!(function () {
  function e(e, t) {
    var r = Object.keys(e);
    if (Object.getOwnPropertySymbols) {
      var i = Object.getOwnPropertySymbols(e);
      (t &&
        (i = i.filter(function (t) {
          return Object.getOwnPropertyDescriptor(e, t).enumerable;
        })),
        r.push.apply(r, i));
    }
    return r;
  }
  function t(t) {
    for (var r = 1; r < arguments.length; r++) {
      var i = null != arguments[r] ? arguments[r] : {};
      r % 2
        ? e(Object(i), !0).forEach(function (e) {
            o(t, e, i[e]);
          })
        : Object.getOwnPropertyDescriptors
          ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(i))
          : e(Object(i)).forEach(function (e) {
              Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(i, e));
            });
    }
    return t;
  }
  function r(e, t) {
    return (
      (function (e) {
        if (Array.isArray(e)) return e;
      })(e) ||
      (function (e, t) {
        var r = null == e ? null : ("undefined" != typeof Symbol && e[Symbol.iterator]) || e["@@iterator"];
        if (null != r) {
          var i,
            n,
            a,
            s,
            o = [],
            l = !0,
            u = !1;
          try {
            if (((a = (r = r.call(e)).next), 0 === t)) {
              if (Object(r) !== r) return;
              l = !1;
            } else for (; !(l = (i = a.call(r)).done) && (o.push(i.value), o.length !== t); l = !0);
          } catch (e) {
            ((u = !0), (n = e));
          } finally {
            try {
              if (!l && null != r.return && ((s = r.return()), Object(s) !== s)) return;
            } finally {
              if (u) throw n;
            }
          }
          return o;
        }
      })(e, t) ||
      u(e, t) ||
      (function () {
        throw new TypeError(
          "Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
        );
      })()
    );
  }
  function i() {
    /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ var e,
      t,
      r = "function" == typeof Symbol ? Symbol : {},
      a = r.iterator || "@@iterator",
      s = r.toStringTag || "@@toStringTag";
    function o(r, i, a, s) {
      var o = i && i.prototype instanceof u ? i : u,
        d = Object.create(o.prototype);
      return (
        n(
          d,
          "_invoke",
          (function (r, i, n) {
            var a,
              s,
              o,
              u = 0,
              d = n || [],
              h = !1,
              c = {
                p: 0,
                n: 0,
                v: e,
                a: f,
                f: f.bind(e, 4),
                d: function (t, r) {
                  return ((a = t), (s = 0), (o = e), (c.n = r), l);
                },
              };
            function f(r, i) {
              for (s = r, o = i, t = 0; !h && u && !n && t < d.length; t++) {
                var n,
                  a = d[t],
                  f = c.p,
                  p = a[2];
                r > 3
                  ? (n = p === i) && ((o = a[(s = a[4]) ? 5 : ((s = 3), 3)]), (a[4] = a[5] = e))
                  : a[0] <= f &&
                    ((n = r < 2 && f < a[1])
                      ? ((s = 0), (c.v = i), (c.n = a[1]))
                      : f < p &&
                        (n = r < 3 || a[0] > i || i > p) &&
                        ((a[4] = r), (a[5] = i), (c.n = p), (s = 0)));
              }
              if (n || r > 1) return l;
              throw ((h = !0), i);
            }
            return function (n, d, p) {
              if (u > 1) throw TypeError("Generator is already running");
              for (h && 1 === d && f(d, p), s = d, o = p; (t = s < 2 ? e : o) || !h; ) {
                a || (s ? (s < 3 ? (s > 1 && (c.n = -1), f(s, o)) : (c.n = o)) : (c.v = o));
                try {
                  if (((u = 2), a)) {
                    if ((s || (n = "next"), (t = a[n]))) {
                      if (!(t = t.call(a, o))) throw TypeError("iterator result is not an object");
                      if (!t.done) return t;
                      ((o = t.value), s < 2 && (s = 0));
                    } else
                      (1 === s && (t = a.return) && t.call(a),
                        s < 2 &&
                          ((o = TypeError("The iterator does not provide a '" + n + "' method")), (s = 1)));
                    a = e;
                  } else if ((t = (h = c.n < 0) ? o : r.call(i, c)) !== l) break;
                } catch (t) {
                  ((a = e), (s = 1), (o = t));
                } finally {
                  u = 1;
                }
              }
              return { value: t, done: h };
            };
          })(r, a, s),
          !0,
        ),
        d
      );
    }
    var l = {};
    function u() {}
    function d() {}
    function h() {}
    t = Object.getPrototypeOf;
    var c = [][a]
        ? t(t([][a]()))
        : (n((t = {}), a, function () {
            return this;
          }),
          t),
      f = (h.prototype = u.prototype = Object.create(c));
    function p(e) {
      return (
        Object.setPrototypeOf
          ? Object.setPrototypeOf(e, h)
          : ((e.__proto__ = h), n(e, s, "GeneratorFunction")),
        (e.prototype = Object.create(f)),
        e
      );
    }
    return (
      (d.prototype = h),
      n(f, "constructor", h),
      n(h, "constructor", d),
      (d.displayName = "GeneratorFunction"),
      n(h, s, "GeneratorFunction"),
      n(f),
      n(f, s, "Generator"),
      n(f, a, function () {
        return this;
      }),
      n(f, "toString", function () {
        return "[object Generator]";
      }),
      (i = function () {
        return { w: o, m: p };
      })()
    );
  }
  function n(e, t, r, i) {
    var a = Object.defineProperty;
    try {
      a({}, "", {});
    } catch (e) {
      a = 0;
    }
    ((n = function (e, t, r, i) {
      function s(t, r) {
        n(e, t, function (e) {
          return this._invoke(t, r, e);
        });
      }
      t
        ? a
          ? a(e, t, { value: r, enumerable: !i, configurable: !i, writable: !i })
          : (e[t] = r)
        : (s("next", 0), s("throw", 1), s("return", 2));
    }),
      n(e, t, r, i));
  }
  function a(e, t, r, i, n, a, s) {
    try {
      var o = e[a](s),
        l = o.value;
    } catch (e) {
      return void r(e);
    }
    o.done ? t(l) : Promise.resolve(l).then(i, n);
  }
  function s(e) {
    return function () {
      var t = this,
        r = arguments;
      return new Promise(function (i, n) {
        var s = e.apply(t, r);
        function o(e) {
          a(s, i, n, o, l, "next", e);
        }
        function l(e) {
          a(s, i, n, o, l, "throw", e);
        }
        o(void 0);
      });
    };
  }
  function o(e, t, r) {
    return (
      (t = (function (e) {
        var t = (function (e, t) {
          if ("object" != typeof e || !e) return e;
          var r = e[Symbol.toPrimitive];
          if (void 0 !== r) {
            var i = r.call(e, t || "default");
            if ("object" != typeof i) return i;
            throw new TypeError("@@toPrimitive must return a primitive value.");
          }
          return ("string" === t ? String : Number)(e);
        })(e, "string");
        return "symbol" == typeof t ? t : t + "";
      })(t)) in e
        ? Object.defineProperty(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 })
        : (e[t] = r),
      e
    );
  }
  function l(e, t) {
    var r = ("undefined" != typeof Symbol && e[Symbol.iterator]) || e["@@iterator"];
    if (!r) {
      if (Array.isArray(e) || (r = u(e)) || (t && e && "number" == typeof e.length)) {
        r && (e = r);
        var i = 0,
          n = function () {};
        return {
          s: n,
          n: function () {
            return i >= e.length ? { done: !0 } : { done: !1, value: e[i++] };
          },
          e: function (e) {
            throw e;
          },
          f: n,
        };
      }
      throw new TypeError(
        "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
      );
    }
    var a,
      s = !0,
      o = !1;
    return {
      s: function () {
        r = r.call(e);
      },
      n: function () {
        var e = r.next();
        return ((s = e.done), e);
      },
      e: function (e) {
        ((o = !0), (a = e));
      },
      f: function () {
        try {
          s || null == r.return || r.return();
        } finally {
          if (o) throw a;
        }
      },
    };
  }
  function u(e, t) {
    if (e) {
      if ("string" == typeof e) return d(e, t);
      var r = {}.toString.call(e).slice(8, -1);
      return (
        "Object" === r && e.constructor && (r = e.constructor.name),
        "Map" === r || "Set" === r
          ? Array.from(e)
          : "Arguments" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)
            ? d(e, t)
            : void 0
      );
    }
  }
  function d(e, t) {
    (null == t || t > e.length) && (t = e.length);
    for (var r = 0, i = Array(t); r < t; r++) i[r] = e[r];
    return i;
  }
  System.register([], function (e, n) {
    "use strict";
    return {
      execute: function () {
        var a = i().m(sl);
        function u(e, t) {}
        function d(e, t, r) {
          var i = Math.trunc(e >>> 24),
            n = Math.trunc((e >>> 16) & 255),
            a = Math.trunc((e >>> 8) & 255),
            s = Math.trunc(255 & e),
            o = Math.trunc(t >>> 24),
            l = Math.trunc((t >>> 16) & 255),
            u = Math.trunc((t >>> 8) & 255),
            d = Math.trunc(255 & t);
          return (
            ((Math.round(o * r + i * (1 - r)) << 24) |
              (Math.round(l * r + n * (1 - r)) << 16) |
              (Math.round(u * r + a * (1 - r)) << 8) |
              Math.round(d * r + s * (1 - r))) >>>
            0
          );
        }
        function h(e, t) {
          return (
            (((e >>> 24) << 24) |
              (((e >>> 16) & 255) << 16) |
              (((e >>> 8) & 255) << 8) |
              Math.trunc((255 & e) * t)) >>>
            0
          );
        }
        var c = !0;
        function f(e, t, r = !1) {
          var i = ((255 & e) / 255) * t,
            n = c ? i : 1,
            a = Math.trunc((e >>> 24) * n),
            s = Math.trunc(((e >>> 16) & 255) * n),
            o = Math.trunc(((e >>> 8) & 255) * n),
            l = Math.trunc(255 * i);
          return r
            ? ((l << 24) | (o << 16) | (s << 8) | a) >>> 0
            : ((a << 24) | (s << 16) | (o << 8) | l) >>> 0;
        }
        function p(e, t) {
          return Object.prototype.hasOwnProperty.call(e, t);
        }
        var g = 1;
        var m,
          v = class {
            constructor() {
              o(this, "eventListeners", {});
            }
            on(e, t) {
              var r = this.eventListeners[e];
              (r || (r = []), r.push(t), (this.eventListeners[e] = r));
            }
            off(e, t) {
              var r = this.eventListeners[e];
              if (r)
                if (t) {
                  var i = r.indexOf(t);
                  i >= 0 && r.splice(i, 1);
                } else delete this.eventListeners[e];
            }
            once(e, t) {
              var r = (i, n) => {
                (this.off(e, r), t(i, n));
              };
              this.on(e, r);
            }
            emit(e, t) {
              var r = this.eventListeners[e];
              r &&
                [...r].forEach(e => {
                  e(this, t);
                });
            }
            removeAllListeners() {
              this.eventListeners = {};
            }
          };
        !(function (e) {
          ((e[(e.generic = 0)] = "generic"),
            (e[(e.color = 1)] = "color"),
            (e[(e.image = 2)] = "image"),
            (e[(e.noise = 3)] = "noise"),
            (e[(e.renderToTexture = 4)] = "renderToTexture"),
            (e[(e.subTexture = 5)] = "subTexture"));
        })(m || (m = {}));
        class y extends v {
          constructor(e) {
            (super(),
              o(this, "txManager", void 0),
              o(this, "_dimensions", null),
              o(this, "_error", null),
              o(this, "state", "initial"),
              o(this, "renderableOwners", []),
              o(this, "renderable", !1),
              o(this, "type", m.generic),
              o(this, "preventCleanup", !1),
              o(this, "ctxTexture", void 0),
              o(this, "textureData", null),
              o(this, "memUsed", 0),
              o(this, "retryCount", 0),
              o(this, "maxRetryCount", void 0),
              o(this, "createdAt", Date.now()),
              o(this, "gracePeriodExpired", !1),
              (this.txManager = e),
              (this.maxRetryCount = e.maxRetryCount));
          }
          get dimensions() {
            return this._dimensions;
          }
          get error() {
            return this._error;
          }
          isWithinStartupGracePeriod() {
            return (
              !this.gracePeriodExpired &&
              (!(Date.now() - this.createdAt >= y.STARTUP_GRACE_PERIOD) ||
                ((this.gracePeriodExpired = !0), !1))
            );
          }
          canBeCleanedUp() {
            return (
              !this.preventCleanup &&
              !this.isWithinStartupGracePeriod() &&
              !0 !== this.renderable &&
              !(this.renderableOwners.length > 0)
            );
          }
          setRenderableOwner(e, t) {
            var r = this.renderableOwners.length,
              i = this.renderableOwners.indexOf(e);
            if (!0 === t) {
              -1 === i && this.renderableOwners.push(e);
              var n,
                a = this.renderableOwners.length;
              if (r !== a && 1 === a)
                ((this.renderable = !0),
                  null === (n = this.onChangeIsRenderable) || void 0 === n || n.call(this, !0),
                  this.load());
            } else {
              -1 !== i && this.renderableOwners.splice(i, 1);
              var s,
                o = this.renderableOwners.length;
              if (r !== o && 0 === o)
                ((this.renderable = !1),
                  null === (s = this.onChangeIsRenderable) || void 0 === s || s.call(this, !1));
            }
          }
          load() {
            this.retryCount > this.maxRetryCount || this.txManager.loadTexture(this);
          }
          loadCtxTexture() {
            return (
              void 0 === this.ctxTexture &&
                (this.ctxTexture = this.txManager.renderer.createCtxTexture(this)),
              this.ctxTexture
            );
          }
          free() {
            var e;
            null === (e = this.ctxTexture) || void 0 === e || e.free();
          }
          release() {
            var e;
            (null === (e = this.ctxTexture) || void 0 === e || e.release(),
              (this.ctxTexture = void 0),
              this.freeTextureData());
          }
          destroy() {
            ("loaded" === this.state && this.free(), this.freeTextureData());
          }
          freeTextureData() {
            queueMicrotask(() => {
              this.textureData = null;
            });
          }
          setState(e, t) {
            if (this.state !== e) {
              var r = null;
              ("loaded" === e
                ? ((this._error = null),
                  void 0 !== t &&
                    "width" in t == !0 &&
                    "height" in t == !0 &&
                    void 0 !== t.width &&
                    void 0 !== t.height &&
                    (this._dimensions = t),
                  (r = this._dimensions))
                : "failed" === e
                  ? ((this._error = t),
                    (r = this._error),
                    (this.retryCount += 1),
                    queueMicrotask(() => {
                      this.release();
                    }))
                  : "loading" === e
                    ? ((this._error = null), (this._dimensions = null))
                    : (this._error = null),
                (this.state = e),
                this.emit(e, r));
            }
          }
          getTextureData() {
            var e = this;
            return s(
              i().m(function t() {
                return i().w(function (t) {
                  for (;;)
                    switch (t.n) {
                      case 0:
                        if (null !== e.textureData) {
                          t.n = 2;
                          break;
                        }
                        return ((t.n = 1), e.getTextureSource());
                      case 1:
                        e.textureData = t.v;
                      case 2:
                        return t.a(2, e.textureData);
                    }
                }, t);
              }),
            )();
          }
          static makeCacheKey(e) {
            return !1;
          }
          static resolveDefaults(e) {
            return {};
          }
          retry() {
            (this.release(), (this.retryCount = 0), this.load());
          }
        }
        o(y, "STARTUP_GRACE_PERIOD", 2e3);
        var T = /^(data|ftps?|https?):/,
          b = e => [(e >>> 24) / 255, ((e >>> 16) & 255) / 255, ((e >>> 8) & 255) / 255, (255 & e) / 255];
        function S(e, t, r, i, n) {
          return n ? ((n.x1 = e), (n.y1 = t), (n.x2 = r), (n.y2 = i), n) : { x1: e, y1: t, x2: r, y2: i };
        }
        function E(e, t) {
          return e.x1 < t.x2 && e.x2 > t.x1 && e.y1 < t.y2 && e.y2 > t.y1;
        }
        function x(e, t, r) {
          var i = Math.max(e.x, t.x),
            n = Math.max(e.y, t.y),
            a = Math.min(e.x + e.width, t.x + t.width) - i,
            s = Math.min(e.y + e.height, t.y + t.height) - n;
          return a > 0 && s > 0
            ? r
              ? ((r.x = i), (r.y = n), (r.width = a), (r.height = s), r)
              : { x: i, y: n, width: a, height: s }
            : r
              ? ((r.x = 0), (r.y = 0), (r.width = 0), (r.height = 0), r)
              : { x: 0, y: 0, width: 0, height: 0 };
        }
        function w(e, t) {
          return t
            ? ((t.x = e.x), (t.y = e.y), (t.width = e.width), (t.height = e.height), t)
            : { x: e.x, y: e.y, width: e.width, height: e.height };
        }
        function A(e, t) {
          return e.x1 <= t.x2 && e.y1 <= t.y2 && e.x2 >= t.x1 && e.y2 >= t.y1;
        }
        function I(e, t, r) {
          return !(e < r.x1 || e > r.x2 || t < r.y1 || t > r.y2);
        }
        function k(e, t) {
          return S(e.x1 - t[3], e.y1 - t[0], e.x2 + t[1], e.y2 + t[2]);
        }
        function R(e) {
          return !0 === e.startsWith("data:");
        }
        function C(e) {
          for (
            var t,
              r =
                (null === (t = (e = e.replace(/^data:/, "")).match(/image\/[^;]+/)) || void 0 === t
                  ? void 0
                  : t[0]) || "",
              i = e.replace(/^[^,]+,/, ""),
              n = 1024,
              a = atob(i),
              s = a.length,
              o = Math.ceil(s / n),
              l = new Array(o),
              u = 0;
            u < o;
            ++u
          ) {
            for (var d = u * n, h = Math.min(d + n, s), c = new Array(h - d), f = d, p = 0; f < h; ++p, ++f) {
              var g;
              c[p] = null === (g = a[f]) || void 0 === g ? void 0 : g.charCodeAt(0);
            }
            l[u] = new Uint8Array(c);
          }
          return new Blob(l, { type: r });
        }
        class L {
          constructor() {
            (o(this, "ta", void 0),
              o(this, "tb", void 0),
              o(this, "tx", void 0),
              o(this, "tc", void 0),
              o(this, "td", void 0),
              o(this, "ty", void 0),
              o(this, "_floatArr", null),
              o(this, "mutation", void 0),
              (this.ta = 0),
              (this.tb = 0),
              (this.tx = 0),
              (this.tc = 0),
              (this.td = 0),
              (this.ty = 0),
              (this.mutation = !0));
          }
          static get temp() {
            return M;
          }
          static multiply(e, t, r) {
            var i = e.ta * t.ta + e.tb * t.tc,
              n = e.ta * t.tb + e.tb * t.td,
              a = e.ta * t.tx + e.tb * t.ty + e.tx,
              s = e.tc * t.ta + e.td * t.tc,
              o = e.tc * t.tb + e.td * t.td,
              l = e.tc * t.tx + e.td * t.ty + e.ty;
            return (
              r || (r = new L()),
              (r.ta = i),
              (r.tb = n),
              (r.tx = a),
              (r.tc = s),
              (r.td = o),
              (r.ty = l),
              (r.mutation = !0),
              r
            );
          }
          static identity(e) {
            return (
              e || (e = new L()),
              (e.ta = 1),
              (e.tb = 0),
              (e.tx = 0),
              (e.tc = 0),
              (e.td = 1),
              (e.ty = 0),
              (e.mutation = !0),
              e
            );
          }
          static translate(e, t, r) {
            return (
              r || (r = new L()),
              (r.ta = 1),
              (r.tb = 0),
              (r.tx = e),
              (r.tc = 0),
              (r.td = 1),
              (r.ty = t),
              (r.mutation = !0),
              r
            );
          }
          static scale(e, t, r) {
            return (
              r || (r = new L()),
              (r.ta = e),
              (r.tb = 0),
              (r.tx = 0),
              (r.tc = 0),
              (r.td = t),
              (r.ty = 0),
              (r.mutation = !0),
              r
            );
          }
          static rotate(e, t) {
            var r = Math.cos(e),
              i = Math.sin(e);
            return (
              t || (t = new L()),
              (t.ta = r),
              (t.tb = -i),
              (t.tx = 0),
              (t.tc = i),
              (t.td = r),
              (t.ty = 0),
              (t.mutation = !0),
              t
            );
          }
          static copy(e, t) {
            return (
              t || (t = new L()),
              (t.ta = e.ta),
              (t.tc = e.tc),
              (t.tb = e.tb),
              (t.td = e.td),
              (t.tx = e.tx),
              (t.ty = e.ty),
              (t.mutation = !0),
              t
            );
          }
          translate(e, t) {
            return (
              (this.tx = this.ta * e + this.tb * t + this.tx),
              (this.ty = this.tc * e + this.td * t + this.ty),
              (this.mutation = !0),
              this
            );
          }
          scale(e, t) {
            return (
              (this.ta = this.ta * e),
              (this.tb = this.tb * t),
              (this.tc = this.tc * e),
              (this.td = this.td * t),
              (this.mutation = !0),
              this
            );
          }
          rotate(e) {
            if (0 === e || !((e % Math.PI) * 2)) return this;
            var t = Math.cos(e),
              r = Math.sin(e),
              i = this.ta * t + this.tb * r,
              n = this.tb * t - this.ta * r,
              a = this.tc * t + this.td * r,
              s = this.td * t - this.tc * r;
            return ((this.ta = i), (this.tb = n), (this.tc = a), (this.td = s), (this.mutation = !0), this);
          }
          multiply(e) {
            return L.multiply(this, e, this);
          }
          getFloatArr() {
            return (
              this._floatArr || (this._floatArr = new Float32Array(9)),
              this.mutation &&
                ((this._floatArr[0] = this.ta),
                (this._floatArr[1] = this.tc),
                (this._floatArr[2] = 0),
                (this._floatArr[3] = this.tb),
                (this._floatArr[4] = this.td),
                (this._floatArr[5] = 0),
                (this._floatArr[6] = this.tx),
                (this._floatArr[7] = this.ty),
                (this._floatArr[8] = 1),
                (this.mutation = !1)),
              this._floatArr
            );
          }
        }
        var M = new L();
        class D {
          constructor(e) {
            (o(this, "data", void 0),
              (this.data = new Float32Array(8)),
              e &&
                ((this.data[0] = e[0]),
                (this.data[2] = e[2]),
                (this.data[4] = e[4]),
                (this.data[6] = e[6]),
                (this.data[1] = e[1]),
                (this.data[3] = e[3]),
                (this.data[5] = e[5]),
                (this.data[7] = e[7])));
          }
          static translate(e, t, r, i, n, a, s, o, l) {
            return (
              l || (l = new D()),
              (l.data[0] = e),
              (l.data[2] = r),
              (l.data[4] = n),
              (l.data[6] = s),
              (l.data[1] = t),
              (l.data[3] = i),
              (l.data[5] = a),
              (l.data[7] = o),
              l
            );
          }
          get x1() {
            return this.data[0];
          }
          get x2() {
            return this.data[2];
          }
          get x3() {
            return this.data[4];
          }
          get x4() {
            return this.data[6];
          }
          get y1() {
            return this.data[1];
          }
          get y2() {
            return this.data[3];
          }
          get y3() {
            return this.data[5];
          }
          get y4() {
            return this.data[7];
          }
        }
        var _,
          P = (e, t, r, i) => {
            var n = 3 * e,
              a = 3 * (r - e) - n,
              s = 1 - n - a,
              o = 3 * t,
              l = 3 * (i - t) - o,
              u = 1 - o - l;
            return function (e) {
              if (e >= 1) return 1;
              if (e <= 0) return 0;
              for (var t, r, i = 0.5, d = 0; d < 20; d++) {
                if ((r = e - i * (i * (i * s + a) + n)) > -1e-8 && r < 1e-8) return i * (i * (i * u + l) + o);
                if ((t = i * (i * (3 * s) + 2 * a) + n) > 1e-10 && t < 1e-10) break;
                i += r / t;
              }
              for (var h = 0, c = 1, f = 0; f < 20; f++) {
                if ((r = e - (i = 0.5 * (h + c)) * (i * (i * s + a) + n)) > -1e-8 && r < 1e-8)
                  return i * (i * (i * u + l) + o);
                r < 0 ? (c = i) : (h = i);
              }
            };
          },
          O = {},
          N = {
            ease: [0.25, 0.1, 0.25, 1],
            "ease-in": [0.42, 0, 1, 1],
            "ease-out": [0, 0, 0.58, 1],
            "ease-in-out": [0.42, 0, 0.58, 1],
            "ease-in-sine": [0.12, 0, 0.39, 0],
            "ease-out-sine": [0.12, 0, 0.39, 0],
            "ease-in-out-sine": [0.37, 0, 0.63, 1],
            "ease-in-cubic": [0.32, 0, 0.67, 0],
            "ease-out-cubic": [0.33, 1, 0.68, 1],
            "ease-in-out-cubic": [0.65, 0, 0.35, 1],
            "ease-in-circ": [0.55, 0, 1, 0.45],
            "ease-out-circ": [0, 0.55, 0.45, 1],
            "ease-in-out-circ": [0.85, 0, 0.15, 1],
            "ease-in-back": [0.36, 0, 0.66, -0.56],
            "ease-out-back": [0.34, 1.56, 0.64, 1],
            "ease-in-out-back": [0.68, -0.6, 0.32, 1.6],
          },
          F = e => e,
          U = e => {
            if ("linear" === e) return F;
            if (void 0 !== O[e]) return O[e] || F;
            if ("step-start" === e) return () => 1;
            if ("step-end" === e) return e => (1 === e ? 1 : 0);
            var t = N[e];
            if (void 0 !== t) {
              var i = r(t, 4),
                n = i[0],
                a = i[1],
                s = i[2],
                o = i[3],
                l = P(n, a, s, o);
              return ((O[e] = l), l);
            }
            return e.startsWith("cubic-bezier")
              ? (e => {
                  var t = e.match(/-?\d*\.?\d+/g);
                  if (t) {
                    var i = r(t, 4),
                      n = i[0],
                      a = i[1],
                      s = i[2],
                      o = i[3],
                      l = parseFloat(n || "0.42"),
                      u = parseFloat(a || "0"),
                      d = parseFloat(s || "1"),
                      h = parseFloat(o || "1"),
                      c = P(l, u, d, h);
                    return ((O[e] = c), c);
                  }
                  return (console.warn("Unknown cubic-bezier timing: " + e), F);
                })(e)
              : (console.warn("Unknown timing function: " + e), F);
          };
        function B(e) {
          return (e / 1024 / 1024).toFixed(2);
        }
        class $ extends v {
          constructor(e, t, i) {
            var n, a, s, l, u, d;
            for (var h in (super(),
            o(this, "node", void 0),
            o(this, "props", void 0),
            o(this, "settings", void 0),
            o(this, "progress", 0),
            o(this, "delayFor", 0),
            o(this, "delay", 0),
            o(this, "timingFunction", void 0),
            o(this, "propValuesMap", {}),
            o(this, "dynPropValuesMap", void 0),
            (this.node = e),
            (this.props = t),
            t))
              if ("shaderProps" !== h)
                (void 0 === this.propValuesMap.props && (this.propValuesMap.props = {}),
                  (this.propValuesMap.props[h] = { start: e[h] || 0, target: t[h] }));
              else if ("DynamicShader" !== e.shader.type)
                for (var c in ((this.propValuesMap.shaderProps = {}), t.shaderProps))
                  this.propValuesMap.shaderProps[c] = { start: e.shader.props[c], target: t.shaderProps[c] };
              else {
                var f = Object.keys(t.shaderProps),
                  p = f.length;
                this.dynPropValuesMap = {};
                for (var g = 0; g < p; g++) {
                  var m = f[g],
                    v = t.shaderProps[m];
                  this.dynPropValuesMap[m] = {};
                  for (var y = Object.entries(v), T = y.length, b = 0; b < T; b++) {
                    var S = r(y[b], 2),
                      E = S[0],
                      x = S[1];
                    this.dynPropValuesMap[m][E] = { start: e.shader.props[m][E], target: x };
                  }
                }
              }
            var w = i.easing || "linear",
              A = null !== (n = i.delay) && void 0 !== n ? n : 0;
            ((this.settings = {
              duration: null !== (a = i.duration) && void 0 !== a ? a : 0,
              delay: A,
              easing: w,
              loop: null !== (s = i.loop) && void 0 !== s && s,
              repeat: null !== (l = i.repeat) && void 0 !== l ? l : 0,
              repeatDelay: null !== (u = i.repeatDelay) && void 0 !== u ? u : 0,
              stopMethod: null !== (d = i.stopMethod) && void 0 !== d && d,
            }),
              (this.timingFunction = U(w)),
              (this.delayFor = A),
              (this.delay = A));
          }
          reset() {
            ((this.progress = 0), (this.delayFor = this.settings.delay || 0), this.update(0));
          }
          restoreValues(e, t) {
            for (var i = Object.entries(t), n = i.length, a = 0; a < n; a++) {
              var s = r(i[a], 2),
                o = s[0],
                l = s[1];
              e[o] = l.start;
            }
          }
          restore() {
            if (
              (this.reset(),
              void 0 !== this.propValuesMap.props && this.restoreValues(this.node, this.propValuesMap.props),
              void 0 !== this.propValuesMap.shaderProps &&
                this.restoreValues(this.node.shader.props, this.propValuesMap.shaderProps),
              void 0 !== this.dynPropValuesMap)
            ) {
              var e = Object.keys(this.dynPropValuesMap),
                t = e.length;
              if (t > 0)
                for (var r = 0; r < t; r++) {
                  var i = e[r];
                  this.restoreValues(this.node.shader.props[i], this.dynPropValuesMap[i]);
                }
            }
          }
          reverseValues(e) {
            for (var t = Object.entries(e), i = t.length, n = 0; n < i; n++) {
              var a = r(t[n], 2),
                s = a[0],
                o = a[1];
              e[s] = { start: o.target, target: o.start };
            }
          }
          reverse() {
            if (
              ((this.progress = 0),
              void 0 !== this.propValuesMap.props && this.reverseValues(this.propValuesMap.props),
              void 0 !== this.propValuesMap.shaderProps && this.reverseValues(this.propValuesMap.shaderProps),
              void 0 !== this.dynPropValuesMap)
            ) {
              var e = Object.keys(this.dynPropValuesMap),
                t = e.length;
              if (t > 0)
                for (var r = 0; r < t; r++) {
                  var i = e[r];
                  this.reverseValues(this.dynPropValuesMap[i]);
                }
            }
            this.settings.loop || (this.settings.stopMethod = !1);
          }
          applyEasing(e, t, r) {
            return (this.timingFunction(e) || e) * (r - t) + t;
          }
          updateValue(e, t, r, i) {
            if (1 === this.progress) return t;
            if (0 === this.progress) return r;
            var n = t;
            return -1 !== e.indexOf("color")
              ? r === n
                ? r
                : d(r, n, (i && this.timingFunction(this.progress)) || this.progress)
              : i
                ? this.applyEasing(this.progress, r, n)
                : r + (n - r) * this.progress;
          }
          updateValues(e, t, i) {
            for (var n = Object.entries(t), a = n.length, s = 0; s < a; s++) {
              var o = r(n[s], 2),
                l = o[0],
                u = o[1];
              e[l] = this.updateValue(l, u.target, u.start, i);
            }
          }
          update(e) {
            var t = this.settings,
              r = t.duration,
              i = t.loop,
              n = t.easing,
              a = t.stopMethod,
              s = this.delayFor;
            if (this.node.destroyed) this.emit("destroyed", {});
            else if (0 !== r || 0 !== s) {
              if (this.delayFor > 0) {
                if (((this.delayFor -= e), this.delayFor >= 0)) return;
                ((e = -this.delayFor), (this.delayFor = 0));
              }
              if (0 !== r)
                if (
                  (0 === this.progress && this.emit("animating", {}),
                  (this.progress += e / r),
                  this.progress > 1 && ((this.progress = i ? 0 : 1), (this.delayFor = this.delay), a))
                )
                  this.emit("finished", {});
                else {
                  if (
                    (void 0 !== this.propValuesMap.props &&
                      this.updateValues(this.node, this.propValuesMap.props, n),
                    void 0 !== this.propValuesMap.shaderProps &&
                      this.updateValues(this.node.shader.props, this.propValuesMap.shaderProps, n),
                    void 0 !== this.dynPropValuesMap)
                  ) {
                    var o = Object.keys(this.dynPropValuesMap),
                      l = o.length;
                    if (l > 0)
                      for (var u = 0; u < l; u++) {
                        var d = o[u];
                        this.updateValues(this.node.shader.props[d], this.dynPropValuesMap[d], n);
                      }
                  }
                  (this.progress < 1 && this.emit("tick", { progress: this.progress }),
                    1 === this.progress && this.emit("finished", {}));
                }
              else this.emit("finished", {});
            } else this.emit("finished", {});
          }
        }
        class j extends v {
          constructor(e, t) {
            (super(),
              o(this, "manager", void 0),
              o(this, "animation", void 0),
              o(this, "stoppedPromise", void 0),
              o(this, "stoppedResolve", null),
              o(this, "state", void 0),
              (this.manager = e),
              (this.animation = t),
              (this.state = "stopped"),
              (this.stoppedPromise = Promise.resolve()),
              (this.onAnimating = this.onAnimating.bind(this)),
              (this.onFinished = this.onFinished.bind(this)),
              (this.onTick = this.onTick.bind(this)),
              (this.onDestroy = this.onDestroy.bind(this)));
          }
          start() {
            return (
              "running" !== this.state &&
                "scheduled" !== this.state &&
                (this.makeStoppedPromise(), this.registerAnimation(), (this.state = "scheduled")),
              this
            );
          }
          stop() {
            return (
              this.unregisterAnimation(),
              null !== this.stoppedResolve &&
                (this.stoppedResolve(), (this.stoppedResolve = null), this.emit("stopped", this)),
              this.animation.reset(),
              (this.state = "stopped"),
              this
            );
          }
          pause() {
            return (this.unregisterAnimation(), (this.state = "paused"), this);
          }
          restore() {
            return ((this.stoppedResolve = null), this.animation.restore(), this);
          }
          waitUntilStopped() {
            return this.stoppedPromise;
          }
          registerAnimation() {
            (this.animation.once("finished", this.onFinished),
              this.animation.on("animating", this.onAnimating),
              this.animation.on("tick", this.onTick),
              this.animation.on("destroyed", this.onDestroy),
              this.manager.registerAnimation(this.animation));
          }
          unregisterAnimation() {
            (this.manager.unregisterAnimation(this.animation),
              this.animation.off("finished", this.onFinished),
              this.animation.off("animating", this.onAnimating),
              this.animation.off("tick", this.onTick),
              this.animation.off("destroy", this.onDestroy));
          }
          makeStoppedPromise() {
            null === this.stoppedResolve &&
              (this.stoppedPromise = new Promise(e => {
                this.stoppedResolve = e;
              }));
          }
          onDestroy() {
            (this.unregisterAnimation(), (this.state = "stopped"));
          }
          onFinished() {
            var e = this.animation.settings,
              t = e.loop;
            if ("reverse" === e.stopMethod)
              return (this.animation.once("finished", this.onFinished), void this.animation.reverse());
            t ||
              (this.unregisterAnimation(),
              null !== this.stoppedResolve && (this.stoppedResolve(), (this.stoppedResolve = null)),
              this.emit("stopped", this),
              (this.state = "stopped"));
          }
          onAnimating() {
            ((this.state = "running"), this.emit("animating", this));
          }
          onTick(e, t) {
            this.emit("tick", t);
          }
        }
        !(function (e) {
          ((e[(e.Init = 0)] = "Init"),
            (e[(e.OutOfBounds = 2)] = "OutOfBounds"),
            (e[(e.InBounds = 4)] = "InBounds"),
            (e[(e.InViewport = 8)] = "InViewport"));
        })(_ || (_ = {}));
        var G,
          V = new Map();
        (V.set(_.Init, "init"),
          V.set(_.OutOfBounds, "outOfBounds"),
          V.set(_.InBounds, "inBounds"),
          V.set(_.InViewport, "inViewport"),
          (function (e) {
            ((e[(e.Children = 1)] = "Children"),
              (e[(e.ScaleRotate = 2)] = "ScaleRotate"),
              (e[(e.Local = 4)] = "Local"),
              (e[(e.Global = 8)] = "Global"),
              (e[(e.Clipping = 16)] = "Clipping"),
              (e[(e.CalculatedZIndex = 32)] = "CalculatedZIndex"),
              (e[(e.ZIndexSortedChildren = 64)] = "ZIndexSortedChildren"),
              (e[(e.PremultipliedColors = 128)] = "PremultipliedColors"),
              (e[(e.WorldAlpha = 256)] = "WorldAlpha"),
              (e[(e.RenderState = 512)] = "RenderState"),
              (e[(e.IsRenderable = 1024)] = "IsRenderable"),
              (e[(e.RenderTexture = 2048)] = "RenderTexture"),
              (e[(e.ParentRenderTexture = 4096)] = "ParentRenderTexture"),
              (e[(e.RenderBounds = 8192)] = "RenderBounds"),
              (e[(e.None = 0)] = "None"),
              (e[(e.All = 14335)] = "All"));
          })(G || (G = {})));
        class H extends v {
          constructor(e, r) {
            (super(),
              o(this, "stage", void 0),
              o(this, "children", []),
              o(this, "_id", g++),
              o(this, "props", void 0),
              o(this, "updateType", G.All),
              o(this, "childUpdateType", G.None),
              o(this, "globalTransform", void 0),
              o(this, "scaleRotateTransform", void 0),
              o(this, "localTransform", void 0),
              o(this, "sceneGlobalTransform", void 0),
              o(this, "renderCoords", void 0),
              o(this, "sceneRenderCoords", void 0),
              o(this, "renderBound", void 0),
              o(this, "strictBound", void 0),
              o(this, "preloadBound", void 0),
              o(this, "clippingRect", { x: 0, y: 0, width: 0, height: 0, valid: !1 }),
              o(this, "isRenderable", !1),
              o(this, "renderState", _.Init),
              o(this, "worldAlpha", 1),
              o(this, "premultipliedColorTl", 0),
              o(this, "premultipliedColorTr", 0),
              o(this, "premultipliedColorBl", 0),
              o(this, "premultipliedColorBr", 0),
              o(this, "calcZIndex", 0),
              o(this, "hasRTTupdates", !1),
              o(this, "parentHasRenderTexture", !1),
              o(this, "rttParent", null),
              o(this, "destroyed", !1),
              o(this, "onTextureLoaded", (e, t) => {
                var r;
                (this.autosizeNode(t),
                  this.setUpdateType(G.IsRenderable),
                  this.stage.requestRender(),
                  this.parentHasRenderTexture && this.notifyParentRTTOfUpdate(),
                  t.width > 1 && t.height > 1 && this.emit("loaded", { type: "texture", dimensions: t }),
                  "contain" ===
                    (null === (r = this.props.textureOptions) ||
                    void 0 === r ||
                    null === (r = r.resizeMode) ||
                    void 0 === r
                      ? void 0
                      : r.type) && this.setUpdateType(G.Local));
              }),
              o(this, "onTextureFailed", (e, t) => {
                ((this.isRenderable = !1),
                  this.updateTextureOwnership(!1),
                  this.setUpdateType(G.IsRenderable),
                  this.parentHasRenderTexture && this.notifyParentRTTOfUpdate(),
                  null !== this.texture &&
                    this.texture.retryCount > this.texture.maxRetryCount &&
                    this.emit("failed", { type: "texture", error: t }));
              }),
              o(this, "onTextureFreed", () => {
                ((this.isRenderable = !1),
                  this.updateTextureOwnership(!1),
                  this.setUpdateType(G.IsRenderable),
                  this.parentHasRenderTexture && this.notifyParentRTTOfUpdate(),
                  this.emit("freed", { type: "texture" }));
              }),
              (this.stage = e),
              (this.props = t(t({}, r), {}, { parent: null, texture: null, src: null, rtt: !1 })),
              (this.parent = r.parent),
              (this.texture = r.texture),
              (this.src = r.src),
              (this.rtt = r.rtt),
              (this.interactive = r.interactive),
              r.boundsMargin &&
                (this.boundsMargin = Array.isArray(r.boundsMargin)
                  ? r.boundsMargin
                  : [r.boundsMargin, r.boundsMargin, r.boundsMargin, r.boundsMargin]),
              this.setUpdateType(G.ScaleRotate | G.Local | G.RenderBounds | G.RenderState),
              this.stage.defaultTexture &&
                "loaded" !== this.stage.defaultTexture.state &&
                this.stage.defaultTexture.once("loaded", () => {
                  this.setUpdateType(G.IsRenderable);
                }));
          }
          loadTexture() {
            var e = this.props.texture;
            queueMicrotask(() => {
              var t, r;
              (!0 === this.textureOptions.preload && this.stage.txManager.loadTexture(e),
                (e.preventCleanup =
                  null !==
                    (t =
                      null === (r = this.props.textureOptions) || void 0 === r ? void 0 : r.preventCleanup) &&
                  void 0 !== t &&
                  t),
                e.on("loaded", this.onTextureLoaded),
                e.on("failed", this.onTextureFailed),
                e.on("freed", this.onTextureFreed),
                "loaded" === e.state
                  ? (e.dimensions, this.onTextureLoaded(e, e.dimensions))
                  : "failed" === e.state
                    ? (e.error, this.onTextureFailed(e, e.error))
                    : "freed" === e.state && this.onTextureFreed(e),
                this.parentHasRenderTexture && this.notifyParentRTTOfUpdate());
            });
          }
          unloadTexture() {
            null !== this.texture &&
              (this.texture.off("loaded", this.onTextureLoaded),
              this.texture.off("failed", this.onTextureFailed),
              this.texture.off("freed", this.onTextureFreed),
              this.texture.setRenderableOwner(this._id, !1));
          }
          autosizeNode(e) {
            this.autosize && ((this.width = e.width), (this.height = e.height));
          }
          setUpdateType(e) {
            this.updateType |= e;
            var t = this.props.parent;
            t && 0 === (t.updateType & G.Children) && t.setUpdateType(G.Children);
          }
          sortChildren() {
            this.children.sort((e, t) => e.calcZIndex - t.calcZIndex);
          }
          updateScaleRotateTransform() {
            var e = this.props,
              t = e.rotation,
              r = e.scaleX,
              i = e.scaleY;
            this.scaleRotateTransform =
              0 !== t || 1 !== r || 1 !== i ? L.rotate(t, this.scaleRotateTransform).scale(r, i) : void 0;
          }
          updateLocalTransform() {
            var e,
              t = this.props,
              r = t.x,
              i = t.y,
              n = t.width,
              a = t.height,
              s = this.props.mountX * n,
              o = this.props.mountY * a;
            if (this.scaleRotateTransform) {
              var l = this.props.pivotX * n,
                u = this.props.pivotY * a;
              this.localTransform = L.translate(r - s + l, i - o + u, this.localTransform)
                .multiply(this.scaleRotateTransform)
                .translate(-l, -u);
            } else this.localTransform = L.translate(r - s, i - o, this.localTransform);
            var d = this.props.texture;
            if (
              d &&
              d.dimensions &&
              "contain" ===
                (null === (e = this.props.textureOptions) ||
                void 0 === e ||
                null === (e = e.resizeMode) ||
                void 0 === e
                  ? void 0
                  : e.type)
            ) {
              var h = 1,
                c = 1,
                f = 0,
                p = 0,
                g = d.dimensions,
                m = g.width,
                v = g.height;
              if (m / v > n / a) {
                var y = v * (n / m);
                ((p = (a - y) / 2), (c = y / a));
              } else {
                var T = m * (a / v);
                ((f = (n - T) / 2), (h = T / n));
              }
              this.localTransform.translate(f, p).scale(h, c);
            }
            this.setUpdateType(G.Global);
          }
          update(e, t) {
            (this.updateType & G.ScaleRotate &&
              (this.updateScaleRotateTransform(), this.setUpdateType(G.Local)),
              this.updateType & G.Local && (this.updateLocalTransform(), this.setUpdateType(G.Global)));
            var r = this.props.parent,
              i = null;
            if (
              (this.updateType & G.RenderTexture && this.rtt && (this.hasRTTupdates = !0),
              this.updateType & G.Global &&
                (this.localTransform,
                !0 === this.parentHasRenderTexture && !0 === (null == r ? void 0 : r.rtt)
                  ? ((this.globalTransform = L.identity()),
                    (this.sceneGlobalTransform = L.copy(
                      (null == r ? void 0 : r.globalTransform) || L.identity(),
                    ).multiply(this.localTransform)))
                  : !0 === this.parentHasRenderTexture && !1 === (null == r ? void 0 : r.rtt)
                    ? ((this.sceneGlobalTransform = L.copy(
                        (null == r ? void 0 : r.sceneGlobalTransform) || this.localTransform,
                      ).multiply(this.localTransform)),
                      (this.globalTransform = L.copy(
                        (null == r ? void 0 : r.globalTransform) || this.localTransform,
                        this.globalTransform,
                      )))
                    : (this.globalTransform = L.copy(
                        (null == r ? void 0 : r.globalTransform) || this.localTransform,
                        this.globalTransform,
                      )),
                null !== r && this.globalTransform.multiply(this.localTransform),
                this.calculateRenderCoords(),
                this.updateBoundingRect(),
                this.setUpdateType(G.RenderState | G.Children),
                (this.childUpdateType |= G.Global),
                !0 === this.clipping &&
                  (this.setUpdateType(G.Clipping | G.RenderBounds),
                  (this.childUpdateType |= G.RenderBounds))),
              this.updateType & G.RenderBounds &&
                (this.createRenderBounds(),
                this.setUpdateType(G.RenderState),
                this.setUpdateType(G.Children),
                (this.childUpdateType |= G.RenderBounds)),
              this.updateType & G.RenderState &&
                ((i = this.checkRenderBounds()),
                this.setUpdateType(G.IsRenderable),
                i !== _.OutOfBounds && this.updateRenderState(i)),
              this.updateType & G.WorldAlpha &&
                ((this.worldAlpha = r ? r.worldAlpha * this.props.alpha : this.props.alpha),
                this.setUpdateType(G.Children | G.PremultipliedColors | G.IsRenderable),
                (this.childUpdateType |= G.WorldAlpha)),
              this.updateType & G.IsRenderable && this.updateIsRenderable(),
              this.updateType & G.Clipping &&
                (this.calculateClippingRect(t),
                this.setUpdateType(G.Children),
                (this.childUpdateType |= G.Clipping),
                (this.childUpdateType |= G.RenderBounds)),
              this.updateType & G.PremultipliedColors &&
                ((this.premultipliedColorTl = f(this.props.colorTl, this.worldAlpha, !0)),
                this.props.colorTl === this.props.colorTr &&
                this.props.colorBl === this.props.colorBr &&
                this.props.colorTl === this.props.colorBl
                  ? (this.premultipliedColorTr =
                      this.premultipliedColorBl =
                      this.premultipliedColorBr =
                        this.premultipliedColorTl)
                  : ((this.premultipliedColorTr = f(this.props.colorTr, this.worldAlpha, !0)),
                    (this.premultipliedColorBl = f(this.props.colorBl, this.worldAlpha, !0)),
                    (this.premultipliedColorBr = f(this.props.colorBr, this.worldAlpha, !0)))),
              null !== r &&
                this.updateType & G.CalculatedZIndex &&
                (this.calculateZIndex(), r.setUpdateType(G.ZIndexSortedChildren)),
              !0 !== this.props.strictBounds || this.renderState !== _.OutOfBounds)
            ) {
              if (this.updateType & G.Children && this.children.length > 0)
                for (var n = 0, a = this.children.length; n < a; n++) {
                  var s = this.children[n];
                  if ((s.setUpdateType(this.childUpdateType), 0 !== s.updateType)) {
                    var o = this.clippingRect;
                    (!0 === this.rtt && (o = { x: 0, y: 0, width: 0, height: 0, valid: !1 }), s.update(e, o));
                  }
                }
              (this.parentHasRenderTexture && this.updateType > 0 && this.notifyParentRTTOfUpdate(),
                this.updateType & G.ZIndexSortedChildren && this.sortChildren(),
                i === _.OutOfBounds &&
                  (this.updateRenderState(i),
                  this.updateIsRenderable(),
                  !0 === this.rtt && i === _.OutOfBounds && this.notifyChildrenRTTOfUpdate(i)),
                (this.updateType = 0),
                (this.childUpdateType = 0));
            } else this.updateType &= ~G.RenderBounds;
          }
          findParentRTTNode() {
            for (var e = this.parent; e && !e.rtt; ) e = e.parent;
            return e;
          }
          getRTTParentRenderState() {
            var e = this.rttParent || this.findParentRTTNode();
            return e ? e.renderState : null;
          }
          notifyChildrenRTTOfUpdate(e) {
            var t,
              r = l(this.children);
            try {
              for (r.s(); !(t = r.n()).done; ) {
                var i = t.value;
                (i.updateRenderState(e), i.updateIsRenderable(), i.notifyChildrenRTTOfUpdate(e));
              }
            } catch (n) {
              r.e(n);
            } finally {
              r.f();
            }
          }
          notifyParentRTTOfUpdate() {
            if (null !== this.parent) {
              var e = this.rttParent || this.findParentRTTNode();
              e &&
                ((e.hasRTTupdates = !0),
                e.setUpdateType(G.RenderTexture),
                !0 === e.parentHasRenderTexture && e.notifyParentRTTOfUpdate());
            }
          }
          checkRenderBounds() {
            return (
              this.renderBound,
              this.strictBound,
              this.preloadBound,
              A(this.renderBound, this.strictBound)
                ? _.InViewport
                : A(this.renderBound, this.preloadBound)
                  ? _.InBounds
                  : ((e = this.renderBound),
                    (t = this.strictBound),
                    e.x1 < t.x1 && e.x2 > t.x2 && e.y1 < t.y1 && e.y2 > t.y2
                      ? _.InViewport
                      : null === this.parent || (0 !== this.props.width && 0 !== this.props.height)
                        ? _.OutOfBounds
                        : this.parent.renderState)
            );
            var e, t;
          }
          updateBoundingRect() {
            var e = this.sceneGlobalTransform || this.globalTransform,
              t = this.sceneRenderCoords || this.renderCoords,
              r = e.tb,
              i = e.tc,
              n = t.x1,
              a = t.y1,
              s = t.x3,
              o = t.y3;
            if (0 === r || 0 === i) this.renderBound = S(n, a, s, o, this.renderBound);
            else {
              var l = t.x2,
                u = t.x4,
                d = t.y2,
                h = t.y4;
              this.renderBound = S(
                Math.min(n, l, s, u),
                Math.min(a, d, o, h),
                Math.max(n, l, s, u),
                Math.max(a, d, o, h),
                this.renderBound,
              );
            }
          }
          createRenderBounds() {
            if ((this.stage, null !== this.parent && void 0 !== this.parent.strictBound)) {
              var e = this.parent.strictBound;
              ((this.strictBound = S(e.x1, e.y1, e.x2, e.y2)),
                (this.preloadBound = k(this.strictBound, this.boundsMargin)));
            } else
              ((this.strictBound = this.stage.strictBound), (this.preloadBound = this.stage.preloadBound));
            if (
              !1 !== this.props.clipping &&
              void 0 !== this.renderBound &&
              !1 !== A(this.renderBound, this.strictBound)
            ) {
              var t = this.props,
                r = t.x,
                i = t.y,
                n = t.width,
                a = t.height,
                s = this.sceneGlobalTransform || this.globalTransform || {},
                o = s.tx,
                l = s.ty,
                u = null != o ? o : r,
                d = null != l ? l : i;
              ((this.strictBound = S(u, d, u + n, d + a, this.strictBound)),
                (this.preloadBound = k(this.strictBound, this.boundsMargin)));
            }
          }
          updateRenderState(e) {
            if (e !== this.renderState) {
              var t = this.renderState;
              this.renderState = e;
              var r = V.get(e);
              this.emit(r, { previous: t, current: e });
            }
          }
          updateIsRenderable() {
            var e = !1,
              t = !1;
            if (!1 === this.checkBasicRenderability())
              return (this.updateTextureOwnership(!1), void this.setRenderable(!1));
            if (null !== this.texture) {
              if (this.texture.retryCount > this.texture.maxRetryCount)
                return (this.updateTextureOwnership(!1), void this.setRenderable(!1));
              ((t = !0), (e = "loaded" === this.texture.state));
            } else
              (!this.hasShader() && !0 !== this.hasColorProperties()) ||
                !0 !== this.hasDimensions() ||
                (this.stage.defaultTexture && "loaded" === this.stage.defaultTexture.state && (e = !0));
            (this.updateTextureOwnership(t), this.setRenderable(e));
          }
          checkBasicRenderability() {
            return 0 !== this.worldAlpha && !0 !== this.isOutOfBounds();
          }
          setRenderable(e) {
            this.isRenderable = e;
          }
          updateTextureOwnership(e) {
            var t;
            null === (t = this.texture) || void 0 === t || t.setRenderableOwner(this._id, e);
          }
          isOutOfBounds() {
            return this.renderState <= _.OutOfBounds;
          }
          hasDimensions() {
            return 0 !== this.props.width && 0 !== this.props.height;
          }
          hasColorProperties() {
            return (
              0 !== this.props.color ||
              0 !== this.props.colorTop ||
              0 !== this.props.colorBottom ||
              0 !== this.props.colorLeft ||
              0 !== this.props.colorRight ||
              0 !== this.props.colorTl ||
              0 !== this.props.colorTr ||
              0 !== this.props.colorBl ||
              0 !== this.props.colorBr
            );
          }
          hasShader() {
            return null !== this.props.shader;
          }
          calculateRenderCoords() {
            var e = this.width,
              t = this.height,
              r = this.globalTransform,
              i = r.tx,
              n = r.ty,
              a = r.ta,
              s = r.tb,
              o = r.tc,
              l = r.td;
            if (0 === s && 0 === o) {
              var u = i,
                d = i + e * a,
                h = n,
                c = n + t * l;
              this.renderCoords = D.translate(u, h, d, h, d, c, u, c, this.renderCoords);
            } else
              this.renderCoords = D.translate(
                i,
                n,
                i + e * a,
                n + e * o,
                i + e * a + t * s,
                n + e * o + t * l,
                i + t * s,
                n + t * l,
                this.renderCoords,
              );
            if (void 0 !== this.sceneGlobalTransform) {
              var f = this.sceneGlobalTransform,
                p = f.tx,
                g = f.ty,
                m = f.ta,
                v = f.tb,
                y = f.tc,
                T = f.td;
              if (0 === v && 0 === y) {
                var b = p,
                  S = p + e * m,
                  E = g,
                  x = g + t * T;
                this.sceneRenderCoords = D.translate(b, E, S, E, S, x, b, x, this.sceneRenderCoords);
              } else
                this.sceneRenderCoords = D.translate(
                  p,
                  g,
                  p + e * m,
                  g + e * y,
                  p + e * m + t * v,
                  g + e * y + t * T,
                  p + t * v,
                  g + t * T,
                  this.sceneRenderCoords,
                );
            }
          }
          calculateClippingRect(e) {
            this.globalTransform;
            var t = this.clippingRect,
              r = this.props,
              i = this.globalTransform,
              n = r.clipping,
              a = 0 !== i.tb || 0 !== i.tc;
            (!0 === n && !1 === a
              ? ((t.x = i.tx),
                (t.y = i.ty),
                (t.width = this.width * i.ta),
                (t.height = this.height * i.td),
                (t.valid = !0))
              : (t.valid = !1),
              !0 === e.valid && !0 === t.valid ? x(e, t, t) : !0 === e.valid && (w(e, t), (t.valid = !0)));
          }
          calculateZIndex() {
            var e,
              t,
              r = this.props,
              i = r.zIndex || 0,
              n = (null === (e = r.parent) || void 0 === e ? void 0 : e.zIndex) || 0,
              a = i;
            (null !== (t = r.parent) && void 0 !== t && t.zIndexLocked && (a = i < n ? i : n),
              (this.calcZIndex = a));
          }
          destroy() {
            if (!0 !== this.destroyed) {
              for (
                this.destroyed = !0,
                  this.unloadTexture(),
                  this.clippingRect.valid = !1,
                  this.isRenderable = !1,
                  this.renderCoords = void 0,
                  this.renderBound = void 0,
                  this.strictBound = void 0,
                  this.preloadBound = void 0,
                  this.globalTransform = void 0,
                  this.scaleRotateTransform = void 0,
                  this.localTransform = void 0,
                  this.props.texture = null,
                  this.props.shader = this.stage.defShaderCtr;
                this.children.length > 0;
              ) {
                var e;
                null === (e = this.children[0]) || void 0 === e || e.destroy();
              }
              ((this.parent = null),
                this.rtt && this.stage.renderer.removeRTTNode(this),
                this.removeAllListeners());
            }
          }
          renderQuads(e) {
            if (this.parentHasRenderTexture) {
              if (!e.renderToTextureActive) return;
              if (this.parentRenderTexture !== e.activeRttNode) return;
            }
            (this.globalTransform,
              this.renderCoords,
              e.addQuad({
                width: this.props.width,
                height: this.props.height,
                colorTl: this.premultipliedColorTl,
                colorTr: this.premultipliedColorTr,
                colorBl: this.premultipliedColorBl,
                colorBr: this.premultipliedColorBr,
                texture: this.texture || this.stage.defaultTexture,
                textureOptions: this.textureOptions,
                zIndex: this.zIndex,
                shader: this.shader.shader,
                shaderProps: this.shader.getResolvedProps(),
                alpha: this.worldAlpha,
                clippingRect: this.clippingRect,
                tx: this.globalTransform.tx,
                ty: this.globalTransform.ty,
                ta: this.globalTransform.ta,
                tb: this.globalTransform.tb,
                tc: this.globalTransform.tc,
                td: this.globalTransform.td,
                renderCoords: this.renderCoords,
                rtt: this.rtt,
                parentHasRenderTexture: this.parentHasRenderTexture,
                framebufferDimensions: this.framebufferDimensions,
              }));
          }
          get id() {
            return this._id;
          }
          get data() {
            return this.props.data;
          }
          set data(e) {
            this.props.data = e;
          }
          get x() {
            return this.props.x;
          }
          set x(e) {
            this.props.x !== e && ((this.props.x = e), this.setUpdateType(G.Local));
          }
          get absX() {
            var e, t;
            return (
              this.props.x +
              -this.props.width * this.props.mountX +
              ((null === (e = this.props.parent) || void 0 === e ? void 0 : e.absX) ||
                (null === (t = this.props.parent) ||
                void 0 === t ||
                null === (t = t.globalTransform) ||
                void 0 === t
                  ? void 0
                  : t.tx) ||
                0)
            );
          }
          get absY() {
            var e, t;
            return (
              this.props.y +
              -this.props.height * this.props.mountY +
              (null !== (e = null === (t = this.props.parent) || void 0 === t ? void 0 : t.absY) &&
              void 0 !== e
                ? e
                : 0)
            );
          }
          get y() {
            return this.props.y;
          }
          set y(e) {
            this.props.y !== e && ((this.props.y = e), this.setUpdateType(G.Local));
          }
          get width() {
            return this.props.width;
          }
          set width(e) {
            this.props.width !== e &&
              ((this.props.width = e),
              this.setUpdateType(G.Local),
              this.props.rtt &&
                ((this.texture = this.stage.txManager.createTexture("RenderTexture", {
                  width: this.width,
                  height: this.height,
                })),
                this.setUpdateType(G.RenderTexture)));
          }
          get height() {
            return this.props.height;
          }
          set height(e) {
            this.props.height !== e &&
              ((this.props.height = e),
              this.setUpdateType(G.Local),
              this.props.rtt &&
                ((this.texture = this.stage.txManager.createTexture("RenderTexture", {
                  width: this.width,
                  height: this.height,
                })),
                this.setUpdateType(G.RenderTexture)));
          }
          get scale() {
            return this.scaleX;
          }
          set scale(e) {
            ((this.scaleX = e), (this.scaleY = e));
          }
          get scaleX() {
            return this.props.scaleX;
          }
          set scaleX(e) {
            this.props.scaleX !== e && ((this.props.scaleX = e), this.setUpdateType(G.ScaleRotate));
          }
          get scaleY() {
            return this.props.scaleY;
          }
          set scaleY(e) {
            this.props.scaleY !== e && ((this.props.scaleY = e), this.setUpdateType(G.ScaleRotate));
          }
          get mount() {
            return this.props.mount;
          }
          set mount(e) {
            (this.props.mountX === e && this.props.mountY === e) ||
              ((this.props.mountX = e),
              (this.props.mountY = e),
              (this.props.mount = e),
              this.setUpdateType(G.Local));
          }
          get mountX() {
            return this.props.mountX;
          }
          set mountX(e) {
            this.props.mountX !== e && ((this.props.mountX = e), this.setUpdateType(G.Local));
          }
          get mountY() {
            return this.props.mountY;
          }
          set mountY(e) {
            this.props.mountY !== e && ((this.props.mountY = e), this.setUpdateType(G.Local));
          }
          get pivot() {
            return this.props.pivot;
          }
          set pivot(e) {
            (this.props.pivotX === e && this.props.pivotY === e) ||
              ((this.props.pivotX = e),
              (this.props.pivotY = e),
              (this.props.pivot = e),
              this.setUpdateType(G.Local));
          }
          get pivotX() {
            return this.props.pivotX;
          }
          set pivotX(e) {
            this.props.pivotX !== e && ((this.props.pivotX = e), this.setUpdateType(G.Local));
          }
          get pivotY() {
            return this.props.pivotY;
          }
          set pivotY(e) {
            this.props.pivotY !== e && ((this.props.pivotY = e), this.setUpdateType(G.Local));
          }
          get rotation() {
            return this.props.rotation;
          }
          set rotation(e) {
            this.props.rotation !== e && ((this.props.rotation = e), this.setUpdateType(G.ScaleRotate));
          }
          get alpha() {
            return this.props.alpha;
          }
          set alpha(e) {
            ((this.props.alpha = e),
              this.setUpdateType(G.PremultipliedColors | G.WorldAlpha | G.Children | G.IsRenderable),
              (this.childUpdateType |= G.WorldAlpha));
          }
          get autosize() {
            return this.props.autosize;
          }
          set autosize(e) {
            this.props.autosize = e;
          }
          get boundsMargin() {
            var e, t, r;
            return null !==
              (e =
                null !== (t = this.props.boundsMargin) && void 0 !== t
                  ? t
                  : null === (r = this.parent) || void 0 === r
                    ? void 0
                    : r.boundsMargin) && void 0 !== e
              ? e
              : this.stage.boundsMargin;
          }
          set boundsMargin(e) {
            if (e !== this.props.boundsMargin) {
              if (null === e) this.props.boundsMargin = e;
              else {
                var t = Array.isArray(e) ? e : [e, e, e, e];
                this.props.boundsMargin = t;
              }
              this.setUpdateType(G.RenderBounds);
            }
          }
          get clipping() {
            return this.props.clipping;
          }
          set clipping(e) {
            ((this.props.clipping = e),
              this.setUpdateType(G.Clipping | G.RenderBounds | G.Children),
              (this.childUpdateType |= G.Global | G.Clipping));
          }
          get color() {
            return this.props.color;
          }
          set color(e) {
            ((this.colorTop = e),
              (this.colorBottom = e),
              (this.colorLeft = e),
              (this.colorRight = e),
              (this.props.color = e),
              this.setUpdateType(G.PremultipliedColors));
          }
          get colorTop() {
            return this.props.colorTop;
          }
          set colorTop(e) {
            ((this.props.colorTl === e && this.props.colorTr === e) ||
              ((this.colorTl = e), (this.colorTr = e)),
              (this.props.colorTop = e),
              this.setUpdateType(G.PremultipliedColors));
          }
          get colorBottom() {
            return this.props.colorBottom;
          }
          set colorBottom(e) {
            ((this.props.colorBl === e && this.props.colorBr === e) ||
              ((this.colorBl = e), (this.colorBr = e)),
              (this.props.colorBottom = e),
              this.setUpdateType(G.PremultipliedColors));
          }
          get colorLeft() {
            return this.props.colorLeft;
          }
          set colorLeft(e) {
            ((this.props.colorTl === e && this.props.colorBl === e) ||
              ((this.colorTl = e), (this.colorBl = e)),
              (this.props.colorLeft = e),
              this.setUpdateType(G.PremultipliedColors));
          }
          get colorRight() {
            return this.props.colorRight;
          }
          set colorRight(e) {
            ((this.props.colorTr === e && this.props.colorBr === e) ||
              ((this.colorTr = e), (this.colorBr = e)),
              (this.props.colorRight = e),
              this.setUpdateType(G.PremultipliedColors));
          }
          get colorTl() {
            return this.props.colorTl;
          }
          set colorTl(e) {
            ((this.props.colorTl = e), this.setUpdateType(G.PremultipliedColors));
          }
          get colorTr() {
            return this.props.colorTr;
          }
          set colorTr(e) {
            ((this.props.colorTr = e), this.setUpdateType(G.PremultipliedColors));
          }
          get colorBl() {
            return this.props.colorBl;
          }
          set colorBl(e) {
            ((this.props.colorBl = e), this.setUpdateType(G.PremultipliedColors));
          }
          get colorBr() {
            return this.props.colorBr;
          }
          set colorBr(e) {
            ((this.props.colorBr = e), this.setUpdateType(G.PremultipliedColors));
          }
          get zIndexLocked() {
            return this.props.zIndexLocked || 0;
          }
          set zIndexLocked(e) {
            ((this.props.zIndexLocked = e), this.setUpdateType(G.CalculatedZIndex | G.Children));
            for (var t = 0, r = this.children.length; t < r; t++)
              this.children[t].setUpdateType(G.CalculatedZIndex);
          }
          get zIndex() {
            return this.props.zIndex;
          }
          set zIndex(e) {
            ((this.props.zIndex = e), this.setUpdateType(G.CalculatedZIndex | G.Children));
            for (var t = 0, r = this.children.length; t < r; t++)
              this.children[t].setUpdateType(G.CalculatedZIndex);
          }
          get parent() {
            return this.props.parent;
          }
          set parent(e) {
            var t = this.props.parent;
            if (t !== e) {
              if (((this.props.parent = e), t)) {
                var r = t.children.indexOf(this);
                (t.children.splice(r, 1), t.setUpdateType(G.Children | G.ZIndexSortedChildren));
              }
              (e &&
                (e.children.push(this),
                this.setUpdateType(G.All),
                e.setUpdateType(G.Children | G.ZIndexSortedChildren),
                (e.rtt || e.parentHasRenderTexture) && this.applyRTTInheritance(e)),
                this.updateScaleRotateTransform(),
                this.setUpdateType(G.RenderBounds | G.Children));
            }
          }
          get preventCleanup() {
            return this.props.textureOptions.preventCleanup || !1;
          }
          set preventCleanup(e) {
            this.props.textureOptions.preventCleanup = e;
          }
          get rtt() {
            return this.props.rtt;
          }
          set rtt(e) {
            this.props.rtt !== e &&
              ((this.props.rtt = e),
              !0 === e ? (this.initRenderTexture(), this.markChildrenWithRTT()) : this.cleanupRenderTexture(),
              this.setUpdateType(G.RenderTexture),
              !0 === this.parentHasRenderTexture && this.notifyParentRTTOfUpdate());
          }
          initRenderTexture() {
            ((this.texture = this.stage.txManager.createTexture("RenderTexture", {
              width: this.width,
              height: this.height,
            })),
              this.stage.renderer.renderToTexture(this));
          }
          cleanupRenderTexture() {
            (this.unloadTexture(),
              this.clearRTTInheritance(),
              (this.hasRTTupdates = !1),
              (this.texture = null));
          }
          markChildrenWithRTT(e = null) {
            var t,
              r = l((e || this).children);
            try {
              for (r.s(); !(t = r.n()).done; ) {
                var i = t.value;
                (i.setUpdateType(G.All), (i.parentHasRenderTexture = !0), i.markChildrenWithRTT());
              }
            } catch (n) {
              r.e(n);
            } finally {
              r.f();
            }
          }
          applyRTTInheritance(e) {
            (e.rtt && e.setUpdateType(G.RenderTexture), this.markChildrenWithRTT(e));
          }
          clearRTTInheritance() {
            if (!this.rtt) {
              var e,
                t = l(this.children);
              try {
                for (t.s(); !(e = t.n()).done; ) {
                  var r = e.value;
                  ((r.parentHasRenderTexture = !1),
                    (r.rttParent = null),
                    r.setUpdateType(G.All),
                    r.clearRTTInheritance());
                }
              } catch (i) {
                t.e(i);
              } finally {
                t.f();
              }
            }
          }
          get shader() {
            return this.props.shader;
          }
          set shader(e) {
            this.props.shader !== e && ((this.props.shader = e), this.setUpdateType(G.IsRenderable));
          }
          get src() {
            return this.props.src;
          }
          set src(e) {
            this.props.src !== e &&
              ((this.props.src = e),
              (this.texture = e
                ? this.stage.txManager.createTexture("ImageTexture", {
                    src: e,
                    width: this.props.width,
                    height: this.props.height,
                    type: this.props.imageType,
                    sx: this.props.srcX,
                    sy: this.props.srcY,
                    sw: this.props.srcWidth,
                    sh: this.props.srcHeight,
                    maxRetryCount: this.props.textureOptions.maxRetryCount,
                  })
                : null));
          }
          set imageType(e) {
            this.props.imageType !== e && (this.props.imageType = e);
          }
          get imageType() {
            return this.props.imageType || null;
          }
          get srcHeight() {
            return this.props.srcHeight;
          }
          set srcHeight(e) {
            this.props.srcHeight = e;
          }
          get srcWidth() {
            return this.props.srcWidth;
          }
          set srcWidth(e) {
            this.props.srcWidth = e;
          }
          get srcX() {
            return this.props.srcX;
          }
          set srcX(e) {
            this.props.srcX = e;
          }
          get srcY() {
            return this.props.srcY;
          }
          set srcY(e) {
            this.props.srcY = e;
          }
          get framebufferDimensions() {
            return this.parentHasRenderTexture && !this.rtt && this.parent
              ? this.parent.framebufferDimensions
              : { width: this.width, height: this.height };
          }
          get parentRenderTexture() {
            for (var e = this.parent; e; ) {
              if (e.rtt) return e;
              e = e.parent;
            }
            return null;
          }
          get texture() {
            return this.props.texture;
          }
          set texture(e) {
            this.props.texture !== e &&
              (this.props.texture && this.unloadTexture(),
              (this.props.texture = e),
              null !== e && (e.setRenderableOwner(this._id, this.isRenderable), this.loadTexture()),
              this.setUpdateType(G.IsRenderable));
          }
          set textureOptions(e) {
            this.props.textureOptions = e;
          }
          get textureOptions() {
            return this.props.textureOptions;
          }
          get strictBounds() {
            return this.props.strictBounds;
          }
          set strictBounds(e) {
            e !== this.props.strictBounds &&
              ((this.props.strictBounds = e),
              this.setUpdateType(G.RenderBounds | G.Children),
              (this.childUpdateType |= G.RenderBounds | G.Children));
          }
          set interactive(e) {
            ((this.props.interactive = e), !0 === e && this.stage.interactiveNodes.add(this));
          }
          get interactive() {
            return this.props.interactive;
          }
          animate(e, t) {
            var r = new $(this, e, t);
            return new j(this.stage.animationManager, r);
          }
          flush() {}
        }
        var K = () => (performance ? performance.now() : Date.now());
        class W {
          constructor() {
            o(this, "activeAnimations", new Set());
          }
          registerAnimation(e) {
            this.activeAnimations.add(e);
          }
          unregisterAnimation(e) {
            this.activeAnimations.delete(e);
          }
          update(e) {
            this.activeAnimations.forEach(t => {
              t.update(e);
            });
          }
        }
        function z() {
          self.onmessage = e => {
            var t = e.data.src,
              r = e.data.id,
              i = e.data.premultiplyAlpha;
            (e.data.sx,
              e.data.sy,
              e.data.sw,
              e.data.sh,
              (function (e, t) {
                return new Promise(function (r, i) {
                  var n = new XMLHttpRequest();
                  (n.open("GET", e, !0),
                    (n.responseType = "blob"),
                    (n.onload = function () {
                      if (200 !== n.status && 0 !== n.status)
                        return i(new Error("Failed to load image: " + n.statusText));
                      var e = n.response;
                      (void 0 !== t || e.type.indexOf("image/png"),
                        createImageBitmap(e)
                          .then(function (e) {
                            r({ data: e, premultiplyAlpha: t });
                          })
                          .catch(function (e) {
                            i(e);
                          }));
                    }),
                    (n.onerror = function () {
                      i(new Error("Network error occurred while trying to fetch the image."));
                    }),
                    n.send());
                });
              })(t, i)
                .then(function (e) {
                  self.postMessage({ id: r, src: t, data: e }, [e.data]);
                })
                .catch(function (e) {
                  self.postMessage({ id: r, src: t, error: e.message });
                }));
          };
        }
        class q {
          constructor(e, t) {
            (o(this, "imageWorkersEnabled", !0),
              o(this, "messageManager", {}),
              o(this, "workers", []),
              o(this, "workerIndex", 0),
              o(this, "nextId", 0),
              (this.workers = this.createWorkers(e, t)),
              this.workers.forEach(e => {
                e.onmessage = this.handleMessage.bind(this);
              }));
          }
          handleMessage(e) {
            var t = e.data,
              i = t.id,
              n = t.data,
              a = t.error,
              s = this.messageManager[i];
            if (s) {
              var o = r(s, 2),
                l = o[0],
                u = o[1];
              (delete this.messageManager[i], a ? u(new Error(a)) : l(n));
            }
          }
          createWorkers(e = 1, t) {
            var r = `(${z.toString()})()`;
            (!0 === t.options &&
              (r = r.replace(
                "var supportsOptionsCreateImageBitmap = false;",
                "var supportsOptionsCreateImageBitmap = true;",
              )),
              !0 === t.full &&
                (r = (r = r.replace(
                  "var supportsOptionsCreateImageBitmap = false;",
                  "var supportsOptionsCreateImageBitmap = true;",
                )).replace(
                  "var supportsFullCreateImageBitmap = false;",
                  "var supportsFullCreateImageBitmap = true;",
                )),
              (r = r.replace('"use strict";', "")));
            for (
              var i = new Blob([r], { type: "application/javascript" }),
                n = (self.URL ? URL : webkitURL).createObjectURL(i),
                a = [],
                s = 0;
              s < e;
              s++
            )
              a.push(new Worker(n));
            return a;
          }
          getNextWorker() {
            var e = this.workers[this.workerIndex];
            return ((this.workerIndex = (this.workerIndex + 1) % this.workers.length), e);
          }
          getImage(e, t, r, i, n, a) {
            return new Promise((s, o) => {
              try {
                if (this.workers) {
                  var l = this.nextId++;
                  this.messageManager[l] = [s, o];
                  var u = this.getNextWorker();
                  u && u.postMessage({ id: l, src: e, premultiplyAlpha: t, sx: r, sy: i, sw: n, sh: a });
                }
              } catch (d) {
                o(d);
              }
            });
          }
        }
        class X extends y {
          constructor(e, t) {
            (super(e),
              o(this, "type", m.color),
              o(this, "props", void 0),
              (this.props = X.resolveDefaults(t)));
          }
          get color() {
            return this.props.color;
          }
          set color(e) {
            this.props.color = e;
          }
          getTextureSource() {
            var e = this;
            return s(
              i().m(function t() {
                var r;
                return i().w(function (t) {
                  for (;;)
                    if (0 === t.n)
                      return (
                        (r = new Uint8Array(4)),
                        4294967295 === e.color
                          ? ((r[0] = 255), (r[1] = 255), (r[2] = 255), (r[3] = 255))
                          : ((r[0] = (e.color >> 16) & 255),
                            (r[1] = (e.color >> 8) & 255),
                            (r[2] = 255 & e.color),
                            (r[3] = (e.color >>> 24) & 255)),
                        t.a(2, { data: r, premultiplyAlpha: !0 })
                      );
                }, t);
              }),
            )();
          }
          static makeCacheKey(e) {
            return `ColorTexture,${X.resolveDefaults(e).color}`;
          }
          static resolveDefaults(e) {
            return { color: e.color || 4294967295 };
          }
        }
        o(X, "z$__type__Props", void 0);
        var Y = {
            0: 35841,
            1: 35843,
            2: 35840,
            3: 35842,
            6: 36196,
            7: 33776,
            8: 33778,
            9: 33778,
            10: 33779,
            11: 33779,
          },
          Q = { "4x4": 37808, "5x5": 37809, "6x6": 37810, "8x8": 37811, "10x10": 37812, "12x12": 37813 },
          J = [171, 75, 84, 88, 32, 49, 49, 187, 13, 10, 26, 10],
          Z = (function () {
            var e = s(
              i().m(function e(t) {
                var r, n, a, s, o, l, u;
                return i().w(
                  function (e) {
                    for (;;)
                      switch ((e.p = e.n)) {
                        case 0:
                          return ((e.p = 0), (e.n = 1), fetch(t));
                        case 1:
                          if ((r = e.v).ok) {
                            e.n = 2;
                            break;
                          }
                          throw new Error(`Failed to fetch compressed texture: ${r.status} ${r.statusText}`);
                        case 2:
                          return ((e.n = 3), r.arrayBuffer());
                        case 3:
                          if (!((n = e.v).byteLength < 16)) {
                            e.n = 4;
                            break;
                          }
                          throw new Error(
                            `File too small to be a valid compressed texture (${n.byteLength} bytes). Expected at least 16 bytes for header inspection.`,
                          );
                        case 4:
                          if (((a = new DataView(n)), 55727696 !== (s = a.getUint32(0, !0)))) {
                            e.n = 5;
                            break;
                          }
                          return e.a(2, ne(a));
                        case 5:
                          if (1554098963 !== s) {
                            e.n = 6;
                            break;
                          }
                          return e.a(2, te(a));
                        case 6:
                          ((o = !0), (l = 0));
                        case 7:
                          if (!(l < J.length)) {
                            e.n = 9;
                            break;
                          }
                          if (a.getUint8(l) === J[l]) {
                            e.n = 8;
                            break;
                          }
                          return ((o = !1), e.a(3, 9));
                        case 8:
                          (l++, (e.n = 7));
                          break;
                        case 9:
                          if (!0 !== o) {
                            e.n = 10;
                            break;
                          }
                          return e.a(2, re(a));
                        case 10:
                          throw new Error("Unrecognized compressed texture format");
                        case 11:
                          e.n = 13;
                          break;
                        case 12:
                          throw (
                            (e.p = 12),
                            (u = e.v),
                            new Error(`Failed to load compressed texture from ${t}: ${u}`)
                          );
                        case 13:
                          return e.a(2);
                      }
                  },
                  e,
                  null,
                  [[0, 12]],
                );
              }),
            );
            return function (t) {
              return e.apply(this, arguments);
            };
          })();
        function ee(e, t) {
          return e.getUint8(t) + (e.getUint8(t + 1) << 8) + (e.getUint8(t + 2) << 16);
        }
        var te = (function () {
            var e = s(
              i().m(function e(t) {
                var r, n, a, s, o, l, u, d, h;
                return i().w(function (e) {
                  for (;;)
                    switch (e.n) {
                      case 0:
                        if (
                          ((r = t.getUint8(4)),
                          (n = t.getUint8(5)),
                          (a = ee(t, 7)),
                          (s = ee(t, 10)),
                          0 !== a && 0 !== s)
                        ) {
                          e.n = 1;
                          break;
                        }
                        throw new Error(`Invalid ASTC texture dimensions: ${a}x${s}`);
                      case 1:
                        if (
                          ((o = Math.ceil(a / r) * Math.ceil(s / n) * 16), (l = t.byteLength - 16), o === l)
                        ) {
                          e.n = 2;
                          break;
                        }
                        throw new Error(`Invalid ASTC texture data size: expected ${o}, got ${l}`);
                      case 2:
                        if (void 0 !== (u = Q[`${r}x${n}`])) {
                          e.n = 3;
                          break;
                        }
                        throw new Error(`Unsupported ASTC block size: ${r}x${n}`);
                      case 3:
                        return (
                          (d = t.buffer),
                          (h = []).push(d.slice(16)),
                          e.a(2, {
                            data: {
                              blockInfo: fe[u],
                              glInternalFormat: u,
                              mipmaps: h,
                              width: a,
                              height: s,
                              type: "astc",
                            },
                            premultiplyAlpha: !1,
                          })
                        );
                    }
                }, e);
              }),
            );
            return function (t) {
              return e.apply(this, arguments);
            };
          })(),
          re = (function () {
            var e = s(
              i().m(function e(t) {
                var r, n, a, s, o, l, u, d, h, c, f, p, g, m, v;
                return i().w(function (e) {
                  for (;;)
                    switch (e.n) {
                      case 0:
                        if (((r = t.getUint32(12, !0)), !1 !== (n = 67305985 === r) || 16909060 === r)) {
                          e.n = 1;
                          break;
                        }
                        throw new Error("Invalid KTX endianness value");
                      case 1:
                        if (((a = t.getUint32(16, n)), (s = t.getUint32(24, n)), 0 === a && 0 === s)) {
                          e.n = 2;
                          break;
                        }
                        throw new Error(`KTX texture is not compressed (glType: ${a}, glFormat: ${s})`);
                      case 2:
                        if (((o = t.getUint32(28, n)), void 0 !== fe[o])) {
                          e.n = 3;
                          break;
                        }
                        throw new Error(`Unsupported KTX compressed texture format: 0x${o.toString(16)}`);
                      case 3:
                        if (((l = t.getUint32(36, n)), (u = t.getUint32(40, n)), 0 !== l && 0 !== u)) {
                          e.n = 4;
                          break;
                        }
                        throw new Error(`Invalid KTX texture dimensions: ${l}x${u}`);
                      case 4:
                        if (0 !== (d = t.getUint32(56, n))) {
                          e.n = 5;
                          break;
                        }
                        throw new Error("KTX texture has no mipmap levels");
                      case 5:
                        if (
                          ((h = t.getUint32(60, n)), (c = []), (f = t.buffer), !((p = 64 + h) > t.byteLength))
                        ) {
                          e.n = 6;
                          break;
                        }
                        throw new Error("Invalid KTX file: key/value data exceeds file size");
                      case 6:
                        for (g = 0; g < d; g++)
                          ((m = t.getUint32(p, n)),
                            (v = (p += 4) + m),
                            c.push(f.slice(p, v)),
                            (p = v) % 4 != 0 && (p += 4 - (p % 4)));
                        return e.a(2, {
                          data: {
                            blockInfo: fe[o],
                            glInternalFormat: o,
                            mipmaps: c,
                            width: l,
                            height: u,
                            type: "ktx",
                          },
                          premultiplyAlpha: !1,
                        });
                    }
                }, e);
              }),
            );
            return function (t) {
              return e.apply(this, arguments);
            };
          })();
        function ie(e, t, r) {
          var i = 2 === r ? 16 : 8;
          return (Math.max(e, i) * Math.max(t, 8) * r) / 8;
        }
        var ne = (function () {
            var e = s(
              i().m(function e(t) {
                var r, n, a, s, o, l, u, d, h, c, f, p, g, m, v, y, T, b, S;
                return i().w(function (e) {
                  for (;;)
                    switch (e.n) {
                      case 0:
                        if (((r = t.getUint32(8, !0)), void 0 !== (n = Y[r]))) {
                          e.n = 1;
                          break;
                        }
                        throw new Error(`Unsupported PVR pixel format: 0x${r.toString(16)}`);
                      case 1:
                        if (((a = t.getInt32(24, !0)), 0 !== (s = t.getInt32(28, !0)) && 0 !== a)) {
                          e.n = 2;
                          break;
                        }
                        throw new Error(`Invalid PVR texture dimensions: ${s}x${a}`);
                      case 2:
                        if (
                          ((o = t.getInt32(44, !0)),
                          (l = t.getUint32(48, !0)),
                          (u = t.buffer),
                          !((d = 52 + l) > u.byteLength))
                        ) {
                          e.n = 3;
                          break;
                        }
                        throw new Error("Invalid PVR file: metadata exceeds file size");
                      case 3:
                        ((h = []), (c = fe[n]), (f = 0));
                      case 4:
                        if (!(f < o)) {
                          e.n = 8;
                          break;
                        }
                        if (((p = t.getUint32(d, !0)), (g = u.byteLength - (d + 4)), !(p > 0 && p <= g))) {
                          e.n = 5;
                          break;
                        }
                        return (
                          (m = d += 4),
                          (v = d + p),
                          h.push(u.slice(m, v)),
                          (d = ((d = v) + 3) & -4),
                          e.a(3, 7)
                        );
                      case 5:
                        if (0 !== r && 1 !== r && 2 !== r && 3 !== r) {
                          e.n = 6;
                          break;
                        }
                        return (
                          (y = ie(s >> f, a >> f, 0 === r || 1 === r ? 2 : 4)),
                          h.push(u.slice(d, d + y)),
                          (d = ((d += y) + 3) & -4),
                          e.a(3, 7)
                        );
                      case 6:
                        void 0 !== c &&
                          ((T = Math.ceil((s >> f) / c.width)),
                          (b = Math.ceil((a >> f) / c.height)),
                          (S = T * b * c.bytes),
                          h.push(u.slice(d, d + S)),
                          (d = ((d += S) + 3) & -4));
                      case 7:
                        (f++, (e.n = 4));
                        break;
                      case 8:
                        return e.a(2, {
                          data: {
                            blockInfo: fe[n],
                            glInternalFormat: n,
                            mipmaps: h,
                            width: s,
                            height: a,
                            type: "pvr",
                          },
                          premultiplyAlpha: !1,
                        });
                    }
                }, e);
              }),
            );
            return function (t) {
              return e.apply(this, arguments);
            };
          })(),
          ae = { width: 4, height: 4, bytes: 8 },
          se = { width: 4, height: 4, bytes: 16 },
          oe = { width: 5, height: 5, bytes: 16 },
          le = { width: 6, height: 6, bytes: 16 },
          ue = { width: 8, height: 4, bytes: 8 },
          de = { width: 8, height: 8, bytes: 16 },
          he = { width: 10, height: 10, bytes: 16 },
          ce = { width: 12, height: 12, bytes: 16 },
          fe = {
            33776: ae,
            33777: ae,
            33778: se,
            33779: se,
            36196: ae,
            37492: ae,
            37493: ae,
            37496: se,
            37497: se,
            35840: ae,
            35842: ae,
            35841: ue,
            35843: ue,
            37808: se,
            37840: se,
            37809: oe,
            37841: oe,
            37810: le,
            37842: le,
            37811: de,
            37843: de,
            37812: he,
            37844: he,
            37813: ce,
            37845: ce,
          },
          pe = {
            ktx: function (e, t, r) {
              var i = r.glInternalFormat,
                n = r.mipmaps,
                a = r.width,
                s = r.height,
                o = r.blockInfo;
              e.bindTexture(t);
              for (var l = o.width, u = o.height, d = a, h = s, c = 0; c < n.length; c++) {
                var f = new Uint8Array(n[c]),
                  p = Math.ceil(d / l) * l,
                  g = Math.ceil(h / u) * u,
                  m = Math.ceil(d / l) * Math.ceil(h / u) * o.bytes;
                if (f.byteLength < m) {
                  var v = new Uint8Array(m);
                  (v.set(f), (f = v));
                }
                (e.compressedTexImage2D(c, i, p, g, 0, f),
                  (d = Math.max(1, d >> 1)),
                  (h = Math.max(1, h >> 1)));
              }
              (e.texParameteri(e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_MAG_FILTER, e.LINEAR),
                e.texParameteri(e.TEXTURE_MIN_FILTER, n.length > 1 ? e.LINEAR_MIPMAP_LINEAR : e.LINEAR));
            },
            pvr: function (e, t, r) {
              var i = r.glInternalFormat,
                n = r.mipmaps,
                a = r.width,
                s = r.height;
              e.bindTexture(t);
              for (var o = a, l = s, u = 0; u < n.length; u++)
                (e.compressedTexImage2D(u, i, o, l, 0, new Uint8Array(n[u])),
                  (o = Math.max(1, o >> 1)),
                  (l = Math.max(1, l >> 1)));
              (e.texParameteri(e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_MAG_FILTER, e.LINEAR),
                e.texParameteri(e.TEXTURE_MIN_FILTER, n.length > 1 ? e.LINEAR_MIPMAP_LINEAR : e.LINEAR));
            },
            astc: function (e, t, r) {
              if (null === e.getExtension("WEBGL_compressed_texture_astc"))
                throw new Error("ASTC compressed textures not supported by this device");
              e.bindTexture(t);
              var i = r.glInternalFormat,
                n = r.mipmaps,
                a = r.width,
                s = r.height,
                o = new Uint8Array(n[0]);
              (e.compressedTexImage2D(0, i, a, s, 0, o),
                e.texParameteri(e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_MAG_FILTER, e.LINEAR),
                e.texParameteri(e.TEXTURE_MIN_FILTER, e.LINEAR));
            },
          };
        var ge = (e, t, r, i, n, a, s) =>
          new Promise((o, l) => {
            var u = document.createElement("canvas"),
              d = u.getContext("2d");
            d.imageSmoothingEnabled = !0;
            var h = new Image();
            ((h.onload = () => {
              var e = null != i ? i : 0,
                l = null != n ? n : 0,
                c = t || h.width,
                f = r || h.height;
              ((u.width = c),
                (u.height = f),
                d.drawImage(h, 0, 0, c, f),
                o({
                  data: d.getImageData(e, l, null != a ? a : c, null != s ? s : f),
                  premultiplyAlpha: !1,
                }));
            }),
              (h.onerror = e => {
                l(e);
              }),
              (h.src = e));
          });
        function me(e, t = "") {
          return new Promise((r, i) => {
            var n = new XMLHttpRequest();
            ((n.responseType = t),
              (n.onreadystatechange = function () {
                n.readyState == XMLHttpRequest.DONE &&
                  (0 === n.status || 200 === n.status ? r(n.response) : i(n.statusText));
              }),
              n.open("GET", e, !0),
              n.send(null));
          });
        }
        class ve extends y {
          constructor(e, t) {
            var r,
              i = ve.resolveDefaults(t);
            (super(e),
              o(this, "type", m.image),
              o(this, "props", void 0),
              (this.props = i),
              (this.maxRetryCount =
                null !== (r = i.maxRetryCount) && void 0 !== r ? r : this.txManager.maxRetryCount));
          }
          hasAlphaChannel(e) {
            return -1 !== e.indexOf("image/png");
          }
          loadImageFallback(e, t) {
            return s(
              i().m(function r() {
                var n;
                return i().w(function (r) {
                  for (;;)
                    if (0 === r.n)
                      return (
                        (n = new Image()),
                        "string" == typeof e && !1 === R(e) && (n.crossOrigin = "anonymous"),
                        r.a(
                          2,
                          new Promise((r, i) => {
                            ((n.onload = () => {
                              r({ data: n, premultiplyAlpha: t });
                            }),
                              (n.onerror = e => {
                                var t =
                                  e instanceof Error
                                    ? e.message
                                    : e instanceof Event
                                      ? `Image loading failed for ${n.src}`
                                      : "Unknown image loading error";
                                i(new Error(`Image loading failed: ${t}`));
                              }),
                              e instanceof Blob ? (n.src = URL.createObjectURL(e)) : (n.src = e));
                          }),
                        )
                      );
                }, r);
              }),
            )();
          }
          createImageBitmap(e, t, r, n, a, o) {
            var l = this;
            return s(
              i().m(function s() {
                var u, d, h, c, f, p, g, m, v;
                return i().w(
                  function (i) {
                    for (;;)
                      switch ((i.p = i.n)) {
                        case 0:
                          if (
                            ((u = null != t ? t : e.type.includes("image/png")),
                            !0 !== (d = l.txManager.imageBitmapSupported).full || null === a || null === o)
                          ) {
                            i.n = 4;
                            break;
                          }
                          return (
                            (i.p = 1),
                            (i.n = 2),
                            createImageBitmap(e, r || 0, n || 0, a, o, {
                              premultiplyAlpha: u ? "premultiply" : "none",
                              colorSpaceConversion: "none",
                              imageOrientation: "none",
                            })
                          );
                        case 2:
                          return ((h = i.v), i.a(2, { data: h, premultiplyAlpha: u }));
                        case 3:
                          throw (
                            (i.p = 3),
                            (f = i.v),
                            new Error(`Failed to create image bitmap with crop: ${f}`)
                          );
                        case 4:
                          if (!0 !== d.basic) {
                            i.n = 8;
                            break;
                          }
                          return ((i.p = 5), (i.n = 6), createImageBitmap(e));
                        case 6:
                          return ((p = i.v), (g = u), i.a(2, { data: p, premultiplyAlpha: g }));
                        case 7:
                          throw (
                            (i.p = 7),
                            (m = i.v),
                            new Error(`Failed to create basic image bitmap: ${m}`)
                          );
                        case 8:
                          return (
                            (i.p = 8),
                            (i.n = 9),
                            createImageBitmap(e, {
                              premultiplyAlpha: u ? "premultiply" : "none",
                              colorSpaceConversion: "none",
                              imageOrientation: "none",
                            })
                          );
                        case 9:
                          return ((c = i.v), i.a(2, { data: c, premultiplyAlpha: u }));
                        case 10:
                          throw (
                            (i.p = 10),
                            (v = i.v),
                            new Error(`Failed to create image bitmap with options: ${v}`)
                          );
                        case 11:
                          return i.a(2);
                      }
                  },
                  s,
                  null,
                  [
                    [8, 10],
                    [5, 7],
                    [1, 3],
                  ],
                );
              }),
            )();
          }
          loadImage(e) {
            var t = this;
            return s(
              i().m(function r() {
                var n, a, s, o, l, u, d, h, c;
                return i().w(
                  function (r) {
                    for (;;)
                      switch ((r.p = r.n)) {
                        case 0:
                          if (
                            ((n = t.props),
                            (a = n.premultiplyAlpha),
                            (s = n.sx),
                            (o = n.sy),
                            (l = n.sw),
                            (u = n.sh),
                            !0 !== t.txManager.hasCreateImageBitmap)
                          ) {
                            r.n = 8;
                            break;
                          }
                          if (
                            !1 !== R(e) ||
                            !0 !== t.txManager.hasWorker ||
                            null === t.txManager.imageWorkerManager
                          ) {
                            r.n = 3;
                            break;
                          }
                          return (
                            (r.p = 1),
                            r.a(2, t.txManager.imageWorkerManager.getImage(e, a, s, o, l, u))
                          );
                        case 2:
                          throw ((r.p = 2), (h = r.v), new Error(`Failed to load image via worker: ${h}`));
                        case 3:
                          if (!0 !== R(e)) {
                            r.n = 4;
                            break;
                          }
                          ((d = C(e)), (r.n = 7));
                          break;
                        case 4:
                          return ((r.p = 4), (r.n = 5), me(e, "blob"));
                        case 5:
                          ((d = r.v), (r.n = 7));
                          break;
                        case 6:
                          throw (
                            (r.p = 6),
                            (c = r.v),
                            new Error(`Failed to fetch image blob from ${e}: ${c}`)
                          );
                        case 7:
                          return r.a(2, t.createImageBitmap(d, a, s, o, l, u));
                        case 8:
                          return r.a(2, t.loadImageFallback(e, null == a || a));
                      }
                  },
                  r,
                  null,
                  [
                    [4, 6],
                    [1, 2],
                  ],
                );
              }),
            )();
          }
          getTextureSource() {
            var e = this;
            return s(
              i().m(function t() {
                var r, n, a;
                return i().w(
                  function (t) {
                    for (;;)
                      switch ((t.p = t.n)) {
                        case 0:
                          return ((t.p = 0), (t.n = 1), e.determineImageTypeAndLoadImage());
                        case 1:
                          ((n = t.v), (t.n = 3));
                          break;
                        case 2:
                          return ((t.p = 2), (a = t.v), e.setState("failed", a), t.a(2, { data: null }));
                        case 3:
                          if (null !== n.data) {
                            t.n = 4;
                            break;
                          }
                          return (
                            e.setState("failed", Error("ImageTexture: No image data")),
                            t.a(2, { data: null })
                          );
                        case 4:
                          return t.a(2, {
                            data: n.data,
                            premultiplyAlpha: null === (r = e.props.premultiplyAlpha) || void 0 === r || r,
                          });
                      }
                  },
                  t,
                  null,
                  [[0, 2]],
                );
              }),
            )();
          }
          determineImageTypeAndLoadImage() {
            var e = this.props,
              t = e.src,
              r = e.premultiplyAlpha,
              i = e.type;
            if (null === t) return { data: null };
            if ("string" != typeof t) {
              if (t instanceof Blob) {
                if (!0 === this.txManager.hasCreateImageBitmap) {
                  var n = this.props,
                    a = n.sx,
                    s = n.sy,
                    o = n.sw,
                    l = n.sh;
                  return this.createImageBitmap(t, r, a, s, o, l);
                }
                return this.loadImageFallback(t, null == r || r);
              }
              return t instanceof ImageData
                ? { data: t, premultiplyAlpha: r }
                : { data: t(), premultiplyAlpha: r };
            }
            var u = (function (e) {
              if ("file:" === self.location.protocol && !T.test(e)) {
                var t = self.location.pathname.split("/");
                t.pop();
                var r = t.join("/"),
                  i = self.location.protocol + "//" + r;
                return (
                  "." === e.charAt(0) && (e = e.slice(1)),
                  "/" === e.charAt(0) && (e = e.slice(1)),
                  i + "/" + e
                );
              }
              return new URL(e, self.location.href).href;
            })(t);
            return "regular" === i
              ? this.loadImage(u)
              : "svg" === i || !0 === /\.(svg)(\?.*)?$/.test(t)
                ? ge(
                    u,
                    this.props.width,
                    this.props.height,
                    this.props.sx,
                    this.props.sy,
                    this.props.sw,
                    this.props.sh,
                  )
                : "compressed" === i ||
                    !0 ===
                      (function (e) {
                        return /\.(ktx|pvr)$/.test(e);
                      })(t)
                  ? Z(u)
                  : this.loadImage(u);
          }
          static makeCacheKey(e) {
            var t,
              r = ve.resolveDefaults(e),
              i = r.key || r.src;
            if ("string" != typeof i) return !1;
            var n,
              a,
              s = "";
            null !== r.sh &&
              null !== r.sw &&
              ((s += ","),
              (s += null !== (n = r.sx) && void 0 !== n ? n : ""),
              (s += null !== (a = r.sy) && void 0 !== a ? a : ""),
              (s += r.sw || ""),
              (s += r.sh || ""));
            return `ImageTexture,${i},${null !== (t = r.premultiplyAlpha) && void 0 !== t ? t : "true"}${s}`;
          }
          static resolveDefaults(e) {
            var t, r, i, n, a, s, o, l, u, d, h;
            return {
              src: null !== (t = e.src) && void 0 !== t ? t : "",
              premultiplyAlpha: null === (r = e.premultiplyAlpha) || void 0 === r || r,
              key: null !== (i = e.key) && void 0 !== i ? i : null,
              type: null !== (n = e.type) && void 0 !== n ? n : null,
              width: null !== (a = e.width) && void 0 !== a ? a : null,
              height: null !== (s = e.height) && void 0 !== s ? s : null,
              sx: null !== (o = e.sx) && void 0 !== o ? o : null,
              sy: null !== (l = e.sy) && void 0 !== l ? l : null,
              sw: null !== (u = e.sw) && void 0 !== u ? u : null,
              sh: null !== (d = e.sh) && void 0 !== d ? d : null,
              maxRetryCount: null !== (h = e.maxRetryCount) && void 0 !== h ? h : null,
            };
          }
        }
        o(ve, "z$__type__Props", void 0);
        class ye extends y {
          constructor(e, t) {
            (super(e),
              o(this, "props", void 0),
              o(this, "type", m.noise),
              (this.props = ye.resolveDefaults(t)));
          }
          getTextureSource() {
            var e = this;
            return s(
              i().m(function t() {
                var r, n, a, s, o, l, u;
                return i().w(function (t) {
                  for (;;)
                    if (0 === t.n) {
                      for (
                        r = e.props,
                          n = r.width,
                          a = r.height,
                          s = n * a * 4,
                          o = new Uint8ClampedArray(s),
                          l = 0;
                        l < s;
                        l += 4
                      )
                        ((u = Math.floor(256 * Math.random())),
                          (o[l] = u),
                          (o[l + 1] = u),
                          (o[l + 2] = u),
                          (o[l + 3] = 255));
                      return t.a(2, { data: new ImageData(o, n, a) });
                    }
                }, t);
              }),
            )();
          }
          static makeCacheKey(e) {
            if (void 0 === e.cacheId) return !1;
            var t = ye.resolveDefaults(e);
            return `NoiseTexture,${t.width},${t.height},${t.cacheId}`;
          }
          static resolveDefaults(e) {
            var t, r, i;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 128,
              height: null !== (r = e.height) && void 0 !== r ? r : 128,
              cacheId: null !== (i = e.cacheId) && void 0 !== i ? i : 0,
            };
          }
        }
        o(ye, "z$__type__Props", void 0);
        var Te,
          be = 0;
        class Se extends y {
          constructor(e, t) {
            (super(e),
              o(this, "props", void 0),
              o(this, "parentTexture", void 0),
              o(this, "type", m.subTexture),
              o(this, "subtextureId", "subtexture-" + be++),
              o(this, "onParentTxLoaded", () => {
                this.forwardParentTxState("loaded", { width: this.props.width, height: this.props.height });
              }),
              o(this, "onParentTxFailed", (e, t) => {
                ((this.retryCount = this.parentTexture.retryCount - 1),
                  this.forwardParentTxState("failed", t));
              }),
              o(this, "onParentTxLoading", () => {
                this.forwardParentTxState("loading");
              }),
              o(this, "onParentTxFreed", () => {
                this.forwardParentTxState("freed");
              }),
              (this.props = Se.resolveDefaults(t || {})),
              this.props.texture,
              this.props.texture,
              (this.parentTexture = e.resolveParentTexture(this.props.texture)),
              this.renderableOwners.length > 0 &&
                this.parentTexture.setRenderableOwner(this.subtextureId, !0),
              queueMicrotask(() => {
                var e = this.parentTexture;
                ("loaded" === e.state && e.dimensions
                  ? this.onParentTxLoaded(e, e.dimensions)
                  : "loading" === e.state
                    ? this.onParentTxLoading()
                    : "failed" === e.state && e.error
                      ? this.onParentTxFailed(e, e.error)
                      : "freed" === e.state && this.onParentTxFreed(),
                  e.on("loading", this.onParentTxLoading),
                  e.on("loaded", this.onParentTxLoaded),
                  e.on("failed", this.onParentTxFailed),
                  e.on("freed", this.onParentTxFreed));
              }));
          }
          forwardParentTxState(e, t) {
            this.setState(e, t);
          }
          onChangeIsRenderable(e) {
            this.parentTexture.setRenderableOwner(this.subtextureId, e);
          }
          getTextureSource() {
            var e = this;
            return s(
              i().m(function t() {
                return i().w(function (t) {
                  for (;;) if (0 === t.n) return t.a(2, { data: e.props });
                }, t);
              }),
            )();
          }
          static makeCacheKey(e) {
            return !1;
          }
          static resolveDefaults(e) {
            return {
              texture: e.texture,
              x: e.x || 0,
              y: e.y || 0,
              width: e.width || 0,
              height: e.height || 0,
            };
          }
        }
        o(Se, "z$__type__Props", void 0);
        class Ee extends y {
          constructor(e, t) {
            (super(e),
              o(this, "props", void 0),
              o(this, "type", m.renderToTexture),
              (this.props = Ee.resolveDefaults(t || {})));
          }
          get width() {
            return this.props.width;
          }
          set width(e) {
            this.props.width = e;
          }
          get height() {
            return this.props.height;
          }
          set height(e) {
            this.props.height = e;
          }
          getTextureSource() {
            return s(
              i().m(function e() {
                return i().w(function (e) {
                  for (;;) if (0 === e.n) return e.a(2, { data: null, premultiplyAlpha: null });
                }, e);
              }),
            )();
          }
          static resolveDefaults(e) {
            return { width: e.width || 256, height: e.height || 256 };
          }
        }
        function xe() {
          return (xe = s(
            i().m(function e() {
              var t, r, n, a, s, o, l, u, d, h;
              return i().w(
                function (e) {
                  for (;;)
                    switch ((e.p = e.n)) {
                      case 0:
                        return (
                          (r = new Uint8Array([
                            137, 80, 78, 71, 13, 10, 26, 10, 0, 0, 0, 13, 73, 72, 68, 82, 0, 0, 0, 1, 0, 0, 0,
                            1, 1, 3, 0, 0, 0, 37, 219, 86, 202, 0, 0, 0, 3, 80, 76, 84, 69, 0, 0, 0, 167, 122,
                            61, 218, 0, 0, 0, 1, 116, 82, 78, 83, 0, 64, 230, 216, 102, 0, 0, 0, 10, 73, 68,
                            65, 84, 8, 215, 99, 96, 0, 0, 0, 2, 0, 1, 226, 33, 188, 51, 0, 0, 0, 0, 73, 69,
                            78, 68, 174, 66, 96, 130,
                          ])),
                          (n = { basic: !1, options: !1, full: !1 }),
                          (a = new Blob([r], { type: "image/png" })),
                          (e.n = 1),
                          createImageBitmap(a)
                        );
                      case 1:
                        return (
                          (s = e.v),
                          null === (t = s.close) || void 0 === t || t.call(s),
                          (n.basic = !0),
                          (e.p = 2),
                          (l = { premultiplyAlpha: "none" }),
                          (e.n = 3),
                          createImageBitmap(a, l)
                        );
                      case 3:
                        ((u = e.v),
                          null === (o = u.close) || void 0 === o || o.call(u),
                          (n.options = !0),
                          (e.n = 5));
                        break;
                      case 4:
                        ((e.p = 4), e.v);
                      case 5:
                        return (
                          (e.p = 5),
                          (e.n = 6),
                          createImageBitmap(a, 0, 0, 1, 1, { premultiplyAlpha: "none" })
                        );
                      case 6:
                        ((h = e.v),
                          null === (d = h.close) || void 0 === d || d.call(h),
                          (n.full = !0),
                          (e.n = 8));
                        break;
                      case 7:
                        ((e.p = 7), e.v);
                      case 8:
                        return e.a(2, n);
                    }
                },
                e,
                null,
                [
                  [5, 7],
                  [2, 4],
                ],
              );
            }),
          )).apply(this, arguments);
        }
        (o(Ee, "z$__type__Props", void 0),
          (function (e) {
            ((e.MEMORY_THRESHOLD_EXCEEDED = "MEMORY_THRESHOLD_EXCEEDED"),
              (e.TEXTURE_DATA_NULL = "TEXTURE_DATA_NULL"),
              (e.TEXTURE_TYPE_NOT_REGISTERED = "TEXTURE_TYPE_NOT_REGISTERED"));
          })(Te || (Te = {})));
        var we = {
          [Te.MEMORY_THRESHOLD_EXCEEDED]: "Memory threshold exceeded",
          [Te.TEXTURE_DATA_NULL]: "Texture data is null",
          [Te.TEXTURE_TYPE_NOT_REGISTERED]: "Texture type is not registered",
        };
        class Ae extends Error {
          constructor(e, t) {
            var r = Object.values(Te).includes(e),
              i = r ? e : void 0;
            (super(r && i ? (null != t ? t : we[i]) : String(e)),
              o(this, "code", void 0),
              (this.name = new.target.name),
              i && (this.code = i));
          }
        }
        class Ie extends v {
          constructor(e, t) {
            (super(),
              o(this, "keyCache", new Map()),
              o(this, "inverseKeyCache", new WeakMap()),
              o(this, "txConstructors", {}),
              o(this, "maxRetryCount", void 0),
              o(this, "priorityQueue", []),
              o(this, "uploadTextureQueue", []),
              o(this, "initialized", !1),
              o(this, "stage", void 0),
              o(this, "numImageWorkers", void 0),
              o(this, "imageWorkerManager", null),
              o(this, "hasCreateImageBitmap", !!self.createImageBitmap),
              o(this, "imageBitmapSupported", { basic: !1, options: !1, full: !1 }),
              o(this, "hasWorker", !!self.Worker),
              o(this, "renderer", void 0),
              o(this, "frameTime", 0));
            var r = t.numImageWorkers,
              i = t.createImageBitmapSupport,
              n = t.maxRetryCount;
            ((this.stage = e),
              (this.numImageWorkers = r),
              (this.maxRetryCount = n),
              "auto" === i
                ? (function () {
                    return xe.apply(this, arguments);
                  })()
                    .then(e => {
                      this.initialize(e);
                    })
                    .catch(() => {
                      (console.warn(
                        "[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower.",
                      ),
                        (this.initialized = !0),
                        this.emit("initialized"));
                    })
                : this.initialize({ basic: "basic" === i, options: "options" === i, full: "full" === i }),
              this.registerTextureType("ImageTexture", ve),
              this.registerTextureType("ColorTexture", X),
              this.registerTextureType("NoiseTexture", ye),
              this.registerTextureType("SubTexture", Se),
              this.registerTextureType("RenderTexture", Ee));
          }
          registerTextureType(e, t) {
            this.txConstructors[e] = t;
          }
          initialize(e) {
            ((this.hasCreateImageBitmap = e.basic || e.options || e.full),
              (this.imageBitmapSupported = e),
              this.hasCreateImageBitmap ||
                console.warn(
                  "[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower.",
                ),
              this.hasCreateImageBitmap && this.hasWorker && this.numImageWorkers > 0
                ? (this.imageWorkerManager = new q(this.numImageWorkers, e))
                : console.warn(
                    "[Lightning] Imageworker is 0 or not supported on this browser. Image loading will be slower.",
                  ),
              (this.initialized = !0),
              this.emit("initialized"));
          }
          enqueueUploadTexture(e) {
            !1 === this.uploadTextureQueue.includes(e) && this.uploadTextureQueue.push(e);
          }
          createTexture(e, t) {
            var r,
              i = this.txConstructors[e];
            if (!i) throw new Ae(Te.TEXTURE_TYPE_NOT_REGISTERED, `Texture type "${e}" is not registered`);
            var n = i.makeCacheKey(t);
            return (
              n && this.keyCache.has(n)
                ? (r = this.keyCache.get(n))
                : ((r = new i(this, t)), n && this.initTextureToCache(r, n)),
              r
            );
          }
          loadTexture(e, t) {
            var r = this;
            return s(
              i().m(function n() {
                return i().w(function (i) {
                  for (;;)
                    switch (i.n) {
                      case 0:
                        if (e.type !== m.subTexture) {
                          i.n = 1;
                          break;
                        }
                        return i.a(2);
                      case 1:
                        if ("loaded" !== e.state) {
                          i.n = 2;
                          break;
                        }
                        return i.a(2);
                      case 2:
                        if ("loading" !== e.state) {
                          i.n = 3;
                          break;
                        }
                        return i.a(2);
                      case 3:
                        if (!1 !== r.initialized) {
                          i.n = 4;
                          break;
                        }
                        return (r.priorityQueue.push(e), i.a(2));
                      case 4:
                        return (
                          e.setState("loading"),
                          (i.n = 5),
                          e.getTextureData().catch(t => (console.error(t), e.setState("failed"), null))
                        );
                      case 5:
                        if (null !== i.v && "failed" !== e.state) {
                          i.n = 6;
                          break;
                        }
                        return i.a(2);
                      case 6:
                        if (!0 !== (e.type !== m.image || !0 === t)) {
                          i.n = 8;
                          break;
                        }
                        return (
                          (i.n = 7),
                          r.uploadTexture(e).catch(t => {
                            (console.error("Failed to upload texture:", t), e.setState("failed"));
                          })
                        );
                      case 7:
                        return i.a(2);
                      case 8:
                        r.enqueueUploadTexture(e);
                      case 9:
                        return i.a(2);
                    }
                }, n);
              }),
            )();
          }
          uploadTexture(e) {
            var t = this;
            return s(
              i().m(function r() {
                var n;
                return i().w(function (r) {
                  for (;;)
                    switch (r.n) {
                      case 0:
                        if (
                          !0 !== t.stage.txMemManager.doNotExceedCriticalThreshold ||
                          !0 !== t.stage.txMemManager.criticalCleanupRequested
                        ) {
                          r.n = 1;
                          break;
                        }
                        return (e.setState("failed", new Ae(Te.MEMORY_THRESHOLD_EXCEEDED)), r.a(2));
                      case 1:
                        if ("failed" !== e.state && "freed" !== e.state) {
                          r.n = 2;
                          break;
                        }
                        return r.a(2);
                      case 2:
                        if ("loaded" !== e.state) {
                          r.n = 3;
                          break;
                        }
                        return r.a(2);
                      case 3:
                        if (null !== e.textureData) {
                          r.n = 4;
                          break;
                        }
                        return (
                          e.setState(
                            "failed",
                            new Ae(Te.TEXTURE_DATA_NULL, "Texture data is null, cannot upload texture"),
                          ),
                          r.a(2)
                        );
                      case 4:
                        if (null === (n = e.loadCtxTexture()) || "loaded" !== n.state) {
                          r.n = 5;
                          break;
                        }
                        return (e.setState("loaded"), r.a(2));
                      case 5:
                        return ((r.n = 6), n.load());
                      case 6:
                        return r.a(2);
                    }
                }, r);
              }),
            )();
          }
          isProcessingTexture(e) {
            return !0 === this.uploadTextureQueue.includes(e);
          }
          processSome(e) {
            var t = this;
            return s(
              i().m(function r() {
                var n, a, s, o, l;
                return i().w(
                  function (r) {
                    for (;;)
                      switch ((r.p = r.n)) {
                        case 0:
                          if (!1 !== t.initialized) {
                            r.n = 1;
                            break;
                          }
                          return r.a(2);
                        case 1:
                          n = K();
                        case 2:
                          if (!(t.priorityQueue.length > 0 && K() - n < e)) {
                            r.n = 8;
                            break;
                          }
                          return ((a = t.priorityQueue.pop()), (r.p = 3), (r.n = 4), a.getTextureData());
                        case 4:
                          return ((r.n = 5), t.uploadTexture(a));
                        case 5:
                          r.n = 7;
                          break;
                        case 6:
                          ((r.p = 6), (o = r.v), console.error("Failed to process priority texture:", o));
                        case 7:
                          r.n = 2;
                          break;
                        case 8:
                          if (!(t.uploadTextureQueue.length > 0 && K() - n < e)) {
                            r.n = 13;
                            break;
                          }
                          return (
                            (s = t.uploadTextureQueue.shift()),
                            (r.p = 9),
                            (r.n = 10),
                            t.uploadTexture(s)
                          );
                        case 10:
                          r.n = 12;
                          break;
                        case 11:
                          ((r.p = 11), (l = r.v), console.error("Failed to upload texture:", l));
                        case 12:
                          r.n = 8;
                          break;
                        case 13:
                          return r.a(2);
                      }
                  },
                  r,
                  null,
                  [
                    [9, 11],
                    [3, 6],
                  ],
                );
              }),
            )();
          }
          hasUpdates() {
            return this.uploadTextureQueue.length > 0;
          }
          initTextureToCache(e, t) {
            var r = this.keyCache,
              i = this.inverseKeyCache;
            (r.set(t, e), i.set(e, t));
          }
          getTextureFromCache(e) {
            return this.keyCache.get(e);
          }
          removeTextureFromCache(e) {
            var t = this.inverseKeyCache,
              r = this.keyCache,
              i = t.get(e);
            i && r.delete(i);
          }
          resolveParentTexture(e) {
            if (null == e || !e.props) return e;
            var t = ve.makeCacheKey(e.props),
              r = t ? this.getTextureFromCache(t) : void 0;
            return null != r ? r : e;
          }
        }
        var ke = { normal: 400, bold: 700, bolder: 900, lighter: 100 },
          Re = e => ("number" == typeof e ? e : ke[e] || 400);
        class Ce {
          constructor(e) {
            (o(this, "textRenderers", void 0), o(this, "fontCache", new Map()), (this.textRenderers = e));
          }
          addFontFace(e) {
            for (var t in this.textRenderers) {
              var r = this.textRenderers[t];
              r && r.isFontFaceSupported(e) && r.addFontFace(e);
            }
          }
          resolveFontFace(e, t, r) {
            var i = t.fontFamily,
              n = t.fontWeight,
              a = t.fontStyle,
              s = t.fontStretch,
              o = `${r}_${i}_${a}_${n}_${s}`;
            if (!0 === this.fontCache.has(o)) return this.fontCache.get(o);
            var u = (function (e, t, r, i, n) {
              var a,
                s = Re(r),
                o = l(e);
              try {
                for (o.s(); !(a = o.n()).done; ) {
                  var u = a.value[t];
                  if (u) {
                    if (1 === u.size)
                      return (
                        console.warn(
                          `TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`,
                        ),
                        u.values().next().value
                      );
                    var d,
                      h = new Map(),
                      c = l(u);
                    try {
                      for (c.s(); !(d = c.n()).done; ) {
                        var f = d.value,
                          p = Re(f.descriptors.weight);
                        if (p === s && f.descriptors.style === i && f.descriptors.stretch === n) return f;
                        h.set(p, f);
                      }
                    } catch (m) {
                      c.e(m);
                    } finally {
                      c.f();
                    }
                    var g = `TrFontManager: No exact match: '${t} Weight: ${s} Style: ${i} Stretch: ${n}'`;
                    if ((console.error(g), 400 === s && h.has(500))) return h.get(500);
                    if (500 === s && h.has(400)) return h.get(400);
                    if (s < 400) {
                      for (; s > 0; ) {
                        if (h.has(s)) return h.get(s);
                        s -= 100;
                      }
                      s = 600;
                    }
                    for (; s < 1e3; ) {
                      if (h.has(s)) return h.get(s);
                      s += 100;
                    }
                    for (s = 500; s > 0; ) {
                      if (h.has(s)) return h.get(s);
                      s -= 100;
                    }
                  }
                }
              } catch (m) {
                o.e(m);
              } finally {
                o.f();
              }
            })(e, i, n, a, s);
            return (void 0 !== u && this.fontCache.set(o, u), u);
          }
        }
        class Le {
          static makeCacheKey(e) {
            return !1;
          }
          static resolveDefaults(e) {
            return {};
          }
        }
        function Me(e, t, r) {
          var i = e.createShader(t);
          if (!i) {
            var n = e.getError();
            throw new Error(
              `Unable to create the shader: ${t === e.VERTEX_SHADER ? "VERTEX_SHADER" : "FRAGMENT_SHADER"}.${n ? ` WebGlContext Error: ${n}` : ""}`,
            );
          }
          if ((e.shaderSource(i, r), e.compileShader(i), !!e.getShaderParameter(i, e.COMPILE_STATUS)))
            return i;
          (console.error(e.getShaderInfoLog(i)), e.deleteShader(i));
        }
        class De extends Le {
          constructor(e) {
            (super(),
              o(this, "buffersBound", !1),
              o(this, "program", void 0),
              o(this, "vao", void 0),
              o(this, "renderer", void 0),
              o(this, "glw", void 0),
              o(this, "attributeLocations", void 0),
              o(this, "uniformLocations", void 0),
              o(this, "supportsIndexedTextures", void 0));
            var t = (this.renderer = e.renderer),
              r = (this.glw = this.renderer.glw);
            this.supportsIndexedTextures = e.supportsIndexedTextures || !1;
            var i = r.isWebGl2(),
              n = (i && e.webgl2Extensions) || (!i && e.webgl1Extensions) || [],
              a = i ? "2.0" : "1.0";
            n.forEach(e => {
              if (!r.getExtension(e))
                throw new Error(
                  `Shader "${this.constructor.name}" requires extension "${e}" for WebGL ${a} but wasn't found`,
                );
            });
            var s = e.shaderSources || this.constructor.shaderSources;
            if (!s) throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);
            i &&
              null != s &&
              s.webGl2 &&
              ((s.fragment = s.webGl2.fragment), (s.vertex = s.webGl2.vertex), delete s.webGl2);
            var l = t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,
              u = s.vertex instanceof Function ? s.vertex(l) : s.vertex,
              d = s.fragment instanceof Function ? s.fragment(l) : s.fragment,
              h = Me(r, r.VERTEX_SHADER, u),
              c = Me(r, r.FRAGMENT_SHADER, d);
            if (!h || !c)
              throw new Error(
                `Unable to create the following shader(s): ${[!h && "VERTEX_SHADER", !c && "FRAGMENT_SHADER"].filter(Boolean).join(" and ")}`,
              );
            var f = (function (e, t, r) {
              var i = e.createProgram();
              if (!i) throw new Error("Unable to create program");
              if (
                (e.attachShader(i, t),
                e.attachShader(i, r),
                e.linkProgram(i),
                e.getProgramParameter(i, e.LINK_STATUS))
              )
                return i;
              (console.warn(e.getProgramInfoLog(i)), e.deleteProgram(i));
            })(r, h, c);
            if (!f) throw new Error("Unable to create program");
            ((this.program = f),
              (this.attributeLocations = r.getAttributeLocations(this.program)),
              (this.uniformLocations = r.getUniformLocations(this.program)));
          }
          disableAttribute(e) {
            this.glw.disableVertexAttribArray(e);
          }
          disableAttributes() {
            for (var e = this.glw, t = this.attributeLocations.length, r = 0; r < t; r++)
              e.disableVertexAttribArray(r);
          }
          canBatchShaderProps(e, t) {
            return !1;
          }
          bindRenderOp(e, t) {
            var r;
            (this.bindBufferCollection(e.buffers),
              e.textures.length > 0 &&
                null !== (r = e.textures[0]) &&
                void 0 !== r &&
                r.ctxTexture &&
                this.bindTextures(e.textures));
            var i = e.glw,
              n = e.parentHasRenderTexture;
            if (!e.renderToTexture || !n) {
              if (n) {
                var a = e.framebufferDimensions || {},
                  s = a.width,
                  o = a.height;
                (i.uniform1f(this.getUniformLocation("u_pixelRatio"), 1),
                  i.uniform2f(this.getUniformLocation("u_resolution"), null != s ? s : 0, null != o ? o : 0));
              } else
                (i.uniform1f(this.getUniformLocation("u_pixelRatio"), e.options.pixelRatio),
                  i.uniform2f(this.getUniformLocation("u_resolution"), i.canvas.width, i.canvas.height));
              if (t) {
                if (p(t, "$dimensions")) {
                  var l = t.$dimensions;
                  (l || (l = e.dimensions),
                    i.uniform2f(this.getUniformLocation("u_dimensions"), l.width, l.height));
                }
                if (p(t, "$alpha")) {
                  var u = t.$alpha;
                  (u || (u = e.alpha), i.uniform1f(this.getUniformLocation("u_alpha"), u));
                }
                this.bindProps(t);
              }
            }
          }
          getUniformLocation(e) {
            return this.uniformLocations[e] || null;
          }
          bindBufferCollection(e) {
            for (var t = this.glw, r = this.attributeLocations, i = r.length, n = 0; n < i; n++) {
              var a = r[n],
                s = e.getBuffer(a),
                o = e.getAttributeInfo(a);
              void 0 !== s &&
                void 0 !== o &&
                (t.enableVertexAttribArray(n),
                t.vertexAttribPointer(s, n, o.size, o.type, o.normalized, o.stride, o.offset));
            }
          }
          bindProps(e) {}
          bindTextures(e) {}
          attach() {
            (this.glw.useProgram(this.program),
              this.glw.isWebGl2() && this.vao && this.glw.bindVertexArray(this.vao));
          }
          detach() {
            this.disableAttributes();
          }
        }
        o(De, "shaderSources", void 0);
        class _e extends De {
          constructor(e) {
            super({ renderer: e });
          }
          bindTextures(e) {
            var t = this.glw;
            (t.activeTexture(0), t.bindTexture(e[0].ctxTexture));
          }
        }
        o(_e, "shaderSources", {
          vertex:
            "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_nodeCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",
          fragment:
            "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    ",
        });
        class Pe extends De {
          constructor(e) {
            (super({ renderer: e }), o(this, "supportsIndexedTextures", !0));
          }
          bindTextures(e) {
            var t = this.renderer,
              r = this.glw;
            if (e.length > t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)
              throw new Error(
                `DefaultShaderBatched: Cannot bind more than ${t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`,
              );
            e.forEach((e, t) => {
              (r.activeTexture(t), r.bindTexture(e.ctxTexture));
            });
            var i = Array.from(Array(e.length).keys());
            this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"), i);
          }
        }
        o(Pe, "shaderSources", {
          vertex:
            "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",
          fragment: e =>
            `\n      #define txUnits ${e}\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {\n        ${Array.from(
              Array(e).keys(),
            )
              .map(
                e =>
                  `\n          ${0 !== e ? "else " : ""}if (idx == ${e}) {\n            return texture2D(textures[${e}], uv);\n          }\n        `,
              )
              .join(
                "",
              )}\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    `,
        });
        class Oe {
          static getEffectKey(e) {
            return "";
          }
          static getMethodParameters(e, t) {
            var r = [];
            for (var i in e) {
              var n = e[i],
                a = "";
              (n.size && (a = `[${n.size(t)}]`), r.push(`${n.type} ${i}${a}`));
            }
            return r.join(",");
          }
          constructor(e) {
            (o(this, "priority", 1),
              o(this, "name", ""),
              o(this, "ref", void 0),
              o(this, "target", void 0),
              o(this, "passParameters", ""),
              o(this, "declaredUniforms", ""),
              o(this, "uniformInfo", {}));
            var t = e.ref,
              r = e.target,
              i = e.props,
              n = void 0 === i ? {} : i;
            ((this.ref = t), (this.target = r));
            var a = {},
              s = [],
              l = "",
              u = this.constructor.uniforms || {};
            for (var d in u) {
              var h = u[d],
                c = h.type,
                f = `${t}_${d}`,
                p = "";
              (h.size && (p = `[${h.size(n)}]`),
                s.push(f),
                (l += `uniform ${c} ${f}${p};`),
                (a[d] = { name: f, uniform: u[d].method }));
            }
            ((this.passParameters = s.join(",")), (this.declaredUniforms = l), (this.uniformInfo = a));
          }
          static resolveDefaults(e) {
            return {};
          }
          static makeEffectKey(e) {
            return !1;
          }
        }
        (o(Oe, "uniforms", {}),
          o(Oe, "methods", void 0),
          o(Oe, "onShaderMask", void 0),
          o(Oe, "onColorize", void 0),
          o(Oe, "onEffectMask", void 0));
        var Ne = new Map(),
          Fe = (e, t) => {
            var r = JSON.stringify(e);
            if (Ne.has(r)) return Ne.get(r);
            for (var i = [], n = (e = null != e ? e : []).length, a = 0; a < n; a++) {
              for (
                var s = e[a],
                  o = s.name,
                  l = s.type,
                  u = s.props,
                  d = { name: o, type: l, props: {} },
                  h = t[l],
                  c = h.resolveDefaults(u),
                  f = h.uniforms,
                  p = Object.keys(f),
                  g = p.length,
                  m = 0;
                m < g;
                m++
              ) {
                var v = p[m],
                  y = f[v],
                  T = {
                    value: c[v],
                    programValue: void 0,
                    method: y.method,
                    updateOnBind: y.updateOnBind || !1,
                    hasValidator: void 0 !== y.validator,
                    hasProgramValueUpdater: void 0 !== y.updateProgramValue,
                  },
                  b = (T.hasValidator && y.validator(c[v], c)) || c[v];
                (c[v] !== b && (T.validatedValue = b),
                  T.hasProgramValueUpdater && y.updateProgramValue(T),
                  void 0 === T.programValue && (T.programValue = T.value),
                  (d.props[v] = T));
              }
              i.push(d);
            }
            return (Ne.set(r, i), i);
          };
        class Ue extends De {
          constructor(e, t, r) {
            var i = Ue.createShader(t, r);
            (super({ renderer: e, shaderSources: { vertex: i.vertex, fragment: i.fragment } }),
              o(this, "effects", []),
              (this.effects = i.effects));
          }
          bindTextures(e) {
            var t = this.glw;
            (t.activeTexture(0), t.bindTexture(e[0].ctxTexture));
          }
          bindUniformMethods(e) {
            for (var t = this, r = this.glw, i = e.effects, n = i.length, a = 0; a < n; a++)
              for (
                var s = this.effects[a].uniformInfo,
                  o = i[a],
                  l = Object.keys(o.props),
                  u = l.length,
                  d = function () {
                    var e = l[h],
                      i = o.props[e].method,
                      n = t.getUniformLocation(s[e].name);
                    return "uniform2fv" === i ||
                      "uniform2iv" === i ||
                      "uniform3iv" === i ||
                      "uniform4fv" === i ||
                      "uniform4iv" === i ||
                      "uniformMatrix2fv" === i ||
                      "uniformMatrix3fv" === i ||
                      "uniformMatrix4fv" === i ||
                      "uniform1f" === i ||
                      "uniform1fv" === i ||
                      "uniform1i" === i ||
                      "uniform1iv" === i
                      ? ((o.props[e].setUniformValue = function () {
                          r[i](n, this.programValue);
                        }),
                        0)
                      : "uniform2f" === i || "uniform2i" === i
                        ? ((o.props[e].setUniformValue = function () {
                            r[i](n, this.programValue[0], this.programValue[1]);
                          }),
                          0)
                        : "uniform3f" === i || "uniform3i" === i
                          ? ((o.props[e].setUniformValue = function () {
                              r[i](n, this.programValue[0], this.programValue[1], this.programValue[2]);
                            }),
                            0)
                          : "uniform4f" === i || "uniform4i" === i
                            ? ((o.props[e].setUniformValue = function () {
                                r[i](
                                  n,
                                  this.programValue[0],
                                  this.programValue[1],
                                  this.programValue[2],
                                  this.programValue[3],
                                );
                              }),
                              0)
                            : void 0;
                  },
                  h = 0;
                h < u;
                h++
              )
                d();
          }
          bindProps(e) {
            for (var t = e.effects, r = t.length, i = 0; i < r; i++)
              for (var n = t[i], a = Object.keys(n.props), s = a.length, o = 0; o < s; o++) {
                var l = a[o],
                  u = n.props[l];
                if (!0 === u.updateOnBind) {
                  var d,
                    h =
                      null === (d = this.renderer.shManager.getRegisteredEffects()[n.type]) || void 0 === d
                        ? void 0
                        : d.uniforms[l];
                  null == h || h.updateProgramValue(n.props[l], e);
                }
                u.setUniformValue();
              }
          }
          canBatchShaderProps(e, t) {
            if (
              e.$alpha !== t.$alpha ||
              e.$dimensions.width !== t.$dimensions.width ||
              e.$dimensions.height !== t.$dimensions.height ||
              e.effects.length !== t.effects.length
            )
              return !1;
            for (var r = e.effects.length, i = 0; i < r; i++) {
              var n = e.effects[i],
                a = t.effects[i];
              if (n.type !== a.type) return !1;
              for (var s in n.props)
                if ((a.props && !a.props[s]) || n.props[s].value !== a.props[s].value) return !1;
            }
            return !0;
          }
          static createShader(e, t) {
            var r = {},
              i = {},
              n = "",
              a = [],
              s = [],
              o = e.effects.map(e => {
                var i = t[e.type],
                  o = i.getEffectKey(e.props || {});
                r[o] = r[o] ? ++r[o] : 1;
                var l = r[o];
                1 === l && s.push({ key: o, type: e.type, props: e.props });
                var u = new i({ ref: `${o}${1 === l ? "" : l}`, target: o, props: e.props });
                return ((n += u.declaredUniforms), a.push(...Object.values(u.uniformInfo)), u);
              }),
              l = "";
            null == s ||
              s.forEach(e => {
                var r,
                  n = t[e.type],
                  a = n.resolveDefaults(null !== (r = e.props) && void 0 !== r ? r : {}),
                  s = [];
                for (var o in n.methods) {
                  var u = o,
                    d = n.methods[o];
                  (i[o] && i[o] !== d && (u = Ue.resolveMethodDuplicate(o, d, i)),
                    (i[u] = d.replace("function", u)),
                    s.push({ m: o, cm: u }));
                }
                var h = n.onShaderMask instanceof Function ? n.onShaderMask(a) : n.onShaderMask,
                  c = n.onColorize instanceof Function ? n.onColorize(a) : n.onColorize,
                  f = n.onEffectMask instanceof Function ? n.onEffectMask(a) : n.onEffectMask;
                s.forEach(e => {
                  var t = e.m,
                    r = e.cm,
                    i = new RegExp(`\\$${t}`, "g");
                  (h && (h = h.replace(i, r)), c && (c = c.replace(i, r)), f && (f = f.replace(i, r)));
                });
                var p = n.getMethodParameters(n.uniforms, a),
                  g = p.length > 0 ? `, ${p}` : "";
                (h &&
                  (l += `\n        float fx_${e.key}_onShaderMask(float shaderMask ${g}) {\n          ${h}\n        }\n        `),
                  c &&
                    (l += `\n          vec4 fx_${e.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${g}) {\n            ${c}\n          }\n        `),
                  f &&
                    (l += `\n          vec4 fx_${e.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${g}) {\n            ${f}\n          }\n        `));
              });
            var u = "";
            for (var d in i) u += i[d];
            for (
              var h = "mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",
                c = "\n\n    ",
                f = 0;
              f < o.length;
              f++
            ) {
              var p = o[f],
                g = p.passParameters.length > 0 ? `, ${p.passParameters}` : "",
                m = t[p.name];
              (m.onShaderMask &&
                (c += `\n        shaderMask = fx_${p.target}_onShaderMask(shaderMask ${g});\n        `),
                m.onColorize &&
                  (c += `\n        maskColor = fx_${p.target}_onColorize(shaderMask, maskColor, shaderColor${g});\n        `),
                m.onEffectMask &&
                  (h = `fx_${p.target}_onEffectMask(shaderMask, maskColor, shaderColor${g})`));
              var v = o[f + 1];
              (void 0 === v || t[v.name].onEffectMask) && (c += `\n          shaderColor = ${h};\n        `);
            }
            return { effects: o, uniforms: a, fragment: Ue.fragment(n, u, l, c), vertex: Ue.vertex() };
          }
          static resolveMethodDuplicate(e, t, r, i = 0) {
            var n = e + (i > 0 ? i : "");
            return r[n] && r[n] !== t ? this.resolveMethodDuplicate(e, t, r, ++i) : n;
          }
          static resolveDefaults(e, t) {
            var r;
            return {
              effects: Fe(null !== (r = e.effects) && void 0 !== r ? r : [], t),
              $dimensions: { width: 0, height: 0 },
              $alpha: 0,
            };
          }
          static makeCacheKey(e, t) {
            var r,
              i = "";
            return (
              null === (r = e.effects) ||
                void 0 === r ||
                r.forEach(e => {
                  var r = t[e.type].getEffectKey(e.props || {});
                  i += `,${r}`;
                }),
              `DynamicShader${i}`
            );
          }
        }
        (o(Ue, "z$__type__Props", void 0),
          o(
            Ue,
            "vertex",
            () =>
              "\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_nodeCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n    varying vec2 v_nodeCoordinate;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n      v_nodeCoordinate = a_nodeCoordinate;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  ",
          ),
          o(
            Ue,
            "fragment",
            (e, t, r, i) =>
              `\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ${e}\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying vec2 v_nodeCoordinate;\n\n    ${t}\n\n    ${r}\n\n    void main() {\n      vec2 p = v_nodeCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ${i}\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  `,
          ));
        class Be extends De {
          constructor(e) {
            super({ renderer: e });
          }
          static resolveDefaults(e) {
            return { radius: e.radius || 10, $dimensions: { width: 0, height: 0 } };
          }
          bindTextures(e) {
            var t = this.glw;
            (t.activeTexture(0), t.bindTexture(e[0].ctxTexture));
          }
          bindProps(e) {
            var t = Math.min(e.$dimensions.width, e.$dimensions.height) / (2 * e.radius);
            this.glw.uniform1f(this.getUniformLocation("u_radius"), e.radius * Math.min(t, 1));
          }
          canBatchShaderProps(e, t) {
            return (
              e.radius === t.radius &&
              e.$dimensions.width === t.$dimensions.width &&
              e.$dimensions.height === t.$dimensions.height
            );
          }
        }
        (o(Be, "z$__type__Props", void 0),
          o(Be, "shaderSources", {
            vertex:
              "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute vec2 a_nodeCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",
            fragment:
              "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    ",
          }));
        var $e = new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
        class je extends De {
          constructor(e) {
            super({ renderer: e });
          }
          bindTextures(e) {
            var t = this.glw;
            (t.activeTexture(0), t.bindTexture(e[0].ctxTexture));
          }
          bindProps(e) {
            var t = je.resolveDefaults(e);
            for (var r in t)
              if ("transform" === r) this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"), t[r]);
              else if ("scrollY" === r) this.glw.uniform1f(this.getUniformLocation("u_scrollY"), t[r]);
              else if ("color" === r) {
                var i = b(t.color);
                this.glw.uniform4fv(this.getUniformLocation("u_color"), i);
              } else
                "size" === r
                  ? this.glw.uniform1f(this.getUniformLocation("u_size"), t[r])
                  : "distanceRange" === r
                    ? this.glw.uniform1f(this.getUniformLocation("u_distanceRange"), t[r])
                    : "debug" === r && this.glw.uniform1i(this.getUniformLocation("u_debug"), t[r] ? 1 : 0);
          }
          static resolveDefaults(e = {}) {
            var t, r, i, n, a, s;
            return {
              transform: null !== (t = e.transform) && void 0 !== t ? t : $e,
              scrollY: null !== (r = e.scrollY) && void 0 !== r ? r : 0,
              color: null !== (i = e.color) && void 0 !== i ? i : 4294967295,
              size: null !== (n = e.size) && void 0 !== n ? n : 16,
              distanceRange: null !== (a = e.distanceRange) && void 0 !== a ? a : 1,
              debug: null !== (s = e.debug) && void 0 !== s && s,
            };
          }
        }
        (o(je, "z$__type__Props", void 0),
          o(je, "shaderSources", {
            vertex:
              "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",
            fragment:
              "\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    ",
          }));
        var Ge = e => {
            void 0 === e.programValue && (e.programValue = new Float32Array(4));
            var t = e.value,
              r = e.programValue;
            ((r[0] = (t >>> 24) / 255),
              (r[1] = ((t >>> 16) & 255) / 255),
              (r[2] = ((t >>> 8) & 255) / 255),
              (r[3] = (255 & t) / 255));
          },
          Ve = e => {
            var t = e.validatedValue || e.value;
            if (e.programValue instanceof Float32Array)
              for (var r = t.length, i = e.programValue, n = 0; n < r; n++) i[n] = t[n];
            else e.programValue = new Float32Array(t);
          },
          He = e => {
            var t = Array.isArray(e);
            return t
              ? t && 4 === e.length
                ? e
                : t && 2 === e.length
                  ? [e[0], e[1], e[0], e[1]]
                  : t && 3 === e.length
                    ? [e[0], e[1], e[2], e[0]]
                    : [e[0], e[0], e[0], e[0]]
              : [e, e, e, e];
          },
          Ke = (e, t) => {
            void 0 === e.programValue && (e.programValue = new Float32Array(4));
            var i = e.programValue,
              n = e.validatedValue || e.value;
            if (void 0 === t && void 0 === e.$dimensions)
              return ((i[0] = n[0]), (i[1] = n[1]), (i[2] = n[2]), void (i[3] = n[3]));
            var a = e.$dimensions;
            if (void 0 !== t) {
              var s = t.$dimensions;
              if (void 0 !== a && (a.width === s.width || a.height === s.height)) return;
              void 0 === a &&
                ((a = { width: null == s ? void 0 : s.width, height: null == s ? void 0 : s.height }),
                (e.$dimensions = a));
            }
            var o = a,
              l = o.width,
              u = o.height,
              d = r(n, 4),
              h = d[0],
              c = d[1],
              f = d[2],
              p = d[3],
              g = Math.min(
                Math.min(
                  Math.min(l / Math.max(l, h + c), l / Math.max(l, f + p)),
                  Math.min(u / Math.max(u, h + f), u / Math.max(u, c + p)),
                ),
                1,
              );
            ((i[0] = h * g), (i[1] = c * g), (i[2] = f * g), (i[3] = p * g));
          };
        class We extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "radius"));
          }
          static getEffectKey() {
            return "radius";
          }
          static resolveDefaults(e) {
            var t;
            return { radius: null !== (t = e.radius) && void 0 !== t ? t : 10 };
          }
        }
        (o(We, "z$__type__Props", void 0),
          o(We, "uniforms", {
            radius: {
              value: 0,
              method: "uniform4fv",
              type: "vec4",
              updateOnBind: !0,
              validator: He,
              updateProgramValue: Ke,
            },
          }),
          o(We, "methods", {
            fillMask:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
            boxDist:
              "\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    ",
          }),
          o(
            We,
            "onShaderMask",
            "\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_nodeCoordinate.x, 0.5) * step(v_nodeCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_nodeCoordinate.x) * step(v_nodeCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_nodeCoordinate.x) * step(0.5, v_nodeCoordinate.y);\n  r = r + radius[3] * step(v_nodeCoordinate.x, 0.5) * step(0.5, v_nodeCoordinate.y);\n  return $boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  ",
          ),
          o(We, "onEffectMask", "\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  "));
        class ze extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "border"));
          }
          static getEffectKey() {
            return "border";
          }
          static resolveDefaults(e) {
            var t, r;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 10,
              color: null !== (r = e.color) && void 0 !== r ? r : 4294967295,
            };
          }
        }
        (o(ze, "z$__type__Props", void 0),
          o(ze, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            color: { value: 4294967295, updateProgramValue: Ge, method: "uniform4fv", type: "vec4" },
          }),
          o(
            ze,
            "onEffectMask",
            "\n  float intR = shaderMask + 1.0;\n  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  ",
          ),
          o(ze, "onColorize", "\n    return color;\n  "));
        class qe extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "linearGradient"));
          }
          static getEffectKey(e) {
            return e.colors.value
              ? `linearGradient${e.colors.value.length}`
              : `linearGradient${e.colors.length}`;
          }
          static resolveDefaults(e) {
            var t,
              r,
              i = null !== (t = e.colors) && void 0 !== t ? t : [4278190080, 4294967295],
              n = e.stops || [];
            if (0 === n.length || n.length !== i.length) {
              for (var a = i.length, s = 0, o = n; s < a; s++)
                n[s]
                  ? ((o[s] = n[s]),
                    void 0 === n[s - 1] &&
                      void 0 !== o[s - 2] &&
                      (o[s - 1] = o[s - 2] + (n[s] - o[s - 2]) / 2))
                  : (o[s] = s * (1 / (i.length - 1)));
              n = o;
            }
            return { colors: i, stops: n, angle: null !== (r = e.angle) && void 0 !== r ? r : 0 };
          }
        }
        (o(qe, "z$__type__Props", void 0),
          o(qe, "uniforms", {
            angle: { value: 0, method: "uniform1f", type: "float" },
            colors: {
              value: 4294967295,
              validator: e => e.reduce((e, t) => e.concat(b(t)), []),
              updateProgramValue: Ve,
              size: e => e.colors.length,
              method: "uniform4fv",
              type: "vec4",
            },
            stops: { value: [], size: e => e.colors.length, method: "uniform1fv", type: "float" },
          }),
          o(qe, "methods", {
            calcPoint:
              "\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    ",
          }),
          o(qe, "ColorLoop", e => {
            for (var t = "", r = 2; r < e; r++)
              t += `colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r - 1}]) / (stops[${r}] - stops[${r - 1}]), 0.0, 1.0));`;
            return t;
          }),
          o(
            qe,
            "onColorize",
            e =>
              `\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_nodeCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ${e.colors.length || 1};\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    `,
          ));
        class Xe extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "grayscale"));
          }
          static getEffectKey() {
            return "grayscale";
          }
          static resolveDefaults(e) {
            var t;
            return { amount: null !== (t = e.amount) && void 0 !== t ? t : 1 };
          }
        }
        (o(Xe, "uniforms", { amount: { value: 1, method: "uniform1f", type: "float" } }),
          o(
            Xe,
            "onColorize",
            "\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ",
          ));
        class Ye extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "borderRight"));
          }
          static getEffectKey() {
            return "borderRight";
          }
          static resolveDefaults(e) {
            var t, r;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 10,
              color: null !== (r = e.color) && void 0 !== r ? r : 4294967295,
            };
          }
        }
        (o(Ye, "z$__type__Props", void 0),
          o(Ye, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            color: { value: 4294967295, updateProgramValue: Ge, method: "uniform4fv", type: "vec4" },
          }),
          o(Ye, "methods", {
            fillMask:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
            rectDist:
              "\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    ",
          }),
          o(
            Ye,
            "onEffectMask",
            "\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ",
          ),
          o(Ye, "onColorize", "\n    return color;\n  "));
        class Qe extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "borderTop"));
          }
          static getEffectKey() {
            return "borderTop";
          }
          static resolveDefaults(e) {
            var t, r;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 10,
              color: null !== (r = e.color) && void 0 !== r ? r : 4294967295,
            };
          }
        }
        (o(Qe, "z$__type__Props", void 0),
          o(Qe, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            color: { value: 4294967295, updateProgramValue: Ge, method: "uniform4fv", type: "vec4" },
          }),
          o(Qe, "methods", {
            fillMask:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
            rectDist:
              "\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    ",
          }),
          o(
            Qe,
            "onEffectMask",
            "\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ",
          ),
          o(Qe, "onColorize", "\n    return color;\n  "));
        class Je extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "borderBottom"));
          }
          static getEffectKey() {
            return "borderBottom";
          }
          static resolveDefaults(e) {
            var t, r;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 10,
              color: null !== (r = e.color) && void 0 !== r ? r : 4294967295,
            };
          }
        }
        (o(Je, "z$__type__Props", void 0),
          o(Je, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            color: { value: 4294967295, updateProgramValue: Ge, method: "uniform4fv", type: "vec4" },
          }),
          o(Je, "methods", {
            fillMask:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
            rectDist:
              "\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    ",
          }),
          o(
            Je,
            "onEffectMask",
            "\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ",
          ),
          o(Je, "onColorize", "\n    return color;\n  "));
        class Ze extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "borderLeft"));
          }
          static getEffectKey() {
            return "borderLeft";
          }
          static resolveDefaults(e) {
            var t, r;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 10,
              color: null !== (r = e.color) && void 0 !== r ? r : 4294967295,
            };
          }
        }
        (o(Ze, "z$__type__Props", void 0),
          o(Ze, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            color: { value: 4294967295, updateProgramValue: Ge, method: "uniform4fv", type: "vec4" },
          }),
          o(Ze, "methods", {
            fillMask:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
            rectDist:
              "\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    ",
          }),
          o(
            Ze,
            "onEffectMask",
            "\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ",
          ),
          o(Ze, "onColorize", "\n    return color;\n  "));
        class et extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "glitch"));
          }
          static getEffectKey(e) {
            return "glitch";
          }
          static resolveDefaults(e) {
            var t, r, i, n, a;
            return {
              amplitude: null !== (t = e.amplitude) && void 0 !== t ? t : 0.2,
              narrowness: null !== (r = e.narrowness) && void 0 !== r ? r : 4,
              blockiness: null !== (i = e.blockiness) && void 0 !== i ? i : 2,
              minimizer: null !== (n = e.minimizer) && void 0 !== n ? n : 8,
              time: null !== (a = e.time) && void 0 !== a ? a : Date.now(),
            };
          }
        }
        (o(et, "z$__type__Props", void 0),
          o(et, "uniforms", {
            amplitude: { value: 0, method: "uniform1f", type: "float" },
            narrowness: { value: 0, method: "uniform1f", type: "float" },
            blockiness: { value: 0, method: "uniform1f", type: "float" },
            minimizer: { value: 0, method: "uniform1f", type: "float" },
            time: {
              value: 0,
              method: "uniform1f",
              updateOnBind: !0,
              updateProgramValue: e => {
                var t = (e.value = (Date.now() - e.value) % 1e3);
                e.programValue = t;
              },
              type: "float",
            },
          }),
          o(et, "methods", {
            rand: "\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",
            noise:
              "\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",
            fbm: "\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    ",
          }),
          o(
            et,
            "onColorize",
            "\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ",
          ));
        class tt extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "fadeOut"));
          }
          static getEffectKey() {
            return "fadeOut";
          }
          static resolveDefaults(e) {
            var t;
            return { fade: null !== (t = e.fade) && void 0 !== t ? t : 10 };
          }
        }
        (o(tt, "z$__type__Props", void 0),
          o(tt, "uniforms", {
            fade: {
              value: 0,
              method: "uniform4fv",
              type: "vec4",
              validator: He,
              updateProgramValue: e => {
                var t = e.validatedValue || e.value;
                if (e.programValue instanceof Float32Array) {
                  var r = e.programValue;
                  ((r[0] = t[0]), (r[1] = t[1]), (r[2] = t[2]), (r[3] = t[3]));
                } else e.programValue = new Float32Array(t);
              },
            },
          }),
          o(
            tt,
            "onColorize",
            "\n  vec2 point = v_nodeCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_nodeCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_nodeCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ",
          ));
        class rt extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "radialGradient"));
          }
          static getEffectKey(e) {
            return e.colors.value
              ? `radialGradient${e.colors.value.length}`
              : `radialGradient${e.colors.length}`;
          }
          static resolveDefaults(e) {
            var t,
              r,
              i,
              n,
              a,
              s = null !== (t = e.colors) && void 0 !== t ? t : [4278190080, 4294967295],
              o = e.stops || [];
            if (0 === o.length || o.length !== s.length) {
              for (var l = s.length, u = 0, d = o; u < l; u++)
                o[u]
                  ? ((d[u] = o[u]),
                    void 0 === o[u - 1] &&
                      void 0 !== d[u - 2] &&
                      (d[u - 1] = d[u - 2] + (o[u] - d[u - 2]) / 2))
                  : (d[u] = u * (1 / (s.length - 1)));
              o = d;
            }
            return {
              colors: s,
              stops: o,
              width: null !== (r = e.width) && void 0 !== r ? r : 0,
              height:
                null !== (i = null !== (n = e.height) && void 0 !== n ? n : e.width) && void 0 !== i ? i : 0,
              pivot: null !== (a = e.pivot) && void 0 !== a ? a : [0.5, 0.5],
            };
          }
        }
        (o(rt, "z$__type__Props", void 0),
          o(rt, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            height: { value: 0, method: "uniform1f", type: "float" },
            pivot: {
              value: [0.5, 0.5],
              updateProgramValue: e => {
                var t = e.validatedValue || e.value;
                if (e.programValue instanceof Float32Array) {
                  var r = e.programValue;
                  ((r[0] = t[0]), (r[1] = t[1]));
                } else e.programValue = new Float32Array(t);
              },
              method: "uniform2fv",
              type: "vec2",
            },
            colors: {
              value: 4294967295,
              validator: e => e.reduce((e, t) => e.concat(b(t)), []),
              updateProgramValue: Ve,
              size: e => e.colors.length,
              method: "uniform4fv",
              type: "vec4",
            },
            stops: { value: [], size: e => e.colors.length, method: "uniform1fv", type: "float" },
          }),
          o(rt, "methods", {
            getGradientColor:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
          }),
          o(rt, "ColorLoop", e => {
            for (var t = "", r = 2; r < e; r++)
              t += `colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r - 1}]) / (stops[${r}] - stops[${r - 1}]), 0.0, 1.0));`;
            return t;
          }),
          o(
            rt,
            "onColorize",
            e =>
              `\n      vec2 point = v_nodeCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      dist = clamp(dist, 0.0, 1.0);\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ${e.colors.length || 1};\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    `,
          ));
        class it extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "radialProgress"));
          }
          static getEffectKey() {
            return "radialProgress";
          }
          static resolveDefaults(e) {
            var t, r, i, n, a, s, o;
            return {
              width: null !== (t = e.width) && void 0 !== t ? t : 10,
              progress: null !== (r = e.progress) && void 0 !== r ? r : 0.5,
              offset: null !== (i = e.offset) && void 0 !== i ? i : 0,
              range: null !== (n = e.range) && void 0 !== n ? n : 2 * Math.PI,
              rounded: null !== (a = e.rounded) && void 0 !== a && a,
              radius: null !== (s = e.radius) && void 0 !== s ? s : 1,
              color: null !== (o = e.color) && void 0 !== o ? o : 4294967295,
            };
          }
        }
        (o(it, "z$__type__Props", void 0),
          o(it, "uniforms", {
            width: { value: 0, method: "uniform1f", type: "float" },
            progress: { value: 0.5, method: "uniform1f", type: "float" },
            offset: { value: 0, method: "uniform1f", type: "float" },
            range: { value: 0, method: "uniform1f", type: "float" },
            rounded: { value: 0, method: "uniform1f", type: "float", validator: e => (e ? 1 : 0) },
            radius: { value: 1, method: "uniform1f", type: "float" },
            color: { value: 4294967295, updateProgramValue: Ge, method: "uniform4fv", type: "vec4" },
          }),
          o(it, "methods", {
            rotateUV:
              "\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",
            drawDot:
              "\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    ",
          }),
          o(
            it,
            "onEffectMask",
            "\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_nodeCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  ",
          ),
          o(it, "onColorize", "\n    return color;\n  "));
        class nt extends Oe {
          constructor(...e) {
            (super(...e), o(this, "name", "holePunch"));
          }
          static getEffectKey() {
            return "holePunch";
          }
          static resolveDefaults(e) {
            var t;
            return {
              x: e.x || 0,
              y: e.y || 0,
              width: e.width || 50,
              height: e.height || 50,
              radius: null !== (t = e.radius) && void 0 !== t ? t : 0,
            };
          }
        }
        (o(nt, "z$__type__Props", void 0),
          o(nt, "uniforms", {
            x: { value: 0, method: "uniform1f", type: "float" },
            y: { value: 0, method: "uniform1f", type: "float" },
            width: { value: 0, method: "uniform1f", type: "float" },
            height: { value: 0, method: "uniform1f", type: "float" },
            radius: {
              value: 0,
              method: "uniform4fv",
              type: "vec4",
              updateOnBind: !0,
              validator: He,
              updateProgramValue: Ke,
            },
          }),
          o(nt, "methods", {
            fillMask:
              "\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",
            boxDist:
              "\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    ",
          }),
          o(
            nt,
            "onShaderMask",
            "\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_nodeCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  ",
          ),
          o(nt, "onEffectMask", "\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  "));
        class at extends Le {
          constructor(e) {
            (super(), o(this, "shType", void 0), (this.shType = e));
          }
          bindRenderOp() {}
          bindProps() {}
          attach() {}
          detach() {}
        }
        class st {
          constructor(e, t, r, i) {
            var n = this;
            (o(this, "type", void 0),
              o(this, "shader", void 0),
              o(this, "resolvedProps", void 0),
              o(this, "props", void 0),
              (this.type = e),
              (this.shader = t),
              (this.resolvedProps = r));
            for (
              var a = Object.keys(r),
                s = a.length,
                l = {},
                u = function () {
                  var e = a[d];
                  Object.defineProperty(l, e, {
                    get: () => n.resolvedProps[e],
                    set: t => {
                      ((n.resolvedProps[e] = t), i.requestRender());
                    },
                  });
                },
                d = 0;
              d < s;
              d++
            )
              u();
            this.props = l;
          }
          getResolvedProps() {
            return this.resolvedProps;
          }
        }
        class ot {
          constructor(e, t, r) {
            var i = this;
            (o(this, "shader", void 0),
              o(this, "resolvedProps", void 0),
              o(this, "props", void 0),
              o(this, "type", void 0),
              (this.shader = e),
              (this.type = "DynamicShader"),
              (this.resolvedProps = t));
            for (
              var n = r.getRegisteredEffects(),
                a = {},
                s = t.effects,
                l = s.length,
                u = function (e) {
                  var t = s[e],
                    o = t.name,
                    l = t.props,
                    u = t.type;
                  if (void 0 === o) return 1;
                  for (
                    var d = {},
                      h = Object.keys(l),
                      c = h.length,
                      f = function () {
                        var t = h[p];
                        Object.defineProperty(d, t, {
                          get: () => i.resolvedProps.effects[e].props[t].value,
                          set: a => {
                            var s,
                              o,
                              d = i.resolvedProps.effects[e].props[t];
                            ((d.value = a), d.hasValidator) &&
                              (a = d.validatedValue =
                                null === (s = n[u].uniforms[t]) || void 0 === s ? void 0 : s.validator(a, l));
                            d.hasProgramValueUpdater
                              ? null === (o = n[u].uniforms[t]) || void 0 === o || o.updateProgramValue(d)
                              : (d.programValue = a);
                            r.renderer.stage.requestRender();
                          },
                        });
                      },
                      p = 0;
                    p < c;
                    p++
                  )
                    f();
                  Object.defineProperty(a, o, { get: () => d });
                },
                d = 0;
              d < l;
              d++
            )
              u(d);
            this.props = a;
          }
          getResolvedProps() {
            return this.resolvedProps;
          }
        }
        class lt {
          constructor() {
            (o(this, "shCache", new Map()),
              o(this, "shConstructors", {}),
              o(this, "attachedShader", null),
              o(this, "effectConstructors", {}),
              o(this, "renderer", void 0),
              this.registerShaderType("DefaultShader", _e),
              this.registerShaderType("DefaultShaderBatched", Pe),
              this.registerShaderType("RoundedRectangle", Be),
              this.registerShaderType("DynamicShader", Ue),
              this.registerShaderType("SdfShader", je),
              this.registerEffectType("border", ze),
              this.registerEffectType("borderBottom", Je),
              this.registerEffectType("borderLeft", Ze),
              this.registerEffectType("borderRight", Ye),
              this.registerEffectType("borderTop", Qe),
              this.registerEffectType("fadeOut", tt),
              this.registerEffectType("linearGradient", qe),
              this.registerEffectType("radialGradient", rt),
              this.registerEffectType("grayscale", Xe),
              this.registerEffectType("glitch", et),
              this.registerEffectType("radius", We),
              this.registerEffectType("radialProgress", it),
              this.registerEffectType("holePunch", nt));
          }
          registerShaderType(e, t) {
            this.shConstructors[e] = t;
          }
          registerEffectType(e, t) {
            this.effectConstructors[e] = t;
          }
          getRegisteredEffects() {
            return this.effectConstructors;
          }
          getRegisteredShaders() {
            return this.shConstructors;
          }
          loadShader(e, t) {
            if (!this.renderer) throw new Error("Renderer is not been defined");
            var r = this.shConstructors[e];
            if (!r) throw new Error(`Shader type "${e}" is not registered`);
            if ("canvas" === this.renderer.mode && r.prototype instanceof De)
              return this._createShaderCtr(e, new at(e), t);
            if ("DynamicShader" === e) return this.loadDynamicShader(t);
            var i = r.resolveDefaults(t),
              n = r.makeCacheKey(i) || r.name;
            if (n && this.shCache.has(n)) return this._createShaderCtr(e, this.shCache.get(n), i);
            var a = new r(this.renderer, t);
            return (n && this.shCache.set(n, a), this._createShaderCtr(e, a, i));
          }
          loadDynamicShader(e) {
            if (!this.renderer) throw new Error("Renderer is not been defined");
            var t = Ue.resolveDefaults(e, this.effectConstructors),
              r = Ue.makeCacheKey(t, this.effectConstructors);
            if (r && this.shCache.has(r)) return this._createDynShaderCtr(this.shCache.get(r), t);
            var i = new Ue(this.renderer, e, this.effectConstructors);
            return (r && this.shCache.set(r, i), this._createDynShaderCtr(i, t));
          }
          _createShaderCtr(e, t, r) {
            return new st(e, t, r, this.renderer.stage);
          }
          _createDynShaderCtr(e, t) {
            return (e.bindUniformMethods(t), new ot(e, t, this));
          }
          useShader(e) {
            this.attachedShader !== e &&
              (this.attachedShader && this.attachedShader.detach(), e.attach(), (this.attachedShader = e));
          }
        }
        var ut = {
          x: (e, t) => {
            e.props.x = t;
          },
          y: (e, t) => {
            e.props.y = t;
          },
          width: (e, t) => {
            e.props.width = t;
          },
          height: (e, t) => {
            e.props.height = t;
          },
          color: (e, t) => {
            e.props.color = t;
          },
          zIndex: (e, t) => {
            e.props.zIndex = t;
          },
          fontFamily: (e, t) => {
            e.props.fontFamily = t;
          },
          fontWeight: (e, t) => {
            e.props.fontWeight = t;
          },
          fontStyle: (e, t) => {
            e.props.fontStyle = t;
          },
          fontStretch: (e, t) => {
            e.props.fontStretch = t;
          },
          fontSize: (e, t) => {
            e.props.fontSize = t;
          },
          text: (e, t) => {
            e.props.text = t;
          },
          textAlign: (e, t) => {
            e.props.textAlign = t;
          },
          contain: (e, t) => {
            e.props.contain = t;
          },
          offsetY: (e, t) => {
            e.props.offsetY = t;
          },
          scrollable: (e, t) => {
            e.props.scrollable = t;
          },
          scrollY: (e, t) => {
            e.props.scrollY = t;
          },
          letterSpacing: (e, t) => {
            e.props.letterSpacing = t;
          },
          lineHeight: (e, t) => {
            e.props.lineHeight = t;
          },
          maxLines: (e, t) => {
            e.props.maxLines = t;
          },
          textBaseline: (e, t) => {
            e.props.textBaseline = t;
          },
          verticalAlign: (e, t) => {
            e.props.verticalAlign = t;
          },
          overflowSuffix: (e, t) => {
            e.props.overflowSuffix = t;
          },
          debug: (e, t) => {
            e.props.debug = t;
          },
        };
        class dt {
          constructor(e) {
            (o(this, "stage", void 0), o(this, "set", void 0), (this.stage = e));
            var r = t(t({}, ut), this.getPropertySetters()),
              i = {};
            (Object.keys(r).forEach(e => {
              Object.defineProperty(i, e, {
                value: (t, i) => {
                  t.props[e] !== i && (r[e](t, i), this.stage.requestRender());
                },
                writable: !1,
                configurable: !1,
              });
            }),
              (this.set = i));
          }
          setStatus(e, t, r) {
            e.status !== t && ((e.status = t), e.emitter.emit(t, r));
          }
          setIsRenderable(e, t) {
            e.isRenderable = t;
          }
          destroyState(e) {
            (this.setStatus(e, "destroyed"), e.emitter.removeAllListeners());
          }
          scheduleUpdateState(e) {
            e.updateScheduled ||
              ((e.updateScheduled = !0),
              queueMicrotask(() => {
                "destroyed" !== e.status && ((e.updateScheduled = !1), this.updateState(e));
              }));
          }
        }
        class ht {
          constructor() {
            o(this, "data", {});
          }
          reset() {
            this.data = {};
          }
          increment(e) {
            (this.data[e] || (this.data[e] = 0), this.data[e]++);
          }
          getData() {
            return t({}, this.data);
          }
        }
        class ct {
          constructor(e, t) {
            (o(this, "stage", void 0),
              o(this, "memUsed", 0),
              o(this, "loadedTextures", []),
              o(this, "criticalThreshold", void 0),
              o(this, "targetThreshold", void 0),
              o(this, "cleanupInterval", void 0),
              o(this, "debugLogging", void 0),
              o(this, "lastCleanupTime", 0),
              o(this, "baselineMemoryAllocation", void 0),
              o(this, "hasWarnedAboveCritical", !1),
              o(this, "criticalCleanupRequested", !1),
              o(this, "doNotExceedCriticalThreshold", void 0),
              o(this, "frameTime", 0),
              (this.stage = e));
            var r = t.criticalThreshold,
              i = t.doNotExceedCriticalThreshold;
            ((this.doNotExceedCriticalThreshold = i || !1), (this.criticalThreshold = Math.round(r)));
            var n = Math.max(0, Math.min(1, t.targetThresholdLevel));
            if (
              ((this.cleanupInterval = t.cleanupInterval),
              (this.debugLogging = t.debugLogging),
              (this.baselineMemoryAllocation = Math.round(t.baselineMemoryAllocation)),
              (this.targetThreshold = Math.max(Math.round(r * n), this.baselineMemoryAllocation)),
              (this.memUsed = Math.round(t.baselineMemoryAllocation)),
              t.debugLogging)
            ) {
              var a = 0;
              setInterval(() => {
                a !== this.memUsed &&
                  ((a = this.memUsed),
                  console.log(
                    `[TextureMemoryManager] Memory used: ${B(this.memUsed)} mb / ${B(this.criticalThreshold)} mb (${((this.memUsed / this.criticalThreshold) * 100).toFixed(1)}%)`,
                  ));
              }, 1e3);
            }
            0 === r && (this.setTextureMemUse = () => {});
          }
          setTextureMemUse(e, t) {
            if (((this.memUsed -= e.memUsed), 0 === t)) {
              var r = this.loadedTextures.indexOf(e);
              return (-1 !== r && (this.loadedTextures[r] = null), void (e.memUsed = 0));
            }
            if (((e.memUsed = t), (this.memUsed += t), -1 === this.loadedTextures.indexOf(e))) {
              var i = this.loadedTextures.indexOf(null);
              -1 !== i ? (this.loadedTextures[i] = e) : this.loadedTextures.push(e);
            }
            this.memUsed > this.criticalThreshold && (this.criticalCleanupRequested = !0);
          }
          checkCleanup() {
            return (
              this.criticalCleanupRequested ||
              (this.memUsed > this.targetThreshold &&
                this.frameTime - this.lastCleanupTime >= this.cleanupInterval)
            );
          }
          checkCriticalCleanup() {
            return this.memUsed > this.criticalThreshold;
          }
          destroyTexture(e) {
            !0 === this.debugLogging &&
              console.log(`[TextureMemoryManager] Destroying texture. State: ${e.state}`);
            var t = this.loadedTextures.indexOf(e);
            (-1 !== t && (this.loadedTextures[t] = null),
              this.stage.txManager.removeTextureFromCache(e),
              e.destroy(),
              (this.memUsed -= e.memUsed),
              (e.memUsed = 0));
          }
          cleanup() {
            var e = this.criticalCleanupRequested;
            ((this.lastCleanupTime = this.frameTime),
              !0 === e &&
                this.stage.queueFrameEvent("criticalCleanup", {
                  memUsed: this.memUsed,
                  criticalThreshold: this.criticalThreshold,
                }),
              !0 === this.debugLogging &&
                console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${e}.`));
            for (
              var t = e ? this.criticalThreshold : this.targetThreshold, r = this.memUsed, i = 0;
              i < this.loadedTextures.length && !(r < t);
              i++
            ) {
              var n = this.loadedTextures[i];
              if (
                n &&
                (n.type === m.image || n.type === m.noise || n.type === m.renderToTexture) &&
                !0 === n.canBeCleanedUp()
              ) {
                var a = n.memUsed;
                (this.destroyTexture(n), (r -= a));
              }
            }
            this.memUsed >= this.criticalThreshold
              ? (this.stage.queueFrameEvent("criticalCleanupFailed", {
                  memUsed: this.memUsed,
                  criticalThreshold: this.criticalThreshold,
                }),
                this.hasWarnedAboveCritical ||
                  !0 !== this.debugLogging ||
                  (console.warn(
                    `[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`,
                  ),
                  (this.hasWarnedAboveCritical = !0)))
              : ((this.criticalCleanupRequested = !1), (this.hasWarnedAboveCritical = !1));
          }
          getMemoryInfo() {
            var e,
              t = 0,
              r = this.baselineMemoryAllocation,
              i = l(this.loadedTextures);
            try {
              for (i.s(); !(e = i.n()).done; ) {
                var n = e.value;
                n && n.renderable && ((t += 1), (r += n.memUsed));
              }
            } catch (s) {
              i.e(s);
            } finally {
              i.f();
            }
            var a = this.loadedTextures.filter(e => null !== e).length;
            return {
              criticalThreshold: this.criticalThreshold,
              targetThreshold: this.targetThreshold,
              renderableMemUsed: r,
              memUsed: this.memUsed,
              renderableTexturesLoaded: t,
              loadedTextures: a,
              baselineMemoryAllocation: this.baselineMemoryAllocation,
            };
          }
        }
        class ft {
          constructor(e, t) {
            (o(this, "textureSource", void 0),
              o(this, "memManager", void 0),
              o(this, "state", "freed"),
              (this.memManager = e),
              (this.textureSource = t));
          }
          setTextureMemUse(e) {
            this.memManager.setTextureMemUse(this.textureSource, e);
          }
          get renderable() {
            return this.textureSource.renderable;
          }
        }
        class pt {
          constructor(e) {
            (o(this, "options", void 0),
              o(this, "mode", void 0),
              o(this, "stage", void 0),
              o(this, "txManager", void 0),
              o(this, "txMemManager", void 0),
              o(this, "shManager", void 0),
              o(this, "rttNodes", []),
              (this.options = e),
              (this.stage = e.stage),
              (this.txManager = e.txManager),
              (this.txMemManager = e.txMemManager),
              (this.shManager = e.shManager));
          }
        }
        class gt extends H {
          constructor(e, t, r) {
            (super(e, t),
              o(this, "textRenderer", void 0),
              o(this, "trState", void 0),
              o(this, "_textRendererOverride", null),
              o(this, "onTextLoaded", () => {
                var e = this.contain,
                  t = this.trState.props.width,
                  r = this.trState.props.height,
                  i = this.trState.textW || 0,
                  n = this.trState.textH || 0;
                ("both" === e
                  ? ((this.props.width = t), (this.props.height = r))
                  : "width" === e
                    ? ((this.props.width = t), (this.props.height = n))
                    : "none" === e && ((this.props.width = i), (this.props.height = n)),
                  this.updateLocalTransform(),
                  this.stage.requestRender(),
                  this.emit("loaded", {
                    type: "text",
                    dimensions: { width: this.trState.textW || 0, height: this.trState.textH || 0 },
                  }));
              }),
              o(this, "onTextFailed", (e, t) => {
                this.emit("failed", { type: "text", error: t });
              }),
              (this._textRendererOverride = t.textRendererOverride),
              (this.textRenderer = r));
            var i = this.createState({
              x: 0,
              y: 0,
              width: t.width,
              height: t.height,
              textAlign: t.textAlign,
              color: t.color,
              zIndex: t.zIndex,
              contain: t.contain,
              scrollable: t.scrollable,
              scrollY: t.scrollY,
              offsetY: t.offsetY,
              letterSpacing: t.letterSpacing,
              debug: t.debug,
              fontFamily: t.fontFamily,
              fontSize: t.fontSize,
              fontStretch: t.fontStretch,
              fontStyle: t.fontStyle,
              fontWeight: t.fontWeight,
              text: t.text,
              lineHeight: t.lineHeight,
              maxLines: t.maxLines,
              textBaseline: t.textBaseline,
              verticalAlign: t.verticalAlign,
              overflowSuffix: t.overflowSuffix,
            });
            this.trState = i;
          }
          get width() {
            return this.props.width;
          }
          set width(e) {
            ((this.props.width = e),
              this.textRenderer.set.width(this.trState, e),
              "none" === this.contain && this.setUpdateType(G.Local));
          }
          get height() {
            return this.props.height;
          }
          set height(e) {
            ((this.props.height = e),
              this.textRenderer.set.height(this.trState, e),
              "both" !== this.contain && this.setUpdateType(G.Local));
          }
          get color() {
            return this.trState.props.color;
          }
          set color(e) {
            this.textRenderer.set.color(this.trState, e);
          }
          get text() {
            return this.trState.props.text;
          }
          set text(e) {
            this.textRenderer.set.text(this.trState, e);
          }
          get textRendererOverride() {
            return this._textRendererOverride;
          }
          set textRendererOverride(e) {
            ((this._textRendererOverride = e), this.textRenderer.destroyState(this.trState));
            var t = this.stage.resolveTextRenderer(this.trState.props, this._textRendererOverride);
            t
              ? ((this.textRenderer = t), (this.trState = this.createState(this.trState.props)))
              : console.warn("Text Renderer not found for font", this.trState.props.fontFamily);
          }
          get fontSize() {
            return this.trState.props.fontSize;
          }
          set fontSize(e) {
            this.textRenderer.set.fontSize(this.trState, e);
          }
          get fontFamily() {
            return this.trState.props.fontFamily;
          }
          set fontFamily(e) {
            this.textRenderer.set.fontFamily(this.trState, e);
          }
          get fontStretch() {
            return this.trState.props.fontStretch;
          }
          set fontStretch(e) {
            this.textRenderer.set.fontStretch(this.trState, e);
          }
          get fontStyle() {
            return this.trState.props.fontStyle;
          }
          set fontStyle(e) {
            this.textRenderer.set.fontStyle(this.trState, e);
          }
          get fontWeight() {
            return this.trState.props.fontWeight;
          }
          set fontWeight(e) {
            this.textRenderer.set.fontWeight(this.trState, e);
          }
          get textAlign() {
            return this.trState.props.textAlign;
          }
          set textAlign(e) {
            this.textRenderer.set.textAlign(this.trState, e);
          }
          get contain() {
            return this.trState.props.contain;
          }
          set contain(e) {
            this.textRenderer.set.contain(this.trState, e);
          }
          get scrollable() {
            return this.trState.props.scrollable;
          }
          set scrollable(e) {
            this.textRenderer.set.scrollable(this.trState, e);
          }
          get scrollY() {
            return this.trState.props.scrollY;
          }
          set scrollY(e) {
            this.textRenderer.set.scrollY(this.trState, e);
          }
          get offsetY() {
            return this.trState.props.offsetY;
          }
          set offsetY(e) {
            this.textRenderer.set.offsetY(this.trState, e);
          }
          get letterSpacing() {
            return this.trState.props.letterSpacing;
          }
          set letterSpacing(e) {
            this.textRenderer.set.letterSpacing(this.trState, e);
          }
          get lineHeight() {
            return this.trState.props.lineHeight;
          }
          set lineHeight(e) {
            this.textRenderer.set.lineHeight(this.trState, e);
          }
          get maxLines() {
            return this.trState.props.maxLines;
          }
          set maxLines(e) {
            this.textRenderer.set.maxLines(this.trState, e);
          }
          get textBaseline() {
            return this.trState.props.textBaseline;
          }
          set textBaseline(e) {
            this.textRenderer.set.textBaseline(this.trState, e);
          }
          get verticalAlign() {
            return this.trState.props.verticalAlign;
          }
          set verticalAlign(e) {
            this.textRenderer.set.verticalAlign(this.trState, e);
          }
          get overflowSuffix() {
            return this.trState.props.overflowSuffix;
          }
          set overflowSuffix(e) {
            this.textRenderer.set.overflowSuffix(this.trState, e);
          }
          get debug() {
            return this.trState.props.debug;
          }
          set debug(e) {
            this.textRenderer.set.debug(this.trState, e);
          }
          update(e, t) {
            (super.update(e, t),
              this.globalTransform,
              this.textRenderer.set.x(this.trState, this.globalTransform.tx),
              this.textRenderer.set.y(this.trState, this.globalTransform.ty));
          }
          checkBasicRenderability() {
            return (
              0 !== this.worldAlpha &&
              !0 !== this.isOutOfBounds() &&
              !(!this.trState || "" === this.trState.props.text)
            );
          }
          setRenderable(e) {
            (super.setRenderable(e), this.textRenderer.setIsRenderable(this.trState, e));
          }
          renderQuads(e) {
            var t;
            if ((this.globalTransform, this.textRenderer.renderQuads)) {
              if (this.parentHasRenderTexture) {
                if (!e.renderToTextureActive) return;
                if (this.parentRenderTexture !== e.activeRttNode) return;
              }
              (this.parentHasRenderTexture &&
                null !== (t = this.props.parent) &&
                void 0 !== t &&
                t.rtt &&
                ((this.globalTransform = L.identity()),
                this.localTransform && this.globalTransform.multiply(this.localTransform)),
                this.globalTransform,
                this.textRenderer.renderQuads(
                  this.trState,
                  this.globalTransform,
                  this.clippingRect,
                  this.worldAlpha,
                  this.parentHasRenderTexture,
                  this.framebufferDimensions,
                ));
            } else super.renderQuads(e);
          }
          destroy() {
            (super.destroy(), this.textRenderer.destroyState(this.trState));
          }
          createState(e) {
            var t = this.textRenderer.createState(e, this);
            return (
              t.emitter.on("loaded", this.onTextLoaded),
              t.emitter.on("failed", this.onTextFailed),
              this.textRenderer.scheduleUpdateState(t),
              t
            );
          }
        }
        class mt {
          constructor(e) {
            (o(this, "options", void 0),
              o(this, "animationManager", void 0),
              o(this, "txManager", void 0),
              o(this, "txMemManager", void 0),
              o(this, "fontManager", void 0),
              o(this, "textRenderers", void 0),
              o(this, "shManager", void 0),
              o(this, "renderer", void 0),
              o(this, "root", void 0),
              o(this, "interactiveNodes", new Set()),
              o(this, "boundsMargin", void 0),
              o(this, "defShaderCtr", void 0),
              o(this, "strictBound", void 0),
              o(this, "preloadBound", void 0),
              o(this, "strictBounds", void 0),
              o(this, "defaultTexture", null),
              o(this, "targetFrameTime", 0),
              o(this, "eventBus", void 0),
              o(this, "deltaTime", 0),
              o(this, "lastFrameTime", 0),
              o(this, "currentFrameTime", 0),
              o(this, "fpsNumFrames", 0),
              o(this, "fpsElapsedTime", 0),
              o(this, "numQuadsRendered", 0),
              o(this, "renderRequested", !1),
              o(this, "frameEventQueue", []),
              o(this, "fontResolveMap", {}),
              o(this, "contextSpy", null),
              (this.options = e));
            var t = e.canvas,
              r = e.clearColor,
              i = e.appWidth,
              n = e.appHeight,
              a = e.boundsMargin,
              s = e.enableContextSpy,
              l = e.forceWebGL2,
              u = e.numImageWorkers,
              d = e.textureMemory,
              h = e.renderEngine,
              f = e.fontEngines,
              p = e.createImageBitmapSupport,
              g = e.maxRetryCount;
            ((this.eventBus = e.eventBus),
              (this.targetFrameTime = e.targetFPS > 0 ? 1e3 / e.targetFPS : 0),
              (this.txManager = new Ie(this, {
                numImageWorkers: u,
                createImageBitmapSupport: p,
                maxRetryCount: g,
              })),
              this.txManager.on("initialized", () => {
                this.requestRender();
              }),
              (this.txMemManager = new ct(this, d)),
              (this.shManager = new lt()),
              (this.animationManager = new W()),
              (this.contextSpy = s ? new ht() : null),
              (this.strictBounds = e.strictBounds));
            var m = [0, 0, 0, 0];
            (a && (m = Array.isArray(a) ? a : [a, a, a, a]),
              (this.boundsMargin = m),
              (this.strictBound = S(0, 0, i, n)),
              (this.preloadBound = k(this.strictBound, m)));
            var v = {
              stage: this,
              canvas: t,
              pixelRatio: e.devicePhysicalPixelRatio * e.deviceLogicalPixelRatio,
              clearColor: null != r ? r : 4278190080,
              bufferMemory: 2e6,
              txManager: this.txManager,
              txMemManager: this.txMemManager,
              shManager: this.shManager,
              contextSpy: this.contextSpy,
              forceWebGL2: l,
            };
            this.renderer = new h(v);
            var y = this.renderer.mode || "webgl";
            (this.createDefaultTexture(),
              (this.defShaderCtr = this.renderer.getDefShaderCtr()),
              (c = "webgl" === y),
              (this.txManager.renderer = this.renderer),
              (this.textRenderers = {}),
              f.forEach(e => {
                var t = new e(this),
                  r = t.type;
                "sdf" !== r || "canvas" !== y
                  ? t instanceof dt &&
                    ("canvas" === r
                      ? (this.textRenderers.canvas = t)
                      : "sdf" === r && (this.textRenderers.sdf = t))
                  : console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...");
              }),
              0 === Object.keys(this.textRenderers).length &&
                console.warn("No text renderers available. Your text will not render."),
              (this.fontManager = new Ce(this.textRenderers)));
            var T,
              b,
              E,
              x,
              w = new H(this, {
                x: 0,
                y: 0,
                width: i,
                height: n,
                alpha: 1,
                autosize: !1,
                boundsMargin: null,
                clipping: !1,
                color: 0,
                colorTop: 0,
                colorBottom: 0,
                colorLeft: 0,
                colorRight: 0,
                colorTl: 0,
                colorTr: 0,
                colorBl: 0,
                colorBr: 0,
                zIndex: 0,
                zIndexLocked: 0,
                scaleX: 1,
                scaleY: 1,
                mountX: 0,
                mountY: 0,
                mount: 0,
                pivot: 0.5,
                pivotX: 0.5,
                pivotY: 0.5,
                rotation: 0,
                parent: null,
                texture: null,
                textureOptions: {},
                shader: this.defShaderCtr,
                rtt: !1,
                src: null,
                scale: 1,
                preventCleanup: !1,
                strictBounds: this.strictBounds,
              });
            ((this.root = w),
              (T = this),
              (b = !1),
              (E = 0),
              (x = (e = 0) => {
                var t = T.targetFrameTime;
                if (t > 0 && e - E < t) setTimeout(() => requestAnimationFrame(x), t - (e - E));
                else {
                  if (((E = e), T.updateFrameTime(), T.updateAnimations(), !T.hasSceneUpdates()))
                    return (
                      T.calculateFps(),
                      t > 0
                        ? setTimeout(() => requestAnimationFrame(x), Math.max(t, 16.666666666666668))
                        : setTimeout(() => requestAnimationFrame(x), 16.666666666666668),
                      b || (T.eventBus.emit("idle"), (b = !0)),
                      !0 === T.txMemManager.checkCleanup() && T.txMemManager.cleanup(),
                      void T.flushFrameEvents()
                    );
                  if (((b = !1), T.drawFrame(), T.flushFrameEvents(), t > 0)) {
                    var r = Math.max(0, t - (performance.now() - e));
                    setTimeout(() => requestAnimationFrame(x), r);
                  } else requestAnimationFrame(x);
                }
              }),
              requestAnimationFrame(x));
          }
          setClearColor(e) {
            (this.renderer.updateClearColor(e), (this.renderRequested = !0));
          }
          updateTargetFrameTime() {
            this.targetFrameTime = this.options.targetFPS > 0 ? 1e3 / this.options.targetFPS : 0;
          }
          updateFrameTime() {
            var e = K();
            ((this.lastFrameTime = this.currentFrameTime),
              (this.currentFrameTime = e),
              (this.deltaTime = this.lastFrameTime ? e - this.lastFrameTime : 100 / 6),
              (this.txManager.frameTime = e),
              (this.txMemManager.frameTime = e),
              this.eventBus.emit("frameTick", { time: this.currentFrameTime, delta: this.deltaTime }));
          }
          createDefaultTexture() {
            ((this.defaultTexture = this.txManager.createTexture("ColorTexture", { color: 4294967295 })),
              this.defaultTexture,
              this.txManager.loadTexture(this.defaultTexture, !0),
              this.defaultTexture.setRenderableOwner("stage", !0),
              this.defaultTexture.once("loaded", () => {
                this.requestRender();
              }));
          }
          updateAnimations() {
            var e = this.animationManager;
            this.root && e.update(this.deltaTime);
          }
          hasSceneUpdates() {
            return !!this.root.updateType || this.renderRequested || this.txManager.hasUpdates();
          }
          drawFrame() {
            var e = this.renderer,
              t = this.renderRequested;
            (0 !== this.root.updateType && this.root.update(this.deltaTime, this.root.clippingRect),
              this.txManager.processSome(this.options.textureProcessingTimeLimit).catch(e => {
                console.error("Error processing textures:", e);
              }),
              e.reset(),
              e.rttNodes.length > 0 && e.renderRTTNodes(),
              this.addQuads(this.root),
              null == e || e.render(),
              this.calculateFps(),
              this.calculateQuads(),
              t && (this.renderRequested = !1),
              !0 === this.txMemManager.criticalCleanupRequested && this.txMemManager.cleanup());
          }
          queueFrameEvent(e, t) {
            this.frameEventQueue.push([e, t]);
          }
          flushFrameEvents() {
            var e,
              t = l(this.frameEventQueue);
            try {
              for (t.s(); !(e = t.n()).done; ) {
                var i = r(e.value, 2),
                  n = i[0],
                  a = i[1];
                this.eventBus.emit(n, a);
              }
            } catch (s) {
              t.e(s);
            } finally {
              t.f();
            }
            this.frameEventQueue = [];
          }
          calculateFps() {
            var e = this.options.fpsUpdateInterval;
            if (
              e &&
              (this.fpsNumFrames++, (this.fpsElapsedTime += this.deltaTime), this.fpsElapsedTime >= e)
            ) {
              var t,
                r,
                i,
                n = Math.round((1e3 * this.fpsNumFrames) / this.fpsElapsedTime);
              ((this.fpsNumFrames = 0),
                (this.fpsElapsedTime = 0),
                this.queueFrameEvent("fpsUpdate", {
                  fps: n,
                  contextSpyData:
                    null !== (t = null === (r = this.contextSpy) || void 0 === r ? void 0 : r.getData()) &&
                    void 0 !== t
                      ? t
                      : null,
                }),
                null === (i = this.contextSpy) || void 0 === i || i.reset());
            }
          }
          calculateQuads() {
            var e = this.renderer.getQuadCount();
            e &&
              e !== this.numQuadsRendered &&
              ((this.numQuadsRendered = e), this.queueFrameEvent("quadsUpdate", { quads: e }));
          }
          addQuads(e) {
            (this.renderer, !0 === e.isRenderable && e.renderQuads(this.renderer));
            for (var t = 0; t < e.children.length; t++) {
              var r = e.children[t];
              void 0 !== r &&
                (0 === r.worldAlpha ||
                  (!0 === r.strictBounds && r.renderState === _.OutOfBounds) ||
                  this.addQuads(r));
            }
          }
          requestRender() {
            this.renderRequested = !0;
          }
          findNodesAtPoint(e) {
            var t,
              r = e.x / this.options.deviceLogicalPixelRatio,
              i = e.y / this.options.deviceLogicalPixelRatio,
              n = [],
              a = l(this.interactiveNodes);
            try {
              for (a.s(); !(t = a.n()).done; ) {
                var s = t.value;
                !1 !== s.isRenderable && !0 === I(r, i, s.renderBound) && n.push(s);
              }
            } catch (o) {
              a.e(o);
            } finally {
              a.f();
            }
            return n;
          }
          getNodeFromPosition(e) {
            var t = this.findNodesAtPoint(e);
            if (0 === t.length) return null;
            for (var r = t[0], i = 0; i < t.length; i++) t[i].zIndex > r.zIndex && (r = t[i]);
            return r || null;
          }
          resolveTextRenderer(e, t = null) {
            var i = `${e.fontFamily}${e.fontStyle}${e.fontWeight}${e.fontStretch}${t || ""}`;
            if (void 0 !== this.fontResolveMap[i]) return this.fontResolveMap[i];
            var n = t,
              a = !1;
            if (n) {
              var s = this.textRenderers[n];
              s
                ? s.canRenderFont(e) ||
                  (console.warn(`Cannot use override text renderer '${n}' for font`, e), (n = null), (a = !0))
                : (console.warn(`Text renderer override '${n}' not found.`), (n = null), (a = !0));
            }
            if (!n) {
              for (var o = 0, l = Object.entries(this.textRenderers); o < l.length; o++) {
                var u = r(l[o], 2),
                  d = u[0];
                if (u[1].canRenderFont(e)) {
                  n = d;
                  break;
                }
              }
              n || void 0 === this.textRenderers.canvas || (n = "canvas");
            }
            if ((a && console.warn(`Falling back to text renderer ${String(n)}`), !n)) return null;
            var h = this.textRenderers[n];
            return ((this.fontResolveMap[i] = h), h);
          }
          createShaderCtr(e, t) {
            return this.shManager.loadShader(e, t);
          }
          createNode(e) {
            var t = this.resolveNodeDefaults(e);
            return new H(this, t);
          }
          createTextNode(e) {
            var r,
              i,
              n,
              a,
              s,
              o,
              l,
              u,
              d,
              h,
              c,
              f,
              p,
              g,
              m,
              v,
              y,
              T,
              b = null !== (r = e.fontSize) && void 0 !== r ? r : 16,
              S = t(
                t({}, this.resolveNodeDefaults(e)),
                {},
                {
                  text: null !== (i = e.text) && void 0 !== i ? i : "",
                  textRendererOverride: null !== (n = e.textRendererOverride) && void 0 !== n ? n : null,
                  fontSize: b,
                  fontFamily: null !== (a = e.fontFamily) && void 0 !== a ? a : "sans-serif",
                  fontStyle: null !== (s = e.fontStyle) && void 0 !== s ? s : "normal",
                  fontWeight: null !== (o = e.fontWeight) && void 0 !== o ? o : "normal",
                  fontStretch: null !== (l = e.fontStretch) && void 0 !== l ? l : "normal",
                  textAlign: null !== (u = e.textAlign) && void 0 !== u ? u : "left",
                  contain: null !== (d = e.contain) && void 0 !== d ? d : "none",
                  scrollable: null !== (h = e.scrollable) && void 0 !== h && h,
                  scrollY: null !== (c = e.scrollY) && void 0 !== c ? c : 0,
                  offsetY: null !== (f = e.offsetY) && void 0 !== f ? f : 0,
                  letterSpacing: null !== (p = e.letterSpacing) && void 0 !== p ? p : 0,
                  lineHeight: e.lineHeight,
                  maxLines: null !== (g = e.maxLines) && void 0 !== g ? g : 0,
                  textBaseline: null !== (m = e.textBaseline) && void 0 !== m ? m : "alphabetic",
                  verticalAlign: null !== (v = e.verticalAlign) && void 0 !== v ? v : "middle",
                  overflowSuffix: null !== (y = e.overflowSuffix) && void 0 !== y ? y : "...",
                  debug: null !== (T = e.debug) && void 0 !== T ? T : {},
                  shaderProps: null,
                },
              ),
              E = this.resolveTextRenderer(S, e.textRendererOverride);
            if (!E) throw new Error(`No compatible text renderer found for ${S.fontFamily}`);
            return new gt(this, S, E);
          }
          setBoundsMargin(e) {
            ((this.boundsMargin = Array.isArray(e) ? e : [e, e, e, e]),
              this.root.setUpdateType(G.RenderBounds));
          }
          resolveNodeDefaults(e) {
            var t,
              r,
              i,
              n,
              a,
              s,
              o,
              l,
              u,
              d,
              h,
              c,
              f,
              p,
              g,
              m,
              v,
              y,
              T,
              b,
              S,
              E,
              x,
              w,
              A,
              I,
              k,
              R,
              C,
              L,
              M,
              D,
              _,
              P,
              O,
              N,
              F,
              U,
              B,
              $,
              j,
              G,
              V,
              H,
              K,
              W,
              z,
              q,
              X,
              Y,
              Q,
              J,
              Z,
              ee = null !== (t = e.color) && void 0 !== t ? t : 4294967295,
              te =
                null !==
                  (r =
                    null !== (i = null !== (n = e.colorTl) && void 0 !== n ? n : e.colorTop) && void 0 !== i
                      ? i
                      : e.colorLeft) && void 0 !== r
                  ? r
                  : ee,
              re =
                null !==
                  (a =
                    null !== (s = null !== (o = e.colorTr) && void 0 !== o ? o : e.colorTop) && void 0 !== s
                      ? s
                      : e.colorRight) && void 0 !== a
                  ? a
                  : ee,
              ie =
                null !==
                  (l =
                    null !== (u = null !== (d = e.colorBl) && void 0 !== d ? d : e.colorBottom) &&
                    void 0 !== u
                      ? u
                      : e.colorLeft) && void 0 !== l
                  ? l
                  : ee,
              ne =
                null !==
                  (h =
                    null !== (c = null !== (f = e.colorBr) && void 0 !== f ? f : e.colorBottom) &&
                    void 0 !== c
                      ? c
                      : e.colorRight) && void 0 !== h
                  ? h
                  : ee,
              ae = {};
            !0 === this.options.inspector &&
              (ae = (function (e) {
                for (
                  var t = { boolean: !0, string: !0, number: !0, undefined: !0 }, r = Object.keys(e), i = 0;
                  i < r.length;
                  i++
                ) {
                  var n = r[i];
                  if (n) {
                    var a = e[n],
                      s = typeof a;
                    ("string" === s &&
                      a.length > 2048 &&
                      (console.warn(
                        `Custom Data value for ${n} is too long, it will be truncated to 2048 characters`,
                      ),
                      (e[n] = a.substring(0, 2048))),
                      t[s] ||
                        (console.warn(
                          `Custom Data value for ${n} is not a boolean, string, or number, it will be ignored`,
                        ),
                        delete e[n]));
                  }
                }
                return e;
              })(null !== (Z = e.data) && void 0 !== Z ? Z : {}));
            return {
              x: null !== (p = e.x) && void 0 !== p ? p : 0,
              y: null !== (g = e.y) && void 0 !== g ? g : 0,
              width: null !== (m = e.width) && void 0 !== m ? m : 0,
              height: null !== (v = e.height) && void 0 !== v ? v : 0,
              alpha: null !== (y = e.alpha) && void 0 !== y ? y : 1,
              autosize: null !== (T = e.autosize) && void 0 !== T && T,
              boundsMargin: null !== (b = e.boundsMargin) && void 0 !== b ? b : null,
              clipping: null !== (S = e.clipping) && void 0 !== S && S,
              color: ee,
              colorTop: null !== (E = e.colorTop) && void 0 !== E ? E : ee,
              colorBottom: null !== (x = e.colorBottom) && void 0 !== x ? x : ee,
              colorLeft: null !== (w = e.colorLeft) && void 0 !== w ? w : ee,
              colorRight: null !== (A = e.colorRight) && void 0 !== A ? A : ee,
              colorBl: ie,
              colorBr: ne,
              colorTl: te,
              colorTr: re,
              zIndex: null !== (I = e.zIndex) && void 0 !== I ? I : 0,
              zIndexLocked: null !== (k = e.zIndexLocked) && void 0 !== k ? k : 0,
              parent: null !== (R = e.parent) && void 0 !== R ? R : null,
              texture: null !== (C = e.texture) && void 0 !== C ? C : null,
              textureOptions: null !== (L = e.textureOptions) && void 0 !== L ? L : {},
              shader: null !== (M = e.shader) && void 0 !== M ? M : this.defShaderCtr,
              src: null !== (D = e.src) && void 0 !== D ? D : null,
              srcHeight: e.srcHeight,
              srcWidth: e.srcWidth,
              srcX: e.srcX,
              srcY: e.srcY,
              scale: null !== (_ = e.scale) && void 0 !== _ ? _ : null,
              scaleX:
                null !== (P = null !== (O = e.scaleX) && void 0 !== O ? O : e.scale) && void 0 !== P ? P : 1,
              scaleY:
                null !== (N = null !== (F = e.scaleY) && void 0 !== F ? F : e.scale) && void 0 !== N ? N : 1,
              mount: null !== (U = e.mount) && void 0 !== U ? U : 0,
              mountX:
                null !== (B = null !== ($ = e.mountX) && void 0 !== $ ? $ : e.mount) && void 0 !== B ? B : 0,
              mountY:
                null !== (j = null !== (G = e.mountY) && void 0 !== G ? G : e.mount) && void 0 !== j ? j : 0,
              pivot: null !== (V = e.pivot) && void 0 !== V ? V : 0.5,
              pivotX:
                null !== (H = null !== (K = e.pivotX) && void 0 !== K ? K : e.pivot) && void 0 !== H
                  ? H
                  : 0.5,
              pivotY:
                null !== (W = null !== (z = e.pivotY) && void 0 !== z ? z : e.pivot) && void 0 !== W
                  ? W
                  : 0.5,
              rotation: null !== (q = e.rotation) && void 0 !== q ? q : 0,
              rtt: null !== (X = e.rtt) && void 0 !== X && X,
              data: ae,
              preventCleanup: null !== (Y = e.preventCleanup) && void 0 !== Y && Y,
              imageType: e.imageType,
              interactive: null !== (Q = e.interactive) && void 0 !== Q && Q,
              strictBounds: null !== (J = e.strictBounds) && void 0 !== J ? J : this.strictBounds,
            };
          }
          cleanup() {
            this.txMemManager.cleanup();
          }
        }
        class vt extends v {
          constructor(e, t) {
            var r, i, n, a, s, l, u, d, h, c, f, p, g;
            (super(),
              o(this, "root", void 0),
              o(this, "canvas", void 0),
              o(this, "settings", void 0),
              o(this, "stage", void 0),
              o(this, "inspector", null));
            var m = {
                criticalThreshold:
                  (null === (r = e.textureMemory) || void 0 === r ? void 0 : r.criticalThreshold) || 124e6,
                targetThresholdLevel:
                  (null === (i = e.textureMemory) || void 0 === i ? void 0 : i.targetThresholdLevel) || 0.5,
                cleanupInterval:
                  (null === (n = e.textureMemory) || void 0 === n ? void 0 : n.cleanupInterval) || 5e3,
                debugLogging:
                  (null === (a = e.textureMemory) || void 0 === a ? void 0 : a.debugLogging) || !1,
                baselineMemoryAllocation:
                  (null === (s = e.textureMemory) || void 0 === s ? void 0 : s.baselineMemoryAllocation) ||
                  26e6,
                doNotExceedCriticalThreshold:
                  (null === (l = e.textureMemory) || void 0 === l
                    ? void 0
                    : l.doNotExceedCriticalThreshold) || !1,
              },
              v = {
                appWidth: e.appWidth || 1920,
                appHeight: e.appHeight || 1080,
                textureMemory: m,
                boundsMargin: e.boundsMargin || 0,
                deviceLogicalPixelRatio: e.deviceLogicalPixelRatio || 1,
                devicePhysicalPixelRatio: e.devicePhysicalPixelRatio || window.devicePixelRatio,
                clearColor: null !== (u = e.clearColor) && void 0 !== u ? u : 0,
                fpsUpdateInterval: e.fpsUpdateInterval || 0,
                targetFPS: e.targetFPS || 0,
                numImageWorkers: void 0 !== e.numImageWorkers ? e.numImageWorkers : 2,
                enableContextSpy: null !== (d = e.enableContextSpy) && void 0 !== d && d,
                forceWebGL2: null !== (h = e.forceWebGL2) && void 0 !== h && h,
                inspector: null !== (c = e.inspector) && void 0 !== c && c,
                renderEngine: e.renderEngine,
                quadBufferSize: null !== (f = e.quadBufferSize) && void 0 !== f ? f : 4194304,
                fontEngines: e.fontEngines,
                strictBounds: null === (p = e.strictBounds) || void 0 === p || p,
                textureProcessingTimeLimit: e.textureProcessingTimeLimit || 42,
                canvas: e.canvas || document.createElement("canvas"),
                createImageBitmapSupport: e.createImageBitmapSupport || "full",
                maxRetryCount: null !== (g = e.maxRetryCount) && void 0 !== g ? g : 5,
              };
            this.settings = v;
            var y,
              T = v.deviceLogicalPixelRatio,
              b = v.devicePhysicalPixelRatio,
              S = v.canvas,
              E = v.appWidth * T,
              x = v.appHeight * T;
            if (
              ((this.canvas = S),
              (S.width = E * b),
              (S.height = x * b),
              (S.style.width = `${E}px`),
              (S.style.height = `${x}px`),
              (this.stage = new mt({
                appWidth: this.settings.appWidth,
                appHeight: this.settings.appHeight,
                boundsMargin: this.settings.boundsMargin,
                clearColor: this.settings.clearColor,
                canvas: this.canvas,
                deviceLogicalPixelRatio: this.settings.deviceLogicalPixelRatio,
                devicePhysicalPixelRatio: this.settings.devicePhysicalPixelRatio,
                enableContextSpy: this.settings.enableContextSpy,
                forceWebGL2: this.settings.forceWebGL2,
                fpsUpdateInterval: this.settings.fpsUpdateInterval,
                targetFPS: this.settings.targetFPS,
                numImageWorkers: this.settings.numImageWorkers,
                renderEngine: this.settings.renderEngine,
                textureMemory: m,
                eventBus: this,
                quadBufferSize: this.settings.quadBufferSize,
                fontEngines: this.settings.fontEngines,
                inspector: null !== this.settings.inspector,
                strictBounds: this.settings.strictBounds,
                textureProcessingTimeLimit: this.settings.textureProcessingTimeLimit,
                createImageBitmapSupport: this.settings.createImageBitmapSupport,
                maxRetryCount: this.settings.maxRetryCount,
              })),
              (this.root = this.stage.root),
              !(y = "string" == typeof t ? document.getElementById(t) : t))
            )
              throw new Error("Could not find target element");
            y.appendChild(S);
          }
          createNode(e) {
            var t = this.stage.createNode(e);
            return this.inspector ? this.inspector.createNode(t) : t;
          }
          createTextNode(e) {
            var t = this.stage.createTextNode(e);
            return this.inspector ? this.inspector.createTextNode(t) : t;
          }
          destroyNode(e) {
            return (this.inspector && this.inspector.destroyNode(e.id), e.destroy());
          }
          createTexture(e, t) {
            return this.stage.txManager.createTexture(e, t);
          }
          createShader(e, t) {
            return this.stage.shManager.loadShader(e, t);
          }
          createDynamicShader(e) {
            return this.stage.shManager.loadDynamicShader({ effects: e });
          }
          createEffect(e, t, r) {
            return { name: r, type: e, props: t };
          }
          getNodeById(e) {
            var t,
              r = null === (t = this.stage) || void 0 === t ? void 0 : t.root;
            if (!r) return null;
            var i = t => {
              if (t.id === e) return t;
              var r,
                n = l(t.children);
              try {
                for (n.s(); !(r = n.n()).done; ) {
                  var a = r.value,
                    s = i(a);
                  if (s) return s;
                }
              } catch (o) {
                n.e(o);
              } finally {
                n.f();
              }
              return null;
            };
            return i(r);
          }
          toggleFreeze() {
            throw new Error("Not implemented");
          }
          advanceFrame() {
            throw new Error("Not implemented");
          }
          getBufferInfo() {
            return this.stage.renderer.getBufferInfo();
          }
          rerender() {
            this.stage.requestRender();
          }
          cleanup() {
            this.stage.cleanup();
          }
          setClearColor(e) {
            this.stage.setClearColor(e);
          }
          get targetFPS() {
            return this.stage.options.targetFPS;
          }
          set targetFPS(e) {
            ((this.stage.options.targetFPS = e > 0 ? e : 0), this.stage.updateTargetFrameTime());
          }
        }
        class yt extends v {
          constructor(e) {
            (super(),
              o(this, "fontFamily", void 0),
              o(this, "descriptors", void 0),
              o(this, "loaded", !1),
              o(this, "metrics", null));
            var r = e.fontFamily,
              i = e.descriptors,
              n = e.metrics;
            (n &&
              (this.metrics = {
                ascender: n.ascender / n.unitsPerEm,
                descender: n.descender / n.unitsPerEm,
                lineGap: n.lineGap / n.unitsPerEm,
              }),
              (this.fontFamily = r),
              (this.descriptors = t({ style: "normal", weight: "normal", stretch: "normal" }, i)));
          }
          static convertToCssFontFaceDescriptors(e) {
            return {
              style: e.style,
              weight: "number" == typeof e.weight ? `${e.weight}` : e.weight,
              stretch: e.stretch,
              unicodeRange: e.unicodeRange,
              featureSettings: e.featureSettings,
              display: e.display,
            };
          }
        }
        class Tt extends yt {
          constructor(e) {
            (super(e), o(this, "fontFace", void 0), o(this, "fontUrl", void 0));
            var t = e.fontFamily,
              r = e.fontUrl,
              i = r.replace(/\(|\)/g, ""),
              n = this.descriptors,
              a = {
                style: n.style,
                weight: "number" == typeof n.weight ? `${n.weight}` : n.weight,
                stretch: n.stretch,
                unicodeRange: n.unicodeRange,
                featureSettings: n.featureSettings,
                display: n.display,
              };
            for (var s in a) {
              var l = s;
              void 0 === a[l] && delete a[l];
            }
            var u = new FontFace(t, `url(${i})`, a);
            (i.length > 0
              ? u
                  .load()
                  .then(() => {
                    ((this.loaded = !0), this.emit("loaded"));
                  })
                  .catch(console.error)
              : ((this.loaded = !0), this.emit("loaded")),
              (this.fontFace = u),
              (this.fontUrl = r));
          }
        }
        class bt {}
        class St extends bt {
          constructor(e, t, r, i, n, a, s, l, u, d, h, c, f) {
            (super(),
              o(this, "glw", void 0),
              o(this, "options", void 0),
              o(this, "buffers", void 0),
              o(this, "shader", void 0),
              o(this, "shaderProps", void 0),
              o(this, "alpha", void 0),
              o(this, "clippingRect", void 0),
              o(this, "dimensions", void 0),
              o(this, "bufferIdx", void 0),
              o(this, "zIndex", void 0),
              o(this, "renderToTexture", void 0),
              o(this, "parentHasRenderTexture", void 0),
              o(this, "framebufferDimensions", void 0),
              o(this, "length", 0),
              o(this, "numQuads", 0),
              o(this, "textures", []),
              o(this, "maxTextures", void 0),
              (this.glw = e),
              (this.options = t),
              (this.buffers = r),
              (this.shader = i),
              (this.shaderProps = n),
              (this.alpha = a),
              (this.clippingRect = s),
              (this.dimensions = l),
              (this.bufferIdx = u),
              (this.zIndex = d),
              (this.renderToTexture = h),
              (this.parentHasRenderTexture = c),
              (this.framebufferDimensions = f),
              (this.maxTextures = i.supportsIndexedTextures
                ? e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)
                : 1));
          }
          addTexture(e) {
            for (var t = this.textures, r = this.maxTextures, i = -1, n = t.length, a = 0; a < n; a++) {
              if (t[a] === e) {
                i = a;
                break;
              }
            }
            return -1 !== i ? i : n >= r ? 4294967295 : (this.textures.push(e), n);
          }
          draw() {
            var e = this.glw,
              t = this.shader,
              r = this.shaderProps,
              i = this.options;
            (i.shManager.useShader(t), t.bindRenderOp(this, r));
            var n = (this.bufferIdx / 32) * 6 * 2;
            if (this.clippingRect.valid) {
              var a = this.clippingRect,
                s = a.x,
                o = a.y,
                l = a.width,
                u = a.height,
                d = this.parentHasRenderTexture ? 1 : i.pixelRatio,
                h = i.canvas.height,
                c = Math.round(s * d),
                f = Math.round(l * d),
                p = Math.round(u * d),
                g = Math.round(h - p - o * d);
              (this.parentHasRenderTexture &&
                (g = this.framebufferDimensions
                  ? this.framebufferDimensions.height - this.dimensions.height
                  : 0),
                e.setScissorTest(!0),
                e.scissor(c, g, f, p));
            } else e.setScissorTest(!1);
            e.drawElements(e.TRIANGLES, 6 * this.numQuads, e.UNSIGNED_SHORT, n);
          }
        }
        function Et(e) {
          var t = {
            MAX_RENDERBUFFER_SIZE: 0,
            MAX_TEXTURE_SIZE: 0,
            MAX_VIEWPORT_DIMS: 0,
            MAX_VERTEX_TEXTURE_IMAGE_UNITS: 0,
            MAX_TEXTURE_IMAGE_UNITS: 0,
            MAX_COMBINED_TEXTURE_IMAGE_UNITS: 0,
            MAX_VERTEX_ATTRIBS: 0,
            MAX_VARYING_VECTORS: 0,
            MAX_VERTEX_UNIFORM_VECTORS: 0,
            MAX_FRAGMENT_UNIFORM_VECTORS: 0,
          };
          return (
            Object.keys(t).forEach(r => {
              t[r] = e.getParameter(e[r]);
            }),
            t
          );
        }
        function xt(e) {
          var t = {
            ANGLE_instanced_arrays: null,
            WEBGL_compressed_texture_s3tc: null,
            WEBGL_compressed_texture_astc: null,
            WEBGL_compressed_texture_etc: null,
            WEBGL_compressed_texture_etc1: null,
            WEBGL_compressed_texture_pvrtc: null,
            WEBKIT_WEBGL_compressed_texture_pvrtc: null,
            WEBGL_compressed_texture_s3tc_srgb: null,
            OES_vertex_array_object: null,
          };
          return (
            Object.keys(t).forEach(r => {
              t[r] = e.getExtension(r);
            }),
            t
          );
        }
        function wt(e) {
          return (
            null !== e &&
            (("object" == typeof e && e.constructor && "HTMLImageElement" === e.constructor.name) ||
              ("undefined" != typeof HTMLImageElement && e instanceof HTMLImageElement))
          );
        }
        var At = new Uint8Array([0, 0, 0, 0]);
        class It extends ft {
          constructor(e, t, r) {
            (super(t, r),
              o(this, "glw", void 0),
              o(this, "_nativeCtxTexture", null),
              o(this, "_w", 0),
              o(this, "_h", 0),
              o(this, "txCoordX1", 0),
              o(this, "txCoordY1", 0),
              o(this, "txCoordX2", 1),
              o(this, "txCoordY2", 1),
              (this.glw = e));
          }
          checkGLError() {
            if ("failed" === this.state) return !0;
            var e = this.glw.getError();
            return (
              0 !== e &&
              ((this.state = "failed"),
              this.textureSource.setState("failed", new Error(`WebGL Error: ${e}`)),
              !0)
            );
          }
          get ctxTexture() {
            return "freed" === this.state
              ? (this.load(), null)
              : (this._nativeCtxTexture, this._nativeCtxTexture);
          }
          get w() {
            return this._w;
          }
          get h() {
            return this._h;
          }
          load() {
            var e = this;
            return s(
              i().m(function t() {
                var r, n, a;
                return i().w(
                  function (t) {
                    for (;;)
                      switch ((t.p = t.n)) {
                        case 0:
                          if ("loading" !== e.state && "loaded" !== e.state) {
                            t.n = 1;
                            break;
                          }
                          return t.a(2, Promise.resolve());
                        case 1:
                          if (
                            ((e.state = "loading"),
                            e.textureSource.setState("loading"),
                            (e._nativeCtxTexture = e.createNativeCtxTexture()),
                            null !== e._nativeCtxTexture)
                          ) {
                            t.n = 2;
                            break;
                          }
                          return (
                            (e.state = "failed"),
                            e.textureSource.setState("failed", new Error("WebGL Texture creation failed")),
                            t.a(2)
                          );
                        case 2:
                          return ((t.p = 2), (t.n = 3), e.onLoadRequest());
                        case 3:
                          if (((r = t.v), (n = r.width), (a = r.height), "freed" !== e.state)) {
                            t.n = 4;
                            break;
                          }
                          return t.a(2);
                        case 4:
                          ((e.state = "loaded"),
                            (e._w = n),
                            (e._h = a),
                            e.textureSource.setState("loaded", { width: n, height: a }),
                            e.textureSource.freeTextureData(),
                            (t.n = 7));
                          break;
                        case 5:
                          if (((t.p = 5), t.v, "freed" !== e.state)) {
                            t.n = 6;
                            break;
                          }
                          return t.a(2);
                        case 6:
                          ((e.state = "failed"), e.textureSource.setState("failed"));
                        case 7:
                          return t.a(2);
                      }
                  },
                  t,
                  null,
                  [[2, 5]],
                );
              }),
            )();
          }
          onLoadRequest() {
            var e = this;
            return s(
              i().m(function t() {
                var r, n, a, s, o, l, u, d, h, c, f, p, g;
                return i().w(function (t) {
                  for (;;)
                    switch (t.n) {
                      case 0:
                        if (((r = e.glw), (n = e.textureSource.textureData), "failed" !== e.state)) {
                          t.n = 1;
                          break;
                        }
                        return t.a(2, { width: 0, height: 0 });
                      case 1:
                        if (null !== n && null !== e._nativeCtxTexture) {
                          t.n = 2;
                          break;
                        }
                        return (
                          (e.state = "failed"),
                          e.textureSource.setState("failed", new Error("No texture data available")),
                          t.a(2, { width: 0, height: 0 })
                        );
                      case 2:
                        if (
                          (r.texImage2D(0, r.RGBA, 1, 1, 0, r.RGBA, r.UNSIGNED_BYTE, null),
                          e.setTextureMemUse(At.byteLength),
                          (a = 0),
                          (s = 0),
                          r.activeTexture(0),
                          !0 !== e.checkGLError())
                        ) {
                          t.n = 3;
                          break;
                        }
                        return t.a(2, { width: 0, height: 0 });
                      case 3:
                        if (
                          ((o = n.data),
                          (l = r.RGBA),
                          (u = 4),
                          (d = 1.1),
                          !(
                            ("undefined" != typeof ImageBitmap && o instanceof ImageBitmap) ||
                            o instanceof ImageData ||
                            wt(o)
                          ))
                        ) {
                          t.n = 5;
                          break;
                        }
                        if (
                          ((a = o.width),
                          (s = o.height),
                          r.bindTexture(e._nativeCtxTexture),
                          r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !!n.premultiplyAlpha),
                          r.texImage2D(0, l, l, r.UNSIGNED_BYTE, o),
                          !0 !== e.checkGLError())
                        ) {
                          t.n = 4;
                          break;
                        }
                        return t.a(2, { width: 0, height: 0 });
                      case 4:
                        (e.setTextureMemUse(s * a * u * d), (t.n = 10));
                        break;
                      case 5:
                        if (!(o && "mipmaps" in o && o.mipmaps)) {
                          t.n = 7;
                          break;
                        }
                        if (
                          ((f = o.mipmaps),
                          (p = o.type),
                          (g = o.blockInfo),
                          pe[p](r, e._nativeCtxTexture, o),
                          !0 !== e.checkGLError())
                        ) {
                          t.n = 6;
                          break;
                        }
                        return t.a(2, { width: 0, height: 0 });
                      case 6:
                        ((a = o.width),
                          (s = o.height),
                          (e.txCoordX2 = a / (Math.ceil(a / g.width) * g.width)),
                          (e.txCoordY2 = s / (Math.ceil(s / g.height) * g.height)),
                          e.setTextureMemUse(
                            null !== (h = null === (c = f[0]) || void 0 === c ? void 0 : c.byteLength) &&
                              void 0 !== h
                              ? h
                              : 0,
                          ),
                          (t.n = 10));
                        break;
                      case 7:
                        if (!(o && o instanceof Uint8Array)) {
                          t.n = 9;
                          break;
                        }
                        if (
                          ((a = 1),
                          (s = 1),
                          r.bindTexture(e._nativeCtxTexture),
                          r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !!n.premultiplyAlpha),
                          r.texImage2D(0, l, a, s, 0, l, r.UNSIGNED_BYTE, o),
                          !0 !== e.checkGLError())
                        ) {
                          t.n = 8;
                          break;
                        }
                        return t.a(2, { width: 0, height: 0 });
                      case 8:
                        (e.setTextureMemUse(a * s * u), (t.n = 10));
                        break;
                      case 9:
                        return (
                          console.error(
                            "WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",
                            n,
                          ),
                          (e.state = "failed"),
                          e.textureSource.setState("failed", new Error("Unexpected texture data")),
                          t.a(2, { width: 0, height: 0 })
                        );
                      case 10:
                        return t.a(2, { width: a, height: s });
                    }
                }, t);
              }),
            )();
          }
          free() {
            "freed" !== this.state &&
              ((this.state = "freed"), this.textureSource.setState("freed"), this.release());
          }
          release() {
            ((this._w = 0),
              (this._h = 0),
              null !== this._nativeCtxTexture &&
                (this.glw.deleteTexture(this._nativeCtxTexture),
                this.setTextureMemUse(0),
                (this._nativeCtxTexture = null)),
              this.textureSource.freeTextureData());
          }
          createNativeCtxTexture() {
            var e = this.glw,
              t = e.createTexture();
            return t
              ? (e.activeTexture(0),
                e.bindTexture(t),
                e.texParameteri(e.TEXTURE_MAG_FILTER, e.LINEAR),
                e.texParameteri(e.TEXTURE_MIN_FILTER, e.LINEAR),
                e.texParameteri(e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE),
                e.texParameteri(e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE),
                0 !== e.getError() ? null : t)
              : null;
          }
        }
        class kt extends It {
          constructor(e, t, r) {
            super(e, t, r);
          }
          onLoadRequest() {
            var e = this;
            return s(
              i().m(function t() {
                var r, n, a;
                return i().w(function (t) {
                  for (;;)
                    switch (t.n) {
                      case 0:
                        if (!((a = e.textureSource.textureData).data instanceof Uint8Array)) {
                          t.n = 1;
                          break;
                        }
                        return t.a(2, { width: 1, height: 1 });
                      case 1:
                        return t.a(2, {
                          width: (null === (r = a.data) || void 0 === r ? void 0 : r.width) || 0,
                          height: (null === (n = a.data) || void 0 === n ? void 0 : n.height) || 0,
                        });
                    }
                }, t);
              }),
            )();
          }
        }
        class Rt {
          constructor(e) {
            (o(this, "config", void 0), (this.config = e));
          }
          getBuffer(e) {
            var t;
            return null === (t = this.config.find(t => t.attributes[e])) || void 0 === t ? void 0 : t.buffer;
          }
          getAttributeInfo(e) {
            var t;
            return null === (t = this.config.find(t => t.attributes[e])) || void 0 === t
              ? void 0
              : t.attributes[e];
          }
        }
        class Ct {
          constructor(e) {
            (o(this, "gl", void 0),
              o(this, "activeTextureUnit", 0),
              o(this, "texture2dUnits", void 0),
              o(this, "texture2dParams", new WeakMap()),
              o(this, "scissorEnabled", void 0),
              o(this, "scissorX", void 0),
              o(this, "scissorY", void 0),
              o(this, "scissorWidth", void 0),
              o(this, "scissorHeight", void 0),
              o(this, "blendEnabled", void 0),
              o(this, "blendSrcRgb", void 0),
              o(this, "blendDstRgb", void 0),
              o(this, "blendSrcAlpha", void 0),
              o(this, "blendDstAlpha", void 0),
              o(this, "boundArrayBuffer", void 0),
              o(this, "boundElementArrayBuffer", void 0),
              o(this, "curProgram", void 0),
              o(this, "canvas", void 0),
              o(this, "MAX_RENDERBUFFER_SIZE", void 0),
              o(this, "MAX_TEXTURE_SIZE", void 0),
              o(this, "MAX_VIEWPORT_DIMS", void 0),
              o(this, "MAX_VERTEX_TEXTURE_IMAGE_UNITS", void 0),
              o(this, "MAX_TEXTURE_IMAGE_UNITS", void 0),
              o(this, "MAX_COMBINED_TEXTURE_IMAGE_UNITS", void 0),
              o(this, "MAX_VERTEX_ATTRIBS", void 0),
              o(this, "MAX_VARYING_VECTORS", void 0),
              o(this, "MAX_VERTEX_UNIFORM_VECTORS", void 0),
              o(this, "MAX_FRAGMENT_UNIFORM_VECTORS", void 0),
              o(this, "TEXTURE_MAG_FILTER", void 0),
              o(this, "TEXTURE_MIN_FILTER", void 0),
              o(this, "TEXTURE_WRAP_S", void 0),
              o(this, "TEXTURE_WRAP_T", void 0),
              o(this, "LINEAR", void 0),
              o(this, "LINEAR_MIPMAP_LINEAR", void 0),
              o(this, "CLAMP_TO_EDGE", void 0),
              o(this, "RGB", void 0),
              o(this, "RGBA", void 0),
              o(this, "UNSIGNED_BYTE", void 0),
              o(this, "UNPACK_PREMULTIPLY_ALPHA_WEBGL", void 0),
              o(this, "UNPACK_FLIP_Y_WEBGL", void 0),
              o(this, "FLOAT", void 0),
              o(this, "TRIANGLES", void 0),
              o(this, "UNSIGNED_SHORT", void 0),
              o(this, "ONE", void 0),
              o(this, "ONE_MINUS_SRC_ALPHA", void 0),
              o(this, "VERTEX_SHADER", void 0),
              o(this, "FRAGMENT_SHADER", void 0),
              o(this, "STATIC_DRAW", void 0),
              o(this, "COMPILE_STATUS", void 0),
              o(this, "LINK_STATUS", void 0),
              o(this, "DYNAMIC_DRAW", void 0),
              o(this, "COLOR_ATTACHMENT0", void 0),
              o(this, "INVALID_ENUM", void 0),
              o(this, "INVALID_OPERATION", void 0),
              (this.gl = e),
              (this.activeTextureUnit = e.getParameter(e.ACTIVE_TEXTURE) - e.TEXTURE0));
            var t = e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);
            ((this.texture2dUnits = new Array(t)
              .fill(void 0)
              .map((t, r) => (this.activeTexture(r), e.getParameter(e.TEXTURE_BINDING_2D)))),
              this.activeTexture(this.activeTextureUnit),
              (this.scissorEnabled = e.isEnabled(e.SCISSOR_TEST)));
            var r = e.getParameter(e.SCISSOR_BOX);
            ((this.scissorX = r[0]),
              (this.scissorY = r[1]),
              (this.scissorWidth = r[2]),
              (this.scissorHeight = r[3]),
              (this.blendEnabled = e.isEnabled(e.BLEND)),
              (this.blendSrcRgb = e.getParameter(e.BLEND_SRC_RGB)),
              (this.blendDstRgb = e.getParameter(e.BLEND_DST_RGB)),
              (this.blendSrcAlpha = e.getParameter(e.BLEND_SRC_ALPHA)),
              (this.blendDstAlpha = e.getParameter(e.BLEND_DST_ALPHA)),
              (this.boundArrayBuffer = e.getParameter(e.ARRAY_BUFFER_BINDING)),
              (this.boundElementArrayBuffer = e.getParameter(e.ELEMENT_ARRAY_BUFFER_BINDING)),
              (this.curProgram = e.getParameter(e.CURRENT_PROGRAM)),
              (this.canvas = e.canvas),
              (this.MAX_RENDERBUFFER_SIZE = e.MAX_RENDERBUFFER_SIZE),
              (this.MAX_TEXTURE_SIZE = e.MAX_TEXTURE_SIZE),
              (this.MAX_VIEWPORT_DIMS = e.MAX_VIEWPORT_DIMS),
              (this.MAX_VERTEX_TEXTURE_IMAGE_UNITS = e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
              (this.MAX_TEXTURE_IMAGE_UNITS = e.MAX_TEXTURE_IMAGE_UNITS),
              (this.MAX_COMBINED_TEXTURE_IMAGE_UNITS = e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),
              (this.MAX_VERTEX_ATTRIBS = e.MAX_VERTEX_ATTRIBS),
              (this.MAX_VARYING_VECTORS = e.MAX_VARYING_VECTORS),
              (this.MAX_VERTEX_UNIFORM_VECTORS = e.MAX_VERTEX_UNIFORM_VECTORS),
              (this.MAX_FRAGMENT_UNIFORM_VECTORS = e.MAX_FRAGMENT_UNIFORM_VECTORS),
              (this.TEXTURE_MAG_FILTER = e.TEXTURE_MAG_FILTER),
              (this.TEXTURE_MIN_FILTER = e.TEXTURE_MIN_FILTER),
              (this.TEXTURE_WRAP_S = e.TEXTURE_WRAP_S),
              (this.TEXTURE_WRAP_T = e.TEXTURE_WRAP_T),
              (this.LINEAR = e.LINEAR),
              (this.LINEAR_MIPMAP_LINEAR = e.LINEAR_MIPMAP_LINEAR),
              (this.CLAMP_TO_EDGE = e.CLAMP_TO_EDGE),
              (this.RGB = e.RGB),
              (this.RGBA = e.RGBA),
              (this.UNSIGNED_BYTE = e.UNSIGNED_BYTE),
              (this.UNPACK_PREMULTIPLY_ALPHA_WEBGL = e.UNPACK_PREMULTIPLY_ALPHA_WEBGL),
              (this.UNPACK_FLIP_Y_WEBGL = e.UNPACK_FLIP_Y_WEBGL),
              (this.FLOAT = e.FLOAT),
              (this.TRIANGLES = e.TRIANGLES),
              (this.UNSIGNED_SHORT = e.UNSIGNED_SHORT),
              (this.ONE = e.ONE),
              (this.ONE_MINUS_SRC_ALPHA = e.ONE_MINUS_SRC_ALPHA),
              (this.MAX_VERTEX_TEXTURE_IMAGE_UNITS = e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
              (this.TRIANGLES = e.TRIANGLES),
              (this.UNSIGNED_SHORT = e.UNSIGNED_SHORT),
              (this.VERTEX_SHADER = e.VERTEX_SHADER),
              (this.FRAGMENT_SHADER = e.FRAGMENT_SHADER),
              (this.STATIC_DRAW = e.STATIC_DRAW),
              (this.COMPILE_STATUS = e.COMPILE_STATUS),
              (this.LINK_STATUS = e.LINK_STATUS),
              (this.DYNAMIC_DRAW = e.DYNAMIC_DRAW),
              (this.COLOR_ATTACHMENT0 = e.COLOR_ATTACHMENT0),
              (this.INVALID_ENUM = e.INVALID_ENUM),
              (this.INVALID_OPERATION = e.INVALID_OPERATION));
          }
          isWebGl2() {
            return ((e = this.gl), self.WebGL2RenderingContext && e instanceof self.WebGL2RenderingContext);
            var e;
          }
          activeTexture(e) {
            var t = this.gl;
            this.activeTextureUnit !== e && (t.activeTexture(e + t.TEXTURE0), (this.activeTextureUnit = e));
          }
          bindTexture(e) {
            var t = this.gl,
              r = this.activeTextureUnit,
              i = this.texture2dUnits;
            i[r] !== e && ((i[r] = e), t.bindTexture(this.gl.TEXTURE_2D, e));
          }
          _getActiveTexture() {
            var e = this.activeTextureUnit;
            return this.texture2dUnits[e];
          }
          texParameteri(e, t) {
            var r = this.gl,
              i = this.texture2dParams,
              n = this._getActiveTexture();
            if (!n) throw new Error("No active texture");
            var a = i.get(n);
            (a || ((a = {}), i.set(n, a)), a[e] !== t && ((a[e] = t), r.texParameteri(r.TEXTURE_2D, e, t)));
          }
          texImage2D(e, t, r, i, n, a, s, o) {
            var l = this.gl;
            a
              ? l.texImage2D(l.TEXTURE_2D, e, t, r, i, n, a, s, o)
              : l.texImage2D(l.TEXTURE_2D, e, t, r, i, n);
          }
          compressedTexImage2D(e, t, r, i, n, a) {
            var s = this.gl;
            s.compressedTexImage2D(s.TEXTURE_2D, e, t, r, i, n, a);
          }
          pixelStorei(e, t) {
            this.gl.pixelStorei(e, t);
          }
          generateMipmap() {
            var e = this.gl;
            e.generateMipmap(e.TEXTURE_2D);
          }
          createTexture() {
            return this.gl.createTexture();
          }
          deleteTexture(e) {
            var t = this.gl;
            (e && this.texture2dParams.delete(e), t.deleteTexture(e));
          }
          deleteFramebuffer(e) {
            this.gl.deleteFramebuffer(e);
          }
          viewport(e, t, r, i) {
            this.gl.viewport(e, t, r, i);
          }
          clearColor(e, t, r, i) {
            this.gl.clearColor(e, t, r, i);
          }
          setScissorTest(e) {
            var t = this.gl;
            e !== this.scissorEnabled &&
              (e ? t.enable(t.SCISSOR_TEST) : t.disable(t.SCISSOR_TEST), (this.scissorEnabled = e));
          }
          scissor(e, t, r, i) {
            var n = this.gl,
              a = this.scissorX,
              s = this.scissorY,
              o = this.scissorWidth,
              l = this.scissorHeight;
            (e === a && t === s && r === o && i === l) ||
              (n.scissor(e, t, r, i),
              (this.scissorX = e),
              (this.scissorY = t),
              (this.scissorWidth = r),
              (this.scissorHeight = i));
          }
          setBlend(e) {
            var t = this.gl;
            e !== this.blendEnabled && (e ? t.enable(t.BLEND) : t.disable(t.BLEND), (this.blendEnabled = e));
          }
          blendFunc(e, t) {
            var r = this.gl,
              i = this.blendSrcRgb,
              n = this.blendDstRgb,
              a = this.blendSrcAlpha,
              s = this.blendDstAlpha;
            (e === i && t === n && e === a && t === s) ||
              (r.blendFunc(e, t),
              (this.blendSrcRgb = e),
              (this.blendDstRgb = t),
              (this.blendSrcAlpha = e),
              (this.blendDstAlpha = t));
          }
          createBuffer() {
            return this.gl.createBuffer();
          }
          createFramebuffer() {
            return this.gl.createFramebuffer();
          }
          bindFramebuffer(e) {
            var t = this.gl;
            t.bindFramebuffer(t.FRAMEBUFFER, e);
          }
          framebufferTexture2D(e, t, r) {
            var i = this.gl;
            i.framebufferTexture2D(i.FRAMEBUFFER, e, i.TEXTURE_2D, t, r);
          }
          clear() {
            var e = this.gl;
            e.clear(e.COLOR_BUFFER_BIT);
          }
          arrayBufferData(e, t, r) {
            var i = this.gl;
            (this.boundArrayBuffer !== e && (i.bindBuffer(i.ARRAY_BUFFER, e), (this.boundArrayBuffer = e)),
              i.bufferData(i.ARRAY_BUFFER, t, r));
          }
          elementArrayBufferData(e, t, r) {
            var i = this.gl;
            (this.boundElementArrayBuffer !== e &&
              (i.bindBuffer(i.ELEMENT_ARRAY_BUFFER, e), (this.boundElementArrayBuffer = e)),
              i.bufferData(i.ELEMENT_ARRAY_BUFFER, t, r));
          }
          vertexAttribPointer(e, t, r, i, n, a, s) {
            var o = this.gl;
            (this.boundArrayBuffer !== e && (o.bindBuffer(o.ARRAY_BUFFER, e), (this.boundArrayBuffer = e)),
              o.vertexAttribPointer(t, r, i, n, a, s));
          }
          getUniformLocations(e) {
            for (
              var t = this.gl, r = t.getProgramParameter(e, t.ACTIVE_UNIFORMS), i = {}, n = 0;
              n < r;
              n++
            ) {
              var a = t.getActiveUniform(e, n).name.replace(/\[.*?\]/g, "");
              i[a] = t.getUniformLocation(e, a);
            }
            return i;
          }
          getAttributeLocations(e) {
            for (
              var t = this.gl, r = t.getProgramParameter(e, t.ACTIVE_ATTRIBUTES), i = [], n = 0;
              n < r;
              n++
            ) {
              var a = t.getActiveAttrib(e, n).name;
              i[t.getAttribLocation(e, a)] = a;
            }
            return i;
          }
          useProgram(e) {
            var t = this.gl;
            this.curProgram !== e && (t.useProgram(e), (this.curProgram = e));
          }
          uniform1f(e, t) {
            this.gl.uniform1f(e, t);
          }
          uniform1fv(e, t) {
            this.gl.uniform1fv(e, t);
          }
          uniform1i(e, t) {
            this.gl.uniform1i(e, t);
          }
          uniform1iv(e, t) {
            this.gl.uniform1iv(e, t);
          }
          uniform2f(e, t, r) {
            this.gl.uniform2f(e, t, r);
          }
          uniform2fv(e, t) {
            this.gl.uniform2fv(e, t);
          }
          uniform2i(e, t, r) {
            this.gl.uniform2i(e, t, r);
          }
          uniform2iv(e, t) {
            this.gl.uniform2iv(e, t);
          }
          uniform3f(e, t, r, i) {
            this.gl.uniform3f(e, t, r, i);
          }
          uniform3fv(e, t) {
            this.gl.uniform3fv(e, t);
          }
          uniform3i(e, t, r, i) {
            this.gl.uniform3i(e, t, r, i);
          }
          uniform3iv(e, t) {
            this.gl.uniform3iv(e, t);
          }
          uniform4f(e, t, r, i, n) {
            this.gl.uniform4f(e, t, r, i, n);
          }
          uniform4fv(e, t) {
            this.gl.uniform4fv(e, t);
          }
          uniform4i(e, t, r, i, n) {
            this.gl.uniform4i(e, t, r, i, n);
          }
          uniform4iv(e, t) {
            this.gl.uniform4iv(e, t);
          }
          uniformMatrix2fv(e, t) {
            this.gl.uniformMatrix2fv(e, !1, t);
          }
          uniformMatrix3fv(e, t) {
            this.gl.uniformMatrix3fv(e, !1, t);
          }
          uniformMatrix4fv(e, t) {
            this.gl.uniformMatrix4fv(e, !1, t);
          }
          getParameter(e) {
            return this.gl.getParameter(e);
          }
          drawElements(e, t, r, i) {
            this.gl.drawElements(e, t, r, i);
          }
          getExtension(e) {
            return this.gl.getExtension(e);
          }
          getError() {
            return this.gl.getError();
          }
          createVertexArray() {
            return this.gl.createVertexArray();
          }
          bindVertexArray(e) {
            this.gl.bindVertexArray(e);
          }
          getAttribLocation(e, t) {
            return this.gl.getAttribLocation(e, t);
          }
          getUniformLocation(e, t) {
            return this.gl.getUniformLocation(e, t);
          }
          enableVertexAttribArray(e) {
            this.gl.enableVertexAttribArray(e);
          }
          disableVertexAttribArray(e) {
            this.gl.disableVertexAttribArray(e);
          }
          createShader(e) {
            return this.gl.createShader(e);
          }
          compileShader(e) {
            this.gl.compileShader(e);
          }
          attachShader(e, t) {
            this.gl.attachShader(e, t);
          }
          linkProgram(e) {
            this.gl.linkProgram(e);
          }
          deleteProgram(e) {
            this.gl.deleteProgram(e);
          }
          getShaderParameter(e, t) {
            return this.gl.getShaderParameter(e, t);
          }
          getShaderInfoLog(e) {
            return this.gl.getShaderInfoLog(e);
          }
          createProgram() {
            return this.gl.createProgram();
          }
          getProgramParameter(e, t) {
            return this.gl.getProgramParameter(e, t);
          }
          getProgramInfoLog(e) {
            return this.gl.getProgramInfoLog(e);
          }
          shaderSource(e, t) {
            this.gl.shaderSource(e, t);
          }
          deleteShader(e) {
            this.gl.deleteShader(e);
          }
          checkError(e) {
            var t = this.getError();
            if (0 !== t) {
              var r = "UNKNOWN_ERROR";
              switch (t) {
                case this.INVALID_ENUM:
                  r = "INVALID_ENUM";
                  break;
                case 1281:
                  r = "INVALID_VALUE";
                  break;
                case this.INVALID_OPERATION:
                  r = "INVALID_OPERATION";
                  break;
                case 1285:
                  r = "OUT_OF_MEMORY";
                  break;
                case 37442:
                  r = "CONTEXT_LOST_WEBGL";
              }
              var i = `WebGL ${r} (0x${t.toString(16)}) during ${e}`;
              return { error: t, errorName: r, message: i };
            }
            return null;
          }
        }
        class Lt extends It {
          constructor(e, t, r) {
            (super(e, t, r), o(this, "framebuffer", null));
          }
          onLoadRequest() {
            var e = this;
            return s(
              i().m(function t() {
                var r, n, a, s, o;
                return i().w(function (t) {
                  for (;;)
                    switch (t.n) {
                      case 0:
                        if (((r = e.glw), (n = e._nativeCtxTexture = e.createNativeCtxTexture()))) {
                          t.n = 1;
                          break;
                        }
                        throw new Error("Failed to create native texture for RenderTexture");
                      case 1:
                        return (
                          (a = e.textureSource),
                          (s = a.width),
                          (o = a.height),
                          (e.framebuffer = r.createFramebuffer()),
                          r.texImage2D(0, r.RGBA, s, o, 0, r.RGBA, r.UNSIGNED_BYTE, null),
                          e.setTextureMemUse(s * o * 4),
                          r.bindFramebuffer(e.framebuffer),
                          r.framebufferTexture2D(r.COLOR_ATTACHMENT0, n, 0),
                          r.bindFramebuffer(null),
                          t.a(2, { width: s, height: o })
                        );
                    }
                }, t);
              }),
            )();
          }
          free() {
            (super.free(), this.glw.deleteFramebuffer(this.framebuffer), (this.framebuffer = null));
          }
        }
        var Mt = 10;
        class Dt {}
        class _t extends Dt {
          constructor(e, t) {
            (super(),
              o(this, "data", void 0),
              o(this, "glyphMap", void 0),
              o(this, "kernings", void 0),
              (this.data = e),
              (this.glyphMap = t));
            var r = (this.kernings = {});
            (e.kernings.forEach(e => {
              var t = e.second;
              (r[t] = r[t] || {})[e.first] = e.amount;
            }),
              (this.kernings = r));
          }
          shapeText(e, t) {
            var r = this;
            return i().m(function n() {
              var a, s, o, l, u, d;
              return i().w(function (i) {
                for (;;)
                  switch (i.n) {
                    case 0:
                      s = void 0;
                    case 1:
                      if (!(a = t.peek()) || a.done) {
                        i.n = 5;
                        break;
                      }
                      if (((o = a.value), (l = r.glyphMap.get(o)), t.next(), void 0 === l)) {
                        i.n = 3;
                        break;
                      }
                      return (
                        (d =
                          void 0 !== s
                            ? ((null === (u = r.kernings[l.id]) || void 0 === u ? void 0 : u[s]) || 0) +
                              e.letterSpacing
                            : 0),
                        (s = l.id),
                        (i.n = 2),
                        {
                          mapped: !0,
                          glyphId: l.id,
                          codepoint: o,
                          cluster: t.lastIndex,
                          xAdvance: l.xadvance + d,
                          yAdvance: 0,
                          xOffset: l.xoffset + d,
                          yOffset: l.yoffset,
                          xBearing: 0,
                          yBearing: 0,
                          width: l.width,
                          height: l.height,
                        }
                      );
                    case 2:
                      i.n = 4;
                      break;
                    case 3:
                      return (
                        o === Mt && (s = void 0),
                        (i.n = 4),
                        { mapped: !1, codepoint: o, cluster: t.lastIndex }
                      );
                    case 4:
                      i.n = 1;
                      break;
                    case 5:
                      return i.a(2);
                  }
              }, n);
            })();
          }
        }
        class Pt extends yt {
          constructor(e, t) {
            (super(t),
              o(this, "type", void 0),
              o(this, "texture", void 0),
              o(this, "maxCharHeight", 0),
              o(this, "shaper", void 0),
              o(this, "glyphMap", new Map()),
              o(this, "data", void 0));
            var r = t.atlasUrl,
              i = t.atlasDataUrl,
              n = t.stage;
            ((this.type = e),
              n.renderer,
              (this.texture = n.txManager.createTexture("ImageTexture", { src: r, premultiplyAlpha: !1 })),
              n.txManager.loadTexture(this.texture, !0),
              (this.texture.preventCleanup = !0),
              this.texture.on("loaded", () => {
                (this.checkLoaded(), n.requestRender());
              }),
              me(i)
                .then(e => {
                  ((this.data = JSON.parse(e)), this.data);
                  var t = 0;
                  if (
                    (this.data.chars.forEach(e => {
                      this.glyphMap.set(e.id, e);
                      var r = e.yoffset + e.height;
                      r > t && (t = r);
                    }),
                    (this.maxCharHeight = t),
                    (this.shaper = new _t(this.data, this.glyphMap)),
                    !this.metrics)
                  ) {
                    var r;
                    if (null === (r = this.data) || void 0 === r || !r.lightningMetrics)
                      throw new Error(
                        `Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`,
                      );
                    var i = this.data.lightningMetrics,
                      n = i.ascender,
                      a = i.descender,
                      s = i.lineGap,
                      o = i.unitsPerEm;
                    this.metrics = { ascender: n / o, descender: a / o, lineGap: s / o };
                  }
                  this.checkLoaded();
                })
                .catch(console.error));
          }
          getAtlasEntry(e) {
            var t = this.glyphMap.get(e);
            if (void 0 === t) throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);
            return { x: t.x, y: t.y, width: t.width, height: t.height };
          }
          checkLoaded() {
            this.loaded ||
              ("loaded" === this.texture.state && this.data && ((this.loaded = !0), this.emit("loaded")));
          }
        }
        var Ot,
          Nt = !!{ LEGACY: !0 },
          Ft = {
            debug: !1,
            focusDebug: !1,
            keyDebug: !1,
            animationsEnabled: !0,
            animationSettings: { duration: 250, easing: "ease-in-out" },
            fontSettings: { fontFamily: "Ubuntu", fontSize: 100 },
            setActiveElement: () => {},
            focusStateKey: "$focus",
            lockStyles: !0,
          };
        var Ut = "element",
          Bt = "textNode",
          $t = "text";
        var jt = e => e instanceof Function,
          Gt = e => "function" == typeof e;
        function Vt(e) {
          return Array.isArray(e);
        }
        function Ht(e) {
          return "string" == typeof e;
        }
        function Kt(e) {
          return "destroy" in e && "function" == typeof e.destroy;
        }
        function Wt(e) {
          return e instanceof yr;
        }
        function zt(e) {
          return e._type === Bt;
        }
        function qt(e) {
          return e._type === $t;
        }
        function Xt(e) {
          var t;
          return null == e || null === (t = e.states) || void 0 === t ? void 0 : t.has(Ft.focusStateKey);
        }
        class Yt extends Array {
          constructor(e, t = {}) {
            return (
              Vt(t)
                ? (super(...t), o(this, "onChange", void 0))
                : Ht(t)
                  ? (super(t), o(this, "onChange", void 0))
                  : (super(
                      ...Object.entries(t)
                        .filter(([e, t]) => t)
                        .map(([e]) => e),
                    ),
                    o(this, "onChange", void 0)),
              (this.onChange = e),
              this
            );
          }
          has(e) {
            return this.indexOf(e) >= 0 || this.indexOf(`$${e}`) >= 0;
          }
          is(e) {
            return this.indexOf(e) >= 0;
          }
          add(e) {
            this.has(e) || (this.push(e), this.onChange());
          }
          toggle(e, t) {
            !0 === t ? this.add(e) : !1 === t || this.has(e) ? this.remove(e) : this.add(e);
          }
          merge(e) {
            if (Vt(e)) ((this.length = 0), this.push(...e));
            else if (Ht(e)) ((this.length = 0), this.push(e));
            else
              for (var t in e) {
                if (e[t]) this.has(t) || this.push(t);
                else {
                  var r = this.indexOf(t);
                  r >= 0 && this.splice(r, 1);
                }
              }
            return this;
          }
          remove(e) {
            var t = this.indexOf(e);
            t >= 0 && (this.splice(t, 1), this.onChange());
          }
        }
        function Qt(e) {
          for (
            var t = "row" === (e.flexDirection || "row"),
              r = t ? "width" : "height",
              i = t ? "height" : "width",
              n = t ? "marginLeft" : "marginTop",
              a = t ? "marginTop" : "marginLeft",
              s = t ? "marginRight" : "marginBottom",
              o = t ? "marginBottom" : "marginRight",
              u = [],
              d = !1,
              h = 0,
              c = 0;
            c < e.children.length;
            c++
          ) {
            var f = e.children[c];
            if (zt(f) && f.text && !f.width && !f.height) return !1;
            if (!qt(f) && !1 !== f.flexItem) {
              var p = f.flexOrder;
              void 0 !== p && (d = !0);
              var g = f.flexGrow,
                m = void 0 !== g && g >= 0;
              m && (h += g);
              var v = f[r] || 0,
                y = f[n] || 0,
                T = f[s] || 0;
              u.push({
                node: f,
                mainSize: v,
                marginStart: y,
                marginEnd: T,
                totalMainSizeOnAxis: v + y + T,
                isGrowItem: m,
                flexGrowValue: m ? g : 0,
                flexOrder: p || 0,
                crossSize: f[i] || 0,
                crossMarginStart: f[a] || 0,
                crossMarginEnd: f[o] || 0,
              });
            }
          }
          d ? u.sort((e, t) => e.flexOrder - t.flexOrder) : "rtl" === e.direction && u.reverse();
          var b = u.length;
          if (0 === b) return !1;
          var S = t ? "x" : "y",
            E = t ? "y" : "x",
            x = e[r] || 0,
            w = e[i] || 0,
            A = e.gap || 0,
            I = e.justifyContent || "flexStart",
            k = !1;
          if (h > 0 && b > 1) {
            e.flexBoundary = e.flexBoundary || "fixed";
            var R,
              C = 0,
              L = l(u);
            try {
              for (L.s(); !(R = L.n()).done; ) {
                var M = R.value;
                C += M.mainSize + M.marginStart + M.marginEnd;
              }
            } catch (xe) {
              L.e(xe);
            } finally {
              L.f();
            }
            var D = x - C - (b > 0 ? A * (b - 1) : 0);
            if (D > 0) {
              var _,
                P = l(u);
              try {
                for (P.s(); !(_ = P.n()).done; ) {
                  var O = _.value;
                  if (O.isGrowItem && O.flexGrowValue > 0) {
                    var N = (O.flexGrowValue / h) * D,
                      F = O.mainSize + N;
                    ((O.node[r] = F),
                      (O.mainSize = F),
                      (O.totalMainSizeOnAxis = F + O.marginStart + O.marginEnd));
                  }
                }
              } catch (xe) {
                P.e(xe);
              } finally {
                P.f();
              }
              e._containsFlexGrow = !e._containsFlexGrow || null;
            } else
              e._containsFlexGrow
                ? (e._containsFlexGrow = null)
                : console.warn("No available space for flex-grow items to expand, or items overflow.");
          }
          var U = 0;
          if ("center" === I || "spaceBetween" === I || "spaceEvenly" === I || "spaceAround" === I) {
            var B,
              $ = l(u);
            try {
              for ($.s(); !(B = $.n()).done; ) {
                U += B.value.totalMainSizeOnAxis;
              }
            } catch (xe) {
              $.e(xe);
            } finally {
              $.f();
            }
          }
          var j = e.alignItems || (e.flexWrap ? "flexStart" : void 0),
            G = w
              ? (e, t = 0) => {
                  var r = e.node.alignSelf || j;
                  r &&
                    ("flexStart" === r
                      ? (e.node[E] = t + e.crossMarginStart)
                      : "center" === r
                        ? (e.node[E] = t + (w - e.crossSize) / 2 + e.crossMarginStart)
                        : "flexEnd" === r && (e.node[E] = t + w - e.crossSize - e.crossMarginEnd));
                }
              : (e, t = 0) => {};
          if (t && e._calcHeight && !e.flexCrossBoundary) {
            var V = u.reduce((e, t) => Math.max(e, t.crossSize), 0),
              H = V || e.height;
            H !== e.height && ((k = !0), (e.height = w = H));
          }
          var K = e.padding || 0;
          if ("flexStart" === I) {
            if ("wrap" === e.flexWrap) {
              var W,
                z,
                q,
                X,
                Y = 0,
                Q = (null === (W = u[0]) || void 0 === W ? void 0 : W.crossSize) || w,
                J = t
                  ? null !== (z = e.columnGap) && void 0 !== z
                    ? z
                    : A
                  : null !== (q = e.rowGap) && void 0 !== q
                    ? q
                    : A,
                Z = l(u);
              try {
                for (Z.s(); !(X = Z.n()).done; ) {
                  var ee = X.value;
                  (K + ee.totalMainSizeOnAxis > x &&
                    K > (e.padding || 0) &&
                    ((K = e.padding || 0), (Y += Q + J)),
                    (ee.node[S] = K + ee.marginStart),
                    (K += ee.totalMainSizeOnAxis + A),
                    G(ee, Y));
                }
              } catch (xe) {
                Z.e(xe);
              } finally {
                Z.f();
              }
              var te = Y + Q;
              e[i] !== te && ((e[`preFlex${i}`] = e[i]), (e[i] = te), (k = !0));
            } else {
              var re,
                ie = l(u);
              try {
                for (ie.s(); !(re = ie.n()).done; ) {
                  var ne = re.value;
                  ((ne.node[S] = K + ne.marginStart), (K += ne.totalMainSizeOnAxis + A), G(ne));
                }
              } catch (xe) {
                ie.e(xe);
              } finally {
                ie.f();
              }
            }
            if ("fixed" !== e.flexBoundary && "wrap" !== e.flexWrap) {
              var ae = K - A + (e.padding || 0);
              if (ae !== x) return ((e[`preFlex${r}`] = x), (e[r] = ae), !0);
            }
          } else if ("flexEnd" === I) {
            K = x - (e.padding || 0);
            for (var se = b - 1; se >= 0; se--) {
              var oe = u[se];
              ((oe.node[S] = K - oe.mainSize - oe.marginEnd), (K -= oe.totalMainSizeOnAxis + A), G(oe));
            }
          } else if ("center" === I) {
            K = (x - (U + A * (b - 1))) / 2 + (e.padding || 0);
            var le,
              ue = l(u);
            try {
              for (ue.s(); !(le = ue.n()).done; ) {
                var de = le.value;
                ((de.node[S] = K + de.marginStart), (K += de.totalMainSizeOnAxis + A), G(de));
              }
            } catch (xe) {
              ue.e(xe);
            } finally {
              ue.f();
            }
          } else if ("spaceBetween" === I) {
            var he = b > 1 ? (x - U - 2 * (e.padding || 0)) / (b - 1) : 0;
            K = e.padding || 0;
            var ce,
              fe = l(u);
            try {
              for (fe.s(); !(ce = fe.n()).done; ) {
                var pe = ce.value;
                ((pe.node[S] = K + pe.marginStart), (K += pe.totalMainSizeOnAxis + he), G(pe));
              }
            } catch (xe) {
              fe.e(xe);
            } finally {
              fe.f();
            }
          } else if ("spaceAround" === I) {
            var ge = b > 0 ? (x - U - 2 * (e.padding || 0)) / b : 0;
            K = (e.padding || 0) + ge / 2;
            var me,
              ve = l(u);
            try {
              for (ve.s(); !(me = ve.n()).done; ) {
                var ye = me.value;
                ((ye.node[S] = K + ye.marginStart), (K += ye.totalMainSizeOnAxis + ge), G(ye));
              }
            } catch (xe) {
              ve.e(xe);
            } finally {
              ve.f();
            }
          } else if ("spaceEvenly" === I) {
            var Te = (x - U - 2 * (e.padding || 0)) / (b + 1);
            K = Te + (e.padding || 0);
            var be,
              Se = l(u);
            try {
              for (Se.s(); !(be = Se.n()).done; ) {
                var Ee = be.value;
                ((Ee.node[S] = K + Ee.marginStart), (K += Ee.totalMainSizeOnAxis + Te), G(Ee));
              }
            } catch (xe) {
              Se.e(xe);
            } finally {
              Se.f();
            }
          }
          return k;
        }
        var Jt,
          Zt,
          er = {
            ArrowLeft: "Left",
            ArrowRight: "Right",
            ArrowUp: "Up",
            ArrowDown: "Down",
            Enter: "Enter",
            l: "Last",
            " ": "Space",
            Backspace: "Back",
            Escape: "Escape",
          },
          tr = {},
          rr = (e, t) => {
            for (
              var i = function () {
                  var e = r(a[n], 2),
                    i = e[0],
                    s = e[1];
                  Array.isArray(s)
                    ? s.forEach(e => {
                        t[e] = i;
                      })
                    : null === s
                      ? delete t[i]
                      : (t[s] = i);
                },
                n = 0,
                a = Object.entries(e);
              n < a.length;
              n++
            )
              i();
          },
          ir = !0,
          nr = [],
          ar = (e, r) => {
            for (var i = e, n = []; i; ) {
              var a, s;
              if (!i.states.has(Ft.focusStateKey) || i === e)
                (i.states.add(Ft.focusStateKey),
                  null === (a = i.onFocus) || void 0 === a || a.call(i, e, r),
                  null === (s = i.onFocusChanged) || void 0 === s || s.call(i, !0, e, r));
              (n.push(i), (i = i.parent));
            }
            return (
              nr.forEach(t => {
                var i, a;
                n.includes(t) ||
                  (t.states.remove(Ft.focusStateKey),
                  null === (i = t.onBlur) || void 0 === i || i.call(t, e, r),
                  null === (a = t.onFocusChanged) || void 0 === a || a.call(t, !1, e, r));
              }),
              Ft.focusDebug &&
                ((e, r) => {
                  if (ir) {
                    var i = document.createElement("style");
                    ((i.type = "text/css"),
                      (i.innerHTML =
                        '\n      [data-focus="3"] {\n        border: 2px solid rgba(255, 33, 33, 0.2);\n        border-radius: 5px;\n        transition: border-color 0.3s ease;\n      }\n\n      [data-focus="2"] {\n        border: 2px solid rgba(255, 33, 33, 0.4);\n        border-radius: 5px;\n        transition: border-color 0.3s ease;\n      }\n\n      [data-focus="1"] {\n        border: 4px solid rgba(255, 33, 33, 0.9);\n        border-radius: 5px;\n        transition: border-color 0.5s ease;\n      }\n    '),
                      document.head.appendChild(i),
                      (ir = !1));
                  }
                  (e.forEach(e => {
                    e.data = t(t({}, e.data), {}, { focus: void 0 });
                  }),
                    r.forEach((e, r) => {
                      e.data = t(t({}, e.data), {}, { focus: r + 1 });
                    }));
                })(nr, n),
              (nr = n),
              n
            );
          },
          sr = 0,
          or = (e, t, r = !1, i = !1) => {
            var n,
              a = performance.now(),
              s = e.key || e.keyCode,
              o = Zt === s;
            if (((Zt = s), !i && Ft.throttleInput)) {
              if (o && a - sr < Ft.throttleInput) return !1;
              sr = a;
            }
            for (
              var l,
                u,
                d,
                h = nr.length,
                c = `onCapture${t || e.key}` + i ? "Release" : "",
                f = i ? "onCaptureKeyRelease" : "onCaptureKey",
                p = h - 1;
              p >= 0;
              p--
            ) {
              var g = nr[p];
              if (
                g.throttleInput &&
                o &&
                void 0 !== g._lastAnyKeyPressTime &&
                a - g._lastAnyKeyPressTime < g.throttleInput
              )
                return !0;
              var m = g[c] || g[f];
              if (Gt(m) && !0 === m.call(g, e, g, n, t)) return ((g._lastAnyKeyPressTime = a), !0);
            }
            (t && ((l = `on${t}`), (u = `on${t}Release`)), i || (d = r ? "onKeyHold" : "onKeyPress"));
            for (var v = 0; v < h; v++) {
              var y = nr[v];
              if (
                (n || (n = y),
                y.throttleInput &&
                  o &&
                  void 0 !== y._lastAnyKeyPressTime &&
                  a - y._lastAnyKeyPressTime < y.throttleInput)
              )
                return !0;
              var T = !1;
              if (i && u) {
                var b = y[u];
                Gt(b) && !0 === b.call(y, e, y, n) && (T = !0);
              } else if (!i && l) {
                var S = y[l];
                Gt(S) && !0 === S.call(y, e, y, n) && (T = !0);
              }
              if (!T && d) {
                var E = y[d];
                Gt(E) && !0 === E.call(y, e, t, y, n) && (T = !0);
              }
              if (T) return ((y._lastAnyKeyPressTime = a), !0);
            }
            return !1;
          },
          lr = {},
          ur = (e, t, r) => {
            if (t) {
              var i = t.key || t.keyCode,
                n = tr[t.key] || tr[t.keyCode],
                a = er[t.key] || er[t.keyCode];
              if (n)
                return void (
                  lr[i] ||
                  (lr[i] = window.setTimeout(() => {
                    ((lr[i] = !0), or(t, n, !0));
                  }, e))
                );
              or(t, a, !1);
            } else if (r) {
              var s = r.key || r.keyCode,
                o = er[r.key] || er[r.keyCode];
              (!0 === lr[s] ? delete lr[s] : lr[s] && (clearTimeout(lr[s]), delete lr[s], or(r, o, !1)),
                or(r, o, !1, !0));
            }
          },
          dr = ({
            userKeyMap: e,
            keyHoldOptions: t,
            ownerContext: i = e => {
              e();
            },
          } = {}) => {
            (e && rr(e, er), null != t && t.userKeyHoldMap && rr(t.userKeyHoldMap, tr));
            var n = (null == t ? void 0 : t.holdThreshold) || 500,
              a = ur.bind(null, n),
              s = e =>
                i(() => {
                  a(e, void 0);
                }),
              o = e =>
                i(() => {
                  a(void 0, e);
                });
            return (
              document.addEventListener("keyup", o),
              document.addEventListener("keydown", s),
              {
                cleanup: () => {
                  (document.removeEventListener("keydown", s), document.removeEventListener("keyup", o));
                  for (var e = 0, t = Object.entries(lr); e < t.length; e++) {
                    var i = r(t[e], 2),
                      n = (i[0], i[1]);
                    n && !0 !== n && clearTimeout(n);
                  }
                },
                focusPath: () => nr,
              }
            );
          };
        var hr = new (class {
            constructor() {
              (o(this, "nodeConfigs", []), o(this, "isRegistered", !1), o(this, "stage", void 0));
            }
            register(e) {
              this.isRegistered ||
                ((this.isRegistered = !0), (this.stage = e), e.animationManager.registerAnimation(this));
            }
            add(e, t, r, i) {
              var n,
                a,
                s = this.nodeConfigs.find(r => r.node === e && r.propName === t),
                o = null !== (n = i.duration) && void 0 !== n ? n : 0,
                l = null !== (a = i.delay) && void 0 !== a ? a : 0,
                u = i.easing || "linear",
                d = U(u),
                h = r,
                c = e[t];
              s
                ? ((s.duration = o),
                  (s.delay = l),
                  (s.easing = u),
                  (s.timingFunction = d),
                  (s.targetValue = h),
                  (s.startValue = c),
                  (s.progress = 0),
                  (s.delayFor = l))
                : this.nodeConfigs.push({
                    node: e,
                    duration: o,
                    delay: l,
                    easing: u,
                    progress: 0,
                    delayFor: l,
                    timingFunction: d,
                    propName: t,
                    startValue: c,
                    targetValue: h,
                  });
            }
            update(e) {
              for (var t = this.nodeConfigs.length - 1; t >= 0; t--) {
                var r = this.nodeConfigs[t],
                  i = r.node,
                  n = r.duration,
                  a = r.timingFunction,
                  s = r.propName,
                  o = r.startValue,
                  l = r.targetValue,
                  u = e;
                if (r.delayFor > 0) {
                  if (((r.delayFor -= u), r.delayFor >= 0)) continue;
                  ((u = -r.delayFor), (r.delayFor = 0));
                }
                n > 0
                  ? ((r.progress += u / n), (r.progress = Math.max(0, Math.min(1, r.progress))))
                  : 0 === n && r.delayFor <= 0 && (r.progress = 1);
                var h,
                  c = a(r.progress) || r.progress,
                  f = void 0;
                if (
                  ((f = 1 === r.progress ? l : s.includes("color") ? d(o, l, c) : o + (l - o) * c),
                  (i.lng[s] = f),
                  1 === r.progress && this.nodeConfigs.splice(t, 1),
                  0 === this.nodeConfigs.length)
                )
                  (null === (h = this.stage) || void 0 === h || h.animationManager.unregisterAnimation(this),
                    (this.isRegistered = !1));
              }
            }
          })(),
          cr = !1,
          fr = new Set();
        function pr() {
          cr = !1;
          var e = [...fr];
          fr.clear();
          for (var t = e.length - 1; t >= 0; t--) {
            e[t].updateLayout();
          }
        }
        function gr(e) {
          (fr.add(e), cr || ((cr = !0), queueMicrotask(pr)));
        }
        function mr(e, t) {
          var r = [];
          for (var i in t) {
            var n = t[i];
            ("rounded" === i && (i = "radius"), "object" == typeof n && r.push(Ot.createEffect(i, n, i)));
          }
          return Ot.createShader("DynamicShader", { effects: r });
        }
        function vr(e = "") {
          return {
            set(r) {
              ("number" == typeof r && (r = { width: r, color: 255 }),
                (this.effects = this.effects
                  ? t(t({}, this.effects || {}), { [`border${e}`]: r })
                  : { [`border${e}`]: r }));
            },
            get() {
              var t;
              return null === (t = this.effects) || void 0 === t ? void 0 : t[`border${e}`];
            },
          };
        }
        class yr extends Object {
          constructor(e) {
            (super(),
              (this._type = "text" === e ? Bt : Ut),
              (this.rendered = !1),
              (this.lng = {}),
              (this.children = []));
          }
          get effects() {
            return this._effects;
          }
          set effects(e) {
            ((this._effects = e), Nt && this.rendered && (this.lng.shader = mr(0, e)));
          }
          set id(e) {
            var r;
            ((this._id = e),
              null !== (r = Ft.rendererOptions) &&
                void 0 !== r &&
                r.inspector &&
                (this.data = t(t({}, this.data), {}, { testId: e })));
          }
          get id() {
            return this._id;
          }
          get parent() {
            return this._parent;
          }
          set parent(e) {
            var t;
            ((this._parent = e), this.rendered && null != e && e.rendered) &&
              (this.lng.parent = null !== (t = e.lng) && void 0 !== t ? t : null);
          }
          insertChild(e, t) {
            if (
              (e.parent && (e.parent.removeChild(e), this.rendered || (this._hasRenderedChildren = !0)),
              (e.parent = this),
              t)
            ) {
              this.removeChild(e);
              var r = this.children.indexOf(t);
              if (r >= 0) return void this.children.splice(r, 0, e);
            }
            this.children.push(e);
          }
          removeChild(e) {
            var t,
              r = this.children.indexOf(e);
            r >= 0 && (this.children.splice(r, 1), null === (t = e.onRemove) || void 0 === t || t.call(e, e));
          }
          get selectedNode() {
            for (var e = this.selected || 0; e < this.children.length; e++) {
              var t = this.children[e];
              if (Wt(t)) return ((this.selected = e), t);
            }
          }
          set shader(e) {
            this.lng.shader = Vt(e) ? Ot.createShader(...e) : e;
          }
          _sendToLightningAnimatable(e, t) {
            var r = this;
            if (
              this.transition &&
              this.rendered &&
              Ft.animationsEnabled &&
              (!0 === this.transition || this.transition[e])
            ) {
              var i = !0 === this.transition || !0 === this.transition[e] ? void 0 : this.transition[e];
              if (Ft.simpleAnimationsEnabled)
                return (hr.add(this, e, t, i || this.animationSettings), void hr.register(Ot.stage));
              var n = this.animate({ [e]: t }, i);
              if (this.onAnimation)
                for (
                  var a = Object.keys(this.onAnimation),
                    s = function () {
                      var i = l[o],
                        a = r.onAnimation[i];
                      n.on(i, (i, n) => {
                        a.call(r, i, e, t, n);
                      });
                    },
                    o = 0,
                    l = a;
                  o < l.length;
                  o++
                )
                  s();
              return n.start();
            }
            this.lng[e] = t;
          }
          animate(e, t) {
            return this.lng.animate(e, t || this.animationSettings || {});
          }
          chain(e, t) {
            return (
              this._animationRunning && ((this._animationQueue = []), (this._animationRunning = !1)),
              t
                ? (this._animationQueueSettings = t)
                : this._animationQueueSettings ||
                  (this._animationQueueSettings = t || this.animationSettings),
              (t = t || this._animationQueueSettings),
              (this._animationQueue = this._animationQueue || []),
              this._animationQueue.push({ props: e, animationSettings: t }),
              this
            );
          }
          start() {
            var e = this;
            return s(
              i().m(function t() {
                var r;
                return i().w(function (t) {
                  for (;;)
                    switch (t.n) {
                      case 0:
                        r = e._animationQueue.shift();
                      case 1:
                        if (!r) {
                          t.n = 3;
                          break;
                        }
                        return (
                          (e._animationRunning = !0),
                          (t.n = 2),
                          e.animate(r.props, r.animationSettings).start().waitUntilStopped()
                        );
                      case 2:
                        ((r = e._animationQueue.shift()), (t.n = 1));
                        break;
                      case 3:
                        ((e._animationRunning = !1), (e._animationQueueSettings = void 0));
                      case 4:
                        return t.a(2);
                    }
                }, t);
              }),
            )();
          }
          emit(e, ...t) {
            for (var r = this, i = `on${e.charAt(0).toUpperCase()}${e.slice(1)}`; r; ) {
              var n = r[i];
              if (Gt(n) && !0 === n.call(r, this, ...t)) return !0;
              r = r.parent;
            }
            return !1;
          }
          setFocus() {
            if (this.rendered) {
              if (void 0 !== this.forwardFocus)
                if (jt(this.forwardFocus)) {
                  if (!1 !== this.forwardFocus.call(this, this)) return;
                } else {
                  var e = "number" == typeof this.forwardFocus ? this.forwardFocus : null,
                    t = this.children;
                  if (null !== e && e < t.length) {
                    var r = t[e];
                    return void (Wt(r) && r.setFocus());
                  }
                }
              queueMicrotask(() => {
                return (ar((e = this), Jt), (Jt = e), void Ft.setActiveElement(e));
                var e;
              });
            } else this._autofocus = !0;
          }
          _layoutOnLoad() {
            this.lng.on("loaded", () => {
              this.parent.updateLayout();
            });
          }
          getText() {
            for (var e = "", t = 0; t < this.children.length; t++) e += this.children[t].text;
            return e;
          }
          destroy() {
            if (this.onDestroy) {
              var e = this.onDestroy(this);
              e instanceof Promise ? e.then(() => this._destroy()) : this._destroy();
            } else this._destroy();
          }
          _destroy() {
            var e;
            Kt(this.lng) &&
              (this.lng.destroy(),
              null !== (e = this.parent) && void 0 !== e && e.requiresLayout() && this.parent.updateLayout());
          }
          set style(e) {
            if ((!Ft.lockStyles || !this._style) && e)
              for (var t in ((this._style = e), this._style))
                void 0 === this[t] && (this[t] = this._style[t]);
          }
          get style() {
            return this._style;
          }
          get hasChildren() {
            return this.children.length > 0;
          }
          set src(e) {
            "string" == typeof e
              ? ((this.lng.src = e), !this.color && this.rendered && (this.color = 4294967295))
              : (this.color = 0);
          }
          get src() {
            return this.lng.src;
          }
          getChildById(e) {
            return this.children.find(t => t.id === e);
          }
          searchChildrenById(e) {
            for (var t = 0; t < this.children.length; t++) {
              var r = this.children[t];
              if (Wt(r)) {
                if (r.id === e) return r;
                var i = r.searchChildrenById(e);
                if (i) return i;
              }
            }
          }
          set states(e) {
            ((this._states = this._states ? this._states.merge(e) : new Yt(this._stateChanged.bind(this), e)),
              this.rendered && this._stateChanged());
          }
          get states() {
            return ((this._states = this._states || new Yt(this._stateChanged.bind(this))), this._states);
          }
          get animationSettings() {
            return this._animationSettings || Ft.animationSettings;
          }
          set animationSettings(e) {
            this._animationSettings = e;
          }
          set hidden(e) {
            this.alpha = e ? 0 : 1;
          }
          get hidden() {
            return 0 === this.alpha;
          }
          get h() {
            return this.height;
          }
          set h(e) {
            this.height = e;
          }
          get w() {
            return this.width;
          }
          set w(e) {
            this.width = e;
          }
          set autofocus(e) {
            ((this._autofocus = e), e && queueMicrotask(() => this.setFocus()));
          }
          get autofocus() {
            return this._autofocus;
          }
          requiresLayout() {
            return "flex" === this.display || this.onLayout;
          }
          set updateLayoutOn(e) {
            this.updateLayout();
          }
          get updateLayoutOn() {
            return null;
          }
          updateLayout() {
            if (this.hasChildren) {
              if ("flex" === this.display && this.flexGrow && 0 === this.width) return;
              var e = "flex" === this.display && Qt(this);
              fr.delete(this);
              var t = jt(this.onLayout) && this.onLayout.call(this, this);
              ((e || t) && this.parent && gr(this.parent),
                !0 === this._containsFlexGrow &&
                  this.children.forEach(e => {
                    "flex" === e.display &&
                      Wt(e) &&
                      (Qt(e), jt(e.onLayout) && e.onLayout.call(e, e), gr(this));
                  }));
            }
          }
          _stateChanged() {
            if (this.forwardStates) {
              var e = this.states.slice();
              this.children.forEach(t => {
                t.states = e;
              });
            }
            var r = this.states;
            if (
              this._undoStyles ||
              (function (e, t) {
                var r,
                  i = l(t);
                try {
                  for (i.s(); !(r = i.n()).done; ) if (r.value in e) return !0;
                } catch (n) {
                  i.e(n);
                } finally {
                  i.f();
                }
                return !1;
              })(this, r)
            ) {
              var i;
              this._undoStyles &&
                this._undoStyles.length &&
                ((i = {}),
                this._undoStyles.forEach(e => {
                  i[e] = this.style[e];
                }));
              var n,
                a = r.length;
              if (0 === a) return (Object.assign(this, i), void (this._undoStyles = []));
              (1 === a
                ? ((n = this[r[0]]), (n = i ? t(t({}, i), n) : n))
                : (n = r.reduce((e, r) => {
                    var i = this[r];
                    return i ? t(t({}, e), i) : e;
                  }, i || {})),
                n
                  ? ((this._undoStyles = Object.keys(n)),
                    void 0 !== n.transition && (this.transition = n.transition),
                    Object.assign(this, n))
                  : (this._undoStyles = []));
            }
          }
          render(e) {
            var t,
              i,
              n,
              a = this,
              s = this.parent;
            if (s)
              if (s.rendered)
                if ((s.requiresLayout() && fr.add(s), this.rendered)) {
                  var o;
                  null === (o = this.onRender) || void 0 === o || o.call(this, this);
                } else {
                  this._states && this._stateChanged();
                  var u = a.lng,
                    d = s.width || 0,
                    h = s.height || 0;
                  if (
                    ((u.x = u.x || 0),
                    (u.y = u.y || 0),
                    (u.parent = s.lng),
                    (this.right || 0 === this.right) && ((u.x = d - this.right), (u.mountX = 1)),
                    (this.bottom || 0 === this.bottom) && ((u.y = h - this.bottom), (u.mountY = 1)),
                    this.center && (this.centerX = this.centerY = !0),
                    this.centerX && ((u.x += d / 2), (u.mountX = 0.5)),
                    this.centerY && ((u.y += h / 2), (u.mountY = 0.5)),
                    zt(a))
                  ) {
                    var c = u;
                    if (Ft.fontSettings)
                      for (var f in Ft.fontSettings) void 0 === c[f] && (c[f] = Ft.fontSettings[f]);
                    ((c.text = c.text || a.getText()),
                      c.textAlign && !c.contain && console.warn("Text align requires contain: ", a.getText()),
                      c.contain &&
                        (c.width || (c.width = d - c.x - (c.marginRight || 0)),
                        "both" !== c.contain || c.height || c.maxLines
                          ? 1 === c.maxLines && (c.height = c.height || c.lineHeight || c.fontSize)
                          : (c.height = h - c.y - (c.marginBottom || 0))),
                      Nt && a._effects && (u.shader = mr(0, a._effects)),
                      (a.lng = Ot.createTextNode(u)),
                      s.requiresLayout() && ((u.width && u.height) || a._layoutOnLoad()));
                  } else if (
                    (u.texture ||
                      (isNaN(u.width) && ((u.width = a.flexGrow ? 0 : d - u.x), (a._calcWidth = !0)),
                      isNaN(u.height) && ((u.height = h - u.y), (a._calcHeight = !0)),
                      u.rtt && !u.color && (u.color = 4294967295),
                      u.color || u.src || (u.color = 0)),
                    Nt && a._effects && (u.shader = mr(0, a._effects)),
                    (a.lng = Ot.createNode(u)),
                    a._hasRenderedChildren)
                  ) {
                    a._hasRenderedChildren = !1;
                    var p,
                      g = l(a.children);
                    try {
                      for (g.s(); !(p = g.n()).done; ) {
                        var m = p.value;
                        Wt(m) && Kt(m.lng) && (m.lng.parent = a.lng);
                      }
                    } catch (x) {
                      g.e(x);
                    } finally {
                      g.f();
                    }
                  }
                  if (
                    ((a.rendered = !0),
                    a.autosize && s.requiresLayout() && a._layoutOnLoad(),
                    null === (t = this.onCreate) || void 0 === t || t.call(this, this),
                    null === (i = this.onRender) || void 0 === i || i.call(this, this),
                    a.onEvent)
                  )
                    for (
                      var v = function () {
                          var e = r(T[y], 2),
                            t = e[0],
                            i = e[1];
                          a.lng.on(t, (e, t) => i.call(a, a, t));
                        },
                        y = 0,
                        T = Object.entries(a.onEvent);
                      y < T.length;
                      y++
                    )
                      v();
                  if (
                    (null !== (n = a.lng) && void 0 !== n && n.div && (a.lng.div.element = a), a._type === Ut)
                  )
                    for (var b = a.children.length, S = 0; S < b; S++) {
                      var E = a.children[S];
                      Wt(E) && E.render();
                    }
                  (e && !cr && ((cr = !0), queueMicrotask(pr)), a._autofocus && a.setFocus());
                }
              else console.warn("Parent not rendered yet: ", this);
            else console.warn("Parent not set - no node created for: ", this);
          }
        }
        for (
          var Tr = function () {
              var e = Sr[br];
              Object.defineProperty(yr.prototype, e, {
                get() {
                  return this.lng[e];
                },
                set(t) {
                  this._sendToLightningAnimatable(e, t);
                },
              });
            },
            br = 0,
            Sr = [
              "alpha",
              "color",
              "colorTop",
              "colorRight",
              "colorLeft",
              "colorBottom",
              "colorTl",
              "colorTr",
              "colorBl",
              "colorBr",
              "height",
              "fontSize",
              "lineHeight",
              "mount",
              "mountX",
              "mountY",
              "pivot",
              "pivotX",
              "pivotY",
              "rotation",
              "scale",
              "scaleX",
              "scaleY",
              "width",
              "worldX",
              "worldY",
              "x",
              "y",
              "zIndex",
              "zIndexLocked",
            ];
          br < Sr.length;
          br++
        )
          Tr();
        for (
          var Er = function () {
              var e = wr[xr];
              Object.defineProperty(yr.prototype, e, {
                get() {
                  return this.lng[e];
                },
                set(t) {
                  this.lng[e] = t;
                },
              });
            },
            xr = 0,
            wr = [
              "absX",
              "absY",
              "autosize",
              "clipping",
              "contain",
              "data",
              "destroyed",
              "fontFamily",
              "fontStretch",
              "fontStyle",
              "fontWeight",
              "imageType",
              "letterSpacing",
              "maxLines",
              "offsetY",
              "overflowSuffix",
              "preventCleanup",
              "rtt",
              "scrollable",
              "scrollY",
              "srcHeight",
              "srcWidth",
              "srcX",
              "srcY",
              "strictBounds",
              "text",
              "textAlign",
              "textBaseline",
              "textOverflow",
              "texture",
              "textureOptions",
              "verticalAlign",
              "wordWrap",
            ];
          xr < wr.length;
          xr++
        )
          Er();
        function Ar(e) {
          return {
            set(r) {
              this.effects = this.effects ? t(t({}, this.effects), {}, { [e]: r }) : { [e]: r };
            },
            get() {
              var t;
              return null === (t = this.effects) || void 0 === t ? void 0 : t[e];
            },
          };
        }
        Object.defineProperties(yr.prototype, {
          border: vr(),
          borderLeft: vr("Left"),
          borderRight: vr("Right"),
          borderTop: vr("Top"),
          borderBottom: vr("Bottom"),
          linearGradient: Ar("linearGradient"),
          radialGradient: Ar("radialGradient"),
          radialProgress: Ar("radialProgressGradient"),
          rounded: {
            set(e) {
              this.effects = this.effects
                ? t(t({}, this.effects), {}, { radius: { radius: e } })
                : { radius: { radius: e } };
            },
            get() {
              var e;
              return null === (e = this.effects) || void 0 === e || null === (e = e.radius) || void 0 === e
                ? void 0
                : e.radius;
            },
          },
          borderRadius: {
            set(e) {
              this.effects = this.effects
                ? t(t({}, this.effects), {}, { radius: { radius: e } })
                : { radius: { radius: e } };
            },
            get() {
              var e;
              return null === (e = this.effects) || void 0 === e || null === (e = e.radius) || void 0 === e
                ? void 0
                : e.radius;
            },
          },
        });
        var Ir = Symbol("solid-proxy"),
          kr = "function" == typeof Proxy,
          Rr = Symbol("solid-track"),
          Cr = { equals: (e, t) => e === t },
          Lr = ui,
          Mr = 1,
          Dr = 2,
          _r = { owned: null, cleanups: null, context: null, owner: null },
          Pr = {},
          Or = null,
          Nr = null,
          Fr = null,
          Ur = null,
          Br = null,
          $r = 0;
        function jr(e, t) {
          var r = Fr,
            i = Or,
            n = 0 === e.length,
            a = i,
            s = n ? _r : { owned: null, cleanups: null, context: a ? a.context : null, owner: a },
            o = n ? e : () => e(() => zr(() => fi(s)));
          ((Or = s), (Fr = null));
          try {
            return li(o, !0);
          } finally {
            ((Fr = r), (Or = i));
          }
        }
        function Gr(e, t) {
          var r = {
            value: e,
            observers: null,
            observerSlots: null,
            comparator: (t = t ? Object.assign({}, Cr, t) : Cr).equals || void 0,
          };
          return [ii.bind(r), e => ("function" == typeof e && (e = e(r.value)), ni(r, e))];
        }
        function Vr(e, t, r) {
          ai(si(e, t, !1, Mr));
        }
        function Hr(e, t, r) {
          Lr = di;
          var i = si(e, t, !1, Mr);
          ((i.user = !0), Br ? Br.push(i) : ai(i));
        }
        function Kr(e, t, r) {
          r = r ? Object.assign({}, Cr, r) : Cr;
          var i = si(e, t, !0, 0);
          return (
            (i.observers = null),
            (i.observerSlots = null),
            (i.comparator = r.equals || void 0),
            ai(i),
            ii.bind(i)
          );
        }
        function Wr(e, t, i) {
          var n, a, s;
          "function" == typeof t ? ((n = e), (a = t), (s = {})) : ((n = !0), (a = e), (s = t || {}));
          var o = null,
            u = Pr,
            d = !1,
            h = "initialValue" in s,
            c = "function" == typeof n && Kr(n),
            f = new Set(),
            p = r((s.storage || Gr)(s.initialValue), 2),
            g = p[0],
            m = p[1],
            v = r(Gr(void 0), 2),
            y = v[0],
            T = v[1],
            b = r(Gr(void 0, { equals: !1 }), 2),
            S = (b[0], b[1]),
            E = r(Gr(h ? "ready" : "unresolved"), 2),
            x = E[0],
            w = E[1];
          function A(e, t, r, i) {
            return (
              o === e &&
                ((o = null),
                void 0 !== i && (h = !0),
                (e !== u && t !== u) || !s.onHydrated || queueMicrotask(() => s.onHydrated(i, { value: t })),
                (u = Pr),
                (function (e, t) {
                  li(() => {
                    (void 0 === t && m(() => e),
                      w(void 0 !== t ? "errored" : h ? "ready" : "unresolved"),
                      T(t));
                    var r,
                      i = l(f.keys());
                    try {
                      for (i.s(); !(r = i.n()).done; ) {
                        r.value.decrement();
                      }
                    } catch (t) {
                      i.e(t);
                    } finally {
                      i.f();
                    }
                    f.clear();
                  }, !1);
                })(t, r)),
              t
            );
          }
          function I() {
            var e = g(),
              t = y();
            if (void 0 !== t && !o) throw t;
            return (Fr && Fr.user, e);
          }
          function k(e = !0) {
            if (!1 === e || !d) {
              d = !1;
              var t = c ? c() : n;
              if (null != t && !1 !== t) {
                var r,
                  i,
                  s =
                    u !== Pr
                      ? u
                      : zr(() => {
                          try {
                            return a(t, { value: g(), refetching: e });
                          } catch (i) {
                            r = i;
                          }
                        });
                if (void 0 === r)
                  return (i = s) && "object" == typeof i && "then" in i
                    ? ((o = s),
                      "v" in s
                        ? (1 === s.s ? A(o, s.v, void 0, t) : A(o, void 0, pi(s.v), t), s)
                        : ((d = !0),
                          queueMicrotask(() => (d = !1)),
                          li(() => {
                            (w(h ? "refreshing" : "pending"), S());
                          }, !1),
                          s.then(
                            e => A(s, e, void 0, t),
                            e => A(s, void 0, pi(e), t),
                          )))
                    : (A(o, s, void 0, t), s);
                A(o, void 0, pi(r), t);
              } else A(o, zr(g));
            }
          }
          Object.defineProperties(I, {
            state: { get: () => x() },
            error: { get: () => y() },
            loading: {
              get() {
                var e = x();
                return "pending" === e || "refreshing" === e;
              },
            },
            latest: {
              get() {
                if (!h) return I();
                var e = y();
                if (e && !o) throw e;
                return g();
              },
            },
          });
          var R = Or;
          return (
            c
              ? (function (e, t) {
                  ai(si(e, t, !0, Mr));
                })(() => ((R = Or), k(!1)))
              : k(!1),
            [I, { refetch: e => Jr(R, () => k(e)), mutate: m }]
          );
        }
        function zr(e) {
          if (null === Fr) return e();
          var t = Fr;
          Fr = null;
          try {
            return e();
          } finally {
            Fr = t;
          }
        }
        function qr(e, t, r) {
          var i,
            n = Array.isArray(e),
            a = r && r.defer;
          return r => {
            var s;
            if (n) {
              s = Array(e.length);
              for (var o = 0; o < e.length; o++) s[o] = e[o]();
            } else s = e();
            if (a) return ((a = !1), r);
            var l = zr(() => t(s, i, r));
            return ((i = s), l);
          };
        }
        function Xr(e) {
          Hr(() => zr(e));
        }
        function Yr(e) {
          return (null === Or || (null === Or.cleanups ? (Or.cleanups = [e]) : Or.cleanups.push(e)), e);
        }
        function Qr() {
          return Or;
        }
        function Jr(e, t) {
          var r = Or,
            i = Fr;
          ((Or = e), (Fr = null));
          try {
            return li(t, !0);
          } catch (n) {
            gi(n);
          } finally {
            ((Or = r), (Fr = i));
          }
        }
        var Zr = r(Gr(!1), 2);
        (Zr[0], Zr[1]);
        function ei(e, t) {
          var r = Symbol("context");
          return { id: r, Provider: vi(r), defaultValue: e };
        }
        function ti(e) {
          var t;
          return Or && Or.context && void 0 !== (t = Or.context[e.id]) ? t : e.defaultValue;
        }
        function ri(e) {
          var t = Kr(e),
            r = Kr(() => mi(t()));
          return (
            (r.toArray = () => {
              var e = r();
              return Array.isArray(e) ? e : null != e ? [e] : [];
            }),
            r
          );
        }
        function ii() {
          if (this.sources && this.state)
            if (this.state === Mr) ai(this);
            else {
              var e = Ur;
              ((Ur = null), li(() => hi(this), !1), (Ur = e));
            }
          if (Fr) {
            var t = this.observers ? this.observers.length : 0;
            (Fr.sources
              ? (Fr.sources.push(this), Fr.sourceSlots.push(t))
              : ((Fr.sources = [this]), (Fr.sourceSlots = [t])),
              this.observers
                ? (this.observers.push(Fr), this.observerSlots.push(Fr.sources.length - 1))
                : ((this.observers = [Fr]), (this.observerSlots = [Fr.sources.length - 1])));
          }
          return this.value;
        }
        function ni(e, t, r) {
          var i = e.value;
          return (
            (e.comparator && e.comparator(i, t)) ||
              ((e.value = t),
              e.observers &&
                e.observers.length &&
                li(() => {
                  for (var t = 0; t < e.observers.length; t += 1) {
                    var r = e.observers[t],
                      i = Nr && Nr.running;
                    (i && Nr.disposed.has(r),
                      (i ? r.tState : r.state) || (r.pure ? Ur.push(r) : Br.push(r), r.observers && ci(r)),
                      i || (r.state = Mr));
                  }
                  if (Ur.length > 1e6) throw ((Ur = []), new Error());
                }, !1)),
            t
          );
        }
        function ai(e) {
          if (e.fn) {
            fi(e);
            var t = $r;
            !(function (e, t, r) {
              var i,
                n = Or,
                a = Fr;
              Fr = Or = e;
              try {
                i = e.fn(t);
              } catch (s) {
                return (
                  e.pure && ((e.state = Mr), e.owned && e.owned.forEach(fi), (e.owned = null)),
                  (e.updatedAt = r + 1),
                  gi(s)
                );
              } finally {
                ((Fr = a), (Or = n));
              }
              (!e.updatedAt || e.updatedAt <= r) &&
                (null != e.updatedAt && "observers" in e ? ni(e, i) : (e.value = i), (e.updatedAt = r));
            })(e, e.value, t);
          }
        }
        function si(e, t, r, i = Mr, n) {
          var a = {
            fn: e,
            state: i,
            updatedAt: null,
            owned: null,
            sources: null,
            sourceSlots: null,
            cleanups: null,
            value: t,
            owner: Or,
            context: Or ? Or.context : null,
            pure: r,
          };
          return (null === Or || (Or !== _r && (Or.owned ? Or.owned.push(a) : (Or.owned = [a]))), a);
        }
        function oi(e) {
          if (0 !== e.state) {
            if (e.state === Dr) return hi(e);
            if (e.suspense && zr(e.suspense.inFallback)) return e.suspense.effects.push(e);
            for (var t = [e]; (e = e.owner) && (!e.updatedAt || e.updatedAt < $r); ) e.state && t.push(e);
            for (var r = t.length - 1; r >= 0; r--)
              if ((e = t[r]).state === Mr) ai(e);
              else if (e.state === Dr) {
                var i = Ur;
                ((Ur = null), li(() => hi(e, t[0]), !1), (Ur = i));
              }
          }
        }
        function li(e, t) {
          if (Ur) return e();
          var r = !1;
          (t || (Ur = []), Br ? (r = !0) : (Br = []), $r++);
          try {
            var i = e();
            return (
              (function (e) {
                Ur && (ui(Ur), (Ur = null));
                if (e) return;
                var t = Br;
                ((Br = null), t.length && li(() => Lr(t), !1));
              })(r),
              i
            );
          } catch (n) {
            (r || (Br = null), (Ur = null), gi(n));
          }
        }
        function ui(e) {
          for (var t = 0; t < e.length; t++) oi(e[t]);
        }
        function di(e) {
          var t,
            r = 0;
          for (t = 0; t < e.length; t++) {
            var i = e[t];
            i.user ? (e[r++] = i) : oi(i);
          }
          for (t = 0; t < r; t++) oi(e[t]);
        }
        function hi(e, t) {
          e.state = 0;
          for (var r = 0; r < e.sources.length; r += 1) {
            var i = e.sources[r];
            if (i.sources) {
              var n = i.state;
              n === Mr ? i !== t && (!i.updatedAt || i.updatedAt < $r) && oi(i) : n === Dr && hi(i, t);
            }
          }
        }
        function ci(e) {
          for (var t = 0; t < e.observers.length; t += 1) {
            var r = e.observers[t];
            r.state || ((r.state = Dr), r.pure ? Ur.push(r) : Br.push(r), r.observers && ci(r));
          }
        }
        function fi(e) {
          var t;
          if (e.sources)
            for (; e.sources.length; ) {
              var r = e.sources.pop(),
                i = e.sourceSlots.pop(),
                n = r.observers;
              if (n && n.length) {
                var a = n.pop(),
                  s = r.observerSlots.pop();
                i < n.length && ((a.sourceSlots[s] = i), (n[i] = a), (r.observerSlots[i] = s));
              }
            }
          if (e.tOwned) {
            for (t = e.tOwned.length - 1; t >= 0; t--) fi(e.tOwned[t]);
            delete e.tOwned;
          }
          if (e.owned) {
            for (t = e.owned.length - 1; t >= 0; t--) fi(e.owned[t]);
            e.owned = null;
          }
          if (e.cleanups) {
            for (t = e.cleanups.length - 1; t >= 0; t--) e.cleanups[t]();
            e.cleanups = null;
          }
          e.state = 0;
        }
        function pi(e) {
          return e instanceof Error ? e : new Error("string" == typeof e ? e : "Unknown error", { cause: e });
        }
        function gi(e, t = Or) {
          throw pi(e);
        }
        function mi(e) {
          if ("function" == typeof e && !e.length) return mi(e());
          if (Array.isArray(e)) {
            for (var t = [], r = 0; r < e.length; r++) {
              var i = mi(e[r]);
              Array.isArray(i) ? t.push.apply(t, i) : t.push(i);
            }
            return t;
          }
          return e;
        }
        function vi(e, r) {
          return function (r) {
            var i;
            return (
              Vr(
                () =>
                  (i = zr(
                    () => ((Or.context = t(t({}, Or.context), {}, { [e]: r.value })), ri(() => r.children)),
                  )),
                void 0,
              ),
              i
            );
          };
        }
        var yi = Symbol("fallback");
        function Ti(e) {
          for (var t = 0; t < e.length; t++) e[t]();
        }
        function bi(e, t) {
          return zr(() => e(t || {}));
        }
        function Si() {
          return !0;
        }
        var Ei = {
          get: (e, t, r) => (t === Ir ? r : e.get(t)),
          has: (e, t) => t === Ir || e.has(t),
          set: Si,
          deleteProperty: Si,
          getOwnPropertyDescriptor: (e, t) => ({
            configurable: !0,
            enumerable: !0,
            get: () => e.get(t),
            set: Si,
            deleteProperty: Si,
          }),
          ownKeys: e => e.keys(),
        };
        function xi(e) {
          return (e = "function" == typeof e ? e() : e) ? e : {};
        }
        function wi() {
          for (var e = 0, t = this.length; e < t; ++e) {
            var r = this[e]();
            if (void 0 !== r) return r;
          }
        }
        function Ai(...e) {
          for (var t = !1, r = 0; r < e.length; r++) {
            var i = e[r];
            ((t = t || (!!i && Ir in i)), (e[r] = "function" == typeof i ? ((t = !0), Kr(i)) : i));
          }
          if (kr && t)
            return new Proxy(
              {
                get(t) {
                  for (var r = e.length - 1; r >= 0; r--) {
                    var i = xi(e[r])[t];
                    if (void 0 !== i) return i;
                  }
                },
                has(t) {
                  for (var r = e.length - 1; r >= 0; r--) if (t in xi(e[r])) return !0;
                  return !1;
                },
                keys() {
                  for (var t = [], r = 0; r < e.length; r++) t.push(...Object.keys(xi(e[r])));
                  return [...new Set(t)];
                },
              },
              Ei,
            );
          for (var n = {}, a = Object.create(null), s = e.length - 1; s >= 0; s--) {
            var o = e[s];
            if (o)
              for (
                var l = Object.getOwnPropertyNames(o),
                  u = function () {
                    var e = l[d];
                    if ("__proto__" === e || "constructor" === e) return 1;
                    var t = Object.getOwnPropertyDescriptor(o, e);
                    if (a[e]) {
                      var r = n[e];
                      r && (t.get ? r.push(t.get.bind(o)) : void 0 !== t.value && r.push(() => t.value));
                    } else
                      a[e] = t.get
                        ? { enumerable: !0, configurable: !0, get: wi.bind((n[e] = [t.get.bind(o)])) }
                        : void 0 !== t.value
                          ? t
                          : void 0;
                  },
                  d = l.length - 1;
                d >= 0;
                d--
              )
                u();
          }
          for (var h = {}, c = Object.keys(a), f = c.length - 1; f >= 0; f--) {
            var p = c[f],
              g = a[p];
            g && g.get ? Object.defineProperty(h, p, g) : (h[p] = g ? g.value : void 0);
          }
          return h;
        }
        function Ii(e) {
          var t = "fallback" in e && { fallback: () => e.fallback };
          return Kr(
            (function (e, t, i = {}) {
              var n = [],
                a = [],
                s = [],
                o = 0,
                l = t.length > 1 ? [] : null;
              return (
                Yr(() => Ti(s)),
                () => {
                  var u,
                    d,
                    h = e() || [],
                    c = h.length;
                  return (
                    h[Rr],
                    zr(() => {
                      var e, t, r, p, g, m, v, y, T;
                      if (0 === c)
                        (0 !== o && (Ti(s), (s = []), (n = []), (a = []), (o = 0), l && (l = [])),
                          i.fallback && ((n = [yi]), (a[0] = jr(e => ((s[0] = e), i.fallback()))), (o = 1)));
                      else if (0 === o) {
                        for (a = new Array(c), d = 0; d < c; d++) ((n[d] = h[d]), (a[d] = jr(f)));
                        o = c;
                      } else {
                        for (
                          r = new Array(c),
                            p = new Array(c),
                            l && (g = new Array(c)),
                            m = 0,
                            v = Math.min(o, c);
                          m < v && n[m] === h[m];
                          m++
                        );
                        for (v = o - 1, y = c - 1; v >= m && y >= m && n[v] === h[y]; v--, y--)
                          ((r[y] = a[v]), (p[y] = s[v]), l && (g[y] = l[v]));
                        for (e = new Map(), t = new Array(y + 1), d = y; d >= m; d--)
                          ((T = h[d]), (u = e.get(T)), (t[d] = void 0 === u ? -1 : u), e.set(T, d));
                        for (u = m; u <= v; u++)
                          ((T = n[u]),
                            void 0 !== (d = e.get(T)) && -1 !== d
                              ? ((r[d] = a[u]), (p[d] = s[u]), l && (g[d] = l[u]), (d = t[d]), e.set(T, d))
                              : s[u]());
                        for (d = m; d < c; d++)
                          d in r
                            ? ((a[d] = r[d]), (s[d] = p[d]), l && ((l[d] = g[d]), l[d](d)))
                            : (a[d] = jr(f));
                        ((a = a.slice(0, (o = c))), (n = h.slice(0)));
                      }
                      return a;
                    })
                  );
                  function f(e) {
                    if (((s[d] = e), l)) {
                      var i = r(Gr(d), 2),
                        n = i[0],
                        a = i[1];
                      return ((l[d] = a), t(h[d], n));
                    }
                    return t(h[d]);
                  }
                }
              );
            })(() => e.each, e.children, t || void 0),
          );
        }
        function ki(e) {
          var t = e.keyed,
            r = Kr(() => e.when, void 0, void 0),
            i = t ? r : Kr(r, void 0, { equals: (e, t) => !e == !t });
          return Kr(
            () => {
              var n = i();
              if (n) {
                var a = e.children;
                return "function" == typeof a && a.length > 0
                  ? zr(() =>
                      a(
                        t
                          ? n
                          : () => {
                              if (!zr(i)) throw `Stale read from <${"Show"}>.`;
                              return r();
                            },
                      ),
                    )
                  : a;
              }
              return e.fallback;
            },
            void 0,
            void 0,
          );
        }
        var Ri = r(Gr(void 0), 2),
          Ci = Ri[0],
          Li = Ri[1];
        function Mi(e, r) {
          return e ? (r ? t(t({}, r), e) : e) : r;
        }
        var Di = e => Kr(() => e());
        function _i({
          createElement: e,
          createTextNode: t,
          isTextNode: r,
          replaceText: i,
          insertNode: n,
          removeNode: a,
          setProperty: s,
          getParentNode: o,
          getFirstChild: l,
          getNextSibling: u,
        }) {
          function d(e, t, r, i) {
            if ((void 0 === r || i || (i = []), "function" != typeof t)) return h(e, t, i, r);
            Vr(i => h(e, t(), i, r), i);
          }
          function h(e, a, s, o, u) {
            for (; "function" == typeof s; ) s = s();
            if (a === s) return s;
            var d = typeof a,
              v = void 0 !== o;
            if ("string" === d || "number" === d)
              if (("number" === d && (a = a.toString()), v)) {
                var y = s[0];
                (y && r(y) ? i(y, a) : (y = t(a)), (s = p(e, s, o, y)));
              } else "" !== s && "string" == typeof s ? i(l(e), (s = a)) : (p(e, s, o, t(a)), (s = a));
            else if (null == a || "boolean" === d) s = p(e, s, o);
            else {
              if ("function" === d)
                return (
                  Vr(() => {
                    for (var t = a(); "function" == typeof t; ) t = t();
                    s = h(e, t, s, o);
                  }),
                  () => s
                );
              if (Array.isArray(a)) {
                var T = [];
                if (c(T, a, u)) return (Vr(() => (s = h(e, T, s, o, !0))), () => s);
                if (0 === T.length) {
                  var b = p(e, s, o);
                  if (v) return (s = b);
                } else
                  Array.isArray(s)
                    ? 0 === s.length
                      ? g(e, T, o)
                      : f(e, s, T)
                    : null == s || "" === s
                      ? g(e, T)
                      : f(e, (v && s) || [l(e)], T);
                s = T;
              } else {
                if (Array.isArray(s)) {
                  if (v) return (s = p(e, s, o, a));
                  p(e, s, null, a);
                } else null != s && "" !== s && l(e) ? m(e, a, l(e)) : n(e, a);
                s = a;
              }
            }
            return s;
          }
          function c(e, r, i) {
            for (var n = !1, a = 0, s = r.length; a < s; a++) {
              var o = r[a],
                l = void 0;
              if (null == o || !0 === o || !1 === o);
              else if (Array.isArray(o)) n = c(e, o) || n;
              else if ("string" == (l = typeof o) || "number" === l) e.push(t(o));
              else if ("function" === l)
                if (i) {
                  for (; "function" == typeof o; ) o = o();
                  n = c(e, Array.isArray(o) ? o : [o]) || n;
                } else (e.push(o), (n = !0));
              else e.push(o);
            }
            return n;
          }
          function f(e, t, r) {
            for (
              var i = r.length, s = t.length, o = i, l = 0, d = 0, h = u(t[s - 1]), c = null;
              l < s || d < o;
            )
              if (t[l] !== r[d]) {
                for (; t[s - 1] === r[o - 1]; ) (s--, o--);
                if (s === l) for (var f = o < i ? (d ? u(r[d - 1]) : r[o - d]) : h; d < o; ) n(e, r[d++], f);
                else if (o === d) for (; l < s; ) ((c && c.has(t[l])) || a(e, t[l]), l++);
                else if (t[l] === r[o - 1] && r[d] === t[s - 1]) {
                  var p = u(t[--s]);
                  (n(e, r[d++], u(t[l++])), n(e, r[--o], p), (t[s] = r[o]));
                } else {
                  if (!c) {
                    c = new Map();
                    for (var g = d; g < o; ) c.set(r[g], g++);
                  }
                  var v = c.get(t[l]);
                  if (null != v)
                    if (d < v && v < o) {
                      for (
                        var y = l, T = 1, b = void 0;
                        ++y < s && y < o && null != (b = c.get(t[y])) && b === v + T;
                      )
                        T++;
                      if (T > v - d) for (var S = t[l]; d < v; ) n(e, r[d++], S);
                      else m(e, r[d++], t[l++]);
                    } else l++;
                  else a(e, t[l++]);
                }
              } else (l++, d++);
          }
          function p(e, r, i, s) {
            if (void 0 === i) {
              for (var u; (u = l(e)); ) a(e, u);
              return (s && n(e, s), "");
            }
            var d = s || t("");
            if (r.length)
              for (var h = !1, c = r.length - 1; c >= 0; c--) {
                var f = r[c];
                if (d !== f) {
                  var p = o(f) === e;
                  h || c ? p && a(e, f) : p ? m(e, d, f) : n(e, d, i);
                } else h = !0;
              }
            else n(e, d, i);
            return [d];
          }
          function g(e, t, r) {
            for (var i = 0, a = t.length; i < a; i++) n(e, t[i], r);
          }
          function m(e, t, r) {
            (n(e, t, r), a(e, r));
          }
          function v(e, t, r = {}, i) {
            return (
              t || (t = {}),
              i || Vr(() => (r.children = h(e, t.children, r.children))),
              Vr(() => t.ref && t.ref(e)),
              Vr(() => {
                for (var i in t)
                  if ("children" !== i && "ref" !== i) {
                    var n = t[i];
                    n !== r[i] && (s(e, i, n, r[i]), (r[i] = n));
                  }
              }),
              r
            );
          }
          return {
            render(e, t) {
              var r;
              return (
                jr(i => {
                  ((r = i), d(t, e()));
                }),
                r
              );
            },
            insert: d,
            spread(e, t, r) {
              "function" == typeof t ? Vr(i => v(e, t(), i, r)) : v(e, t, void 0, r);
            },
            createElement: e,
            createTextNode: t,
            insertNode: n,
            setProp: (e, t, r, i) => (s(e, t, r, i), r),
            mergeProps: Ai,
            effect: Vr,
            memo: Di,
            createComponent: bi,
            use: (e, t, r) => zr(() => e(t, r)),
          };
        }
        Object.defineProperty(yr.prototype, "preserve", {
          get() {
            return 0 === this._queueDelete;
          },
          set(e) {
            this._queueDelete = e ? 0 : void 0;
          },
        });
        var Pi = [];
        function Oi() {
          var e,
            t = l(Pi);
          try {
            for (t.s(); !(e = t.n()).done; ) {
              var r = e.value;
              (Number(r._queueDelete) < 0 && r.destroy(), (r._queueDelete = void 0));
            }
          } catch (i) {
            t.e(i);
          } finally {
            t.f();
          }
          Pi.length = 0;
        }
        function Ni(e, t) {
          void 0 === e._queueDelete
            ? ((e._queueDelete = t), 1 === Pi.push(e) && queueMicrotask(Oi))
            : (e._queueDelete += t);
        }
        var Fi,
          Ui = {
            createElement: e => new yr(e),
            createTextNode: e => ({ _type: $t, text: e }),
            replaceText(e, t) {
              e.text = t;
              var r = e.parent;
              r.text = r.getText();
            },
            setProperty(e, t, r = !0) {
              e[t] = r;
            },
            insertNode(e, t, r) {
              var i = t.parent;
              (e.insertChild(t, r),
                t instanceof yr
                  ? (t.parent.rendered && t.render(!0), void 0 !== i && Ni(t, 1))
                  : zt(e) && (e.text = e.getText()));
            },
            isTextNode: e => zt(e),
            removeNode(e, t) {
              (e.removeChild(t), t instanceof yr ? Ni(t, -1) : zt(e) && (e.text = e.getText()));
            },
            getParentNode: e => e.parent,
            getFirstChild: e => e.children[0],
            getNextSibling(e) {
              var t = e.parent.children || [],
                r = t.indexOf(e) + 1;
              if (r < t.length) return t[r];
            },
          },
          Bi = (function (e) {
            var t = _i(e);
            return ((t.mergeProps = Ai), t);
          })(Ui),
          $i = Ui.createElement("App"),
          ji = function (e) {
            return Bi.render(e, $i);
          };
        var Gi = Bi.memo,
          Vi = Bi.createComponent,
          Hi = Bi.createElement,
          Ki = Bi.spread,
          Wi = Bi.setProp,
          zi = Bi.mergeProps,
          qi = [],
          Xi = !1;
        function Yi() {
          Xi &&
            qi.length &&
            setTimeout(() => {
              var e = qi.shift();
              e && (e(), Yi());
            }, Ft.taskDelay || 50);
        }
        jr(() => {
          Vr(() => {
            (Ci(), (Xi = !1));
          });
        });
        var Qi,
          Ji = e => {
            var t = Hi("node");
            return (Ki(t, e, !1), t);
          },
          Zi = e => {
            var t = Hi("text");
            return (Ki(t, e, !1), t);
          };
        function en() {
          var e = new Set();
          var r = !1;
          return {
            subscribe: function (t) {
              return (e.add(t), () => e.delete(t));
            },
            confirm: function (i, n) {
              if (r) return !(r = !1);
              var a,
                s = {
                  to: i,
                  options: n,
                  defaultPrevented: !1,
                  preventDefault: () => (s.defaultPrevented = !0),
                },
                o = l(e);
              try {
                var u = function () {
                  var e = a.value;
                  e.listener(
                    t(
                      t({}, s),
                      {},
                      {
                        from: e.location,
                        retry: a => {
                          (a && (r = !0), e.navigate(i, t(t({}, n), {}, { resolve: !1 })));
                        },
                      },
                    ),
                  );
                };
                for (o.s(); !(a = o.n()).done; ) u();
              } catch (d) {
                o.e(d);
              } finally {
                o.f();
              }
              return !s.defaultPrevented;
            },
          };
        }
        function tn() {
          ((window.history.state && null != window.history.state._depth) ||
            window.history.replaceState(
              t(t({}, window.history.state), {}, { _depth: window.history.length - 1 }),
              "",
            ),
            (Qi = window.history.state._depth));
        }
        tn();
        var rn = /^(?:[a-z0-9]+:)?\/\//i,
          nn = /^\/+|(\/)\/+$/g;
        function an(e, t = !1) {
          var r = e.replace(nn, "$1");
          return r ? (t || /^[?#]/.test(r) ? r : "/" + r) : "";
        }
        function sn(e, t, r) {
          if (!rn.test(t)) {
            var i = an(e),
              n = r && an(r),
              a = "";
            return (
              ((a =
                !n || t.startsWith("/") ? i : 0 !== n.toLowerCase().indexOf(i.toLowerCase()) ? i + n : n) ||
                "/") + an(t, !a)
            );
          }
        }
        function on(e, t) {
          return an(e).replace(/\/*(\*.*)?$/g, "") + an(t);
        }
        function ln(e) {
          var t = {};
          return (
            e.searchParams.forEach((e, r) => {
              r in t ? (Array.isArray(t[r]) ? t[r].push(e) : (t[r] = [t[r], e])) : (t[r] = e);
            }),
            t
          );
        }
        function un(e, t, i) {
          var n = r(e.split("/*", 2), 2),
            a = n[0],
            s = n[1],
            o = a.split("/").filter(Boolean),
            l = o.length;
          return e => {
            var r = e.split("/").filter(Boolean),
              n = r.length - l;
            if (n < 0 || (n > 0 && void 0 === s && !t)) return null;
            for (
              var a = { path: l ? "" : "/", params: {} }, u = e => (void 0 === i ? void 0 : i[e]), d = 0;
              d < l;
              d++
            ) {
              var h = o[d],
                c = ":" === h[0],
                f = c ? r[d] : r[d].toLowerCase(),
                p = c ? h.slice(1) : h.toLowerCase();
              if (c && dn(f, u(p))) a.params[p] = f;
              else if (c || !dn(f, p)) return null;
              a.path += `/${f}`;
            }
            if (s) {
              var g = n ? r.slice(-n).join("/") : "";
              if (!dn(g, u(s))) return null;
              a.params[s] = g;
            }
            return a;
          };
        }
        function dn(e, t) {
          var r = t => t === e;
          return (
            void 0 === t ||
            ("string" == typeof t
              ? r(t)
              : "function" == typeof t
                ? t(e)
                : Array.isArray(t)
                  ? t.some(r)
                  : t instanceof RegExp && t.test(e))
          );
        }
        function hn(e) {
          var t = new Map(),
            r = Qr();
          return new Proxy(
            {},
            {
              get: (i, n) => (
                t.has(n) ||
                  Jr(r, () =>
                    t.set(
                      n,
                      Kr(() => e()[n]),
                    ),
                  ),
                t.get(n)()
              ),
              getOwnPropertyDescriptor: () => ({ enumerable: !0, configurable: !0 }),
              ownKeys: () => Reflect.ownKeys(e()),
              has: (t, r) => r in e(),
            },
          );
        }
        function cn(e) {
          var t = /(\/?\:[^\/]+)\?/.exec(e);
          if (!t) return [e];
          for (
            var r = e.slice(0, t.index), i = e.slice(t.index + t[0].length), n = [r, (r += t[1])];
            (t = /^(\/\:[^\/]+)\?/.exec(i));
          )
            (n.push((r += t[1])), (i = i.slice(t[0].length)));
          return cn(i).reduce((e, t) => [...e, ...n.map(e => e + t)], []);
        }
        var fn,
          pn = ei(),
          gn = ei(),
          mn = () =>
            (function (e, t) {
              if (null == e) throw new Error(t);
              return e;
            })(ti(pn), "<A> and 'use' router primitives can be only used inside a Route."),
          vn = () => mn().navigatorFactory();
        function yn(e, r = "") {
          var i = e.component,
            n = e.preload,
            a = e.load,
            s = e.children,
            o = e.info,
            u = !s || (Array.isArray(s) && !s.length),
            d = { key: e, component: i, preload: n || a, info: o };
          return bn(e.path).reduce((i, n) => {
            var a,
              s = l(cn(n));
            try {
              for (s.s(); !(a = s.n()).done; ) {
                var o = a.value,
                  h = on(r, o),
                  c = u ? h : h.split("/*", 1)[0];
                ((c = c
                  .split("/")
                  .map(e => (e.startsWith(":") || e.startsWith("*") ? e : encodeURIComponent(e)))
                  .join("/")),
                  i.push(
                    t(t({}, d), {}, { originalPath: n, pattern: c, matcher: un(c, !u, e.matchFilters) }),
                  ));
              }
            } catch (f) {
              s.e(f);
            } finally {
              s.f();
            }
            return i;
          }, []);
        }
        function Tn(e, i = 0) {
          return {
            routes: e,
            score:
              1e4 *
                ((n = e[e.length - 1]),
                (a = r(n.pattern.split("/*", 2), 2)),
                (s = a[0]),
                (o = a[1]),
                (l = s.split("/").filter(Boolean)),
                l.reduce((e, t) => e + (t.startsWith(":") ? 2 : 3), l.length - (void 0 === o ? 0 : 1))) -
              i,
            matcher(r) {
              for (var i = [], n = e.length - 1; n >= 0; n--) {
                var a = e[n],
                  s = a.matcher(r);
                if (!s) return null;
                i.unshift(t(t({}, s), {}, { route: a }));
              }
              return i;
            },
          };
          var n, a, s, o, l;
        }
        function bn(e) {
          return Array.isArray(e) ? e : [e];
        }
        function Sn(e, t = "", r = [], i = []) {
          for (var n = bn(e), a = 0, s = n.length; a < s; a++) {
            var o = n[a];
            if (o && "object" == typeof o) {
              o.hasOwnProperty("path") || (o.path = "");
              var u,
                d = l(yn(o, t));
              try {
                for (d.s(); !(u = d.n()).done; ) {
                  var h = u.value;
                  r.push(h);
                  var c = Array.isArray(o.children) && 0 === o.children.length;
                  if (o.children && !c) Sn(o.children, h.pattern, r, i);
                  else {
                    var f = Tn([...r], i.length);
                    i.push(f);
                  }
                  r.pop();
                }
              } catch (p) {
                d.e(p);
              } finally {
                d.f();
              }
            }
          }
          return r.length ? i : i.sort((e, t) => t.score - e.score);
        }
        function En(e, t) {
          for (var r = 0, i = e.length; r < i; r++) {
            var n = e[r].matcher(t);
            if (n) return n;
          }
          return [];
        }
        function xn(e, i, n, a = {}) {
          var s = r(e.signal, 2),
            o = s[0],
            l = s[1],
            u = e.utils,
            d = void 0 === u ? {} : u,
            h = d.parsePath || (e => e),
            c = d.renderPath || (e => e),
            f = d.beforeLeave || en(),
            p = sn("", a.base || "");
          if (void 0 === p) throw new Error(`${p} is not a valid base path`);
          p && !o().value && l({ value: p, replace: !0, scroll: !1 });
          var g,
            m = r(Gr(!1), 2),
            v = m[0],
            y = m[1],
            T = (e, r) => {
              var i, n, a;
              (r.value === S() && r.state === w()) ||
                (void 0 === g && y(!0),
                (fn = e),
                (g = r),
                ((i = () => {
                  g === r && (E(g.value), A(g.state), R[1](e => e.filter(e => e.pending)));
                }),
                (n = Fr),
                (a = Or),
                Promise.resolve().then(() => {
                  ((Fr = n), (Or = a), li(i, !1), (Fr = Or = null));
                })).finally(() => {
                  g === r &&
                    (function (e) {
                      li(e, !1);
                    })(() => {
                      var r, i;
                      ((fn = void 0),
                        "navigate" === e &&
                          ((r = g),
                          (i = k[0]) &&
                            (l(t(t({}, r), {}, { replace: i.replace, scroll: i.scroll })), (k.length = 0))),
                        y(!1),
                        (g = void 0));
                    });
                }));
            },
            b = r(Gr(o().value), 2),
            S = b[0],
            E = b[1],
            x = r(Gr(o().state), 2),
            w = x[0],
            A = x[1],
            I = (function (e, t, r) {
              var i = new URL("http://sr"),
                n = Kr(
                  t => {
                    var r = e();
                    try {
                      return new URL(r, i);
                    } catch (n) {
                      return (console.error(`Invalid path ${r}`), t);
                    }
                  },
                  i,
                  { equals: (e, t) => e.href === t.href },
                ),
                a = Kr(() => n().pathname),
                s = Kr(() => n().search, !0),
                o = Kr(() => n().hash),
                l = qr(s, () => ln(n()));
              return {
                get pathname() {
                  return a();
                },
                get search() {
                  return s();
                },
                get hash() {
                  return o();
                },
                get state() {
                  return t();
                },
                get key() {
                  return "";
                },
                query: r ? r(l) : hn(l),
              };
            })(S, w, d.queryWrapper),
            k = [],
            R = Gr([]),
            C = Kr(() =>
              "function" == typeof a.transformUrl ? En(i(), a.transformUrl(I.pathname)) : En(i(), I.pathname),
            ),
            L = () => {
              for (var e = C(), t = {}, r = 0; r < e.length; r++) Object.assign(t, e[r].params);
              return t;
            },
            M = d.paramsWrapper ? d.paramsWrapper(L, i) : hn(L),
            D = { pattern: p, path: () => p, outlet: () => null, resolvePath: e => sn(p, e) };
          return (
            Vr(qr(o, e => T("native", e), { defer: !0 })),
            {
              base: D,
              location: I,
              params: M,
              isRouting: v,
              renderPath: c,
              parsePath: h,
              navigatorFactory: function (e) {
                return (
                  (e = e || ti(gn) || D),
                  (r, i) =>
                    (function (e, r, i) {
                      zr(() => {
                        if ("number" != typeof r) {
                          var n = !r || "?" === r[0],
                            a = t({ replace: !1, resolve: !n, scroll: !0 }, i),
                            s = a.replace,
                            o = a.resolve,
                            l = a.scroll,
                            u = a.state,
                            h = o ? e.resolvePath(r) : sn((n && I.pathname) || "", r);
                          if (void 0 === h) throw new Error(`Path '${r}' is not a routable path`);
                          if (k.length >= 100) throw new Error("Too many redirects");
                          var c = S();
                          (h === c && u === w()) ||
                            (f.confirm(h, i) &&
                              (k.push({ value: c, replace: s, scroll: l, state: w() }),
                              T("navigate", { value: h, state: u })));
                        } else
                          r &&
                            (d.go
                              ? d.go(r)
                              : console.warn("Router integration does not support relative routing"));
                      });
                    })(e, r, i)
                );
              },
              matches: C,
              beforeLeave: f,
              preloadRoute: function (e, t) {
                var r = En(i(), e.pathname),
                  a = fn;
                fn = "preload";
                var s = function () {
                  var i = r[o],
                    a = i.route,
                    s = i.params;
                  a.component && a.component.preload && a.component.preload();
                  var l = a.preload;
                  t &&
                    l &&
                    Jr(n(), () =>
                      l({
                        params: s,
                        location: {
                          pathname: e.pathname,
                          search: e.search,
                          hash: e.hash,
                          query: ln(e),
                          state: null,
                          key: "",
                        },
                        intent: "preload",
                      }),
                    );
                };
                for (var o in r) s();
                fn = a;
              },
              singleFlight: void 0 === a.singleFlight || a.singleFlight,
              submissions: R,
            }
          );
        }
        var wn = e => t => {
          var r,
            i = t.base,
            n = ri(() => t.children),
            a = Kr(() => Sn(n(), t.base || "")),
            s = xn(e, a, () => r, { base: i, singleFlight: t.singleFlight, transformUrl: t.transformUrl });
          return (
            e.create && e.create(s),
            Vi(pn.Provider, {
              value: s,
              get children() {
                return Vi(An, {
                  routerState: s,
                  get root() {
                    return t.root;
                  },
                  get preload() {
                    return t.rootPreload || t.rootLoad;
                  },
                  get children() {
                    return [
                      Gi(() => (r = Qr()) && null),
                      Vi(In, {
                        routerState: s,
                        get branches() {
                          return a();
                        },
                      }),
                    ];
                  },
                });
              },
            })
          );
        };
        function An(e) {
          var t = e.routerState.location,
            r = e.routerState.params,
            i = Kr(
              () =>
                e.preload &&
                zr(() => {
                  e.preload({ params: r, location: t, intent: fn || "initial" });
                }),
            );
          return Vi(ki, {
            get when() {
              return e.root;
            },
            keyed: !0,
            get fallback() {
              return e.children;
            },
            children: n =>
              Vi(n, {
                params: r,
                location: t,
                get data() {
                  return i();
                },
                get children() {
                  return e.children;
                },
              }),
          });
        }
        function In(e) {
          var t,
            r = [],
            i = Kr(
              qr(e.routerState.matches, (n, a, s) => {
                for (
                  var o = a && n.length === a.length,
                    l = [],
                    u = function (t) {
                      var u = a && a[t],
                        d = n[t];
                      s && u && d.route.key === u.route.key
                        ? (l[t] = s[t])
                        : ((o = !1),
                          r[t] && r[t](),
                          jr(n => {
                            ((r[t] = n),
                              (l[t] = (function (e, t, r, i) {
                                var n = e.base,
                                  a = e.location,
                                  s = e.params,
                                  o = i().route,
                                  l = o.pattern,
                                  u = o.component,
                                  d = o.preload,
                                  h = Kr(() => i().path);
                                u && u.preload && u.preload();
                                var c = d ? d({ params: s, location: a, intent: fn || "initial" }) : void 0;
                                return {
                                  parent: t,
                                  pattern: l,
                                  path: h,
                                  outlet: () =>
                                    u
                                      ? bi(u, {
                                          params: s,
                                          location: a,
                                          data: c,
                                          get children() {
                                            return r();
                                          },
                                        })
                                      : r(),
                                  resolvePath: e => sn(n.path(), e, h()),
                                };
                              })(
                                e.routerState,
                                l[t - 1] || e.routerState.base,
                                kn(() => i()[t + 1]),
                                () => {
                                  var r,
                                    i = e.routerState.matches();
                                  return null !== (r = i[t]) && void 0 !== r ? r : i[0];
                                },
                              )));
                          }));
                    },
                    d = 0,
                    h = n.length;
                  d < h;
                  d++
                )
                  u(d);
                return (r.splice(n.length).forEach(e => e()), s && o ? s : ((t = l[0]), l));
              }),
            );
          return kn(() => i() && t)();
        }
        var kn = e => () =>
            Vi(ki, {
              get when() {
                return e();
              },
              keyed: !0,
              children: e =>
                Vi(gn.Provider, {
                  value: e,
                  get children() {
                    return e.outlet();
                  },
                }),
            }),
          Rn = e => {
            var t = ri(() => e.children);
            return Ai(e, {
              get children() {
                return t();
              },
            });
          };
        var Cn,
          Ln = r(Gr([]), 2),
          Mn = Ln[0],
          Dn = Ln[1],
          _n = "aria-parent",
          Pn = [];
        function On(e) {
          return new Promise(t => {
            setTimeout(t, e);
          });
        }
        function Nn(e) {
          var t;
          0 !== (null == e || null === (t = e.text) || void 0 === t ? void 0 : t.trim().length) && Pn.push(e);
        }
        function Fn() {
          var e = $n();
          if (e) {
            for (var t = 0, r = Pn; t < r.length; t++) {
              var i = r[t],
                n = document.createElement("span");
              (n.setAttribute("lang", i.lang), n.setAttribute("aria-label", i.text), e.appendChild(n));
            }
            setTimeout(() => {
              ((Pn = []), Un(), Bn());
            }, 100);
          } else console.error(`ARIA div not found: ${_n}`);
        }
        function Un() {
          var e = document.getElementById(_n);
          if (e) for (; e.firstChild; ) e.removeChild(e.firstChild);
        }
        function Bn() {
          var e,
            t = null === (e = document.getElementById("app")) || void 0 === e ? void 0 : e.firstChild;
          null == t || t.focus();
        }
        function $n() {
          var e = document.getElementById(_n);
          if (!e) {
            var t = document.createElement("div");
            return (
              t.setAttribute("id", _n),
              t.setAttribute("aria-live", "assertive"),
              t.setAttribute("tabindex", "0"),
              document.body.appendChild(t),
              t
            );
          }
          return e;
        }
        function jn(e, t, r = "en-US", i) {
          var n = window.speechSynthesis;
          return new Promise((a, s) => {
            var o;
            if (i) {
              var l = n.getVoices();
              o = l.find(e => e.name === i) || l[0];
            }
            var u = new SpeechSynthesisUtterance(e);
            ((u.lang = r),
              o && (u.voice = o),
              (u.onend = () => {
                a();
              }),
              (u.onerror = e => {
                s(e);
              }),
              t.push(u),
              n.speak(u));
          });
        }
        function Gn(e, t, r, n, a = !0) {
          var o = window.speechSynthesis,
            l = (function (e = []) {
              var t,
                r = [];
              for (t = 0; t < e.length; t++) {
                var i = e[t];
                if ("string" != typeof i || i.includes("PAUSE-")) break;
                r.push(e[t]);
              }
              return [r.join(",\b ")].concat(e.slice(t));
            })(Array.isArray(e) ? e : [e]),
            u = [],
            d = [],
            h = !0;
          return {
            series: s(
              i().m(function e() {
                var s, o, c, f, p, g, m, v, y, T, b, S, E;
                return i().w(
                  function (e) {
                    for (;;)
                      switch ((e.p = e.n)) {
                        case 0:
                          e.p = 0;
                        case 1:
                          if (!h || !l.length) {
                            e.n = 37;
                            break;
                          }
                          return ((e.n = 2), Promise.resolve(l.shift()));
                        case 2:
                          if (((s = e.v), h)) {
                            e.n = 3;
                            break;
                          }
                          return e.a(3, 37);
                        case 3:
                          if ("string" != typeof s || !s.includes("PAUSE-")) {
                            e.n = 5;
                            break;
                          }
                          if (((o = 1e3 * Number(s.split("PAUSE-")[1])), isNaN(o))) {
                            e.n = 4;
                            break;
                          }
                          return ((e.n = 4), On(o));
                        case 4:
                          e.n = 36;
                          break;
                        case 5:
                          if ("string" != typeof s) {
                            e.n = 19;
                            break;
                          }
                          if (s) {
                            e.n = 6;
                            break;
                          }
                          return e.a(3, 1);
                        case 6:
                          f = c = 3;
                        case 7:
                          if (!(h && f > 0)) {
                            e.n = 18;
                            break;
                          }
                          if (((e.p = 8), !t)) {
                            e.n = 9;
                            break;
                          }
                          (Nn({ text: s, lang: r }), (e.n = 10));
                          break;
                        case 9:
                          return ((e.n = 10), jn(s, d, r, n));
                        case 10:
                          ((f = 0), (e.n = 17));
                          break;
                        case 11:
                          if (((e.p = 11), !((S = e.v) instanceof SpeechSynthesisErrorEvent))) {
                            e.n = 16;
                            break;
                          }
                          if ("network" !== S.error) {
                            e.n = 13;
                            break;
                          }
                          return (
                            f--,
                            console.warn(`Speech synthesis network error. Retries left: ${f}`),
                            (e.n = 12),
                            On(500 * (c - f))
                          );
                        case 12:
                          e.n = 15;
                          break;
                        case 13:
                          if ("canceled" !== S.error && "interrupted" !== S.error) {
                            e.n = 14;
                            break;
                          }
                          ((f = 0), (e.n = 15));
                          break;
                        case 14:
                          throw new Error(`SpeechSynthesisErrorEvent: ${S.error}`);
                        case 15:
                          e.n = 17;
                          break;
                        case 16:
                          throw S;
                        case 17:
                          e.n = 7;
                          break;
                        case 18:
                          e.n = 36;
                          break;
                        case 19:
                          if (!(s instanceof SpeechSynthesisUtterance)) {
                            e.n = 33;
                            break;
                          }
                          ((g = p = 3),
                            (m = s.text),
                            (v = null == s ? void 0 : s.lang),
                            (y = null == s ? void 0 : s.voice));
                        case 20:
                          if (!(h && g > 0)) {
                            e.n = 32;
                            break;
                          }
                          if (((e.p = 21), !m)) {
                            e.n = 24;
                            break;
                          }
                          if (!t) {
                            e.n = 22;
                            break;
                          }
                          (Nn({ text: m, lang: v }), (e.n = 23));
                          break;
                        case 22:
                          return ((e.n = 23), jn(m, d, v, null == y ? void 0 : y.name));
                        case 23:
                          g = 0;
                        case 24:
                          e.n = 31;
                          break;
                        case 25:
                          if (((e.p = 25), !((E = e.v) instanceof SpeechSynthesisErrorEvent))) {
                            e.n = 30;
                            break;
                          }
                          if ("network" !== E.error) {
                            e.n = 27;
                            break;
                          }
                          return (
                            g--,
                            console.warn(`Speech synthesis network error. Retries left: ${g}`),
                            (e.n = 26),
                            On(500 * (p - g))
                          );
                        case 26:
                          e.n = 29;
                          break;
                        case 27:
                          if ("canceled" !== E.error && "interrupted" !== E.error) {
                            e.n = 28;
                            break;
                          }
                          ((g = 0), (e.n = 29));
                          break;
                        case 28:
                          throw new Error(`SpeechSynthesisErrorEvent: ${E.error}`);
                        case 29:
                          e.n = 31;
                          break;
                        case 30:
                          throw E;
                        case 31:
                          e.n = 20;
                          break;
                        case 32:
                          e.n = 36;
                          break;
                        case 33:
                          if ("function" != typeof s) {
                            e.n = 35;
                            break;
                          }
                          return ((T = Gn(s(), t, r, n, !1)), u.push(T), (e.n = 34), T.series);
                        case 34:
                          e.n = 36;
                          break;
                        case 35:
                          if (!Array.isArray(s)) {
                            e.n = 36;
                            break;
                          }
                          return ((b = Gn(s, t, r, n, !1)), u.push(b), (e.n = 36), b.series);
                        case 36:
                          e.n = 1;
                          break;
                        case 37:
                          return ((e.p = 37), (h = !1), a && t && Fn(), e.f(37));
                        case 38:
                          return e.a(2);
                      }
                  },
                  e,
                  null,
                  [
                    [21, 25],
                    [8, 11],
                    [0, , 37, 38],
                  ],
                );
              }),
            )(),
            get active() {
              return h;
            },
            append: e => {
              l.push(e);
            },
            cancel: () => {
              if (h) {
                if (a) {
                  if (t) {
                    var e = $n();
                    return void (e && ((Pn = []), Un(), e.focus(), Bn()));
                  }
                  o.cancel();
                }
                (u.forEach(e => {
                  e.cancel();
                }),
                  (h = !1));
              }
            },
          };
        }
        function Vn(e, t, r = "en-US", i) {
          return (Cn && Cn.cancel(), (Cn = Gn(e, t, r, i)));
        }
        var Hn,
          Kn,
          Wn = (e, t) => {
            var r,
              i = () => clearTimeout(r);
            Qr() && Yr(i);
            return Object.assign(
              (...n) => {
                (void 0 !== r && i(), (r = setTimeout(() => e(...n), t)));
              },
              { clear: i },
            );
          },
          zn = [],
          qn = !1;
        function Xn(e, t) {
          var r,
            i = Wn(e, t),
            n = e => {
              ((r = e), i(e));
            };
          return (
            (n.flush = () => {
              (i.clear(), e(r));
            }),
            (n.clear = i.clear),
            n
          );
        }
        function Yn(e) {
          return e.id || e.name;
        }
        function Qn(e = []) {
          if (Jn.onFocusChange && Jn.enabled) {
            var t = e.every(e => !e.loading),
              r = e.filter(e => !zn.includes(e));
            if ((Hn(), t || !Jn.onFocusChange)) {
              zn = e.slice(0);
              var i = [],
                n = r
                  .reverse()
                  .reduce(
                    (e, t) => (
                      t.announce
                        ? (e.push([Yn(t), "Announce", t.announce]), i.push(t.announce))
                        : t.title
                          ? (e.push([Yn(t), "Title", t.title]), i.push(t.title))
                          : e.push([Yn(t), "No Announce", ""]),
                      e
                    ),
                    [],
                  );
              return (
                r
                  .reverse()
                  .reduce(
                    (e, t) => (
                      t.announceContext
                        ? (e.push([Yn(t), "Context", t.announceContext]), i.push(t.announceContext))
                        : e.push([Yn(t), "No Context", ""]),
                      e
                    ),
                    n,
                  ),
                Jn.debug && console.table(n),
                i.length ? Jn.speak(i.reduce((e, t) => e.concat(t), [])) : void 0
              );
            }
            Jn.onFocusChange([]);
          }
        }
        var Jn = {
            debug: !1,
            enabled: !0,
            lang: "en-US",
            aria: !1,
            cancel: function () {
              Kn && Kn.cancel();
            },
            clearPrevFocus: function (e = 0) {
              ((zn = zn.slice(0, e)), Hn());
            },
            speak: function (e, { append: t = !1, notification: r = !1 } = {}) {
              var i;
              Jn.onFocusChange &&
                Jn.enabled &&
                (t && Kn && Kn.active
                  ? Kn.append(e)
                  : (Jn.cancel(),
                    (function (e, t, r, i) {
                      if (!qn) Kn = Vn(e, t, r, i);
                    })(e, Jn.aria, Jn.lang, Jn.voice)),
                r &&
                  ((qn = !0),
                  null === (i = Kn) ||
                    void 0 === i ||
                    i.series
                      .finally(() => {
                        ((qn = !1), Jn.refresh());
                      })
                      .catch(console.error)));
              return Kn;
            },
            refresh: function (e = 0) {
              (Jn.clearPrevFocus(e), Jn.onFocusChange && Jn.onFocusChange(zr(() => Mn())));
            },
            setupTimers: function ({ focusDebounce: e = 400, focusChangeTimeout: t = 3e5 } = {}) {
              ((Jn.onFocusChange = Xn(Qn, e)),
                (Hn = Xn(() => {
                  zn = [];
                }, t)));
            },
          },
          Zn = !1;
        function ea(e) {
          var t = e.replace(/^.*?#/, "");
          if (!t.startsWith("/")) {
            var i = r(window.location.hash.split("#", 2), 2)[1];
            return `${void 0 === i ? "/" : i}#${t}`;
          }
          return t;
        }
        function ta(e) {
          var r = () => window.location.hash.slice(1),
            i = en();
          return (function (e) {
            var t = !1,
              r = e => ("string" == typeof e ? { value: e } : e),
              i = (function ([e, t], r, i) {
                return [e, i ? e => t(i(e)) : t];
              })(
                Gr(r(e.get()), { equals: (e, t) => e.value === t.value && e.state === t.state }),
                0,
                r => (!t && e.set(r), r),
              );
            return (
              e.init &&
                Yr(
                  e.init((n = e.get()) => {
                    ((t = !0), i[1](r(n)), (t = !1));
                  }),
                ),
              wn({ signal: i, create: e.create, utils: e.utils })
            );
          })({
            get: r,
            set({ value: e, replace: r, state: i }) {
              (r
                ? window.history.replaceState(
                    (function (e) {
                      return t(t({}, e), {}, { _depth: window.history.state && window.history.state._depth });
                    })(i),
                    "",
                    "#" + e,
                  )
                : window.history.pushState(i, "", "#" + e),
                tn());
            },
            init: e => {
              return (
                (t = window),
                (n = "hashchange"),
                (a = (function (e, t) {
                  var r = !1;
                  return () => {
                    var i = Qi;
                    tn();
                    var n = null == i ? null : Qi - i;
                    r ? (r = !1) : n && t(n) ? ((r = !0), window.history.go(-n)) : e();
                  };
                })(e, e => !i.confirm(e && e < 0 ? e : r()))),
                t.addEventListener(n, a),
                () => t.removeEventListener(n, a)
              );
              var t, n, a;
            },
            utils: {
              go: e => window.history.go(e),
              renderPath: e => `#${e}`,
              parsePath: ea,
              beforeLeave: i,
              queryWrapper: e.forceProxy || !ra ? t => ia(t, e.queryParams) : void 0,
              paramsWrapper: e.forceProxy || !ra ? (e, t) => ia(e, na(t())) : void 0,
            },
          })(e);
        }
        var ra = "function" == typeof Proxy;
        function ia(e, t) {
          var r = new Map(),
            i = Qr(),
            n = {};
          return (
            (t || Object.keys(e())).forEach(t => {
              Object.defineProperty(n, t, {
                get: () => {
                  return (
                    (n = t),
                    r.has(n) ||
                      Jr(i, () =>
                        r.set(
                          n,
                          Kr(() => e()[n]),
                        ),
                      ),
                    r.get(n)()
                  );
                  var n;
                },
                enumerable: !0,
                configurable: !0,
              });
            }),
            n
          );
        }
        var na = e => {
          var t = [];
          return (
            e.forEach(e => {
              e.routes.forEach(e => {
                if (e.pattern) {
                  var r = e.pattern.match(/:(\w+)/g);
                  r &&
                    r.forEach(e => {
                      var r = e.slice(1);
                      t.includes(r) || t.push(r);
                    });
                }
              });
            }),
            t
          );
        };
        function aa(e, t) {
          return 0 === e || (e >= 0 && e < t.length);
        }
        function sa(e, t = 0, r = 1) {
          for (var i = t; ; i += r) {
            var n;
            if (!aa(i, e.children)) {
              if (!e.wrap) break;
              i = (i + e.children.length) % e.children.length;
            }
            if (null === (n = e.children[i]) || void 0 === n || !n.skipFocus) return i;
          }
          return -1;
        }
        function oa(e, t) {
          var r,
            i = e.children[t];
          if (null == i || i.skipFocus) return ((e.selected = -1), !1);
          var n = e.selected;
          return (
            (e.selected = t),
            Xt(i) || i.setFocus(),
            null === (r = e.onSelectedChanged) || void 0 === r || r.call(e, t, e, i, n),
            !0
          );
        }
        var la = function () {
          var e,
            t,
            r,
            i = this,
            n = i.selected;
          if (0 !== n)
            for (
              e = n,
                t = 0,
                r = this.children.length - 1,
                n = t < r ? Math.min(Math.max(e, t), r) : Math.min(Math.max(e, r), t);
              !aa(n, this.children);
            )
              n--;
          return ((n = sa(i, n)), (i.selected = n), oa(i, n));
        };
        function ua(e) {
          return function () {
            return (function (e, t) {
              var r = sa(e, e.selected + t, t);
              if (-1 === r) {
                var i;
                if (
                  !aa(e.selected, e.children) ||
                  (null !== (i = e.children[e.selected]) && void 0 !== i && i.skipFocus) ||
                  Xt(e.children[e.selected])
                )
                  return !1;
                r = e.selected;
              }
              var n = e.children[r];
              if (e.plinko) {
                var a = e.children[e.selected].selected || 0;
                n.selected = a < n.children.length ? a : n.children.length - 1;
              }
              return oa(e, r);
            })(this, "up" === e || "left" === e ? -1 : 1);
          };
        }
        var da = e => 8 !== e.lng.renderState;
        function ha(e) {
          var t = e ? "width" : "height",
            r = e ? "x" : "y";
          return (i, n, a, s) => {
            var o,
              l,
              u,
              d,
              h,
              c,
              f,
              p,
              g,
              m = n;
            if (
              ("number" != typeof i && (i = (m = i).selected || 0),
              m && "none" !== m.scroll && i !== s && m.children.length)
            ) {
              void 0 === m._initialPosition && (m._initialPosition = m[r]);
              var v = m.lng,
                y = e ? v.stage.root.width : v.stage.root.height,
                T = void 0 === s || s - 1 !== i;
              if (void 0 === m._screenOffset) {
                var b;
                if (m.parent.clipping) {
                  var S,
                    E = m.parent;
                  m.endOffset =
                    null !== (S = m.endOffset) && void 0 !== S ? S : y - ((e ? E.absX : E.absY) || 0) - E[t];
                }
                m._screenOffset = null !== (b = m.offset) && void 0 !== b ? b : (e ? v.absX : v.absY) - m[r];
              }
              var x = m._screenOffset,
                w = m.gap || 0,
                A = m.scroll || (void 0 === s ? (m.scrollIndex ? "center" : "always") : "auto"),
                I = null !== (o = m._targetPosition) && void 0 !== o ? o : m[r],
                k = T ? Math.min(I, m[r]) : Math.max(I, m[r]);
              m.offset = null !== (l = m.offset) && void 0 !== l ? l : k;
              var R = m.offset;
              if ((a = a || m.children[i])) {
                var C = null !== (u = a[r]) && void 0 !== u ? u : 0,
                  L = null !== (d = a[t]) && void 0 !== d ? d : 0,
                  M =
                    L *
                    (null !==
                      (h =
                        null !== (c = a.scale) && void 0 !== c
                          ? c
                          : null === (f = a.style) || void 0 === f || null === (f = f.focus) || void 0 === f
                            ? void 0
                            : f.scale) && void 0 !== h
                      ? h
                      : 1),
                  D = null !== (p = m[t]) && void 0 !== p ? p : 0,
                  _ = Math.min(y - D - x - (null !== (g = m.endOffset) && void 0 !== g ? g : 2 * w), R),
                  P = T ? i + 1 : i - 1,
                  O = m.children[P] || null,
                  N = k;
                if (a.centerScroll) N = (y - M) / 2 - C;
                else if ("always" === A) N = -C + R;
                else if ("bounded" === A) {
                  var F = m.children.length,
                    U = m.upCount || 6,
                    B = Math.max(0, F - U),
                    $ = i === B;
                  if (i >= B)
                    if (T)
                      if ($ && void 0 !== s && s < B) {
                        var j,
                          G = m.children[B],
                          V = null !== (j = null == G ? void 0 : G[r]) && void 0 !== j ? j : 0;
                        N = G ? -V + R : k;
                      } else N = k;
                    else N = $ ? -C + R : k;
                  else N = -C + R;
                } else if ("center" === A) {
                  var H = (y - M) / 2 - C - x;
                  N = Math.min(Math.max(H, _), R);
                } else if (O)
                  if ("auto" === A)
                    if (m.scrollIndex && m.scrollIndex > 0) {
                      var K = m.children.length - m.scrollIndex;
                      T && m.selected >= m.scrollIndex
                        ? (N = k - L - w)
                        : !T && m.selected < K && (N = k + L + w);
                    } else N = T ? k - L - w : k + L + w;
                  else T && da(O) ? (N = k - L - w) : da(O) && (N = -C + R);
                else N = T ? _ : R;
                if (
                  ((N = T && "always" !== A && "bounded" !== A ? Math.max(N, _) : Math.min(N, R)), m[r] !== N)
                ) {
                  if (m.onScrolled) {
                    var W = N === m._initialPosition;
                    m.onScrolled(m, N, W);
                  }
                  ((m[r] = N), (m._targetPosition = N));
                }
              }
            }
          };
        }
        var ca = ha(!0),
          fa = ha(!1);
        function pa(...e) {
          var t = e.filter(e => "function" == typeof e);
          if (0 !== t.length)
            return 1 === t.length
              ? t[0]
              : function (...e) {
                  var r,
                    i,
                    n = l(t);
                  try {
                    for (n.s(); !(i = n.n()).done; ) {
                      if (!0 === (r = i.value.apply(this, e))) return r;
                    }
                  } catch (a) {
                    n.e(a);
                  } finally {
                    n.f();
                  }
                  return r;
                };
        }
        var ga = {
          display: "flex",
          flexDirection: "column",
          gap: 30,
          transition: { y: { duration: 250, easing: "ease-in-out" } },
        };
        function ma(e) {
          var t;
          ((this.selected = e), fa(e, this), null === (t = this.children[e]) || void 0 === t || t.setFocus());
        }
        var va = ua("up"),
          ya = ua("down"),
          Ta = e => {
            return (
              (t = Hi("view")),
              Ki(
                t,
                zi(e, {
                  onUp: pa(e.onUp, va),
                  onDown: pa(e.onDown, ya),
                  get selected() {
                    return e.selected || 0;
                  },
                  scrollToIndex: ma,
                  forwardFocus: la,
                  onLayout: e.selected ? pa(e.onLayout, fa) : e.onLayout,
                  onSelectedChanged: pa(e.onSelectedChanged, "none" !== e.scroll ? fa : void 0),
                  style: Mi(e.style, ga),
                }),
                !1,
              ),
              t
            );
            var t;
          },
          ba = { display: "flex", gap: 30, transition: { x: { duration: 250, easing: "ease-in-out" } } };
        function Sa(e) {
          var t;
          ((this.selected = e), ca(e, this), null === (t = this.children[e]) || void 0 === t || t.setFocus());
        }
        var Ea = ua("left"),
          xa = ua("right"),
          wa = e => {
            return (
              (t = Hi("view")),
              Ki(
                t,
                zi(e, {
                  get selected() {
                    return e.selected || 0;
                  },
                  onLeft: pa(e.onLeft, Ea),
                  onRight: pa(e.onRight, xa),
                  forwardFocus: la,
                  scrollToIndex: Sa,
                  onLayout: e.selected ? pa(e.onLayout, ca) : e.onLayout,
                  onSelectedChanged: pa(e.onSelectedChanged, "none" !== e.scroll ? ca : void 0),
                  style: Mi(e.style, ba),
                }),
                !1,
              ),
              t
            );
            var t;
          },
          Aa = ei(void 0);
        function Ia(e) {
          var t = r(Gr([]), 2),
            i = (t[0], t[1]);
          return Vi(Aa.Provider, {
            value: {
              storeFocus: function (e, t) {
                var r = t || e;
                r && i(e => [...e, r]);
              },
              restoreFocus: function () {
                var e = !1;
                return (
                  i(t => {
                    var r = t.pop();
                    return (r && "function" == typeof r.setFocus && (r.setFocus(), (e = !0)), [...t]);
                  }),
                  e
                );
              },
              clearFocusStack: function () {
                i([]);
              },
            },
            get children() {
              return e.children;
            },
          });
        }
        var ka = new Map(),
          Ra = e =>
            ka.has(e.id)
              ? (console.warn(`[KeepAlive] Element with id "${e.id}" already in cache. Recreating.`), e)
              : (ka.set(e.id, e), e),
          Ca = e => {
            var t = ka.get(e);
            t && (t.dispose(), ka.delete(e));
          };
        function La(e) {
          var t,
            r =
              e.onRemove ||
              (e => {
                e.alpha = 0;
              }),
            i =
              e.onRender ||
              (e => {
                e.alpha = 1;
              }),
            n = e.transition || { alpha: !0 };
          return (
            (t = Hi("view")),
            Wi(t, "preserve", !0),
            Wi(t, "onRemove", r),
            Wi(t, "onRender", i),
            Wi(t, "forwardFocus", 0),
            Wi(t, "transition", n),
            Ki(t, e, !1),
            t
          );
        }
        var Ma = e => {
            var t,
              r = ka.get(e.id);
            return (
              r &&
                null !== (t = e.shouldDispose) &&
                void 0 !== t &&
                t.call(e, e.id) &&
                (r.dispose(), ka.delete(e.id), (r = void 0)),
              r
                ? (r && !r.children && (r.children = Jr(r.owner, () => La(e))), r.children)
                : jr(t => {
                    var r = La(e);
                    return (Ra({ id: e.id, owner: Qr(), children: r, dispose: t }), r);
                  })
            );
          },
          Da = e => {
            var t = e.id || e.path,
              r = e.preload
                ? r => {
                    var i,
                      n,
                      a = ka.get(t);
                    if (
                      (a &&
                        null !== (i = e.shouldDispose) &&
                        void 0 !== i &&
                        i.call(e, t) &&
                        (a.dispose(), ka.delete(t), (a = void 0)),
                      !a)
                    )
                      return jr(i => (Ra({ id: t, owner: Qr(), dispose: i, children: null }), e.preload(r)));
                    a.children && (null === (n = a.children) || void 0 === n || n.setFocus());
                  }
                : void 0;
            return Vi(
              Rn,
              zi(e, {
                preload: r,
                component: r =>
                  Vi(Ma, {
                    id: t,
                    get onRemove() {
                      return e.onRemove;
                    },
                    get onRender() {
                      return e.onRender;
                    },
                    get transition() {
                      return e.transition;
                    },
                    get children() {
                      return e.component(r);
                    },
                  }),
              }),
            );
          },
          _a = r(Gr(""), 2),
          Pa = _a[0],
          Oa = _a[1],
          Na = r(Gr(""), 2),
          Fa = Na[0],
          Ua = Na[1],
          Ba = r(Gr(""), 2),
          $a = Ba[0],
          ja = Ba[1],
          Ga = r(Gr(1920), 2),
          Va = Ga[0],
          Ha = Ga[1],
          Ka = r(Gr(1080), 2),
          Wa = Ka[0],
          za = Ka[1],
          qa = r(Gr(!1), 2),
          Xa = qa[0],
          Ya = qa[1],
          Qa = r(Gr(null), 2),
          Ja = Qa[0],
          Za = Qa[1],
          es = r(Gr(null), 2),
          ts = es[0],
          rs = es[1],
          is = r(Gr(0), 2),
          ns = is[0],
          as = is[1],
          ss = r(Gr(!1), 2),
          os = ss[0],
          ls = ss[1],
          us = () => {
            var e,
              t,
              r = 0,
              i = null,
              n = { duration: 600, easing: "ease-in-out" },
              a = null,
              s = null;
            return (
              Hr(() => {
                if (!os()) {
                  var o = Pa();
                  if (o && o !== i) {
                    i = o;
                    var l = 1 === r ? t : e,
                      u = 1 === r ? e : t;
                    ((u.src = o),
                      (u.alpha = 0.01),
                      a && a.stop(),
                      s && s.stop(),
                      (s = u.animate({ alpha: 1 }, n)).start(),
                      (a = l.animate({ alpha: 0 }, n)).start(),
                      (r = 1 === r ? 2 : 1));
                  }
                }
              }),
              Yr(() => {
                (a.stop(), s.stop());
              }),
              Vi(Ji, {
                get width() {
                  return Va();
                },
                get height() {
                  return Wa();
                },
                get children() {
                  return [
                    Vi(Ji, {
                      ref(t) {
                        "function" == typeof e ? e(t) : (e = t);
                      },
                      get width() {
                        return Va();
                      },
                      get height() {
                        return Wa();
                      },
                      alpha: 0,
                    }),
                    Vi(Ji, {
                      ref(e) {
                        "function" == typeof t ? t(e) : (t = e);
                      },
                      get width() {
                        return Va();
                      },
                      get height() {
                        return Wa();
                      },
                      alpha: 0,
                    }),
                  ];
                },
              })
            );
          },
          ds = e => {
            var t,
              r = vn(),
              i = mn().location,
              n = (Zn || ((Zn = !0), Jn.setupTimers(t), Hr(qr(Mn, Jn.onFocusChange, { defer: !0 }))), Jn);
            return (
              (n.debug = !1),
              (n.enabled = !1),
              Hr(() => {
                (Za(ts()), rs(i.pathname));
              }),
              Vi(Ji, {
                ref(e) {
                  var t = window.APP;
                  "function" == typeof t ? t(e) : (window.APP = e);
                },
                onAnnouncer: () => (n.enabled = !n.enabled),
                onLast: () => history.back(),
                onBack: () => (r(-1), !0),
                get children() {
                  return [Vi(us, {}), Gi(() => e.children)];
                },
              })
            );
          },
          hs = "static/",
          cs = [
            {
              type: "msdf",
              fontFamily: "Inter",
              descriptors: { weight: 400 },
              atlasDataUrl: hs + "fonts/Inter_18pt-Regular.msdf.json",
              atlasUrl: hs + "fonts/Inter_18pt-Regular.msdf.png",
            },
            {
              type: "msdf",
              fontFamily: "Inter",
              descriptors: { weight: 600 },
              atlasDataUrl: hs + "fonts/Inter_18pt-SemiBold.msdf.json",
              atlasUrl: hs + "fonts/Inter_18pt-SemiBold.msdf.png",
            },
            {
              type: "msdf",
              fontFamily: "Inter",
              descriptors: { weight: 700 },
              atlasDataUrl: hs + "fonts/Inter_18pt-Bold.msdf.json",
              atlasUrl: hs + "fonts/Inter_18pt-Bold.msdf.png",
            },
            {
              type: "msdf",
              fontFamily: "Roboto",
              descriptors: { weight: 700 },
              atlasDataUrl: hs + "fonts/Roboto-Bold.msdf.json",
              atlasUrl: hs + "fonts/Roboto-Bold.msdf.png",
            },
            {
              type: "msdf",
              fontFamily: "Roboto",
              descriptors: { weight: 400 },
              atlasDataUrl: hs + "fonts/Roboto-Regular.msdf.json",
              atlasUrl: hs + "fonts/Roboto-Regular.msdf.png",
            },
            {
              type: "msdf",
              fontFamily: "Arial",
              descriptors: { weight: 500 },
              atlasDataUrl: hs + "fonts/Roboto-Regular.msdf.json",
              atlasUrl: hs + "fonts/Roboto-Regular.msdf.png",
            },
          ],
          fs = "object" == typeof global && global && global.Object === Object && global,
          ps = "object" == typeof self && self && self.Object === Object && self,
          gs = fs || ps || Function("return this")(),
          ms = gs.Symbol,
          vs = Object.prototype,
          ys = vs.hasOwnProperty,
          Ts = vs.toString,
          bs = ms ? ms.toStringTag : void 0;
        var Ss = Object.prototype.toString;
        var Es = ms ? ms.toStringTag : void 0;
        function xs(e) {
          return null == e
            ? void 0 === e
              ? "[object Undefined]"
              : "[object Null]"
            : Es && Es in Object(e)
              ? (function (e) {
                  var t = ys.call(e, bs),
                    r = e[bs];
                  try {
                    e[bs] = void 0;
                    var i = !0;
                  } catch (a) {}
                  var n = Ts.call(e);
                  return (i && (t ? (e[bs] = r) : delete e[bs]), n);
                })(e)
              : (function (e) {
                  return Ss.call(e);
                })(e);
        }
        function ws(e) {
          return null != e && "object" == typeof e;
        }
        var As = Array.isArray;
        function Is(e) {
          var t = typeof e;
          return null != e && ("object" == t || "function" == t);
        }
        function ks(e) {
          return e;
        }
        function Rs(e) {
          if (!Is(e)) return !1;
          var t = xs(e);
          return (
            "[object Function]" == t ||
            "[object GeneratorFunction]" == t ||
            "[object AsyncFunction]" == t ||
            "[object Proxy]" == t
          );
        }
        var Cs,
          Ls = gs["__core-js_shared__"],
          Ms = (Cs = /[^.]+$/.exec((Ls && Ls.keys && Ls.keys.IE_PROTO) || "")) ? "Symbol(src)_1." + Cs : "";
        var Ds = Function.prototype.toString;
        var _s = /^\[object .+?Constructor\]$/,
          Ps = Function.prototype,
          Os = Object.prototype,
          Ns = Ps.toString,
          Fs = Os.hasOwnProperty,
          Us = RegExp(
            "^" +
              Ns.call(Fs)
                .replace(/[\\^$.*+?()[\]{}|]/g, "\\$&")
                .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") +
              "$",
          );
        function Bs(e) {
          return (
            !(!Is(e) || ((t = e), Ms && Ms in t)) &&
            (Rs(e) ? Us : _s).test(
              (function (e) {
                if (null != e) {
                  try {
                    return Ds.call(e);
                  } catch (t) {}
                  try {
                    return e + "";
                  } catch (t) {}
                }
                return "";
              })(e),
            )
          );
          var t;
        }
        function $s(e, t) {
          var r = (function (e, t) {
            return null == e ? void 0 : e[t];
          })(e, t);
          return Bs(r) ? r : void 0;
        }
        var js = Object.create,
          Gs = (function () {
            function e() {}
            return function (t) {
              if (!Is(t)) return {};
              if (js) return js(t);
              e.prototype = t;
              var r = new e();
              return ((e.prototype = void 0), r);
            };
          })();
        var Vs = Date.now;
        var Hs,
          Ks,
          Ws,
          zs = (function () {
            try {
              var e = $s(Object, "defineProperty");
              return (e({}, "", {}), e);
            } catch (t) {}
          })(),
          qs = zs
            ? function (e, t) {
                return zs(e, "toString", {
                  configurable: !0,
                  enumerable: !1,
                  value:
                    ((r = t),
                    function () {
                      return r;
                    }),
                  writable: !0,
                });
                var r;
              }
            : ks,
          Xs =
            ((Hs = qs),
            (Ks = 0),
            (Ws = 0),
            function () {
              var e = Vs(),
                t = 16 - (e - Ws);
              if (((Ws = e), t > 0)) {
                if (++Ks >= 800) return arguments[0];
              } else Ks = 0;
              return Hs.apply(void 0, arguments);
            }),
          Ys = /^(?:0|[1-9]\d*)$/;
        function Qs(e, t) {
          var r = typeof e;
          return (
            !!(t = null == t ? 9007199254740991 : t) &&
            ("number" == r || ("symbol" != r && Ys.test(e))) &&
            e > -1 &&
            e % 1 == 0 &&
            e < t
          );
        }
        function Js(e, t, r) {
          "__proto__" == t && zs
            ? zs(e, t, { configurable: !0, enumerable: !0, value: r, writable: !0 })
            : (e[t] = r);
        }
        function Zs(e, t) {
          return e === t || (e != e && t != t);
        }
        var eo = Object.prototype.hasOwnProperty;
        function to(e, t, r) {
          var i = e[t];
          (eo.call(e, t) && Zs(i, r) && (void 0 !== r || t in e)) || Js(e, t, r);
        }
        var ro = Math.max;
        function io(e, t) {
          return Xs(
            (function (e, t, r) {
              return (
                (t = ro(void 0 === t ? e.length - 1 : t, 0)),
                function () {
                  for (var i = arguments, n = -1, a = ro(i.length - t, 0), s = Array(a); ++n < a; )
                    s[n] = i[t + n];
                  n = -1;
                  for (var o = Array(t + 1); ++n < t; ) o[n] = i[n];
                  return (
                    (o[t] = r(s)),
                    (function (e, t, r) {
                      switch (r.length) {
                        case 0:
                          return e.call(t);
                        case 1:
                          return e.call(t, r[0]);
                        case 2:
                          return e.call(t, r[0], r[1]);
                        case 3:
                          return e.call(t, r[0], r[1], r[2]);
                      }
                      return e.apply(t, r);
                    })(e, this, o)
                  );
                }
              );
            })(e, t, ks),
            e + "",
          );
        }
        function no(e) {
          return "number" == typeof e && e > -1 && e % 1 == 0 && e <= 9007199254740991;
        }
        function ao(e) {
          return null != e && no(e.length) && !Rs(e);
        }
        var so = Object.prototype;
        function oo(e) {
          var t = e && e.constructor;
          return e === (("function" == typeof t && t.prototype) || so);
        }
        function lo(e) {
          return ws(e) && "[object Arguments]" == xs(e);
        }
        var uo = Object.prototype,
          ho = uo.hasOwnProperty,
          co = uo.propertyIsEnumerable,
          fo = lo(
            (function () {
              return arguments;
            })(),
          )
            ? lo
            : function (e) {
                return ws(e) && ho.call(e, "callee") && !co.call(e, "callee");
              };
        var po = "object" == typeof e && e && !e.nodeType && e,
          go = po && "object" == typeof n && n && !n.nodeType && n,
          mo = go && go.exports === po ? gs.Buffer : void 0,
          vo =
            (mo ? mo.isBuffer : void 0) ||
            function () {
              return !1;
            },
          yo = {};
        ((yo["[object Float32Array]"] =
          yo["[object Float64Array]"] =
          yo["[object Int8Array]"] =
          yo["[object Int16Array]"] =
          yo["[object Int32Array]"] =
          yo["[object Uint8Array]"] =
          yo["[object Uint8ClampedArray]"] =
          yo["[object Uint16Array]"] =
          yo["[object Uint32Array]"] =
            !0),
          (yo["[object Arguments]"] =
            yo["[object Array]"] =
            yo["[object ArrayBuffer]"] =
            yo["[object Boolean]"] =
            yo["[object DataView]"] =
            yo["[object Date]"] =
            yo["[object Error]"] =
            yo["[object Function]"] =
            yo["[object Map]"] =
            yo["[object Number]"] =
            yo["[object Object]"] =
            yo["[object RegExp]"] =
            yo["[object Set]"] =
            yo["[object String]"] =
            yo["[object WeakMap]"] =
              !1));
        var To = "object" == typeof e && e && !e.nodeType && e,
          bo = To && "object" == typeof n && n && !n.nodeType && n,
          So = bo && bo.exports === To && fs.process,
          Eo = (function () {
            try {
              var e = bo && bo.require && bo.require("util").types;
              return e || (So && So.binding && So.binding("util"));
            } catch (t) {}
          })(),
          xo = Eo && Eo.isTypedArray,
          wo = xo
            ? (function (e) {
                return function (t) {
                  return e(t);
                };
              })(xo)
            : function (e) {
                return ws(e) && no(e.length) && !!yo[xs(e)];
              };
        function Ao(e, t) {
          var r = As(e),
            i = !r && fo(e),
            n = !r && !i && vo(e),
            a = !r && !i && !n && wo(e),
            s = r || i || n || a,
            o = s
              ? (function (e, t) {
                  for (var r = -1, i = Array(e); ++r < e; ) i[r] = t(r);
                  return i;
                })(e.length, String)
              : [],
            l = o.length;
          for (var u in e)
            (s &&
              ("length" == u ||
                (n && ("offset" == u || "parent" == u)) ||
                (a && ("buffer" == u || "byteLength" == u || "byteOffset" == u)) ||
                Qs(u, l))) ||
              o.push(u);
          return o;
        }
        var Io = Object.prototype.hasOwnProperty;
        function ko(e) {
          if (!Is(e))
            return (function (e) {
              var t = [];
              if (null != e) for (var r in Object(e)) t.push(r);
              return t;
            })(e);
          var t = oo(e),
            r = [];
          for (var i in e) ("constructor" != i || (!t && Io.call(e, i))) && r.push(i);
          return r;
        }
        function Ro(e) {
          return ao(e) ? Ao(e) : ko(e);
        }
        var Co = $s(Object, "create");
        var Lo = Object.prototype.hasOwnProperty;
        var Mo = Object.prototype.hasOwnProperty;
        function Do(e) {
          var t = -1,
            r = null == e ? 0 : e.length;
          for (this.clear(); ++t < r; ) {
            var i = e[t];
            this.set(i[0], i[1]);
          }
        }
        function _o(e, t) {
          for (var r = e.length; r--; ) if (Zs(e[r][0], t)) return r;
          return -1;
        }
        ((Do.prototype.clear = function () {
          ((this.__data__ = Co ? Co(null) : {}), (this.size = 0));
        }),
          (Do.prototype.delete = function (e) {
            var t = this.has(e) && delete this.__data__[e];
            return ((this.size -= t ? 1 : 0), t);
          }),
          (Do.prototype.get = function (e) {
            var t = this.__data__;
            if (Co) {
              var r = t[e];
              return "__lodash_hash_undefined__" === r ? void 0 : r;
            }
            return Lo.call(t, e) ? t[e] : void 0;
          }),
          (Do.prototype.has = function (e) {
            var t = this.__data__;
            return Co ? void 0 !== t[e] : Mo.call(t, e);
          }),
          (Do.prototype.set = function (e, t) {
            var r = this.__data__;
            return (
              (this.size += this.has(e) ? 0 : 1),
              (r[e] = Co && void 0 === t ? "__lodash_hash_undefined__" : t),
              this
            );
          }));
        var Po = Array.prototype.splice;
        function Oo(e) {
          var t = -1,
            r = null == e ? 0 : e.length;
          for (this.clear(); ++t < r; ) {
            var i = e[t];
            this.set(i[0], i[1]);
          }
        }
        ((Oo.prototype.clear = function () {
          ((this.__data__ = []), (this.size = 0));
        }),
          (Oo.prototype.delete = function (e) {
            var t = this.__data__,
              r = _o(t, e);
            return !(r < 0) && (r == t.length - 1 ? t.pop() : Po.call(t, r, 1), --this.size, !0);
          }),
          (Oo.prototype.get = function (e) {
            var t = this.__data__,
              r = _o(t, e);
            return r < 0 ? void 0 : t[r][1];
          }),
          (Oo.prototype.has = function (e) {
            return _o(this.__data__, e) > -1;
          }),
          (Oo.prototype.set = function (e, t) {
            var r = this.__data__,
              i = _o(r, e);
            return (i < 0 ? (++this.size, r.push([e, t])) : (r[i][1] = t), this);
          }));
        var No = $s(gs, "Map");
        function Fo(e, t) {
          var r,
            i,
            n = e.__data__;
          return (
            "string" == (i = typeof (r = t)) || "number" == i || "symbol" == i || "boolean" == i
              ? "__proto__" !== r
              : null === r
          )
            ? n["string" == typeof t ? "string" : "hash"]
            : n.map;
        }
        function Uo(e) {
          var t = -1,
            r = null == e ? 0 : e.length;
          for (this.clear(); ++t < r; ) {
            var i = e[t];
            this.set(i[0], i[1]);
          }
        }
        ((Uo.prototype.clear = function () {
          ((this.size = 0), (this.__data__ = { hash: new Do(), map: new (No || Oo)(), string: new Do() }));
        }),
          (Uo.prototype.delete = function (e) {
            var t = Fo(this, e).delete(e);
            return ((this.size -= t ? 1 : 0), t);
          }),
          (Uo.prototype.get = function (e) {
            return Fo(this, e).get(e);
          }),
          (Uo.prototype.has = function (e) {
            return Fo(this, e).has(e);
          }),
          (Uo.prototype.set = function (e, t) {
            var r = Fo(this, e),
              i = r.size;
            return (r.set(e, t), (this.size += r.size == i ? 0 : 1), this);
          }));
        var Bo = (function (e, t) {
            return function (r) {
              return e(t(r));
            };
          })(Object.getPrototypeOf, Object),
          $o = Function.prototype,
          jo = Object.prototype,
          Go = $o.toString,
          Vo = jo.hasOwnProperty,
          Ho = Go.call(Object);
        function Ko(e) {
          var t = (this.__data__ = new Oo(e));
          this.size = t.size;
        }
        ((Ko.prototype.clear = function () {
          ((this.__data__ = new Oo()), (this.size = 0));
        }),
          (Ko.prototype.delete = function (e) {
            var t = this.__data__,
              r = t.delete(e);
            return ((this.size = t.size), r);
          }),
          (Ko.prototype.get = function (e) {
            return this.__data__.get(e);
          }),
          (Ko.prototype.has = function (e) {
            return this.__data__.has(e);
          }),
          (Ko.prototype.set = function (e, t) {
            var r = this.__data__;
            if (r instanceof Oo) {
              var i = r.__data__;
              if (!No || i.length < 199) return (i.push([e, t]), (this.size = ++r.size), this);
              r = this.__data__ = new Uo(i);
            }
            return (r.set(e, t), (this.size = r.size), this);
          }));
        var Wo = "object" == typeof e && e && !e.nodeType && e,
          zo = Wo && "object" == typeof n && n && !n.nodeType && n,
          qo = zo && zo.exports === Wo ? gs.Buffer : void 0;
        qo && qo.allocUnsafe;
        var Xo = gs.Uint8Array;
        function Yo(e, t) {
          var r,
            i,
            n = ((r = e.buffer), (i = new r.constructor(r.byteLength)), new Xo(i).set(new Xo(r)), i);
          return new e.constructor(n, e.byteOffset, e.length);
        }
        var Qo = function (e, t, r) {
          for (var i = -1, n = Object(e), a = r(e), s = a.length; s--; ) {
            var o = a[++i];
            if (!1 === t(n[o], o, n)) break;
          }
          return e;
        };
        function Jo(e, t, r) {
          ((void 0 !== r && !Zs(e[t], r)) || (void 0 === r && !(t in e))) && Js(e, t, r);
        }
        function Zo(e, t) {
          if (("constructor" !== t || "function" != typeof e[t]) && "__proto__" != t) return e[t];
        }
        function el(e) {
          return (function (e, t, r) {
            var i = !r;
            r || (r = {});
            for (var n = -1, a = t.length; ++n < a; ) {
              var s = t[n],
                o = void 0;
              (void 0 === o && (o = e[s]), i ? Js(r, s, o) : to(r, s, o));
            }
            return r;
          })(e, Ro(e));
        }
        function tl(e, t, r, i, n, a, s) {
          var o = Zo(e, r),
            l = Zo(t, r),
            u = s.get(l);
          if (u) Jo(e, r, u);
          else {
            var d,
              h = a ? a(o, l, r + "", e, t, s) : void 0,
              c = void 0 === h;
            if (c) {
              var f = As(l),
                p = !f && vo(l),
                g = !f && !p && wo(l);
              ((h = l),
                f || p || g
                  ? As(o)
                    ? (h = o)
                    : ws((d = o)) && ao(d)
                      ? (h = (function (e, t) {
                          var r = -1,
                            i = e.length;
                          for (t || (t = Array(i)); ++r < i; ) t[r] = e[r];
                          return t;
                        })(o))
                      : p
                        ? ((c = !1), (h = l.slice()))
                        : g
                          ? ((c = !1), (h = Yo(l)))
                          : (h = [])
                  : (function (e) {
                        if (!ws(e) || "[object Object]" != xs(e)) return !1;
                        var t = Bo(e);
                        if (null === t) return !0;
                        var r = Vo.call(t, "constructor") && t.constructor;
                        return "function" == typeof r && r instanceof r && Go.call(r) == Ho;
                      })(l) || fo(l)
                    ? ((h = o),
                      fo(o)
                        ? (h = el(o))
                        : (Is(o) && !Rs(o)) ||
                          (h = (function (e) {
                            return "function" != typeof e.constructor || oo(e) ? {} : Gs(Bo(e));
                          })(l)))
                    : (c = !1));
            }
            (c && (s.set(l, h), n(h, l, i, a, s), s.delete(l)), Jo(e, r, h));
          }
        }
        function rl(e, t, r, i, n) {
          e !== t &&
            Qo(
              t,
              function (a, s) {
                if ((n || (n = new Ko()), Is(a))) tl(e, t, s, r, rl, i, n);
                else {
                  var o = i ? i(Zo(e, s), a, s + "", e, t, n) : void 0;
                  (void 0 === o && (o = a), Jo(e, s, o));
                }
              },
              Ro,
            );
        }
        var il,
          nl =
            ((il = function (e, t, r) {
              rl(e, t, r);
            }),
            io(function (e, t) {
              var r = -1,
                i = t.length,
                n = i > 1 ? t[i - 1] : void 0,
                a = i > 2 ? t[2] : void 0;
              for (
                n = il.length > 3 && "function" == typeof n ? (i--, n) : void 0,
                  a &&
                    (function (e, t, r) {
                      if (!Is(r)) return !1;
                      var i = typeof t;
                      return (
                        !!("number" == i ? ao(r) && Qs(t, r.length) : "string" == i && (t in r)) &&
                        Zs(r[t], e)
                      );
                    })(t[0], t[1], a) &&
                    ((n = i < 3 ? void 0 : n), (i = 1)),
                  e = Object(e);
                ++r < i;
              ) {
                var s = t[r];
                s && il(e, s, r, n);
              }
              return e;
            }));
        class al {
          constructor(e, t = 0) {
            (o(this, "iterator", void 0),
              o(this, "peekBuffer", []),
              o(this, "_lastIndex", void 0),
              (this.iterator = e),
              (this.iterator = e),
              (this._lastIndex = t - 1),
              (this.peekBuffer = []));
          }
          next() {
            var e = this.peekBuffer.length > 0 ? this.peekBuffer.pop() : this.iterator.next();
            return (e.done ? (this._lastIndex = -1) : this._lastIndex++, e);
          }
          peek() {
            if (this.peekBuffer.length > 0) return this.peekBuffer[0];
            var e = this.iterator.next();
            return (this.peekBuffer.push(e), e);
          }
          get lastIndex() {
            return this._lastIndex;
          }
        }
        function sl(e, t = 0) {
          var r, n;
          return i().w(function (i) {
            for (;;)
              switch (i.n) {
                case 0:
                  r = t;
                case 1:
                  if (!(r < e.length)) {
                    i.n = 4;
                    break;
                  }
                  if (void 0 !== (n = e.codePointAt(r))) {
                    i.n = 2;
                    break;
                  }
                  throw new Error("Invalid Unicode code point");
                case 2:
                  return ((i.n = 3), n);
                case 3:
                  ((r += n <= 65535 ? 1 : 2), (i.n = 1));
                  break;
                case 4:
                  return i.a(2);
              }
          }, a);
        }
        function ol(e, t, r, i, n, a, s, o, u, d, h, c, f, p, g, m, v, y, T) {
          (g.loaded, g.data, g.shaper);
          var b = o / g.data.info.size,
            S = u / b,
            E = a / b,
            x = d / b,
            w = f[e],
            A = (null == w ? void 0 : w.codepointIndex) || 0,
            I = (null == w ? void 0 : w.maxX) || 0,
            k = (null == w ? void 0 : w.maxY) || 0,
            R = t,
            C = r,
            L = 0,
            M = { codepointIndex: -1, bufferOffset: -1, xStart: -1 },
            D = g.shaper,
            _ = { letterSpacing: x };
          i.endsWith(" ") && (i += " ");
          for (
            var P,
              O = D.shapeText(_, new al(sl(i, A), A)),
              N = -1,
              F = [],
              U = s / b,
              B = (function (e, t, r) {
                var i,
                  n = 0,
                  a = l(r.shapeText(t, new al(sl(e, 0), 0)));
                try {
                  for (a.s(); !(i = a.n()).done; ) {
                    var s = i.value;
                    s.mapped && 8203 !== s.codepoint && (n += s.xAdvance);
                  }
                } catch (o) {
                  a.e(o);
                } finally {
                  a.f();
                }
                return n;
              })(y, _, D),
              $ = !0;
            $;
          ) {
            for (
              var j = (0 === T || e + 1 < T) && ("both" !== c || v || C + S + g.maxCharHeight <= U),
                G = j ? E : E - B,
                V = 0,
                H = C + g.maxCharHeight >= p.y1,
                K = C <= p.y2,
                W = H && K;
              (P = O.next()) && !P.done;
            ) {
              var z = P.value;
              if (e === f.length) f.push({ codepointIndex: z.cluster, maxY: k, maxX: I });
              else if (e > f.length) throw new Error("Unexpected lineCache length");
              if (
                (32 === z.codepoint || 10 === z.codepoint || 8203 === z.codepoint
                  ? -1 !== M.codepointIndex && ((M.codepointIndex = -1), (V = R))
                  : -1 === M.codepointIndex &&
                    ((M.codepointIndex = z.cluster), (M.bufferOffset = L), (M.xStart = V)),
                z.mapped)
              ) {
                var q = R + z.xOffset + z.width;
                if ("none" !== c && q >= G && -1 !== M.codepointIndex && M.xStart > 0) {
                  if (j) {
                    ((O = D.shapeText(_, new al(sl(i, M.codepointIndex), M.codepointIndex))),
                      (L = M.bufferOffset));
                    break;
                  }
                  ((O = D.shapeText(_, new al(sl(y, 0), 0))),
                    (R = M.xStart),
                    (L = M.bufferOffset),
                    (c = "none"));
                } else {
                  var X = R + z.xOffset,
                    Y = C + z.yOffset;
                  if (W) {
                    -1 === N && (N = L);
                    var Q = g.getAtlasEntry(z.glyphId),
                      J = Q.x / g.data.common.scaleW,
                      Z = Q.y / g.data.common.scaleH,
                      ee = Q.width / g.data.common.scaleW,
                      te = Q.height / g.data.common.scaleH;
                    ((h[L++] = X),
                      (h[L++] = Y),
                      (h[L++] = J),
                      (h[L++] = Z),
                      (h[L++] = X + z.width),
                      (h[L++] = Y),
                      (h[L++] = J + ee),
                      (h[L++] = Z),
                      (h[L++] = X),
                      (h[L++] = Y + z.height),
                      (h[L++] = J),
                      (h[L++] = Z + te),
                      (h[L++] = X + z.width),
                      (h[L++] = Y + z.height),
                      (h[L++] = J + ee),
                      (h[L++] = Z + te));
                  }
                  ((k = Math.max(k, Y + z.height)), (I = Math.max(I, X + z.width)), (R += z.xAdvance));
                }
              } else if (10 === z.codepoint) {
                if (j) break;
                ((O = D.shapeText(_, new al(sl(y, 0), 0))), (c = "none"));
              }
            }
            (-1 !== N && (F.push({ bufferStart: N, bufferEnd: L }), (N = -1)),
              (R = 0),
              (C += S),
              e++,
              (M.codepointIndex = -1),
              (V = 0),
              (!m && "both" === c && C > p.y2) || (P && P.done) ? ($ = !1) : j || ($ = !1));
          }
          if ("center" === n)
            for (var re = "none" === c ? I : E, ie = 0; ie < F.length; ie++)
              for (
                var ne = F[ie],
                  ae = (re - (h[ne.bufferEnd - 4] - h[ne.bufferStart])) / 2,
                  se = ne.bufferStart;
                se < ne.bufferEnd;
                se += 4
              )
                h[se] += ae;
          else if ("right" === n)
            for (var oe = "none" === c ? I : E, le = 0; le < F.length; le++)
              for (
                var ue = F[le],
                  de = oe - (ue.bufferEnd === ue.bufferStart ? 0 : h[ue.bufferEnd - 4] - h[ue.bufferStart]),
                  he = ue.bufferStart;
                he < ue.bufferEnd;
                he += 4
              )
                h[he] += de;
          return {
            bufferNumFloats: L,
            bufferNumQuads: L / 16,
            layoutNumCharacters: P.done ? i.length - A : P.value.cluster - A + 1,
            fullyProcessed: !!P.done,
            maxX: I,
            maxY: k,
            numLines: f.length,
          };
        }
        function ll(e, t, r, i, n, a, s, o) {
          var l,
            u,
            d,
            h = e.screen,
            c = e.sdf;
          if ((d = s).x1 < d.x2 && d.y1 < d.y2) {
            var f = s.x1 - t,
              p = f + (s.x2 - s.x1),
              g = s.y1 - r + i,
              m = ((l = g - a), (u = n || 1), Math.floor(l / u) * u),
              v = (function (e, t) {
                return Math.ceil(e / t) * t;
              })(g + (s.y2 - s.y1) + a, n || 1);
            ((h.x1 = f),
              (h.y1 = m),
              (h.x2 = p),
              (h.y2 = v),
              (c.x1 = f / o),
              (c.y1 = m / o),
              (c.x2 = p / o),
              (c.y2 = v / o),
              (e.numLines = Math.ceil((v - m) / n)),
              (e.firstLineIdx = n ? Math.floor(m / n) : 0));
          } else
            ((h.x1 = 0),
              (h.y1 = 0),
              (h.x2 = 0),
              (h.y2 = 0),
              (c.x1 = 0),
              (c.y1 = 0),
              (c.x2 = 0),
              (c.y2 = 0),
              (e.numLines = 0),
              (e.firstLineIdx = 0));
          e.valid = !0;
        }
        var ul = { x: 0, y: 0, width: 0, height: 0 };
        var dl,
          hl,
          cl =
            "undefined" != typeof globalThis
              ? globalThis
              : "undefined" != typeof window
                ? window
                : "undefined" != typeof global
                  ? global
                  : "undefined" != typeof self
                    ? self
                    : {},
          fl = {};
        dl ||
          ((dl = 1),
          (hl = fl),
          (function () {
            var e = "undefined" != typeof window ? window : cl,
              t = {};
            for (var r in (function (e, t, i) {
              var n,
                a,
                s =
                  "function" == typeof Object.create
                    ? Object.create
                    : function (e) {
                        function t() {}
                        return ((t.prototype = e), new t());
                      },
                o =
                  "function" == typeof Object.defineProperties
                    ? Object.defineProperty
                    : function (e, t, r) {
                        return (e == Array.prototype || e == Object.prototype || (e[t] = r.value), e);
                      },
                l = (function (r) {
                  r = [
                    "object" == typeof globalThis && globalThis,
                    r,
                    "object" == typeof e && e,
                    "object" == typeof self && self,
                    "object" == typeof t && t,
                  ];
                  for (var i = 0; i < r.length; ++i) {
                    var n = r[i];
                    if (n && n.Math == Math) return n;
                  }
                  throw Error("Cannot find global object");
                })(this);
              function u(e, t) {
                if (t)
                  e: {
                    var r = l;
                    e = e.split(".");
                    for (var i = 0; i < e.length - 1; i++) {
                      var n = e[i];
                      if (!(n in r)) break e;
                      r = r[n];
                    }
                    (t = t((i = r[(e = e[e.length - 1])]))) != i &&
                      null != t &&
                      o(r, e, { configurable: !0, writable: !0, value: t });
                  }
              }
              if ("function" == typeof Object.setPrototypeOf) a = Object.setPrototypeOf;
              else {
                var d;
                e: {
                  var h = {};
                  try {
                    ((h.__proto__ = { a: !0 }), (d = h.a));
                    break e;
                  } catch (pw) {}
                  d = !1;
                }
                a = d
                  ? function (e, t) {
                      if (((e.__proto__ = t), e.__proto__ !== t))
                        throw new TypeError(e + " is not extensible");
                      return e;
                    }
                  : null;
              }
              var c = a;
              function f(e, t) {
                if (((e.prototype = s(t.prototype)), (e.prototype.constructor = e), c)) c(e, t);
                else
                  for (var r in t)
                    if ("prototype" != r)
                      if (Object.defineProperties) {
                        var i = Object.getOwnPropertyDescriptor(t, r);
                        i && Object.defineProperty(e, r, i);
                      } else e[r] = t[r];
                e.Im = t.prototype;
              }
              function p(e) {
                var t = 0;
                return function () {
                  return t < e.length ? { done: !1, value: e[t++] } : { done: !0 };
                };
              }
              function g(e) {
                var t = "undefined" != typeof Symbol && Symbol.iterator && e[Symbol.iterator];
                if (t) return t.call(e);
                if ("number" == typeof e.length) return { next: p(e) };
                throw Error(String(e) + " is not an iterable or ArrayLike");
              }
              function m(e) {
                if (!(e instanceof Array)) {
                  e = g(e);
                  for (var t, r = []; !(t = e.next()).done; ) r.push(t.value);
                  e = r;
                }
                return e;
              }
              function v() {
                ((this.o = !1),
                  (this.l = null),
                  (this.h = void 0),
                  (this.g = 1),
                  (this.j = this.m = 0),
                  (this.B = this.i = null));
              }
              function y(e) {
                if (e.o) throw new TypeError("Generator is already running");
                e.o = !0;
              }
              function T(e, t) {
                ((e.i = { bi: t, si: !0 }), (e.g = e.m || e.j));
              }
              function b(e, t, r) {
                return ((e.g = r), { value: t });
              }
              function S(e) {
                e.g = 0;
              }
              function E(e, t, r) {
                ((e.m = t), null != r && (e.j = r));
              }
              function x(e, t) {
                ((e.m = 0), (e.j = t || 0));
              }
              function w(e, t, r) {
                ((e.g = t), (e.m = r || 0));
              }
              function A(e, t) {
                return ((e.m = t || 0), (t = e.i.bi), (e.i = null), t);
              }
              function I(e) {
                ((e.B = [e.i]), (e.m = 0), (e.j = 0));
              }
              function k(e, t) {
                var r = e.B.splice(0)[0];
                (r = e.i = e.i || r)
                  ? r.si
                    ? (e.g = e.m || e.j)
                    : null != r.A && e.j < r.A
                      ? ((e.g = r.A), (e.i = null))
                      : (e.g = e.j)
                  : (e.g = t);
              }
              function R(e) {
                ((this.g = new v()), (this.h = e));
              }
              function C(e, t, r, i) {
                try {
                  var n = t.call(e.g.l, r);
                  if (!(n instanceof Object))
                    throw new TypeError("Iterator result " + n + " is not an object");
                  if (!n.done) return ((e.g.o = !1), n);
                  var a = n.value;
                } catch (s) {
                  return ((e.g.l = null), T(e.g, s), L(e));
                }
                return ((e.g.l = null), i.call(e.g, a), L(e));
              }
              function L(e) {
                for (; e.g.g; )
                  try {
                    var t = e.h(e.g);
                    if (t) return ((e.g.o = !1), { value: t.value, done: !1 });
                  } catch (r) {
                    ((e.g.h = void 0), T(e.g, r));
                  }
                if (((e.g.o = !1), e.g.i)) {
                  if (((t = e.g.i), (e.g.i = null), t.si)) throw t.bi;
                  return { value: t.return, done: !0 };
                }
                return { value: void 0, done: !0 };
              }
              function M(e) {
                ((this.next = function (t) {
                  return (y(e.g), e.g.l ? (t = C(e, e.g.l.next, t, e.g.u)) : (e.g.u(t), (t = L(e))), t);
                }),
                  (this.throw = function (t) {
                    return (y(e.g), e.g.l ? (t = C(e, e.g.l.throw, t, e.g.u)) : (T(e.g, t), (t = L(e))), t);
                  }),
                  (this.return = function (t) {
                    return (function (e, t) {
                      y(e.g);
                      var r = e.g.l;
                      return r
                        ? C(
                            e,
                            "return" in r
                              ? r.return
                              : function (e) {
                                  return { value: e, done: !0 };
                                },
                            t,
                            e.g.return,
                          )
                        : (e.g.return(t), L(e));
                    })(e, t);
                  }),
                  (this[Symbol.iterator] = function () {
                    return this;
                  }));
              }
              function D(e) {
                return (function (e) {
                  function t(t) {
                    return e.next(t);
                  }
                  function r(t) {
                    return e.throw(t);
                  }
                  return new Promise(function (i, n) {
                    !(function e(a) {
                      a.done ? i(a.value) : Promise.resolve(a.value).then(t, r).then(e, n);
                    })(e.next());
                  });
                })(new M(new R(e)));
              }
              function _() {
                for (var e = Number(this), t = [], r = e; r < arguments.length; r++) t[r - e] = arguments[r];
                return t;
              }
              function P(e) {
                return (
                  ((e = { next: e })[Symbol.iterator] = function () {
                    return this;
                  }),
                  e
                );
              }
              function O(e, t) {
                return Object.prototype.hasOwnProperty.call(e, t);
              }
              function N(e, t, r) {
                e instanceof String && (e = String(e));
                for (var i = e.length, n = 0; n < i; n++) {
                  var a = e[n];
                  if (t.call(r, a, n, e)) return { ni: n, v: a };
                }
                return { ni: -1, v: void 0 };
              }
              function F(e, t) {
                e instanceof String && (e += "");
                var r = 0,
                  i = !1,
                  n = {
                    next: function () {
                      if (!i && r < e.length) {
                        var n = r++;
                        return { value: t(n, e[n]), done: !1 };
                      }
                      return ((i = !0), { done: !0, value: void 0 });
                    },
                  };
                return (
                  (n[Symbol.iterator] = function () {
                    return n;
                  }),
                  n
                );
              }
              function U(e, t, r) {
                if (null == e)
                  throw new TypeError(
                    "The 'this' value for String.prototype." + r + " must not be null or undefined",
                  );
                if (t instanceof RegExp)
                  throw new TypeError(
                    "First argument to String.prototype." + r + " must not be a regular expression",
                  );
                return e + "";
              }
              ((v.prototype.u = function (e) {
                this.h = e;
              }),
                (v.prototype.return = function (e) {
                  ((this.i = { return: e }), (this.g = this.j));
                }),
                (v.prototype.A = function (e) {
                  this.g = e;
                }),
                u("Symbol", function (e) {
                  function t(e, t) {
                    ((this.g = e), o(this, "description", { configurable: !0, writable: !0, value: t }));
                  }
                  if (e) return e;
                  t.prototype.toString = function () {
                    return this.g;
                  };
                  var r = "jscomp_symbol_" + ((1e9 * Math.random()) >>> 0) + "_",
                    i = 0;
                  return function e(n) {
                    if (this instanceof e) throw new TypeError("Symbol is not a constructor");
                    return new t(r + (n || "") + "_" + i++, n);
                  };
                }),
                u("Symbol.iterator", function (e) {
                  return (
                    e ||
                    ((e = Symbol("Symbol.iterator")),
                    o(Array.prototype, e, {
                      configurable: !0,
                      writable: !0,
                      value: function () {
                        return P(p(this));
                      },
                    }),
                    e)
                  );
                }),
                u("Promise", function (e) {
                  function t(e) {
                    ((this.h = 0), (this.i = void 0), (this.g = []), (this.o = !1));
                    var t = this.j();
                    try {
                      e(t.resolve, t.reject);
                    } catch (r) {
                      t.reject(r);
                    }
                  }
                  function i() {
                    this.g = null;
                  }
                  function n(e) {
                    return e instanceof t
                      ? e
                      : new t(function (t) {
                          t(e);
                        });
                  }
                  if (e) return e;
                  i.prototype.h = function (e) {
                    if (null == this.g) {
                      this.g = [];
                      var t = this;
                      this.i(function () {
                        t.l();
                      });
                    }
                    this.g.push(e);
                  };
                  var a = l.setTimeout;
                  ((i.prototype.i = function (e) {
                    a(e, 0);
                  }),
                    (i.prototype.l = function () {
                      for (; this.g && this.g.length; ) {
                        var e = this.g;
                        this.g = [];
                        for (var t = 0; t < e.length; ++t) {
                          var r = e[t];
                          e[t] = null;
                          try {
                            r();
                          } catch (i) {
                            this.j(i);
                          }
                        }
                      }
                      this.g = null;
                    }),
                    (i.prototype.j = function (e) {
                      this.i(function () {
                        throw e;
                      });
                    }),
                    (t.prototype.j = function () {
                      function e(e) {
                        return function (i) {
                          r || ((r = !0), e.call(t, i));
                        };
                      }
                      var t = this,
                        r = !1;
                      return { resolve: e(this.G), reject: e(this.l) };
                    }),
                    (t.prototype.G = function (e) {
                      if (e === this) this.l(new TypeError("A Promise cannot resolve to itself"));
                      else if (e instanceof t) this.I(e);
                      else {
                        e: switch (typeof e) {
                          case "object":
                            var r = null != e;
                            break e;
                          case "function":
                            r = !0;
                            break e;
                          default:
                            r = !1;
                        }
                        r ? this.F(e) : this.m(e);
                      }
                    }),
                    (t.prototype.F = function (e) {
                      var t = void 0;
                      try {
                        t = e.then;
                      } catch (r) {
                        return void this.l(r);
                      }
                      "function" == typeof t ? this.J(t, e) : this.m(e);
                    }),
                    (t.prototype.l = function (e) {
                      this.u(2, e);
                    }),
                    (t.prototype.m = function (e) {
                      this.u(1, e);
                    }),
                    (t.prototype.u = function (e, t) {
                      if (0 != this.h)
                        throw Error(
                          "Cannot settle(" + e + ", " + t + "): Promise already settled in state" + this.h,
                        );
                      ((this.h = e), (this.i = t), 2 === this.h && this.H(), this.B());
                    }),
                    (t.prototype.H = function () {
                      var e = this;
                      a(function () {
                        if (e.C()) {
                          var t = l.console;
                          void 0 !== t && t.error(e.i);
                        }
                      }, 1);
                    }),
                    (t.prototype.C = function () {
                      if (this.o) return !1;
                      var e = l.CustomEvent,
                        t = l.Event,
                        r = l.dispatchEvent;
                      return (
                        void 0 === r ||
                        ("function" == typeof e
                          ? (e = new e("unhandledrejection", { cancelable: !0 }))
                          : "function" == typeof t
                            ? (e = new t("unhandledrejection", { cancelable: !0 }))
                            : (e = l.document.createEvent("CustomEvent")).initCustomEvent(
                                "unhandledrejection",
                                !1,
                                !0,
                                e,
                              ),
                        (e.promise = this),
                        (e.reason = this.i),
                        r(e))
                      );
                    }),
                    (t.prototype.B = function () {
                      if (null != this.g) {
                        for (var e = 0; e < this.g.length; ++e) s.h(this.g[e]);
                        this.g = null;
                      }
                    }));
                  var s = new i();
                  return (
                    (t.prototype.I = function (e) {
                      var t = this.j();
                      e.Te(t.resolve, t.reject);
                    }),
                    (t.prototype.J = function (e, t) {
                      var r = this.j();
                      try {
                        e.call(t, r.resolve, r.reject);
                      } catch (i) {
                        r.reject(i);
                      }
                    }),
                    (t.prototype.then = function (e, r) {
                      function i(e, t) {
                        return "function" == typeof e
                          ? function (t) {
                              try {
                                n(e(t));
                              } catch (r) {
                                a(r);
                              }
                            }
                          : t;
                      }
                      var n,
                        a,
                        s = new t(function (e, t) {
                          ((n = e), (a = t));
                        });
                      return (this.Te(i(e, n), i(r, a)), s);
                    }),
                    (t.prototype.catch = function (e) {
                      return this.then(void 0, e);
                    }),
                    (t.prototype.Te = function (e, t) {
                      function r() {
                        switch (i.h) {
                          case 1:
                            e(i.i);
                            break;
                          case 2:
                            t(i.i);
                            break;
                          default:
                            throw Error("Unexpected state: " + i.h);
                        }
                      }
                      var i = this;
                      (null == this.g ? s.h(r) : this.g.push(r), (this.o = !0));
                    }),
                    (t.resolve = n),
                    (t.reject = function (e) {
                      return new t(function (t, r) {
                        r(e);
                      });
                    }),
                    (t.race = function (e) {
                      return new t(function (t, r) {
                        for (var i = g(e), a = i.next(); !a.done; a = i.next()) n(a.value).Te(t, r);
                      });
                    }),
                    (t.all = function (e) {
                      var r = g(e),
                        i = r.next();
                      return i.done
                        ? n([])
                        : new t(function (e, t) {
                            function a(t) {
                              return function (r) {
                                ((s[t] = r), 0 == --o && e(s));
                              };
                            }
                            var s = [],
                              o = 0;
                            do {
                              (s.push(void 0), o++, n(i.value).Te(a(s.length - 1), t), (i = r.next()));
                            } while (!i.done);
                          });
                    }),
                    t
                  );
                }),
                u("WeakMap", function (e) {
                  function t(e) {
                    if (((this.g = (l += Math.random() + 1).toString()), e)) {
                      e = g(e);
                      for (var t; !(t = e.next()).done; ) ((t = t.value), this.set(t[0], t[1]));
                    }
                  }
                  function r() {}
                  function i(e) {
                    var t = typeof e;
                    return ("object" === t && null !== e) || "function" === t;
                  }
                  function n(e) {
                    if (!O(e, s)) {
                      var t = new r();
                      o(e, s, { value: t });
                    }
                  }
                  function a(e) {
                    var t = Object[e];
                    t &&
                      (Object[e] = function (e) {
                        return e instanceof r ? e : (Object.isExtensible(e) && n(e), t(e));
                      });
                  }
                  if (
                    (function () {
                      if (!e || !Object.seal) return !1;
                      try {
                        var t = Object.seal({}),
                          r = Object.seal({}),
                          i = new e([
                            [t, 2],
                            [r, 3],
                          ]);
                        return (
                          2 == i.get(t) &&
                          3 == i.get(r) &&
                          (i.delete(t), i.set(r, 4), !i.has(t) && 4 == i.get(r))
                        );
                      } catch (n) {
                        return !1;
                      }
                    })()
                  )
                    return e;
                  var s = "$jscomp_hidden_" + Math.random();
                  (a("freeze"), a("preventExtensions"), a("seal"));
                  var l = 0;
                  return (
                    (t.prototype.set = function (e, t) {
                      if (!i(e)) throw Error("Invalid WeakMap key");
                      if ((n(e), !O(e, s))) throw Error("WeakMap key fail: " + e);
                      return ((e[s][this.g] = t), this);
                    }),
                    (t.prototype.get = function (e) {
                      return i(e) && O(e, s) ? e[s][this.g] : void 0;
                    }),
                    (t.prototype.has = function (e) {
                      return i(e) && O(e, s) && O(e[s], this.g);
                    }),
                    (t.prototype.delete = function (e) {
                      return !!(i(e) && O(e, s) && O(e[s], this.g)) && delete e[s][this.g];
                    }),
                    t
                  );
                }),
                u("Map", function (e) {
                  function t() {
                    var e = {};
                    return (e.xc = e.next = e.head = e);
                  }
                  function r(e, t) {
                    var r = e[1];
                    return P(function () {
                      if (r) {
                        for (; r.head != e[1]; ) r = r.xc;
                        for (; r.next != r.head; ) return ((r = r.next), { done: !1, value: t(r) });
                        r = null;
                      }
                      return { done: !0, value: void 0 };
                    });
                  }
                  function i(e, t) {
                    var r = t && typeof t;
                    "object" == r || "function" == r
                      ? a.has(t)
                        ? (r = a.get(t))
                        : ((r = "" + ++s), a.set(t, r))
                      : (r = "p_" + t);
                    var i = e[0][r];
                    if (i && O(e[0], r))
                      for (e = 0; e < i.length; e++) {
                        var n = i[e];
                        if ((t != t && n.key != n.key) || t === n.key)
                          return { id: r, list: i, index: e, entry: n };
                      }
                    return { id: r, list: i, index: -1, entry: void 0 };
                  }
                  function n(e) {
                    if (((this[0] = {}), (this[1] = t()), (this.size = 0), e)) {
                      e = g(e);
                      for (var r; !(r = e.next()).done; ) ((r = r.value), this.set(r[0], r[1]));
                    }
                  }
                  if (
                    (function () {
                      if (
                        !e ||
                        "function" != typeof e ||
                        !e.prototype.entries ||
                        "function" != typeof Object.seal
                      )
                        return !1;
                      try {
                        var t = Object.seal({ x: 4 }),
                          r = new e(g([[t, "s"]]));
                        if (
                          "s" != r.get(t) ||
                          1 != r.size ||
                          r.get({ x: 4 }) ||
                          r.set({ x: 4 }, "t") != r ||
                          2 != r.size
                        )
                          return !1;
                        var i = r.entries(),
                          n = i.next();
                        return (
                          !n.done &&
                          n.value[0] == t &&
                          "s" == n.value[1] &&
                          !((n = i.next()).done || 4 != n.value[0].x || "t" != n.value[1] || !i.next().done)
                        );
                      } catch (a) {
                        return !1;
                      }
                    })()
                  )
                    return e;
                  var a = new WeakMap();
                  ((n.prototype.set = function (e, t) {
                    var r = i(this, (e = 0 === e ? 0 : e));
                    return (
                      r.list || (r.list = this[0][r.id] = []),
                      r.entry
                        ? (r.entry.value = t)
                        : ((r.entry = { next: this[1], xc: this[1].xc, head: this[1], key: e, value: t }),
                          r.list.push(r.entry),
                          (this[1].xc.next = r.entry),
                          (this[1].xc = r.entry),
                          this.size++),
                      this
                    );
                  }),
                    (n.prototype.delete = function (e) {
                      return !(
                        !(e = i(this, e)).entry ||
                        !e.list ||
                        (e.list.splice(e.index, 1),
                        e.list.length || delete this[0][e.id],
                        (e.entry.xc.next = e.entry.next),
                        (e.entry.next.xc = e.entry.xc),
                        (e.entry.head = null),
                        this.size--,
                        0)
                      );
                    }),
                    (n.prototype.clear = function () {
                      ((this[0] = {}), (this[1] = this[1].xc = t()), (this.size = 0));
                    }),
                    (n.prototype.has = function (e) {
                      return !!i(this, e).entry;
                    }),
                    (n.prototype.get = function (e) {
                      return (e = i(this, e).entry) && e.value;
                    }),
                    (n.prototype.entries = function () {
                      return r(this, function (e) {
                        return [e.key, e.value];
                      });
                    }),
                    (n.prototype.keys = function () {
                      return r(this, function (e) {
                        return e.key;
                      });
                    }),
                    (n.prototype.values = function () {
                      return r(this, function (e) {
                        return e.value;
                      });
                    }),
                    (n.prototype.forEach = function (e, t) {
                      for (var r, i = this.entries(); !(r = i.next()).done; )
                        ((r = r.value), e.call(t, r[1], r[0], this));
                    }),
                    (n.prototype[Symbol.iterator] = n.prototype.entries));
                  var s = 0;
                  return n;
                }),
                u("Set", function (e) {
                  function t(e) {
                    if (((this.g = new Map()), e)) {
                      e = g(e);
                      for (var t; !(t = e.next()).done; ) this.add(t.value);
                    }
                    this.size = this.g.size;
                  }
                  return (function () {
                    if (
                      !e ||
                      "function" != typeof e ||
                      !e.prototype.entries ||
                      "function" != typeof Object.seal
                    )
                      return !1;
                    try {
                      var t = Object.seal({ x: 4 }),
                        r = new e(g([t]));
                      if (
                        !r.has(t) ||
                        1 != r.size ||
                        r.add(t) != r ||
                        1 != r.size ||
                        r.add({ x: 4 }) != r ||
                        2 != r.size
                      )
                        return !1;
                      var i = r.entries(),
                        n = i.next();
                      return (
                        !n.done &&
                        n.value[0] == t &&
                        n.value[1] == t &&
                        !(n = i.next()).done &&
                        n.value[0] != t &&
                        4 == n.value[0].x &&
                        n.value[1] == n.value[0] &&
                        i.next().done
                      );
                    } catch (a) {
                      return !1;
                    }
                  })()
                    ? e
                    : ((t.prototype.add = function (e) {
                        return ((e = 0 === e ? 0 : e), this.g.set(e, e), (this.size = this.g.size), this);
                      }),
                      (t.prototype.delete = function (e) {
                        return ((e = this.g.delete(e)), (this.size = this.g.size), e);
                      }),
                      (t.prototype.clear = function () {
                        (this.g.clear(), (this.size = 0));
                      }),
                      (t.prototype.has = function (e) {
                        return this.g.has(e);
                      }),
                      (t.prototype.entries = function () {
                        return this.g.entries();
                      }),
                      (t.prototype.values = function () {
                        return this.g.values();
                      }),
                      (t.prototype.keys = t.prototype.values),
                      (t.prototype[Symbol.iterator] = t.prototype.values),
                      (t.prototype.forEach = function (e, t) {
                        var r = this;
                        this.g.forEach(function (i) {
                          return e.call(t, i, i, r);
                        });
                      }),
                      t);
                }),
                u("Array.prototype.findIndex", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      return N(this, e, t).ni;
                    }
                  );
                }),
                u("Array.prototype.values", function (e) {
                  return (
                    e ||
                    function () {
                      return F(this, function (e, t) {
                        return t;
                      });
                    }
                  );
                }),
                u("Array.from", function (e) {
                  return (
                    e ||
                    function (e, t, r) {
                      t =
                        null != t
                          ? t
                          : function (e) {
                              return e;
                            };
                      var i = [],
                        n = "undefined" != typeof Symbol && Symbol.iterator && e[Symbol.iterator];
                      if ("function" == typeof n) {
                        e = n.call(e);
                        for (var a = 0; !(n = e.next()).done; ) i.push(t.call(r, n.value, a++));
                      } else for (n = e.length, a = 0; a < n; a++) i.push(t.call(r, e[a], a));
                      return i;
                    }
                  );
                }),
                u("Array.prototype.keys", function (e) {
                  return (
                    e ||
                    function () {
                      return F(this, function (e) {
                        return e;
                      });
                    }
                  );
                }),
                u("String.prototype.startsWith", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      var r = U(this, e, "startsWith"),
                        i = r.length,
                        n = e.length;
                      t = Math.max(0, Math.min(0 | t, r.length));
                      for (var a = 0; a < n && t < i; ) if (r[t++] != e[a++]) return !1;
                      return a >= n;
                    }
                  );
                }),
                u("Object.is", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      return e === t ? 0 !== e || 1 / e == 1 / t : e != e && t != t;
                    }
                  );
                }),
                u("Array.prototype.includes", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      var r = this;
                      r instanceof String && (r = String(r));
                      var i = r.length;
                      for ((t = t || 0) < 0 && (t = Math.max(t + i, 0)); t < i; t++) {
                        var n = r[t];
                        if (n === e || Object.is(n, e)) return !0;
                      }
                      return !1;
                    }
                  );
                }),
                u("String.prototype.includes", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      return -1 !== U(this, e, "includes").indexOf(e, t || 0);
                    }
                  );
                }),
                u("String.fromCodePoint", function (e) {
                  return (
                    e ||
                    function (e) {
                      for (var t = "", r = 0; r < arguments.length; r++) {
                        var i = Number(arguments[r]);
                        if (i < 0 || i > 1114111 || i !== Math.floor(i))
                          throw new RangeError("invalid_code_point " + i);
                        i <= 65535
                          ? (t += String.fromCharCode(i))
                          : ((i -= 65536),
                            (t += String.fromCharCode(((i >>> 10) & 1023) | 55296)),
                            (t += String.fromCharCode((1023 & i) | 56320)));
                      }
                      return t;
                    }
                  );
                }),
                u("WeakSet", function (e) {
                  function t(e) {
                    if (((this.g = new WeakMap()), e)) {
                      e = g(e);
                      for (var t; !(t = e.next()).done; ) this.add(t.value);
                    }
                  }
                  return (function () {
                    if (!e || !Object.seal) return !1;
                    try {
                      var t = Object.seal({}),
                        r = Object.seal({}),
                        i = new e([t]);
                      return !(!i.has(t) || i.has(r)) && (i.delete(t), i.add(r), !i.has(t) && i.has(r));
                    } catch (n) {
                      return !1;
                    }
                  })()
                    ? e
                    : ((t.prototype.add = function (e) {
                        return (this.g.set(e, !0), this);
                      }),
                      (t.prototype.has = function (e) {
                        return this.g.has(e);
                      }),
                      (t.prototype.delete = function (e) {
                        return this.g.delete(e);
                      }),
                      t);
                }),
                u("Array.prototype.find", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      return N(this, e, t).v;
                    }
                  );
                }),
                u("Object.entries", function (e) {
                  return (
                    e ||
                    function (e) {
                      var t,
                        r = [];
                      for (t in e) O(e, t) && r.push([t, e[t]]);
                      return r;
                    }
                  );
                }));
              var B =
                "function" == typeof Object.assign
                  ? Object.assign
                  : function (e, t) {
                      if (null == e) throw new TypeError("No nullish arg");
                      e = Object(e);
                      for (var r = 1; r < arguments.length; r++) {
                        var i = arguments[r];
                        if (i) for (var n in i) O(i, n) && (e[n] = i[n]);
                      }
                      return e;
                    };
              (u("Object.assign", function (e) {
                return e || B;
              }),
                u("Promise.prototype.finally", function (e) {
                  return (
                    e ||
                    function (e) {
                      return this.then(
                        function (t) {
                          return Promise.resolve(e()).then(function () {
                            return t;
                          });
                        },
                        function (t) {
                          return Promise.resolve(e()).then(function () {
                            throw t;
                          });
                        },
                      );
                    }
                  );
                }),
                u("Array.prototype.entries", function (e) {
                  return (
                    e ||
                    function () {
                      return F(this, function (e, t) {
                        return [e, t];
                      });
                    }
                  );
                }),
                u("Number.isNaN", function (e) {
                  return (
                    e ||
                    function (e) {
                      return "number" == typeof e && isNaN(e);
                    }
                  );
                }),
                u("String.prototype.repeat", function (e) {
                  return (
                    e ||
                    function (e) {
                      var t = U(this, null, "repeat");
                      if (e < 0 || e > 1342177279) throw new RangeError("Invalid count value");
                      e |= 0;
                      for (var r = ""; e; ) (1 & e && (r += t), (e >>>= 1) && (t += t));
                      return r;
                    }
                  );
                }),
                u("Number.EPSILON", function () {
                  return 2220446049250313e-31;
                }),
                u("Number.MAX_SAFE_INTEGER", function () {
                  return 9007199254740991;
                }),
                u("Number.isFinite", function (e) {
                  return (
                    e ||
                    function (e) {
                      return "number" == typeof e && !isNaN(e) && e !== 1 / 0 && e !== -1 / 0;
                    }
                  );
                }),
                u("Object.values", function (e) {
                  return (
                    e ||
                    function (e) {
                      var t,
                        r = [];
                      for (t in e) O(e, t) && r.push(e[t]);
                      return r;
                    }
                  );
                }),
                u("Math.log2", function (e) {
                  return (
                    e ||
                    function (e) {
                      return Math.log(e) / Math.LN2;
                    }
                  );
                }),
                u("String.prototype.endsWith", function (e) {
                  return (
                    e ||
                    function (e, t) {
                      var r = U(this, e, "endsWith");
                      (void 0 === t && (t = r.length), (t = Math.max(0, Math.min(0 | t, r.length))));
                      for (var i = e.length; i > 0 && t > 0; ) if (r[--t] != e[--i]) return !1;
                      return i <= 0;
                    }
                  );
                }),
                u("Math.trunc", function (e) {
                  return (
                    e ||
                    function (e) {
                      if (((e = Number(e)), isNaN(e) || e === 1 / 0 || e === -1 / 0 || 0 === e)) return e;
                      var t = Math.floor(Math.abs(e));
                      return e < 0 ? -t : t;
                    }
                  );
                }));
              var $ = this || self;
              function j(e, t) {
                e = e.split(".");
                var r,
                  i = $;
                e[0] in i || void 0 === i.execScript || i.execScript("var " + e[0]);
                for (; e.length && (r = e.shift()); )
                  e.length || void 0 === t
                    ? (i = i[r] && i[r] !== Object.prototype[r] ? i[r] : (i[r] = {}))
                    : (i[r] = t);
              }
              function G(e) {
                ((this.g = Math.exp(Math.log(0.5) / e)), (this.i = this.h = 0));
              }
              function V(e) {
                return e.h / (1 - Math.pow(e.g, e.i));
              }
              function H() {
                ((this.h = new G(2)), (this.j = new G(5)), (this.g = 0), (this.i = 128e3), (this.l = 16e3));
              }
              function K() {}
              function W() {}
              function z() {}
              function q(e) {
                var t = _.apply(1, arguments);
                Y.has(e) || (Y.add(e), z.apply(K, m(t)));
              }
              function X() {}
              ((G.prototype.sample = function (e, t) {
                var r = Math.pow(this.g, e);
                ((t = t * (1 - r) + r * this.h), isNaN(t) || ((this.h = t), (this.i += e)));
              }),
                (H.prototype.configure = function (e) {
                  ((this.i = e.minTotalBytes),
                    (this.l = e.minBytes),
                    (this.h.g = Math.exp(Math.log(0.5) / e.fastHalfLife)),
                    (this.j.g = Math.exp(Math.log(0.5) / e.slowHalfLife)));
                }),
                (H.prototype.sample = function (e, t) {
                  if (!(t < this.l)) {
                    var r = (8e3 * t) / e;
                    ((e /= 1e3), (this.g += t), this.h.sample(e, r), this.j.sample(e, r));
                  }
                }),
                (H.prototype.getBandwidthEstimate = function (e) {
                  return this.g < this.i ? e : Math.min(V(this.h), V(this.j));
                }));
              var Y = new Set();
              function Q(e, t) {
                return !("number" != typeof e || "number" != typeof t || !isNaN(e) || !isNaN(t)) || e === t;
              }
              function J(e, t) {
                (t = e.indexOf(t)) > -1 && e.splice(t, 1);
              }
              function Z(e, t, r) {
                if ((r || (r = Q), e.length != t.length)) return !1;
                t = t.slice();
                for (var i = (e = g(e)).next(), n = {}; !i.done; n = { ui: void 0 }, i = e.next()) {
                  if (
                    ((n.ui = i.value),
                    -1 ==
                      (i = t.findIndex(
                        (function (e) {
                          return function (t) {
                            return r(e.ui, t);
                          };
                        })(n),
                      )))
                  )
                    return !1;
                  ((t[i] = t[t.length - 1]), t.pop());
                }
                return 0 == t.length;
              }
              function ee(e, t, r) {
                if (e === t) return !0;
                if (!e || !t) return e == t;
                if ((r || (r = Q), e.length != t.length)) return !1;
                for (var i = 0; i < e.length; i++) if (!r(e[i], t[i])) return !1;
                return !0;
              }
              function te() {
                this.g = new Map();
              }
              function re() {
                this.g = new te();
              }
              function ie(e, t, r, i) {
                ((this.target = e),
                  (this.type = t),
                  (this.listener = r),
                  (this.g = (function (e, t) {
                    if (null == t) return !1;
                    if ("boolean" == typeof t) return t;
                    var r = new Set(["passive", "capture"]);
                    return (
                      Object.keys(t).filter(function (e) {
                        return !r.has(e);
                      }),
                      (function (e) {
                        var t = ne;
                        if (null == t) {
                          t = !1;
                          try {
                            var r = {},
                              i = {
                                get: function () {
                                  return ((t = !0), !1);
                                },
                              };
                            (Object.defineProperty(r, "passive", i),
                              Object.defineProperty(r, "capture", i),
                              (i = function () {}),
                              e.addEventListener("test", i, r),
                              e.removeEventListener("test", i, r));
                          } catch (n) {
                            t = !1;
                          }
                          ne = t;
                        }
                        return t || !1;
                      })(e)
                        ? t
                        : t.capture || !1
                    );
                  })(e, i)),
                  this.target.addEventListener(t, r, this.g));
              }
              (e.console &&
                (new Map()
                  .set(1, function () {
                    return console.error.apply(console, m(_.apply(0, arguments)));
                  })
                  .set(2, function () {
                    return console.warn.apply(console, m(_.apply(0, arguments)));
                  })
                  .set(3, function () {
                    return console.info.apply(console, m(_.apply(0, arguments)));
                  })
                  .set(4, function () {
                    return console.log.apply(console, m(_.apply(0, arguments)));
                  })
                  .set(5, function () {
                    return console.debug.apply(console, m(_.apply(0, arguments)));
                  })
                  .set(6, function () {
                    return console.debug.apply(console, m(_.apply(0, arguments)));
                  }),
                (z = function () {
                  return console.warn.apply(console, m(_.apply(0, arguments)));
                }),
                (W = function () {
                  console.error.apply(console, m(_.apply(0, arguments)));
                })),
                ((n = te.prototype).push = function (e, t) {
                  this.g.has(e) ? this.g.get(e).push(t) : this.g.set(e, [t]);
                }),
                (n.get = function (e) {
                  return this.g.has(e) ? this.g.get(e).slice() : null;
                }),
                (n.remove = function (e, t) {
                  if (this.g.has(e)) {
                    var r = this.g.get(e).filter(function (e) {
                      return e != t;
                    });
                    (this.g.set(e, r), r.length || this.g.delete(e));
                  }
                }),
                (n.forEach = function (e) {
                  this.g.forEach(function (t, r) {
                    e(r, t);
                  });
                }),
                (n.size = function () {
                  return this.g.size;
                }),
                (n.keys = function () {
                  return Array.from(this.g.keys());
                }),
                ((n = re.prototype).release = function () {
                  (this.Qa(), (this.g = null));
                }),
                (n.D = function (e, t, r, i) {
                  this.g && ((e = new ie(e, t, r, i)), this.g.push(t, e));
                }),
                (n.Aa = function (e, t, r, i) {
                  var n = this;
                  this.D(
                    e,
                    t,
                    function i(a) {
                      (n.Ma(e, t, i), r(a));
                    },
                    i,
                  );
                }),
                (n.Ma = function (e, t, r) {
                  if (this.g)
                    for (var i = this.g.get(t) || [], n = (i = g(i)).next(); !n.done; n = i.next())
                      (n = n.value).target != e || (r != n.listener && r) || (n.Ma(), this.g.remove(t, n));
                }),
                (n.Qa = function () {
                  if (this.g) {
                    for (var e = [], t = g(this.g.g.values()), r = t.next(); !r.done; r = t.next())
                      e.push.apply(e, m(r.value));
                    for (t = (e = g(e)).next(); !t.done; t = e.next()) t.value.Ma();
                    this.g.g.clear();
                  }
                }),
                j("shaka.util.EventManager", re),
                (re.prototype.removeAll = re.prototype.Qa),
                (re.prototype.unlisten = re.prototype.Ma),
                (re.prototype.listenOnce = re.prototype.Aa),
                (re.prototype.listen = re.prototype.D),
                (re.prototype.release = re.prototype.release),
                (ie.prototype.Ma = function () {
                  (this.target.removeEventListener(this.type, this.listener, this.g),
                    (this.listener = this.target = null),
                    (this.g = !1));
                }));
              var ne = void 0;
              function ae(e) {
                ((this.h = e), (this.g = void 0));
              }
              /*
      		 @license
      		 Shaka Player
      		 Copyright 2025 Google LLC
      		 SPDX-License-Identifier: Apache-2.0
      		*/
              function se() {
                return ue.value();
              }
              (j("shaka.config.AutoShowText", {
                NEVER: 0,
                ALWAYS: 1,
                IF_PREFERRED_TEXT_LANGUAGE: 2,
                IF_SUBTITLES_MAY_BE_NEEDED: 3,
              }),
                (ae.prototype.value = function () {
                  return (void 0 === this.g && (this.g = this.h()), this.g);
                }));
              var oe = null,
                le = null,
                ue = new ae(function () {
                  var e = void 0;
                  return (oe && (e = oe()), !e && le && (e = le()), e);
                });
              function de(e, t) {
                ((this.g = e), (this.h = t));
              }
              function he(e, t) {
                var r = new de(5, 0),
                  i = pe,
                  n = i.g,
                  a = r.h - n.h;
                ((r.g - n.g || a) > 0 ? i.i : i.h)(i.g, r, e, t);
              }
              function ce(e, t, r, i) {
                z(
                  [
                    r,
                    "has been deprecated and will be removed in",
                    t,
                    ". We are currently at version",
                    e,
                    ". Additional information:",
                    i,
                  ].join(" "),
                );
              }
              function fe(e, t, r, i) {
                W(
                  [
                    r,
                    "has been deprecated and has been removed in",
                    t,
                    ". We are now at version",
                    e,
                    ". Additional information:",
                    i,
                  ].join(" "),
                );
              }
              de.prototype.toString = function () {
                return "v" + this.g + "." + this.h;
              };
              var pe = null,
                ge = RegExp(
                  "^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$",
                );
              /*
      		 @license
      		 Copyright 2008 The Closure Library Authors
      		 SPDX-License-Identifier: Apache-2.0
      		*/
              /*
      		 @license
      		 Copyright 2006 The Closure Library Authors
      		 SPDX-License-Identifier: Apache-2.0
      		*/
              function me(e) {
                var t;
                e instanceof me
                  ? (ve(this, e.fc),
                    (this.hd = e.hd),
                    ye(this, e.Db),
                    Te(this, e.Dd),
                    (this.Sb = e.Sb),
                    be(this, e.g.clone()),
                    (this.Rc = e.Rc))
                  : e && (t = String(e).match(ge))
                    ? (ve(this, t[1] || "", !0),
                      (this.hd = Se(t[2] || "")),
                      ye(this, t[3] || "", !0),
                      Te(this, t[4]),
                      (this.Sb = Se(t[5] || "", !0)),
                      be(this, t[6] || "", !0),
                      (this.Rc = Se(t[7] || "")))
                    : (this.g = new Ce(null));
              }
              function ve(e, t, r) {
                ((e.fc = r ? Se(t, !0) : t), e.fc && (e.fc = e.fc.replace(/:$/, "")));
              }
              function ye(e, t, r) {
                e.Db = r ? Se(t, !0) : t;
              }
              function Te(e, t) {
                if (t) {
                  if (((t = Number(t)), isNaN(t) || t < 0)) throw Error("Bad port number " + t);
                  e.Dd = t;
                } else e.Dd = null;
              }
              function be(e, t, r) {
                t instanceof Ce ? (e.g = t) : (r || (t = Ee(t, ke)), (e.g = new Ce(t)));
              }
              function Se(e, t) {
                return e ? (t ? decodeURI(e) : decodeURIComponent(e)) : "";
              }
              function Ee(e, t, r) {
                return null != e
                  ? ((e = encodeURI(e).replace(t, xe)),
                    r && (e = e.replace(/%25([0-9a-fA-F]{2})/g, "%$1")),
                    e)
                  : null;
              }
              function xe(e) {
                return "%" + (((e = e.charCodeAt(0)) >> 4) & 15).toString(16) + (15 & e).toString(16);
              }
              (((n = me.prototype).fc = ""),
                (n.hd = ""),
                (n.Db = ""),
                (n.Dd = null),
                (n.Sb = ""),
                (n.Rc = ""),
                (n.toString = function () {
                  var e = [],
                    t = this.fc;
                  if ((t && e.push(Ee(t, we, !0), ":"), (t = this.Db))) {
                    e.push("//");
                    var r = this.hd;
                    (r && e.push(Ee(r, we, !0), "@"),
                      e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g, "%$1")),
                      null != (t = this.Dd) && e.push(":", String(t)));
                  }
                  return (
                    (t = this.Sb) &&
                      (this.Db && "/" != t.charAt(0) && e.push("/"),
                      e.push(Ee(t, "/" == t.charAt(0) ? Ie : Ae, !0))),
                    (t = this.g.toString()) && e.push("?", t),
                    (t = this.Rc) && e.push("#", Ee(t, Re)),
                    e.join("")
                  );
                }),
                (n.resolve = function (e) {
                  var t = this.clone();
                  "data" === t.fc && (t = new me());
                  var r = !!e.fc;
                  (r ? ve(t, e.fc) : (r = !!e.hd),
                    r ? (t.hd = e.hd) : (r = !!e.Db),
                    r ? ye(t, e.Db) : (r = null != e.Dd));
                  var i = e.Sb;
                  if (r) Te(t, e.Dd);
                  else if ((r = !!e.Sb)) {
                    if ("/" != i.charAt(0))
                      if (this.Db && !this.Sb) i = "/" + i;
                      else {
                        var n = t.Sb.lastIndexOf("/");
                        -1 != n && (i = t.Sb.substr(0, n + 1) + i);
                      }
                    if (".." == i || "." == i) i = "";
                    else if (-1 != i.indexOf("./") || -1 != i.indexOf("/.")) {
                      ((n = 0 == i.lastIndexOf("/", 0)), (i = i.split("/")));
                      for (var a = [], s = 0; s < i.length; ) {
                        var o = i[s++];
                        "." == o
                          ? n && s == i.length && a.push("")
                          : ".." == o
                            ? ((a.length > 1 || (1 == a.length && "" != a[0])) && a.pop(),
                              n && s == i.length && a.push(""))
                            : (a.push(o), (n = !0));
                      }
                      i = a.join("/");
                    }
                  }
                  return (
                    r ? (t.Sb = i) : (r = "" !== e.g.toString()),
                    r ? be(t, e.g.clone()) : (r = !!e.Rc),
                    r && (t.Rc = e.Rc),
                    t
                  );
                }),
                (n.clone = function () {
                  return new me(this);
                }));
              var we = /[#\/\?@]/g,
                Ae = /[#\?:]/g,
                Ie = /[#\?]/g,
                ke = /[#\?@]/g,
                Re = /#/g;
              function Ce(e) {
                this.g = e || null;
              }
              function Le(e) {
                if (!e.fb && ((e.fb = new Map()), (e.Vd = 0), e.g))
                  for (var t = e.g.split("&"), r = 0; r < t.length; r++) {
                    var i = t[r].indexOf("="),
                      n = null;
                    if (i >= 0) {
                      var a = t[r].substring(0, i);
                      n = t[r].substring(i + 1);
                    } else a = t[r];
                    ((a = decodeURIComponent(a)), (n = n || ""), e.add(a, decodeURIComponent(n)));
                  }
              }
              function Me(e) {
                return (Le(e), e.Vd);
              }
              function De() {}
              function _e(e, t) {
                if (!e && !t) return !0;
                if (!e || !t || e.byteLength != t.byteLength) return !1;
                if (
                  (ArrayBuffer.isView(e) ? e.buffer : e) == (ArrayBuffer.isView(t) ? t.buffer : t) &&
                  (e.byteOffset || 0) == (t.byteOffset || 0)
                )
                  return !0;
                var r = Oe(e);
                t = Oe(t);
                for (var i = 0; i < e.byteLength; i++) if (r[i] != t[i]) return !1;
                return !0;
              }
              function Pe(e) {
                return ArrayBuffer.isView(e)
                  ? 0 == e.byteOffset && e.byteLength == e.buffer.byteLength
                    ? e.buffer
                    : new Uint8Array(e).buffer
                  : e;
              }
              function Oe(e, t, r) {
                return Ue(e, void 0 === t ? 0 : t, (r = void 0 === r ? 1 / 0 : r), Uint8Array);
              }
              function Ne(e, t, r) {
                return Ue(e, void 0 === t ? 0 : t, (r = void 0 === r ? 1 / 0 : r), Uint16Array);
              }
              function Fe(e, t, r) {
                return Ue(e, void 0 === t ? 0 : t, (r = void 0 === r ? 1 / 0 : r), DataView);
              }
              function Ue(e, t, r, i) {
                var n = ArrayBuffer.isView(e) ? e.buffer : e,
                  a = 1;
                "BYTES_PER_ELEMENT" in i && (a = i.BYTES_PER_ELEMENT);
                var s = ((e.byteOffset || 0) + e.byteLength) / a;
                return new i(
                  n,
                  (e = Math.floor(Math.max(0, Math.min(((e.byteOffset || 0) + t) / a, s)))),
                  Math.floor(Math.min(e + Math.max(r, 0), s)) - e,
                );
              }
              function Be(e, t) {
                if (e === t || !e.length || !t.length) return !0;
                for (var r = (e = g(e)).next(); !r.done; r = e.next()) {
                  if (Ve((r = r.value))) return !0;
                  for (var i = g(t), n = i.next(); !n.done; n = i.next())
                    if (((n = n.value), r.keySystem === n.keySystem || Ve(n))) return !0;
                }
                return !1;
              }
              function $e(e, t) {
                if (!e.length) return t;
                if (!t.length) return e;
                for (var r = [], i = (e = g(e)).next(); !i.done; i = e.next()) {
                  i = i.value;
                  for (var n = g(t), a = n.next(); !a.done; a = n.next()) {
                    if (((a = a.value), i.keySystem == a.keySystem)) {
                      n = new Map();
                      for (
                        var s = g((i.initData || []).concat(a.initData || [])), o = s.next();
                        !o.done;
                        o = s.next()
                      )
                        ((o = o.value), n.set(o.keyId, o));
                      ((n = Array.from(n.values())),
                        (s =
                          i.keyIds && a.keyIds
                            ? new Set([].concat(m(i.keyIds), m(a.keyIds)))
                            : i.keyIds || a.keyIds),
                        r.push({
                          keySystem: i.keySystem,
                          licenseServerUri: i.licenseServerUri || a.licenseServerUri,
                          distinctiveIdentifierRequired:
                            i.distinctiveIdentifierRequired || a.distinctiveIdentifierRequired,
                          persistentStateRequired: i.persistentStateRequired || a.persistentStateRequired,
                          videoRobustness: i.videoRobustness || a.videoRobustness,
                          audioRobustness: i.audioRobustness || a.audioRobustness,
                          serverCertificate: i.serverCertificate || a.serverCertificate,
                          serverCertificateUri: i.serverCertificateUri || a.serverCertificateUri,
                          initData: n,
                          keyIds: s,
                        }));
                      break;
                    }
                    Ve(i) ? r.push(i) : Ve(a) && r.push(a);
                  }
                }
                return r;
              }
              function je(e) {
                return !!e && !!e.match(/^com\.(microsoft|chromecast)\.playready/);
              }
              function Ge(e) {
                return !!e && !!e.match(/^com\.apple\.fps/);
              }
              function Ve(e) {
                return !!(e = e.licenseServerUri) && e.startsWith("data:application/json;base64,");
              }
              function He(e, t, r, i) {
                return (
                  e +
                  "#" +
                  t +
                  "#" +
                  r +
                  "#" +
                  (i = []
                    .concat(m(new Set(i)))
                    .sort()
                    .join("#"))
                );
              }
              (((n = Ce.prototype).fb = null),
                (n.Vd = null),
                (n.add = function (e, t) {
                  (Le(this), (this.g = null));
                  var r = this.fb.has(e) ? this.fb.get(e) : null;
                  return (r || this.fb.set(e, (r = [])), r.push(t), this.Vd++, this);
                }),
                (n.set = function (e, t) {
                  return (
                    Le(this),
                    (this.g = null),
                    this.fb.has(e) ? this.fb.set(e, [t]) : this.add(e, t),
                    this
                  );
                }),
                (n.get = function (e) {
                  return (Le(this), this.fb.get(e) || []);
                }),
                (n.toString = function () {
                  if (this.g) return this.g;
                  if (!this.fb || !this.fb.size) return "";
                  for (var e = [], t = g(this.fb.keys()), r = t.next(); !r.done; r = t.next()) {
                    var i = r.value;
                    ((r = encodeURIComponent(i)), (i = this.fb.get(i)));
                    for (var n = 0; n < i.length; n++) {
                      var a = r;
                      ("" !== i[n] && (a += "=" + encodeURIComponent(i[n])), e.push(a));
                    }
                  }
                  return (this.g = e.join("&"));
                }),
                (n.clone = function () {
                  var e = new Ce();
                  if (((e.g = this.g), this.fb)) {
                    for (var t = new Map(), r = g(this.fb), i = r.next(); !i.done; i = r.next()) {
                      var n = g(i.value);
                      ((i = n.next().value), (n = n.next().value), t.set(i, n.concat()));
                    }
                    ((e.fb = t), (e.Vd = this.Vd));
                  }
                  return e;
                }),
                j("shaka.util.BufferUtils", De),
                (De.toDataView = Fe),
                (De.toUint16 = Ne),
                (De.toUint8 = Oe),
                (De.toArrayBuffer = Pe),
                (De.equal = _e));
              var Ke = new ae(function () {
                  return Pe(new Uint8Array([0]));
                }),
                We = new Map();
              function ze(e, t, r) {
                var i = _.apply(3, arguments);
                ((this.severity = e),
                  (this.category = t),
                  (this.code = r),
                  (this.data = i),
                  (this.handled = !1),
                  (this.message = "Shaka Error " + this.code));
                try {
                  throw Error(this.message || "Shaka Error");
                } catch (n) {
                  this.stack = n.stack;
                }
              }
              function qe() {}
              function Xe(t) {
                if (!t) return "";
                if (
                  (239 == (t = Oe(t))[0] && 187 == t[1] && 191 == t[2] && (t = t.subarray(3)),
                  e.TextDecoder && !se().xh())
                )
                  return (
                    (t = new TextDecoder().decode(t)).includes("") &&
                      W(
                        'Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!',
                      ),
                    t
                  );
                for (var r = "", i = 0; i < t.length; ++i) {
                  var n = 65533;
                  if (
                    (128 & t[i]
                      ? t.length >= i + 2 && 192 == (224 & t[i]) && 128 == (192 & t[i + 1])
                        ? ((n = ((31 & t[i]) << 6) | (63 & t[i + 1])), (i += 1))
                        : t.length >= i + 3 &&
                            224 == (240 & t[i]) &&
                            128 == (192 & t[i + 1]) &&
                            128 == (192 & t[i + 2])
                          ? ((n = ((15 & t[i]) << 12) | ((63 & t[i + 1]) << 6) | (63 & t[i + 2])), (i += 2))
                          : t.length >= i + 4 &&
                            240 == (241 & t[i]) &&
                            128 == (192 & t[i + 1]) &&
                            128 == (192 & t[i + 2]) &&
                            128 == (192 & t[i + 3]) &&
                            ((n =
                              ((7 & t[i]) << 18) |
                              ((63 & t[i + 1]) << 12) |
                              ((63 & t[i + 2]) << 6) |
                              (63 & t[i + 3])),
                            (i += 3))
                      : (n = t[i]),
                    n <= 65535)
                  )
                    r += String.fromCharCode(n);
                  else {
                    var a = 1023 & (n -= 65536);
                    ((r += String.fromCharCode(55296 + (n >> 10))), (r += String.fromCharCode(56320 + a)));
                  }
                }
                return r;
              }
              function Ye(e, t, r) {
                if (!e) return "";
                if (!r && e.byteLength % 2 != 0) throw new ze(2, 2, 2004);
                r = Math.floor(e.byteLength / 2);
                var i = new Uint16Array(r);
                e = Fe(e);
                for (var n = 0; n < r; n++) i[n] = e.getUint16(2 * n, t);
                return tt.value()(i);
              }
              function Qe(e) {
                function t(e) {
                  return r.byteLength <= e || (r[e] >= 9 && r[e] <= 126);
                }
                if (!e) return "";
                var r = Oe(e);
                if (239 == r[0] && 187 == r[1] && 191 == r[2]) return Xe(r);
                if (254 == r[0] && 255 == r[1]) return Ye(r.subarray(2), !1);
                if (255 == r[0] && 254 == r[1]) return Ye(r.subarray(2), !0);
                if (0 == r[0] && 0 == r[2]) return Ye(e, !1);
                if (0 == r[1] && 0 == r[3]) return Ye(e, !0);
                if (t(0) && t(1) && t(2) && t(3)) return Xe(e);
                throw new ze(2, 2, 2003);
              }
              function Je(t) {
                if (e.TextEncoder && !se().xh()) {
                  var r = new TextEncoder();
                  return Pe(r.encode(t));
                }
                ((t = encodeURIComponent(t)), (t = unescape(t)), (r = new Uint8Array(t.length)));
                for (var i = 0; i < t.length; i++) r[i] = t[i].charCodeAt(0);
                return Pe(r);
              }
              function Ze(e, t) {
                for (var r = new ArrayBuffer(2 * e.length), i = new DataView(r), n = 0; n < e.length; ++n)
                  i.setUint16(2 * n, e.charCodeAt(n), t);
                return r;
              }
              function et(e) {
                var t = {
                    "&amp;": "&",
                    "&lt;": "<",
                    "&gt;": ">",
                    "&quot;": '"',
                    "&apos;": "'",
                    "&nbsp;": "",
                    "&lrm;": "",
                    "&rlm;": "",
                  },
                  r = /&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,
                  i = RegExp(r.source);
                return e && i.test(e)
                  ? e.replace(r, function (e) {
                      return "#" == e[1]
                        ? (e =
                            "x" == e[2] || "X" == e[2]
                              ? parseInt(e.substring(3), 16)
                              : parseInt(e.substring(2), 10)) >= 0 && e <= 1114111
                          ? String.fromCodePoint(e)
                          : ""
                        : t[e] || "'";
                    })
                  : e || "";
              }
              ((ze.prototype.toString = function () {
                return "shaka.util.Error " + JSON.stringify(this, null, "  ");
              }),
                j("shaka.util.Error", ze),
                (ze.Severity = { RECOVERABLE: 1, CRITICAL: 2 }),
                (ze.Category = {
                  NETWORK: 1,
                  TEXT: 2,
                  MEDIA: 3,
                  MANIFEST: 4,
                  STREAMING: 5,
                  DRM: 6,
                  PLAYER: 7,
                  CAST: 8,
                  STORAGE: 9,
                  ADS: 10,
                }),
                (ze.Code = {
                  UNSUPPORTED_SCHEME: 1e3,
                  BAD_HTTP_STATUS: 1001,
                  HTTP_ERROR: 1002,
                  TIMEOUT: 1003,
                  MALFORMED_DATA_URI: 1004,
                  REQUEST_FILTER_ERROR: 1006,
                  RESPONSE_FILTER_ERROR: 1007,
                  MALFORMED_TEST_URI: 1008,
                  UNEXPECTED_TEST_REQUEST: 1009,
                  ATTEMPTS_EXHAUSTED: 1010,
                  SEGMENT_MISSING: 1011,
                  INVALID_TEXT_HEADER: 2e3,
                  INVALID_TEXT_CUE: 2001,
                  UNABLE_TO_DETECT_ENCODING: 2003,
                  BAD_ENCODING: 2004,
                  INVALID_XML: 2005,
                  INVALID_MP4_TTML: 2007,
                  INVALID_MP4_VTT: 2008,
                  UNABLE_TO_EXTRACT_CUE_START_TIME: 2009,
                  INVALID_MP4_CEA: 2010,
                  TEXT_COULD_NOT_GUESS_MIME_TYPE: 2011,
                  CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS: 2012,
                  TEXT_ONLY_WEBVTT_SRC_EQUALS: 2013,
                  MISSING_TEXT_PLUGIN: 2014,
                  UNSUPPORTED_EXTERNAL_THUMBNAILS_URI: 2017,
                  BUFFER_READ_OUT_OF_BOUNDS: 3e3,
                  JS_INTEGER_OVERFLOW: 3001,
                  EBML_OVERFLOW: 3002,
                  EBML_BAD_FLOATING_POINT_SIZE: 3003,
                  MP4_SIDX_WRONG_BOX_TYPE: 3004,
                  MP4_SIDX_INVALID_TIMESCALE: 3005,
                  MP4_SIDX_TYPE_NOT_SUPPORTED: 3006,
                  WEBM_CUES_ELEMENT_MISSING: 3007,
                  WEBM_EBML_HEADER_ELEMENT_MISSING: 3008,
                  WEBM_SEGMENT_ELEMENT_MISSING: 3009,
                  WEBM_INFO_ELEMENT_MISSING: 3010,
                  WEBM_DURATION_ELEMENT_MISSING: 3011,
                  WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING: 3012,
                  WEBM_CUE_TIME_ELEMENT_MISSING: 3013,
                  MEDIA_SOURCE_OPERATION_FAILED: 3014,
                  MEDIA_SOURCE_OPERATION_THREW: 3015,
                  VIDEO_ERROR: 3016,
                  QUOTA_EXCEEDED_ERROR: 3017,
                  TRANSMUXING_FAILED: 3018,
                  CONTENT_TRANSFORMATION_FAILED: 3019,
                  MSS_MISSING_DATA_FOR_TRANSMUXING: 3020,
                  MSS_TRANSMUXING_FAILED: 3022,
                  TRANSMUXING_NO_VIDEO_DATA: 3023,
                  STREAMING_NOT_ALLOWED: 3024,
                  UNABLE_TO_GUESS_MANIFEST_TYPE: 4e3,
                  DASH_INVALID_XML: 4001,
                  DASH_NO_SEGMENT_INFO: 4002,
                  DASH_EMPTY_ADAPTATION_SET: 4003,
                  DASH_EMPTY_PERIOD: 4004,
                  DASH_WEBM_MISSING_INIT: 4005,
                  DASH_UNSUPPORTED_CONTAINER: 4006,
                  DASH_PSSH_BAD_ENCODING: 4007,
                  DASH_NO_COMMON_KEY_SYSTEM: 4008,
                  DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED: 4009,
                  DASH_CONFLICTING_KEY_IDS: 4010,
                  RESTRICTIONS_CANNOT_BE_MET: 4012,
                  HLS_PLAYLIST_HEADER_MISSING: 4015,
                  INVALID_HLS_TAG: 4016,
                  HLS_INVALID_PLAYLIST_HIERARCHY: 4017,
                  DASH_DUPLICATE_REPRESENTATION_ID: 4018,
                  HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND: 4020,
                  HLS_REQUIRED_ATTRIBUTE_MISSING: 4023,
                  HLS_REQUIRED_TAG_MISSING: 4024,
                  HLS_COULD_NOT_GUESS_CODECS: 4025,
                  HLS_KEYFORMATS_NOT_SUPPORTED: 4026,
                  DASH_UNSUPPORTED_XLINK_ACTUATE: 4027,
                  DASH_XLINK_DEPTH_LIMIT: 4028,
                  CONTENT_UNSUPPORTED_BY_BROWSER: 4032,
                  CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM: 4033,
                  NO_VARIANTS: 4036,
                  PERIOD_FLATTENING_FAILED: 4037,
                  INCONSISTENT_DRM_ACROSS_PERIODS: 4038,
                  HLS_VARIABLE_NOT_FOUND: 4039,
                  HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED: 4040,
                  HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED: 4041,
                  NO_WEB_CRYPTO_API: 4042,
                  CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM: 4045,
                  MSS_INVALID_XML: 4046,
                  MSS_LIVE_CONTENT_NOT_SUPPORTED: 4047,
                  AES_128_INVALID_IV_LENGTH: 4048,
                  AES_128_INVALID_KEY_LENGTH: 4049,
                  DASH_CONFLICTING_AES_128: 4050,
                  DASH_UNSUPPORTED_AES_128: 4051,
                  DASH_INVALID_PATCH: 4052,
                  HLS_EMPTY_MEDIA_PLAYLIST: 4053,
                  DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED: 4054,
                  CANNOT_ADD_EXTERNAL_CHAPTERS_TO_LIVE_STREAM: 4055,
                  STREAMING_ENGINE_STARTUP_INVALID_STATE: 5006,
                  NO_RECOGNIZED_KEY_SYSTEMS: 6e3,
                  REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE: 6001,
                  FAILED_TO_CREATE_CDM: 6002,
                  FAILED_TO_ATTACH_TO_VIDEO: 6003,
                  INVALID_SERVER_CERTIFICATE: 6004,
                  FAILED_TO_CREATE_SESSION: 6005,
                  FAILED_TO_GENERATE_LICENSE_REQUEST: 6006,
                  LICENSE_REQUEST_FAILED: 6007,
                  LICENSE_RESPONSE_REJECTED: 6008,
                  ENCRYPTED_CONTENT_WITHOUT_DRM_INFO: 6010,
                  NO_LICENSE_SERVER_GIVEN: 6012,
                  OFFLINE_SESSION_REMOVED: 6013,
                  EXPIRED: 6014,
                  SERVER_CERTIFICATE_REQUIRED: 6015,
                  INIT_DATA_TRANSFORM_ERROR: 6016,
                  SERVER_CERTIFICATE_REQUEST_FAILED: 6017,
                  MIN_HDCP_VERSION_NOT_MATCH: 6018,
                  ERROR_CHECKING_HDCP_VERSION: 6019,
                  MISSING_EME_SUPPORT: 6020,
                  LOAD_INTERRUPTED: 7e3,
                  OPERATION_ABORTED: 7001,
                  NO_VIDEO_ELEMENT: 7002,
                  OBJECT_DESTROYED: 7003,
                  CONTENT_NOT_LOADED: 7004,
                  SRC_EQUALS_PRELOAD_NOT_SUPPORTED: 7005,
                  PRELOAD_DESTROYED: 7006,
                  QUEUE_INDEX_OUT_OF_BOUNDS: 7007,
                  CAST_API_UNAVAILABLE: 8e3,
                  NO_CAST_RECEIVERS: 8001,
                  ALREADY_CASTING: 8002,
                  UNEXPECTED_CAST_ERROR: 8003,
                  CAST_CANCELED_BY_USER: 8004,
                  CAST_CONNECTION_TIMED_OUT: 8005,
                  CAST_RECEIVER_APP_UNAVAILABLE: 8006,
                  STORAGE_NOT_SUPPORTED: 9e3,
                  INDEXED_DB_ERROR: 9001,
                  DEPRECATED_OPERATION_ABORTED: 9002,
                  REQUESTED_ITEM_NOT_FOUND: 9003,
                  MALFORMED_OFFLINE_URI: 9004,
                  CANNOT_STORE_LIVE_OFFLINE: 9005,
                  NO_INIT_DATA_FOR_OFFLINE: 9007,
                  LOCAL_PLAYER_INSTANCE_REQUIRED: 9008,
                  NEW_KEY_OPERATION_NOT_SUPPORTED: 9011,
                  KEY_NOT_FOUND: 9012,
                  MISSING_STORAGE_CELL: 9013,
                  STORAGE_LIMIT_REACHED: 9014,
                  DOWNLOAD_SIZE_CALLBACK_ERROR: 9015,
                  MODIFY_OPERATION_NOT_SUPPORTED: 9016,
                  INDEXED_DB_INIT_TIMED_OUT: 9017,
                  CS_IMA_SDK_MISSING: 1e4,
                  CS_AD_MANAGER_NOT_INITIALIZED: 10001,
                  SS_IMA_SDK_MISSING: 10002,
                  SS_AD_MANAGER_NOT_INITIALIZED: 10003,
                  CURRENT_DAI_REQUEST_NOT_FINISHED: 10004,
                  MT_AD_MANAGER_NOT_INITIALIZED: 10005,
                  INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED: 10006,
                  VAST_INVALID_XML: 10007,
                }),
                j("shaka.util.StringUtils", qe),
                (qe.resetFromCharCode = function () {
                  tt.g = void 0;
                }),
                (qe.toUTF16 = Ze),
                (qe.toUTF8 = Je),
                (qe.fromBytesAutoDetect = Qe),
                (qe.fromUTF16 = Ye),
                (qe.fromUTF8 = Xe));
              var tt = new ae(function () {
                function e(e) {
                  try {
                    var t = new Uint8Array(e);
                    return String.fromCharCode.apply(null, t).length > 0;
                  } catch (r) {
                    return !1;
                  }
                }
                for (var t = { Pc: 65536 }; t.Pc > 0; (t = { Pc: t.Pc }).Pc /= 2)
                  if (e(t.Pc))
                    return (function (e) {
                      return function (t) {
                        for (var r = "", i = 0; i < t.length; i += e.Pc)
                          r += String.fromCharCode.apply(null, t.subarray(i, i + e.Pc));
                        return r;
                      };
                    })(t);
                return null;
              });
              function rt() {}
              function it(e) {
                return (
                  (e = Oe(e)),
                  Uint8Array.prototype.toBase64
                    ? e.toBase64({ alphabet: "base64", omitPadding: !1 })
                    : ((e = tt.value()(e)), btoa(e))
                );
              }
              function nt(e, t) {
                return (
                  (t = null == t || t),
                  Uint8Array.prototype.toBase64
                    ? Oe(e).toBase64({ alphabet: "base64url", omitPadding: !t })
                    : ((e = it(e).replace(/\+/g, "-").replace(/\//g, "_")), t ? e : e.replace(/[=]*$/, ""))
                );
              }
              function at(t) {
                if (!("fromBase64" in Uint8Array)) {
                  t = e.atob(t.replace(/-/g, "+").replace(/_/g, "/"));
                  for (var r = new Uint8Array(t.length), i = 0; i < t.length; ++i) r[i] = t.charCodeAt(i);
                  return r;
                }
                return (
                  (t = t.replace(/\s+/g, "")),
                  Uint8Array.fromBase64(t, { alphabet: /[-_]/.test(t) ? "base64url" : "base64" })
                );
              }
              function st(t) {
                if (!("fromHex" in Uint8Array)) {
                  for (var r = t.length / 2, i = new Uint8Array(r), n = 0; n < r; n++)
                    i[n] = e.parseInt(t.substr(2 * n, 2), 16);
                  return i;
                }
                return Uint8Array.fromHex(t);
              }
              function ot(e) {
                var t = Oe(e);
                if (!Uint8Array.prototype.toHex) {
                  e = "";
                  for (var r = (t = g(t)).next(); !r.done; r = t.next())
                    (1 == (r = (r = r.value).toString(16)).length && (r = "0" + r), (e += r));
                  return e;
                }
                return t.toHex();
              }
              function lt() {
                for (var e = _.apply(0, arguments), t = 0, r = 0; r < e.length; ++r) t += e[r].byteLength;
                t = new Uint8Array(t);
                for (var i = (r = 0); i < e.length; ++i) {
                  var n = e[i];
                  (ArrayBuffer.isView(n) && 1 === n.BYTES_PER_ELEMENT ? t.set(n, r) : t.set(Oe(n), r),
                    (r += n.byteLength));
                }
                return t;
              }
              function ut(e, t, r) {
                if (((r = void 0 === r ? "" : r), 0 == t.length)) return e;
                if (1 == e.length && 1 == t.length) {
                  var i = new me(e[0]);
                  return ((t = new me(t[0])), (t = i.resolve(t)), r && be(t, r), [t.toString()]);
                }
                ((t = t.map(function (e) {
                  return new me(e);
                })),
                  (i = []));
                for (var n = (e = g(e)).next(); !n.done; n = e.next()) {
                  n = new me(n.value);
                  for (var a = g(t), s = a.next(); !s.done; s = a.next())
                    ((s = n.resolve(s.value)), r && be(s, r), i.push(s.toString()));
                }
                return i;
              }
              function dt(e, t, r, i, n) {
                return (
                  (t = {
                    keySystem: e,
                    encryptionScheme: t,
                    licenseServerUri: "",
                    distinctiveIdentifierRequired: !1,
                    persistentStateRequired: !1,
                    audioRobustness: "",
                    videoRobustness: "",
                    serverCertificate: null,
                    serverCertificateUri: "",
                    sessionType: "",
                    initData: r || [],
                    keyIds: new Set(),
                    mediaTypes: n,
                  }),
                  i && (t.keySystemUris = new Set([i])),
                  !r &&
                    Ge(e) &&
                    t.initData.push({ initDataType: "sinf", initData: new Uint8Array(0), keyId: null }),
                  t
                );
              }
              function ht(t, r) {
                r = void 0 === r ? "cenc" : r;
                var i = [],
                  n = [],
                  a = [];
                (t.forEach(function (e, t) {
                  var r = t;
                  22 != r.length && (r = nt(st(t), !1));
                  var s = e;
                  (22 != s.length && (s = nt(st(e), !1)),
                    (e = { kty: "oct", kid: r, k: s }),
                    i.push(e),
                    n.push(e.kid),
                    a.push(t));
                }),
                  (t = JSON.stringify({ keys: i })));
                var s = JSON.stringify({ kids: n });
                return (
                  (s = [{ initData: Oe(Je(s)), initDataType: "keyids" }]),
                  {
                    keySystem: "org.w3.clearkey",
                    encryptionScheme: r,
                    licenseServerUri: "data:application/json;base64," + e.btoa(t),
                    distinctiveIdentifierRequired: !1,
                    persistentStateRequired: !1,
                    audioRobustness: "",
                    videoRobustness: "",
                    serverCertificate: null,
                    serverCertificateUri: "",
                    sessionType: "",
                    initData: s,
                    keyIds: new Set(a),
                  }
                );
              }
              function ct(e, t) {
                if (1 == t.length) return t[0];
                if (null != (e = ft(e, t))) return e;
                throw new ze(2, 4, 4025, t);
              }
              function ft(e, t) {
                for (var r = yt.get(e), i = (r = g(r)).next(); !i.done; i = r.next()) {
                  i = i.value;
                  for (var n = g(t), a = n.next(); !a.done; a = n.next())
                    if (((a = a.value), i.test(a.trim()))) return a.trim();
                }
                return e == gt ? "" : null;
              }
              function pt(e, t) {
                for (var r = [], i = (e = g((e = yt.get(e)))).next(); !i.done; i = e.next()) {
                  i = i.value;
                  for (var n = g(t), a = n.next(); !a.done; a = n.next())
                    ((a = a.value), i.test(a.trim()) && r.push(a.trim()));
                }
                return r;
              }
              (j("shaka.util.Uint8ArrayUtils", rt),
                (rt.concat = lt),
                (rt.toHex = ot),
                (rt.fromHex = st),
                (rt.fromBase64 = at),
                (rt.toBase64 = nt),
                (rt.toStandardBase64 = it));
              var gt = "text",
                mt = { wa: "video", aa: "audio", Na: gt, Yf: "image", ul: "application" },
                vt = 1 / 15,
                yt = new Map()
                  .set("audio", [
                    /^vorbis$/,
                    /^Opus$/,
                    /^opus$/,
                    /^fLaC$/,
                    /^flac$/,
                    /^mp4a/,
                    /^[ae]c-3$/,
                    /^ac-4/,
                    /^dts[cex]$/,
                    /^iamf/,
                    /^mhm[12]/,
                    /^ac3$/,
                    /^eac3$/,
                    /^apac$/,
                  ])
                  .set("video", [
                    /^avc/,
                    /^hev/,
                    /^hvc/,
                    /^vvc/,
                    /^vvi/,
                    /^vp0?[89]/,
                    /^av01/,
                    /^dvh/,
                    /^dva/,
                    /^dav/,
                  ])
                  .set("text", [/^vtt$/, /^wvtt/, /^stpp/]);
              function Tt(e, t, r, i) {
                ((this.g = null), (this.l = e), (this.i = t), (this.m = r), (this.o = i), (this.j = !1));
                e: {
                  if (
                    ("undefined" == typeof libDPIModule &&
                      z("Could not find LCEVC Library dependencies on this page"),
                    "undefined" != typeof LCEVCdec)
                  )
                    this.h = LCEVCdec;
                  else {
                    if ("undefined" == typeof LcevcDil) {
                      (z("Could not find LCEVC Library on this page"), (e = !1));
                      break e;
                    }
                    ((this.h = LcevcDil),
                      (this.j = !0),
                      he("LcevcDil", "lcevc_dil.js is deprecated, please use lcevc_dec.js instead"));
                  }
                  void 0 === this.h.SupportObject
                    ? (z("Could not find LCEVC Library on this page"), (e = !1))
                    : (this.h.SupportObject.SupportStatus || z(this.h.SupportObject.SupportError),
                      (e =
                        void 0 !== this.h &&
                        "undefined" != typeof libDPIModule &&
                        this.i instanceof HTMLCanvasElement &&
                        this.h.SupportObject.SupportStatus));
                }
                e &&
                  !this.g &&
                  this.h.SupportObject.webGLSupport(this.i) &&
                  (this.i.classList.remove("shaka-hidden"),
                  (this.g = this.j
                    ? new this.h.LcevcDil(this.l, this.i, this.m)
                    : new this.h.LCEVCdec(this.l, this.i, this.m)));
              }
              function bt(e, t, r, i) {
                "video" !== i.type ||
                  (e.o && !i.baseOriginalId) ||
                  (e.g && e.g.appendBuffer(t, "video", i.id, -r, !e.o));
              }
              function St(e) {
                e.g && e.i.classList.add("shaka-hidden");
              }
              function Et(e) {
                return !(!e || "undefined" == typeof LCEVCdec) && "lvc1" == e.codecs;
              }
              function xt() {}
              function wt(e, t) {
                It.set(e, t);
              }
              function At(e, t) {
                if (t) {
                  var r = It.get(t.toLowerCase());
                  if (r) return r;
                }
                throw new ze(2, 4, 4e3, e, t);
              }
              ((Tt.prototype.release = function () {
                this.g && (this.g.close(), (this.g = null));
              }),
                j("shaka.lcevc.Dec", Tt),
                (Tt.prototype.release = Tt.prototype.release),
                j("shaka.media.ManifestParser", xt),
                (xt.unregisterParserByMime = function (e) {
                  It.delete(e);
                }),
                (xt.registerParserByMime = wt),
                (xt.registerParserByExtension = function () {
                  he(
                    "ManifestParser.registerParserByExtension",
                    "Please use an ManifestParser with registerParserByMime function.",
                  );
                }),
                (xt.AccessibilityPurpose = {
                  Cm: "visually impaired",
                  Nl: "hard of hearing",
                  jm: "spoken subtitles",
                }));
              var It = new Map();
              function kt() {}
              function Rt() {}
              function Ct() {}
              function Lt(e) {
                ((this.h = new Map()),
                  (this.i = 0),
                  (this.j = new Rt()),
                  (e = Dt(e.toLowerCase())) && (this.j = e()),
                  (this.g = new kt()),
                  (e = Pt) && ((this.g = e()), this.h.set(this.i, this.g)));
              }
              function Mt(e, t) {
                _t.set(e, t);
              }
              function Dt(e) {
                return _t.get(e);
              }
              ((kt.prototype.extract = function () {}),
                (kt.prototype.decode = function () {
                  return [];
                }),
                (kt.prototype.clear = function () {}),
                (kt.prototype.getStreams = function () {
                  return [];
                }),
                (Rt.prototype.init = function () {}),
                (Rt.prototype.parse = function () {
                  return [];
                }),
                ((n = Ct.prototype).init = function () {}),
                (n.Af = function () {}),
                (n.Pd = function () {}),
                (n.remove = function () {}),
                (n.Zf = function () {}),
                j("shaka.media.IClosedCaptionParser", Ct),
                ((n = Lt.prototype).init = function (e, t, r) {
                  if (((t = void 0 !== t && t), -1 != (r = void 0 === r ? -1 : r) && this.i != r)) {
                    t = r;
                    var i = this.h.get(t);
                    (this.h.set(this.i, this.g),
                      i ? (this.g = i) : ((i = Pt) && (this.g = i()), this.h.set(t, this.g)));
                  } else t || this.Pd();
                  (this.j.init(e), -1 != r && (this.i = r));
                }),
                (n.Af = function (e) {
                  for (var t = (e = g((e = this.j.parse(e)))).next(); !t.done; t = e.next()) {
                    var r = Oe((t = t.value).packet);
                    r.length > 0 && this.g.extract(r, t.pts);
                  }
                  return this.g.decode();
                }),
                (n.Pd = function () {
                  this.g.clear();
                }),
                (n.remove = function (e) {
                  ((e = void 0 === e ? [] : e), (e = new Set(e)));
                  for (var t = g(this.h.keys()), r = t.next(); !r.done; r = t.next())
                    if (((r = r.value), !e.has(r))) {
                      var i = this.h.get(r);
                      (i && i.clear(), this.h.delete(r));
                    }
                }),
                (n.Zf = function () {
                  return this.g.getStreams();
                }),
                j("shaka.media.ClosedCaptionParser", Lt),
                (Lt.findDecoder = function () {
                  return Pt;
                }),
                (Lt.unregisterDecoder = function () {
                  Pt = null;
                }),
                (Lt.registerDecoder = function (e) {
                  Pt = e;
                }),
                (Lt.findParser = Dt),
                (Lt.unregisterParser = function (e) {
                  _t.delete(e);
                }),
                (Lt.registerParser = Mt));
              var _t = new Map(),
                Pt = null;
              function Ot() {
                ((this.id = ""),
                  (this.regionAnchorY = this.regionAnchorX = this.viewportAnchorY = this.viewportAnchorX = 0),
                  (this.height = this.width = 100),
                  (this.viewportAnchorUnits = this.widthUnits = this.heightUnits = Nt),
                  (this.scroll = Ft));
              }
              j("shaka.text.CueRegion", Ot);
              var Nt = 1;
              Ot.units = { PX: 0, PERCENTAGE: Nt, LINES: 2 };
              var Ft = "";
              function Ut(e) {
                ((this.h = e || ""), (this.g = 0));
              }
              function Bt(e) {
                $t(e, /[ \t]+/gm);
              }
              function $t(e, t) {
                return (
                  (t.lastIndex = e.g),
                  (t =
                    null == (t = t.exec(e.h))
                      ? null
                      : { position: t.index, length: t[0].length, results: t }),
                  e.g == e.h.length || null == t || t.position != e.g ? null : ((e.g += t.length), t.results)
                );
              }
              function jt(e) {
                return e.g == e.h.length ? null : (e = $t(e, /[^ \t\n]*/gm)) ? e[0] : null;
              }
              function Gt(e) {
                if (null == (e = $t(e, Ht))) return null;
                var t = Number(e[2]),
                  r = Number(e[3]);
                return t > 59 || r > 59
                  ? null
                  : (Number(e[6]) || 0) / 1e3 + r + 60 * t + 3600 * (Number(e[1]) || 0);
              }
              function Vt(e) {
                return e ? Gt(new Ut(e)) : null;
              }
              Ot.scrollMode = { NONE: Ft, UP: "up" };
              var Ht = /(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;
              function Kt() {}
              function Wt(e) {
                var t = new WeakSet();
                return (function e(r) {
                  switch (typeof r) {
                    case "undefined":
                    case "boolean":
                    case "number":
                    case "string":
                    case "symbol":
                    case "function":
                      return r;
                    default:
                      if (!r || ArrayBuffer.isView(r)) return r;
                      if (t.has(r)) return null;
                      var i = Array.isArray(r);
                      if (r.constructor != Object && !i) return null;
                      t.add(r);
                      var n,
                        a = i ? [] : {};
                      for (n in r) a[n] = e(r[n]);
                      return (i && (a.length = r.length), a);
                  }
                })(e);
              }
              function zt(e) {
                var t,
                  r = {};
                for (t in e) r[t] = e[t];
                return r;
              }
              function qt(e) {
                if (Array.isArray(e)) {
                  for (var t = [], r = 0; r < e.length; r++) {
                    var i = r.toString(),
                      n = e[r];
                    void 0 !== n && (n = qt(n)) && t.push(i + ":" + n);
                  }
                  e = "[" + t.join(",") + "]";
                } else if ("function" == typeof e) e = "";
                else if (e instanceof Object) {
                  for ((r = Object.keys(e)).sort(), t = [], i = (r = g(r)).next(); !i.done; i = r.next())
                    ((n = i.value),
                      (i = JSON.stringify(n)),
                      void 0 !== (n = e[n]) && (n = qt(n)) && t.push(i + ":" + n));
                  e = "{" + t.join(",") + "}";
                } else e = JSON.stringify(e);
                return e;
              }
              /*
      		 @license
      		 tXml
      		 Copyright 2015 Tobias Nickel
      		 SPDX-License-Identifier: MIT
      		*/
              function Xt(e, t) {
                var r = void 0 !== r && r;
                return Yt((e = Qe(e)), t, r);
              }
              function Yt(e, t, r) {
                return (
                  (e = (function (e, t) {
                    function r(a, s) {
                      s = void 0 !== s && s;
                      for (var o = []; e[n]; )
                        if (60 == e.charCodeAt(n)) {
                          if (47 === e.charCodeAt(n + 1)) {
                            ((s = n + 2), (n = e.indexOf(">", n)));
                            var l = (s = e.substring(s, n)).indexOf(a);
                            if (-1 == l) {
                              var u = a.indexOf(".");
                              u > 0 && (l = s.indexOf(a.substring(0, u)));
                            }
                            if (-1 == l)
                              throw (
                                (a = e.substring(0, n).split("\n")),
                                Error(
                                  "Unexpected close tag\nLine: " +
                                    (a.length - 1) +
                                    "\nColumn: " +
                                    (a[a.length - 1].length + 1) +
                                    "\nChar: " +
                                    e[n],
                                )
                              );
                            n + 1 && (n += 1);
                            break;
                          }
                          if (33 === e.charCodeAt(n + 1)) {
                            if (45 == e.charCodeAt(n + 2)) {
                              for (
                                ;
                                -1 !== n &&
                                (62 !== e.charCodeAt(n) ||
                                  45 != e.charCodeAt(n - 1) ||
                                  45 != e.charCodeAt(n - 2) ||
                                  -1 == n);
                              )
                                n = e.indexOf(">", n + 1);
                              -1 === n && (n = e.length);
                            } else if (
                              91 === e.charCodeAt(n + 2) &&
                              91 === e.charCodeAt(n + 8) &&
                              "cdata" === e.substr(n + 3, 5).toLowerCase()
                            ) {
                              -1 == (l = e.indexOf("]]>", n))
                                ? (o.push(e.substr(n + 9)), (n = e.length))
                                : (o.push(e.substring(n + 9, l)), (n = l + 3));
                              continue;
                            }
                            n++;
                            continue;
                          }
                          e: {
                            ((u = s), n++);
                            var d = i(),
                              h = {};
                            for (l = []; 62 !== e.charCodeAt(n) && e[n]; ) {
                              var c = e.charCodeAt(n);
                              if ((c > 64 && c < 91) || (c > 96 && c < 123)) {
                                c = i();
                                for (
                                  var f = e.charCodeAt(n);
                                  f &&
                                  39 !== f &&
                                  34 !== f &&
                                  !((f > 64 && f < 91) || (f > 96 && f < 123)) &&
                                  62 !== f;
                                )
                                  (n++, (f = e.charCodeAt(n)));
                                var p = n + 1;
                                if (
                                  ((n = e.indexOf(e[n], p)),
                                  (p = (" " + e.slice(p, n)).slice(1)),
                                  39 === f || 34 === f)
                                ) {
                                  if (-1 === n) {
                                    if (((u = { tagName: d, attributes: h, children: l, parent: null }), t))
                                      for (d = 0; d < l.length; d++)
                                        "string" != typeof l[d] && (l[d].parent = u);
                                    l = u;
                                    break e;
                                  }
                                } else ((p = null), n--);
                                if (c.startsWith("xmlns:")) {
                                  f = p;
                                  var g = c.split(":")[1];
                                  (Ar.set(f, g), Ir.set(g, f));
                                }
                                ("tt" === d && "xml:space" === c && "preserve" === p && (u = !0), (h[c] = p));
                              }
                              n++;
                            }
                            for (
                              47 !== e.charCodeAt(n - 1) ? (n++, (l = r(d, u))) : n++,
                                u = { tagName: d, attributes: h, children: l, parent: null },
                                d = l.length,
                                h = 0;
                              h < d;
                              h++
                            )
                              "string" != typeof (c = l[h])
                                ? t && (c.parent = u)
                                : h == d - 1 && "\n" == c && l.pop();
                            l = u;
                          }
                          if ((o.push(l), "string" == typeof l)) break;
                          "?" === l.tagName[0] &&
                            l.children &&
                            (o.push.apply(o, m(l.children)), (l.children = []));
                        } else
                          ((l = n),
                            -2 == (n = e.indexOf("<", n) - 1) && (n = e.length),
                            (l = (" " + e.slice(l, n + 1)).slice(1)),
                            s
                              ? l.length > 0 && o.push(l)
                              : ((o.length && 1 == l.length && "\n" == l[0]) || l.trim().length > 0) &&
                                o.push(l),
                            n++);
                      return o;
                    }
                    function i() {
                      for (var t = n; -1 === "\r\n\t>/= ".indexOf(e[n]) && e[n]; ) n++;
                      return (" " + e.slice(t, n)).slice(1);
                    }
                    var n = 0;
                    return r("");
                  })(e, void 0 !== r && r)),
                  !t && e.length
                    ? e[0]
                    : (e = e.find(function (e) {
                          return t.split(",").includes(e.tagName);
                        }))
                      ? e
                      : null
                );
              }
              function Qt(e) {
                return Ar.has(e) ? Ar.get(e) : "";
              }
              function Jt(e) {
                return "string" == typeof e;
              }
              function Zt(e) {
                var t = [];
                if (!e.children) return [];
                for (var r = (e = g(e.children)).next(); !r.done; r = e.next())
                  "string" != typeof (r = r.value) && t.push(r);
                return t;
              }
              function er(e, t) {
                var r = [];
                if (!e.children) return [];
                for (var i = (e = g(e.children)).next(); !i.done; i = e.next())
                  (i = i.value).tagName === t && r.push(i);
                return r;
              }
              function tr(e) {
                return "string" == typeof e
                  ? et(e)
                  : "" ===
                      (e = e.children.reduce(function (e, t) {
                        return "string" == typeof t ? e + t : e;
                      }, ""))
                    ? null
                    : et(e);
              }
              function rr(e) {
                return Array.from(e.children).every(function (e) {
                  return "string" == typeof e;
                })
                  ? ((e = tr(e)) && (e = e.trim()), e)
                  : null;
              }
              function ir(e, t, r) {
                if (((r = void 0 === r ? [] : r), e.tagName === t && r.push(e), e.children))
                  for (var i = (e = g(e.children)).next(); !i.done; i = e.next()) ir(i.value, t, r);
                return r;
              }
              function nr(e, t) {
                return 1 != (e = er(e, t)).length ? null : e[0];
              }
              function ar(e, t, r) {
                return 1 != (e = lr(e, t, r)).length ? null : e[0];
              }
              function sr(e, t, r, i) {
                i = void 0 === i ? null : i;
                var n = null;
                return (null != (e = e.attributes[t]) && (n = r(e)), null == n ? i : n);
              }
              function or(e, t, r) {
                return ((t = Qt(t)), e.attributes[t + ":" + r] || null);
              }
              function lr(e, t, r) {
                var i = Qt(t);
                if (((t = []), e.children))
                  for (r = i ? i + ":" + r : r, i = (e = g(e.children)).next(); !i.done; i = e.next())
                    (i = i.value) && i.tagName === r && t.push(i);
                return t;
              }
              function ur(e, t, r) {
                for (var i = (t = g(t)).next(); !i.done; i = t.next()) if ((i = or(e, i.value, r))) return i;
                return null;
              }
              function dr(e) {
                return e
                  ? (/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e) && (e += "Z"),
                    (e = Date.parse(e)),
                    isNaN(e) ? null : e / 1e3)
                  : null;
              }
              function hr(e) {
                return e &&
                  (e = RegExp(
                    "^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$",
                    "i",
                  ).exec(e))
                  ? ((e =
                      31536e3 * Number(e[1] || null) +
                      2592e3 * Number(e[2] || null) +
                      86400 * Number(e[3] || null) +
                      3600 * Number(e[4] || null) +
                      60 * Number(e[5] || null) +
                      Number(e[6] || null)),
                    isFinite(e) ? e : null)
                  : null;
              }
              function cr(e) {
                var t = /([0-9]+)-([0-9]+)/.exec(e);
                return t
                  ? ((e = Number(t[1])),
                    isFinite(e) ? ((t = Number(t[2])), isFinite(t) ? { start: e, end: t } : null) : null)
                  : null;
              }
              function fr(e) {
                return (e = Number(e)) % 1 == 0 ? e : null;
              }
              function pr(e) {
                return (e = Number(e)) % 1 == 0 && e > 0 ? e : null;
              }
              function gr(e) {
                return (e = Number(e)) % 1 == 0 && e >= 0 ? e : null;
              }
              function mr(e) {
                return ((e = Number(e)), isNaN(e) ? null : e);
              }
              function vr(e) {
                return !!e && "true" === e.toLowerCase();
              }
              function yr(e) {
                var t,
                  r = (t = e.match(/^(\d+)\/(\d+)$/)) ? Number(t[1]) / Number(t[2]) : Number(e);
                return isNaN(r) ? null : r;
              }
              function Tr(e) {
                for (
                  var t = [],
                    r = (e = g((e = et(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/)))).next();
                  !r.done;
                  r = e.next()
                ) {
                  var i = (r = r.value).match(/^([\w]+)/);
                  if (i) {
                    var n = r.match(/(@id='(.*?)')/),
                      a = r.match(/(@t='(\d+)')/),
                      s = r.match(/(@n='(\d+)')/),
                      o = r.match(/\[(\d+)\]/);
                    t.push({
                      name: i[0],
                      id: n ? n[0].match(/'(.*?)'/)[0].replace(/'/gm, "") : null,
                      t: a ? Number(a[0].match(/'(.*?)'/)[0].replace(/'/gm, "")) : null,
                      n: s ? Number(s[0].match(/'(.*?)'/)[0].replace(/'/gm, "")) : null,
                      position: o ? Number(o[1]) - 1 : null,
                      Dc: r.split("/@")[1] || null,
                    });
                  } else r.startsWith("@") && t.length && (t[t.length - 1].Dc = r.slice(1));
                }
                return t;
              }
              function br(e, t) {
                var r = Tr(t.attributes.sel || "");
                if (r.length) {
                  var i = r[r.length - 1],
                    n = t.attributes.pos || null;
                  (null == (r = i.position) &&
                    (null !== i.t && (r = Sr(e, "t", i.t)), null !== i.n && (r = Sr(e, "n", i.n))),
                    null === r
                      ? (r = "prepend" === n ? 0 : e.length)
                      : "prepend" === n
                        ? --r
                        : "after" === n && ++r,
                    (n = t.tagName),
                    (i = i.Dc) && e[r]
                      ? Er(e[r], n, i, rr(t) || "")
                      : (("remove" !== n && "replace" !== n) || e.splice(r, 1),
                        ("add" !== n && "replace" !== n) || e.splice.apply(e, [r, 0].concat(m(t.children)))));
                }
              }
              function Sr(e, t, r) {
                for (var i = 0, n = (e = g(e)).next(); !n.done; n = e.next()) {
                  if (Number(n.value.attributes[t]) === r) return i;
                  i++;
                }
                return null;
              }
              function Er(e, t, r, i) {
                "remove" === t
                  ? delete e.attributes[r]
                  : ("add" !== t && "replace" !== t) || (e.attributes[r] = i);
              }
              function xr(e) {
                var t = "",
                  r = e.tagName.split(":");
                for (var i in (r.length > 0 && ((t = r[0]), (t = Ir.has(t) ? Ir.get(t) : "")),
                (t = document.createElementNS(t, e.tagName)),
                e.attributes))
                  t.setAttribute(i, e.attributes[i]);
                for (i = (e = g(e.children)).next(); !i.done; i = e.next())
                  ((r = void 0),
                    (r = "string" == typeof (i = i.value) ? new Text(i) : xr(i)),
                    t.appendChild(r));
                return t;
              }
              function wr(e) {
                if (!e) return null;
                for (
                  var t = { tagName: e.tagName, attributes: zt(e.attributes), children: [], parent: null },
                    r = (e = g(e.children)).next();
                  !r.done;
                  r = e.next()
                )
                  ("string" == typeof (r = r.value) || ((r = wr(r)).parent = t), t.children.push(r));
                return t;
              }
              (j("shaka.util.ObjectUtils", Kt),
                (Kt.alphabeticalKeyOrderStringify = qt),
                (Kt.shallowCloneObject = zt),
                (Kt.cloneObject = Wt));
              var Ar = new Map(),
                Ir = new Map();
              function kr(e, t, r) {
                ((this.startTime = e),
                  (this.endTime = t),
                  (this.payload = r),
                  (this.region = new Ot()),
                  (this.position = null),
                  (this.positionAlign = Pr),
                  (this.size = 0),
                  (this.textAlign = Or),
                  (this.direction = Br),
                  (this.writingMode = $r),
                  (this.lineInterpretation = jr),
                  (this.line = null),
                  (this.lineHeight = ""),
                  (this.lineAlign = Gr),
                  (this.displayAlign = Fr),
                  (this.fontSize =
                    this.border =
                    this.backgroundImage =
                    this.backgroundColor =
                    this.color =
                      ""),
                  (this.fontWeight = Wr),
                  (this.fontStyle = qr),
                  (this.linePadding = this.letterSpacing = this.fontFamily = ""),
                  (this.opacity = 1),
                  (this.textCombineUpright = ""),
                  (this.textDecoration = []),
                  (this.textStrokeWidth = this.textStrokeColor = this.textShadow = ""),
                  (this.wrapLine = !0),
                  (this.id = ""),
                  (this.nestedCues = []),
                  (this.lineBreak = this.isContainer = !1),
                  (this.rubyTag = null),
                  (this.cellResolution = { columns: 32, rows: 15 }));
              }
              function Rr(e, t) {
                return (((e = new kr(e, t, "")).lineBreak = !0), e);
              }
              function Cr(e, t) {
                if (
                  e.payload != t.payload ||
                  !(Math.abs(e.startTime - t.startTime) < 0.001 && Math.abs(e.endTime - t.endTime) < 0.001)
                )
                  return !1;
                for (var r in e)
                  if ("startTime" != r && "endTime" != r && "payload" != r)
                    if ("nestedCues" == r) {
                      if (!ee(e.nestedCues, t.nestedCues, Cr)) return !1;
                    } else if ("region" == r || "cellResolution" == r) {
                      for (var i in e[r]) if (e[r][i] != t[r][i]) return !1;
                    } else if (Array.isArray(e[r])) {
                      if (!ee(e[r], t[r])) return !1;
                    } else if (e[r] != t[r]) return !1;
                return !0;
              }
              function Lr(e, t) {
                t = void 0 === t ? new Map() : t;
                var r = e.payload;
                if (r.includes("<")) {
                  0 === t.size && Mr(t);
                  var i = r;
                  r = [];
                  for (var n = -1, a = 0; a < i.length; a++)
                    "<" === i[a]
                      ? (n = a + 1)
                      : ">" === i[a] && n > 0 && ((n = i.substr(n, a - n)).match(Jr) && r.push(n), (n = -1));
                  for (a = (r = g(r)).next(); !a.done; a = r.next())
                    ((a = a.value),
                      (i = i.replace("<" + a + ">", '<div time="' + a + '">')),
                      (i += "</div>"));
                  e: {
                    ((a = i), (n = []));
                    var s = -1;
                    ((r = ""), (i = !1));
                    for (var o = 0; o < a.length; o++)
                      if ("/" === a[o]) {
                        var l = a.indexOf(">", o);
                        if (-1 === l) {
                          r = a;
                          break e;
                        }
                        if ((l = a.substring(o + 1, l)) && "v" == l) {
                          i = !0;
                          var u = null;
                          if ((n.length && (u = n[n.length - 1]), u)) {
                            if (u === l) r += "/" + l + ">";
                            else {
                              if (!u.startsWith("v")) {
                                r += a[o];
                                continue;
                              }
                              r += "/" + u + ">";
                            }
                            o += l.length + 1;
                          } else r += a[o];
                        } else r += a[o];
                      } else
                        ("<" === a[o]
                          ? "v" != a[(s = o + 1)] && (s = -1)
                          : ">" === a[o] && s > 0 && (n.push(a.substr(s, o - s)), (s = -1)),
                          (r += a[o]));
                    for (n = (a = g(n)).next(); !n.done; n = a.next())
                      ((s = (n = n.value).replace(" ", ".voice-")),
                        (r = (r = r.replace("<" + n + ">", "<" + s + ">")).replace(
                          "</" + n + ">",
                          "</" + s + ">",
                        )),
                        i || (r += "</" + s + ">"));
                  }
                  ((r = (function (e) {
                    var t = { "< ": "", " >": " &gt;" },
                      r = /(< +>|<\s|\s>)/g,
                      i = RegExp(r.source);
                    return e && i.test(e)
                      ? e.replace(r, function (e) {
                          return t[e] || "";
                        })
                      : e || "";
                  })(r)),
                    (e.payload = ""),
                    (i = "<span>" + r.replace(/\n/g, "<br />") + "</span>"));
                  try {
                    var d = Yt(i, "span");
                  } catch (h) {}
                  if (d)
                    if (1 != (d = d.children).length || d[0].tagName)
                      for (r = (d = g(d)).next(); !r.done; r = d.next()) Dr(r.value, e, t);
                    else e.payload = et(r);
                  else e.payload = et(r);
                } else e.payload = et(r);
              }
              function Mr(e) {
                for (var t = g(Object.entries(Hr)), r = t.next(); !r.done; r = t.next()) {
                  var i = g(r.value);
                  ((r = i.next().value), (i = i.next().value));
                  var n = new kr(0, 0, "");
                  ((n.color = i), e.set("." + r, n));
                }
                for (r = (t = g(Object.entries(Kr))).next(); !r.done; r = t.next())
                  ((r = (i = g(r.value)).next().value),
                    (i = i.next().value),
                    ((n = new kr(0, 0, "")).backgroundColor = i),
                    e.set("." + r, n));
              }
              function Dr(e, t, r) {
                var i = t.clone();
                if (
                  ((i.nestedCues = []),
                  (i.payload = ""),
                  (i.rubyTag = ""),
                  (i.line = null),
                  (i.region = new Ot()),
                  (i.position = null),
                  (i.size = 0),
                  (i.textAlign = Or),
                  e.tagName)
                )
                  for (var n = g(e.tagName.split(/(?=[ .])+/g)), a = n.next(); !a.done; a = n.next()) {
                    var s = (a = a.value);
                    if (s.startsWith(".voice-")) {
                      var o = s.split("-").pop();
                      ((s = 'v[voice="' + o + '"]'), r.has(s) || (s = "v[voice=" + o + "]"));
                    }
                    switch (
                      (r.has(s) &&
                        ((o = i), (s = r.get(s))) &&
                        ((o.backgroundColor = _r(s.backgroundColor, o.backgroundColor)),
                        (o.color = _r(s.color, o.color)),
                        (o.fontFamily = _r(s.fontFamily, o.fontFamily)),
                        (o.fontSize = _r(s.fontSize, o.fontSize)),
                        (o.textShadow = _r(s.textShadow, o.textShadow)),
                        (o.fontWeight = s.fontWeight),
                        (o.fontStyle = s.fontStyle),
                        (o.opacity = s.opacity),
                        (o.rubyTag = s.rubyTag),
                        (o.textCombineUpright = s.textCombineUpright),
                        (o.wrapLine = s.wrapLine)),
                      a)
                    ) {
                      case "br":
                        return ((i = Rr(i.startTime, i.endTime)), void t.nestedCues.push(i));
                      case "b":
                        i.fontWeight = zr;
                        break;
                      case "i":
                        i.fontStyle = Xr;
                        break;
                      case "u":
                        i.textDecoration.push(Qr);
                        break;
                      case "font":
                        (a = e.attributes.color) && (i.color = a);
                        break;
                      case "div":
                        if (!(a = e.attributes.time)) break;
                        (a = Vt(a)) && (i.startTime = a);
                        break;
                      case "ruby":
                      case "rp":
                      case "rt":
                        i.rubyTag = a;
                    }
                  }
                if (((n = e.children), Jt(e) || (1 == n.length && Jt(n[0]))))
                  for (r = tr(e).split("\n"), e = !0, n = (r = g(r)).next(); !n.done; n = r.next())
                    ((n = n.value),
                      e || ((e = Rr(i.startTime, i.endTime)), t.nestedCues.push(e)),
                      n.length > 0 && (((e = i.clone()).payload = et(n)), t.nestedCues.push(e)),
                      (e = !1));
                else
                  for (t.nestedCues.push(i), e = (t = g(n)).next(); !e.done; e = t.next()) Dr(e.value, i, r);
              }
              function _r(e, t) {
                return e && e.length > 0 ? e : t;
              }
              ((kr.prototype.clone = function () {
                var e,
                  t = new kr(0, 0, "");
                for (e in this) ((t[e] = this[e]), Array.isArray(t[e]) && (t[e] = t[e].slice()));
                return t;
              }),
                j("shaka.text.Cue", kr),
                (kr.parseCuePayload = Lr),
                (kr.equal = Cr),
                (kr.prototype.clone = kr.prototype.clone));
              var Pr = "auto";
              kr.positionAlign = { LEFT: "line-left", RIGHT: "line-right", CENTER: "center", AUTO: Pr };
              var Or = "center",
                Nr = { LEFT: "left", RIGHT: "right", CENTER: Or, START: "start", END: "end" };
              kr.textAlign = Nr;
              var Fr = "after",
                Ur = { BEFORE: "before", CENTER: "center", AFTER: Fr };
              kr.displayAlign = Ur;
              var Br = "ltr";
              kr.direction = { HORIZONTAL_LEFT_TO_RIGHT: Br, HORIZONTAL_RIGHT_TO_LEFT: "rtl" };
              var $r = "horizontal-tb";
              kr.writingMode = {
                HORIZONTAL_TOP_TO_BOTTOM: $r,
                VERTICAL_LEFT_TO_RIGHT: "vertical-lr",
                VERTICAL_RIGHT_TO_LEFT: "vertical-rl",
              };
              var jr = 0;
              kr.lineInterpretation = { LINE_NUMBER: jr, PERCENTAGE: 1 };
              var Gr = "start",
                Vr = { CENTER: "center", START: Gr, END: "end" };
              kr.lineAlign = Vr;
              var Hr = {
                white: "white",
                lime: "lime",
                cyan: "cyan",
                red: "red",
                yellow: "yellow",
                magenta: "magenta",
                blue: "blue",
                black: "black",
              };
              kr.defaultTextColor = Hr;
              var Kr = {
                bg_white: "white",
                bg_lime: "lime",
                bg_cyan: "cyan",
                bg_red: "red",
                bg_yellow: "yellow",
                bg_magenta: "magenta",
                bg_blue: "blue",
                bg_black: "black",
              };
              kr.defaultTextBackgroundColor = Kr;
              var Wr = 400,
                zr = 700;
              kr.fontWeight = { NORMAL: Wr, BOLD: zr };
              var qr = "normal",
                Xr = "italic",
                Yr = { NORMAL: qr, ITALIC: Xr, OBLIQUE: "oblique" };
              kr.fontStyle = Yr;
              var Qr = "underline";
              kr.textDecoration = { UNDERLINE: Qr, LINE_THROUGH: "lineThrough", OVERLINE: "overline" };
              var Jr = /(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;
              function Zr() {}
              function ei(e, t, r) {
                ri.set(e.toLowerCase().split(";")[0] + "-" + r, { priority: r, Bf: t });
              }
              function ti(e, t) {
                for (
                  var r = e.toLowerCase().split(";")[0], i = g([si, ai, ni, ii]), n = i.next();
                  !n.done;
                  n = i.next()
                )
                  if ((n = ri.get(r + "-" + n.value))) {
                    var a = n.Bf(),
                      s = a.isSupported(e, t);
                    if ((a.destroy(), s)) return n.Bf;
                  }
                return null;
              }
              ((Zr.prototype.destroy = function () {}),
                j("shaka.transmuxer.TransmuxerEngine", Zr),
                (Zr.findTransmuxer = ti),
                (Zr.unregisterTransmuxer = function (e, t) {
                  ri.delete(e.toLowerCase().split(";")[0] + "-" + t);
                }),
                (Zr.registerTransmuxer = ei),
                (Zr.prototype.destroy = Zr.prototype.destroy));
              var ri = new Map(),
                ii = 1,
                ni = 2,
                ai = 3,
                si = 4;
              function oi() {}
              function li(e, t) {
                var r = e;
                return (t && !yi.includes(e) && (r += '; codecs="' + t + '"'), r);
              }
              function ui(e, t) {
                return (t && (e += '; codecs="' + t + '"'), e);
              }
              function di(e, t, r) {
                var i = li(e, t);
                return (
                  ti((t = ui(e, t)))
                    ? (e = ti(t))
                      ? ((r = (e = e()).convertCodecs(r, t)), e.destroy())
                      : (r = t)
                    : (r = "video/mp2t" != e && "audio" == r ? i.replace("video", "audio") : i),
                  r
                );
              }
              function hi(e) {
                return e.split(";")[0].split("/")[1];
              }
              function ci(e) {
                var t = vi(e);
                switch (((e = t[0].toLowerCase()), (t = t[1].toLowerCase()), !0)) {
                  case "mp4a" === e && "69" === t:
                  case "mp4a" === e && "6b" === t:
                  case "mp4a" === e && "40.34" === t:
                    return "mp3";
                  case "mp4a" === e && "66" === t:
                  case "mp4a" === e && "67" === t:
                  case "mp4a" === e && "68" === t:
                  case "mp4a" === e && "40.2" === t:
                  case "mp4a" === e && "40.02" === t:
                  case "mp4a" === e && "40.5" === t:
                  case "mp4a" === e && "40.05" === t:
                  case "mp4a" === e && "40.29" === t:
                  case "mp4a" === e && "40.42" === t:
                    return "aac";
                  case "mp4a" === e && "a5" === t:
                  case "ac3" === e:
                  case "ac-3" === e:
                    return "ac-3";
                  case "mp4a" === e && "a6" === t:
                  case "eac3" === e:
                  case "ec-3" === e:
                    return "ec-3";
                  case "ac-4" === e:
                    return "ac-4";
                  case "mp4a" === e && "b2" === t:
                    return "dtsx";
                  case "mp4a" === e && "a9" === t:
                    return "dtsc";
                  case "vp09" === e:
                  case "vp9" === e:
                    return "vp9";
                  case "avc1" === e:
                  case "avc3" === e:
                    return "avc";
                  case "hvc1" === e:
                  case "hev1" === e:
                    return "hevc";
                  case "vvc1" === e:
                  case "vvi1" === e:
                    return "vvc";
                  case "dvh1" === e:
                  case "dvhe" === e:
                    return t && t.startsWith("05") ? "dovi-p5" : "dovi-hevc";
                  case "dvav" === e:
                  case "dva1" === e:
                    return "dovi-avc";
                  case "dav1" === e:
                    return "dovi-av1";
                  case "dvc1" === e:
                  case "dvi1" === e:
                    return "dovi-vvc";
                  case "lvc1" === e:
                    return "lcevc";
                }
                return e;
              }
              function fi(e) {
                for (var t = [], r = (e = g(e.split(","))).next(); !r.done; r = e.next())
                  ((r = vi(r.value)), t.push(r[0]));
                return t.sort().join(",");
              }
              function pi(e) {
                return e.split(";")[0];
              }
              function gi(e) {
                return (
                  (e = e.split(/ *; */)).shift(),
                  (e = e.find(function (e) {
                    return e.startsWith("codecs=");
                  }))
                    ? e.split("=")[1].replace(/^"|"$/g, "")
                    : ""
                );
              }
              function mi(e) {
                return "application/x-mpegurl" === e || "application/vnd.apple.mpegurl" === e;
              }
              function vi(e) {
                var t = (e = e.split("."))[0];
                return (e.shift(), [t, e.join(".")]);
              }
              ((Zr.PluginPriority = {
                FALLBACK: ii,
                PREFERRED_SECONDARY: ni,
                PREFERRED: ai,
                APPLICATION: si,
              }),
                j("shaka.util.MimeUtils", oi),
                (oi.getFullTypeWithAllCodecs = ui),
                (oi.getFullType = li),
                new Map()
                  .set("codecs", "codecs")
                  .set("frameRate", "framerate")
                  .set("bandwidth", "bitrate")
                  .set("width", "width")
                  .set("height", "height")
                  .set("channelsCount", "channels"));
              var yi = ["audio/aac", "audio/ac3", "audio/ec3", "audio/mpeg"];
              function Ti(e) {
                ((this.i = null),
                  (this.l = e),
                  (this.C = !1),
                  (this.m = this.u = 0),
                  (this.o = 1 / 0),
                  (this.h = this.g = null),
                  (this.F = ""),
                  (this.B = function () {}),
                  (this.j = new Map()));
              }
              function bi(e, t) {
                Ii.set(e, t);
              }
              function Si(e) {
                return Ii.get(e);
              }
              function Ei(e) {
                return !!Ii.has(e) || (("application/cea-608" == e || "application/cea-708" == e) && !!Pt);
              }
              function xi(e, t, r) {
                ((e.F = t),
                  (t = e.j.get(t)) &&
                    (t = t.filter(function (e) {
                      return e.endTime <= r;
                    })).length &&
                    e.l.append(t));
              }
              function wi(e, t, r) {
                ((t.startTime += r), (t.endTime += r));
                for (var i = (t = g(t.nestedCues)).next(); !i.done; i = t.next()) wi(e, i.value, r);
              }
              function Ai(e) {
                for (var t = 1 / 0, r = -1 / 0, i = g(e.j.values()), n = i.next(); !n.done; n = i.next())
                  for (var a = (n = g(n.value)).next(); !a.done; a = n.next())
                    ((a = a.value), (t = Math.min(t, a.startTime)), (r = Math.max(r, a.endTime)));
                t !== 1 / 0 &&
                  r !== -1 / 0 &&
                  ((e.g = null == e.g ? Math.max(t, e.m) : Math.min(e.g, Math.max(t, e.m))),
                  (e.h = Math.max(e.h, Math.min(r, e.o))));
              }
              ((Ti.prototype.destroy = function () {
                return ((this.l = this.i = null), this.j.clear(), Promise.resolve());
              }),
                (Ti.prototype.remove = function (e, t, r) {
                  r = void 0 !== r && r;
                  var i = this;
                  return D(function (n) {
                    return 1 == n.g
                      ? b(n, Promise.resolve(), 2)
                      : e >= t
                        ? n.return()
                        : (r &&
                            (function (e, t, r) {
                              for (var i = g(e.j.keys()), n = i.next(); !n.done; n = i.next()) {
                                n = n.value;
                                var a = e.j.get(n);
                                ((a = a.filter(function (e) {
                                  return e.startTime < t || e.endTime >= r;
                                })),
                                  e.j.set(n, a));
                              }
                            })(i, e, t),
                          i.l &&
                            i.l.remove(e, t) &&
                            null != i.g &&
                            (t <= i.g ||
                              e >= i.h ||
                              (e <= i.g && t >= i.h
                                ? (i.g = i.h = null)
                                : e <= i.g && t < i.h
                                  ? (i.g = t)
                                  : e > i.g && t >= i.h && (i.h = e)),
                            Ai(i)),
                          void S(n));
                  });
                }),
                j("shaka.text.TextEngine", Ti),
                (Ti.prototype.destroy = Ti.prototype.destroy),
                (Ti.findParser = Si),
                (Ti.unregisterParser = function (e) {
                  Ii.delete(e);
                }),
                (Ti.registerParser = bi));
              var Ii = new Map();
              function ki(e) {
                ((this.h = e), (this.g = null));
              }
              function Ri(e) {
                ((this.h = e), (this.g = null));
              }
              function Ci(e, t) {
                return e.concat(t);
              }
              function Li() {}
              function Mi(e) {
                return null != e;
              }
              function Di(e, t) {
                return Promise.race([
                  t,
                  new Promise(function (t, r) {
                    new Ri(r).ka(e);
                  }),
                ]);
              }
              function _i() {}
              function Pi(e, t) {
                return ((e = Fi(e)), (t = Fi(t)), e.split("-")[0] == t.split("-")[0]);
              }
              function Oi(e, t) {
                return (
                  (e = Fi(e)),
                  (t = Fi(t)),
                  (e = e.split("-")),
                  (t = t.split("-")),
                  e[0] == t[0] && 1 == e.length && 2 == t.length
                );
              }
              function Ni(e, t) {
                return (
                  (e = Fi(e)),
                  (t = Fi(t)),
                  (e = e.split("-")),
                  (t = t.split("-")),
                  2 == e.length && 2 == t.length && e[0] == t[0]
                );
              }
              function Fi(e) {
                var t = (e = g(e.split("-x-"))).next().value;
                ((t = void 0 === t ? "" : t), (e = void 0 === (e = e.next().value) ? "" : e));
                var r = g(t.split("-"));
                return (
                  (t = void 0 === (t = r.next().value) ? "" : t),
                  (r = void 0 === (r = r.next().value) ? "" : r),
                  (e = e ? "x-" + e : ""),
                  (t = t.toLowerCase()),
                  (t = Gi.get(t) || t),
                  ((r = r.toUpperCase()) ? t + "-" + r : t) + (e ? "-" + e : "")
                );
              }
              function Ui(e, t) {
                return ((e = Fi(e)), (t = Fi(t)) == e ? 4 : Oi(t, e) ? 3 : Ni(t, e) ? 2 : Oi(e, t) ? 1 : 0);
              }
              function Bi(e) {
                var t = e.indexOf("-");
                return ((e = (e = t >= 0 ? e.substring(0, t) : e).toLowerCase()), Gi.get(e) || e);
              }
              function $i(e) {
                return e.language
                  ? Fi(e.language)
                  : e.audio && e.audio.language
                    ? Fi(e.audio.language)
                    : e.video && e.video.language
                      ? Fi(e.video.language)
                      : "und";
              }
              function ji(e, t) {
                e = Fi(e);
                for (var r = new Set(), i = (t = g(t)).next(); !i.done; i = t.next()) r.add(Fi(i.value));
                for (i = (t = g(r)).next(); !i.done; i = t.next()) if ((i = i.value) == e) return i;
                for (i = (t = g(r)).next(); !i.done; i = t.next()) if (Oi((i = i.value), e)) return i;
                for (i = (t = g(r)).next(); !i.done; i = t.next()) if (Ni((i = i.value), e)) return i;
                for (t = (r = g(r)).next(); !t.done; t = r.next()) if (Oi(e, (t = t.value))) return t;
                return null;
              }
              ((ki.prototype.ka = function (t) {
                var r = this;
                this.stop();
                var i = !0,
                  n = null;
                return (
                  (this.g = function () {
                    (e.clearTimeout(n), (i = !1));
                  }),
                  (n = e.setTimeout(function () {
                    i && r.h();
                  }, 1e3 * t)),
                  this
                );
              }),
                (ki.prototype.stop = function () {
                  this.g && (this.g(), (this.g = null));
                }),
                (Ri.prototype.Jb = function () {
                  return (this.stop(), this.h(), this);
                }),
                (Ri.prototype.ka = function (e) {
                  var t = this;
                  return (
                    this.stop(),
                    (this.g = new ki(function () {
                      t.h();
                    }).ka(e)),
                    this
                  );
                }),
                (Ri.prototype.Ea = function (e) {
                  var t = this;
                  return (
                    this.stop(),
                    (this.g = new ki(function () {
                      (t.g.ka(e), t.h());
                    }).ka(e)),
                    this
                  );
                }),
                (Ri.prototype.stop = function () {
                  this.g && (this.g.stop(), (this.g = null));
                }),
                j("shaka.util.Timer", Ri),
                (Ri.prototype.stop = Ri.prototype.stop),
                (Ri.prototype.tickEvery = Ri.prototype.Ea),
                (Ri.prototype.tickAfter = Ri.prototype.ka),
                (Ri.prototype.tickNow = Ri.prototype.Jb),
                j("shaka.util.LanguageUtils", _i),
                (_i.findClosestLocale = ji),
                (_i.getLocaleForVariant = $i),
                (_i.getLocaleForText = function (e) {
                  return Fi(e.language || "und");
                }),
                (_i.getBase = Bi),
                (_i.relatedness = Ui),
                (_i.areSiblings = function (e, t) {
                  var r = Bi(e),
                    i = Bi(t);
                  return e != r && t != i && r == i;
                }),
                (_i.normalize = Fi),
                (_i.isSiblingOf = Ni),
                (_i.isParentOf = Oi),
                (_i.areLanguageCompatible = Pi),
                (_i.areLocaleCompatible = function (e, t) {
                  return (e = Fi(e)) == (t = Fi(t));
                }));
              var Gi = new Map([
                ["aar", "aa"],
                ["abk", "ab"],
                ["afr", "af"],
                ["aka", "ak"],
                ["alb", "sq"],
                ["amh", "am"],
                ["ara", "ar"],
                ["arg", "an"],
                ["arm", "hy"],
                ["asm", "as"],
                ["ava", "av"],
                ["ave", "ae"],
                ["aym", "ay"],
                ["aze", "az"],
                ["bak", "ba"],
                ["bam", "bm"],
                ["baq", "eu"],
                ["bel", "be"],
                ["ben", "bn"],
                ["bih", "bh"],
                ["bis", "bi"],
                ["bod", "bo"],
                ["bos", "bs"],
                ["bre", "br"],
                ["bul", "bg"],
                ["bur", "my"],
                ["cat", "ca"],
                ["ces", "cs"],
                ["cha", "ch"],
                ["che", "ce"],
                ["chi", "zh"],
                ["chu", "cu"],
                ["chv", "cv"],
                ["cor", "kw"],
                ["cos", "co"],
                ["cre", "cr"],
                ["cym", "cy"],
                ["cze", "cs"],
                ["dan", "da"],
                ["deu", "de"],
                ["div", "dv"],
                ["dut", "nl"],
                ["dzo", "dz"],
                ["ell", "el"],
                ["eng", "en"],
                ["epo", "eo"],
                ["est", "et"],
                ["eus", "eu"],
                ["ewe", "ee"],
                ["fao", "fo"],
                ["fas", "fa"],
                ["fij", "fj"],
                ["fin", "fi"],
                ["fra", "fr"],
                ["fre", "fr"],
                ["fry", "fy"],
                ["ful", "ff"],
                ["geo", "ka"],
                ["ger", "de"],
                ["gla", "gd"],
                ["gle", "ga"],
                ["glg", "gl"],
                ["glv", "gv"],
                ["gre", "el"],
                ["grn", "gn"],
                ["guj", "gu"],
                ["hat", "ht"],
                ["hau", "ha"],
                ["heb", "he"],
                ["her", "hz"],
                ["hin", "hi"],
                ["hmo", "ho"],
                ["hrv", "hr"],
                ["hun", "hu"],
                ["hye", "hy"],
                ["ibo", "ig"],
                ["ice", "is"],
                ["ido", "io"],
                ["iii", "ii"],
                ["iku", "iu"],
                ["ile", "ie"],
                ["ina", "ia"],
                ["ind", "id"],
                ["ipk", "ik"],
                ["isl", "is"],
                ["ita", "it"],
                ["jav", "jv"],
                ["jpn", "ja"],
                ["kal", "kl"],
                ["kan", "kn"],
                ["kas", "ks"],
                ["kat", "ka"],
                ["kau", "kr"],
                ["kaz", "kk"],
                ["khm", "km"],
                ["kik", "ki"],
                ["kin", "rw"],
                ["kir", "ky"],
                ["kom", "kv"],
                ["kon", "kg"],
                ["kor", "ko"],
                ["kua", "kj"],
                ["kur", "ku"],
                ["lao", "lo"],
                ["lat", "la"],
                ["lav", "lv"],
                ["lim", "li"],
                ["lin", "ln"],
                ["lit", "lt"],
                ["ltz", "lb"],
                ["lub", "lu"],
                ["lug", "lg"],
                ["mac", "mk"],
                ["mah", "mh"],
                ["mal", "ml"],
                ["mao", "mi"],
                ["mar", "mr"],
                ["may", "ms"],
                ["mkd", "mk"],
                ["mlg", "mg"],
                ["mlt", "mt"],
                ["mon", "mn"],
                ["mri", "mi"],
                ["msa", "ms"],
                ["mya", "my"],
                ["nau", "na"],
                ["nav", "nv"],
                ["nbl", "nr"],
                ["nde", "nd"],
                ["ndo", "ng"],
                ["nep", "ne"],
                ["nld", "nl"],
                ["nno", "nn"],
                ["nob", "nb"],
                ["nor", "no"],
                ["nya", "ny"],
                ["oci", "oc"],
                ["oji", "oj"],
                ["ori", "or"],
                ["orm", "om"],
                ["oss", "os"],
                ["pan", "pa"],
                ["per", "fa"],
                ["pli", "pi"],
                ["pol", "pl"],
                ["por", "pt"],
                ["pus", "ps"],
                ["que", "qu"],
                ["roh", "rm"],
                ["ron", "ro"],
                ["rum", "ro"],
                ["run", "rn"],
                ["rus", "ru"],
                ["sag", "sg"],
                ["san", "sa"],
                ["sin", "si"],
                ["slk", "sk"],
                ["slo", "sk"],
                ["slv", "sl"],
                ["sme", "se"],
                ["smo", "sm"],
                ["sna", "sn"],
                ["snd", "sd"],
                ["som", "so"],
                ["sot", "st"],
                ["spa", "es"],
                ["sqi", "sq"],
                ["srd", "sc"],
                ["srp", "sr"],
                ["ssw", "ss"],
                ["sun", "su"],
                ["swa", "sw"],
                ["swe", "sv"],
                ["tah", "ty"],
                ["tam", "ta"],
                ["tat", "tt"],
                ["tel", "te"],
                ["tgk", "tg"],
                ["tgl", "tl"],
                ["tha", "th"],
                ["tib", "bo"],
                ["tir", "ti"],
                ["ton", "to"],
                ["tsn", "tn"],
                ["tso", "ts"],
                ["tuk", "tk"],
                ["tur", "tr"],
                ["twi", "tw"],
                ["uig", "ug"],
                ["ukr", "uk"],
                ["urd", "ur"],
                ["uzb", "uz"],
                ["ven", "ve"],
                ["vie", "vi"],
                ["vol", "vo"],
                ["wel", "cy"],
                ["wln", "wa"],
                ["wol", "wo"],
                ["xho", "xh"],
                ["yid", "yi"],
                ["yor", "yo"],
                ["zha", "za"],
                ["zho", "zh"],
                ["zul", "zu"],
              ]);
              function Vi() {}
              function Hi(e, t, r, i, n) {
                if (n.length) {
                  for (
                    var a = e.textStreams, s = (n = g(n)).next(), o = {};
                    !s.done;
                    o = { Fh: void 0 }, s = n.next()
                  )
                    if (
                      ((o.Fh = s.value),
                      (s = a.filter(
                        (function (e) {
                          return function (t) {
                            return !(!t.codecs.startsWith(e.Fh) && !t.mimeType.startsWith(e.Fh));
                          };
                        })(o),
                      )).length)
                    ) {
                      a = s;
                      break;
                    }
                  e.textStreams = a;
                }
                if (
                  ((a = e.variants),
                  (t.length || r.length) &&
                    (a = (function (e, t, r) {
                      for (var i = (t = g(t)).next(), n = {}; !i.done; n = { lj: void 0 }, i = t.next())
                        if (
                          ((n.lj = i.value),
                          (i = e.filter(
                            (function (e) {
                              return function (t) {
                                return t.video && t.video.codecs.startsWith(e.lj);
                              };
                            })(n),
                          )),
                          i.length)
                        ) {
                          e = i;
                          break;
                        }
                      for (r = g(r), t = r.next(), i = {}; !t.done; i = { Rh: void 0 }, t = r.next())
                        if (
                          ((i.Rh = t.value),
                          (t = e.filter(
                            (function (e) {
                              return function (t) {
                                return t.audio && t.audio.codecs.startsWith(e.Rh);
                              };
                            })(i),
                          )),
                          t.length)
                        ) {
                          e = t;
                          break;
                        }
                      return e;
                    })(a, t, r)),
                  i.length)
                ) {
                  for (t = new te(), r = (a = g(a)).next(); !r.done; r = a.next())
                    ((r = r.value), t.push(String(r.video.width || 0), r));
                  var l = [];
                  (t.forEach(function (e, t) {
                    e = 0;
                    for (var r = [], n = (t = g(t)).next(), a = {}; !n.done; a = { Xf: void 0 }, n = t.next())
                      ((a.Xf = n.value),
                        (n = i.filter(
                          (function (e) {
                            return function (t) {
                              return e.Xf.decodingInfos[0][t];
                            };
                          })(a),
                        ).length) > e
                          ? ((e = n), (r = [a.Xf]))
                          : n == e && r.push(a.Xf));
                    l.push.apply(l, m(r));
                  }),
                    (a = l));
                }
                for (t = new Set(), n = (r = g(a)).next(); !n.done; n = r.next())
                  (n = n.value).video && t.add(n.video);
                if (t.size) {
                  var u = {
                    vp8: 1,
                    avc: 1,
                    "dovi-avc": 0.95,
                    vp9: 0.9,
                    vp09: 0.9,
                    hevc: 0.85,
                    "dovi-hevc": 0.8,
                    "dovi-p5": 0.75,
                    av01: 0.7,
                    "dovi-av1": 0.65,
                    vvc: 0.6,
                  };
                  n = Array.from(t).sort(function (e, t) {
                    return e.bandwidth && t.bandwidth && e.bandwidth != t.bandwidth
                      ? e.bandwidth - t.bandwidth
                      : e.width != t.width
                        ? e.width - t.width
                        : e.codecs && t.codecs
                          ? ((e = ci(e.codecs)), (t = ci(t.codecs)), (u[e] || 1) - (u[t] || 1))
                          : 0;
                  });
                  var d = [];
                  for (
                    t = new Map(),
                      r = function (e) {
                        var t = [
                          String(e.width || ""),
                          String(e.height || ""),
                          String(Math.round(e.frameRate || 0)),
                          e.hdr || "",
                          e.fastSwitching,
                        ];
                        return (
                          e.dependencyStream && t.push(e.dependencyStream.baseOriginalId || ""),
                          e.roles && t.push(e.roles.sort().join("_")),
                          t.join(";")
                        );
                      },
                      s = (n = g(n)).next();
                    !s.done;
                    s = n.next()
                  ) {
                    o = r((s = s.value));
                    var h = t.get(o) || [];
                    (h.length
                      ? ci(h[h.length - 1].codecs) == ci(s.codecs) && (h.push(s), d.push(s.id))
                      : (h.push(s), d.push(s.id)),
                      t.set(o, h));
                  }
                  e.variants = a.filter(function (e) {
                    return !((e = e.video) && !d.includes(e.id));
                  });
                } else e.variants = a;
              }
              function Ki(e, t, r) {
                function i(e, t, r) {
                  return e >= t && e <= r;
                }
                if (e && e.video && e.video.width && e.video.height) {
                  var n = e.video.width,
                    a = e.video.height;
                  if (
                    (a > n && ((n = (a = g([a, n])).next().value), (a = a.next().value)),
                    !i(n, t.minWidth, Math.min(t.maxWidth, r.width)) ||
                      !i(a, t.minHeight, Math.min(t.maxHeight, r.height)) ||
                      !i(n * a, t.minPixels, t.maxPixels))
                  )
                    return !1;
                }
                return !(
                  (e &&
                    e.video &&
                    e.video.frameRate &&
                    !i(e.video.frameRate, t.minFrameRate, t.maxFrameRate)) ||
                  (e &&
                    e.audio &&
                    e.audio.channelsCount &&
                    !i(e.audio.channelsCount, t.minChannelsCount, t.maxChannelsCount)) ||
                  !i(e.bandwidth, t.minBandwidth, t.maxBandwidth)
                );
              }
              function Wi(e, t, r, i) {
                return (
                  (r = void 0 === r ? [] : r),
                  (i = void 0 === i ? {} : i),
                  D(function (n) {
                    return 1 == n.g
                      ? b(n, zi(e, t, t.offlineSessionIds.length > 0, r, i), 2)
                      : ((function (e) {
                          e.textStreams = e.textStreams.filter(function (e) {
                            return Ei((e = li(e.mimeType, e.codecs)));
                          });
                        })(t),
                        b(
                          n,
                          (function (e) {
                            var t, r, i, n, a, s, o;
                            return D(function (l) {
                              switch (l.g) {
                                case 1:
                                  ((t = []), (r = g(e.imageStreams)), (i = r.next()));
                                case 2:
                                  if (i.done) {
                                    l.A(4);
                                    break;
                                  }
                                  if (
                                    ((n = i.value),
                                    "application/mp4" == (a = n.mimeType) &&
                                      "mjpg" == n.codecs &&
                                      (a = "image/jpg"),
                                    yn.has(a))
                                  ) {
                                    l.A(5);
                                    break;
                                  }
                                  if (!(s = Tn.get(a))) {
                                    (yn.set(a, !1), l.A(5));
                                    break;
                                  }
                                  return b(
                                    l,
                                    (function (e) {
                                      return new Promise(function (t) {
                                        var r = new Image();
                                        ((r.src = e),
                                          "decode" in r
                                            ? r
                                                .decode()
                                                .then(function () {
                                                  t(!0);
                                                })
                                                .catch(function () {
                                                  t(!1);
                                                })
                                            : (r.onload = r.onerror =
                                                function () {
                                                  t(2 === r.height);
                                                }));
                                      });
                                    })(s),
                                    7,
                                  );
                                case 7:
                                  ((o = l.h), yn.set(a, o));
                                case 5:
                                  (yn.get(a) && t.push(n), (i = r.next()), l.A(2));
                                  break;
                                case 4:
                                  ((e.imageStreams = t), S(l));
                              }
                            });
                          })(t),
                          0,
                        ));
                  })
                );
              }
              function zi(e, t, r, i, n) {
                var a, s;
                return D(function (o) {
                  if (1 == o.g)
                    return (
                      se().$i() &&
                        (function (e) {
                          for (
                            var t = new Map()
                                .set("dvav", "avc3")
                                .set("dva1", "avc1")
                                .set("dvhe", "hev1")
                                .set("dvh1", "hvc1")
                                .set("dvc1", "vvc1")
                                .set("dvi1", "vvi1"),
                              r = new Set(),
                              i = (e = g(e)).next();
                            !i.done;
                            i = e.next()
                          )
                            (i = i.value).video && r.add(i.video);
                          for (r = g(r), e = r.next(); !e.done; e = r.next()) {
                            e = e.value;
                            for (var n = (i = g(t)).next(); !n.done; n = i.next()) {
                              var a = g(n.value);
                              if (((n = a.next().value), (a = a.next().value), e.codecs.includes(n))) {
                                e.codecs = e.codecs.replace(n, a);
                                break;
                              }
                            }
                          }
                        })(t.variants),
                      b(o, Yi(t.variants, r, !1, i), 2)
                    );
                  ((a = null),
                    e && (s = e.g) && (a = s.keySystem),
                    (t.variants = t.variants.filter(function (e) {
                      var t = (function (e, t, r) {
                        if (
                          !e.decodingInfos.some(function (e) {
                            return !(
                              !e.supported ||
                              (t && (e = e.keySystemAccess) && (r[e.keySystem] || e.keySystem) != t)
                            );
                          })
                        )
                          return !1;
                        var i = se(),
                          n = "Xbox" === i.Nb();
                        i = "MOBILE" === i.Oa() && "GECKO" === i.Ha();
                        var a = e.video,
                          s = (a && a.width) || 0,
                          o = (a && a.height) || 0;
                        return !(
                          (n &&
                            a &&
                            (s > 1920 || o > 1080) &&
                            (a.codecs.includes("avc1.") || a.codecs.includes("avc3."))) ||
                          ((n = a && a.dependencyStream) && !Et(n)) ||
                          ((e = e.audio),
                          (i && e && e.encrypted && e.codecs.toLowerCase().includes("opus")) ||
                            (e && e.dependencyStream))
                        );
                      })(e, a, n);
                      if (!t) {
                        var r = [];
                        (e.audio && r.push(fn(e.audio)), e.video && r.push(fn(e.video)));
                      }
                      return t;
                    })),
                    S(o));
                });
              }
              function qi(e, t) {
                var r, i, n, a, s, o, l;
                return D(function (u) {
                  if (1 == u.g) {
                    for (
                      r = function (e, t) {
                        if (e) {
                          var r = zt(e);
                          return (
                            (r.supported = e.supported && t.supported),
                            (r.powerEfficient = e.powerEfficient && t.powerEfficient),
                            (r.smooth = e.smooth && t.smooth),
                            t.keySystemAccess &&
                              !r.keySystemAccess &&
                              (r.keySystemAccess = t.keySystemAccess),
                            r
                          );
                        }
                        return t;
                      },
                        i = null,
                        n = [],
                        a = g(t),
                        s = a.next(),
                        o = {};
                      !s.done;
                      o = { cache: void 0, Se: void 0 }, s = a.next()
                    )
                      ((l = s.value),
                        (o.Se = qt(l)),
                        (o.cache = mn),
                        o.cache.has(o.Se)
                          ? (i = r(i, o.cache.get(o.Se)))
                          : n.push(
                              Xi(l).then(
                                (function (e) {
                                  return function (t) {
                                    for (var n = null, a = (t = g(t || [])).next(); !a.done; a = t.next())
                                      n = r(n, a.value);
                                    n && (e.cache.set(e.Se, n), (i = r(i, n)));
                                  };
                                })(o),
                              ),
                            ));
                    return b(u, Promise.all(n), 2);
                  }
                  (i && e.decodingInfos.push(i), S(u));
                });
              }
              function Xi(e) {
                var t = [""];
                e.video && (t = gi(e.video.contentType).split(","));
                var r = [""];
                e.audio && (r = gi(e.audio.contentType).split(","));
                for (var i = [], n = (t = g(t)).next(); !n.done; n = t.next()) {
                  n = n.value;
                  for (var a = g(r), s = a.next(), o = {}; !s.done; o = { Qc: void 0 }, s = a.next())
                    ((s = s.value),
                      (o.Qc = Wt(e)),
                      e.video && (o.Qc.video.contentType = li(pi(o.Qc.video.contentType), n)),
                      e.audio && (o.Qc.audio.contentType = li(pi(o.Qc.audio.contentType), s)),
                      i.push(
                        new Promise(
                          (function (e) {
                            return function (t, r) {
                              ("MOBILE" == se().Oa()
                                ? Di(5, navigator.mediaCapabilities.decodingInfo(e.Qc))
                                : navigator.mediaCapabilities.decodingInfo(e.Qc)
                              )
                                .then(function (e) {
                                  t(e);
                                })
                                .catch(r);
                            };
                          })(o),
                        ),
                      ));
                }
                return Promise.all(i).catch(function () {
                  return (JSON.stringify(e), null);
                });
              }
              function Yi(e, t, r, i) {
                var n, a, s, o, l, u, d, h, c, f, p, m, v, y, T, S, E, x;
                return D(function (w) {
                  switch (w.g) {
                    case 1:
                      if (
                        e.some(function (e) {
                          return e.decodingInfos.length;
                        })
                      )
                        return w.return();
                      ((n = g(i)), (a = n.next()), (s = {}));
                    case 2:
                      if (a.done) {
                        w.A(4);
                        break;
                      }
                      ((s.Ji = a.value), (o = !1), (l = g(e)), (u = l.next()));
                    case 5:
                      if (u.done) {
                        w.A(7);
                        break;
                      }
                      ((d = u.value),
                        (h = Qi(d, t, r).filter(
                          ((A = s),
                          function (e) {
                            return (
                              ((e = e[0]).keySystemConfiguration && e.keySystemConfiguration.keySystem) ===
                              A.Ji
                            );
                          }),
                        )),
                        (c = g(h)),
                        (f = c.next()));
                    case 8:
                      if (f.done) {
                        w.A(10);
                        break;
                      }
                      return ((p = f.value), b(w, qi(d, p), 9));
                    case 9:
                      ((f = c.next()), w.A(8));
                      break;
                    case 10:
                      (d.decodingInfos.some(function (e) {
                        return e.supported;
                      }) && (o = !0),
                        (u = l.next()),
                        w.A(5));
                      break;
                    case 7:
                      if (o) return w.return();
                      ((s = { Ji: void 0 }), (a = n.next()), w.A(2));
                      break;
                    case 4:
                      ((m = g(e)), (v = m.next()));
                    case 12:
                      if (v.done) {
                        w.A(0);
                        break;
                      }
                      ((y = v.value),
                        (T = Qi(y, t, r).filter(function (e) {
                          return (
                            !(e = (e = e[0]).keySystemConfiguration && e.keySystemConfiguration.keySystem) ||
                            !i.includes(e)
                          );
                        })),
                        (S = g(T)),
                        (E = S.next()));
                    case 15:
                      if (E.done) {
                        ((v = m.next()), w.A(12));
                        break;
                      }
                      return ((x = E.value), b(w, qi(y, x), 16));
                    case 16:
                      ((E = S.next()), w.A(15));
                  }
                  var A;
                });
              }
              function Qi(e, t, r) {
                var i = e.audio,
                  n = e.video,
                  a = [],
                  s = [];
                if (n)
                  for (var o = g(n.fullMimeTypes), l = o.next(); !l.done; l = o.next()) {
                    var u = gi((l = l.value));
                    if (u.includes(",") && !i) {
                      var d = u.split(","),
                        h = pi(l);
                      ((u = ct("video", d)),
                        (h = di(h, (d = Ji((d = ct("audio", d)), h)), "audio")),
                        s.push({
                          contentType: h,
                          channels: 2,
                          bitrate: e.bandwidth || 1,
                          samplerate: 1,
                          spatialRendering: !1,
                        }));
                    }
                    if (
                      ((u = Zi(u)),
                      (l = {
                        contentType: di(pi(l), u, "video"),
                        width: n.width || 64,
                        height: n.height || 64,
                        bitrate: n.bandwidth || e.bandwidth || 1,
                        framerate: n.frameRate || 30,
                      }),
                      n.hdr)
                    )
                      switch (n.hdr) {
                        case "PQ":
                          l.transferFunction = "pq";
                          break;
                        case "HLG":
                          l.transferFunction = "hlg";
                      }
                    (n.colorGamut && (l.colorGamut = n.colorGamut), a.push(l));
                  }
                if (i)
                  for (l = (o = g(i.fullMimeTypes)).next(); !l.done; l = o.next())
                    ((l = di((l = pi((u = l.value))), (u = Ji(gi(u), l)), "audio")),
                      s.push({
                        contentType: l,
                        channels: i.channelsCount || 2,
                        bitrate: i.bandwidth || e.bandwidth || 1,
                        samplerate: i.audioSamplingRate || 1,
                        spatialRendering: i.spatialAudio,
                      }));
                for (
                  o = [], 0 == a.length && a.push(null), 0 == s.length && s.push(null), l = (a = g(a)).next();
                  !l.done;
                  l = a.next()
                )
                  for (l = l.value, h = (u = g(s)).next(); !h.done; h = u.next())
                    ((h = h.value),
                      (d = { type: r ? "file" : "media-source" }),
                      l && (d.video = l),
                      h && (d.audio = h),
                      o.push(d));
                if (!(s = (e.video ? e.video.drmInfos : []).concat(e.audio ? e.audio.drmInfos : [])).length)
                  return [o];
                for (e = [], r = new Map(), a = (s = g(s)).next(); !a.done; a = s.next())
                  ((a = a.value), r.get(a.keySystem) || r.set(a.keySystem, []), r.get(a.keySystem).push(a));
                for (
                  s = t ? "required" : "optional",
                    t = t ? ["persistent-license"] : ["temporary"],
                    l = (a = g(r.keys())).next();
                  !l.done;
                  l = a.next()
                ) {
                  for (
                    l = l.value, h = r.get(l), u = new Map(), d = (h = g(h)).next();
                    !d.done;
                    d = h.next()
                  ) {
                    var c = (d = d.value).videoRobustness + "," + d.audioRobustness;
                    (u.get(c) || u.set(c, []), u.get(c).push(d));
                  }
                  for (h = (u = g(u.values())).next(); !h.done; h = u.next()) {
                    ((h = h.value), (d = []));
                    for (var f = (c = g(o)).next(); !f.done; f = c.next()) {
                      f = Object.assign({}, f.value);
                      for (
                        var p = {
                            keySystem: l,
                            initDataType: "cenc",
                            persistentState: s,
                            distinctiveIdentifier: "optional",
                            sessionTypes: t,
                          },
                          m = g(h),
                          v = m.next();
                        !v.done;
                        v = m.next()
                      ) {
                        if ((v = v.value).initData && v.initData.length) {
                          for (var y = new Set(), T = g(v.initData), b = T.next(); !b.done; b = T.next())
                            y.add(b.value.initDataType);
                          p.initDataType = v.initData[0].initDataType;
                        }
                        (v.distinctiveIdentifierRequired && (p.distinctiveIdentifier = "required"),
                          v.persistentStateRequired && (p.persistentState = "required"),
                          v.sessionType && (p.sessionTypes = [v.sessionType]),
                          i &&
                            (p.audio
                              ? (v.encryptionScheme &&
                                  (p.audio.encryptionScheme = p.audio.encryptionScheme || v.encryptionScheme),
                                (p.audio.robustness = p.audio.robustness || v.audioRobustness))
                              : ((p.audio = { robustness: v.audioRobustness }),
                                v.encryptionScheme && (p.audio.encryptionScheme = v.encryptionScheme)),
                            "" == p.audio.robustness && delete p.audio.robustness),
                          n &&
                            (p.video
                              ? (v.encryptionScheme &&
                                  (p.video.encryptionScheme = p.video.encryptionScheme || v.encryptionScheme),
                                (p.video.robustness = p.video.robustness || v.videoRobustness))
                              : ((p.video = { robustness: v.videoRobustness }),
                                v.encryptionScheme && (p.video.encryptionScheme = v.encryptionScheme)),
                            "" == p.video.robustness && delete p.video.robustness));
                      }
                      ((f.keySystemConfiguration = p), d.push(f));
                    }
                    e.push(d);
                  }
                }
                return e;
              }
              function Ji(e, t) {
                var r = se();
                return "flac" == e.toLowerCase()
                  ? "WEBKIT" != r.Ha()
                    ? "flac"
                    : "fLaC"
                  : "opus" === e.toLowerCase()
                    ? "WEBKIT" != r.Ha()
                      ? "opus"
                      : "mp4" == hi(t)
                        ? "Opus"
                        : "opus"
                    : "ac-3" == e.toLowerCase() && r.se()
                      ? "ec-3"
                      : e;
              }
              function Zi(e) {
                if (e.includes("avc1")) {
                  var t = e.split(".");
                  if (3 == t.length)
                    return (
                      (e = t.shift() + "."),
                      (e += parseInt(t.shift(), 10).toString(16)) +
                        ("000" + parseInt(t.shift(), 10).toString(16)).slice(-4)
                    );
                } else if ("vp9" == e) return "vp09.00.41.08";
                return e;
              }
              function en(e) {
                var t = e.audio,
                  r = e.video,
                  i = t ? t.mimeType : null,
                  n = r ? r.mimeType : null,
                  a = t ? t.codecs : null,
                  s = r ? r.codecs : null,
                  o = t ? t.groupId : null,
                  l = [];
                (r && l.push(r.mimeType), t && l.push(t.mimeType), (l = l[0] || null));
                var u = [];
                (t && u.push(t.kind), r && u.push(r.kind), (u = u[0] || null));
                var d = new Set();
                if (t) for (var h = g(t.roles), c = h.next(); !c.done; c = h.next()) d.add(c.value);
                if (r) for (c = (h = g(r.roles)).next(); !c.done; c = h.next()) d.add(c.value);
                if (
                  ((e = {
                    id: e.id,
                    active: !1,
                    type: "variant",
                    bandwidth: e.bandwidth,
                    language: e.language,
                    label: null,
                    videoLabel: null,
                    kind: u,
                    width: null,
                    height: null,
                    frameRate: null,
                    pixelAspectRatio: null,
                    hdr: null,
                    colorGamut: null,
                    videoLayout: null,
                    mimeType: l,
                    audioMimeType: i,
                    videoMimeType: n,
                    codecs: "",
                    audioCodec: a,
                    videoCodec: s,
                    primary: e.primary,
                    roles: Array.from(d),
                    audioRoles: null,
                    videoRoles: null,
                    forced: !1,
                    videoId: null,
                    audioId: null,
                    audioGroupId: o,
                    channelsCount: null,
                    audioSamplingRate: null,
                    spatialAudio: !1,
                    tilesLayout: null,
                    audioBandwidth: null,
                    videoBandwidth: null,
                    originalVideoId: null,
                    originalAudioId: null,
                    originalTextId: null,
                    originalImageId: null,
                    accessibilityPurpose: null,
                    originalLanguage: null,
                  }),
                  r &&
                    ((e.videoId = r.id),
                    (e.originalVideoId = r.originalId),
                    (e.width = r.width || null),
                    (e.height = r.height || null),
                    (e.frameRate = r.frameRate || null),
                    (e.pixelAspectRatio = r.pixelAspectRatio || null),
                    (e.videoBandwidth = r.bandwidth || null),
                    (e.hdr = r.hdr || null),
                    (e.colorGamut = r.colorGamut || null),
                    (e.videoLayout = r.videoLayout || null),
                    (e.videoRoles = r.roles),
                    (e.videoLabel = r.label),
                    (i = r.dependencyStream) &&
                      ((e.width = i.width || e.width),
                      (e.height = i.height || e.height),
                      (e.videoCodec = i.codecs || e.videoCodec),
                      (e.pixelAspectRatio = i.pixelAspectRatio || e.pixelAspectRatio),
                      e.videoBandwidth && i.bandwidth && (e.videoBandwidth += i.bandwidth)),
                    s.includes(",")))
                ) {
                  ((e.channelsCount = r.channelsCount),
                    (e.audioSamplingRate = r.audioSamplingRate),
                    (e.spatialAudio = r.spatialAudio),
                    (e.originalLanguage = r.originalLanguage),
                    (e.audioMimeType = n),
                    (n = s.split(",")));
                  try {
                    ((e.videoCodec = ct("video", n)), (e.audioCodec = ct("audio", n)));
                  } catch (f) {}
                }
                return (
                  t &&
                    ((e.audioId = t.id),
                    (e.originalAudioId = t.originalId),
                    (e.channelsCount = t.channelsCount),
                    (e.audioSamplingRate = t.audioSamplingRate),
                    (e.audioBandwidth = t.bandwidth || null),
                    (e.spatialAudio = t.spatialAudio),
                    (e.label = t.label),
                    (e.audioRoles = t.roles),
                    (e.accessibilityPurpose = t.accessibilityPurpose),
                    (e.originalLanguage = t.originalLanguage),
                    (n = t.dependencyStream)) &&
                    ((e.audioCodec = n.codecs || e.audioCodec),
                    e.audioBandwidth && n.bandwidth && (e.audioBandwidth += n.bandwidth)),
                  r &&
                    !e.videoBandwidth &&
                    (t
                      ? e.audioBandwidth && (e.videoBandwidth = e.bandwidth - e.audioBandwidth)
                      : (e.videoBandwidth = e.bandwidth)),
                  t &&
                    !e.audioBandwidth &&
                    (r
                      ? e.videoBandwidth && (e.audioBandwidth = e.bandwidth - e.videoBandwidth)
                      : (e.audioBandwidth = e.bandwidth)),
                  (t = []),
                  e.videoCodec && t.push(e.videoCodec),
                  e.audioCodec && t.push(e.audioCodec),
                  (e.codecs = t.join(", ")),
                  e
                );
              }
              function tn(e) {
                return {
                  id: e.id,
                  active: !1,
                  type: gt,
                  bandwidth: e.bandwidth || 0,
                  language: e.language,
                  label: e.label,
                  kind: e.kind || null,
                  mimeType: e.mimeType,
                  codecs: e.codecs || null,
                  primary: e.primary,
                  roles: e.roles,
                  accessibilityPurpose: e.accessibilityPurpose,
                  forced: e.forced,
                  originalTextId: e.originalId,
                  originalLanguage: e.originalLanguage,
                };
              }
              function rn(e) {
                var t = e.width || null,
                  r = e.height || null,
                  i = null;
                e.segmentIndex && (i = Dl(e.segmentIndex));
                var n = e.tilesLayout;
                return (
                  i && (n = i.tilesLayout || n),
                  n && null != t && (t /= Number(n.split("x")[0])),
                  n && null != r && (r /= Number(n.split("x")[1])),
                  {
                    id: e.id,
                    type: "image",
                    bandwidth: e.bandwidth || 0,
                    width: t,
                    height: r,
                    mimeType: e.mimeType,
                    codecs: e.codecs || null,
                    tilesLayout: n || null,
                    originalImageId: e.originalId,
                  }
                );
              }
              function nn(e) {
                return (e.__shaka_id || (e.__shaka_id = vn++), e.__shaka_id);
              }
              function an(e) {
                var t = {
                  id: nn(e),
                  active: "disabled" != e.mode,
                  type: gt,
                  bandwidth: 0,
                  language: Fi(e.language || "und"),
                  label: e.label,
                  kind: e.kind,
                  mimeType: null,
                  codecs: null,
                  primary: !1,
                  roles: [],
                  accessibilityPurpose: null,
                  forced: "forced" == e.kind,
                  originalTextId: e.id,
                  originalLanguage: e.language,
                };
                return (
                  "captions" == e.kind && (t.mimeType = "unknown"),
                  "subtitles" == e.kind && (t.mimeType = "text/vtt"),
                  e.kind && (t.roles = [e.kind]),
                  t
                );
              }
              function sn(e, t) {
                var r = e ? e.language : null;
                if (
                  ((r = {
                    id: nn(e || t),
                    active: e ? e.enabled : t.selected,
                    type: "variant",
                    bandwidth: 0,
                    language: Fi(r || "und"),
                    label: e ? e.label : null,
                    videoLabel: null,
                    kind: e ? e.kind : null,
                    width: null,
                    height: null,
                    frameRate: null,
                    pixelAspectRatio: null,
                    hdr: null,
                    colorGamut: null,
                    videoLayout: null,
                    mimeType: null,
                    audioMimeType: null,
                    videoMimeType: null,
                    codecs: null,
                    audioCodec: null,
                    videoCodec: null,
                    primary: !!e && "main" == e.kind,
                    roles: [],
                    forced: !1,
                    audioRoles: null,
                    videoRoles: null,
                    videoId: null,
                    audioId: null,
                    audioGroupId: null,
                    channelsCount: null,
                    audioSamplingRate: null,
                    spatialAudio: !1,
                    tilesLayout: null,
                    audioBandwidth: null,
                    videoBandwidth: null,
                    originalVideoId: t ? t.id : null,
                    originalAudioId: e ? e.id : null,
                    originalTextId: null,
                    originalImageId: null,
                    accessibilityPurpose: null,
                    originalLanguage: r,
                  }),
                  e && e.kind && ((r.roles = [e.kind]), (r.audioRoles = [e.kind])),
                  e &&
                    e.configuration &&
                    (e.configuration.codec &&
                      ((r.audioCodec = e.configuration.codec), (r.codecs = r.audioCodec)),
                    e.configuration.bitrate &&
                      ((r.audioBandwidth = e.configuration.bitrate), (r.bandwidth += r.audioBandwidth)),
                    e.configuration.sampleRate && (r.audioSamplingRate = e.configuration.sampleRate),
                    e.configuration.numberOfChannels && (r.channelsCount = e.configuration.numberOfChannels)),
                  t &&
                    t.configuration &&
                    (t.configuration.codec &&
                      ((r.videoCodec = t.configuration.codec),
                      (r.codecs = r.codecs ? r.codecs + "," + r.videoCodec : r.videoCodec)),
                    t.configuration.bitrate &&
                      ((r.videoBandwidth = t.configuration.bitrate), (r.bandwidth += r.videoBandwidth)),
                    t.configuration.framerate && (r.frameRate = t.configuration.framerate),
                    t.configuration.width && (r.width = t.configuration.width),
                    t.configuration.height && (r.height = t.configuration.height),
                    t.configuration.colorSpace && t.configuration.colorSpace.transfer))
                )
                  switch (t.configuration.colorSpace.transfer) {
                    case "pq":
                      r.hdr = "PQ";
                      break;
                    case "hlg":
                      r.hdr = "HLG";
                      break;
                    case "bt709":
                      r.hdr = "SDR";
                  }
                return r;
              }
              function on(e) {
                return e.allowedByApplication && e.allowedByKeySystem && 0 == e.disabledUntilTime;
              }
              function ln(e) {
                return e.filter(function (e) {
                  return on(e);
                });
              }
              function un(e, t, r, i) {
                var n = e,
                  a = e.filter(function (e) {
                    return e.primary;
                  });
                a.length && (n = a);
                var s = n.length ? n[0].language : "";
                if (
                  ((n = n.filter(function (e) {
                    return e.language == s;
                  })),
                  t)
                ) {
                  var o = ji(
                    Fi(t),
                    e.map(function (e) {
                      return e.language;
                    }),
                  );
                  o &&
                    (n = e.filter(function (e) {
                      return Fi(e.language) == o;
                    }));
                }
                if (
                  ((n = n.filter(function (e) {
                    return e.forced == i;
                  })),
                  r)
                ) {
                  if ((e = dn(n, r)).length) return e;
                } else if (
                  ((e = n.filter(function (e) {
                    return 0 == e.roles.length;
                  })),
                  e.length)
                )
                  return e;
                return (
                  (e = n
                    .map(function (e) {
                      return e.roles;
                    })
                    .reduce(Ci, [])),
                  e.length ? dn(n, e[0]) : n
                );
              }
              function dn(e, t) {
                return e.filter(function (e) {
                  return e.roles.includes(t);
                });
              }
              function hn(e) {
                var t = [];
                return (e.audio && t.push(e.audio), e.video && t.push(e.video), t);
              }
              function cn(e, t) {
                t.length &&
                  ((t = t
                    .filter(function (t) {
                      return ci(e.codecs) == ci(t.codecs);
                    })
                    .sort(function (e, t) {
                      return e.bandwidth && t.bandwidth && e.bandwidth != t.bandwidth
                        ? e.bandwidth - t.bandwidth
                        : (e.width || 0) - (t.width || 0);
                    })),
                  (e.trickModeVideo = t[0]),
                  t.length > 1 &&
                    (t = t.find(function (t) {
                      return e.width == t.width && e.height == t.height;
                    }))) &&
                  (e.trickModeVideo = t);
              }
              function fn(e) {
                return "audio" == e.type
                  ? "type=audio codecs=" +
                      e.codecs +
                      " bandwidth=" +
                      e.bandwidth +
                      " channelsCount=" +
                      e.channelsCount +
                      " audioSamplingRate=" +
                      e.audioSamplingRate
                  : "video" == e.type
                    ? "type=video codecs=" +
                      e.codecs +
                      " bandwidth=" +
                      e.bandwidth +
                      " frameRate=" +
                      e.frameRate +
                      " width=" +
                      e.width +
                      " height=" +
                      e.height
                    : "unexpected stream type";
              }
              function pn(e, t, r) {
                if (0 == r.autoShowText) return !1;
                if (1 == r.autoShowText) return !0;
                var i = Fi(r.preferredTextLanguage);
                return (
                  (t = Fi(t.language)),
                  2 == r.autoShowText
                    ? Pi(t, i)
                    : 3 == r.autoShowText
                      ? !!e && ((e = Fi(e.language)), Pi(t, i) && !Pi(e, t))
                      : (z("Invalid autoShowText setting!"), !1)
                );
              }
              function gn(e) {
                for (
                  var t = {
                      id: 0,
                      language: "und",
                      disabledUntilTime: 0,
                      primary: !1,
                      audio: null,
                      video: null,
                      bandwidth: 100,
                      allowedByApplication: !0,
                      allowedByKeySystem: !0,
                      decodingInfos: [],
                    },
                    r = (e = g(e)).next();
                  !r.done;
                  r = e.next()
                ) {
                  var i = {
                    id: 0,
                    originalId: null,
                    groupId: null,
                    createSegmentIndex: function () {
                      return Promise.resolve();
                    },
                    segmentIndex: null,
                    mimeType: (r = r.value) ? pi(r) : "",
                    codecs: r ? gi(r) : "",
                    encrypted: !0,
                    drmInfos: [],
                    keyIds: new Set(),
                    language: "und",
                    originalLanguage: null,
                    label: null,
                    type: "video",
                    primary: !1,
                    trickModeVideo: null,
                    dependencyStream: null,
                    emsgSchemeIdUris: null,
                    roles: [],
                    forced: !1,
                    channelsCount: null,
                    audioSamplingRate: null,
                    spatialAudio: !1,
                    closedCaptions: null,
                    accessibilityPurpose: null,
                    external: !1,
                    fastSwitching: !1,
                    fullMimeTypes: new Set(),
                    isAudioMuxedInVideo: !1,
                    baseOriginalId: null,
                  };
                  (i.fullMimeTypes.add(li(i.mimeType, i.codecs)),
                    r.startsWith("audio/") ? ((i.type = "audio"), (t.audio = i)) : (t.video = i));
                }
                return t;
              }
              (j("shaka.util.StreamUtils", Vi), (Vi.meetsRestrictions = Ki));
              var mn = new Map(),
                vn = 0,
                yn = new Map()
                  .set("image/svg+xml", !0)
                  .set("image/png", !0)
                  .set("image/jpeg", !0)
                  .set("image/jpg", !0),
                Tn = new Map()
                  .set(
                    "image/webp",
                    "data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",
                  )
                  .set(
                    "image/avif",
                    "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",
                  );
              function bn() {
                var t = this;
                ((this.H = null),
                  (this.G = !1),
                  (this.u = new H()),
                  (this.j = new re()),
                  navigator.connection &&
                    navigator.connection.addEventListener &&
                    this.j.D(navigator.connection, "change", function () {
                      t.g.useNetworkInformation &&
                        navigator.onLine &&
                        ((t.u = new H()), t.g && t.u.configure(t.g.advanced), t.trySuggestStreams());
                    }),
                  (this.l = []),
                  (this.I = 1),
                  (this.J = !1),
                  (this.h = this.o = this.g = this.B = null),
                  (this.m = new Ri(function () {
                    if (t.G && (t.g.restrictToElementSize || t.g.restrictToScreenSize)) {
                      var e = t.chooseVariant();
                      e && t.H(e, t.g.clearBufferSwitch, t.g.safeMarginSwitch);
                    }
                  })),
                  (this.C = e),
                  "documentPictureInPicture" in e &&
                    this.j.D(e.documentPictureInPicture, "enter", function () {
                      ((t.C = e.documentPictureInPicture.window),
                        t.m && t.m.Jb(),
                        t.j.Aa(t.C, "pagehide", function () {
                          ((t.C = e), t.m && t.m.Jb());
                        }));
                    }),
                  (this.F = this.i = null));
              }
              function Sn(e, t) {
                if (void 0 === t || !t) {
                  if (!e.J) {
                    if (!((t = e.u).g >= t.i)) return;
                    ((e.J = !0), (e.B -= 1e3 * (e.g.switchInterval - e.g.minTimeToSwitch)));
                  }
                  if (Date.now() - e.B < 1e3 * e.g.switchInterval) return;
                }
                ((t = e.chooseVariant()),
                  e.getBandwidthEstimate(),
                  t && e.H(t, e.g.clearBufferSwitch, e.g.safeMarginSwitch));
              }
              function En(e, t, r, i, n) {
                if (e.F) {
                  var a = e.F.ji();
                  a &&
                    (r = r.filter(function (e) {
                      return !e.bandwidth || !a || e.bandwidth <= a;
                    }));
                }
                return (
                  t &&
                    (r = r.filter(function (e) {
                      return Ki(e, t, { width: n, height: i });
                    })),
                  r.sort(function (e, t) {
                    return e.bandwidth - t.bandwidth;
                  })
                );
              }
              (((n = bn.prototype).stop = function () {
                ((this.H = null),
                  (this.G = !1),
                  (this.l = []),
                  (this.I = 1),
                  (this.o = this.B = null),
                  this.h && (this.h.disconnect(), (this.h = null)),
                  this.m && this.m.stop(),
                  (this.F = this.i = null));
              }),
                (n.release = function () {
                  (this.stop(), this.j.release(), (this.m = null));
                }),
                (n.init = function (e) {
                  this.H = e;
                }),
                (n.chooseVariant = function (e) {
                  e = void 0 !== e && e;
                  var t = 1 / 0,
                    r = 1 / 0;
                  if (
                    (this.g.restrictToScreenSize &&
                      ((r = this.g.ignoreDevicePixelRatio ? 1 : this.C.devicePixelRatio),
                      (t = this.C.screen.height * r),
                      (r *= this.C.screen.width)),
                    this.h && this.g.restrictToElementSize)
                  ) {
                    var i = this.g.ignoreDevicePixelRatio ? 1 : this.C.devicePixelRatio,
                      n = this.o.clientHeight,
                      a = this.o.clientWidth;
                    (this.i &&
                      document.pictureInPictureElement &&
                      document.pictureInPictureElement == this.o &&
                      ((n = this.i.height), (a = this.i.width)),
                      (t = Math.min(t, n * i)),
                      (r = Math.min(r, a * i)));
                  }
                  if (
                    ((n = this.l.filter(function (e) {
                      return e && !((e.audio && e.audio.fastSwitching) || (e.video && e.video.fastSwitching));
                    })).length || (n = this.l),
                    (i = n),
                    e &&
                      n.length != this.l.length &&
                      (i = this.l.filter(function (e) {
                        return (
                          e && !!((e.audio && e.audio.fastSwitching) || (e.video && e.video.fastSwitching))
                        );
                      })),
                    (e = En(this, this.g.restrictions, i, 1 / 0, 1 / 0)),
                    t != 1 / 0 || r != 1 / 0)
                  ) {
                    for (
                      e = (function (e) {
                        for (var t = [], r = (e = g(e)).next(); !r.done; r = e.next())
                          (r = r.value) &&
                            (r = r.video) &&
                            r.height &&
                            r.width &&
                            t.push({ height: r.height, width: r.width });
                        return t.sort(function (e, t) {
                          return e.width - t.width;
                        });
                      })(e),
                        n = (e = g(e)).next();
                      !n.done;
                      n = e.next()
                    )
                      if ((n = n.value).height >= t && n.width >= r) {
                        ((t = n.height), (r = n.width));
                        break;
                      }
                    e = En(this, this.g.restrictions, i, t, r);
                  }
                  for (
                    t = this.getBandwidthEstimate(),
                      i.length && !e.length && (e = [(e = En(this, null, i, 1 / 0, 1 / 0))[0]]),
                      r = e[0] || null,
                      i = 0;
                    i < e.length;
                    i++
                  ) {
                    n = e[i];
                    var s = isNaN(this.I) ? 1 : Math.abs(this.I);
                    a = (s * n.bandwidth) / this.g.bandwidthDowngradeTarget;
                    for (var o = { bandwidth: 1 / 0 }, l = i + 1; l < e.length; l++)
                      if (n.bandwidth != e[l].bandwidth) {
                        o = e[l];
                        break;
                      }
                    ((s = (s * o.bandwidth) / this.g.bandwidthUpgradeTarget),
                      r &&
                        n &&
                        t >= a &&
                        t <= s &&
                        (r.bandwidth != n.bandwidth ||
                          (r.bandwidth == n.bandwidth &&
                            r.video &&
                            n.video &&
                            (r.video.width < n.video.width || r.video.height < n.video.height))) &&
                        (r = n));
                  }
                  return ((this.B = Date.now()), r);
                }),
                (n.enable = function () {
                  ((this.G = !0), this.l.length && this.trySuggestStreams());
                }),
                (n.disable = function () {
                  this.G = !1;
                }),
                (n.segmentDownloaded = function (e, t, r, i) {
                  var n = e;
                  (this.g.removeLatencyFromFirstPacketTime &&
                    i &&
                    1 === i.packetNumber &&
                    i.timeToFirstByte &&
                    (n = e - i.timeToFirstByte),
                    n >= this.g.cacheLoadThreshold && this.u.sample(n, t),
                    r && null != this.B && this.G && Sn(this));
                }),
                (n.trySuggestStreams = function () {
                  this.G && ((this.B = Date.now()), Sn(this, !0));
                }),
                (n.getBandwidthEstimate = function () {
                  var e = this.g.defaultBandwidthEstimate;
                  return (
                    navigator.connection &&
                      navigator.connection.downlink &&
                      this.g.useNetworkInformation &&
                      (e = 1e6 * navigator.connection.downlink),
                    navigator.connection &&
                    navigator.connection.downlink &&
                    this.g.useNetworkInformation &&
                    this.g.preferNetworkInformationBandwidth
                      ? e
                      : ((e = this.u.getBandwidthEstimate(e)), this.F ? this.F.getBandwidthEstimate(e) : e)
                  );
                }),
                (n.setVariants = function (e) {
                  return !Z(e, this.l) && ((this.l = e), !0);
                }),
                (n.playbackRateChanged = function (e) {
                  this.I = e;
                }),
                (n.setMediaElement = function (t) {
                  function r() {
                    i.m.ka(xn);
                  }
                  var i = this;
                  ((this.o = t),
                    this.h && (this.h.disconnect(), (this.h = null)),
                    this.o &&
                      "ResizeObserver" in e &&
                      ((this.h = new ResizeObserver(r)), this.h.observe(this.o)),
                    this.j.D(t, "enterpictureinpicture", function (e) {
                      e.pictureInPictureWindow && ((i.i = e.pictureInPictureWindow), i.j.D(i.i, "resize", r));
                    }),
                    this.j.D(t, "leavepictureinpicture", function () {
                      (i.i && i.j.Ma(i.i, "resize", r), (i.i = null));
                    }));
                }),
                (n.setCmsdManager = function (e) {
                  this.F = e;
                }),
                (n.configure = function (e) {
                  ((this.g = e), this.u && this.g && this.u.configure(this.g.advanced));
                }),
                j("shaka.abr.SimpleAbrManager", bn),
                (bn.prototype.configure = bn.prototype.configure),
                (bn.prototype.setCmsdManager = bn.prototype.setCmsdManager),
                (bn.prototype.setMediaElement = bn.prototype.setMediaElement),
                (bn.prototype.playbackRateChanged = bn.prototype.playbackRateChanged),
                (bn.prototype.setVariants = bn.prototype.setVariants),
                (bn.prototype.getBandwidthEstimate = bn.prototype.getBandwidthEstimate),
                (bn.prototype.trySuggestStreams = bn.prototype.trySuggestStreams),
                (bn.prototype.segmentDownloaded = bn.prototype.segmentDownloaded),
                (bn.prototype.disable = bn.prototype.disable),
                (bn.prototype.enable = bn.prototype.enable),
                (bn.prototype.chooseVariant = bn.prototype.chooseVariant),
                (bn.prototype.init = bn.prototype.init),
                (bn.prototype.release = bn.prototype.release),
                (bn.prototype.stop = bn.prototype.stop));
              var xn = 1;
              function wn(e, t) {
                var r = {
                  maxAttempts: 2,
                  baseDelay: 1e3,
                  backoffFactor: 2,
                  fuzzFactor: 0.5,
                  timeout: 3e4,
                  stallTimeout: 5e3,
                  connectionTimeout: 1e4,
                };
                ((this.l = null == e.maxAttempts ? r.maxAttempts : e.maxAttempts),
                  (this.j = null == e.baseDelay ? r.baseDelay : e.baseDelay),
                  (this.o = null == e.fuzzFactor ? r.fuzzFactor : e.fuzzFactor),
                  (this.m = null == e.backoffFactor ? r.backoffFactor : e.backoffFactor),
                  (this.g = 0),
                  (this.h = this.j),
                  (this.i = void 0 !== t && t) && (this.g = 1));
              }
              function An(e) {
                var t, r;
                return D(function (i) {
                  if (1 == i.g) {
                    if (e.g >= e.l) {
                      if (!e.i) throw new ze(2, 7, 1010);
                      ((e.g = 1), (e.h = e.j));
                    }
                    return (
                      (t = e.g),
                      e.g++,
                      0 == t
                        ? i.return()
                        : ((r = e.h * (1 + (2 * Math.random() - 1) * e.o)),
                          b(
                            i,
                            new Promise(function (e) {
                              new Ri(e).ka(r / 1e3);
                            }),
                            2,
                          ))
                    );
                  }
                  ((e.h *= e.m), S(i));
                });
              }
              function In() {
                return {
                  maxAttempts: 2,
                  baseDelay: 1e3,
                  backoffFactor: 2,
                  fuzzFactor: 0.5,
                  timeout: 3e4,
                  stallTimeout: 5e3,
                  connectionTimeout: 1e4,
                };
              }
              function kn() {
                var e,
                  t,
                  r = new Promise(function (r, i) {
                    ((e = r), (t = i));
                  });
                return ((r.resolve = e), (r.reject = t), r);
              }
              function Rn(e, t) {
                ((this.promise = e), (this.i = t), (this.g = null));
              }
              function Cn(e) {
                return new Rn(Promise.reject(e), function () {
                  return Promise.resolve();
                });
              }
              function Ln() {
                var e = Promise.reject(new ze(2, 7, 7001));
                return (
                  e.catch(function () {}),
                  new Rn(e, function () {
                    return Promise.resolve();
                  })
                );
              }
              function Mn(e) {
                return new Rn(Promise.resolve(e), function () {
                  return Promise.resolve();
                });
              }
              function Dn(e) {
                return new Rn(e, function () {
                  return e.catch(function () {});
                });
              }
              function _n(e) {
                return new Rn(
                  Promise.all(
                    e.map(function (e) {
                      return e.promise;
                    }),
                  ),
                  function () {
                    return Promise.all(
                      e.map(function (e) {
                        return e.abort();
                      }),
                    );
                  },
                );
              }
              function Pn(t, r) {
                if (r)
                  if (r instanceof Map)
                    for (var i = g(r.keys()), n = i.next(); !n.done; n = i.next())
                      ((n = n.value),
                        Object.defineProperty(this, n, { value: r.get(n), writable: !0, enumerable: !0 }));
                  else
                    for (i in r)
                      Object.defineProperty(this, i, { value: r[i], writable: !0, enumerable: !0 });
                ((this.defaultPrevented = this.cancelable = this.bubbles = !1),
                  (this.timeStamp = e.performance && e.performance.now ? e.performance.now() : Date.now()),
                  (this.type = t),
                  (this.isTrusted = !1),
                  (this.target = this.currentTarget = null),
                  (this.g = !1));
              }
              function On(e) {
                var t,
                  r = new Pn(e.type);
                for (t in e) Object.defineProperty(r, t, { value: e[t], writable: !0, enumerable: !0 });
                return r;
              }
              ((kn.prototype.resolve = function () {}),
                (kn.prototype.reject = function () {}),
                (Rn.prototype.abort = function () {
                  return (this.g || (this.g = this.i()), this.g);
                }),
                (Rn.prototype.finally = function (e) {
                  return (
                    this.promise.then(
                      function () {
                        return e(!0);
                      },
                      function () {
                        return e(!1);
                      },
                    ),
                    this
                  );
                }),
                (Rn.prototype.Xa = function (e, t) {
                  function r(r) {
                    return function (o) {
                      if (n.g && r) a.reject(s);
                      else {
                        var l = r ? e : t;
                        l
                          ? (i = (function (e, t, r) {
                              try {
                                var i = e(t);
                                return i && i.promise && i.abort
                                  ? (r.resolve(i.promise),
                                    function () {
                                      return i.abort();
                                    })
                                  : (r.resolve(i),
                                    function () {
                                      return Promise.resolve(i).then(
                                        function () {},
                                        function () {},
                                      );
                                    });
                              } catch (n) {
                                return (
                                  r.reject(n),
                                  function () {
                                    return Promise.resolve();
                                  }
                                );
                              }
                            })(l, o, a))
                          : (r ? a.resolve : a.reject)(o);
                      }
                    };
                  }
                  function i() {
                    return (a.reject(s), n.abort());
                  }
                  var n = this,
                    a = new kn();
                  a.catch(function () {});
                  var s = new ze(2, 7, 7001);
                  return (
                    this.promise.then(r(!0), r(!1)),
                    new Rn(a, function () {
                      return i();
                    })
                  );
                }),
                l.Object.defineProperties(Rn.prototype, {
                  aborted: {
                    configurable: !0,
                    enumerable: !0,
                    get: function () {
                      return null !== this.g;
                    },
                  },
                }),
                j("shaka.util.AbortableOperation", Rn),
                (Rn.prototype.chain = Rn.prototype.Xa),
                (Rn.prototype.finally = Rn.prototype.finally),
                (Rn.all = _n),
                (Rn.prototype.abort = Rn.prototype.abort),
                (Rn.notAbortable = Dn),
                (Rn.completed = Mn),
                (Rn.aborted = Ln),
                (Rn.failed = Cn),
                (Pn.prototype.preventDefault = function () {
                  this.cancelable && (this.defaultPrevented = !0);
                }),
                (Pn.prototype.stopImmediatePropagation = function () {
                  this.g = !0;
                }),
                (Pn.prototype.stopPropagation = function () {}),
                j("shaka.util.FakeEvent", Pn));
              var Nn = {
                wl: "abrstatuschanged",
                xl: "adaptation",
                yl: "audiotrackchanged",
                zl: "audiotrackschanged",
                Al: "boundarycrossed",
                Bl: "buffering",
                Cl: "canupdatestarttime",
                Dl: "complete",
                El: "currentitemchanged",
                Fl: "downloadcompleted",
                Gl: "downloadfailed",
                Hl: "downloadheadersreceived",
                Il: "drmsessionupdate",
                Jl: "emsg",
                Pl: "itemsinserted",
                Ql: "itemsremoved",
                gm: "prft",
                Error: "error",
                Kl: "expirationupdated",
                Ll: "firstquartile",
                Ml: "gapjumped",
                Rl: "keystatuschanged",
                Ul: "loaded",
                Vl: "loading",
                Xl: "manifestparsed",
                Yl: "manifestupdated",
                Zl: "mediaqualitychanged",
                $l: "mediasourcerecovered",
                am: "metadataadded",
                Metadata: "metadata",
                bm: "midpoint",
                dm: "nospatialvideoinfo",
                fm: "onstatechange",
                hm: "ratechange",
                lm: "segmentappended",
                nm: "sessiondata",
                om: "spatialvideoinfo",
                pm: "stalldetected",
                qm: "started",
                rm: "statechanged",
                sm: "streaming",
                tm: "textchanged",
                um: "texttrackvisibility",
                vm: "thirdquartile",
                wm: "timelineregionadded",
                xm: "timelineregionenter",
                ym: "timelineregionexit",
                zm: "trackschanged",
                Bm: "unloading",
                Dm: "variantchanged",
              };
              function Fn() {
                ((this.ab = new te()), (this.Je = this));
              }
              function Un() {
                this.g = [];
              }
              function Bn(e, t) {
                e.g.push(
                  t.finally(function () {
                    J(e.g, t);
                  }),
                );
              }
              function $n(e, t, r, i, n, a, s) {
                (Fn.call(this),
                  (this.i = null),
                  (this.j = !1),
                  (this.u = new Un()),
                  (this.g = new Set()),
                  (this.h = new Set()),
                  (this.o = e || null),
                  (this.m = t || null),
                  (this.B = r || null),
                  (this.C = i || null),
                  (this.F = n || null),
                  (this.H = a || null),
                  (this.G = s || null),
                  (this.l = new Map()));
              }
              function jn(e, t, r, i) {
                ((i = void 0 !== i && i), (r = r || Xn));
                var n = Yn.get(e);
                (!n || r >= n.priority) && Yn.set(e, { priority: r, Bf: t, Ik: i });
              }
              function Gn(e, t) {
                for (var r = g(e.g), i = r.next(); !i.done; i = r.next()) t.g.add(i.value);
                for (r = (e = g(e.h)).next(); !r.done; r = e.next()) t.h.add(r.value);
              }
              function Vn(e, t, r) {
                return {
                  uris: e,
                  method: "GET",
                  body: null,
                  headers: {},
                  allowCrossSiteCredentials: !1,
                  retryParameters: t,
                  licenseRequestType: null,
                  sessionId: null,
                  drmInfo: null,
                  initData: null,
                  initDataType: null,
                  streamDataCallback: void 0 === r ? null : r,
                };
              }
              function Hn(e, t, r, i, n, a, s, o) {
                (e.i.forceHTTP && (r.uris[a] = r.uris[a].replace("https://", "http://")),
                  e.i.forceHTTPS && (r.uris[a] = r.uris[a].replace("http://", "https://")),
                  a > 0 && e.H && e.H(t, i, r.uris[a], r.uris[a - 1]));
                var l = new me(r.uris[a]),
                  u = l.fc,
                  d = !1;
                (u || (ve(l, (u = (u = location.protocol).slice(0, -1))), (r.uris[a] = l.toString())),
                  (u = u.toLowerCase()));
                var h = (u = Yn.get(u)) ? u.Bf : null;
                if (!h) return Cn(new ze(2, 1, 1e3, l));
                var c = u.Ik;
                (l = e.l.get(l.Db)) && (r.headers["common-access-token"] = l);
                var f,
                  p = null,
                  g = null,
                  m = !1,
                  v = !1;
                return Dn(An(n))
                  .Xa(function () {
                    if (e.j) return Ln();
                    f = Date.now();
                    var n = 0;
                    r.requestStartTime = Date.now();
                    var s = h(
                      r.uris[a],
                      r,
                      t,
                      function (a, s, l) {
                        (p && p.stop(),
                          g && g.ka(u / 1e3),
                          e.o &&
                            t == qn &&
                            (n++, (r.packetNumber = n), e.o(a, s, Kn(i), r, i), (d = !0), (o.g = l)));
                      },
                      function (i) {
                        ((v = !0),
                          (r.timeToFirstByte = Date.now() - r.requestStartTime),
                          e.m && e.m(i, r, t));
                      },
                      { minBytesForProgressEvents: e.i.minBytesForProgressEvents },
                    );
                    if (!c) return s;
                    var l = r.retryParameters.connectionTimeout;
                    l &&
                      (p = new Ri(function () {
                        ((m = !0), s.abort());
                      })).ka(l / 1e3);
                    var u = r.retryParameters.stallTimeout;
                    return (
                      u &&
                        (g = new Ri(function () {
                          ((m = !0), s.abort());
                        })),
                      s
                    );
                  })
                  .Xa(
                    function (i) {
                      (p && p.stop(), g && g.stop(), null == i.timeMs && (i.timeMs = Date.now() - f));
                      var n = i.headers["common-access-token"];
                      if (n) {
                        var a = new me(i.uri);
                        e.l.set(a.Db, n);
                      }
                      return (
                        (n = { response: i, jk: d }),
                        !v && e.m && e.m(i.headers, r, t),
                        e.B && e.B(r, i),
                        n
                      );
                    },
                    function (l) {
                      if ((p && p.stop(), g && g.stop(), e.C)) {
                        var u = null,
                          d = 0;
                        (l instanceof ze && ((u = l), 1001 == l.code && (d = l.data[1])), e.C(r, u, d, m));
                      }
                      if (e.j) return Ln();
                      if ((m && (l = new ze(1, 1, 1003, r.uris[a], t)), l instanceof ze)) {
                        if (7001 == l.code) throw l;
                        if (1010 == l.code) throw s;
                        if (1 == l.severity) {
                          if (
                            (((u = new Pn("retry", (u = new Map().set("error", l)))).cancelable = !0),
                            e.dispatchEvent(u),
                            u.defaultPrevented)
                          )
                            throw l;
                          return ((a = (a + 1) % r.uris.length), Hn(e, t, r, i, n, a, l, o));
                        }
                      }
                      throw l;
                    },
                  );
              }
              function Kn(e) {
                if (e) {
                  var t = e.segment;
                  if (((e = e.stream), t && e && e.fastSwitching && t.Xc)) return !1;
                }
                return !0;
              }
              function Wn() {
                this.g = 0;
              }
              function zn(e, t, r) {
                (Rn.call(this, e, t), (this.h = r));
              }
              ((Fn.prototype.addEventListener = function (e, t) {
                this.ab && this.ab.push(e, t);
              }),
                (Fn.prototype.removeEventListener = function (e, t) {
                  this.ab && this.ab.remove(e, t);
                }),
                (Fn.prototype.dispatchEvent = function (e) {
                  if (!this.ab) return !0;
                  var t = this.ab.get(e.type) || [],
                    r = this.ab.get("All");
                  for (r && (t = t.concat(r)), r = (t = g(t)).next(); !r.done; r = t.next()) {
                    ((r = r.value), (e.target = this.Je), (e.currentTarget = this.Je));
                    try {
                      r.handleEvent ? r.handleEvent(e) : r.call(this, e);
                    } catch (i) {}
                    if (e.g) break;
                  }
                  return e.defaultPrevented;
                }),
                (Fn.prototype.release = function () {
                  this.ab = null;
                }),
                (Un.prototype.destroy = function () {
                  for (var e = [], t = g(this.g), r = t.next(); !r.done; r = t.next())
                    ((r = r.value).promise.catch(function () {}), e.push(r.abort()));
                  return ((this.g = []), Promise.all(e));
                }),
                f($n, Fn),
                ((n = $n.prototype).configure = function (e) {
                  this.i = e;
                }),
                (n.Lk = function (e) {
                  this.g.add(e);
                }),
                (n.kl = function (e) {
                  this.g.delete(e);
                }),
                (n.vj = function () {
                  this.g.clear();
                }),
                (n.Mk = function (e) {
                  this.h.add(e);
                }),
                (n.ll = function (e) {
                  this.h.delete(e);
                }),
                (n.wj = function () {
                  this.h.clear();
                }),
                (n.Wh = function () {
                  this.l.clear();
                }),
                (n.destroy = function () {
                  return (
                    (this.j = !0),
                    this.g.clear(),
                    this.h.clear(),
                    this.l.clear(),
                    Fn.prototype.release.call(this),
                    this.u.destroy()
                  );
                }),
                (n.request = function (e, t, r) {
                  var i = this,
                    n = new Wn();
                  if (this.j) {
                    var a = Promise.reject(new ze(2, 7, 7001));
                    return (
                      a.catch(function () {}),
                      new zn(
                        a,
                        function () {
                          return Promise.resolve();
                        },
                        n,
                      )
                    );
                  }
                  ((t.method = t.method || "GET"),
                    (t.headers = t.headers || {}),
                    (t.retryParameters = t.retryParameters
                      ? Wt(t.retryParameters)
                      : {
                          maxAttempts: 2,
                          baseDelay: 1e3,
                          backoffFactor: 2,
                          fuzzFactor: 0.5,
                          timeout: 3e4,
                          stallTimeout: 5e3,
                          connectionTimeout: 1e4,
                        }),
                    (t.uris = Wt(t.uris)),
                    (a = (function (e, t, r, i) {
                      function n(e) {
                        a = a.Xa(function () {
                          return (r.body && (r.body = Pe(r.body)), e(t, r, i));
                        });
                      }
                      var a = Mn(void 0);
                      e.F && n(e.F);
                      for (var s = (e = g(e.g)).next(); !s.done; s = e.next()) n(s.value);
                      return a.Xa(void 0, function (e) {
                        if (e instanceof ze && 7001 == e.code) throw e;
                        throw new ze(2, 1, 1006, e);
                      });
                    })(this, e, t, r)));
                  var s = a.Xa(function () {
                      return Hn(i, e, t, r, new wn(t.retryParameters, !1), 0, null, n);
                    }),
                    o = s.Xa(function (t) {
                      return (function (e, t, r, i) {
                        for (
                          var n = Mn(void 0), a = (e = g(e.h)).next(), s = {};
                          !a.done;
                          s = { Pi: void 0 }, a = e.next()
                        )
                          ((s.Pi = a.value),
                            (n = n.Xa(
                              (function (e) {
                                return function () {
                                  var n = r.response;
                                  return (n.data && (n.data = Pe(n.data)), (0, e.Pi)(t, n, i));
                                };
                              })(s),
                            )));
                        return n.Xa(
                          function () {
                            return r;
                          },
                          function (e) {
                            var t = 2;
                            if (e instanceof ze) {
                              if (7001 == e.code) throw e;
                              t = e.severity;
                            }
                            throw new ze(t, 1, 1007, e);
                          },
                        );
                      })(i, e, t, r);
                    }),
                    l = Date.now(),
                    u = 0;
                  a.promise.then(
                    function () {
                      u = Date.now() - l;
                    },
                    function () {},
                  );
                  var d = 0;
                  s.promise.then(
                    function () {
                      d = Date.now();
                    },
                    function () {},
                  );
                  var h = o.Xa(
                    function (n) {
                      var a = Date.now() - d,
                        s = n.response;
                      return (
                        (s.timeMs += u),
                        (s.timeMs += a),
                        n.jk ||
                          !i.o ||
                          s.fromCache ||
                          "HEAD" == t.method ||
                          e != qn ||
                          i.o(s.timeMs, s.data.byteLength, Kn(r), t, r),
                        i.G && i.G(e, s, r),
                        s
                      );
                    },
                    function (e) {
                      throw (e && (e.severity = 2), e);
                    },
                  );
                  return (
                    (a = new zn(
                      h.promise,
                      function () {
                        return h.abort();
                      },
                      n,
                    )),
                    Bn(this.u, a),
                    a
                  );
                }),
                j("shaka.net.NetworkingEngine", $n),
                ($n.prototype.request = $n.prototype.request),
                ($n.prototype.destroy = $n.prototype.destroy),
                ($n.makeRequest = Vn),
                ($n.defaultRetryParameters = function () {
                  return {
                    maxAttempts: 2,
                    baseDelay: 1e3,
                    backoffFactor: 2,
                    fuzzFactor: 0.5,
                    timeout: 3e4,
                    stallTimeout: 5e3,
                    connectionTimeout: 1e4,
                  };
                }),
                ($n.prototype.clearCommonAccessTokenMap = $n.prototype.Wh),
                ($n.prototype.clearAllResponseFilters = $n.prototype.wj),
                ($n.prototype.unregisterResponseFilter = $n.prototype.ll),
                ($n.prototype.registerResponseFilter = $n.prototype.Mk),
                ($n.prototype.clearAllRequestFilters = $n.prototype.vj),
                ($n.prototype.unregisterRequestFilter = $n.prototype.kl),
                ($n.prototype.registerRequestFilter = $n.prototype.Lk),
                ($n.unregisterScheme = function (e) {
                  Yn.delete(e);
                }),
                ($n.registerScheme = jn),
                ($n.prototype.configure = $n.prototype.configure),
                ($n.NumBytesRemainingClass = Wn),
                f(zn, Rn),
                ($n.PendingRequest = zn));
              var qn = 1;
              (($n.RequestType = {
                MANIFEST: 0,
                SEGMENT: qn,
                LICENSE: 2,
                APP: 3,
                TIMING: 4,
                SERVER_CERTIFICATE: 5,
                KEY: 6,
                ADS: 7,
                CONTENT_STEERING: 8,
                CMCD: 9,
              }),
                ($n.AdvancedRequestType = {
                  INIT_SEGMENT: 0,
                  MEDIA_SEGMENT: 1,
                  MEDIA_PLAYLIST: 2,
                  MASTER_PLAYLIST: 3,
                  MPD: 4,
                  MSS: 5,
                  MPD_PATCH: 6,
                  MEDIATAILOR_SESSION_INFO: 7,
                  MEDIATAILOR_TRACKING_INFO: 8,
                  MEDIATAILOR_STATIC_RESOURCE: 9,
                  MEDIATAILOR_TRACKING_EVENT: 10,
                  INTERSTITIAL_ASSET_LIST: 11,
                  INTERSTITIAL_AD_URL: 12,
                }));
              var Xn = 3;
              $n.PluginPriority = { FALLBACK: 1, PREFERRED: 2, APPLICATION: Xn };
              var Yn = new Map();
              function Qn(e) {
                ((this.g = !1), (this.h = new kn()), (this.i = e));
              }
              function Jn(e, t) {
                if (e.g) {
                  if (t instanceof ze && 7003 == t.code) throw t;
                  throw new ze(2, 7, 7003, t);
                }
              }
              function Zn(e, t) {
                for (var r = [], i = (e = g(e)).next(); !i.done; i = e.next()) r.push(t(i.value));
                return r;
              }
              function ea(e) {
                for (var t = new Map(), r = g(Object.keys(e)), i = r.next(); !i.done; i = r.next())
                  ((i = i.value), t.set(i, e[i]));
                return t;
              }
              function ta(e) {
                var t = {};
                return (
                  e.forEach(function (e, r) {
                    t[r] = e;
                  }),
                  t
                );
              }
              function ra(e, t) {
                ((this.h = Fe(e)), (this.i = t == na), (this.g = 0));
              }
              function ia() {
                return new ze(2, 3, 3e3);
              }
              ((Qn.prototype.destroy = function () {
                var e = this;
                return this.g
                  ? this.h
                  : ((this.g = !0),
                    this.i().then(
                      function () {
                        e.h.resolve();
                      },
                      function () {
                        e.h.resolve();
                      },
                    ));
              }),
                ((n = ra.prototype).Ia = function () {
                  return this.g < this.h.byteLength;
                }),
                (n.Pa = function () {
                  return this.g;
                }),
                (n.getLength = function () {
                  return this.h.byteLength;
                }),
                (n.Y = function () {
                  try {
                    var e = this.h.getUint8(this.g);
                    return ((this.g += 1), e);
                  } catch (t) {
                    throw ia();
                  }
                }),
                (n.Ca = function () {
                  try {
                    var e = this.h.getUint16(this.g, this.i);
                    return ((this.g += 2), e);
                  } catch (t) {
                    throw ia();
                  }
                }),
                (n.U = function () {
                  try {
                    var e = this.h.getUint32(this.g, this.i);
                    return ((this.g += 4), e);
                  } catch (t) {
                    throw ia();
                  }
                }),
                (n.dh = function () {
                  try {
                    var e = this.h.getInt32(this.g, this.i);
                    return ((this.g += 4), e);
                  } catch (t) {
                    throw ia();
                  }
                }),
                (n.Ed = function () {
                  try {
                    if (this.i)
                      var e = this.h.getUint32(this.g, !0),
                        t = this.h.getUint32(this.g + 4, !0);
                    else ((t = this.h.getUint32(this.g, !1)), (e = this.h.getUint32(this.g + 4, !1)));
                  } catch (r) {
                    throw ia();
                  }
                  if (t > 2097151) throw new ze(2, 3, 3001);
                  return ((this.g += 8), 4294967296 * t + e);
                }),
                (n.Tb = function (e, t) {
                  if (this.g + e > this.h.byteLength) throw ia();
                  var r = Oe(this.h, this.g, e);
                  return ((this.g += e), t ? new Uint8Array(r) : r);
                }),
                (n.skip = function (e) {
                  if (this.g + e > this.h.byteLength) throw ia();
                  this.g += e;
                }),
                (n.Qi = function (e) {
                  if (this.g < e) throw ia();
                  this.g -= e;
                }),
                (n.seek = function (e) {
                  if (e < 0 || e > this.h.byteLength) throw ia();
                  this.g = e;
                }),
                (n.Yc = function () {
                  for (var e = this.g; this.Ia() && 0 != this.h.getUint8(this.g); ) this.g += 1;
                  return ((e = Oe(this.h, e, this.g - e)), (this.g += 1), Xe(e));
                }),
                j("shaka.util.DataViewReader", ra),
                (ra.prototype.readTerminatedString = ra.prototype.Yc),
                (ra.prototype.seek = ra.prototype.seek),
                (ra.prototype.rewind = ra.prototype.Qi),
                (ra.prototype.skip = ra.prototype.skip),
                (ra.prototype.readBytes = ra.prototype.Tb),
                (ra.prototype.readUint64 = ra.prototype.Ed),
                (ra.prototype.readInt32 = ra.prototype.dh),
                (ra.prototype.readUint32 = ra.prototype.U),
                (ra.prototype.readUint16 = ra.prototype.Ca),
                (ra.prototype.readUint8 = ra.prototype.Y),
                (ra.prototype.getLength = ra.prototype.getLength),
                (ra.prototype.getPosition = ra.prototype.Pa),
                (ra.prototype.hasMoreData = ra.prototype.Ia));
              var na = 1;
              function aa() {
                ((this.i = new Map()), (this.h = new Map()), (this.g = !1));
              }
              function sa(e) {
                for (var t = fa(e); e.reader.Ia() && !e.parser.g; )
                  e.parser.Bd(e.start + t, e.reader, e.partialOkay, e.stopOnPartial);
              }
              function oa(e) {
                for (
                  var t = fa(e), r = e.reader.U(), i = 0;
                  i < r && (e.parser.Bd(e.start + t, e.reader, e.partialOkay, e.stopOnPartial), !e.parser.g);
                  i++
                );
              }
              function la(e) {
                var t = fa(e);
                for (e.reader.skip(78); e.reader.Ia() && !e.parser.g; )
                  e.parser.Bd(e.start + t, e.reader, e.partialOkay, e.stopOnPartial);
              }
              function ua(e) {
                var t = fa(e);
                e.reader.skip(8);
                var r = e.reader.Ca();
                for (
                  e.reader.skip(6),
                    2 == r ? e.reader.skip(48) : e.reader.skip(12),
                    1 == r && e.reader.skip(16);
                  e.reader.Ia() && !e.parser.g;
                )
                  e.parser.Bd(e.start + t, e.reader, e.partialOkay, e.stopOnPartial);
              }
              function da(e, t) {
                return function (r) {
                  e(r.reader.Tb(r.reader.getLength() - r.reader.Pa(), t));
                };
              }
              function ha(e) {
                for (var t = 0, r = (e = g(e)).next(); !r.done; r = e.next())
                  t = (t << 8) | r.value.charCodeAt(0);
                return t;
              }
              function ca(e) {
                return String.fromCharCode((e >> 24) & 255, (e >> 16) & 255, (e >> 8) & 255, 255 & e);
              }
              function fa(e) {
                return 8 + (e.has64BitSize ? 8 : 0) + (null != e.flags ? 4 : 0);
              }
              ((ra.Endianness = { BIG_ENDIAN: 0, LITTLE_ENDIAN: na }),
                ((n = aa.prototype).box = function (e, t) {
                  return ((e = ha(e)), this.i.set(e, pa), this.h.set(e, t), this);
                }),
                (n.S = function (e, t) {
                  return ((e = ha(e)), this.i.set(e, ga), this.h.set(e, t), this);
                }),
                (n.stop = function () {
                  this.g = !0;
                }),
                (n.parse = function (e, t, r) {
                  for (e = new ra(e, 0), this.g = !1; e.Ia() && !this.g; ) this.Bd(0, e, t, r);
                }),
                (n.Bd = function (e, t, r, i) {
                  var n = t.Pa();
                  if (i && n + 8 > t.getLength()) this.g = !0;
                  else {
                    var a = t.U(),
                      s = t.U(),
                      o = ca(s),
                      l = !1;
                    switch (a) {
                      case 0:
                        a = t.getLength() - n;
                        break;
                      case 1:
                        if (i && t.Pa() + 8 > t.getLength()) return void (this.g = !0);
                        ((a = t.Ed()), (l = !0));
                    }
                    var u = this.h.get(s);
                    if (u) {
                      var d = null,
                        h = null;
                      if (this.i.get(s) == ga) {
                        if (i && t.Pa() + 4 > t.getLength()) return void (this.g = !0);
                        ((d = (h = t.U()) >>> 24), (h &= 16777215));
                      }
                      ((s = n + a),
                        r && s > t.getLength() && (s = t.getLength()),
                        i && s > t.getLength()
                          ? (this.g = !0)
                          : ((s -= t.Pa()),
                            u({
                              name: o,
                              parser: this,
                              partialOkay: r || !1,
                              stopOnPartial: i || !1,
                              version: d,
                              flags: h,
                              reader: (t = new ra((t = s > 0 ? t.Tb(s, !1) : new Uint8Array(0)), 0)),
                              size: a,
                              start: n + e,
                              has64BitSize: l,
                            })));
                    } else t.skip(Math.min(n + a - t.Pa(), t.getLength() - t.Pa()));
                  }
                }),
                j("shaka.util.Mp4Parser", aa),
                (aa.headerSize = fa),
                (aa.typeToString = ca),
                (aa.allData = da),
                (aa.audioSampleEntry = ua),
                (aa.visualSampleEntry = la),
                (aa.sampleDescription = oa),
                (aa.children = sa),
                (aa.prototype.parseNext = aa.prototype.Bd),
                (aa.prototype.parse = aa.prototype.parse),
                (aa.prototype.stop = aa.prototype.stop),
                (aa.prototype.fullBox = aa.prototype.S),
                (aa.prototype.box = aa.prototype.box));
              var pa = 0,
                ga = 1;
              function ma(e) {
                var t = this;
                ((this.g = []),
                  (this.h = []),
                  (this.data = []),
                  new aa()
                    .box("moov", sa)
                    .box("moof", sa)
                    .S("pssh", function (e) {
                      if (!(e.version > 1)) {
                        var r = Oe(e.reader.h, -12, e.size);
                        if ((t.data.push(r), (r = e.reader.Tb(16, !1)), t.g.push(ot(r)), e.version > 0)) {
                          r = e.reader.U();
                          for (var i = 0; i < r; i++) {
                            var n = e.reader.Tb(16, !1);
                            ((n = ot(n)), t.h.push(n));
                          }
                        }
                      }
                    })
                    .parse(e));
              }
              function va(e, t, r, i) {
                var n = e.length,
                  a = 12 + t.length + 4 + n;
                i > 0 && (a += 4 + 16 * r.size);
                var s = new Uint8Array(a),
                  o = Fe(s),
                  l = 0;
                if (
                  (o.setUint32(l, a),
                  (l += 4),
                  o.setUint32(l, 1886614376),
                  (l += 4),
                  i < 1 ? o.setUint32(l, 0) : o.setUint32(l, 16777216),
                  (l += 4),
                  s.set(t, l),
                  (l += t.length),
                  i > 0)
                )
                  for (o.setUint32(l, r.size), l += 4, r = (t = g(r)).next(); !r.done; r = t.next())
                    ((r = st(r.value)), s.set(r, l), (l += r.length));
                return (o.setUint32(l, n), s.set(e, l + 4), s);
              }
              function ya(e) {
                var t = this;
                ((this.F = e),
                  (this.l = this.B = null),
                  (this.$ = this.T = !1),
                  (this.J = 0),
                  (this.g = null),
                  (this.o = new re()),
                  (this.i = new Map()),
                  (this.X = []),
                  (this.C = new Map()),
                  (this.K = !1),
                  (this.m = new kn()),
                  (this.h = null),
                  (this.u = function (r) {
                    (2 == r.severity && t.m.reject(r), e.onError(r));
                  }),
                  (this.ba = new Map()),
                  (this.ma = new Map()),
                  (this.M = new Ri(function () {
                    return (function (e) {
                      var t = e.ba,
                        r = e.ma;
                      (r.clear(),
                        t.forEach(function (e, t) {
                          return r.set(t, e);
                        }),
                        (t = Array.from(r.values())).length &&
                          t.every(function (e) {
                            return "expired" == e;
                          }) &&
                          e.u(new ze(2, 6, 6014)),
                        e.F.zf(ta(r)));
                    })(t);
                  })),
                  (this.R = !1),
                  (this.N = []),
                  (this.oa = !1),
                  (this.G = new Ri(function () {
                    !(function (e) {
                      e.i.forEach(function (t, r) {
                        var i = t.Yg,
                          n = r.expiration;
                        (isNaN(n) && (n = 1 / 0),
                          n != i && (e.F.onExpirationUpdated(r.sessionId, n), (t.Yg = n)));
                      });
                    })(t);
                  })),
                  this.m.catch(function () {}),
                  (this.j = new Qn(function () {
                    return (function (e) {
                      return D(function (t) {
                        switch (t.g) {
                          case 1:
                            return (
                              e.o.release(),
                              (e.o = null),
                              e.m.reject(),
                              e.G.stop(),
                              (e.G = null),
                              e.M.stop(),
                              (e.M = null),
                              b(t, _a(e), 2)
                            );
                          case 2:
                            if (!e.l) {
                              t.A(3);
                              break;
                            }
                            return (E(t, 4), b(t, e.l.setMediaKeys(null), 6));
                          case 6:
                            w(t, 5);
                            break;
                          case 4:
                            A(t);
                          case 5:
                            e.l = null;
                          case 3:
                            ((e.g = null),
                              (e.B = null),
                              (e.C = new Map()),
                              (e.h = null),
                              (e.u = function () {}),
                              (e.F = null),
                              (e.O = !1),
                              (e.I = null),
                              S(t));
                        }
                      });
                    })(t);
                  })),
                  (this.O = !1),
                  (this.H = this.I = null),
                  (this.V = function () {
                    return !1;
                  }));
              }
              function Ta(e, t, r, i) {
                ((i = void 0 === i || i), (e.C = new Map()));
                for (var n = (r = g(r)).next(); !n.done; n = r.next())
                  e.C.set(n.value, { initData: null, initDataType: null });
                for (n = (r = g(e.h.persistentSessionsMetadata)).next(); !n.done; n = r.next())
                  ((n = n.value),
                    e.C.set(n.sessionId, { initData: n.initData, initDataType: n.initDataType }));
                return ((e.R = e.C.size > 0), ba(e, t, i));
              }
              function ba(e, t, r) {
                var i, n, a, s, o, l, u, d, h, c, f, p, m, v, y, T, S;
                return D(function (E) {
                  if (1 == E.g) {
                    for (
                      Fa(e.h.clearKeys, t),
                        i = t.some(function (e) {
                          return !!(
                            (e.video && e.video.drmInfos.length) ||
                            (e.audio && e.audio.drmInfos.length)
                          );
                        }),
                        n = ea(e.h.servers),
                        a = ea(e.h.advanced || {}),
                        !i &&
                          r &&
                          (function (e, t) {
                            var r = [];
                            for (
                              t.forEach(function (e, t) {
                                r.push({
                                  keySystem: t,
                                  licenseServerUri: e,
                                  distinctiveIdentifierRequired: !1,
                                  persistentStateRequired: !1,
                                  audioRobustness: "",
                                  videoRobustness: "",
                                  serverCertificate: null,
                                  serverCertificateUri: "",
                                  initData: [],
                                  keyIds: new Set(),
                                });
                              }),
                                e = g(e),
                                t = e.next();
                              !t.done;
                              t = e.next()
                            )
                              ((t = t.value).video && (t.video.drmInfos = r),
                                t.audio && (t.audio.drmInfos = r));
                          })(t, n),
                        s = new WeakSet(),
                        o = g(t),
                        l = o.next();
                      !l.done;
                      l = o.next()
                    )
                      for (u = l.value, d = Pa(u), h = g(d), c = h.next(); !c.done; c = h.next())
                        ((f = c.value), s.has(f) || (s.add(f), Na(f, n, a, e.h.keySystemsMapping)));
                    for (
                      p = function (t, r) {
                        for (var i = [], n = (t = g(t)).next(); !n.done; n = t.next()) {
                          var s,
                            o = (n = n.value)[r] || (a.has(n.keySystem) && a.get(n.keySystem)[r]) || "";
                          if (
                            ((s = "" == o) && (s = !!(s = n.keySystem) && !!s.match(/^com\.widevine\.alpha/)),
                            s &&
                              ("audioRobustness" == r
                                ? (o = [e.h.defaultAudioRobustnessForWidevine])
                                : "videoRobustness" == r && (o = [e.h.defaultVideoRobustnessForWidevine])),
                            "string" == typeof o)
                          )
                            i.push(n);
                          else if (Array.isArray(o))
                            for (0 === o.length && (o = [""]), s = (o = g(o)).next(); !s.done; s = o.next()) {
                              var l = {};
                              i.push(Object.assign({}, n, ((l[r] = s.value), l)));
                            }
                        }
                        return i;
                      },
                        m = new WeakSet(),
                        v = g(t),
                        y = v.next();
                      !y.done;
                      y = v.next()
                    )
                      ((T = y.value).video &&
                        !m.has(T.video) &&
                        ((T.video.drmInfos = p(T.video.drmInfos, "videoRobustness")),
                        (T.video.drmInfos = p(T.video.drmInfos, "audioRobustness")),
                        m.add(T.video)),
                        T.audio &&
                          !m.has(T.audio) &&
                          ((T.audio.drmInfos = p(T.audio.drmInfos, "videoRobustness")),
                          (T.audio.drmInfos = p(T.audio.drmInfos, "audioRobustness")),
                          m.add(T.audio)));
                    return b(E, Yi(t, e.R, e.O, e.h.preferredKeySystems), 2);
                  }
                  return (
                    Jn(e.j),
                    i || n.size > 0
                      ? ((S = Aa(e, t)), E.return(i ? S : S.catch(function () {})))
                      : ((e.T = !0), E.return(Promise.resolve()))
                  );
                });
              }
              function Sa(e) {
                var t;
                return D(function (r) {
                  switch (r.g) {
                    case 1:
                      if (e.l.mediaKeys) return r.return();
                      if (!e.I) {
                        r.A(2);
                        break;
                      }
                      return b(r, e.I, 3);
                    case 3:
                      return (Jn(e.j), r.return());
                    case 2:
                      return (E(r, 4), (e.I = e.l.setMediaKeys(e.B)), b(r, e.I, 6));
                    case 6:
                      w(r, 5);
                      break;
                    case 4:
                      ((t = A(r)), e.u(new ze(2, 6, 6003, t.message)));
                    case 5:
                      (Jn(e.j), S(r));
                  }
                });
              }
              function Ea(e) {
                var t, r, i, n;
                return D(function (a) {
                  if (1 == a.g)
                    return e.C.size
                      ? (e.C.forEach(function (t, r) {
                          Ra(e, r, t);
                        }),
                        b(a, e.m, 3))
                      : a.A(2);
                  if (2 != a.g) {
                    if (
                      ((e.g && e.g.keyIds) || new Set([])).size > 0 &&
                      (function (e) {
                        for (
                          var t = g((e.g && e.g.keyIds) || new Set([])), r = t.next();
                          !r.done;
                          r = t.next()
                        )
                          if ("usable" !== e.ba.get(r.value)) return !1;
                        return !0;
                      })(e)
                    )
                      return a.return(e.m);
                    ((e.K = !1), (e.m = new kn()), e.m.catch(function () {}));
                  }
                  for (t = (e.g ? e.g.initData : []) || [], r = g(t), i = r.next(); !i.done; i = r.next())
                    ((n = i.value), xa(e, n.initDataType, n.initData));
                  return (Oa(e) && e.m.resolve(), a.return(e.m));
                });
              }
              function xa(e, t, r) {
                if (r.length) {
                  try {
                    r = e.h.initDataTransform(r, t, e.g);
                  } catch (s) {
                    return ((t = s), s instanceof ze || (t = new ze(2, 6, 6016, s)), void e.u(t));
                  }
                  if (e.h.ignoreDuplicateInitData) {
                    for (var i = e.i.values(), n = (i = g(i)).next(); !n.done; n = i.next())
                      if (_e(r, n.value.initData)) return;
                    var a = !1;
                    if (
                      (e.C.forEach(function (e) {
                        !a && _e(r, e.initData) && (a = !0);
                      }),
                      a)
                    )
                      return;
                  }
                  ((e.K = !0),
                    e.i.size > 0 &&
                      Oa(e) &&
                      (e.m.resolve(), (e.K = !1), (e.m = new kn()), e.m.catch(function () {})),
                    (function (e, t, r, i) {
                      try {
                        var n = e.B.createSession(i);
                      } catch (a) {
                        return void e.u(new ze(2, 6, 6005, a.message));
                      }
                      (e.o.D(n, "message", function (t) {
                        Ca(e) ? e.N.push(t) : La(e, t);
                      }),
                        e.o.D(n, "keystatuseschange", function (t) {
                          return Ma(e, t);
                        }),
                        e.i.set(n, {
                          initData: r,
                          initDataType: t,
                          loaded: !1,
                          Yg: 1 / 0,
                          Kb: null,
                          type: i,
                        }),
                        e.h.logLicenseExchange && nt(r),
                        n.generateRequest(t, r).catch(function (t) {
                          if (!e.j.g) {
                            e.i.delete(n);
                            var r = t.errorCode;
                            if (r && r.systemCode) {
                              var i = r.systemCode;
                              (i < 0 && (i += 4294967296), (i = "0x" + i.toString(16)));
                            }
                            e.u(new ze(2, 6, 6006, t.message, t, i));
                          }
                        }));
                    })(e, t, r, e.g.sessionType));
                }
              }
              function wa(e) {
                return (
                  (e = Zn((e = e.i.keys()), function (e) {
                    return e.sessionId;
                  })),
                  Array.from(e)
                );
              }
              function Aa(t, r) {
                var i, n, a, s, o, l;
                return D(function (u) {
                  switch (u.g) {
                    case 1:
                      if (
                        ((i = new Map()),
                        (n = (function (e, t, r) {
                          for (var i = g(t), n = i.next(); !n.done; n = i.next())
                            for (var a = (n = g(Pa(n.value))).next(); !a.done; a = n.next())
                              ((a = a.value),
                                r.has(a.keySystem) || r.set(a.keySystem, []),
                                r.get(a.keySystem).push(a));
                          if (1 == r.size && r.has("")) throw new ze(2, 6, 6e3);
                          (i = e.h.preferredKeySystems).length ||
                            (1 == (n = ea(e.h.servers)).size && (i = Array.from(n.keys())));
                          var s = (n = g(i)).next();
                          for (a = {}; !s.done; a = { Ki: void 0 }, s = n.next()) {
                            a.Ki = s.value;
                            for (var o = (s = g(t)).next(); !o.done; o = s.next())
                              if (
                                (o = o.value.decodingInfos.find(
                                  (function (e) {
                                    return function (t) {
                                      return (
                                        t.supported &&
                                        null != t.keySystemAccess &&
                                        t.keySystemAccess.keySystem == e.Ki
                                      );
                                    };
                                  })(a),
                                ))
                              )
                                return o.keySystemAccess;
                          }
                          for (n = g([!0, !1]), a = n.next(); !a.done; a = n.next())
                            for (a = a.value, s = g(t), o = s.next(); !o.done; o = s.next())
                              for (var l = (o = g(o.value.decodingInfos)).next(); !l.done; l = o.next())
                                if ((l = l.value).supported && l.keySystemAccess) {
                                  var u = l.keySystemAccess.keySystem;
                                  if (!i.includes(u)) {
                                    var d = r.get(u);
                                    for (
                                      !d && e.h.keySystemsMapping[u] && (d = r.get(e.h.keySystemsMapping[u])),
                                        d = (u = g(d)).next();
                                      !d.done;
                                      d = u.next()
                                    )
                                      if (!!d.value.licenseServerUri == a) return l.keySystemAccess;
                                  }
                                }
                          return null;
                        })(t, r, i)),
                        !n)
                      ) {
                        if (!navigator.requestMediaKeySystemAccess) throw new ze(2, 6, 6020);
                        throw new ze(2, 6, 6001);
                      }
                      (Jn(t.j), E(u, 2), n.getConfiguration());
                      var d = (a = t.h.keySystemsMapping[n.keySystem] || n.keySystem),
                        h = i.get(a),
                        c = [],
                        f = [],
                        p = [],
                        v = [],
                        y = [],
                        T = new Set(),
                        S = new Set();
                      !(function (t, r, i, n, a, s, o, l) {
                        for (
                          var u = [], d = (t = g(t)).next(), h = {};
                          !d.done;
                          h = { La: void 0 }, d = t.next()
                        ) {
                          if (
                            ((h.La = d.value),
                            r.includes(h.La.encryptionScheme) || r.push(h.La.encryptionScheme),
                            "org.w3.clearkey" == h.La.keySystem &&
                            h.La.licenseServerUri.startsWith("data:application/json;base64,")
                              ? u.includes(h.La.licenseServerUri) || u.push(h.La.licenseServerUri)
                              : i.includes(h.La.licenseServerUri) || i.push(h.La.licenseServerUri),
                            a.includes(h.La.serverCertificateUri) || a.push(h.La.serverCertificateUri),
                            h.La.serverCertificate &&
                              (n.some(
                                (function (e) {
                                  return function (t) {
                                    return _e(t, e.La.serverCertificate);
                                  };
                                })(h),
                              ) ||
                                n.push(h.La.serverCertificate)),
                            h.La.initData)
                          )
                            for (
                              var c = (d = g(h.La.initData)).next(), f = {};
                              !c.done;
                              f = { Pg: void 0 }, c = d.next()
                            )
                              ((f.Pg = c.value),
                                s.some(
                                  (function (e) {
                                    return function (t) {
                                      var r = e.Pg;
                                      return (
                                        !(!t.keyId || t.keyId != r.keyId) ||
                                        (t.initDataType == r.initDataType && _e(t.initData, r.initData))
                                      );
                                    };
                                  })(f),
                                ) || s.push(f.Pg));
                          if (h.La.keyIds)
                            for (c = (d = g(h.La.keyIds)).next(); !c.done; c = d.next()) o.add(c.value);
                          if (h.La.keySystemUris && l)
                            for (d = (h = g(h.La.keySystemUris)).next(); !d.done; d = h.next())
                              l.add(d.value);
                        }
                        if (1 == u.length) i.push(u[0]);
                        else if (u.length > 0) {
                          for (r = [], n = (u = g(u)).next(); !n.done; n = u.next())
                            ((n = e.atob(n.value.split("data:application/json;base64,").pop())),
                              (n = JSON.parse(n)),
                              r.push.apply(r, m(n.keys)));
                          ((u = JSON.stringify({ keys: r })),
                            i.push("data:application/json;base64," + e.btoa(u)));
                        }
                      })(h, c, f, v, p, y, T, S);
                      var x = t.R ? "persistent-license" : "temporary";
                      for (
                        d = {
                          keySystem: d,
                          encryptionScheme: c[0],
                          licenseServerUri: f[0],
                          distinctiveIdentifierRequired: h[0].distinctiveIdentifierRequired,
                          persistentStateRequired: h[0].persistentStateRequired,
                          sessionType: h[0].sessionType || x,
                          audioRobustness: h[0].audioRobustness || "",
                          videoRobustness: h[0].videoRobustness || "",
                          serverCertificate: v[0],
                          serverCertificateUri: p[0],
                          initData: y,
                          keyIds: T,
                          mediaTypes: h[0].mediaTypes,
                        },
                          S.size > 0 && (d.keySystemUris = S),
                          S = (h = g(h)).next();
                        !S.done;
                        S = h.next()
                      )
                        ((S = S.value).distinctiveIdentifierRequired &&
                          (d.distinctiveIdentifierRequired = S.distinctiveIdentifierRequired),
                          S.persistentStateRequired &&
                            (d.persistentStateRequired = S.persistentStateRequired));
                      if (((t.g = d), !t.g.licenseServerUri)) throw new ze(2, 6, 6012, t.g.keySystem);
                      return b(u, n.createMediaKeys(), 4);
                    case 4:
                      if (
                        ((s = u.h),
                        Jn(t.j),
                        (t.B = s),
                        "" == t.h.minHdcpVersion || !("getStatusForPolicy" in t.B))
                      ) {
                        u.A(5);
                        break;
                      }
                      return (
                        E(u, 6),
                        b(u, t.B.getStatusForPolicy({ minHdcpVersion: t.h.minHdcpVersion }), 8)
                      );
                    case 8:
                      if ("usable" != u.h) throw new ze(2, 6, 6018);
                      (Jn(t.j), w(u, 5, 2));
                      break;
                    case 6:
                      if ((o = A(u, 2)) instanceof ze) throw o;
                      throw new ze(2, 6, 6019, o.message);
                    case 5:
                      return (
                        (t.T = !0),
                        t.G.Ea(t.h.updateExpirationTime),
                        b(
                          u,
                          (function (e) {
                            var t, r;
                            return D(function (i) {
                              switch (i.g) {
                                case 1:
                                  if (!e.B || !e.g) return i.return();
                                  if (
                                    !e.g.serverCertificateUri ||
                                    (e.g.serverCertificate && e.g.serverCertificate.length)
                                  ) {
                                    i.A(2);
                                    break;
                                  }
                                  return (
                                    (t = Vn([e.g.serverCertificateUri], e.h.retryParameters)),
                                    E(i, 3),
                                    b(i, e.F.vc.request(5, t, { isPreload: e.V() }).promise, 5)
                                  );
                                case 5:
                                  ((r = i.h), (e.g.serverCertificate = Oe(r.data)), w(i, 4));
                                  break;
                                case 3:
                                  throw new ze(2, 6, 6017, A(i));
                                case 4:
                                  if (e.j.g) return i.return();
                                case 2:
                                  return e.g.serverCertificate && e.g.serverCertificate.length
                                    ? (E(i, 6), b(i, e.B.setServerCertificate(e.g.serverCertificate), 8))
                                    : i.return();
                                case 8:
                                  w(i, 0);
                                  break;
                                case 6:
                                  throw new ze(2, 6, 6004, A(i).message);
                              }
                            });
                          })(t),
                          9,
                        )
                      );
                    case 9:
                      (Jn(t.j), w(u, 0));
                      break;
                    case 2:
                      if (((l = A(u)), Jn(t.j, l), (t.g = null), l instanceof ze)) throw l;
                      throw new ze(2, 6, 6002, l.message);
                  }
                });
              }
              function Ia(e) {
                Oa(e) && e.m.resolve();
              }
              function ka(e, t) {
                new Ri(function () {
                  ((t.loaded = !0), Ia(e));
                }).ka(Ba);
              }
              function Ra(e, t, r) {
                var i, n, a, s, o, l, u;
                return D(function (d) {
                  switch (d.g) {
                    case 1:
                      try {
                        i = e.B.createSession("persistent-license");
                      } catch (h) {
                        return ((n = new ze(2, 6, 6005, h.message)), e.u(n), d.return(Promise.reject(n)));
                      }
                      return (
                        e.o.D(i, "message", function (t) {
                          Ca(e) ? e.N.push(t) : La(e, t);
                        }),
                        e.o.D(i, "keystatuseschange", function (t) {
                          return Ma(e, t);
                        }),
                        (a = {
                          initData: r.initData,
                          initDataType: r.initDataType,
                          loaded: !1,
                          Yg: 1 / 0,
                          Kb: null,
                          type: "persistent-license",
                        }),
                        e.i.set(i, a),
                        E(d, 2),
                        b(d, i.load(t), 4)
                      );
                    case 4:
                      return (
                        (s = d.h),
                        Jn(e.j),
                        s ||
                          (e.i.delete(i),
                          (o = e.h.persistentSessionOnlinePlayback ? 1 : 2),
                          e.u(new ze(o, 6, 6013)),
                          (a.loaded = !0)),
                        ka(e, a),
                        Ia(e),
                        d.return(i)
                      );
                    case 2:
                      ((l = A(d)),
                        Jn(e.j, l),
                        e.i.delete(i),
                        (u = e.h.persistentSessionOnlinePlayback ? 1 : 2),
                        e.u(new ze(u, 6, 6005, l.message)),
                        (a.loaded = !0),
                        Ia(e));
                    case 3:
                      return d.return(Promise.resolve());
                  }
                });
              }
              function Ca(e) {
                return e.l
                  ? e.h.delayLicenseRequestUntilPlayed && e.l.paused && !e.oa
                  : !e.$ && e.h.delayLicenseRequestUntilPlayed;
              }
              function La(e, t) {
                var r, i, n, a, s, o, l, u, d, h, c, f, p, m, v, y;
                D(function (T) {
                  switch (T.g) {
                    case 1:
                      if (
                        ((r = t.target),
                        e.h.logLicenseExchange && nt(t.message),
                        (i = e.i.get(r)),
                        (n = e.g.licenseServerUri),
                        (a = e.h.advanced[e.g.keySystem]),
                        "individualization-request" == t.messageType &&
                          a &&
                          a.individualizationServer &&
                          (n = a.individualizationServer),
                        ((s = Vn([n], e.h.retryParameters)).body = t.message),
                        (s.method = "POST"),
                        (s.licenseRequestType = t.messageType),
                        (s.sessionId = r.sessionId),
                        (s.drmInfo = e.g),
                        i && ((s.initData = i.initData), (s.initDataType = i.initDataType)),
                        a && a.headers)
                      )
                        for (o in a.headers) s.headers[o] = a.headers[o];
                      if ("org.w3.clearkey" === e.g.keySystem) {
                        var x = s,
                          I = e.g;
                        try {
                          var k = Qe(x.body);
                          if (k) {
                            var R = JSON.parse(k);
                            R.type || ((R.type = I.sessionType), (x.body = Je(JSON.stringify(R))));
                          }
                        } catch (C) {}
                      }
                      if (je(e.g.keySystem))
                        if ((x = Ye(s.body, !0, !0)).includes("PlayReadyKeyMessage")) {
                          for (
                            k = (I = g((I = ir((x = Yt(x, "PlayReadyKeyMessage")), "HttpHeader")))).next();
                            !k.done;
                            k = I.next()
                          )
                            ((k = ir((R = k.value), "name")[0]),
                              (R = ir(R, "value")[0]),
                              (s.headers[tr(k)] = tr(R)));
                          ((x = ir(x, "Challenge")[0]), (s.body = at(tr(x))));
                        } else s.headers["Content-Type"] = "text/xml; charset=utf-8";
                      return (
                        (l = Date.now()),
                        E(T, 2),
                        (d = e.F.vc.request(2, s, { isPreload: e.V() })),
                        e.X.push(d),
                        b(T, d.promise, 4)
                      );
                    case 4:
                      ((u = T.h), J(e.X, d), w(T, 3));
                      break;
                    case 2:
                      return (
                        (h = A(T)),
                        e.j.g ||
                          ((c = {
                            sessionId: r.sessionId,
                            sessionType: i.type,
                            initData: i.initData,
                            initDataType: i.initDataType,
                          }),
                          (f = new ze(2, 6, 6007, h, c)),
                          1 == e.i.size
                            ? (e.u(f), i && i.Kb && i.Kb.reject(f))
                            : (i && i.Kb && i.Kb.reject(f),
                              e.i.delete(r),
                              Oa(e) && (e.m.resolve(), e.M.ka(0.1)))),
                        T.return()
                      );
                    case 3:
                      return e.j.g
                        ? T.return()
                        : ((e.J += (Date.now() - l) / 1e3),
                          e.h.logLicenseExchange && nt(u.data),
                          E(T, 5),
                          b(T, r.update(u.data), 7));
                    case 7:
                      w(T, 6);
                      break;
                    case 5:
                      return (
                        (m = ((p = A(T)) && p.message) || String(p)),
                        (v = new ze(2, 6, 6008, m)),
                        e.u(v),
                        i && i.Kb && i.Kb.reject(v),
                        T.return()
                      );
                    case 6:
                      if (e.j.g) return T.return();
                      ((y = new Pn("drmsessionupdate")),
                        e.F.onEvent(y),
                        i && (i.Kb && i.Kb.resolve(), ka(e, i)),
                        S(T));
                  }
                });
              }
              function Ma(e, t) {
                t = t.target;
                var r = e.i.get(t),
                  i = !1;
                t.keyStatuses.forEach(function (t, n) {
                  if ("string" == typeof n) {
                    var a = n;
                    ((n = t), (t = a));
                  }
                  if (((a = se()), je(e.g.keySystem) && 16 == n.byteLength && a.Ff())) {
                    var s = (a = Fe(n)).getUint32(0, !0),
                      o = a.getUint16(4, !0),
                      l = a.getUint16(6, !0);
                    (a.setUint32(0, s, !1), a.setUint16(4, o, !1), a.setUint16(6, l, !1));
                  }
                  ("status-pending" != t && (r.loaded = !0),
                    "expired" == t && (i = !0),
                    (n = ot(n).slice(0, 32)),
                    e.ba.set(n, t));
                });
                var n = t.expiration - Date.now();
                ((n < 0 || (i && n < 1e3)) && r && !r.Kb && (e.i.delete(t), Da(t)),
                  Oa(e) && (e.m.resolve(), e.M.ka($a)));
              }
              function Da(e) {
                return D(function (t) {
                  return 1 == t.g
                    ? (E(t, 2), b(t, Di(Ua, Promise.all([e.close().catch(function () {}), e.closed])), 4))
                    : 2 != t.g
                      ? w(t, 0)
                      : (A(t), void S(t));
                });
              }
              function _a(e) {
                var t;
                return D(function (r) {
                  return (
                    (t = Array.from(e.i.entries())),
                    e.i.clear(),
                    b(
                      r,
                      Promise.all(
                        t.map(function (t) {
                          var r = (t = g(t)).next().value,
                            i = t.next().value;
                          return D(function (t) {
                            return 1 == t.g
                              ? (E(t, 2),
                                e.$ ||
                                e.C.has(r.sessionId) ||
                                "persistent-license" !== i.type ||
                                e.h.persistentSessionOnlinePlayback
                                  ? b(t, Da(r), 5)
                                  : b(t, r.remove(), 5))
                              : 2 != t.g
                                ? w(t, 0)
                                : (A(t), void S(t));
                          });
                        }),
                      ),
                      0,
                    )
                  );
                });
              }
              function Pa(e) {
                return (e.video ? e.video.drmInfos : []).concat(e.audio ? e.audio.drmInfos : []);
              }
              function Oa(e) {
                return (function (e, t) {
                  for (var r = (e = g(e)).next(); !r.done; r = e.next()) if (!t(r.value)) return !1;
                  return !0;
                })((e = e.i.values()), function (e) {
                  return e.loaded;
                });
              }
              function Na(t, r, i, n) {
                var a = t.keySystem;
                !a ||
                  ("org.w3.clearkey" == a && t.licenseServerUri) ||
                  (r.size && r.get(a) && ((r = r.get(a)), (t.licenseServerUri = r)),
                  t.keyIds || (t.keyIds = new Set()),
                  (i = i.get(a)) &&
                    (t.distinctiveIdentifierRequired ||
                      (t.distinctiveIdentifierRequired = i.distinctiveIdentifierRequired),
                    t.persistentStateRequired || (t.persistentStateRequired = i.persistentStateRequired),
                    t.serverCertificate || (t.serverCertificate = i.serverCertificate),
                    i.sessionType && (t.sessionType = i.sessionType),
                    t.serverCertificateUri || (t.serverCertificateUri = i.serverCertificateUri)),
                  n[a] && (t.keySystem = n[a]),
                  e.cast &&
                    e.cast.__platform__ &&
                    "com.microsoft.playready" == a &&
                    (t.keySystem = "com.chromecast.playready"));
              }
              function Fa(e, t) {
                if (0 != (e = ea(e)).size) {
                  e = ht(e);
                  for (var r = (t = g(t)).next(); !r.done; r = t.next())
                    ((r = r.value).video && (r.video.drmInfos = [e]), r.audio && (r.audio.drmInfos = [e]));
                }
              }
              (((n = ya.prototype).destroy = function () {
                return this.j.destroy();
              }),
                (n.configure = function (e, t) {
                  ((this.h = e),
                    t && (this.V = t),
                    this.G && this.T && this.g && this.G.Ea(this.h.updateExpirationTime));
                }),
                (n.Vb = function (e) {
                  var t,
                    r,
                    i = this;
                  return D(function (n) {
                    if (1 == n.g)
                      return i.l === e
                        ? n.return()
                        : i.B
                          ? ((i.l = e),
                            i.h.delayLicenseRequestUntilPlayed &&
                              i.o.Aa(i.l, "play", function () {
                                for (var e = g(i.N), t = e.next(); !t.done; t = e.next()) La(i, t.value);
                                ((i.oa = !0), (i.N = []));
                              }),
                            i.l.remote
                              ? (i.o.D(i.l.remote, "connect", function () {
                                  return _a(i);
                                }),
                                i.o.D(i.l.remote, "connecting", function () {
                                  return _a(i);
                                }),
                                i.o.D(i.l.remote, "disconnect", function () {
                                  return _a(i);
                                }))
                              : "webkitCurrentPlaybackTargetIsWireless" in i.l &&
                                i.o.D(i.l, "webkitcurrentplaybacktargetiswirelesschanged", function () {
                                  return _a(i);
                                }),
                            (i.H =
                              (i.g &&
                                i.g.initData.find(function (e) {
                                  return e.initData.length > 0;
                                })) ||
                              null),
                            (t = i.g.keySystem),
                            (r = se().Vg(t)) || (!i.H && "com.apple.fps" === i.g.keySystem && !i.C.size)
                              ? n.A(2)
                              : b(n, Sa(i), 2))
                          : (i.o.Aa(e, "encrypted", function () {
                              i.u(new ze(2, 6, 6010));
                            }),
                            n.return());
                    (Ea(i).catch(function () {}),
                      (!r && (i.H || i.C.size || i.h.parseInbandPsshEnabled)) ||
                        i.o.D(i.l, "encrypted", function (e) {
                          return (function (e, t) {
                            return D(function (r) {
                              if (1 == r.g) return b(r, Sa(e), 2);
                              (xa(e, t.initDataType, Oe(t.initData)), S(r));
                            });
                          })(i, e);
                        }),
                      S(n));
                  });
                }),
                (n.Kg = function () {
                  var e = this,
                    t = this.i.keys();
                  return (
                    (t = Zn(t, function (t) {
                      var r = e.i.get(t);
                      return {
                        sessionId: t.sessionId,
                        sessionType: r.type,
                        initData: r.initData,
                        initDataType: r.initDataType,
                      };
                    })),
                    Array.from(t)
                  );
                }),
                (n.Zd = function () {
                  for (var e = 1 / 0, t = this.i.keys(), r = (t = g(t)).next(); !r.done; r = t.next())
                    ((r = r.value), isNaN(r.expiration) || (e = Math.min(e, r.expiration)));
                  return e;
                }),
                (n.$e = function () {
                  return ta(this.ma);
                }));
              var Ua = 1,
                Ba = 5,
                $a = 0.5;
              function ja() {
                ((this.g = Ha), (this.j = new Map().set(Ha, 2).set(Va, 1)), (this.i = 0), (this.h = -1));
              }
              function Ga(e, t) {
                var r = e.g !== t;
                return ((e.g = t), r && t === Ha && (e.i = Date.now()), r);
              }
              var Va = 0,
                Ha = 1;
              /*
      		 @license
      		 Shaka Player
      		 Copyright 2023 Google LLC
      		 SPDX-License-Identifier: Apache-2.0
      		*/ function Ka(e, t, r) {
                ((this.h = e), (this.i = t), (this.g = r));
              }
              function Wa(e, t) {
                return D(function (r) {
                  if (1 == r.g)
                    return b(r, Wi(e.g, t, e.h.drm.preferredKeySystems, e.h.drm.keySystemsMapping), 2);
                  if (
                    (e.h.streaming.dontChooseCodecs ||
                      Hi(
                        t,
                        e.h.preferredVideoCodecs,
                        e.h.preferredAudioCodecs,
                        e.h.preferredDecodingAttributes,
                        e.h.preferredTextFormats,
                      ),
                    !t.variants.some(on))
                  )
                    throw new ze(2, 4, 4032);
                  return r.return(qa(e, t));
                });
              }
              function za(e, t) {
                var r = e.h.restrictions;
                e = e.i;
                for (var i = !1, n = (t = g(t.variants)).next(); !n.done; n = t.next()) {
                  var a = (n = n.value).allowedByApplication;
                  ((n.allowedByApplication = Ki(n, r, e)), a != n.allowedByApplication && (i = !0));
                }
                return i;
              }
              function qa(e, t) {
                var r = za(e, t);
                if (t) {
                  var i = e.g ? e.g.g : null;
                  if (i && e.g.B) {
                    for (var n = new Set(), a = g(t.variants), s = a.next(); !s.done; s = a.next())
                      ((s = s.value).audio && n.add(s.audio), s.video && n.add(s.video));
                    for (a = (n = g(n)).next(); !a.done; a = n.next()) Xa(e, i.keySystem, a.value);
                  }
                  Ya(e, t);
                }
                return r;
              }
              function Xa(e, t, r) {
                for (var i = (r = g(r.drmInfos)).next(); !i.done; i = r.next())
                  if ((i = i.value).keySystem == t) {
                    for (var n = g(i.initData || []), a = n.next(); !a.done; a = n.next())
                      ((a = a.value), xa(e.g, a.initDataType, a.initData));
                    (n = e.g).g && n.g.mediaTypes !== i.mediaTypes && (n.g.mediaTypes = i.mediaTypes);
                  }
              }
              function Ya(e, t) {
                function r(e) {
                  if (e && !o.has(e) && (o.add(e), e.keyIds.size))
                    for (var t = (e = g(e.keyIds)).next(); !t.done; t = e.next()) {
                      t = t.value;
                      var r = i[n ? "00" : t];
                      r ? Qa.includes(r) && s.add(r) : a.add(t);
                    }
                }
                var i = e.g ? e.g.$e() : {},
                  n = (e = Object.keys(i)).length && "00" == e[0];
                e = !1;
                for (
                  var a = new Set(), s = new Set(), o = new WeakSet(), l = (t = g(t.variants)).next();
                  !l.done;
                  l = t.next()
                ) {
                  if ((l = l.value).allowedByApplication) {
                    if (l.allowedByKeySystem) return;
                  } else e = !0;
                  (r(l.audio), r(l.video));
                }
                throw new ze(
                  2,
                  4,
                  4012,
                  (e = {
                    hasAppRestrictions: e,
                    missingKeys: Array.from(a),
                    restrictedKeyStatuses: Array.from(s),
                  }),
                );
              }
              var Qa = ["output-restricted", "internal-error"];
              function Ja(t) {
                if (es.has(t)) return es.get(t);
                var r = e.ManagedMediaSource || e.MediaSource;
                return !!r && ((r = r.isTypeSupported(t)), es.set(t, r), r);
              }
              function Za() {
                var t = e.ManagedMediaSource || e.MediaSource;
                return !!(
                  t &&
                  t.prototype &&
                  t.prototype.setLiveSeekableRange &&
                  t.prototype.clearLiveSeekableRange
                );
              }
              j("shaka.config.CodecSwitchingStrategy", { RELOAD: "reload", SMOOTH: "smooth" });
              var es = new Map();
              function ts(e, t) {
                var r = null,
                  i = null,
                  n = null,
                  a = null,
                  s = e.U();
                return (
                  1 & t && (n = e.Ed()),
                  2 & t && (a = e.U()),
                  8 & t && (r = e.U()),
                  16 & t && (i = e.U()),
                  { trackId: s, Wd: r, Xd: i, rj: n, Ri: a }
                );
              }
              function rs(e, t) {
                return 1 == t
                  ? { baseMediaDecodeTime: 4294967296 * (t = e.U()) + (e = e.U()) }
                  : { baseMediaDecodeTime: e.U() };
              }
              function is(e, t) {
                return (
                  1 == t ? (e.skip(8), e.skip(8)) : (e.skip(4), e.skip(4)),
                  (t = e.U()),
                  e.skip(4),
                  (e = e.Ca()),
                  {
                    timescale: t,
                    language:
                      String.fromCharCode(96 + (e >> 10)) +
                      String.fromCharCode(96 + ((960 & e) >> 5)) +
                      String.fromCharCode(96 + (31 & e)),
                  }
                );
              }
              function ns(e, t, r) {
                var i = e.U(),
                  n = [],
                  a = null;
                (1 & r && (a = e.dh()), 4 & r && e.skip(4));
                for (var s = 0; s < i; s++) {
                  var o = { nh: null, sampleSize: null, Gf: null };
                  (256 & r && (o.nh = e.U()),
                    512 & r && (o.sampleSize = e.U()),
                    1024 & r && e.skip(4),
                    2048 & r && (o.Gf = 0 == t ? e.U() : e.dh()),
                    n.push(o));
                }
                return { Hm: i, mh: n, qg: a };
              }
              function as(e) {
                (e.skip(6), e.skip(2), e.skip(8));
                var t = e.Ca();
                return (
                  e.skip(2),
                  e.skip(2),
                  e.skip(2),
                  { channelCount: t, sampleRate: (e = e.Ca() + e.Ca() / 65536) }
                );
              }
              function ss(e) {
                return { codec: ca((e = e.U())) };
              }
              function os(e, t) {
                return (
                  (t = void 0 !== t && t),
                  (e = e.toString(16).toUpperCase()),
                  t ? e : ("0" + e).slice(-2)
                );
              }
              function ls(e) {
                return (e < 10 ? "0" : "") + e;
              }
              function us(e) {
                this.g = e;
              }
              function ds(e) {
                for (var t = [], r = g(e.g), i = r.next(); !i.done; i = r.next()) {
                  var n = t,
                    a = n.push,
                    s = i.value;
                  i = bs;
                  var o = s.id + 1,
                    l = s.stream.width || 0,
                    u = s.stream.height || 0;
                  "audio" == s.type && (u = l = 0);
                  var d = s.duration * s.timescale,
                    h = Math.floor(d / (Ss + 1));
                  switch (
                    ((d = Math.floor(d % (Ss + 1))),
                    (o = bs(
                      "tkhd",
                      (o = new Uint8Array(
                        [1, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3].concat(
                          m(vs(o, 4)),
                          [0, 0, 0, 0],
                          m(vs(h, 4)),
                          m(vs(d, 4)),
                          [
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                            0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0,
                          ],
                          m(vs(l, 2)),
                          [0, 0],
                          m(vs(u, 2)),
                          [0, 0],
                        ),
                      )),
                    )),
                    (l = bs),
                    (h = s.duration * s.timescale),
                    (u = Math.floor(h / (Ss + 1))),
                    (h = Math.floor(h % (Ss + 1))),
                    (d =
                      (((d = s.stream.language).charCodeAt(0) - 96) << 10) |
                      ((d.charCodeAt(1) - 96) << 5) |
                      (d.charCodeAt(2) - 96)),
                    (u = bs(
                      "mdhd",
                      (u = new Uint8Array(
                        [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3].concat(
                          m(vs(s.timescale, 4)),
                          m(vs(u, 4)),
                          m(vs(h, 4)),
                          m(vs(d, 2)),
                          [0, 0],
                        ),
                      )),
                    )),
                    (h = s),
                    (d = new Uint8Array([])),
                    h.type)
                  ) {
                    case "video":
                      d = xs.value();
                      break;
                    case "audio":
                      d = ws.value();
                  }
                  h = bs("hdlr", d);
                  e: {
                    switch (s.type) {
                      case "video":
                        s = bs("minf", bs("vmhd", Cs.value()), _s.value(), hs(s));
                        break e;
                      case "audio":
                        s = bs("minf", bs("smhd", Ls.value()), _s.value(), hs(s));
                        break e;
                    }
                    s = new Uint8Array([]);
                  }
                  ((i = i("trak", o, (s = l("mdia", u, h, s)))), a.call(n, i));
                }
                for (
                  t = lt.apply(rt, m(t)),
                    r = bs,
                    i = (a = e.g[0]).duration * a.timescale,
                    n = Math.floor(i / (Ss + 1)),
                    i = Math.floor(i % (Ss + 1)),
                    n = bs(
                      "mvhd",
                      (n = new Uint8Array(
                        [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3].concat(
                          m(vs(a.timescale, 4)),
                          m(vs(n, 4)),
                          m(vs(i, 4)),
                          [
                            0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                            0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0,
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255,
                            255,
                          ],
                        ),
                      )),
                    ),
                    i = [],
                    l = (e = g(e.g)).next();
                  !l.done;
                  l = e.next()
                )
                  ((o = (s = i).push),
                    (l = bs(
                      "trex",
                      (l = new Uint8Array(
                        [0, 0, 0, 0].concat(
                          m(vs(l.value.id + 1, 4)),
                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                        ),
                      )),
                    )),
                    o.call(s, l));
                if (((e = bs("mvex", (e = lt.apply(rt, m(i))))), (i = []), a.encrypted)) {
                  for (s = (a = g(a.stream.drmInfos)).next(); !s.done; s = a.next())
                    if ((s = s.value).initData)
                      for (o = (s = g(s.initData)).next(); !o.done; o = s.next()) i.push(o.value.initData);
                  a = lt.apply(rt, m(i));
                } else a = new Uint8Array([]);
                return (
                  (e = r("moov", n, t, e, a)),
                  (t = Ds.value()),
                  (r = new Uint8Array(t.byteLength + e.byteLength)).set(t),
                  r.set(e, t.byteLength),
                  r
                );
              }
              function hs(e) {
                var t = bs,
                  r = "aac";
                e.codecs.includes("mp3")
                  ? (r = "mp3")
                  : e.codecs.includes("ac-3")
                    ? (r = se().se() ? "ec-3" : "ac-3")
                    : e.codecs.includes("ec-3")
                      ? (r = "ec-3")
                      : e.codecs.includes("opus") && (r = "opus");
                var i = new Uint8Array([]);
                switch (e.type) {
                  case "video":
                    if (e.codecs.includes("avc1")) {
                      if (((r = e.stream.width || 0), (i = e.stream.height || 0), e.Sa.byteLength > 0))
                        var n = bs("avcC", e.Sa);
                      else {
                        n = bs;
                        for (var a = 7, s = [], o = [], l = 0, u = 0, d = 0, h = 0; h < e.Bb.length; h++) {
                          var c = ys(e.Bb[h]);
                          switch (31 & c[0]) {
                            case 7:
                              (s.push(c), (a += c.length + 2));
                              break;
                            case 8:
                              (o.push(c), (a += c.length + 2));
                          }
                        }
                        for (
                          s.length > 0 && ((l = s[0][1]), (d = s[0][2]), (u = s[0][3])),
                            h = 0,
                            (a = new Uint8Array(a))[h++] = 1,
                            a[h++] = l,
                            a[h++] = d,
                            a[h++] = u,
                            a[h++] = 255,
                            a[h++] = 224 | s.length,
                            l = 0;
                          l < s.length;
                          l++
                        )
                          ((a[h++] = (65280 & s[l].length) >> 8),
                            (a[h++] = 255 & s[l].length),
                            a.set(s[l], h),
                            (h += s[l].length));
                        for (a[h++] = o.length, s = 0; s < o.length; s++)
                          ((a[h++] = (65280 & o[s].length) >> 8),
                            (a[h++] = 255 & o[s].length),
                            a.set(o[s], h),
                            (h += o[s].length));
                        n = n("avcC", a);
                      }
                      ((r = new Uint8Array(
                        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0].concat(
                          m(vs(r, 2)),
                          m(vs(i, 2)),
                          [
                            0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 19, 118, 105, 100, 101, 111, 106, 115,
                            45, 99, 111, 110, 116, 114, 105, 98, 45, 104, 108, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                            0, 0, 0, 0, 24, 17, 17,
                          ],
                        ),
                      )),
                        (i = "avc1"),
                        (o = cs(e)),
                        (s = new Uint8Array([])),
                        e.encrypted && ((s = ps(e.stream, e.codecs)), (i = "encv")),
                        (i = bs(i, r, n, o, s)));
                    } else
                      e.codecs.includes("hvc1") &&
                        ((i = e.stream.width || 0),
                        (n = e.stream.height || 0),
                        (r = new Uint8Array([])),
                        e.Sa.byteLength > 0 && (r = bs("hvcC", e.Sa)),
                        (i = new Uint8Array(
                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0].concat(
                            m(vs(i, 2)),
                            m(vs(n, 2)),
                            [
                              0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 19, 118, 105, 100, 101, 111, 106,
                              115, 45, 99, 111, 110, 116, 114, 105, 98, 45, 104, 108, 115, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 24, 17, 17,
                            ],
                          ),
                        )),
                        (n = "hvc1"),
                        (o = cs(e)),
                        (s = new Uint8Array([])),
                        e.encrypted && ((s = ps(e.stream, e.codecs)), (n = "encv")),
                        (i = bs(n, i, r, o, s)));
                    break;
                  case "audio":
                    ("mp3" == r
                      ? (e = bs(".mp3", fs(e)))
                      : "ac-3" == r
                        ? ((r = bs("dac3", e.Ga)),
                          (i = "ac-3"),
                          (n = new Uint8Array([])),
                          e.encrypted && ((n = ps(e.stream, e.codecs)), (i = "enca")),
                          (e = bs(i, fs(e), r, n)))
                        : "ec-3" == r
                          ? ((r = bs("dec3", e.Ga)),
                            (i = "ec-3"),
                            (n = new Uint8Array([])),
                            e.encrypted && ((n = ps(e.stream, e.codecs)), (i = "enca")),
                            (e = bs(i, fs(e), r, n)))
                          : "opus" == r
                            ? ((r = bs("dOps", e.Ga)),
                              (i = "Opus"),
                              (n = new Uint8Array([])),
                              e.encrypted && ((n = ps(e.stream, e.codecs)), (i = "enca")),
                              (e = bs(i, fs(e), r, n)))
                            : (e.Ga.byteLength > 0
                                ? (r = bs("esds", e.Ga))
                                : ((r = bs),
                                  (i = e.id + 1),
                                  (n = e.stream.channelsCount || 2),
                                  (s = e.stream.audioSamplingRate || 44100),
                                  (l = ct("audio", e.codecs.split(","))),
                                  (o = (u = {
                                    96e3: 0,
                                    88200: 1,
                                    64e3: 2,
                                    48e3: 3,
                                    44100: 4,
                                    32e3: 5,
                                    24e3: 6,
                                    22050: 7,
                                    16e3: 8,
                                    12e3: 9,
                                    11025: 10,
                                    8e3: 11,
                                    7350: 12,
                                  })[s]),
                                  ("mp4a.40.5" !== l && "mp4a.40.29" !== l) || (o = u[2 * s]),
                                  (s = parseInt(l.split(".").pop(), 10)),
                                  (r = r(
                                    "esds",
                                    (i = new Uint8Array(
                                      [0, 0, 0, 0, 3, 25].concat(m(vs(i, 2)), [
                                        0,
                                        4,
                                        17,
                                        64,
                                        21,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        0,
                                        5,
                                        2,
                                        (s << 3) | (o >>> 1),
                                        (o << 7) | (n << 3),
                                        6,
                                        1,
                                        2,
                                      ]),
                                    )),
                                  ))),
                              (i = "mp4a"),
                              (n = new Uint8Array([])),
                              e.encrypted && ((n = ps(e.stream, e.codecs)), (i = "enca")),
                              (e = bs(i, fs(e), r, n))),
                      (i = e));
                }
                return t(
                  "stbl",
                  (e = bs("stsd", Ms.value(), i)),
                  bs("stts", As.value()),
                  bs("stsc", Is.value()),
                  bs("stsz", Rs.value()),
                  bs("stco", ks.value()),
                );
              }
              function cs(e) {
                if (!e.Za && !e.$a) return new Uint8Array([]);
                var t = e.$a;
                return bs("pasp", (e = new Uint8Array([].concat(m(vs(e.Za, 4)), m(vs(t, 4))))));
              }
              function fs(e) {
                return new Uint8Array(
                  [
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    1,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    e.stream.channelsCount || 2,
                    0,
                    16,
                    0,
                    0,
                    0,
                    0,
                  ].concat(m(vs(e.stream.audioSamplingRate || 44100, 2)), [0, 0]),
                );
              }
              function ps(e, t) {
                var r = bs;
                t = bs("frma", (t = new Uint8Array([].concat(m(vs(Ts(t.split(".")[0]), 4))))));
                var i = "cenc",
                  n = e.drmInfos[0];
                (n && n.encryptionScheme && (i = n.encryptionScheme),
                  (i = bs("schm", (i = new Uint8Array([0, 0, 0, 0].concat(m(vs(Ts(i), 4)), [0, 1, 0, 0]))))),
                  (n = bs));
                for (
                  var a = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]),
                    s = (e = g(e.drmInfos)).next();
                  !s.done;
                  s = e.next()
                )
                  if ((s = s.value) && s.keyIds && s.keyIds.size)
                    for (var o = (s = g(s.keyIds)).next(); !o.done; o = s.next()) a = ys(o.value);
                return r(
                  "sinf",
                  t,
                  i,
                  n("schi", (a = bs("tenc", (e = new Uint8Array([0, 0, 0, 0, 0, 0, 1, 8])), a))),
                );
              }
              function gs(e) {
                for (var t = [], r = (e = g(e.g)).next(); !r.done; r = e.next()) {
                  r = r.value;
                  var i,
                    n = t.push,
                    a = n.apply,
                    s = bs,
                    o = new Uint8Array([0, 0, 0, 0].concat(m(vs(r.data ? r.data.sequenceNumber : 0, 4))));
                  o = bs("mfhd", o);
                  var l = r.data ? r.data.zb : [],
                    u = new Uint8Array(4 + l.length);
                  for (i = 0; i < l.length; i++) {
                    var d = l[i].flags;
                    u[i + 4] = (d.ib << 4) | (d.mb << 2) | d.jb;
                  }
                  var h = (l = bs("sdtp", u)).length + 32 + 20 + 8 + 16 + 8 + 8;
                  ((u = bs),
                    (i = bs(
                      "tfhd",
                      (i = new Uint8Array(
                        [0, 0, 0, 58].concat(
                          m(vs(r.id + 1, 4)),
                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                        ),
                      )),
                    )),
                    (d = r.data ? r.data.baseMediaDecodeTime : 0));
                  var c = Math.floor(d % (Ss + 1));
                  d = bs(
                    "tfdt",
                    (d = new Uint8Array(
                      [1, 0, 0, 0].concat(m(vs(Math.floor(d / (Ss + 1)), 4)), m(vs(c, 4))),
                    )),
                  );
                  var f = h,
                    p = 12 + 16 * (c = (h = r.data ? r.data.zb : []).length),
                    v = new Uint8Array(p);
                  for (
                    f += 8 + p,
                      v.set(["video" === r.type ? 1 : 0, 0, 15, 1].concat(m(vs(c, 4)), m(vs(f, 4))), 0),
                      f = 0;
                    f < c;
                    f++
                  ) {
                    var y = h[f];
                    p = vs(y.duration, 4);
                    var T = vs(y.size, 4),
                      b = y.flags;
                    ((y = vs(y.sb, 4)),
                      v.set(
                        [].concat(
                          m(p),
                          m(T),
                          [(b.xb << 2) | b.ib, (b.mb << 6) | (b.jb << 4) | b.yb, 61440 & b.hb, 15 & b.hb],
                          m(y),
                        ),
                        12 + 16 * f,
                      ));
                  }
                  ((s = s("moof", o, (l = u("traf", i, d, (h = bs("trun", v)), l)))),
                    a.call(n, t, [s, ms(r)]));
                }
                return lt.apply(rt, m(t));
              }
              function ms(e) {
                return (
                  (e = (e.data ? e.data.zb : []).map(function (e) {
                    return e.data;
                  })),
                  bs("mdat", (e = lt.apply(rt, m(e))))
                );
              }
              function vs(e, t) {
                var r = [];
                for (--t; t >= 0; t--) r.push((e >> (8 * t)) & 255);
                return r;
              }
              function ys(e) {
                for (var t = new Uint8Array(e.length / 2), r = 0; r < e.length / 2; r += 1)
                  t[r] = parseInt(String(e[2 * r] + e[2 * r + 1]), 16);
                return t;
              }
              function Ts(e) {
                for (var t = 0, r = 0; r < e.length; r += 1) t |= e.charCodeAt(r) << (8 * (e.length - r - 1));
                return t;
              }
              function bs(e) {
                var t = _.apply(1, arguments),
                  r = Es.get(e);
                r ||
                  ((r = [e.charCodeAt(0), e.charCodeAt(1), e.charCodeAt(2), e.charCodeAt(3)]), Es.set(e, r));
                for (var i = 8, n = t.length - 1; n >= 0; n--) i += t[n].byteLength;
                for (
                  (n = new Uint8Array(i))[0] = (i >> 24) & 255,
                    n[1] = (i >> 16) & 255,
                    n[2] = (i >> 8) & 255,
                    n[3] = 255 & i,
                    n.set(r, 4),
                    r = 0,
                    i = 8;
                  r < t.length;
                  r++
                )
                  (n.set(t[r], i), (i += t[r].byteLength));
                return n;
              }
              var Ss = 4294967295,
                Es = new Map(),
                xs = new ae(function () {
                  return new Uint8Array([
                    0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105,
                    100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0,
                  ]);
                }),
                ws = new ae(function () {
                  return new Uint8Array([
                    0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111,
                    117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0,
                  ]);
                }),
                As = new ae(function () {
                  return new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
                }),
                Is = new ae(function () {
                  return new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
                }),
                ks = new ae(function () {
                  return new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
                }),
                Rs = new ae(function () {
                  return new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
                }),
                Cs = new ae(function () {
                  return new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]);
                }),
                Ls = new ae(function () {
                  return new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
                }),
                Ms = new ae(function () {
                  return new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]);
                }),
                Ds = new ae(function () {
                  var e = new Uint8Array([105, 115, 111, 109]),
                    t = new Uint8Array([97, 118, 99, 49]);
                  return bs("ftyp", e, new Uint8Array([0, 0, 0, 1]), e, t);
                }),
                _s = new ae(function () {
                  var e = new Uint8Array([
                    0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1,
                  ]);
                  return ((e = bs("dref", e)), bs("dinf", e));
                });
              function Ps(e) {
                function t(e) {
                  (s.push(e), sa(e));
                }
                var r,
                  i,
                  n,
                  a,
                  s = [];
                if (
                  (new aa()
                    .box("moof", t)
                    .box("traf", t)
                    .S("tfhd", function (e) {
                      ((r = e), (n = ts(e.reader, e.flags)));
                    })
                    .S("trun", function (e) {
                      ((i = e), (a = ns(e.reader, e.version, e.flags)));
                    })
                    .parse(e),
                  n && 2 !== n.Ri)
                ) {
                  var o = r.start + fa(r) + 4 + (null !== n.rj ? 8 : 0),
                    l = Fe(e);
                  if (null !== n.Ri) l.setUint32(o, 2);
                  else {
                    Ns(e, r.start, r.size + 4);
                    var u = l.getUint32(r.start + 8);
                    (l.setUint32(r.start + 8, 2 | u),
                      a && null !== a.qg && l.setInt32(i.start + fa(i) + 4, a.qg + 4),
                      (u = e.subarray(0, o)),
                      (l = e.subarray(o)),
                      (e = new Uint8Array(e.byteLength + 4)).set(u),
                      (u = []));
                    for (var d = 3; d >= 0; d--) u.push((2 >> (8 * d)) & 255);
                    for (
                      e.set(new Uint8Array(u), o), e.set(l, o + 4), l = (o = g(s)).next();
                      !l.done;
                      l = o.next()
                    )
                      Ns(e, (l = l.value).start, l.size + 4);
                  }
                }
                return e;
              }
              function Os(e, t, r, i, n, a) {
                var s = ps(e, i.name),
                  o = t.subarray(i.start, i.start + i.size);
                for (
                  (e = new Uint8Array(i.size + s.byteLength)).set(o, 0),
                    Fe(e).setUint32(4, a),
                    e.set(s, i.size),
                    Ns(e, 0, e.byteLength),
                    a = new Uint8Array(t.byteLength + e.byteLength),
                    i = se().jf() ? i.start : i.start + i.size,
                    s = t.subarray(i),
                    a.set(t.subarray(0, i)),
                    a.set(e, i),
                    a.set(s, i + e.byteLength),
                    n = (t = g(n)).next();
                  !n.done;
                  n = t.next()
                )
                  Ns(a, (n = n.value).start, n.size + e.byteLength);
                return ((e = Fe(a, r.start)), (r = fa(r)), (t = e.getUint32(r)), e.setUint32(r, t + 1), a);
              }
              function Ns(e, t, r) {
                0 != (t = (e = Fe(e, t)).getUint32(0)) &&
                  (1 == t ? (e.setUint32(8, r >> 32), e.setUint32(12, 4294967295 & r)) : e.setUint32(0, r));
              }
              function Fs(e, t, r, i, n, a, s, o) {
                ((this.P = e),
                  (this.startByte = t),
                  (this.endByte = r),
                  (this.xd = void 0 === i ? null : i),
                  (this.timescale = void 0 === n ? null : n),
                  (this.h = void 0 === a ? null : a),
                  (this.aesKey = void 0 === s ? null : s),
                  (this.g = this.mimeType = this.codecs = null),
                  (this.encrypted = void 0 !== o && o));
              }
              function Us(e, t) {
                return (
                  e === t ||
                  (e && t
                    ? e.Jc() == t.Jc() &&
                      e.Hc() == t.Hc() &&
                      ee(e.P().sort(), t.P().sort()) &&
                      _e(e.$b(), t.$b())
                    : e == t)
                );
              }
              function Bs(e, t, r, i, n, a, s, o, l, u, d, h, c, f, p, m) {
                for (
                  u = void 0 === u ? [] : u,
                    f = void 0 === f ? Gs : f,
                    this.startTime = e,
                    this.j = this.endTime = t,
                    this.C = r,
                    this.startByte = i,
                    this.endByte = n,
                    this.ea = a,
                    this.timestampOffset = s,
                    this.appendWindowStart = o,
                    this.appendWindowEnd = l,
                    this.g = u,
                    this.tilesLayout = void 0 === d ? "" : d,
                    this.B = void 0 === h ? null : h,
                    this.h = void 0 === c ? null : c,
                    this.status = f,
                    this.preload = !1,
                    this.l = !0,
                    this.o = !1,
                    this.aesKey = void 0 === p ? null : p,
                    this.thumbnailSprite = null,
                    this.i = -1,
                    this.m = void 0 !== m && m,
                    this.je = this.Xc = !1,
                    t = (e = g(this.g)).next();
                  !t.done;
                  t = e.next()
                )
                  t.value.Ai();
                (this.m && this.g.length && this.g[this.g.length - 1].zi(),
                  (this.u = this.bandwidth = this.mimeType = this.codecs = null),
                  (this.F = !1));
              }
              function $s(e) {
                if (e.endByte) return e.endByte + 1 - e.startByte;
                if (e.bandwidth) {
                  var t = e.bandwidth * (e.endTime - e.startTime);
                  if (!isNaN(t) && t > 0) return t;
                }
                if (e.g.length > 0 && e.m)
                  for (e = (e = g(e.g)).next(); !e.done; e = e.next()) {
                    $s(e.value);
                    break;
                  }
                return null;
              }
              function js(e, t) {
                e.ea = t;
                for (var r = (e = g(e.g)).next(); !r.done; r = e.next()) js(r.value, t);
              }
              ((Fs.prototype.Jc = function () {
                return this.startByte;
              }),
                (Fs.prototype.Hc = function () {
                  return this.endByte;
                }),
                (Fs.prototype.ue = function (e) {
                  this.h = e;
                }),
                (Fs.prototype.$b = function () {
                  return this.h;
                }),
                j("shaka.media.InitSegmentReference", Fs),
                (Fs.prototype.getEndByte = Fs.prototype.Hc),
                (Fs.prototype.getStartByte = Fs.prototype.Jc),
                ((n = Bs.prototype).P = function () {
                  return this.C();
                }),
                (n.getStartTime = function () {
                  return this.startTime;
                }),
                (n.Kj = function () {
                  return this.endTime;
                }),
                (n.Jc = function () {
                  return this.startByte;
                }),
                (n.Hc = function () {
                  return this.endByte;
                }),
                (n.ek = function () {
                  return this.tilesLayout;
                }),
                (n.dk = function () {
                  return this.B;
                }),
                (n.Kc = function () {
                  return this.status;
                }),
                (n.Ak = function () {
                  this.status = Vs;
                }),
                (n.Ug = function () {
                  this.preload = !0;
                }),
                (n.isPreload = function () {
                  return this.preload;
                }),
                (n.wd = function () {
                  this.l = !1;
                }),
                (n.qk = function () {
                  return this.l;
                }),
                (n.Ai = function () {
                  this.Xc = !0;
                }),
                (n.tk = function () {
                  return this.Xc;
                }),
                (n.zi = function () {
                  this.je = !0;
                }),
                (n.rk = function () {
                  return this.je;
                }),
                (n.xi = function () {
                  this.o = !0;
                }),
                (n.kk = function () {
                  return this.o;
                }),
                (n.Mf = function (e) {
                  this.thumbnailSprite = e;
                }),
                (n.bk = function () {
                  return this.thumbnailSprite;
                }),
                (n.offset = function (e) {
                  ((this.startTime += e), (this.endTime += e), (this.j += e));
                  for (var t = g(this.g), r = t.next(); !r.done; r = t.next())
                    (((r = r.value).startTime += e), (r.endTime += e), (r.j += e));
                }),
                (n.Dh = function (e) {
                  null == this.h
                    ? W("Sync attempted without sync time!")
                    : ((e = this.h - e - this.startTime), Math.abs(e) >= 0.001 && this.offset(e));
                }),
                (n.ue = function (e, t) {
                  ((this.u = e), (this.F = void 0 !== t && t));
                }),
                (n.$b = function (e) {
                  var t = this.u;
                  return ((void 0 === e || e) && this.F && (this.u = null), t);
                }),
                j("shaka.media.SegmentReference", Bs),
                (Bs.prototype.getSegmentData = Bs.prototype.$b),
                (Bs.prototype.setSegmentData = Bs.prototype.ue),
                (Bs.prototype.syncAgainst = Bs.prototype.Dh),
                (Bs.prototype.offset = Bs.prototype.offset),
                (Bs.prototype.getThumbnailSprite = Bs.prototype.bk),
                (Bs.prototype.setThumbnailSprite = Bs.prototype.Mf),
                (Bs.prototype.hasByterangeOptimization = Bs.prototype.kk),
                (Bs.prototype.markAsByterangeOptimization = Bs.prototype.xi),
                (Bs.prototype.isLastPartial = Bs.prototype.rk),
                (Bs.prototype.markAsLastPartial = Bs.prototype.zi),
                (Bs.prototype.isPartial = Bs.prototype.tk),
                (Bs.prototype.markAsPartial = Bs.prototype.Ai),
                (Bs.prototype.isIndependent = Bs.prototype.qk),
                (Bs.prototype.markAsNonIndependent = Bs.prototype.wd),
                (Bs.prototype.isPreload = Bs.prototype.isPreload),
                (Bs.prototype.markAsPreload = Bs.prototype.Ug),
                (Bs.prototype.markAsUnavailable = Bs.prototype.Ak),
                (Bs.prototype.getStatus = Bs.prototype.Kc),
                (Bs.prototype.getTileDuration = Bs.prototype.dk),
                (Bs.prototype.getTilesLayout = Bs.prototype.ek),
                (Bs.prototype.getEndByte = Bs.prototype.Hc),
                (Bs.prototype.getStartByte = Bs.prototype.Jc),
                (Bs.prototype.getEndTime = Bs.prototype.Kj),
                (Bs.prototype.getStartTime = Bs.prototype.getStartTime),
                (Bs.prototype.getUris = Bs.prototype.P));
              var Gs = 0,
                Vs = 1;
              function Hs(e) {
                return 1 == e.length && e.end(0) - e.start(0) < 1e-4;
              }
              function Ks(e) {
                return !e || Hs(e)
                  ? null
                  : 1 == e.length && e.start(0) < 0
                    ? 0
                    : e.length
                      ? e.start(0)
                      : null;
              }
              function Ws(e) {
                return !e || Hs(e) ? null : e.length ? e.end(e.length - 1) : null;
              }
              function zs(e, t) {
                return !(!e || !e.length || Hs(e) || t > e.end(e.length - 1)) && t >= e.start(0);
              }
              function qs(e, t) {
                if (!e || !e.length || Hs(e)) return 0;
                for (var r = 0, i = (e = g(Xs(e))).next(); !i.done; i = e.next()) {
                  var n = i.value;
                  ((i = n.start), (n = n.end) > t && (r += n - Math.max(i, t)));
                }
                return r;
              }
              function Xs(e) {
                if (!e) return [];
                for (var t = [], r = 0; r < e.length; r++) t.push({ start: e.start(r), end: e.end(r) });
                return t;
              }
              function Ys() {}
              function Qs(e, t) {
                var r = document.createElement("source");
                return ((r.src = e), (r.type = void 0 === t ? "" : t), r);
              }
              function Js(e) {
                for (var t = !1, r = e.getElementsByTagName("source"), i = r.length - 1; i >= 0; --i)
                  (e.removeChild(r[i]), (t = !0));
                return (e.src && (e.removeAttribute("src"), (t = !0)), t);
              }
              function Zs(e) {
                for (; e.firstChild; ) e.removeChild(e.firstChild);
              }
              function eo() {
                return (
                  ro ||
                  (to ||
                    (to = new Ri(function () {
                      ro = null;
                    })),
                  (ro =
                    document.getElementsByTagName("video")[0] || document.getElementsByTagName("audio")[0]) ||
                    (ro = document.createElement("video")),
                  to.ka(1),
                  ro)
                );
              }
              ((Bs.Status = { vl: Gs, Am: Vs, Wl: 2 }),
                j("shaka.util.Dom", Ys),
                (Ys.removeAllChildren = Zs),
                (Ys.clearSourceFromVideo = Js));
              var to = null,
                ro = null;
              /*
      		 @license
      		 Shaka Player
      		 Copyright 2022 Google LLC
      		 SPDX-License-Identifier: Apache-2.0
      		*/ function io() {}
              function no(e, t) {
                return (
                  t + 10 <= e.length &&
                  73 === e[t] &&
                  68 === e[t + 1] &&
                  51 === e[t + 2] &&
                  e[t + 3] < 255 &&
                  e[t + 4] < 255 &&
                  e[t + 6] < 128 &&
                  e[t + 7] < 128 &&
                  e[t + 8] < 128 &&
                  e[t + 9] < 128
                );
              }
              function ao(e, t) {
                return (
                  t + 10 <= e.length &&
                  51 === e[t] &&
                  68 === e[t + 1] &&
                  73 === e[t + 2] &&
                  e[t + 3] < 255 &&
                  e[t + 4] < 255 &&
                  e[t + 6] < 128 &&
                  e[t + 7] < 128 &&
                  e[t + 8] < 128 &&
                  e[t + 9] < 128
                );
              }
              function so(e, t) {
                var r = (127 & e[t]) << 21;
                return ((r |= (127 & e[t + 1]) << 14), (r |= (127 & e[t + 2]) << 7) | (127 & e[t + 3]));
              }
              function oo(e) {
                var t = { key: e.type, description: "", data: "", mimeType: null, pictureType: null };
                if ("APIC" === e.type) {
                  if (e.size < 2 || 3 !== e.data[0]) return null;
                  var r = e.data.subarray(1).indexOf(0);
                  if (-1 === r) return null;
                  var i = Xe(Oe(e.data, 1, r)),
                    n = e.data[2 + r],
                    a = e.data.subarray(3 + r).indexOf(0);
                  if (-1 === a) return null;
                  var s,
                    o = Xe(Oe(e.data, 3 + r, a));
                  return (
                    (s = "--\x3e" === i ? Xe(Oe(e.data, 4 + r + a)) : Pe(e.data.subarray(4 + r + a))),
                    (t.mimeType = i),
                    (t.pictureType = n),
                    (t.description = o),
                    (t.data = s),
                    t
                  );
                }
                return "TXXX" === e.type || "WXXX" === e.type
                  ? e.size < 2 || 3 !== e.data[0] || -1 === (i = e.data.subarray(1).indexOf(0))
                    ? null
                    : ((r = Xe(Oe(e.data, 1, i))),
                      (e = Xe(Oe(e.data, 2 + i)).replace(/\0*$/, "")),
                      (t.description = r),
                      (t.data = e),
                      t)
                  : "PRIV" === e.type
                    ? e.size < 2 || -1 === (r = e.data.indexOf(0))
                      ? null
                      : ((r = Xe(Oe(e.data, 0, r))),
                        (t.description = r),
                        "com.apple.streaming.transportStreamTimestamp" == r
                          ? ((r = e.data.subarray(r.length + 1)),
                            (e = 1 & r[3]),
                            (r = (r[4] << 23) + (r[5] << 15) + (r[6] << 7) + r[7]),
                            (r /= 45),
                            e && (r += 47721858.84),
                            (t.data = r))
                          : ((e = Pe(e.data.subarray(r.length + 1))), (t.data = e)),
                        t)
                    : "T" === e.type[0]
                      ? e.size < 2 || 3 !== e.data[0]
                        ? null
                        : ((e = Xe(e.data.subarray(1)).replace(/\0*$/, "")), (t.data = e), t)
                      : "W" === e.type[0]
                        ? ((e = Xe(e.data).replace(/\0*$/, "")), (t.data = e), t)
                        : e.data
                          ? ((t.data = Pe(e.data)), t)
                          : null;
              }
              function lo(e) {
                for (var t = 0, r = []; no(e, t); ) {
                  var i = so(e, t + 6);
                  for ((e[t + 5] >> 6) & 1 && (t += 10), i = (t += 10) + i; t + 10 < i; ) {
                    var n = e.subarray(t),
                      a = so(n, 4);
                    ((a = oo(
                      (n = {
                        type: String.fromCharCode(n[0], n[1], n[2], n[3]),
                        size: a,
                        data: n.subarray(10, 10 + a),
                      }),
                    )) && r.push(a),
                      (t += n.size + 10));
                  }
                  ao(e, t) && (t += 10);
                }
                return r;
              }
              function uo(e, t) {
                for (var r = (t = void 0 === t ? 0 : t), i = 0; no(e, t); )
                  ((e[t + 5] >> 6) & 1 && (i += 10),
                    (i += 10),
                    (i += so(e, t + 6)),
                    ao(e, t + 10) && (i += 10),
                    (t += i));
                return i > 0 ? e.subarray(r, r + i) : new Uint8Array([]);
              }
              function ho(e) {
                return new Date(Date.UTC(1900, 0, 1, 0, 0, 0, 0) + e).getTime();
              }
              function co(e, t) {
                if (((this.j = e), void 0 !== t && t)) {
                  t = new Uint8Array(e.byteLength);
                  for (var r = 0, i = 0; i < e.byteLength; i++)
                    (i >= 2 && 3 == e[i] && 0 == e[i - 1] && 0 == e[i - 2]) || ((t[r] = e[i]), r++);
                  this.j = Oe(t, 0, r);
                }
                ((this.i = this.j.byteLength), (this.g = this.h = 0));
              }
              function fo(e) {
                var t = e.j.byteLength - e.i,
                  r = new Uint8Array(4),
                  i = Math.min(4, e.i);
                0 !== i &&
                  (r.set(e.j.subarray(t, t + i)), (e.h = new ra(r, 0).U()), (e.g = 8 * i), (e.i -= i));
              }
              function po(e, t) {
                if (e.g <= t) {
                  t -= e.g;
                  var r = Math.floor(t / 8);
                  ((t -= 8 * r), (e.g -= r), fo(e));
                }
                ((e.h <<= t), (e.g -= t));
              }
              function go(e, t) {
                var r = Math.min(e.g, t),
                  i = e.h >>> (32 - r);
                return (
                  (e.g -= r),
                  e.g > 0 ? (e.h <<= r) : e.i > 0 && fo(e),
                  (r = t - r) > 0 ? (i << r) | go(e, r) : i
                );
              }
              function mo(e) {
                var t;
                for (t = 0; t < e.g; ++t) if (e.h & (2147483648 >>> t)) return ((e.h <<= t), (e.g -= t), t);
                return (fo(e), t + mo(e));
              }
              function vo(e) {
                po(e, 1 + mo(e));
              }
              function yo(e) {
                return go(e, mo(e) + 1) - 1;
              }
              function To(e) {
                return 1 & (e = yo(e)) ? (1 + e) >>> 1 : -1 * (e >>> 1);
              }
              function bo(e) {
                return 1 === go(e, 1);
              }
              function So(e) {
                return go(e, 8);
              }
              function Eo(e, t) {
                for (var r = 8, i = 8, n = 0; n < t; n++)
                  (0 !== i && (i = (r + (i = To(e)) + 256) % 256), (r = 0 === i ? r : i));
              }
              function xo(e) {
                return (So(e), yo(e), yo(e));
              }
              function wo() {
                ((this.I = null),
                  (this.J = !1),
                  (this.m = this.K = null),
                  (this.j = []),
                  (this.g = []),
                  (this.C = this.F = null),
                  (this.i = []),
                  (this.h = []),
                  (this.G = null),
                  (this.l = []),
                  (this.B = this.H = this.o = this.u = null));
              }
              function Ao(e, t) {
                if (1 != ((t[0] << 16) | (t[1] << 8) | t[2])) return null;
                var r = {
                  data: new Uint8Array(0),
                  packetLength: (t[4] << 8) | t[5],
                  pts: null,
                  dts: null,
                  nalus: [],
                };
                if (r.packetLength && r.packetLength > t.byteLength - 6) return null;
                var i = t[7];
                if (192 & i) {
                  var n =
                    536870912 * (14 & t[9]) +
                    4194304 * (255 & t[10]) +
                    16384 * (254 & t[11]) +
                    128 * (255 & t[12]) +
                    (254 & t[13]) / 2;
                  (null == e.u && (e.u = n),
                    (r.pts = ko(n, e.u)),
                    (e.u = r.pts),
                    (r.dts = r.pts),
                    64 & i &&
                      ((i =
                        536870912 * (14 & t[14]) +
                        4194304 * (255 & t[15]) +
                        16384 * (254 & t[16]) +
                        128 * (255 & t[17]) +
                        (254 & t[18]) / 2),
                      null == e.o && (e.o = i),
                      (r.dts = r.pts != n ? ko(i, e.o) : i)),
                    (e.o = r.dts));
                }
                return ((e = t[8] + 9), t.byteLength <= e ? null : ((r.data = t.subarray(e)), r));
              }
              function Io(e) {
                var t = e.ud();
                return t.length > 1 && ((e = t[0].pts), (t = t[1].pts), !isNaN(t - e))
                  ? String(Math.abs((1 / (t - e)) * 9e4))
                  : null;
              }
              function ko(e, t) {
                var r = 1;
                for (e > t && (r = -1); Math.abs(t - e) > 4294967296; ) e += 8589934592 * r;
                return e;
              }
              function Ro(e) {
                return !(Co(e) < 0);
              }
              function Co(e) {
                for (var t = Math.min(1e3, e.length - 564), r = 0; r < t; ) {
                  if (71 == e[r] && 71 == e[r + 188] && 71 == e[r + 376]) return r;
                  r++;
                }
                return -1;
              }
              (j("shaka.util.Id3Utils", io),
                (io.getID3Data = uo),
                (io.getID3Frames = lo),
                j("shaka.util.ExpGolomb", co),
                ((n = wo.prototype).clearData = function () {
                  ((this.j = []), (this.g = []), (this.i = []), (this.h = []), (this.l = []));
                }),
                (n.Kf = function (e) {
                  (null != this.B && this.B != e && (this.o = this.u = null), (this.B = e));
                }),
                (n.parse = function (e) {
                  if (e.length < 564) return this;
                  for (
                    var t = Math.max(0, Co(e)), r = e.length - ((e.length + t) % 188), i = !1, n = t;
                    n < r;
                    n += 188
                  )
                    if (71 == e[n]) {
                      var a = !!(64 & e[n + 1]),
                        s = ((31 & e[n + 1]) << 8) + e[n + 2];
                      if ((48 & e[n + 3]) >> 4 > 1) {
                        var o = n + 5 + e[n + 4];
                        if (o == n + 188) continue;
                      } else o = n + 4;
                      switch (s) {
                        case 0:
                          (a && (o += e[o] + 1), (this.I = ((31 & e[o + 10]) << 8) | e[o + 11]));
                          break;
                        case 17:
                        case 8191:
                          break;
                        case this.I:
                          (a && (o += e[o] + 1),
                            (s = { audio: -1, video: -1, gf: -1, audioCodec: "", videoCodec: "" }));
                          var l = o + 3 + (((15 & (a = e)[o + 1]) << 8) | a[o + 2]) - 4;
                          for (o += 12 + (((15 & a[o + 10]) << 8) | a[o + 11]); o < l; ) {
                            var u = ((31 & a[o + 1]) << 8) | a[o + 2],
                              d = ((15 & a[o + 3]) << 8) | a[o + 4];
                            switch (a[o]) {
                              case 6:
                                if (d > 0)
                                  for (var h = o + 5, c = d; c > 2; ) {
                                    var f = a[h + 1] + 2;
                                    switch (a[h]) {
                                      case 5:
                                        var p = a.subarray(h + 2, h + f);
                                        ((p = tt.value()(p)),
                                          -1 == s.audio && "Opus" === p
                                            ? ((s.audio = u), (s.audioCodec = "opus"))
                                            : -1 == s.video &&
                                              "AV01" === p &&
                                              ((s.video = u), (s.videoCodec = "av1")));
                                        break;
                                      case 106:
                                        -1 == s.audio && ((s.audio = u), (s.audioCodec = "ac3"));
                                        break;
                                      case 122:
                                        -1 == s.audio && ((s.audio = u), (s.audioCodec = "ec3"));
                                        break;
                                      case 124:
                                        -1 == s.audio && ((s.audio = u), (s.audioCodec = "aac"));
                                        break;
                                      case 127:
                                        "opus" == s.audioCodec &&
                                          ((p = null),
                                          128 === a[h + 2] && (p = a[h + 3]),
                                          null != p &&
                                            (this.H = {
                                              channelCount: 15 & p ? 15 & p : 2,
                                              uj: p,
                                              sampleRate: 48e3,
                                            }));
                                    }
                                    ((h += f), (c -= f));
                                  }
                                break;
                              case 15:
                                -1 == s.audio && ((s.audio = u), (s.audioCodec = "aac"));
                                break;
                              case 17:
                                -1 == s.audio && ((s.audio = u), (s.audioCodec = "aac-loas"));
                                break;
                              case 21:
                                -1 == s.gf && (s.gf = u);
                                break;
                              case 27:
                                -1 == s.video && ((s.video = u), (s.videoCodec = "avc"));
                                break;
                              case 3:
                              case 4:
                                -1 == s.audio && ((s.audio = u), (s.audioCodec = "mp3"));
                                break;
                              case 36:
                                -1 == s.video && ((s.video = u), (s.videoCodec = "hvc"));
                                break;
                              case 129:
                                -1 == s.audio && ((s.audio = u), (s.audioCodec = "ac3"));
                                break;
                              case 132:
                              case 135:
                                -1 == s.audio && ((s.audio = u), (s.audioCodec = "ec3"));
                            }
                            o += d + 5;
                          }
                          (-1 != (a = s).video && ((this.K = a.video), (this.m = a.videoCodec)),
                            -1 != a.audio && ((this.F = a.audio), (this.C = a.audioCodec)),
                            -1 != a.gf && (this.G = a.gf),
                            i && !this.J && ((i = !1), (n = t - 188)),
                            (this.J = !0));
                          break;
                        case this.K:
                          ((o = e.subarray(o, n + 188)),
                            a
                              ? this.j.push([o])
                              : this.j.length &&
                                this.j[this.j.length - 1] &&
                                this.j[this.j.length - 1].push(o));
                          break;
                        case this.F:
                          ((o = e.subarray(o, n + 188)),
                            a
                              ? this.i.push([o])
                              : this.i.length &&
                                this.i[this.i.length - 1] &&
                                this.i[this.i.length - 1].push(o));
                          break;
                        case this.G:
                          ((o = e.subarray(o, n + 188)),
                            a
                              ? this.l.push([o])
                              : this.l.length &&
                                this.l[this.l.length - 1] &&
                                this.l[this.l.length - 1].push(o));
                          break;
                        default:
                          i = !0;
                      }
                    }
                  return this;
                }),
                (n.Hk = function (e) {
                  return (
                    he("TsParser.parseAvcNalus", "Please use parseNalus function instead."),
                    this.$g(e, { le: null, state: null })
                  );
                }),
                (n.$g = function (e, t) {
                  var r = e.pts ? e.pts / 9e4 : null,
                    i = (e = e.data).byteLength,
                    n = 1;
                  "hvc" == this.m && (n = 2);
                  var a = t.state || 0,
                    s = a,
                    o = 0,
                    l = [],
                    u = -1,
                    d = 0;
                  for (
                    -1 == a &&
                    ((u = 0), (d = "hvc" == this.m ? (e[0] >> 1) & 63 : 31 & e[0]), (a = 0), (o = 1));
                    o < i;
                  ) {
                    var h = e[o++];
                    a
                      ? 1 === a
                        ? (a = h ? 0 : 2)
                        : h
                          ? 1 == h
                            ? ((h = o - a - 1),
                              u >= 0
                                ? l.push({
                                    data: e.subarray(u + n, h),
                                    fullData: e.subarray(u, h),
                                    type: d,
                                    time: r,
                                    state: null,
                                  })
                                : (a = l.length ? l[l.length - 1] : t.le) &&
                                  (s &&
                                    o <= 4 - s &&
                                    a.state &&
                                    ((a.data = a.data.subarray(0, a.data.byteLength - s)),
                                    (a.fullData = a.fullData.subarray(0, a.fullData.byteLength - s))),
                                  h > 0 &&
                                    ((h = e.subarray(0, h)),
                                    (a.data = lt(a.data, h)),
                                    (a.fullData = lt(a.fullData, h)),
                                    (a.state = 0))),
                              o < i
                                ? ((d = "hvc" == this.m ? (e[o] >> 1) & 63 : 31 & e[o]), (u = o), (a = 0))
                                : (a = -1))
                            : (a = 0)
                          : (a = 3)
                      : (a = h ? 0 : 1);
                  }
                  return (
                    u >= 0 &&
                      a >= 0 &&
                      l.push({
                        data: e.subarray(u + n, i),
                        fullData: e.subarray(u, i),
                        type: d,
                        time: r,
                        state: a,
                      }),
                    !l.length &&
                      t.le &&
                      (r = l.length ? l[l.length - 1] : t.le) &&
                      ((r.data = lt(r.data, e)), (r.fullData = lt(r.fullData, e))),
                    (t.state = a),
                    l
                  );
                }),
                (n.getMetadata = function () {
                  for (var e = [], t = g(this.l), r = t.next(); !r.done; r = t.next())
                    (r = Ao(this, (r = lt.apply(rt, m(r.value))))) &&
                      e.push({
                        cueTime: r.pts ? r.pts / 9e4 : null,
                        data: r.data,
                        frames: lo(r.data),
                        dts: r.dts,
                        pts: r.pts,
                      });
                  return e;
                }),
                (n.ub = function () {
                  if (this.i.length && !this.h.length)
                    for (var e = g(this.i), t = e.next(); !t.done; t = e.next()) {
                      var r = lt.apply(rt, m(t.value)),
                        i = Ao(this, r);
                      ((t = this.h.length ? this.h[this.h.length - 1] : null),
                        i && null != i.pts && null != i.dts && (!t || (t.pts != i.pts && t.dts != i.dts))
                          ? this.h.push(i)
                          : this.h.length &&
                            (r = i ? i.data : r) &&
                            (((t = this.h.pop()).data = lt(t.data, r)), this.h.push(t)));
                    }
                  return this.h;
                }),
                (n.ud = function (e) {
                  if (((e = void 0 === e || e), this.j.length && !this.g.length)) {
                    for (var t = g(this.j), r = t.next(); !r.done; r = t.next()) {
                      var i = lt.apply(rt, m(r.value)),
                        n = Ao(this, i);
                      ((r = this.g.length ? this.g[this.g.length - 1] : null),
                        n && null != n.pts && null != n.dts && (!r || (r.pts != n.pts && r.dts != n.dts))
                          ? this.g.push(n)
                          : this.g.length &&
                            (i = n ? n.data : i) &&
                            (((r = this.g.pop()).data = lt(r.data, i)), this.g.push(r)));
                    }
                    if (e) {
                      for (
                        t = { le: null, state: null }, r = [], n = (i = g(this.g)).next();
                        !n.done;
                        n = i.next()
                      )
                        (((n = n.value).nalus = this.$g(n, t)),
                          n.nalus.length && (r.push(n), (t.le = n.nalus[n.nalus.length - 1])));
                      this.g = r;
                    }
                  }
                  return e ? this.g : ((e = this.g), (this.g = []), e);
                }),
                (n.getStartTime = function (e) {
                  if ("audio" == e) {
                    e = null;
                    var t = this.ub();
                    return (t.length && ((e = t[0]), (e = Math.min(e.dts, e.pts) / 9e4)), e);
                  }
                  return "video" == e
                    ? ((e = null),
                      (t = this.ud(!1)).length && ((e = t[0]), (e = Math.min(e.dts, e.pts) / 9e4)),
                      e)
                    : null;
                }),
                (n.Yd = function () {
                  return { audio: this.C, video: this.m };
                }),
                (n.ef = function () {
                  for (var e = [], t = g(this.ud()), r = t.next(); !r.done; r = t.next())
                    e.push.apply(e, m(r.value.nalus));
                  return e;
                }),
                (n.hk = function () {
                  he("TsParser.getVideoResolution", "Please use getVideoInfo function instead.");
                  var e = this.Ng();
                  return { height: e.height, width: e.width };
                }),
                (n.Ng = function () {
                  return "hvc" == this.m
                    ? (function (e) {
                        var t = { height: null, width: null, codec: null, frameRate: null },
                          r = e.ef();
                        if (!r.length) return t;
                        if (
                          !(r = r.find(function (e) {
                            return 33 == e.type;
                          }))
                        )
                          return t;
                        var i = new co(r.fullData, !0);
                        (So(i), So(i), go(i, 4));
                        var n = go(i, 3);
                        bo(i);
                        var a = go(i, 2),
                          s = go(i, 1),
                          o = go(i, 5),
                          l = go(i, 32);
                        r = So(i);
                        for (
                          var u = So(i),
                            d = So(i),
                            h = So(i),
                            c = So(i),
                            f = So(i),
                            p = So(i),
                            g = [],
                            m = [],
                            v = 0;
                          v < n;
                          v++
                        )
                          (g.push(bo(i)), m.push(bo(i)));
                        if (n > 0) for (v = n; v < 8; v++) go(i, 2);
                        for (v = 0; v < n; v++) (g[v] && go(i, 88), m[v] && So(i));
                        (yo(i), 3 == (n = yo(i)) && go(i, 1), (g = yo(i)), (m = yo(i)));
                        var y = (v = 0),
                          T = 0,
                          b = 0;
                        return (
                          bo(i) && ((v += yo(i)), (y += yo(i)), (T += yo(i)), (b += yo(i))),
                          (t.width = String(g - (v + y) * (1 === n || 2 === n ? 2 : 1))),
                          (t.height = String(m - (T + b) * (1 === n ? 2 : 1))),
                          (i = (function (e) {
                            for (var t = 0, r = 0; r < 32; r++) t |= ((e >> r) & 1) << (31 - r);
                            return t >>> 0;
                          })(l)),
                          (s = 1 == s ? "H" : "L"),
                          (a = "hvc1." + ["", "A", "B", "C"][a] + o),
                          (a += "." + i.toString(16).toUpperCase()),
                          (a += "." + s + p),
                          f && (a += "." + f.toString(16).toUpperCase()),
                          c && (a += "." + c.toString(16).toUpperCase()),
                          h && (a += "." + h.toString(16).toUpperCase()),
                          d && (a += "." + d.toString(16).toUpperCase()),
                          u && (a += "." + u.toString(16).toUpperCase()),
                          r && (a += "." + r.toString(16).toUpperCase()),
                          (t.codec = a),
                          (t.frameRate = Io(e)),
                          t
                        );
                      })(this)
                    : (function (e) {
                        var t = { height: null, width: null, codec: null, frameRate: null },
                          r = e.ef();
                        if (!r.length) return t;
                        if (
                          !(r = r.find(function (e) {
                            return 7 == e.type;
                          }))
                        )
                          return t;
                        var i = So((r = new co(r.data))),
                          n = So(r),
                          a = So(r);
                        if ((vo(r), Lo.includes(i))) {
                          var s = yo(r);
                          if ((3 === s && po(r, 1), vo(r), vo(r), po(r, 1), bo(r))) {
                            s = 3 !== s ? 8 : 12;
                            for (var o = 0; o < s; o++) bo(r) && Eo(r, o < 6 ? 16 : 64);
                          }
                        }
                        if ((vo(r), 0 === (s = yo(r)))) yo(r);
                        else if (1 === s) for (po(r, 1), vo(r), vo(r), s = yo(r), o = 0; o < s; o++) vo(r);
                        (vo(r), po(r, 1), (s = yo(r)), (o = yo(r)));
                        var l = go(r, 1);
                        (0 === l && po(r, 1), po(r, 1));
                        var u = 0,
                          d = 0,
                          h = 0,
                          c = 0;
                        return (
                          bo(r) && ((u = yo(r)), (d = yo(r)), (h = yo(r)), (c = yo(r))),
                          (t.height = String((2 - l) * (o + 1) * 16 - 2 * h - 2 * c)),
                          (t.width = String(16 * (s + 1) - 2 * u - 2 * d)),
                          (t.codec =
                            "avc1." +
                            ("0" + i.toString(16).toUpperCase()).slice(-2) +
                            ("0" + n.toString(16).toUpperCase()).slice(-2) +
                            ("0" + a.toString(16).toUpperCase()).slice(-2)),
                          (t.frameRate = Io(e)),
                          t
                        );
                      })(this);
                }),
                j("shaka.util.TsParser", wo),
                (wo.syncOffset = Co),
                (wo.probe = Ro),
                (wo.prototype.getVideoInfo = wo.prototype.Ng),
                (wo.prototype.getVideoResolution = wo.prototype.hk),
                (wo.prototype.getVideoNalus = wo.prototype.ef),
                (wo.prototype.getCodecs = wo.prototype.Yd),
                (wo.prototype.getStartTime = wo.prototype.getStartTime),
                (wo.prototype.getVideoData = wo.prototype.ud),
                (wo.prototype.getAudioData = wo.prototype.ub),
                (wo.prototype.getMetadata = wo.prototype.getMetadata),
                (wo.prototype.parseNalus = wo.prototype.$g),
                (wo.prototype.parseAvcNalus = wo.prototype.Hk),
                (wo.prototype.parse = wo.prototype.parse),
                (wo.prototype.setDiscontinuitySequence = wo.prototype.Kf),
                (wo.prototype.clearData = wo.prototype.clearData),
                (wo.Timescale = 9e4));
              var Lo = [100, 110, 122, 244, 44, 83, 86, 118, 128, 138, 139, 134];
              function Mo(e, t, r, i, n) {
                var a = this;
                ((this.g = e),
                  (this.O = r),
                  (this.B = i),
                  (this.ba = t),
                  (this.l = new Map()),
                  (this.G = new Map()),
                  (this.Ta = new Map()),
                  (this.h = null),
                  (this.Fa = !1),
                  (this.C = n || null),
                  (this.o = new Map()),
                  (this.u = new re()),
                  (this.j = new Map()),
                  (this.K = null),
                  (this.M = new kn()),
                  (this.Da = ""),
                  (this.ob = !1),
                  (this.za = !0),
                  (this.N = !1),
                  (this.F = this.R = null),
                  (this.i = Do(this, this.M)),
                  (this.Ua = this.H = !1),
                  (this.I = new Qn(function () {
                    return (function (e) {
                      var t, r, i, n, a, s, o, l, u, d, h, c, f;
                      return D(function (p) {
                        if (1 == p.g) {
                          for (t = [], r = g(e.o), i = r.next(); !i.done; i = r.next())
                            for (
                              n = i.value,
                                a = g(n),
                                s = a.next().value,
                                o = a.next().value,
                                l = o[0],
                                u = s,
                                e.o.set(u, o.slice(0, 1)),
                                l && t.push(l.p.catch(Li)),
                                d = g(o.slice(1)),
                                h = d.next();
                              !h.done;
                              h = d.next()
                            )
                              h.value.p.reject(new ze(2, 7, 7003, void 0));
                          return (e.h && t.push(e.h.destroy()), b(p, Promise.all(t), 2));
                        }
                        for (c = g(e.j.values()), f = c.next(); !f.done; f = c.next()) f.value.destroy();
                        (e.u && (e.u.release(), (e.u = null)),
                          e.g && e.F && e.g.removeChild(e.F),
                          e.g && e.R && (e.g.removeChild(e.R), e.g.load(), (e.g.disableRemotePlayback = !1)),
                          (e.g = null),
                          (e.R = null),
                          (e.F = null),
                          (e.B = null),
                          (e.i = null),
                          (e.h = null),
                          (e.ba = null),
                          e.l.clear(),
                          e.Ta.clear(),
                          e.j.clear(),
                          (e.K = null),
                          e.o.clear(),
                          (e.C = null),
                          e.$.clear(),
                          (e.O = null),
                          S(p));
                      });
                    })(a);
                  })),
                  (this.J = !1),
                  (this.X = "UNKNOWN"),
                  (this.eb = this.kb = !1),
                  (this.ab = new kn()),
                  (this.m = !1),
                  (this.ya = null),
                  (this.$ = new Map()),
                  (this.oa = this.T = this.va = this.V = null),
                  (this.ma = new kn()),
                  this.g.remote &&
                    ((this.N = "disconnected" != this.g.remote.state),
                    this.u.D(this.g.remote, "connect", function () {
                      a.N = "disconnected" != a.g.remote.state;
                    }),
                    this.u.D(this.g.remote, "connecting", function () {
                      a.N = "disconnected" != a.g.remote.state;
                    }),
                    this.u.D(this.g.remote, "disconnect", function () {
                      a.N = "disconnected" != a.g.remote.state;
                    })));
              }
              function Do(t, r) {
                if (((t.za = !0), e.ManagedMediaSource)) {
                  t.F || (t.g.disableRemotePlayback = !0);
                  var i = new ManagedMediaSource();
                  (t.u.D(i, "startstreaming", function () {
                    t.za = !0;
                  }),
                    t.u.D(i, "endstreaming", function () {
                      t.za = !1;
                    }));
                } else i = new MediaSource();
                return (
                  t.u.Aa(i, "sourceopen", function () {
                    (URL.revokeObjectURL(t.Da), r.resolve());
                  }),
                  t.u.Aa(t.g, "playing", function () {
                    t.ob = !0;
                  }),
                  (t.Da = il(i)),
                  t.B.useSourceElements
                    ? (t.g.removeAttribute("src"),
                      t.R && t.g.removeChild(t.R),
                      t.F && t.g.removeChild(t.F),
                      (t.R = Qs(t.Da)),
                      t.g.appendChild(t.R),
                      t.F && t.g.appendChild(t.F),
                      t.g.load())
                    : (t.g.src = t.Da),
                  i
                );
              }
              function _o(e, t, i, n) {
                "audio" == t && n && (n = Ji(n, i.mimeType));
                var a = li(i.mimeType, n);
                if (t == gt) Oo(e, a, e.J, i.external);
                else {
                  var s = e.B.forceTransmux;
                  (!Ja(a) || (!e.J && yi.includes(a))) && (s = !0);
                  var o = ui(i.mimeType, n);
                  if (s) {
                    if (
                      ((s = ft("audio", (n || "").split(","))),
                      (n = ft("video", (n || "").split(","))),
                      s && n)
                    )
                      return ((e.m = !0), _o(e, "audio", i, s), void _o(e, "video", i, n));
                    (n = ti(o)) && ((a = n()), e.j.set(t, a), (a = a.convertCodecs(t, o)));
                  }
                  ((o = a + e.B.addExtraFeaturesToSourceBuffer(a)), Jn(e.I));
                  try {
                    var l = e.i.addSourceBuffer(o);
                  } catch (r) {
                    throw new ze(
                      2,
                      3,
                      3015,
                      r,
                      "The mediaSource_ status was " + e.i.readyState + " expected 'open'",
                      null,
                    );
                  }
                  (e.J && (l.mode = nl),
                    e.u.D(l, "error", function () {
                      var r = e.o.get(t)[0];
                      r.p.reject(new ze(2, 3, 3014, e.g.error ? e.g.error.code : 0, r.uri));
                    }),
                    e.u.D(l, "updateend", function () {
                      return Xo(e, t);
                    }),
                    e.l.set(t, l),
                    e.G.set(t, a),
                    e.Ta.set(t, !!i.drmInfos.length));
                }
              }
              function Po(e) {
                return e.za && !e.N && !e.H;
              }
              function Oo(e, t, r, i) {
                e.h || ((e.h = new Ti(e.ba)), e.h && (e.h.B = e.B.modifyCueCallback));
                var n = e.h;
                ((i = i || e.Fa),
                  (e = e.X),
                  "application/cea-608" == t || "application/cea-708" == t
                    ? (n.i = null)
                    : ((n.i = Ii.get(t)()),
                      n.i.setSequenceMode
                        ? n.i.setSequenceMode(r)
                        : he(
                            "Text parsers w/ setSequenceMode",
                            'Text parsers should have a "setSequenceMode" method!',
                          ),
                      n.i.setManifestType
                        ? n.i.setManifestType(e)
                        : he(
                            "Text parsers w/ setManifestType",
                            'Text parsers should have a "setManifestType" method!',
                          ),
                      (n.C = i)));
              }
              function No(e) {
                return !(e.H || (e.i && "ended" != e.i.readyState));
              }
              function Fo(e) {
                return !(e.H || (e.i && "closed" != e.i.readyState));
              }
              function Uo(e, t) {
                return e.l.size ? (t == gt ? e.h.g : Ks($o(e, t))) : null;
              }
              function Bo(e, t) {
                return e.l.size ? (t == gt ? e.h.h : Ws($o(e, t))) : null;
              }
              function $o(e, t) {
                if (e.H || e.N || Fo(e)) return null;
                try {
                  return e.l.get(t).buffered;
                } catch (r) {
                  return (e.l.has(t), null);
                }
              }
              function jo(e, t, r, i, n, a, s, o, l, u, d) {
                var h, c, f, p, v, y, T, E, x, w, A, I, k, R, C, L, M, _, P;
                return (
                  (s = void 0 !== s && s),
                  (o = void 0 !== o && o),
                  (l = void 0 !== l && l),
                  (u = void 0 !== u && u),
                  D(function (O) {
                    switch (O.g) {
                      case 1:
                        if (t != (h = mt).Na) {
                          O.A(2);
                          break;
                        }
                        if ("HLS" != e.X) {
                          O.A(3);
                          break;
                        }
                        return b(O, e.ab, 4);
                      case 4:
                        ((c = O.h), (e.h.u = c));
                      case 3:
                        return b(
                          O,
                          (function (e, t, r, i, n) {
                            var a, s, o, l, u, d, h;
                            return D(function (c) {
                              if (1 == c.g) return b(c, Promise.resolve(), 2);
                              if (!e.i || !e.l) return c.return();
                              if (null == r || null == i) return (e.i.parseInit(Oe(t)), c.return());
                              for (
                                a = e.C ? r : e.u,
                                  s = { periodStart: e.u, segmentStart: r, segmentEnd: i, vttOffset: a },
                                  o = e.i.parseMedia(Oe(t), s, n, []),
                                  l = g(o),
                                  u = l.next();
                                !u.done;
                                u = l.next()
                              )
                                ((d = u.value), e.B(d, n || null, s));
                              ((h = o.filter(function (t) {
                                return t.startTime >= e.m && t.startTime < e.o;
                              })),
                                e.l.append(h),
                                null == e.g && (e.g = Math.max(r, e.m)),
                                (e.h = Math.min(i, e.o)),
                                S(c));
                            });
                          })(e.h, r, i ? i.startTime : null, i ? i.endTime : null, i ? i.P()[0] : null),
                          5,
                        );
                      case 5:
                        return O.return();
                      case 2:
                        if (u || !e.m) {
                          O.A(6);
                          break;
                        }
                        return b(O, jo(e, h.aa, r, i, n, a, s, o, l, !0), 7);
                      case 7:
                        return b(O, jo(e, h.wa, r, i, n, a, s, o, l, !0), 8);
                      case 8:
                        return O.return();
                      case 6:
                        if (!e.l.has(t)) return O.return();
                        if (
                          ((f = e.l.get(t).timestampOffset),
                          (p = e.G.get(t)),
                          e.j.has(t) && (p = e.j.get(t).getOriginalMimeType()),
                          i &&
                            ((v = (function (e, t, r, i, n, a, s) {
                              s = void 0 !== s && s;
                              var o = null,
                                l = [],
                                u = Oe(r);
                              if (yi.includes(a))
                                (r = lo(u)).length &&
                                  i &&
                                  ((s = r.find(function (e) {
                                    return "com.apple.streaming.transportStreamTimestamp" === e.description;
                                  })) &&
                                    "number" == typeof s.data &&
                                    (o = Math.round(s.data) / 1e3),
                                  e.O.onMetadata(
                                    [
                                      {
                                        cueTime: i.startTime,
                                        data: u,
                                        frames: r,
                                        dts: i.startTime,
                                        pts: i.startTime,
                                      },
                                    ],
                                    0,
                                    i.endTime,
                                  ));
                              else if (a.includes("/mp4") && i && i.ea) {
                                u = new aa();
                                var d =
                                  (null != n.emsgSchemeIdUris && n.emsgSchemeIdUris.length > 0) ||
                                  e.B.dispatchAllEmsgBoxes;
                                d &&
                                  u.S("emsg", function (t) {
                                    var r = n.emsgSchemeIdUris;
                                    if (0 === t.version)
                                      var a = t.reader.Yc(),
                                        s = t.reader.Yc(),
                                        o = t.reader.U(),
                                        l = t.reader.U(),
                                        u = t.reader.U(),
                                        d = t.reader.U(),
                                        h = i.startTime + l / o;
                                    else
                                      ((o = t.reader.U()),
                                        (l = (h = t.reader.Ed() / o + i.timestampOffset) - i.startTime),
                                        (u = t.reader.U()),
                                        (d = t.reader.U()),
                                        (a = t.reader.Yc()),
                                        (s = t.reader.Yc()));
                                    ((t = t.reader.Tb(t.reader.getLength() - t.reader.Pa(), !0)),
                                      ((r && r.includes(a)) || e.B.dispatchAllEmsgBoxes) &&
                                        ("urn:mpeg:dash:event:2012" == a
                                          ? e.O.Gk()
                                          : ((r = h + u / o),
                                            e.O.Ek({
                                              startTime: h,
                                              endTime: r,
                                              schemeIdUri: a,
                                              value: s,
                                              timescale: o,
                                              presentationTimeDelta: l,
                                              eventDuration: u,
                                              id: d,
                                              messageData: t,
                                            }),
                                            ("https://aomedia.org/emsg/ID3" == a ||
                                              "https://developer.apple.com/streaming/emsg-id3" == a) &&
                                              (o = lo(t)).length &&
                                              e.O.onMetadata(
                                                [{ cueTime: h, data: t, frames: o, dts: h, pts: h }],
                                                0,
                                                r,
                                              ))));
                                  });
                                var h = i.ea.timescale;
                                t = h && !isNaN(h);
                                var c = 0,
                                  f = !1;
                                (t &&
                                  u
                                    .S("prft", function (t) {
                                      var r = t.reader,
                                        i = t.version;
                                      (r.U(),
                                        (t = 1e3 * (t = r.U()) + (r.U() / 4294967296) * 1e3),
                                        0 === i
                                          ? (r = r.U())
                                          : ((i = r.U()), (r = 4294967296 * i + (r = r.U()))),
                                        (t = ho(t)),
                                        (r = new Pn(
                                          "prft",
                                          (r = new Map().set("detail", {
                                            wallClockTime: t,
                                            programStartDate: new Date(t - (r / h) * 1e3),
                                          })),
                                        )),
                                        e.O.onEvent(r));
                                    })
                                    .box("moof", sa)
                                    .box("traf", sa)
                                    .S("tfdt", function (e) {
                                      f ||
                                        ((c = rs(e.reader, e.version).baseMediaDecodeTime / h),
                                        (f = !0),
                                        d || e.parser.stop());
                                    }),
                                  (d || t) && u.parse(r, !1, s),
                                  f && 0 == i.timestampOffset && (o = c));
                              } else
                                a.includes("/mp4") ||
                                  a.includes("/webm") ||
                                  !Ro(u) ||
                                  (e.$.has(t) || e.$.set(t, new wo()),
                                  (l = e.$.get(t)).clearData(),
                                  l.Kf(i.i),
                                  l.parse(u),
                                  null != (u = l.getStartTime(t)) && (o = u),
                                  (l = l.getMetadata()));
                              return { timestamp: o, metadata: l };
                            })(e, t, r, i, n, p, l)),
                            (y = v.timestamp),
                            (T = v.metadata),
                            null != y &&
                              (null == e.V &&
                                t == h.wa &&
                                ((e.V = y),
                                (e.va = i.startTime),
                                null != e.T && ((E = 0), e.va == e.oa && (E = e.V - e.T), e.ma.resolve(E))),
                              null == e.T &&
                                t == h.aa &&
                                ((e.T = y),
                                (e.oa = i.startTime),
                                null != e.V && ((x = 0), e.va == e.oa && (x = e.V - e.T), e.ma.resolve(x))),
                              (w = y),
                              (A = yi),
                              !e.J && A.includes(e.G.get(t)) && (w = 0),
                              (I = i.startTime - w),
                              (Math.abs(f - I) >= 0.001 || s || o) &&
                                (!l || I > 0 || !f) &&
                                ((f = I),
                                e.eb &&
                                  (Yo(
                                    e,
                                    t,
                                    function () {
                                      return Wo(e, t);
                                    },
                                    null,
                                  ),
                                  Yo(
                                    e,
                                    t,
                                    function () {
                                      return zo(e, t, f);
                                    },
                                    null,
                                  ))),
                              (t == h.wa || !e.l.has(h.wa)) && e.ab.resolve(f)),
                            T.length) &&
                            e.O.onMetadata(T, f, i ? i.endTime : null),
                          a &&
                            t == h.wa &&
                            (e.h || Oo(e, "application/cea-608", e.J, !1),
                            e.K || ((k = p.split(";", 1)[0]), (e.K = new Lt(k))),
                            i
                              ? (R = e.K.Af(r)).length &&
                                (function (e, t, r) {
                                  for (var i = new Map(), n = (t = g(t)).next(); !n.done; n = t.next()) {
                                    var a = n.value;
                                    ((n = a.stream),
                                      (a = a.cue),
                                      i.has(n) || i.set(n, []),
                                      wi(e, a, r),
                                      a.startTime >= e.m &&
                                        a.startTime < e.o &&
                                        (i.get(n).push(a), n == e.F && e.l.append([a])));
                                  }
                                  for (t = (r = g(i.keys())).next(); !t.done; t = r.next())
                                    for (
                                      t = t.value, e.j.has(t) || e.j.set(t, []), a = (n = g(i.get(t))).next();
                                      !a.done;
                                      a = n.next()
                                    )
                                      ((a = a.value), e.j.get(t).push(a));
                                  Ai(e);
                                })(e.h, R, f)
                              : e.K.init(r, o, d)),
                          !e.j.has(t))
                        ) {
                          O.A(9);
                          break;
                        }
                        return b(O, e.j.get(t).transmux(r, n, i, e.i.duration, t), 10);
                      case 10:
                        ((C = O.h),
                          ArrayBuffer.isView(C)
                            ? (r = C)
                            : (null != (L = C).init &&
                                ((M = L.init),
                                Yo(
                                  e,
                                  t,
                                  function () {
                                    (e.C && bt(e.C, M, f, n), e.l.get(t).appendBuffer(M));
                                  },
                                  i ? i.P()[0] : null,
                                )),
                              (r = L.data)));
                      case 9:
                        if (
                          ((r = (function (e, t, r, i, n) {
                            if ("mp4" != hi(e.G.get(n))) return r;
                            var a = null === i,
                              s = e.Ta.get(n),
                              o = e.O.Pj(),
                              l = !1;
                            (i && i.ea && (l = i.ea.encrypted), (i = i ? i.P()[0] : null));
                            var u = se();
                            return (
                              e.B.correctEc3Enca &&
                                a &&
                                "audio" === n &&
                                (r = (function (e) {
                                  e = Oe(e);
                                  var t = null;
                                  return (
                                    new aa()
                                      .box("moov", sa)
                                      .box("trak", sa)
                                      .box("mdia", sa)
                                      .box("minf", sa)
                                      .box("stbl", sa)
                                      .S("stsd", oa)
                                      .box("enca", function (e) {
                                        return ((t = e.reader.h), ua(e));
                                      })
                                      .box("sinf", sa)
                                      .box("frma", function (e) {
                                        (e.parser.stop(),
                                          "ec-3" === ss(e.reader).codec &&
                                            t &&
                                            2 !== t.getUint16(16) &&
                                            t.setUint16(16, 2));
                                      })
                                      .parse(e),
                                    e
                                  );
                                })(r)),
                              e.B.insertFakeEncryptionInInit &&
                                s &&
                                u.Fd(o, n) &&
                                (a
                                  ? (r = (function (e, t, r) {
                                      function i(e) {
                                        h.push({ box: e, Ei: 1701733217 });
                                      }
                                      function n(e) {
                                        h.push({ box: e, Ei: 1701733238 });
                                      }
                                      function a(e) {
                                        ((u = !0), e.parser.stop());
                                      }
                                      function s(e) {
                                        (d.push(e), sa(e));
                                      }
                                      var o,
                                        l = (t = Oe(t)),
                                        u = !1,
                                        d = [],
                                        h = [];
                                      if (
                                        (new aa()
                                          .box("moov", s)
                                          .box("trak", s)
                                          .box("mdia", s)
                                          .box("minf", s)
                                          .box("stbl", s)
                                          .S("stsd", function (e) {
                                            ((o = e), d.push(e), oa(e));
                                          })
                                          .S("encv", a)
                                          .S("enca", a)
                                          .S("dvav", n)
                                          .S("dva1", n)
                                          .S("dvh1", n)
                                          .S("dvhe", n)
                                          .S("dvc1", n)
                                          .S("dvi1", n)
                                          .S("hev1", n)
                                          .S("hvc1", n)
                                          .S("avc1", n)
                                          .S("avc3", n)
                                          .S("ac-3", i)
                                          .S("ec-3", i)
                                          .S("ac-4", i)
                                          .S("Opus", i)
                                          .S("fLaC", i)
                                          .S("mp4a", i)
                                          .parse(t),
                                        u)
                                      )
                                        return t;
                                      if (0 == h.length || !o) throw (ot(t), new ze(2, 3, 3019, r));
                                      h.reverse();
                                      for (var c = (r = g(h)).next(); !c.done; c = r.next())
                                        ((c = c.value), (l = Os(e, l, o, c.box, d, c.Ei)));
                                      return se().ih()
                                        ? ((e = new Uint8Array(t.byteLength + l.byteLength)).set(l),
                                          e.set(t, l.byteLength),
                                          e)
                                        : l;
                                    })(t, r, i))
                                  : !l &&
                                    u.Ni(n) &&
                                    (r = (function (e) {
                                      e = Oe(e);
                                      var t = [];
                                      new aa()
                                        .box("mdat", function (e) {
                                          t.push(e);
                                        })
                                        .parse(e);
                                      for (var r = [], i = 0; i < t.length; i++) {
                                        var n = t[i - 1],
                                          a = t[i];
                                        r.push(Ps(e.subarray(n ? n.start + n.size : 0, a.start + a.size)));
                                      }
                                      return lt.apply(rt, m(r));
                                    })(r))),
                              a &&
                                u.se() &&
                                (r = (function (e) {
                                  function t(e) {
                                    (i.push({ start: e.start, size: e.size }), sa(e));
                                  }
                                  var r = Oe(e),
                                    i = [];
                                  return (
                                    new aa()
                                      .box("moov", t)
                                      .box("trak", t)
                                      .box("mdia", t)
                                      .box("minf", t)
                                      .box("stbl", t)
                                      .box("stsd", function (e) {
                                        i.push({ start: e.start, size: e.size });
                                        for (var t = Fe(r, e.start), n = 0; n < e.size - 3; n++) {
                                          var a = t.getUint32(n);
                                          1633889587 == a
                                            ? t.setUint32(n, 1700998451)
                                            : 1684103987 == a && t.setUint32(n, 1684366131);
                                        }
                                      })
                                      .parse(r),
                                    r
                                  );
                                })(r)),
                              r
                            );
                          })(e, n, r, i, t)),
                          !i || !e.J || t == h.Na)
                        ) {
                          O.A(11);
                          break;
                        }
                        if (!s && !o) {
                          O.A(11);
                          break;
                        }
                        if (((_ = i.startTime), "HLS" != e.X || e.m || t != h.aa || !e.l.has(h.wa))) {
                          O.A(13);
                          break;
                        }
                        return b(O, e.ma, 14);
                      case 14:
                        ((P = O.h), Math.abs(P) > 0.15 && (_ -= P));
                      case 13:
                        (Yo(
                          e,
                          t,
                          function () {
                            return Wo(e, t);
                          },
                          null,
                        ),
                          Yo(
                            e,
                            t,
                            function () {
                              return zo(e, t, _);
                            },
                            null,
                          ));
                      case 11:
                        return b(
                          O,
                          Yo(
                            e,
                            t,
                            function () {
                              var i = r;
                              (e.C && bt(e.C, i, f, n), e.l.get(t).appendBuffer(i));
                            },
                            i ? i.P()[0] : null,
                          ),
                          15,
                        );
                      case 15:
                        S(O);
                    }
                  })
                );
              }
              function Go(e, t) {
                var r;
                return D(function (i) {
                  return 1 == i.g
                    ? t == (r = mt).Na
                      ? e.h
                        ? b(i, e.h.remove(0, 1 / 0), 0)
                        : i.return()
                      : t === r.wa && e.K && e.h
                        ? b(i, e.h.remove(0, 1 / 0, !0), 4)
                        : i.A(4)
                    : 6 != i.g
                      ? b(
                          i,
                          Yo(
                            e,
                            t,
                            function () {
                              return Ko(e, t, 0, e.i.duration);
                            },
                            null,
                          ),
                          6,
                        )
                      : e.m
                        ? b(
                            i,
                            Yo(
                              e,
                              r.aa,
                              function () {
                                return Ko(e, r.aa, 0, e.i.duration);
                              },
                              null,
                            ),
                            0,
                          )
                        : i.A(0);
                });
              }
              function Vo(e, t, r, i, n, a, s, o, l) {
                var u, d;
                return D(function (h) {
                  return 1 == h.g
                    ? t == (u = mt).Na
                      ? (a || (e.h.u = r),
                        (function (e, t, r) {
                          ((e.m = t), (e.o = r));
                        })(e.h, i, n),
                        h.return())
                      : ((d = []),
                        b(
                          h,
                          (function (e, t, r, i, n) {
                            var a, s, o, l, u, d;
                            return D(function (h) {
                              return 1 == h.g
                                ? ((a = mt),
                                  (s = rl(e, t, r, i, n)),
                                  (o = s.type),
                                  (l = s.jc),
                                  (u = s.wf),
                                  (d = n.get(a.aa)) && (e.m = d.isAudioMuxedInVideo),
                                  o == al
                                    ? (e.j.has(t) && !l
                                        ? (e.j.get(t).destroy(), e.j.delete(t))
                                        : !e.j.has(t) && l
                                          ? e.j.set(t, l)
                                          : l &&
                                            (e.j.has(t) && e.j.get(t).transmux !== l.transmux
                                              ? (e.j.get(t).destroy(), e.j.set(t, l))
                                              : l.destroy()),
                                      h.return(!1))
                                    : o == ol
                                      ? b(
                                          h,
                                          (function (e, t, r, i) {
                                            return Yo(
                                              e,
                                              t,
                                              function () {
                                                if (t !== gt) {
                                                  if ((e.G.get(t), se().Ib())) {
                                                    (e.j.has(t) && (e.j.get(t).destroy(), e.j.delete(t)),
                                                      i && e.j.set(t, i));
                                                    var n = r + e.B.addExtraFeaturesToSourceBuffer(r);
                                                    (e.l.get(t).changeType(n), e.G.set(t, r));
                                                  }
                                                  Xo(e, t);
                                                }
                                              },
                                              null,
                                            );
                                          })(e, t, u, l),
                                          3,
                                        )
                                      : o != sl
                                        ? h.A(3)
                                        : (l && l.destroy(), b(h, el(e, n), 3)))
                                : h.return(!0);
                            });
                          })(e, t, s, o, l),
                          2,
                        ))
                    : (h.h ||
                        (d.push(
                          Yo(
                            e,
                            t,
                            function () {
                              return Wo(e, t);
                            },
                            null,
                          ),
                        ),
                        e.m &&
                          d.push(
                            Yo(
                              e,
                              u.aa,
                              function () {
                                return Wo(e, u.aa);
                              },
                              null,
                            ),
                          )),
                      a ||
                        (d.push(
                          Yo(
                            e,
                            t,
                            function () {
                              return zo(e, t, r);
                            },
                            null,
                          ),
                        ),
                        e.m &&
                          d.push(
                            Yo(
                              e,
                              u.aa,
                              function () {
                                return zo(e, u.aa, r);
                              },
                              null,
                            ),
                          )),
                      (0 == i && n == 1 / 0) ||
                        (d.push(
                          Yo(
                            e,
                            t,
                            function () {
                              return qo(e, t, i, n);
                            },
                            null,
                          ),
                        ),
                        e.m &&
                          d.push(
                            Yo(
                              e,
                              u.aa,
                              function () {
                                return qo(e, u.aa, i, n);
                              },
                              null,
                            ),
                          )),
                      d.length ? b(h, Promise.all(d), 0) : h.A(0));
                });
              }
              function Ho(e) {
                D(function (t) {
                  return e.I.g || e.g.error || e.N || e.H || No(e) || Fo(e)
                    ? t.return()
                    : b(
                        t,
                        Qo(e, function () {
                          No(e) || Fo(e) || e.i.clearLiveSeekableRange();
                        }),
                        0,
                      );
                });
              }
              function Ko(e, t, r, i) {
                if (i <= r) Xo(e, t);
                else {
                  if (e.C) {
                    var n = e.C;
                    "video" === t && n.g && n.g.flushBuffer(r, i);
                  }
                  e.l.get(t).remove(r, i);
                }
              }
              function Wo(e, t) {
                var r = e.l.get(t),
                  i = r.appendWindowStart,
                  n = r.appendWindowEnd;
                (r.abort(), (r.appendWindowStart = i), (r.appendWindowEnd = n), Xo(e, t));
              }
              function zo(e, t, r) {
                (r < 0 && (r += 0.001), (e.l.get(t).timestampOffset = r), Xo(e, t));
              }
              function qo(e, t, r, i) {
                var n = e.l.get(t);
                ((n.appendWindowEnd === i && n.appendWindowStart === r) ||
                  ((n.appendWindowStart = 0), (n.appendWindowEnd = i), (n.appendWindowStart = r)),
                  Xo(e, t));
              }
              function Xo(e, t) {
                if (e.H || e.I.g) {
                  var r = e.o.get(t);
                  r && r.length && ((r = r[0]) && r.p && r.p.resolve(), e.o.set(t, []));
                } else (r = e.o.get(t)[0]) && (r.p.resolve(), Jo(e, t));
              }
              function Yo(e, t, r, i) {
                return (
                  Jn(e.I),
                  (r = { start: r, p: new kn(), uri: i }),
                  e.o.get(t).push(r),
                  1 == e.o.get(t).length && Zo(e, t),
                  r.p
                );
              }
              function Qo(e, t) {
                var r, i, n, a, s, o, l, u, d, h, c;
                return D(function (f) {
                  switch (f.g) {
                    case 1:
                      for (
                        Jn(e.I), r = [], i = Array.from(e.l.keys()), n = g(i), a = n.next(), s = {};
                        !a.done;
                        s = { ready: void 0 }, a = n.next()
                      )
                        ((o = a.value),
                          (s.ready = new kn()),
                          (l = {
                            start: (function (e) {
                              return function () {
                                return e.ready.resolve();
                              };
                            })(s),
                            p: s.ready,
                            uri: null,
                          }),
                          (u = e.o.get(o)).push(l),
                          r.push(s.ready),
                          1 == u.length && l.start());
                      return (E(f, 2), b(f, Promise.all(r), 4));
                    case 4:
                      w(f, 3);
                      break;
                    case 2:
                      throw A(f);
                    case 3:
                      return (E(f, 5, 6), b(f, t(), 6));
                    case 6:
                      for (I(f), d = g(i), h = d.next(); !h.done; h = d.next()) ((c = h.value), Jo(e, c));
                      k(f, 0);
                      break;
                    case 5:
                      throw new ze(2, 3, 3015, A(f), e.g.error || "No error in the media element", null);
                  }
                });
              }
              function Jo(e, t) {
                (e.o.get(t).shift(), Zo(e, t));
              }
              function Zo(e, t) {
                var r = e.o.get(t)[0];
                if (r)
                  try {
                    r.start();
                  } catch (i) {
                    ("QuotaExceededError" == i.name
                      ? r.p.reject(new ze(2, 3, 3017, t))
                      : Po(e)
                        ? r.p.reject(
                            new ze(2, 3, 3015, i, e.g.error || "No error in the media element", r.uri),
                          )
                        : r.p.reject(new ze(2, 3, 3024, t)),
                      Jo(e, t));
                  }
              }
              function el(e, t) {
                return Qo(e, function () {
                  return (function (e, t) {
                    var r, i, n, a, s, o, l, u, d, h, c, f, p, m, v, y, T, S, E;
                    return D(function (w) {
                      if (1 == w.g) {
                        if (e.H || e.N) return w.return();
                        for (
                          r = mt,
                            e.H = !0,
                            e.m = !1,
                            i = e.g.currentTime,
                            n = e.g.autoplay,
                            e.g.paused || (e.Ua = !0),
                            e.ob && (e.g.autoplay = !1),
                            x(w, 2),
                            e.u.Qa(),
                            a = g(e.j.values()),
                            s = a.next();
                          !s.done;
                          s = a.next()
                        )
                          s.value.destroy();
                        for (o = g(e.l.values()), l = o.next(); !l.done; l = o.next()) {
                          u = l.value;
                          try {
                            e.i.removeSourceBuffer(u);
                          } catch (A) {}
                        }
                        return (
                          e.j.clear(),
                          e.l.clear(),
                          (d = e.i.duration),
                          (e.M = new kn()),
                          (e.i = Do(e, e.M)),
                          b(w, e.M, 4)
                        );
                      }
                      if (2 != w.g) {
                        for (
                          !isNaN(d) && d ? (e.i.duration = d) : !isNaN(e.ya) && e.ya && (e.i.duration = e.ya),
                            h = new kn(),
                            c = e.i.sourceBuffers,
                            f = t.size,
                            p = 0,
                            m = function () {
                              ++p === f && (h.resolve(), e.u.Ma(c, "addsourcebuffer", m));
                            },
                            e.u.D(c, "addsourcebuffer", m),
                            v = g(t.keys()),
                            y = v.next();
                          !y.done;
                          y = v.next()
                        )
                          ((T = y.value), (S = t.get(T)), _o(e, T, S, S.codecs));
                        return (
                          (E = t.get(r.aa)) && E.isAudioMuxedInVideo && (e.m = !0),
                          e.m && !e.o.has(r.aa) && e.o.set(r.aa, []),
                          b(w, h, 2)
                        );
                      }
                      return (
                        I(w),
                        (e.H = !1),
                        Jn(e.I),
                        e.u.Aa(e.g, "loadedmetadata", function () {
                          e.I.g || (e.g.currentTime = i);
                        }),
                        e.u.Aa(e.g, "canplaythrough", function () {
                          e.I.g || ((e.g.autoplay = n), e.Ua && ((e.Ua = !1), e.g.play()));
                        }),
                        k(w, 0)
                      );
                    });
                  })(e, t);
                });
              }
              function tl(e, t, r, i) {
                var n = !1,
                  a = ft("audio", (i || "").split(",")),
                  s = ft("video", (i || "").split(",")),
                  o = s;
                ("audio" == t && (o = a), o || (o = i));
                var l = li(r, o),
                  u = pi(e.G.get(t)),
                  d = e.B.forceTransmux;
                if (
                  (!Ja(l) || (!e.J && yi.includes(l))
                    ? (d = !0)
                    : d || r == u || (d = !se().Nf() && yi.includes(r)),
                  d && (o = ti((e = ui(r, o)))))
                ) {
                  var h = o();
                  (a && s && (n = !0), (l = h.convertCodecs(t, e)));
                }
                return (
                  !h && "video" === t && a && (l = li(r, i)),
                  (t = ci(gi(l))),
                  { jc: h, jl: n, Th: pi(l), codec: t, mimeType: l }
                );
              }
              function rl(e, t, r, i, n) {
                if (t == gt) return { type: al, wf: r, jc: null };
                var a = ci(gi(e.G.get(t))),
                  s = pi(e.G.get(t)),
                  o = tl(e, t, r, i),
                  l = o.jc,
                  u = o.jl,
                  d = o.Th,
                  h = o.codec;
                o = o.mimeType;
                var c = !0;
                return (
                  u &&
                    e.G.has("audio") &&
                    ((r = tl(e, "audio", r, i)),
                    (i = ci(gi(e.G.get("audio")))),
                    (c = pi(e.G.get("audio"))),
                    (c = i == r.codec && c == r.Th),
                    r.jc && r.jc.destroy()),
                  a === h && s === d && c
                    ? { type: al, wf: o, jc: l }
                    : ((a = !0),
                      ((e.m && !n.has("audio")) || (u && l && !e.j.has(t))) && (a = !1),
                      (t = se()),
                      a && "smooth" === e.B.codecSwitchingStrategy && t.Ib()
                        ? { type: ol, wf: o, jc: l }
                        : (l && l.destroy(), { type: sl, wf: o, jc: null }))
                );
              }
              (((n = Mo.prototype).destroy = function () {
                return this.I.destroy();
              }),
                (n.init = function (e, t, r, i) {
                  ((t = void 0 !== t && t), (r = void 0 === r ? "UNKNOWN" : r), (i = void 0 !== i && i));
                  var n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d = this;
                  return D(function (h) {
                    if (1 == h.g) return ((n = mt), b(h, d.M, 2));
                    if (3 != h.g)
                      return No(d) || Fo(d)
                        ? (W("Expected MediaSource to be open during init(); reopening the media source."),
                          (d.M = new kn()),
                          (d.i = Do(d, d.M)),
                          b(h, d.M, 3))
                        : h.A(3);
                    for (
                      d.J = t,
                        d.X = r,
                        d.kb = i,
                        d.eb = !d.J && "HLS" == d.X && !d.kb,
                        d.$.clear(),
                        d.V = null,
                        d.va = null,
                        d.T = null,
                        d.oa = null,
                        d.ma = new kn(),
                        a = g(e.keys()),
                        s = a.next();
                      !s.done;
                      s = a.next()
                    )
                      ((o = s.value),
                        (l = e.get(o)),
                        _o(d, o, l, l.codecs),
                        d.m ? (d.o.set(n.aa, []), d.o.set(n.wa, [])) : d.o.set(o, []));
                    ((u = e.get(n.aa)) && u.isAudioMuxedInVideo && (d.m = !0), S(h));
                  });
                }),
                (n.configure = function (e) {
                  ((this.B = e), this.h && (this.h.B = e.modifyCueCallback));
                }),
                (n.Gc = function () {
                  var e = {
                    total: this.H ? [] : Xs(this.g.buffered),
                    audio: Xs($o(this, "audio")),
                    video: Xs($o(this, "video")),
                    text: [],
                  };
                  if (this.h) {
                    var t = this.h.g,
                      r = this.h.h;
                    null != t && null != r && e.text.push({ start: t, end: r });
                  }
                  return e;
                }),
                (n.remove = function (e, t, r, i) {
                  var n,
                    a,
                    s = this;
                  return D(function (o) {
                    return 1 == o.g
                      ? (e == (n = mt).wa && s.K && (s.K.remove(i), (a = s.h.g || 0), s.h.remove(a, r, !0)),
                        e == n.Na
                          ? b(o, s.h.remove(t, r), 0)
                          : r > t
                            ? b(
                                o,
                                Yo(
                                  s,
                                  e,
                                  function () {
                                    return Ko(s, e, t, r);
                                  },
                                  null,
                                ),
                                5,
                              )
                            : o.A(0))
                      : s.m
                        ? b(
                            o,
                            Yo(
                              s,
                              n.aa,
                              function () {
                                return Ko(s, n.aa, t, r);
                              },
                              null,
                            ),
                            0,
                          )
                        : o.A(0);
                  });
                }),
                (n.flush = function (e) {
                  var t,
                    r = this;
                  return D(function (i) {
                    return 1 == i.g
                      ? e == (t = mt).Na
                        ? i.return()
                        : b(
                            i,
                            Yo(
                              r,
                              e,
                              function () {
                                ((r.g.currentTime -= 0.001), Xo(r, e));
                              },
                              null,
                            ),
                            2,
                          )
                      : r.m
                        ? b(
                            i,
                            Yo(
                              r,
                              t.aa,
                              function () {
                                var e = t.aa;
                                ((r.g.currentTime -= 0.001), Xo(r, e));
                              },
                              null,
                            ),
                            0,
                          )
                        : i.A(0);
                  });
                }),
                (n.endOfStream = function (e) {
                  var t = this;
                  return D(function (r) {
                    return b(
                      r,
                      Qo(t, function () {
                        No(t) || Fo(t) || (e ? t.i.endOfStream(e) : t.i.endOfStream());
                      }),
                      0,
                    );
                  });
                }),
                (n.Ab = function (e) {
                  var t = this;
                  return D(function (r) {
                    return b(
                      r,
                      Qo(t, function () {
                        if (t.B.durationReductionEmitsUpdateEnd && e < t.i.duration)
                          for (var r = g(t.l.keys()), i = r.next(); !i.done; i = r.next()) {
                            i = i.value;
                            var n = { start: function () {}, p: new kn(), uri: null };
                            t.o.get(i).unshift(n);
                          }
                        ((t.i.duration = e), (t.ya = e));
                      }),
                      0,
                    );
                  });
                }),
                (n.getDuration = function () {
                  return this.i.duration;
                }));
              var il = e.URL.createObjectURL,
                nl = "sequence",
                al = "none",
                sl = "reset",
                ol = "changeType";
              function ll(e, t, r) {
                ((this.i = e),
                  (this.F = t),
                  (this.u = this.l = 1 / 0),
                  (this.h = 1),
                  (this.g = this.j = null),
                  (this.B = 0),
                  (this.C = !0),
                  (this.J = !1),
                  (this.I = 0),
                  (this.G = void 0 === r || r),
                  (this.H = 0),
                  (this.o = !1),
                  (this.m = e));
              }
              function ul(e, t, r, i) {
                var n = this;
                ((this.u = i),
                  (this.g = e),
                  (this.F = t),
                  (this.h = r),
                  (this.j = new re()),
                  (this.m = !1),
                  (this.l = 0),
                  (this.C = !1),
                  (this.H = this.G = 0),
                  (this.o = (function (e) {
                    if (!e.h.stallEnabled) return null;
                    var t = e.h.stallThreshold,
                      r = e.h.stallSkip;
                    return new hl(new cl(e.g), t, function () {
                      return D(function (t) {
                        if (1 == t.g)
                          return Xs(e.g.buffered).length
                            ? r
                              ? ((e.g.currentTime += r), t.A(2))
                              : b(t, e.g.play(), 3)
                            : t.return();
                        if (2 != t.g) {
                          if (!e.g) return t.return();
                          (e.g.pause(), e.g.play());
                        }
                        (e.H++, e.u(new Pn("stalldetected")), S(t));
                      });
                    });
                  })(this)),
                  (this.B = !1),
                  this.j.D(e, "waiting", function () {
                    return dl(n);
                  }),
                  (this.i = new Ri(function () {
                    dl(n);
                  }).Ea(this.h.gapJumpTimerTime)));
              }
              function dl(e) {
                if (0 != e.g.readyState) {
                  if (e.g.seeking) {
                    if (!e.m) return;
                  } else e.m = !1;
                  if (!e.g.paused || (e.g.currentTime == e.l && (e.g.autoplay || e.g.currentTime != e.l))) {
                    var t;
                    if (!(t = !e.o)) {
                      var r = (t = e.o).h,
                        i = fl(r),
                        n = r.g.currentTime,
                        a = Date.now() / 1e3;
                      ((t.g == n && t.m == i) || ((t.l = a), (t.g = n), (t.m = i), (t.i = !1)),
                        (i = (n = a - t.l) >= t.o && i && !t.i) &&
                          (t.j && t.j(t.g, n), (t.i = !0), (t.g = r.g.currentTime)),
                        (t = !i));
                    }
                    t &&
                      ((t = e.g.currentTime),
                      (i = (function (e, t, r) {
                        return e &&
                          e.length &&
                          !Hs(e) &&
                          (e = Xs(e).findIndex(function (e, i, n) {
                            return e.start > t && (0 == i || n[i - 1].end - t <= r);
                          })) >= 0
                          ? e
                          : null;
                      })((r = e.g.buffered), t, e.h.gapDetectionThreshold)),
                      null == i ||
                        (0 == i && !e.B) ||
                        ((n = r.start(i)),
                        (a = e.h.gapPadding) && (n = Math.ceil(100 * (n + a)) / 100),
                        n >= e.F.Gb() ||
                          n - t < 0.001 ||
                          (0 != i && r.end(i - 1),
                          (function (e, t) {
                            ((e.C = !0),
                              e.j.Aa(e.g, "seeked", function () {
                                e.C = !1;
                              }),
                              (e.g.currentTime = t));
                          })(e, n),
                          t == e.l && (e.l = n),
                          e.G++,
                          e.u(new Pn("gapjumped")))));
                  }
                }
              }
              function hl(e, t, r) {
                ((this.h = e),
                  (this.m = fl(e)),
                  (this.g = e.g.currentTime),
                  (this.l = Date.now() / 1e3),
                  (this.i = !1),
                  (this.o = t),
                  (this.j = r));
              }
              function cl(e) {
                var t = this;
                ((this.g = e),
                  (this.h = new re()),
                  (this.i = !1),
                  this.h.D(this.g, "audiofocuspaused", function () {
                    t.i = !0;
                  }),
                  this.h.D(this.g, "audiofocusgranted", function () {
                    t.i = !1;
                  }),
                  this.h.D(this.g, "audiofocuslost", function () {
                    t.i = !0;
                  }));
              }
              function fl(e) {
                if (e.g.paused || 0 == e.g.playbackRate || e.i || 0 == e.g.buffered.length) var t = !1;
                else
                  e: {
                    t = e.g.currentTime;
                    for (var r = (e = g(Xs(e.g.buffered))).next(); !r.done; r = e.next())
                      if (!(t < (r = r.value).start - 0.1 || t > r.end - 0.5)) {
                        t = !0;
                        break e;
                      }
                    t = !1;
                  }
                return t;
              }
              function pl(e, t, r, i) {
                t == HTMLMediaElement.HAVE_NOTHING || e.readyState >= t
                  ? i()
                  : ((t = gl.value().get(t)), r.Aa(e, t, i));
              }
              (((n = ll.prototype).getDuration = function () {
                return this.l;
              }),
                (n.Rj = function () {
                  return this.h;
                }),
                (n.Wi = function (e) {
                  this.i = e;
                }),
                (n.Ab = function (e) {
                  this.l = e;
                }),
                (n.Wj = function () {
                  return this.i;
                }),
                (n.Vi = function (e) {
                  this.B = e;
                }),
                (n.cd = function (e) {
                  (e && !this.C && (this.J = !0), (this.C = e));
                }),
                (n.Lf = function (e) {
                  this.u = e;
                }),
                (n.df = function () {
                  return this.u;
                }),
                (n.rh = function (e) {
                  this.F = e;
                }),
                (n.Jj = function () {
                  return this.F;
                }),
                (n.Hi = function (e, t) {
                  if (0 != e.length) {
                    var r = (Date.now() + this.B) / 1e3;
                    if (
                      0 !=
                      (e = e.filter(function (e) {
                        return e.start + t < r;
                      })).length
                    ) {
                      var i = e[e.length - 1].end + t;
                      (this.xf(e[0].start + t),
                        (this.h = e.reduce(function (e, t) {
                          return Math.max(e, t.end - t.start);
                        }, this.h)),
                        (this.g = Math.max(this.g, i)),
                        null != this.i && this.G && !this.o && (this.i = r - this.g - this.h));
                    }
                  }
                }),
                (n.me = function (e) {
                  if (0 != e.length) {
                    for (
                      var t = e[0].startTime,
                        r = e[0].endTime,
                        i = (Date.now() + this.B) / 1e3,
                        n = (e = g(e)).next();
                      !n.done;
                      n = e.next()
                    )
                      i < (n = n.value).startTime ||
                        ((t = Math.min(t, n.startTime)),
                        (r = Math.max(r, n.endTime)),
                        (this.h = Math.max(this.h, n.endTime - n.startTime)));
                    (this.xf(t),
                      (this.g = Math.max(this.g, r)),
                      null != this.i && this.G && !this.o && (this.i = i - this.g - this.h));
                  }
                }),
                (n.Gi = function (e, t) {
                  (this.xf(e), t == 1 / 0 || this.W() || (this.g = Math.max(this.g, t)));
                }),
                (n.Sj = function () {
                  return this.g;
                }),
                (n.qf = function () {
                  this.o = !0;
                }),
                (n.vk = function () {
                  return this.o;
                }),
                (n.sh = function (e) {
                  this.m = e;
                }),
                (n.Oj = function () {
                  return this.m;
                }),
                (n.xf = function (e) {
                  null == this.j ? (this.j = e) : this.J || (this.j = Math.min(this.j, e));
                }),
                (n.Wg = function (e) {
                  this.h = Math.max(this.h, e);
                }),
                (n.offset = function (e) {
                  (null != this.j && (this.j += e), null != this.g && (this.g += e));
                }),
                (n.W = function () {
                  return this.l == 1 / 0 && !this.C;
                }),
                (n.Vc = function () {
                  return this.l != 1 / 0 && !this.C;
                }),
                (n.Hb = function () {
                  return Math.max(this.I, this.Ic() - this.u);
                }),
                (n.Yi = function (e) {
                  this.I = e;
                }),
                (n.Ic = function () {
                  return this.W() || this.Vc()
                    ? Math.min(Math.max(0, (Date.now() + this.B) / 1e3 - this.h - this.i) + this.H, this.l)
                    : this.g
                      ? Math.min(this.g, this.l)
                      : this.l;
                }),
                (n.ae = function (e) {
                  var t = Math.max(this.j, this.I);
                  return this.u == 1 / 0
                    ? Math.ceil(1e3 * t) / 1e3
                    : Math.max(t, Math.min(this.Ic() - this.u + e, this.Gb()));
                }),
                (n.Zb = function () {
                  return this.ae(0);
                }),
                (n.Gb = function () {
                  return Math.max(0, this.Ic() - (this.W() || this.Vc() ? this.F : 0));
                }),
                (n.kj = function () {
                  return !(null == this.i || (null != this.g && this.G));
                }),
                (n.Ui = function (e) {
                  this.H = e;
                }),
                (n.Ej = function () {
                  return this.H;
                }),
                j("shaka.media.PresentationTimeline", ll),
                (ll.prototype.getAvailabilityTimeOffset = ll.prototype.Ej),
                (ll.prototype.setAvailabilityTimeOffset = ll.prototype.Ui),
                (ll.prototype.usingPresentationStartTime = ll.prototype.kj),
                (ll.prototype.getSeekRangeEnd = ll.prototype.Gb),
                (ll.prototype.getSeekRangeStart = ll.prototype.Zb),
                (ll.prototype.getSafeSeekRangeStart = ll.prototype.ae),
                (ll.prototype.getSegmentAvailabilityEnd = ll.prototype.Ic),
                (ll.prototype.setUserSeekStart = ll.prototype.Yi),
                (ll.prototype.getSegmentAvailabilityStart = ll.prototype.Hb),
                (ll.prototype.isInProgress = ll.prototype.Vc),
                (ll.prototype.isLive = ll.prototype.W),
                (ll.prototype.offset = ll.prototype.offset),
                (ll.prototype.notifyMaxSegmentDuration = ll.prototype.Wg),
                (ll.prototype.notifyMinSegmentStartTime = ll.prototype.xf),
                (ll.prototype.getInitialProgramDateTime = ll.prototype.Oj),
                (ll.prototype.setInitialProgramDateTime = ll.prototype.sh),
                (ll.prototype.isStartTimeLocked = ll.prototype.vk),
                (ll.prototype.lockStartTime = ll.prototype.qf),
                (ll.prototype.getMaxSegmentEndTime = ll.prototype.Sj),
                (ll.prototype.notifyPeriodDuration = ll.prototype.Gi),
                (ll.prototype.notifySegments = ll.prototype.me),
                (ll.prototype.notifyTimeRange = ll.prototype.Hi),
                (ll.prototype.getDelay = ll.prototype.Jj),
                (ll.prototype.setDelay = ll.prototype.rh),
                (ll.prototype.getSegmentAvailabilityDuration = ll.prototype.df),
                (ll.prototype.setSegmentAvailabilityDuration = ll.prototype.Lf),
                (ll.prototype.setStatic = ll.prototype.cd),
                (ll.prototype.setClockOffset = ll.prototype.Vi),
                (ll.prototype.getPresentationStartTime = ll.prototype.Wj),
                (ll.prototype.setDuration = ll.prototype.Ab),
                (ll.prototype.setPresentationStartTime = ll.prototype.Wi),
                (ll.prototype.getMaxSegmentDuration = ll.prototype.Rj),
                (ll.prototype.getDuration = ll.prototype.getDuration),
                (ul.prototype.release = function () {
                  (this.j && (this.j.release(), (this.j = null)),
                    null != this.i && (this.i.stop(), (this.i = null)),
                    this.o && (this.o.release(), (this.o = null)),
                    (this.g = this.F = this.u = null));
                }),
                (ul.prototype.zd = function () {
                  ((this.B = !0), this.i && this.i.Ea(this.h.gapJumpTimerTime), dl(this));
                }),
                (hl.prototype.release = function () {
                  (this.h && this.h.release(), (this.j = this.h = null));
                }),
                (cl.prototype.release = function () {
                  (this.h && this.h.release(), (this.h = null));
                }));
              var gl = new ae(function () {
                return new Map([
                  [HTMLMediaElement.HAVE_METADATA, "loadedmetadata"],
                  [HTMLMediaElement.HAVE_CURRENT_DATA, "loadeddata"],
                  [HTMLMediaElement.HAVE_FUTURE_DATA, "canplay"],
                  [HTMLMediaElement.HAVE_ENOUGH_DATA, "canplaythrough"],
                ]);
              });
              function ml(e, t, r, i) {
                var n = this;
                ((this.g = e),
                  (this.m = t),
                  (this.u = r),
                  (this.l = null),
                  (this.j = function () {
                    return (null == n.l && (n.l = i()), n.l);
                  }),
                  (this.o = !1),
                  (this.h = new re()),
                  (this.i = new Sl(e)),
                  pl(this.g, HTMLMediaElement.HAVE_METADATA, this.h, function () {
                    Tl(n, n.j());
                  }));
              }
              function vl(e) {
                return e.o ? e.g.currentTime : e.j();
              }
              function yl(e, t) {
                e.g.readyState > 0
                  ? El(e.i, t)
                  : pl(e.g, HTMLMediaElement.HAVE_METADATA, e.h, function () {
                      Tl(e, e.j());
                    });
              }
              function Tl(e, t) {
                Math.abs(e.g.currentTime - t) < 0.001
                  ? bl(e)
                  : (e.h.Aa(e.g, "seeking", function () {
                      bl(e);
                    }),
                    El(e.i, e.g.currentTime && 0 != e.g.currentTime ? e.g.currentTime : t));
              }
              function bl(e) {
                ((e.o = !0),
                  e.h.D(e.g, "seeking", function () {
                    return e.m();
                  }),
                  e.u(e.g.currentTime));
              }
              function Sl(e) {
                var t = this;
                ((this.g = e),
                  (this.m = 10),
                  (this.j = this.l = this.i = 0),
                  (this.h = new Ri(function () {
                    t.i <= 0 || t.g.currentTime != t.l || t.g.currentTime === t.j
                      ? t.h.stop()
                      : ((t.g.currentTime = t.j), t.i--);
                  })));
              }
              function El(e, t) {
                ((e.l = e.g.currentTime), (e.j = t), (e.i = e.m), (e.g.currentTime = t), e.h.Ea(0.1));
              }
              function xl(e) {
                ((this.g = e), (this.i = !1), (this.h = null), (this.j = new re()));
              }
              function wl(e) {
                return e.g.getStartDate && ((e = e.g.getStartDate().getTime()), !isNaN(e)) ? e / 1e3 : null;
              }
              function Al(e, t) {
                return (
                  (e = e.g.seekable).length > 0 &&
                    ((t = Math.max(e.start(0), t)), (t = Math.min(e.end(e.length - 1), t))),
                  t
                );
              }
              function Il(e, t, r, i, n, a) {
                var s = this;
                ((this.h = e),
                  (this.g = t.presentationTimeline),
                  (this.l = r),
                  (this.u = n),
                  (this.o = null),
                  (this.i = new ul(e, t.presentationTimeline, r, a)),
                  (this.j = new ml(
                    e,
                    function () {
                      e: {
                        var e = s.i;
                        ((e.m = !0), (e.B = !1), e.i && e.i.Ea(e.h.gapJumpTimerTime), dl(e));
                        var t = vl(s.j);
                        if (((e = Cl(s, t)), !Za() && Math.abs(e - t) > 0.001)) {
                          t = !1;
                          var r = se().Si();
                          if (r) {
                            var i = Date.now() / 1e3;
                            (!s.o || s.o < i - r) && ((s.o = i), (t = !0));
                          } else t = !0;
                          if (t) {
                            (yl(s.j, e), (e = void 0));
                            break e;
                          }
                        }
                        (s.u(), (e = void 0));
                      }
                      return e;
                    },
                    function (e) {
                      var t = s.i;
                      (t.g.seeking && !t.m && ((t.m = !0), (t.l = e)),
                        t.i && t.i.Ea(t.h.gapJumpTimerTime),
                        dl(t));
                    },
                    function () {
                      return kl(s, i);
                    },
                  )),
                  (this.m = new Ri(function () {
                    if (0 != s.h.readyState && !s.h.paused) {
                      var e = vl(s.j),
                        t = s.g.Zb(),
                        r = s.g.Gb();
                      (r - t < 3 && (t = r - 3), e < t && ((e = Cl(s, e)), (s.h.currentTime = e)));
                    }
                  })));
              }
              function kl(e, t) {
                return (
                  null == t
                    ? (t = e.g.getDuration() < 1 / 0 ? e.g.Zb() : e.g.Gb())
                    : t instanceof Date
                      ? (t = t.getTime() / 1e3 - (e.g.m || e.g.i))
                      : t < 0 && (t = e.g.Gb() + t),
                  Rl(e, Ll(e, t))
                );
              }
              function Rl(e, t) {
                var r = e.g.getDuration();
                return t >= r ? r - e.l.durationBackoff : t;
              }
              function Cl(e, t) {
                var r = e.l.rebufferingGoal,
                  i = e.l.safeSeekOffset,
                  n = e.g.Zb(),
                  a = e.g.Gb(),
                  s = e.g.getDuration();
                a - n < 3 && (n = a - 3);
                var o = e.g.ae(r),
                  l = e.g.ae(i);
                return (
                  (r = e.g.ae(r + i)),
                  t >= s
                    ? Rl(e, t)
                    : t > a
                      ? a - e.l.safeSeekEndOffset
                      : t < n
                        ? e.g.W() && e.l.returnToEndOfLiveWindowWhenOutside
                          ? a - e.l.safeSeekEndOffset
                          : zs(e.h.buffered, l)
                            ? l
                            : r
                        : t >= o || zs(e.h.buffered, t)
                          ? t
                          : r
                );
              }
              function Ll(e, t) {
                var r = e.g.Zb();
                return t < r ? r : t > (e = e.g.Gb()) ? e : t;
              }
              function Ml(e) {
                ((this.g = e), (this.m = null), (this.i = 0), (this.o = !1));
              }
              function Dl(e) {
                return e.g[0] || null;
              }
              function _l(e, t, r) {
                return new Ml([
                  (e = new Bs(
                    e,
                    e + t,
                    function () {
                      return r;
                    },
                    0,
                    null,
                    null,
                    e,
                    e,
                    e + t,
                  )),
                ]);
              }
              function Pl(e, t, r, i) {
                ((this.i = e), (this.h = t), (this.g = r), (this.reverse = i));
              }
              function Ol() {
                (Ml.call(this, []), (this.h = []));
              }
              function Nl(e) {
                var t = this;
                ((this.g = e),
                  (this.j = !1),
                  (this.i = this.g.cf()),
                  (this.h = new Ri(function () {
                    t.g.Di(0.25 * t.i);
                  })));
              }
              function Fl(e) {
                e.h.stop();
                var t = e.j ? 0 : e.i;
                if (t >= 0)
                  try {
                    return void (e.g.cf() != t && e.g.uh(t));
                  } catch (r) {}
                (e.h.Ea(0.25), 0 != e.g.cf() && e.g.uh(0));
              }
              function Ul(e) {
                var t = this;
                ((this.j = e),
                  (this.h = new re()),
                  (this.g = new Set()),
                  (this.i = new Ri(function () {
                    Bl(t, !1);
                  }).Jb()),
                  e.paused || this.i.Ea(0.25),
                  this.h.D(e, "playing", function () {
                    t.i.Jb().Ea(0.25);
                  }),
                  this.h.D(e, "pause", function () {
                    t.i.stop();
                  }));
              }
              function Bl(e, t) {
                for (var r = e.j.currentTime, i = (e = g(e.g)).next(); !i.done; i = e.next()) i.value.j(r, t);
              }
              function $l(e) {
                (Fn.call(this), (this.g = new Map()), (this.h = e));
              }
              function jl(e, t, r) {
                return !!(
                  (e = e.h()[r]) &&
                  e.length > 0 &&
                  ((r = e[e.length - 1].end), t >= e[0].start && t < r)
                );
              }
              function Gl(e) {
                var t = {
                  bandwidth: e.bandwidth || 0,
                  audioSamplingRate: null,
                  codecs: e.codecs,
                  contentType: e.type,
                  frameRate: null,
                  height: null,
                  mimeType: e.mimeType,
                  channelsCount: null,
                  pixelAspectRatio: null,
                  width: null,
                  label: null,
                  roles: e.roles,
                  language: null,
                };
                return (
                  "video" == e.type &&
                    ((t.frameRate = e.frameRate || null),
                    (t.height = e.height || null),
                    (t.pixelAspectRatio = e.pixelAspectRatio || null),
                    (t.width = e.width || null)),
                  "audio" == e.type &&
                    ((t.audioSamplingRate = e.audioSamplingRate),
                    (t.channelsCount = e.channelsCount),
                    (t.label = e.label || null),
                    (t.language = e.language)),
                  t
                );
              }
              function Vl(e) {
                (Fn.call(this), (this.h = new Map()), (this.i = e), (this.g = null));
              }
              function Hl(e, t) {
                var r =
                  t.schemeIdUri + "_" + t.id + "_" + t.startTime.toFixed(1) + "_" + t.endTime.toFixed(1);
                e.h.has(r) ||
                  (e.h.set(r, t),
                  (t = new Pn("regionadd", new Map([["region", t]]))),
                  e.dispatchEvent(t),
                  (function (e) {
                    e.g ||
                      (e.g = new Ri(function () {
                        for (var t = e.i(), r = g(e.h), i = r.next(); !i.done; i = r.next()) {
                          var n = g(i.value);
                          ((i = n.next().value),
                            (n = n.next().value).endTime < t.start &&
                              (e.h.delete(i),
                              (i = new Pn("regionremove", new Map([["region", n]]))),
                              e.dispatchEvent(i)));
                        }
                        !e.h.size && e.g && (e.g.stop(), (e.g = null));
                      }).Ea(2));
                  })(e));
              }
              function Kl(e, t, r, i, n) {
                ((this.m = e),
                  (this.i = t),
                  (this.l = r),
                  (this.g = new Map()),
                  (this.j = new Map()),
                  (this.h = null),
                  (this.o = i),
                  (this.u =
                    n ||
                    function (e, t) {
                      return !(t.fastSwitching && e.Xc && e.je);
                    }));
              }
              function Wl(e, t) {
                e.l = t;
                for (var r = (e = g(e.g.values())).next(); !r.done; r = e.next()) r.value.g = t;
              }
              function zl(e, t, r) {
                if (((r = void 0 !== r && r), !e.i.segmentIndex)) return Promise.resolve();
                if ((e.h || (e.h = e.i.segmentIndex.Xb(t, !0, e.o)), !e.h)) return Promise.resolve();
                for (r && e.h.next(), t = []; e.g.size < e.m && (r = e.h.next().value); ) {
                  var i = !0;
                  if (
                    (r.isPreload() && null != r.endByte && (i = !1),
                    2 == r.Kc() && (i = !1),
                    r.$b(!1) && (i = !1),
                    i && r.ea && t.push(ql(e, r.ea)),
                    i && !e.g.has(r) && ((i = new eu(e.l)), t.push(tu(i, r, e.i)), e.g.set(r, i)),
                    !e.u(r, e.i))
                  )
                    break;
                }
                return (Ql(e), Promise.all(t));
              }
              function ql(e, t) {
                if (
                  !e.i.segmentIndex ||
                  t.$b() ||
                  Array.from(e.j.keys()).some(function (e) {
                    return Us(e, t);
                  })
                )
                  return Promise.resolve();
                var r = new eu(e.l),
                  i = tu(r, t, e.i);
                return (e.j.set(t, r), i);
              }
              function Xl(e, t) {
                for (var r = (t = g(t.keys())).next(); !r.done; r = t.next()) (r = r.value) && Zl(e, r);
              }
              function Yl(e) {
                (Xl(e, e.g), Xl(e, e.j), (e.h = null));
              }
              function Ql(e) {
                if (e.g.size)
                  for (
                    var t = Array.from(e.g.keys()), r = g(e.j.keys()), i = r.next(), n = {};
                    !i.done;
                    n = { Qg: void 0 }, i = r.next()
                  )
                    ((n.Qg = i.value),
                      t.some(
                        (function (e) {
                          return function (t) {
                            return Us(t.ea, e.Qg);
                          };
                        })(n),
                      ) || Zl(e, n.Qg));
              }
              function Jl(e, t) {
                e.m = t;
                for (var r = Array.from(e.g.keys()); r.length > t; ) {
                  var i = r.pop();
                  i && Zl(e, i);
                }
                Ql(e);
              }
              function Zl(e, t) {
                var r = e.g;
                (t instanceof Fs && (r = e.j), (e = r.get(t)), r.delete(t), e && e.abort());
              }
              function eu(e) {
                ((this.g = e), (this.oe = this.Bh = null));
              }
              function tu(e, t, r) {
                var i = new Uint8Array(0);
                return (
                  (e.oe = e.g(t, r, function (t) {
                    return D(function (r) {
                      if (1 == r.g)
                        return ((i = i.byteLength > 0 ? lt(i, t) : t), e.Bh ? b(r, e.Bh(i), 3) : r.A(0));
                      ((i = new Uint8Array(0)), S(r));
                    });
                  })),
                  e.oe.promise.catch(function (e) {
                    return e instanceof ze && 7001 == e.code ? Promise.resolve() : Promise.reject(e);
                  })
                );
              }
              function ru(e) {
                var t = pi(e);
                return {
                  type: t.split("/")[0],
                  mimeType: t,
                  codecs: (e = gi(e)),
                  language: null,
                  height: null,
                  width: null,
                  channelCount: null,
                  sampleRate: null,
                  closedCaptions: new Map(),
                  ze: null,
                  colorGamut: null,
                  frameRate: null,
                  timescale: null,
                };
              }
              function iu(e, t, r) {
                function i(e) {
                  s = e.name;
                  var t = e.reader;
                  t.skip(24);
                  var r = t.Ca(),
                    i = t.Ca();
                  (t.skip(50), (f = String(r)), (c = String(i)), e.reader.Ia() && sa(e));
                }
                function n(e) {
                  var t = as(e.reader);
                  ((p = t.channelCount), (m = t.sampleRate), a(e.name));
                }
                function a(e) {
                  switch ((e = e.toLowerCase())) {
                    case "avc1":
                    case "avc3":
                      (l.push(e + ".42E01E"), (d = !0));
                      break;
                    case "hev1":
                    case "hvc1":
                      (l.push(e + ".1.6.L93.90"), (d = !0));
                      break;
                    case "dvh1":
                    case "dvhe":
                      (l.push(e + ".05.04"), (d = !0));
                      break;
                    case "vp09":
                      (l.push(e + ".00.10.08"), (d = !0));
                      break;
                    case "av01":
                      (l.push(e + ".0.01M.08"), (d = !0));
                      break;
                    case "mp4a":
                      (o.push("mp4a.40.2"), (u = !0));
                      break;
                    case "ac-3":
                    case "ec-3":
                    case "ac-4":
                    case "opus":
                    case "flac":
                      (o.push(e), (u = !0));
                      break;
                    case "apac":
                      (o.push("apac.31.00"), (u = !0));
                  }
                }
                var s,
                  o = [],
                  l = [],
                  u = !1,
                  d = !1,
                  h = null,
                  c = null,
                  f = null,
                  p = null,
                  m = null,
                  v = null,
                  y = null,
                  T = null;
                if (
                  (new aa()
                    .box("moov", sa)
                    .box("trak", sa)
                    .box("mdia", sa)
                    .S("mdhd", function (e) {
                      ((e = is(e.reader, e.version)), (h = e.language), (T = e.timescale));
                    })
                    .box("minf", sa)
                    .box("stbl", sa)
                    .S("stsd", oa)
                    .box("mp4a", function (e) {
                      var t = as(e.reader);
                      ((p = t.channelCount), (m = t.sampleRate), e.reader.Ia() ? sa(e) : a(e.name));
                    })
                    .box("esds", function (e) {
                      e = e.reader;
                      for (var t, r, i = "mp4a"; e.Ia(); ) {
                        t = e.Y();
                        for (var n = e.Y(); 128 & n; ) n = e.Y();
                        if (3 == t)
                          (e.Ca(), 128 & (n = e.Y()) && e.Ca(), 64 & n && e.skip(e.Y()), 32 & n && e.Ca());
                        else if (4 == t) ((r = e.Y()), e.skip(12));
                        else if (5 == t) break;
                      }
                      (r &&
                        ((i += "." + os(r)),
                        5 == t &&
                          e.Ia() &&
                          (31 == (r = (248 & (t = e.Y())) >> 3) &&
                            e.Ia() &&
                            (r = 32 + ((7 & t) << 3) + ((224 & e.Y()) >> 5)),
                          (i += "." + r))),
                        o.push(i),
                        (u = !0));
                    })
                    .box("ac-3", n)
                    .box("ec-3", n)
                    .box("ac-4", n)
                    .box("Opus", n)
                    .box("fLaC", n)
                    .box("apac", n)
                    .box("avc1", i)
                    .box("avc3", i)
                    .box("hev1", i)
                    .box("hvc1", i)
                    .box("dva1", i)
                    .box("dvav", i)
                    .box("dvh1", i)
                    .box("dvhe", i)
                    .box("vp09", i)
                    .box("av01", i)
                    .box("avcC", function (e) {
                      var t = s || "";
                      switch (s) {
                        case "dvav":
                          t = "avc3";
                          break;
                        case "dva1":
                          t = "avc1";
                      }
                      ((e = e.reader).skip(1),
                        (e = t + "." + os(e.Y()) + os(e.Y()) + os(e.Y())),
                        l.push(e),
                        (d = !0));
                    })
                    .box("hvcC", function (e) {
                      var t = s || "";
                      switch (s) {
                        case "dvh1":
                          t = "hvc1";
                          break;
                        case "dvhe":
                          t = "hev1";
                      }
                      var r = e.reader;
                      r.skip(1);
                      var i = ["", "A", "B", "C"][(e = r.Y()) >> 6],
                        n = 31 & e,
                        a = r.U(),
                        o = (32 & e) >> 5 ? "H" : "L";
                      ((e = [r.Y(), r.Y(), r.Y(), r.Y(), r.Y(), r.Y()]), (r = r.Y()));
                      for (var u = 0, h = 0; h < 32 && ((u |= 1 & a), 31 != h); h++) ((u <<= 1), (a >>= 1));
                      for (
                        t = t + "." + i + n + "." + os(u, !0), t += "." + o + r, i = "", n = e.length;
                        n--;
                      )
                        ((o = e[n]) || i) && (i = "." + o.toString(16).toUpperCase() + i);
                      ((t += i), l.push(t), (d = !0));
                    })
                    .box("dvcC", function (e) {
                      var t = s || "";
                      switch (s) {
                        case "hvc1":
                          t = "dvh1";
                          break;
                        case "hev1":
                          t = "dvhe";
                          break;
                        case "avc1":
                          t = "dva1";
                          break;
                        case "avc3":
                          t = "dvav";
                          break;
                        case "av01":
                          t = "dav1";
                      }
                      var r = e.reader;
                      (r.skip(2),
                        (e = r.Y()),
                        (r = r.Y()),
                        l.push(t + "." + ls((e >> 1) & 127) + "." + ls(((e << 5) & 32) | ((r >> 3) & 31))),
                        (d = !0));
                    })
                    .box("dvvC", function (e) {
                      var t = s || "";
                      switch (s) {
                        case "hvc1":
                          t = "dvh1";
                          break;
                        case "hev1":
                          t = "dvhe";
                          break;
                        case "avc1":
                          t = "dva1";
                          break;
                        case "avc3":
                          t = "dvav";
                          break;
                        case "av01":
                          t = "dav1";
                      }
                      var r = e.reader;
                      (r.skip(2),
                        (e = r.Y()),
                        (r = r.Y()),
                        l.push(t + "." + ls((e >> 1) & 127) + "." + ls(((e << 5) & 32) | ((r >> 3) & 31))),
                        (d = !0));
                    })
                    .S("vpcC", function (e) {
                      var t = s || "",
                        r = e.reader;
                      e = r.Y();
                      var i = r.Y();
                      ((r = (r.Y() >> 4) & 15),
                        l.push(t + "." + ls(e) + "." + ls(i) + "." + ls(r)),
                        (d = !0));
                    })
                    .box("av1C", function (e) {
                      var t = s || "";
                      "dav1" === s && (t = "av01");
                      var r = e.reader;
                      r.skip(1);
                      var i = (e = r.Y()) >>> 5,
                        n = (64 & (r = r.Y())) >> 6;
                      (l.push(
                        t +
                          "." +
                          i +
                          "." +
                          ls(31 & e) +
                          (r >>> 7 ? "H" : "M") +
                          "." +
                          ls(2 === i && n ? ((32 & r) >> 5 ? 12 : 10) : n ? 10 : 8) +
                          "." +
                          ((16 & r) >> 4) +
                          "." +
                          ((8 & r) >> 3) +
                          ((4 & r) >> 2) +
                          (3 & r) +
                          "." +
                          ls(1) +
                          "." +
                          ls(1) +
                          "." +
                          ls(1) +
                          ".0",
                      ),
                        (d = !0));
                    })
                    .box("enca", ua)
                    .box("encv", la)
                    .box("sinf", sa)
                    .box("frma", function (e) {
                      a((e = ss(e.reader).codec));
                    })
                    .box("colr", function (e) {
                      l = l.map(function (t) {
                        if (t.startsWith("av01.")) {
                          var r = e.reader,
                            i = r.Pa(),
                            n = r.Tb(4, !1),
                            a = String.fromCharCode(n[0]);
                          if (
                            ((a += String.fromCharCode(n[1])),
                            (a += String.fromCharCode(n[2])),
                            "nclx" === (a += String.fromCharCode(n[3])))
                          ) {
                            ((n = r.Ca()), (a = r.Ca()));
                            var s = r.Ca(),
                              o = r.Y() >> 7,
                              l = t.split(".");
                            10 == l.length &&
                              ((l[6] = ls(n)),
                              (l[7] = ls(a)),
                              (l[8] = ls(s)),
                              (l[9] = String(o)),
                              (t = l.join(".")));
                          }
                          r.seek(i);
                        }
                        return t;
                      });
                      var t = (function (e) {
                          var t = null,
                            r = null,
                            i = e.Tb(4, !1),
                            n = String.fromCharCode(i[0]);
                          if (
                            ((n += String.fromCharCode(i[1])),
                            (n += String.fromCharCode(i[2])),
                            "nclx" === (n += String.fromCharCode(i[3])))
                          ) {
                            switch (e.Ca()) {
                              case 1:
                              case 5:
                              case 6:
                              case 7:
                                t = "srgb";
                                break;
                              case 9:
                                t = "rec2020";
                                break;
                              case 11:
                              case 12:
                                t = "p3";
                            }
                            switch (((i = e.Ca()), e.Ca(), i)) {
                              case 1:
                              case 6:
                              case 13:
                              case 14:
                              case 15:
                                r = "SDR";
                                break;
                              case 16:
                                r = "PQ";
                                break;
                              case 18:
                                r = "HLG";
                            }
                          }
                          return { colorGamut: t, ze: r };
                        })(e.reader),
                        r = t.colorGamut;
                      ((v = t.ze), (y = r));
                    })
                    .parse(e || t, !0, !0),
                  !o.length && !l.length)
                )
                  return null;
                var b = u && !d,
                  S = new Map();
                if (d && !r) {
                  ((r = new Lt("video/mp4")), e && r.init(e));
                  try {
                    r.Af(t);
                    for (var E = g(r.Zf()), x = E.next(); !x.done; x = E.next()) {
                      var w = x.value;
                      S.set(w, w);
                    }
                  } catch (A) {}
                  r.Pd();
                }
                return {
                  type: b ? "audio" : "video",
                  mimeType: b ? "audio/mp4" : "video/mp4",
                  codecs: nu(o.concat(l)).join(", "),
                  language: h,
                  height: c,
                  width: f,
                  channelCount: p,
                  sampleRate: m,
                  closedCaptions: S,
                  ze: v,
                  colorGamut: y,
                  frameRate: null,
                  timescale: T,
                };
              }
              function nu(e) {
                for (var t = new Set(), r = [], i = (e = g(e)).next(); !i.done; i = e.next()) {
                  var n = fi((i = i.value));
                  t.has(n) || (r.push(i), t.add(n));
                }
                return (
                  (t = pt("audio", r)),
                  (i = pt("video", r)),
                  (e = pt(gt, r)),
                  (i = (function (e) {
                    if (e.length <= 1) return e;
                    var t = e.find(function (e) {
                      return (
                        e.startsWith("dvav.") ||
                        e.startsWith("dva1.") ||
                        e.startsWith("dvh1.") ||
                        e.startsWith("dvhe.") ||
                        e.startsWith("dav1.") ||
                        e.startsWith("dvc1.") ||
                        e.startsWith("dvi1.")
                      );
                    });
                    return t
                      ? Ja('video/mp4; codecs="' + t + '"')
                        ? [t]
                        : e.filter(function (e) {
                            return e != t;
                          })
                      : e;
                  })(i)),
                  (t = t.concat(i).concat(e)),
                  r.length && !t.length ? r : t
                );
              }
              function au(t, r, i) {
                var n, a, s, o, l;
                return D(function (u) {
                  if (1 == u.g) return (n = r).cryptoKey ? u.A(2) : b(u, n.fetchKey(), 3);
                  if (!(a = n.iv))
                    for (
                      a = Oe(new ArrayBuffer(16)), s = n.firstMediaSequenceNumber + i, o = a.byteLength - 1;
                      o >= 0;
                      o--
                    )
                      ((a[o] = 255 & s), (s >>= 8));
                  return (
                    (l =
                      "CBC" == r.blockCipherMode
                        ? { name: "AES-CBC", iv: a }
                        : { name: "AES-CTR", counter: a, length: 64 }),
                    u.return(e.crypto.subtle.decrypt(l, n.cryptoKey, t))
                  );
                });
              }
              function su(e, t, r) {
                var i, n, a, s, o, l, u;
                return D(function (d) {
                  switch (d.g) {
                    case 1:
                      return (
                        (i = ou(e)),
                        (n = uu.get(i))
                          ? d.return(n)
                          : ((a = 0),
                            (s = Vn([e], r)),
                            E(d, 2),
                            (s.method = "HEAD"),
                            b(d, t.request(a, s).promise, 4))
                      );
                    case 4:
                      ((o = d.h), (n = o.headers["content-type"]), w(d, 3));
                      break;
                    case 2:
                      if (!(l = A(d)) || (1002 != l.code && 1001 != l.code)) {
                        d.A(3);
                        break;
                      }
                      return ((s.method = "GET"), b(d, t.request(a, s).promise, 6));
                    case 6:
                      ((u = d.h), (n = u.headers["content-type"]));
                    case 3:
                      return d.return(n ? n.toLowerCase().split(";").shift() : "");
                  }
                });
              }
              function ou(e) {
                return 1 == (e = new me(e).Sb.split("/").pop().split(".")).length
                  ? ""
                  : e.pop().toLowerCase();
              }
              function lu(e, t, r, i, n) {
                return (
                  (e = Vn(e, i, n)),
                  (0 == t && null == r) ||
                    (e.headers.Range = r ? "bytes=" + t + "-" + r : "bytes=" + t + "-"),
                  e
                );
              }
              ((ml.prototype.release = function () {
                (this.h && (this.h.release(), (this.h = null)),
                  null != this.i && (this.i.release(), (this.i = null)),
                  (this.m = function () {}),
                  (this.g = null));
              }),
                (Sl.prototype.release = function () {
                  (this.h && (this.h.stop(), (this.h = null)), (this.g = null));
                }),
                ((n = xl.prototype).ready = function () {
                  var e = this;
                  pl(this.g, HTMLMediaElement.HAVE_FUTURE_DATA, this.j, function () {
                    !(function () {
                      if (null == e.h || (0 == e.h && e.g.duration != 1 / 0)) e.i = !0;
                      else {
                        var t = e.g.currentTime,
                          r = null;
                        if ("number" == typeof e.h) r = e.h;
                        else if (e.h instanceof Date) {
                          var i = wl(e);
                          null !== i && ((r = e.h.getTime() / 1e3 - i), (r = Al(e, r)));
                        }
                        null == r
                          ? (e.i = !0)
                          : (r < 0 && (r = Math.max(0, t + r)),
                            t != r
                              ? (e.j.Aa(e.g, "seeking", function () {
                                  e.i = !0;
                                }),
                                (e.g.currentTime = r))
                              : (e.i = !0));
                      }
                    })();
                  });
                }),
                (n.release = function () {
                  (this.j && (this.j.release(), (this.j = null)), (this.g = null));
                }),
                (n.$f = function (e) {
                  this.h = this.i ? this.h : e;
                }),
                (n.Qd = function () {
                  var e = this.i ? this.g.currentTime : this.h;
                  return (
                    e instanceof Date && (e = Al(this, (e = e.getTime() / 1e3 - (wl(this) || 0)))),
                    e || 0
                  );
                }),
                (n.Nh = function () {
                  return 0;
                }),
                (n.Lh = function () {
                  return 0;
                }),
                (n.Mh = function () {
                  return !1;
                }),
                (n.Fi = function () {}),
                (n.ri = function () {
                  var e = Ws(this.g.buffered);
                  return null != e && e >= this.g.duration - 1;
                }),
                ((n = Il.prototype).ready = function () {
                  this.m.Ea(0.25);
                }),
                (n.release = function () {
                  (this.j && (this.j.release(), (this.j = null)),
                    this.i && (this.i.release(), (this.i = null)),
                    this.m && (this.m.stop(), (this.m = null)),
                    (this.h = this.j = this.g = this.l = null),
                    (this.u = function () {}));
                }),
                (n.$f = function (e) {
                  yl(this.j, kl(this, e));
                }),
                (n.Qd = function () {
                  var e = vl(this.j);
                  return this.h.readyState > 0 && !this.h.paused ? Ll(this, e) : e;
                }),
                (n.Nh = function () {
                  return this.i.H;
                }),
                (n.Lh = function () {
                  return this.i.G;
                }),
                (n.Mh = function () {
                  return this.i.C;
                }),
                (n.Fi = function () {
                  this.i.zd();
                }),
                (n.ri = function () {
                  if (this.g.W()) {
                    var e = this.g.Ic(),
                      t = Ws(this.h.buffered);
                    if (null != t && t >= e) return !0;
                  }
                  return !1;
                }),
                ((n = Ml.prototype).getNumReferences = function () {
                  return this.g.length;
                }),
                (n.getNumEvicted = function () {
                  return this.i;
                }),
                (n.release = function () {
                  this.o || ((this.g = []), this.m && this.m.stop(), (this.m = null));
                }),
                (n.Bk = function () {
                  this.o = !0;
                }),
                (n.Fb = function (e) {
                  for (var t = g(this.g), r = t.next(); !r.done; r = t.next()) e(r.value);
                }),
                (n.find = function (e) {
                  for (var t = this.g.length - 1, r = t; r >= 0; --r) {
                    var i = this.g[r],
                      n = r < t ? this.g[r + 1].startTime : i.endTime;
                    if (e >= i.startTime && e < n) return r + this.i;
                  }
                  return this.g.length && e < this.g[0].startTime ? this.i : null;
                }),
                (n.get = function (e) {
                  return 0 == this.g.length || (e -= this.i) < 0 || e >= this.g.length ? null : this.g[e];
                }),
                (n.offset = function (e) {
                  if (!this.o) for (var t = g(this.g), r = t.next(); !r.done; r = t.next()) r.value.offset(e);
                }),
                (n.tf = function (e) {
                  if (!this.o && e.length) {
                    var t = Math.round(1e3 * e[0].startTime) / 1e3;
                    ((this.g = this.g.filter(function (e) {
                      return Math.round(1e3 * e.startTime) / 1e3 < t;
                    })),
                      this.g.push.apply(this.g, m(e)));
                  }
                }),
                (n.ke = function (e, t) {
                  var r = this;
                  ((e = e.filter(function (e) {
                    return e.endTime > t && (0 == r.g.length || e.endTime > r.g[0].startTime);
                  })),
                    this.tf(e),
                    this.Ya(t));
                }),
                (n.Ya = function (e) {
                  if (!this.o) {
                    var t = this.g.length;
                    ((this.g = this.g.filter(function (t) {
                      return t.endTime > e;
                    })),
                      (this.i += t - this.g.length));
                  }
                }),
                (n.pd = function (e, t, r) {
                  if (((r = void 0 !== r && r), !this.o)) {
                    for (; this.g.length && this.g[this.g.length - 1].startTime >= t; ) this.g.pop();
                    for (; this.g.length && this.g[0].endTime <= e; ) (this.g.shift(), r || this.i++);
                    0 != this.g.length &&
                      (((t = new Bs(
                        (e = this.g[this.g.length - 1]).startTime,
                        t,
                        e.C,
                        e.startByte,
                        e.endByte,
                        e.ea,
                        e.timestampOffset,
                        e.appendWindowStart,
                        e.appendWindowEnd,
                        e.g,
                        e.tilesLayout,
                        e.B,
                        e.h,
                        e.status,
                        e.aesKey,
                      )).mimeType = e.mimeType),
                      (t.codecs = e.codecs),
                      (t.i = e.i),
                      (this.g[this.g.length - 1] = t));
                  }
                }),
                (n.Rf = function (e, t) {
                  var r = this;
                  this.o ||
                    (this.m && this.m.stop(),
                    (this.m = new Ri(function () {
                      var e = t();
                      e ? r.g.push.apply(r.g, m(e)) : (r.m.stop(), (r.m = null));
                    })),
                    this.m.Ea(e));
                }),
                (Ml.prototype[Symbol.iterator] = function () {
                  return this.Xb(0);
                }),
                (Ml.prototype.Xb = function (e, t, r) {
                  ((t = void 0 !== t && t), (r = void 0 !== r && r));
                  var i = this.find(e);
                  if (null == i) return null;
                  var n = this.get(i);
                  r ? i++ : i--;
                  var a = -1;
                  if (n && n.g.length > 0)
                    for (var s = n.g.length - 1; s >= 0; --s) {
                      var o = n.g[s];
                      if (e >= o.startTime && e < o.endTime) {
                        if (!t) {
                          for (; s && !o.l; ) (s--, (o = n.g[s]));
                          if (!o.l) return (W("No independent partial segment found!"), null);
                        }
                        (r ? i-- : i++, (a = s - 1));
                        break;
                      }
                    }
                  return new Pl(this, i, a, r);
                }),
                (Ml.prototype.We = function () {
                  return -1;
                }),
                j("shaka.media.SegmentIndex", Ml),
                (Ml.forSingleSegment = _l),
                (Ml.prototype.getIteratorForTime = Ml.prototype.Xb),
                (Ml.prototype.updateEvery = Ml.prototype.Rf),
                (Ml.prototype.fit = Ml.prototype.pd),
                (Ml.prototype.evict = Ml.prototype.Ya),
                (Ml.prototype.mergeAndEvict = Ml.prototype.ke),
                (Ml.prototype.offset = Ml.prototype.offset),
                (Ml.prototype.get = Ml.prototype.get),
                (Ml.prototype.find = Ml.prototype.find),
                (Ml.prototype.markImmutable = Ml.prototype.Bk),
                (Ml.prototype.release = Ml.prototype.release),
                (Ml.prototype.getNumEvicted = Ml.prototype.getNumEvicted),
                (Ml.prototype.getNumReferences = Ml.prototype.getNumReferences),
                ((n = Pl.prototype).Jd = function (e) {
                  this.reverse = e;
                }),
                (n.zj = function () {
                  return this.h;
                }),
                (n.current = function () {
                  var e = this.i.get(this.h);
                  return (
                    e &&
                      e.g.length > 0 &&
                      e.m &&
                      this.g >= e.g.length &&
                      (this.h++, (this.g = 0), (e = this.i.get(this.h))),
                    e && e.g.length > 0 ? e.g[this.g] : e
                  );
                }),
                (n.next = function () {
                  var e = this.i.get(this.h);
                  return (
                    this.reverse
                      ? e && e.g.length > 0
                        ? (this.g--,
                          this.g < 0 &&
                            (this.h--,
                            (this.g = (e = this.i.get(this.h)) && e.g.length > 0 ? e.g.length - 1 : 0)))
                        : (this.h--, (this.g = 0))
                      : e && e.g.length > 0
                        ? (this.g++, e.m && this.g == e.g.length && (this.h++, (this.g = 0)))
                        : (this.h++, (this.g = 0)),
                    { value: (e = this.current()), done: !e }
                  );
                }),
                (n.jh = function () {
                  var e = this.current();
                  if (e && e.Xc && !e.l && (e = this.i.get(this.h)) && e.g.length > 0)
                    for (var t = e.g[this.g]; t.l && !(this.g <= 0); ) (this.g--, (t = e.g[this.g]));
                }),
                j("shaka.media.SegmentIterator", Pl),
                (Pl.prototype.resetToLastIndependent = Pl.prototype.jh),
                (Pl.prototype.next = Pl.prototype.next),
                (Pl.prototype.current = Pl.prototype.current),
                (Pl.prototype.currentPosition = Pl.prototype.zj),
                (Pl.prototype.setReverse = Pl.prototype.Jd),
                f(Ol, Ml),
                ((n = Ol.prototype).clone = function () {
                  var e = new Ol();
                  return ((e.h = this.h.slice()), (e.i = this.i), e);
                }),
                (n.release = function () {
                  this.h = [];
                }),
                (n.Fb = function (e) {
                  for (var t = g(this.h), r = t.next(); !r.done; r = t.next()) r.value.Fb(e);
                }),
                (n.find = function (e) {
                  for (var t = this.i, r = g(this.h), i = r.next(); !i.done; i = r.next()) {
                    var n = (i = i.value).find(e);
                    if (null != n) return n + t;
                    t += i.getNumEvicted() + i.getNumReferences();
                  }
                  return null;
                }),
                (n.get = function (e) {
                  for (var t = this.i, r = g(this.h), i = r.next(); !i.done; i = r.next()) {
                    var n = (i = i.value).get(e - t);
                    if (n) return n;
                    ((n = i.getNumReferences()), (t += i.getNumEvicted() + n));
                  }
                  return null;
                }),
                (n.offset = function () {}),
                (n.tf = function () {}),
                (n.Ya = function (e) {
                  if (this.h.length) {
                    var t = this.h[0];
                    (t.Ya(e),
                      0 == t.getNumReferences() &&
                        (this.h.shift(), (this.i += t.getNumEvicted()), t.release(), this.Ya(e)));
                  }
                }),
                (n.ke = function () {}),
                (n.pd = function () {}),
                (n.Rf = function () {}),
                j("shaka.media.MetaSegmentIndex", Ol),
                (Ol.prototype.updateEvery = Ol.prototype.Rf),
                (Ol.prototype.fit = Ol.prototype.pd),
                (Ol.prototype.mergeAndEvict = Ol.prototype.ke),
                (Ol.prototype.evict = Ol.prototype.Ya),
                (Ol.prototype.merge = Ol.prototype.tf),
                (Ol.prototype.offset = Ol.prototype.offset),
                (Ol.prototype.get = Ol.prototype.get),
                (Ol.prototype.find = Ol.prototype.find),
                (Ol.prototype.forEachTopLevelReference = Ol.prototype.Fb),
                (Ol.prototype.release = Ol.prototype.release),
                (Nl.prototype.release = function () {
                  (this.set(this.Tc()), this.h && (this.h.stop(), (this.h = null)), (this.g = null));
                }),
                (Nl.prototype.set = function (e) {
                  ((this.i = e), Fl(this));
                }),
                (Nl.prototype.Tc = function () {
                  return this.g.Tc();
                }),
                (Ul.prototype.release = function () {
                  (this.h && (this.h.release(), (this.h = null)), this.i.stop());
                  for (var e = g(this.g), t = e.next(); !t.done; t = e.next()) t.value.release();
                  this.g.clear();
                }),
                f($l, Fn),
                ($l.prototype.release = function () {
                  (this.g.clear(), Fn.prototype.release.call(this));
                }),
                ($l.prototype.j = function (e) {
                  for (var t = g(this.g.values()), r = t.next(); !r.done; r = t.next()) {
                    var i = (r = r.value).pg;
                    e: {
                      for (var n = r.re, a = n.length - 1; a >= 0; a--) {
                        var s = n[a];
                        if (s.position <= e) {
                          n = s.xd;
                          break e;
                        }
                      }
                      n = null;
                    }
                    ((a =
                      n &&
                      !(
                        i === n ||
                        (i &&
                          n &&
                          i.bandwidth == n.bandwidth &&
                          i.audioSamplingRate == n.audioSamplingRate &&
                          i.codecs == n.codecs &&
                          i.contentType == n.contentType &&
                          i.frameRate == n.frameRate &&
                          i.height == n.height &&
                          i.mimeType == n.mimeType &&
                          i.channelsCount == n.channelsCount &&
                          i.pixelAspectRatio == n.pixelAspectRatio &&
                          i.width == n.width)
                      )),
                      (s = n && i && n.label && i.label && i.label !== n.label));
                    var o = n && i && n.language && i.language && i.language !== n.language;
                    ((i = n && i && n.roles && i.roles && !ee(i.roles, n.roles)),
                      (s || o || i) &&
                        jl(this, e, n.contentType) &&
                        ((r.pg = n),
                        (i = new Pn(
                          "audiotrackchange",
                          new Map([
                            ["quality", n],
                            ["position", e],
                          ]),
                        )),
                        this.dispatchEvent(i)),
                      a &&
                        jl(this, e, n.contentType) &&
                        ((r.pg = n),
                        JSON.stringify(n),
                        (r = new Pn(
                          "qualitychange",
                          new Map([
                            ["quality", n],
                            ["position", e],
                          ]),
                        )),
                        this.dispatchEvent(r)));
                  }
                }),
                f(Vl, Fn),
                (Vl.prototype.release = function () {
                  (this.h.clear(),
                    this.g && (this.g.stop(), (this.g = null)),
                    Fn.prototype.release.call(this));
                }),
                (Kl.prototype.Ya = function (e, t) {
                  t = void 0 !== t && t;
                  for (var r = g(this.g.keys()), i = r.next(); !i.done; i = r.next())
                    e > (i = i.value).endTime && Zl(this, i);
                  t && Ql(this);
                }),
                (Kl.prototype.Jd = function (e) {
                  ((this.o = e), this.h && this.h.Jd(e));
                }),
                (eu.prototype.abort = function () {
                  this.oe && this.oe.abort();
                }),
                j("shaka.config.CrossBoundaryStrategy", {
                  KEEP: "keep",
                  RESET: "reset",
                  RESET_TO_ENCRYPTED: "reset_to_encrypted",
                  RESET_ON_ENCRYPTION_CHANGE: "RESET_ON_ENCRYPTION_CHANGE",
                }));
              var uu = new Map()
                .set("mp4", "video/mp4")
                .set("m4v", "video/mp4")
                .set("m4a", "audio/mp4")
                .set("webm", "video/webm")
                .set("weba", "audio/webm")
                .set("mkv", "video/webm")
                .set("ts", "video/mp2t")
                .set("ogv", "video/ogg")
                .set("ogg", "audio/ogg")
                .set("mpg", "video/mpeg")
                .set("mpeg", "video/mpeg")
                .set("mov", "video/quicktime")
                .set("m3u8", "application/x-mpegurl")
                .set("mpd", "application/dash+xml")
                .set("ism", "application/vnd.ms-sstr+xml")
                .set("mp3", "audio/mpeg")
                .set("aac", "audio/aac")
                .set("flac", "audio/flac")
                .set("wav", "audio/wav")
                .set("sbv", "text/x-subviewer")
                .set("srt", "text/srt")
                .set("vtt", "text/vtt")
                .set("webvtt", "text/vtt")
                .set("ttml", "application/ttml+xml")
                .set("lrc", "application/x-subtitle-lrc")
                .set("ssa", "text/x-ssa")
                .set("ass", "text/x-ssa")
                .set("jpeg", "image/jpeg")
                .set("jpg", "image/jpeg")
                .set("png", "image/png")
                .set("svg", "image/svg+xml")
                .set("webp", "image/webp")
                .set("avif", "image/avif")
                .set("html", "text/html")
                .set("htm", "text/html");
              function du(e, t) {
                var r = this;
                ((this.g = t),
                  (this.j = e),
                  (this.i = null),
                  (this.M = new Map()),
                  (this.C = 1),
                  (this.B = this.o = null),
                  (this.V = 0),
                  (this.h = new Map()),
                  (this.N = !1),
                  (this.X = null),
                  (this.F = !1),
                  (this.l = new Qn(function () {
                    return (function (e) {
                      var t, r, i, n, a, s;
                      return D(function (o) {
                        if (1 == o.g) {
                          for (
                            e.u && e.u.stop(),
                              e.u = null,
                              e.K && e.K.stop(),
                              e.K = null,
                              e.G && (e.G.release(), (e.G = null)),
                              t = [],
                              r = g(e.h.values()),
                              i = r.next();
                            !i.done;
                            i = r.next()
                          )
                            (Lu((n = i.value)), t.push(Mu(n)), n.ia && (Yl(n.ia), (n.ia = null)));
                          for (a = g(e.m.values()), s = a.next(); !s.done; s = a.next()) Yl(s.value);
                          return b(o, Promise.all(t), 2);
                        }
                        (e.h.clear(),
                          e.m.clear(),
                          (e.g = null),
                          (e.j = null),
                          (e.i = null),
                          (e.I = null),
                          S(o));
                      });
                    })(r);
                  })),
                  (this.R = Date.now() / 1e3),
                  (this.m = new Map()),
                  (this.T = { projection: null, hfov: null }),
                  (this.ba = 0),
                  (this.$ = 1 / 0),
                  (this.H = null),
                  (this.O = []),
                  (this.u = new Ri(function () {
                    if (r.j && r.g)
                      if (r.j.presentationTimeline.W()) {
                        var e = r.j.presentationTimeline.Zb(),
                          t = r.j.presentationTimeline.Gb();
                        t - e > 1
                          ? (function (e, t, r) {
                              D(function (i) {
                                return e.I.g || e.g.error || e.N || e.H || No(e) || Fo(e)
                                  ? i.return()
                                  : b(
                                      i,
                                      Qo(e, function () {
                                        No(e) || Fo(e) || e.i.setLiveSeekableRange(t, r);
                                      }),
                                      0,
                                    );
                              });
                            })(r.g.Z, e, t)
                          : Ho(r.g.Z);
                      } else (Ho(r.g.Z), r.u && r.u.stop());
                    else r.u && r.u.stop();
                  })),
                  (this.I = null),
                  (this.J = !1),
                  (this.K = new Ri(function () {
                    var e = r.g.video;
                    !e.ended && r.I && ((r.J = !0), (e.currentTime = r.I), (r.I = null));
                  })),
                  (this.G = new re()));
              }
              function hu(e, t) {
                for (var r = e.g.Ob() < 0, i = g(e.h.values()), n = i.next(); !n.done; n = i.next())
                  ((n = n.value).ua && n.ua.Jd(r), n.ia && n.ia.Jd(r));
                for (n = (i = g(e.m.values())).next(); !n.done; n = i.next()) n.value.Jd(r);
                (r = e.h.get("video")) &&
                  (i = r.stream) &&
                  (t
                    ? (t = i.trickModeVideo) && !r.Nc && (pu(e, t, !1, 0, !1), (r.Nc = i))
                    : (t = r.Nc) && ((r.Nc = null), pu(e, t, !0, 0, !1)));
              }
              function cu(e, t, r, i, n, a) {
                ((r = void 0 !== r && r),
                  (i = void 0 === i ? 0 : i),
                  (n = void 0 !== n && n),
                  (a = void 0 !== a && a),
                  (e.o = t),
                  e.N && (t.video && pu(e, t.video, r, i, n, a), t.audio && pu(e, t.audio, r, i, n, a)));
              }
              function fu(e, t) {
                D(function (r) {
                  if (1 == r.g)
                    return (
                      (e.H = null),
                      (e.B = t),
                      e.N ? (t.segmentIndex ? r.A(2) : b(r, t.createSegmentIndex(), 2)) : r.return()
                    );
                  (pu(e, t, !0, 0, !1), S(r));
                });
              }
              function pu(e, t, r, i, n, a) {
                var s = e.h.get(t.type);
                s || t.type != gt
                  ? s &&
                    (s.Nc && (t.trickModeVideo ? ((s.Nc = t), (t = t.trickModeVideo)) : (s.Nc = null)),
                    s.stream != t || n) &&
                    (e.m.has(t)
                      ? (s.ia = e.m.get(t))
                      : s.ia &&
                        (function (e, t) {
                          t && t !== e.i && (Yl(e), (e.i = t));
                        })(s.ia, t),
                    t.type == gt &&
                      s.stream != t &&
                      ((n = li(t.mimeType, t.codecs)), Oo(e.g.Z, n, e.j.sequenceMode, t.external)),
                    !e.m.has(s.stream) &&
                      s.stream.closeSegmentIndex &&
                      (s.Ka
                        ? ((n = "(" + s.type + ":" + s.stream.id + ")"),
                          e.M.has(n) || e.M.set(n, s.stream.closeSegmentIndex))
                        : s.stream.closeSegmentIndex()),
                    (n = s.stream.isAudioMuxedInVideo != t.isAudioMuxedInVideo),
                    (s.stream = t),
                    (s.ua = null),
                    (s.gg = !!a),
                    t.dependencyStream ? (s.Fc = vu(e, t.dependencyStream)) : (s.Fc = null),
                    Nu(e),
                    n &&
                      ((s.pb = null),
                      (s.tc = null),
                      (s.sc = null),
                      t.isAudioMuxedInVideo &&
                        ((t = null),
                        "video" === s.type
                          ? (t = e.h.get("audio"))
                          : "audio" === s.type && (t = e.h.get("video")),
                        t &&
                          (Mu(t).catch(function () {}),
                          (t.pb = null),
                          (t.tc = null),
                          (t.sc = null),
                          mu(e, t),
                          gu(e, t).catch(function (t) {
                            e.g && e.g.onError(t);
                          })))),
                    r
                      ? s.Wb
                        ? (s.Md = !0)
                        : s.Ka
                          ? ((s.Ub = !0), (s.ld = i), (s.Md = !0))
                          : (Lu(s),
                            Ru(e, s, !0, i).catch(function (t) {
                              e.g && e.g.onError(t);
                            }))
                      : s.Ka || s.qb || Cu(e, s, 0),
                    gu(e, s).catch(function (t) {
                      e.g && e.g.onError(t);
                    }))
                  : (function (e, t) {
                      var r, i, n, a, s;
                      D(function (o) {
                        switch (o.g) {
                          case 1:
                            return ((r = mt), e.V++, (i = e.V), E(o, 2), b(o, Go(e.g.Z, r.Na), 4));
                          case 4:
                            w(o, 3);
                            break;
                          case 2:
                            ((n = A(o)), e.g && e.g.onError(n));
                          case 3:
                            ((a = li(t.mimeType, t.codecs)),
                              Oo(e.g.Z, a, e.j.sequenceMode, t.external),
                              (e.g.Z.ba.isTextVisible() || e.i.alwaysStreamText) &&
                                e.V == i &&
                                ((s = vu(e, t)), e.h.set(r.Na, s), Cu(e, s, 0)),
                              S(o));
                        }
                      });
                    })(e, t);
              }
              function gu(e, t) {
                var r, i, n;
                return D(function (a) {
                  if (1 == a.g)
                    return t.Va
                      ? ((r = t.stream),
                        (i = t.Va),
                        r.segmentIndex ? a.A(2) : b(a, r.createSegmentIndex(), 2))
                      : a.return();
                  if (4 != a.g)
                    return !(n = r.dependencyStream) || n.segmentIndex
                      ? a.A(4)
                      : b(a, n.createSegmentIndex(), 4);
                  if (t.Va != i || t.stream != r) return a.return();
                  var s = e.g.nc(),
                    o = Bo(e.g.Z, t.type),
                    l = t.stream.segmentIndex.find(t.Ja ? t.Ja.endTime : s),
                    u = null == l ? null : t.stream.segmentIndex.get(l);
                  ((l = u ? $s(u) : null),
                    u &&
                      !l &&
                      (l = ((u.endTime - u.getStartTime()) * (t.stream.bandwidth || e.o.bandwidth)) / 8),
                    l
                      ? ((u = u.ea) && (l += (u.endByte ? u.endByte + 1 - u.startByte : null) || 0),
                        (s =
                          (8 * l) / (u = e.g.getBandwidthEstimate()) < (o || 0) - s - e.i.rebufferingGoal ||
                          t.Va.h.g > l))
                      : (s = !0),
                    s && t.Va.abort(),
                    S(a));
                });
              }
              function mu(e, t) {
                t.Wb ||
                  t.Ub ||
                  (t.Ka
                    ? ((t.Ub = !0), (t.ld = 0))
                    : null == Uo(e.g.Z, t.type)
                      ? null == t.qb && Cu(e, t, 0)
                      : (Lu(t),
                        Ru(e, t, !1, 0).catch(function (t) {
                          e.g && e.g.onError(t);
                        })));
              }
              function vu(e, t) {
                var r = {
                  stream: t,
                  type: t.type,
                  ua: null,
                  ia: yu(e, t),
                  Ja: null,
                  pb: null,
                  pf: null,
                  tc: null,
                  sc: null,
                  mf: null,
                  nf: null,
                  Nc: null,
                  endOfStream: !1,
                  Ka: !1,
                  qb: null,
                  Ub: !1,
                  ld: 0,
                  Md: !1,
                  Wb: !1,
                  bd: !0,
                  gg: !1,
                  fh: !1,
                  ce: !1,
                  Va: null,
                  Fc: null,
                };
                return (t.dependencyStream && (r.Fc = vu(e, t.dependencyStream)), r);
              }
              function yu(e, t) {
                if (
                  ("video" === t.type && e.i.disableVideoPrefetch) ||
                  ("audio" === t.type && e.i.disableAudioPrefetch) ||
                  (t.type === gt &&
                    ("application/cea-608" == t.mimeType || "application/cea-708" == t.mimeType)) ||
                  (t.type === gt && e.i.disableTextPrefetch)
                )
                  return null;
                if (e.m.has(t)) return e.m.get(t);
                var r = e.h.get(t.type);
                return (r = r && r.ia) && t === r.i
                  ? r
                  : e.i.segmentPrefetchLimit > 0
                    ? new Kl(
                        e.i.segmentPrefetchLimit,
                        t,
                        function (t, r, i) {
                          return ku(t, r, i || null, e.i.retryParameters, e.g.vc);
                        },
                        e.g.Ob() < 0,
                        e.g.hl,
                      )
                    : null;
              }
              function Tu(t, r) {
                var i, n, a, s, o, l, u, d, h;
                return D(function (c) {
                  switch (c.g) {
                    case 1:
                      if ((Jn(t.l), (i = mt), r.Ka || null == r.qb || r.Wb)) return c.return();
                      if (((r.qb = null), !r.Ub)) {
                        c.A(2);
                        break;
                      }
                      return b(c, Ru(t, r, r.Md, r.ld), 3);
                    case 3:
                      return c.return();
                    case 2:
                      if (
                        ((function (e, t) {
                          for (var r = g(e.M.entries()), i = r.next(); !i.done; i = r.next()) {
                            var n = g(i.value);
                            ((i = n.next().value),
                              (n = n.next().value),
                              i.includes(t.type) && (n(), e.M.delete(i)));
                          }
                        })(t, r),
                        r.stream.segmentIndex)
                      ) {
                        c.A(4);
                        break;
                      }
                      return ((n = r.stream), E(c, 5), b(c, r.stream.createSegmentIndex(), 7));
                    case 7:
                      w(c, 6);
                      break;
                    case 5:
                      return ((a = A(c)), b(c, Du(t, r, a), 8));
                    case 8:
                      return c.return();
                    case 6:
                      if (n != r.stream)
                        return (
                          n.closeSegmentIndex && n.closeSegmentIndex(),
                          r.Ka || r.qb || Cu(t, r, 0),
                          c.return()
                        );
                    case 4:
                      if (!r.Fc) {
                        c.A(9);
                        break;
                      }
                      if (r.Fc.stream.segmentIndex) {
                        c.A(9);
                        break;
                      }
                      return (E(c, 11), b(c, r.Fc.stream.createSegmentIndex(), 13));
                    case 13:
                      w(c, 9);
                      break;
                    case 11:
                      A(c);
                    case 9:
                      (E(c, 14),
                        (s = (function (t, r) {
                          if (Au(r))
                            return (
                              (function (e, t) {
                                var r = Bo(e, "video") || 0;
                                xi(e.h, t, r);
                              })(t.g.Z, r.stream.originalId || ""),
                              null
                            );
                          if (
                            (r.type == gt &&
                              (function (e) {
                                e.h && xi(e.h, "", 0);
                              })(t.g.Z),
                            r.stream.isAudioMuxedInVideo && "audio" == r.type)
                          )
                            return null;
                          if (r.type != gt && Fo(t.g.Z)) return (Pu(t, !0), null);
                          var i = t.i.updateIntervalSeconds / Math.max(1, Math.abs(t.g.Ob()));
                          if (!Po(t.g.Z) && r.type != gt) return i / 2;
                          var n = t.g.nc();
                          if ("audio" === r.type)
                            for (var a = g(t.m.keys()), s = a.next(); !s.done; s = a.next())
                              ((s = t.m.get(s.value)).Ya(n, !0), zl(s, n));
                          a = r.Ja ? r.Ja.endTime : n;
                          var o = (function (e, t, r) {
                            return t == gt
                              ? null == (e = e.h).h || e.h < r
                                ? 0
                                : e.h - Math.max(r, e.g)
                              : qs((e = $o(e, t)), r);
                          })(t.g.Z, r.type, n);
                          s = Math.max(1, Math.max(t.i.rebufferingGoal, t.i.bufferingGoal) * t.C);
                          var l = t.j.presentationTimeline.getDuration() - a,
                            u = Bo(t.g.Z, r.type);
                          if (l < 1e-6 && u)
                            return (
                              (r.endOfStream = !0),
                              "video" == r.type && (i = t.h.get(gt)) && Au(i) && (i.endOfStream = !0),
                              null
                            );
                          if (((r.endOfStream = !1), o >= s)) return i / 2;
                          if (((l = !r.ua), !(u = bu(t, r, n, u))))
                            return (
                              (t = 1 / 0),
                              (r = r.Ja) && (t = r.endTime - r.startTime),
                              Math.min(t / 2, i)
                            );
                          o = r.pb;
                          var d = u.ea;
                          (o && d && Us(d, o) && (o.g = d.g),
                            (o = !1),
                            l && r.gg && ((o = !0), (r.gg = !1)),
                            (l = 1 / 0));
                          for (var h = (d = g((d = Array.from(t.h.values())))).next(); !h.done; h = d.next())
                            Au((h = h.value)) ||
                              (h.ua && !h.ua.current()) ||
                              (l = Math.min(l, h.Ja ? h.Ja.endTime : n));
                          return a >= l + t.j.presentationTimeline.h
                            ? i
                            : (r.ia &&
                                r.ua &&
                                !t.m.has(r.stream) &&
                                (r.ia.Ya(u.startTime + 0.001), zl(r.ia, u.startTime).catch(function () {})),
                              (Ou(t) &&
                                (function (e, t, r) {
                                  if (t.type === gt) return !1;
                                  var i = t.pb;
                                  if (!i) return !1;
                                  var n = r.ea;
                                  if (
                                    ((r = i.g !== n.g),
                                    "reset_to_encrypted" === e.i.crossBoundaryStrategy &&
                                      (i.encrypted || n.encrypted || (r = !1),
                                      i.encrypted && (e.i.crossBoundaryStrategy = "keep")),
                                    "RESET_ON_ENCRYPTION_CHANGE" === e.i.crossBoundaryStrategy &&
                                      i.encrypted == n.encrypted &&
                                      (r = !1),
                                    "keep" === e.i.crossBoundaryStrategy && i.mimeType && n.mimeType)
                                  ) {
                                    var a = ci(gi(i.mimeType)),
                                      s = ci(gi(i.mimeType));
                                    i.mimeType == n.mimeType && a == s && (r = !1);
                                  }
                                  return (
                                    r &&
                                      (e.J || t.bd) &&
                                      ((e.J = !1),
                                      Pu(e, !0).then(function () {
                                        var t = new Map()
                                          .set("oldEncrypted", i.encrypted)
                                          .set("newEncrypted", n.encrypted);
                                        e.g.onEvent(new Pn("boundarycrossed", t));
                                      })),
                                    r
                                  );
                                })(t, r, u)) ||
                                ((function (t, r, i, n, a) {
                                  var s, o, l, u, d, h, c, f, p, m, v, y, T, x, I, k;
                                  return D(function (R) {
                                    switch (R.g) {
                                      case 1:
                                        if (
                                          ((s = mt),
                                          (o = r.stream),
                                          (l = r.ua),
                                          (r.Ka = !0),
                                          E(R, 2),
                                          2 == n.Kc())
                                        )
                                          throw new ze(1, 1, 1011);
                                        return b(
                                          R,
                                          (function (e, t, r, i) {
                                            var n, a, s, o, l, u, d, h, c, f, p, m, v, y, T, S;
                                            return D(function (x) {
                                              switch (x.g) {
                                                case 1:
                                                  if (
                                                    ((n = mt),
                                                    (a = null == t.Ja),
                                                    (s = []),
                                                    (o = Math.max(
                                                      0,
                                                      Math.max(r.appendWindowStart, e.ba) - 0.1,
                                                    )),
                                                    (l = Math.min(r.appendWindowEnd, e.$) + 0.1),
                                                    (u = r.codecs || t.stream.codecs),
                                                    (d = fi(u)),
                                                    (h = pi(r.mimeType || t.stream.mimeType)),
                                                    (c = r.timestampOffset) == t.pf &&
                                                      o == t.tc &&
                                                      l == t.sc &&
                                                      d == t.mf &&
                                                      h == t.nf)
                                                  ) {
                                                    x.A(2);
                                                    break;
                                                  }
                                                  if (
                                                    ((f =
                                                      t.mf &&
                                                      t.nf &&
                                                      (function (e, t, r, i, n) {
                                                        return (
                                                          (e = rl(e, t, r, i, n)).jc && e.jc.destroy(),
                                                          e.type == sl
                                                        );
                                                      })(e.g.Z, t.type, h, u, Uu(e))),
                                                    !f)
                                                  ) {
                                                    x.A(3);
                                                    break;
                                                  }
                                                  if (
                                                    ((p = null),
                                                    t.type === n.wa
                                                      ? (p = e.h.get(n.aa))
                                                      : t.type === n.aa && (p = e.h.get(n.wa)),
                                                    !p)
                                                  ) {
                                                    x.A(3);
                                                    break;
                                                  }
                                                  return b(
                                                    x,
                                                    Mu(p).catch(function () {}),
                                                    5,
                                                  );
                                                case 5:
                                                  ((p.pb = null), (p.tc = null), (p.sc = null), mu(e, p));
                                                case 3:
                                                  return b(x, Eu(e, t, c, o, l, r, d, h), 2);
                                                case 2:
                                                  return (
                                                    Us(r.ea, t.pb) ||
                                                      ((t.pb = r.ea),
                                                      r.l &&
                                                        r.ea &&
                                                        ((m = Iu(e, t, r.ea)),
                                                        (v = function () {
                                                          var a, s, o, l, u, d, h, c, f, p, v;
                                                          return D(function (y) {
                                                            switch (y.g) {
                                                              case 1:
                                                                return (E(y, 2), b(y, m, 4));
                                                              case 4:
                                                                return (
                                                                  (a = y.h),
                                                                  Jn(e.l),
                                                                  (s = null),
                                                                  (o = new Map()),
                                                                  (l = { projection: null, hfov: null }),
                                                                  t.stream &&
                                                                    (u = t.stream.videoLayout) &&
                                                                    ((d = u.split("/")).includes("PROJ-RECT")
                                                                      ? (l.projection = "rect")
                                                                      : d.includes("PROJ-EQUI")
                                                                        ? (l.projection = "equi")
                                                                        : d.includes("PROJ-HEQU")
                                                                          ? (l.projection = "hequ")
                                                                          : d.includes("PROJ-PRIM")
                                                                            ? (l.projection = "prim")
                                                                            : d.includes("PROJ-AIV") &&
                                                                              (l.projection = "hequ")),
                                                                  (h = new aa())
                                                                    .box("moov", sa)
                                                                    .box("trak", sa)
                                                                    .box("mdia", sa)
                                                                    .S("mdhd", function (e) {
                                                                      s = is(e.reader, e.version).timescale;
                                                                    })
                                                                    .box("hdlr", function (e) {
                                                                      switch (
                                                                        ((e = e.reader).skip(8), e.Yc())
                                                                      ) {
                                                                        case "soun":
                                                                          o.set(n.aa, s);
                                                                          break;
                                                                        case "vide":
                                                                          o.set(n.wa, s);
                                                                      }
                                                                      s = null;
                                                                    }),
                                                                  t.type !== n.wa ||
                                                                    l.projection ||
                                                                    h
                                                                      .box("minf", sa)
                                                                      .box("stbl", sa)
                                                                      .S("stsd", oa)
                                                                      .box("encv", la)
                                                                      .box("avc1", la)
                                                                      .box("avc3", la)
                                                                      .box("hev1", la)
                                                                      .box("hvc1", la)
                                                                      .box("dvav", la)
                                                                      .box("dva1", la)
                                                                      .box("dvh1", la)
                                                                      .box("dvhe", la)
                                                                      .box("dvc1", la)
                                                                      .box("dvi1", la)
                                                                      .box("vexu", sa)
                                                                      .box("proj", sa)
                                                                      .S("prji", function (e) {
                                                                        ((e = e.reader.Yc()),
                                                                          (l.projection = e));
                                                                      })
                                                                      .box("hfov", function (e) {
                                                                        ((e = e.reader.U() / 1e3),
                                                                          (l.hfov = e));
                                                                      }),
                                                                  h.parse(a, !0, !0),
                                                                  t.type === n.wa &&
                                                                    (function (e, t) {
                                                                      if (
                                                                        e.T.projection != t.projection ||
                                                                        e.T.hfov != t.hfov
                                                                      ) {
                                                                        if (
                                                                          null != t.projection ||
                                                                          null != t.hfov
                                                                        ) {
                                                                          var r = new Map().set("detail", t);
                                                                          r = new Pn("spatialvideoinfo", r);
                                                                        } else
                                                                          r = new Pn("nospatialvideoinfo");
                                                                        ((r.cancelable = !0),
                                                                          e.g.onEvent(r),
                                                                          (e.T = t));
                                                                      }
                                                                    })(e, l),
                                                                  o.has(t.type)
                                                                    ? (r.ea.timescale = o.get(t.type))
                                                                    : null != s && (r.ea.timescale = s),
                                                                  (c = t.stream.segmentIndex) instanceof Ol &&
                                                                    (f = (function (e, t) {
                                                                      for (
                                                                        var r = (e = g(e.h)).next();
                                                                        !r.done;
                                                                        r = e.next()
                                                                      )
                                                                        if (null != (r = r.value).find(t))
                                                                          return r.We();
                                                                      return -1;
                                                                    })(c, r.startTime)),
                                                                  (p =
                                                                    t.stream.closedCaptions &&
                                                                    t.stream.closedCaptions.size > 0),
                                                                  b(y, e.g.Uh(t.type, a), 5)
                                                                );
                                                              case 5:
                                                                return b(
                                                                  y,
                                                                  jo(
                                                                    e.g.Z,
                                                                    t.type,
                                                                    a,
                                                                    null,
                                                                    t.stream,
                                                                    p,
                                                                    t.bd,
                                                                    i,
                                                                    !1,
                                                                    !1,
                                                                    f,
                                                                  ),
                                                                  6,
                                                                );
                                                              case 6:
                                                                w(y, 0);
                                                                break;
                                                              case 2:
                                                                throw ((v = A(y)), (t.pb = null), v);
                                                            }
                                                          });
                                                        }),
                                                        (y = r.startTime),
                                                        a && null != (T = Bo(e.g.Z, t.type)) && (y = T),
                                                        e.g.Fk(y, r.ea),
                                                        s.push(v()))),
                                                    (S = t.Ja ? t.Ja.i : -1),
                                                    r.i != S &&
                                                      s.push(
                                                        (function (e, t, r) {
                                                          var i, n;
                                                          return D(function (a) {
                                                            return 1 == a.g
                                                              ? t == (i = mt).Na
                                                                ? a.return()
                                                                : (t == i.wa && (e.ab = new kn()),
                                                                  !e.J ||
                                                                  ((n = Bo(e, t)) && Math.abs(n - r) < 0.15)
                                                                    ? a.return()
                                                                    : (Yo(
                                                                        e,
                                                                        t,
                                                                        function () {
                                                                          return Wo(e, t);
                                                                        },
                                                                        null,
                                                                      ),
                                                                      e.m &&
                                                                        Yo(
                                                                          e,
                                                                          i.aa,
                                                                          function () {
                                                                            return Wo(e, i.aa);
                                                                          },
                                                                          null,
                                                                        ),
                                                                      b(
                                                                        a,
                                                                        Yo(
                                                                          e,
                                                                          t,
                                                                          function () {
                                                                            return zo(e, t, r);
                                                                          },
                                                                          null,
                                                                        ),
                                                                        2,
                                                                      )))
                                                              : e.m
                                                                ? b(
                                                                    a,
                                                                    Yo(
                                                                      e,
                                                                      i.aa,
                                                                      function () {
                                                                        return zo(e, i.aa, r);
                                                                      },
                                                                      null,
                                                                    ),
                                                                    0,
                                                                  )
                                                                : a.A(0);
                                                          });
                                                        })(e.g.Z, t.type, r.startTime),
                                                      ),
                                                    b(x, Promise.all(s), 0)
                                                  );
                                              }
                                            });
                                          })(t, r, n, a),
                                          4,
                                        );
                                      case 4:
                                        return (
                                          Jn(t.l),
                                          t.F
                                            ? R.return()
                                            : ((u = "video/mp4" == o.mimeType || "audio/mp4" == o.mimeType),
                                              (d = e.ReadableStream),
                                              t.i.lowLatencyMode &&
                                              t.j.isLowLatency &&
                                              d &&
                                              u &&
                                              ("HLS" != t.j.type || n.o)
                                                ? ((c = new Uint8Array(0)),
                                                  (p = f = !1),
                                                  (v = function (e) {
                                                    var s, l, u;
                                                    return D(function (d) {
                                                      switch (d.g) {
                                                        case 1:
                                                          if (f) return d.return();
                                                          if (((p = !0), Jn(t.l), t.F)) return d.return();
                                                          if (
                                                            (E(d, 2),
                                                            (c = lt(c, e)),
                                                            (s = !1),
                                                            (l = 0),
                                                            new aa()
                                                              .box("mdat", function (e) {
                                                                ((l = e.size + e.start), (s = !0));
                                                              })
                                                              .parse(c, !1, !0),
                                                            !s)
                                                          ) {
                                                            d.A(4);
                                                            break;
                                                          }
                                                          return (
                                                            (u = c.subarray(0, l)),
                                                            (c = c.subarray(l)),
                                                            b(d, xu(t, r, i, o, n, u, !0, a), 5)
                                                          );
                                                        case 5:
                                                          r.ia && r.ua && zl(r.ia, n.startTime, !0);
                                                        case 4:
                                                          w(d, 0);
                                                          break;
                                                        case 2:
                                                          ((m = A(d)), S(d));
                                                      }
                                                    });
                                                  }),
                                                  b(R, Iu(t, r, n, v), 9))
                                                : b(R, Iu(t, r, n), 7))
                                        );
                                      case 7:
                                        return (
                                          (h = R.h),
                                          Jn(t.l),
                                          t.F
                                            ? R.return()
                                            : (Jn(t.l),
                                              r.Ub
                                                ? ((r.Ka = !1), Cu(t, r, 0), R.return())
                                                : b(R, xu(t, r, i, o, n, h, !1, a), 6))
                                        );
                                      case 9:
                                        if (((y = R.h), m)) throw m;
                                        if (p) {
                                          R.A(10);
                                          break;
                                        }
                                        return (
                                          (f = !0),
                                          Jn(t.l),
                                          t.F
                                            ? R.return()
                                            : r.Ub
                                              ? ((r.Ka = !1), Cu(t, r, 0), R.return())
                                              : b(R, xu(t, r, i, o, n, y, !1, a), 10)
                                        );
                                      case 10:
                                        r.ia && r.ua && zl(r.ia, n.startTime, !0);
                                      case 6:
                                        if ((Jn(t.l), t.F)) return R.return();
                                        ((r.Ja = n),
                                          l.next(),
                                          (r.Ka = !1),
                                          (r.fh = !1),
                                          (T = t.g.Z.Gc()),
                                          (x = T[r.type]),
                                          JSON.stringify(x),
                                          r.Ub ||
                                            ((I = null),
                                            r.type === s.wa
                                              ? (I = t.h.get(s.aa))
                                              : r.type === s.aa && (I = t.h.get(s.wa)),
                                            I && I.type == s.aa
                                              ? t.g.zd(n, r.stream, I.stream.isAudioMuxedInVideo, !1)
                                              : t.g.zd(n, r.stream, r.stream.codecs.includes(","), !1)),
                                          Lu(r),
                                          Cu(t, r, 0),
                                          w(R, 0));
                                        break;
                                      case 2:
                                        if (((k = A(R)), Jn(t.l, k), t.F)) return R.return();
                                        if (((r.Ka = !1), 7001 == k.code))
                                          ((r.Ka = !1), Lu(r), Cu(t, r, 0), R.A(0));
                                        else {
                                          if (r.type != s.Na || !t.i.ignoreTextStreamFailures)
                                            return 3017 == k.code
                                              ? b(
                                                  R,
                                                  (function (e, t, r) {
                                                    var i, n, a, s, o;
                                                    return D(function (l) {
                                                      switch (l.g) {
                                                        case 1:
                                                          if (
                                                            Array.from(e.h.values()).some(function (e) {
                                                              return e != t && e.fh;
                                                            })
                                                          ) {
                                                            l.A(2);
                                                            break;
                                                          }
                                                          if (e.i.avoidEvictionOnQuotaExceededError)
                                                            return (
                                                              (i = _u(e, r)),
                                                              e.g.disableStream(t.stream, i) || Cu(e, t, 4),
                                                              l.return()
                                                            );
                                                          if ((n = Math.round(100 * e.C)) > 20) {
                                                            ((e.C -= 0.2), l.A(3));
                                                            break;
                                                          }
                                                          if (n > 4) {
                                                            ((e.C -= 0.04), l.A(3));
                                                            break;
                                                          }
                                                          if (
                                                            ((a = _u(e, r)), !e.g.disableStream(t.stream, a))
                                                          ) {
                                                            ((t.ce = !0), (e.F = !0), e.g.onError(r), l.A(5));
                                                            break;
                                                          }
                                                          return (
                                                            (e.C = 1),
                                                            (s = e.g.nc()),
                                                            b(l, wu(e, t, s), 5)
                                                          );
                                                        case 5:
                                                          return l.return();
                                                        case 3:
                                                          return (
                                                            (t.fh = !0),
                                                            (o = e.g.nc()),
                                                            b(l, wu(e, t, o), 2)
                                                          );
                                                        case 2:
                                                          (Cu(e, t, 4), S(l));
                                                      }
                                                    });
                                                  })(t, r, k),
                                                  0,
                                                )
                                              : ((r.ce = !0),
                                                1 == k.category && r.ia && Zl(r.ia, n),
                                                (k.severity = 2),
                                                b(R, Du(t, r, k), 0));
                                          (t.h.delete(s.Na), R.A(0));
                                        }
                                    }
                                  });
                                })(t, r, n, u, o).catch(function () {}),
                                r.Fc && Su(t, r.Fc, n, s)),
                              null);
                        })(t, r)),
                        null != s && (Cu(t, r, s), (r.ce = !1)),
                        w(c, 15));
                      break;
                    case 14:
                      return ((o = A(c)), b(c, Du(t, r, o), 16));
                    case 16:
                      return c.return();
                    case 15:
                      if (r.type === i.Na) return c.return();
                      if (
                        ((l = []),
                        r.stream && !r.stream.isAudioMuxedInVideo && l.push(r),
                        (u = r.type === i.aa ? i.wa : i.aa),
                        (d = t.h.get(u)) && d.stream && !d.stream.isAudioMuxedInVideo && l.push(d),
                        !t.N ||
                          !l.every(function (e) {
                            return e.endOfStream;
                          }))
                      ) {
                        c.A(0);
                        break;
                      }
                      return b(c, t.g.Z.endOfStream(), 18);
                    case 18:
                      (Jn(t.l),
                        0 != (h = t.g.Z.getDuration()) &&
                          h < t.j.presentationTimeline.getDuration() &&
                          t.j.presentationTimeline.Ab(h),
                        S(c));
                  }
                });
              }
              function bu(e, t, r, i) {
                if (t.ua)
                  return (
                    (r = t.ua.current()) &&
                      t.Ja &&
                      Math.abs(t.Ja.startTime - r.startTime) < 0.001 &&
                      (r = t.ua.next().value),
                    r
                  );
                if (t.Ja || i)
                  return (
                    (r = t.Ja ? t.Ja.endTime : i),
                    (e = e.g.Ob() < 0),
                    t.stream.segmentIndex && (t.ua = t.stream.segmentIndex.Xb(r, !1, e)),
                    t.ua && t.ua.next().value
                  );
                i = e.j.sequenceMode || Ou(e) ? 0 : e.i.inaccurateManifestTolerance;
                var n = Math.max(r - i, 0);
                e = e.g.Ob() < 0;
                var a = null;
                return (
                  i &&
                    (t.stream.segmentIndex && (t.ua = t.stream.segmentIndex.Xb(n, !1, e)),
                    (a = t.ua && t.ua.next().value)),
                  a ||
                    (t.stream.segmentIndex && (t.ua = t.stream.segmentIndex.Xb(r, !1, e)),
                    (a = t.ua && t.ua.next().value)),
                  a
                );
              }
              function Su(e, t, r, i) {
                var n, a, s, o, l, u, d, h, c, f, p, g;
                return D(function (v) {
                  switch (v.g) {
                    case 1:
                      for (
                        n = mt, a = t.stream, l = (o = (s = a.segmentIndex) && s.Xb(r)) && o.next().value;
                        l && e.O.includes(l.startTime);
                      )
                        l = o && o.next().value;
                      if (!l) {
                        v.A(0);
                        break;
                      }
                      if (!(u = l.ea) || Us(u, t.pb)) {
                        v.A(3);
                        break;
                      }
                      return ((t.pb = u), E(v, 4), b(v, Iu(e, t, u), 6));
                    case 6:
                      d = v.h;
                      var y = e.g.Z;
                      (y.C && bt(y.C, d, 0, a), (e.O = []), w(v, 3));
                      break;
                    case 4:
                      throw ((h = A(v)), (t.pb = null), h);
                    case 3:
                      if (t.Ja && t.Ja == l) {
                        v.A(0);
                        break;
                      }
                      return ((t.Ja = l), E(v, 8), b(v, Iu(e, t, l), 10));
                    case 10:
                      ((c = v.h), (y = e.g.Z).C && bt(y.C, c, 0, a), e.O.push(l.startTime), w(v, 9));
                      break;
                    case 8:
                      throw ((f = A(v)), (t.Ja = null), f);
                    case 9:
                      if (
                        (t.Ub ||
                          ((p = null),
                          t.type === n.wa ? (p = e.h.get(n.aa)) : t.type === n.aa && (p = e.h.get(n.wa)),
                          p && p.type == n.aa
                            ? e.g.zd(l, t.stream, p.stream.isAudioMuxedInVideo, !0)
                            : e.g.zd(l, t.stream, t.stream.codecs.includes(","), !0)),
                        (g = Math.max.apply(Math, [0].concat(m(e.O)))),
                        e.g.nc() + i > g)
                      )
                        return b(v, Su(e, t, l.startTime, i), 0);
                      v.A(0);
                  }
                });
              }
              function Eu(e, t, r, i, n, a, s, o) {
                var l, u, d, h, c;
                return D(function (f) {
                  switch (f.g) {
                    case 1:
                      if (
                        ((l = mt),
                        (u = Uu(e)),
                        E(f, 2),
                        (t.tc = i),
                        (t.sc = n),
                        s && (t.mf = s),
                        o && (t.nf = o),
                        (t.pf = r),
                        (d = e.j.sequenceMode || "HLS" == e.j.type),
                        (h = null),
                        t.type === l.wa ? (h = e.h.get(l.aa)) : t.type === l.aa && (h = e.h.get(l.wa)),
                        !(h && h.stream && h.stream.isAudioMuxedInVideo))
                      ) {
                        f.A(4);
                        break;
                      }
                      return b(f, Vo(e.g.Z, h.type, r, i, n, d, h.stream.mimeType, h.stream.codecs, u), 4);
                    case 4:
                      return b(
                        f,
                        Vo(
                          e.g.Z,
                          t.type,
                          r,
                          i,
                          n,
                          d,
                          a.mimeType || t.stream.mimeType,
                          a.codecs || t.stream.codecs,
                          u,
                        ),
                        6,
                      );
                    case 6:
                      w(f, 0);
                      break;
                    case 2:
                      throw (
                        (c = A(f)),
                        (t.tc = null),
                        (t.sc = null),
                        (t.mf = null),
                        (t.nf = null),
                        (t.pf = null),
                        c
                      );
                  }
                });
              }
              function xu(e, t, r, i, n, a, s, o) {
                var l, u, d, h;
                return (
                  (s = void 0 !== s && s),
                  (o = void 0 !== o && o),
                  D(function (c) {
                    switch (c.g) {
                      case 1:
                        return (
                          (l = i.closedCaptions && i.closedCaptions.size > 0),
                          e.i.shouldFixTimestampOffset &&
                            ((u = "video/mp4" == i.mimeType || "audio/mp4" == i.mimeType),
                            (d = null),
                            n.ea && (d = n.ea.timescale),
                            u &&
                              d &&
                              "video" === i.type &&
                              "DASH" == e.j.type &&
                              new aa()
                                .box("moof", sa)
                                .box("traf", sa)
                                .S("tfdt", function (r) {
                                  var i, a, s, o, l;
                                  return D(function (u) {
                                    return (
                                      (i = rs(r.reader, r.version)),
                                      (a = i.baseMediaDecodeTime)
                                        ? ((s = -a / d),
                                          (Number(t.pf) || 0) < s
                                            ? ((o = t.tc), (l = t.sc), b(u, Eu(e, t, s, o, l, n), 0))
                                            : u.A(0))
                                        : u.return()
                                    );
                                  });
                                })
                                .parse(a, !1, s)),
                          b(c, wu(e, t, r), 2)
                        );
                      case 2:
                        return (Jn(e.l), (h = t.bd), (t.bd = !1), b(c, e.g.Uh(t.type, a), 3));
                      case 3:
                        return b(c, jo(e.g.Z, t.type, a, n, i, l, h, o, s), 4);
                      case 4:
                        (Jn(e.l), S(c));
                    }
                  })
                );
              }
              function wu(e, t, r) {
                var i, n, a, s, o, l, u, d, h;
                return D(function (c) {
                  return 1 == c.g
                    ? (e.H == t && (e.H = null),
                      (i = t.stream.segmentIndex) instanceof Ol &&
                        (i.Ya(e.j.presentationTimeline.Hb()),
                        (n = []),
                        (function (e, t) {
                          for (var r = (e = g(e.h)).next(); !r.done; r = e.next()) t(r.value);
                        })(i, function (e) {
                          n.push(e.We());
                        })),
                      (a = Math.max(e.i.bufferBehind * e.C, e.j.presentationTimeline.h)),
                      null == (s = Uo(e.g.Z, t.type))
                        ? c.return()
                        : ((o = r - s),
                          (l = e.i.evictionGoal),
                          (u = e.j.presentationTimeline.Zb()),
                          (d = e.j.presentationTimeline.Gb()),
                          (h = o - a),
                          d - u > l && (h = Math.max(o - a, u - l - s)),
                          h <= l ? c.return() : b(c, e.g.Z.remove(t.type, s, s + h, n), 2)))
                    : 4 != c.g
                      ? (Jn(e.l), e.H ? b(c, wu(e, e.H, r), 4) : c.A(0))
                      : (Jn(e.l), void S(c));
                });
              }
              function Au(e) {
                return (
                  e &&
                  e.type == gt &&
                  ("application/cea-608" == e.stream.mimeType || "application/cea-708" == e.stream.mimeType)
                );
              }
              function Iu(e, t, r, i) {
                var n, a, s, o, l;
                return D(function (u) {
                  switch (u.g) {
                    case 1:
                      if ((n = r.$b())) return u.return(n);
                      if (((a = null), t.ia)) {
                        var d = t.ia,
                          h = d.g;
                        (r instanceof Fs && (h = d.j),
                          h.has(r) ? ((d = h.get(r)), i && (d.Bh = i), (a = d.oe)) : (a = null));
                      }
                      return (
                        a || (a = ku(r, t.stream, i || null, e.i.retryParameters, e.g.vc)),
                        (s = 0),
                        t.ua && (s = t.ua.h),
                        (t.Va = a),
                        b(u, a.promise, 2)
                      );
                    case 2:
                      if (((o = u.h), (t.Va = null), (l = o.data), !r.aesKey)) {
                        u.A(3);
                        break;
                      }
                      return b(u, au(l, r.aesKey, s), 4);
                    case 4:
                      l = u.h;
                    case 3:
                      return u.return(l);
                  }
                });
              }
              function ku(e, t, r, i, n, a) {
                a = void 0 !== a && a;
                var s = e instanceof Bs ? e : void 0,
                  o = s ? 1 : 0;
                return (
                  ((e = lu(e.P(), e.startByte, e.endByte, i, r)).contentType = t.type),
                  n.request(qn, e, { type: o, stream: t, segment: s, isPreload: a })
                );
              }
              function Ru(e, t, r, i) {
                var n, a;
                return D(function (s) {
                  return 1 == s.g
                    ? ((t.Ub = !1),
                      (t.Md = !1),
                      (t.ld = 0),
                      (t.Wb = !0),
                      (t.Ja = null),
                      (t.ua = null),
                      t.ia && !e.m.has(t.stream) && Yl(t.ia),
                      i
                        ? ((n = e.g.nc()), (a = e.g.Z.getDuration()), b(s, e.g.Z.remove(t.type, n + i, a), 3))
                        : b(s, Go(e.g.Z, t.type), 4))
                    : 3 != s.g
                      ? (Jn(e.l), r ? b(s, e.g.Z.flush(t.type), 3) : s.A(3))
                      : (Jn(e.l), (t.Wb = !1), (t.endOfStream = !1), t.Ka || t.qb || Cu(e, t, 0), void S(s));
                });
              }
              function Cu(e, t, r) {
                var i = t.type;
                (i != gt || e.h.has(i)) &&
                  (t.qb = new ki(function () {
                    var r;
                    return D(function (i) {
                      return 1 == i.g
                        ? (E(i, 2), b(i, Tu(e, t), 4))
                        : 2 != i.g
                          ? w(i, 0)
                          : ((r = A(i)), e.g && e.g.onError(r), void S(i));
                    });
                  }).ka(r));
              }
              function Lu(e) {
                null != e.qb && (e.qb.stop(), (e.qb = null));
              }
              function Mu(e) {
                return D(function (t) {
                  return e.Va ? b(t, e.Va.abort(), 0) : t.A(0);
                });
              }
              function Du(e, t, r) {
                var i;
                return D(function (n) {
                  if (1 == n.g)
                    return 3024 == r.code ? ((t.Ka = !1), Lu(t), Cu(e, t, 0), n.return()) : b(n, An(e.X), 2);
                  if ((Jn(e.l), 1 === r.category && 1003 != r.code)) {
                    if (t.Nc) return (hu(e, !1), n.return());
                    ((i = _u(e, r)),
                      (r.handled = e.g.disableStream(t.stream, i)),
                      r.handled && (r.severity = 1));
                  }
                  ((r.handled && 1011 == r.code) || e.g.onError(r),
                    r.handled || e.i.failureCallback(r),
                    S(n));
                });
              }
              function _u(e, t) {
                return 0 === e.i.maxDisabledTime && 1011 == t.code ? 1 : e.i.maxDisabledTime;
              }
              function Pu(e, t) {
                var r, i, n, a, s, o;
                return (
                  (t = void 0 !== t && t),
                  D(function (l) {
                    if (1 == l.g) {
                      if (((r = Date.now() / 1e3), (i = e.i.minTimeBetweenRecoveries), !t)) {
                        if (!e.i.allowMediaSourceRecoveries || r - e.R < i) return l.return(!1);
                        e.R = r;
                      }
                      return (
                        (n = mt),
                        (a = e.h.get(n.aa)) &&
                          (Lu(a),
                          a.Va && (a.Va.abort(), (a.Va = null)),
                          (a.pb = null),
                          (a.tc = null),
                          (a.sc = null),
                          (a.Ka = !1),
                          (a.Ub = !1),
                          (a.ld = 0),
                          (a.Md = !1),
                          (a.Wb = !1),
                          a.ua && a.ua.jh()),
                        (s = e.h.get(n.wa)) &&
                          (Lu(s),
                          s.Va && (s.Va.abort(), (s.Va = null)),
                          (s.pb = null),
                          (s.tc = null),
                          (s.sc = null),
                          (s.Ka = !1),
                          (s.Ub = !1),
                          (s.ld = 0),
                          (s.Md = !1),
                          (s.Wb = !1),
                          s.ua && s.ua.jh()),
                        (o = e.g.video.paused),
                        b(l, el(e.g.Z, Uu(e)), 2)
                      );
                    }
                    return (
                      !s || s.Wb || s.Ka || s.qb || Cu(e, s, 0),
                      !a || a.Wb || a.Ka || a.qb || Cu(e, a, 0),
                      o || e.g.video.play(),
                      l.return(!0)
                    );
                  })
                );
              }
              function Ou(e) {
                if ("keep" !== e.i.crossBoundaryStrategy) return !0;
                var t = se();
                if (t.Ib()) {
                  if (!t.Nf())
                    for (r = (t = g(e.h.keys())).next(); !r.done; r = t.next())
                      if (
                        (r = e.h.get(r.value)).type !== mt.Na &&
                        (r = r.stream) &&
                        r.fullMimeTypes &&
                        r.fullMimeTypes.size > 1
                      ) {
                        for (e = new Set(), r = (t = g(r.fullMimeTypes)).next(); !r.done; r = t.next())
                          e.add(hi(r.value));
                        return e.size > 1;
                      }
                } else
                  for (var r = (t = g(e.h.keys())).next(); !r.done; r = t.next())
                    if (
                      (r = e.h.get(r.value)).type !== mt.Na &&
                      (r = r.stream) &&
                      r.fullMimeTypes &&
                      r.fullMimeTypes.size > 1
                    )
                      return !0;
                return !1;
              }
              function Nu(e) {
                (e.G.Qa(),
                  Ou(e) &&
                    (e.G.D(e.g.video, "waiting", function () {
                      return Fu(e);
                    }),
                    e.G.D(e.g.video, "timeupdate", function () {
                      return Fu(e);
                    })));
              }
              function Fu(e) {
                if (Ou(e)) {
                  e.K.stop();
                  var t = e.g.nc(),
                    r = e.h.get("video") || e.h.get("audio");
                  r &&
                    (r = r.pb) &&
                    null !== r.g &&
                    ((t = r.g - t) < 0 || t > 1 || ((e.I = r.g + 0.1), e.K.ka(t)));
                }
              }
              function Uu(e, t) {
                function r(t) {
                  if (t.fullMimeTypes && t.fullMimeTypes.size > 1 && e.h.has(t.type)) {
                    var r = e.h.get(t.type),
                      i = Bo(e.g.Z, r.type),
                      n = e.g.nc();
                    (r = bu(e, r, n, i)) &&
                      r.codecs &&
                      r.mimeType &&
                      ((t.codecs = r.codecs), (t.mimeType = r.mimeType));
                  }
                }
                t = void 0 !== t && t;
                var i = new Map(),
                  n = e.o.audio;
                return (
                  n && (r(n), i.set("audio", n)),
                  (n = e.o.video) && (r(n), i.set("video", n)),
                  t && e.B && i.set(gt, e.B),
                  i
                );
              }
              function Bu() {}
              function $u(e, t, r, i, n) {
                var a,
                  s = n in i,
                  o = s
                    ? r.constructor == Object && 0 == Object.keys(i).length
                    : r.constructor == Object && 0 == Object.keys(r).length,
                  l = s || o,
                  u = !0;
                for (a in t) {
                  var d = n + "." + a,
                    h = s ? i[n] : r[a];
                  l || a in r
                    ? void 0 === t[a]
                      ? void 0 === h || l
                        ? delete e[a]
                        : (e[a] = Wt(h))
                      : o
                        ? (e[a] = t[a])
                        : h.constructor == Object && t[a] && t[a].constructor == Object
                          ? (e[a] || (e[a] = Wt(h)), (d = $u(e[a], t[a], h, i, d)), (u = u && d))
                          : typeof t[a] != typeof h ||
                              null == t[a] ||
                              ("function" != typeof t[a] && t[a].constructor != h.constructor)
                            ? (W("Invalid config, wrong type for " + d), (u = !1))
                            : "function" == typeof r[a] && r[a].length != t[a].length
                              ? (z("Unexpected number of arguments for " + d), (e[a] = t[a]))
                              : (e[a] = Array.isArray(e[a]) ? t[a].slice() : t[a])
                    : (W("Invalid config, unrecognized key " + d), (u = !1));
                }
                return u;
              }
              function ju(e, t) {
                for (var r = {}, i = r, n = 0, a = 0; !((n = e.indexOf(".", n)) < 0); )
                  ((0 != n && "\\" == e[n - 1]) ||
                    ((i[(a = e.substring(a, n).replace(/\\\./g, "."))] = {}), (i = i[a]), (a = n + 1)),
                    (n += 1));
                return ((i[e.substring(a).replace(/\\\./g, ".")] = t), r);
              }
              function Gu(e, t) {
                return e && t;
              }
              function Vu(e, t) {
                function r(e) {
                  return e && "object" == typeof e && !Array.isArray(e);
                }
                return (
                  (e = (function e(t, i) {
                    return Object.keys(t).reduce(function (n, a) {
                      var s = t[a];
                      return (
                        i.hasOwnProperty(a)
                          ? s instanceof HTMLElement && i[a] instanceof HTMLElement
                            ? s.isEqualNode(i[a]) || (n[a] = s)
                            : r(s) && r(i[a])
                              ? ((s = e(s, i[a])), (Object.keys(s).length > 0 || !r(s)) && (n[a] = s))
                              : Array.isArray(s) && Array.isArray(i[a])
                                ? Z(s, i[a]) || (n[a] = s)
                                : (Number.isNaN(s) && Number.isNaN(i[a])) || (s !== i[a] && (n[a] = s))
                          : (n[a] = s),
                        n
                      );
                    }, {});
                  })(e, t)),
                  (function e(t) {
                    for (var i = g(Object.keys(t)), n = i.next(); !n.done; n = i.next())
                      if (!(t[(n = n.value)] instanceof HTMLElement))
                        if (r(t[n]) && 0 === Object.keys(t[n]).length) delete t[n];
                        else {
                          var a = t[n];
                          (Array.isArray(a) && 0 === a.length) || "function" == typeof t[n]
                            ? delete t[n]
                            : r(t[n]) && (e(t[n]), 0 === Object.keys(t[n]).length && delete t[n]);
                        }
                  })(e),
                  e
                );
              }
              function Hu() {}
              function Ku(e) {
                return new me((e = Qe(e))).Db;
              }
              function Wu(e, t, r) {
                function i(e) {
                  (Fe(a).setUint32(s, e.byteLength, !0), (s += 4), a.set(Oe(e), s), (s += e.byteLength));
                }
                if (!r || !r.byteLength) throw new ze(2, 6, 6015);
                var n;
                ((n = "string" == typeof t ? Ze(t, !0) : t), (e = Ze((e = Qe(e)), !0)));
                var a = new Uint8Array(12 + e.byteLength + n.byteLength + r.byteLength),
                  s = 0;
                return (i(e), i(n), i(r), a);
              }
              function zu(e, t, r) {
                return "skd" !== t
                  ? e
                  : ((t = r.serverCertificate), Wu(e, (r = Qe(e).split("skd://").pop()), t));
              }
              function qu(e, t) {
                2 === e &&
                  (e = t.drmInfo) &&
                  Ge(e.keySystem) &&
                  (t.headers["Content-Type"] = "application/octet-stream");
              }
              function Xu(e, t, r) {
                for (
                  r = void 0 === r || r, this.h = e, this.g = new Set([e]), t = (e = g((t = t || []))).next();
                  !t.done;
                  t = e.next()
                )
                  this.add(t.value, r);
              }
              function Yu(e, t) {
                return (
                  e.mimeType == t.mimeType &&
                  Z(
                    (e = e.codecs.split(",").map(function (e) {
                      return fi(e);
                    })),
                    (t = t.codecs.split(",").map(function (e) {
                      return fi(e);
                    })),
                  )
                );
              }
              function Qu() {
                this.h = this.g = null;
              }
              function Ju(e, t) {
                return e
                  .filter(function (e) {
                    return !(e.audio && e.audio.channelsCount && e.audio.channelsCount > t);
                  })
                  .sort(function (e, t) {
                    return e.audio || t.audio
                      ? e.audio
                        ? t.audio
                          ? (t.audio.channelsCount || 0) - (e.audio.channelsCount || 0)
                          : 1
                        : -1
                      : 0;
                  });
              }
              function Zu(e, t) {
                return e.filter(function (e) {
                  return !e.audio || e.audio.codecs == t;
                });
              }
              function ed() {}
              function td() {
                var t = 1 / 0,
                  r = se();
                navigator.connection && navigator.connection.saveData && (t = 360);
                var i = {
                    retryParameters: {
                      maxAttempts: 2,
                      baseDelay: 1e3,
                      backoffFactor: 2,
                      fuzzFactor: 0.5,
                      timeout: 3e4,
                      stallTimeout: 5e3,
                      connectionTimeout: 1e4,
                    },
                    servers: {},
                    clearKeys: {},
                    advanced: {},
                    delayLicenseRequestUntilPlayed: !1,
                    persistentSessionOnlinePlayback: !1,
                    persistentSessionsMetadata: [],
                    initDataTransform: function (t, r, i) {
                      return (
                        "apple" === e.shakaMediaKeysPolyfill &&
                          "skd" == r &&
                          ((r = i.serverCertificate), (t = Wu(t, (i = Ku(t)), r))),
                        t
                      );
                    },
                    logLicenseExchange: !1,
                    updateExpirationTime: 1,
                    preferredKeySystems: [],
                    keySystemsMapping: {},
                    parseInbandPsshEnabled: !1,
                    minHdcpVersion: "",
                    ignoreDuplicateInitData: !0,
                    defaultAudioRobustnessForWidevine: "SW_SECURE_CRYPTO",
                    defaultVideoRobustnessForWidevine: "SW_SECURE_DECODE",
                  },
                  n = "reload";
                r.Ib() && (n = "smooth");
                var a = {
                    trackSelectionCallback: function (e) {
                      return D(function (t) {
                        return t.return(e);
                      });
                    },
                    downloadSizeCallback: function (e) {
                      var t;
                      return D(function (r) {
                        return 1 == r.g
                          ? navigator.storage && navigator.storage.estimate
                            ? b(r, navigator.storage.estimate(), 3)
                            : r.return(!0)
                          : ((t = r.h), r.return(t.usage + e < 0.95 * t.quota));
                      });
                    },
                    progressCallback: function (e, t) {
                      return Gu([e, t]);
                    },
                    usePersistentLicense: !0,
                    numberOfParallelDownloads: 5,
                  },
                  s = {
                    drm: i,
                    manifest: {
                      retryParameters: {
                        maxAttempts: 2,
                        baseDelay: 1e3,
                        backoffFactor: 2,
                        fuzzFactor: 0.5,
                        timeout: 3e4,
                        stallTimeout: 5e3,
                        connectionTimeout: 1e4,
                      },
                      availabilityWindowOverride: NaN,
                      disableAudio: !1,
                      disableVideo: !1,
                      disableText: !1,
                      disableThumbnails: !1,
                      disableIFrames: !1,
                      defaultPresentationDelay: 0,
                      segmentRelativeVttTiming: !1,
                      raiseFatalErrorOnManifestUpdateRequestFailure: !1,
                      continueLoadingWhenPaused: !0,
                      ignoreSupplementalCodecs: !1,
                      updatePeriod: -1,
                      ignoreDrmInfo: !1,
                      enableAudioGroups: !0,
                      dash: {
                        clockSyncUri: "",
                        disableXlinkProcessing: !0,
                        xlinkFailGracefully: !1,
                        ignoreMinBufferTime: !1,
                        autoCorrectDrift: !0,
                        initialSegmentLimit: 1e3,
                        ignoreSuggestedPresentationDelay: !1,
                        ignoreEmptyAdaptationSet: !1,
                        ignoreMaxSegmentDuration: !1,
                        keySystemsByURI: {
                          "urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b": "org.w3.clearkey",
                          "urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e": "org.w3.clearkey",
                          "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed": "com.widevine.alpha",
                          "urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95": "com.microsoft.playready",
                          "urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95": "com.microsoft.playready",
                          "urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2": "com.apple.fps",
                          "urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c": "com.huawei.wiseplay",
                        },
                        manifestPreprocessor: nd,
                        manifestPreprocessorTXml: ad,
                        sequenceMode: !1,
                        useStreamOnceInPeriodFlattening: !1,
                        enableFastSwitching: !0,
                      },
                      hls: {
                        ignoreTextStreamFailures: !1,
                        ignoreImageStreamFailures: !1,
                        defaultAudioCodec: "mp4a.40.2",
                        defaultVideoCodec: "avc1.42E01E",
                        ignoreManifestProgramDateTime: !1,
                        ignoreManifestProgramDateTimeForTypes: [],
                        mediaPlaylistFullMimeType: 'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',
                        liveSegmentsDelay: 3,
                        sequenceMode: r.fd(),
                        ignoreManifestTimestampsInSegmentsMode: !1,
                        disableCodecGuessing: !1,
                        disableClosedCaptionsDetection: !1,
                        allowLowLatencyByteRangeOptimization: !0,
                        allowRangeRequestsToGuessMimeType: !1,
                      },
                      mss: {
                        manifestPreprocessor: nd,
                        manifestPreprocessorTXml: ad,
                        sequenceMode: !1,
                        keySystemsBySystemId: {
                          "9a04f079-9840-4286-ab92-e65be0885f95": "com.microsoft.playready",
                          "79f0049a-4098-8642-ab92-e65be0885f95": "com.microsoft.playready",
                        },
                      },
                    },
                    streaming: {
                      retryParameters: {
                        maxAttempts: 2,
                        baseDelay: 1e3,
                        backoffFactor: 2,
                        fuzzFactor: 0.5,
                        timeout: 3e4,
                        stallTimeout: 5e3,
                        connectionTimeout: 1e4,
                      },
                      failureCallback: function (e) {
                        return Gu([e]);
                      },
                      rebufferingGoal: 0,
                      bufferingGoal: 10,
                      bufferBehind: 30,
                      evictionGoal: 1,
                      ignoreTextStreamFailures: !1,
                      alwaysStreamText: !1,
                      startAtSegmentBoundary: !1,
                      gapDetectionThreshold: 0.5,
                      gapPadding: 0,
                      gapJumpTimerTime: 0.25,
                      durationBackoff: 1,
                      safeSeekOffset: 5,
                      safeSeekEndOffset: 0,
                      stallEnabled: !0,
                      stallThreshold: 1,
                      stallSkip: 0.1,
                      useNativeHlsForFairPlay: !0,
                      inaccurateManifestTolerance: 2,
                      lowLatencyMode: !0,
                      preferNativeDash: !1,
                      preferNativeHls: !1,
                      updateIntervalSeconds: 1,
                      observeQualityChanges: !1,
                      maxDisabledTime: 30,
                      segmentPrefetchLimit: 1,
                      prefetchAudioLanguages: [],
                      disableAudioPrefetch: !1,
                      disableTextPrefetch: !1,
                      disableVideoPrefetch: !1,
                      liveSync: {
                        enabled: !1,
                        targetLatency: 0.5,
                        targetLatencyTolerance: 0.5,
                        maxPlaybackRate: 1.1,
                        minPlaybackRate: 0.95,
                        panicMode: !1,
                        panicThreshold: 60,
                        dynamicTargetLatency: {
                          enabled: !1,
                          stabilityThreshold: 60,
                          rebufferIncrement: 0.5,
                          maxAttempts: 10,
                          maxLatency: 4,
                          minLatency: 1,
                        },
                      },
                      allowMediaSourceRecoveries: !0,
                      minTimeBetweenRecoveries: 5,
                      vodDynamicPlaybackRate: !1,
                      vodDynamicPlaybackRateLowBufferRate: 0.95,
                      vodDynamicPlaybackRateBufferRatio: 0.5,
                      preloadNextUrlWindow: 30,
                      loadTimeout: 30,
                      clearDecodingCache: !1,
                      dontChooseCodecs: !1,
                      shouldFixTimestampOffset: !1,
                      avoidEvictionOnQuotaExceededError: !1,
                      crossBoundaryStrategy: "keep",
                      returnToEndOfLiveWindowWhenOutside: !1,
                    },
                    networking: { forceHTTP: !1, forceHTTPS: !1, minBytesForProgressEvents: 16e3 },
                    mediaSource: {
                      codecSwitchingStrategy: n,
                      addExtraFeaturesToSourceBuffer: function (e) {
                        return Gu([e], "");
                      },
                      forceTransmux: !1,
                      insertFakeEncryptionInInit: !0,
                      correctEc3Enca: !1,
                      modifyCueCallback: function (e, t, r) {
                        return Gu([e, t, r]);
                      },
                      dispatchAllEmsgBoxes: !1,
                      useSourceElements: !0,
                      durationReductionEmitsUpdateEnd: !0,
                    },
                    offline: a,
                    abrFactory: function () {
                      return new bn();
                    },
                    adaptationSetCriteriaFactory: function () {
                      return new (Function.prototype.bind.apply(
                        Qu,
                        [null].concat(m(_.apply(0, arguments))),
                      ))();
                    },
                    abr: {
                      enabled: !0,
                      useNetworkInformation: !0,
                      defaultBandwidthEstimate: 1e6,
                      switchInterval: 8,
                      bandwidthUpgradeTarget: 0.85,
                      bandwidthDowngradeTarget: 0.95,
                      restrictions: {
                        minWidth: 0,
                        maxWidth: 1 / 0,
                        minHeight: 0,
                        maxHeight: t,
                        minPixels: 0,
                        maxPixels: 1 / 0,
                        minFrameRate: 0,
                        maxFrameRate: 1 / 0,
                        minBandwidth: 0,
                        maxBandwidth: 1 / 0,
                        minChannelsCount: 0,
                        maxChannelsCount: 1 / 0,
                      },
                      advanced: { minTotalBytes: 128e3, minBytes: 16e3, fastHalfLife: 2, slowHalfLife: 5 },
                      restrictToElementSize: !1,
                      restrictToScreenSize: !1,
                      ignoreDevicePixelRatio: !1,
                      clearBufferSwitch: !1,
                      safeMarginSwitch: 0,
                      cacheLoadThreshold: 5,
                      minTimeToSwitch: 0,
                      preferNetworkInformationBandwidth: !1,
                      removeLatencyFromFirstPacketTime: !1,
                    },
                    autoShowText: 3,
                    preferredAudioLanguage: "",
                    preferredAudioLabel: "",
                    preferredTextLanguage: "",
                    preferredAudioRole: "",
                    preferredVideoRole: "",
                    preferredTextRole: "",
                    preferredAudioChannelCount: 2,
                    preferredVideoHdrLevel: "AUTO",
                    preferredVideoLayout: "",
                    preferredVideoLabel: "",
                    preferredVideoCodecs: [],
                    preferredAudioCodecs: [],
                    preferredTextFormats: [],
                    preferForcedSubs: !1,
                    preferSpatialAudio: !1,
                    preferredDecodingAttributes: [],
                    restrictions: {
                      minWidth: 0,
                      maxWidth: 1 / 0,
                      minHeight: 0,
                      maxHeight: 1 / 0,
                      minPixels: 0,
                      maxPixels: 1 / 0,
                      minFrameRate: 0,
                      maxFrameRate: 1 / 0,
                      minBandwidth: 0,
                      maxBandwidth: 1 / 0,
                      minChannelsCount: 0,
                      maxChannelsCount: 1 / 0,
                    },
                    playRangeStart: 0,
                    playRangeEnd: 1 / 0,
                    textDisplayer: { captionsUpdatePeriod: 0.25, fontScaleFactor: 1 },
                    textDisplayFactory: function () {
                      return null;
                    },
                    cmcd: {
                      enabled: !1,
                      sessionId: "",
                      contentId: "",
                      rtpSafetyFactor: 5,
                      useHeaders: !1,
                      includeKeys: [],
                      version: 1,
                      targets: [],
                    },
                    cmsd: {
                      enabled: !0,
                      applyMaximumSuggestedBitrate: !0,
                      estimatedThroughputWeightRatio: 0.5,
                    },
                    lcevc: {
                      enabled: !1,
                      dynamicPerformanceScaling: !0,
                      logLevel: 0,
                      drawLogo: !1,
                      poster: !0,
                    },
                    ads: {
                      customPlayheadTracker: !1,
                      skipPlayDetection: !1,
                      supportsMultipleMediaElements: !0,
                      disableHLSInterstitial: !1,
                      disableDASHInterstitial: !1,
                      allowPreloadOnDomElements: !0,
                      allowStartInMiddleOfInterstitial: !0,
                    },
                    ignoreHardwareResolution: !1,
                    queue: { preloadNextUrlWindow: 1 / 0, preloadPrevItem: !0, repeatMode: 0 },
                  };
                return (
                  (a.trackSelectionCallback = function (e) {
                    return D(function (t) {
                      return t.return(
                        (function (e, t, r) {
                          var i = r;
                          "AUTO" == i &&
                            ((r = e.some(function (e) {
                              return !(!e.hdr || "HLG" != e.hdr);
                            })),
                            (i = se().sd(r)));
                          var n = e.filter(function (e) {
                            return !("variant" != e.type || (e.hdr && e.hdr != i));
                          });
                          r = [];
                          var a = ji(
                            t,
                            n.map(function (e) {
                              return e.language;
                            }),
                          );
                          (a &&
                            (r = n.filter(function (e) {
                              return Fi(e.language) == a;
                            })),
                            0 == r.length &&
                              (r = n.filter(function (e) {
                                return e.primary;
                              })),
                            0 == r.length &&
                              (n.map(function (e) {
                                return e.language;
                              }),
                              (r = n)));
                          var s = r.filter(function (e) {
                            return e.height && e.height <= 480;
                          });
                          for (
                            s.length &&
                              (s.sort(function (e, t) {
                                return t.height - e.height;
                              }),
                              (r = s.filter(function (e) {
                                return e.height == s[0].height;
                              }))),
                              t = [],
                              r.length &&
                                ((n = Math.floor(r.length / 2)),
                                r.sort(function (e, t) {
                                  return e.bandwidth - t.bandwidth;
                                }),
                                t.push(r[n])),
                              e = g(e),
                              r = e.next();
                            !r.done;
                            r = e.next()
                          )
                            ((r = r.value).type != gt && "image" != r.type) || t.push(r);
                          return t;
                        })(e, s.preferredAudioLanguage, s.preferredVideoHdrLevel),
                      );
                    });
                  }),
                  r.Wa(s)
                );
              }
              function rd() {
                return {
                  streaming: {
                    inaccurateManifestTolerance: 0,
                    segmentPrefetchLimit: 2,
                    updateIntervalSeconds: 0.1,
                    maxDisabledTime: 1,
                    retryParameters: { baseDelay: 100 },
                  },
                  manifest: { dash: { autoCorrectDrift: !1 }, retryParameters: { baseDelay: 100 } },
                  drm: { retryParameters: { baseDelay: 100 } },
                };
              }
              function id(e, t, r) {
                var i = {
                  ".drm.keySystemsMapping": "",
                  ".drm.servers": "",
                  ".drm.clearKeys": "",
                  ".drm.advanced": {
                    distinctiveIdentifierRequired: !1,
                    persistentStateRequired: !1,
                    videoRobustness: [],
                    audioRobustness: [],
                    sessionType: "",
                    serverCertificate: new Uint8Array(0),
                    serverCertificateUri: "",
                    individualizationServer: "",
                    headers: {},
                  },
                };
                return $u(e, t, r || td(), i, "");
              }
              function nd(e) {
                return Gu([e], e);
              }
              function ad(e) {
                return Gu([e], e);
              }
              function sd() {
                ((this.g = null), (this.h = []));
              }
              function od(e, t) {
                var r = 0;
                e.g && e.g.state == t && (r += e.g.duration);
                for (var i = (e = g(e.h)).next(); !i.done; i = e.next())
                  r += (i = i.value).state == t ? i.duration : 0;
                return r;
              }
              function ld() {
                ((this.i = this.h = null), (this.g = []));
              }
              function ud(e, t, r) {
                e.i != t &&
                  ((e.i = t),
                  e.g.push({
                    timestamp: Date.now() / 1e3,
                    id: t.id,
                    type: "text",
                    fromAdaptation: r,
                    bandwidth: null,
                  }));
              }
              function dd() {
                ((this.C = this.X = NaN),
                  (this.l = ""),
                  (this.j =
                    this.wi =
                    this.u =
                    this.B =
                    this.K =
                    this.F =
                    this.o =
                    this.m =
                    this.J =
                    this.G =
                    this.i =
                    this.T =
                    this.V =
                    this.N =
                    this.O =
                    this.R =
                      NaN),
                  (this.M = 0),
                  (this.H = this.I = NaN),
                  (this.g = new sd()),
                  (this.h = new ld()));
              }
              function hd(e, t, r) {
                ((e.X = t), (e.C = r));
              }
              function cd(e, t) {
                e.j = isNaN(e.j) ? t : e.j + t;
              }
              function fd(e) {
                for (
                  var t = e.X,
                    r = e.C,
                    i = e.l,
                    n = e.B,
                    a = e.O,
                    s = e.R,
                    o = e.N,
                    l = e.V,
                    u = e.T,
                    d = e.u,
                    h = e.i,
                    c = e.G,
                    f = e.J,
                    p = e.m,
                    m = od(e.g, "playing"),
                    v = od(e.g, "paused"),
                    y = od(e.g, "buffering"),
                    T = e.o,
                    b = e.F,
                    S = e.K,
                    E = e.wi,
                    x = e.j,
                    w = e.M,
                    A = e.I,
                    I = e.H,
                    k = (function (e) {
                      function t(e) {
                        return { timestamp: e.timestamp, state: e.state, duration: e.duration };
                      }
                      for (var r = [], i = g(e.h), n = i.next(); !n.done; n = i.next()) r.push(t(n.value));
                      return (e.g && r.push(t(e.g)), r);
                    })(e.g),
                    R = [],
                    C = (e = g(e.h.g)).next();
                  !C.done;
                  C = e.next()
                )
                  ((C = C.value),
                    R.push({
                      timestamp: C.timestamp,
                      id: C.id,
                      type: C.type,
                      fromAdaptation: C.fromAdaptation,
                      bandwidth: C.bandwidth,
                    }));
                return {
                  width: t,
                  height: r,
                  currentCodecs: i,
                  streamBandwidth: n,
                  decodedFrames: a,
                  droppedFrames: s,
                  corruptedFrames: o,
                  stallsDetected: l,
                  gapsJumped: u,
                  estimatedBandwidth: d,
                  completionPercent: h,
                  loadLatency: c,
                  manifestTimeSeconds: f,
                  drmTimeSeconds: p,
                  playTime: m,
                  pauseTime: v,
                  bufferingTime: y,
                  licenseTime: T,
                  liveLatency: b,
                  maxSegmentDuration: S,
                  manifestSizeBytes: E,
                  bytesDownloaded: x,
                  nonFatalErrorCount: w,
                  manifestPeriodCount: A,
                  manifestGapCount: I,
                  stateHistory: k,
                  switchHistory: R,
                };
              }
              function pd(e, t, r, i) {
                (Fn.call(this),
                  (this.N = e),
                  (this.V = t),
                  (this.Da = i.networkingEngine),
                  (this.o = r),
                  (this.C = null),
                  (this.za = 0),
                  (this.Ta = i.md),
                  (this.G = i.yk),
                  (this.Ua = i.zk),
                  (this.g = i.config),
                  (this.m = this.H = this.h = null),
                  (this.oa = !1),
                  (this.I = i.Kk),
                  (this.va = !1),
                  (this.j = null),
                  (this.ba = !1),
                  (this.u = null),
                  (this.M = new Map()),
                  (this.ya = !1),
                  (this.Fa = i.Jk),
                  (this.X = new dd()),
                  (this.ma = new kn()),
                  (this.B = new kn()),
                  (this.O = null),
                  (this.l = !1),
                  (this.$ = i.pj),
                  (this.T = this.i = null),
                  (this.R = !1),
                  (this.K = []),
                  (this.J = []),
                  (this.F = !0));
              }
              function gd(e, t, r) {
                (e = t ? e.J : e.K) ? e.push(r) : r();
              }
              function md(e, t) {
                if (((e.O = t), (e.R = !0), e.K))
                  for (var r = (t = g(e.K)).next(); !r.done; r = t.next()) (r = r.value)();
                e.K = null;
              }
              function vd(e) {
                if (e.l) throw new ze(2, 7, 7003);
              }
              function yd(e, t) {
                e.dispatchEvent(new Pn("onstatechange", new Map().set("state", t)));
              }
              function Td(e, t) {
                var r, i, n;
                return D(function (a) {
                  switch (a.g) {
                    case 1:
                      return !e.h || e.j
                        ? a.return()
                        : (yd(e, "drm-engine"),
                          (e.za = Date.now() / 1e3),
                          (e.j = e.Ta()),
                          (e.G.g = e.j),
                          e.j.configure(e.g.drm, function () {
                            return e.F;
                          }),
                          (r = ln(e.h.variants)),
                          (i = !0),
                          e.h && e.h.presentationTimeline && (i = e.h.presentationTimeline.W()),
                          b(a, Ta(e.j, r, e.h.offlineSessionIds, i), 2));
                    case 2:
                      if ((vd(e), !t)) {
                        a.A(3);
                        break;
                      }
                      return b(a, e.j.Vb(t), 4);
                    case 4:
                      vd(e);
                    case 3:
                      return b(a, Wa(e.G, e.h), 5);
                    case 5:
                      if (!a.h) {
                        a.A(0);
                        break;
                      }
                      return ((n = new Pn("trackschanged", void 0)), b(a, Promise.resolve(), 7));
                    case 7:
                      (e.dispatchEvent(n), S(a));
                  }
                });
              }
              function bd(e) {
                if (!e.u) {
                  var t = e.g.abrFactory;
                  ((e.u = t()), e.u.configure(e.g.abr));
                }
                return (
                  (t = ln(e.h.variants)),
                  (t = e.C.create(t)),
                  e.u.setVariants(Array.from(t.values())),
                  e.u.chooseVariant(!0)
                );
              }
              function Sd(e, t, r) {
                var i, n, a, s, o;
                return D(function (l) {
                  return 1 == l.g
                    ? ((i = e.g.streaming.segmentPrefetchLimit || 2),
                      (n = new Kl(
                        i,
                        t,
                        function (t, r, i) {
                          return ku(t, r, i || null, e.g.streaming.retryParameters, e.Da, e.F);
                        },
                        !1,
                      )),
                      e.M.set(t.id, n),
                      t.segmentIndex ? l.A(2) : b(l, t.createSegmentIndex(), 2))
                    : ((a = "number" == typeof e.o ? e.o : 0),
                      (s = t.segmentIndex.Xb(a)),
                      (o = null),
                      s && ((o = s.current()) || (o = s.next().value)),
                      o || (o = Dl(t.segmentIndex)),
                      o
                        ? r
                          ? o.ea
                            ? b(l, ql(n, o.ea), 0)
                            : l.A(0)
                          : b(l, zl(n, o.startTime), 0)
                        : l.A(0));
                });
              }
              function Ed(e) {
                var t, r, i, n;
                return D(function (a) {
                  for (t = [], r = g([e.video, e.audio]), i = r.next(); !i.done; i = r.next())
                    (n = i.value) && !n.segmentIndex && t.push(n.createSegmentIndex());
                  return t.length > 0 ? b(a, Promise.all(t), 0) : a.A(0);
                });
              }
              function xd(e) {
                function t(e) {
                  return (e.video && e.audio) || (e.video && e.video.codecs.includes(","));
                }
                e.variants.some(t) && (e.variants = e.variants.filter(t));
              }
              function wd(e, t) {
                Fn.call(this);
                var r = this;
                ((this.i = e),
                  (this.l = t),
                  (this.g = new Map()),
                  (this.m = [
                    {
                      kd: null,
                      jd: kd,
                      Uc: function (e, t) {
                        return Ad(r, "enter", e, t);
                      },
                    },
                    {
                      kd: Id,
                      jd: kd,
                      Uc: function (e, t) {
                        return Ad(r, "enter", e, t);
                      },
                    },
                    {
                      kd: Rd,
                      jd: kd,
                      Uc: function (e, t) {
                        return Ad(r, "enter", e, t);
                      },
                    },
                    {
                      kd: kd,
                      jd: Id,
                      Uc: function (e, t) {
                        return Ad(r, "exit", e, t);
                      },
                    },
                    {
                      kd: kd,
                      jd: Rd,
                      Uc: function (e, t) {
                        return Ad(r, "exit", e, t);
                      },
                    },
                    {
                      kd: Id,
                      jd: Rd,
                      Uc: function (e, t) {
                        t ? Ad(r, "skip", e, t) : (Ad(r, "enter", e, t), Ad(r, "exit", e, t));
                      },
                    },
                    {
                      kd: Rd,
                      jd: Id,
                      Uc: function (e, t) {
                        return Ad(r, "skip", e, t);
                      },
                    },
                  ]),
                  (this.h = new re()),
                  this.h.D(this.i, "regionremove", function (e) {
                    r.g.delete(e.region);
                  }));
              }
              function Ad(e, t, r, i) {
                ((t = new Pn(
                  t,
                  new Map([
                    ["region", r],
                    ["seeking", i],
                  ]),
                )),
                  e.dispatchEvent(t));
              }
              (((n = du.prototype).destroy = function () {
                return this.l.destroy();
              }),
                (n.configure = function (e) {
                  if (
                    ((this.i = e),
                    (this.X = new wn(
                      {
                        maxAttempts: Math.max(e.retryParameters.maxAttempts, 2),
                        baseDelay: e.retryParameters.baseDelay,
                        backoffFactor: e.retryParameters.backoffFactor,
                        fuzzFactor: e.retryParameters.fuzzFactor,
                      },
                      !0,
                    )),
                    e.disableAudioPrefetch)
                  ) {
                    var t = this.h.get("audio");
                    t && t.ia && (Yl(t.ia), (t.ia = null));
                    for (var r = (t = g(this.m.keys())).next(); !r.done; r = t.next())
                      ((r = r.value), Yl(this.m.get(r)), this.m.delete(r));
                  }
                  for (
                    e.disableTextPrefetch && (t = this.h.get(gt)) && t.ia && (Yl(t.ia), (t.ia = null)),
                      e.disableVideoPrefetch &&
                        (t = this.h.get("video")) &&
                        t.ia &&
                        (Yl(t.ia), (t.ia = null)),
                      r = (t = g(this.h.keys())).next();
                    !r.done;
                    r = t.next()
                  )
                    (r = this.h.get(r.value)).ia
                      ? (Jl(r.ia, e.segmentPrefetchLimit),
                        e.segmentPrefetchLimit > 0 || (Yl(r.ia), (r.ia = null)))
                      : e.segmentPrefetchLimit > 0 && (r.ia = yu(this, r.stream));
                  e.disableAudioPrefetch ||
                    (function (e) {
                      for (
                        var t = e.i.segmentPrefetchLimit,
                          r = e.i.prefetchAudioLanguages,
                          i = g(e.j.variants),
                          n = i.next(),
                          a = {};
                        !n.done;
                        a = { Mb: void 0 }, n = i.next()
                      )
                        if (((a.Mb = n.value), a.Mb.audio))
                          if (e.m.has(a.Mb.audio)) {
                            if (
                              (Jl((n = e.m.get(a.Mb.audio)), t),
                              !(
                                t > 0 &&
                                r.some(
                                  (function (e) {
                                    return function (t) {
                                      return Pi(e.Mb.audio.language, t);
                                    };
                                  })(a),
                                )
                              ))
                            ) {
                              var s = e.h.get(a.Mb.audio.type);
                              (n !== (s && s.ia) && Yl(n), e.m.delete(a.Mb.audio));
                            }
                          } else
                            t <= 0 ||
                              !r.some(
                                (function (e) {
                                  return function (t) {
                                    return Pi(e.Mb.audio.language, t);
                                  };
                                })(a),
                              ) ||
                              !(n = yu(e, a.Mb.audio)) ||
                              (a.Mb.audio.segmentIndex || a.Mb.audio.createSegmentIndex(),
                              e.m.set(a.Mb.audio, n));
                    })(this);
                }),
                (n.start = function (e) {
                  var t = this;
                  return D(function (r) {
                    if (1 == r.g)
                      return b(
                        r,
                        (function (e, t) {
                          var r, i, n, a, s, o, l;
                          return D(function (u) {
                            if (1 == u.g) {
                              if (!e.o) throw new ze(2, 5, 5006);
                              return (
                                (r = Uu(e, !0)),
                                b(
                                  u,
                                  e.g.Z.init(
                                    r,
                                    e.j.sequenceMode,
                                    e.j.type,
                                    e.j.ignoreManifestTimestampsInSegmentsMode,
                                  ),
                                  2,
                                )
                              );
                            }
                            for (
                              Jn(e.l), e.updateDuration(), i = g(r.keys()), n = i.next();
                              !n.done;
                              n = i.next()
                            )
                              ((a = n.value),
                                (s = r.get(a)),
                                e.h.has(a) ||
                                  ((o = vu(e, s)),
                                  t.has(s.id) &&
                                    (Wl((l = t.get(s.id)), function (t, r, i) {
                                      return ku(t, r, i || null, e.i.retryParameters, e.g.vc);
                                    }),
                                    (o.ia = l)),
                                  e.h.set(a, o),
                                  Cu(e, o, 0)));
                            (Nu(e), S(u));
                          });
                        })(t, e || new Map()),
                        2,
                      );
                    (Jn(t.l), (t.N = !0), S(r));
                  });
                }),
                (n.bd = function () {
                  if (this.g) {
                    for (var e = this.g.nc(), t = g(this.h.keys()), r = t.next(); !r.done; r = t.next()) {
                      var i,
                        n = r.value;
                      if (
                        ((r = this.h.get(n)),
                        (i = !this.J) &&
                          ((i = this.g.Z),
                          (i = !(i =
                            n == gt
                              ? null != (i = i.h).g && null != i.h && e >= i.g && e < i.h
                              : zs((i = $o(i, n)), e)))),
                        i)
                      ) {
                        if (((this.R = 0), r.ia && (r.ia.h = null), "audio" === r.type))
                          for (var a = (i = g(this.m.values())).next(); !a.done; a = i.next())
                            a.value.h = null;
                        ((r.ua = null),
                          (null != Bo(this.g.Z, n) || r.Ka) && mu(this, r),
                          r.Va && (r.Va.abort(), (r.Va = null)),
                          n === gt && (n = this.g.Z).K && n.K.Pd(),
                          (r.bd = !0));
                      }
                      !this.J || r.Wb || r.Ka || r.qb || Cu(this, r, 0);
                    }
                    Ou(this) && Fu(this);
                  }
                }),
                (n.updateDuration = function () {
                  var e = Za(),
                    t = this.j.presentationTimeline.getDuration();
                  t < 1 / 0
                    ? (e && (this.u && this.u.stop(), Ho(this.g.Z)), this.g.Z.Ab(t))
                    : e
                      ? (this.u && this.u.Ea(0.5), this.g.Z.Ab(1 / 0))
                      : this.g.Z.Ab(4294967296);
                }),
                j("shaka.util.ConfigUtils", Bu),
                (Bu.getDifferenceFromConfigObjects = Vu),
                (Bu.convertToConfigObject = ju),
                (Bu.mergeConfigObjects = $u),
                j("shaka.config.RepeatMode", { OFF: 0, ALL: 1, SINGLE: 2 }),
                j("shaka.drm.FairPlay", Hu),
                (Hu.commonFairPlayResponse = function (e, t) {
                  if (2 === e && (e = t.originalRequest.drmInfo) && Ge(e.keySystem)) {
                    try {
                      var r = Xe(t.data);
                    } catch (n) {
                      return;
                    }
                    if (
                      ((e = !1),
                      "<ckc>" === (r = r.trim()).substr(0, 5) &&
                        "</ckc>" === r.substr(-6) &&
                        ((r = r.slice(5, -6)), (e = !0)),
                      !e)
                    )
                      try {
                        var i = JSON.parse(r);
                        (i.ckc && ((r = i.ckc), (e = !0)),
                          i.CkcMessage && ((r = i.CkcMessage), (e = !0)),
                          i.License && ((r = i.License), (e = !0)));
                      } catch (n) {}
                    e && (t.data = Pe(at(r)));
                  }
                }),
                (Hu.muxFairPlayRequest = function (e, t) {
                  qu(e, t);
                }),
                (Hu.expressplayFairPlayRequest = function (e, t) {
                  if (2 === e) {
                    var r = t.drmInfo;
                    r && Ge(r.keySystem) && qu(e, t);
                  }
                }),
                (Hu.conaxFairPlayRequest = function (e, t) {
                  qu(e, t);
                }),
                (Hu.ezdrmFairPlayRequest = function (e, t) {
                  qu(e, t);
                }),
                (Hu.verimatrixFairPlayRequest = function (e, t) {
                  2 === e &&
                    (e = t.drmInfo) &&
                    Ge(e.keySystem) &&
                    ((e = nt((e = Oe(t.body)))),
                    (t.headers["Content-Type"] = "application/x-www-form-urlencoded"),
                    (t.body = Je("spc=" + e)));
                }),
                (Hu.muxInitDataTransform = function (e, t, r) {
                  return zu(e, t, r);
                }),
                (Hu.expressplayInitDataTransform = function (e, t, r) {
                  return zu(e, t, r);
                }),
                (Hu.conaxInitDataTransform = function (t, r, i) {
                  if ("skd" !== r) return t;
                  ((r = i.serverCertificate),
                    (i = Qe(t).split("skd://").pop().split("?").shift()),
                    (i = e.atob(i)));
                  var n = new ArrayBuffer(2 * i.length);
                  n = Ne(n);
                  for (var a = 0, s = i.length; a < s; a++) n[a] = i.charCodeAt(a);
                  return Wu(t, n, r);
                }),
                (Hu.ezdrmInitDataTransform = function (e, t, r) {
                  return "skd" !== t
                    ? e
                    : ((t = r.serverCertificate), Wu(e, (r = Qe(e).split(";").pop()), t));
                }),
                (Hu.verimatrixInitDataTransform = function (e, t, r) {
                  return zu(e, t, r);
                }),
                (Hu.initDataTransform = Wu),
                (Hu.defaultGetContentId = Ku),
                (Hu.isFairPlaySupported = function () {
                  var e;
                  return D(function (t) {
                    return 1 == t.g
                      ? ((e = {
                          initDataTypes: ["cenc", "sinf", "skd"],
                          videoCapabilities: [{ contentType: 'video/mp4; codecs="avc1.42E01E"' }],
                        }),
                        E(t, 2),
                        b(t, navigator.requestMediaKeySystemAccess("com.apple.fps", [e]), 4))
                      : 2 != t.g
                        ? t.return(!0)
                        : (A(t), t.return(!1));
                  });
                }),
                (Xu.prototype.add = function (e, t) {
                  var r,
                    i = this.h;
                  if (
                    ((t = void 0 === t || t),
                    !(r = !!i.audio != !!e.audio || !!i.video != !!e.video || i.language != e.language) &&
                      (r = i.audio && e.audio))
                  ) {
                    r = i.audio;
                    var n = e.audio;
                    r = !(
                      !(
                        ((!r.channelsCount ||
                          !n.channelsCount ||
                          r.channelsCount > 2 ||
                          n.channelsCount > 2) &&
                          r.channelsCount != n.channelsCount) ||
                        r.spatialAudio !== n.spatialAudio ||
                        (t && !Yu(r, n))
                      ) &&
                      Z(r.roles, n.roles) &&
                      r.groupId === n.groupId
                    );
                  }
                  return (
                    !r &&
                      (r = i.video && e.video) &&
                      ((i = i.video), (r = e.video), (r = !((!t || Yu(i, r)) && Z(i.roles, r.roles)))),
                    !r && (this.g.add(e), !0)
                  );
                }),
                (Xu.prototype.values = function () {
                  return this.g.values();
                }),
                j("shaka.media.AdaptationSet", Xu),
                (Qu.prototype.configure = function (e) {
                  this.g = e;
                }),
                (Qu.prototype.getConfiguration = function () {
                  return this.g;
                }),
                (Qu.prototype.create = function (e) {
                  var t;
                  if (this.g.language) {
                    var r = (function (e, t) {
                      var r = ji(
                        (t = Fi(t)),
                        e.map(function (e) {
                          return $i(e);
                        }),
                      );
                      return r
                        ? e.filter(function (e) {
                            return r == $i(e);
                          })
                        : [];
                    })(e, this.g.language);
                    r.length && (t = r);
                  }
                  (t ||
                    (t = (t = e.filter(function (e) {
                      return e.primary;
                    })).length
                      ? t
                      : e),
                    (e = (function (e, t) {
                      return e.filter(function (e) {
                        return !!e.audio && (t ? e.audio.roles.includes(t) : 0 == e.audio.roles.length);
                      });
                    })(t, this.g.role)),
                    e.length && (t = e),
                    (e = (function (e, t) {
                      return e.filter(function (e) {
                        return !!e.video && (t ? e.video.roles.includes(t) : 0 == e.video.roles.length);
                      });
                    })(t, this.g.videoRole)),
                    e.length && (t = e),
                    this.g.videoLayout &&
                      ((e = (function (e, t) {
                        return e.filter(function (e) {
                          return !e.video || !e.video.videoLayout || e.video.videoLayout == t;
                        });
                      })(t, this.g.videoLayout)),
                      e.length && (t = e)),
                    this.g.hdrLevel &&
                      ((e = (function (e, t) {
                        if ("AUTO" == t) {
                          var r = e.some(function (e) {
                            return !(!e.video || !e.video.hdr || "HLG" != e.video.hdr);
                          });
                          t = se().sd(r);
                        }
                        return e.filter(function (e) {
                          return !e.video || !e.video.hdr || e.video.hdr == t;
                        });
                      })(t, this.g.hdrLevel)),
                      e.length && (t = e)));
                  var i = [this.g.channelCount, this.g.preferredAudioChannelCount];
                  if (
                    (e = i.filter(function (e, t) {
                      return e && i.indexOf(e) === t;
                    })).length
                  )
                    for (r = (e = g(e)).next(); !r.done; r = e.next())
                      if ((r = Ju(t, r.value)).length) {
                        t = r;
                        break;
                      }
                  (this.g.audioLabel &&
                    ((e = (function (e, t) {
                      return e.filter(function (e) {
                        return (
                          !(!e.audio || !e.audio.label) && e.audio.label.toLowerCase() == t.toLowerCase()
                        );
                      });
                    })(t, this.g.audioLabel)),
                    e.length && (t = e)),
                    this.g.videoLabel &&
                      ((e = (function (e, t) {
                        return e.filter(function (e) {
                          return (
                            !(!e.video || !e.video.label) && e.video.label.toLowerCase() == t.toLowerCase()
                          );
                        });
                      })(t, this.g.videoLabel)),
                      e.length && (t = e)),
                    (e = (function (e, t) {
                      return e.filter(function (e) {
                        return !e.audio || e.audio.spatialAudio == t;
                      });
                    })(t, this.g.spatialAudio)),
                    e.length && (t = e));
                  var n = [this.g.audioCodec, this.g.activeAudioCodec].concat(m(this.g.preferredAudioCodecs));
                  if (
                    (e = n.filter(function (e, t) {
                      return e && n.indexOf(e) === t;
                    })).length
                  )
                    for (r = (e = g(e)).next(); !r.done; r = e.next())
                      if ((r = Zu(t, r.value)).length) {
                        t = r;
                        break;
                      }
                  return (
                    (e = se()),
                    (e = "smooth" == this.g.codecSwitchingStrategy && e.Ib()),
                    (this.h = new Xu(t[0], t, !e))
                  );
                }),
                (Qu.prototype.getLastAdaptationSet = function () {
                  return this.h;
                }),
                j("shaka.util.PlayerConfiguration", ed),
                (ed.mergeConfigObjects = id),
                (ed.createDefaultForLL = rd),
                (ed.createDefault = td),
                f(pd, Fn),
                ((n = pd.prototype).getStartTime = function () {
                  return this.o;
                }),
                (n.rd = function () {
                  return this.N;
                }),
                (n.Lg = function () {
                  return this.h;
                }),
                (n.getStats = function () {
                  return this.X;
                }),
                (n.Vj = function () {
                  return this.i ? en(this.i) : null;
                }),
                (n.Uj = function () {
                  return this.T ? tn(this.T) : null;
                }),
                (n.start = function () {
                  var t,
                    r = this;
                  D(function (i) {
                    switch (i.g) {
                      case 1:
                        return b(i, Promise.resolve(), 2);
                      case 2:
                        return (
                          E(i, 3),
                          b(
                            i,
                            (function (e) {
                              var t, r, i, n, a;
                              return D(function (s) {
                                switch (s.g) {
                                  case 1:
                                    if (
                                      (yd(e, "manifest-parser"),
                                      e.m ||
                                        ((e.H = At(e.N, e.V)),
                                        (e.m = e.H()),
                                        e.m.configure(e.g.manifest, function () {
                                          return e.F;
                                        })),
                                      (t = Date.now() / 1e3),
                                      yd(e, "manifest"),
                                      e.h)
                                    ) {
                                      s.A(2);
                                      break;
                                    }
                                    return b(s, e.m.start(e.N, e.Ua), 3);
                                  case 3:
                                    return (
                                      (e.h = s.h),
                                      xd(e.h),
                                      b(
                                        s,
                                        (function (e) {
                                          return D(function (t) {
                                            return (
                                              e.C ||
                                                ((e.C = e.g.adaptationSetCriteriaFactory()),
                                                e.C.configure({
                                                  language: e.g.preferredAudioLanguage,
                                                  role: e.g.preferredAudioRole,
                                                  videoRole: e.g.preferredVideoRole,
                                                  channelCount: 0,
                                                  hdrLevel: e.g.preferredVideoHdrLevel,
                                                  spatialAudio: e.g.preferSpatialAudio,
                                                  videoLayout: e.g.preferredVideoLayout,
                                                  audioLabel: e.g.preferredAudioLabel,
                                                  videoLabel: e.g.preferredVideoLabel,
                                                  codecSwitchingStrategy:
                                                    e.g.mediaSource.codecSwitchingStrategy,
                                                  audioCodec: "",
                                                  activeAudioCodec: "",
                                                  activeAudioChannelCount: 0,
                                                  preferredAudioCodecs: e.g.preferredAudioCodecs,
                                                  preferredAudioChannelCount: e.g.preferredAudioChannelCount,
                                                })),
                                              e.i ||
                                              !e.h.variants.length ||
                                              (1 != e.h.variants.length && "HLS" != e.h.type)
                                                ? t.A(0)
                                                : ((e.i = bd(e)), e.i ? b(t, Ed(e.i), 0) : t.A(0))
                                            );
                                          });
                                        })(e),
                                        2,
                                      )
                                    );
                                  case 2:
                                    return (
                                      e.ma.resolve(),
                                      (r = new Pn("manifestparsed", void 0)),
                                      b(s, Promise.resolve(), 5)
                                    );
                                  case 5:
                                    if ((e.dispatchEvent(r), 0 == e.h.variants.length))
                                      throw new ze(2, 4, 4036);
                                    if ((xd(e.h), !za(e.G, e.h))) {
                                      s.A(6);
                                      break;
                                    }
                                    return (
                                      (i = new Pn("trackschanged", void 0)),
                                      b(s, Promise.resolve(), 7)
                                    );
                                  case 7:
                                    (vd(e), e.dispatchEvent(i));
                                  case 6:
                                    ((n = Date.now() / 1e3), (a = n - t), (e.X.J = a), S(s));
                                }
                              });
                            })(r),
                            5,
                          )
                        );
                      case 5:
                        if ((vd(r), "webkit" === e.shakaMediaKeysPolyfill)) {
                          i.A(6);
                          break;
                        }
                        return b(i, Td(r), 7);
                      case 7:
                        vd(r);
                      case 6:
                        return b(
                          i,
                          (function (e) {
                            return D(function (t) {
                              return 1 == t.g
                                ? !e.i || e.h.variants.includes(e.i)
                                  ? t.A(0)
                                  : b(
                                      t,
                                      (function (e) {
                                        var t, r, i, n;
                                        return D(function (a) {
                                          for (
                                            t = [], r = g([e.video, e.audio]), i = r.next();
                                            !i.done;
                                            i = r.next()
                                          )
                                            (n = i.value) &&
                                              n.segmentIndex &&
                                              n.closeSegmentIndex &&
                                              t.push(n.closeSegmentIndex());
                                          return t.length > 0 ? b(a, Promise.all(t), 0) : a.A(0);
                                        });
                                      })(e.i),
                                      3,
                                    )
                                : ((e.i = bd(e)), e.i ? b(t, Ed(e.i), 0) : t.A(0));
                            });
                          })(r),
                          8,
                        );
                      case 8:
                        if ((vd(r), !r.$)) {
                          i.A(9);
                          break;
                        }
                        return b(
                          i,
                          (function (e) {
                            var t, r, i, n, a;
                            return D(function (s) {
                              return (
                                !e.i && (t = bd(e)) && (e.i = t),
                                e.i
                                  ? ((r = e.h.presentationTimeline.W()),
                                    (i = []),
                                    (n = e.i).video && i.push(Sd(e, n.video, r)),
                                    n.audio && i.push(Sd(e, n.audio, r)),
                                    (a =
                                      un(
                                        e.h.textStreams,
                                        e.g.preferredTextLanguage,
                                        e.g.preferredTextRole,
                                        e.g.preferForcedSubs,
                                      )[0] || null) &&
                                      pn(n.audio, a, e.g) &&
                                      (i.push(Sd(e, a, r)), (e.T = a)),
                                    b(s, Promise.all(i), 0))
                                  : s.A(0)
                              );
                            });
                          })(r),
                          10,
                        );
                      case 10:
                        vd(r);
                      case 9:
                        if (!r.$ || !r.j) {
                          i.A(11);
                          break;
                        }
                        return b(
                          i,
                          (function (e) {
                            return D(function (t) {
                              return 1 == t.g
                                ? !e.K || Ca(e)
                                  ? t.A(0)
                                  : b(t, e.m, 3)
                                : b(
                                    t,
                                    Promise.all(
                                      e.X.map(function (e) {
                                        return e.promise;
                                      }),
                                    ),
                                    0,
                                  );
                            });
                          })(r.j),
                          12,
                        );
                      case 12:
                        vd(r);
                      case 11:
                        (r.B.resolve(), w(i, 0));
                        break;
                      case 3:
                        (((t = A(i)) instanceof ze && (7001 == t.code || 7003 == t.code)) || r.B.reject(t),
                          S(i));
                    }
                  });
                }),
                (n.dispatchEvent = function (e) {
                  return this.O ? this.O.dispatchEvent(e) : Fn.prototype.dispatchEvent.call(this, e);
                }),
                (n.onError = function (e) {
                  2 === e.severity && (this.B.reject(e), this.destroy());
                  var t = new Map().set("detail", e);
                  ((t = new Pn("error", t)), this.dispatchEvent(t), t.defaultPrevented && (e.handled = !0));
                }),
                (n.configure = function (e, t) {
                  ((e = ju(e, t)), id(this.g, e));
                }),
                (n.getConfiguration = function () {
                  return Wt(this.g);
                }),
                (n.rl = function () {
                  return this.B;
                }),
                (n.destroy = function () {
                  var e,
                    t,
                    r = this;
                  return D(function (i) {
                    if (1 == i.g) return ((r.l = !0), !r.m || r.oa ? i.A(2) : b(i, r.m.stop(), 2));
                    if (4 != i.g)
                      return (
                        r.u && r.u.release(),
                        r.I && !r.va && r.I.release(),
                        !r.j || r.ba ? i.A(4) : b(i, r.j.destroy(), 4)
                      );
                    if (r.M.size > 0 && !r.ya)
                      for (e = g(r.M.values()), t = e.next(); !t.done; t = e.next()) Yl(t.value);
                    S(i);
                  });
                }),
                j("shaka.media.PreloadManager", pd),
                (pd.prototype.destroy = pd.prototype.destroy),
                (pd.prototype.waitForFinish = pd.prototype.rl),
                (pd.prototype.getPrefetchedTextTrack = pd.prototype.Uj),
                (pd.prototype.getPrefetchedVariantTrack = pd.prototype.Vj),
                f(wd, Fn),
                (wd.prototype.release = function () {
                  ((this.i = null),
                    this.g.clear(),
                    this.h.release(),
                    (this.h = null),
                    Fn.prototype.release.call(this));
                }),
                (wd.prototype.j = function (e, t) {
                  if (!this.l || 0 != e) {
                    this.l = !1;
                    for (var r = g(this.i.h.values()), i = r.next(); !i.done; i = r.next()) {
                      i = i.value;
                      var n = this.g.get(i),
                        a = e < i.startTime ? Id : e > i.endTime ? Rd : kd;
                      this.g.set(i, a);
                      for (var s = g(this.m), o = s.next(); !o.done; o = s.next())
                        (o = o.value).kd == n && o.jd == a && o.Uc(i, t);
                    }
                  }
                }));
              /*
      		 @license
      		 Copyright 2013 Ali Al Dallal

      		 Licensed under the MIT license.

      		 Permission is hereby granted, free of charge, to any person obtaining a copy
      		 of this software and associated documentation files (the "Software"), to deal
      		 in the Software without restriction, including without limitation the rights
      		 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      		 copies of the Software, and to permit persons to whom the Software is
      		 furnished to do so, subject to the following conditions:

      		 The above copyright notice and this permission notice shall be included in
      		 all copies or substantial portions of the Software.

      		 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      		 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      		 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      		 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      		 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      		 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      		 SOFTWARE.
      		*/
              for (
                var Id = 1,
                  kd = 2,
                  Rd = 3,
                  Cd = {
                    ach: "Lwo",
                    ady: "",
                    af: "Afrikaans",
                    "af-NA": "Afrikaans (Namibia)",
                    "af-ZA": "Afrikaans (South Africa)",
                    ak: "Ti",
                    ar: "",
                    "ar-AR": "",
                    "ar-MA": "",
                    "ar-SA": " ()",
                    "ay-BO": "Aymar aru",
                    az: "Azrbaycan dili",
                    "az-AZ": "Azrbaycan dili",
                    "be-BY": "",
                    bg: "",
                    "bg-BG": "",
                    bn: "",
                    "bn-IN": " ()",
                    "bn-BD": "()",
                    "bs-BA": "Bosanski",
                    ca: "Catal",
                    "ca-ES": "Catal",
                    cak: "Maya Kaqchikel",
                    "ck-US": " (tsalagi)",
                    cs: "etina",
                    "cs-CZ": "etina",
                    cy: "Cymraeg",
                    "cy-GB": "Cymraeg",
                    da: "Dansk",
                    "da-DK": "Dansk",
                    de: "Deutsch",
                    "de-AT": "Deutsch (sterreich)",
                    "de-DE": "Deutsch (Deutschland)",
                    "de-CH": "Deutsch (Schweiz)",
                    dsb: "Dolnoserbina",
                    el: "",
                    "el-GR": "",
                    en: "English",
                    "en-GB": "English (UK)",
                    "en-AU": "English (Australia)",
                    "en-CA": "English (Canada)",
                    "en-IE": "English (Ireland)",
                    "en-IN": "English (India)",
                    "en-PI": "English (Pirate)",
                    "en-UD": "English (Upside Down)",
                    "en-US": "English (US)",
                    "en-ZA": "English (South Africa)",
                    "en@pirate": "English (Pirate)",
                    eo: "Esperanto",
                    "eo-EO": "Esperanto",
                    es: "Espaol",
                    "es-AR": "Espaol (Argentine)",
                    "es-419": "Espaol (Latinoamrica)",
                    "es-CL": "Espaol (Chile)",
                    "es-CO": "Espaol (Colombia)",
                    "es-EC": "Espaol (Ecuador)",
                    "es-ES": "Espaol (Espaa)",
                    "es-LA": "Espaol (Latinoamrica)",
                    "es-NI": "Espaol (Nicaragua)",
                    "es-MX": "Espaol (Mxico)",
                    "es-US": "Espaol (Estados Unidos)",
                    "es-VE": "Espaol (Venezuela)",
                    et: "eesti keel",
                    "et-EE": "Eesti (Estonia)",
                    eu: "Euskara",
                    "eu-ES": "Euskara",
                    fa: "",
                    "fa-IR": "",
                    "fb-LT": "Leet Speak",
                    ff: "Fulah",
                    fi: "Suomi",
                    "fi-FI": "Suomi",
                    "fo-FO": "Froyskt",
                    fr: "Franais",
                    "fr-CA": "Franais (Canada)",
                    "fr-FR": "Franais (France)",
                    "fr-BE": "Franais (Belgique)",
                    "fr-CH": "Franais (Suisse)",
                    "fy-NL": "Frysk",
                    ga: "Gaeilge",
                    "ga-IE": "Gaeilge (Gaelic)",
                    gl: "Galego",
                    "gl-ES": "Galego",
                    "gn-PY": "Avae'",
                    "gu-IN": "",
                    "gx-GR": " ",
                    he: "",
                    "he-IL": "",
                    hi: "",
                    "hi-IN": "",
                    hr: "Hrvatski",
                    "hr-HR": "Hrvatski",
                    hsb: "Hornjoserbina",
                    ht: "Kreyl",
                    hu: "Magyar",
                    "hu-HU": "Magyar",
                    "hy-AM": "",
                    id: "Bahasa Indonesia",
                    "id-ID": "Bahasa Indonesia",
                    is: "slenska",
                    "is-IS": "slenska (Iceland)",
                    it: "Italiano",
                    "it-IT": "Italiano",
                    ja: "",
                    "ja-JP": "",
                    "jv-ID": "Basa Jawa",
                    "ka-GE": "",
                    "kk-KZ": "",
                    km: "",
                    "km-KH": "",
                    kab: "Taqbaylit",
                    kn: "",
                    "kn-IN": " (India)",
                    ko: "",
                    "ko-KR": " ()",
                    ku: "Kurd",
                    "ku-TR": "Kurd",
                    la: "Latin",
                    "la-VA": "Latin",
                    lb: "Ltzebuergesch",
                    "li-NL": "Lmbrgs",
                    lt: "Lietuvi",
                    "lt-LT": "Lietuvi",
                    lv: "Latvieu",
                    "lv-LV": "Latvieu",
                    mai: ", ",
                    "mg-MG": "Malagasy",
                    mk: "",
                    "mk-MK": " ()",
                    ml: "",
                    "ml-IN": "",
                    "mn-MN": "",
                    mr: "",
                    "mr-IN": "",
                    ms: "Bahasa Melayu",
                    "ms-MY": "Bahasa Melayu",
                    mt: "Malti",
                    "mt-MT": "Malti",
                    my: "",
                    nb: "Norsk (bokml)",
                    "nb-NO": "Norsk (bokml)",
                    ne: "",
                    "ne-NP": "",
                    nl: "Nederlands",
                    "nl-BE": "Nederlands (Belgi)",
                    "nl-NL": "Nederlands (Nederland)",
                    "nn-NO": "Norsk (nynorsk)",
                    no: "Norsk",
                    oc: "Occitan",
                    "or-IN": "",
                    pa: "",
                    "pa-IN": " ( )",
                    pl: "Polski",
                    "pl-PL": "Polski",
                    "ps-AF": "",
                    pt: "Portugus",
                    "pt-BR": "Portugus (Brasil)",
                    "pt-PT": "Portugus (Portugal)",
                    "qu-PE": "Qhichwa",
                    "rm-CH": "Rumantsch",
                    ro: "Romn",
                    "ro-RO": "Romn",
                    ru: "",
                    "ru-RU": "",
                    "sa-IN": "",
                    "se-NO": "Davvismegiella",
                    "si-LK": "",
                    sk: "Slovenina",
                    "sk-SK": "Slovenina (Slovakia)",
                    sl: "Slovenina",
                    "sl-SI": "Slovenina",
                    "so-SO": "Soomaaliga",
                    sq: "Shqip",
                    "sq-AL": "Shqip",
                    sr: "",
                    "sr-RS": " (Serbia)",
                    su: "Basa Sunda",
                    sv: "Svenska",
                    "sv-SE": "Svenska",
                    sw: "Kiswahili",
                    "sw-KE": "Kiswahili",
                    ta: "",
                    "ta-IN": "",
                    te: "",
                    "te-IN": "",
                    tg: " ",
                    "tg-TJ": "",
                    th: "",
                    "th-TH": " ()",
                    tl: "Filipino",
                    "tl-PH": "Filipino",
                    tlh: "tlhIngan-Hol",
                    tr: "Trke",
                    "tr-TR": "Trke",
                    "tt-RU": "",
                    uk: "",
                    "uk-UA": "",
                    ur: "",
                    "ur-PK": "",
                    uz: "O'zbek",
                    "uz-UZ": "O'zbek",
                    vi: "Ting Vit",
                    "vi-VN": "Ting Vit",
                    "xh-ZA": "isiXhosa",
                    yi: "",
                    "yi-DE": " (German)",
                    zh: "",
                    "zh-HANS": "",
                    "zh-HANT": "",
                    "zh-CN": "",
                    "zh-HK": "",
                    "zh-SG": "",
                    "zh-TW": "",
                    "zu-ZA": "isiZulu",
                  },
                  Ld = g(Object.keys(Cd)),
                  Md = Ld.next();
                !Md.done;
                Md = Ld.next()
              ) {
                var Dd = Md.value;
                Cd[Dd.toLowerCase()] = Cd[Dd];
              }
              function _d(e, t) {
                if (e.lineBreak) return "\n";
                if (e.nestedCues.length)
                  return e.nestedCues
                    .map(function (t) {
                      return _d(t, e);
                    })
                    .join("");
                if (!e.payload) return e.payload;
                var r = [],
                  i = e.fontWeight >= zr,
                  n = e.fontStyle == Xr,
                  a = e.textDecoration.includes(Qr);
                return (
                  i && r.push(["b"]),
                  n && r.push(["i"]),
                  a && r.push(["u"]),
                  "" == (n = e.color) && t && (n = t.color),
                  (i = ""),
                  (n = Pd(n)) && (i += "." + n),
                  "" == (n = e.backgroundColor) && t && (n = t.backgroundColor),
                  (t = Pd(n)) && (i += ".bg_" + t),
                  i && r.push(["c", i]),
                  r.reduceRight(function (e, t) {
                    var r = g(t);
                    return (
                      "<" +
                      (t = r.next().value) +
                      (void 0 === (r = r.next().value) ? "" : r) +
                      ">" +
                      e +
                      "</" +
                      t +
                      ">"
                    );
                  }, e.payload)
                );
              }
              function Pd(e) {
                var t = (e = e.toLowerCase())
                  .replace(/\s/g, "")
                  .match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);
                switch (
                  (t
                    ? (e =
                        "#" +
                        (256 | parseInt(t[1], 10)).toString(16).slice(1) +
                        (256 | parseInt(t[2], 10)).toString(16).slice(1) +
                        (256 | parseInt(t[3], 10)).toString(16).slice(1))
                    : e.startsWith("#") && e.length > 7 && (e = e.slice(0, 7)),
                  e)
                ) {
                  case "white":
                  case "#fff":
                  case "#ffffff":
                    return "white";
                  case "lime":
                  case "#0f0":
                  case "#00ff00":
                    return "lime";
                  case "cyan":
                  case "#0ff":
                  case "#00ffff":
                    return "cyan";
                  case "red":
                  case "#f00":
                  case "#ff0000":
                    return "red";
                  case "yellow":
                  case "#ff0":
                  case "#ffff00":
                    return "yellow";
                  case "magenta":
                  case "#f0f":
                  case "#ff00ff":
                    return "magenta";
                  case "blue":
                  case "#00f":
                  case "#0000ff":
                    return "blue";
                  case "black":
                  case "#000":
                  case "#000000":
                    return "black";
                }
                return null;
              }
              function Od(e, t) {
                for (var r = [], i = (e = g(Nd(e))).next(); !i.done; i = e.next())
                  if ((i = i.value).isContainer) r.push.apply(r, m(Od(i.nestedCues, i)));
                  else {
                    var n = i.clone();
                    ((n.nestedCues = []), (n.payload = _d(i, t)), r.push(n));
                  }
                return r;
              }
              function Nd(e) {
                for (var t = [], r = (e = g(e)).next(), i = {}; !r.done; i = { mg: void 0 }, r = e.next())
                  ((i.mg = r.value),
                    t.some(
                      (function (e) {
                        return function (t) {
                          return Cr(e.mg, t);
                        };
                      })(i),
                    ) || t.push(i.mg));
                return t;
              }
              function Fd(e) {
                function t(e) {
                  for (var t = 5381, r = e.length; r; ) t = (33 * t) ^ e.charCodeAt(--r);
                  return (t >>> 0).toString();
                }
                if (e.startTime >= e.endTime) return null;
                var r = new VTTCue(e.startTime, e.endTime, e.payload);
                ((r.id = t(e.startTime.toString()) + t(e.endTime.toString()) + t(e.payload)),
                  (r.lineAlign = e.lineAlign),
                  (r.positionAlign = e.positionAlign),
                  e.size && (r.size = e.size));
                try {
                  r.align = e.textAlign;
                } catch (i) {}
                return (
                  "center" == e.textAlign && "center" != r.align && (r.align = "middle"),
                  "vertical-lr" == e.writingMode
                    ? (r.vertical = "lr")
                    : "vertical-rl" == e.writingMode && (r.vertical = "rl"),
                  1 == e.lineInterpretation && (r.snapToLines = !1),
                  null != e.line && (r.line = e.line),
                  null != e.position && (r.position = e.position),
                  r
                );
              }
              function Ud(e, t) {
                var r = Od(t),
                  i = [];
                t = e.cues ? Array.from(e.cues) : [];
                for (var n = (r = g(r)).next(), a = {}; !n.done; a = { vd: void 0 }, n = r.next())
                  ((a.vd = n.value),
                    !t.some(
                      (function (e) {
                        return function (t) {
                          return (
                            t.startTime == e.vd.startTime &&
                            t.endTime == e.vd.endTime &&
                            t.text == e.vd.payload
                          );
                        };
                      })(a),
                    ) &&
                      a.vd.payload &&
                      (n = Fd(a.vd)) &&
                      i.push(n));
                for (
                  r = (t = g(
                    (t = i.slice().sort(function (e, t) {
                      return e.startTime != t.startTime
                        ? e.startTime - t.startTime
                        : e.endTime != t.endTime
                          ? e.endTime - t.startTime
                          : ("line" in VTTCue.prototype)
                            ? i.indexOf(t) - i.indexOf(e)
                            : i.indexOf(e) - i.indexOf(t);
                    })),
                  )).next();
                  !r.done;
                  r = t.next()
                )
                  e.addCue(r.value);
              }
              function Bd(e, t) {
                var r = !1;
                "disabled" === e.mode && ((r = !0), (e.mode = "hidden"));
                for (var i = 0; i < e.cues.length; ) {
                  var n = e.cues[i];
                  t(n) ? e.removeCue(n) : i++;
                }
                r && (e.mode = "disabled");
              }
              function $d(e) {
                var t = this;
                ((this.i = e),
                  (this.l = new re()),
                  (this.j = null),
                  (this.h = new Map()),
                  (this.g = -1),
                  (this.u = !1),
                  (this.o = null),
                  (this.C = function () {
                    (t.l.Ma(t.i, "textchanged", t.m), t.l.Ma(t.j.textTracks, "change", t.B));
                    for (var e = g(t.h.values()), r = e.next(); !r.done; r = e.next()) r.value.remove();
                    (t.h.clear(), (t.g = -1), (t.j = null));
                  }),
                  (this.m = function () {
                    for (var e = new Map(), r = t.i.Lc(), i = (r = g(r)).next(); !i.done; i = r.next()) {
                      if (((i = i.value), t.h.has(i.id))) {
                        var n = t.h.get(i.id);
                        (i.active || "disabled" === n.track.mode || (n.track.mode = "disabled"),
                          t.h.delete(i.id));
                      } else {
                        (n = t.j.ownerDocument.createElement("track")).kind = jd(i);
                        var a = n,
                          s = void 0;
                        if (i.label) s = i.label;
                        else if (i.language)
                          if (i.language in Cd) s = Cd[i.language];
                          else {
                            var o = Bi(i.language);
                            o in Cd && (s = Cd[o] + " (" + i.language + ")");
                          }
                        (s ||
                          ((s = i.originalTextId),
                          i.language && i.language !== i.originalTextId && (s += " (" + i.language + ")")),
                          (a.label = s),
                          i.language in Cd && (n.srclang = i.language),
                          (n.src = "data:,WEBVTT"),
                          (n.track.mode = "disabled"),
                          t.j.appendChild(n));
                      }
                      (e.set(i.id, n), i.active && (t.g = i.id));
                    }
                    for (i = (r = g(t.h.values())).next(); !i.done; i = r.next()) i.value.remove();
                    (t.g > -1 &&
                      (e.has(t.g)
                        ? "disabled" === (r = e.get(t.g).track).mode && (r.mode = t.u ? "showing" : "hidden")
                        : (t.g = -1)),
                      (t.h = e));
                  }),
                  (this.B = function () {
                    if (!t.o) {
                      var e = t.j;
                      t.o = new Ri(function () {
                        if (((t.o = null), t.j === e)) {
                          var r = -1,
                            i = !1;
                          if (t.h.has(t.g)) {
                            var n = t.h.get(t.g);
                            "showing" === n.track.mode
                              ? ((r = t.g), (i = !0))
                              : "hidden" === n.track.mode && (r = t.g);
                          }
                          if (!i)
                            for (n = (i = g(t.h)).next(); !n.done; n = i.next()) {
                              var a = g(n.value);
                              if (((n = a.next().value), "showing" === (a = a.next().value).track.mode)) {
                                r = n;
                                break;
                              }
                              r < 0 && "hidden" === a.track.mode && (r = n);
                            }
                          for (n = (i = g(t.h)).next(); !n.done; n = i.next())
                            ((n = (a = g(n.value)).next().value),
                              (a = a.next().value),
                              n !== r && "disabled" !== a.track.mode && (a.track.mode = "disabled"));
                          (t.g !== r && ((t.g = r), r > -1 && t.i.ph({ id: r })),
                            t.i.wh(r > -1 && "showing" === t.h.get(r).track.mode));
                        }
                      }).ka(0);
                    }
                  }),
                  this.l.D(e, "loaded", function () {
                    return t.enableTextDisplayer();
                  }),
                  this.enableTextDisplayer());
              }
              function jd(e) {
                var t = se();
                return e.forced && "WEBKIT" === t.Ha()
                  ? "forced"
                  : "caption" === e.kind ||
                      (e.roles &&
                        e.roles.some(function (e) {
                          return e.includes("transcribes-spoken-dialog");
                        }) &&
                        e.roles.some(function (e) {
                          return e.includes("describes-music-and-sound");
                        }))
                    ? "captions"
                    : "subtitles";
              }
              function Gd(e, t) {
                for (
                  he("SimpleTextDisplayer", "Please migrate to NativeTextDisplayer"),
                    this.h = e,
                    this.i = t,
                    this.g = null,
                    t = (e = g(Array.from(this.h.textTracks))).next();
                  !t.done;
                  t = e.next()
                )
                  "metadata" !== (t = t.value).kind &&
                    "chapters" !== t.kind &&
                    ((t.mode = "disabled"), t.label == this.i && (this.g = t));
                this.g && (this.g.mode = "hidden");
              }
              function Vd(e) {
                e.h && !e.g && ((e.g = e.h.addTextTrack("subtitles", e.i)), (e.g.mode = "hidden"));
              }
              function Hd() {}
              function Kd(t, r) {
                var i = this;
                ((this.m = !1),
                  (this.h = []),
                  (this.j = t),
                  (this.o = r),
                  (this.C = this.u = null),
                  (this.g = document.createElement("div")),
                  this.g.classList.add("shaka-text-container"),
                  (this.g.style.textAlign = "center"),
                  (this.g.style.display = "flex"),
                  (this.g.style.flexDirection = "column"),
                  (this.g.style.alignItems = "center"),
                  (this.g.style.justifyContent = "flex-end"),
                  (this.B = new Ri(function () {
                    i.j.paused || Xd(i);
                  })),
                  Wd(this),
                  (this.l = new Map()),
                  (this.i = new re()),
                  this.i.D(document, "fullscreenchange", function () {
                    Xd(i, !0);
                  }),
                  this.i.D(this.j, "seeking", function () {
                    Xd(i, !0);
                  }),
                  this.i.D(this.j, "ratechange", function () {
                    Wd(i);
                  }),
                  this.i.D(this.j, "resize", function () {
                    var e = i.j,
                      t = e.videoWidth;
                    ((e = e.videoHeight), (i.u = t && e ? t / e : null));
                  }),
                  (this.F = null),
                  "ResizeObserver" in e &&
                    ((this.F = new ResizeObserver(function () {
                      Xd(i, !0);
                    })),
                    this.F.observe(this.g)),
                  (this.G = new Map()));
              }
              function Wd(e) {
                e.B &&
                  (e.h.length
                    ? e.B.Ea(
                        (e.C ? e.C.captionsUpdatePeriod : 0.25) / Math.max(1, Math.abs(e.j.playbackRate)),
                      )
                    : e.B.stop());
              }
              function zd(e, t) {
                for (; null != t; ) {
                  if (t == e.g) return !0;
                  t = t.parentElement;
                }
                return !1;
              }
              function qd(e, t, r, i, n) {
                for (var a = !1, s = [], o = [], l = (t = g(t)).next(); !l.done; l = t.next()) {
                  ((l = l.value), n.push(l));
                  var u = e.l.get(l),
                    d = l.startTime <= i && l.endTime > i,
                    h = u ? u.nj : null;
                  (u && (s.push(u.og), u.$c && s.push(u.$c), d || ((a = !0), e.l.delete(l), (u = null))),
                    d &&
                      (o.push(l),
                      u ? zd(e, h) || (a = !0) : (Yd(e, l, n), (h = (u = e.l.get(l)).nj), (a = !0))),
                    l.nestedCues.length > 0 && h && qd(e, l.nestedCues, h, i, n),
                    n.pop());
                }
                if (a) {
                  for (n = (i = g(s)).next(); !n.done; n = i.next())
                    (n = n.value).parentElement && n.parentElement.removeChild(n);
                  for (
                    o.sort(function (e, t) {
                      return e.startTime != t.startTime ? e.startTime - t.startTime : e.endTime - t.endTime;
                    }),
                      i = (o = g(o)).next();
                    !i.done;
                    i = o.next()
                  )
                    (i = e.l.get(i.value)).$c
                      ? (i.$c.contains(r) && i.$c.removeChild(r), r.appendChild(i.$c), i.$c.appendChild(i.og))
                      : r.appendChild(i.og);
                }
              }
              function Xd(e, t) {
                if (e.g) {
                  var r = e.j.currentTime;
                  if (!e.m || (void 0 !== t && t)) {
                    for (var i = (t = g(e.G.values())).next(); !i.done; i = t.next()) Zs(i.value);
                    (Zs(e.g), e.l.clear(), e.G.clear());
                  }
                  e.m && qd(e, e.h, e.g, r, []);
                }
              }
              function Yd(e, t, r) {
                var i = r.length > 1,
                  n = i ? "span" : "div";
                (t.lineBreak && (n = "br"),
                  t.rubyTag && (n = t.rubyTag),
                  (i = !i && t.nestedCues.length > 0));
                var a = document.createElement(n);
                if (
                  ("br" != n &&
                    (function (e, t, r, i, n) {
                      var a = t.style,
                        s = 0 == r.nestedCues.length,
                        o = i.length > 1;
                      a.whiteSpace = "pre-wrap";
                      var l = r.payload.replace(/\s+$/g, function (e) {
                        return "".repeat(e.length);
                      });
                      if (
                        ((a.webkitTextStrokeColor = r.textStrokeColor),
                        (a.webkitTextStrokeWidth = r.textStrokeWidth),
                        (a.color = r.color),
                        (a.direction = r.direction),
                        (a.opacity = r.opacity),
                        (a.paddingLeft = Qd(r.linePadding, r, e.o)),
                        (a.paddingRight = Qd(r.linePadding, r, e.o)),
                        (a.textCombineUpright = r.textCombineUpright),
                        (a.textShadow = r.textShadow),
                        r.backgroundImage)
                      )
                        ((a.backgroundImage = "url('" + r.backgroundImage + "')"),
                          (a.backgroundRepeat = "no-repeat"),
                          (a.backgroundSize = "contain"),
                          (a.backgroundPosition = "center"),
                          r.backgroundColor && (a.backgroundColor = r.backgroundColor),
                          (a.width = "100%"),
                          (a.height = "100%"));
                      else {
                        if (r.nestedCues.length) var u = t;
                        else ((u = document.createElement("span")), t.appendChild(u));
                        (r.border && (u.style.border = r.border),
                          n ||
                            ((t = (function (e, t) {
                              for (var r = e.length - 1; r >= 0; r--) {
                                var i = t(e[r]);
                                if (i || 0 === i) return i;
                              }
                              return null;
                            })(i, function (e) {
                              return e.backgroundColor;
                            }))
                              ? (u.style.backgroundColor = t)
                              : l && (u.style.backgroundColor = "rgba(0, 0, 0, 0.8)")),
                          l && (u.setAttribute("translate", "no"), (u.textContent = l)));
                      }
                      (o && !i[i.length - 1].isContainer
                        ? (a.display = "inline")
                        : ((a.display = "flex"),
                          (a.flexDirection = "column"),
                          (a.alignItems = "center"),
                          "left" == r.textAlign || "start" == r.textAlign
                            ? ((a.width = "100%"), (a.alignItems = "start"))
                            : ("right" != r.textAlign && "end" != r.textAlign) ||
                              ((a.width = "100%"), (a.alignItems = "end")),
                          (a.justifyContent =
                            "before" == r.displayAlign
                              ? "flex-start"
                              : "center" == r.displayAlign
                                ? "center"
                                : "flex-end")),
                        s || (a.margin = "0"),
                        (a.fontFamily = r.fontFamily),
                        (a.fontWeight = r.fontWeight.toString()),
                        (a.fontStyle = r.fontStyle),
                        (a.letterSpacing = r.letterSpacing),
                        (1 !== (i = e.C ? e.C.fontScaleFactor : 1) || r.fontSize) &&
                          (a.fontSize = Qd(r.fontSize || "1em", r, e.o, i)),
                        null != (i = r.line) &&
                          ((s = r.lineInterpretation) == jr &&
                            ((s = 1),
                            (o = 16),
                            e.u && e.u < 1 && (o = 32),
                            (i = i < 0 ? 100 + (i / o) * 100 : (i / o) * 100)),
                          1 == s &&
                            ((a.position = "absolute"),
                            r.writingMode == $r
                              ? ((a.width = "100%"),
                                r.lineAlign == Gr
                                  ? (a.top = i + "%")
                                  : "end" == r.lineAlign && (a.bottom = 100 - i + "%"))
                              : "vertical-lr" == r.writingMode
                                ? ((a.height = "100%"),
                                  r.lineAlign == Gr
                                    ? (a.left = i + "%")
                                    : "end" == r.lineAlign && (a.right = 100 - i + "%"))
                                : ((a.height = "100%"),
                                  r.lineAlign == Gr
                                    ? (a.right = i + "%")
                                    : "end" == r.lineAlign && (a.left = 100 - i + "%")))),
                        (a.lineHeight = r.lineHeight),
                        (e = (function (e) {
                          var t = e.direction,
                            r = e.positionAlign;
                          return (
                            (e = e.textAlign),
                            r !== Pr
                              ? r
                              : "left" === e || ("start" === e && t === Br) || ("end" === e && "rtl" === t)
                                ? "line-left"
                                : "right" === e || ("start" === e && "rtl" === t) || ("end" === e && t === Br)
                                  ? "line-right"
                                  : "center"
                          );
                        })(r)),
                        "line-left" == e
                          ? ((a.cssFloat = "left"),
                            null !== r.position &&
                              ((a.position = "absolute"),
                              r.writingMode == $r
                                ? ((a.left = r.position + "%"), (a.width = "auto"))
                                : (a.top = r.position + "%")))
                          : "line-right" == e
                            ? ((a.cssFloat = "right"),
                              null !== r.position &&
                                ((a.position = "absolute"),
                                r.writingMode == $r
                                  ? ((a.right = 100 - r.position + "%"), (a.width = "auto"))
                                  : (a.bottom = r.position + "%")))
                            : null !== r.position &&
                              50 != r.position &&
                              ((a.position = "absolute"),
                              r.writingMode == $r
                                ? ((a.left = r.position + "%"), (a.width = "auto"))
                                : (a.top = r.position + "%"),
                              r.size && (a.transform = "translateX(-50%)")),
                        (a.textAlign = r.textAlign),
                        (a.textDecoration = r.textDecoration.join(" ")),
                        (a.writingMode = r.writingMode),
                        ("writingMode" in document.documentElement.style && a.writingMode == r.writingMode) ||
                          (a.webkitWritingMode = r.writingMode),
                        r.size &&
                          (r.writingMode == $r ? (a.width = r.size + "%") : (a.height = r.size + "%")));
                    })(e, a, t, r, i),
                  (r = null),
                  t.region && t.region.id)
                ) {
                  var s = t.region,
                    o = e.u === 4 / 3 ? 2.5 : 1.9;
                  if (
                    ((r =
                      s.id +
                      "_" +
                      s.width +
                      "x" +
                      s.height +
                      (s.heightUnits == Nt ? "%" : "px") +
                      "-" +
                      s.viewportAnchorX +
                      "x" +
                      s.viewportAnchorY +
                      (s.viewportAnchorUnits == Nt ? "%" : "px")),
                    e.G.has(r))
                  )
                    r = e.G.get(r);
                  else {
                    n = document.createElement("span");
                    var l = s.heightUnits == Nt ? "%" : "px",
                      u = s.widthUnits == Nt ? "%" : "px",
                      d = s.viewportAnchorUnits == Nt ? "%" : "px";
                    ((n.id = "shaka-text-region---" + r),
                      n.classList.add("shaka-text-region"),
                      (n.style.position = "absolute"));
                    var h = s.height,
                      c = s.width;
                    (2 === s.heightUnits && ((h = 5.33 * s.height), (l = "%")),
                      2 === s.widthUnits && ((c = s.width * o), (u = "%")),
                      (n.style.height = h + l),
                      (n.style.width = c + u),
                      2 === s.viewportAnchorUnits
                        ? ((o = (s.viewportAnchorY / 75) * 100),
                          (l = (s.viewportAnchorX / (e.u === 4 / 3 ? 160 : 210)) * 100),
                          (o -= (s.regionAnchorY * h) / 100),
                          (l -= (s.regionAnchorX * c) / 100),
                          (n.style.top = o + "%"),
                          (n.style.left = l + "%"))
                        : ((n.style.top = s.viewportAnchorY - (s.regionAnchorY * h) / 100 + d),
                          (n.style.left = s.viewportAnchorX - (s.regionAnchorX * c) / 100 + d)),
                      0 !== s.heightUnits &&
                        0 !== s.widthUnits &&
                        0 !== s.viewportAnchorUnits &&
                        ((s = Math.max(
                          0,
                          Math.min(
                            100 - (parseInt(n.style.width.slice(0, -1), 10) || 0),
                            parseInt(n.style.left.slice(0, -1), 10) || 0,
                          ),
                        )),
                        (n.style.top =
                          Math.max(
                            0,
                            Math.min(
                              100 - (parseInt(n.style.height.slice(0, -1), 10) || 0),
                              parseInt(n.style.top.slice(0, -1), 10) || 0,
                            ),
                          ) + "%"),
                        (n.style.left = s + "%")),
                      (n.style.display = "flex"),
                      (n.style.flexDirection = "column"),
                      (n.style.alignItems = "center"),
                      (n.style.justifyContent =
                        "before" == t.displayAlign
                          ? "flex-start"
                          : "center" == t.displayAlign
                            ? "center"
                            : "flex-end"),
                      e.G.set(r, n),
                      (r = n));
                  }
                }
                ((n = a),
                  i &&
                    ((n = document.createElement("span")).classList.add("shaka-text-wrapper"),
                    (n.style.backgroundColor = t.backgroundColor),
                    (n.style.lineHeight = "normal"),
                    a.appendChild(n)),
                  e.l.set(t, { og: a, nj: n, $c: r }));
              }
              function Qd(e, t, r, i) {
                i = void 0 === i ? 1 : i;
                var n = (n = new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))
                  ? { value: Number(n[1]), unit: n[2] }
                  : null;
                if (!n) return e;
                switch (((e = n.unit), (i *= n.value), e)) {
                  case "%":
                    return ((i / 100) * r.clientHeight) / t.cellResolution.rows + "px";
                  case "c":
                    return (r.clientHeight * i) / t.cellResolution.rows + "px";
                  default:
                    return i + e;
                }
              }
              function Jd(e, t) {
                ((this.g = t),
                  (this.j = e),
                  (this.m = new Map()),
                  (this.l = void 0),
                  (this.F = !1),
                  (this.J = !0),
                  (this.u = this.I = !1),
                  (this.C = this.B = void 0),
                  (this.H = 0),
                  (this.K = { request: !1, response: !1, event: !1 }),
                  (this.o = {}),
                  (this.i = new re()),
                  (this.G = []),
                  (this.h = null));
              }
              function Zd(e) {
                if (e.G) for (var t = g(e.G), r = t.next(); !r.done; r = t.next()) r.value.stop();
                e.G = [];
              }
              function eh(e) {
                return (e = e.g.targets)
                  ? e.filter(function (e) {
                      return e.mode === jh && e.enabled;
                    })
                  : [];
              }
              function th(e) {
                return (e = e.g.targets)
                  ? e.filter(function (e) {
                      return e.mode === $h && !0 === e.enabled;
                    })
                  : [];
              }
              function rh(t) {
                return (
                  t.g.sessionId || (t.g.sessionId = e.crypto.randomUUID()),
                  {
                    v: t.g.version,
                    sf: t.l,
                    sid: t.g.sessionId,
                    cid: t.g.contentId,
                    mtp: t.j.getBandwidthEstimate() / 1e3,
                  }
                );
              }
              function ih(e, t, r) {
                if (
                  ((r = void 0 === r ? {} : r),
                  (t = hh(e, (t = Object.assign({ e: t, ts: Date.now() }, r)), jh)),
                  (r = e.g.targets),
                  !(e.g.version < Eh) && r)
                ) {
                  var i = eh(e);
                  r = Array.from(new Set([].concat(m(Lh), m(_h))));
                  for (var n = (i = g(i)).next(); !n.done; n = i.next()) {
                    var a = sh((n = n.value).includeKeys || [], r);
                    (a.includes(Fh) || a.push(Fh), (a = oh(t, a)));
                    var s = n.events || [],
                      o = a.e,
                      l = a.sta;
                    (o &&
                      (!Ph.includes(o) ||
                        !("ps" !== o || (l && Oh.includes(l))) ||
                        (s && s.length > 0 && !s.includes(o)))) ||
                      ah(e, a, n);
                  }
                }
              }
              function nh(e, t, r) {
                if (e.g.enabled) {
                  r = hh(e, r, Bh);
                  var i = lh({ mode: Bh, useHeaders: e.g.useHeaders, includeKeys: e.g.includeKeys || [] });
                  (e.o[i] || (e.o[i] = { request: 1, response: 1 }),
                    (r.sn = e.o[i].request++),
                    (function (e, t, r, i) {
                      if (i) {
                        if (((t = fh(t)), !Object.keys(t).length)) return;
                        Object.assign(r.headers, t);
                      } else {
                        var n = ch(t);
                        if (!n) return;
                        r.uris = r.uris.map(function (e) {
                          return ph(e, n);
                        });
                      }
                      th(e).length > 0 || !e.m.has(r) || e.m.delete(r);
                    })(
                      e,
                      (r = oh(
                        r,
                        (i = sh(
                          (i = e.g.includeKeys || []),
                          e.g.version == Eh ? Array.from(new Set([].concat(m(Lh), m(Mh)))) : Ch,
                        )),
                      )),
                      t,
                      e.g.useHeaders,
                    ));
                }
              }
              function ah(e, t, r, i) {
                var n = {
                    maxAttempts: 2,
                    baseDelay: 1e3,
                    backoffFactor: 2,
                    fuzzFactor: 0.5,
                    timeout: 3e4,
                    stallTimeout: 5e3,
                    connectionTimeout: 1e4,
                  },
                  a = r.url;
                if (r.useHeaders) {
                  if (((t = fh(t)), !Object.keys(t).length)) return;
                  (i && Object.assign(i.headers, t), (i = Vn([a], n)), Object.assign(i.headers, t));
                } else {
                  if (!(t = ch(t))) return;
                  ((a = ph(a, t)), i && (i.uri = a), (i = Vn([a], n)));
                }
                e.j.Yb().request(9, i);
              }
              function sh(e, t) {
                if (!e || 0 === e.length) return t;
                for (var r = g(e), i = r.next(); !i.done; i = r.next()) t.includes(i.value);
                return e.filter(function (e) {
                  return t.includes(e);
                });
              }
              function oh(e, t) {
                return Object.keys(e).reduce(function (r, i) {
                  return (t.includes(i) && (r[i] = e[i]), r);
                }, {});
              }
              function lh(e) {
                var t = Object.keys(e)
                  .sort()
                  .reduce(function (t, r) {
                    return ("enabled" !== r && (t[r] = e[r]), t);
                  }, {});
                return JSON.stringify(t);
              }
              function uh(e, t) {
                if (!(t = e.j.Gc()[t]).length) return 0;
                var r = e.h ? e.h.currentTime : 0;
                return (e = t.find(function (e) {
                  return e.start <= r && e.end >= r;
                }))
                  ? 1e3 * (e.end - r)
                  : 0;
              }
              function dh(e, t, r) {
                var i = t.segment,
                  n = 0;
                (i && (n = i.endTime - i.startTime),
                  ((n = { d: 1e3 * n, st: e.j.W() ? wh : xh }).ot = (function (e) {
                    if (0 === e.type) return Th;
                    if ((e = e.stream)) {
                      var t = e.type;
                      if ("video" == t) return e.codecs && e.codecs.includes(",") ? yh : vh;
                      if ("audio" == t) return mh;
                      if ("text" == t) return "application/mp4" === e.mimeType ? Sh : bh;
                    }
                  })(t)));
                var a = n.ot === vh || n.ot === mh || n.ot === yh || n.ot === Sh;
                if ((t = t.stream)) {
                  var s = e.j.Ob();
                  if (
                    a &&
                    ((n.bl = (function (e, t) {
                      if (!(t = e.j.Gc()[t]).length) return NaN;
                      var r = e.h ? e.h.currentTime : 0;
                      return (e = t.find(function (e) {
                        return e.start <= r && e.end >= r;
                      }))
                        ? 1e3 * (e.end - r)
                        : NaN;
                    })(e, t.type)),
                    n.ot !== Sh)
                  ) {
                    var o = uh(e, t.type);
                    n.dl = s ? o / Math.abs(s) : o;
                  }
                  if ((t.bandwidth && (n.br = t.bandwidth / 1e3), t.segmentIndex && i)) {
                    if ((s = t.segmentIndex.Xb(i.endTime, !0, s < 0)) && (s = s.next().value) && s != i) {
                      if (r && !ee(i.P(), s.P())) {
                        var l = s.P()[0];
                        o = new URL(l);
                        var u = new URL(r);
                        if (o.origin !== u.origin) r = l;
                        else {
                          ((r = o.pathname.split("/").slice(1)),
                            (l = u.pathname.split("/").slice(1, -1)),
                            (u = Math.min(r.length, l.length)));
                          for (var d = 0; d < u && r[d] === l[d]; d++) (r.shift(), l.shift());
                          for (; l.length; ) (l.shift(), r.unshift(".."));
                          r = r.join("/") + o.search + o.hash;
                        }
                        n.nor = r;
                      }
                      (!s.startByte && !s.endByte) ||
                        (i.startByte == s.startByte && i.endByte == s.endByte) ||
                        ((r = s.startByte + "-"), s.endByte && (r += s.endByte), (n.nrr = r));
                    }
                    ((s = e.j.Ob() || 1),
                      (r = uh(e, t.type) || 500),
                      (i = (t = t.bandwidth)
                        ? ((t * (i.endTime - i.startTime)) / 1e3 / (r / s / 1e3)) * e.g.rtpSafetyFactor
                        : NaN),
                      isNaN(i) || (n.rtp = i));
                  }
                }
                return (
                  a &&
                    n.ot !== Sh &&
                    (n.tb =
                      (function (e, t) {
                        var r = e.j.qc();
                        if (!r.length) return NaN;
                        e = r[0];
                        for (var i = (r = g(r)).next(); !i.done; i = r.next())
                          "variant" === (i = i.value).type && i.bandwidth > e.bandwidth && (e = i);
                        switch (t) {
                          case vh:
                            return e.videoBandwidth || NaN;
                          case mh:
                            return e.audioBandwidth || NaN;
                          default:
                            return e.bandwidth;
                        }
                      })(e, n.ot) / 1e3),
                  n
                );
              }
              function hh(e, t, r) {
                (Object.assign(t, rh(e)), (t.pr = e.j.Ob()));
                var i = t.ot === vh || t.ot === yh;
                return (
                  e.I && i && ((t.bs = !0), (t.su = !0), (e.I = !1)),
                  null == t.su && (t.su = e.J),
                  e.j.W() && ((i = Ec(e.j)), (t.ltc = i || void 0)),
                  document.hidden && (t.bg = !0),
                  null == (i = e.C && e.B ? e.C - (e.H || e.B) : void 0) ||
                    e.K[r] ||
                    ((t.msd = i), (e.K[r] = !0)),
                  t
                );
              }
              function ch(e) {
                function t(e) {
                  return 100 * r(e / 100);
                }
                function r(e) {
                  return Math.round(e);
                }
                function i(e) {
                  return !Number.isNaN(e) && null != e && "" !== e && !1 !== e;
                }
                for (
                  var n = [],
                    a = {
                      br: r,
                      d: r,
                      bl: t,
                      dl: t,
                      mtp: t,
                      nor: function (e) {
                        return encodeURIComponent(e);
                      },
                      rtp: t,
                      tb: r,
                      ttfb: r,
                      ttlb: r,
                    },
                    s = Object.keys(e || {}).sort(),
                    o = (s = g(s)).next();
                  !o.done;
                  o = s.next()
                ) {
                  var l = e[(o = o.value)];
                  if (i(l) && ("v" !== o || 1 !== l) && ("pr" != o || 1 !== l)) {
                    var u,
                      d = a[o];
                    (d && (l = d(l)),
                      (u =
                        "string" == (d = typeof l) && "ot" !== o && "sf" !== o && "st" !== o
                          ? o + "=" + JSON.stringify(l)
                          : "boolean" === d
                            ? o
                            : "symbol" === d
                              ? o + "=" + l.description
                              : o + "=" + l),
                      n.push(u));
                  }
                }
                return n.join(",");
              }
              function fh(e) {
                for (
                  var t = Object.keys(e),
                    r = {},
                    i = ["Object", "Request", "Session", "Status"],
                    n = [{}, {}, {}, {}],
                    a = {
                      br: 0,
                      d: 0,
                      ot: 0,
                      tb: 0,
                      url: 0,
                      bl: 1,
                      dl: 1,
                      mtp: 1,
                      nor: 1,
                      nrr: 1,
                      su: 1,
                      ltc: 1,
                      ttfb: 1,
                      ttlb: 1,
                      ts: 1,
                      rc: 1,
                      cmsdd: 1,
                      cmsds: 1,
                      sn: 1,
                      cid: 2,
                      pr: 2,
                      sf: 2,
                      sid: 2,
                      st: 2,
                      v: 2,
                      msd: 2,
                      bs: 3,
                      rtp: 3,
                      bg: 3,
                    },
                    s = (t = g(t)).next();
                  !s.done;
                  s = t.next()
                )
                  n[null != a[(s = s.value)] ? a[s] : 1][s] = e[s];
                for (e = 0; e < n.length; e++) (a = ch(n[e])) && (r["CMCD-" + i[e]] = a);
                return r;
              }
              function ph(e, t) {
                return !t || e.includes("offline:") ? e : ((e = new me(e)).g.set("CMCD", t), e.toString());
              }
              (((n = $d.prototype).configure = function () {}),
                (n.remove = function (e, t) {
                  return (
                    !!this.i &&
                    (this.h.has(this.g) &&
                      Bd(this.h.get(this.g).track, function (r) {
                        return r.startTime < t && r.endTime > e;
                      }),
                    !0)
                  );
                }),
                (n.append = function (e) {
                  this.h.has(this.g) && Ud(this.h.get(this.g).track, e);
                }),
                (n.destroy = function () {
                  return (
                    this.i && (this.j && this.C(), (this.i = null)),
                    this.l && (this.l.release(), (this.l = null)),
                    Promise.resolve()
                  );
                }),
                (n.isTextVisible = function () {
                  return this.u;
                }),
                (n.setTextVisibility = function (e) {
                  if (((this.u = e), this.h.has(this.g))) {
                    var t = this.h.get(this.g).track;
                    "disabled" !== t.mode && ((e = e ? "showing" : "hidden"), t.mode !== e && (t.mode = e));
                  } else if (this.i && 3 === this.i.$d())
                    if (
                      ((t = Array.from(this.i.bf().textTracks).filter(function (e) {
                        return ["captions", "subtitles", "forced"].includes(e.kind);
                      })),
                      e)
                    ) {
                      e = null;
                      for (var r = (t = g(t)).next(); !r.done; r = t.next()) {
                        if ("showing" === (r = r.value).mode) {
                          e = null;
                          break;
                        }
                        e || "hidden" !== r.mode || (e = r);
                      }
                      e && (e.mode = "showing");
                    } else
                      for (t = (e = g(t)).next(); !t.done; t = e.next())
                        "showing" === (t = t.value).mode && (t.mode = "hidden");
                }),
                (n.setTextLanguage = function () {}),
                (n.enableTextDisplayer = function () {
                  !this.j &&
                    this.i &&
                    2 === this.i.$d() &&
                    ((this.j = this.i.bf()),
                    this.l.Aa(this.i, "unloading", this.C),
                    this.l.D(this.i, "textchanged", this.m),
                    this.l.D(this.j.textTracks, "change", this.B),
                    this.m());
                }),
                j("shaka.text.NativeTextDisplayer", $d),
                ($d.prototype.enableTextDisplayer = $d.prototype.enableTextDisplayer),
                ($d.prototype.setTextLanguage = $d.prototype.setTextLanguage),
                ($d.prototype.setTextVisibility = $d.prototype.setTextVisibility),
                ($d.prototype.isTextVisible = $d.prototype.isTextVisible),
                ($d.prototype.destroy = $d.prototype.destroy),
                ($d.prototype.append = $d.prototype.append),
                ($d.prototype.remove = $d.prototype.remove),
                ($d.prototype.configure = $d.prototype.configure),
                ((n = Gd.prototype).configure = function () {}),
                (n.remove = function (e, t) {
                  return (
                    !!this.g &&
                    (Bd(this.g, function (r) {
                      return r.startTime < t && r.endTime > e;
                    }),
                    !0)
                  );
                }),
                (n.append = function (e) {
                  this.g && Ud(this.g, e);
                }),
                (n.destroy = function () {
                  return (
                    this.g &&
                      (Bd(this.g, function () {
                        return !0;
                      }),
                      (this.g.mode = "disabled")),
                    (this.g = this.h = null),
                    Promise.resolve()
                  );
                }),
                (n.isTextVisible = function () {
                  return !!this.g && "showing" == this.g.mode;
                }),
                (n.setTextVisibility = function (e) {
                  (e && !this.g && Vd(this), this.g && (this.g.mode = e ? "showing" : "hidden"));
                }),
                (n.setTextLanguage = function () {}),
                (n.enableTextDisplayer = function () {
                  Vd(this);
                }),
                j("shaka.text.SimpleTextDisplayer", Gd),
                (Gd.prototype.enableTextDisplayer = Gd.prototype.enableTextDisplayer),
                (Gd.prototype.setTextLanguage = Gd.prototype.setTextLanguage),
                (Gd.prototype.setTextVisibility = Gd.prototype.setTextVisibility),
                (Gd.prototype.isTextVisible = Gd.prototype.isTextVisible),
                (Gd.prototype.destroy = Gd.prototype.destroy),
                (Gd.prototype.append = Gd.prototype.append),
                (Gd.prototype.remove = Gd.prototype.remove),
                (Gd.prototype.configure = Gd.prototype.configure),
                ((n = Hd.prototype).configure = function () {}),
                (n.remove = function () {}),
                (n.append = function () {}),
                (n.destroy = function () {}),
                (n.isTextVisible = function () {
                  return !1;
                }),
                (n.setTextVisibility = function () {}),
                (n.setTextLanguage = function () {}),
                (n.enableTextDisplayer = function () {}),
                j("shaka.text.StubTextDisplayer", Hd),
                (Hd.prototype.enableTextDisplayer = Hd.prototype.enableTextDisplayer),
                (Hd.prototype.setTextLanguage = Hd.prototype.setTextLanguage),
                (Hd.prototype.setTextVisibility = Hd.prototype.setTextVisibility),
                (Hd.prototype.isTextVisible = Hd.prototype.isTextVisible),
                (Hd.prototype.destroy = Hd.prototype.destroy),
                (Hd.prototype.append = Hd.prototype.append),
                (Hd.prototype.remove = Hd.prototype.remove),
                (Hd.prototype.configure = Hd.prototype.configure),
                ((n = Kd.prototype).configure = function (e) {
                  ((this.C = e), Wd(this), Xd(this, !0));
                }),
                (n.append = function (e) {
                  for (
                    var t = [].concat(m(this.h)), r = (e = g(Nd(e))).next(), i = {};
                    !r.done;
                    i = { ng: void 0 }, r = e.next()
                  )
                    ((i.ng = r.value),
                      t.some(
                        (function (e) {
                          return function (t) {
                            return Cr(t, e.ng);
                          };
                        })(i),
                      ) || this.h.push(i.ng));
                  (this.h.length && Wd(this), Xd(this));
                }),
                (n.destroy = function () {
                  return this.g
                    ? (this.g.parentElement && this.o.removeChild(this.g),
                      (this.g = null),
                      (this.m = !1),
                      (this.h = []),
                      this.B && (this.B.stop(), (this.B = null)),
                      this.l.clear(),
                      this.i && (this.i.release(), (this.i = null)),
                      this.F && (this.F.disconnect(), (this.F = null)),
                      Promise.resolve())
                    : Promise.resolve();
                }),
                (n.remove = function (e, t) {
                  if (!this.g) return !1;
                  var r = this.h.length;
                  return (
                    (this.h = this.h.filter(function (r) {
                      return r.startTime < e || r.endTime >= t;
                    })),
                    Xd(this, r > this.h.length),
                    this.h.length || Wd(this),
                    !0
                  );
                }),
                (n.isTextVisible = function () {
                  return this.m;
                }),
                (n.setTextVisibility = function (e) {
                  (this.m = e)
                    ? (this.g.parentElement || this.o.appendChild(this.g), Xd(this, !0))
                    : this.g.parentElement && this.o.removeChild(this.g);
                }),
                (n.setTextLanguage = function (e) {
                  e && "und" != e ? this.g.setAttribute("lang", e) : this.g.setAttribute("lang", "");
                }),
                (n.enableTextDisplayer = function () {}),
                j("shaka.text.UITextDisplayer", Kd),
                (Kd.prototype.enableTextDisplayer = Kd.prototype.enableTextDisplayer),
                (Kd.prototype.setTextLanguage = Kd.prototype.setTextLanguage),
                (Kd.prototype.setTextVisibility = Kd.prototype.setTextVisibility),
                (Kd.prototype.isTextVisible = Kd.prototype.isTextVisible),
                (Kd.prototype.remove = Kd.prototype.remove),
                (Kd.prototype.destroy = Kd.prototype.destroy),
                (Kd.prototype.append = Kd.prototype.append),
                (Kd.prototype.configure = Kd.prototype.configure),
                j("shaka.text.WebVttGenerator", function () {}),
                (Jd.prototype.setMediaElement = function (t) {
                  ((this.h = t),
                    (function (t) {
                      (t.i.D(t.h, "playing", function () {
                        (t.C || (t.C = Date.now()), ih(t, "ps", { dd: "p" }));
                      }),
                        t.i.D(t.h, "volumechange", function () {
                          ih(t, t.h.muted ? "m" : "um");
                        }),
                        t.i.D(t.h, "play", function () {
                          t.B || ((t.B = Date.now()), ih(t, "ps", { dd: "s" }));
                        }),
                        t.i.D(t.h, "pause", function () {
                          ih(t, "ps", { dd: "a" });
                        }),
                        t.i.D(t.j, "buffering", function () {
                          ih(t, "ps", { dd: "w" });
                        }),
                        t.i.D(t.h, "seeking", function () {
                          return ih(t, "ps", { dd: "k" });
                        }),
                        t.i.D(document, "fullscreenchange", function () {
                          ih(t, document.fullscreenElement ? "pe" : "pc");
                        }));
                      var r = t.h;
                      ((r.webkitPresentationMode || r.webkitSupportsFullscreen) &&
                        t.i.D(r, "webkitpresentationmodechanged", function () {
                          r.webkitPresentationMode
                            ? ih(t, "inline" !== r.webkitPresentationMode ? "pe" : "pc")
                            : r.webkitSupportsFullscreen && ih(t, r.webkitDisplayingFullscreen ? "pe" : "pc");
                        }),
                        t.i.D(t.h, "enterpictureinpicture", function () {
                          ih(t, "pe");
                        }),
                        t.i.D(t.h, "leavepictureinpicture", function () {
                          ih(t, "pc");
                        }),
                        "documentPictureInPicture" in e &&
                          t.i.D(e.documentPictureInPicture, "enter", function (e) {
                            (ih(t, "pe"),
                              t.i.Aa(e.window, "pagehide", function () {
                                ih(t, "pc");
                              }));
                          }),
                        t.i.D(document, "visibilitychange", function () {
                          document.hidden ? ih(t, "b", { bg: !0 }) : ih(t, "b");
                        }),
                        t.i.D(t.j, "complete", function () {
                          ih(t, "ps", { dd: "e" });
                        }));
                    })(this));
                }),
                (Jd.prototype.configure = function (e) {
                  ((this.g = e),
                    (function (e) {
                      Zd(e);
                      for (var t = eh(e), r = (t = g(t)).next(); !r.done; r = t.next())
                        if ((void 0 === (r = r.value.timeInterval) && (r = Nh), r >= 1)) {
                          var i = new Ri(function () {
                            return ih(e, Uh);
                          });
                          (i.Ea(r), e.G.push(i));
                        }
                    })(this));
                }));
              var gh = "m",
                mh = "a",
                vh = "v",
                yh = "av",
                Th = "i",
                bh = "c",
                Sh = "tt",
                Eh = 2,
                xh = "v",
                wh = "l",
                Ah = "d",
                Ih = "ld",
                kh = "h",
                Rh = "lh";
              j("shaka.util.CmcdManager.StreamingFormat", {
                DASH: Ah,
                Sl: Ih,
                HLS: kh,
                Tl: Rh,
                im: "s",
                OTHER: "o",
              });
              var Ch = "br bl bs cid d dl mtp nor nrr ot pr rtp sf sid st su tb v".split(" "),
                Lh =
                  "br ab bl tbl bs cdn cid ltc mtp pr sf sid bg sta st ts tpb tb lb tab lab pt ec msd v sn".split(
                    " ",
                  ),
                Mh =
                  "ab bl tbl bs cdn cid d dl ltc mtp nor ot pr rtp sf sid bg sta st su ts tpb tb lb tab lab pt ec msd v".split(
                    " ",
                  ),
                Dh = "d dl nor ot rtp rc su ttfb ttfbb ttlb url cmsdd cmsds".split(" "),
                _h = ["e", "sta"],
                Ph = "ps e t c b m um pe pc".split(" "),
                Oh = "spawkrfeqd".split(""),
                Nh = 10,
                Fh = "ts",
                Uh = "t",
                Bh = "request",
                $h = "response",
                jh = "event";
              function Gh(e) {
                ((this.h = e), (this.g = null));
              }
              function Vh(e) {
                return (
                  !e ||
                  ("false" !== e.toLowerCase() &&
                    (/^[-0-9]/.test(e) ? parseInt(e, 10) : e.replace(/["]+/g, "")))
                );
              }
              (((n = Gh.prototype).configure = function (e) {
                this.h = e;
              }),
                (n.ji = function () {
                  return this.h.enabled && this.h.applyMaximumSuggestedBitrate && this.g && this.g.has(Kh)
                    ? 1e3 * this.g.get(Kh)
                    : null;
                }),
                (n.gi = function () {
                  return this.h.enabled && this.g && this.g.has(Hh) ? 1e3 * this.g.get(Hh) : null;
                }),
                (n.Xj = function () {
                  return this.h.enabled && this.g && this.g.has(Wh) ? this.g.get(Wh) : null;
                }),
                (n.Yj = function () {
                  return this.h.enabled && this.g && this.g.has(zh) ? this.g.get(zh) : null;
                }),
                (n.getBandwidthEstimate = function (e) {
                  var t = this.gi();
                  if (!t) return e;
                  var r = this.h.estimatedThroughputWeightRatio;
                  return r > 0 && r <= 1 ? e * (1 - r) + t * r : e;
                }),
                j("shaka.util.CmsdManager", Gh),
                (Gh.prototype.getBandwidthEstimate = Gh.prototype.getBandwidthEstimate),
                (Gh.prototype.getRoundTripTime = Gh.prototype.Yj),
                (Gh.prototype.getResponseDelay = Gh.prototype.Xj),
                (Gh.prototype.getEstimatedThroughput = Gh.prototype.gi),
                (Gh.prototype.getMaxBitrate = Gh.prototype.ji));
              var Hh = "etp",
                Kh = "mb",
                Wh = "rd",
                zh = "rtt";
              function qh() {
                ((this.g = null), (this.h = []));
              }
              function Xh(e, t) {
                return D(function (r) {
                  if (1 == r.g)
                    return e.g
                      ? b(
                          r,
                          new Promise(function (t) {
                            return e.h.push(t);
                          }),
                          2,
                        )
                      : r.A(2);
                  ((e.g = t), S(r));
                });
              }
              function Yh(e, t, r) {
                return (
                  (r = void 0 === r ? Number.EPSILON : r),
                  e === t ||
                    (e = Math.abs(e - t)) <= r ||
                    (r !== Number.EPSILON && Math.abs(e - r) <= Number.EPSILON)
                );
              }
              function Qh(t, r, i) {
                ((r = void 0 === r ? null : r), Fn.call(this));
                var n = this;
                ((this.m = rf),
                  (this.h = null),
                  (this.Be = r),
                  (this.$ = !1),
                  (this.Le = new re()),
                  (this.Ce = new re()),
                  (this.j = new re()),
                  (this.dc = new re()),
                  (this.Gd = new re()),
                  (this.G = this.H = this.F = this.N = null),
                  (this.Me = 0),
                  (this.ba = new qh()),
                  (this.O =
                    this.Fa =
                    this.X =
                    this.i =
                    this.zc =
                    this.I =
                    this.l =
                    this.ye =
                    this.T =
                    this.Ph =
                    this.va =
                    this.K =
                    this.kb =
                    this.za =
                    this.Ae =
                    this.R =
                    this.Ta =
                    this.M =
                    this.ac =
                      null),
                  (this.Ua = !1),
                  (this.Ge = this.o = null),
                  (this.Fe = 1e9),
                  (this.Ke = []),
                  (this.yc = new Map()),
                  (this.ob = []),
                  (this.ag = -1),
                  (this.g = Ic(this)),
                  (this.dg = {
                    streaming: {
                      inaccurateManifestTolerance: 0,
                      segmentPrefetchLimit: 2,
                      updateIntervalSeconds: 0.1,
                      maxDisabledTime: 1,
                      retryParameters: { baseDelay: 100 },
                    },
                    manifest: { dash: { autoCorrectDrift: !1 }, retryParameters: { baseDelay: 100 } },
                    drm: { retryParameters: { baseDelay: 100 } },
                  }),
                  (this.V = null),
                  (this.Ne = -1),
                  (this.cc = null),
                  (this.ya = { width: 1 / 0, height: 1 / 0 }),
                  (this.Ee = new Ka(this.g, this.ya, null)),
                  (this.Ie = []),
                  (this.B = null),
                  (this.J = this.g.adaptationSetCriteriaFactory()),
                  this.J.configure({
                    language: this.g.preferredAudioLanguage,
                    role: this.g.preferredAudioRole,
                    videoRole: this.g.preferredVideoRole,
                    channelCount: 0,
                    hdrLevel: this.g.preferredVideoHdrLevel,
                    spatialAudio: this.g.preferSpatialAudio,
                    videoLayout: this.g.preferredVideoLayout,
                    audioLabel: this.g.preferredAudioLabel,
                    videoLabel: this.g.preferredVideoLabel,
                    codecSwitchingStrategy: this.g.mediaSource.codecSwitchingStrategy,
                    audioCodec: "",
                    activeAudioCodec: "",
                    activeAudioChannelCount: 0,
                    preferredAudioCodecs: this.g.preferredAudioCodecs,
                    preferredAudioChannelCount: this.g.preferredAudioChannelCount,
                  }),
                  (this.Kd = this.g.preferredTextLanguage),
                  (this.Od = this.g.preferredTextRole),
                  (this.Nd = this.g.preferForcedSubs),
                  (this.De = []),
                  i && i(this),
                  (this.K = new Jd(this, this.g.cmcd)),
                  (this.va = new Gh(this.g.cmsd)),
                  (this.N = cc(this)),
                  (this.ma = this.oa = this.Da = this.C = null),
                  (this.fg = !1),
                  (this.cg = []),
                  (this.eg = new Ri(function () {
                    return D(function (e) {
                      return 1 == e.g
                        ? n.oa
                          ? b(e, n.Vb(n.ma, !0), 3)
                          : e.A(0)
                        : 4 != e.g
                          ? b(e, n.load(n.oa), 4)
                          : (n.fg ? n.ma.pause() : n.ma.play(), (n.oa = null), (n.fg = !1), void S(e));
                    });
                  })),
                  lf &&
                    ((this.C = lf()),
                    this.C.configure(this.g.ads),
                    this.Gd.D(this.C, "ad-content-pause-requested", function (e) {
                      var t, r;
                      return D(function (i) {
                        if (1 == i.g)
                          return (
                            n.eg.stop(),
                            n.oa
                              ? i.A(0)
                              : ((n.ma = n.h),
                                (n.fg = n.ge()),
                                (t = e.saveLivePosition || !1),
                                (r = !0),
                                n.W() && (r = t),
                                b(i, n.$h(!0, r), 3))
                          );
                        ((n.oa = i.h), S(i));
                      });
                    }),
                    this.Gd.D(this.C, "ad-content-resume-requested", function (e) {
                      if (((e = e.offset || 0), n.oa)) {
                        var t = n.oa;
                        t.o &&
                          e &&
                          ("number" == typeof t.o ? (t.o += e) : t.o.setTime(t.o.getTime() + 1e3 * e));
                      }
                      n.eg.ka(0.1);
                    }),
                    this.Gd.D(this.C, "ad-content-attach-requested", function () {
                      return D(function (e) {
                        if (1 == e.g) return n.h || !n.ma ? e.A(0) : b(e, n.Vb(n.ma, !0), 3);
                        ((n.ma = null), S(e));
                      });
                    })),
                  uf && ((this.Da = uf(this)), this.Da.configure(this.g.queue)),
                  this.Le.D(e, "online", function () {
                    (Wc(n), n.kh());
                  }),
                  (this.He = new Ri(function () {
                    for (
                      var e = Date.now() / 1e3, t = !1, r = !0, i = g(n.i.variants), a = i.next();
                      !a.done;
                      a = i.next()
                    )
                      ((a = a.value).disabledUntilTime > 0 &&
                        a.disabledUntilTime <= e &&
                        ((a.disabledUntilTime = 0), (t = !0)),
                        a.disabledUntilTime > 0 && (r = !1));
                    (r && n.He.stop(), t && Pc(n, !1, void 0, !1, !1));
                  })),
                  (this.eb = null),
                  t &&
                    (he(
                      "Player w/ mediaElement",
                      "Please migrate from initializing Player with a mediaElement; use the attach method instead.",
                    ),
                    this.Vb(t, !0)),
                  (this.u = null));
              }
              function Jh(e) {
                null != e.T && (St(e.T), e.T.release(), (e.T = null));
              }
              function Zh(e, t) {
                return new Pn(e, t);
              }
              function ec(e, t) {
                of.set(e, t);
              }
              function tc(e, t) {
                e.dispatchEvent(Zh("onstatechange", new Map().set("state", t)));
              }
              function rc(e, t) {
                var r;
                return D(function (i) {
                  return 1 == i.g
                    ? ((r = ++e.Me), b(i, Xh(e.ba, t), 2))
                    : r != e.Me
                      ? (e.ba.release(), i.return(!0))
                      : i.return(!1);
                });
              }
              function ic(e, t) {
                var r, i, n;
                return (
                  (t = void 0 !== t && t),
                  D(function (a) {
                    if (1 == a.g)
                      return (
                        (r = null),
                        e.i && e.I && e.zc && e.X && e.g
                          ? ((i = e.h.currentTime),
                            t || (i = null),
                            b(a, ac(e, e.X, i, e.Fa, e.g, !0, !1), 3))
                          : a.A(2)
                      );
                    if (2 != a.g) {
                      ((r = a.h),
                        e.Ie.push(r),
                        e.I && e.I.setMediaElement && e.I.setMediaElement(null),
                        (n = e.l ? e.l.o : null) && (r.i = n));
                      var s = r,
                        o = e.I,
                        l = e.zc;
                      ((s.h = e.i),
                        (s.m = o),
                        (s.H = l),
                        (r.C = e.J),
                        r.start(),
                        (e.i = null),
                        (e.I = null),
                        (e.zc = null),
                        (e.o = null),
                        (e.Ge = null));
                    }
                    return a.return(r);
                  })
                );
              }
              function nc(e, t, r, i, n, a) {
                var s, o, l;
                return (
                  (n = void 0 !== n && n),
                  D(function (u) {
                    return 1 == u.g
                      ? i
                        ? u.A(2)
                        : b(u, sc(e, t), 3)
                      : (2 != u.g && (i = u.h),
                        (function (e, t) {
                          if (!Qv(se())) return !0;
                          if (t) {
                            if ("" == (e.h || eo()).canPlayType(t)) return !1;
                            if (!Qv(se()) || !It.has(t.toLowerCase())) return !0;
                            if (mi(t))
                              return "WEBKIT" === se().Ha() &&
                                (e.g.drm.servers["com.apple.fps"] || e.g.drm.servers["com.apple.fps.1_0"])
                                ? e.g.streaming.useNativeHlsForFairPlay
                                : e.g.streaming.preferNativeHls;
                            if ("application/dash+xml" === t || "video/vnd.mpeg.dash.mpd" === t)
                              return e.g.streaming.preferNativeDash;
                          }
                          return !1;
                        })(e, i)
                          ? u.return(null)
                          : ((s = a || e.g),
                            (o = !1),
                            n && e.h && "AUDIO" === e.h.nodeName && (o = !0),
                            (l = ac(e, t, r, i || null, s, !n, o)),
                            (l = n
                              ? l.then(function (e) {
                                  return ((e.F = !1), e);
                                })
                              : l.then(function (t) {
                                  return (e.Ie.push(t), t);
                                })),
                            u.return(l)));
                  })
                );
              }
              function ac(e, t, r, i, n, a, s) {
                var o, l, u, d, h, c, f, p, m, v, y, T;
                return (
                  (a = void 0 === a || a),
                  (s = void 0 !== s && s),
                  D(function (E) {
                    return 1 == E.g
                      ? ((o = null),
                        (l = Wt(n)),
                        s && (l.manifest.disableVideo = !0),
                        (u = function () {
                          return o.R && o.l ? null : o;
                        }),
                        (d = function () {
                          return u() ? u().getConfiguration() : e.g;
                        }),
                        e.ya.width != 1 / 0 || e.ya.height != 1 / 0 || e.g.ignoreHardwareResolution
                          ? E.A(2)
                          : b(E, se().lc(), 3))
                      : (2 != E.g && ((h = E.h), (e.ya.width = h.width), (e.ya.height = h.height)),
                        (c = new Ka(l, e.ya, null)),
                        (f = {
                          networkingEngine: e.N,
                          filter: function (e) {
                            var t;
                            return D(function (r) {
                              return 1 == r.g
                                ? b(r, Wa(c, e), 2)
                                : 4 != r.g
                                  ? r.h
                                    ? ((t = Zh("trackschanged")), b(r, Promise.resolve(), 4))
                                    : r.A(0)
                                  : (o.dispatchEvent(t), void S(r));
                            });
                          },
                          makeTextStreamsForClosedCaptions: function (t) {
                            return (function (e, t) {
                              for (
                                var r = new Set(), i = g(t.textStreams), n = i.next();
                                !n.done;
                                n = i.next()
                              )
                                ("application/cea-608" != (n = n.value).mimeType &&
                                  "application/cea-708" != n.mimeType) ||
                                  r.add(n.originalId);
                              for (i = g(t.variants), n = i.next(); !n.done; n = i.next())
                                if ((n = n.value.video) && n.closedCaptions)
                                  for (
                                    var a = g(n.closedCaptions.keys()), s = a.next();
                                    !s.done;
                                    s = a.next()
                                  )
                                    if (((s = s.value), !r.has(s))) {
                                      var o = s.startsWith("CC")
                                          ? "application/cea-608"
                                          : "application/cea-708",
                                        l = new Ol(),
                                        u = n.closedCaptions.get(s);
                                      ((o = {
                                        id: e.Fe++,
                                        originalId: s,
                                        groupId: null,
                                        createSegmentIndex: function () {
                                          return Promise.resolve();
                                        },
                                        segmentIndex: l,
                                        mimeType: o,
                                        codecs: "",
                                        kind: "caption",
                                        encrypted: !1,
                                        drmInfos: [],
                                        keyIds: new Set(),
                                        language: u,
                                        originalLanguage: u,
                                        label: null,
                                        type: gt,
                                        primary: !1,
                                        trickModeVideo: null,
                                        dependencyStream: null,
                                        emsgSchemeIdUris: null,
                                        roles: n.roles,
                                        forced: !1,
                                        channelsCount: null,
                                        audioSamplingRate: null,
                                        spatialAudio: !1,
                                        closedCaptions: null,
                                        accessibilityPurpose: null,
                                        external: !1,
                                        fastSwitching: !1,
                                        fullMimeTypes: new Set([li(o, "")]),
                                        isAudioMuxedInVideo: !1,
                                        baseOriginalId: null,
                                      }),
                                        t.textStreams.push(o),
                                        r.add(s));
                                    }
                            })(e, t);
                          },
                          onTimelineRegionAdded: function (e) {
                            Hl(o.I, e);
                          },
                          onEvent: function (e) {
                            return o.dispatchEvent(e);
                          },
                          onError: function (e) {
                            return o.onError(e);
                          },
                          isLowLatencyMode: function () {
                            return d().streaming.lowLatencyMode;
                          },
                          updateDuration: function () {
                            e.l && o.R && e.l.updateDuration();
                          },
                          newDrmInfo: function (e) {
                            var t = o.j,
                              r = t ? t.g : null;
                            r && t.B && Xa(c, r.keySystem, e);
                          },
                          onManifestUpdated: function () {
                            var t = new Map().set("isLive", e.W());
                            (o.dispatchEvent(Zh("manifestupdated", t)),
                              gd(o, !1, function () {
                                e.C && e.C.onManifestUpdated(e.W());
                              }));
                          },
                          getBandwidthEstimate: function () {
                            return e.o.getBandwidthEstimate();
                          },
                          onMetadata: function (t, r, i, n) {
                            var a = t;
                            (("com.apple.hls.interstitial" != t && "com.apple.hls.overlay" != t) ||
                              ((a = "com.apple.quicktime.HLS"),
                              (t = { startTime: r, endTime: i, values: n }),
                              e.C && e.C.onHLSInterstitialMetadata(e, e.h, t)),
                              (t = (n = g(n)).next()));
                            for (var s = {}; !t.done; s = { bh: void 0 }, t = n.next())
                              ((s.bh = t.value),
                                "ID" != s.bh.name &&
                                  gd(
                                    o,
                                    !1,
                                    (function (t) {
                                      return function () {
                                        hc(e, r, i, a, t.bh);
                                      };
                                    })(s),
                                  ));
                          },
                          disableStream: function (t) {
                            return e.disableStream(t, e.g.streaming.maxDisabledTime);
                          },
                          addFont: function (t, r) {
                            return e.addFont(t, r);
                          },
                        }),
                        (p = new Vl(function () {
                          return e.Ra();
                        })).addEventListener("regionadd", function (t) {
                          var r = t.region;
                          (qc(e, "timelineregionadded", r, o),
                            gd(o, !1, function () {
                              e.C && (e.C.onDashTimedMetadata(r), e.C.onDASHInterstitialMetadata(e, e.h, r));
                            }));
                        }),
                        (m = null),
                        l.streaming.observeQualityChanges &&
                          ((m = new $l(function () {
                            return e.Gc();
                          })).addEventListener("qualitychange", function (t) {
                            Xc(e, t.quality, t.position);
                          }),
                          m.addEventListener("audiotrackchange", function (t) {
                            Xc(e, t.quality, t.position, !0);
                          })),
                        (v = !0),
                        (y = {
                          vc: e.N,
                          onError: function (e) {
                            return o.onError(e);
                          },
                          zf: function (t) {
                            gd(o, !0, function () {
                              e.F &&
                                (function (e, t) {
                                  var r = Zh("keystatuschanged");
                                  e.dispatchEvent(r);
                                  var i = Object.keys(t);
                                  1 == i.length && "" == i[0] && ((i = ["00"]), (t = { "00": t[""] }));
                                  var n = 1 == i.length && "00" == i[0];
                                  if (((r = !1), i.length)) {
                                    i = e.keySystem();
                                    for (
                                      var a = ea(e.g.drm.clearKeys),
                                        s = function (r, i) {
                                          r.allowedByKeySystem = !0;
                                          for (var a = (i = g(i)).next(); !a.done; a = i.next())
                                            ((a = a.value),
                                              ((a = t[n ? "00" : a]) || e.F.H) &&
                                                (r.allowedByKeySystem =
                                                  r.allowedByKeySystem && !!a && !Qa.includes(a)));
                                        },
                                        o = g(e.i.variants),
                                        l = o.next();
                                      !l.done;
                                      l = o.next()
                                    )
                                      for (
                                        var u = hn((l = l.value)), d = (u = g(u)).next();
                                        !d.done;
                                        d = u.next()
                                      ) {
                                        d = d.value;
                                        var h = l.allowedByKeySystem;
                                        if (d.keyIds.size)
                                          if (d.drmInfos.length && !a.size && "HLS" == e.i.type)
                                            for (var c = g(d.drmInfos), f = c.next(); !f.done; f = c.next())
                                              (f = f.value).keySystem == i &&
                                                (f.keyIds.size ? s(l, f.keyIds) : s(l, d.keyIds));
                                          else s(l, d.keyIds);
                                        h != l.allowedByKeySystem && (r = !0);
                                      }
                                  }
                                  r && (Uc(e), (r = e.l.o) && !r.allowedByKeySystem ? Pc(e) : Dc(e));
                                })(e, t);
                            });
                          },
                          onExpirationUpdated: function (e, t) {
                            var r = Zh("expirationupdated");
                            (o.dispatchEvent(r),
                              (r = o.m) && r.onExpirationUpdated && r.onExpirationUpdated(e, t));
                          },
                          onEvent: function (t) {
                            (o.dispatchEvent(t),
                              "drmsessionupdate" == t.type &&
                                v &&
                                ((v = !1),
                                (t = Date.now() / 1e3 - o.za),
                                ((e.B || o.getStats()).m = t),
                                e.T && St(e.T)));
                          },
                        }),
                        (T = cc(e, u)),
                        Gn(e.N, T),
                        (o = new pd(t, i, r, {
                          config: l,
                          zk: f,
                          Kk: p,
                          Jk: m,
                          md: function () {
                            return e.md(y);
                          },
                          yk: c,
                          networkingEngine: T,
                          pj: a,
                        })),
                        E.return(o));
                  })
                );
              }
              function sc(e, t) {
                var r, i;
                return D(function (n) {
                  return 1 == n.g
                    ? ((r = e.g.manifest.retryParameters), b(n, su(t, e.N, r), 2))
                    : ("application/x-mpegurl" == (i = n.h) &&
                        "WEBKIT" === se().Ha() &&
                        (i = "application/vnd.apple.mpegurl"),
                      "video/quicktime" == i && "CHROMIUM" === se().Ha() && (i = "video/mp4"),
                      n.return(i));
                });
              }
              function oc(e, t) {
                var r = e.g.textDisplayFactory;
                e.Oh !== r || (void 0 !== t && t)
                  ? ((t = e.u),
                    (e.u = r()),
                    e.u.configure
                      ? e.u.configure(e.g.textDisplayer)
                      : he("Text displayer w/ configure", 'Text displayer should have a "configure" method!'),
                    e.u.setTextLanguage ||
                      he(
                        "Text displayer w/ setTextLanguage",
                        'Text displayer should have a "setTextLanguage" method!',
                      ),
                    t
                      ? (e.u.setTextVisibility(t.isTextVisible()), t.destroy().catch(function () {}))
                      : e.u.setTextVisibility(e.$),
                    e.H &&
                      (function (e, t) {
                        ((e.ba = t), e.h && (e.h.l = t));
                      })(e.H, e.u),
                    (e.Oh = r),
                    e.l &&
                      (function (e) {
                        var t = e.h.get(gt);
                        t && pu(e, t.stream, !0, 0, !0);
                      })(e.l))
                  : e.u && e.u.configure && e.u.configure(e.g.textDisplayer);
              }
              function lc(e) {
                var t, r, i;
                return D(function (n) {
                  if (1 == n.g)
                    return (
                      se(),
                      tc(e, "media-source"),
                      e.g.mediaSource.useSourceElements && Js(e.h),
                      oc(e),
                      (t = (function (e, t, r, i, n) {
                        return new Mo(e, t, r, n, i);
                      })(
                        e.h,
                        e.u,
                        {
                          Pj: function () {
                            return e.keySystem();
                          },
                          onMetadata: function (t, r, i) {
                            for (var n = (t = g(t)).next(); !n.done; n = t.next())
                              if ((n = n.value).data && "number" == typeof n.cueTime && n.frames) {
                                var a = n.cueTime + r,
                                  s = i;
                                s && a > s && (s = a);
                                for (var o = g(n.frames), l = o.next(); !l.done; l = o.next())
                                  hc(e, a, s, "org.id3", l.value);
                                e.C && e.C.onHlsTimedMetadata(n, a);
                              }
                          },
                          Ek: function (t) {
                            e.kb &&
                              Hl(e.kb, {
                                schemeIdUri: t.schemeIdUri,
                                startTime: t.startTime,
                                endTime: t.endTime,
                                id: String(t.id),
                                emsg: t,
                              });
                          },
                          onEvent: function (t) {
                            return e.dispatchEvent(t);
                          },
                          Gk: function () {
                            e.I && e.I.update && e.I.update();
                          },
                        },
                        e.T,
                        e.g.mediaSource,
                      )),
                      (r = e.g.manifest),
                      (i = r.segmentRelativeVttTiming),
                      (t.Fa = i),
                      b(n, t.M, 2)
                    );
                  ((e.H = t), S(n));
                });
              }
              function uc(e, t, r) {
                function i() {
                  return Cc(e);
                }
                if (
                  (e.j.D(t, "playing", i),
                  e.j.D(t, "pause", i),
                  e.j.D(t, "ended", i),
                  e.j.D(t, "ratechange", function () {
                    var t = e.h.playbackRate;
                    0 != t &&
                      (e.M && (e.M.set(t), e.m == nf && e.o.playbackRateChanged(t), Rc(e, t)),
                      (t = Zh("ratechange")),
                      e.dispatchEvent(t));
                  }),
                  t.remote &&
                    (e.j.D(t.remote, "connect", function () {
                      (e.l && "connected" == t.remote.state && Gc(e), Uc(e));
                    }),
                    e.j.D(t.remote, "connecting", function () {
                      return Uc(e);
                    }),
                    e.j.D(t.remote, "disconnect", function () {
                      return D(function (r) {
                        if (1 == r.g)
                          return e.l && "disconnected" == t.remote.state ? b(r, Pu(e.l), 3) : r.A(2);
                        (2 != r.g && Gc(e), Uc(e), S(r));
                      });
                    })),
                  t.audioTracks &&
                    (e.j.D(t.audioTracks, "addtrack", function () {
                      return Uc(e);
                    }),
                    e.j.D(t.audioTracks, "removetrack", function () {
                      return Uc(e);
                    }),
                    e.j.D(t.audioTracks, "change", function () {
                      return Uc(e);
                    })),
                  t.videoTracks &&
                    (e.j.D(t.videoTracks, "addtrack", function () {
                      return Uc(e);
                    }),
                    e.j.D(t.videoTracks, "removetrack", function () {
                      return Uc(e);
                    }),
                    e.j.D(t.videoTracks, "change", function () {
                      return Uc(e);
                    })),
                  (t.webkitPresentationMode || t.webkitSupportsFullscreen) &&
                    e.j.D(t, "webkitpresentationmodechanged", function () {
                      e.Be && oc(e, !0);
                    }),
                  t.textTracks)
                ) {
                  var n = function () {
                    (e.m === af && e.u instanceof $d && Gc(e), Uc(e));
                  };
                  (e.j.D(t.textTracks, "addtrack", function (t) {
                    if (t.track)
                      switch (((t = t.track), t.kind)) {
                        case "metadata":
                          !(function (e, t) {
                            if ("metadata" == t.kind) {
                              ((t.mode = "hidden"),
                                e.j.D(t, "cuechange", function () {
                                  if (t.activeCues)
                                    for (var r = g(t.activeCues), i = r.next(); !i.done; i = r.next())
                                      ((i = i.value),
                                        hc(e, i.startTime, i.endTime, i.type, i.value),
                                        e.C && e.C.onCueMetadataChange(i.value));
                                  if (t.cues) {
                                    r = [];
                                    for (
                                      var n = (i = g(t.cues)).next(), a = {};
                                      !n.done;
                                      a = { Ec: void 0 }, n = i.next()
                                    )
                                      ((a.Ec = n.value),
                                        "com.apple.quicktime.HLS" == a.Ec.type &&
                                          null != a.Ec.startTime &&
                                          ((n = r.find(
                                            (function (e) {
                                              return function (t) {
                                                return (
                                                  t.startTime == e.Ec.startTime && t.endTime == e.Ec.endTime
                                                );
                                              };
                                            })(a),
                                          )),
                                          n ||
                                            ((n = {
                                              startTime: a.Ec.startTime,
                                              endTime: a.Ec.endTime,
                                              values: [],
                                            }),
                                            r.push(n)),
                                          n.values.push(a.Ec.value)));
                                    for (i = (r = g(r)).next(); !i.done; i = r.next())
                                      (i = i.value).values.some(function (e) {
                                        return "X-ASSET-URI" == e.key || "X-ASSET-LIST" == e.key;
                                      }) &&
                                        e.C &&
                                        (i.values.push({
                                          key: "CUE",
                                          description: "",
                                          data: 0 != i.startTime || e.W() ? "ONCE" : "ONCE,PRE",
                                          mimeType: null,
                                          pictureType: null,
                                        }),
                                        e.C.onHLSInterstitialMetadata(e, e.h, i));
                                  }
                                }));
                              var r = new Ri(function () {
                                for (
                                  var t = (function (e) {
                                      return Array.from(e.h.textTracks).filter(function (e) {
                                        return "metadata" == e.kind;
                                      });
                                    })(e),
                                    r = (t = g(t)).next();
                                  !r.done;
                                  r = t.next()
                                )
                                  r.value.mode = "hidden";
                              })
                                .Jb()
                                .ka(0.5);
                              e.De.push(function () {
                                r.stop();
                              });
                            }
                          })(e, t);
                          break;
                        case "chapters":
                          !(function (e, t) {
                            if (t && "chapters" == t.kind) {
                              t.mode = "hidden";
                              var r = new Ri(function () {
                                t.mode = "hidden";
                              })
                                .Jb()
                                .ka(0.5);
                              e.De.push(function () {
                                r.stop();
                              });
                            }
                          })(e, t);
                          break;
                        default:
                          n();
                      }
                  }),
                    e.j.D(t.textTracks, "removetrack", n),
                    e.j.D(t.textTracks, "change", n));
                }
                "none" != t.preload &&
                  e.j.Aa(t, "loadedmetadata", function () {
                    e.B.G = Date.now() / 1e3 - r;
                  });
              }
              function dc(e, t, r) {
                ((t = new Map()
                  .set("startTime", t.startTime)
                  .set("endTime", t.endTime)
                  .set("metadataType", t.schemeIdUri)
                  .set("payload", t.payload)),
                  e.dispatchEvent(Zh(r, t)));
              }
              function hc(e, t, r, i, n) {
                e.za &&
                  (((t = { schemeIdUri: i, startTime: t, endTime: r || 1 / 0, id: "", payload: n }).id =
                    JSON.stringify(t)),
                  Hl(e.za, t));
              }
              function cc(e, t) {
                function r(r) {
                  t() ? t().dispatchEvent(r) : e.dispatchEvent(r);
                }
                function i(e) {
                  t() ? gd(t(), !0, e) : e();
                }
                t ||
                  (t = function () {
                    return null;
                  });
                var n = new $n(
                  function (t, r, n, a, s) {
                    i(function () {
                      e.o && e.o.segmentDownloaded(t, r, n, a, s);
                    });
                  },
                  function (t, n, a) {
                    (r(
                      Zh(
                        "downloadheadersreceived",
                        (n = new Map().set("headers", t).set("request", n).set("requestType", a)),
                      ),
                    ),
                      i(function () {
                        if (e.va) {
                          var r = e.va;
                          if (r.h.enabled) {
                            var i = t["cmsd-static"];
                            if (i)
                              try {
                                var n = new Map(),
                                  a = i.split(",");
                                for (i = 0; i < a.length; i++) {
                                  var s = a[i].split("=");
                                  n.set(s[0], Vh(s[1]));
                                }
                              } catch (h) {}
                            if ((n = t["cmsd-dynamic"])) {
                              e: {
                                try {
                                  var o = new Map(),
                                    l = n.split(";");
                                  for (n = 1; n < l.length; n++) {
                                    var u = l[n].split("=");
                                    o.set(u[0], Vh(u[1]));
                                  }
                                  var d = o;
                                  break e;
                                } catch (h) {
                                  d = null;
                                  break e;
                                }
                                d = void 0;
                              }
                              d && (r.g = d);
                            }
                          }
                        }
                      }));
                  },
                  function (e, t) {
                    r(Zh("downloadcompleted", (e = new Map().set("request", e).set("response", t))));
                  },
                  function (e, t, i, n) {
                    r(
                      Zh(
                        "downloadfailed",
                        (e = new Map()
                          .set("request", e)
                          .set("error", t)
                          .set("httpResponseCode", i)
                          .set("aborted", n)),
                      ),
                    );
                  },
                  function (t, r, n) {
                    i(function () {
                      if (e.K) {
                        var i = e.K,
                          a = n;
                        if (((a = void 0 === a ? {} : a), i.g.enabled))
                          if ("HEAD" === r.method) nh(i, r, {});
                          else
                            switch (t) {
                              case 0:
                                try {
                                  if (i.g.enabled) {
                                    if (a.type) {
                                      e: {
                                        switch (a.type) {
                                          case 4:
                                            var s = i.u ? Ih : Ah;
                                            break e;
                                          case 3:
                                          case 2:
                                            s = i.u ? Rh : kh;
                                            break e;
                                          case 5:
                                            s = "s";
                                            break e;
                                        }
                                        s = void 0;
                                      }
                                      i.l = s;
                                    }
                                    nh(i, r, { ot: gh, su: !i.F });
                                  }
                                } catch (l) {
                                  q("CMCD_MANIFEST_ERROR", "Could not generate manifest CMCD data.", l);
                                }
                                break;
                              case qn:
                                try {
                                  if (i.g.enabled) {
                                    var o = dh(i, a, r.uris[0]);
                                    ((o.ts = Date.now()),
                                      i.m.has(r) && i.m.delete(r),
                                      i.m.set(r, o.ts),
                                      nh(i, r, o));
                                  }
                                } catch (l) {
                                  q("CMCD_SEGMENT_ERROR", "Could not generate segment CMCD data.", l);
                                }
                                break;
                              case 2:
                              case 5:
                              case 6:
                                nh(i, r, { ot: "k" });
                                break;
                              case 4:
                                nh(i, r, { ot: "o" });
                            }
                      }
                    });
                  },
                  function (r, i, n, a) {
                    (r = t() ? t().m : e.I) && r.banLocation && r.banLocation(a);
                  },
                  function (r, i, n) {
                    if (i.data) {
                      var a = i.data.byteLength,
                        s = t() ? t().getStats() : e.B;
                      if (
                        (s && (cd(s, a), 0 === r && (s.wi = a)),
                        (n = void 0 === n ? {} : n),
                        0 !== th((a = e.K)).length && r === qn)
                      )
                        try {
                          var o = dh(a, n, i.uri);
                          (i.originalRequest &&
                            null != i.originalRequest.timeToFirstByte &&
                            (o.ttfb = i.originalRequest.timeToFirstByte),
                            null != i.timeMs && (o.ttlb = i.timeMs));
                          var l = i.originalUri || i.uri;
                          if (l.includes("CMCD="))
                            try {
                              var u = new URL(l);
                              u.searchParams.delete("CMCD");
                              var d = u.toString();
                            } catch (S) {
                              d = l;
                            }
                          else d = l;
                          ((o.url = d),
                            a.m.has(i.originalRequest)
                              ? ((o.ts = a.m.get(i.originalRequest)), a.m.delete(i.originalRequest))
                              : o.ts || (o.ts = Date.now()));
                          var h = th(a);
                          if (0 !== h.length) {
                            var c = a.g.version == Eh ? Array.from(new Set([].concat(m(Lh), m(Dh)))) : Ch;
                            o.rc = i.status || 0;
                            var f = hh(a, o, $h);
                            (i.headers &&
                              i.headers["CMSD-Static"] &&
                              (f.cmsds = btoa(i.headers["CMSD-Static"])),
                              i.headers &&
                                i.headers["CMSD-Dynamic"] &&
                                (f.cmsdd = btoa(i.headers["CMSD-Dynamic"])));
                            for (var p = g(h), v = p.next(); !v.done; v = p.next()) {
                              var y = v.value,
                                T = sh(y.includeKeys || [], c),
                                b = lh(y);
                              (a.o[b] || (a.o[b] = { request: 1, response: 1 }),
                                (f.sn = a.o[b].response++),
                                ah(a, oh(f, T), y, i));
                            }
                          }
                        } catch (S) {
                          q("CMCD_SEGMENT_ERROR", "Could not generate response segment CMCD data.", S);
                        }
                    }
                  },
                );
                return (n.configure(e.g.networking), n);
              }
              function fc(e, t, r) {
                ((e.R = new ja()),
                  Ga(e.R, Va),
                  pc(e),
                  kc(e),
                  (e.Ta = new Ri(function () {
                    gc(e);
                  })),
                  e.g.streaming.rebufferingGoal && e.Ta.Ea(0.25),
                  e.j.D(t, "waiting", function () {
                    return gc(e, "waiting");
                  }),
                  e.j.D(t, "canplaythrough", function () {
                    return gc(e, "canplaythrough");
                  }),
                  e.j.D(t, "playing", function () {
                    return gc(e, "playing");
                  }),
                  e.j.D(t, "seeked", function () {
                    return gc(e, "seeked");
                  }),
                  e.j.D(t, "timeupdate", function () {
                    return gc(e, "timeupdate");
                  }),
                  r &&
                    (e.j.D(t, "progress", function () {
                      return gc(e, "progress");
                    }),
                    e.j.D(t, "stalled", function () {
                      return gc(e, "stalled");
                    })));
              }
              function pc(e) {
                var t = e.g.streaming.rebufferingGoal;
                e.R.j.set(Ha, Math.min(0.5, t / 2)).set(Va, t);
              }
              function gc(e, t) {
                if (e.g.streaming.rebufferingGoal) {
                  ((t = !!e.H && No(e.H)), (t = e.ge() || t || e.G.ri()));
                  var r = qs(e.h.buffered, e.h.currentTime),
                    i = e.R,
                    n = i.j.get(i.g);
                  Ga(i, t || (r >= n && r > 0) ? Ha : Va) && kc(e);
                } else if (t) {
                  ((r = e.R), (i = e.h.currentTime), (n = r.h), (r.h = i));
                  var a = void 0;
                  switch (t) {
                    case "seeking":
                    case "waiting":
                      ((r.h = -1), (a = Va));
                      break;
                    case "canplaythrough":
                    case "playing":
                    case "seeked":
                      a = Ha;
                      break;
                    case "timeupdate":
                      n >= 0 && i - n > 0.01 && (a = Ha);
                  }
                  void 0 !== a && Ga(r, a) && kc(e);
                }
              }
              function mc(e, t) {
                if (((e.Ee = new Ka(e.g, e.ya, e.F)), e.I)) {
                  var r = Wt(e.g.manifest);
                  (e.h && "AUDIO" === e.h.nodeName && (r.disableVideo = !0), e.I.configure(r));
                }
                if ((e.F && e.F.configure(e.g.drm), e.l)) {
                  e.l.configure(e.g.streaming);
                  try {
                    e.m != tf && qa(e.Ee, e.i) && Uc(e);
                  } catch (n) {
                    zc(e, n);
                  }
                  (e.o && Dc(e), !(r = e.l.o) || (r.allowedByApplication && r.allowedByKeySystem) || Pc(e));
                }
                if (
                  (e.N && e.N.configure(e.g.networking),
                  e.H && (e.H.configure(e.g.mediaSource), (e.H.Fa = e.g.manifest.segmentRelativeVttTiming)),
                  e.u && oc(e),
                  e.o && (e.o.configure(e.g.abr), e.g.abr.enabled ? e.o.enable() : e.o.disable(), Hc(e)),
                  e.R && pc(e),
                  e.Ta && (e.g.streaming.rebufferingGoal ? e.Ta.Ea(0.25) : e.Ta.stop()),
                  e.i && Qc(e.i.presentationTimeline, e.g.playRangeStart, e.g.playRangeEnd),
                  e.C && e.C.configure(e.g.ads),
                  e.K && e.K.configure(e.g.cmcd),
                  e.va && e.va.configure(e.g.cmsd),
                  e.Da && e.Da.configure(e.g.queue),
                  e.m == nf && e.J.getConfiguration)
                ) {
                  r = e.J.getConfiguration();
                  var i = !1;
                  (t.preferredVideoHdrLevel != e.g.preferredVideoHdrLevel &&
                    r.hdrLevel != e.g.preferredVideoHdrLevel &&
                    ((r.hdrLevel = e.g.preferredVideoHdrLevel), (i = !0)),
                    t.preferredVideoLayout != e.g.preferredVideoLayout &&
                      r.videoLayout != e.g.preferredVideoLayout &&
                      ((r.videoLayout = e.g.preferredVideoLayout), (i = !0)),
                    t.preferSpatialAudio != e.g.preferSpatialAudio &&
                      r.spatialAudio != e.g.preferSpatialAudio &&
                      ((r.spatialAudio = e.g.preferSpatialAudio), (i = !0)),
                    t.preferredVideoRole != e.g.preferredVideoRole &&
                      r.videoRole != e.g.preferredVideoRole &&
                      ((r.videoRole = e.g.preferredVideoRole), (i = !0)),
                    i && (e.J.configure(r), Pc(e)));
                }
              }
              function vc(e) {
                return e && (e = /(\d+)x(\d+)/.exec(e))
                  ? { columns: parseInt(e[1], 10), rows: parseInt(e[2], 10) }
                  : null;
              }
              function yc(e, t) {
                var r, i;
                return D(function (n) {
                  return 1 == n.g
                    ? e.m != nf && e.m != af
                      ? n.return(null)
                      : ((r = e.Ke),
                        e.i && (r = e.i.imageStreams),
                        (i = r[0])
                          ? (null != t &&
                              (i = r.find(function (e) {
                                return e.id == t;
                              })),
                            i ? (i.segmentIndex ? n.A(2) : b(n, i.createSegmentIndex(), 2)) : n.return(null))
                          : n.return(null))
                    : n.return(i);
                });
              }
              function Tc(e, t, r, i) {
                var n = t.width || 0,
                  a = t.height || 0,
                  s = n / i.columns,
                  o = a / i.rows,
                  l = i.columns * i.rows,
                  u = e.j - e.startTime;
                u = e.B || u / l;
                var d = e.startTime,
                  h = 0,
                  c = 0;
                return (
                  l > 1 &&
                    ((c = Math.floor((r - e.startTime) / u)),
                    (d = e.startTime + c * u),
                    (h = (c % i.columns) * s),
                    (c = Math.floor(c / i.columns) * o)),
                  (i = !1),
                  (r = e.thumbnailSprite) &&
                    ((i = !0), (o = r.height), (h = r.positionX), (c = r.positionY), (s = r.width)),
                  {
                    segment: e,
                    imageHeight: a,
                    imageWidth: n,
                    height: o,
                    positionX: h,
                    positionY: c,
                    startTime: d,
                    duration: u,
                    uris: e.P(),
                    startByte: e.Jc(),
                    endByte: e.Hc(),
                    width: s,
                    sprite: i,
                    mimeType: e.mimeType || t.mimeType,
                    codecs: e.codecs || t.codecs,
                  }
                );
              }
              function bc(e, t) {
                (e.j.D(t, "cuechange", function () {
                  e.u.remove(0, Math.max(0, e.h.currentTime - e.g.streaming.bufferBehind));
                  for (
                    var r = { periodStart: 0, segmentStart: 0, segmentEnd: e.h.duration, vttOffset: 0 },
                      i = [],
                      n = Array.from(t.activeCues || []),
                      a = (n = g(n)).next();
                    !a.done;
                    a = n.next()
                  ) {
                    if ((a = a.value).endTime === 1 / 0 || a.endTime < a.startTime) a = null;
                    else {
                      var s = new kr(a.startTime, a.endTime, a.text);
                      ((s.line = "number" == typeof a.line ? a.line : null),
                        a.lineAlign && (s.lineAlign = a.lineAlign),
                        (s.lineInterpretation = a.snapToLines ? jr : 1),
                        (s.position = "number" == typeof a.position ? a.position : null),
                        a.positionAlign && (s.positionAlign = a.positionAlign),
                        (s.size = a.size),
                        (s.textAlign = a.align),
                        "lr" === a.vertical
                          ? (s.writingMode = "vertical-lr")
                          : "rl" === a.vertical && (s.writingMode = "vertical-rl"),
                        a.region &&
                          ((s.region.id = a.region.id),
                          (s.region.height = a.region.lines),
                          (s.region.heightUnits = 2),
                          (s.region.regionAnchorX = a.region.regionAnchorX),
                          (s.region.regionAnchorY = a.region.regionAnchorY),
                          (s.region.scroll = a.region.scroll),
                          (s.region.viewportAnchorX = a.region.viewportAnchorX),
                          (s.region.viewportAnchorY = a.region.viewportAnchorY),
                          (s.region.viewportAnchorUnits = Nt),
                          (s.region.width = a.region.width),
                          (s.region.widthUnits = Nt)),
                        Lr(s),
                        (a = s));
                    }
                    a && ((s = e.g.mediaSource.modifyCueCallback) && s(a, null, r), i.push(a));
                  }
                  e.u.append(i);
                }),
                  (t.mode = document.pictureInPictureElement ? "showing" : "hidden"));
              }
              function Sc(e) {
                return Array.from(e.h.textTracks).filter(function (e) {
                  return "metadata" != e.kind && "chapters" != e.kind && "Shaka Player TextTrack" != e.label;
                });
              }
              function Ec(e) {
                if (!e.h || !e.h.currentTime) return null;
                var t = e.li();
                return t ? Math.floor(Date.now() - (t.getTime() + 1e3 * e.h.currentTime)) : null;
              }
              function xc(e, t) {
                var r;
                return D(function (i) {
                  switch (i.g) {
                    case 1:
                      return (E(i, 2), b(i, su(t, e.N, e.g.streaming.retryParameters), 4));
                    case 4:
                      ((r = i.h), w(i, 3));
                      break;
                    case 2:
                      A(i);
                    case 3:
                      if (r) return i.return(r);
                      throw new ze(1, 2, 2011, t);
                  }
                });
              }
              function wc(e, t) {
                var i, n, a, s;
                return D(function (o) {
                  if (1 == o.g) {
                    ((i = qn), (n = e.g.streaming.retryParameters), ((a = Vn([t], n)).method = "GET"));
                    var l = e.K;
                    try {
                      l.g.enabled && nh(l, a, { ot: bh, su: !0 });
                    } catch (r) {
                      q("CMCD_TEXT_ERROR", "Could not generate text CMCD data.", r);
                    }
                    return b(o, e.N.request(i, a).promise, 2);
                  }
                  return ((s = o.h), o.return(s.data));
                });
              }
              function Ac(e, t, r, i) {
                var n = Si(r);
                if (n)
                  return (
                    (r = n()),
                    (e = { periodStart: 0, segmentStart: 0, segmentEnd: e.h.duration, vttOffset: 0 }),
                    (t = Oe(t)),
                    (function (e, t) {
                      function r(e) {
                        for (var r = e, i = g(t), n = i.next(); !n.done; n = i.next())
                          (n = n.value).end && n.start < e && (r += n.end - n.start);
                        return (
                          ((e = Math.floor(r / 3600)) < 10 ? "0" : "") +
                          e +
                          ":" +
                          ((i = Math.floor((r / 60) % 60)) < 10 ? "0" : "") +
                          i +
                          ":" +
                          ((n = Math.floor(r % 60)) < 10 ? "0" : "") +
                          n +
                          "." +
                          ((r = Math.floor((1e3 * r) % 1e3)) < 100 ? (r < 10 ? "00" : "0") : "") +
                          r
                        );
                      }
                      var i = Od(e);
                      e = "WEBVTT\n\n";
                      for (var n = (i = g(i)).next(); !n.done; n = i.next())
                        ((e +=
                          r((n = n.value).startTime) +
                          " --\x3e " +
                          r(n.endTime) +
                          (function (e) {
                            var t = [];
                            switch (e.textAlign) {
                              case "left":
                                t.push("align:left");
                                break;
                              case "right":
                                t.push("align:right");
                                break;
                              case Or:
                                t.push("align:middle");
                                break;
                              case "start":
                                t.push("align:start");
                                break;
                              case "end":
                                t.push("align:end");
                            }
                            switch (e.writingMode) {
                              case "vertical-lr":
                                t.push("vertical:lr");
                                break;
                              case "vertical-rl":
                                t.push("vertical:rl");
                            }
                            return t.length ? " " + t.join(" ") : "";
                          })(n) +
                          "\n"),
                          (e += n.payload + "\n\n"));
                      return e;
                    })((t = r.parseMedia(t, e, null, [])), i)
                  );
                throw new ze(2, 2, 2014, r);
              }
              function Ic(e) {
                var t = td();
                return (
                  (t.streaming.failureCallback = function (t) {
                    if (e.W()) {
                      var r = null;
                      (1001 == t.code || 1002 == t.code
                        ? ((r = 1), e.g.streaming.lowLatencyMode && (r = 0.1))
                        : 1003 == t.code && (r = 0.1),
                        null != r && ((t.severity = 1), e.kh(r)));
                    }
                  }),
                  (t.textDisplayFactory = function () {
                    if (e.Be) {
                      var t = e.h;
                      t = !(
                        t.webkitDisplayingFullscreen ||
                        (t.webkitPresentationMode && "inline" != t.webkitPresentationMode)
                      );
                    } else t = !1;
                    return t
                      ? new Kd(e.h, e.Be)
                      : "track" in document.createElement("track")
                        ? new $d(e)
                        : new Hd();
                  }),
                  t
                );
              }
              function kc(e) {
                var t = e.Rg();
                if (e.B && e.R && e.G) {
                  if (0 == e.g.streaming.rebufferingGoal) {
                    var r = e.M;
                    ((r.j = !1), Fl(r));
                  } else (((r = e.M).j = t), Fl(r));
                  if (
                    (e.K &&
                      ((r = e.K),
                      t || r.F || (r.F = !0),
                      r.F && t && ((r.I = !0), ih(r, "ps", { dd: "r" })),
                      (r.J = t)),
                    Cc(e),
                    (r = e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts),
                    e.g.streaming.liveSync.dynamicTargetLatency.enabled && t && e.Ne < r)
                  ) {
                    r = e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;
                    var i = e.g.streaming.liveSync.targetLatencyTolerance,
                      n = e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;
                    e.V && (e.V = Math.min(e.V + ++e.Ne * n, r - i));
                  }
                }
                ((t = new Map().set("buffering", t)), e.dispatchEvent(Zh("buffering", t)));
              }
              function Rc(e, t) {
                (e.dc.Qa(),
                  e.dc.D(e.h, "timeupdate", function () {
                    var r = e.h.currentTime,
                      i = e.Ra(),
                      n = e.W(),
                      a = n ? e.g.streaming.safeSeekOffset : 0;
                    t > 0
                      ? n && t > 1 && Math.floor(r) >= Math.floor(i.end) && e.Sd()
                      : Math.floor(r) <= Math.floor(i.start + a) && e.Sd();
                  }));
              }
              function Cc(e) {
                if (e.B && e.R) {
                  var t = e.B.g,
                    r = "playing";
                  e.R.g == Va ? (r = "buffering") : e.ge() ? (r = "ended") : e.h.paused && (r = "paused");
                  var i = r;
                  if (null == t.g) ((t.g = { timestamp: Date.now() / 1e3, state: i, duration: 0 }), (t = !0));
                  else {
                    var n = Date.now() / 1e3;
                    ((t.g.duration = n - t.g.timestamp),
                      t.g.state == i
                        ? (t = !1)
                        : (t.h.push(t.g), (t.g = { timestamp: n, state: i, duration: 0 }), (t = !0)));
                  }
                  t && ((r = new Map().set("newstate", r)), e.dispatchEvent(Zh("statechanged", r)));
                }
              }
              function Lc(e) {
                var t = e.h.playbackRate,
                  r = e.W();
                if (e.g.streaming.vodDynamicPlaybackRate && !r) {
                  var i = e.g.streaming.vodDynamicPlaybackRateLowBufferRate,
                    n = e.ei();
                  n <= e.g.streaming.vodDynamicPlaybackRateBufferRatio
                    ? t != i && e.xe(i, !1)
                    : 1 == n && t !== e.M.Tc() && e.Sd();
                }
                if (
                  r &&
                  ((r = e.Ra()), Number.isFinite(r.end) && !(e.h.currentTime < r.start || e.h.paused))
                ) {
                  ((i = e.g.streaming.liveSync.targetLatencyTolerance),
                    (n = e.g.streaming.liveSync.dynamicTargetLatency.enabled));
                  var a = e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;
                  if (e.g.streaming.liveSync && e.g.streaming.liveSync.enabled)
                    var s = e.g.streaming.liveSync.targetLatency,
                      o = s + i,
                      l = Math.max(0, s - i),
                      u = e.g.streaming.liveSync.maxPlaybackRate,
                      d = e.g.streaming.liveSync.minPlaybackRate;
                  else
                    e.i &&
                      e.i.serviceDescription &&
                      ((s = e.i.serviceDescription.targetLatency),
                      null != e.i.serviceDescription.targetLatency
                        ? (o = e.i.serviceDescription.targetLatency + i)
                        : null != e.i.serviceDescription.maxLatency &&
                          (o = e.i.serviceDescription.maxLatency),
                      null != e.i.serviceDescription.targetLatency
                        ? (l = Math.max(0, e.i.serviceDescription.targetLatency - i))
                        : null != e.i.serviceDescription.minLatency &&
                          (l = e.i.serviceDescription.minLatency),
                      (u = e.i.serviceDescription.maxPlaybackRate || e.g.streaming.liveSync.maxPlaybackRate),
                      (d = e.i.serviceDescription.minPlaybackRate || e.g.streaming.liveSync.minPlaybackRate));
                  e.V || "number" != typeof s || (e.V = s);
                  var h = e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;
                  (n &&
                    e.cc &&
                    null !== e.V &&
                    "number" == typeof s &&
                    e.Ne < h &&
                    Date.now() - e.cc > 1e3 * a &&
                    ((a = e.g.streaming.liveSync.dynamicTargetLatency.minLatency),
                    (e.V = Math.max(e.V - (s - a) / 2, a + i)),
                    (e.cc = Date.now())),
                    n && null !== e.V && ((o = e.V + i), (l = e.V - i)),
                    (s = r.end - e.h.currentTime),
                    (i = 0),
                    e.m == af &&
                      (n = e.h.buffered).length > 0 &&
                      ((i = n.end(n.length - 1)), (i = Math.max(u, i - r.end))),
                    (r = e.g.streaming.liveSync.panicMode),
                    (n = 1e3 * e.g.streaming.liveSync.panicThreshold),
                    (a = Date.now() - e.R.i),
                    r && !d && (d = e.g.streaming.liveSync.minPlaybackRate),
                    r && d && a <= n
                      ? t != d && e.xe(d, !1)
                      : null != o && u && s - i > o
                        ? (t != u && e.xe(u, !1), (e.cc = null))
                        : null != l && d && s - i < l
                          ? (t != d && e.xe(d, !1), (e.cc = null))
                          : t !== e.M.Tc() && (e.Sd(), (e.cc = Date.now())));
                }
              }
              function Mc(e) {
                if (e.h) {
                  var t = function (t, r) {
                      return !!((Yh(t, r, 0.01) || r > t) && e.ag < t) && ((e.ag = t), !0);
                    },
                    r = e.Ra();
                  if (((r = (r = r.end - r.start) > 0 ? e.h.currentTime / r : 0), !isNaN(r))) {
                    if (t(0, (r *= 100))) var i = Zh("started");
                    else
                      t(25, r)
                        ? (i = Zh("firstquartile"))
                        : t(50, r)
                          ? (i = Zh("midpoint"))
                          : t(75, r)
                            ? (i = Zh("thirdquartile"))
                            : ((t(100, r) || r > 100) && (i = Zh("complete")),
                              e.g && e.g.playRangeEnd != 1 / 0 && e.ge() && e.h.pause());
                    i && e.dispatchEvent(i);
                  }
                }
              }
              function Dc(e) {
                try {
                  Ya(e.Ee, e.i);
                } catch (r) {
                  return (zc(e, r), !1);
                }
                var t = ln(e.i.variants);
                return (
                  (t = e.J.create(t)),
                  "boolean" != typeof (e = e.o.setVariants(Array.from(t.values()))) || e
                );
              }
              function _c(e, t) {
                if (((t = void 0 !== t && t), Dc(e))) {
                  if (!e.g.abr.enabled) {
                    var r = e.J;
                    if (
                      ("function" != typeof r.getLastAdaptationSet &&
                        (he(
                          "AdaptationSetCriteria w/o getLastAdaptationSet",
                          "Please use an AdaptationSetCriteria with getLastAdaptationSet.",
                        ),
                        (r.getLastAdaptationSet = function () {
                          return null;
                        })),
                      (r = r.getLastAdaptationSet()) && (r = Array.from(r.values())).length)
                    ) {
                      var i = e.l.o;
                      if (
                        i &&
                        i.video &&
                        (r = r.find(function (e) {
                          return e.video == i.video;
                        }))
                      )
                        return r;
                    }
                  }
                  return e.o.chooseVariant(t);
                }
                return null;
              }
              function Pc(e, t, r, i, n) {
                ((t = void 0 === t || t),
                  (r = void 0 === r ? 0 : r),
                  (i = void 0 !== i && i),
                  (n = void 0 === n || n));
                var a = _c(e);
                a && Oc(e, a, n, t, r, i);
              }
              function Oc(e, t, r, i, n, a) {
                a = void 0 !== a && a;
                var s = e.l.o;
                if (t == s) i && cu(e.l, t, i, n, !0);
                else {
                  var o = e.B.h;
                  if (
                    (o.h != t &&
                      ((o.h = t),
                      o.g.push({
                        timestamp: Date.now() / 1e3,
                        id: t.id,
                        type: "variant",
                        fromAdaptation: r,
                        bandwidth: t.bandwidth,
                      })),
                    cu(e.l, t, i, n, a, r),
                    (i = null),
                    s && (i = en(s)),
                    ((s = en(t)).active = !0),
                    e.T && ((n = e.T), (t = t.video)))
                  ) {
                    switch ((t.dependencyStream && (t = t.dependencyStream), (a = 0), (o = -1), t.mimeType)) {
                      case "video/webm":
                        a = 1;
                        break;
                      case "video/mp4":
                        a = 2;
                    }
                    switch (e.ii()) {
                      case "DASH":
                        o = 1;
                        break;
                      case "HLS":
                        o = 0;
                    }
                    n.g &&
                      (n.g.setLevelSwitching(t.id, !0),
                      n.g.setContainerFormat(a),
                      n.j || n.g.setStreamingFormat(o));
                  }
                  (r
                    ? Jc(e, (r = Zh("adaptation", (r = new Map().set("oldTrack", i).set("newTrack", s)))))
                    : Bc(e, i, s),
                    $c(e, i, s));
                }
              }
              function Nc(e, t) {
                var r = Array.from(e.h.audioTracks).find(function (e) {
                  return e.enabled;
                });
                if (((t.enabled = !0), r)) {
                  t.id !== r.id && (r.enabled = !1);
                  var i = Fc(e);
                  (Bc(e, (r = sn(r, i)), (t = sn(t, i))), $c(e, r, t));
                }
              }
              function Fc(e) {
                return e.h && e.h.videoTracks
                  ? Array.from(e.h.videoTracks).find(function (e) {
                      return e.selected;
                    })
                  : null;
              }
              function Uc(e) {
                (Jc(e, Zh("trackschanged")), jc(e));
              }
              function Bc(e, t, r) {
                Jc(e, (t = Zh("variantchanged", (t = new Map().set("oldTrack", t).set("newTrack", r)))));
              }
              function $c(e, t, r) {
                var i = !1;
                ((t && t.audioId == r.audioId && t.audioGroupId == r.audioGroupId) || (i = !0), i && jc(e));
              }
              function jc(e) {
                Jc(e, Zh("audiotrackschanged"));
              }
              function Gc(e) {
                Jc(e, Zh("textchanged"));
              }
              function Vc(e) {
                Jc(e, Zh("texttrackvisibility"));
              }
              function Hc(e) {
                (e.g.abr.enabled || Wc(e),
                  Jc(e, Zh("abrstatuschanged", new Map().set("newStatus", e.g.abr.enabled))));
              }
              function Kc(e) {
                var t = e.Lc().find(function (e) {
                  return e.active;
                });
                t && e.u && e.u.setTextLanguage && e.u.setTextLanguage(t.language);
              }
              function Wc(e, t) {
                if (((t = void 0 === t || t), e.m == nf)) {
                  e.He.stop();
                  for (var r = g(e.i.variants), i = r.next(); !i.done; i = r.next())
                    i.value.disabledUntilTime = 0;
                  t && Dc(e);
                }
              }
              function zc(e, t) {
                var r, i, n, a;
                return D(function (s) {
                  switch (s.g) {
                    case 1:
                      if (e.m == tf) return s.return();
                      if (
                        (1 === t.severity && e.B.M++,
                        (r = !0),
                        !(e.Ua && e.i && e.l) ||
                          (3016 != t.code &&
                            3014 != t.code &&
                            3015 != t.code &&
                            3024 != t.code &&
                            3018 != t.code))
                      ) {
                        s.A(2);
                        break;
                      }
                      return "WEBKIT" === se().Ha() && 3016 == t.code
                        ? s.return()
                        : (E(s, 3), b(s, Pu(e.l), 5));
                    case 5:
                      ((i = s.h),
                        (r = !i),
                        i && ((n = Zh("mediasourcerecovered")), e.dispatchEvent(n)),
                        w(s, 2));
                      break;
                    case 3:
                      (A(s), (r = !0));
                    case 2:
                      if (!r) return s.return();
                      (2 === t.severity && Wc(e, !1),
                        (a = Zh("error", new Map().set("detail", t))),
                        e.dispatchEvent(a),
                        a.defaultPrevented && (t.handled = !0),
                        S(s));
                  }
                });
              }
              function qc(e, t, r, i) {
                ((i = void 0 === i ? e : i),
                  (e = new Map().set("detail", {
                    schemeIdUri: r.schemeIdUri,
                    value: r.value,
                    startTime: r.startTime,
                    endTime: r.endTime,
                    id: r.id,
                    timescale: r.timescale,
                    eventElement: r.eventElement,
                    eventNode: r.eventNode,
                  })),
                  i.dispatchEvent(Zh(t, e)));
              }
              function Xc(e, t, r, i) {
                ((i = void 0 !== i && i),
                  (t = new Map()
                    .set("mediaQuality", {
                      bandwidth: t.bandwidth,
                      audioSamplingRate: t.audioSamplingRate,
                      codecs: t.codecs,
                      contentType: t.contentType,
                      frameRate: t.frameRate,
                      height: t.height,
                      mimeType: t.mimeType,
                      channelsCount: t.channelsCount,
                      pixelAspectRatio: t.pixelAspectRatio,
                      width: t.width,
                      label: t.label,
                      roles: t.roles,
                      language: t.language,
                    })
                    .set("position", r)),
                  e.dispatchEvent(Zh(i ? "audiotrackchanged" : "mediaqualitychanged", t)));
              }
              function Yc(e, t) {
                if (((t = void 0 === t || t), !e.h.error)) return t ? new ze(2, 3, 3016) : null;
                var r = e.h.error.code;
                return t || 1 != r
                  ? ((t = e.h.error.msExtendedCode) && (t < 0 && (t += 4294967296), (t = t.toString(16))),
                    new ze(2, 3, 3016, r, t, e.h.error.message))
                  : null;
              }
              function Qc(e, t, r) {
                (t > 0 && (e.W() || e.Yi(t)), r < (t = e.getDuration()) && (e.W() || e.Ab(r)));
              }
              function Jc(e, t) {
                D(function (r) {
                  if (1 == r.g) return b(r, Promise.resolve(), 2);
                  (e.m != tf && e.dispatchEvent(t), S(r));
                });
              }
              function Zc(e) {
                for (var t = new Set(), r = (e = g(e)).next(); !r.done; r = e.next())
                  (r = r.value).language ? t.add(Fi(r.language)) : t.add("und");
                return t;
              }
              function ef(e) {
                for (var t = new Map(), r = new Map(), i = 0; i < e.length; i++) {
                  var n = e[i],
                    a = "und",
                    s = [];
                  (n.language && (a = Fi(n.language)),
                    ((s = "variant" == n.type ? n.audioRoles : n.roles) && s.length) || (s = [""]),
                    t.has(a) || t.set(a, new Set()));
                  for (var o = (s = g(s)).next(); !o.done; o = s.next())
                    ((o = o.value),
                      t.get(a).add(o),
                      n.label && (r.has(a) || r.set(a, new Map()), r.get(a).set(o, n.label)));
                }
                var l = [];
                return (
                  t.forEach(function (e, t) {
                    for (var i = (e = g(e)).next(); !i.done; i = e.next()) {
                      i = i.value;
                      var n = null;
                      (r.has(t) && r.get(t).has(i) && (n = r.get(t).get(i)),
                        l.push({ language: t, role: i, label: n }));
                    }
                  }),
                  l
                );
              }
              ((qh.prototype.release = function () {
                this.h.length > 0 ? this.h.shift()() : (this.g = null);
              }),
                f(Qh, Fn),
                ((n = Qh.prototype).destroy = function () {
                  var e,
                    t = this;
                  return D(function (r) {
                    switch (r.g) {
                      case 1:
                        return t.m == tf ? r.return() : (Jh(t), (e = t.detach()), (t.m = tf), b(r, e, 2));
                      case 2:
                        return b(r, t.rg(), 3);
                      case 3:
                        if (
                          (t.Le && (t.Le.release(), (t.Le = null)),
                          t.Ce && (t.Ce.release(), (t.Ce = null)),
                          t.j && (t.j.release(), (t.j = null)),
                          t.dc && (t.dc.release(), (t.dc = null)),
                          t.Gd && (t.Gd.release(), (t.Gd = null)),
                          (t.Ge = null),
                          (t.g = null),
                          (t.B = null),
                          (t.Be = null),
                          (t.K = null),
                          (t.va = null),
                          !t.N)
                        ) {
                          r.A(4);
                          break;
                        }
                        return b(r, t.N.destroy(), 5);
                      case 5:
                        t.N = null;
                      case 4:
                        (t.o && (t.o.release(), (t.o = null)),
                          t.Da && (t.Da.destroy(), (t.Da = null)),
                          Fn.prototype.release.call(t),
                          S(r));
                    }
                  });
                }),
                (n.Vb = function (e, t) {
                  t = void 0 === t || t;
                  var r,
                    i,
                    n,
                    a = this;
                  return D(function (s) {
                    switch (s.g) {
                      case 1:
                        if (a.m == tf) throw new ze(2, 7, 7e3);
                        if (((r = a.h && a.h == e), !a.h || a.h == e)) {
                          s.A(2);
                          break;
                        }
                        return b(s, a.detach(), 2);
                      case 2:
                        return b(s, rc(a, "attach"), 4);
                      case 4:
                        if (s.h) return s.return();
                        if (
                          (E(s, 5, 6),
                          r ||
                            (tc(a, "attach"),
                            (i = function () {
                              var e = Yc(a, !1);
                              e && zc(a, e);
                            }),
                            a.Ce.D(e, "error", i),
                            (a.h = e),
                            a.K && a.K.setMediaElement(e)),
                          se(),
                          !t || !Qv() || a.H)
                        ) {
                          s.A(6);
                          break;
                        }
                        return b(s, lc(a), 6);
                      case 6:
                        (I(s), a.ba.release(), k(s, 0));
                        break;
                      case 5:
                        return ((n = A(s)), b(s, a.detach(), 10));
                      case 10:
                        throw n;
                    }
                  });
                }),
                (n.qj = function (e) {
                  this.Ph = e;
                }),
                (n.detach = function (e) {
                  e = void 0 !== e && e;
                  var t = this;
                  return D(function (r) {
                    if (1 == r.g) {
                      if (t.m == tf) throw new ze(2, 7, 7e3);
                      return b(r, t.Cc(!1, e), 2);
                    }
                    if (3 != r.g) return b(r, rc(t, "detach"), 3);
                    if (r.h) return r.return();
                    try {
                      (t.h && (t.Ce.Qa(), (t.h = null)), tc(t, "detach"), t.C && !e && t.C.release());
                    } finally {
                      t.ba.release();
                    }
                    S(r);
                  });
                }),
                (n.Cc = function (t, r) {
                  ((t = void 0 === t || t), (r = void 0 !== r && r));
                  var i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    m,
                    v,
                    y,
                    T = this;
                  return D(function (S) {
                    switch (S.g) {
                      case 1:
                        return (T.m != tf && (T.m = rf), b(S, rc(T, "unload"), 2));
                      case 2:
                        return S.h
                          ? S.return()
                          : (x(S, 3),
                            (T.Ua = !1),
                            tc(T, "unload"),
                            Jh(T),
                            (i = T.De.map(function (e) {
                              return e();
                            })),
                            (T.De = []),
                            b(S, Promise.all(i), 5));
                      case 5:
                        if (
                          (T.dispatchEvent(Zh("unloading")),
                          T.Ae && (T.Ae.release(), (T.Ae = null)),
                          T.za && (T.za.release(), (T.za = null)),
                          T.kb && (T.kb.release(), (T.kb = null)),
                          T.h && (T.j.Qa(), T.dc.Qa()),
                          T.He.stop(),
                          T.ac && (T.ac.release(), (T.ac = null)),
                          T.Ta && (T.Ta.stop(), (T.Ta = null)),
                          !T.I)
                        ) {
                          S.A(6);
                          break;
                        }
                        return b(S, T.I.stop(), 7);
                      case 7:
                        ((T.I = null), (T.zc = null));
                      case 6:
                        if ((T.o && T.o.stop(), !T.l)) {
                          S.A(8);
                          break;
                        }
                        return b(S, T.l.destroy(), 9);
                      case 9:
                        T.l = null;
                      case 8:
                        if (
                          (T.M && (T.M.release(), (T.M = null)),
                          T.G && (T.G.release(), (T.G = null)),
                          "webkit" !== e.shakaMediaKeysPolyfill || !T.F)
                        ) {
                          S.A(10);
                          break;
                        }
                        return b(S, T.F.destroy(), 11);
                      case 11:
                        T.F = null;
                      case 10:
                        if (!T.H) {
                          S.A(12);
                          break;
                        }
                        return b(S, T.H.destroy(), 13);
                      case 13:
                        T.H = null;
                      case 12:
                        if (
                          (T.C && !r && T.C.onAssetUnload(),
                          T.oa && !r && (T.oa.destroy(), (T.oa = null)),
                          r || T.eg.stop(),
                          T.K &&
                            (function (e) {
                              (e.m.clear(),
                                (e.F = !1),
                                (e.J = !0),
                                (e.I = !1),
                                (e.u = !1),
                                (e.B = 0),
                                (e.C = 0),
                                (e.H = 0),
                                (e.K = { request: !1, response: !1, event: !1 }),
                                Zd(e),
                                (e.o = {}),
                                (e.h = null),
                                e.i.Qa());
                            })(T.K),
                          T.va && (T.va.g = null),
                          !T.u)
                        ) {
                          S.A(14);
                          break;
                        }
                        return b(S, T.u.destroy(), 15);
                      case 15:
                        T.u = null;
                      case 14:
                        if (((T.$ = !1), T.h)) {
                          for (n = g(T.cg), a = n.next(); !a.done; a = n.next())
                            ((s = a.value).src.startsWith("blob:") && URL.revokeObjectURL(s.src), s.remove());
                          ((T.cg = []), Js(T.h) && T.h.load());
                        }
                        if (!T.F) {
                          S.A(16);
                          break;
                        }
                        return b(S, T.F.destroy(), 17);
                      case 17:
                        T.F = null;
                      case 16:
                        if (
                          (T.eb && T.X != T.eb.rd() && (T.eb.l || T.eb.destroy(), (T.eb = null)),
                          (T.X = null),
                          (T.Fa = null),
                          (T.R = null),
                          T.i)
                        ) {
                          for (o = g(T.i.variants), l = o.next(); !l.done; l = o.next())
                            for (u = l.value, d = g([u.audio, u.video]), h = d.next(); !h.done; h = d.next())
                              (c = h.value) && c.segmentIndex && c.segmentIndex.release();
                          for (f = g(T.i.textStreams), p = f.next(); !p.done; p = f.next())
                            (m = p.value).segmentIndex && m.segmentIndex.release();
                        }
                        for (
                          T.g && T.g.streaming.clearDecodingCache && (mn.clear(), We.clear()),
                            T.i = null,
                            T.B = new dd(),
                            T.Oh = null,
                            T.cc = null,
                            T.V = null,
                            T.Ne = -1,
                            T.Ke = [],
                            v = g(T.yc.values()),
                            y = v.next();
                          !y.done;
                          y = v.next()
                        )
                          y.value.stop();
                        (T.yc.clear(), (T.ob = []), (T.ag = -1), T.N && T.N.Wh(), kc(T));
                      case 3:
                        (I(S), T.ba.release(), k(S, 4));
                        break;
                      case 4:
                        if ((se(), t && Qv() && !T.H && T.h)) return b(S, lc(T), 0);
                        S.A(0);
                    }
                  });
                }),
                (n.ql = function (e) {
                  this.O = e;
                }),
                (n.load = function (t, r, i) {
                  r = void 0 === r ? null : r;
                  var n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    m,
                    v,
                    y,
                    T = this;
                  return D(function (w) {
                    switch (w.g) {
                      case 1:
                        if (T.m == tf) throw new ze(2, 7, 7e3);
                        if (T.h || !T.ma) {
                          w.A(2);
                          break;
                        }
                        return b(w, T.Vb(T.ma, !0), 3);
                      case 3:
                        T.ma = null;
                      case 2:
                        if (((n = null), (a = ""), t instanceof pd)) {
                          if (t.l) throw new ze(2, 7, 7006);
                          a = (n = t).rd() || "";
                        } else a = t || "";
                        return b(w, Xh(T.ba, "load"), 4);
                      case 4:
                        if ((T.ba.release(), !T.h)) throw new ze(2, 7, 7002);
                        if (!T.X) {
                          w.A(5);
                          break;
                        }
                        return ((T.X = a), b(w, T.Cc(!1), 5));
                      case 5:
                        if (
                          ((s = ++T.Me),
                          (o = function () {
                            return D(function (e) {
                              if (1 == e.g) return T.Me == s ? e.A(0) : n ? b(e, n.destroy(), 3) : e.A(3);
                              throw new ze(2, 7, 7e3);
                            });
                          }),
                          (l = function (e, t) {
                            return D(function (r) {
                              switch (r.g) {
                                case 1:
                                  return (x(r, 2), b(r, Xh(T.ba, t), 4));
                                case 4:
                                  return b(r, o(), 5);
                                case 5:
                                  return b(r, e(), 6);
                                case 6:
                                  return b(r, o(), 7);
                                case 7:
                                  n && T.g && (n.g = T.g);
                                case 2:
                                  (I(r), T.ba.release(), k(r, 0));
                              }
                            });
                          }),
                          E(w, 7, 8),
                          null == r && n && (r = n.getStartTime()),
                          (T.O = r),
                          (T.Ua = !1),
                          T.dispatchEvent(Zh("loading")),
                          n)
                        ) {
                          ((i = n.V), w.A(10));
                          break;
                        }
                        if (i) {
                          w.A(10);
                          break;
                        }
                        return b(
                          w,
                          l(function () {
                            return D(function (e) {
                              if (1 == e.g) return b(e, sc(T, a), 2);
                              ((i = e.h), S(e));
                            });
                          }, "guessMimeType_"),
                          10,
                        );
                      case 10:
                        if (((u = !!n), n)) {
                          (md(n, T), (T.B = n.getStats()), w.A(13));
                          break;
                        }
                        return b(w, nc(T, a, r, i, !0, T.g), 14);
                      case 14:
                        (n = w.h)
                          ? ((n.F = !1), md(n, T), (T.B = n.getStats()), n.start(), n.B.catch(function () {}))
                          : (T.B = new dd());
                      case 13:
                        return (
                          (d = !n),
                          (h = Date.now() / 1e3),
                          (T.B = n ? n.getStats() : new dd()),
                          (T.X = a),
                          (T.Fa = i || null),
                          kc(T),
                          (c = function () {
                            var e = T.h ? T.h.buffered : null;
                            return { start: Ks(e) || 0, end: Ws(e) || 0 };
                          }),
                          (T.za = new Vl(c)),
                          T.za.addEventListener("regionadd", function (e) {
                            dc(T, e.region, "metadataadded");
                          }),
                          d
                            ? b(
                                w,
                                l(function () {
                                  return D(function (e) {
                                    return b(
                                      e,
                                      (function (e, t) {
                                        var r, i, n;
                                        return D(function (a) {
                                          return 1 == a.g
                                            ? ((r = Date.now() / 1e3),
                                              (i = !0),
                                              (e.F = e.md({
                                                vc: e.N,
                                                onError: function (t) {
                                                  zc(e, t);
                                                },
                                                zf: function () {},
                                                onExpirationUpdated: function () {
                                                  var t = Zh("expirationupdated");
                                                  e.dispatchEvent(t);
                                                },
                                                onEvent: function (t) {
                                                  (e.dispatchEvent(t),
                                                    "drmsessionupdate" == t.type &&
                                                      i &&
                                                      ((i = !1), (e.B.m = Date.now() / 1e3 - r)));
                                                },
                                              })),
                                              e.F.configure(e.g.drm),
                                              (n = gn([t])),
                                              (e.F.O = !0),
                                              b(a, Ta(e.F, [n], []), 2))
                                            : b(a, e.F.Vb(e.h), 0);
                                        });
                                      })(T, i),
                                      0,
                                    );
                                  });
                                }, "initializeSrcEqualsDrmInner_"),
                                25,
                              )
                            : ((T.kb = new Vl(c)),
                              b(
                                w,
                                l(function () {
                                  return D(function (e) {
                                    if (1 == e.g) return b(e, Promise.race([n.ma, n.B]), 2);
                                    T.zc = n.H;
                                    var t = n;
                                    ((t.oa = !0), (T.I = t.m), (T.i = n.Lg()), S(e));
                                  });
                                }, "waitForFinish"),
                                17,
                              ))
                        );
                      case 17:
                        if (T.H) {
                          w.A(18);
                          break;
                        }
                        return b(
                          w,
                          l(function () {
                            return D(function (e) {
                              return b(e, lc(T), 0);
                            });
                          }, "initializeMediaSourceEngineInner_"),
                          18,
                        );
                      case 18:
                        return (
                          T.i &&
                            T.i.textStreams.length &&
                            (T.u.enableTextDisplayer
                              ? T.u.enableTextDisplayer()
                              : he(
                                  "Text displayer w/ enableTextDisplayer",
                                  'Text displayer should have a "enableTextDisplayer" method!',
                                )),
                          b(
                            w,
                            l(function () {
                              return D(function (e) {
                                return b(e, n.B, 0);
                              });
                            }, "waitForFinish"),
                            20,
                          )
                        );
                      case 20:
                        if (
                          ((T.g = n.getConfiguration()),
                          (T.Ee = n.G),
                          T.I && T.I.setMediaElement && T.h && T.I.setMediaElement(T.h),
                          (T.Ae = (function (e) {
                            return ((e.va = !0), e.I);
                          })(n)),
                          (T.ye = n.Fa),
                          (f = n.C) && (T.J = f),
                          u &&
                            T.h &&
                            "AUDIO" === T.h.nodeName &&
                            ((function (e) {
                              for (var t = g(e.i.variants), r = t.next(); !r.done; r = t.next())
                                ((r = r.value).video && (r.video.closeSegmentIndex(), (r.video = null)),
                                  (r.bandwidth = r.audio && r.audio.bandwidth ? r.audio.bandwidth : 0));
                              e.i.variants = e.i.variants.filter(function (e) {
                                return e.audio;
                              });
                            })(T),
                            T.configure("manifest.disableVideo", !0)),
                          n.j)
                        ) {
                          w.A(21);
                          break;
                        }
                        return b(
                          w,
                          l(function () {
                            return D(function (e) {
                              return b(e, Td(n, T.h), 0);
                            });
                          }, "drmEngine_.init"),
                          21,
                        );
                      case 21:
                        return (
                          (T.F = (function (e) {
                            return ((e.ba = !0), e.j);
                          })(n)),
                          b(
                            w,
                            l(function () {
                              return D(function (e) {
                                return b(e, T.F.Vb(T.h), 0);
                              });
                            }, "drmEngine_.attach"),
                            23,
                          )
                        );
                      case 23:
                        return (
                          (p = T.g.abrFactory),
                          (T.o && T.Ge == p) ||
                            ((T.Ge = p),
                            T.o && T.o.release(),
                            (T.o = p()),
                            "function" != typeof T.o.setMediaElement &&
                              (he(
                                "AbrManager w/o setMediaElement",
                                "Please use an AbrManager with setMediaElement function.",
                              ),
                              (T.o.setMediaElement = function () {})),
                            "function" != typeof T.o.setCmsdManager &&
                              (he(
                                "AbrManager w/o setCmsdManager",
                                "Please use an AbrManager with setCmsdManager function.",
                              ),
                              (T.o.setCmsdManager = function () {})),
                            "function" != typeof T.o.trySuggestStreams &&
                              (he(
                                "AbrManager w/o trySuggestStreams",
                                "Please use an AbrManager with trySuggestStreams function.",
                              ),
                              (T.o.trySuggestStreams = function () {})),
                            T.o.configure(T.g.abr)),
                          (m = (function (e) {
                            return ((e.ya = !0), e.M);
                          })(n)),
                          (v = n.i),
                          b(
                            w,
                            l(function () {
                              return D(function (t) {
                                return b(
                                  t,
                                  (function (t, r, i, n) {
                                    var a,
                                      s,
                                      o,
                                      l,
                                      u,
                                      d,
                                      h,
                                      c,
                                      f,
                                      p,
                                      m,
                                      v,
                                      y,
                                      T,
                                      E,
                                      x,
                                      w,
                                      A,
                                      I,
                                      k,
                                      R,
                                      C,
                                      L,
                                      M,
                                      _,
                                      P,
                                      O;
                                    return D(function (N) {
                                      switch (N.g) {
                                        case 1:
                                          (tc(t, "load"),
                                            (a = t.h),
                                            (t.M = new Nl({
                                              cf: function () {
                                                return a.playbackRate;
                                              },
                                              Tc: function () {
                                                return a.defaultPlaybackRate;
                                              },
                                              uh: function (e) {
                                                a.playbackRate = e;
                                              },
                                              Di: function (e) {
                                                a.currentTime += e;
                                              },
                                            })),
                                            uc(t, a, r),
                                            "onchange" in e.screen &&
                                              t.j.D(e.screen, "change", function () {
                                                if (t.J.getConfiguration) {
                                                  var e = t.J.getConfiguration();
                                                  "AUTO" == e.hdrLevel
                                                    ? Dc(t)
                                                    : "AUTO" == t.g.preferredVideoHdrLevel &&
                                                      t.g.abr.enabled &&
                                                      ((e.hdrLevel = "AUTO"), t.J.configure(e), Dc(t));
                                                }
                                              }),
                                            (s = !1),
                                            (o = g(t.i.variants)));
                                          for (l = o.next(); !l.done; l = o.next())
                                            ((u = l.value),
                                              (d = u.video && u.video.dependencyStream) && (s = Et(d)));
                                          (!(function (e, t, r) {
                                            r || t.lcevc.enabled
                                              ? (Jh(e),
                                                null == e.T &&
                                                  ((e.T = new Tt(e.h, e.Ph, t.lcevc, r)),
                                                  e.H && (e.H.C = e.T)))
                                              : Jh(e);
                                          })(t, t.g, s),
                                            (t.Kd = t.g.preferredTextLanguage),
                                            (t.Od = t.g.preferredTextRole),
                                            (t.Nd = t.g.preferForcedSubs),
                                            Qc(
                                              t.i.presentationTimeline,
                                              t.g.playRangeStart,
                                              t.g.playRangeEnd,
                                            ),
                                            t.o.init(function (e, r, i) {
                                              t.i &&
                                                t.l &&
                                                e != t.l.o &&
                                                Oc(t, e, !0, void 0 !== r && r, void 0 === i ? 0 : i);
                                            }),
                                            t.o.setMediaElement(a),
                                            t.o.setCmsdManager(t.va),
                                            (t.l = (function (e) {
                                              return new du(e.i, {
                                                nc: function () {
                                                  return e.G ? e.G.Qd() : 0;
                                                },
                                                getBandwidthEstimate: function () {
                                                  return e.o.getBandwidthEstimate();
                                                },
                                                Ob: function () {
                                                  return e.Ob();
                                                },
                                                video: e.h,
                                                Z: e.H,
                                                vc: e.N,
                                                onError: function (t) {
                                                  return zc(e, t);
                                                },
                                                onEvent: function (t) {
                                                  return e.dispatchEvent(t);
                                                },
                                                zd: function (t, r, i, n) {
                                                  var a = t.startTime,
                                                    s = t.endTime,
                                                    o = r.type;
                                                  if (o != gt) {
                                                    if (e.G) {
                                                      e.G.Fi();
                                                      var l = Uo(e.H, o);
                                                      !e.W() &&
                                                        e.h.paused &&
                                                        !e.h.seeking &&
                                                        null != l &&
                                                        l > 0 &&
                                                        e.G.Qd() < l &&
                                                        !Yh(e.G.Qd(), l, 0.001) &&
                                                        e.G.$f(l);
                                                    }
                                                    gc(e);
                                                  }
                                                  ((i = new Map()
                                                    .set("start", a)
                                                    .set("end", s)
                                                    .set("contentType", o)
                                                    .set("isMuxed", i)
                                                    .set("isDependency", n)),
                                                    e.dispatchEvent(Zh("segmentappended", i)),
                                                    e.o &&
                                                      r.fastSwitching &&
                                                      t.Xc &&
                                                      t.je &&
                                                      e.o.trySuggestStreams());
                                                },
                                                Fk: function (t, r) {
                                                  (r = r.xd) &&
                                                    e.ye &&
                                                    (function (e, t, r) {
                                                      var i = (function (e, t) {
                                                        var r = e.g.get(t);
                                                        return (
                                                          r ||
                                                            ((r = { re: [], pg: null, contentType: t }),
                                                            e.g.set(t, r)),
                                                          r
                                                        );
                                                      })(e, t.contentType);
                                                      (!(function (e, t) {
                                                        if ((e = e.h()[t.contentType]) && e.length > 0) {
                                                          var r = e[0].start,
                                                            i = e[e.length - 1].end,
                                                            n = t.re;
                                                          t.re = n.filter(function (e, t) {
                                                            return !(
                                                              (e.position <= r &&
                                                                t + 1 < n.length &&
                                                                n[t + 1].position <= r) ||
                                                              e.position >= i
                                                            );
                                                          });
                                                        } else t.re = [];
                                                      })(e, i),
                                                        (e = { xd: t, position: r }),
                                                        (t = (i = i.re).findIndex(function (e) {
                                                          return e.position >= r;
                                                        })) >= 0
                                                          ? i.splice(t, i[t].position == r ? 1 : 0, e)
                                                          : i.push(e));
                                                    })(e.ye, r, t);
                                                },
                                                Uh: function (t, r) {
                                                  var i = e.F;
                                                  if (
                                                    i.h.parseInbandPsshEnabled &&
                                                    !i.H &&
                                                    ["audio", "video"].includes(t)
                                                  ) {
                                                    ((t = new ma(Oe(r))), (r = 0));
                                                    for (
                                                      var n = g(t.data), a = n.next();
                                                      !a.done;
                                                      a = n.next()
                                                    )
                                                      r += a.value.length;
                                                    if (0 == r) i = Promise.resolve();
                                                    else {
                                                      for (
                                                        r = new Uint8Array(r),
                                                          n = 0,
                                                          a = (t = g(t.data)).next();
                                                        !a.done;
                                                        a = t.next()
                                                      )
                                                        ((a = a.value), r.set(a, n), (n += a.length));
                                                      (xa(i, "cenc", r), (i = i.m));
                                                    }
                                                  } else i = Promise.resolve();
                                                  return i;
                                                },
                                                disableStream: function (t, r) {
                                                  return e.disableStream(t, r);
                                                },
                                                hl: function (t, r) {
                                                  return !(
                                                    e.g.abr.enabled &&
                                                    r.fastSwitching &&
                                                    t.Xc &&
                                                    t.je
                                                  );
                                                },
                                              });
                                            })(t)),
                                            t.l.configure(t.g.streaming),
                                            (t.m = nf),
                                            t.dispatchEvent(Zh("streaming")),
                                            (h = i));
                                        case 2:
                                          for (
                                            (f = t.l.o) || h || (h = _c(t, !0)),
                                              p = [],
                                              m = g([(c = f || h).video, c.audio]),
                                              v = m.next();
                                            !v.done;
                                            v = m.next()
                                          )
                                            (y = v.value) &&
                                              !y.segmentIndex &&
                                              (p.push(y.createSegmentIndex()),
                                              y.dependencyStream &&
                                                p.push(y.dependencyStream.createSegmentIndex()));
                                          if (!(p.length > 0)) {
                                            N.A(4);
                                            break;
                                          }
                                          return b(N, Promise.all(p), 4);
                                        case 4:
                                          if (!c || 0 != c.disabledUntilTime) {
                                            N.A(2);
                                            break;
                                          }
                                          if (
                                            (Dc(t),
                                            t.I &&
                                              t.I.onInitialVariantChosen &&
                                              t.I.onInitialVariantChosen(c),
                                            t.i.isLowLatency &&
                                              (t.g.streaming.lowLatencyMode
                                                ? t.configure(t.dg)
                                                : z(
                                                    "Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.",
                                                  )),
                                            t.K &&
                                              ((function (e, t) {
                                                ((e.u = t),
                                                  e.u
                                                    ? e.l == Ah
                                                      ? (e.l = Ih)
                                                      : e.l == kh && (e.l = Rh)
                                                    : e.l == Ih
                                                      ? (e.l = Ah)
                                                      : e.l == Rh && (e.l = kh));
                                              })(t.K, t.i.isLowLatency && t.g.streaming.lowLatencyMode),
                                              (function (e, t) {
                                                if (
                                                  e.g &&
                                                  e.g.enabled &&
                                                  (ih(e, "ps", { dd: "d" }), e.h && e.h.autoplay)
                                                ) {
                                                  var r = e.h.play();
                                                  r &&
                                                    r
                                                      .then(function () {
                                                        e.H = t;
                                                      })
                                                      .catch(function () {
                                                        e.H = 0;
                                                      });
                                                }
                                              })(t.K, 1e3 * r)),
                                            Qc(
                                              t.i.presentationTimeline,
                                              t.g.playRangeStart,
                                              t.g.playRangeEnd,
                                            ),
                                            (function (e, t, r) {
                                              e.j.presentationTimeline.W() || ((e.ba = t), (e.$ = r));
                                            })(t.l, t.g.playRangeStart, t.g.playRangeEnd),
                                            (t.Ua = !0),
                                            t.dispatchEvent(Zh("canupdatestarttime")),
                                            (T = function (e) {
                                              ((t.G = (function (e, t) {
                                                return new Il(
                                                  e.h,
                                                  e.i,
                                                  e.g.streaming,
                                                  t,
                                                  function () {
                                                    (e.ac && Bl(e.ac, !e.G.Mh()),
                                                      e.l && e.l.bd(),
                                                      e.R && gc(e, "seeking"));
                                                  },
                                                  function (t) {
                                                    return e.dispatchEvent(t);
                                                  },
                                                );
                                              })(t, e)),
                                                (t.ac = (function (e, t) {
                                                  var r = e.W() || ("number" == typeof t && t > 0);
                                                  ((t = new wd(e.Ae, r)).addEventListener(
                                                    "enter",
                                                    function (t) {
                                                      qc(e, "timelineregionenter", t.region);
                                                    },
                                                  ),
                                                    t.addEventListener("exit", function (t) {
                                                      qc(e, "timelineregionexit", t.region);
                                                    }),
                                                    t.addEventListener("skip", function (t) {
                                                      var r = t.region;
                                                      t.seeking ||
                                                        (qc(e, "timelineregionenter", r),
                                                        qc(e, "timelineregionexit", r));
                                                    }));
                                                  var i = new wd(e.za, r);
                                                  (i.addEventListener("enter", function (t) {
                                                    dc(e, t.region, "metadata");
                                                  }),
                                                    (r = new wd(e.kb, r)).addEventListener(
                                                      "enter",
                                                      function (t) {
                                                        ((t = new Map().set("detail", t.region.emsg)),
                                                          e.dispatchEvent(Zh("emsg", t)));
                                                      },
                                                    ));
                                                  var n = new Ul(e.h);
                                                  return (
                                                    n.g.add(t),
                                                    n.g.add(i),
                                                    n.g.add(r),
                                                    e.ye && n.g.add(e.ye),
                                                    n
                                                  );
                                                })(t, e)),
                                                fc(t, a, !1));
                                            }),
                                            t.g.streaming.startAtSegmentBoundary ||
                                              (null == (E = t.O) && t.i.startTime && (E = t.i.startTime),
                                              T(E)),
                                            f)
                                          ) {
                                            N.A(7);
                                            break;
                                          }
                                          if (!t.g.streaming.startAtSegmentBoundary) {
                                            N.A(8);
                                            break;
                                          }
                                          return (
                                            (x = t.i.presentationTimeline),
                                            t.O instanceof Date &&
                                              ((A = x.m || x.i),
                                              null != (I = t.O.getTime() / 1e3 - A) && (w = I)),
                                            null == w && (w = "number" == typeof t.O ? t.O : t.h.currentTime),
                                            null == t.O && t.i.startTime && (w = t.i.startTime),
                                            (k = x.Zb()),
                                            (R = x.Gb()),
                                            w < k ? (w = k) : w > R && (w = R),
                                            b(
                                              N,
                                              (function (e, t) {
                                                var r, i, n, a, s;
                                                return D(function (o) {
                                                  return 1 == o.g
                                                    ? ((r = e.audio),
                                                      (i = e.video),
                                                      (n = function (e, t) {
                                                        var r, i, n;
                                                        return D(function (a) {
                                                          return 1 == a.g
                                                            ? e
                                                              ? e.segmentIndex
                                                                ? a.A(2)
                                                                : b(a, e.createSegmentIndex(), 2)
                                                              : a.return(null)
                                                            : (i = (r = e.segmentIndex.Xb(t))
                                                                  ? r.next().value
                                                                  : null)
                                                              ? ((n = i.startTime), a.return(n))
                                                              : a.return(null);
                                                        });
                                                      }),
                                                      b(o, n(r, t), 2))
                                                    : 3 != o.g
                                                      ? ((a = o.h), b(o, n(i, t), 3))
                                                      : null != (s = o.h) && null != a
                                                        ? o.return(Math.max(s, a))
                                                        : null != s
                                                          ? o.return(s)
                                                          : null != a
                                                            ? o.return(a)
                                                            : o.return(t);
                                                });
                                              })(h, w),
                                              9,
                                            )
                                          );
                                        case 9:
                                          ((C = N.h), T(C));
                                        case 8:
                                          Oc(t, h, !0, !1, 0);
                                        case 7:
                                          return (
                                            t.G.ready(),
                                            t.Lc().find(function (e) {
                                              return e.active;
                                            }) ||
                                              ((L = un(t.i.textStreams, t.Kd, t.Od, t.Nd)[0] || null) &&
                                                ud(t.B.h, L, !0),
                                              h &&
                                                (L
                                                  ? (pn(h.audio, L, t.g) && (t.$ = !0),
                                                    t.$ && t.u.setTextVisibility(!0))
                                                  : ((t.$ = !1), t.u.setTextVisibility(!1)),
                                                Vc(t)),
                                              L &&
                                                (t.g.streaming.alwaysStreamText || t.Sg()) &&
                                                (fu(t.l, L), Kc(t))),
                                            b(N, t.l.start(n), 10)
                                          );
                                        case 10:
                                          (t.g.abr.enabled && (t.o.enable(), Hc(t)),
                                            Uc(t),
                                            t.i.variants.some(function (e) {
                                              return e.primary;
                                            }),
                                            (((M = t.W()) &&
                                              ((t.g.streaming.liveSync && t.g.streaming.liveSync.enabled) ||
                                                t.i.serviceDescription ||
                                                t.g.streaming.liveSync.panicMode)) ||
                                              t.g.streaming.vodDynamicPlaybackRate) &&
                                              ((_ = function () {
                                                return Lc(t);
                                              }),
                                              t.j.D(a, "timeupdate", _)),
                                            M ||
                                              ((P = function () {
                                                return Mc(t);
                                              }),
                                              t.j.D(a, "timeupdate", P),
                                              Mc(t),
                                              t.i.nextUrl &&
                                                (t.g.streaming.preloadNextUrlWindow > 0 &&
                                                  ((O = function () {
                                                    var e;
                                                    return D(function (r) {
                                                      if (1 == r.g)
                                                        return (
                                                          (e = t.Ra().end - t.h.currentTime),
                                                          !isNaN(e) && e <= t.g.streaming.preloadNextUrlWindow
                                                            ? (t.j.Ma(a, "timeupdate", O),
                                                              b(r, t.preload(t.i.nextUrl), 4))
                                                            : r.A(0)
                                                        );
                                                      ((t.eb = r.h), S(r));
                                                    });
                                                  }),
                                                  t.j.D(a, "timeupdate", O)),
                                                t.j.D(a, "ended", function () {
                                                  t.load(t.eb || t.i.nextUrl);
                                                }))),
                                            t.C && t.C.onManifestUpdated(M),
                                            S(N));
                                      }
                                    });
                                  })(T, h, v, m),
                                  0,
                                );
                              });
                            }, "loadInner_"),
                            24,
                          )
                        );
                      case 24:
                        (!(function (e) {
                          if (e.J) for (var t = g(e.J), r = t.next(); !r.done; r = t.next()) (r = r.value)();
                          e.J = null;
                        })(n),
                          T.Fa &&
                            se().gj() &&
                            mi(T.Fa) &&
                            (function (t, r, i) {
                              t.g &&
                                e.ManagedMediaSource &&
                                t.i &&
                                t.B.useSourceElements &&
                                (t.F && t.g.removeChild(t.F),
                                (t.F = Qs(r, i)),
                                t.g.appendChild(t.F),
                                (t.g.disableRemotePlayback = !1));
                            })(T.H, T.X, T.Fa),
                          w.A(16));
                        break;
                      case 25:
                        return b(
                          w,
                          l(function () {
                            return D(function (e) {
                              return b(
                                e,
                                (function (e, t, r) {
                                  var i, n, a, s, o, l, u, d, h, c, f, p;
                                  return D(function (m) {
                                    switch (m.g) {
                                      case 1:
                                        if (
                                          (tc(e, "src-equals"),
                                          (i = e.h),
                                          (e.G = new xl(i)),
                                          (n = !1),
                                          e.De.push(function () {
                                            n = !0;
                                          }),
                                          e.dispatchEvent(Zh("canupdatestarttime")),
                                          null != e.O && e.G.$f(e.O),
                                          (e.ac = (function (e, t) {
                                            (t = new wd(e.za, t instanceof Date || t > 0)).addEventListener(
                                              "enter",
                                              function (t) {
                                                dc(e, t.region, "metadata");
                                              },
                                            );
                                            var r = new Ul(e.h);
                                            return (r.g.add(t), r);
                                          })(e, e.O || 0)),
                                          (e.M = new Nl({
                                            cf: function () {
                                              return i.playbackRate;
                                            },
                                            Tc: function () {
                                              return i.defaultPlaybackRate;
                                            },
                                            uh: function (e) {
                                              i.playbackRate = e;
                                            },
                                            Di: function (e) {
                                              i.currentTime += e;
                                            },
                                          })),
                                          fc(e, i, !0),
                                          i.textTracks &&
                                            (oc(e),
                                            (a = function (t) {
                                              if (!(e.u instanceof $d)) {
                                                var r = Sc(e).find(function (e) {
                                                  return "disabled" !== e.mode;
                                                });
                                                (r && (r.mode = t ? "showing" : "hidden"),
                                                  e.u instanceof Gd &&
                                                    (r = (function (e) {
                                                      return Array.from(e.h.textTracks).find(function (e) {
                                                        return "Shaka Player TextTrack" == e.label;
                                                      });
                                                    })(e)) &&
                                                    (r.mode =
                                                      !t && e.u.isTextVisible() ? "showing" : "hidden"));
                                              }
                                            }),
                                            e.j.D(i, "enterpictureinpicture", function () {
                                              return a(!0);
                                            }),
                                            e.j.D(i, "leavepictureinpicture", function () {
                                              return a(!1);
                                            }),
                                            i.remote
                                              ? (e.j.D(i.remote, "connect", function () {
                                                  return a(!1);
                                                }),
                                                e.j.D(i.remote, "connecting", function () {
                                                  return a(!1);
                                                }),
                                                e.j.D(i.remote, "disconnect", function () {
                                                  return a(!1);
                                                }))
                                              : "webkitCurrentPlaybackTargetIsWireless" in i &&
                                                e.j.D(
                                                  i,
                                                  "webkitcurrentplaybacktargetiswirelesschanged",
                                                  function () {
                                                    return a(!1);
                                                  },
                                                ),
                                            ((s = i).webkitPresentationMode || s.webkitSupportsFullscreen) &&
                                              e.j.D(s, "webkitpresentationmodechanged", function () {
                                                s.webkitPresentationMode
                                                  ? a("inline" !== s.webkitPresentationMode)
                                                  : s.webkitSupportsFullscreen &&
                                                    a(s.webkitDisplayingFullscreen);
                                              })),
                                          uc(e, i, t),
                                          (o = (function (e, t, r) {
                                            try {
                                              if (!e.g.enabled) return t;
                                              var i = rh(e);
                                              e: {
                                                switch (r.toLowerCase()) {
                                                  case "audio/mp4":
                                                  case "audio/webm":
                                                  case "audio/ogg":
                                                  case "audio/mpeg":
                                                  case "audio/aac":
                                                  case "audio/flac":
                                                  case "audio/wav":
                                                    var n = mh;
                                                    break e;
                                                  case "video/webm":
                                                  case "video/mp4":
                                                  case "video/mpeg":
                                                  case "video/mp2t":
                                                    n = yh;
                                                    break e;
                                                  case "application/x-mpegurl":
                                                  case "application/vnd.apple.mpegurl":
                                                  case "application/dash+xml":
                                                  case "video/vnd.mpeg.dash.mpd":
                                                  case "application/vnd.ms-sstr+xml":
                                                    n = gh;
                                                    break e;
                                                }
                                                n = void 0;
                                              }
                                              return ((i.ot = n), (i.su = !0), ph(t, ch(i)));
                                            } catch (s) {
                                              return (
                                                q("CMCD_SRC_ERROR", "Could not generate src CMCD data.", s),
                                                t
                                              );
                                            }
                                          })(e.K, e.X, r)),
                                          !o.includes("#t=") &&
                                            (e.g.playRangeStart > 0 || isFinite(e.g.playRangeEnd)) &&
                                            ((o += "#t="),
                                            e.g.playRangeStart > 0 && (o += e.g.playRangeStart),
                                            isFinite(e.g.playRangeEnd) && (o += "," + e.g.playRangeEnd)),
                                          !e.H)
                                        ) {
                                          m.A(2);
                                          break;
                                        }
                                        return b(m, e.H.destroy(), 3);
                                      case 3:
                                        e.H = null;
                                      case 2:
                                        return (
                                          Js(i),
                                          (i.src = o),
                                          "TV" == (l = se()).Oa() && i.load(),
                                          "none" != i.preload &&
                                            !i.autoplay &&
                                            mi(r) &&
                                            "WEBKIT" === l.Ha() &&
                                            i.load(),
                                          (e.m = af),
                                          e.dispatchEvent(Zh("streaming")),
                                          (u = function () {
                                            return new Promise(function (t) {
                                              var r = new Ri(t);
                                              (e.j.D(i.textTracks, "change", function () {
                                                return r.ka(0.5);
                                              }),
                                                r.ka(0.5));
                                            });
                                          }),
                                          (d = new kn()),
                                          pl(i, HTMLMediaElement.HAVE_METADATA, e.j, function () {
                                            return D(function (t) {
                                              if (1 == t.g)
                                                return (
                                                  e.G.ready(),
                                                  e.Fa && mi(e.Fa) ? b(t, u(), 3) : (d.resolve(), t.A(0))
                                                );
                                              (d.resolve(), S(t));
                                            });
                                          }),
                                          pl(i, HTMLMediaElement.HAVE_CURRENT_DATA, e.j, function () {
                                            var t, r, i, a, s;
                                            return D(function (o) {
                                              if (1 == o.g) return b(o, u(), 2);
                                              if (n) return o.return();
                                              if (
                                                ((function (e) {
                                                  var t = e.g.preferredAudioLanguage;
                                                  "" != t && e.Ti(t, e.g.preferredAudioRole);
                                                })(e),
                                                (t = Sc(e)).some(function (e) {
                                                  return "showing" === e.mode;
                                                }) && ((e.$ = !0), e.u.setTextVisibility(!0)),
                                                !(e.u instanceof $d))
                                              )
                                                for (
                                                  t.length &&
                                                    (e.u.enableTextDisplayer
                                                      ? e.u.enableTextDisplayer()
                                                      : he(
                                                          "Text displayer w/ enableTextDisplayer",
                                                          'Text displayer should have a "enableTextDisplayer" method',
                                                        )),
                                                    r = !1,
                                                    i = g(t),
                                                    a = i.next();
                                                  !a.done;
                                                  a = i.next()
                                                )
                                                  "disabled" !== (s = a.value).mode &&
                                                    (r
                                                      ? ((s.mode = "disabled"),
                                                        z(
                                                          "Found more than one enabled text track, disabling it",
                                                          s,
                                                        ))
                                                      : (bc(e, s), (r = !0)));
                                              (!(function (e) {
                                                var t = e.g.preferredTextLanguage;
                                                "" != t &&
                                                  e.oh(t, e.g.preferredTextRole, e.g.preferForcedSubs);
                                              })(e),
                                                S(o));
                                            });
                                          }),
                                          i.error
                                            ? d.reject(Yc(e))
                                            : "none" == i.preload &&
                                              (z(
                                                'With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.',
                                              ),
                                              d.resolve()),
                                          e.j.Aa(i, "error", function () {
                                            d.reject(Yc(e));
                                          }),
                                          b(m, Di(e.g.streaming.loadTimeout, d), 4)
                                        );
                                      case 4:
                                        ((((h = e.W()) &&
                                          ((e.g.streaming.liveSync && e.g.streaming.liveSync.enabled) ||
                                            e.g.streaming.liveSync.panicMode)) ||
                                          e.g.streaming.vodDynamicPlaybackRate) &&
                                          ((c = function () {
                                            return Lc(e);
                                          }),
                                          e.j.D(i, "timeupdate", c)),
                                          h ||
                                            ((f = function () {
                                              return Mc(e);
                                            }),
                                            e.j.D(i, "timeupdate", f),
                                            Mc(e)),
                                          e.C &&
                                            (e.C.onManifestUpdated(h),
                                            h &&
                                              ((p = e.Ra().end),
                                              e.j.D(i, "progress", function () {
                                                var t = e.Ra().end;
                                                p != t && (e.C.onManifestUpdated(e.W()), (p = t));
                                              }))),
                                          (e.Ua = !0),
                                          S(m));
                                    }
                                  });
                                })(T, h, i),
                                0,
                              );
                            });
                          }, "srcEqualsInner_"),
                          16,
                        );
                      case 16:
                        T.dispatchEvent(Zh("loaded"));
                      case 8:
                        if ((I(w), !n)) {
                          w.A(27);
                          break;
                        }
                        return b(w, n.destroy(), 27);
                      case 27:
                        ((T.eb = null), k(w, 0));
                        break;
                      case 7:
                        if (!(y = A(w)) || 7e3 == y.code) {
                          w.A(29);
                          break;
                        }
                        return b(w, T.Cc(!1), 29);
                      case 29:
                        throw y;
                    }
                  });
                }),
                (n.jj = function (e, t, r) {
                  ((e = void 0 === e || e), (t = void 0 !== t && t), (r = void 0 !== r && r));
                  var i,
                    n = this;
                  return D(function (a) {
                    return 1 == a.g
                      ? b(a, ic(n, r), 2)
                      : 3 != a.g
                        ? ((i = a.h), b(a, n.Cc(e, t), 3))
                        : a.return(i);
                  });
                }),
                (n.$h = function (e, t) {
                  ((e = void 0 !== e && e), (t = void 0 !== t && t));
                  var r,
                    i = this;
                  return D(function (n) {
                    return 1 == n.g
                      ? b(n, ic(i, t), 2)
                      : 3 != n.g
                        ? ((r = n.h), b(n, i.detach(e), 3))
                        : n.return(r);
                  });
                }),
                (n.preload = function (e, t, r, i) {
                  t = void 0 === t ? null : t;
                  var n,
                    a,
                    s = this;
                  return D(function (o) {
                    return 1 == o.g
                      ? (id((n = Ic(s)), i || s.g, Ic(s)), b(o, nc(s, e, t, r, !1, n), 2))
                      : ((a = o.h) ? a.start() : zc(s, new ze(2, 7, 7005)), o.return(a));
                  });
                }),
                (n.rg = function () {
                  var e,
                    t,
                    r,
                    i,
                    n = this;
                  return D(function (a) {
                    for (e = [], t = g(n.Ie), r = t.next(); !r.done; r = t.next())
                      (i = r.value).l || e.push(i.destroy());
                    return ((n.Ie = []), b(a, Promise.all(e), 0));
                  });
                }),
                (n.Ok = function () {
                  for (var e = this.ba; e.g; ) e.release();
                }),
                (n.md = function (e) {
                  return new ya(e);
                }),
                (n.configure = function (e, t) {
                  var r = this.getConfiguration();
                  if (
                    (2 == arguments.length && "string" == typeof e && (e = ju(e, t)),
                    "preferredVariantRole" in e &&
                      (he("preferredVariantRole configuration", "Please Use preferredAudioRole instead."),
                      (e.preferredAudioRole = e.preferredVariantRole),
                      delete e.preferredVariantRole),
                    e.streaming &&
                      "forceTransmuxTS" in e.streaming &&
                      (he(
                        "streaming.forceTransmuxTS configuration",
                        "Please Use mediaSource.forceTransmux instead.",
                      ),
                      (e.mediaSource = e.mediaSource || {}),
                      (e.mediaSource.mediaSource = e.streaming.forceTransmuxTS),
                      delete e.streaming.forceTransmuxTS),
                    e.streaming &&
                      "forceTransmux" in e.streaming &&
                      (he(
                        "streaming.forceTransmux configuration",
                        "Please Use mediaSource.forceTransmux instead.",
                      ),
                      (e.mediaSource = e.mediaSource || {}),
                      (e.mediaSource.mediaSource = e.streaming.forceTransmux),
                      delete e.streaming.forceTransmux),
                    e.streaming && "useNativeHlsOnSafari" in e.streaming)
                  ) {
                    he(
                      "streaming.useNativeHlsOnSafari configuration",
                      "Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead.",
                    );
                    var i = se();
                    ((e.streaming.preferNativeHls = e.streaming.useNativeHlsOnSafari && "WEBKIT" === i.Ha()),
                      delete e.streaming.useNativeHlsOnSafari);
                  }
                  if (
                    (e.streaming &&
                      "boolean" == typeof e.streaming.liveSync &&
                      (he("streaming.liveSync", "Please Use streaming.liveSync.enabled instead."),
                      (i = e.streaming.liveSync),
                      (e.streaming.liveSync = {}),
                      (e.streaming.liveSync.enabled = i)),
                    e.streaming &&
                      (!e.streaming.liveSync || !("targetLatency" in e.streaming.liveSync)) &&
                      ("liveSyncMinLatency" in e.streaming || "liveSyncMaxLatency" in e.streaming))
                  ) {
                    i = e.streaming.liveSyncMinLatency || 0;
                    var n = Math.abs((e.streaming.liveSyncMaxLatency || 1) - i) / 2;
                    ((e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.targetLatency = i + n),
                      (e.streaming.liveSync.targetLatencyTolerance = n));
                  }
                  if (
                    (e.streaming &&
                      "liveSyncMaxLatency" in e.streaming &&
                      (he(
                        "streaming.liveSyncMaxLatency",
                        "Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest",
                      ),
                      delete e.streaming.liveSyncMaxLatency),
                    e.streaming &&
                      "liveSyncMinLatency" in e.streaming &&
                      (he(
                        "streaming.liveSyncMinLatency",
                        "Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest",
                      ),
                      delete e.streaming.liveSyncMinLatency),
                    e.streaming &&
                      "liveSyncTargetLatency" in e.streaming &&
                      (he(
                        "streaming.liveSyncTargetLatency",
                        "Please Use streaming.liveSync.targetLatency instead.",
                      ),
                      (e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.targetLatency = e.streaming.liveSyncTargetLatency),
                      delete e.streaming.liveSyncTargetLatency),
                    e.streaming &&
                      "liveSyncTargetLatencyTolerance" in e.streaming &&
                      (he(
                        "streaming.liveSyncTargetLatencyTolerance",
                        "Please Use streaming.liveSync.targetLatencyTolerance instead.",
                      ),
                      (e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.targetLatencyTolerance =
                        e.streaming.liveSyncTargetLatencyTolerance),
                      delete e.streaming.liveSyncTargetLatencyTolerance),
                    e.streaming &&
                      "liveSyncPlaybackRate" in e.streaming &&
                      (he(
                        "streaming.liveSyncPlaybackRate",
                        "Please Use streaming.liveSync.maxPlaybackRate instead.",
                      ),
                      (e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.maxPlaybackRate = e.streaming.liveSyncPlaybackRate),
                      delete e.streaming.liveSyncPlaybackRate),
                    e.streaming &&
                      "liveSyncMinPlaybackRate" in e.streaming &&
                      (he(
                        "streaming.liveSyncMinPlaybackRate",
                        "Please Use streaming.liveSync.minPlaybackRate instead.",
                      ),
                      (e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.minPlaybackRate = e.streaming.liveSyncMinPlaybackRate),
                      delete e.streaming.liveSyncMinPlaybackRate),
                    e.streaming &&
                      "liveSyncPanicMode" in e.streaming &&
                      (he("streaming.liveSyncPanicMode", "Please Use streaming.liveSync.panicMode instead."),
                      (e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.panicMode = e.streaming.liveSyncPanicMode),
                      delete e.streaming.liveSyncPanicMode),
                    e.streaming &&
                      "liveSyncPanicThreshold" in e.streaming &&
                      (he(
                        "streaming.liveSyncPanicThreshold",
                        "Please Use streaming.liveSync.panicThreshold instead.",
                      ),
                      (e.streaming.liveSync = e.streaming.liveSync || {}),
                      (e.streaming.liveSync.panicThreshold = e.streaming.liveSyncPanicThreshold),
                      delete e.streaming.liveSyncPanicThreshold),
                    e.mediaSource && "sourceBufferExtraFeatures" in e.mediaSource)
                  ) {
                    he(
                      "mediaSource.sourceBufferExtraFeatures configuration",
                      "Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.",
                    );
                    var a = e.mediaSource.sourceBufferExtraFeatures;
                    ((e.mediaSource.addExtraFeaturesToSourceBuffer = function () {
                      return a;
                    }),
                      delete e.mediaSource.sourceBufferExtraFeatures);
                  }
                  if (
                    (e.manifest &&
                      e.manifest.hls &&
                      "useSafariBehaviorForLive" in e.manifest.hls &&
                      (he(
                        "manifest.hls.useSafariBehaviorForLive configuration",
                        "Please Use liveSync config to keep on live Edge instead.",
                      ),
                      delete e.manifest.hls.useSafariBehaviorForLive),
                    e.streaming &&
                      "parsePrftBox" in e.streaming &&
                      (he(
                        "streaming.parsePrftBox configuration",
                        "Now fired without needing a configuration.",
                      ),
                      delete e.streaming.parsePrftBox),
                    e.manifest &&
                      e.manifest.dash &&
                      "enableAudioGroups" in e.manifest.dash &&
                      (he(
                        "manifest.dash.enableAudioGroups configuration",
                        "Please Use manifest.enableAudioGroups instead.",
                      ),
                      (e.manifest.enableAudioGroups = e.manifest.dash.enableAudioGroups),
                      delete e.manifest.dash.enableAudioGroups),
                    e.streaming &&
                      "dispatchAllEmsgBoxes" in e.streaming &&
                      (he(
                        "streaming.dispatchAllEmsgBoxes configuration",
                        "Please Use mediaSource.dispatchAllEmsgBoxes instead.",
                      ),
                      (e.mediaSource = e.mediaSource || {}),
                      (e.mediaSource.dispatchAllEmsgBoxes = e.streaming.dispatchAllEmsgBoxes),
                      delete e.streaming.dispatchAllEmsgBoxes),
                    e.streaming &&
                      "autoLowLatencyMode" in e.streaming &&
                      (he(
                        "streaming.autoLowLatencyMode configuration",
                        "Please Use streaming.lowLatencyMode instead.",
                      ),
                      (e.streaming.lowLatencyMode = e.streaming.autoLowLatencyMode),
                      delete e.streaming.autoLowLatencyMode),
                    e.manifest &&
                      e.manifest.dash &&
                      "ignoreSupplementalCodecs" in e.manifest.dash &&
                      (he(
                        "manifest.dash.ignoreSupplementalCodecs configuration",
                        "Please Use manifest.ignoreSupplementalCodecs instead.",
                      ),
                      (e.manifest.ignoreSupplementalCodecs = e.manifest.dash.ignoreSupplementalCodecs),
                      delete e.manifest.dash.ignoreSupplementalCodecs),
                    e.manifest &&
                      e.manifest.hls &&
                      "ignoreSupplementalCodecs" in e.manifest.hls &&
                      (he(
                        "manifest.hls.ignoreSupplementalCodecs configuration",
                        "Please Use manifest.ignoreSupplementalCodecs instead.",
                      ),
                      (e.manifest.ignoreSupplementalCodecs = e.manifest.hls.ignoreSupplementalCodecs),
                      delete e.manifest.hls.ignoreSupplementalCodecs),
                    e.manifest &&
                      e.manifest.dash &&
                      "updatePeriod" in e.manifest.dash &&
                      (he(
                        "manifest.dash.updatePeriod configuration",
                        "Please Use manifest.updatePeriod instead.",
                      ),
                      (e.manifest.updatePeriod = e.manifest.dash.updatePeriod),
                      delete e.manifest.dash.updatePeriod),
                    e.manifest &&
                      e.manifest.hls &&
                      "updatePeriod" in e.manifest.hls &&
                      (he(
                        "manifest.hls.updatePeriod configuration",
                        "Please Use manifest.updatePeriod instead.",
                      ),
                      (e.manifest.updatePeriod = e.manifest.hls.updatePeriod),
                      delete e.manifest.hls.updatePeriod),
                    e.manifest &&
                      e.manifest.dash &&
                      "ignoreDrmInfo" in e.manifest.dash &&
                      (he(
                        "manifest.dash.ignoreDrmInfo configuration",
                        "Please Use manifest.ignoreDrmInfo instead.",
                      ),
                      (e.manifest.ignoreDrmInfo = e.manifest.dash.ignoreDrmInfo),
                      delete e.manifest.dash.ignoreDrmInfo),
                    e.drm && e.drm.advanced)
                  ) {
                    for (var s in ((i = !1), e.drm.advanced)) {
                      var o = e.drm.advanced[s];
                      ((n = o.videoRobustness),
                        (o = o.audioRobustness),
                        "videoRobustness" in e.drm.advanced[s] &&
                          !Array.isArray(e.drm.advanced[s].videoRobustness) &&
                          ((e.drm.advanced[s].videoRobustness = [n]), (i = !0)),
                        "audioRobustness" in e.drm.advanced[s] &&
                          !Array.isArray(e.drm.advanced[s].audioRobustness) &&
                          ((e.drm.advanced[s].audioRobustness = [o]), (i = !0)));
                    }
                    i &&
                      he(
                        "AdvancedDrmConfiguration's videoRobustness and audioRobustness",
                        "These properties are no longer strings but array of strings, please update your usage of these properties.",
                      );
                  }
                  return (
                    e.streaming &&
                      "forceHTTP" in e.streaming &&
                      (he("streaming.forceHTTP configuration", "Please Use networking.forceHTTP instead."),
                      (e.networking = e.networking || {}),
                      (e.networking.forceHTTP = e.streaming.forceHTTP),
                      delete e.streaming.forceHTTP),
                    e.streaming &&
                      "forceHTTPS" in e.streaming &&
                      (he("streaming.forceHTTPS configuration", "Please Use networking.forceHTTP instead."),
                      (e.networking = e.networking || {}),
                      (e.networking.forceHTTPS = e.streaming.forceHTTPS),
                      delete e.streaming.forceHTTPS),
                    e.streaming &&
                      "minBytesForProgressEvents" in e.streaming &&
                      (he(
                        "streaming.minBytesForProgressEvents configuration",
                        "Please Use networking.minBytesForProgressEvents instead.",
                      ),
                      (e.networking = e.networking || {}),
                      (e.networking.minBytesForProgressEvents = e.streaming.minBytesForProgressEvents),
                      delete e.streaming.minBytesForProgressEvents),
                    (s = id(this.g, e, Ic(this))),
                    mc(this, r),
                    s
                  );
                }),
                (n.yj = function (e) {
                  this.dg = e;
                }),
                (n.getConfiguration = function () {
                  var e = Ic(this);
                  return (id(e, this.g, Ic(this)), e);
                }),
                (n.Ij = function () {
                  return this.dg;
                }),
                (n.ki = function () {
                  return (id(Ic(this), this.g, Ic(this)), Vu(this.g, Ic(this)));
                }),
                (n.ei = function () {
                  if (this.h) {
                    var e = this.h.buffered.length;
                    e = e ? this.h.buffered.end(e - 1) : 0;
                    var t = this.getConfiguration().streaming.bufferingGoal;
                    if (e >= (t = Math.min(this.h.currentTime + t, this.Ra().end))) return 1;
                    if (!(e <= this.h.currentTime) && e < t)
                      return (e - this.h.currentTime) / (t - this.h.currentTime);
                  }
                  return 0;
                }),
                (n.Oi = function () {
                  var e,
                    t = this.getConfiguration();
                  for (e in this.g) delete this.g[e];
                  (id(this.g, Ic(this), Ic(this)), mc(this, t));
                }),
                (n.$d = function () {
                  return this.m;
                }),
                (n.ii = function () {
                  return this.i ? this.i.type : null;
                }),
                (n.bf = function () {
                  return this.h;
                }),
                (n.Yb = function () {
                  return this.N;
                }),
                (n.rd = function () {
                  return this.X;
                }),
                (n.di = function () {
                  return this.C ? this.C : null;
                }),
                (n.mi = function () {
                  return this.Da ? this.Da : null;
                }),
                (n.W = function () {
                  return this.i && !this.xa()
                    ? this.i.presentationTimeline.W()
                    : !(!this.h || (!this.h.src && !this.xa())) && this.h.duration == 1 / 0;
                }),
                (n.Vc = function () {
                  return !!this.i && this.i.presentationTimeline.Vc();
                }),
                (n.lk = function () {
                  if (this.i && !this.xa()) {
                    var e = this.i.variants;
                    return !!e.length && !e[0].video;
                  }
                  return (
                    !(!this.h || (!this.h.src && !this.xa())) &&
                    (this.h.videoTracks ? 0 == this.h.videoTracks.length : 0 == this.h.videoHeight)
                  );
                }),
                (n.ti = function () {
                  if (this.i && !this.xa()) {
                    var e = this.i.variants;
                    return !(!e.length || (e = e[0]).audio || !e.video || e.video.codecs.includes(","));
                  }
                  return (
                    !(!this.h || (!this.h.src && !this.xa()) || !this.h.audioTracks) &&
                    0 == this.h.audioTracks.length
                  );
                }),
                (n.Ra = function () {
                  if (this.i && !this.xa()) {
                    if (!this.Ua && "HLS" == this.i.type) return { start: 0, end: 0 };
                    var e = this.i.presentationTimeline;
                    return { start: e.Zb(), end: e.Gb() };
                  }
                  if (this.h && (this.h.src || this.xa()) && (e = this.h.seekable) && e.length) {
                    var t = this.g ? this.g.playRangeStart : 0;
                    t = Math.max(e.start(0), t);
                    var r = this.g ? this.g.playRangeEnd : 1 / 0;
                    return { start: t, end: (e = Math.min(e.end(e.length - 1), r)) };
                  }
                  return { start: 0, end: 0 };
                }),
                (n.ik = function () {
                  this.W() && (this.h.currentTime = this.Ra().end);
                }),
                (n.nk = function () {
                  return this.Ua;
                }),
                (n.keySystem = function () {
                  var e = this.drmInfo();
                  return e ? e.keySystem : "";
                }),
                (n.drmInfo = function () {
                  return this.F ? this.F.g : null;
                }),
                (n.Zd = function () {
                  return this.F ? this.F.Zd() : 1 / 0;
                }),
                (n.Kg = function () {
                  return this.F ? this.F.Kg() : [];
                }),
                (n.$e = function () {
                  return this.F ? this.F.$e() : {};
                }),
                (n.Rg = function () {
                  return this.R ? this.R.g == Va : !!this.X;
                }),
                (n.Ob = function () {
                  return this.h ? (this.M ? this.M.i : 1) : 0;
                }),
                (n.Kh = function (e) {
                  this.m == nf && this.l && hu(this.l, e);
                }),
                (n.xe = function (e, t) {
                  ((t = void 0 === t || t),
                    0 == e
                      ? z("A trick play rate of 0 is unsupported!")
                      : (this.M.set(e),
                        this.m == nf && (this.o.playbackRateChanged(e), this.Kh(t && 1 != e)),
                        Rc(this, e)));
                }),
                (n.Sd = function () {
                  var e = this.M.Tc();
                  (this.m == af && this.M.set(e),
                    this.m == nf && (this.M.set(e), this.o.playbackRateChanged(e), this.Kh(!1)),
                    this.dc.Qa());
                }),
                (n.qc = function () {
                  if (this.i && !this.xa()) {
                    for (
                      var e = this.l ? this.l.o : null, t = [], r = 0, i = g(this.i.variants), n = i.next();
                      !n.done;
                      n = i.next()
                    )
                      if (on((n = n.value))) {
                        var a = en(n);
                        ((a.active = n == e),
                          a.active ||
                            1 == r ||
                            null == e ||
                            n.video != e.video ||
                            n.audio != e.audio ||
                            (a.active = !0),
                          a.active && r++,
                          t.push(a));
                      }
                    return t;
                  }
                  if (this.h && this.h.audioTracks) {
                    var s = Fc(this);
                    return (e = Array.from(this.h.audioTracks)).length
                      ? e.map(function (e) {
                          return sn(e, s);
                        })
                      : s
                        ? [sn(null, s)]
                        : [];
                  }
                  return [];
                }),
                (n.Lc = function () {
                  if (this.i) {
                    if (this.xa()) return [];
                    for (
                      var e = this.l ? this.l.B : null, t = [], r = g(this.i.textStreams), i = r.next();
                      !i.done;
                      i = r.next()
                    ) {
                      var n = tn((i = i.value));
                      ((n.active = i == e), t.push(n));
                    }
                    return t;
                  }
                  return this.h && this.h.src && this.h.textTracks
                    ? Sc(this).map(function (e) {
                        return an(e);
                      })
                    : [];
                }),
                (n.Nj = function () {
                  var e = this.Ke;
                  return (
                    this.i && (e = this.i.imageStreams),
                    e.map(function (e) {
                      return rn(e);
                    })
                  );
                }),
                (n.Bj = function (e) {
                  var t,
                    r,
                    i = this;
                  return D(function (n) {
                    return 1 == n.g
                      ? b(n, yc(i, e), 2)
                      : (t = n.h)
                        ? ((r = []),
                          t.segmentIndex.Fb(function (e) {
                            var i = vc(e.tilesLayout || t.tilesLayout);
                            if (i)
                              for (var n = i.rows * i.columns, a = e.j - e.startTime, s = 0; s < n; s++) {
                                var o = Tc(e, t, e.startTime + (a * s) / n, i);
                                r.push(o);
                              }
                          }),
                          t.closeSegmentIndex && t.closeSegmentIndex(),
                          n.return(r))
                        : n.return(null);
                  });
                }),
                (n.ck = function (e, t) {
                  var r,
                    i,
                    n,
                    a,
                    s,
                    o = this;
                  return D(function (l) {
                    return 1 == l.g
                      ? b(l, yc(o, e), 2)
                      : (r = l.h)
                        ? (r.closeSegmentIndex &&
                            (o.yc.has(r) ||
                              ((i = new Ri(function () {
                                (r.closeSegmentIndex(), o.yc.delete(r));
                              })),
                              o.yc.set(r, i)),
                            o.yc.get(r).ka(5)),
                          null == (n = r.segmentIndex.find(t))
                            ? l.return(null)
                            : ((a = r.segmentIndex.get(n)),
                              (s = vc(a.tilesLayout || r.tilesLayout))
                                ? l.return(Tc(a, r, t, s))
                                : l.return(null)))
                        : l.return(null);
                  });
                }),
                (n.ph = function (e) {
                  var t,
                    r = this;
                  (this.i &&
                    this.G &&
                    ((t = r.i.textStreams.find(function (t) {
                      return t.id == e.id;
                    })) &&
                      t != r.l.B &&
                      (ud(r.B.h, t, !1), fu(r.l, t), Gc(r), Kc(r), (r.Kd = t.language)),
                    !this.xa())) ||
                    (function () {
                      if (r.h && r.h.textTracks) {
                        var t = Sc(r),
                          i = t.find(function (t) {
                            return nn(t) === e.id;
                          });
                        if (i) {
                          if (r.u instanceof $d)
                            for (var n = (t = g(t)).next(); !n.done; n = t.next()) {
                              var a = (n = n.value) === i ? (r.$ ? "showing" : "hidden") : "disabled";
                              n.mode !== a && (n.mode = a);
                            }
                          else
                            (t = t.find(function (e) {
                              return "disabled" !== e.mode;
                            })) !== i &&
                              (t && ((t.mode = "disabled"), r.j.Ma(t, "cuechange"), r.u.remove(0, 1 / 0)),
                              i && bc(r, i));
                          (Gc(r), Kc(r));
                        }
                      }
                    })();
                }),
                (n.Jf = function (e, t, r) {
                  var i = this;
                  ((t = void 0 !== t && t),
                    (r = void 0 === r ? 0 : r),
                    (this.i &&
                      this.G &&
                      ((function () {
                        var n = i.i.variants.find(function (t) {
                          return t.id == e.id;
                        });
                        if (n && on(n)) {
                          var a = i.l.o;
                          (i.g.abr.enabled &&
                            (a.video != n.video ||
                              (a.audio &&
                                n.audio &&
                                a.audio.language == n.audio.language &&
                                a.audio.channelsCount == n.audio.channelsCount &&
                                a.audio.label == n.audio.label)) &&
                            z(
                              "Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack().",
                            ),
                            i.xa() ? Oc(i, n, !1, !1, 0) : Oc(i, n, !1, t || !1, r || 0),
                            i.J.configure({
                              language: n.language,
                              role: (n.audio && n.audio.roles && n.audio.roles[0]) || "",
                              videoRole: (n.video && n.video.roles && n.video.roles[0]) || "",
                              channelCount: n.audio && n.audio.channelsCount ? n.audio.channelsCount : 0,
                              hdrLevel: n.video && n.video.hdr ? n.video.hdr : "",
                              spatialAudio: !(!n.audio || !n.audio.spatialAudio) && n.audio.spatialAudio,
                              videoLayout: n.video && n.video.videoLayout ? n.video.videoLayout : "",
                              audioLabel: n.audio && n.audio.label ? n.audio.label : "",
                              videoLabel: n.video && n.video.label ? n.video.label : "",
                              codecSwitchingStrategy: i.g.mediaSource.codecSwitchingStrategy,
                              audioCodec: n.audio && n.audio.codecs ? n.audio.codecs : "",
                              activeAudioCodec: a.audio && a.audio.codecs ? a.audio.codecs : "",
                              activeAudioChannelCount:
                                a.audio && a.audio.channelsCount ? a.audio.channelsCount : 0,
                              preferredAudioCodecs: i.g.preferredAudioCodecs,
                              preferredAudioChannelCount: i.g.preferredAudioChannelCount,
                            }),
                            Dc(i));
                        }
                      })(),
                      !this.xa())) ||
                      (function () {
                        if (e.originalAudioId && i.h && i.h.audioTracks)
                          for (
                            var t = Array.from(i.h.audioTracks), r = (t = g(t)).next();
                            !r.done;
                            r = t.next()
                          )
                            if (nn((r = r.value)) == e.id) {
                              Nc(i, r);
                              break;
                            }
                      })());
                }),
                (n.Wk = function (e, t) {
                  var r = this;
                  ((t = void 0 === t ? 0 : t),
                    (this.i &&
                      this.G &&
                      ((function () {
                        var i = r.J.getConfiguration();
                        ((i.audioCodec = e.codecs || ""),
                          (i.audioLabel = e.label || ""),
                          (i.channelCount = e.channelsCount || 0),
                          (i.language = e.language),
                          (i.role = e.roles[0] || ""),
                          (i.spatialAudio = e.spatialAudio));
                        var n = r.l.o;
                        ((n = n && n.audio) &&
                          ((i.activeAudioCodec = n.codecs || ""),
                          (i.activeAudioChannelCount = n.channelsCount || 0)),
                          r.J.configure(i),
                          Pc(r, !0, t, !1, !1));
                      })(),
                      !this.xa())) ||
                      (function () {
                        if (r.h && r.h.audioTracks) {
                          for (
                            var t = Fi(e.language),
                              i = Array.from(r.h.audioTracks),
                              n = null,
                              a = (i = g(i)).next();
                            !a.done;
                            a = i.next()
                          ) {
                            var s = (a = a.value).language || "und";
                            if (a.label == e.label && Fi(s) == t && a.kind == e.roles[0]) {
                              n = a;
                              break;
                            }
                          }
                          n && Nc(r, n);
                        }
                      })());
                }),
                (n.getAudioTracks = function () {
                  if (this.i && !this.xa()) {
                    var e = this.qc();
                    if (!e.length) return [];
                    var t = e.find(function (e) {
                      return e.active;
                    });
                    if (!t) return [];
                    var r = e;
                    if (
                      (this.m != nf ||
                        this.xa() ||
                        (r = e.filter(function (e) {
                          return (
                            e.originalVideoId === t.originalVideoId &&
                            (e.audioCodec || yi.includes(e.audioMimeType || ""))
                          );
                        })),
                      !r.length)
                    )
                      return [];
                    e = new Map();
                    for (var i = (r = g(r)).next(); !i.done; i = r.next()) {
                      var n = (i = i.value).originalAudioId;
                      (n || null == i.audioId || (n = String(i.audioId)),
                        !n && i.codecs.includes(",") && i.audioCodec && (n = "muxed-in-video"),
                        n &&
                          ((n += [
                            i.language,
                            i.label,
                            i.channelsCount,
                            i.spatialAudio,
                            i.audioCodec || "",
                          ].join("_")),
                          e.set(n, {
                            active: i.active,
                            language: i.language,
                            label: i.label,
                            mimeType: i.audioMimeType,
                            codecs: i.audioCodec,
                            primary: i.primary,
                            roles: i.audioRoles || [],
                            accessibilityPurpose: i.accessibilityPurpose,
                            channelsCount: i.channelsCount,
                            audioSamplingRate: i.audioSamplingRate,
                            spatialAudio: i.spatialAudio,
                            originalLanguage: i.originalLanguage,
                          })));
                    }
                    return Array.from(e.values());
                  }
                  return this.h && this.h.audioTracks
                    ? Array.from(this.h.audioTracks).map(function (e) {
                        var t = e.language;
                        return (
                          (t = {
                            active: e.enabled,
                            language: Fi(t || "und"),
                            label: e.label,
                            mimeType: null,
                            codecs: null,
                            primary: "main" == e.kind,
                            roles: [],
                            accessibilityPurpose: null,
                            channelsCount: null,
                            audioSamplingRate: null,
                            spatialAudio: !1,
                            originalLanguage: t,
                          }),
                          e.kind &&
                            ("description" == e.kind && (t.accessibilityPurpose = "visually impaired"),
                            t.roles.push(e.kind)),
                          e.configuration &&
                            (e.configuration.codec && (t.codecs = e.configuration.codec),
                            e.configuration.sampleRate && (t.audioSamplingRate = e.configuration.sampleRate),
                            e.configuration.numberOfChannels &&
                              (t.channelsCount = e.configuration.numberOfChannels)),
                          t
                        );
                      })
                    : [];
                }),
                (n.Yk = function (e, t, r) {
                  ((t = void 0 !== t && t), (r = void 0 === r ? 0 : r));
                  var i = this.qc();
                  if (i.length) {
                    var n,
                      a = i.find(function (e) {
                        return e.active;
                      });
                    a &&
                      ((n =
                        1 ==
                        (i = i.filter(function (t) {
                          return (
                            (t.videoBandwidth || t.bandwidth) == e.bandwidth &&
                            t.width == e.width &&
                            t.height == e.height &&
                            t.frameRate == e.frameRate &&
                            t.pixelAspectRatio == e.pixelAspectRatio &&
                            t.hdr == e.hdr &&
                            t.colorGamut == e.colorGamut &&
                            t.videoLayout == e.videoLayout &&
                            t.videoMimeType == e.mimeType &&
                            t.videoCodec == e.codecs &&
                            ee(t.videoRoles, e.roles) &&
                            t.videoLabel == e.label
                          );
                        })).length
                          ? i[0]
                          : i.find(function (e) {
                              return e.audioId === a.audioId;
                            })) ||
                        (n = i.find(function (e) {
                          return (
                            e.language == a.language &&
                            e.label === a.label &&
                            e.channelsCount === a.channelsCount &&
                            e.spatialAudio === a.spatialAudio &&
                            e.audioMimeType === a.audioMimeType &&
                            ci(e.audioCodec || "") === ci(a.audioCodec || "") &&
                            ee(e.audioRoles, a.audioRoles)
                          );
                        })),
                      n && !n.active && this.Jf(n, t, r));
                  }
                }),
                (n.getVideoTracks = function () {
                  if (this.m == af || this.xa()) return [];
                  var e = this.qc();
                  if (!e.length) return [];
                  var t = e.find(function (e) {
                    return e.active;
                  });
                  if (!t) return [];
                  var r = e;
                  if (
                    (this.ti() ||
                      (r = e.filter(function (e) {
                        return (
                          !(
                            !e.videoCodec ||
                            e.audioGroupId !== t.audioGroupId ||
                            e.originalAudioId !== t.originalAudioId
                          ) &&
                          (e.audioId === t.audioId ||
                            (e.language === t.language &&
                              e.label === t.label &&
                              e.channelsCount === t.channelsCount &&
                              e.spatialAudio === t.spatialAudio &&
                              e.audioMimeType === t.audioMimeType &&
                              ci(e.audioCodec || "") === ci(t.audioCodec || "") &&
                              ee(e.audioRoles, t.audioRoles)))
                        );
                      })),
                    !r.length)
                  )
                    return [];
                  e = new Map();
                  for (var i = (r = g(r)).next(); !i.done; i = r.next()) {
                    var n = (i = i.value).originalVideoId;
                    (n || null == i.videoId || (n = String(i.videoId)),
                      n &&
                        e.set(n, {
                          active: i.active,
                          bandwidth: i.videoBandwidth || i.bandwidth,
                          width: i.width,
                          height: i.height,
                          frameRate: i.frameRate,
                          pixelAspectRatio: i.pixelAspectRatio,
                          hdr: i.hdr,
                          colorGamut: i.colorGamut,
                          videoLayout: i.videoLayout,
                          mimeType: i.videoMimeType,
                          codecs: i.videoCodec,
                          roles: i.videoRoles || [],
                          label: i.videoLabel,
                        }));
                  }
                  return Array.from(e.values());
                }),
                (n.Dj = function () {
                  return ef(this.qc());
                }),
                (n.$j = function () {
                  return ef(this.Lc());
                }),
                (n.Cj = function () {
                  return Array.from(Zc(this.qc()));
                }),
                (n.Zj = function () {
                  return Array.from(Zc(this.Lc()));
                }),
                (n.Ti = function (e, t, r, i, n, a, s) {
                  var o = this;
                  ((r = void 0 === r ? 0 : r),
                    (i = void 0 === i ? 0 : i),
                    (n = void 0 === n ? "" : n),
                    (a = void 0 !== a && a),
                    (s = void 0 === s ? "" : s),
                    (this.i &&
                      this.G &&
                      ((function () {
                        function l(e, t) {
                          return e.video || t.video
                            ? e.video && t.video
                              ? Math.abs((e.video.height || 0) - (t.video.height || 0)) +
                                Math.abs((e.video.width || 0) - (t.video.width || 0))
                              : 1 / 0
                            : 0;
                        }
                        var u = o.l.o;
                        ((o.J = o.g.adaptationSetCriteriaFactory()),
                          o.J.configure({
                            language: e,
                            role: t || "",
                            videoRole: (u.video && u.video.roles && u.video.roles[0]) || "",
                            channelCount: r || 0,
                            hdrLevel: "",
                            spatialAudio: a || !1,
                            videoLayout: "",
                            audioLabel: s || "",
                            videoLabel: "",
                            codecSwitchingStrategy: o.g.mediaSource.codecSwitchingStrategy,
                            audioCodec: n || "",
                            activeAudioCodec: u.audio && u.audio.codecs ? u.audio.codecs : "",
                            activeAudioChannelCount:
                              u.audio && u.audio.channelsCount ? u.audio.channelsCount : 0,
                            preferredAudioCodecs: o.g.preferredAudioCodecs,
                            preferredAudioChannelCount: o.g.preferredAudioChannelCount,
                          }));
                        for (
                          var d = o.J.create(o.i.variants), h = null, c = (d = g(d.values())).next();
                          !c.done;
                          c = d.next()
                        )
                          on((c = c.value)) && (!h || l(h, u) > l(c, u)) && (h = c);
                        h != u && (h ? ((u = en(h)), o.Jf(u, !0, i || 0)) : Pc(o));
                      })(),
                      !this.xa())) ||
                      (function () {
                        if (o.h && o.h.audioTracks) {
                          var r = un(o.qc(), e, t || "", !1)[0];
                          r && o.Jf(r);
                        }
                      })());
                }),
                (n.oh = function (e, t, r) {
                  var i,
                    n = this;
                  ((r = void 0 !== r && r),
                    (this.i &&
                      this.G &&
                      ((function () {
                        ((n.Kd = e), (n.Od = t || ""), (n.Nd = r || !1));
                        var i = un(n.i.textStreams, n.Kd, n.Od, n.Nd)[0] || null;
                        i &&
                          i != n.l.B &&
                          (ud(n.B.h, i, !1), n.g.streaming.alwaysStreamText || n.Sg()) &&
                          (fu(n.l, i), Gc(n), Kc(n));
                      })(),
                      !this.xa())) ||
                      ((i = un(n.Lc(), e, t || "", r || !1)[0]) && n.ph(i)));
                }),
                (n.Xk = function (e, t, r) {
                  var i = this;
                  ((t = void 0 === t || t),
                    (r = void 0 === r ? 0 : r),
                    (this.i &&
                      this.G &&
                      ((function () {
                        for (var n = null, a = g(i.i.variants), s = a.next(); !s.done; s = a.next())
                          if ((s = s.value).audio.label == e) {
                            n = s;
                            break;
                          }
                        null != n &&
                          ((i.J = i.g.adaptationSetCriteriaFactory()),
                          i.J.configure({
                            language: n.language,
                            role: "",
                            videoRole: "",
                            channelCount: 0,
                            hdrLevel: "",
                            spatialAudio: !1,
                            videoLayout: "",
                            videoLabel: "",
                            audioLabel: e,
                            codecSwitchingStrategy: i.g.mediaSource.codecSwitchingStrategy,
                            audioCodec: "",
                            activeAudioCodec: "",
                            activeAudioChannelCount: 0,
                            preferredAudioCodecs: i.g.preferredAudioCodecs,
                            preferredAudioChannelCount: i.g.preferredAudioChannelCount,
                          }),
                          Pc(i, t, r));
                      })(),
                      !this.xa())) ||
                      (function () {
                        if (i.h && i.h.audioTracks) {
                          for (
                            var t = Array.from(i.h.audioTracks), r = null, n = (t = g(t)).next();
                            !n.done;
                            n = t.next()
                          )
                            (n = n.value).label == e && (r = n);
                          r && Nc(i, r);
                        }
                      })());
                }),
                (n.Sg = function () {
                  var e = this.$;
                  return this.u ? this.u.isTextVisible() : e;
                }),
                (n.Hj = function () {
                  return this.ob.map(function (e) {
                    return tn(e);
                  });
                }),
                (n.Fj = function (e) {
                  if ((he("getChapters", "Please use an getChaptersAsync."), !this.ob.length)) return [];
                  var t = Fi(e);
                  if (
                    !(e = this.ob.filter(function (e) {
                      return Fi(e.language) == t;
                    })).length
                  )
                    return [];
                  for (var r = [], i = new Set(), n = (e = g(e)).next(); !n.done; n = e.next())
                    (n = n.value).segmentIndex &&
                      n.segmentIndex.Fb(function (e) {
                        var t = e.P()[0],
                          n = e.startTime + "-" + e.endTime + "-" + t;
                        ((e = { id: n, title: t, startTime: e.startTime, endTime: e.endTime }),
                          i.has(n) || (r.push(e), i.add(n)));
                      });
                  return r;
                }),
                (n.Gj = function (e) {
                  var t,
                    r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l = this;
                  return D(function (u) {
                    switch (u.g) {
                      case 1:
                        if (!l.ob.length) return u.return([]);
                        if (
                          ((t = Fi(e)),
                          !(r = l.ob.filter(function (e) {
                            return Fi(e.language) == t;
                          })).length)
                        )
                          return u.return([]);
                        ((i = []), (n = new Set()), (a = g(r)), (s = a.next()));
                      case 2:
                        if (s.done) {
                          u.A(4);
                          break;
                        }
                        if ((o = s.value).segmentIndex) {
                          u.A(5);
                          break;
                        }
                        return b(u, o.createSegmentIndex(), 5);
                      case 5:
                        (o.segmentIndex.Fb(function (e) {
                          var t = e.P()[0],
                            r = e.startTime + "-" + e.endTime + "-" + t;
                          ((e = { id: r, title: t, startTime: e.startTime, endTime: e.endTime }),
                            n.has(r) || (i.push(e), n.add(r)));
                        }),
                          (s = a.next()),
                          u.A(2));
                        break;
                      case 4:
                        return u.return(i);
                    }
                  });
                }),
                (n.wh = function (e) {
                  ((e = !!e),
                    this.$ != e &&
                      ((this.$ = e),
                      this.m == nf
                        ? (this.u.setTextVisibility(e),
                          this.g.streaming.alwaysStreamText ||
                            (e
                              ? this.l.B ||
                                ((e = un(this.i.textStreams, this.Kd, this.Od, this.Nd)).length > 0 &&
                                  (fu(this.l, e[0]), Gc(this), Kc(this)))
                              : (function (e) {
                                  var t = e.h.get(gt);
                                  (t &&
                                    (Lu(t),
                                    Mu(t).catch(function () {}),
                                    (e.H = e.h.get(gt)),
                                    e.h.delete(gt),
                                    t.stream && t.stream.closeSegmentIndex && t.stream.closeSegmentIndex()),
                                    (e.B = null));
                                })(this.l)))
                        : this.h && this.h.src && this.h.textTracks && this.u.setTextVisibility(e),
                      Vc(this)));
                }),
                (n.Tj = function () {
                  if (this.G) var e = this.G.Qd();
                  else {
                    if (null == this.O) return new Date();
                    if (this.O instanceof Date) return this.O;
                    e = this.O;
                  }
                  if (this.i && !this.xa()) {
                    var t = this.i.presentationTimeline;
                    return new Date(1e3 * ((t.m || t.i) + e));
                  }
                  return this.h && this.h.getStartDate
                    ? ((t = this.h.getStartDate()),
                      isNaN(t.getTime()) ? null : new Date(t.getTime() + 1e3 * e))
                    : null;
                }),
                (n.li = function () {
                  if (this.i && !this.xa()) {
                    var e = this.i.presentationTimeline;
                    return null === (e = e.m || e.i) ? null : new Date(1e3 * e);
                  }
                  return this.h && this.h.getStartDate
                    ? ((e = this.h.getStartDate()), isNaN(e.getTime()) ? null : e)
                    : null;
                }),
                (n.df = function () {
                  return this.W() && this.i ? this.i.presentationTimeline.df() : null;
                }),
                (n.Gc = function () {
                  if (this.m == nf) return this.H.Gc();
                  var e = { total: [], audio: [], video: [], text: [] };
                  return (this.m == af && (e.total = Xs(this.h.buffered)), e);
                }),
                (n.getBandwidthEstimate = function () {
                  return this.o ? this.o.getBandwidthEstimate() : NaN;
                }),
                (n.getStats = function () {
                  if (this.m != nf && this.m != af)
                    return {
                      width: NaN,
                      height: NaN,
                      currentCodecs: "",
                      streamBandwidth: NaN,
                      decodedFrames: NaN,
                      droppedFrames: NaN,
                      corruptedFrames: NaN,
                      stallsDetected: NaN,
                      gapsJumped: NaN,
                      estimatedBandwidth: NaN,
                      completionPercent: NaN,
                      loadLatency: NaN,
                      manifestTimeSeconds: NaN,
                      drmTimeSeconds: NaN,
                      playTime: NaN,
                      pauseTime: NaN,
                      bufferingTime: NaN,
                      licenseTime: NaN,
                      liveLatency: NaN,
                      maxSegmentDuration: NaN,
                      manifestSizeBytes: NaN,
                      bytesDownloaded: NaN,
                      nonFatalErrorCount: NaN,
                      manifestPeriodCount: NaN,
                      manifestGapCount: NaN,
                      switchHistory: [],
                      stateHistory: [],
                    };
                  Cc(this);
                  var e = this.h,
                    t = e.currentTime / e.duration;
                  if (
                    (isNaN(t) ||
                      this.W() ||
                      (function (e, t) {
                        e.i = isNaN(e.i) ? t : Math.max(e.i, t);
                      })(this.B, Math.round(100 * t)),
                    this.G && ((this.B.T = this.G.Lh()), (this.B.V = this.G.Nh())),
                    e.getVideoPlaybackQuality &&
                      ((t = e.getVideoPlaybackQuality()),
                      (function (e, t, r) {
                        ((e.R = t), (e.O = r));
                      })(this.B, Number(t.droppedVideoFrames), Number(t.totalVideoFrames)),
                      (this.B.N = Number(t.corruptedVideoFrames))),
                    (this.B.o = this.F
                      ? (function (e) {
                          return e.J ? e.J : NaN;
                        })(this.F)
                      : NaN),
                    hd(this.B, e.videoWidth || NaN, e.videoHeight || NaN),
                    (this.B.l = ""),
                    this.W() && null != (e = Ec(this)) && (this.B.F = e / 1e3),
                    (t = this.qc().find(function (e) {
                      return e.active;
                    })),
                    (e = this.Lc().find(function (e) {
                      return e.active;
                    })),
                    t)
                  ) {
                    if (t.bandwidth) {
                      var r = this.M ? this.M.i : 1,
                        i = r * t.bandwidth;
                      (e && e.bandwidth && (i += r * e.bandwidth), (this.B.B = i));
                    }
                    (t.width && t.height && hd(this.B, t.width || NaN, t.height || NaN),
                      (t = t.codecs),
                      e && (t += "," + (e.codecs || e.mimeType)),
                      t && (this.B.l = t));
                  }
                  return (
                    this.m != nf ||
                      this.xa() ||
                      (this.i &&
                        ((this.B.I = this.i.periodCount),
                        (this.B.H = this.i.gapCount),
                        this.i.presentationTimeline && (this.B.K = this.i.presentationTimeline.h)),
                      (e = this.o.getBandwidthEstimate()),
                      (this.B.u = e)),
                    this.m == af && cd(this.B, NaN),
                    fd(this.B)
                  );
                }),
                (n.Rd = function (e, t, r, i, n, a, s) {
                  s = void 0 !== s && s;
                  var o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    g,
                    m,
                    v = this;
                  return D(function (y) {
                    switch (y.g) {
                      case 1:
                        if (v.m != nf && v.m != af) throw new ze(1, 7, 7004);
                        if (
                          ("subtitles" != r &&
                            "captions" != r &&
                            z(
                              "Using a kind value different of `subtitles` or `captions` can cause unwanted issues.",
                            ),
                          i)
                        ) {
                          y.A(2);
                          break;
                        }
                        return b(y, xc(v, e), 3);
                      case 3:
                        i = y.h;
                      case 2:
                        if (((o = []), v.C && (o = v.C.getCuePoints()), v.m != af)) {
                          y.A(4);
                          break;
                        }
                        return (
                          (l = se()),
                          s && "WEBKIT" === l.Ha() && (r = "forced"),
                          b(
                            y,
                            (function (e, t, r, i, n, a, s) {
                              var o, l, u, d;
                              return D(function (h) {
                                if (1 == h.g) return "text/vtt" != n || s.length ? b(h, wc(e, t), 3) : h.A(2);
                                (2 != h.g &&
                                  ((o = h.h),
                                  (l = Ac(e, o, n, s)),
                                  (u = new Blob([l], { type: "text/vtt" })),
                                  (t = il(u)),
                                  (n = "text/vtt")),
                                  (d = document.createElement("track")));
                                e: {
                                  var c = e.K,
                                    f = t;
                                  try {
                                    if (!c.g.enabled) {
                                      var p = f;
                                      break e;
                                    }
                                    var g = rh(c);
                                    ((g.ot = bh), (g.su = !0), (p = ph(f, ch(g))));
                                    break e;
                                  } catch (m) {
                                    (q(
                                      "CMCD_TEXT_TRACK_ERROR",
                                      "Could not generate text track CMCD data.",
                                      m,
                                    ),
                                      (p = f));
                                    break e;
                                  }
                                  p = void 0;
                                }
                                return (
                                  (d.src = p),
                                  (d.label = a),
                                  (d.kind = i),
                                  (d.srclang = r),
                                  e.h.getAttribute("crossorigin") ||
                                    e.h.setAttribute("crossorigin", "anonymous"),
                                  e.h.appendChild(d),
                                  e.cg.push(d),
                                  h.return(d)
                                );
                              });
                            })(v, e, t, r, i, a || "", o),
                            5,
                          )
                        );
                      case 5:
                        if ((u = y.h).track) return (Uc(v), Gc(v), y.return(an(u.track)));
                        throw new ze(1, 2, 2012);
                      case 4:
                        if (
                          ((d = mt),
                          (h = v.Ra()),
                          (c = h.end - h.start),
                          v.i && (c = v.i.presentationTimeline.getDuration()),
                          c == 1 / 0)
                        )
                          throw new ze(1, 4, 4033);
                        if (!o.length) {
                          y.A(6);
                          break;
                        }
                        return b(y, wc(v, e), 7);
                      case 7:
                        ((f = y.h),
                          (p = Ac(v, f, i, o)),
                          (g = new Blob([p], { type: "text/vtt" })),
                          (e = il(g)),
                          (i = "text/vtt"));
                      case 6:
                        if (
                          ((m = {
                            id: v.Fe++,
                            originalId: null,
                            groupId: null,
                            createSegmentIndex: function () {
                              return Promise.resolve();
                            },
                            segmentIndex: _l(0, c, [e]),
                            mimeType: i || "",
                            codecs: n || "",
                            kind: r,
                            encrypted: !1,
                            drmInfos: [],
                            keyIds: new Set(),
                            language: t,
                            originalLanguage: t,
                            label: a || null,
                            type: d.Na,
                            primary: !1,
                            trickModeVideo: null,
                            dependencyStream: null,
                            emsgSchemeIdUris: null,
                            roles: [],
                            forced: !!s,
                            channelsCount: null,
                            audioSamplingRate: null,
                            spatialAudio: !1,
                            closedCaptions: null,
                            accessibilityPurpose: null,
                            external: !0,
                            fastSwitching: !1,
                            fullMimeTypes: new Set([li(i || "", n || "")]),
                            isAudioMuxedInVideo: !1,
                            baseOriginalId: null,
                          }),
                          !Ei(li(m.mimeType, m.codecs)))
                        )
                          throw new ze(2, 2, 2014, i);
                        return (v.i.textStreams.push(m), Uc(v), Gc(v), y.return(tn(m)));
                    }
                  });
                }),
                (n.Pe = function (e, t) {
                  var r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    m,
                    v,
                    y,
                    T,
                    S,
                    E = this;
                  return D(function (x) {
                    switch (x.g) {
                      case 1:
                        if (E.m != nf && E.m != af) throw new ze(1, 7, 7004);
                        if (t) {
                          x.A(2);
                          break;
                        }
                        return b(x, xc(E, e), 3);
                      case 3:
                        t = x.h;
                      case 2:
                        if ("text/vtt" != t) throw new ze(1, 2, 2017, e);
                        if (
                          ((r = mt),
                          (i = E.Ra()),
                          (n = i.end - i.start),
                          E.i && (n = E.i.presentationTimeline.getDuration()),
                          n == 1 / 0)
                        )
                          throw new ze(1, 4, 4045);
                        return b(x, wc(E, e), 4);
                      case 4:
                        if (((a = x.h), !(s = Si(t)))) throw new ze(2, 2, 2014, t);
                        for (
                          o = s(),
                            l = { periodStart: 0, segmentStart: 0, segmentEnd: n, vttOffset: 0 },
                            u = Oe(a),
                            d = o.parseMedia(u, l, e, []),
                            h = [],
                            c = g(d),
                            f = c.next(),
                            p = {};
                          !f.done;
                          p = { Wf: void 0, nd: void 0 }, f = c.next()
                        )
                          ((p.nd = f.value),
                            (p.Wf = null),
                            (m = (function (t) {
                              return function () {
                                return (null == t.Wf && (t.Wf = ut([e], [t.nd.payload])), t.Wf || []);
                              };
                            })(p)),
                            (v = new Bs(p.nd.startTime, p.nd.endTime, m, 0, null, null, 0, 0, 1 / 0)),
                            p.nd.payload.includes("#xywh") &&
                              4 === (y = p.nd.payload.split("#xywh=")[1].split(",")).length &&
                              v.Mf({
                                height: parseInt(y[3], 10),
                                positionX: parseInt(y[0], 10),
                                positionY: parseInt(y[1], 10),
                                width: parseInt(y[2], 10),
                              }),
                            h.push(v));
                        if (((T = t), !h.length)) {
                          x.A(5);
                          break;
                        }
                        return b(x, xc(E, h[0].P()[0]), 6);
                      case 6:
                        T = x.h;
                      case 5:
                        return (
                          (S = {
                            id: E.Fe++,
                            originalId: null,
                            groupId: null,
                            createSegmentIndex: function () {
                              return Promise.resolve();
                            },
                            segmentIndex: new Ml(h),
                            mimeType: T || "",
                            codecs: "",
                            kind: "",
                            encrypted: !1,
                            drmInfos: [],
                            keyIds: new Set(),
                            language: "und",
                            originalLanguage: null,
                            label: null,
                            type: r.Yf,
                            primary: !1,
                            trickModeVideo: null,
                            dependencyStream: null,
                            emsgSchemeIdUris: null,
                            roles: [],
                            forced: !1,
                            channelsCount: null,
                            audioSamplingRate: null,
                            spatialAudio: !1,
                            closedCaptions: null,
                            tilesLayout: "1x1",
                            accessibilityPurpose: null,
                            external: !0,
                            fastSwitching: !1,
                            fullMimeTypes: new Set([li(T || "", "")]),
                            isAudioMuxedInVideo: !1,
                            baseOriginalId: null,
                          }),
                          E.m == af ? E.Ke.push(S) : E.i.imageStreams.push(S),
                          Uc(E),
                          x.return(rn(S))
                        );
                    }
                  });
                }),
                (n.Oe = function (e, t, r) {
                  var i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    m,
                    v,
                    y,
                    T = this;
                  return D(function (S) {
                    switch (S.g) {
                      case 1:
                        if (T.m != nf && T.m != af) throw new ze(1, 7, 7004);
                        if (r) {
                          S.A(2);
                          break;
                        }
                        return b(S, xc(T, e), 3);
                      case 3:
                        r = S.h;
                      case 2:
                        if (
                          ((i = mt),
                          (n = T.Ra()),
                          (a = n.end - n.start),
                          T.i && (a = T.i.presentationTimeline.getDuration()),
                          a == 1 / 0)
                        )
                          throw new ze(1, 4, 4055);
                        if (!(s = Si(r))) throw new ze(2, 2, 2014, r);
                        return b(S, wc(T, e), 4);
                      case 4:
                        for (
                          o = S.h,
                            l = s(),
                            u = { periodStart: 0, segmentStart: 0, segmentEnd: a, vttOffset: 0 },
                            d = Oe(o),
                            h = l.parseMedia(d, u, e, []),
                            c = [],
                            f = g(h),
                            p = f.next(),
                            m = {};
                          !p.done;
                          m = { Xe: void 0 }, p = f.next()
                        )
                          ((m.Xe = p.value),
                            (v = new Bs(
                              m.Xe.startTime,
                              m.Xe.endTime,
                              (function (e) {
                                return function () {
                                  return [e.Xe.payload];
                                };
                              })(m),
                              0,
                              null,
                              null,
                              0,
                              0,
                              1 / 0,
                            )),
                            c.push(v));
                        return (
                          (y = {
                            id: T.Fe++,
                            originalId: null,
                            groupId: null,
                            createSegmentIndex: function () {
                              return Promise.resolve();
                            },
                            segmentIndex: new Ml(c),
                            mimeType: "text/plain",
                            codecs: "",
                            kind: "",
                            encrypted: !1,
                            drmInfos: [],
                            keyIds: new Set(),
                            language: t,
                            originalLanguage: t,
                            label: null,
                            type: i.Na,
                            primary: !1,
                            trickModeVideo: null,
                            dependencyStream: null,
                            emsgSchemeIdUris: null,
                            roles: [],
                            forced: !1,
                            channelsCount: null,
                            audioSamplingRate: null,
                            spatialAudio: !1,
                            closedCaptions: null,
                            accessibilityPurpose: null,
                            external: !0,
                            fastSwitching: !1,
                            fullMimeTypes: new Set([li("text/plain", "")]),
                            isAudioMuxedInVideo: !1,
                            baseOriginalId: null,
                          }),
                          T.ob.push(y),
                          Uc(T),
                          S.return(tn(y))
                        );
                    }
                  });
                }),
                (n.fl = function (e, t) {
                  ((this.ya.width = e), (this.ya.height = t));
                }),
                (n.kh = function (e) {
                  if (this.m == nf) {
                    var t = this.l;
                    if (((e = void 0 === e ? 0.1 : e), t.l.g)) t = !1;
                    else if (t.F) t = !1;
                    else {
                      for (var r = g(t.h.values()), i = r.next(); !i.done; i = r.next())
                        !(i = i.value).ce || i.Ka || i.qb || ((i.ce = !1), Cu(t, i, e));
                      t = !0;
                    }
                  } else t = !1;
                  return t;
                }),
                (n.Lg = function () {
                  return (
                    z(
                      "Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for.",
                    ),
                    this.i
                  );
                }),
                (n.Qj = function () {
                  return this.zc;
                }),
                (n.Lj = function () {
                  var e = { video: null, audio: null, text: null };
                  if (this.m != nf) return e;
                  for (
                    var t = this.l.o,
                      r = this.h.currentTime,
                      i = (t = g([t.video, t.audio, this.l.B])).next();
                    !i.done;
                    i = t.next()
                  )
                    if ((i = i.value) && i.segmentIndex) {
                      var n = i.segmentIndex.find(r);
                      ((n = {
                        codecs: (n = i.segmentIndex.get(n)).codecs || i.codecs,
                        mimeType: n.mimeType || i.mimeType,
                        bandwidth: n.bandwidth || i.bandwidth,
                      }),
                        "video" == i.type
                          ? ((n.width = i.width), (n.height = i.height), (e.video = n))
                          : "audio" == i.type
                            ? (e.audio = n)
                            : i.type == gt && (e.text = n));
                    }
                  return e;
                }),
                (n.Zi = function (e) {
                  this.Be = e;
                }),
                (n.disableStream = function (e, t) {
                  if (!this.g.abr.enabled || this.m === tf || !navigator.onLine || 0 == t || !this.i)
                    return !1;
                  if (
                    this.i.variants.some(function (t) {
                      var r = t[e.type];
                      return !(
                        !r ||
                        r.id === e.id ||
                        t.disabledUntilTime ||
                        ("audio" == e.type && e.language !== r.language)
                      );
                    })
                  ) {
                    for (var r = !1, i = !1, n = g(this.i.variants), a = n.next(); !a.done; a = n.next()) {
                      var s = (a = a.value)[e.type];
                      s &&
                        (s.id === e.id
                          ? ((a.disabledUntilTime = Date.now() / 1e3 + t), (r = !0))
                          : s.trickModeVideo && s.trickModeVideo.id == e.id && (i = !0));
                    }
                    return !(
                      (!r && i) ||
                      (this.He.Ea(1),
                      (t = this.Gc().video.reduce(function (e, t) {
                        return e + t.end - t.start;
                      }, 0)),
                      Pc(this, !1, t, !0, !1),
                      0)
                    );
                  }
                  return !1;
                }),
                (n.addFont = function (t, r) {
                  return (function (t, r) {
                    var i, n, a, s, o;
                    return D(function (l) {
                      if (1 == l.g)
                        return "fonts" in document && "FontFace" in e
                          ? b(l, document.fonts.ready, 2)
                          : l.return();
                      if (!("entries" in document.fonts)) return l.return();
                      for (
                        i = function (e) {
                          for (var t = [], r = (e = e.entries()).next(); !1 === r.done; )
                            (t.push(r.value), (r = e.next()));
                          return t;
                        },
                          n = g(i(document.fonts)),
                          a = n.next();
                        !a.done;
                        a = n.next()
                      )
                        if ((s = a.value).family === t && "swap" === s.display) return l.return();
                      ((o = new FontFace(t, "url(" + r + ")", { display: "swap" })),
                        document.fonts.add(o),
                        S(l));
                    });
                  })(t, r);
                }),
                (n.xa = function () {
                  return !(!this.h || !this.h.remote) && "disconnected" != this.h.remote.state;
                }),
                (n.ge = function () {
                  return (
                    !(this.h && !this.h.ended) ||
                    (this.Ua && !this.W() && this.h.currentTime >= this.Ra().end)
                  );
                }),
                j("shaka.Player", Qh),
                (Qh.prototype.isEnded = Qh.prototype.ge),
                (Qh.prototype.isRemotePlayback = Qh.prototype.xa),
                (Qh.prototype.addFont = Qh.prototype.addFont),
                (Qh.prototype.setVideoContainer = Qh.prototype.Zi),
                (Qh.prototype.getFetchedPlaybackInfo = Qh.prototype.Lj),
                (Qh.prototype.getManifestParserFactory = Qh.prototype.Qj),
                (Qh.prototype.getManifest = Qh.prototype.Lg),
                (Qh.prototype.retryStreaming = Qh.prototype.kh),
                (Qh.prototype.setMaxHardwareResolution = Qh.prototype.fl),
                (Qh.prototype.addChaptersTrack = Qh.prototype.Oe),
                (Qh.prototype.addThumbnailsTrack = Qh.prototype.Pe),
                (Qh.prototype.addTextTrackAsync = Qh.prototype.Rd),
                (Qh.prototype.getStats = Qh.prototype.getStats),
                (Qh.prototype.getBufferedInfo = Qh.prototype.Gc),
                (Qh.prototype.getSegmentAvailabilityDuration = Qh.prototype.df),
                (Qh.prototype.getPresentationStartTimeAsDate = Qh.prototype.li),
                (Qh.prototype.getPlayheadTimeAsDate = Qh.prototype.Tj),
                (Qh.prototype.setTextTrackVisibility = Qh.prototype.wh),
                (Qh.prototype.getChaptersAsync = Qh.prototype.Gj),
                (Qh.prototype.getChapters = Qh.prototype.Fj),
                (Qh.prototype.getChaptersTracks = Qh.prototype.Hj),
                (Qh.prototype.isTextTrackVisible = Qh.prototype.Sg),
                (Qh.prototype.selectVariantsByLabel = Qh.prototype.Xk),
                (Qh.prototype.selectTextLanguage = Qh.prototype.oh),
                (Qh.prototype.selectAudioLanguage = Qh.prototype.Ti),
                (Qh.prototype.getTextLanguages = Qh.prototype.Zj),
                (Qh.prototype.getAudioLanguages = Qh.prototype.Cj),
                (Qh.prototype.getTextLanguagesAndRoles = Qh.prototype.$j),
                (Qh.prototype.getAudioLanguagesAndRoles = Qh.prototype.Dj),
                (Qh.prototype.getVideoTracks = Qh.prototype.getVideoTracks),
                (Qh.prototype.selectVideoTrack = Qh.prototype.Yk),
                (Qh.prototype.getAudioTracks = Qh.prototype.getAudioTracks),
                (Qh.prototype.selectAudioTrack = Qh.prototype.Wk),
                (Qh.prototype.selectVariantTrack = Qh.prototype.Jf),
                (Qh.prototype.selectTextTrack = Qh.prototype.ph),
                (Qh.prototype.getThumbnails = Qh.prototype.ck),
                (Qh.prototype.getAllThumbnails = Qh.prototype.Bj),
                (Qh.prototype.getImageTracks = Qh.prototype.Nj),
                (Qh.prototype.getTextTracks = Qh.prototype.Lc),
                (Qh.prototype.getVariantTracks = Qh.prototype.qc),
                (Qh.prototype.cancelTrickPlay = Qh.prototype.Sd),
                (Qh.prototype.trickPlay = Qh.prototype.xe),
                (Qh.prototype.useTrickPlayTrackIfAvailable = Qh.prototype.Kh),
                (Qh.prototype.getPlaybackRate = Qh.prototype.Ob),
                (Qh.prototype.isBuffering = Qh.prototype.Rg),
                (Qh.prototype.getKeyStatuses = Qh.prototype.$e),
                (Qh.prototype.getActiveSessionsMetadata = Qh.prototype.Kg),
                (Qh.prototype.getExpiration = Qh.prototype.Zd),
                (Qh.prototype.drmInfo = Qh.prototype.drmInfo),
                (Qh.prototype.keySystem = Qh.prototype.keySystem),
                (Qh.prototype.isFullyLoaded = Qh.prototype.nk),
                (Qh.prototype.goToLive = Qh.prototype.ik),
                (Qh.prototype.seekRange = Qh.prototype.Ra),
                (Qh.prototype.isVideoOnly = Qh.prototype.ti),
                (Qh.prototype.isAudioOnly = Qh.prototype.lk),
                (Qh.prototype.isInProgress = Qh.prototype.Vc),
                (Qh.prototype.isLive = Qh.prototype.W),
                (Qh.prototype.getQueueManager = Qh.prototype.mi),
                (Qh.prototype.getAdManager = Qh.prototype.di),
                (Qh.prototype.getAssetUri = Qh.prototype.rd),
                (Qh.prototype.getNetworkingEngine = Qh.prototype.Yb),
                (Qh.prototype.getMediaElement = Qh.prototype.bf),
                (Qh.prototype.getManifestType = Qh.prototype.ii),
                (Qh.prototype.getLoadMode = Qh.prototype.$d),
                (Qh.prototype.resetConfiguration = Qh.prototype.Oi),
                (Qh.prototype.getBufferFullness = Qh.prototype.ei),
                (Qh.prototype.getNonDefaultConfiguration = Qh.prototype.ki),
                (Qh.prototype.getConfigurationForLowLatency = Qh.prototype.Ij),
                (Qh.prototype.getConfiguration = Qh.prototype.getConfiguration),
                (Qh.prototype.configurationForLowLatency = Qh.prototype.yj),
                (Qh.prototype.configure = Qh.prototype.configure),
                (Qh.prototype.releaseAllMutexes = Qh.prototype.Ok),
                (Qh.prototype.destroyAllPreloads = Qh.prototype.rg),
                (Qh.prototype.preload = Qh.prototype.preload),
                (Qh.prototype.detachAndSavePreload = Qh.prototype.$h),
                (Qh.prototype.unloadAndSavePreload = Qh.prototype.jj),
                (Qh.prototype.load = Qh.prototype.load),
                (Qh.prototype.updateStartTime = Qh.prototype.ql),
                (Qh.prototype.unload = Qh.prototype.Cc),
                (Qh.prototype.detach = Qh.prototype.detach),
                (Qh.prototype.attachCanvas = Qh.prototype.qj),
                (Qh.prototype.attach = Qh.prototype.Vb),
                (Qh.probeSupport = function (t) {
                  var r, i, n, a, s;
                  return (
                    (t = void 0 === t || t),
                    D(function (o) {
                      switch (o.g) {
                        case 1:
                          if (((r = {}), !t)) {
                            o.A(2);
                            break;
                          }
                          return b(
                            o,
                            (function () {
                              var t,
                                r,
                                i,
                                n,
                                a,
                                s,
                                o,
                                l,
                                u,
                                d,
                                h,
                                c,
                                f,
                                p,
                                m,
                                v,
                                y,
                                T,
                                x,
                                I,
                                k,
                                R,
                                C,
                                L,
                                M,
                                _;
                              return D(function (P) {
                                if (1 == P.g) {
                                  if (
                                    ((t =
                                      "org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.microsoft.playready.recommendation.3000 com.microsoft.playready.recommendation.3000.clearlead com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(
                                        " ",
                                      )),
                                    !(
                                      e.MediaKeys &&
                                      e.navigator &&
                                      e.navigator.requestMediaKeySystemAccess &&
                                      e.MediaKeySystemAccess &&
                                      e.MediaKeySystemAccess.prototype.getConfiguration
                                    ))
                                  ) {
                                    for (r = {}, i = g(t), n = i.next(); !n.done; n = i.next())
                                      ((a = n.value), (r[a] = null));
                                    return P.return(r);
                                  }
                                  for (
                                    s = "1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),
                                      l = {
                                        "com.widevine.alpha": (o = [
                                          "SW_SECURE_CRYPTO",
                                          "SW_SECURE_DECODE",
                                          "HW_SECURE_CRYPTO",
                                          "HW_SECURE_DECODE",
                                          "HW_SECURE_ALL",
                                        ]),
                                        "com.widevine.alpha.experiment": o,
                                        "com.microsoft.playready.recommendation": ["150", "2000", "3000"],
                                      },
                                      u = {
                                        videoCapabilities: [
                                          { contentType: 'video/mp4; codecs="avc1.42E01E"' },
                                          { contentType: 'video/webm; codecs="vp8"' },
                                        ],
                                        audioCapabilities: [
                                          { contentType: 'audio/mp4; codecs="mp4a.40.2"' },
                                          { contentType: 'audio/webm; codecs="opus"' },
                                        ],
                                        initDataTypes: ["cenc", "sinf", "skd", "keyids"],
                                      },
                                      d = [null, "cenc", "cbcs"],
                                      h = new Map(),
                                      c = se(),
                                      f = function (e, t, r) {
                                        var i, n, a, o, l, u, d, f, p, m, v, y;
                                        return D(function (T) {
                                          switch (T.g) {
                                            case 1:
                                              return (E(T, 2), b(T, t.createMediaKeys(), 5));
                                            case 5:
                                              i = T.h;
                                            case 4:
                                              w(T, 3);
                                              break;
                                            case 2:
                                              return (A(T), T.return());
                                            case 3:
                                              if (
                                                ((a =
                                                  !!(n = t.getConfiguration().sessionTypes) &&
                                                  n.includes("persistent-license")),
                                                c.Ci() && (a = !1),
                                                (o = t.getConfiguration().videoCapabilities),
                                                (l = t.getConfiguration().audioCapabilities),
                                                (u = {
                                                  persistentState: a,
                                                  encryptionSchemes: [],
                                                  videoRobustnessLevels: [],
                                                  audioRobustnessLevels: [],
                                                  minHdcpVersions: [],
                                                }),
                                                h.get(e) ? (u = h.get(e)) : h.set(e, u),
                                                (d = o[0].encryptionScheme) &&
                                                  !u.encryptionSchemes.includes(d) &&
                                                  u.encryptionSchemes.push(d),
                                                (f = o[0].robustness) &&
                                                  !u.videoRobustnessLevels.includes(f) &&
                                                  u.videoRobustnessLevels.push(f),
                                                (p = l[0].robustness) &&
                                                  !u.audioRobustnessLevels.includes(p) &&
                                                  u.audioRobustnessLevels.push(p),
                                                !r || !("getStatusForPolicy" in i))
                                              ) {
                                                T.A(0);
                                                break;
                                              }
                                              ((m = g(s)), (v = m.next()));
                                            case 7:
                                              if (v.done) {
                                                T.A(0);
                                                break;
                                              }
                                              if (((y = v.value), u.minHdcpVersions.includes(y))) {
                                                T.A(8);
                                                break;
                                              }
                                              return b(T, i.getStatusForPolicy({ minHdcpVersion: y }), 10);
                                            case 10:
                                              if ("usable" != T.h) {
                                                T.A(0);
                                                break;
                                              }
                                              u.minHdcpVersions.includes(y) || u.minHdcpVersions.push(y);
                                            case 8:
                                              ((v = m.next()), T.A(7));
                                          }
                                        });
                                      },
                                      p = function (e, t, r, i, n) {
                                        var a, s, o, l, d, h, c, p, m, v;
                                        return (
                                          (n = void 0 !== n && n),
                                          D(function (y) {
                                            switch (y.g) {
                                              case 1:
                                                for (
                                                  E(y, 2),
                                                    a = Wt(u),
                                                    s = g(a.videoCapabilities),
                                                    o = s.next();
                                                  !o.done;
                                                  o = s.next()
                                                )
                                                  (((l = o.value).encryptionScheme = t), (l.robustness = r));
                                                for (
                                                  d = g(a.audioCapabilities), h = d.next();
                                                  !h.done;
                                                  h = d.next()
                                                )
                                                  (((c = h.value).encryptionScheme = t), (c.robustness = i));
                                                return (
                                                  ((p = Wt(a)).persistentState = "required"),
                                                  (p.sessionTypes = ["persistent-license"]),
                                                  (m = [p, a]),
                                                  "MOBILE" == se().Oa()
                                                    ? b(
                                                        y,
                                                        Di(5, navigator.requestMediaKeySystemAccess(e, m)),
                                                        7,
                                                      )
                                                    : b(y, navigator.requestMediaKeySystemAccess(e, m), 6)
                                                );
                                              case 6:
                                                ((v = y.h), y.A(5));
                                                break;
                                              case 7:
                                                v = y.h;
                                              case 5:
                                                return b(y, f(e, v, n), 8);
                                              case 8:
                                                w(y, 0);
                                                break;
                                              case 2:
                                                (A(y), S(y));
                                            }
                                          })
                                        );
                                      },
                                      m = function (e) {
                                        return "WEBKIT" !== se().Ha() || "org.w3.clearkey" !== e;
                                      },
                                      v = [],
                                      y = g(t),
                                      T = y.next();
                                    !T.done;
                                    T = y.next()
                                  )
                                    if (((x = T.value), h.set(x, null), m(x))) {
                                      for (I = !0, k = g(d), R = k.next(); !R.done; R = k.next())
                                        ((C = R.value), v.push(p(x, C, "", "", I)), (I = !1));
                                      for (L = g(l[x] || []), M = L.next(); !M.done; M = L.next())
                                        ((_ = M.value), v.push(p(x, null, _, "")), v.push(p(x, null, "", _)));
                                    }
                                  return b(P, Promise.all(v), 2);
                                }
                                return P.return(ta(h));
                              });
                            })(),
                            3,
                          );
                        case 3:
                          r = o.h;
                        case 2:
                          return (
                            (i = (function () {
                              var e = {};
                              if ((se(), Qv()))
                                for (var t = g(It.keys()), r = t.next(); !r.done; r = t.next())
                                  e[r.value] = !0;
                              for (
                                r = (t = g([
                                  "application/dash+xml",
                                  "application/x-mpegurl",
                                  "application/vnd.apple.mpegurl",
                                  "application/vnd.ms-sstr+xml",
                                ])).next();
                                !r.done;
                                r = t.next()
                              )
                                e[(r = r.value)] = Qv() ? It.has(r) : "" != eo().canPlayType(r);
                              return e;
                            })()),
                            (n = (function () {
                              var e =
                                  'video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.20000000.L153.B0",video/mp4; codecs="hvc1.2.4.L120.b0",video/mp4; codecs="hvc1.2.4.L123.b0",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="av01.0.31M.10.0.111.09.16.09.0",video/mp4; codecs="av01.0.31M.10.0.112.09.18.09.0",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.08.01",video/mp4; codecs="dav1.10.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.03",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",audio/mp4; codecs="apac.31.00",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'
                                    .split(",")
                                    .concat(m(yi)),
                                t = {};
                              se();
                              for (var r = (e = g(e)).next(); !r.done; r = e.next()) {
                                if (Ei((r = r.value))) t[r] = !0;
                                else if (Qv()) {
                                  var i = pi(r);
                                  ((i = li(i, Ji(gi(r), i))), (t[r] = Ja(i) || !!ti(i)));
                                } else t[r] = "" != eo().canPlayType(r);
                                t[(i = r.split(";")[0])] = t[i] || t[r];
                              }
                              return t;
                            })()),
                            b(o, se().lc(), 4)
                          );
                        case 4:
                          return (
                            (a = o.h),
                            (s = { manifest: i, media: n, drm: r, hardwareResolution: a }),
                            of.forEach(function (e, t) {
                              s[t] = e();
                            }),
                            o.return(s)
                          );
                      }
                    })
                  );
                }),
                (Qh.isBrowserSupported = function () {
                  return (
                    e.Promise || z("A Promise implementation or polyfill is required"),
                    !(
                      !(e.Promise && e.Uint8Array && Array.prototype.forEach) ||
                      (navigator.userAgent || "").includes("Trident/") ||
                      (se(), !Qv() && "" == eo().canPlayType("application/x-mpegurl"))
                    )
                  );
                }),
                (Qh.setQueueManagerFactory = function (e) {
                  uf = e;
                }),
                (Qh.setAdManagerFactory = function (e) {
                  lf = e;
                }),
                (Qh.registerSupportPlugin = ec),
                (Qh.prototype.destroy = Qh.prototype.destroy));
              var tf = 0,
                rf = 1,
                nf = 2,
                af = 3;
              ((Qh.LoadMode = { DESTROYED: tf, NOT_LOADED: rf, MEDIA_SOURCE: nf, SRC_EQUALS: af }),
                (Qh.version = "v4.16.12"));
              var sf = ["4", "16"];
              pe = new (function (e) {
                ((this.g = e), (this.i = ce), (this.h = fe));
              })(new de(Number(sf[0]), Number(sf[1])));
              var of = new Map(),
                lf = null,
                uf = null;
              function df() {
                ((this.g = []), (this.i = this.m = this.l = this.j = this.h = 0));
              }
              function hf(e) {
                return e.g.length
                  ? e.g.reduce(function (e, t) {
                      return e + t;
                    }, 0) / e.g.length
                  : 0;
              }
              function cf(e, t, r) {
                var i = this;
                ((this.g = e),
                  (this.h = t),
                  (this.m = r),
                  (this.i = !1),
                  (this.j = this.h.getVolume()),
                  (this.l = new re()),
                  this.l.D(this.h, google.ima.AdEvent.Type.PAUSED, function () {
                    i.i = !0;
                  }),
                  this.l.D(this.h, google.ima.AdEvent.Type.RESUMED, function () {
                    i.i = !1;
                  }));
              }
              function ff() {}
              function pf(e, t) {
                for (var r = [], i = (e = g(er(e, "Ad"))).next(); !i.done; i = e.next())
                  if ((i = nr(i.value, "InLine")) && (i = nr(i, "Creatives")))
                    for (var n = (i = g(er(i, "Creative"))).next(); !n.done; n = i.next()) {
                      var a = nr((n = n.value), "Linear");
                      if ((a && gf(r, t, a), (n = nr(n, "NonLinearAds"))))
                        for (var s = (n = g((n = er(n, "NonLinear")))).next(); !s.done; s = n.next())
                          e: {
                            a = r;
                            var o = t,
                              l = s.value,
                              u = nr(l, "StaticResource");
                            if (u) s = u.attributes.creativeType;
                            else {
                              if (!(u = nr(l, "HTMLResource"))) break e;
                              s = "text/html";
                            }
                            if ((u = rr(u))) {
                              "text/html" === s &&
                                (u = "data:text/html;charset=UTF-8," + encodeURIComponent(u));
                              var d = sr(l, "width", fr) || sr(l, "expandedWidth", fr),
                                h = sr(l, "height", fr) || sr(l, "expandedHeight", fr);
                              if (d || h) {
                                var c = null,
                                  f = nr(l, "NonLinearClickThrough");
                                (f && (f = rr(f)) && (c = f),
                                  (f = null),
                                  (l = l.attributes.minSuggestedDuration) && (f = Vt(l)),
                                  (l = 0),
                                  null != o && (l = o),
                                  a.push({
                                    id: null,
                                    groupId: null,
                                    startTime: l,
                                    endTime: null,
                                    uri: u,
                                    mimeType: s,
                                    isSkippable: !1,
                                    skipOffset: null,
                                    skipFor: null,
                                    canJump: !1,
                                    resumeOffset: 0,
                                    playoutLimit: f,
                                    once: !0,
                                    pre: null == o,
                                    post: o == 1 / 0,
                                    timelineRange: !1,
                                    loop: !1,
                                    overlay: {
                                      viewport: { x: 0, y: 0 },
                                      topLeft: { x: 0, y: 0 },
                                      size: { x: d || 0, y: h || 0 },
                                    },
                                    displayOnBackground: !1,
                                    currentVideo: null,
                                    background: null,
                                    clickThroughUrl: c,
                                  }));
                              }
                            }
                          }
                    }
                return r;
              }
              function gf(e, t, r) {
                var i = 0;
                null != t && (i = t);
                var n = null;
                r.attributes.skipoffset && ((n = Vt(r.attributes.skipoffset)), isNaN(n) && (n = null));
                var a = nr(r, "MediaFiles");
                if (a) {
                  var s = null;
                  for (
                    (r = nr(r, "VideoClicks")) && (r = nr(r, "ClickThrough")) && (r = rr(r)) && (s = r),
                      a = r = er(a, "MediaFile"),
                      r = r.filter(function (e) {
                        return "streaming" == e.attributes.delivery;
                      }),
                      r.length && (a = r),
                      a = a.sort(function (e, t) {
                        return (
                          (parseInt(t.attributes.height, 10) || 0) - (parseInt(e.attributes.height, 10) || 0)
                        );
                      }),
                      r = (a = g(a)).next();
                    !r.done;
                    r = a.next()
                  )
                    if (!(r = r.value).attributes.apiFramework) {
                      var o = rr(r);
                      if (o) {
                        e.push({
                          id: null,
                          groupId: null,
                          startTime: i,
                          endTime: null,
                          uri: o,
                          mimeType: r.attributes.type || null,
                          isSkippable: null != n,
                          skipOffset: n,
                          skipFor: null,
                          canJump: !1,
                          resumeOffset: 0,
                          playoutLimit: null,
                          once: !0,
                          pre: null == t,
                          post: t == 1 / 0,
                          timelineRange: !1,
                          loop: !1,
                          overlay: null,
                          displayOnBackground: !1,
                          currentVideo: null,
                          background: null,
                          clickThroughUrl: s,
                        });
                        break;
                      }
                    }
                }
              }
              function mf(t, r, i, n, a) {
                var s = this;
                ((this.u = t),
                  (this.i = r),
                  (this.G = !1),
                  (this.B = this.o = null),
                  (this.H = NaN),
                  (this.l = a),
                  (this.j = null),
                  (this.h = new re()),
                  google.ima.settings.setLocale(i),
                  google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),
                  (this.F = new google.ima.AdDisplayContainer(this.u, this.i)),
                  this.F.initialize(),
                  (this.m = new google.ima.AdsLoader(this.F)),
                  this.m.getSettings().setPlayerType("shaka-player"),
                  this.m.getSettings().setPlayerVersion("v4.16.12"),
                  (this.g = null),
                  (this.C = n || new google.ima.AdsRenderingSettings()),
                  this.h.D(this.m, google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, function (t) {
                    !(function (t, r) {
                      if (
                        (t.l(new Pn("ads-loaded", new Map().set("loadTime", Date.now() / 1e3 - t.H))),
                        t.o.customPlayheadTracker)
                      ) {
                        var i = { currentTime: t.i.currentTime };
                        ((t.g = r.getAdsManager(i, t.C)),
                          t.i.muted ? t.g.setVolume(0) : t.g.setVolume(t.i.volume),
                          t.h.D(t.i, "timeupdate", function () {
                            t.i.duration && (i.currentTime = t.i.currentTime);
                          }),
                          t.h.D(t.i, "volumechange", function () {
                            t.j && (t.j.setVolume(t.i.volume), t.i.muted && t.j.setMuted(!0));
                          }));
                      } else t.g = r.getAdsManager(t.i, t.C);
                      t.l(new Pn("ima-ad-manager-loaded", new Map().set("imaAdManager", t.g)));
                      var n = t.g.getCuePoints();
                      if (n.length) {
                        r = [];
                        for (var a = (n = g(n)).next(); !a.done; a = n.next())
                          r.push({ start: a.value, end: null });
                        t.l(new Pn("ad-cue-points-changed", new Map().set("cuepoints", r)));
                      }
                      !(function (e) {
                        function t(t, r) {
                          ((t = new Map().set("originalEvent", t)), e.l(new Pn(r, t)));
                        }
                        (e.h.D(e.g, google.ima.AdErrorEvent.Type.AD_ERROR, function (t) {
                          vf(e, t);
                        }),
                          e.h.D(e.g, google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED, function (t) {
                            yf(e, t);
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.STARTED, function (t) {
                            yf(e, t);
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.FIRST_QUARTILE, function (e) {
                            t(e, "ad-first-quartile");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.MIDPOINT, function (e) {
                            t(e, "ad-midpoint");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.THIRD_QUARTILE, function (e) {
                            t(e, "ad-third-quartile");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.COMPLETE, function (e) {
                            t(e, "ad-complete");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED, function (t) {
                            Tf(e, t);
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.ALL_ADS_COMPLETED, function (r) {
                            (t(r, "all-ads-completed"), Tf(e, r));
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.SKIPPED, function (e) {
                            t(e, "ad-skipped");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.VOLUME_CHANGED, function (e) {
                            t(e, "ad-volume-changed");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.VOLUME_MUTED, function (e) {
                            t(e, "ad-muted");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.PAUSED, function (r) {
                            e.j && ((e.j.i = !0), t(r, "ad-paused"));
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.RESUMED, function (r) {
                            e.j && ((e.j.i = !1), t(r, "ad-resumed"));
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED, function (r) {
                            e.j && t(r, "ad-skip-state-changed");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.CLICK, function (e) {
                            t(e, "ad-clicked");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.AD_PROGRESS, function (e) {
                            t(e, "ad-progress");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.AD_BUFFERING, function (e) {
                            t(e, "ad-buffering");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.IMPRESSION, function (e) {
                            t(e, "ad-impression");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.DURATION_CHANGE, function (e) {
                            t(e, "ad-duration-changed");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.USER_CLOSE, function (e) {
                            t(e, "ad-closed");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.LOADED, function (e) {
                            t(e, "ad-loaded");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.LINEAR_CHANGED, function (e) {
                            t(e, "ad-linear-changed");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.AD_METADATA, function (e) {
                            t(e, "ad-metadata");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.LOG, function (e) {
                            t(e, "ad-recoverable-error");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.AD_BREAK_READY, function (e) {
                            t(e, "ad-break-ready");
                          }),
                          e.h.D(e.g, google.ima.AdEvent.Type.INTERACTION, function (e) {
                            t(e, "ad-interaction");
                          }));
                      })(t);
                      try {
                        (t.g.init(t.i.offsetWidth, t.i.offsetHeight),
                          t.h.D(t.i, "loadeddata", function () {
                            t.g.resize(t.i.offsetWidth, t.i.offsetHeight);
                          }),
                          "ResizeObserver" in e
                            ? ((t.B = new ResizeObserver(function () {
                                t.g.resize(t.i.offsetWidth, t.i.offsetHeight);
                              })),
                              t.B.observe(t.i))
                            : t.h.D(document, "fullscreenchange", function () {
                                t.g.resize(t.i.offsetWidth, t.i.offsetHeight);
                              }),
                          t.G || t.o.skipPlayDetection
                            ? t.g.start()
                            : t.h.Aa(t.i, "play", function () {
                                ((t.G = !0), t.g.start());
                              }));
                      } catch (s) {
                        Tf(t, null);
                      }
                    })(s, t);
                  }),
                  this.h.D(this.m, google.ima.AdErrorEvent.Type.AD_ERROR, function (e) {
                    vf(s, e);
                  }),
                  this.h.D(this.i, "ended", function () {
                    s.m.contentComplete();
                  }),
                  this.h.Aa(this.i, "play", function () {
                    s.G = !0;
                  }));
              }
              function vf(e, t) {
                (t.getError(),
                  (t = new Map().set("originalEvent", t)),
                  e.l(new Pn("ad-error", t)),
                  Tf(e, null),
                  e.l(new Pn("ad-cue-points-changed", new Map().set("cuepoints", []))));
              }
              function yf(e, t) {
                var r = t.getAd();
                r
                  ? ((e.j = new cf(r, e.g, e.i)),
                    t.type != google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED ||
                      e.o.supportsMultipleMediaElements ||
                      e.l(new Pn("ad-content-pause-requested")),
                    (t = new Map().set("ad", e.j).set("sdkAdObject", r).set("originalEvent", t)),
                    e.l(new Pn("ad-started", t)),
                    e.j.isLinear() &&
                      (e.u.setAttribute("ad-active", "true"),
                      e.o.customPlayheadTracker || e.i.pause(),
                      e.i.muted ? (((t = e.j).j = e.i.volume), t.h.setVolume(0)) : e.j.setVolume(e.i.volume)))
                  : z("The IMA SDK fired a " + t.type + " event with no associated ad. Unable to play ad!");
              }
              function Tf(e, t) {
                (t &&
                  t.type == google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED &&
                  !e.o.supportsMultipleMediaElements &&
                  e.l(new Pn("ad-content-resume-requested")),
                  e.l(new Pn("ad-stopped", new Map().set("originalEvent", t))),
                  e.j &&
                    e.j.isLinear() &&
                    (e.u.removeAttribute("ad-active"), e.o.customPlayheadTracker || e.i.ended || e.i.play()));
              }
              function bf(e, t, r, i, n, a) {
                ((this.g = e),
                  (this.h = t),
                  (this.j = (this.i = t.isSkippable) ? t.skipOffset || 0 : t.skipOffset),
                  (this.l = t.skipFor),
                  (this.B = r),
                  (this.o = i),
                  (this.m = n),
                  (this.u = a),
                  (this.C = t.overlay));
              }
              function Sf(e, t, r) {
                ((this.g = e), (this.j = t), (this.h = r), (this.i = null == e.overlay));
              }
              function Ef(e, t, r, i) {
                function n(e) {
                  return !!e && (!!e.overlay || (a.g.ended ? e.post : !a.g.paused));
                }
                var a = this;
                ((this.M = null),
                  (this.m = e),
                  (this.C = t),
                  (this.g = r),
                  (this.G = null),
                  (this.u = !0),
                  (this.h = this.g),
                  (this.va = i),
                  (this.ma = new Set()),
                  (this.T = new Set()),
                  (this.H = new Set()),
                  (this.F = new Map()),
                  (this.K = new Map()),
                  (this.i = new Qh()),
                  Df(this),
                  (this.I = new re()),
                  (this.j = new re()),
                  (this.J = !1),
                  (this.$ = this.o = this.B = this.l = null),
                  (this.ba = !1),
                  (this.O = -1),
                  (this.X = function () {
                    if (!a.J && a.l && !a.C.xa()) {
                      a.l = a.g.currentTime;
                      var e = kf(a);
                      e && n(e) && Rf(a, e, 1, 1, Date.now());
                    }
                  }),
                  (this.V = function () {
                    if (!(a.J || a.l || a.C.xa())) {
                      a.g.paused || (a.l = a.g.currentTime);
                      var e = kf(a, !0);
                      (e || (e = kf(a)), e && n(e) && Rf(a, e, 1, 1, Date.now()));
                    }
                  }),
                  (this.oa = function () {
                    if (!a.J && a.l && !a.C.xa()) {
                      var e = a.g.currentTime;
                      a.B && !a.B.pre && !a.B.post && e < (a.B.endTime || a.B.startTime) && (a.B = null);
                    }
                  }),
                  (this.R = new Ri(this.X)),
                  (this.N = new Ri(function () {
                    var e, t, r, i, n, s, o, l, u, d, h;
                    return D(function (c) {
                      switch (c.g) {
                        case 1:
                          if (!a.H.size || null == a.l) {
                            c.A(0);
                            break;
                          }
                          if ((e = a.C.$d()) == tf || e == rf) return c.return();
                          ((t = !1), (r = Array.from(a.H)), (i = a.C.Ra()), (n = g(r)), (s = n.next()));
                        case 3:
                          if (s.done) {
                            c.A(5);
                            break;
                          }
                          if ((o = s.value) == a.B) {
                            c.A(4);
                            break;
                          }
                          if (((l = o.endTime || o.startTime), !(i.start - l >= 1))) {
                            ((u = o.startTime - a.l) > 0 &&
                              u <= 10 &&
                              (!a.F.has(o) &&
                                Pf(o) &&
                                a.F.set(o, a.i.preload(o.uri, null, o.mimeType || void 0)),
                              Nf(a, o)),
                              c.A(4));
                            break;
                          }
                          if (!a.F.has(o)) {
                            c.A(7);
                            break;
                          }
                          return b(c, a.F.get(o), 8);
                        case 8:
                          ((d = c.h) && d.destroy(), a.F.delete(o));
                        case 7:
                          (Ff(a, o),
                            (h = o.id || JSON.stringify(o)),
                            a.T.has(h) && a.T.delete(h),
                            a.H.delete(o),
                            xf(a),
                            o.overlay || (t = !0));
                        case 4:
                          ((s = n.next()), c.A(3));
                          break;
                        case 5:
                          (t && Mf(a), S(c));
                      }
                    });
                  })),
                  this.configure(this.C.getConfiguration().ads));
              }
              function xf(e) {
                e.ba &&
                  !e.H.size &&
                  (e.I.Ma(e.g, "playing", e.V),
                  e.I.Ma(e.g, "timeupdate", e.V),
                  e.I.Ma(e.g, "seeked", e.oa),
                  e.I.Ma(e.g, "ended", e.X),
                  -1 != e.O && (e.g.cancelVideoFrameCallback(e.O), (e.O = -1)),
                  e.R && e.R.stop(),
                  e.N && e.N.stop(),
                  (e.ba = !1));
              }
              function wf(e) {
                if (e.m && e.M) {
                  var t = e.M.supportsMultipleMediaElements,
                    r = e.g;
                  ((r.controls ||
                    (r.webkitPresentationMode && "inline" !== r.webkitPresentationMode) ||
                    r.webkitDisplayingFullscreen) &&
                    (t = !1),
                    e.u == t &&
                      ((e.u = !t),
                      e.u
                        ? ((e.h = e.g), e.G && (e.G.parentElement && e.m.removeChild(e.G), (e.G = null)))
                        : (e.G ||
                            (((t = document.createElement(e.g.tagName)).autoplay = !0),
                            (t.style.position = "absolute"),
                            (t.style.top = "0"),
                            (t.style.left = "0"),
                            (t.style.width = "100%"),
                            (t.style.height = "100%"),
                            (t.style.display = "none"),
                            t.setAttribute("playsinline", ""),
                            (e.G = t)),
                          (e.h = e.G))));
                } else e.u = !0;
              }
              function Af(e, t) {
                var r, i, n;
                D(function (a) {
                  if (1 == a.g) {
                    if (
                      ((r = null),
                      (i = t.values.find(function (e) {
                        return "ID" == e.key;
                      })) && (r = i.data),
                      r)
                    ) {
                      if (e.ma.has(r)) return a.return();
                      e.ma.add(r);
                    }
                    return (
                      Df(e),
                      (n = []),
                      t &&
                      t.values.find(function (e) {
                        return "X-OVERLAY-ID" == e.key;
                      })
                        ? ((n = (function (e) {
                            var t = [];
                            if (!e) return t;
                            var r = e.values.find(function (e) {
                              return "X-ASSET-URI" == e.key;
                            });
                            if (!r) return t;
                            if (!(r = r.data)) return t;
                            var i = null,
                              n = e.values.find(function (e) {
                                return "X-OVERLAY-ID" == e.key;
                              });
                            (n && (i = n.data),
                              (n = null == i ? Math.floor(10 * e.startTime) / 10 : e.startTime));
                            var a = e.endTime;
                            e.endTime &&
                              e.endTime != 1 / 0 &&
                              "number" == typeof e.endTime &&
                              (a = null == i ? Math.floor(10 * e.endTime) / 10 : e.endTime);
                            var s = !1,
                              o = !1,
                              l = !1,
                              u = e.values.find(function (e) {
                                return "CUE" == e.key;
                              });
                            (u &&
                              ((l = u.data),
                              (s = l.includes("ONCE")),
                              (o = l.includes("PRE")),
                              (l = l.includes("POST"))),
                              (u = null));
                            var d = e.values.find(function (e) {
                              return "X-ASSET-MIMETYPE" == e.key;
                            });
                            (d && (u = d.data), (d = !1));
                            var h = e.values.find(function (e) {
                              return "X-LOOP" == e.key;
                            });
                            (h && (d = "YES" == h.data), (h = 1));
                            var c = e.values.find(function (e) {
                              return "X-DEPTH" == e.key;
                            });
                            (c && ((h = parseFloat(c.data)), isNaN(h) && (h = 1)), (c = null));
                            var f = e.values.find(function (e) {
                              return "X-BACKGROUND" == e.key;
                            });
                            (f && (c = f.data), (f = 1920));
                            var p = 1080,
                              g = e.values.find(function (e) {
                                return "X-VIEWPORT" == e.key;
                              });
                            if (g) {
                              if (2 != (p = g.data.split("x")).length) return t;
                              ((f = parseFloat(p[0])), (p = parseFloat(p[1])));
                            }
                            if (
                              ((f = {
                                viewport: { x: f, y: p },
                                topLeft: { x: 0, y: 0 },
                                size: { x: f, y: p },
                              }),
                              (p = e.values.find(function (e) {
                                return "X-OVERLAY-POSITION" == e.key;
                              })))
                            ) {
                              if (2 != (p = p.data.split("x")).length) return t;
                              ((f.topLeft.x = parseFloat(p[0])), (f.topLeft.y = parseFloat(p[1])));
                            }
                            if (
                              (p = e.values.find(function (e) {
                                return "X-OVERLAY-SIZE" == e.key;
                              }))
                            ) {
                              if (2 != (p = p.data.split("x")).length) return t;
                              ((f.size.x = parseFloat(p[0])), (f.size.y = parseFloat(p[1])));
                            }
                            if (
                              ((p = null),
                              (g = e.values.find(function (e) {
                                return "X-SQUEEZECURRENT" == e.key;
                              })) &&
                                ((p = parseFloat(g.data)),
                                isNaN(p) && (p = 1),
                                (p = {
                                  viewport: { x: 1920, y: 1080 },
                                  topLeft: { x: 0, y: 0 },
                                  size: { x: 1920 * p, y: 1080 * p },
                                }),
                                (e = e.values.find(function (e) {
                                  return "X-SQUEEZECURRENT-POSITION" == e.key;
                                }))))
                            ) {
                              if (2 != (e = e.data.split("x")).length) return t;
                              ((p.topLeft.x = parseFloat(e[0])), (p.topLeft.y = parseFloat(e[1])));
                            }
                            return (
                              t.push({
                                id: i,
                                groupId: null,
                                startTime: n,
                                endTime: a,
                                uri: r,
                                mimeType: u,
                                isSkippable: !1,
                                skipOffset: null,
                                skipFor: null,
                                canJump: !0,
                                resumeOffset: null,
                                playoutLimit: null,
                                once: s,
                                pre: o,
                                post: l,
                                timelineRange: !0,
                                loop: d,
                                overlay: f,
                                displayOnBackground: -1 == h,
                                currentVideo: p,
                                background: c,
                                clickThroughUrl: null,
                              }),
                              t
                            );
                          })(t)),
                          a.A(2))
                        : b(
                            a,
                            (function (e, t) {
                              var r,
                                i,
                                n,
                                a,
                                s,
                                o,
                                l,
                                u,
                                d,
                                h,
                                c,
                                f,
                                p,
                                g,
                                m,
                                v,
                                y,
                                T,
                                S,
                                x,
                                I,
                                k,
                                R,
                                C,
                                L,
                                M,
                                _,
                                P,
                                O,
                                N,
                                F,
                                U,
                                B,
                                $,
                                j,
                                G,
                                V,
                                H,
                                K,
                                W,
                                z;
                              return D(function (D) {
                                switch (D.g) {
                                  case 1:
                                    if (((r = []), !t)) return D.return(r);
                                    if (
                                      ((i = t.values.find(function (e) {
                                        return "X-ASSET-URI" == e.key;
                                      })),
                                      (n = t.values.find(function (e) {
                                        return "X-ASSET-LIST" == e.key;
                                      })),
                                      !i && !n)
                                    )
                                      return D.return(r);
                                    if (
                                      ((a = null),
                                      (s = t.values.find(function (e) {
                                        return "ID" == e.key;
                                      })) && (a = s.data),
                                      (o = null == a ? Math.floor(10 * t.startTime) / 10 : t.startTime),
                                      (l = t.endTime) &&
                                        t.endTime != 1 / 0 &&
                                        "number" == typeof t.endTime &&
                                        (l = null == a ? Math.floor(10 * t.endTime) / 10 : t.endTime),
                                      (u = t.values.find(function (e) {
                                        return "X-RESTRICT" == e.key;
                                      })),
                                      (h = d = !0),
                                      u &&
                                        u.data &&
                                        ((c = u.data), (d = !c.includes("SKIP")), (h = !c.includes("JUMP"))),
                                      (f = d ? 0 : null),
                                      (p = t.values.find(function (e) {
                                        return "X-ENABLE-SKIP-AFTER" == e.key;
                                      })) &&
                                        ((g = p.data), (f = parseFloat(g)), isNaN(f) && (f = d ? 0 : null)),
                                      (m = null),
                                      (v = t.values.find(function (e) {
                                        return "X-ENABLE-SKIP-FOR" == e.key;
                                      })) && ((y = v.data), (m = parseFloat(y)), isNaN(f) && (m = null)),
                                      (T = null),
                                      (S = t.values.find(function (e) {
                                        return "X-RESUME-OFFSET" == e.key;
                                      })) && ((x = S.data), (T = parseFloat(x)), isNaN(T) && (T = null)),
                                      (I = null),
                                      (k = t.values.find(function (e) {
                                        return "X-PLAYOUT-LIMIT" == e.key;
                                      })) && ((R = k.data), (I = parseFloat(R)), isNaN(I) && (I = null)),
                                      (M = L = C = !1),
                                      (_ = t.values.find(function (e) {
                                        return "CUE" == e.key;
                                      })) &&
                                        ((P = _.data),
                                        (C = P.includes("ONCE")),
                                        (L = P.includes("PRE")),
                                        (M = P.includes("POST"))),
                                      (O = !1),
                                      (N = t.values.find(function (e) {
                                        return "X-TIMELINE-OCCUPIES" == e.key;
                                      }))
                                        ? ((F = N.data), (O = F.includes("RANGE")))
                                        : !S && e.C.W() && (O = !L && !M),
                                      i)
                                    ) {
                                      if (!(U = i.data)) return D.return(r);
                                      (r.push({
                                        id: a,
                                        groupId: null,
                                        startTime: o,
                                        endTime: l,
                                        uri: U,
                                        mimeType: null,
                                        isSkippable: d,
                                        skipOffset: f,
                                        skipFor: m,
                                        canJump: h,
                                        resumeOffset: T,
                                        playoutLimit: I,
                                        once: C,
                                        pre: L,
                                        post: M,
                                        timelineRange: O,
                                        loop: !1,
                                        overlay: null,
                                        displayOnBackground: !1,
                                        currentVideo: null,
                                        background: null,
                                        clickThroughUrl: null,
                                      }),
                                        D.A(2));
                                      break;
                                    }
                                    if (!n) {
                                      D.A(2);
                                      break;
                                    }
                                    return (B = n.data)
                                      ? (E(D, 4), b(D, _f(e, B, { type: 11 }), 6))
                                      : D.return(r);
                                  case 6:
                                    for (
                                      $ = D.h,
                                        j = Xe($),
                                        G = JSON.parse(j),
                                        (V = G["SKIP-CONTROL"]) &&
                                          ("number" == typeof (H = V["ENABLE-SKIP-AFTER"]) &&
                                            ((f = parseFloat(H)), isNaN(H) && (f = d ? 0 : null)),
                                          "number" == typeof (K = V["ENABLE-SKIP-FOR"]) &&
                                            ((m = parseFloat(K)), isNaN(K) && (m = null))),
                                        W = 0;
                                      W < G.ASSETS.length;
                                      W++
                                    )
                                      (z = G.ASSETS[W]).URI &&
                                        r.push({
                                          id: a + "_shaka_asset_" + W,
                                          groupId: a,
                                          startTime: o,
                                          endTime: l,
                                          uri: z.URI,
                                          mimeType: null,
                                          isSkippable: d,
                                          skipOffset: f,
                                          skipFor: m,
                                          canJump: h,
                                          resumeOffset: T,
                                          playoutLimit: I,
                                          once: C,
                                          pre: L,
                                          post: M,
                                          timelineRange: O,
                                          loop: !1,
                                          overlay: null,
                                          displayOnBackground: !1,
                                          currentVideo: null,
                                          background: null,
                                          clickThroughUrl: null,
                                        });
                                    w(D, 2);
                                    break;
                                  case 4:
                                    A(D);
                                  case 2:
                                    return D.return(r);
                                }
                              });
                            })(e, t),
                            3,
                          )
                    );
                  }
                  (2 != a.g && (n = a.h), n.length ? If(e, n) : z("Unsupported HLS interstitial", t), S(a));
                });
              }
              function If(e, t) {
                var r, i, n, a, s, o, l, u;
                D(function (d) {
                  switch (d.g) {
                    case 1:
                      ((r = !1), (i = g(t)), (n = i.next()));
                    case 2:
                      if (n.done) {
                        d.A(4);
                        break;
                      }
                      if (!(a = n.value).uri) {
                        (z("Missing URL in interstitial", a), d.A(3));
                        break;
                      }
                      if (a.mimeType) {
                        d.A(5);
                        break;
                      }
                      return (
                        E(d, 6),
                        (s = e.i.Yb()),
                        b(d, su(a.uri, s, e.C.getConfiguration().streaming.retryParameters), 8)
                      );
                    case 8:
                      ((a.mimeType = d.h), w(d, 5));
                      break;
                    case 6:
                      A(d);
                    case 5:
                      if (((o = a.id || JSON.stringify(a)), e.T.has(o))) {
                        d.A(3);
                        break;
                      }
                      (a.loop && !a.overlay && z("Loop is only supported in overlay interstitials", a),
                        a.overlay || (r = !0),
                        e.T.add(o),
                        e.H.add(a),
                        (l = !1),
                        a.pre && null == e.l
                          ? (l = !0)
                          : 0 != a.startTime || a.canJump
                            ? null != e.l && (u = a.startTime - e.l) > 0 && u <= 10 && (l = !0)
                            : (l = !0),
                        l &&
                          (!e.F.has(a) && Pf(a) && e.F.set(a, e.i.preload(a.uri, null, a.mimeType || void 0)),
                          Nf(e, a)));
                    case 3:
                      ((n = i.next()), d.A(2));
                      break;
                    case 4:
                      (r && Mf(e),
                        (function (e) {
                          if (!e.ba && e.H.size) {
                            if (
                              (e.I.D(e.g, "playing", e.V),
                              e.I.D(e.g, "timeupdate", e.V),
                              e.I.D(e.g, "seeked", e.oa),
                              e.I.D(e.g, "ended", e.X),
                              "requestVideoFrameCallback" in e.g && !Of())
                            ) {
                              var t = e.g,
                                r = function () {
                                  -1 != e.O && (e.X(), -1 != e.O && (e.O = t.requestVideoFrameCallback(r)));
                                };
                              e.O = t.requestVideoFrameCallback(r);
                            } else e.R.Ea(0.025);
                            (e.N && e.N.Ea(1), (e.ba = !0));
                          }
                        })(e),
                        S(d));
                  }
                });
              }
              function kf(e, t, r) {
                ((t = void 0 !== t && t), (r = void 0 === r ? null : r));
                var i = 0,
                  n = null;
                if (e.H.size && null != e.l) {
                  var a = e.g.ended,
                    s = Array.from(e.H).sort(function (e, t) {
                      return t.startTime - e.startTime;
                    }),
                    o = s;
                  for (
                    o = t
                      ? s.filter(function (e) {
                          return e.pre;
                        })
                      : a
                        ? s.filter(function (e) {
                            return e.post;
                          })
                        : s.filter(function (e) {
                            return !e.pre && !e.post;
                          }),
                      o = (s = g(o)).next();
                    !o.done;
                    o = s.next()
                  ) {
                    o = o.value;
                    var l = !1;
                    if (t) l = o.pre;
                    else if (a) l = o.post;
                    else if (!o.pre && !o.post) {
                      var u = e.l - Math.round(1e3 * o.startTime) / 1e3,
                        d = 1;
                      (e.M.allowStartInMiddleOfInterstitial &&
                        o.endTime &&
                        o.endTime != 1 / 0 &&
                        (d = o.endTime - o.startTime),
                        (u > 0 || (0 == u && 0 == e.l)) &&
                          (u <= d || !o.canJump) &&
                          (l = !(null == r && e.B && !e.B.pre && !e.B.post && e.B.startTime >= o.startTime)));
                    }
                    l &&
                      (!e.B || o.startTime >= e.B.startTime) &&
                      (i == (r || 0)
                        ? (n = o)
                        : n &&
                          !o.canJump &&
                          Math.round(1e3 * o.startTime) / 1e3 - Math.round(1e3 * n.startTime) / 1e3 > 0.001 &&
                          ((n = o), (i = 0)),
                      i++);
                  }
                }
                return n;
              }
              function Rf(t, r, i, n, a, s) {
                ((s = void 0 === s ? 0 : s),
                  (t.B = r),
                  wf(t),
                  t.u || !t.m || t.h.parentElement || t.m.appendChild(t.h),
                  1 == n &&
                    1 == i &&
                    (i = Array.from(t.H).filter(function (e) {
                      return r.pre
                        ? e.pre == r.pre
                        : r.post
                          ? e.post == r.post
                          : Math.abs(e.startTime - r.startTime) < 0.001;
                    }).length),
                  r.once && (s++, t.H.delete(r), xf(t), r.overlay || Mf(t)),
                  r.mimeType && (r.mimeType.startsWith("image/") || "text/html" === r.mimeType)
                    ? r.overlay
                      ? (function (t, r, i, n, a) {
                          function s() {
                            (t.o && (t.o.stop(), (t.o = null)),
                              t.m.removeChild(u),
                              Lf(t, r),
                              Uf(t, "ad-stopped"),
                              t.j.Qa());
                            var e = kf(t, r.pre, n - a);
                            e ? Rf(t, e, i, ++n, Date.now(), a) : (t.J = !1);
                          }
                          t.J = !0;
                          var o = r.overlay,
                            l = "text/html" == r.mimeType ? "iframe" : "img",
                            u = document.createElement(l);
                          ((u.style.objectFit = "contain"),
                            (u.style.position = "absolute"),
                            (u.style.border = "none"),
                            Cf(t, r));
                          var d = new Sf(r, i, n);
                          (Uf(t, "ad-impression"),
                            Uf(t, "ad-started", new Map().set("ad", d)),
                            "iframe" == l
                              ? (u.src = r.uri)
                              : ((u.src = r.uri),
                                (u.onerror = function (e) {
                                  (Uf(t, "ad-error", new Map().set("originalEvent", e)), s());
                                })),
                            (d = o.viewport));
                          var h = o.topLeft;
                          ((o = o.size),
                            0 == d.x && 0 == d.y
                              ? ((u.width = r.overlay.size.x),
                                (u.height = r.overlay.size.y),
                                (u.style.bottom = "10%"),
                                (u.style.left = "0"),
                                (u.style.right = "0"),
                                (u.style.width = "100%"),
                                r.overlay.size.y || "iframe" != l || (u.style.height = "auto"))
                              : ((u.style.height = (o.y / d.y) * 100 + "%"),
                                (u.style.left = (h.x / d.x) * 100 + "%"),
                                (u.style.top = (h.y / d.y) * 100 + "%"),
                                (u.style.width = (o.x / d.x) * 100 + "%")),
                            t.m.appendChild(u));
                          var c = Date.now();
                          (t.o && t.o.stop(),
                            (t.o = new Ri(function () {
                              (r.playoutLimit && (Date.now() - c) / 1e3 > r.playoutLimit) ||
                              (r.endTime && t.g.currentTime > r.endTime)
                                ? (Uf(t, "ad-complete"), s())
                                : t.g.currentTime < r.startTime && (Uf(t, "ad-skipped"), s());
                            })),
                            r.playoutLimit && !r.endTime
                              ? t.o.ka(r.playoutLimit)
                              : r.endTime && t.o.Ea(0.025),
                            t.j.D(t.g, "seeked", function () {
                              var e = t.g.currentTime;
                              (e < r.startTime || (r.endTime && e > r.endTime)) &&
                                (t.o && t.o.stop(), Uf(t, "ad-skipped"), s());
                            }),
                            r.clickThroughUrl &&
                              t.j.D(u, "click", function () {
                                r.clickThroughUrl && e.open(r.clickThroughUrl, "_blank");
                              }));
                        })(t, r, i, n, s)
                      : z("Unsupported interstitial", r)
                    : t.u && r.overlay
                      ? z("Unsupported interstitial", r)
                      : (function (t, r, i, n, a, s) {
                          var o, l, u, d, h, c, f, p, g, m, v, y, T, x, I, k, R, C, L, M, _;
                          D(function (P) {
                            switch (P.g) {
                              case 1:
                                if (
                                  ((o = Date.now()),
                                  (t.J = !0),
                                  (l = !1),
                                  (u = function () {
                                    if (!t.u && !r.overlay && null == r.resumeOffset)
                                      if (r.timelineRange && r.endTime && r.endTime != 1 / 0)
                                        t.g.currentTime != r.endTime && (t.g.currentTime = r.endTime);
                                      else {
                                        var e = Date.now();
                                        ((t.g.currentTime += (e - a) / 1e3), (a = e));
                                      }
                                  }),
                                  (d = function (e) {
                                    var o, l;
                                    return D(function (d) {
                                      if (1 == d.g) {
                                        if ((u(), (o = kf(t, r.pre, n - s)), e && r.groupId))
                                          for (; o && o.groupId == r.groupId; )
                                            (n++, (o = kf(t, r.pre, n - s)));
                                        return (
                                          t.o &&
                                            (!r.groupId || (o && o.groupId != r.groupId)) &&
                                            (t.o.stop(), (t.o = null)),
                                          Lf(t, r),
                                          o && !o.overlay
                                            ? d.A(2)
                                            : (r.post && ((t.l = null), (t.B = null)),
                                              t.u ? b(d, t.i.detach(), 4) : b(d, t.i.Cc(), 4))
                                        );
                                      }
                                      (2 != d.g &&
                                        (t.u &&
                                          (null == (l = r.resumeOffset) &&
                                            (l =
                                              r.timelineRange && r.endTime && r.endTime != 1 / 0
                                                ? r.endTime - (t.l || 0)
                                                : (Date.now() - a) / 1e3),
                                          Uf(t, "ad-content-resume-requested", new Map().set("offset", l))),
                                        Uf(t, "ad-stopped"),
                                        t.j.Qa(),
                                        (t.J = !1),
                                        t.u
                                          ? Mf(t)
                                          : ((t.h.style.display = "none"), u(), t.g.ended || t.g.play())),
                                        wf(t),
                                        o && (Uf(t, "ad-stopped"), t.j.Qa(), Rf(t, o, i, ++n, a, s)),
                                        S(d));
                                    });
                                  }),
                                  (h = function (e) {
                                    return D(function (r) {
                                      return l
                                        ? r.return()
                                        : ((l = !0),
                                          Uf(t, "ad-error", new Map().set("originalEvent", e)),
                                          b(r, d(!1), 0));
                                    });
                                  }),
                                  (c = function () {
                                    return D(function (e) {
                                      if (1 == e.g) return l ? e.return() : ((l = !0), b(e, d(!1), 2));
                                      (Uf(t, "ad-complete"), S(e));
                                    });
                                  }),
                                  (t.$ = function () {
                                    return D(function (e) {
                                      return l ? e.return() : ((l = !0), Uf(t, "ad-skipped"), b(e, d(!0), 0));
                                    });
                                  }),
                                  (f = new bf(t.h, r, t.$, i, n, !t.u)),
                                  t.u || (f.setMuted(t.g.muted), f.setVolume(t.g.volume)),
                                  Uf(t, "ad-started", new Map().set("ad", f)),
                                  (p = f.canSkipNow()) && Uf(t, "ad-skip-state-changed"),
                                  t.j.Aa(t.i, "error", h),
                                  t.j.D(t.h, "timeupdate", function () {
                                    if (t.h.duration) {
                                      var e = f.canSkipNow();
                                      (p != e &&
                                        f.getRemainingTime() > 0 &&
                                        f.getDuration() > 0 &&
                                        Uf(t, "ad-skip-state-changed"),
                                        (p = e),
                                        !t.u &&
                                          !r.overlay &&
                                          null == r.resumeOffset &&
                                          r.timelineRange &&
                                          r.endTime &&
                                          r.endTime != 1 / 0 &&
                                          t.g.currentTime != r.endTime &&
                                          t.C.Ra().end >= r.endTime &&
                                          (t.g.currentTime = r.endTime));
                                    }
                                  }),
                                  t.j.Aa(t.i, "firstquartile", function () {
                                    (u(), Uf(t, "ad-first-quartile"));
                                  }),
                                  t.j.Aa(t.i, "midpoint", function () {
                                    (u(), Uf(t, "ad-midpoint"));
                                  }),
                                  t.j.Aa(t.i, "thirdquartile", function () {
                                    (u(), Uf(t, "ad-third-quartile"));
                                  }),
                                  t.j.Aa(t.i, "complete", c),
                                  t.j.D(t.h, "play", function () {
                                    Uf(t, "ad-resumed");
                                  }),
                                  t.j.D(t.h, "pause", function () {
                                    var e = t.i.getConfiguration();
                                    t.h.currentTime >= e.playRangeEnd ? c() : Uf(t, "ad-paused");
                                  }),
                                  t.j.D(t.h, "volumechange", function () {
                                    t.h.muted ? Uf(t, "ad-muted") : Uf(t, "ad-volume-changed");
                                  }),
                                  r.clickThroughUrl &&
                                    ((g = t.m || t.h),
                                    t.j.D(g, "click", function () {
                                      r.clickThroughUrl &&
                                        (f.isPaused() || f.pause(), e.open(r.clickThroughUrl, "_blank"));
                                    })),
                                  !t.u || 1 != n)
                                ) {
                                  P.A(2);
                                  break;
                                }
                                return (
                                  Uf(t, "ad-content-pause-requested", new Map().set("saveLivePosition", !0)),
                                  (m = new kn()),
                                  (v = function (e) {
                                    return D(function (r) {
                                      if (1 == r.g)
                                        return "detach" != e.state
                                          ? r.A(0)
                                          : Of()
                                            ? b(
                                                r,
                                                new Promise(function (e) {
                                                  return new Ri(e).ka(0.1);
                                                }),
                                                3,
                                              )
                                            : r.A(3);
                                      (m.resolve(), t.j.Ma(t.C, "onstatechange", v), S(r));
                                    });
                                  }),
                                  t.j.D(t.C, "onstatechange", v),
                                  b(P, m, 2)
                                );
                              case 2:
                                return (
                                  Cf(t, r),
                                  t.u ||
                                    ((t.h.style.display = ""),
                                    r.overlay
                                      ? ((t.h.loop = r.loop),
                                        (y = r.overlay.viewport),
                                        (T = r.overlay.topLeft),
                                        (x = r.overlay.size),
                                        (t.h.style.height = (x.y / y.y) * 100 + "%"),
                                        (t.h.style.left = (T.x / y.x) * 100 + "%"),
                                        (t.h.style.top = (T.y / y.y) * 100 + "%"),
                                        (t.h.style.width = (x.x / y.x) * 100 + "%"))
                                      : (t.g.pause(),
                                        null != r.resumeOffset &&
                                          0 != r.resumeOffset &&
                                          (t.g.currentTime += r.resumeOffset),
                                        (t.h.loop = !1),
                                        (t.h.style.height = "100%"),
                                        (t.h.style.left = "0"),
                                        (t.h.style.top = "0"),
                                        (t.h.style.width = "100%"))),
                                  E(P, 4),
                                  Df(t),
                                  r.startTime &&
                                    r.endTime &&
                                    r.endTime != 1 / 0 &&
                                    r.startTime != r.endTime &&
                                    (I = r.endTime - r.startTime) > 0 &&
                                    t.i.configure("playRangeEnd", I),
                                  r.playoutLimit &&
                                    !t.o &&
                                    ((t.o = new Ri(function () {
                                      t.$();
                                    }).ka(r.playoutLimit)),
                                    t.i.configure("playRangeEnd", r.playoutLimit)),
                                  b(P, t.i.Vb(t.h), 6)
                                );
                              case 6:
                                return (
                                  (k = null),
                                  r.pre ||
                                    r.post ||
                                    !t.M.allowStartInMiddleOfInterstitial ||
                                    null == t.l ||
                                    ((R = t.l - r.startTime), Math.abs(R) > 0.25 && (k = R)),
                                  t.F.has(r)
                                    ? b(P, t.F.get(r), 10)
                                    : b(P, t.i.load(r.uri, k, r.mimeType || void 0), 8)
                                );
                              case 10:
                                return (
                                  (C = P.h),
                                  t.F.delete(r),
                                  b(P, C ? t.i.load(C) : t.i.load(r.uri, k, r.mimeType || void 0), 8)
                                );
                              case 8:
                                (r.overlay && t.g.paused ? t.h.pause() : t.h.play(),
                                  (L = (Date.now() - o) / 1e3),
                                  Uf(t, "ads-loaded", new Map().set("loadTime", L)),
                                  t.u && t.g.play(),
                                  r.overlay &&
                                    (r.pre ||
                                      r.post ||
                                      (t.C.W() && !(r.startTime > 0)) ||
                                      ((M = function () {
                                        var e = t.g.currentTime - r.startTime;
                                        Math.abs(e - t.h.currentTime) > 0.1 && (t.h.currentTime = e);
                                      }),
                                      t.j.Aa(t.h, "playing", M),
                                      t.j.D(t.g, "seeking", M)),
                                    t.j.D(t.g, "seeked", function () {
                                      var e = t.g.currentTime;
                                      (e < r.startTime || (r.endTime && e > r.endTime)) && t.$();
                                    })),
                                  w(P, 0));
                                break;
                              case 4:
                                if (((_ = A(P)), !t.J)) return P.return();
                                (h(_), S(P));
                            }
                          });
                        })(t, r, i, n, a, s));
              }
              function Cf(e, t) {
                if ((t.displayOnBackground && (e.g.style.zIndex = "1"), null != t.currentVideo)) {
                  var r = t.currentVideo;
                  e.g.style.transformOrigin = "top left";
                  var i = !0,
                    n = [],
                    a = (r.topLeft.x / r.viewport.x) * 100;
                  (a > 0 && a <= 100 && (n.push("translateX(" + a + "%)"), (i = !1)),
                    (a = (r.topLeft.y / r.viewport.y) * 100) > 0 &&
                      a <= 100 &&
                      (n.push("translateY(" + a + "%)"), (i = !1)),
                    (a = r.size.x / r.viewport.x) < 1 && n.push("scaleX(" + a + ")"),
                    (r = r.size.y / r.viewport.y),
                    a < 1 && n.push("scaleY(" + r + ")"),
                    n.length && (e.g.style.transform = n.join(" ")),
                    i && (e.g.style.transition = "transform 250ms"));
                }
                (e.m &&
                  (t.clickThroughUrl
                    ? (e.m.setAttribute("ad-active", "true"), (e.m.style.pointerEvents = ""))
                    : (e.m.style.pointerEvents = "none"),
                  t.background && (e.m.style.background = t.background)),
                  e.G && (e.G.style.background = t.overlay ? "" : "rgb(0, 0, 0)"));
              }
              function Lf(e, t) {
                ((t && !t.displayOnBackground) || (e.g.style.zIndex = ""),
                  (t && null == t.currentVideo) ||
                    ((e.g.style.transformOrigin = ""),
                    (e.g.style.transition = ""),
                    (e.g.style.transform = "")),
                  e.m &&
                    (e.m.removeAttribute("ad-active"), (e.m.style.pointerEvents = ""), !t || t.background) &&
                    (e.m.style.background = ""),
                  e.G && (e.G.style.background = ""));
              }
              function Mf(e) {
                for (var t = [], r = g(e.H), i = r.next(), n = {}; !i.done; n = { Bc: void 0 }, i = r.next())
                  (i = i.value).overlay ||
                    ((n.Bc = { start: i.startTime, end: null }),
                    i.pre
                      ? ((n.Bc.start = 0), (n.Bc.end = null))
                      : i.post
                        ? ((n.Bc.start = -1), (n.Bc.end = null))
                        : i.timelineRange && (n.Bc.end = i.endTime),
                    t.find(
                      (function (e) {
                        return function (t) {
                          return e.Bc.start == t.start && e.Bc.end == t.end;
                        };
                      })(n),
                    ) || t.push(n.Bc));
                Uf(e, "ad-cue-points-changed", new Map().set("cuepoints", t));
              }
              function Df(e) {
                (e.i.configure(e.C.ki()),
                  e.i.configure("ads.disableHLSInterstitial", !0),
                  e.i.configure("ads.disableDASHInterstitial", !0),
                  e.i.configure("playRangeEnd", 1 / 0),
                  Gn(e.C.Yb(), e.i.Yb()));
              }
              function _f(e, t, r) {
                var i, n;
                return D(function (a) {
                  return 1 == a.g
                    ? ((i = Vn([t], {
                        maxAttempts: 2,
                        baseDelay: 1e3,
                        backoffFactor: 2,
                        fuzzFactor: 0.5,
                        timeout: 3e4,
                        stallTimeout: 5e3,
                        connectionTimeout: 1e4,
                      })),
                      b(a, e.C.Yb().request(7, i, r).promise, 2))
                    : ((n = a.h), a.return(n.data));
                });
              }
              function Pf(e) {
                return !(e = e.mimeType) || (!e.startsWith("image/") && "text/html" !== e);
              }
              function Of() {
                var e = se().Oa();
                return "TV" == e || "CONSOLE" == e || "CAST" == e;
              }
              function Nf(e, t) {
                if (!(e.K.has(t) || (e.M && !e.M.allowPreloadOnDomElements))) {
                  var r = function (e) {
                      var t = document.createElement("link");
                      return (
                        (t.rel = "preload"),
                        (t.href = e),
                        (t.as = "image"),
                        document.head.appendChild(t),
                        t
                      );
                    },
                    i = [];
                  if (t.background) {
                    var n = t.background.match(/url\(('|")?([^'"()]+)('|")\)?/);
                    n && i.push(r(n[2]));
                  }
                  (t.mimeType && t.mimeType.startsWith("image/") && i.push(r(t.uri)), e.K.set(t, i));
                }
              }
              function Ff(e, t) {
                if (e.K.has(t)) {
                  for (var r = e.K.get(t), i = (r = g(r)).next(); !i.done; i = r.next())
                    (i = i.value).parentNode.removeChild(i);
                  e.K.delete(t);
                }
              }
              function Uf(e, t, r) {
                e.va(new Pn(t, r));
              }
              function Bf(e, t, r, i, n) {
                ((this.h = e),
                  (this.j = Vt(this.h.skipOffset)),
                  (this.g = n),
                  (this.i = t),
                  (this.l = r),
                  (this.o = i),
                  (this.m = !1));
              }
              function $f(e, t, r, i) {
                ((this.C = e),
                  (this.K = t),
                  (this.h = r),
                  (this.l = null),
                  (this.R = NaN),
                  (this.i = i),
                  (this.J = !1),
                  (this.B = null),
                  (this.j = []),
                  (this.N = []),
                  (this.M = this.F = this.g = null),
                  (this.G = new Map()),
                  (this.m = []),
                  (this.u = []),
                  (this.H = ""),
                  (this.O = !0),
                  (this.I = ""),
                  (this.o = new re()));
              }
              function jf(e, t) {
                var r, i, n, a, s, o, l, u;
                D(function (d) {
                  return 1 == d.g
                    ? t.staticResource
                      ? ((r = Gf(t)),
                        e.G.get(r)
                          ? d.return()
                          : ((i = { type: 9 }),
                            (n = Vn([t.staticResource], {
                              maxAttempts: 2,
                              baseDelay: 1e3,
                              backoffFactor: 2,
                              fuzzFactor: 0.5,
                              timeout: 3e4,
                              stallTimeout: 5e3,
                              connectionTimeout: 1e4,
                            })),
                            (a = e.K.request(7, n, i)),
                            E(d, 2),
                            e.G.set(r, []),
                            b(d, a.promise, 4)))
                      : d.return()
                    : 2 != d.g
                      ? ((s = d.h),
                        (o = Xe(s.data)),
                        (l = JSON.parse(o)),
                        (u = l.apps),
                        e.G.set(r, u),
                        w(d, 0))
                      : (A(d), e.G.delete(r), void S(d));
                });
              }
              function Gf(e) {
                return [
                  e.adId,
                  e.adParameters,
                  e.adSystem,
                  e.adTitle,
                  e.creativeAdId,
                  e.creativeId,
                  e.creativeSequence,
                  e.height,
                  e.width,
                  e.staticResource,
                ].join("");
              }
              function Vf(e) {
                var t = e.h.currentTime;
                if (0 != t && null == e.B) {
                  for (var r, i, n = g(e.j), a = n.next(); !a.done; a = n.next())
                    for (var s = g((a = a.value).ads), o = s.next(); !o.done; o = s.next())
                      if (((o = o.value), i)) {
                        if (
                          o.startTimeInSeconds < t &&
                          o.startTimeInSeconds > i.startTimeInSeconds + i.durationInSeconds
                        ) {
                          ((i = o), (r = a));
                          break;
                        }
                      } else o.startTimeInSeconds < t && ((i = o), (r = a));
                  r && i && !e.N.includes(i.adId) && ((e.B = t), (e.h.currentTime = r.startTimeInSeconds));
                }
              }
              function Hf(e) {
                if (e.h.duration && (e.g || e.j.length)) {
                  var t = e.h.currentTime,
                    r = !1;
                  if (e.g) {
                    r = !0;
                    var i = e.F,
                      n = i.startTimeInSeconds + 0.5 * i.durationInSeconds,
                      a = i.startTimeInSeconds + 0.75 * i.durationInSeconds;
                    (t >= i.startTimeInSeconds + 0.25 * i.durationInSeconds && !e.u.includes("firstQuartile")
                      ? (e.u.push("firstQuartile"), zf(e, "firstQuartile"))
                      : t >= n && !e.u.includes("midpoint")
                        ? (e.u.push("midpoint"), zf(e, "midpoint"))
                        : t >= a &&
                          !e.u.includes("thirdQuartile") &&
                          (e.u.push("thirdQuartile"), zf(e, "thirdQuartile")),
                      (i = e.g.getRemainingTime()),
                      (n = e.g.getDuration()),
                      e.g.canSkipNow() && i > 0 && n > 0 && zf(e, "skipStateChanged"),
                      n > 0 && (i <= 0 || i > n) && Kf(e));
                  }
                  if (!e.g || !e.g.isLinear()) {
                    e: for (
                      i = g(e.j), n = i.next();
                      !n.done && ((n = n.value), !e.g || !e.g.isLinear());
                      n = i.next()
                    )
                      for (a = 0; a < n.ads.length; a++) {
                        var s = n.ads[a],
                          o = s.startTimeInSeconds + s.durationInSeconds;
                        if (s.startTimeInSeconds <= t && o > t) {
                          if (e.N.includes(s.adId)) {
                            if (e.h.ended) continue;
                            e.h.currentTime = o;
                            break e;
                          }
                          (Kf(e),
                            (e.M = n),
                            (e.g = new Bf(s, a + 1, n.ads.length, !0, e.h)),
                            (e.F = s),
                            0 === a && zf(e, "breakStart"),
                            Wf(e));
                          break;
                        }
                      }
                    if (!e.g)
                      for (n = (i = g(e.j)).next(); !n.done && ((n = n.value), !e.g); n = i.next())
                        for (a = 0; a < n.nonLinearAdsList.length; a++)
                          if ((s = n.nonLinearAdsList[a]).nonLinearAdList.length) {
                            o = n.startTimeInSeconds;
                            var l = e.G.get(Gf(s.nonLinearAdList[0]));
                            if (o <= t && l && l.length) {
                              (Kf(e), (o = e));
                              for (var u = (l = g(l)).next(); !u.done; u = l.next())
                                if ((u = u.value).data.source.length) {
                                  var d = document.createElement("img");
                                  ((d.src = u.data.source[0].url),
                                    (d.style.top = (u.placeholder.top || 0) + "%"),
                                    (d.style.height = 100 - (u.placeholder.top || 0) + "%"),
                                    (d.style.left = (u.placeholder.left || 0) + "%"),
                                    (d.style.maxWidth = 100 - (u.placeholder.left || 0) + "%"),
                                    (d.style.objectFit = "contain"),
                                    (d.style.position = "absolute"),
                                    o.C.appendChild(d));
                                }
                              ((e.M = n),
                                (e.g = new Bf(s, a + 1, n.ads.length, !1, e.h)),
                                (e.F = s),
                                0 === a && zf(e, "breakStart"),
                                Wf(e));
                              break;
                            }
                          }
                    r &&
                      !e.g &&
                      ((t = e.h.currentTime), e.B && e.B > t && (e.h.currentTime = e.B), (e.B = null));
                  }
                }
              }
              function Kf(e) {
                if (e.g) {
                  for (; e.C.lastChild; ) e.C.removeChild(e.C.firstChild);
                  e.J || e.N.push(e.F.adId);
                  var t = e.g.m;
                  zf(e, void 0 !== t && t ? "skip" : "complete");
                  for (var r = (t = g(e.m)).next(); !r.done; r = t.next())
                    ((r = r.value), e.o.Ma(r.target, r.type, r.listener));
                  ((e.m = []),
                    (e.u = []),
                    (t = e.g.getPositionInSequence()) === (r = e.g.getSequenceLength()) && zf(e, "breakEnd"),
                    (e.g = null),
                    (e.F = null),
                    (e.M = null));
                }
              }
              function Wf(e) {
                var t = !1;
                (e.h.paused ? (t = !0) : (zf(e, "impression"), zf(e, "start")),
                  e.m.push({
                    target: e.h,
                    type: "volumechange",
                    listener: function () {
                      e.h.muted && zf(e, "mute");
                    },
                  }),
                  e.m.push({
                    target: e.h,
                    type: "volumechange",
                    listener: function () {
                      e.h.muted || zf(e, "unmute");
                    },
                  }),
                  e.m.push({
                    target: e.h,
                    type: "play",
                    listener: function () {
                      t ? (zf(e, "impression"), zf(e, "start"), (t = !1)) : zf(e, "resume");
                    },
                  }),
                  e.m.push({
                    target: e.h,
                    type: "pause",
                    listener: function () {
                      zf(e, "pause");
                    },
                  }));
                for (var r = g(e.m), i = r.next(); !i.done; i = r.next())
                  ((i = i.value), e.o.D(i.target, i.type, i.listener));
              }
              function zf(e, t) {
                var r = e.F.trackingEvents.find(function (e) {
                  return e.eventType == t;
                });
                if (
                  (r ||
                    (r = e.M.adBreakTrackingEvents.find(function (e) {
                      return e.eventType == t;
                    })),
                  r)
                )
                  for (var i = { type: 10 }, n = (r = g(r.beaconUrls)).next(); !n.done; n = r.next())
                    (n = n.value) && "" != n && (((n = Vn([n], In())).method = "POST"), e.K.request(7, n, i));
                switch (t) {
                  case "impression":
                    e.i(new Pn("ad-impression"));
                    break;
                  case "start":
                    e.i(new Pn("ad-started", new Map().set("ad", e.g)));
                    break;
                  case "mute":
                    e.i(new Pn("ad-muted"));
                    break;
                  case "unmute":
                    e.i(new Pn("ad-volume-changed"));
                    break;
                  case "resume":
                    e.i(new Pn("ad-resumed"));
                    break;
                  case "pause":
                    e.i(new Pn("ad-paused"));
                    break;
                  case "firstQuartile":
                    e.i(new Pn("ad-first-quartile"));
                    break;
                  case "midpoint":
                    e.i(new Pn("ad-midpoint"));
                    break;
                  case "thirdQuartile":
                    e.i(new Pn("ad-third-quartile"));
                    break;
                  case "complete":
                    (e.i(new Pn("ad-complete")), e.i(new Pn("ad-stopped")));
                    break;
                  case "skip":
                    (e.i(new Pn("ad-skipped")), e.i(new Pn("ad-stopped")));
                    break;
                  case "breakStart":
                    e.C.setAttribute("ad-active", "true");
                    break;
                  case "breakEnd":
                    e.C.removeAttribute("ad-active");
                    break;
                  case "skipStateChanged":
                    e.i(new Pn("ad-skip-state-changed"));
                }
              }
              function qf(e, t) {
                ((this.g = e), (this.i = null), (this.h = t));
              }
              function Xf(e, t, r, i) {
                var n = this;
                ((this.u = e),
                  (this.l = t),
                  (this.j = null),
                  (this.G = NaN),
                  (this.i = i),
                  (this.H = !1),
                  (this.B = this.m = this.o = null),
                  (this.C = ""),
                  (this.F = []),
                  (this.h = new re()),
                  (e = new google.ima.dai.api.UiSettings()).setLocale(r),
                  (this.g = new google.ima.dai.api.StreamManager(this.l, this.u, e)),
                  this.i(new Pn("ima-stream-manager-loaded", new Map().set("imaStreamManager", this.g))),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.LOADED, function (e) {
                    !(function (e, t) {
                      (e.i(new Pn("ads-loaded", new Map().set("loadTime", Date.now() / 1e3 - e.G))),
                        (t = t.getStreamData().url),
                        e.j.resolve(t),
                        (e.j = null),
                        e.H ||
                          e.h.D(e.l, "seeked", function () {
                            var t = e.l.currentTime;
                            if (0 != t) {
                              e.g.streamTimeForContentTime(t);
                              var r = e.g.previousCuePointForStreamTime(t);
                              r && !r.played && ((e.o = t), (e.l.currentTime = r.start));
                            }
                          }));
                    })(n, e);
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.ERROR, function () {
                    (n.C.length
                      ? n.j.resolve(n.C)
                      : n.j.reject(
                          "IMA Stream request returned an error and there was no backup asset uri provided.",
                        ),
                      (n.j = null));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED, function () {}),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.STARTED, function (e) {
                    ((e = e.getAd()),
                      (n.m = new qf(e, n.l)),
                      n.B && (n.m.i = n.B),
                      n.i(new Pn("ad-started", new Map().set("ad", n.m))),
                      n.u.setAttribute("ad-active", "true"));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED, function () {
                    n.u.removeAttribute("ad-active");
                    var e = n.l.currentTime;
                    n.o && n.o > e && ((n.l.currentTime = n.o), (n.o = null));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.AD_PROGRESS, function (e) {
                    ((n.B = e.getStreamData().adProgressData), n.m && (n.m.i = n.B));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE, function () {
                    n.i(new Pn("ad-first-quartile"));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.MIDPOINT, function () {
                    n.i(new Pn("ad-midpoint"));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE, function () {
                    n.i(new Pn("ad-third-quartile"));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.COMPLETE, function () {
                    (n.i(new Pn("ad-complete")),
                      n.i(new Pn("ad-stopped")),
                      n.u.removeAttribute("ad-active"),
                      (n.m = null));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.SKIPPED, function () {
                    (n.i(new Pn("ad-skipped")), n.i(new Pn("ad-stopped")));
                  }),
                  this.h.D(this.g, google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED, function (e) {
                    var t = e.getStreamData();
                    e = [];
                    for (var r = (t = g(t.cuepoints)).next(); !r.done; r = t.next())
                      ((r = r.value), e.push({ start: r.start, end: r.end }));
                    ((n.F = e), n.i(new Pn("ad-cue-points-changed", new Map().set("cuepoints", e))));
                  }));
              }
              function Yf() {
                (Fn.call(this),
                  (this.h = this.i = this.j = this.g = null),
                  (this.m = new df()),
                  (this.o = navigator.language),
                  (this.l = null));
              }
              function Qf(e, t) {
                if (t && t.type)
                  switch (t.type) {
                    case "ads-loaded":
                      e.m.g.push(t.loadTime);
                      break;
                    case "ad-started":
                      e.m.h++;
                      var r = t.ad;
                      r && !r.isLinear() && e.m.j++;
                      break;
                    case "ad-complete":
                      e.m.l++;
                      break;
                    case "ad-skipped":
                      e.m.m++;
                      break;
                    case "ad-error":
                      e.m.i++;
                  }
                e.dispatchEvent(t);
              }
              function Jf(e) {
                return JSON.stringify(e, function (e, t) {
                  if ("function" != typeof t) {
                    if (((e = t instanceof Pn), t instanceof Event || e)) {
                      var r = {};
                      for (n in t) {
                        var i = t[n];
                        i && "object" == typeof i
                          ? "detail" == n
                            ? (r[n] = i)
                            : i instanceof Event || i instanceof Pn
                              ? (r[n] = { __type__: "Event", event: Jf(i) })
                              : e && Array.isArray(i) && (r[n] = i)
                          : n in Event || (r[n] = i);
                      }
                      return r;
                    }
                    if (t instanceof Error) {
                      var n = new Set(["name", "message", "stack"]);
                      for (r in t) n.add(r);
                      for (r = (e = g(Object.getOwnPropertyNames(t))).next(); !r.done; r = e.next())
                        n.add(r.value);
                      for (e = {}, r = (n = g(n)).next(); !r.done; r = n.next()) e[(r = r.value)] = t[r];
                      t = { __type__: "Error", contents: e };
                    } else if (t instanceof TimeRanges) {
                      for (
                        n = { __type__: "TimeRanges", length: t.length, start: [], end: [] },
                          e = (t = g(Xs(t))).next();
                        !e.done;
                        e = t.next()
                      )
                        ((r = (e = e.value).end), n.start.push(e.start), n.end.push(r));
                      t = n;
                    } else
                      t =
                        ArrayBuffer.isView(t) && 1 === t.BYTES_PER_ELEMENT
                          ? { __type__: "Uint8Array", entries: Array.from(t) }
                          : "number" == typeof t
                            ? isNaN(t)
                              ? "NaN"
                              : isFinite(t)
                                ? t
                                : t < 0
                                  ? "-Infinity"
                                  : "Infinity"
                            : t;
                    return t;
                  }
                });
              }
              function Zf(e) {
                return JSON.parse(e, function (e, t) {
                  if ("NaN" == t) var r = NaN;
                  else if ("-Infinity" == t) r = -1 / 0;
                  else if ("Infinity" == t) r = 1 / 0;
                  else if (t && "object" == typeof t && "TimeRanges" == t.__type__)
                    r = (function (e) {
                      return {
                        length: e.length,
                        start: function (t) {
                          return e.start[t];
                        },
                        end: function (t) {
                          return e.end[t];
                        },
                      };
                    })(t);
                  else if (t && "object" == typeof t && "Uint8Array" == t.__type__)
                    r = new Uint8Array(t.entries);
                  else if (t && "object" == typeof t && "Error" == t.__type__) {
                    for (r in ((e = t.contents), (t = Error(e.message)), e)) t[r] = e[r];
                    r = t;
                  } else r = t && "object" == typeof t && "Event" == t.__type__ ? Zf(t.event) : t;
                  return r;
                });
              }
              (((n = cf.prototype).needsSkipUI = function () {
                return !1;
              }),
                (n.isClientRendering = function () {
                  return !0;
                }),
                (n.hasCustomClick = function () {
                  return !0;
                }),
                (n.isUsingAnotherMediaElement = function () {
                  return !0;
                }),
                (n.getDuration = function () {
                  return this.g.getDuration();
                }),
                (n.getMinSuggestedDuration = function () {
                  return this.g.getMinSuggestedDuration();
                }),
                (n.getRemainingTime = function () {
                  return this.h.getRemainingTime();
                }),
                (n.isPaused = function () {
                  return this.i;
                }),
                (n.isSkippable = function () {
                  return this.g.getSkipTimeOffset() >= 0;
                }),
                (n.getTimeUntilSkippable = function () {
                  var e = this.g.getSkipTimeOffset();
                  return ((e = this.getRemainingTime() - e), Math.max(e, 0));
                }),
                (n.canSkipNow = function () {
                  return this.h.getAdSkippableState();
                }),
                (n.skip = function () {
                  return this.h.skip();
                }),
                (n.pause = function () {
                  return this.h.pause();
                }),
                (n.play = function () {
                  return this.h.resume();
                }),
                (n.getVolume = function () {
                  return this.h.getVolume();
                }),
                (n.setVolume = function (e) {
                  return ((this.m.volume = e), this.h.setVolume(e));
                }),
                (n.isMuted = function () {
                  return 0 == this.h.getVolume();
                }),
                (n.isLinear = function () {
                  return this.g.isLinear();
                }),
                (n.resize = function (e, t) {
                  this.h.resize(e, t);
                }),
                (n.setMuted = function (e) {
                  (this.m.muted = e)
                    ? ((this.j = this.getVolume()), this.h.setVolume(0))
                    : this.h.setVolume(this.j);
                }),
                (n.getSequenceLength = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 1 : e.getTotalAds();
                }),
                (n.getPositionInSequence = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 1 : e.getAdPosition();
                }),
                (n.getTitle = function () {
                  return this.g.getTitle();
                }),
                (n.getDescription = function () {
                  return this.g.getDescription();
                }),
                (n.getVastMediaBitrate = function () {
                  return this.g.getVastMediaBitrate();
                }),
                (n.getVastMediaHeight = function () {
                  return this.g.getVastMediaHeight();
                }),
                (n.getVastMediaWidth = function () {
                  return this.g.getVastMediaWidth();
                }),
                (n.getVastAdId = function () {
                  return "";
                }),
                (n.getAdId = function () {
                  return this.g.getAdId();
                }),
                (n.getCreativeAdId = function () {
                  return this.g.getCreativeAdId();
                }),
                (n.getAdvertiserName = function () {
                  return this.g.getAdvertiserName();
                }),
                (n.getMediaUrl = function () {
                  return this.g.getMediaUrl();
                }),
                (n.getTimeOffset = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 0 : e.getTimeOffset();
                }),
                (n.getPodIndex = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 0 : e.getPodIndex();
                }),
                (n.release = function () {
                  this.h = this.g = null;
                }),
                j("shaka.ads.ClientSideAd", cf),
                (cf.prototype.release = cf.prototype.release),
                (cf.prototype.getPodIndex = cf.prototype.getPodIndex),
                (cf.prototype.getTimeOffset = cf.prototype.getTimeOffset),
                (cf.prototype.getMediaUrl = cf.prototype.getMediaUrl),
                (cf.prototype.getAdvertiserName = cf.prototype.getAdvertiserName),
                (cf.prototype.getCreativeAdId = cf.prototype.getCreativeAdId),
                (cf.prototype.getAdId = cf.prototype.getAdId),
                (cf.prototype.getVastAdId = cf.prototype.getVastAdId),
                (cf.prototype.getVastMediaWidth = cf.prototype.getVastMediaWidth),
                (cf.prototype.getVastMediaHeight = cf.prototype.getVastMediaHeight),
                (cf.prototype.getVastMediaBitrate = cf.prototype.getVastMediaBitrate),
                (cf.prototype.getDescription = cf.prototype.getDescription),
                (cf.prototype.getTitle = cf.prototype.getTitle),
                (cf.prototype.getPositionInSequence = cf.prototype.getPositionInSequence),
                (cf.prototype.getSequenceLength = cf.prototype.getSequenceLength),
                (cf.prototype.setMuted = cf.prototype.setMuted),
                (cf.prototype.resize = cf.prototype.resize),
                (cf.prototype.isLinear = cf.prototype.isLinear),
                (cf.prototype.isMuted = cf.prototype.isMuted),
                (cf.prototype.setVolume = cf.prototype.setVolume),
                (cf.prototype.getVolume = cf.prototype.getVolume),
                (cf.prototype.play = cf.prototype.play),
                (cf.prototype.pause = cf.prototype.pause),
                (cf.prototype.skip = cf.prototype.skip),
                (cf.prototype.canSkipNow = cf.prototype.canSkipNow),
                (cf.prototype.getTimeUntilSkippable = cf.prototype.getTimeUntilSkippable),
                (cf.prototype.isSkippable = cf.prototype.isSkippable),
                (cf.prototype.isPaused = cf.prototype.isPaused),
                (cf.prototype.getRemainingTime = cf.prototype.getRemainingTime),
                (cf.prototype.getMinSuggestedDuration = cf.prototype.getMinSuggestedDuration),
                (cf.prototype.getDuration = cf.prototype.getDuration),
                (cf.prototype.isUsingAnotherMediaElement = cf.prototype.isUsingAnotherMediaElement),
                (cf.prototype.hasCustomClick = cf.prototype.hasCustomClick),
                (cf.prototype.isClientRendering = cf.prototype.isClientRendering),
                (cf.prototype.needsSkipUI = cf.prototype.needsSkipUI),
                j("shaka.ads.Utils", ff),
                (ff.ADS_LOADED = "ads-loaded"),
                (ff.AD_STARTED = "ad-started"),
                (ff.AD_FIRST_QUARTILE = "ad-first-quartile"),
                (ff.AD_MIDPOINT = "ad-midpoint"),
                (ff.AD_THIRD_QUARTILE = "ad-third-quartile"),
                (ff.AD_COMPLETE = "ad-complete"),
                (ff.AD_STOPPED = "ad-stopped"),
                (ff.AD_SKIPPED = "ad-skipped"),
                (ff.AD_VOLUME_CHANGED = "ad-volume-changed"),
                (ff.AD_MUTED = "ad-muted"),
                (ff.AD_PAUSED = "ad-paused"),
                (ff.AD_RESUMED = "ad-resumed"),
                (ff.AD_SKIP_STATE_CHANGED = "ad-skip-state-changed"),
                (ff.CUEPOINTS_CHANGED = "ad-cue-points-changed"),
                (ff.IMA_AD_MANAGER_LOADED = "ima-ad-manager-loaded"),
                (ff.IMA_STREAM_MANAGER_LOADED = "ima-stream-manager-loaded"),
                (ff.AD_CLICKED = "ad-clicked"),
                (ff.AD_PROGRESS = "ad-progress"),
                (ff.AD_BUFFERING = "ad-buffering"),
                (ff.AD_IMPRESSION = "ad-impression"),
                (ff.AD_DURATION_CHANGED = "ad-duration-changed"),
                (ff.AD_CLOSED = "ad-closed"),
                (ff.AD_LOADED = "ad-loaded"),
                (ff.ALL_ADS_COMPLETED = "all-ads-completed"),
                (ff.AD_LINEAR_CHANGED = "ad-linear-changed"),
                (ff.AD_METADATA = "ad-metadata"),
                (ff.AD_RECOVERABLE_ERROR = "ad-recoverable-error"),
                (ff.AD_ERROR = "ad-error"),
                (ff.AD_BREAK_READY = "ad-break-ready"),
                (ff.AD_INTERACTION = "ad-interaction"),
                (ff.AD_CONTENT_PAUSE_REQUESTED = "ad-content-pause-requested"),
                (ff.AD_CONTENT_RESUME_REQUESTED = "ad-content-resume-requested"),
                (ff.AD_CONTENT_ATTACH_REQUESTED = "ad-content-attach-requested"),
                (mf.prototype.configure = function (e) {
                  this.o = e;
                }),
                (mf.prototype.stop = function () {
                  (this.g && this.g.stop(), this.u && Zs(this.u));
                }),
                (mf.prototype.release = function () {
                  (this.stop(),
                    this.B && this.B.disconnect(),
                    this.h && this.h.release(),
                    this.g && this.g.destroy(),
                    this.m.destroy(),
                    this.F.destroy());
                }),
                ((n = bf.prototype).needsSkipUI = function () {
                  return !0;
                }),
                (n.isClientRendering = function () {
                  return !0;
                }),
                (n.hasCustomClick = function () {
                  return null != this.h.clickThroughUrl;
                }),
                (n.isUsingAnotherMediaElement = function () {
                  return this.u;
                }),
                (n.getDuration = function () {
                  var e = this.g.duration;
                  return isNaN(e) ? -1 : e;
                }),
                (n.getMinSuggestedDuration = function () {
                  return this.getDuration();
                }),
                (n.getRemainingTime = function () {
                  var e = this.g.duration;
                  return isNaN(e) ? -1 : e - this.g.currentTime;
                }),
                (n.isPaused = function () {
                  return this.g.paused;
                }),
                (n.isSkippable = function () {
                  return this.i && null != this.l
                    ? this.getDuration() - this.getRemainingTime() < this.j + this.l
                    : this.i;
                }),
                (n.getTimeUntilSkippable = function () {
                  if (this.isSkippable()) {
                    var e = this.getRemainingTime() + this.j - this.getDuration();
                    return Math.max(e, 0);
                  }
                  return Math.max(this.getRemainingTime(), 0);
                }),
                (n.canSkipNow = function () {
                  return this.i && 0 == this.getTimeUntilSkippable();
                }),
                (n.skip = function () {
                  this.canSkipNow() && this.B();
                }),
                (n.pause = function () {
                  return this.g.pause();
                }),
                (n.play = function () {
                  return this.g.play();
                }),
                (n.getVolume = function () {
                  return this.g.volume;
                }),
                (n.setVolume = function (e) {
                  this.g.volume = e;
                }),
                (n.isMuted = function () {
                  return this.g.muted;
                }),
                (n.isLinear = function () {
                  return null == this.C;
                }),
                (n.resize = function () {}),
                (n.setMuted = function (e) {
                  this.g.muted = e;
                }),
                (n.getSequenceLength = function () {
                  return this.o;
                }),
                (n.getPositionInSequence = function () {
                  return this.m;
                }),
                (n.getTitle = function () {
                  return "";
                }),
                (n.getDescription = function () {
                  return "";
                }),
                (n.getVastMediaBitrate = function () {
                  return 0;
                }),
                (n.getVastMediaHeight = function () {
                  return 0;
                }),
                (n.getVastMediaWidth = function () {
                  return 0;
                }),
                (n.getVastAdId = function () {
                  return "";
                }),
                (n.getAdId = function () {
                  return this.h.id || "";
                }),
                (n.getCreativeAdId = function () {
                  return "";
                }),
                (n.getAdvertiserName = function () {
                  return "";
                }),
                (n.getMediaUrl = function () {
                  return this.h.uri;
                }),
                (n.getTimeOffset = function () {
                  return this.h.pre ? 0 : this.h.post ? -1 : this.h.startTime;
                }),
                (n.getPodIndex = function () {
                  return 0;
                }),
                (n.release = function () {
                  this.g = null;
                }),
                j("shaka.ads.InterstitialAd", bf),
                (bf.prototype.release = bf.prototype.release),
                (bf.prototype.getPodIndex = bf.prototype.getPodIndex),
                (bf.prototype.getTimeOffset = bf.prototype.getTimeOffset),
                (bf.prototype.getMediaUrl = bf.prototype.getMediaUrl),
                (bf.prototype.getAdvertiserName = bf.prototype.getAdvertiserName),
                (bf.prototype.getCreativeAdId = bf.prototype.getCreativeAdId),
                (bf.prototype.getAdId = bf.prototype.getAdId),
                (bf.prototype.getVastAdId = bf.prototype.getVastAdId),
                (bf.prototype.getVastMediaWidth = bf.prototype.getVastMediaWidth),
                (bf.prototype.getVastMediaHeight = bf.prototype.getVastMediaHeight),
                (bf.prototype.getVastMediaBitrate = bf.prototype.getVastMediaBitrate),
                (bf.prototype.getDescription = bf.prototype.getDescription),
                (bf.prototype.getTitle = bf.prototype.getTitle),
                (bf.prototype.getPositionInSequence = bf.prototype.getPositionInSequence),
                (bf.prototype.getSequenceLength = bf.prototype.getSequenceLength),
                (bf.prototype.setMuted = bf.prototype.setMuted),
                (bf.prototype.resize = bf.prototype.resize),
                (bf.prototype.isLinear = bf.prototype.isLinear),
                (bf.prototype.isMuted = bf.prototype.isMuted),
                (bf.prototype.setVolume = bf.prototype.setVolume),
                (bf.prototype.getVolume = bf.prototype.getVolume),
                (bf.prototype.play = bf.prototype.play),
                (bf.prototype.pause = bf.prototype.pause),
                (bf.prototype.skip = bf.prototype.skip),
                (bf.prototype.canSkipNow = bf.prototype.canSkipNow),
                (bf.prototype.getTimeUntilSkippable = bf.prototype.getTimeUntilSkippable),
                (bf.prototype.isSkippable = bf.prototype.isSkippable),
                (bf.prototype.isPaused = bf.prototype.isPaused),
                (bf.prototype.getRemainingTime = bf.prototype.getRemainingTime),
                (bf.prototype.getMinSuggestedDuration = bf.prototype.getMinSuggestedDuration),
                (bf.prototype.getDuration = bf.prototype.getDuration),
                (bf.prototype.isUsingAnotherMediaElement = bf.prototype.isUsingAnotherMediaElement),
                (bf.prototype.hasCustomClick = bf.prototype.hasCustomClick),
                (bf.prototype.isClientRendering = bf.prototype.isClientRendering),
                (bf.prototype.needsSkipUI = bf.prototype.needsSkipUI),
                ((n = Sf.prototype).needsSkipUI = function () {
                  return !0;
                }),
                (n.isClientRendering = function () {
                  return !0;
                }),
                (n.hasCustomClick = function () {
                  return null != this.g.clickThroughUrl;
                }),
                (n.isUsingAnotherMediaElement = function () {
                  return !1;
                }),
                (n.getDuration = function () {
                  return -1;
                }),
                (n.getMinSuggestedDuration = function () {
                  return this.getDuration();
                }),
                (n.getRemainingTime = function () {
                  return -1;
                }),
                (n.isPaused = function () {
                  return !1;
                }),
                (n.isSkippable = function () {
                  return !1;
                }),
                (n.getTimeUntilSkippable = function () {
                  return 0;
                }),
                (n.canSkipNow = function () {
                  return !1;
                }),
                (n.skip = function () {}),
                (n.pause = function () {}),
                (n.play = function () {}),
                (n.getVolume = function () {
                  return 1;
                }),
                (n.setVolume = function () {}),
                (n.isMuted = function () {
                  return !1;
                }),
                (n.isLinear = function () {
                  return this.i;
                }),
                (n.resize = function () {}),
                (n.setMuted = function () {}),
                (n.getSequenceLength = function () {
                  return this.j;
                }),
                (n.getPositionInSequence = function () {
                  return this.h;
                }),
                (n.getTitle = function () {
                  return "";
                }),
                (n.getDescription = function () {
                  return "";
                }),
                (n.getVastMediaBitrate = function () {
                  return 0;
                }),
                (n.getVastMediaHeight = function () {
                  return 0;
                }),
                (n.getVastMediaWidth = function () {
                  return 0;
                }),
                (n.getVastAdId = function () {
                  return "";
                }),
                (n.getAdId = function () {
                  return this.g.id || "";
                }),
                (n.getCreativeAdId = function () {
                  return "";
                }),
                (n.getAdvertiserName = function () {
                  return "";
                }),
                (n.getMediaUrl = function () {
                  return this.g.uri;
                }),
                (n.getTimeOffset = function () {
                  return this.g.pre ? 0 : this.g.post ? -1 : this.g.startTime;
                }),
                (n.getPodIndex = function () {
                  return 0;
                }),
                (n.release = function () {}),
                j("shaka.ads.InterstitialStaticAd", Sf),
                (Sf.prototype.release = Sf.prototype.release),
                (Sf.prototype.getPodIndex = Sf.prototype.getPodIndex),
                (Sf.prototype.getTimeOffset = Sf.prototype.getTimeOffset),
                (Sf.prototype.getMediaUrl = Sf.prototype.getMediaUrl),
                (Sf.prototype.getAdvertiserName = Sf.prototype.getAdvertiserName),
                (Sf.prototype.getCreativeAdId = Sf.prototype.getCreativeAdId),
                (Sf.prototype.getAdId = Sf.prototype.getAdId),
                (Sf.prototype.getVastAdId = Sf.prototype.getVastAdId),
                (Sf.prototype.getVastMediaWidth = Sf.prototype.getVastMediaWidth),
                (Sf.prototype.getVastMediaHeight = Sf.prototype.getVastMediaHeight),
                (Sf.prototype.getVastMediaBitrate = Sf.prototype.getVastMediaBitrate),
                (Sf.prototype.getDescription = Sf.prototype.getDescription),
                (Sf.prototype.getTitle = Sf.prototype.getTitle),
                (Sf.prototype.getPositionInSequence = Sf.prototype.getPositionInSequence),
                (Sf.prototype.getSequenceLength = Sf.prototype.getSequenceLength),
                (Sf.prototype.setMuted = Sf.prototype.setMuted),
                (Sf.prototype.resize = Sf.prototype.resize),
                (Sf.prototype.isLinear = Sf.prototype.isLinear),
                (Sf.prototype.isMuted = Sf.prototype.isMuted),
                (Sf.prototype.setVolume = Sf.prototype.setVolume),
                (Sf.prototype.getVolume = Sf.prototype.getVolume),
                (Sf.prototype.play = Sf.prototype.play),
                (Sf.prototype.pause = Sf.prototype.pause),
                (Sf.prototype.skip = Sf.prototype.skip),
                (Sf.prototype.canSkipNow = Sf.prototype.canSkipNow),
                (Sf.prototype.getTimeUntilSkippable = Sf.prototype.getTimeUntilSkippable),
                (Sf.prototype.isSkippable = Sf.prototype.isSkippable),
                (Sf.prototype.isPaused = Sf.prototype.isPaused),
                (Sf.prototype.getRemainingTime = Sf.prototype.getRemainingTime),
                (Sf.prototype.getMinSuggestedDuration = Sf.prototype.getMinSuggestedDuration),
                (Sf.prototype.getDuration = Sf.prototype.getDuration),
                (Sf.prototype.isUsingAnotherMediaElement = Sf.prototype.isUsingAnotherMediaElement),
                (Sf.prototype.hasCustomClick = Sf.prototype.hasCustomClick),
                (Sf.prototype.isClientRendering = Sf.prototype.isClientRendering),
                (Sf.prototype.needsSkipUI = Sf.prototype.needsSkipUI),
                ((n = Ef.prototype).configure = function (e) {
                  ((this.M = e), this.J || wf(this));
                }),
                (n.stop = function () {
                  if (
                    (this.j && this.j.Qa(),
                    this.ma.clear(),
                    this.T.clear(),
                    this.H.clear(),
                    this.i.rg(),
                    this.F.size)
                  )
                    for (var e = Array.from(this.F.values()), t = (e = g(e)).next(); !t.done; t = e.next())
                      (t = t.value) &&
                        t.then(function (e) {
                          e && e.destroy();
                        });
                  if ((this.F.clear(), this.K.size))
                    for (t = (e = g((e = Array.from(this.K.keys())))).next(); !t.done; t = e.next())
                      Ff(this, t.value);
                  (this.K.clear(),
                    this.i.detach(),
                    (this.J = !1),
                    (this.B = this.l = null),
                    (this.u = !0),
                    (this.h = this.g),
                    (this.G = null),
                    Lf(this),
                    xf(this),
                    this.m && Zs(this.m),
                    this.o && (this.o.stop(), (this.o = null)));
                }),
                (n.release = function () {
                  (this.stop(),
                    this.I && this.I.release(),
                    this.j && this.j.release(),
                    this.R && (this.R.stop(), (this.R = null)),
                    this.N && (this.N.stop(), (this.N = null)),
                    this.i.destroy());
                }),
                (n.td = function () {
                  return this.i;
                }),
                (n.addAdUrlInterstitial = function (e) {
                  var t,
                    r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d = this;
                  return D(function (h) {
                    if (1 == h.g) return b(h, _f(d, e, (t = { type: 12 })), 2);
                    if (3 != h.g) {
                      if (((r = h.h), !(i = Xt(r, "VAST,vmap:VMAP")))) throw new ze(2, 10, 10007);
                      if (((n = []), "VAST" == i.tagName)) return ((n = pf(i, d.l)), h.A(3));
                      if ("vmap:VMAP" != i.tagName) return h.A(3);
                      for (
                        a = function (e) {
                          var r, i;
                          return D(function (a) {
                            if (1 == a.g) return b(a, _f(d, e.uri, t), 2);
                            if (((r = a.h), !(i = Xt(r, "VAST")))) throw new ze(2, 10, 10007);
                            (n.push.apply(n, m(pf(i, e.time))), S(a));
                          });
                        },
                          s = [],
                          o = g(
                            (function (e) {
                              for (
                                var t = [], r = (e = g(er(e, "vmap:AdBreak"))).next();
                                !r.done;
                                r = e.next()
                              ) {
                                var i = r.value,
                                  n = i.attributes.timeOffset;
                                n &&
                                  ((r = null),
                                  (r = "start" == n ? null : "end" == n ? 1 / 0 : Vt(n)),
                                  (i = nr(i, "vmap:AdSource")) &&
                                    (i = nr(i, "vmap:AdTagURI")) &&
                                    (i = tr(i)) &&
                                    t.push({ time: r, uri: i }));
                              }
                              return t;
                            })(i),
                          ),
                          l = o.next();
                        !l.done;
                        l = o.next()
                      )
                        ((u = l.value), s.push(a(u)));
                      return s.length ? b(h, Promise.all(s), 3) : h.A(3);
                    }
                    (If(d, n), S(h));
                  });
                }),
                ((n = Bf.prototype).needsSkipUI = function () {
                  return !0;
                }),
                (n.isClientRendering = function () {
                  return !1;
                }),
                (n.hasCustomClick = function () {
                  return !1;
                }),
                (n.isUsingAnotherMediaElement = function () {
                  return !1;
                }),
                (n.getDuration = function () {
                  return this.h.durationInSeconds;
                }),
                (n.getMinSuggestedDuration = function () {
                  return this.getDuration();
                }),
                (n.getRemainingTime = function () {
                  return this.h.startTimeInSeconds + this.h.durationInSeconds - this.g.currentTime;
                }),
                (n.isPaused = function () {
                  return this.g.paused;
                }),
                (n.isSkippable = function () {
                  return "number" == typeof this.j;
                }),
                (n.getTimeUntilSkippable = function () {
                  if ("number" != typeof this.j) return this.getRemainingTime();
                  var e = this.getRemainingTime() + this.j - this.getDuration();
                  return Math.max(e, 0);
                }),
                (n.canSkipNow = function () {
                  return 0 == this.getTimeUntilSkippable();
                }),
                (n.skip = function () {
                  ((this.m = !0), (this.g.currentTime += this.getRemainingTime()));
                }),
                (n.pause = function () {
                  return this.g.pause();
                }),
                (n.play = function () {
                  return this.g.play();
                }),
                (n.getVolume = function () {
                  return this.g.volume;
                }),
                (n.setVolume = function (e) {
                  this.g.volume = e;
                }),
                (n.isMuted = function () {
                  return this.g.muted;
                }),
                (n.isLinear = function () {
                  return this.o;
                }),
                (n.resize = function () {}),
                (n.setMuted = function (e) {
                  this.g.muted = e;
                }),
                (n.getSequenceLength = function () {
                  return this.l ? this.l : 1;
                }),
                (n.getPositionInSequence = function () {
                  return this.i ? this.i : 1;
                }),
                (n.getTitle = function () {
                  return this.h.adTitle;
                }),
                (n.getDescription = function () {
                  return "";
                }),
                (n.getVastMediaBitrate = function () {
                  return 0;
                }),
                (n.getVastMediaHeight = function () {
                  return 0;
                }),
                (n.getVastMediaWidth = function () {
                  return 0;
                }),
                (n.getVastAdId = function () {
                  return this.h.vastAdId || "";
                }),
                (n.getAdId = function () {
                  return this.h.adId;
                }),
                (n.getCreativeAdId = function () {
                  return this.h.creativeId;
                }),
                (n.getAdvertiserName = function () {
                  return "";
                }),
                (n.getMediaUrl = function () {
                  return null;
                }),
                (n.getTimeOffset = function () {
                  return 0;
                }),
                (n.getPodIndex = function () {
                  return 0;
                }),
                (n.release = function () {
                  this.l = this.i = this.g = this.h = null;
                }),
                j("shaka.ads.MediaTailorAd", Bf),
                (Bf.prototype.release = Bf.prototype.release),
                (Bf.prototype.getPodIndex = Bf.prototype.getPodIndex),
                (Bf.prototype.getTimeOffset = Bf.prototype.getTimeOffset),
                (Bf.prototype.getMediaUrl = Bf.prototype.getMediaUrl),
                (Bf.prototype.getAdvertiserName = Bf.prototype.getAdvertiserName),
                (Bf.prototype.getCreativeAdId = Bf.prototype.getCreativeAdId),
                (Bf.prototype.getAdId = Bf.prototype.getAdId),
                (Bf.prototype.getVastAdId = Bf.prototype.getVastAdId),
                (Bf.prototype.getVastMediaWidth = Bf.prototype.getVastMediaWidth),
                (Bf.prototype.getVastMediaHeight = Bf.prototype.getVastMediaHeight),
                (Bf.prototype.getVastMediaBitrate = Bf.prototype.getVastMediaBitrate),
                (Bf.prototype.getDescription = Bf.prototype.getDescription),
                (Bf.prototype.getTitle = Bf.prototype.getTitle),
                (Bf.prototype.getPositionInSequence = Bf.prototype.getPositionInSequence),
                (Bf.prototype.getSequenceLength = Bf.prototype.getSequenceLength),
                (Bf.prototype.setMuted = Bf.prototype.setMuted),
                (Bf.prototype.resize = Bf.prototype.resize),
                (Bf.prototype.isLinear = Bf.prototype.isLinear),
                (Bf.prototype.isMuted = Bf.prototype.isMuted),
                (Bf.prototype.setVolume = Bf.prototype.setVolume),
                (Bf.prototype.getVolume = Bf.prototype.getVolume),
                (Bf.prototype.play = Bf.prototype.play),
                (Bf.prototype.pause = Bf.prototype.pause),
                (Bf.prototype.skip = Bf.prototype.skip),
                (Bf.prototype.canSkipNow = Bf.prototype.canSkipNow),
                (Bf.prototype.getTimeUntilSkippable = Bf.prototype.getTimeUntilSkippable),
                (Bf.prototype.isSkippable = Bf.prototype.isSkippable),
                (Bf.prototype.isPaused = Bf.prototype.isPaused),
                (Bf.prototype.getRemainingTime = Bf.prototype.getRemainingTime),
                (Bf.prototype.getMinSuggestedDuration = Bf.prototype.getMinSuggestedDuration),
                (Bf.prototype.getDuration = Bf.prototype.getDuration),
                (Bf.prototype.isUsingAnotherMediaElement = Bf.prototype.isUsingAnotherMediaElement),
                (Bf.prototype.hasCustomClick = Bf.prototype.hasCustomClick),
                (Bf.prototype.isClientRendering = Bf.prototype.isClientRendering),
                (Bf.prototype.needsSkipUI = Bf.prototype.needsSkipUI),
                ($f.prototype.stop = function () {
                  for (var e = g(this.m), t = e.next(); !t.done; t = e.next())
                    ((t = t.value), this.o.Ma(t.target, t.type, t.listener));
                  (Kf(this),
                    (this.m = []),
                    (this.u = []),
                    (this.H = ""),
                    (this.O = !0),
                    (this.I = ""),
                    (this.B = null),
                    (this.j = []),
                    (this.N = []),
                    this.G.clear());
                }),
                ($f.prototype.release = function () {
                  (this.stop(), this.o && this.o.release());
                }),
                ($f.prototype.onManifestUpdated = function (e) {
                  ((this.J = e),
                    "" != this.H &&
                      ((function (e, t, r) {
                        var i, n, a, s, o, l, u, d, h, c, f, p, m, v, y, T;
                        D(function (x) {
                          if (1 == x.g)
                            return (
                              (i = { type: 8 }),
                              (n = Vn([t], {
                                maxAttempts: 2,
                                baseDelay: 1e3,
                                backoffFactor: 2,
                                fuzzFactor: 0.5,
                                timeout: 3e4,
                                stallTimeout: 5e3,
                                connectionTimeout: 1e4,
                              })),
                              (a = e.K.request(7, n, i)),
                              E(x, 2),
                              b(x, a.promise, 4)
                            );
                          if (2 != x.g) {
                            if (
                              ((s = x.h), (o = []), (l = Xe(s.data)), (u = JSON.parse(l)).avails.length > 0)
                            ) {
                              if (JSON.stringify(e.j) != JSON.stringify(u.avails)) {
                                for (e.j = u.avails, d = g(e.j), h = d.next(); !h.done; h = d.next())
                                  for (
                                    c = h.value, f = g(c.nonLinearAdsList), p = f.next();
                                    !p.done;
                                    p = f.next()
                                  )
                                    for (
                                      m = p.value, v = g(m.nonLinearAdList), y = v.next();
                                      !y.done;
                                      y = v.next()
                                    )
                                      ((T = y.value), jf(e, T));
                                ((o = e.getCuePoints()),
                                  e.i(new Pn("ad-cue-points-changed", new Map().set("cuepoints", o))));
                              }
                            } else
                              (e.j.length &&
                                e.i(new Pn("ad-cue-points-changed", new Map().set("cuepoints", o))),
                                Kf(e),
                                (e.j = []));
                            return (
                              r &&
                                (e.J || o.length > 0) &&
                                (function (e) {
                                  (Hf(e),
                                    e.J ||
                                      (Vf(e),
                                      e.o.D(e.h, "seeked", function () {
                                        Vf(e);
                                      }),
                                      e.o.D(e.h, "ended", function () {
                                        Kf(e);
                                      })),
                                    e.o.D(e.h, "timeupdate", function () {
                                      Hf(e);
                                    }));
                                })(e),
                              w(x, 0)
                            );
                          }
                          (A(x), S(x));
                        });
                      })(this, this.H, this.O),
                      (this.O = !1)));
                }),
                ($f.prototype.getCuePoints = function () {
                  for (var e = [], t = g(this.j), r = t.next(); !r.done; r = t.next())
                    for (var i = (r = g(r.value.ads)).next(); !i.done; i = r.next())
                      ((i = i.value),
                        e.push({
                          start: i.startTimeInSeconds,
                          end: i.startTimeInSeconds + i.durationInSeconds,
                        }));
                  return e;
                }),
                ((n = qf.prototype).needsSkipUI = function () {
                  return !0;
                }),
                (n.isClientRendering = function () {
                  return !1;
                }),
                (n.hasCustomClick = function () {
                  return !0;
                }),
                (n.isUsingAnotherMediaElement = function () {
                  return !1;
                }),
                (n.getDuration = function () {
                  return this.i ? this.i.duration : -1;
                }),
                (n.getMinSuggestedDuration = function () {
                  return this.getDuration();
                }),
                (n.getRemainingTime = function () {
                  return this.i ? this.i.duration - this.i.currentTime : -1;
                }),
                (n.isPaused = function () {
                  return this.h.paused;
                }),
                (n.isSkippable = function () {
                  return this.g.isSkippable();
                }),
                (n.getTimeUntilSkippable = function () {
                  var e = this.g.getSkipTimeOffset();
                  return ((e = this.getRemainingTime() - e), Math.max(e, 0));
                }),
                (n.canSkipNow = function () {
                  return 0 == this.getTimeUntilSkippable();
                }),
                (n.skip = function () {
                  this.h.currentTime += this.getRemainingTime();
                }),
                (n.pause = function () {
                  return this.h.pause();
                }),
                (n.play = function () {
                  return this.h.play();
                }),
                (n.getVolume = function () {
                  return this.h.volume;
                }),
                (n.setVolume = function (e) {
                  this.h.volume = e;
                }),
                (n.isMuted = function () {
                  return this.h.muted;
                }),
                (n.isLinear = function () {
                  return !0;
                }),
                (n.resize = function () {}),
                (n.setMuted = function (e) {
                  this.h.muted = e;
                }),
                (n.getSequenceLength = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 1 : e.getTotalAds();
                }),
                (n.getPositionInSequence = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 1 : e.getAdPosition();
                }),
                (n.getTitle = function () {
                  return this.g.getTitle();
                }),
                (n.getDescription = function () {
                  return this.g.getDescription();
                }),
                (n.getVastMediaBitrate = function () {
                  return 0;
                }),
                (n.getVastMediaHeight = function () {
                  return this.g.getVastMediaHeight();
                }),
                (n.getVastMediaWidth = function () {
                  return this.g.getVastMediaWidth();
                }),
                (n.getVastAdId = function () {
                  return "";
                }),
                (n.getAdId = function () {
                  return this.g.getAdId();
                }),
                (n.getCreativeAdId = function () {
                  return this.g.getCreativeAdId();
                }),
                (n.getAdvertiserName = function () {
                  return this.g.getAdvertiserName();
                }),
                (n.getMediaUrl = function () {
                  return null;
                }),
                (n.getTimeOffset = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 0 : e.getTimeOffset();
                }),
                (n.getPodIndex = function () {
                  var e = this.g.getAdPodInfo();
                  return null == e ? 0 : e.getPodIndex();
                }),
                (n.release = function () {
                  this.h = this.i = this.g = null;
                }),
                j("shaka.ads.ServerSideAd", qf),
                (qf.prototype.release = qf.prototype.release),
                (qf.prototype.getPodIndex = qf.prototype.getPodIndex),
                (qf.prototype.getTimeOffset = qf.prototype.getTimeOffset),
                (qf.prototype.getMediaUrl = qf.prototype.getMediaUrl),
                (qf.prototype.getAdvertiserName = qf.prototype.getAdvertiserName),
                (qf.prototype.getCreativeAdId = qf.prototype.getCreativeAdId),
                (qf.prototype.getAdId = qf.prototype.getAdId),
                (qf.prototype.getVastAdId = qf.prototype.getVastAdId),
                (qf.prototype.getVastMediaWidth = qf.prototype.getVastMediaWidth),
                (qf.prototype.getVastMediaHeight = qf.prototype.getVastMediaHeight),
                (qf.prototype.getVastMediaBitrate = qf.prototype.getVastMediaBitrate),
                (qf.prototype.getDescription = qf.prototype.getDescription),
                (qf.prototype.getTitle = qf.prototype.getTitle),
                (qf.prototype.getPositionInSequence = qf.prototype.getPositionInSequence),
                (qf.prototype.getSequenceLength = qf.prototype.getSequenceLength),
                (qf.prototype.setMuted = qf.prototype.setMuted),
                (qf.prototype.resize = qf.prototype.resize),
                (qf.prototype.isLinear = qf.prototype.isLinear),
                (qf.prototype.isMuted = qf.prototype.isMuted),
                (qf.prototype.setVolume = qf.prototype.setVolume),
                (qf.prototype.getVolume = qf.prototype.getVolume),
                (qf.prototype.play = qf.prototype.play),
                (qf.prototype.pause = qf.prototype.pause),
                (qf.prototype.skip = qf.prototype.skip),
                (qf.prototype.canSkipNow = qf.prototype.canSkipNow),
                (qf.prototype.getTimeUntilSkippable = qf.prototype.getTimeUntilSkippable),
                (qf.prototype.isSkippable = qf.prototype.isSkippable),
                (qf.prototype.isPaused = qf.prototype.isPaused),
                (qf.prototype.getRemainingTime = qf.prototype.getRemainingTime),
                (qf.prototype.getMinSuggestedDuration = qf.prototype.getMinSuggestedDuration),
                (qf.prototype.getDuration = qf.prototype.getDuration),
                (qf.prototype.isUsingAnotherMediaElement = qf.prototype.isUsingAnotherMediaElement),
                (qf.prototype.hasCustomClick = qf.prototype.hasCustomClick),
                (qf.prototype.isClientRendering = qf.prototype.isClientRendering),
                (qf.prototype.needsSkipUI = qf.prototype.needsSkipUI),
                ((n = Xf.prototype).configure = function () {}),
                (n.stop = function () {
                  ((this.C = ""), (this.o = null), (this.F = []));
                }),
                (n.release = function () {
                  (this.stop(), this.h && this.h.release());
                }),
                (n.onCueMetadataChange = function (e) {
                  if (e.key && e.data) {
                    var t = {};
                    ((t[e.key] = e.data), this.g.onTimedMetadata(t));
                  }
                }),
                (n.getCuePoints = function () {
                  return this.F;
                }),
                f(Yf, Fn),
                ((n = Yf.prototype).setLocale = function (e) {
                  this.o = e;
                }),
                (n.configure = function (e) {
                  ((this.l = e),
                    this.g && this.g.configure(this.l),
                    this.j && this.j.configure(this.l),
                    this.h && this.h.configure(this.l));
                }),
                (n.initInterstitial = function (e, t, r) {
                  var i = this;
                  (this.g && this.g.release(),
                    (this.g = new Ef(e, t, r, function (e) {
                      return Qf(i, e);
                    })),
                    this.g.configure(this.l));
                }),
                (n.initClientSide = function (t, r, i) {
                  var n = this;
                  if (!e.google || !google.ima || !google.ima.AdsLoader) throw new ze(2, 10, 1e4);
                  (this.j && this.j.release(),
                    (this.j = new mf(t, r, this.o, i, function (e) {
                      return Qf(n, e);
                    })),
                    this.j.configure(this.l));
                }),
                (n.release = function () {
                  (this.g && (this.g.release(), (this.g = null)),
                    this.j && (this.j.release(), (this.j = null)),
                    this.i && (this.i.release(), (this.i = null)),
                    this.h && (this.h.release(), (this.h = null)),
                    Fn.prototype.release.call(this));
                }),
                (n.onAssetUnload = function () {
                  (this.g && this.g.stop(),
                    this.j && this.j.stop(),
                    this.i && this.i.stop(),
                    this.h && this.h.stop(),
                    this.dispatchEvent(new Pn("ad-stopped")),
                    this.dispatchEvent(new Pn("ad-content-attach-requested")),
                    (this.m = new df()));
                }),
                (n.requestClientSideAds = function (e) {
                  if (!this.j) throw new ze(1, 10, 10001);
                  var t = this.j;
                  (t.g && t.g.destroy(),
                    t.m && t.m.contentComplete(),
                    (t.H = Date.now() / 1e3),
                    t.m.requestAds(e));
                }),
                (n.updateClientSideAdsRenderingSettings = function (e) {
                  if (!this.j) throw new ze(1, 10, 10001);
                  var t = this.j;
                  ((t.C = e), t.g && t.g.updateAdsRenderingSettings(t.C));
                }),
                (n.initMediaTailor = function (e, t, r) {
                  var i = this;
                  (this.i && this.i.release(),
                    (this.i = new $f(e, t, r, function (e) {
                      return Qf(i, e);
                    })));
                }),
                (n.requestMediaTailorStream = function (e, t, r) {
                  if (!this.i) throw new ze(1, 10, 10005);
                  var i = this.i;
                  return (
                    (r = void 0 === r ? "" : r),
                    i.l
                      ? (e = Promise.reject(new ze(1, 10, 10004)))
                      : ((i.l = new kn()),
                        (function (e, t, r) {
                          var i, n, a, s, o, l, u, d, h, c, f, p;
                          D(function (g) {
                            if (1 == g.g)
                              return (
                                (i = { type: 7 }),
                                ((n = Vn([t], {
                                  maxAttempts: 2,
                                  baseDelay: 1e3,
                                  backoffFactor: 2,
                                  fuzzFactor: 0.5,
                                  timeout: 3e4,
                                  stallTimeout: 5e3,
                                  connectionTimeout: 1e4,
                                })).method = "POST"),
                                r && ((a = JSON.stringify(r)), (n.body = Je(a))),
                                (s = e.K.request(7, n, i)),
                                E(g, 2),
                                b(g, s.promise, 4)
                              );
                            if (2 != g.g) {
                              if (
                                ((o = g.h),
                                (l = Xe(o.data)),
                                !(u = JSON.parse(l)).manifestUrl || !u.trackingUrl)
                              )
                                throw Error("Insufficient data from MediaTailor.");
                              return (
                                (d = new me(t)),
                                (h = new me(u.trackingUrl)),
                                (e.H = d.resolve(h).toString()),
                                (c = Date.now() / 1e3),
                                (f = c - e.R),
                                e.i(new Pn("ads-loaded", new Map().set("loadTime", f))),
                                (p = new me(u.manifestUrl)),
                                e.l.resolve(d.resolve(p).toString()),
                                (e.l = null),
                                w(g, 0)
                              );
                            }
                            if ((A(g), !e.I.length))
                              return (
                                e.l.reject(
                                  "MediaTailor request returned an error and there was no backup asset uri provided.",
                                ),
                                (e.l = null),
                                g.return()
                              );
                            (e.l.resolve(e.I), (e.l = null), S(g));
                          });
                        })(i, e, t),
                        (i.I = r || ""),
                        (i.R = Date.now() / 1e3),
                        (e = i.l)),
                    e
                  );
                }),
                (n.addMediaTailorTrackingUrl = function (e) {
                  if (!this.i) throw new ze(1, 10, 10005);
                  var t = this.i;
                  ((t.H = e), t.i(new Pn("ads-loaded", new Map().set("loadTime", 0))));
                }),
                (n.initServerSide = function (t, r) {
                  var i = this;
                  if (!e.google || !google.ima || !google.ima.dai) throw new ze(2, 10, 10002);
                  (this.h && this.h.release(),
                    (this.h = new Xf(t, r, this.o, function (e) {
                      return Qf(i, e);
                    })),
                    this.h.configure(this.l));
                }),
                (n.requestServerSideStream = function (e, t) {
                  if (((t = void 0 === t ? "" : t), !this.h)) throw new ze(1, 10, 10003);
                  e.adTagParameters || (e.adTagParameters = {});
                  var r = e.adTagParameters;
                  return (
                    (r.mpt || r.mpv) &&
                      z(
                        'You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.',
                      ),
                    (e.adTagParameters.mpt = "shaka-player"),
                    (e.adTagParameters.mpv = "v4.16.12"),
                    (r = this.h).j
                      ? (e = Promise.reject(new ze(1, 10, 10004)))
                      : (e instanceof google.ima.dai.api.LiveStreamRequest && (r.H = !0),
                        (r.j = new kn()),
                        r.g.requestStream(e),
                        (r.C = t || ""),
                        (r.G = Date.now() / 1e3),
                        (e = r.j)),
                    e
                  );
                }),
                (n.replaceServerSideAdTagParameters = function (e) {
                  if (!this.h) throw new ze(1, 10, 10003);
                  ((e.mpt || e.mpv) &&
                    z(
                      'You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.',
                    ),
                    (e.mpt = "Shaka Player"),
                    (e.mpv = "v4.16.12"),
                    this.h.g.replaceAdTagParameters(e));
                }),
                (n.getServerSideCuePoints = function () {
                  return (
                    he("AdManager.getServerSideCuePoints", "Please use getCuePoints function."),
                    this.getCuePoints()
                  );
                }),
                (n.getCuePoints = function () {
                  var e = [];
                  return (
                    this.h && (e = e.concat(this.h.getCuePoints())),
                    this.i && (e = e.concat(this.i.getCuePoints())),
                    e
                  );
                }),
                (n.getStats = function () {
                  var e = this.m;
                  return {
                    loadTimes: e.g,
                    averageLoadTime: hf(e),
                    started: e.h,
                    overlayAds: e.j,
                    playedCompletely: e.l,
                    skipped: e.m,
                    errors: e.i,
                  };
                }),
                (n.onManifestUpdated = function (e) {
                  this.i && this.i.onManifestUpdated(e);
                }),
                (n.onDashTimedMetadata = function (e) {
                  this.h &&
                    "urn:google:dai:2018" == e.schemeIdUri &&
                    this.h.g.processMetadata(
                      e.schemeIdUri,
                      e.eventNode ? e.eventNode.attributes.messageData : null,
                      e.startTime,
                    );
                }),
                (n.onHlsTimedMetadata = function (e, t) {
                  this.h && this.h.g.processMetadata("ID3", e.data, t);
                }),
                (n.onCueMetadataChange = function (e) {
                  this.h && this.h.onCueMetadataChange(e);
                }),
                (n.onHLSInterstitialMetadata = function (e, t, r) {
                  (this.l && this.l.disableHLSInterstitial) ||
                    (this.g || this.initInterstitial(null, e, t), this.g && Af(this.g, r));
                }),
                (n.onDASHInterstitialMetadata = function (e, t, r) {
                  if (!this.l || !this.l.disableDASHInterstitial) {
                    var i = r.schemeIdUri;
                    if (
                      "urn:mpeg:dash:event:alternativeMPD:insert:2025" == i ||
                      "urn:mpeg:dash:event:alternativeMPD:replace:2025" == i
                    ) {
                      if (
                        (this.g || this.initInterstitial(null, e, t),
                        this.g &&
                          ((e = this.g),
                          (t = "urn:mpeg:dash:event:alternativeMPD:replace:2025" == r.schemeIdUri),
                          (i = "urn:mpeg:dash:event:alternativeMPD:insert:2025" == r.schemeIdUri),
                          t || i))
                      ) {
                        for (
                          var n,
                            a = r.startTime,
                            s = r.endTime,
                            o = null,
                            l = 0,
                            u = g(r.eventNode.children),
                            d = u.next();
                          !d.done;
                          d = u.next()
                        )
                          if ("AlternativeMPD" == (d = d.value).tagName) {
                            if ((d = d.attributes.uri)) {
                              n = d;
                              break;
                            }
                          } else if (
                            "InsertPresentation" == d.tagName ||
                            "ReplacePresentation" == d.tagName
                          ) {
                            var h = d.attributes.url;
                            if (h) {
                              ((n = et(h)),
                                (u = sr(d, "maxDuration", fr)) && (o = u / r.timescale),
                                (u = sr(d, "returnOffset", fr)) && (l = u / r.timescale),
                                t && l && (s = a + l));
                              break;
                            }
                          }
                        n &&
                          If(e, [
                            {
                              id: r.id,
                              groupId: null,
                              startTime: a,
                              endTime: s,
                              uri: n,
                              mimeType: null,
                              isSkippable: !1,
                              skipOffset: null,
                              skipFor: null,
                              canJump: !0,
                              resumeOffset: i ? l : null,
                              playoutLimit: o,
                              once: !1,
                              pre: !1,
                              post: !1,
                              timelineRange: t && !i,
                              loop: !1,
                              overlay: null,
                              displayOnBackground: !1,
                              currentVideo: null,
                              background: null,
                              clickThroughUrl: null,
                            },
                          ]);
                      }
                    } else
                      ("urn:mpeg:dash:event:2012" == i || "urn:scte:dash:scte214-events" == i) &&
                        r.eventNode &&
                        nr(r.eventNode, "OverlayEvent") &&
                        (this.g || this.initInterstitial(null, e, t),
                        this.g &&
                          (function (e, t) {
                            var r = nr(t.eventNode, "OverlayEvent"),
                              i = r.attributes.uri,
                              n = r.attributes.mimeType,
                              a = "true" == r.attributes.loop,
                              s = sr(r, "z", fr);
                            if (i && 0 != s) {
                              var o = null,
                                l = nr(r, "Background");
                              if (l) {
                                var u = l.attributes.uri;
                                o = u ? "center / contain no-repeat url('" + u + "')" : rr(l);
                              }
                              ((l = 1920), (u = 1080));
                              var d = nr(r, "Viewport");
                              if (d) {
                                if (null == (l = sr(d, "x", fr))) return;
                                if (null == (u = sr(d, "y", fr))) return;
                              }
                              var h = {
                                  viewport: { x: l, y: u },
                                  topLeft: { x: 0, y: 0 },
                                  size: { x: l, y: u },
                                },
                                c = nr(r, "Overlay");
                              if (d && c) {
                                var f = nr(c, "TopLeft"),
                                  p = nr(c, "Size");
                                if (f && p) {
                                  if (null == (c = sr(f, "x", fr))) return;
                                  if (null == (f = sr(f, "y", fr))) return;
                                  var g = sr(p, "x", fr);
                                  if (null == g) return;
                                  if (null == (p = sr(p, "y", fr))) return;
                                  ((h.topLeft.x = c), (h.topLeft.y = f), (h.size.x = g), (h.size.y = p));
                                }
                              }
                              if (
                                ((c = null),
                                (r = nr(r, "Squeeze")),
                                d && r && ((p = nr(r, "TopLeft")), (r = nr(r, "Size")), p && r))
                              ) {
                                if (null == (d = sr(p, "x", fr))) return;
                                if (null == (c = sr(p, "y", fr))) return;
                                if (null == (p = sr(r, "x", fr))) return;
                                if (null == (r = sr(r, "y", fr))) return;
                                c = {
                                  viewport: { x: l, y: u },
                                  topLeft: { x: d, y: c },
                                  size: { x: p, y: r },
                                };
                              }
                              If(e, [
                                {
                                  id: t.id,
                                  groupId: null,
                                  startTime: t.startTime,
                                  endTime: t.endTime,
                                  uri: i,
                                  mimeType: n,
                                  isSkippable: !1,
                                  skipOffset: null,
                                  skipFor: null,
                                  canJump: !0,
                                  resumeOffset: null,
                                  playoutLimit: null,
                                  once: !1,
                                  pre: !1,
                                  post: !1,
                                  timelineRange: !0,
                                  loop: a,
                                  overlay: h,
                                  displayOnBackground: -1 == s,
                                  currentVideo: c,
                                  background: o,
                                  clickThroughUrl: null,
                                },
                              ]);
                            }
                          })(this.g, r));
                  }
                }),
                (n.addCustomInterstitial = function (e) {
                  if (!this.g) throw new ze(1, 10, 10006);
                  If(this.g, [e]);
                }),
                (n.addAdUrlInterstitial = function (e) {
                  if (!this.g) throw new ze(1, 10, 10006);
                  return this.g.addAdUrlInterstitial(e);
                }),
                (n.getInterstitialPlayer = function () {
                  if (!this.g) throw new ze(1, 10, 10006);
                  return this.g.td();
                }),
                j("shaka.ads.AdManager", Yf),
                (Yf.prototype.getInterstitialPlayer = Yf.prototype.getInterstitialPlayer),
                (Yf.prototype.addAdUrlInterstitial = Yf.prototype.addAdUrlInterstitial),
                (Yf.prototype.addCustomInterstitial = Yf.prototype.addCustomInterstitial),
                (Yf.prototype.onDASHInterstitialMetadata = Yf.prototype.onDASHInterstitialMetadata),
                (Yf.prototype.onHLSInterstitialMetadata = Yf.prototype.onHLSInterstitialMetadata),
                (Yf.prototype.onCueMetadataChange = Yf.prototype.onCueMetadataChange),
                (Yf.prototype.onHlsTimedMetadata = Yf.prototype.onHlsTimedMetadata),
                (Yf.prototype.onDashTimedMetadata = Yf.prototype.onDashTimedMetadata),
                (Yf.prototype.onManifestUpdated = Yf.prototype.onManifestUpdated),
                (Yf.prototype.getStats = Yf.prototype.getStats),
                (Yf.prototype.getCuePoints = Yf.prototype.getCuePoints),
                (Yf.prototype.getServerSideCuePoints = Yf.prototype.getServerSideCuePoints),
                (Yf.prototype.replaceServerSideAdTagParameters =
                  Yf.prototype.replaceServerSideAdTagParameters),
                (Yf.prototype.requestServerSideStream = Yf.prototype.requestServerSideStream),
                (Yf.prototype.initServerSide = Yf.prototype.initServerSide),
                (Yf.prototype.addMediaTailorTrackingUrl = Yf.prototype.addMediaTailorTrackingUrl),
                (Yf.prototype.requestMediaTailorStream = Yf.prototype.requestMediaTailorStream),
                (Yf.prototype.initMediaTailor = Yf.prototype.initMediaTailor),
                (Yf.prototype.updateClientSideAdsRenderingSettings =
                  Yf.prototype.updateClientSideAdsRenderingSettings),
                (Yf.prototype.requestClientSideAds = Yf.prototype.requestClientSideAds),
                (Yf.prototype.onAssetUnload = Yf.prototype.onAssetUnload),
                (Yf.prototype.release = Yf.prototype.release),
                (Yf.prototype.initClientSide = Yf.prototype.initClientSide),
                (Yf.prototype.initInterstitial = Yf.prototype.initInterstitial),
                (Yf.prototype.configure = Yf.prototype.configure),
                (Yf.prototype.setLocale = Yf.prototype.setLocale),
                (Yf.ADS_LOADED = "ads-loaded"),
                (Yf.AD_STARTED = "ad-started"),
                (Yf.AD_FIRST_QUARTILE = "ad-first-quartile"),
                (Yf.AD_MIDPOINT = "ad-midpoint"),
                (Yf.AD_THIRD_QUARTILE = "ad-third-quartile"),
                (Yf.AD_COMPLETE = "ad-complete"),
                (Yf.AD_STOPPED = "ad-stopped"),
                (Yf.AD_SKIPPED = "ad-skipped"),
                (Yf.AD_VOLUME_CHANGED = "ad-volume-changed"),
                (Yf.AD_MUTED = "ad-muted"),
                (Yf.AD_PAUSED = "ad-paused"),
                (Yf.AD_RESUMED = "ad-resumed"),
                (Yf.AD_SKIP_STATE_CHANGED = "ad-skip-state-changed"),
                (Yf.CUEPOINTS_CHANGED = "ad-cue-points-changed"),
                (Yf.IMA_AD_MANAGER_LOADED = "ima-ad-manager-loaded"),
                (Yf.IMA_STREAM_MANAGER_LOADED = "ima-stream-manager-loaded"),
                (Yf.AD_CLICKED = "ad-clicked"),
                (Yf.AD_PROGRESS = "ad-progress"),
                (Yf.AD_BUFFERING = "ad-buffering"),
                (Yf.AD_IMPRESSION = "ad-impression"),
                (Yf.AD_DURATION_CHANGED = "ad-duration-changed"),
                (Yf.AD_CLOSED = "ad-closed"),
                (Yf.AD_LOADED = "ad-loaded"),
                (Yf.ALL_ADS_COMPLETED = "all-ads-completed"),
                (Yf.AD_LINEAR_CHANGED = "ad-linear-changed"),
                (Yf.AD_METADATA = "ad-metadata"),
                (Yf.AD_RECOVERABLE_ERROR = "ad-recoverable-error"),
                (Yf.AD_ERROR = "ad-error"),
                (Yf.AD_BREAK_READY = "ad-break-ready"),
                (Yf.AD_INTERACTION = "ad-interaction"),
                (Yf.AD_CONTENT_PAUSE_REQUESTED = "ad-content-pause-requested"),
                (Yf.AD_CONTENT_RESUME_REQUESTED = "ad-content-resume-requested"),
                (Yf.AD_CONTENT_ATTACH_REQUESTED = "ad-content-attach-requested"),
                (lf = function () {
                  return new Yf();
                }));
              var ep =
                  "ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(
                    " ",
                  ),
                tp =
                  "buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(
                    " ",
                  ),
                rp = ["loop", "playbackRate"],
                ip = ["pause", "play"],
                np = new Map()
                  .set("getAssetUri", 2)
                  .set("getAudioLanguages", 4)
                  .set("getAudioLanguagesAndRoles", 4)
                  .set("getBufferFullness", 1)
                  .set("getBufferedInfo", 2)
                  .set("getExpiration", 2)
                  .set("getKeyStatuses", 2)
                  .set("getPlaybackRate", 2)
                  .set("getTextLanguages", 4)
                  .set("getTextLanguagesAndRoles", 4)
                  .set("isAudioOnly", 10)
                  .set("isBuffering", 1)
                  .set("isInProgress", 1)
                  .set("isLive", 10)
                  .set("isTextTrackVisible", 1)
                  .set("isVideoOnly", 10)
                  .set("keySystem", 10)
                  .set("seekRange", 1)
                  .set("getLoadMode", 10)
                  .set("getManifestType", 10)
                  .set("isFullyLoaded", 1)
                  .set("isEnded", 1)
                  .set("getBandwidthEstimate", 1)
                  .set("isRemotePlayback", 1),
                ap = new Map()
                  .set("getConfiguration", 4)
                  .set("getConfigurationForLowLatency", 4)
                  .set("getStats", 5)
                  .set("getAudioTracks", 2)
                  .set("getChaptersTracks", 2)
                  .set("getImageTracks", 2)
                  .set("getVideoTracks", 2)
                  .set("getTextTracks", 2)
                  .set("getVariantTracks", 2),
                sp = new Map()
                  .set("getPlayheadTimeAsDate", 1)
                  .set("getPresentationStartTimeAsDate", 20)
                  .set("getSegmentAvailabilityDuration", 20),
                op = [
                  [
                    "getConfiguration",
                    "configure",
                    "getConfigurationForLowLatency",
                    "configurationForLowLatency",
                  ],
                ],
                lp = [["isTextTrackVisible", "setTextTrackVisibility"]],
                up =
                  "cancelTrickPlay configure configurationForLowLatency getChapters resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel selectVideoTrack setTextTrackVisibility trickPlay updateStartTime goToLive useTrickPlayTrackIfAvailable".split(
                    " ",
                  ),
                dp =
                  "addChaptersTrack addTextTrackAsync addThumbnailsTrack getAllThumbnails getChaptersAsync getThumbnails attach attachCanvas detach load unload".split(
                    " ",
                  );
              function hp(e, t, r, i, n, a, s) {
                var o = this;
                ((this.H = e),
                  (this.K = s),
                  (this.l = new Ri(t)),
                  (this.M = r),
                  (this.u = !1),
                  (this.B = i),
                  (this.G = n),
                  (this.N = a),
                  (this.i = this.m = !1),
                  (this.J = ""),
                  (this.o = null),
                  (this.C = function () {
                    return gp(o);
                  }),
                  (this.F = function (e, t) {
                    switch ((e = Zf(t)).type) {
                      case "event":
                        var r = e.targetName,
                          i = On(e.event);
                        o.B(r, i);
                        break;
                      case "update":
                        for (i in (r = e.update)) for (var n in ((e = o.g[i] || {}), r[i])) e[n] = r[i][n];
                        o.u && (o.M(), (o.u = !1));
                        break;
                      case "asyncComplete":
                        if (((n = e.id), (i = e.error), (t = e.res), (e = o.h.get(n)), o.h.delete(n), e))
                          if (i) {
                            for (r in ((n = new ze(i.severity, i.category, i.code)), i)) n[r] = i[r];
                            e.reject(n);
                          } else e.resolve(t);
                    }
                  }),
                  (this.g = { video: {}, player: {} }),
                  (this.I = 0),
                  (this.h = new Map()),
                  (this.j = null),
                  Ep.add(this));
              }
              function cp(e, t) {
                var r = e.N();
                ((bp = t),
                  t.addUpdateListener(e.C),
                  t.addMessageListener("urn:x-cast:com.google.shaka.v2", e.F),
                  gp(e),
                  vp(e, { type: "init", initState: r, appData: e.o }),
                  e.j.resolve());
              }
              function fp(e, t) {
                var r = 8003;
                switch (t.code) {
                  case "cancel":
                    r = 8004;
                    break;
                  case "timeout":
                    r = 8005;
                    break;
                  case "receiver_unavailable":
                    r = 8006;
                }
                e.j.reject(new ze(2, 8, r, t));
              }
              function pp(e) {
                var t = bp;
                (t.removeUpdateListener(e.C), t.removeMessageListener("urn:x-cast:com.google.shaka.v2", e.F));
              }
              function gp(e) {
                var t = !!bp && "connected" == bp.status;
                if (e.i && !t) {
                  for (var r in (e.G(), e.g)) e.g[r] = {};
                  mp(e);
                }
                ((e.i = t), (e.J = t ? bp.receiver.friendlyName : ""), e.l.Jb());
              }
              function mp(e) {
                if (e.h)
                  for (var t = g(e.h.keys()), r = t.next(); !r.done; r = t.next()) {
                    r = r.value;
                    var i = e.h.get(r);
                    (e.h.delete(r), i.reject(new ze(1, 7, 7e3)));
                  }
              }
              function vp(e, t) {
                t = Jf(t);
                var r = bp;
                try {
                  r.sendMessage("urn:x-cast:com.google.shaka.v2", t, function () {}, X);
                } catch (i) {
                  throw (
                    (t = new ze(2, 8, 8005, i)),
                    (r = new Pn("error", new Map().set("detail", t))),
                    e.B("player", r),
                    e.qd(),
                    t
                  );
                }
              }
              (((n = hp.prototype).destroy = function () {
                return (
                  Ep.delete(this),
                  mp(this),
                  bp && pp(this),
                  this.l && (this.l.stop(), (this.l = null)),
                  (this.G = this.B = null),
                  (this.i = this.m = !1),
                  (this.F = this.C = this.j = this.h = this.g = this.o = null),
                  Promise.resolve()
                );
              }),
                (n.wb = function () {
                  return this.i;
                }),
                (n.eh = function () {
                  return this.J;
                }),
                (n.init = function () {
                  if (this.H.length)
                    if (e.chrome && chrome.cast && chrome.cast.isAvailable) {
                      ((this.m = !0), this.l.Jb());
                      var t = new chrome.cast.SessionRequest(this.H, [], null, this.K, null);
                      ((t = new chrome.cast.ApiConfig(
                        t,
                        function (e) {
                          for (var t = g(Ep), r = t.next(); !r.done; r = t.next()) {
                            var i = e;
                            (((r = r.value).j = new kn()), (r.u = !0), cp(r, i));
                          }
                        },
                        function (e) {
                          for (var t = g(Ep), r = t.next(); !r.done; r = t.next())
                            ((r = r.value), (Tp = "available" == e), r.l.Jb());
                        },
                        "origin_scoped",
                      )),
                        chrome.cast.initialize(
                          t,
                          function () {},
                          function () {},
                        ),
                        Tp && this.l.ka(yp),
                        (t = bp) && t.status != chrome.cast.SessionStatus.STOPPED
                          ? ((this.j = new kn()), (this.u = !0), cp(this, t))
                          : (bp = null));
                    } else
                      e.__onGCastApiAvailable !== xp &&
                        ((Sp = e.__onGCastApiAvailable || null), (e.__onGCastApiAvailable = xp));
                }),
                (n.qh = function (e) {
                  ((this.o = e), this.i && vp(this, { type: "appData", appData: this.o }));
                }),
                (n.cast = function () {
                  var e = this;
                  return D(function (t) {
                    if (!e.m) throw new ze(1, 8, 8e3);
                    if (!Tp) throw new ze(1, 8, 8001);
                    if (e.i) throw new ze(1, 8, 8002);
                    return (
                      (e.j = new kn()),
                      chrome.cast.requestSession(
                        function (t) {
                          return cp(e, t);
                        },
                        function (t) {
                          return fp(e, t);
                        },
                      ),
                      b(t, e.j, 0)
                    );
                  });
                }),
                (n.qd = function () {
                  if (this.i) {
                    if ((mp(this), bp)) {
                      pp(this);
                      try {
                        bp.stop(
                          function () {},
                          function () {},
                        );
                      } catch (pw) {}
                      bp = null;
                    }
                    gp(this);
                  }
                }),
                (n.get = function (e, t) {
                  var r = this;
                  if ("video" == e) {
                    if (ip.includes(t))
                      return function () {
                        return r.Mi.apply(r, [e, t].concat(m(_.apply(0, arguments))));
                      };
                  } else if ("player" == e) {
                    if (sp.has(t) && !this.get("player", "isLive")()) return function () {};
                    if (up.includes(t))
                      return function () {
                        return r.Mi.apply(r, [e, t].concat(m(_.apply(0, arguments))));
                      };
                    if (dp.includes(t))
                      return function () {
                        return r.Pk.apply(r, [e, t].concat(m(_.apply(0, arguments))));
                      };
                    if (np.has(t) || ap.has(t))
                      return function () {
                        return r.g[e][t];
                      };
                  }
                  return this.g[e][t];
                }),
                (n.set = function (e, t, r) {
                  ((this.g[e][t] = r), vp(this, { type: "set", targetName: e, property: t, value: r }));
                }),
                (n.Mi = function (e, t) {
                  vp(this, { type: "call", targetName: e, methodName: t, args: _.apply(2, arguments) });
                }),
                (n.Pk = function (e, t) {
                  var r = _.apply(2, arguments),
                    i = new kn(),
                    n = this.I.toString();
                  (this.I++, this.h.set(n, i));
                  try {
                    vp(this, { type: "asyncCall", targetName: e, methodName: t, args: r, id: n });
                  } catch (a) {
                    i.reject(a);
                  }
                  return i;
                }));
              var yp = 0.02,
                Tp = !1,
                bp = null,
                Sp = null,
                Ep = new Set();
              function xp(t) {
                if ((Sp ? (e.__onGCastApiAvailable = Sp) : delete e.__onGCastApiAvailable, (Sp = null), t))
                  for (var r = g(Ep), i = r.next(); !i.done; i = r.next()) i.value.init();
                "function" == typeof e.__onGCastApiAvailable && e.__onGCastApiAvailable(t);
              }
              function wp(t, r, i, n) {
                ((n = void 0 !== n && n), Fn.call(this));
                var a = this;
                ((this.i = t),
                  (this.h = r),
                  (this.l = this.o = this.m = this.u = this.j = null),
                  (this.I = i),
                  (this.H = n),
                  (this.F = []),
                  (this.C = []),
                  (this.B = []),
                  (this.G = new Map()),
                  (this.g = null),
                  e.chrome && "CAST" != se().Oa()
                    ? ((this.g = new hp(
                        i,
                        function () {
                          return kp(a);
                        },
                        function () {
                          return Rp(a);
                        },
                        function (e, t) {
                          return Dp(a, e, t);
                        },
                        function () {
                          return Cp(a);
                        },
                        function () {
                          return Ip(a);
                        },
                        n,
                      )),
                      (function (e) {
                        (e.g.init(), (e.l = new re()));
                        for (var t = g(ep), r = t.next(); !r.done; r = t.next())
                          e.l.D(e.i, r.value, function (t) {
                            e.g.wb() || ((t = On(t)), e.m.dispatchEvent(t));
                          });
                        for (var i in Nn)
                          e.l.D(e.h, Nn[i], function (t) {
                            e.g.wb() || e.o.dispatchEvent(t);
                          });
                        for (var n in ((e.j = {}), (t = {}), e.i))
                          (((t = { ie: t.ie }).ie = n),
                            Object.defineProperty(e.j, t.ie, {
                              configurable: !1,
                              enumerable: !0,
                              get: (function (t) {
                                return function () {
                                  return Lp(e, t.ie);
                                };
                              })(t),
                              set: (function (t) {
                                return function (r) {
                                  var i = t.ie;
                                  e.g.wb() ? e.g.set("video", i, r) : (e.i[i] = r);
                                };
                              })(t),
                            }));
                        ((e.u = {}),
                          Ap(e, function (t) {
                            Object.defineProperty(e.u, t, {
                              configurable: !1,
                              enumerable: !0,
                              get: function () {
                                return Mp(e, t);
                              },
                            });
                          }),
                          (function (e) {
                            var t = new Map();
                            Ap(e, function (r, i) {
                              t.has(i)
                                ? ((i = t.get(i)), r.length < i.length ? e.G.set(r, i) : e.G.set(i, r))
                                : t.set(i, r);
                            });
                          })(e),
                          (e.m = new Fn()),
                          (e.m.Je = e.j),
                          (e.o = new Fn()),
                          (e.o.Je = e.u),
                          e.l.D(e.h, "unloading", function () {
                            (e.g && e.g.wb()) || _p(e);
                          }));
                      })(this))
                    : ((this.j = this.i), (this.u = this.h)));
              }
              function Ap(e, t) {
                function r(e) {
                  return "constructor" != e && "function" == typeof n[e] && !a.has(e);
                }
                var i,
                  n = e.h,
                  a = new Set();
                for (i in n) r(i) && (a.add(i), t(i, n[i]));
                for (e = Object.getPrototypeOf(n), i = Object.getPrototypeOf({}); e && e != i; ) {
                  for (var s = g(Object.getOwnPropertyNames(e)), o = s.next(); !o.done; o = s.next())
                    r((o = o.value)) && (a.add(o), t(o, n[o]));
                  e = Object.getPrototypeOf(e);
                }
              }
              function Ip(e) {
                var t = {
                  video: {},
                  player: {},
                  playerAfterLoad: {},
                  manifest: e.h.rd(),
                  startTime: null,
                  addThumbnailsTrackCalls: e.F,
                  addTextTrackAsyncCalls: e.C,
                  addChaptersTrackCalls: e.B,
                };
                e.i.pause();
                for (var r = g(rp), i = r.next(); !i.done; i = r.next())
                  ((i = i.value), (t.video[i] = e.i[i]));
                for (
                  e.i.ended || (t.startTime = e.i.currentTime), i = (r = g(op)).next();
                  !i.done;
                  i = r.next()
                ) {
                  var n = i.value;
                  ((i = n[1]), (n = e.h[n[0]]()), (t.player[i] = n));
                }
                for (i = (r = g(lp)).next(); !i.done; i = r.next())
                  ((i = (n = i.value)[1]), (n = e.h[n[0]]()), (t.playerAfterLoad[i] = n));
                return t;
              }
              function kp(e) {
                var t = new Pn("caststatuschanged");
                e.dispatchEvent(t);
              }
              function Rp(e) {
                var t = new Pn(e.j.paused ? "pause" : "play");
                e.m.dispatchEvent(t);
              }
              function Cp(e) {
                for (var t = g(op), r = t.next(); !r.done; r = t.next()) {
                  var i = r.value;
                  ((r = i[1]), (i = e.g.get("player", i[0])()), e.h[r](i));
                }
                var n = e.F,
                  a = e.C,
                  s = e.B;
                _p(e);
                var o = e.g.get("player", "getAssetUri")();
                ((i = e.g.get("video", "ended")), (t = Promise.resolve()));
                var l,
                  u = e.i.autoplay;
                ((r = null),
                  i || (r = e.g.get("video", "currentTime")),
                  (i = e.g.get("player", "getTextTracks")()) &&
                    i.length &&
                    (l = i.find(function (e) {
                      return e.active;
                    })));
                var d = e.g.get("player", "isTextTrackVisible")();
                o && ((e.i.autoplay = !1), (t = e.h.load(o, r)));
                var h = {};
                for (i = (r = g(rp)).next(); !i.done; i = r.next())
                  ((i = i.value), (h[i] = e.g.get("video", i)));
                t.then(
                  function () {
                    if (e.i) {
                      for (var t = g(n), r = t.next(); !r.done; r = t.next()) {
                        var i;
                        ((r = r.value), (i = e.td()).Pe.apply(i, m(r)));
                      }
                      for (i = (t = g(a)).next(); !i.done; i = t.next()) {
                        var c;
                        ((i = i.value), (c = e.td()).Rd.apply(c, m(i)));
                      }
                      for (t = (c = g(s)).next(); !t.done; t = c.next()) {
                        var f;
                        ((t = t.value), (f = e.td()).Oe.apply(f, m(t)));
                      }
                      for (c = (f = g(rp)).next(); !c.done; c = f.next()) ((c = c.value), (e.i[c] = h[c]));
                      for (c = (f = g(lp)).next(); !c.done; c = f.next())
                        ((c = (t = c.value)[1]), (t = e.g.get("player", t[0])()), e.h[c](t));
                      (e.h.wh(d),
                        l && e.h.oh(l.language, l.roles, l.forced),
                        (e.i.autoplay = u),
                        o && e.i.play());
                    }
                  },
                  function (t) {
                    ((t = new Pn("error", (t = new Map().set("detail", t)))), e.h.dispatchEvent(t));
                  },
                );
              }
              function Lp(e, t) {
                if ("addEventListener" == t)
                  return function (t, r, i) {
                    return e.m.addEventListener(t, r, i);
                  };
                if ("removeEventListener" == t)
                  return function (t, r, i) {
                    return e.m.removeEventListener(t, r, i);
                  };
                if (e.g.wb() && 0 == Object.keys(e.g.g.video).length) {
                  var r = e.i[t];
                  if ("function" != typeof r) return r;
                }
                return e.g.wb()
                  ? e.g.get("video", t)
                  : ("function" == typeof (t = e.i[t]) && (t = t.bind(e.i)), t);
              }
              function Mp(e, t, r) {
                if (((r = void 0 !== r && r), e.G.has(t) && (t = e.G.get(t)), "addEventListener" == t))
                  return function (t, r, i) {
                    return e.o.addEventListener(t, r, i);
                  };
                if ("removeEventListener" == t)
                  return function (t, r, i) {
                    return e.o.removeEventListener(t, r, i);
                  };
                if ("getMediaElement" == t)
                  return function () {
                    return e.j;
                  };
                if ("getSharedConfiguration" == t) return e.g.get("player", "getConfiguration");
                if ("getNetworkingEngine" == t)
                  return function () {
                    return e.h.Yb();
                  };
                if ("getDrmEngine" == t)
                  return function () {
                    return e.h.F;
                  };
                if ("getAdManager" == t)
                  return function () {
                    return e.h.di();
                  };
                if ("getQueueManager" == t)
                  return function () {
                    return e.h.mi();
                  };
                if ("setVideoContainer" == t)
                  return function (t) {
                    return e.h.Zi(t);
                  };
                if (!r) {
                  if ("addThumbnailsTrack" == t)
                    return function () {
                      var r = _.apply(0, arguments);
                      return (e.F.push(r), Mp(e, t, !0).apply(null, m(r)));
                    };
                  if ("addTextTrackAsync" == t)
                    return function () {
                      var r = _.apply(0, arguments);
                      return (e.C.push(r), Mp(e, t, !0).apply(null, m(r)));
                    };
                  if ("addChaptersTrack" == t)
                    return function () {
                      var r = _.apply(0, arguments);
                      return (e.B.push(r), Mp(e, t, !0).apply(null, m(r)));
                    };
                }
                if (e.g.wb()) {
                  if ("getManifest" == t || "drmInfo" == t)
                    return function () {
                      return (z(t + "() does not work while casting!"), null);
                    };
                  if ("attach" == t || "detach" == t)
                    return function () {
                      return (z(t + "() does not work while casting!"), Promise.resolve());
                    };
                  if ("getChapters" == t)
                    return function () {
                      return (z(t + "() does not work while casting!"), []);
                    };
                }
                return (e.g.wb() && 0 == Object.keys(e.g.g.video).length && (np.has(t) || ap.has(t))) ||
                  !e.g.wb()
                  ? e.h[t].bind(e.h)
                  : e.g.get("player", t);
              }
              function Dp(e, t, r) {
                e.g.wb() &&
                  ("video" == t
                    ? e.m.dispatchEvent(r)
                    : "player" == t && ("unloading" == r.type && _p(e), e.o.dispatchEvent(r)));
              }
              function _p(e) {
                ((e.F = []), (e.C = []), (e.B = []));
              }
              function Pp(e, t, r, i) {
                Fn.call(this);
                var n = this;
                ((this.h = e),
                  (this.g = t),
                  (this.j = new re()),
                  (this.I = { video: e, player: t }),
                  (this.G = r || function () {}),
                  (this.J =
                    i ||
                    function (e) {
                      return e;
                    }),
                  (this.i = null),
                  (this.H = !1),
                  (this.o = !0),
                  (this.m = 0),
                  (this.C = !1),
                  (this.B = !0),
                  (this.u = this.l = null),
                  (this.F = new Ri(function () {
                    Up(n);
                  })),
                  (function (e) {
                    var t = cast.receiver.CastReceiverManager.getInstance();
                    ((t.onSenderConnected = function () {
                      return Op(e);
                    }),
                      (t.onSenderDisconnected = function () {
                        return Op(e);
                      }),
                      (t.onSystemVolumeChanged = function () {
                        var t = cast.receiver.CastReceiverManager.getInstance().getSystemVolume();
                        (t &&
                          Gp(
                            e,
                            { type: "update", update: { video: { volume: t.level, muted: t.muted } } },
                            e.l,
                          ),
                          Gp(
                            e,
                            { type: "event", targetName: "video", event: { type: "volumechange" } },
                            e.l,
                          ));
                      }),
                      (e.u = t.getCastMessageBus("urn:x-cast:com.google.cast.media")),
                      (e.u.onMessage = function (t) {
                        return (function (e, t) {
                          var r = Zf(t.data);
                          switch (r.type) {
                            case "PLAY":
                              (e.h.play(), Vp(e));
                              break;
                            case "PAUSE":
                              (e.h.pause(), Vp(e));
                              break;
                            case "SEEK":
                              t = r.currentTime;
                              var i = r.resumeState;
                              (null != t && (e.h.currentTime = Number(t)),
                                i && "PLAYBACK_START" == i
                                  ? (e.h.play(), Vp(e))
                                  : i && "PLAYBACK_PAUSE" == i && (e.h.pause(), Vp(e)));
                              break;
                            case "STOP":
                              e.g.Cc().then(function () {
                                e.g && Vp(e);
                              });
                              break;
                            case "GET_STATUS":
                              $p(e, Number(r.requestId));
                              break;
                            case "VOLUME":
                              ((t = (i = r.volume).level), (i = i.muted));
                              var n = e.h.volume,
                                a = e.h.muted;
                              (null != t && (e.h.volume = Number(t)),
                                null != i && (e.h.muted = i),
                                (n == e.h.volume && a == e.h.muted) || Vp(e));
                              break;
                            case "LOAD":
                              ((e.m = 0),
                                (e.C = !1),
                                (e.B = !1),
                                (t = r.media),
                                (i = r.currentTime),
                                (n = e.J(t.contentId)),
                                (a = r.autoplay || !0),
                                e.G(t.customData),
                                a && (e.h.autoplay = !0),
                                e.g
                                  .load(n, i)
                                  .then(function () {
                                    e.g && $p(e);
                                  })
                                  .catch(function (t) {
                                    var i = "LOAD_FAILED";
                                    (7 == t.category && 7e3 == t.code && (i = "LOAD_CANCELLED"),
                                      Gp(e, { requestId: Number(r.requestId), type: i }, e.u));
                                  }));
                              break;
                            default:
                              Gp(
                                e,
                                {
                                  requestId: Number(r.requestId),
                                  type: "INVALID_REQUEST",
                                  reason: "INVALID_COMMAND",
                                },
                                e.u,
                              );
                          }
                        })(e, t);
                      }),
                      (e.l = t.getCastMessageBus("urn:x-cast:com.google.shaka.v2")),
                      (e.l.onMessage = function (t) {
                        return (function (e, t) {
                          var r = Zf(t.data);
                          switch (r.type) {
                            case "init":
                              ((e.m = 0),
                                (e.C = !1),
                                (e.B = !0),
                                (function (e, t, r) {
                                  var i, n, a, s, o, l, u, d, h, c, f, p, v, y, T, x, I, k, R;
                                  D(function (C) {
                                    switch (C.g) {
                                      case 1:
                                        for (i in t.player) ((n = t.player[i]), e.g[i](n));
                                        return (
                                          e.G(r),
                                          (a = e.h.autoplay),
                                          t.manifest
                                            ? ((e.h.autoplay = !1),
                                              E(C, 5),
                                              b(C, e.g.load(t.manifest, t.startTime), 7))
                                            : b(C, Promise.resolve(), 3)
                                        );
                                      case 7:
                                        if (t.addThumbnailsTrackCalls)
                                          for (
                                            s = g(t.addThumbnailsTrackCalls), o = s.next();
                                            !o.done;
                                            o = s.next()
                                          )
                                            ((l = o.value), e.g.Pe.apply(e.g, m(l)));
                                        if (t.addTextTrackAsyncCalls)
                                          for (
                                            u = g(t.addTextTrackAsyncCalls), d = u.next();
                                            !d.done;
                                            d = u.next()
                                          )
                                            ((h = d.value), e.g.Rd.apply(e.g, m(h)));
                                        if (t.addChaptersTrackCalls)
                                          for (
                                            c = g(t.addChaptersTrackCalls), f = c.next();
                                            !f.done;
                                            f = c.next()
                                          )
                                            ((p = f.value), e.g.Oe.apply(e.g, m(p)));
                                        w(C, 3);
                                        break;
                                      case 5:
                                        return (
                                          (v = A(C)),
                                          (y = new Map().set("detail", v)),
                                          (T = new Pn("error", y)),
                                          e.g && e.g.dispatchEvent(T),
                                          C.return()
                                        );
                                      case 3:
                                        if (!e.g) return C.return();
                                        for (x in t.video) ((I = t.video[x]), (e.h[x] = I));
                                        for (k in t.playerAfterLoad) ((R = t.playerAfterLoad[k]), e.g[k](R));
                                        ((e.h.autoplay = a), t.manifest && (e.h.play(), Vp(e)), S(C));
                                    }
                                  });
                                })(e, r.initState, r.appData),
                                Up(e));
                              break;
                            case "appData":
                              e.G(r.appData);
                              break;
                            case "set":
                              var i = r.targetName,
                                n = r.property;
                              if (((r = r.value), "video" == i)) {
                                if (((t = cast.receiver.CastReceiverManager.getInstance()), "volume" == n)) {
                                  t.setSystemVolumeLevel(r);
                                  break;
                                }
                                if ("muted" == n) {
                                  t.setSystemVolumeMuted(r);
                                  break;
                                }
                              }
                              e.I[i][n] = r;
                              break;
                            case "call":
                              (i = e.I[r.targetName])[r.methodName].apply(i, r.args);
                              break;
                            case "asyncCall":
                              ((i = r.targetName),
                                (n = r.methodName),
                                "player" == i && "load" == n && ((e.m = 0), (e.C = !1)));
                              var a = r.id,
                                s = t.senderId;
                              ((r = (t = e.I[i])[n].apply(t, r.args)),
                                "player" == i &&
                                  "load" == n &&
                                  (r = r.then(function () {
                                    e.B = !0;
                                  })),
                                r.then(
                                  function (t) {
                                    return jp(e, s, a, null, t);
                                  },
                                  function (t) {
                                    return jp(e, s, a, t, null);
                                  },
                                ));
                          }
                        })(e, t);
                      }),
                      t.start());
                    for (var r = (t = g(ep)).next(); !r.done; r = t.next())
                      e.j.D(e.h, r.value, function (t) {
                        return Fp(e, "video", t);
                      });
                    for (var i in Nn)
                      e.j.D(e.g, Nn[i], function (t) {
                        return Fp(e, "player", t);
                      });
                    (e.j.D(e.h, "loadeddata", function () {
                      e.C = !0;
                    }),
                      e.j.D(e.g, "loading", function () {
                        ((e.o = !1), Np(e));
                      }),
                      e.j.D(e.h, "playing", function () {
                        ((e.o = !1), Np(e));
                      }),
                      e.j.D(e.h, "pause", function () {
                        Np(e);
                      }),
                      e.j.D(e.g, "unloading", function () {
                        ((e.o = !0), Np(e));
                      }),
                      e.j.D(e.h, "ended", function () {
                        new Ri(function () {
                          e.h && e.h.ended && ((e.o = !0), Np(e));
                        }).ka(Kp);
                      }));
                  })(this));
              }
              function Op(e) {
                ((e.m = 0),
                  (e.B = !0),
                  (e.H = 0 != cast.receiver.CastReceiverManager.getInstance().getSenders().length),
                  Np(e));
              }
              function Np(e) {
                var t;
                D(function (r) {
                  return 1 == r.g
                    ? b(r, Promise.resolve(), 2)
                    : e.g
                      ? ((t = new Pn("caststatuschanged")), e.dispatchEvent(t), Bp(e) || Vp(e), void S(r))
                      : r.return();
                });
              }
              function Fp(e, t, r) {
                e.g && (Up(e), Gp(e, { type: "event", targetName: t, event: r }, e.l));
              }
              function Up(e) {
                e.F.ka(Hp);
                for (var t = { video: {}, player: {} }, r = g(tp), i = r.next(); !i.done; i = r.next())
                  ((i = i.value), (t.video[i] = e.h[i]));
                (e.g.W() &&
                  sp.forEach(function (r, i) {
                    e.m % r == 0 && (t.player[i] = e.g[i]());
                  }),
                  np.forEach(function (r, i) {
                    e.m % r == 0 && (t.player[i] = e.g[i]());
                  }),
                  (r = cast.receiver.CastReceiverManager.getInstance().getSystemVolume()) &&
                    ((t.video.volume = r.level), (t.video.muted = r.muted)),
                  Gp(e, { type: "update", update: t }, e.l),
                  ap.forEach(function (t, r) {
                    e.m % t == 0 &&
                      (((t = { player: {} }).player[r] = e.g[r]()),
                      Gp(e, { type: "update", update: t }, e.l));
                  }),
                  e.C && (e.m += 1),
                  Bp(e));
              }
              function Bp(e) {
                return !(!e.B || (!e.h.duration && !e.g.W()) || ($p(e), (e.B = !1), 0));
              }
              function $p(e, t) {
                var r = { contentId: e.g.rd(), streamType: e.g.W() ? "LIVE" : "BUFFERED", contentType: "" };
                (e.g.W() || (r.duration = e.h.duration),
                  e.i && (r.metadata = e.i),
                  Vp(e, void 0 === t ? 0 : t, r));
              }
              function jp(e, t, r, i, n) {
                e.g && Gp(e, { type: "asyncComplete", id: r, error: i, res: n }, e.l, t);
              }
              function Gp(e, t, r, i) {
                e.H && ((e = Jf(t)), i ? r.getCastChannel(i).send(e) : r.broadcast(e));
              }
              function Vp(e, t, r) {
                r = void 0 === r ? null : r;
                var i = {
                  mediaSessionId: 0,
                  playbackRate: e.h.playbackRate,
                  playerState: e.o ? Wp : e.g.Rg() ? qp : e.h.paused ? Xp : zp,
                  currentTime: e.h.currentTime,
                  supportedMediaCommands: 63,
                  volume: { level: e.h.volume, muted: e.h.muted },
                };
                (r && (i.media = r),
                  Gp(e, { requestId: void 0 === t ? 0 : t, type: "MEDIA_STATUS", status: [i] }, e.u));
              }
              (f(wp, Fn),
                ((n = wp.prototype).destroy = function (e) {
                  return (
                    this.g && void 0 !== e && e && this.g.qd(),
                    this.l && (this.l.release(), (this.l = null)),
                    (e = []),
                    this.h && (e.push(this.h.destroy()), (this.h = null)),
                    this.g && (e.push(this.g.destroy()), (this.g = null)),
                    (this.u = this.j = this.i = null),
                    Fn.prototype.release.call(this),
                    Promise.all(e)
                  );
                }),
                (n.gk = function () {
                  return this.j;
                }),
                (n.td = function () {
                  return this.u;
                }),
                (n.sj = function () {
                  return !!this.g && this.g.m && Tp;
                }),
                (n.wb = function () {
                  return !!this.g && this.g.wb();
                }),
                (n.eh = function () {
                  return this.g ? this.g.eh() : "";
                }),
                (n.cast = function () {
                  var e = this;
                  return D(function (t) {
                    return 1 == t.g
                      ? e.g
                        ? b(t, e.g.cast(), 2)
                        : t.return()
                      : e.h
                        ? b(t, e.h.Cc(), 0)
                        : t.return();
                  });
                }),
                (n.qh = function (e) {
                  this.g && this.g.qh(e);
                }),
                (n.il = function () {
                  var e;
                  this.g &&
                    (e = this.g).i &&
                    chrome.cast.requestSession(
                      function (t) {
                        return cp(e, t);
                      },
                      function (t) {
                        return fp(e, t);
                      },
                    );
                }),
                (n.qd = function () {
                  this.g && this.g.qd();
                }),
                (n.tj = function (e, t) {
                  t = void 0 !== t && t;
                  var r = this;
                  return D(function (i) {
                    if (1 == i.g)
                      return e == r.I && t == r.H
                        ? i.return()
                        : ((r.I = e), (r.H = t), r.g ? (r.g.qd(), b(i, r.g.destroy(), 2)) : i.return());
                    ((r.g = null),
                      (r.g = new hp(
                        e,
                        function () {
                          return kp(r);
                        },
                        function () {
                          return Rp(r);
                        },
                        function (e, t) {
                          return Dp(r, e, t);
                        },
                        function () {
                          return Cp(r);
                        },
                        function () {
                          return Ip(r);
                        },
                        t,
                      )),
                      r.g.init(),
                      S(i));
                  });
                }),
                j("shaka.cast.CastProxy", wp),
                (wp.prototype.changeReceiverId = wp.prototype.tj),
                (wp.prototype.forceDisconnect = wp.prototype.qd),
                (wp.prototype.suggestDisconnect = wp.prototype.il),
                (wp.prototype.setAppData = wp.prototype.qh),
                (wp.prototype.cast = wp.prototype.cast),
                (wp.prototype.receiverName = wp.prototype.eh),
                (wp.prototype.isCasting = wp.prototype.wb),
                (wp.prototype.canCast = wp.prototype.sj),
                (wp.prototype.getPlayer = wp.prototype.td),
                (wp.prototype.getVideo = wp.prototype.gk),
                (wp.prototype.destroy = wp.prototype.destroy),
                f(Pp, Fn),
                ((n = Pp.prototype).isConnected = function () {
                  return this.H;
                }),
                (n.pk = function () {
                  return this.o;
                }),
                (n.al = function (e) {
                  this.i = e;
                }),
                (n.xj = function () {
                  this.i = null;
                }),
                (n.cl = function (e) {
                  (this.i || (this.i = { metadataType: cast.receiver.media.MetadataType.GENERIC }),
                    (this.i.title = e));
                }),
                (n.$k = function (e) {
                  (this.i || (this.i = { metadataType: cast.receiver.media.MetadataType.GENERIC }),
                    (this.i.images = [{ url: e }]));
                }),
                (n.Zk = function (e) {
                  (this.i || (this.i = {}),
                    (this.i.artist = e),
                    (this.i.metadataType = cast.receiver.media.MetadataType.MUSIC_TRACK));
                }),
                (n.destroy = function () {
                  var e,
                    t = this;
                  return D(function (r) {
                    if (1 == r.g)
                      return (
                        t.j && (t.j.release(), (t.j = null)),
                        (e = []),
                        t.g && (e.push(t.g.destroy()), (t.g = null)),
                        t.F && (t.F.stop(), (t.F = null)),
                        (t.h = null),
                        (t.I = null),
                        (t.G = null),
                        (t.H = !1),
                        (t.o = !0),
                        (t.l = null),
                        (t.u = null),
                        Fn.prototype.release.call(t),
                        b(r, Promise.all(e), 2)
                      );
                    (cast.receiver.CastReceiverManager.getInstance().stop(), S(r));
                  });
                }),
                j("shaka.cast.CastReceiver", Pp),
                (Pp.prototype.destroy = Pp.prototype.destroy),
                (Pp.prototype.setContentArtist = Pp.prototype.Zk),
                (Pp.prototype.setContentImage = Pp.prototype.$k),
                (Pp.prototype.setContentTitle = Pp.prototype.cl),
                (Pp.prototype.clearContentMetadata = Pp.prototype.xj),
                (Pp.prototype.setContentMetadata = Pp.prototype.al),
                (Pp.prototype.isIdle = Pp.prototype.pk),
                (Pp.prototype.isConnected = Pp.prototype.isConnected));
              var Hp = 0.5,
                Kp = 5,
                Wp = "IDLE",
                zp = "PLAYING",
                qp = "BUFFERING",
                Xp = "PAUSED";
              function Yp(e, t, r, i, n) {
                if (i >= n) return null;
                for (var a = -1, s = -1, o = 0; o < r.length; o++)
                  if (
                    r[o].some(function (e) {
                      return null != e && "" != e.g.trim();
                    })
                  ) {
                    a = o;
                    break;
                  }
                for (o = r.length - 1; o >= 0; o--)
                  if (
                    r[o].some(function (e) {
                      return null != e && "" != e.g.trim();
                    })
                  ) {
                    s = o;
                    break;
                  }
                if (-1 === a || -1 === s) return null;
                for (var l = (o = !1), u = "white", d = "black", h = Qp(i, n, o, l, u, d); a <= s; a++) {
                  for (var c = r[a], f = -1, p = -1, g = 0; g < c.length; g++)
                    if (null != c[g] && "" !== c[g].g.trim()) {
                      f = g;
                      break;
                    }
                  for (g = c.length - 1; g >= 0; g--)
                    if (null != c[g] && "" !== c[g].g.trim()) {
                      p = g;
                      break;
                    }
                  if (-1 === f || -1 === p) ((c = Jp(i, n)), e.nestedCues.push(c));
                  else {
                    for (; f <= p; f++)
                      if ((g = c[f])) {
                        var m = g.l,
                          v = g.i,
                          y = g.j,
                          T = g.h;
                        ((m == o && v == l && y == u && T == d) ||
                          (h.payload && e.nestedCues.push(h),
                          (h = Qp(i, n, m, v, y, T)),
                          (o = m),
                          (l = v),
                          (u = y),
                          (d = T)),
                          (h.payload += g.g));
                      } else h.payload += " ";
                    (h.payload && e.nestedCues.push(h),
                      a !== s && ((h = Jp(i, n)), e.nestedCues.push(h)),
                      (h = Qp(i, n, o, l, u, d)));
                  }
                }
                return e.nestedCues.length ? { cue: e, stream: t } : null;
              }
              function Qp(e, t, r, i, n, a) {
                return (
                  (e = new kr(e, t, "")),
                  r && e.textDecoration.push(Qr),
                  i && (e.fontStyle = Xr),
                  (e.color = n),
                  (e.backgroundColor = a),
                  e
                );
              }
              function Jp(e, t) {
                return (((e = new kr(e, t, "")).lineBreak = !0), e);
              }
              function Zp(e, t, r, i, n) {
                ((this.g = e), (this.l = t), (this.i = r), (this.h = i), (this.j = n));
              }
              function eg(e, t) {
                ((this.i = []),
                  (this.g = 1),
                  (this.h = 0),
                  (this.F = e),
                  (this.C = t),
                  (this.j = this.m = !1),
                  (this.l = "white"),
                  (this.o = "black"),
                  (this.u = this.B = null),
                  rg(this));
              }
              function tg(e, t, r) {
                var i = "CC" + (1 + ((e.F << 1) | e.C)),
                  n = new kr(t, r, "");
                n.lineInterpretation = 1;
                var a = dg.get(e.g);
                return (
                  a && (n.line = a),
                  null != e.u && null != e.B && (n.position = 10 + Math.min(70, 10 * e.u) + 2.5 * e.B),
                  (t = Yp(n, i, e.i, t, r)) &&
                    e.g + t.cue.nestedCues.length - 3 > 15 &&
                    (a = dg.get(e.g + 3 - t.cue.nestedCues.length)) &&
                    (n.line = a),
                  t
                );
              }
              function rg(e) {
                (ag(e, 0, 15), (e.g = 1));
              }
              function ig(e, t, r) {
                if (!(r < 32 || r > 127)) {
                  var i = "";
                  switch (t) {
                    case 0:
                      i = sg.has(r) ? sg.get(r) : String.fromCharCode(r);
                      break;
                    case 1:
                      i = og.get(r);
                      break;
                    case 2:
                      (e.i[e.g].pop(), (i = lg.get(r)));
                      break;
                    case 3:
                      (e.i[e.g].pop(), (i = ug.get(r)));
                  }
                  i && e.i[e.g].push(new Zp(i, e.m, e.j, e.o, e.l));
                }
              }
              function ng(e, t, r, i) {
                if (!(r < 0 || t < 0))
                  if (t >= r)
                    for (--i; i >= 0; i--)
                      e.i[t + i] = e.i[r + i].map(function (e) {
                        return e;
                      });
                  else
                    for (var n = 0; n < i; n++)
                      e.i[t + n] = e.i[r + n].map(function (e) {
                        return e;
                      });
              }
              function ag(e, t, r) {
                for (var i = 0; i <= r; i++) e.i[t + i] = [];
              }
              var sg = new Map([
                  [39, ""],
                  [42, ""],
                  [92, ""],
                  [92, ""],
                  [94, ""],
                  [95, ""],
                  [96, ""],
                  [123, ""],
                  [124, ""],
                  [125, ""],
                  [126, ""],
                  [127, ""],
                ]),
                og = new Map([
                  [48, ""],
                  [49, ""],
                  [50, ""],
                  [51, ""],
                  [52, ""],
                  [53, ""],
                  [54, ""],
                  [55, ""],
                  [56, ""],
                  [57, " "],
                  [58, ""],
                  [59, ""],
                  [60, ""],
                  [61, ""],
                  [62, ""],
                  [63, ""],
                ]),
                lg = new Map([
                  [32, ""],
                  [33, ""],
                  [34, ""],
                  [35, ""],
                  [36, ""],
                  [37, ""],
                  [38, ""],
                  [39, ""],
                  [40, "*"],
                  [41, "'"],
                  [42, ""],
                  [43, ""],
                  [44, ""],
                  [45, ""],
                  [46, ""],
                  [47, ""],
                  [48, ""],
                  [49, ""],
                  [50, ""],
                  [51, ""],
                  [52, ""],
                  [53, ""],
                  [54, ""],
                  [55, ""],
                  [56, ""],
                  [57, ""],
                  [58, ""],
                  [59, ""],
                  [60, ""],
                  [61, ""],
                  [62, ""],
                  [63, ""],
                ]),
                ug = new Map([
                  [32, ""],
                  [33, ""],
                  [34, ""],
                  [35, ""],
                  [36, ""],
                  [37, ""],
                  [38, ""],
                  [39, ""],
                  [40, ""],
                  [41, "{"],
                  [42, "}"],
                  [43, "\\"],
                  [44, "^"],
                  [45, "_"],
                  [46, "|"],
                  [47, "~"],
                  [48, ""],
                  [49, ""],
                  [50, ""],
                  [51, ""],
                  [52, ""],
                  [53, ""],
                  [54, ""],
                  [55, ""],
                  [56, ""],
                  [57, ""],
                  [58, ""],
                  [59, ""],
                  [60, ""],
                  [61, ""],
                  [62, ""],
                  [63, ""],
                ]),
                dg = new Map([
                  [1, 10],
                  [2, 15.33],
                  [3, 20.66],
                  [4, 26],
                  [5, 31.33],
                  [6, 36.66],
                  [7, 42],
                  [8, 47.33],
                  [9, 52.66],
                  [10, 58],
                  [11, 63.33],
                  [12, 68.66],
                  [13, 74],
                  [14, 79.33],
                  [15, 84.66],
                ]);
              function hg(e, t) {
                ((this.h = 0),
                  (this.o = new eg(e, t)),
                  (this.i = new eg(e, t)),
                  (this.g = this.j = new eg(e, t)),
                  (this.l = 0),
                  (this.m = null));
              }
              function cg(e, t, r) {
                e.g = e.i;
                var i = e.g,
                  n = null;
                return (
                  3 !== e.h &&
                    4 !== e.h &&
                    ((n = tg(i, e.l, r)),
                    ((r = e.i).g = r.h > 0 ? r.h : 0),
                    ag(r, 0, 15),
                    ((r = e.j).g = r.h > 0 ? r.h : 0),
                    ag(r, 0, 15),
                    (i.g = 15)),
                  (e.h = 3),
                  (i.h = t),
                  n
                );
              }
              function fg(e) {
                ((e.h = 1), (e.g = e.j), (e.g.h = 0));
              }
              function pg(e) {
                (q("Cea608DataChannel", "CEA-608 text mode entered, but is unsupported"),
                  (e.g = e.o),
                  (e.h = 4));
              }
              var gg = "black green blue cyan red yellow magenta black".split(" "),
                mg = "white green blue cyan red yellow magenta white_italics".split(" ");
              function vg(e, t) {
                ((this.J = t),
                  (this.N = e),
                  (this.K = this.l = !1),
                  (this.m = this.o = this.H = this.M = this.I = 0),
                  (this.G = 2),
                  (this.i = []),
                  (this.g = this.h = this.j = 0),
                  (this.F = this.B = !1),
                  (this.C = "white"),
                  (this.u = "black"),
                  yg(this));
              }
              function yg(e) {
                e.i = [];
                for (var t = 0; t < 16; t++) e.i.push(Tg());
              }
              function Tg() {
                for (var e = [], t = 0; t < 42; t++) e.push(null);
                return e;
              }
              function bg(e, t) {
                Sg(e) && ((e.i[e.h][e.g] = new Zp(t, e.F, e.B, e.u, e.C)), e.g++);
              }
              function Sg(e) {
                var t = e.g < e.m && e.g >= 0;
                return e.h < e.o && e.h >= 0 && t;
              }
              function Eg(e, t, r) {
                var i = new kr(e.j, t, "");
                i.textAlign = 0 === e.G ? "left" : 1 === e.G ? "right" : Or;
                var n = i.region;
                switch (
                  (e.J && (n.id += "svc" + e.J),
                  (n.id += "win" + e.N),
                  (n.height = e.o),
                  (n.width = e.m),
                  (n.heightUnits = 2),
                  (n.widthUnits = 2),
                  (n.viewportAnchorX = e.I),
                  (n.viewportAnchorY = e.M),
                  (n.viewportAnchorUnits = e.K ? Nt : 2),
                  e.H)
                ) {
                  case 0:
                    ((n.regionAnchorX = 0), (n.regionAnchorY = 0));
                    break;
                  case 1:
                    ((n.regionAnchorX = 50), (n.regionAnchorY = 0));
                    break;
                  case 2:
                    ((n.regionAnchorX = 100), (n.regionAnchorY = 0));
                    break;
                  case 3:
                    ((n.regionAnchorX = 0), (n.regionAnchorY = 50));
                    break;
                  case 4:
                    ((n.regionAnchorX = 50), (n.regionAnchorY = 50));
                    break;
                  case 5:
                    ((n.regionAnchorX = 100), (n.regionAnchorY = 50));
                    break;
                  case 6:
                    ((n.regionAnchorX = 0), (n.regionAnchorY = 100));
                    break;
                  case 7:
                    ((n.regionAnchorX = 50), (n.regionAnchorY = 100));
                    break;
                  case 8:
                    ((n.regionAnchorX = 100), (n.regionAnchorY = 100));
                }
                return ((r = Yp(i, "svc" + r, e.i, e.j, t)) && (e.j = t), r);
              }
              function xg() {
                ((this.i = []), (this.h = null), (this.g = 0));
              }
              function wg(e, t) {
                3 === t.type
                  ? ((e.g = 2 * (63 & t.value) - 1), (e.h = []))
                  : e.h &&
                    (e.g > 0 && (e.h.push(t), e.g--),
                    0 === e.g && (e.i.push(new Ag(e.h)), (e.h = null), (e.g = 0)));
              }
              function Ag(e) {
                ((this.g = 0), (this.h = e));
              }
              function Ig(e) {
                if (!e.Ia()) throw new ze(2, 2, 3e3);
                return e.h[e.g++];
              }
              function kg(e) {
                ((this.i = e), (this.h = [null, null, null, null, null, null, null, null]), (this.g = null));
              }
              function Rg(e, t, r, i) {
                if (!e.g) return [];
                if (24 == r)
                  return (
                    (r = Ig(t).value),
                    (i = Ig(t).value),
                    (r = [r, i]
                      .map(function (e) {
                        return ("0" + (255 & e).toString(16)).slice(-2);
                      })
                      .join("")),
                    bg(e.g, String.fromCharCode(parseInt(r, 16))),
                    []
                  );
                t = e.g;
                var n = null;
                switch (r) {
                  case 8:
                    !Sg(t) ||
                      (t.g <= 0 && t.h <= 0) ||
                      (t.g <= 0 ? ((t.g = t.m - 1), t.h--) : t.g--, (t.i[t.h][t.g] = null));
                    break;
                  case 13:
                    (t.isVisible() && (n = Eg(t, i, e.i)),
                      t.h + 1 >= t.o
                        ? (function (e) {
                            for (var t = 0, r = 1; r < 16; r++, t++) e.i[t] = e.i[r];
                            for (r = 0; r < 1; r++, t++) e.i[t] = Tg();
                          })(t)
                        : t.h++,
                      (t.g = 0));
                    break;
                  case 14:
                    (t.isVisible() && (n = Eg(t, i, e.i)), (t.i[t.h] = Tg()), (t.g = 0));
                    break;
                  case 12:
                    (t.isVisible() && (n = Eg(t, i, e.i)), yg(t), (t.h = 0), (t.g = 0));
                }
                return n ? [n] : [];
              }
              function Cg(e, t, r, i) {
                if (r >= 128 && r <= 135) ((i = 7 & r), e.h[i] && (e.g = e.h[i]));
                else {
                  if (136 === r) {
                    ((r = Ig(t).value), (t = []));
                    for (var n = (r = g(Lg(e, r))).next(); !n.done; n = r.next()) {
                      if ((n = e.h[n.value]).isVisible()) {
                        var a = Eg(n, i, e.i);
                        a && t.push(a);
                      }
                      yg(n);
                    }
                    return t;
                  }
                  if (137 === r)
                    for (r = (t = g(Lg(e, (t = Ig(t).value)))).next(); !r.done; r = t.next())
                      ((r = e.h[r.value]).isVisible() || (r.j = i), r.display());
                  else {
                    if (138 === r) {
                      for (r = Ig(t).value, t = null, n = (r = g(Lg(e, r))).next(); !n.done; n = r.next())
                        ((n = e.h[n.value]).isVisible() && (t = Eg(n, i, e.i)), (n.l = !1));
                      return t ? [t] : [];
                    }
                    if (139 === r) {
                      for (r = Ig(t).value, t = null, n = (r = g(Lg(e, r))).next(); !n.done; n = r.next())
                        ((n = e.h[n.value]).isVisible() ? (t = Eg(n, i, e.i)) : (n.j = i), (n.l = !n.l));
                      return t ? [t] : [];
                    }
                    if (140 === r) return Mg(e, (t = Ig(t).value), i);
                    if (143 === r) return ((i = Mg(e, 255, i)), Dg(e), i);
                    if (144 === r)
                      (t.skip(1),
                        (i = Ig(t).value),
                        e.g && ((e.g.B = (128 & i) > 0), (e.g.F = (64 & i) > 0)));
                    else if (145 === r)
                      ((i = Ig(t).value),
                        (r = Ig(t).value),
                        t.skip(1),
                        e.g &&
                          ((t = _g((48 & r) >> 4, (12 & r) >> 2, 3 & r)),
                          (e.g.C = _g((48 & i) >> 4, (12 & i) >> 2, 3 & i)),
                          (e.g.u = t)));
                    else if (146 === r)
                      ((i = Ig(t).value), (t = Ig(t).value), e.g && (((e = e.g).h = 15 & i), (e.g = 63 & t)));
                    else if (151 === r)
                      (t.skip(1), t.skip(1), (i = Ig(t).value), t.skip(1), e.g && (e.g.G = 3 & i));
                    else if (r >= 152 && r <= 159) {
                      ((r = (15 & r) - 8),
                        (n = null !== e.h[r]) || (((a = new vg(r, e.i)).j = i), (e.h[r] = a)),
                        (i = Ig(t).value),
                        (a = Ig(t).value));
                      var s = Ig(t).value,
                        o = Ig(t).value,
                        l = Ig(t).value;
                      ((t = Ig(t).value),
                        (n && !(7 & t)) ||
                          (((t = e.h[r]).h = 0),
                          (t.g = 0),
                          (t.F = !1),
                          (t.B = !1),
                          (t.C = "white"),
                          (t.u = "black")),
                        ((t = e.h[r]).l = (32 & i) > 0),
                        (t.M = 127 & a),
                        (t.I = s),
                        (t.H = (240 & o) >> 4),
                        (t.K = (128 & a) > 0),
                        (t.o = 1 + (15 & o)),
                        (t.m = 1 + (63 & l)),
                        (e.g = e.h[r]));
                    }
                  }
                }
                return [];
              }
              function Lg(e, t) {
                for (var r = [], i = 0; i < 8; i++) (!(1 & ~t) && e.h[i] && r.push(i), (t >>= 1));
                return r;
              }
              function Mg(e, t, r) {
                for (var i = [], n = (t = g(Lg(e, t))).next(); !n.done; n = t.next()) {
                  n = n.value;
                  var a = e.h[n];
                  (a.isVisible() && (a = Eg(a, r, e.i)) && i.push(a), (e.h[n] = null));
                }
                return i;
              }
              function Dg(e) {
                ((e.g = null), (e.h = [null, null, null, null, null, null, null, null]));
              }
              function _g(e, t, r) {
                var i = { 0: 0, 1: 0, 2: 1, 3: 1 };
                return Og[((e = i[e]) << 2) | ((t = i[t]) << 1) | (r = i[r])];
              }
              ((vg.prototype.isVisible = function () {
                return this.l;
              }),
                (vg.prototype.display = function () {
                  this.l = !0;
                }),
                (Ag.prototype.Ia = function () {
                  return this.g < this.h.length;
                }),
                (Ag.prototype.Pa = function () {
                  return this.g;
                }),
                (Ag.prototype.skip = function (e) {
                  if (this.g + e > this.h.length) throw new ze(2, 2, 3e3);
                  this.g += e;
                }),
                (Ag.prototype.Qi = function (e) {
                  if (this.g - e < 0) throw new ze(2, 2, 3e3);
                  this.g -= e;
                }));
              var Pg = new Map([
                  [32, " "],
                  [33, ""],
                  [37, ""],
                  [42, ""],
                  [44, ""],
                  [48, ""],
                  [49, ""],
                  [50, ""],
                  [51, ""],
                  [52, ""],
                  [53, ""],
                  [57, ""],
                  [58, ""],
                  [60, ""],
                  [61, ""],
                  [63, ""],
                  [118, ""],
                  [119, ""],
                  [120, ""],
                  [121, ""],
                  [122, ""],
                  [123, ""],
                  [124, ""],
                  [125, ""],
                  [126, ""],
                  [127, ""],
                ]),
                Og = "black blue green cyan red magenta yellow white".split(" ");
              function Ng() {
                ((this.h = []),
                  (this.g = []),
                  (this.i = new xg()),
                  (this.l = 0),
                  (this.m = new Map([
                    ["CC1", new hg(0, 0)],
                    ["CC2", new hg(0, 1)],
                    ["CC3", new hg(1, 0)],
                    ["CC4", new hg(1, 1)],
                  ])),
                  (this.u = this.o = 0),
                  (this.j = new Map()),
                  (this.C = !0),
                  (this.B = new Set()),
                  Fg(this));
              }
              function Fg(e) {
                ((e.o = 0), (e.u = 0));
                for (var t = g(e.m.values()), r = t.next(); !r.done; r = t.next())
                  (((r = r.value).h = 0), (r.g = r.j), (r.m = null), rg(r.i), rg(r.j), rg(r.o));
                e.C = !0;
              }
              function Ug(e, t) {
                var r = t.type;
                if (16 == (112 & t.Cb)) {
                  var i = (t.Cb >> 3) & 1;
                  0 === r ? (e.o = i) : (e.u = i);
                }
                if (
                  ((i = "CC" + (1 + ((r << 1) | (r ? e.u : e.o)))),
                  (r = e.m.get(i)),
                  (255 === t.Cb && 255 === t.kc) || (!t.Cb && !t.kc) || !$g(t.Cb) || !$g(t.kc))
                )
                  return (++e.l >= 45 && Fg(e), null);
                ((e.l = 0), (t.Cb &= 127), (t.kc &= 127));
                var n = t.Cb;
                if ((n >= 1 && n <= 15) || (!t.Cb && !t.kc)) return null;
                if (((n = null), 16 == (112 & t.Cb)))
                  e: {
                    if ((e.B.add(i), (i = t.Cb), (e = t.kc), r.m === ((i << 8) | e))) r.m = null;
                    else if (((r.m = (i << 8) | e), 16 == (240 & i) && 64 == (192 & e))) {
                      ((t = [11, 11, 1, 2, 3, 4, 12, 13, 14, 15, 5, 6, 7, 8, 9, 10][
                        ((7 & i) << 1) | ((e >> 5) & 1)
                      ]),
                        (i = "white"),
                        (n = !1));
                      var a = null,
                        s = e > 95 ? e - 96 : e - 64;
                      (s <= 13
                        ? (i = mg[Math.floor(s / 2)])
                        : s <= 15
                          ? (n = !0)
                          : (a = Math.floor((s - 16) / 2)),
                        (e = !(1 & ~e)),
                        4 !== r.h &&
                          ((s = r.g),
                          3 === r.h &&
                            t !== s.g &&
                            (ng(s, (r = 1 + t - s.h), 1 + s.g - s.h, s.h),
                            ag(s, 0, r - 1),
                            ag(s, t + 1, 15 - t)),
                          (s.g = t),
                          (s.m = e),
                          (s.j = n),
                          (s.l = i),
                          (s.u = a),
                          (s.o = "black")));
                    } else if (17 == (247 & i) && 32 == (240 & e))
                      ((r.g.m = !1),
                        (r.g.j = !1),
                        (r.g.l = "white"),
                        ig(r.g, 0, 32),
                        (i = !1),
                        "white_italics" === (t = mg[(14 & e) >> 1]) && ((t = "white"), (i = !0)),
                        (r.g.m = !(1 & ~e)),
                        (r.g.j = i),
                        (r.g.l = t));
                    else if ((16 == (247 & i) && 32 == (240 & e)) || (23 == (247 & i) && 45 == (255 & e)))
                      ((t = "black"), !(7 & i) && (t = gg[(14 & e) >> 1]), (r.g.o = t));
                    else if (17 == (247 & i) && 48 == (240 & e)) ig(r.g, 1, e);
                    else if (18 == (246 & i) && 32 == (224 & e)) ig(r.g, 1 & i ? 3 : 2, e);
                    else {
                      if (20 == (246 & i) && 32 == (240 & e)) {
                        switch (((e = t.pts), (i = null), t.kc)) {
                          case 32:
                            fg(r);
                            break;
                          case 33:
                            (r = r.g).i[r.g].pop();
                            break;
                          case 37:
                            i = cg(r, 2, e);
                            break;
                          case 38:
                            i = cg(r, 3, e);
                            break;
                          case 39:
                            i = cg(r, 4, e);
                            break;
                          case 40:
                            ig(r.g, 0, 32);
                            break;
                          case 41:
                            ((r.h = 2), (r.g = r.i), (r.g.h = 0), (r.l = e));
                            break;
                          case 42:
                            (rg(r.o), pg(r));
                            break;
                          case 43:
                            pg(r);
                            break;
                          case 44:
                            ((t = r.i), (i = null), 4 !== r.h && (i = tg(t, r.l, e)), ag(t, 0, 15));
                            break;
                          case 45:
                            ((t = r.g),
                              3 !== r.h
                                ? (i = null)
                                : ((i = tg(t, r.l, e)),
                                  ng(t, (n = t.g - t.h + 1) - 1, n, t.h),
                                  ag(t, 0, n - 1),
                                  ag(t, t.g, 15 - t.g),
                                  (r.l = e)));
                            break;
                          case 46:
                            ag(r.j, 0, 15);
                            break;
                          case 47:
                            ((t = null),
                              4 !== r.h && (t = tg(r.i, r.l, e)),
                              (i = r.j),
                              (r.j = r.i),
                              (r.i = i),
                              fg(r),
                              (r.l = e),
                              (i = t));
                        }
                        n = i;
                        break e;
                      }
                      (23 == i || 31 == i) && e >= 33 && e <= 35 && (r.g.B = e - 32);
                    }
                    n = null;
                  }
                else ((e = t.kc), ig(r.g, 0, t.Cb), ig(r.g, 0, e));
                return n;
              }
              function Bg(e, t) {
                var r = [];
                try {
                  for (; t.Ia(); ) {
                    var i = Ig(t).value,
                      n = (224 & i) >> 5,
                      a = 31 & i;
                    if ((7 === n && 0 != a && (n = 63 & Ig(t).value), 0 != n)) {
                      (e.B.add("svc" + n), e.j.has(n) || e.j.set(n, new kg(n)));
                      for (var s = e.j.get(n), o = t.Pa(); t.Pa() - o < a; ) {
                        n = s;
                        var l = t,
                          u = Ig(l),
                          d = u.value,
                          h = u.pts;
                        if ((16 === d && (d = (d << 16) | Ig(l).value), d >= 0 && d <= 31))
                          var c = Rg(n, l, d, h);
                        else if (d >= 128 && d <= 159) c = Cg(n, l, d, h);
                        else {
                          if (d >= 4096 && d <= 4127)
                            ((n = l),
                              (l = 255 & d) >= 8 && l <= 15
                                ? n.skip(1)
                                : l >= 16 && l <= 23
                                  ? n.skip(2)
                                  : l >= 24 && l <= 31 && n.skip(3));
                          else if (d >= 4224 && d <= 4255)
                            ((n = l),
                              (l = 255 & d) >= 128 && l <= 135
                                ? n.skip(4)
                                : l >= 136 && l <= 143 && n.skip(5));
                          else if (d >= 32 && d <= 127)
                            ((l = d), n.g && bg(n.g, 127 === l ? "" : String.fromCharCode(l)));
                          else if (d >= 160 && d <= 255) n.g && bg(n.g, String.fromCharCode(d));
                          else if (d >= 4128 && d <= 4223) {
                            if (((l = 255 & d), n.g))
                              if (Pg.has(l)) {
                                var f = Pg.get(l);
                                bg(n.g, f);
                              } else bg(n.g, "_");
                          } else d >= 4256 && d <= 4351 && n.g && bg(n.g, 160 != (255 & d) ? "_" : "[CC]");
                          c = [];
                        }
                        r.push.apply(r, m(c));
                      }
                    }
                  }
                } catch (p) {
                  if (!(p instanceof ze && 3e3 === p.code)) throw p;
                  q("CEA708_INVALID_DATA", "Buffer read out of bounds / invalid CEA-708 Data.");
                }
                return r;
              }
              function $g(e) {
                for (var t = 0; e; ) ((t ^= 1 & e), (e >>= 1));
                return 1 === t;
              }
              function jg(e) {
                for (var t = [], r = e, i = (e = 0); i < r.length; )
                  (2 == e && 3 == r[i]
                    ? ((e = 0), (r = [].concat(m(r))).splice(i, 1), (r = new Uint8Array(r)))
                    : 0 == r[i]
                      ? e++
                      : (e = 0),
                    i++);
                for (e = r, i = 0; i < e.length; ) {
                  for (r = 0; 255 == e[i]; ) ((r += 255), i++);
                  r += e[i++];
                  for (var n = 0; 255 == e[i]; ) ((n += 255), i++);
                  ((n += e[i++]), 4 == r && t.push(e.subarray(i, i + n)), (i += n));
                }
                return t;
              }
              function Gg() {
                ((this.j = new Map()), (this.i = this.h = 0), (this.g = Hg));
              }
              function Vg(e, t, r, i, n, a, s, o, l) {
                var u = 0,
                  d = a,
                  h = o.map(function (e) {
                    return e.mh;
                  });
                for (
                  (h = [].concat.apply([], m(h))).length && (d = h[0].sampleSize || a), t.skip(s + o[0].qg);
                  t.Ia();
                ) {
                  s = t.U();
                  var c = t.Y(),
                    f = null;
                  switch (((f = !1), (o = 1), e.g)) {
                    case Kg:
                      f = 6 == (f = 31 & c);
                      break;
                    case Wg:
                      ((o = 2), t.skip(1), (f = 39 == (f = (c >> 1) & 63) || 40 == f));
                      break;
                    case zg:
                      ((o = 2), t.skip(1), (f = 23 == (f = (c >> 1) & 63) || 24 == f));
                      break;
                    default:
                      return;
                  }
                  if (f)
                    for (
                      c = 0,
                        u < h.length && (c = h[u].Gf || 0),
                        c = (r + c) / i,
                        f = (o = g(jg((o = t.Tb(s - o, !1))))).next();
                      !f.done;
                      f = o.next()
                    )
                      l.push({ packet: f.value, pts: c });
                  else
                    try {
                      t.skip(s - o);
                    } catch (p) {
                      break;
                    }
                  0 == (d -= s + 4) &&
                    ((r = u < h.length ? r + (h[u].nh || n) : r + n),
                    (d = (++u < h.length && h[u].sampleSize) || a));
                }
              }
              ((Ng.prototype.clear = function () {
                ((this.l = 0), (this.h = []), (this.g = []));
                var e = this.i;
                ((e.i = []), (e.h = []), (e.g = 0), Fg(this));
                for (var t = (e = g(this.j.values())).next(); !t.done; t = e.next()) Dg(t.value);
              }),
                (Ng.prototype.extract = function (e, t) {
                  if (this.C) {
                    for (var r = g(this.m.values()), i = r.next(); !i.done; i = r.next()) i.value.l = t;
                    this.C = !1;
                  }
                  if (
                    !((e = new ra(e, 0)).getLength() < 8) &&
                    181 === e.Y() &&
                    49 === e.Ca() &&
                    1195456820 === e.U() &&
                    3 === e.Y() &&
                    64 & (r = e.Y())
                  )
                    for (r &= 31, e.skip(1), i = 0; i < r; i++) {
                      var n = e.Y(),
                        a = (4 & n) >> 2,
                        s = e.Y(),
                        o = e.Y();
                      a &&
                        (0 == (n &= 3) || 1 === n
                          ? this.h.push({ pts: t, type: n, Cb: s, kc: o, order: this.h.length })
                          : (this.g.push({ pts: t, type: n, value: s, order: this.g.length }),
                            this.g.push({ pts: t, type: 2, value: o, order: this.g.length })));
                    }
                }),
                (Ng.prototype.decode = function () {
                  function e(e, t) {
                    return e.pts - t.pts || e.order - t.order;
                  }
                  var t = [];
                  (this.h.sort(e), this.g.sort(e));
                  for (var r = g(this.h), i = r.next(); !i.done; i = r.next())
                    (i = Ug(this, i.value)) && t.push(i);
                  for (i = (r = g(this.g)).next(); !i.done; i = r.next()) wg(this.i, i.value);
                  for (i = (r = g(this.i.i)).next(); !i.done; i = r.next())
                    ((i = Bg(this, i.value)), t.push.apply(t, m(i)));
                  return ((this.i.i = []), (this.h = []), (this.g = []), t);
                }),
                (Ng.prototype.getStreams = function () {
                  return Array.from(this.B);
                }),
                j("shaka.cea.CeaDecoder", Ng),
                (Pt = function () {
                  return new Ng();
                }),
                (Gg.prototype.init = function (e) {
                  function t(e) {
                    ((e = e.name), qg.has(e) && (r.g = qg.get(e)));
                  }
                  var r = this,
                    i = [],
                    n = [];
                  if (
                    (new aa()
                      .box("moov", sa)
                      .box("mvex", sa)
                      .S("trex", function (e) {
                        var t = e.reader;
                        (t.skip(4), t.skip(4), (e = t.U()), (t = t.U()), (r.h = e), (r.i = t));
                      })
                      .box("trak", sa)
                      .S("tkhd", function (e) {
                        var t = e.reader;
                        1 == (e = e.version) ? (t.skip(8), t.skip(8)) : (t.skip(4), t.skip(4));
                        var r = t.U();
                        (1 == e ? t.skip(8) : t.skip(4),
                          t.skip(4),
                          t.skip(8),
                          t.skip(2),
                          t.skip(2),
                          t.skip(2),
                          t.skip(2),
                          t.skip(36),
                          t.Ca(),
                          t.Ca(),
                          t.Ca(),
                          t.Ca(),
                          i.push(r));
                      })
                      .box("mdia", sa)
                      .S("mdhd", function (e) {
                        ((e = is(e.reader, e.version)), n.push(e.timescale));
                      })
                      .box("minf", sa)
                      .box("stbl", sa)
                      .S("stsd", oa)
                      .box("avc1", t)
                      .box("avc3", t)
                      .box("dvav", t)
                      .box("dva1", t)
                      .box("hev1", t)
                      .box("hvc1", t)
                      .box("dvh1", t)
                      .box("dvhe", t)
                      .box("vvc1", t)
                      .box("vvi1", t)
                      .box("dvc1", t)
                      .box("dvi1", t)
                      .box("encv", la)
                      .box("sinf", sa)
                      .box("frma", function (e) {
                        ((e = ss(e.reader).codec), qg.has(e) && (r.g = qg.get(e)));
                      })
                      .parse(e, !0, !0),
                    !i.length || !n.length || i.length != n.length)
                  )
                    throw new ze(2, 2, 2010);
                  (this.g == Hg && z("Unable to determine bitstream format for CEA parsing!"),
                    i.forEach(function (e, t) {
                      r.j.set(e, n[t]);
                    }));
                }),
                (Gg.prototype.parse = function (e) {
                  var t = this;
                  if (this.g == Hg) return [];
                  var r = [],
                    i = 0,
                    n = [];
                  return (
                    new aa()
                      .box("moof", function (e) {
                        ((i = e.start), (n = []), sa(e));
                      })
                      .box("traf", function (e) {
                        (n.push({ baseMediaDecodeTime: null, Wd: t.h, Xd: t.i, Ii: [], timescale: 9e4 }),
                          sa(e));
                      })
                      .S("trun", function (e) {
                        var t = n[n.length - 1];
                        ((e = ns(e.reader, e.version, e.flags)), t.Ii.push(e));
                      })
                      .S("tfhd", function (e) {
                        var r = n[n.length - 1];
                        ((e = ts(e.reader, e.flags)),
                          (r.Wd = e.Wd || t.h),
                          (r.Xd = e.Xd || t.i),
                          (e = e.trackId),
                          t.j.has(e) && (r.timescale = t.j.get(e)));
                      })
                      .S("tfdt", function (e) {
                        var t = n[n.length - 1];
                        ((e = rs(e.reader, e.version)), (t.baseMediaDecodeTime = e.baseMediaDecodeTime));
                      })
                      .box("mdat", function (e) {
                        for (
                          var a = i - e.start - 8, s = e.reader.Pa(), o = g(n), l = o.next();
                          !l.done;
                          l = o.next()
                        )
                          null === (l = l.value).baseMediaDecodeTime
                            ? z("Unable to find base media decode time for CEA captions!")
                            : (e.reader.seek(s),
                              Vg(t, e.reader, l.baseMediaDecodeTime, l.timescale, l.Wd, l.Xd, a, l.Ii, r));
                      })
                      .parse(e, !1, !0),
                    r
                  );
                }),
                j("shaka.cea.Mp4CeaParser", Gg));
              var Hg = 0,
                Kg = 1,
                Wg = 2,
                zg = 3,
                qg = new Map()
                  .set("avc1", Kg)
                  .set("avc3", Kg)
                  .set("dvav", Kg)
                  .set("dva1", Kg)
                  .set("hev1", Wg)
                  .set("hvc1", Wg)
                  .set("dvh1", Wg)
                  .set("dvhe", Wg)
                  .set("vvc1", zg)
                  .set("vvi1", zg)
                  .set("dvc1", zg)
                  .set("dvi1", zg);
              function Xg() {
                this.g = null;
              }
              function Yg(e) {
                return (e = (function (e) {
                  var t = 0,
                    r = Fe(e),
                    i = r.getUint32(t, !0);
                  if (i != e.byteLength) return [];
                  e: {
                    for (e = t + 4 + 2, t = []; e < r.byteLength - 1; ) {
                      ((i = r.getUint16(e, !0)), (e += 2));
                      var n = r.getUint16(e, !0);
                      if (((e += 2), 1 & n || n + e > r.byteLength)) {
                        r = [];
                        break e;
                      }
                      var a = Oe(r, e, n);
                      (t.push({ type: i, value: a }), (e += n));
                    }
                    r = t;
                  }
                  return r;
                })((e = at(tr(e)))).filter(function (e) {
                  return e.type === Jg;
                })[0]) && (e = Yt((e = Ye(e.value, !0)), "WRMHEADER"))
                  ? e
                  : null;
              }
              function Qg(e) {
                try {
                  var t = Yg(e);
                  if (t)
                    e: {
                      for (var r = g(ir(t, "DATA")), i = r.next(); !i.done; i = r.next()) {
                        var n = i.value;
                        if (n.children)
                          for (var a = g(n.children), s = a.next(); !s.done; s = a.next()) {
                            var o = s.value;
                            if ("LA_URL" == o.tagName) {
                              var l = tr(o);
                              break e;
                            }
                          }
                      }
                      l = "";
                    }
                  else l = "";
                  return l;
                } catch (u) {
                  return "";
                }
              }
              (Mt("video/mp4", function () {
                return new Gg();
              }),
                (Xg.prototype.init = function () {}),
                (Xg.prototype.parse = function (e) {
                  this.g ? this.g.clearData() : (this.g = new wo());
                  var t = [];
                  if (!Ro((e = Oe(e)))) return t;
                  var r = (e = this.g.parse(e)).Yd(),
                    i = e.ef();
                  switch (((e = []), r.video)) {
                    case "avc":
                      e.push(6);
                      break;
                    case "hvc":
                      (e.push(39), e.push(40));
                  }
                  if (!e.length) return t;
                  for (i = (r = g(i)).next(); !i.done; i = r.next())
                    if (((i = i.value), e.includes(i.type) && null != i.time))
                      for (var n = g(jg(i.data)), a = n.next(); !a.done; a = n.next())
                        t.push({ packet: a.value, pts: i.time });
                  return t;
                }),
                j("shaka.cea.TsCeaParser", Xg),
                Mt("video/mp2t", function () {
                  return new Xg();
                }));
              var Jg = 1;
              function Zg() {
                this.g = new Map();
              }
              function em(t, r, i, n) {
                var a = (function (e, t) {
                    for (var r = [], i = (t = g(t)).next(); !i.done; i = t.next())
                      (i = rm(e, i.value)) && r.push(i);
                    return r;
                  })(t, r),
                  s = null;
                t = [];
                var o = [];
                r = null;
                var l = new Set(
                  a.map(function (e) {
                    return e.keyId;
                  }),
                );
                l.delete(null);
                var u = "cenc";
                if (l.size > 1) throw new ze(2, 4, 4010);
                if (!i) {
                  if (
                    (o = a.filter(function (e) {
                      return "urn:mpeg:dash:sea:2012" == e.Hd;
                    })).length > 1
                  )
                    throw new ze(2, 4, 4050);
                  (o.length &&
                    (r = (function (t) {
                      if (!e.crypto || !e.crypto.subtle)
                        throw (
                          z(
                            "Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)",
                          ),
                          new ze(2, 4, 4042)
                        );
                      var r = ar(t.node, "urn:mpeg:dash:schema:sea:2012", "SegmentEncryption");
                      if (!r) throw new ze(2, 4, 4051);
                      if ("urn:mpeg:dash:sea:aes128-cbc:2013" != r.attributes.schemeIdUri)
                        throw new ze(2, 4, 4051);
                      if (!(r = ar(t.node, "urn:mpeg:dash:schema:sea:2012", "CryptoPeriod")))
                        throw new ze(2, 4, 4051);
                      if (((t = r.attributes.IV), (r = et(r.attributes.keyUriTemplate)), !t || !r))
                        throw new ze(2, 4, 4051);
                      if (16 != (t = st(t.substr(2))).byteLength) throw new ze(2, 4, 4048);
                      return { wk: r, iv: t };
                    })(o[0])),
                    (o = a.find(function (e) {
                      return "urn:mpeg:dash:mp4protection:2011" == e.Hd;
                    })) &&
                      o.encryptionScheme &&
                      (u = o.encryptionScheme),
                    (o = a.filter(function (e) {
                      return "urn:mpeg:dash:mp4protection:2011" == e.Hd
                        ? ((s = e.init || s), !1)
                        : "urn:mpeg:dash:sea:2012" != e.Hd;
                    })).length &&
                      ((t = (function (e, t, r, i, n) {
                        for (var a = [], s = (r = g(r)).next(); !s.done; s = r.next()) {
                          var o = i[(s = s.value).Hd];
                          if (o) {
                            var l;
                            if ((l = ar(s.node, "urn:microsoft:playready", "pro")) && tr(l)) {
                              l = at((l = tr(l)));
                              var u = new Uint8Array([
                                154, 4, 240, 121, 152, 64, 66, 134, 171, 146, 230, 91, 224, 136, 95, 149,
                              ]);
                              l = [
                                { initData: va(l, u, new Set(), 0), initDataType: "cenc", keyId: s.keyId },
                              ];
                            } else l = null;
                            if (((u = null), "urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e" === s.Hd)) {
                              u = s;
                              var d = n;
                              if (0 == d.size) u = null;
                              else {
                                var h = new Uint8Array([
                                  16, 119, 239, 236, 192, 178, 77, 2, 172, 227, 60, 30, 82, 226, 251, 75,
                                ]);
                                u = [
                                  {
                                    initData: va(new Uint8Array([]), h, d, 1),
                                    initDataType: "cenc",
                                    keyId: u.keyId,
                                  },
                                ];
                              }
                            }
                            ((l = dt(o, t, s.init || e || l || u)),
                              (o = im.get(o)) && (l.licenseServerUri = o(s)),
                              ((s = ar(s.node, "https://dashif.org/CPS", "Certurl")) && (s = tr(s))) ||
                                (s = ""),
                              (l.serverCertificateUri = s),
                              a.push(l));
                          }
                        }
                        return a;
                      })(s, u, o, n, l)),
                      0 == t.length && (t = [dt("", u, s)])));
                }
                if (a.length && !r && (i || !o.length))
                  for (t = [], n = (i = g(Object.values(n))).next(); !n.done; n = i.next())
                    "org.w3.clearkey" != (n = n.value) && ((n = dt(n, u, s)), t.push(n));
                if ((l = Array.from(l)[0] || null))
                  for (i = (u = g(t)).next(); !i.done; i = u.next())
                    for (n = (i = g(i.value.initData)).next(); !n.done; n = i.next()) n.value.keyId = l;
                return { Yh: l, Em: s, drmInfos: t, hg: r, ci: !0 };
              }
              function tm(e) {
                var t = ar(e.node, "https://dashif.org/CPS", "Laurl");
                if (t && (t = tr(t))) return t;
                if ((t = ar(e.node, "urn:microsoft:playready", "pro")) && tr(t)) return Qg(t);
                if ((e = ar(e.node, "urn:mpeg:cenc:2013", "pssh")) && (e = tr(e))) {
                  ((t = at(e)), (e = 8));
                  var r = (t = Fe(t)).getUint8(e);
                  return (
                    (e += 20),
                    r > 0 && (e += 4 + 16 * t.getUint32(e)),
                    Qg((e = Yt("<pro>" + (e = it((e = Oe(t, e + 4)))) + "</pro>")))
                  );
                }
                return "";
              }
              function rm(e, t) {
                var r = t.attributes.schemeIdUri,
                  i = or(t, "urn:mpeg:cenc:2013", "default_KID"),
                  n = lr(t, "urn:mpeg:cenc:2013", "pssh").map(rr),
                  a = t.attributes.value;
                if (!r) return null;
                if (((r = r.toLowerCase()), i && (i = i.replace(/-/g, "").toLowerCase()).includes(" ")))
                  throw new ze(2, 4, 4009);
                var s = [];
                try {
                  s = n.map(function (t) {
                    if (!e.g.has(t)) {
                      var r = at(t);
                      e.g.set(t, r);
                    }
                    return { initDataType: "cenc", initData: e.g.get(t), keyId: null };
                  });
                } catch (o) {
                  throw new ze(2, 4, 4007);
                }
                return { node: t, Hd: r, keyId: i, init: s.length > 0 ? s : null, encryptionScheme: a };
              }
              Zg.prototype.release = function () {
                this.g.clear();
              };
              var im = new Map()
                .set("com.apple.fps", function (t) {
                  if ("apple" === e.shakaMediaKeysPolyfill) throw new ze(2, 4, 4054);
                  return (t = ar(t.node, "https://dashif.org/CPS", "Laurl")) && (t = tr(t)) ? t : "";
                })
                .set("com.widevine.alpha", function (e) {
                  var t = ar(e.node, "https://dashif.org/CPS", "Laurl");
                  return t && (t = tr(t))
                    ? t
                    : ((e = ar(e.node, "urn:microsoft", "laurl")) && et(e.attributes.licenseUrl)) || "";
                })
                .set("com.microsoft.playready", tm)
                .set("com.microsoft.playready.recommendation", tm)
                .set("com.microsoft.playready.software", tm)
                .set("com.microsoft.playready.hardware", tm)
                .set("org.w3.clearkey", function (e) {
                  var t = ar(e.node, "https://dashif.org/CPS", "Laurl");
                  return t && (t = tr(t))
                    ? t
                    : (e = ar(e.node, "http://dashif.org/guidelines/clearKey", "Laurl")) &&
                        "EME-1.0" === e.attributes.Lic_type &&
                        e &&
                        (e = tr(e))
                      ? e
                      : "";
                });
              function nm(t, r, i, n, a, s) {
                var o = new Map()
                  .set("RepresentationID", r)
                  .set("Number", i)
                  .set("SubNumber", n)
                  .set("Bandwidth", a)
                  .set("Time", s);
                return t.replace(
                  /\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,
                  function (t, r, i, n) {
                    if ("$$" == t) return "$";
                    var a = o.get(r);
                    if (null == a) return t;
                    switch (
                      ("RepresentationID" == r && i && (i = void 0),
                      "Time" == r &&
                        "bigint" != typeof a &&
                        (Math.abs(a - Math.round(a)) >= 0.2 &&
                          z("Calculated $Time$ values must be close to integers"),
                        (a = Math.round(a))),
                      n)
                    ) {
                      case void 0:
                      case "d":
                      case "i":
                      case "u":
                        t = a.toString();
                        break;
                      case "o":
                        t = a.toString(8);
                        break;
                      case "x":
                        t = a.toString(16);
                        break;
                      case "X":
                        t = a.toString(16).toUpperCase();
                        break;
                      default:
                        t = a.toString();
                    }
                    return ((i = e.parseInt(i, 10) || 1), Array(Math.max(0, i - t.length) + 1).join("0") + t);
                  },
                );
              }
              function am(e, t) {
                var r = om(e, t, "timescale"),
                  i = 1;
                r && (i = pr(r) || 1);
                var n = (r = pr((r = om(e, t, "duration")) || "")) ? r / i : null,
                  a = om(e, t, "startNumber"),
                  s = Number(om(e, t, "presentationTimeOffset")) || 0,
                  o = gr(a || "");
                if (((null != a && null != o) || (o = 1), (a = null), (t = lm(e, t, "SegmentTimeline")))) {
                  ((t = er(t, "S")), (a = i), (e = e.na.duration || 1 / 0));
                  for (var l = o, u = [], d = -s, h = 0; h < t.length; ++h) {
                    var c = t[h],
                      f = t[h + 1],
                      p = sr(c, "t", gr),
                      g = sr(c, "d", gr),
                      m = sr(c, "r", fr);
                    if (((c = sr(c, "k", fr) || 0), null != p && (p -= s), g)) {
                      if (((p = null != p ? p : d), (m = m || 0) < 0))
                        if (f) {
                          if (null == (f = sr(f, "t", gr))) break;
                          if (p >= f) break;
                          m = Math.ceil((f - p) / g) - 1;
                        } else {
                          if (e == 1 / 0) break;
                          if (p / a >= e) break;
                          m = Math.ceil((e * a - p) / g) - 1;
                        }
                      for (u.length > 0 && p != d && (u[u.length - 1].end = p / a), f = 0; f <= m; ++f)
                        ((d = p + g),
                          u.push({ start: p / a, Ld: p, end: d / a, Jh: d, wc: c, Vk: u.length + l }),
                          (p = d));
                    }
                  }
                  a = u;
                }
                return { timescale: i, Qf: r, gb: n, ve: o, ec: s / i || 0, gd: s, timeline: a };
              }
              function sm(e, t) {
                return [t(e.L), t(e.qa), t(e.sa)].filter(Mi);
              }
              function om(e, t, r) {
                ((t = sm(e, t)), (e = null));
                for (var i = (t = g(t)).next(); !i.done && !(e = i.value.attributes[r]); i = t.next());
                return e;
              }
              function lm(e, t, r) {
                ((t = sm(e, t)), (e = null));
                for (var i = (t = g(t)).next(); !i.done && !(e = nr(i.value, r)); i = t.next());
                return e;
              }
              function um(e, t, r, i, n, a) {
                if (((a = void 0 === a ? 0 : a), or(e, "http://www.w3.org/1999/xlink", "href"))) {
                  var s = (function (e, t, r, i, n, a) {
                    for (
                      var s = or(e, "http://www.w3.org/1999/xlink", "href"),
                        o = or(e, "http://www.w3.org/1999/xlink", "actuate") || "onRequest",
                        l = g(Object.keys(e.attributes)),
                        u = l.next();
                      !u.done;
                      u = l.next()
                    ) {
                      var d = (u = u.value).split(":"),
                        h = Qt("http://www.w3.org/1999/xlink");
                      d[0] == h && delete e.attributes[u];
                    }
                    if (a >= 5) return Cn(new ze(2, 4, 4028));
                    if ("onLoad" != o) return Cn(new ze(2, 4, 4027));
                    var c = ut([i], [s]);
                    return n.request(0, Vn(c, t)).Xa(function (i) {
                      if (!(i = Xt(i.data, e.tagName))) return Cn(new ze(2, 4, 4001, s));
                      for (e.children = []; i.children.length; ) {
                        var o = i.children.shift();
                        e.children.push(o);
                      }
                      for (var l = (o = g(Object.keys(i.attributes))).next(); !l.done; l = o.next())
                        ((l = l.value), (e.attributes[l] = i.attributes[l]));
                      return um(e, t, r, c[0], n, a + 1);
                    });
                  })(e, t, r, i, n, a);
                  return (
                    r &&
                      (s = s.Xa(void 0, function () {
                        return um(e, t, r, i, n, a);
                      })),
                    s
                  );
                }
                s = [];
                for (var o = g(Zt(e)), l = o.next(), u = {}; !l.done; u = { Td: void 0 }, l = o.next())
                  ((u.Td = l.value),
                    "urn:mpeg:dash:resolve-to-zero:2013" == or(u.Td, "http://www.w3.org/1999/xlink", "href")
                      ? (e.children = e.children.filter(
                          (function (e) {
                            return function (t) {
                              return t !== e.Td;
                            };
                          })(u),
                        ))
                      : "SegmentTimeline" != u.Td.tagName && s.push(um(u.Td, t, r, i, n, a)));
                return _n(s).Xa(function () {
                  return e;
                });
              }
              function dm(e, t, r, i, n, a, s, o) {
                var l,
                  u = new aa().S("sidx", function (e) {
                    l = (function (e, t, r, i, n, a, s, o) {
                      o = void 0 !== o && o;
                      var l = [];
                      s.reader.skip(4);
                      var u = s.reader.U();
                      if (0 == u) throw new ze(2, 3, 3005);
                      if (0 == s.version)
                        var d = s.reader.U(),
                          h = s.reader.U();
                      else ((d = s.reader.Ed()), (h = s.reader.Ed()));
                      s.reader.skip(2);
                      var c = s.reader.Ca();
                      for (e = (o ? -s.size : e) + s.size + h, o = 0; o < c; o++) {
                        var f = s.reader.U();
                        ((h = (2147483648 & f) >>> 31), (f &= 2147483647));
                        var p = s.reader.U();
                        if ((s.reader.skip(4), 1 == h)) throw new ze(2, 3, 3006);
                        (l.push(
                          new Bs(
                            d / u + r,
                            (d + p) / u + r,
                            function () {
                              return a;
                            },
                            e,
                            e + f - 1,
                            t,
                            r,
                            i,
                            n,
                          ),
                        ),
                          (d += p),
                          (e += f));
                      }
                      return (s.parser.stop(), l);
                    })(t, i, n, a, s, r, e, o);
                  });
                if ((e && u.parse(e), l)) return l;
                throw new ze(2, 3, 3004);
              }
              function hm(e) {
                ((this.h = Fe(e)), (this.g = new ra(this.h, 0)));
              }
              function cm(e) {
                var t = fm(e);
                if (t.length > 7) throw new ze(2, 3, 3002);
                for (var r = 0, i = (t = g(t)).next(); !i.done; i = t.next()) r = 256 * r + i.value;
                t = fm(e);
                e: {
                  for (var n = (i = g(pm)).next(); !n.done; n = i.next())
                    if (_e(t, new Uint8Array(n.value))) {
                      i = !0;
                      break e;
                    }
                  i = !1;
                }
                if (i) t = e.h.byteLength - e.g.Pa();
                else {
                  if (8 == t.length && 224 & t[1]) throw new ze(2, 3, 3001);
                  for (n = i = 0; n < t.length; n++) {
                    var a = t[n];
                    i = 0 == n ? a & ((1 << (8 - t.length)) - 1) : 256 * i + a;
                  }
                  t = i;
                }
                return (
                  (t = e.g.Pa() + t <= e.h.byteLength ? t : e.h.byteLength - e.g.Pa()),
                  (i = Fe(e.h, e.g.Pa(), t)),
                  e.g.skip(t),
                  new gm(r, i)
                );
              }
              function fm(e) {
                var t = e.g.Pa(),
                  r = e.g.Y();
                if (0 == r) throw new ze(2, 3, 3002);
                return ((r = 8 - Math.floor(Math.log2(r))), e.g.skip(r - 1), Oe(e.h, t, r));
              }
              hm.prototype.Ia = function () {
                return this.g.Ia();
              };
              var pm = [
                [255],
                [127, 255],
                [63, 255, 255],
                [31, 255, 255, 255],
                [15, 255, 255, 255, 255],
                [7, 255, 255, 255, 255, 255],
                [3, 255, 255, 255, 255, 255, 255],
                [1, 255, 255, 255, 255, 255, 255, 255],
              ];
              function gm(e, t) {
                ((this.id = e), (this.g = t));
              }
              function mm(e) {
                if (e.g.byteLength > 8) throw new ze(2, 3, 3002);
                if (8 == e.g.byteLength && 224 & e.g.getUint8(0)) throw new ze(2, 3, 3001);
                for (var t = 0, r = 0; r < e.g.byteLength; r++) t = 256 * t + e.g.getUint8(r);
                return t;
              }
              function vm(e, t, r, i, n, a, s) {
                if (440786851 != cm((t = new hm(t))).id) throw new ze(2, 3, 3008);
                var o = cm(t);
                if (408125543 != o.id) throw new ze(2, 3, 3009);
                ((t = o.g.byteOffset), (o = new hm(o.g)));
                for (var l = null; o.Ia(); ) {
                  var u = cm(o);
                  if (357149030 == u.id) {
                    l = u;
                    break;
                  }
                }
                if (!l) throw new ze(2, 3, 3010);
                for (l = new hm(l.g), u = 1e6, o = null; l.Ia(); ) {
                  var d = cm(l);
                  if (2807729 == d.id) u = mm(d);
                  else if (17545 == d.id)
                    if (4 == d.g.byteLength) o = d.g.getFloat32(0);
                    else {
                      if (8 != d.g.byteLength) throw new ze(2, 3, 3003);
                      o = d.g.getFloat64(0);
                    }
                }
                if (null == o) throw new ze(2, 3, 3011);
                if (((o *= l = u / 1e9), 475249515 != (e = cm(new hm(e))).id)) throw new ze(2, 3, 3007);
                return (function (e, t, r, i, n, a, s, o, l) {
                  function u() {
                    return n;
                  }
                  var d = [];
                  e = new hm(e.g);
                  for (var h = null, c = null; e.Ia(); ) {
                    var f = cm(e);
                    if (187 == f.id) {
                      var p = ym(f);
                      p &&
                        ((f = r * p.ol),
                        (p = t + p.Nk),
                        null != h && d.push(new Bs(h + s, f + s, u, c, p - 1, a, s, o, l)),
                        (h = f),
                        (c = p));
                    }
                  }
                  return (null != h && d.push(new Bs(h + s, i + s, u, c, null, a, s, o, l)), d);
                })(e, t, l, o, r, i, n, a, s);
              }
              function ym(e) {
                var t = new hm(e.g);
                if (179 != (e = cm(t)).id) throw new ze(2, 3, 3013);
                if (((e = mm(e)), 183 != (t = cm(t)).id)) throw new ze(2, 3, 3012);
                t = new hm(t.g);
                for (var r = 0; t.Ia(); ) {
                  var i = cm(t);
                  if (241 == i.id) {
                    r = mm(i);
                    break;
                  }
                }
                return { ol: e, Nk: r };
              }
              function Tm(e, t, r) {
                if (!(t = lm(e, t, "Initialization"))) return null;
                var i = e.L.bb(),
                  n = t.attributes.sourceURL;
                (n && (i = ut(i, [et(n)], e.Lb())), (n = 0));
                var a = null;
                return (
                  (t = sr(t, "range", cr)) && ((n = t.start), (a = t.end)),
                  ((r = new Fs(
                    function () {
                      return i;
                    },
                    n,
                    a,
                    Am(e),
                    null,
                    null,
                    r,
                    e.qa.encrypted,
                  )).codecs = e.L.codecs),
                  (r.mimeType = e.L.mimeType),
                  e.na && !e.na.kf && (r.g = e.na.start + e.na.duration),
                  r
                );
              }
              function bm(e, t, r) {
                var i = Number(om(e, Em, "presentationTimeOffset")) || 0,
                  n = om(e, Em, "timescale"),
                  a = 1;
                n && (a = pr(n) || 1);
                var s = i / a || 0,
                  o = Tm(e, Em, r);
                !(function (e, t) {
                  if ((wm(e, t), !xm(e))) throw new ze(2, 4, 4002);
                })(e, o);
                var l = zt(e);
                return {
                  endTime: -1,
                  timeline: -1,
                  Sc: function () {
                    var e = lm(l, Em, "RepresentationIndex"),
                      r = l.L.bb();
                    return (
                      e && (e = et(e.attributes.sourceURL)) && (r = ut(r, [e], l.Lb())),
                      (e = xm(l)),
                      Sm(l, t, o, r, e.start, e.end, s)
                    );
                  },
                  timescale: a,
                };
              }
              function Sm(e, t, r, i, n, a, s) {
                var o, l, u, d, h, c, f, p, m, v, y, T, S, E, x, w, A, I, k, R;
                return D(function (C) {
                  if (1 == C.g)
                    return (
                      (o = e.presentationTimeline),
                      (l = !e.Eb || !e.na.kf),
                      (u = e.na.start),
                      (d = e.na.duration),
                      (h = e.L.mimeType.split("/")[1]),
                      (f = null),
                      (p = [(c = t)(i, n, a, !1), "webm" == h ? c(r.P(), r.startByte, r.endByte, !0) : null]),
                      (c = null),
                      b(C, Promise.all(p), 2)
                    );
                  for (
                    m = C.h,
                      v = m[0],
                      y = m[1] || null,
                      S = u - s,
                      E = u,
                      x = d ? u + d : 1 / 0,
                      w = e.L.bb(),
                      A =
                        w.length != i.length ||
                        w.some(function (e, t) {
                          return e != i[t];
                        }),
                      T = "mp4" == h ? dm(v, n, w, r, S, E, x, A) : vm(v, y, w, r, S, E, x),
                      I = g(T),
                      k = I.next();
                    !k.done;
                    k = I.next()
                  )
                    (((R = k.value).codecs = e.L.codecs),
                      (R.mimeType = e.L.mimeType),
                      (R.bandwidth = e.bandwidth));
                  return (o.me(T), (f = new Ml(T)), l && f.pd(E, x, !0), C.return(f));
                });
              }
              function Em(e) {
                return e.Id;
              }
              function xm(e) {
                var t = lm(e, Em, "RepresentationIndex");
                return ((e = cr((e = om(e, Em, "indexRange")) || "")), t && (e = sr(t, "range", cr, e)), e);
              }
              function wm(e, t) {
                var r = e.L.mimeType.split("/")[1];
                if (e.L.contentType != gt && "mp4" != r && "webm" != r) throw new ze(2, 4, 4006);
                if ("webm" == r && !t) throw new ze(2, 4, 4005);
              }
              function Am(e) {
                var t = e.L;
                return {
                  bandwidth: e.bandwidth,
                  audioSamplingRate: t.audioSamplingRate,
                  codecs: t.codecs,
                  contentType: t.contentType,
                  frameRate: t.frameRate || null,
                  height: t.height || null,
                  mimeType: t.mimeType,
                  channelsCount: t.yf,
                  pixelAspectRatio: t.pixelAspectRatio || null,
                  width: t.width || null,
                  label: e.qa.label || null,
                  roles: e.roles || null,
                  language: e.qa.language || null,
                };
              }
              function Im(e, t, r) {
                var i = Tm(e, km, r),
                  n = (function (e) {
                    var t = (function (e) {
                        return [e.L.Ac, e.qa.Ac, e.sa.Ac]
                          .filter(Mi)
                          .map(function (e) {
                            return er(e, "SegmentURL");
                          })
                          .reduce(function (e, t) {
                            return e.length > 0 ? e : t;
                          })
                          .map(function (t) {
                            return (
                              t.attributes.indexRange && !e.Og && (e.Og = !0),
                              {
                                Ck: et(t.attributes.media),
                                start: (t = sr(t, "mediaRange", cr, { start: 0, end: null })).start,
                                end: t.end,
                              }
                            );
                          });
                      })(e),
                      r = (e = am(e, km)).ve;
                    0 == r && (r = 1);
                    var i = 0;
                    return (
                      e.gb
                        ? (i = e.gb * (r - 1))
                        : e.timeline && e.timeline.length > 0 && (i = e.timeline[0].start),
                      {
                        gb: e.gb,
                        startTime: i,
                        ve: r,
                        ec: e.ec,
                        timescale: e.timescale,
                        timeline: e.timeline,
                        yd: t,
                      }
                    );
                  })(e);
                if (!n.gb && !n.timeline && n.yd.length > 1) throw new ze(2, 4, 4002);
                if (!n.gb && !e.na.duration && !n.timeline && 1 == n.yd.length) throw new ze(2, 4, 4002);
                if (n.timeline && 0 == n.timeline.length) throw new ze(2, 4, 4002);
                var a = null,
                  s = null;
                e.sa.id && e.L.id && (s = t.get(e.sa.id + "," + e.L.id)) && (a = s.segmentIndex);
                var o = (function (e, t, r, i, n, a, s, o, l, u) {
                  var d = i.yd.length;
                  i.timeline &&
                    i.timeline.length != i.yd.length &&
                    (d = Math.min(i.timeline.length, i.yd.length));
                  for (
                    var h = e - i.ec, c = t ? e + t : 1 / 0, f = [], p = i.startTime, g = {}, m = 0;
                    m < d;
                    g = { Sf: void 0, Hf: void 0 }, m++
                  ) {
                    g.Hf = i.yd[m];
                    var v = p;
                    ((p = void 0),
                      (p = null != i.gb ? v + i.gb : i.timeline ? i.timeline[m].end : v + t),
                      (g.Sf = null),
                      ((g = new Bs(
                        e + v,
                        e + p,
                        (function (e) {
                          return function () {
                            return (null == e.Sf && (e.Sf = ut(r(), [e.Hf.Ck], u())), e.Sf);
                          };
                        })(g),
                        g.Hf.start,
                        g.Hf.end,
                        n,
                        h,
                        e,
                        c,
                        [],
                        "",
                        null,
                        null,
                        Gs,
                        a,
                      )).codecs = o),
                      (g.mimeType = s),
                      (g.bandwidth = l),
                      f.push(g));
                  }
                  return f;
                })(e.na.start, e.na.duration, e.L.bb, n, i, r, e.L.mimeType, e.L.codecs, e.bandwidth, e.Lb);
                return (
                  (t = !a),
                  a ? a.ke(o, e.presentationTimeline.Hb()) : (a = new Ml(o)),
                  e.presentationTimeline.me(o),
                  (e.Eb && e.na.kf) ||
                    a.pd(e.na.start, e.na.duration ? e.na.start + e.na.duration : 1 / 0, t),
                  s && (s.segmentIndex = a),
                  {
                    endTime: -1,
                    timeline: -1,
                    Sc: function () {
                      return ((a && 0 != a.getNumReferences()) || a.tf(o), Promise.resolve(a));
                    },
                    timescale: n.timescale,
                  }
                );
              }
              function km(e) {
                return e.Ac;
              }
              function Rm(t, r, i, n, a, s, o, l, u, d) {
                u || t.L.hf || (t.L.hf = om(t, Cm, "initialization"));
                var h = t.L.hf
                    ? (function (e, t) {
                        var r = e.L.hf;
                        if ((r || (r = om(e, Cm, "initialization")), !r)) return null;
                        r = et(r);
                        var i = e.L.originalId,
                          n = e.bandwidth || null,
                          a = e.L.bb,
                          s = e.Lb;
                        return (
                          (t = new Fs(
                            function () {
                              var e = nm(r, i, null, null, n, null);
                              return ut(a(), [e], s());
                            },
                            0,
                            null,
                            Am(e),
                            null,
                            null,
                            t,
                            e.qa.encrypted,
                          )),
                          (t.codecs = e.L.codecs),
                          (t.mimeType = e.L.mimeType),
                          e.na && !e.na.kf && (t.g = e.na.start + e.na.duration),
                          t
                        );
                      })(t, o)
                    : null,
                  c = (function (e) {
                    var t = am(e, Cm),
                      r = om(e, Cm, "media"),
                      i = om(e, Cm, "index"),
                      n = om(e, Cm, "k"),
                      a = 0;
                    return (
                      n && (a = parseInt(n, 10)),
                      {
                        Qf: t.Qf,
                        gb: t.gb,
                        timescale: t.timescale,
                        ve: t.ve,
                        ec: t.ec,
                        gd: t.gd,
                        timeline: t.timeline,
                        bc: r && et(r),
                        fe: i,
                        mimeType: e.L.mimeType,
                        codecs: e.L.codecs,
                        bandwidth: e.bandwidth,
                        Dk: a,
                      }
                    );
                  })(t);
                !(function (e) {
                  var t = e.fe ? 1 : 0;
                  if (((t += e.timeline ? 1 : 0), 0 == (t += e.gb ? 1 : 0))) throw new ze(2, 4, 4002);
                  if ((1 != t && (e.fe && (e.timeline = null), (e.Qf = null), (e.gb = null)), !e.fe && !e.bc))
                    throw new ze(2, 4, 4002);
                })(c);
                var f = zt(t);
                if (c.fe)
                  return (
                    wm(t, h),
                    {
                      endTime: -1,
                      timeline: -1,
                      Sc: function () {
                        var e = nm(c.fe, f.L.originalId, null, null, f.bandwidth || null, null);
                        return ((e = ut(f.L.bb(), [e])), Sm(f, r, h, e, 0, null, c.ec));
                      },
                      timescale: c.timescale,
                    }
                  );
                if (c.gb)
                  return (
                    n ||
                      "image" === t.qa.contentType ||
                      "text" === t.qa.contentType ||
                      ((n = t.na.start),
                      (d = t.sa.id),
                      (i = t.na.duration),
                      (d = (d = (null != d && s.get(d)) || i) ? n + d : 1 / 0),
                      t.presentationTimeline.Wg(c.gb),
                      t.presentationTimeline.Gi(n, d)),
                    {
                      endTime: -1,
                      timeline: -1,
                      Sc: function () {
                        return (function (t, r, i, n, a, s, o, l) {
                          function u(i) {
                            var a = i - y,
                              o = a * v,
                              u = r.Qf,
                              d = a * u;
                            ("BigInt" in e && d > Number.MAX_SAFE_INTEGER && (d = BigInt(a) * BigInt(u)),
                              (a = (o += f) + v),
                              (u = Math.min(a, h())));
                            var c = [],
                              p = r.Dk;
                            if (p)
                              for (var g = (u - o) / p, m = {}, A = 0; A < p; m = { bj: void 0 }, A++) {
                                var I = o + g * A,
                                  k = I + g;
                                ((m.bj = A),
                                  ((m = new Bs(
                                    I,
                                    k,
                                    (function (e) {
                                      return function () {
                                        var t = nm(T, S, i, e.bj, b, d);
                                        return ut(E(), [t], x());
                                      };
                                    })(m),
                                    0,
                                    null,
                                    n,
                                    w,
                                    f,
                                    h(),
                                    [],
                                    "",
                                    null,
                                    null,
                                    Gs,
                                    s,
                                  )).codecs = t.L.codecs),
                                  (m.mimeType = t.L.mimeType),
                                  0 == l ? A > 0 && m.wd() : A % l != 0 && m.wd(),
                                  c.push(m));
                              }
                            return (
                              ((o = new Bs(
                                o,
                                u,
                                function () {
                                  if (p) return [];
                                  var e = nm(T, S, i, null, b, d);
                                  return ut(E(), [e], x());
                                },
                                0,
                                null,
                                n,
                                w,
                                f,
                                h(),
                                c,
                                "",
                                null,
                                null,
                                Gs,
                                s,
                                c.length > 0,
                              )).codecs = t.L.codecs),
                              (o.mimeType = t.L.mimeType),
                              (o.bandwidth = t.bandwidth),
                              (o.j = a),
                              o
                            );
                          }
                          function d() {
                            var e = [Math.max(c.Hb(), f), Math.min(c.Ic(), h())].map(function (e) {
                              return e - f;
                            });
                            return (
                              (e = [Math.ceil(e[0] / v), Math.ceil(e[1] / v) - 1]),
                              t.L.rb && e[1]++,
                              e.map(function (e) {
                                return e + y;
                              })
                            );
                          }
                          function h() {
                            var e = (null != p && a.get(p)) || m;
                            return e ? f + e : 1 / 0;
                          }
                          var c = t.presentationTimeline,
                            f = t.na.start,
                            p = t.sa.id,
                            m = t.na.duration,
                            v = r.gb,
                            y = r.ve,
                            T = r.bc,
                            b = t.bandwidth || null,
                            S = t.L.originalId,
                            E = t.L.bb,
                            x = t.Lb,
                            w = f - r.ec,
                            A = d();
                          ((i = t.Eb ? Math.max(A[0], A[1] - i + 1) : A[0]), (o = o || A[1]), (A = []));
                          for (var I = i; I <= o; ++I) {
                            var k = u(I);
                            A.push(k);
                          }
                          var R = new Ml(A);
                          if (((A = c.Ic() < h()), (I = c.W()), A || I)) {
                            var C = Math.max(i, o + 1);
                            ((i = v),
                              t.L.rb && (i = 0.1),
                              R.Rf(i, function () {
                                var e = c.Hb();
                                R.Ya(e);
                                var t = g(d());
                                (t.next(), (t = t.next().value));
                                for (var r = []; C <= t; ) {
                                  var i = u(C);
                                  (r.push(i), C++);
                                }
                                return e > h() && !r.length ? null : r;
                              }));
                          }
                          return Promise.resolve(R);
                        })(f, c, a, h, s, o, l, t.L.If);
                      },
                      timescale: c.timescale,
                    }
                  );
                var p = null;
                ((n = n = null),
                  t.sa.id &&
                    t.L.id &&
                    ((n = t.sa.id + "," + t.L.id), (n = i.get(n))) &&
                    (p = n.segmentIndex));
                var m = t.na.start,
                  v = t.na.duration ? m + t.na.duration : 1 / 0;
                if (p) (Mm((d = p), c, m, v, h, t.Eb), d.Ya(t.presentationTimeline.Hb()));
                else {
                  if (((i = 0), (u = -1), null != t.sa.id && null != t.L.id)) {
                    var y = d.get(t.sa.id);
                    if (y) u = y.timeline;
                    else
                      for (y = (d = g(d.values())).next(); !y.done; y = d.next()) {
                        if (((y = y.value), Math.abs(c.ec - y.endTime) <= vt && y.gh.includes(t.L.id))) {
                          u = y.timeline;
                          break;
                        }
                        y.timeline >= i && (i = y.timeline + 1);
                      }
                  }
                  (-1 == u && (u = i),
                    (p = new Lm(t.Eb, c, t.L.originalId, t.bandwidth, t.L.bb, t.Lb, m, v, h, o, t.L.If, u)));
                }
                return (
                  c.timeline &&
                    "image" !== t.qa.contentType &&
                    "text" !== t.qa.contentType &&
                    t.presentationTimeline.Hi(p.h ? p.h.timeline : [], m),
                  n && t.Eb && (n.segmentIndex = p),
                  (n = (n = (n = c.timeline) && n[n.length - 1]) ? n.end + c.ec : -1),
                  (d = -1),
                  p instanceof Lm && (d = p.We()),
                  {
                    endTime: n,
                    timeline: d,
                    Sc: function () {
                      return (
                        p instanceof Lm && 0 == p.getNumReferences() && Mm(p, c, m, v, h, t.Eb),
                        Promise.resolve(p)
                      );
                    },
                    timescale: c.timescale,
                  }
                );
              }
              function Cm(e) {
                return e.Oc;
              }
              function Lm(e, t, r, i, n, a, s, o, l, u, d, h) {
                (Ml.call(this, []),
                  (this.F = e),
                  (this.h = t),
                  (this.H = r),
                  (this.C = i),
                  (this.G = n),
                  (this.J = a),
                  (this.j = s),
                  (this.l = o),
                  (this.u = l),
                  (this.B = u),
                  (this.I = d),
                  (this.K = h),
                  Dm(this));
              }
              function Mm(e, t, r, i, n, a) {
                if (
                  ((function (e, t) {
                    if (e.u !== t) {
                      e.u = t;
                      for (var r = (e = g(e.g)).next(); !r.done; r = e.next()) (r = r.value) && js(r, t);
                    }
                  })(e, n),
                  (e.F = a),
                  e.h)
                ) {
                  if (e.h.gd !== t.gd)
                    for (r = t.gd - e.h.gd, n = 0; n < t.timeline.length; n++)
                      (((a = t.timeline[n]).Ld += r),
                        (a.Jh += r),
                        (a.start = (a.Ld + r) / t.timescale),
                        (a.end = (a.Jh + r) / t.timescale));
                  if ((e.h.bc !== t.bc && (e.h.bc = t.bc), (r = e.h.timeline).length)) {
                    var s = r[r.length - 1];
                    t = t.timeline.filter(function (e) {
                      return e.end > s.end;
                    });
                  } else t = t.timeline.slice();
                  (t.length > 0 && e.h.timeline.push.apply(e.h.timeline, m(t)), e.l !== i && (e.l = i));
                } else ((e.h = t), (e.j = r), (e.l = i));
                Dm(e);
              }
              function Dm(e) {
                if (e.h && !e.o) {
                  for (var t = [], r = g(e.h.timeline), i = r.next(); !i.done; i = r.next())
                    (i = i.value).start >= e.l || i.end <= 0 || t.push(i);
                  ((e.h.timeline = t), e.Ya(e.j));
                }
              }
              function _m(e, t, r, i, n, a, s, o) {
                return (
                  (e = nm(e, t, r, a, i || null, n)),
                  ut(s(), [e], o()).map(function (e) {
                    return e.toString();
                  })
                );
              }
              function Pm(e) {
                ((this.o = null),
                  (this.B = e),
                  (this.H = new Un()),
                  (this.i = []),
                  (this.h = null),
                  (this.m = []),
                  (this.C = null),
                  (this.G = []),
                  (this.F = 300),
                  (this.l = new Map()),
                  (this.j = new Map()),
                  (this.g = null),
                  (this.u = "UNKNOWN"));
              }
              function Om(e, t) {
                var r, i, n, a, s, o, l;
                return D(function (u) {
                  return 1 == u.g
                    ? ((r = ut(e.i, [Nm(e, t)])),
                      (i = Vn(r, e.o.retryParameters)),
                      (n = e.B.networkingEngine.request(8, i)),
                      Bn(e.H, n),
                      E(u, 2),
                      b(u, n.promise, 4))
                    : 2 != u.g
                      ? ((a = u.h),
                        (s = Xe(a.data)),
                        1 == (o = JSON.parse(s)).VERSION &&
                          (function (e, t, r) {
                            null != e.g && (e.g.stop(), (e.g = null));
                            var i = t["RELOAD-URI"] || r;
                            ((e.g = new Ri(function () {
                              Om(e, i);
                            })),
                              (r = t.TTL) && (e.F = r),
                              e.g.ka(e.F),
                              (e.m = t["PATHWAY-PRIORITY"] || []),
                              (e.G = t["PATHWAY-CLONES"] || []));
                          })(e, o, a.uri),
                        w(u, 0))
                      : (l = A(u)) && 7001 == l.code
                        ? u.return()
                        : (null != e.g && (e.g.stop(), (e.g = null)),
                          (e.g = new Ri(function () {
                            Om(e, t);
                          })),
                          e.g.ka(e.F),
                          void S(u));
                });
              }
              function Nm(e, t) {
                if (!e.m.length) return t;
                t = new me(t);
                var r = e.C || e.m[0],
                  i = Math.round(e.B.getBandwidthEstimate()),
                  n = t.g;
                return (
                  "DASH" == e.u
                    ? (n.add("_DASH_pathway", r), n.add("_DASH_throughput", String(i)))
                    : "HLS" == e.u && (n.add("_HLS_pathway", r), n.add("_HLS_throughput", String(i))),
                  Me(n) && be(t, n),
                  t.toString()
                );
              }
              function Fm(e, t, r, i) {
                var n = e.l.get(t);
                (n || (n = new Map()), n.set(r, i), e.l.set(t, n));
              }
              function Um(e, t, r) {
                ((r = void 0 !== r && r), (t = e.l.get(t) || new Map()));
                for (var i = [], n = g(e.m), a = n.next(), s = {}; !a.done; s = { Cd: void 0 }, a = n.next())
                  if (((s.Cd = a.value), (a = t.get(s.Cd)))) i.push({ ah: s.Cd, location: a });
                  else if (
                    (a = e.G.find(
                      (function (e) {
                        return function (t) {
                          return t.Ol == e.Cd;
                        };
                      })(s),
                    ))
                  ) {
                    var o = t.get(a["BASE-ID"]);
                    o &&
                      (a["URI-REPLACEMENT"].oj
                        ? (ye((o = new me(o)), a["URI-REPLACEMENT"].oj),
                          i.push({ ah: s.Cd, location: o.toString() }))
                        : i.push({ ah: s.Cd, location: o }));
                  }
                for (n = Date.now(), a = (s = g(e.j.keys())).next(); !a.done; a = s.next())
                  ((a = a.value), n > (o = e.j.get(a)) && e.j.delete(a));
                if (
                  ((i = i.filter(function (t) {
                    for (var r = g(e.j.keys()), i = r.next(); !i.done; i = r.next())
                      if (i.value.includes(new me(t.location).Db)) return !1;
                    return !0;
                  })),
                  i.length && (e.C = i[0].ah),
                  (i = i.map(function (e) {
                    return e.location;
                  })),
                  !i.length && e.h)
                )
                  for (s = (n = g(e.h.split(","))).next(); !s.done; s = n.next())
                    (s = t.get(s.value)) && ((e.C = e.h), i.push(s));
                if (!i.length) for (n = (t = g(t.values())).next(); !n.done; n = t.next()) i.push(n.value);
                return r ? i : ut(e.i, i);
              }
              function Bm() {
                ((this.l = []),
                  (this.h = []),
                  (this.g = []),
                  (this.j = []),
                  (this.i = []),
                  (this.o = !1),
                  (this.m = new Set()));
              }
              function $m(e, t) {
                for (var r = [], i = [], n = [], a = [], s = (e = g(e)).next(); !s.done; s = e.next()) {
                  var o = s.value;
                  s = new Map(
                    o.audioStreams.map(function (e) {
                      return [fv(e), e];
                    }),
                  );
                  var l = new Map(
                      o.videoStreams.map(function (e) {
                        return [cv(e), e];
                      }),
                    ),
                    u = new Map(
                      o.textStreams.map(function (e) {
                        return [pv(e), e];
                      }),
                    );
                  if (
                    ((o = new Map(
                      o.imageStreams.map(function (e) {
                        return [gv(e), e];
                      }),
                    )),
                    t)
                  ) {
                    var d = ov(gt);
                    (u.set(pv(d), d), (d = ov("image")), o.set(gv(d), d));
                  }
                  (r.push(s), i.push(l), n.push(u), a.push(o));
                }
                return { Sh: r, mj: i, hj: n, pi: a };
              }
              function jm(e) {
                var t, r, i, n, a, s, o, l, u, d, h, c, f, p, m, v, y, T, S, E, x, w, A, I, k, R, C, L, M;
                return D(function (D) {
                  switch (D.g) {
                    case 1:
                      if (((t = mt), 1 == e.length)) return D.return(e[0]);
                      for (
                        r = e.map(function (e) {
                          return new Map(
                            e
                              .filter(function (e) {
                                return e.type === t.aa;
                              })
                              .map(function (e) {
                                return [fv(e), e];
                              }),
                          );
                        }),
                          i = e.map(function (e) {
                            return new Map(
                              e
                                .filter(function (e) {
                                  return e.type === t.wa;
                                })
                                .map(function (e) {
                                  return [cv(e), e];
                                }),
                            );
                          }),
                          n = e.map(function (e) {
                            return new Map(
                              e
                                .filter(function (e) {
                                  return e.type === t.Na;
                                })
                                .map(function (e) {
                                  return [pv(e), e];
                                }),
                            );
                          }),
                          a = e.map(function (e) {
                            return new Map(
                              e
                                .filter(function (e) {
                                  return e.type === t.Yf;
                                })
                                .map(function (e) {
                                  return [gv(e), e];
                                }),
                            );
                          }),
                          s = g(n),
                          o = s.next();
                        !o.done;
                        o = s.next()
                      )
                        ((l = o.value), (u = sv(t.Na)), l.set(pv(u), u));
                      for (d = g(a), h = d.next(); !h.done; h = d.next())
                        ((c = h.value), (f = sv(t.Yf)), c.set(gv(f), f));
                      return b(D, Gm((p = new Bm()), [], r, 0, zm, Xm, 0), 2);
                    case 2:
                      return ((m = D.h), b(D, Gm(p, [], i, 0, zm, Xm, 0), 3));
                    case 3:
                      return ((v = D.h), b(D, Gm(p, [], n, 0, zm, Xm, 0), 4));
                    case 4:
                      return ((y = D.h), b(D, Gm(p, [], a, 0, zm, Xm, 0), 5));
                    case 5:
                      if (((T = D.h), (S = 0), v.length && m.length))
                        for (A = g(m), I = A.next(); !I.done; I = A.next())
                          for (k = I.value, R = g(v), C = R.next(); !C.done; C = R.next())
                            ((L = C.value), (M = S++), L.variantIds.push(M), k.variantIds.push(M));
                      else
                        for (E = v.concat(m), x = g(E), w = x.next(); !w.done; w = x.next())
                          w.value.variantIds = [S++];
                      return D.return(v.concat(m).concat(y).concat(T));
                  }
                });
              }
              function Gm(e, t, r, i, n, a, s) {
                var o, l, u, d, h, c, f, p, m, v, y, T, S, E, x, w, A, I;
                return D(function (k) {
                  switch (k.g) {
                    case 1:
                      for (o = [], l = 0; l < r.length; l++)
                        l >= i ? o.push(new Set(r[l].values())) : o.push(new Set());
                      ((u = g(t)), (d = u.next()));
                    case 2:
                      if (d.done) {
                        k.A(4);
                        break;
                      }
                      return (
                        (h = d.value),
                        b(
                          k,
                          (function (e, t, r, i, n, a, s) {
                            return D(function (o) {
                              return 1 == o.g
                                ? (Ym(e, r, t, s > 0),
                                  t.matchedStreams
                                    ? t.segmentIndex
                                      ? b(o, Vm(t, i + s), 2)
                                      : o.A(2)
                                    : o.return(!1))
                                : (Km(t, i, n, a, s), o.return(!0));
                            });
                          })(e, h, r, i, a, o, s),
                          5,
                        )
                      );
                    case 5:
                      if (!k.h) throw new ze(2, 4, 4037);
                      ((d = u.next()), k.A(2));
                      break;
                    case 4:
                      for (c = g(o), f = c.next(); !f.done; f = c.next())
                        for (p = f.value, m = g(p), v = m.next(); !v.done; v = m.next())
                          ((y = v.value), (T = Hm(e, t, y, r, n, a, o)) && t.push(T));
                      for (S = g(o), E = S.next(); !E.done; E = S.next())
                        for (
                          x = E.value, w = g(x), A = w.next(), I = {};
                          !A.done;
                          I = { yh: void 0 }, A = w.next()
                        )
                          if (
                            ((I.yh = A.value),
                            !hv(I.yh) &&
                              t.some(
                                (function (e) {
                                  return function (t) {
                                    return Zm(e.yh, t);
                                  };
                                })(I),
                              ))
                          )
                            throw new ze(2, 4, 4037);
                      return k.return(t);
                  }
                });
              }
              function Vm(e, t) {
                var r, i, n, a, s, o;
                return D(function (l) {
                  if (1 == l.g) {
                    for (r = [], i = e.matchedStreams, n = t; n < i.length; n++)
                      ((a = i[n]),
                        r.push(a.createSegmentIndex()),
                        a.trickModeVideo &&
                          !a.trickModeVideo.segmentIndex &&
                          r.push(a.trickModeVideo.createSegmentIndex()),
                        a.dependencyStream &&
                          !a.dependencyStream.segmentIndex &&
                          r.push(a.dependencyStream.createSegmentIndex()));
                    return b(l, Promise.all(r), 2);
                  }
                  if (e.segmentIndex instanceof Ol)
                    for (s = t; s < i.length; s++)
                      (o = i[s]).segmentIndex && e.segmentIndex.h.push(o.segmentIndex);
                  S(l);
                });
              }
              function Hm(e, t, r, i, n, a, s) {
                if (hv(r)) return null;
                var o = n(r);
                return (
                  Ym(e, i, o),
                  o.createSegmentIndex &&
                    ((o.createSegmentIndex = function () {
                      return D(function (e) {
                        return o.segmentIndex ? e.A(0) : ((o.segmentIndex = new Ol()), b(e, Vm(o, 0), 0));
                      });
                    }),
                    (o.closeSegmentIndex = function () {
                      if (
                        (o.segmentIndex && (o.segmentIndex.release(), (o.segmentIndex = null)),
                        o.matchedStreams)
                      )
                        for (var e = g(o.matchedStreams), r = e.next(); !r.done; r = e.next()) {
                          var i;
                          if ((i = (r = r.value).segmentIndex)) {
                            e: {
                              for (var n = (i = g(t)).next(); !n.done; n = i.next())
                                if (
                                  (n = n.value) !== o &&
                                  n.segmentIndex &&
                                  n.matchedStreams &&
                                  n.matchedStreams.includes(r)
                                ) {
                                  i = !0;
                                  break e;
                                }
                              i = !1;
                            }
                            i = !i;
                          }
                          i && (r.segmentIndex.release(), (r.segmentIndex = null));
                        }
                    })),
                  o.matchedStreams && o.matchedStreams.length ? (Km(o, 0, a, s, 0), o) : null
                );
              }
              function Km(e, t, r, i, n) {
                var a = e.matchedStreams;
                for (t += n; t < a.length; t++) {
                  var s = a[t];
                  r(e, s);
                  var o = !0;
                  if (
                    ("audio" == e.type && 0 == Ui(e.language, s.language) && (o = !1),
                    o && ((o = i[t - n]) && o.delete(s), s.fullMimeTypes))
                  )
                    for (o = (s = g(s.fullMimeTypes.values())).next(); !o.done; o = s.next())
                      e.fullMimeTypes.add(o.value);
                }
              }
              function Wm(e) {
                var t = Object.assign({}, e);
                return (
                  (t.originalId = null),
                  (t.createSegmentIndex = function () {
                    return Promise.resolve();
                  }),
                  (t.closeSegmentIndex = function () {}),
                  (t.roles = t.roles.slice()),
                  (t.segmentIndex = null),
                  (t.emsgSchemeIdUris = []),
                  (t.keyIds = new Set(e.keyIds)),
                  (t.closedCaptions = e.closedCaptions ? new Map(e.closedCaptions) : null),
                  (t.trickModeVideo = null),
                  (t.dependencyStream = null),
                  t
                );
              }
              function zm(e) {
                var t = Object.assign({}, e);
                return (
                  (t.roles = t.roles.slice()),
                  (t.keyIds = new Set(e.keyIds)),
                  (t.segments = []),
                  (t.variantIds = []),
                  (t.closedCaptions = e.closedCaptions ? new Map(e.closedCaptions) : null),
                  t
                );
              }
              function qm(e, t) {
                function r(e, t) {
                  e || (e = []);
                  for (var r = (t = g(t)).next(); !r.done; r = t.next())
                    ((r = r.value), e.includes(r) || e.push(r));
                  return e;
                }
                ((e.roles = r(e.roles, t.roles)),
                  t.emsgSchemeIdUris && (e.emsgSchemeIdUris = r(e.emsgSchemeIdUris, t.emsgSchemeIdUris)));
                for (var i = g(t.keyIds), n = i.next(); !n.done; n = i.next()) e.keyIds.add(n.value);
                if (
                  (null == e.originalId
                    ? (e.originalId = t.originalId)
                    : (i = t.originalId || "") && !e.originalId.endsWith(i) && (e.originalId += "," + i),
                  (i = $e(e.drmInfos, t.drmInfos)),
                  t.drmInfos.length && e.drmInfos.length && !i.length)
                )
                  throw new ze(2, 4, 4038);
                if (((e.drmInfos = i), (e.encrypted = e.encrypted || t.encrypted), t.closedCaptions))
                  for (
                    e.closedCaptions || (e.closedCaptions = new Map()), n = (i = g(t.closedCaptions)).next();
                    !n.done;
                    n = i.next()
                  ) {
                    var a = g(n.value);
                    ((n = a.next().value), (a = a.next().value), e.closedCaptions.set(n, a));
                  }
                (e.bandwidth && t.bandwidth && (e.bandwidth = Math.max(e.bandwidth, t.bandwidth)),
                  t.trickModeVideo
                    ? (e.trickModeVideo ||
                        ((e.trickModeVideo = Wm(t.trickModeVideo)),
                        (e.trickModeVideo.matchedStreams = []),
                        (e.trickModeVideo.createSegmentIndex = function () {
                          if (e.trickModeVideo.segmentIndex) return Promise.resolve();
                          for (
                            var t = new Ol(), r = g(e.trickModeVideo.matchedStreams), i = r.next();
                            !i.done;
                            i = r.next()
                          )
                            t.h.push(i.value.segmentIndex);
                          return ((e.trickModeVideo.segmentIndex = t), Promise.resolve());
                        })),
                      e.trickModeVideo.matchedStreams.push(t.trickModeVideo),
                      qm(e.trickModeVideo, t.trickModeVideo))
                    : e.trickModeVideo && (e.trickModeVideo.matchedStreams.push(t), qm(e.trickModeVideo, t)),
                  t.dependencyStream
                    ? (e.dependencyStream ||
                        ((e.dependencyStream = Wm(t.dependencyStream)),
                        (e.dependencyStream.matchedStreams = []),
                        (e.dependencyStream.createSegmentIndex = function () {
                          if (e.dependencyStream.segmentIndex) return Promise.resolve();
                          for (
                            var t = new Ol(), r = g(e.dependencyStream.matchedStreams), i = r.next();
                            !i.done;
                            i = r.next()
                          )
                            t.h.push(i.value.segmentIndex);
                          return ((e.dependencyStream.segmentIndex = t), Promise.resolve());
                        })),
                      e.dependencyStream.matchedStreams.push(t.dependencyStream),
                      qm(e.dependencyStream, t.dependencyStream))
                    : e.dependencyStream &&
                      (e.dependencyStream.matchedStreams.push(t), qm(e.dependencyStream, t)));
              }
              function Xm(e, t) {
                var r = e.roles;
                r || (r = []);
                for (var i = g(t.roles), n = i.next(); !n.done; n = i.next())
                  ((n = n.value), r.includes(n) || r.push(n));
                for (e.roles = r, i = (r = g(t.keyIds)).next(); !i.done; i = r.next()) e.keyIds.add(i.value);
                if (
                  ((e.encrypted = e.encrypted && t.encrypted),
                  e.segments.push.apply(e.segments, m(t.segments)),
                  t.closedCaptions)
                )
                  for (
                    e.closedCaptions || (e.closedCaptions = new Map()), r = (t = g(t.closedCaptions)).next();
                    !r.done;
                    r = t.next()
                  )
                    ((r = (i = g(r.value)).next().value), (i = i.next().value), e.closedCaptions.set(r, i));
              }
              function Ym(e, t, r, i) {
                i = void 0 !== i && i ? r.matchedStreams : [];
                for (var n = (t = g(t)).next(); !n.done; n = t.next()) {
                  if (!(n = Qm(e, n.value, r))) return;
                  i.push(n);
                }
                r.matchedStreams = i;
              }
              function Qm(e, t, r) {
                var i = { audio: fv, video: cv, text: pv, image: gv }[r.type],
                  n = null,
                  a = i(r);
                if (t.has(a)) n = t.get(a);
                else {
                  a = {
                    audio: function (e, t) {
                      return Zm(e, t);
                    },
                    video: function (e, t) {
                      return Zm(e, t);
                    },
                    text: ev,
                    image: tv,
                  }[r.type];
                  for (
                    var s = { audio: rv, video: iv, text: nv, image: av }[r.type],
                      o = g(t.values()),
                      l = o.next();
                    !l.done;
                    l = o.next()
                  )
                    !a(r, (l = l.value)) ||
                      r.fastSwitching != l.fastSwitching ||
                      (n && !s(r, n, l)) ||
                      (n = l);
                }
                return (e.o && !hv(n) && t.delete(i(n)), n);
              }
              function Jm(e, t) {
                return e.mimeType == t.mimeType && vv(e.codecs) === vv(t.codecs);
              }
              function Zm(e, t) {
                return !(e.drmInfos && !Be(e.drmInfos, t.drmInfos));
              }
              function ev(e, t) {
                return (
                  !t.language ||
                  (e.forced === t.forced && 0 != Ui(e.language, t.language) && t.kind == e.kind)
                );
              }
              function tv() {
                return !0;
              }
              function rv(e, t, r) {
                var i = uv(e, t, r);
                if (i === yv) return !0;
                if (i === bv) return !1;
                i = Ui(e.language, t.language);
                var n = Ui(e.language, r.language);
                if (n > i) return !0;
                if (n < i) return !1;
                if (t.label !== r.label) {
                  if (e.label === t.label) return !1;
                  if (e.label === r.label) return !0;
                }
                if (e.roles.length) {
                  if (
                    ((i = t.roles.filter(function (t) {
                      return e.roles.includes(t);
                    })),
                    (n = r.roles.filter(function (t) {
                      return e.roles.includes(t);
                    })).length > i.length)
                  )
                    return !0;
                  if (n.length < i.length) return !1;
                  if (r.roles.length !== t.roles.length) return r.roles.length < t.roles.length;
                } else {
                  if (!r.roles.length && t.roles.length) return !0;
                  if (r.roles.length && !t.roles.length) return !1;
                }
                return (
                  !(t.primary || !r.primary) ||
                  (!(t.primary && !r.primary) &&
                    ((i = lv(e.channelsCount, t.channelsCount, r.channelsCount)) == yv ||
                      (i != bv &&
                        ((i = lv(e.audioSamplingRate, t.audioSamplingRate, r.audioSamplingRate)) == yv ||
                          (i != bv && !(!e.bandwidth || dv(e.bandwidth, t.bandwidth, r.bandwidth) != yv))))))
                );
              }
              function iv(e, t, r) {
                var i = uv(e, t, r);
                if (i === yv) return !0;
                if (i === bv) return !1;
                if ((i = lv(e.width * e.height, t.width * t.height, r.width * r.height)) == yv) return !0;
                if (i == bv) return !1;
                if (e.frameRate) {
                  if ((i = lv(e.frameRate, t.frameRate, r.frameRate)) == yv) return !0;
                  if (i == bv) return !1;
                }
                return !(!e.bandwidth || dv(e.bandwidth, t.bandwidth, r.bandwidth) != yv);
              }
              function nv(e, t, r) {
                var i = Ui(e.language, t.language),
                  n = Ui(e.language, r.language);
                if (n > i) return !0;
                if (n < i) return !1;
                if (!t.primary && r.primary) return !0;
                if (t.primary && !r.primary) return !1;
                if (t.label !== r.label) {
                  if (e.label === t.label) return !1;
                  if (e.label === r.label) return !0;
                }
                if (e.roles.length) {
                  if (
                    ((i = t.roles.filter(function (t) {
                      return e.roles.includes(t);
                    })),
                    (n = r.roles.filter(function (t) {
                      return e.roles.includes(t);
                    })).length > i.length)
                  )
                    return !0;
                  if (n.length < i.length) return !1;
                } else {
                  if (!r.roles.length && t.roles.length) return !0;
                  if (r.roles.length && !t.roles.length) return !1;
                }
                return (
                  r.mimeType == e.mimeType &&
                  r.codecs == e.codecs &&
                  (t.mimeType != e.mimeType || t.codecs != e.codecs)
                );
              }
              function av(e, t, r) {
                return lv(e.width * e.height, t.width * t.height, r.width * r.height) == yv;
              }
              function sv(e) {
                return {
                  id: 0,
                  originalId: "",
                  groupId: null,
                  primary: !1,
                  type: e,
                  mimeType: "",
                  codecs: "",
                  language: "",
                  originalLanguage: null,
                  label: null,
                  width: null,
                  height: null,
                  encrypted: !1,
                  keyIds: new Set(),
                  segments: [],
                  variantIds: [],
                  roles: [],
                  forced: !1,
                  channelsCount: null,
                  audioSamplingRate: null,
                  spatialAudio: !1,
                  closedCaptions: null,
                  external: !1,
                  fastSwitching: !1,
                  isAudioMuxedInVideo: !1,
                  baseOriginalId: null,
                };
              }
              function ov(e) {
                return {
                  id: 0,
                  originalId: "",
                  groupId: null,
                  createSegmentIndex: function () {
                    return Promise.resolve();
                  },
                  segmentIndex: new Ml([]),
                  mimeType: "",
                  codecs: "",
                  encrypted: !1,
                  drmInfos: [],
                  keyIds: new Set(),
                  language: "",
                  originalLanguage: null,
                  label: null,
                  type: e,
                  primary: !1,
                  trickModeVideo: null,
                  dependencyStream: null,
                  emsgSchemeIdUris: null,
                  roles: [],
                  forced: !1,
                  channelsCount: null,
                  audioSamplingRate: null,
                  spatialAudio: !1,
                  closedCaptions: null,
                  accessibilityPurpose: null,
                  external: !1,
                  fastSwitching: !1,
                  fullMimeTypes: new Set(),
                  isAudioMuxedInVideo: !1,
                  baseOriginalId: null,
                };
              }
              function lv(e, t, r) {
                if (t == e && e != r) return bv;
                if (r == e && e != t) return yv;
                if (t > e) {
                  if (r <= e || r - e < t - e) return yv;
                  if (r - e > t - e) return bv;
                } else {
                  if (r > e) return bv;
                  if (e - r < e - t) return yv;
                  if (e - r > e - t) return bv;
                }
                return Tv;
              }
              function uv(e, t, r) {
                var i = e.mimeType === t.mimeType && e.codecs === t.codecs,
                  n = e.mimeType === r.mimeType && e.codecs === r.codecs;
                return i && !n
                  ? bv
                  : !i && n
                    ? yv
                    : ((t = Jm(e, t)), (e = Jm(e, r)), t && !e ? bv : !t && e ? yv : Tv);
              }
              function dv(e, t, r) {
                return ((t = Math.abs(e - t)), (e = Math.abs(e - r)) < t ? yv : t < e ? bv : Tv);
              }
              function hv(e) {
                switch (e.type) {
                  case gt:
                    return !e.language;
                  case "image":
                    return !e.tilesLayout;
                  default:
                    return !1;
                }
              }
              function cv(e) {
                return mv([
                  e.fastSwitching,
                  e.width,
                  e.frameRate,
                  e.codecs,
                  e.mimeType,
                  e.label,
                  e.roles,
                  e.closedCaptions ? Array.from(e.closedCaptions.entries()) : null,
                  e.bandwidth,
                  e.dependencyStream ? e.dependencyStream.baseOriginalId : null,
                  Array.from(e.keyIds),
                ]);
              }
              function fv(e) {
                return mv([
                  e.fastSwitching,
                  e.channelsCount,
                  e.language,
                  e.bandwidth,
                  e.label,
                  e.codecs,
                  e.mimeType,
                  e.roles,
                  e.audioSamplingRate,
                  e.primary,
                  e.dependencyStream ? e.dependencyStream.baseOriginalId : null,
                  Array.from(e.keyIds),
                ]);
              }
              function pv(e) {
                return mv([e.language, e.label, e.codecs, e.mimeType, e.bandwidth, e.roles]);
              }
              function gv(e) {
                return mv([e.width, e.codecs, e.mimeType]);
              }
              function mv(e) {
                return JSON.stringify(e);
              }
              function vv(e) {
                if (!Sv.has(e)) {
                  var t = ci(e);
                  Sv.set(e, t);
                }
                return Sv.get(e);
              }
              (f(Lm, Ml),
                ((n = Lm.prototype).getNumReferences = function () {
                  return this.h ? this.h.timeline.length : 0;
                }),
                (n.release = function () {
                  (Ml.prototype.release.call(this), (this.h = null));
                }),
                (n.Ya = function (e) {
                  if (this.h) {
                    for (
                      var t = 0, r = this.h.timeline, i = 0;
                      i < r.length && r[i].end + this.j <= e;
                      i += 1
                    )
                      t += 1;
                    t > 0 &&
                      ((this.h.timeline = r.slice(t)),
                      this.g.length >= t && (this.g = this.g.slice(t)),
                      (this.i += t),
                      0 === this.getNumReferences() && this.release());
                  }
                }),
                (n.find = function (e) {
                  if (
                    this.h &&
                    this.h.timeline &&
                    this.h.timeline.length &&
                    e < this.h.timeline[0].start + this.j
                  )
                    return this.i;
                  if (!this.h) return null;
                  var t = this.h.timeline;
                  if (e < this.j || e >= this.l) return null;
                  for (var r = t.length - 1, i = 0; i < t.length; i++) {
                    var n = t[i],
                      a = n.start + this.j;
                    if (
                      ((n = i < r ? t[i + 1].start + this.j : this.l === 1 / 0 ? n.end + this.j : this.l),
                      e >= a && e < n)
                    )
                      return i + this.i;
                  }
                  return null;
                }),
                (n.get = function (e) {
                  var t = this;
                  if ((e -= this.i) < 0 || e >= this.getNumReferences() || !this.h) return null;
                  var r = this.g[e];
                  if (!r) {
                    var i = (r = this.h.timeline[e]).Vk,
                      n = r.Ld + this.h.gd,
                      a = this.j - this.h.ec,
                      s = this.j + r.end,
                      o = s;
                    e === this.getNumReferences() - 1 &&
                      this.l !== 1 / 0 &&
                      (o = this.F && Math.abs(o - this.l) > 0.1 ? Math.min(o, this.l) : this.l);
                    var l = this.h.codecs,
                      u = this.h.mimeType,
                      d = this.h.bandwidth,
                      h = [],
                      c = !1;
                    if ((r.wc && this.h && this.h.bc && (c = this.h.bc.includes("$SubNumber$")), c)) {
                      c = (r.end - r.start) / r.wc;
                      for (var f = {}, p = 0; p < r.wc; f = { Tf: void 0, cj: void 0 }, p++) {
                        var g = r.start + c * p,
                          m = g + c;
                        ((f.cj = p),
                          (f.Tf = null),
                          ((f = new Bs(
                            this.j + g,
                            this.j + m,
                            (function (e) {
                              return function () {
                                return t.h
                                  ? (null == e.Tf && (e.Tf = _m(t.h.bc, t.H, i, t.C, n, e.cj, t.G, t.J)),
                                    e.Tf)
                                  : [];
                              };
                            })(f),
                            0,
                            null,
                            this.u,
                            a,
                            this.j,
                            this.l,
                            [],
                            "",
                            null,
                            null,
                            Gs,
                            this.B,
                          )).codecs = l),
                          (f.mimeType = u),
                          (f.bandwidth = d),
                          0 == this.I ? p > 0 && f.wd() : p % this.I != 0 && f.wd(),
                          h.push(f));
                      }
                    }
                    (((r = new Bs(
                      this.j + r.start,
                      o,
                      function () {
                        return h.length > 0 || !t.h ? [] : _m(t.h.bc, t.H, i, t.C, n, null, t.G, t.J);
                      },
                      0,
                      null,
                      this.u,
                      a,
                      this.j,
                      this.l,
                      h,
                      "",
                      null,
                      null,
                      Gs,
                      this.B,
                      h.length > 0,
                    )).codecs = l),
                      (r.mimeType = u),
                      (r.j = s),
                      (r.bandwidth = d),
                      (this.g[e] = r));
                  }
                  return r;
                }),
                (n.Fb = function (e) {
                  Dm(this);
                  for (var t = 0; t < this.getNumReferences(); t++) {
                    var r = this.get(t + this.i);
                    r && e(r);
                  }
                }),
                (n.We = function () {
                  return this.K;
                }),
                (Pm.prototype.configure = function (e) {
                  this.o = e;
                }),
                (Pm.prototype.destroy = function () {
                  return (
                    (this.B = this.o = null),
                    (this.i = []),
                    (this.h = null),
                    (this.m = []),
                    (this.G = []),
                    this.l.clear(),
                    null != this.g && (this.g.stop(), (this.g = null)),
                    this.H.destroy()
                  );
                }),
                (Pm.prototype.setManifestType = function (e) {
                  this.u = e;
                }),
                (Pm.prototype.banLocation = function (e) {
                  this.j.set(e, Date.now() + 6e4);
                }),
                ((n = Bm.prototype).release = function () {
                  for (var e = g(this.h.concat(this.g, this.j, this.i)), t = e.next(); !t.done; t = e.next())
                    (t = t.value).segmentIndex && t.segmentIndex.release();
                  ((this.h = []),
                    (this.g = []),
                    (this.j = []),
                    (this.i = []),
                    (this.l = []),
                    (this.o = !1),
                    this.m.clear());
                }),
                (n.fk = function () {
                  return this.l;
                }),
                (n.Mg = function () {
                  return this.j.slice();
                }),
                (n.Mj = function () {
                  return this.i;
                }),
                (n.Zh = function (e, t) {
                  if (e) {
                    if ("audio" == e.type)
                      for (var r = g(this.h), i = r.next(); !i.done; i = r.next())
                        (i = i.value).matchedStreams = i.matchedStreams.filter(function (t) {
                          return t !== e;
                        });
                    else if ("video" == e.type)
                      for (i = (r = g(this.g)).next(); !i.done; i = r.next())
                        (((i = i.value).matchedStreams = i.matchedStreams.filter(function (t) {
                          return t !== e;
                        })),
                          i.trickModeVideo &&
                            (i.trickModeVideo.matchedStreams = i.trickModeVideo.matchedStreams.filter(
                              function (t) {
                                return t !== e;
                              },
                            )),
                          i.dependencyStream &&
                            (i.dependencyStream.matchedStreams = i.dependencyStream.matchedStreams.filter(
                              function (t) {
                                return t !== e;
                              },
                            )));
                    else if (e.type == gt)
                      for (i = (r = g(this.j)).next(); !i.done; i = r.next())
                        (i = i.value).matchedStreams = i.matchedStreams.filter(function (t) {
                          return t !== e;
                        });
                    else if ("image" == e.type)
                      for (i = (r = g(this.i)).next(); !i.done; i = r.next())
                        (i = i.value).matchedStreams = i.matchedStreams.filter(function (t) {
                          return t !== e;
                        });
                    (e.segmentIndex && e.closeSegmentIndex(), this.m.delete(t));
                  }
                }),
                (n.lg = function (e, t, r) {
                  r = void 0 !== r && r;
                  var i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    m,
                    v,
                    y,
                    T,
                    E,
                    x,
                    w,
                    A,
                    I,
                    k,
                    R,
                    C,
                    L,
                    M,
                    _,
                    P,
                    O,
                    N,
                    F,
                    U,
                    B = this;
                  return D(function (D) {
                    if (1 == D.g) {
                      if (((i = mt), !t && 1 == e.length))
                        return (
                          (n = $m(e, !1)),
                          (a = n.Sh),
                          (s = n.mj),
                          (o = n.hj),
                          (l = n.pi),
                          (B.h = Array.from(a[0].values())),
                          (B.g = Array.from(s[0].values())),
                          (B.j = Array.from(o[0].values())),
                          (B.i = Array.from(l[0].values())),
                          D.A(2)
                        );
                      for (u = r ? B.m.size : 0, d = -1, h = 0; h < e.length; h++)
                        ((c = e[h]), B.m.has(c.id) || (B.m.add(c.id), -1 == d && (d = h)));
                      return -1 == d
                        ? D.return()
                        : ((f = $m(e, !0)),
                          (p = f.Sh),
                          (m = f.mj),
                          (v = f.hj),
                          (y = f.pi),
                          b(
                            D,
                            Promise.all([
                              Gm(B, B.h, p, d, Wm, qm, u),
                              Gm(B, B.g, m, d, Wm, qm, u),
                              Gm(B, B.j, v, d, Wm, qm, u),
                              Gm(B, B.i, y, d, Wm, qm, u),
                            ]),
                            2,
                          ));
                    }
                    if (((T = 0), (E = []), B.g.length && B.h.length))
                      for (C = g(B.h), L = C.next(); !L.done; L = C.next())
                        for (M = L.value, _ = g(B.g), P = _.next(); !P.done; P = _.next())
                          ((O = P.value),
                            (N = $e(M.drmInfos, O.drmInfos)),
                            (M.drmInfos.length && O.drmInfos.length && !N.length) ||
                              ((F = (M.bandwidth || 0) + (O.bandwidth || 0)),
                              M.dependencyStream && (F += M.dependencyStream.bandwidth || 0),
                              O.dependencyStream && (F += O.dependencyStream.bandwidth || 0),
                              (U = T++),
                              E.push({
                                id: U,
                                language: M.language,
                                disabledUntilTime: 0,
                                primary: M.primary,
                                audio: M,
                                video: O,
                                bandwidth: F,
                                drmInfos: N,
                                allowedByApplication: !0,
                                allowedByKeySystem: !0,
                                decodingInfos: [],
                              })));
                    else
                      for (x = B.g.length ? B.g : B.h, w = g(x), A = w.next(); !A.done; A = w.next())
                        ((I = A.value),
                          (k = T++),
                          (R = I.bandwidth || 0),
                          I.dependencyStream && (R += I.dependencyStream.bandwidth || 0),
                          E.push({
                            id: k,
                            language: I.language,
                            disabledUntilTime: 0,
                            primary: I.primary,
                            audio: I.type == i.aa ? I : null,
                            video: I.type == i.wa ? I : null,
                            bandwidth: R,
                            drmInfos: I.drmInfos,
                            allowedByApplication: !0,
                            allowedByKeySystem: !0,
                            decodingInfos: [],
                          }));
                    ((B.l = E), S(D));
                  });
                }),
                (n.Xi = function (e) {
                  this.o = e;
                }),
                j("shaka.util.PeriodCombiner", Bm),
                (Bm.prototype.setUseStreamOnce = Bm.prototype.Xi),
                (Bm.prototype.combinePeriods = Bm.prototype.lg),
                (Bm.prototype.deleteStream = Bm.prototype.Zh),
                (Bm.prototype.getImageStreams = Bm.prototype.Mj),
                (Bm.prototype.getTextStreams = Bm.prototype.Mg),
                (Bm.prototype.getVariants = Bm.prototype.fk));
              var yv = 1,
                Tv = 0,
                bv = -1,
                Sv = new Map();
              function Ev(e, t) {
                try {
                  return (function (e, t) {
                    var r = new DOMParser(),
                      i = xv.value()(e);
                    e = null;
                    try {
                      e = r.parseFromString(i, "text/xml");
                    } catch (n) {
                      return null;
                    }
                    if (
                      !(r = e.documentElement) ||
                      r.getElementsByTagName("parsererror").length ||
                      r.tagName != t
                    )
                      return null;
                    if (!("createNodeIterator" in document)) return r;
                    for (t = document.createNodeIterator(e, NodeFilter.SHOW_ALL); (e = t.nextNode()); )
                      if (e instanceof HTMLElement || e instanceof SVGElement) return null;
                    return r;
                  })(Qe(e), t);
                } catch (r) {
                  return null;
                }
              }
              var xv = new ae(function () {
                if ("undefined" != typeof trustedTypes) {
                  var e = trustedTypes.createPolicy("shaka-player#xml", {
                    createHTML: function (e) {
                      return e;
                    },
                  });
                  return function (t) {
                    return e.createHTML(t);
                  };
                }
                return function (e) {
                  return e;
                };
              });
              function wv() {
                var e = this;
                ((this.j = this.g = null),
                  (this.B = []),
                  (this.h = null),
                  (this.Fa = 1),
                  (this.H = []),
                  (this.l = { vf: "", type: "", profiles: [], uc: null, rb: 0, bb: null, qe: 0 }),
                  (this.u = new Map()),
                  (this.C = new Map()),
                  (this.o = new Map()),
                  (this.F = new Map()),
                  (this.za = new Map()),
                  (this.m = new Bm()),
                  (this.K = 0),
                  (this.Da = new G(5)),
                  (this.M = new Ri(function () {
                    e.J && !e.g.continueLoadingWhenPaused && (e.I.Ma(e.J, "timeupdate"), e.J.paused)
                      ? e.I.Aa(e.J, "timeupdate", function () {
                          return Nv(e);
                        })
                      : Nv(e);
                  })),
                  (this.R = new Un()),
                  (this.O = null),
                  (this.G = []),
                  (this.ba = 1 / 0),
                  (this.va = !1),
                  (this.i = null),
                  (this.N = 0),
                  (this.T = !1),
                  (this.I = new re()),
                  (this.J = null),
                  (this.V = !1),
                  (this.$ = ""),
                  (this.oa = function () {
                    return !1;
                  }),
                  (this.X = []),
                  (this.ma = new Set()),
                  (this.ya = new Zg()));
              }
              function Av(e) {
                var t, r, i, n, a, s, o, l, u, d, h;
                return D(function (c) {
                  return 1 == c.g
                    ? ((t = 4),
                      (r = "MPD"),
                      (i = (function (e) {
                        var t = e.l.qe;
                        if (!e.l.vf || !t || !e.H.length) return [];
                        var r = Date.now() / 1e3,
                          i = e.H.filter(function (e) {
                            return !(e = gr(e.attributes.ttl)) || t + e > r;
                          })
                            .map(rr)
                            .filter(Mi);
                        return i.length ? ut(e.B, i) : [];
                      })(e)),
                      (n = e.B),
                      i.length
                        ? ((n = i), (r = "Patch"), (t = 6))
                        : e.B.length > 1 && e.i && (a = Um(e.i, "Location", !0)).length && (n = a),
                      (s = Vn(n, e.g.retryParameters)),
                      (o = Date.now()),
                      b(c, Vv(e, s, 0, { type: t }), 2))
                    : 3 != c.g
                      ? ((l = c.h),
                        e.j
                          ? (l.uri && l.uri != l.originalUri && !e.B.includes(l.uri) && e.B.unshift(l.uri),
                            (u = new me(l.uri)),
                            (e.$ = u.g.toString()),
                            b(
                              c,
                              (function (e, t, r, i) {
                                var n, a, s, o, l, u, d, h;
                                return D(function (c) {
                                  if (1 == c.g) {
                                    if (((n = t), (a = e.g.dash.manifestPreprocessor) != nd)) {
                                      if (
                                        (he(
                                          "manifest.dash.manifestPreprocessor configuration",
                                          "Please Use manifest.dash.manifestPreprocessorTXml instead.",
                                        ),
                                        !(s = Ev(n, i)))
                                      )
                                        throw new ze(2, 4, 4001, r);
                                      (a(s), (n = Je(s.outerHTML)));
                                    }
                                    if (!(o = Xt(n, i))) throw new ze(2, 4, 4001, r);
                                    return (
                                      (l = e.g.dash.manifestPreprocessorTXml) != ad && l(o),
                                      "Patch" === i
                                        ? c.return(
                                            (function (e, t) {
                                              var r,
                                                i,
                                                n,
                                                a,
                                                s,
                                                o,
                                                l,
                                                u,
                                                d,
                                                h,
                                                c,
                                                f,
                                                p,
                                                v,
                                                y,
                                                T,
                                                E,
                                                x,
                                                w,
                                                A,
                                                I,
                                                k,
                                                R,
                                                C;
                                              return D(function (L) {
                                                if (1 == L.g) {
                                                  if (
                                                    ((r = t.attributes.mpdId),
                                                    (i = sr(t, "originalPublishTime", dr)),
                                                    !r || r !== e.l.vf || i !== e.l.qe)
                                                  )
                                                    throw ((e.H = []), new ze(1, 4, 4052));
                                                  for (
                                                    n = [], a = [], s = new Set(), o = g(Zt(t)), l = o.next();
                                                    !l.done;
                                                    l = o.next()
                                                  )
                                                    if (
                                                      ((u = l.value),
                                                      (d = Tr(u.attributes.sel || "")),
                                                      (h = d[d.length - 1]),
                                                      (c = rr(u) || ""),
                                                      "MPD" === h.name)
                                                    )
                                                      if ("mediaPresentationDuration" === h.Dc) {
                                                        var M = hr(rr(u) || "");
                                                        if (null != M) {
                                                          e.l.uc = M;
                                                          for (
                                                            var D = g(e.u.values()), _ = D.next();
                                                            !_.done;
                                                            _ = D.next()
                                                          )
                                                            _.value.uc = M;
                                                        }
                                                      } else if ("type" === h.Dc) {
                                                        for (
                                                          e.h.presentationTimeline.cd("static" == c),
                                                            e.l.type = c,
                                                            D = (M = g(e.u.values())).next();
                                                          !D.done;
                                                          D = M.next()
                                                        )
                                                          D.value.Eb = "dynamic" == c;
                                                        "static" == c && (e.K = -1);
                                                      } else
                                                        "publishTime" === h.Dc
                                                          ? (e.l.qe = dr(c) || 0)
                                                          : null === h.Dc && "add" === u.tagName && a.push(u);
                                                    else if ("PatchLocation" === h.name) br(e.H, u);
                                                    else if ("Period" === h.name)
                                                      "add" === u.tagName
                                                        ? a.push(u)
                                                        : "remove" === u.tagName && h.id && Rv(e, h.id);
                                                    else if ("SegmentTemplate" === h.name) {
                                                      if (
                                                        (M = (D = Tr(u.attributes.sel || ""))[D.length - 1])
                                                          .Dc
                                                      ) {
                                                        ((D = Cv(e, D)), (_ = rr(u) || ""));
                                                        for (
                                                          var P = g(D), O = P.next();
                                                          !O.done;
                                                          O = P.next()
                                                        )
                                                          Er((O = e.u.get(O.value)).L.Oc, u.tagName, M.Dc, _);
                                                        M = D;
                                                      } else M = [];
                                                      for (f = g(M), p = f.next(); !p.done; p = f.next())
                                                        ((v = p.value), s.add(v));
                                                    } else if (
                                                      "SegmentTimeline" === h.name ||
                                                      "S" === h.name
                                                    ) {
                                                      for (
                                                        M = Tr(u.attributes.sel || ""),
                                                          _ = (D = g((M = Cv(e, M)))).next();
                                                        !_.done;
                                                        _ = D.next()
                                                      )
                                                        (br(
                                                          (P = er(
                                                            (_ = lm(
                                                              (_ = e.u.get(_.value)),
                                                              Cm,
                                                              "SegmentTimeline",
                                                            )),
                                                            "S",
                                                          )),
                                                          u,
                                                        ),
                                                          (_.children = P));
                                                      for (y = g(M), T = y.next(); !T.done; T = y.next())
                                                        ((E = T.value), s.add(E));
                                                    }
                                                  for (x = g(s), w = x.next(); !w.done; w = x.next())
                                                    ((A = w.value), Lv(e, A));
                                                  for (I = g(a), k = I.next(); !k.done; k = I.next())
                                                    ((R = k.value),
                                                      n.push.apply(
                                                        n,
                                                        m(
                                                          Mv(
                                                            e,
                                                            {
                                                              Eb: "dynamic" == e.l.type,
                                                              presentationTimeline: e.h.presentationTimeline,
                                                              sa: null,
                                                              na: null,
                                                              qa: null,
                                                              L: null,
                                                              bandwidth: 0,
                                                              Og: !1,
                                                              rb: e.l.rb,
                                                              profiles: e.l.profiles,
                                                              uc: e.l.uc,
                                                              roles: null,
                                                              Lb: Hv,
                                                            },
                                                            e.l.bb,
                                                            R,
                                                            !0,
                                                          ).periods,
                                                        ),
                                                      ));
                                                  return n.length
                                                    ? ((e.h.periodCount += n.length),
                                                      (e.h.gapCount = e.N),
                                                      b(L, kv(e, n, !0), 2))
                                                    : L.A(2);
                                                }
                                                ("static" == e.l.type &&
                                                  ((C = e.l.uc), e.h.presentationTimeline.Ab(C || 1 / 0)),
                                                  S(L));
                                              });
                                            })(e, o),
                                          )
                                        : e.g.dash.disableXlinkProcessing
                                          ? c.return(Iv(e, o, r))
                                          : ((u = e.g.dash.xlinkFailGracefully),
                                            (d = um(o, e.g.retryParameters, u, r, e.j.networkingEngine)),
                                            Bn(e.R, d),
                                            b(c, d.promise, 2))
                                    );
                                  }
                                  return ((h = c.h), c.return(Iv(e, h, r)));
                                });
                              })(e, l.data, l.uri, r),
                              3,
                            ))
                          : c.return(0))
                      : ((d = Date.now()), (h = (d - o) / 1e3), e.Da.sample(1, h), e.ma.clear(), c.return(h));
                });
              }
              function Iv(e, t, r) {
                var i,
                  n,
                  a,
                  s,
                  o,
                  l,
                  u,
                  d,
                  h,
                  c,
                  f,
                  p,
                  v,
                  y,
                  T,
                  x,
                  I,
                  k,
                  R,
                  C,
                  L,
                  M,
                  _,
                  P,
                  O,
                  N,
                  F,
                  U,
                  B,
                  $,
                  j,
                  G,
                  V,
                  H,
                  K,
                  W,
                  q,
                  X,
                  Y,
                  Q,
                  J,
                  Z,
                  ee,
                  te,
                  re,
                  ie,
                  ne,
                  ae,
                  se,
                  oe,
                  le,
                  ue,
                  de,
                  he;
                return D(function (ce) {
                  switch (ce.g) {
                    case 1:
                      for (
                        e.i && e.i.l.clear(),
                          i = [r],
                          n = [],
                          a = new Map(),
                          s = er(t, "Location"),
                          o = g(s),
                          l = o.next();
                        !l.done;
                        l = o.next()
                      )
                        ((u = l.value),
                          (d = u.attributes.serviceLocation),
                          (h = rr(u)) &&
                            ((c = ut(i, [h])[0]),
                            d && (e.i ? Fm(e.i, "Location", d, c) : a.set(d, c)),
                            n.push(c)));
                      if (
                        (e.i
                          ? (f = Um(e.i, "Location", !0)).length > 0 && (i = e.B = f)
                          : n.length && (i = e.B = n),
                        (e.l.vf = t.attributes.id || ""),
                        (e.l.qe = sr(t, "publishTime", dr) || 0),
                        (e.H = er(t, "PatchLocation")),
                        (p = Promise.resolve()),
                        (v = nr(t, "ContentSteering")) && e.j)
                      )
                        for (
                          y = v.attributes.defaultServiceLocation,
                            e.i
                              ? ((e.i.i = i), (e.i.h = y))
                              : ((e.i = new Pm(e.j)),
                                e.i.configure(e.g),
                                e.i.setManifestType("DASH"),
                                (e.i.i = i),
                                (e.i.h = y),
                                (T = rr(v)) &&
                                  (sr(v, "queryBeforeStart", vr, !1) ? (p = Om(e.i, T)) : Om(e.i, T))),
                            x = g(a.keys()),
                            I = x.next();
                          !I.done;
                          I = x.next()
                        )
                          ((k = I.value), (R = a.get(k)), Fm(e.i, "Location", k, R));
                      if (((C = er(t, "BaseURL")), (L = !1), e.i))
                        for (M = g(C), _ = M.next(); !_.done; _ = M.next())
                          ((P = _.value),
                            (O = P.attributes.serviceLocation),
                            (N = rr(P)),
                            O && N && (Fm(e.i, "BaseURL", O, N), (L = !0)));
                      if (
                        (e.X.splice(0),
                        (L && e.i) || ((F = C.map(rr)), e.X.push.apply(e.X, m(ut(i, F)))),
                        (U = e.i),
                        (B = e.X),
                        ($ = Kv.call(wv, U, L, B)),
                        (e.l.bb = $),
                        (j = 0),
                        C && C.length && (j = sr(C[0], "availabilityTimeOffset", mr) || 0),
                        (e.l.rb = j),
                        (e.K = sr(t, "minimumUpdatePeriod", hr, -1)),
                        (G = sr(t, "availabilityStartTime", dr)),
                        (V = sr(t, "timeShiftBufferDepth", hr)),
                        (H = e.g.dash.ignoreSuggestedPresentationDelay),
                        (K = null),
                        H || (K = sr(t, "suggestedPresentationDelay", hr)),
                        (W = e.g.dash.ignoreMaxSegmentDuration),
                        (q = null),
                        W || (q = sr(t, "maxSegmentDuration", hr)),
                        (X = t.attributes.type || "static"),
                        e.h &&
                          e.h.presentationTimeline &&
                          (e.V = e.h.presentationTimeline.W() && "static" == X),
                        (e.l.type = X),
                        e.h)
                      )
                        for (
                          Y = e.h.presentationTimeline, Q = Y.Hb(), J = g(e.o.values()), Z = J.next();
                          !Z.done;
                          Z = J.next()
                        )
                          (ee = Z.value).segmentIndex && ee.segmentIndex.Ya(Q);
                      else
                        ((te = e.g.dash.ignoreMinBufferTime),
                          (re = 0),
                          te || (re = sr(t, "minBufferTime", hr) || 0),
                          (ie =
                            null != K
                              ? Math.min(K, V || 1 / 0)
                              : e.g.defaultPresentationDelay > 0
                                ? e.g.defaultPresentationDelay
                                : Math.min(1.5 * re, V || 1 / 0)),
                          (Y = new ll(G, ie, e.g.dash.autoCorrectDrift)));
                      return (
                        Y.cd("static" == X),
                        Y.W() &&
                          !isNaN(e.g.availabilityWindowOverride) &&
                          (V = e.g.availabilityWindowOverride),
                        null == V && (V = 1 / 0),
                        Y.Lf(V),
                        (ne = t.attributes.profiles || ""),
                        (e.l.profiles = ne.split(",")),
                        (ae = {
                          Eb: "static" != X,
                          presentationTimeline: Y,
                          sa: null,
                          na: null,
                          qa: null,
                          L: null,
                          bandwidth: 0,
                          Og: !1,
                          rb: j,
                          uc: null,
                          profiles: ne.split(","),
                          roles: null,
                          Lb: Hv,
                        }),
                        b(ce, p, 2)
                      );
                    case 2:
                      return (
                        (e.N = 0),
                        (se = Mv(e, ae, $, t, !1)),
                        (oe = se.duration),
                        (le = se.periods),
                        (("static" != X || e.V) && se.ai) || Y.Ab(oe || 1 / 0),
                        e.T && e.va && Y.Ui(e.ba),
                        Y.Wg(q || 1),
                        e.T && e.va && ((ue = null != K ? K : e.g.defaultPresentationDelay), Y.rh(ue)),
                        e.h
                          ? ((e.h.periodCount = le.length), (e.h.gapCount = e.N), b(ce, kv(e, le, !1), 4))
                          : b(ce, e.m.lg(le, ae.Eb), 6)
                      );
                    case 6:
                      var fe = Y,
                        pe = e.m.l,
                        ge = e.m.Mg(),
                        me = e.m.i,
                        ve = e.g.dash.sequenceMode,
                        ye = nr(t, "ServiceDescription");
                      if (ye) {
                        var Te = nr(ye, "Latency");
                        if (((ye = nr(ye, "PlaybackRate")), Te || ye)) {
                          var be = {};
                          (Te &&
                            ("target" in Te.attributes &&
                              (be.targetLatency = parseInt(Te.attributes.target, 10) / 1e3),
                            "max" in Te.attributes && (be.maxLatency = parseInt(Te.attributes.max, 10) / 1e3),
                            "min" in Te.attributes &&
                              (be.minLatency = parseInt(Te.attributes.min, 10) / 1e3)),
                            ye &&
                              ("max" in ye.attributes && (be.maxPlaybackRate = parseFloat(ye.attributes.max)),
                              "min" in ye.attributes && (be.minPlaybackRate = parseFloat(ye.attributes.min))),
                            (Te = be));
                        } else Te = null;
                      } else Te = null;
                      e: {
                        if ((ye = er(t, "SupplementalProperty")).length)
                          for (be = (ye = g(ye)).next(); !be.done; be = ye.next())
                            if ("urn:mpeg:dash:chaining:2016" == (be = be.value).attributes.schemeIdUri) {
                              ye = be.attributes.value;
                              break e;
                            }
                        ye = null;
                      }
                      if (
                        ((e.h = {
                          presentationTimeline: fe,
                          variants: pe,
                          textStreams: ge,
                          imageStreams: me,
                          offlineSessionIds: [],
                          sequenceMode: ve,
                          ignoreManifestTimestampsInSegmentsMode: !1,
                          type: "DASH",
                          serviceDescription: Te,
                          nextUrl: ye,
                          periodCount: le.length,
                          gapCount: e.N,
                          isLowLatency: e.T,
                          startTime: null,
                        }),
                        !Y.kj())
                      ) {
                        ce.A(7);
                        break;
                      }
                      return (
                        (de = er(t, "UTCTiming")),
                        b(
                          ce,
                          (function (e, t, r) {
                            var i, n, a, s, o, l, u, d;
                            return D(function (h) {
                              switch (h.g) {
                                case 1:
                                  ((i = r.map(function (e) {
                                    return { scheme: e.attributes.schemeIdUri, value: e.attributes.value };
                                  })),
                                    (n = e.g.dash.clockSyncUri),
                                    !i.length &&
                                      n &&
                                      i.push({ scheme: "urn:mpeg:dash:utc:http-head:2014", value: n }),
                                    (a = g(i)),
                                    (s = a.next()));
                                case 2:
                                  if (s.done) {
                                    h.A(4);
                                    break;
                                  }
                                  switch (((o = s.value), E(h, 5), (l = o.scheme), (u = o.value), l)) {
                                    case "urn:mpeg:dash:utc:http-head:2014":
                                    case "urn:mpeg:dash:utc:http-head:2012":
                                      return h.A(7);
                                    case "urn:mpeg:dash:utc:http-xsdate:2014":
                                    case "urn:mpeg:dash:utc:http-iso:2014":
                                    case "urn:mpeg:dash:utc:http-xsdate:2012":
                                    case "urn:mpeg:dash:utc:http-iso:2012":
                                      return h.A(8);
                                    case "urn:mpeg:dash:utc:direct:2014":
                                    case "urn:mpeg:dash:utc:direct:2012":
                                      return ((d = Date.parse(u)), h.return(isNaN(d) ? 0 : d - Date.now()));
                                    case "urn:mpeg:dash:utc:http-ntp:2014":
                                    case "urn:mpeg:dash:utc:ntp:2014":
                                    case "urn:mpeg:dash:utc:sntp:2014":
                                      z("NTP UTCTiming scheme is not supported");
                                      break;
                                    default:
                                      z("Unrecognized scheme in UTCTiming element", l);
                                  }
                                  h.A(9);
                                  break;
                                case 7:
                                  return b(h, Bv(e, t, u, "HEAD"), 10);
                                case 10:
                                  return h.return(h.h);
                                case 8:
                                  return b(h, Bv(e, t, u, "GET"), 11);
                                case 11:
                                  return h.return(h.h);
                                case 9:
                                  w(h, 3);
                                  break;
                                case 5:
                                  A(h);
                                case 3:
                                  ((s = a.next()), h.A(2));
                                  break;
                                case 4:
                                  return (
                                    z(
                                      "A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!",
                                    ),
                                    h.return(0)
                                  );
                              }
                            });
                          })(e, $, de),
                          8,
                        )
                      );
                    case 8:
                      if (((he = ce.h), !e.j)) return ce.return();
                      Y.Vi(he);
                    case 7:
                      (Y.qf(), e.m && !e.h.presentationTimeline.W() && e.m.release());
                    case 4:
                      (e.j.makeTextStreamsForClosedCaptions(e.h),
                        (function (e) {
                          for (
                            var t = Array.from(e.F.keys()).filter(function (t) {
                                return !e.G.includes(t);
                              }),
                              r = (t = g(t)).next();
                            !r.done;
                            r = t.next()
                          ) {
                            r = r.value;
                            for (var i = !0, n = g(e.F.get(r)), a = n.next(); !a.done; a = n.next()) {
                              a = a.value;
                              var s = e.o.get(a);
                              s &&
                                (s.segmentIndex && 0 != s.segmentIndex.getNumReferences()
                                  ? (i = !1)
                                  : (e.m && e.m.Zh(s, r), e.o.delete(a)));
                            }
                            i && e.F.delete(r);
                          }
                        })(e),
                        (function (e, t) {
                          t = new Set(
                            t.map(function (e) {
                              return e.id;
                            }),
                          );
                          for (var r = g(e.C.keys()), i = r.next(); !i.done; i = r.next())
                            ((i = i.value), t.has(i) || e.C.delete(i));
                        })(e, le),
                        S(ce));
                  }
                });
              }
              function kv(e, t, r) {
                var i;
                return D(function (n) {
                  if (1 == n.g) return b(n, e.m.lg(t, !0, r), 2);
                  ((e.h.variants = e.m.l),
                    (i = e.m.Mg()).length > 0 && (e.h.textStreams = i),
                    (e.h.imageStreams = e.m.i),
                    e.j.filter(e.h),
                    S(n));
                });
              }
              function Rv(e, t) {
                e.h.periodCount--;
                for (var r = g(e.u.keys()), i = r.next(); !i.done; i = r.next())
                  (i = i.value).startsWith(t) &&
                    ((lm(e.u.get(i), Cm, "SegmentTimeline").children = []), Lv(e, i), e.u.delete(i));
                e.G = e.G.filter(function (e) {
                  return e !== t;
                });
              }
              function Cv(e, t) {
                for (var r = "", i = "", n = -1, a = "", s = (t = g(t)).next(); !s.done; s = t.next())
                  "Period" === (s = s.value).name
                    ? (r = s.id)
                    : "AdaptationSet" === s.name
                      ? ((i = s.id), null !== s.position && (n = s.position))
                      : "Representation" === s.name && (a = s.id);
                if (((t = []), a)) t.push(r + "," + a);
                else if (i)
                  for (n = g(e.u.values()), e = n.next(); !e.done; e = n.next())
                    (e = e.value).sa.id === r && e.qa.id === i && e.L.id && t.push(r + "," + e.L.id);
                else if (n > -1)
                  for (i = g(e.u.values()), e = i.next(); !e.done; e = i.next())
                    (e = e.value).sa.id === r && e.qa.position === n && e.L.id && t.push(r + "," + e.L.id);
                return t;
              }
              function Lv(e, t) {
                var r = e.u.get(t),
                  i = e.o.get(t);
                i.segmentIndex && i.segmentIndex.Ya(e.h.presentationTimeline.Hb());
                try {
                  var n = Rm(
                    r,
                    function (t, r, i, n) {
                      return jv(e, t, r, i, n);
                    },
                    e.o,
                    !0,
                    e.g.dash.initialSegmentLimit,
                    e.za,
                    r.L.aesKey,
                    null,
                    !0,
                    e.C,
                  );
                  i.createSegmentIndex = function () {
                    return D(function (e) {
                      if (1 == e.g) return i.segmentIndex ? e.A(0) : b(e, n.Sc(), 3);
                      ((i.segmentIndex = e.h), S(e));
                    });
                  };
                } catch (a) {
                  if (((t = r.L.contentType) != gt && "application" != t && "image" != t) || 4002 != a.code)
                    throw a;
                }
              }
              function Mv(e, t, r, i, n) {
                var a = t.uc;
                a || ((a = sr(i, "mediaPresentationDuration", hr)), (e.l.uc = a));
                var s = 0;
                e.h && e.h.presentationTimeline && e.V && (s = e.h.presentationTimeline.Zb());
                var o = [],
                  l = s;
                i = er(i, "Period");
                for (var u = 0; u < i.length; u++) {
                  var d = i[u],
                    h = i[u + 1],
                    c = sr(d, "start", hr, l),
                    f = d.attributes.id,
                    p = sr(d, "duration", hr);
                  c = 0 == u && 0 == c && e.V ? s : c;
                  var m = null;
                  if (h) {
                    var v = sr(h, "start", hr);
                    null != v && (m = v - c + s);
                  } else null != a && (m = a - c + s);
                  if (
                    ((v = vt),
                    m && p && Math.abs(m - p) > v && m > p && e.N++,
                    null == m && (m = p),
                    !(null !== e.O && null !== f && null !== c && c < e.O) ||
                      e.G.includes(f) ||
                      u + 1 == i.length)
                  ) {
                    if (
                      (null !== c && (null === e.O || c > e.O) && (e.O = c),
                      (l = Dv(e, t, r, { start: c, duration: m, node: d, kf: null == m || !h })),
                      o.push(l),
                      t.sa.id && m && e.za.set(t.sa.id, m),
                      null == m)
                    ) {
                      l = null;
                      break;
                    }
                    l = c + m;
                  }
                }
                if (n)
                  for (r = (t = g(o)).next(); !r.done; r = t.next())
                    ((r = r.value.id), e.G.includes(r) || e.G.push(r));
                else
                  e.G = o.map(function (e) {
                    return e.id;
                  });
                return null != a
                  ? { periods: o, duration: a + s, ai: !1 }
                  : { periods: o, duration: l, ai: !0 };
              }
              function Dv(e, t, r, i) {
                ((t.sa = Uv(e, i.node, null, r)),
                  (t.na = i),
                  (t.sa.rb = t.rb),
                  t.sa.id || (t.sa.id = "__shaka_period_" + i.start));
                var n = er(i.node, "EventStream");
                r = t.presentationTimeline.Hb();
                for (var a = (n = g(n)).next(); !a.done; a = n.next()) $v(e, i.start, i.duration, a.value, r);
                for (n = (r = g((r = er(i.node, "SupplementalProperty")))).next(); !n.done; n = r.next())
                  "urn:mpeg:dash:urlparam:2014" == (n = n.value).attributes.schemeIdUri &&
                    (n = Ov(e, n)) &&
                    (t.Lb = n);
                if (
                  ((r = er(i.node, "AdaptationSet")
                    .map(function (r, i) {
                      return Pv(e, t, i, r);
                    })
                    .filter(Mi)),
                  t.Eb)
                ) {
                  n = [];
                  for (var s = (a = g(r)).next(); !s.done; s = a.next())
                    for (var o = (s = g(s.value.Rk)).next(); !o.done; o = s.next()) n.push(o.value);
                  if (n.length != new Set(n).size) throw new ze(2, 4, 4018);
                }
                for (n = new Map(), s = (a = g(r)).next(); !s.done; s = a.next())
                  for (o = (s = g(s.value.Aj)).next(); !o.done; o = s.next()) {
                    var l = g(o.value);
                    ((o = l.next().value), (l = l.next().value), n.set(o, l));
                  }
                if (n.size)
                  for (a = null, o = (s = g(r)).next(); !o.done; o = s.next()) {
                    l = [];
                    for (
                      var u = g((o = o.value).streams), d = u.next(), h = {};
                      !d.done;
                      h = { Ah: void 0 }, d = u.next()
                    )
                      if (((h.Ah = d.value), n.has(h.Ah.originalId))) {
                        a ||
                          (a = er(i.node, "AdaptationSet")
                            .map(function (r, i) {
                              return Pv(e, t, i, r);
                            })
                            .filter(Mi));
                        for (var c = (d = g(a)).next(); !c.done; c = d.next())
                          (c = c.value.streams.find(
                            (function (e) {
                              return function (t) {
                                return t.originalId == e.Ah.originalId;
                              };
                            })(h),
                          )) &&
                            ((c.dependencyStream = n.get(c.originalId)),
                            (c.originalId += c.dependencyStream.originalId),
                            l.push(c));
                      }
                    l.length && o.streams.push.apply(o.streams, m(l));
                  }
                if (
                  ((i = r.filter(function (e) {
                    return !e.Hh;
                  })),
                  (r = r.filter(function (e) {
                    return e.Hh;
                  })),
                  !e.g.disableIFrames)
                )
                  for (n = (r = g(r)).next(); !n.done; n = r.next())
                    for (a = (n = n.value).Hh.split(" "), o = (s = g(i)).next(); !o.done; o = s.next())
                      if (((o = o.value), a.includes(o.id)))
                        for (l = (o = g(o.streams)).next(); !l.done; l = o.next()) cn(l.value, n.streams);
                if (
                  ((r = _v(e.g.disableAudio, i, "audio")),
                  (n = _v(e.g.disableVideo, i, "video")),
                  (a = _v(e.g.disableText, i, gt)),
                  (i = _v(e.g.disableThumbnails, i, "image")),
                  0 === n.length && 0 === r.length)
                )
                  throw new ze(2, 4, 4004);
                return { id: t.sa.id, audioStreams: r, videoStreams: n, textStreams: a, imageStreams: i };
              }
              function _v(e, t, r) {
                return e || !t.length
                  ? []
                  : t.reduce(function (e, t) {
                      return (t.contentType != r || e.push.apply(e, m(t.streams)), e);
                    }, []);
              }
              function Pv(t, r, i, n) {
                function a(e) {
                  var i = e.attributes["dvb:fontFamily"];
                  ((e = e.attributes["dvb:url"]),
                    i && e && ((e = ut(r.qa.bb(), [e], r.Lb())), t.j.addFont(i, e[0])));
                }
                function s(e) {
                  switch (e) {
                    case 1:
                    case 5:
                    case 6:
                    case 7:
                      return "srgb";
                    case 9:
                      return "rec2020";
                    case 11:
                    case 12:
                      return "p3";
                  }
                }
                function o(e) {
                  switch (e) {
                    case 1:
                    case 6:
                    case 13:
                    case 14:
                    case 15:
                      return "SDR";
                    case 16:
                      return "PQ";
                    case 18:
                      return "HLG";
                  }
                }
                ((r.qa = Uv(t, n, r.sa, null)), (r.qa.position = i));
                var l = !1,
                  u = (i = er(n, "Role"))
                    .map(function (e) {
                      return e.attributes.value;
                    })
                    .filter(Mi),
                  d = void 0,
                  h = r.qa.contentType == gt;
                h && (d = "subtitle");
                for (var c = (i = g(i)).next(); !c.done; c = i.next()) {
                  var f = (c = c.value).attributes.schemeIdUri;
                  if (null == f || "urn:mpeg:dash:role:2011" == f)
                    switch (((c = c.attributes.value), c)) {
                      case "main":
                        l = !0;
                        break;
                      case "caption":
                      case "subtitle":
                        d = c;
                    }
                }
                var p = er(n, "EssentialProperty");
                i = null;
                var v = !1;
                ((c = null), (f = !1));
                for (var y = (p = g(p)).next(); !y.done; y = p.next()) {
                  var T = (y = y.value).attributes.schemeIdUri;
                  if ("http://dashif.org/guidelines/trickmode" == T) i = y.attributes.value;
                  else if ("urn:mpeg:mpegB:cicp:TransferCharacteristics" == T)
                    var E = o(parseInt(y.attributes.value, 10));
                  else if ("urn:mpeg:mpegB:cicp:ColourPrimaries" == T)
                    var x = s(parseInt(y.attributes.value, 10));
                  else
                    "urn:mpeg:mpegB:cicp:MatrixCoefficients" != T &&
                      ("urn:mpeg:dash:ssr:2023" == T && t.g.dash.enableFastSwitching
                        ? (v = !0)
                        : "urn:dvb:dash:fontdownload:2014" == T
                          ? a(y)
                          : ("urn:mpeg:dash:urlparam:2014" == T && (c = Ov(t, y))) || (f = !0));
                }
                if (f) return null;
                var w = null;
                for (p = (f = g((f = er(n, "SupplementalProperty")))).next(); !p.done; p = f.next())
                  "http://dashif.org/guidelines/last-segment-number" ==
                  (y = (p = p.value).attributes.schemeIdUri)
                    ? (w = parseInt(p.attributes.value, 10) - 1)
                    : "urn:mpeg:mpegB:cicp:TransferCharacteristics" == y
                      ? (E = o(parseInt(p.attributes.value, 10)))
                      : "urn:mpeg:mpegB:cicp:ColourPrimaries" == y
                        ? (x = s(parseInt(p.attributes.value, 10)))
                        : "urn:dvb:dash:fontdownload:2014" == y
                          ? a(p)
                          : "urn:mpeg:dash:urlparam:2014" == y && (c = Ov(t, p));
                (c && (r.Lb = c), (c = er(n, "Accessibility")));
                var A,
                  I = new Map();
                for (f = (c = g(c)).next(); !f.done; f = c.next())
                  if (
                    ((f = (p = f.value).attributes.schemeIdUri),
                    (p = p.attributes.value),
                    "urn:scte:dash:cc:cea-608:2015" != f || t.g.disableText)
                  )
                    if ("urn:scte:dash:cc:cea-708:2015" != f || t.g.disableText)
                      "urn:mpeg:dash:role:2011" == f
                        ? null != p && (u.push(p), "captions" == p && (d = "caption"))
                        : "urn:tva:metadata:cs:AudioPurposeCS:2007" == f &&
                          ("1" == p
                            ? (A = "visually impaired")
                            : "2" == p
                              ? (A = "hard of hearing")
                              : "9" == p && (A = "spoken subtitles"));
                    else if (((f = 1), null != p))
                      for (y = (p = g(p.split(";"))).next(); !y.done; y = p.next()) {
                        T = y.value;
                        var k = (y = void 0);
                        (T.includes("=")
                          ? ((y = "svc" + (T = T.split("="))[0]), (k = T[1].split(",")[0].split(":").pop()))
                          : ((y = "svc" + f), f++, (k = T)),
                          I.set(y, Fi(k)));
                      }
                    else I.set("svc1", "und");
                  else if (((f = 1), null != p))
                    for (T = (y = g((p = p.split(";")))).next(); !T.done; T = y.next()) {
                      k = T.value;
                      var R = (T = void 0);
                      (k.includes("=")
                        ? ((T = (k = k.split("="))[0].startsWith("CC") ? k[0] : "CC" + k[0]),
                          (R = k[1] || "und"))
                        : ((T = "CC" + f), 2 == p.length ? (f += 2) : f++, (R = k)),
                        I.set(T, Fi(R)));
                    }
                  else I.set("CC1", "und");
                c = er(n, "ContentProtection");
                var C = em(t.ya, c, t.g.ignoreDrmInfo, t.g.dash.keySystemsByURI);
                r.qa.encrypted = c.length > 0;
                var L = Fi(r.qa.language || "und"),
                  M = r.qa.label,
                  _ = new Map();
                if (((n = er(n, "Representation")), !t.g.ignoreSupplementalCodecs)) {
                  for (c = [], p = (f = g(n)).next(); !p.done; p = f.next())
                    (p = or((y = p.value), "urn:scte:dash:scte214-extensions", "supplementalCodecs")) &&
                      (((y = Wt(y)).attributes.codecs = p.split(" ").join(",")),
                      y.attributes.id &&
                        (y.attributes.supplementalId = y.attributes.id + "_supplementalCodecs"),
                      c.push(y));
                  n.push.apply(n, m(c));
                }
                if (
                  ((c = n
                    .map(function (i) {
                      var n = (function (t, r, i, n, a, s, o, l, u, d, h, c) {
                        r.L = Uv(t, d, r.qa, null);
                        var f = r.L.id;
                        if (
                          ((t.ba = Math.min(t.ba, r.L.rb)),
                          (t.T = t.ba > 0),
                          !(function (e) {
                            var t = e.Id ? 1 : 0;
                            return (
                              (t += e.Ac ? 1 : 0),
                              0 == (t += e.Oc ? 1 : 0)
                                ? e.contentType == gt || "application" == e.contentType
                                : (1 != t && (e.Id && (e.Ac = null), (e.Oc = null)), !0)
                            );
                          })(r.L))
                        )
                          return null;
                        var p = r.na.start;
                        ((r.bandwidth = sr(d, "bandwidth", pr) || 0), (r.roles = l));
                        var g = er(d, "SupplementalProperty"),
                          m = er(d, "EssentialProperty"),
                          v = er(d, "ContentProtection");
                        d = null;
                        var y,
                          T,
                          E = m.find(function (e) {
                            return "urn:mpeg:dash:urlparam:2014" == e.attributes.schemeIdUri;
                          });
                        ((E ||
                          (E = g.find(function (e) {
                            return "urn:mpeg:dash:urlparam:2014" == e.attributes.schemeIdUri;
                          }))) &&
                          (d = Ov(t, E)),
                          d && (r.Lb = d),
                          (E = r.L.contentType),
                          (d = E == gt || "application" == E),
                          (E = "image" == E),
                          v.length && (r.qa.encrypted = !0));
                        try {
                          var x = void 0;
                          if (i.hg) {
                            var w = r.L.bb,
                              A = r.Lb,
                              I = Vn(ut(w(), [i.hg.wk], A()), t.g.retryParameters);
                            x = {
                              bitsKey: 128,
                              blockCipherMode: "CBC",
                              iv: i.hg.iv,
                              firstMediaSequenceNumber: 0,
                              fetchKey: function () {
                                var r, i, n;
                                return D(function (a) {
                                  if (1 == a.g) return b(a, Vv(t, I, 6), 2);
                                  if (3 != a.g) {
                                    if (!(r = a.h).data || 16 != r.data.byteLength) throw new ze(2, 4, 4049);
                                    return (
                                      (i = { name: "AES-CBC" }),
                                      (n = x),
                                      b(a, e.crypto.subtle.importKey("raw", r.data, i, !0, ["decrypt"]), 3)
                                    );
                                  }
                                  ((n.cryptoKey = a.h), (x.fetchKey = void 0), S(a));
                                });
                              },
                            };
                          }
                          if (
                            ((r.L.aesKey = x),
                            (w = function (e, r, i, n) {
                              return jv(t, e, r, i, n);
                            }),
                            r.L.Id)
                          )
                            var k = bm(r, w, x);
                          else if (r.L.Ac) k = Im(r, t.o, x);
                          else if (r.L.Oc)
                            k = Rm(r, w, t.o, !!t.h, t.g.dash.initialSegmentLimit, t.za, x, c, !1, t.C);
                          else {
                            var R = r.na.duration || 0,
                              C = r.L.bb,
                              L = r.L.mimeType,
                              M = r.L.codecs;
                            k = {
                              endTime: -1,
                              timeline: -1,
                              Sc: function () {
                                var e = _l(p, R, C());
                                return (
                                  e.Fb(function (e) {
                                    ((e.mimeType = L), (e.codecs = M));
                                  }),
                                  Promise.resolve(e)
                                );
                              },
                              timescale: 1,
                            };
                          }
                        } catch (P) {
                          if ((d || E) && 4002 == P.code) return null;
                          throw P;
                        }
                        if (
                          ((c = (function (e, t, r, i, n) {
                            var a = em(e, t, i, n);
                            if (r.ci)
                              ((e = 1 == r.drmInfos.length && !r.drmInfos[0].keySystem),
                                (t = 0 == a.drmInfos.length),
                                (0 == r.drmInfos.length || (e && !t)) && (r.drmInfos = a.drmInfos),
                                (r.ci = !1));
                            else if (
                              a.drmInfos.length > 0 &&
                              ((r.drmInfos = r.drmInfos.filter(function (e) {
                                return a.drmInfos.some(function (t) {
                                  return t.keySystem == e.keySystem;
                                });
                              })),
                              0 == r.drmInfos.length)
                            )
                              throw new ze(2, 4, 4008);
                            return a.Yh || r.Yh;
                          })(t.ya, v, i, t.g.ignoreDrmInfo, t.g.dash.keySystemsByURI)),
                          (c = new Set(c ? [c] : [])),
                          (v = !1),
                          g.some(function (e) {
                            return (
                              "tag:dolby.com,2018:dash:EC3_ExtensionType:2018" == e.attributes.schemeIdUri &&
                              "JOC" == e.attributes.value
                            );
                          }) && (v = !0),
                          (g = !1),
                          d && (g = l.includes("forced_subtitle") || l.includes("forced-subtitle")),
                          E &&
                            ((m = m.find(function (e) {
                              return [
                                "http://dashif.org/thumbnail_tile",
                                "http://dashif.org/guidelines/thumbnail_tile",
                              ].includes(e.attributes.schemeIdUri);
                            })) && (y = m.attributes.value),
                            !y))
                        )
                          return null;
                        ((d = r.L.codecs),
                          r.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10") &&
                            (d.includes("hvc1.2.4.L153.B0") || d.includes("hev1.2.4.L153.B0")) &&
                            (T = "PQ"),
                          (m = r.L.id ? r.sa.id + "," + r.L.id : ""),
                          t.H.length &&
                            f &&
                            t.u.set(
                              r.sa.id + "," + f,
                              (function (e) {
                                function t(e) {
                                  return e
                                    ? (((e = zt(e)).Id = null),
                                      (e.Ac = null),
                                      (e.Oc = wr(e.Oc)),
                                      (e.Cf = null),
                                      e)
                                    : null;
                                }
                                return (
                                  ((e = zt(e)).sa = t(e.sa)),
                                  (e.qa = t(e.qa)),
                                  (e.L = t(e.L)),
                                  e.na && ((e.na = zt(e.na)), (e.na.node = null)),
                                  e
                                );
                              })(r),
                            ),
                          r.L.Cf &&
                            (function (e, t, r, i) {
                              if (!e.ma.has(t)) {
                                e.ma.add(t);
                                var n,
                                  a = sr(t, "presentationTime", gr) || 0,
                                  s = nr(t, "UTCTiming");
                                ((n = s && s.attributes.schemeIdUri) &&
                                  (n = !(
                                    "urn:mpeg:dash:utc:http-ntp:2014" === (s = s.attributes.schemeIdUri) ||
                                    "urn:mpeg:dash:utc:ntp:2014" === s ||
                                    "urn:mpeg:dash:utc:sntp:2014" === s
                                  )),
                                  (t = n
                                    ? 1e3 * (sr(t, "wallClockTime", dr) || 0)
                                    : ho((t = sr(t, "wallClockTime", gr) || 0))),
                                  (a = (r = new Date(t - (a / r.timescale) * 1e3)).getTime() / 1e3),
                                  isNaN(a) ||
                                    (i.o || i.sh(a),
                                    (i = new Pn(
                                      "prft",
                                      (i = new Map().set("detail", {
                                        wallClockTime: t,
                                        programStartDate: r,
                                      })),
                                    )),
                                    e.j.onEvent(i)));
                              }
                            })(t, r.L.Cf, k, r.presentationTimeline),
                          -1 != k.endTime &&
                            null != r.sa.id &&
                            null != r.L.id &&
                            ((f = t.C.get(r.sa.id))
                              ? ((f.endTime = k.endTime),
                                f.gh.includes(r.L.id) || f.gh.push(r.L.id),
                                t.C.set(r.sa.id, f))
                              : t.C.set(r.sa.id, {
                                  endTime: k.endTime,
                                  timeline: k.timeline,
                                  gh: [r.L.id],
                                })));
                        var _ =
                          m && t.o.has(m)
                            ? t.o.get(m)
                            : {
                                id: t.Fa++,
                                originalId: r.L.id,
                                groupId: null,
                                createSegmentIndex: function () {
                                  return Promise.resolve();
                                },
                                closeSegmentIndex: function () {
                                  _.segmentIndex && (_.segmentIndex.release(), (_.segmentIndex = null));
                                },
                                segmentIndex: null,
                                mimeType: r.L.mimeType,
                                codecs: d,
                                frameRate: r.L.frameRate,
                                pixelAspectRatio: r.L.pixelAspectRatio,
                                bandwidth: r.bandwidth,
                                width: r.L.width,
                                height: r.L.height,
                                kind: n,
                                encrypted: i.drmInfos.length > 0,
                                drmInfos: i.drmInfos,
                                keyIds: c,
                                language: a,
                                originalLanguage: r.qa.language,
                                label: s,
                                type: r.qa.contentType,
                                primary: o,
                                trickModeVideo: null,
                                dependencyStream: null,
                                emsgSchemeIdUris: r.L.emsgSchemeIdUris,
                                roles: l,
                                forced: g,
                                channelsCount: r.L.yf,
                                audioSamplingRate: r.L.audioSamplingRate,
                                spatialAudio: v,
                                closedCaptions: u,
                                hdr: T,
                                colorGamut: void 0,
                                videoLayout: void 0,
                                tilesLayout: y,
                                accessibilityPurpose: h,
                                external: !1,
                                fastSwitching: !1,
                                fullMimeTypes: new Set([li(r.L.mimeType, r.L.codecs)]),
                                isAudioMuxedInVideo: !1,
                                baseOriginalId: null,
                              };
                        return (
                          (_.createSegmentIndex = function () {
                            var e;
                            return D(function (t) {
                              if (1 == t.g) return _.segmentIndex ? t.A(0) : ((e = _), b(t, k.Sc(), 3));
                              ((e.segmentIndex = t.h), S(t));
                            });
                          }),
                          m &&
                            r.Eb &&
                            !t.o.has(m) &&
                            ((r = r.sa.id || ""),
                            t.F.has(r) || t.F.set(r, []),
                            t.o.set(m, _),
                            t.F.get(r).push(m)),
                          _
                        );
                      })(t, r, C, d, L, M, l, u, I, i, A, w);
                      return n &&
                        ((n.hdr = n.hdr || E),
                        (n.colorGamut = n.colorGamut || x),
                        (n.fastSwitching = v),
                        (i = i.attributes.dependencyId))
                        ? ((n.baseOriginalId = i), _.set(i, n), null)
                        : n;
                    })
                    .filter(function (e) {
                      return !!e;
                    })),
                  0 == c.length && 0 == _.size)
                ) {
                  if (((i = "image" == r.qa.contentType), t.g.dash.ignoreEmptyAdaptationSet || h || i))
                    return null;
                  throw new ze(2, 4, 4003);
                }
                if (!r.qa.contentType || "application" == r.qa.contentType)
                  for (
                    r.qa.contentType = Gv(c[0].mimeType, c[0].codecs), f = (h = g(c)).next();
                    !f.done;
                    f = h.next()
                  )
                    f.value.type = r.qa.contentType;
                for (h = r.qa.id || "__fake__" + t.Fa++, p = (f = g(c)).next(); !p.done; p = f.next()) {
                  for (p = p.value, T = (y = g(C.drmInfos)).next(); !T.done; T = y.next())
                    (T = T.value).keyIds =
                      T.keyIds && p.keyIds
                        ? new Set([].concat(m(T.keyIds), m(p.keyIds)))
                        : T.keyIds || p.keyIds;
                  t.g.enableAudioGroups && (p.groupId = h);
                }
                return (
                  (n = n
                    .map(function (e) {
                      return e.attributes.supplementalId || e.attributes.id;
                    })
                    .filter(Mi)),
                  {
                    id: h,
                    contentType: r.qa.contentType,
                    language: L,
                    Fm: l,
                    streams: c,
                    drmInfos: C.drmInfos,
                    Hh: i,
                    Rk: n,
                    Aj: _,
                  }
                );
              }
              function Ov(e, t) {
                if (
                  (t = ar(t, "urn:mpeg:dash:schema:urlparam:2014", "UrlQueryInfo")) &&
                  sr(t, "useMPDUrlQuery", vr, !1)
                ) {
                  var r = t.attributes.queryTemplate;
                  if (r)
                    return function () {
                      return "$querypart$" == r
                        ? e.$
                        : r
                            .split("&")
                            .map(function (t) {
                              if ("$querypart$" == t) return e.$;
                              var r = /\$query:(.*?)\$/g.exec(t);
                              if (r && 2 == r.length) {
                                r = r[1];
                                var i = new Ce(e.$).get(r);
                                if (i.length) return r + "=" + i[0];
                              }
                              return t;
                            })
                            .join("&");
                    };
                }
                return null;
              }
              function Nv(e) {
                var t, r;
                return D(function (i) {
                  switch (i.g) {
                    case 1:
                      return ((t = 0), E(i, 2), b(i, Av(e), 4));
                    case 4:
                      ((t = i.h), w(i, 3));
                      break;
                    case 2:
                      if (((r = A(i)), e.j)) {
                        if (e.g.raiseFatalErrorOnManifestUpdateRequestFailure)
                          return (e.j.onError(r), i.return());
                        ((r.severity = 1), e.j.onError(r));
                      }
                    case 3:
                      if (!e.j) return i.return();
                      (e.j.onManifestUpdated(), Fv(e, t), S(i));
                  }
                });
              }
              function Fv(e, t) {
                if (!(e.K < 0)) {
                  var r = e.K;
                  (e.g.updatePeriod >= 0 && (r = e.g.updatePeriod), e.M.ka(Math.max(r - t, V(e.Da))));
                }
              }
              function Uv(e, t, r, i) {
                ((r = r || {
                  contentType: "",
                  mimeType: "",
                  codecs: "",
                  emsgSchemeIdUris: [],
                  frameRate: void 0,
                  pixelAspectRatio: void 0,
                  yf: null,
                  audioSamplingRate: null,
                  rb: 0,
                  If: 1,
                  encrypted: !1,
                }),
                  (i = i || r.bb));
                var n,
                  a = t.attributes.id,
                  s = t.attributes.supplementalId,
                  o = er(t, "BaseURL"),
                  l = !1;
                if (e.i)
                  for (var u = g(o), d = u.next(); !d.done; d = u.next()) {
                    var h = d.value;
                    ((d = h.attributes.serviceLocation), (h = rr(h)), d && h && (Fm(e.i, a, d, h), (l = !0)));
                  }
                (l && e.i) || (n = o.map(rr));
                var c = e.i;
                ((e = t.attributes.contentType || r.contentType),
                  (u = t.attributes.mimeType || r.mimeType),
                  (d = nu([t.attributes.codecs || r.codecs]).join(",")),
                  (h = sr(t, "frameRate", yr) || r.frameRate));
                var f = t.attributes.sar || r.pixelAspectRatio,
                  p = (function (e, t) {
                    t = t.slice();
                    for (var r = (e = g(e)).next(); !r.done; r = e.next())
                      ((r = r.value.attributes.schemeIdUri), t.includes(r) || t.push(r));
                    return t;
                  })(er(t, "InbandEventStream"), r.emsgSchemeIdUris),
                  m = er(t, "AudioChannelConfiguration");
                m =
                  (function (e) {
                    for (var t = (e = g(e)).next(); !t.done; t = e.next()) {
                      var r = (t = t.value).attributes.schemeIdUri;
                      if (r && (t = t.attributes.value))
                        switch (r) {
                          case "urn:mpeg:dash:outputChannelPositionList:2012":
                            return t.trim().split(/ +/).length;
                          case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":
                          case "urn:dts:dash:audio_channel_configuration:2012":
                            if (!(t = parseInt(t, 10))) continue;
                            return t;
                          case "tag:dolby.com,2015:dash:audio_channel_configuration:2015":
                            if (
                              ((r = [2, 1, 2, 2, 2, 2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2]),
                              !(t = parseInt(t, 16)))
                            )
                              continue;
                            for (var i = 0, n = 0; n < r.length; n++) t & (1 << n) && (i += r[n]);
                            if (i) return i;
                            continue;
                          case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":
                          case "urn:dolby:dash:audio_channel_configuration:2011":
                            if (
                              ((r = [1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2, 1, 1].reverse()),
                              !(t = parseInt(t, 16)))
                            )
                              continue;
                            for (n = i = 0; n < r.length; n++) t & (1 << n) && (i += r[n]);
                            if (i) return i;
                            continue;
                          case "urn:mpeg:mpegB:cicp:ChannelConfiguration":
                            if (
                              ((r = [0, 1, 2, 3, 4, 5, 6, 8, 2, 3, 4, 7, 8, 24, 8, 12, 10, 12, 14, 12, 14]),
                              (t = parseInt(t, 10)) && t > 0 && t < r.length)
                            )
                              return r[t];
                        }
                    }
                    return null;
                  })(m) || r.yf;
                var v = sr(t, "audioSamplingRate", gr) || r.audioSamplingRate;
                e || (e = Gv(u, d));
                var y = nr(t, "SegmentBase"),
                  T = nr(t, "SegmentTemplate"),
                  b = (y && sr(y, "availabilityTimeOffset", mr)) || 0,
                  S = (T && sr(T, "availabilityTimeOffset", mr)) || 0,
                  E = (o && o.length && sr(o[0], "availabilityTimeOffset", mr)) || 0;
                ((b = r.rb + E + b + S),
                  (S = null),
                  (E = nr(t, "SegmentSequenceProperties")) && (E = sr(E, "cadence", pr)) && (S = E),
                  (E = t.attributes.label));
                var x = er(t, "Label");
                return (
                  x && x.length && tr((x = x[0])) && (E = tr(x)),
                  {
                    bb: function () {
                      return ut(i(), o.length ? (c && l ? Um(c, a) : n || []) : []);
                    },
                    Id: y || r.Id,
                    Ac: nr(t, "SegmentList") || r.Ac,
                    Oc: T || r.Oc,
                    Cf: nr(t, "ProducerReferenceTime") || r.Cf,
                    width: sr(t, "width", gr) || r.width,
                    height: sr(t, "height", gr) || r.height,
                    contentType: e,
                    mimeType: u,
                    codecs: d,
                    frameRate: h,
                    pixelAspectRatio: f,
                    emsgSchemeIdUris: p,
                    id: s || a,
                    originalId: a,
                    language: t.attributes.lang,
                    yf: m,
                    audioSamplingRate: v,
                    rb: b,
                    hf: null,
                    If: S || r.If,
                    label: E || null,
                    encrypted: !1,
                  }
                );
              }
              function Bv(e, t, r, i) {
                var n, a, s, o, l, u, d;
                return D(function (h) {
                  if (1 == h.g)
                    return (
                      (n = [et(r)]),
                      (a = ut(t(), n)),
                      ((s = Vn(a, e.g.retryParameters)).method = i),
                      (o = e.j.networkingEngine.request(4, s, { isPreload: e.oa() })),
                      Bn(e.R, o),
                      b(h, o.promise, 2)
                    );
                  if (((l = h.h), "HEAD" == i)) {
                    if (!l.headers || !l.headers.date) return h.return(0);
                    u = l.headers.date;
                  } else u = Xe(l.data);
                  return ((d = Date.parse(u)), isNaN(d) ? h.return(0) : h.return(d - Date.now()));
                });
              }
              function $v(e, t, r, i, n) {
                for (
                  var a = i.attributes.schemeIdUri || "",
                    s = i.attributes.value || "",
                    o = sr(i, "timescale", gr) || 1,
                    l = sr(i, "presentationTimeOffset", gr) || 0,
                    u = (i = g(er(i, "Event"))).next();
                  !u.done;
                  u = i.next()
                ) {
                  var d = sr((u = u.value), "presentationTime", gr) || 0,
                    h = sr(u, "duration", gr) || 0;
                  ((h = (d = Math.max((d - l) / o + t, t)) + h / o),
                    null != r && ((d = Math.min(d, t + r)), (h = Math.min(h, t + r))),
                    h < n ||
                      ((u = {
                        schemeIdUri: a,
                        value: s,
                        startTime: d,
                        endTime: h,
                        id: u.attributes.id || "",
                        timescale: o,
                        eventElement: xr(u),
                        eventNode: wr(u),
                      }),
                      e.j.onTimelineRegionAdded(u)));
                }
              }
              function jv(e, t, r, i, n) {
                var a, s, o, l;
                return D(function (u) {
                  return 1 == u.g
                    ? ((a = qn),
                      (s = n ? 0 : 1),
                      (o = lu(t, r, i, e.g.retryParameters)),
                      b(u, Vv(e, o, a, { type: s }), 2))
                    : ((l = u.h), u.return(l.data));
                });
              }
              function Gv(e, t) {
                return Ei((t = li(e, t))) ? gt : e.split("/")[0];
              }
              function Vv(e, t, r, i) {
                return (
                  i || (i = {}),
                  (i.isPreload = e.oa()),
                  (t = e.j.networkingEngine.request(r, t, i)),
                  Bn(e.R, t),
                  t.promise
                );
              }
              function Hv() {
                return "";
              }
              function Kv(e, t, r) {
                return function () {
                  return e && t ? Um(e, "BaseURL") : r.slice();
                };
              }
              function Wv() {}
              (((n = wv.prototype).configure = function (e, t) {
                var r = this.j && e.updatePeriod != this.g.updatePeriod && e.updatePeriod >= 0;
                ((this.g = e),
                  t && (this.oa = t),
                  r && this.h && this.h.presentationTimeline.W() && this.M.Jb(),
                  this.i && this.i.configure(this.g),
                  this.m && this.m.Xi(this.g.dash.useStreamOnceInPeriodFlattening));
              }),
                (n.start = function (e, t) {
                  var r,
                    i = this;
                  return D(function (n) {
                    if (1 == n.g)
                      return ((i.va = t.isLowLatencyMode()), (i.B = [e]), (i.j = t), b(n, Av(i), 2));
                    if (((r = n.h), i.j && Fv(i, r), !i.j)) throw new ze(2, 7, 7001);
                    return n.return(i.h);
                  });
                }),
                (n.stop = function () {
                  for (var e = g(this.o.values()), t = e.next(); !t.done; t = e.next())
                    (t = t.value).segmentIndex && t.segmentIndex.release();
                  return (
                    this.m && this.m.release(),
                    (this.g = this.j = null),
                    (this.B = []),
                    (this.h = null),
                    this.o.clear(),
                    this.F.clear(),
                    this.u.clear(),
                    this.C.clear(),
                    (this.l = { vf: "", type: "", profiles: [], uc: null, rb: 0, bb: null, qe: 0 }),
                    (this.m = null),
                    null != this.M && (this.M.stop(), (this.M = null)),
                    this.i && this.i.destroy(),
                    this.I && (this.I.release(), (this.I = null)),
                    this.ma.clear(),
                    this.ya.release(),
                    this.R.destroy()
                  );
                }),
                (n.update = function () {
                  var e,
                    t = this;
                  return D(function (r) {
                    return 1 == r.g
                      ? (E(r, 2), b(r, Av(t), 4))
                      : 2 != r.g
                        ? w(r, 0)
                        : ((e = A(r)), t.j && e ? (t.j.onError(e), void S(r)) : r.return());
                  });
                }),
                (n.onExpirationUpdated = function () {}),
                (n.onInitialVariantChosen = function (e) {
                  if (this.h && this.h.presentationTimeline.W()) {
                    var t = e.video || e.audio;
                    if (t && t.segmentIndex) {
                      e = this.h.presentationTimeline.Ic();
                      var r = t.segmentIndex.find(e);
                      null != r && (t = t.segmentIndex.get(r)) && ((this.K = t.endTime - e), Fv(this, 0));
                    }
                  }
                }),
                (n.banLocation = function (e) {
                  this.i && this.i.banLocation(e);
                }),
                (n.setMediaElement = function (e) {
                  this.J = e;
                }),
                j("shaka.dash.DashParser", wv),
                wt("application/dash+xml", function () {
                  return new wv();
                }),
                wt("video/vnd.mpeg.dash.mpd", function () {
                  return new wv();
                }),
                j("shaka.dependencies", Wv),
                (Wv.has = function (e) {
                  return Xv.has(e);
                }),
                (Wv.add = function (e, t) {
                  if (!qv[e]) throw Error(e + " is not supported");
                  e == zv
                    ? he("mux.js", "mux.js is no longer used in Shaka Player.")
                    : Xv.set(e, function () {
                        return t;
                      });
                }));
              var zv = "muxjs",
                qv = { Gm: zv, ISOBoxer: "ISOBoxer" };
              Wv.Allowed = qv;
              var Xv = new Map([
                [
                  "ISOBoxer",
                  function () {
                    return e.ISOBoxer;
                  },
                ],
              ]);
              function Yv() {
                ((this.j = new ae(function () {
                  return ["Oculus", "Quest"].some(function (e) {
                    return navigator.userAgent.includes(e.toLowerCase());
                  })
                    ? "VR"
                    : navigator.userAgent.match(/Smart( ?|_)TV/i) || navigator.userAgent.match(/Android ?TV/i)
                      ? "TV"
                      : navigator.userAgentData
                        ? navigator.userAgentData.mobile
                          ? "MOBILE"
                          : "DESKTOP"
                        : /(?:iPhone|iPad|iPod)/.test(navigator.userAgent)
                          ? "MOBILE"
                          : navigator.userAgentData && navigator.userAgentData.platform
                            ? "android" == navigator.userAgentData.platform.toLowerCase()
                              ? "MOBILE"
                              : "DESKTOP"
                            : navigator.userAgent.includes("Android")
                              ? "MOBILE"
                              : "DESKTOP";
                })),
                  (this.l = new ae(function () {
                    return navigator.vendor.includes("Apple") &&
                      (navigator.userAgent.includes("Version/") || navigator.userAgent.includes("OS/"))
                      ? "WEBKIT"
                      : navigator.userAgent.includes("Edge/")
                        ? "EDGE"
                        : navigator.userAgent.includes("Chrome/")
                          ? "CHROMIUM"
                          : navigator.userAgent.includes("Firefox/")
                            ? "GECKO"
                            : "UNKNOWN";
                  })));
              }
              function Qv() {
                var t = e.ManagedMediaSource || e.MediaSource;
                return !(!t || !t.isTypeSupported);
              }
              function Jv() {
                (Yv.call(this),
                  (this.g = new ae(function () {
                    var e = navigator.userAgent.match(/Version\/(\d+)/);
                    return e || (e = navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))
                      ? parseInt(e[1], 10)
                      : null;
                  })),
                  (this.h = new ae(function () {
                    return /(?:iPhone|iPad|iPod)/.test(navigator.userAgent) || navigator.maxTouchPoints > 1
                      ? "xr" in navigator
                        ? "APPLE_VR"
                        : "MOBILE"
                      : "xr" in navigator
                        ? "APPLE_VR"
                        : "DESKTOP";
                  })));
              }
              function Zv() {
                if (!ey()) throw Error("Not a Chromecast device!");
                (Yv.call(this),
                  (this.h = new ae(function () {
                    var e = navigator.userAgent.match(/Chrome\/(\d+)/);
                    return e ? parseInt(e[1], 10) : null;
                  })),
                  (this.g = new ae(function () {
                    var e =
                      (navigator.userAgentData && navigator.userAgentData.platform) || navigator.userAgent;
                    return (e = e.toLowerCase()).includes("android") ? ty : e.includes("fuchsia") ? ry : iy;
                  })));
              }
              function ey() {
                return (
                  navigator.userAgent.includes("CrKey") && !navigator.userAgent.includes("VIZIO SmartCast")
                );
              }
              (((n = Yv.prototype).hc = function () {
                return !!navigator.mediaCapabilities;
              }),
                (n.Oa = function () {
                  return this.j.value();
                }),
                (n.Ha = function () {
                  return this.l.value();
                }),
                (n.Fd = function () {
                  return !1;
                }),
                (n.ih = function () {
                  return !1;
                }),
                (n.jf = function () {
                  return !1;
                }),
                (n.Ni = function () {
                  return !1;
                }),
                (n.se = function () {
                  return !1;
                }),
                (n.fd = function () {
                  return !0;
                }),
                (n.Ib = function () {
                  var t = e.ManagedSourceBuffer || e.SourceBuffer;
                  return !!t && !!t.prototype && !!t.prototype.changeType;
                }),
                (n.we = function () {
                  return !0;
                }),
                (n.Si = function () {
                  return 0;
                }),
                (n.lc = function () {
                  return Promise.resolve({ width: 1 / 0, height: 1 / 0 });
                }),
                (n.$i = function () {
                  return !1;
                }),
                (n.xh = function () {
                  return !1;
                }),
                (n.Wa = function (e) {
                  var t = this.Oa();
                  return (
                    ("TV" !== t && "CONSOLE" !== t && "CAST" !== t) ||
                      ((e.ads.customPlayheadTracker = !0),
                      (e.ads.skipPlayDetection = !0),
                      (e.ads.supportsMultipleMediaElements = !1)),
                    e
                  );
                }),
                (n.Ch = function () {
                  return !!e.indexedDB;
                }),
                (n.Li = function () {
                  return [];
                }),
                (n.sd = function (t) {
                  return void 0 !== e.matchMedia && e.matchMedia("(color-gamut: p3)").matches
                    ? t
                      ? "HLG"
                      : "PQ"
                    : "SDR";
                }),
                (n.gj = function () {
                  return !1;
                }),
                (n.Bi = function () {
                  return !1;
                }),
                (n.Ff = function () {
                  return !1;
                }),
                (n.Of = function () {
                  return !0;
                }),
                (n.Ci = function () {
                  return !1;
                }),
                (n.fj = function () {
                  return !0;
                }),
                (n.ed = function () {
                  return !1;
                }),
                (n.Vg = function (e) {
                  return "com.apple.fps" === e;
                }),
                (n.Nf = function () {
                  return !0;
                }),
                (n.toString = function () {
                  return "Device: " + this.Nb() + " v" + this.Ba() + "; Type: " + this.Oa();
                }),
                f(Jv, Yv),
                ((n = Jv.prototype).Ba = function () {
                  return this.g.value();
                }),
                (n.Nb = function () {
                  return "Apple Browser";
                }),
                (n.Oa = function () {
                  return this.h.value();
                }),
                (n.Ha = function () {
                  return "WEBKIT";
                }),
                (n.hc = function () {
                  return !1;
                }),
                (n.Fd = function (e, t) {
                  return "audio" === t;
                }),
                (n.jf = function () {
                  return !0;
                }),
                (n.Ni = function (e) {
                  return "audio" === e;
                }),
                (n.Wa = function (e) {
                  return (Yv.prototype.Wa.call(this, e), (e.abr.minTimeToSwitch = 0.5), e);
                }),
                (n.gj = function () {
                  return !0;
                }),
                (n.Nf = function () {
                  return !1;
                }),
                (navigator.vendor || "").includes("Apple") &&
                  (/(?:iPhone|iPad|iPod)/.test(navigator.userAgent) ||
                    navigator.maxTouchPoints > 1 ||
                    (navigator.userAgentData &&
                      navigator.userAgentData.platform &&
                      "macos" == navigator.userAgentData.platform.toLowerCase()) ||
                    (navigator.platform && navigator.platform.toLowerCase().includes("mac"))) &&
                  (oe = function () {
                    return new Jv();
                  }),
                f(Zv, Yv),
                ((n = Zv.prototype).Ba = function () {
                  return this.h.value();
                }),
                (n.Nb = function () {
                  return "Chromecast with " + this.g.value();
                }),
                (n.Oa = function () {
                  return "CAST";
                }),
                (n.Ha = function () {
                  return "CHROMIUM";
                }),
                (n.hc = function () {
                  return Yv.prototype.hc.call(this) && this.g.value() !== iy;
                }),
                (n.Ib = function () {
                  return Yv.prototype.Ib.call(this) && this.g.value() !== iy;
                }),
                (n.Si = function () {
                  switch (this.g.value()) {
                    case ty:
                      return 0;
                    case ry:
                      return 3;
                    default:
                      return 1;
                  }
                }),
                (n.lc = function () {
                  var t, r, i, n;
                  return D(function (a) {
                    switch (a.g) {
                      case 1:
                        if (
                          ((t = e.cast && cast.__platform__ && cast.__platform__.canDisplayType),
                          (r = { width: 1280, height: 720 }),
                          E(a, 2),
                          !(i = t))
                        ) {
                          a.A(4);
                          break;
                        }
                        return b(
                          a,
                          cast.__platform__.canDisplayType(
                            'video/mp4; codecs="avc1.640028"; width=3840; height=2160',
                          ),
                          5,
                        );
                      case 5:
                        i = a.h;
                      case 4:
                        if (i) {
                          ((r.width = 3840), (r.height = 2160), a.A(6));
                          break;
                        }
                        if (!(n = t)) {
                          a.A(7);
                          break;
                        }
                        return b(
                          a,
                          cast.__platform__.canDisplayType(
                            'video/mp4; codecs="avc1.640028"; width=1920; height=1080',
                          ),
                          8,
                        );
                      case 8:
                        n = a.h;
                      case 7:
                        n && ((r.width = 1920), (r.height = 1080));
                      case 6:
                        w(a, 3);
                        break;
                      case 2:
                        W("Failed to check canDisplayType:", A(a));
                      case 3:
                        return a.return(r);
                    }
                  });
                }),
                (n.Wa = function (e) {
                  return (Yv.prototype.Wa.call(this, e), (e.streaming.stallSkip = 0), e);
                }),
                (n.Ch = function () {
                  return !1;
                }),
                (n.ed = function () {
                  return !0;
                }));
              var ty = "Android",
                ry = "Fuchsia",
                iy = "Linux";
              function ny() {
                Yv.call(this);
                var e = this;
                ((this.i = new ae(function () {
                  var e = navigator.userAgent.match(/(Chrome|Firefox)\/(\d+)/);
                  return e ? parseInt(e[2], 10) : null;
                })),
                  (this.g = new ae(function () {
                    return navigator.userAgent.match(/Edge?\//)
                      ? "Edge"
                      : navigator.userAgent.includes("Chrome")
                        ? "Chrome"
                        : navigator.userAgent.includes("Firefox")
                          ? "Firefox"
                          : "Unknown";
                  })),
                  (this.h = new ae(function () {
                    return navigator.userAgentData && navigator.userAgentData.platform
                      ? "windows" == navigator.userAgentData.platform.toLowerCase()
                      : !!navigator.platform && navigator.platform.toLowerCase().includes("win32");
                  })),
                  (this.u = new ae(function () {
                    return !(
                      !Yv.prototype.Ib.call(e) ||
                      (navigator.userAgent.match(/Edge?\//) && e.h.value())
                    );
                  })),
                  (this.o = new ae(function () {
                    return navigator.userAgent.includes("sony.hbbtv.tv");
                  })),
                  (this.m = new ae(function () {
                    return navigator.userAgentData && navigator.userAgentData.platform
                      ? "android" == navigator.userAgentData.platform.toLowerCase()
                      : !!navigator.userAgent.includes("Android");
                  })));
              }
              function ay() {
                Yv.apply(this, arguments);
              }
              function sy() {
                (Yv.call(this),
                  (this.g = new ae(function () {
                    var e = navigator.userAgent.match(/PlayStation (\d+)/);
                    return e ? parseInt(e[1], 10) : null;
                  })));
              }
              function oy() {
                Yv.call(this);
                var e = navigator.userAgent.match(/Tizen (\d+).(\d+)/);
                ((this.g = e ? parseInt(e[1], 10) : null), (this.h = e ? parseInt(e[2], 10) : null));
              }
              function ly() {
                Yv.apply(this, arguments);
              }
              function uy() {
                (Yv.call(this),
                  (this.i = new ae(function () {
                    return (
                      navigator.userAgent.includes("DT_STB_BCM") || navigator.userAgent.includes("Sky_STB")
                    );
                  })),
                  (this.h = new ae(function () {
                    return navigator.userAgent.includes("SOPOpenBrowser");
                  })),
                  (this.g = new ae(function () {
                    if (navigator.userAgent.includes("DT_STB_BCM")) return 11;
                    var e = navigator.userAgent.match(/Version\/(\d+)/);
                    return e || (e = navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))
                      ? parseInt(e[1], 10)
                      : null;
                  })));
              }
              function dy() {
                Yv.call(this);
                var e = this;
                ((this.h = (function () {
                  var e = null,
                    t = navigator.userAgent.match(/Chrome\/(\d+)/);
                  switch ((t && (e = parseInt(t[1], 10)), e)) {
                    case 38:
                      return 3;
                    case 53:
                      return 4;
                    case 68:
                      return 5;
                    case 79:
                      return 6;
                    case 87:
                      return 22;
                    case 94:
                      return 23;
                    case 108:
                      return 24;
                    case 120:
                      return 25;
                    default:
                      return null;
                  }
                })()),
                  (this.g = null));
                try {
                  var t = new PalmServiceBridge();
                  ((t.onservicecallback = function (t) {
                    ((t = JSON.parse(t)),
                      (e.g =
                        t.configs["tv.model.supportHDR"] ||
                        t.configs["tv.config.supportDolbyHDRContents"] ||
                        !1));
                  }),
                    t.call(
                      "luna://com.webos.service.config/getConfigs",
                      JSON.stringify({
                        configNames: ["tv.model.supportHDR", "tv.config.supportDolbyHDRContents"],
                      }),
                    ));
                } catch (r) {
                  z("WebOS: getConfigs call failed", r);
                }
              }
              if (
                (ey() &&
                  (oe = function () {
                    return new Zv();
                  }),
                f(ny, Yv),
                ((n = ny.prototype).Ba = function () {
                  return this.i.value();
                }),
                (n.Nb = function () {
                  return this.g.value();
                }),
                (n.Fd = function (e) {
                  return !!je(e) && "Edge" === this.g.value() && this.h.value();
                }),
                (n.ih = function () {
                  return "Edge" === this.g.value() && this.h.value();
                }),
                (n.jf = function () {
                  return "Edge" === this.g.value() && this.h.value();
                }),
                (n.Ib = function () {
                  return this.u.value();
                }),
                (n.Wa = function (e) {
                  if ((Yv.prototype.Wa.call(this, e), this.h.value()))
                    switch (this.g.value()) {
                      case "Firefox":
                        e.drm.keySystemsMapping = {
                          "com.microsoft.playready": "com.microsoft.playready.recommendation",
                        };
                        break;
                      case "Chrome":
                        e.drm.keySystemsMapping = {
                          "com.microsoft.playready": "com.microsoft.playready.recommendation.3000",
                          "com.microsoft.playready.recommendation":
                            "com.microsoft.playready.recommendation.3000",
                        };
                    }
                  return (
                    this.m.value() &&
                      ((e.drm.defaultAudioRobustnessForWidevine = ""),
                      (e.drm.defaultVideoRobustnessForWidevine = "")),
                    e
                  );
                }),
                (n.Ff = function () {
                  return "Edge" === this.g.value() || this.o.value();
                }),
                (n.ed = function () {
                  if ("GECKO" === this.Ha()) {
                    var e = this.Ba();
                    return null !== e ? e >= 100 : Yv.prototype.ed.call(this);
                  }
                  return Yv.prototype.ed.call(this);
                }),
                (n.Vg = function (e) {
                  return "GECKO" === this.Ha()
                    ? e.startsWith("com.microsoft.playready.recommendation")
                    : Yv.prototype.Vg.call(this, e);
                }),
                (le = function () {
                  return new ny();
                }),
                f(ay, Yv),
                ((n = ay.prototype).Ba = function () {
                  return null;
                }),
                (n.Nb = function () {
                  return "Hisense";
                }),
                (n.Oa = function () {
                  return "TV";
                }),
                (n.hc = function () {
                  return !1;
                }),
                (n.lc = function () {
                  var t = { width: 1920, height: 1080 },
                    r = null;
                  if (e.Hisense_Get4KSupportState)
                    try {
                      r = e.Hisense_Get4KSupportState();
                    } catch (i) {}
                  return (
                    null == r && (r = navigator.userAgent.includes("UHD")),
                    r && ((t.width = 3840), (t.height = 2160)),
                    Promise.resolve(t)
                  );
                }),
                (n.Wa = function (e) {
                  return (Yv.prototype.Wa.call(this, e), (e.streaming.stallSkip = 0), e);
                }),
                (navigator.userAgent.includes("Hisense") || navigator.userAgent.includes("VIDAA")) &&
                  (oe = function () {
                    return new ay();
                  }),
                f(sy, Yv),
                ((n = sy.prototype).Nb = function () {
                  return "PlayStation";
                }),
                (n.Oa = function () {
                  return "CONSOLE";
                }),
                (n.Ha = function () {
                  return "WEBKIT";
                }),
                (n.Ba = function () {
                  return this.g.value();
                }),
                (n.hc = function () {
                  return !1;
                }),
                (n.fd = function () {
                  return !1;
                }),
                (n.Ib = function () {
                  return !1;
                }),
                (n.xh = function () {
                  return 4 === this.Ba();
                }),
                (n.lc = function () {
                  var t, r, i, n;
                  return D(function (a) {
                    switch (a.g) {
                      case 1:
                        return (
                          (t = { width: 1920, height: 1080 }),
                          (r = !1),
                          E(a, 2),
                          b(a, e.msdk.device.getDisplayInfo(), 4)
                        );
                      case 4:
                        ((i = a.h), (r = "4K" === i.resolution), w(a, 3));
                        break;
                      case 2:
                        return (A(a), E(a, 5), b(a, e.msdk.device.getDisplayInfoImmediate(), 7));
                      case 7:
                        ((n = a.h), (r = "4K" === n.resolution), w(a, 3));
                        break;
                      case 5:
                        z("PlayStation: Failed to get the display info:", A(a));
                      case 3:
                        return (r && ((t.width = 3840), (t.height = 2160)), a.return(t));
                    }
                  });
                }),
                (n.Wa = function (e) {
                  return (
                    Yv.prototype.Wa.call(this, e),
                    4 === this.Ba() && e.drm.preferredKeySystems.push("com.microsoft.playready"),
                    (e.streaming.clearDecodingCache = !0),
                    e
                  );
                }),
                (n.Ff = function () {
                  return 4 === this.Ba();
                }),
                (n.Of = function () {
                  return 4 !== this.Ba();
                }),
                navigator.userAgent.includes("PlayStation") &&
                  (oe = function () {
                    return new sy();
                  }),
                f(oy, Yv),
                ((n = oy.prototype).Ba = function () {
                  return this.g;
                }),
                (n.Nb = function () {
                  return "Tizen";
                }),
                (n.Ha = function () {
                  return "CHROMIUM";
                }),
                (n.Oa = function () {
                  return "TV";
                }),
                (n.Fd = function () {
                  return !0;
                }),
                (n.se = function () {
                  return 3 === this.Ba();
                }),
                (n.hc = function () {
                  return !1;
                }),
                (n.fd = function () {
                  var e = this.Ba();
                  return null !== e ? e >= 4 : Yv.prototype.fd.call(this);
                }),
                (n.Ib = function () {
                  return !1;
                }),
                (n.we = function () {
                  return this.g && this.h
                    ? 5 === this.g
                      ? this.h >= 5
                      : this.g > 5
                    : Yv.prototype.we.call(this);
                }),
                (n.lc = function () {
                  var t = e.devicePixelRatio;
                  t = {
                    width: e.screen.width * t > 1920 ? 3840 : 1920,
                    height: e.screen.height * t > 1080 ? 2160 : 1080,
                  };
                  try {
                    if (webapis.systeminfo && webapis.systeminfo.getMaxVideoResolution) {
                      var r = webapis.systeminfo.getMaxVideoResolution();
                      ((t.width = r.width), (t.height = r.height));
                    } else
                      webapis.productinfo.is8KPanelSupported && webapis.productinfo.is8KPanelSupported()
                        ? ((t.width = 7680), (t.height = 4320))
                        : webapis.productinfo.isUdPanelSupported &&
                          webapis.productinfo.isUdPanelSupported() &&
                          ((t.width = 3840), (t.height = 2160));
                  } catch (i) {
                    z("Tizen: Error detecting screen size, default screen size 1920x1080.");
                  }
                  return Promise.resolve(t);
                }),
                (n.Wa = function (e) {
                  return (
                    Yv.prototype.Wa.call(this, e),
                    (e.drm.ignoreDuplicateInitData = 2 !== this.Ba()),
                    3 === this.Ba() && (e.streaming.crossBoundaryStrategy = "reset_to_encrypted"),
                    (e.streaming.shouldFixTimestampOffset = !0),
                    (e.streaming.stallSkip = 0),
                    (e.streaming.gapPadding = 2),
                    e
                  );
                }),
                (n.Li = function () {
                  var e = [];
                  return (null !== this.g && this.g < 5 && e.push("opus"), e);
                }),
                (n.sd = function (e) {
                  try {
                    if (webapis.avinfo.isHdrTvSupport()) return e ? "HLG" : "PQ";
                  } catch (t) {
                    return Yv.prototype.sd.call(this, e);
                  }
                  return "SDR";
                }),
                (n.Bi = function () {
                  return !0;
                }),
                (n.Ci = function () {
                  return 3 === this.Ba();
                }),
                navigator.userAgent.includes("Tizen") &&
                  (oe = function () {
                    return new oy();
                  }),
                f(ly, Yv),
                (ly.prototype.Ba = function () {
                  return null;
                }),
                (ly.prototype.Nb = function () {
                  return "Vizio";
                }),
                (ly.prototype.Oa = function () {
                  return "TV";
                }),
                (ly.prototype.hc = function () {
                  return !1;
                }),
                navigator.userAgent.includes("VIZIO SmartCast") &&
                  (oe = function () {
                    return new ly();
                  }),
                f(uy, Yv),
                ((n = uy.prototype).Ba = function () {
                  return this.g.value();
                }),
                (n.Nb = function () {
                  return "WebKit STB";
                }),
                (n.Oa = function () {
                  return "TV";
                }),
                (n.Ha = function () {
                  return "WEBKIT";
                }),
                (n.hc = function () {
                  return !1;
                }),
                (n.fd = function () {
                  var e = this.g.value();
                  return null === e || e >= 15;
                }),
                (n.Fd = function () {
                  return this.h.value();
                }),
                (n.lc = function () {
                  return Promise.resolve({
                    width: e.screen.width * e.devicePixelRatio,
                    height: e.screen.height * e.devicePixelRatio,
                  });
                }),
                (n.Of = function () {
                  return !this.i.value();
                }),
                (n.Nf = function () {
                  return !1;
                }),
                (navigator.userAgent.includes("SOPOpenBrowser") ||
                  navigator.userAgent.includes("DT_STB_BCM") ||
                  navigator.userAgent.includes("Sky_STB") ||
                  !(
                    !(navigator.vendor || "").includes("Apple") ||
                    /(?:iPhone|iPad|iPod)/.test(navigator.userAgent) ||
                    navigator.maxTouchPoints > 1 ||
                    (navigator.userAgentData &&
                      navigator.userAgentData.platform &&
                      "macos" == navigator.userAgentData.platform.toLowerCase()) ||
                    (navigator.platform && navigator.platform.toLowerCase().includes("mac"))
                  )) &&
                  (oe = function () {
                    return new uy();
                  }),
                f(dy, Yv),
                ((n = dy.prototype).Ba = function () {
                  return this.h;
                }),
                (n.Nb = function () {
                  return "WebOS";
                }),
                (n.Oa = function () {
                  return "TV";
                }),
                (n.Ha = function () {
                  return "CHROMIUM";
                }),
                (n.hc = function () {
                  return !1;
                }),
                (n.fd = function () {
                  var e = this.Ba();
                  return null !== e ? e > 3 : Yv.prototype.fd.call(this);
                }),
                (n.Ib = function () {
                  return !1;
                }),
                (n.we = function () {
                  var e = this.Ba();
                  return null !== e ? e > 3 : Yv.prototype.we.call(this);
                }),
                (n.lc = function () {
                  var t = { width: 1920, height: 1080 };
                  try {
                    var r = JSON.parse(e.PalmSystem.deviceInfo);
                    ((t.width = Math.max(1920, r.screenWidth)), (t.height = Math.max(1080, r.screenHeight)));
                  } catch (i) {
                    z("WebOS: Error detecting screen size, default screen size 1920x1080.");
                  }
                  return Promise.resolve(t);
                }),
                (n.Wa = function (e) {
                  return (
                    Yv.prototype.Wa.call(this, e),
                    3 === this.Ba() && (e.streaming.crossBoundaryStrategy = "reset"),
                    (e.streaming.shouldFixTimestampOffset = !0),
                    (e.streaming.stallSkip = 0),
                    e
                  );
                }),
                (n.sd = function (e) {
                  return null == this.g
                    ? (z("WebOS: getConfigs call haven't finished"), Yv.prototype.sd.call(this, e))
                    : this.g
                      ? e
                        ? "HLG"
                        : "PQ"
                      : "SDR";
                }),
                (n.fj = function () {
                  return !1;
                }),
                (n.ed = function () {
                  var e = this.Ba();
                  return null !== e ? e >= 6 : Yv.prototype.ed.call(this);
                }),
                navigator.userAgent.includes("Web0S"))
              ) {
                var hy = new dy();
                oe = function () {
                  return hy;
                };
              }
              function cy() {
                (Yv.call(this), (this.g = navigator.userAgent.includes("Edge/")));
                var e = navigator.userAgent.match(/Edge?\/(\d+)/);
                this.h = e ? parseInt(e[1], 10) : null;
              }
              function fy() {
                var e = null;
                try {
                  e = "undefined" != typeof Windows ? Windows : chrome.webview.hostObjects.sync.Windows;
                } catch (t) {}
                return e;
              }
              function py(e, t, r) {
                ((this.type = e), (this.ha = t), (this.segments = r || null));
              }
              function gy(e, t, r, i) {
                ((this.id = e),
                  (this.name = t),
                  (this.attributes = r),
                  (this.value = void 0 === i ? null : i));
              }
              function my(e, t) {
                return t
                  ? e.toString()
                  : ((t = new Set()
                      .add("AUDIO")
                      .add("VIDEO")
                      .add("SUBTITLES")
                      .add("PATHWAY-ID")
                      .add("GROUP-ID")
                      .add("URI")),
                    e.toString(t));
              }
              function vy(e, t) {
                return (
                  e.attributes.find(function (e) {
                    return e.name === t;
                  }) || null
                );
              }
              function yy(e, t, r) {
                return (e = vy(e, t)) ? e.value : r || null;
              }
              function Ty(e, t) {
                if (!(e = vy(e, t))) throw new ze(2, 4, 4023, t);
                return e.value;
              }
              function by(e, t, r) {
                ((r = void 0 === r ? [] : r), (this.ha = t), (this.g = e), (this.wc = r));
              }
              function Sy(e, t) {
                ((this.name = e), (this.value = t));
              }
              function Ey(e, t) {
                return e.filter(function (e) {
                  return e.name == t;
                });
              }
              function xy(e, t) {
                return e.filter(function (e) {
                  return Ty(e, "TYPE") == t;
                });
              }
              function wy(e, t) {
                for (var r = (e = g(e)).next(); !r.done; r = e.next()) if ((r = r.value).name === t) return r;
                return null;
              }
              function Ay(e, t, r) {
                return ((r = void 0 === r ? 0 : r), (e = wy(e, t)) ? Number(e.value) : r);
              }
              function Iy(e, t, r) {
                return t ? ky(e, [t], r) : [];
              }
              function ky(e, t, r) {
                if (!t.length) return [];
                var i = t;
                return (
                  r &&
                    r.size &&
                    (i = t.map(function (e) {
                      return Ry(e, r);
                    })),
                  ut(e, i)
                );
              }
              function Ry(e, t) {
                if (!t || !t.size) return e;
                var r = (e = String(e).replace(/%7B/g, "{").replace(/%7D/g, "}")).match(/{\$\w*}/g);
                if (r)
                  for (var i = (r = g(r)).next(); !i.done; i = r.next()) {
                    var n = (i = i.value).slice(2, i.length - 1),
                      a = t.get(n);
                    if (!a) throw new ze(2, 4, 4039, n);
                    e = e.replace(i, a);
                  }
                return e;
              }
              function Cy() {
                this.g = 0;
              }
              function Ly(e, t) {
                var r = (t = (t = Xe(t)).replace(/\r\n|\r(?=[^\n]|$)/gm, "\n").trim()).split(/\n+/m);
                if (!_y.test(r[0])) throw new ze(2, 4, 4015);
                t = 0;
                for (var i = !1, n = [], a = !0, s = 0; s < r.length; s++) {
                  var o = r[s],
                    l = r[s + 1];
                  if ((o.startsWith("#") && !o.startsWith("#EXT")) || a) a = !1;
                  else {
                    if (
                      ((o = My(e, o)),
                      i ||
                        (Ny.has(o.name)
                          ? ((t = 1), (i = !0))
                          : "EXT-X-STREAM-INF" == o.name || "EXT-X-MEDIA" == o.name
                            ? (i = !0)
                            : Fy.has(o.name) && ((t = 1), (i = !0))),
                      Fy.has(o.name))
                    ) {
                      if (1 != t) throw new ze(2, 4, 4017);
                      ((a = e),
                        (e = Array(Math.max(100, Math.floor((r.length - s) / 2)))),
                        (i = 0),
                        (o = []));
                      var u = [];
                      for (l = null; s < r.length; s++) {
                        var d = r[s];
                        d.startsWith("#EXT")
                          ? ((d = My(a, d)),
                            Ny.has(d.name)
                              ? n.push(d)
                              : "EXT-X-MAP" == d.name
                                ? (l = d)
                                : "EXT-X-PART" == d.name
                                  ? u.push(d)
                                  : "EXT-X-PRELOAD-HINT" == d.name
                                    ? "PART" == yy(d, "TYPE")
                                      ? u.push(d)
                                      : "MAP" == yy(d, "TYPE") && ((d.name = "EXT-X-MAP"), (l = d))
                                    : o.push(d))
                          : (d.startsWith("#") && !d.startsWith("#EXT")) ||
                            ((d = d.trim()),
                            l && o.push(l),
                            (o = new by(d, o, u)),
                            i < e.length ? (e[i++] = o) : (e.push(o), i++),
                            (o = []),
                            (u = []));
                      }
                      return (
                        u.length &&
                          (l && o.push(l),
                          (r = new by("", o, u)),
                          i < e.length ? (e[i++] = r) : (e.push(r), i++)),
                        new py(t, n, i < e.length ? e.slice(0, i) : e)
                      );
                    }
                    (n.push(o),
                      "EXT-X-STREAM-INF" == o.name && (o.attributes.push(new Sy("URI", l)), (a = !0)));
                  }
                }
                return new py(t, n);
              }
              function My(e, t) {
                e = e.g++;
                var r = t.match(Dy);
                if (!r) throw new ze(2, 4, 4016, t);
                t = r[1];
                var i,
                  n,
                  a = r[2];
                if (((r = []), a))
                  for (
                    a = new Ut(a),
                      Py.lastIndex = 0,
                      (n = $t(a, Py)) && (i = n[1]),
                      Oy.lastIndex = 0,
                      n = $t(a, Oy);
                    n;
                  )
                    (r.push(new Sy(n[1], n[2] || n[3])), Bt(a), (n = $t(a, Oy)));
                return new gy(e, t, r, i);
              }
              (f(cy, Yv),
                ((n = cy.prototype).Ba = function () {
                  return this.h;
                }),
                (n.Nb = function () {
                  return "Xbox";
                }),
                (n.Oa = function () {
                  return "CONSOLE";
                }),
                (n.Ha = function () {
                  return this.g ? "EDGE" : "CHROMIUM";
                }),
                (n.Fd = function () {
                  return !0;
                }),
                (n.ih = function () {
                  return !0;
                }),
                (n.jf = function () {
                  return !0;
                }),
                (n.$i = function () {
                  return this.g;
                }),
                (n.lc = function () {
                  var e = { width: 1920, height: 1080 },
                    t = fy();
                  if (t)
                    try {
                      var r = new t.Media.Protection.ProtectionCapabilities(),
                        i = t.Media.Protection.ProtectionCapabilityResult;
                      t = null;
                      do {
                        t = r.isTypeSupported(
                          'video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',
                          "com.microsoft.playready.recommendation",
                        );
                      } while (t === i.maybe);
                      t === i.probably && ((e.width = 3840), (e.height = 2160));
                    } catch (n) {
                      z("Xbox: Error detecting screen size, default screen size 1920x1080.");
                    }
                  return Promise.resolve(e);
                }),
                (n.Wa = function (e) {
                  return (
                    Yv.prototype.Wa.call(this, e),
                    (e.drm.parseInbandPsshEnabled = this.g),
                    e.drm.preferredKeySystems.push("com.microsoft.playready"),
                    this.g && (e.streaming.gapPadding = 0.01),
                    e
                  );
                }),
                (n.Ff = function () {
                  return !0;
                }),
                (n.Ch = function () {
                  return !1;
                }),
                (navigator.userAgent.includes("Xbox One") || null !== fy()) &&
                  (oe = function () {
                    return new cy();
                  }),
                (gy.prototype.toString = function (e) {
                  var t = "#" + this.name,
                    r = this.attributes
                      ? this.attributes
                          .filter(function (t) {
                            return !e || !e.has(t.name);
                          })
                          .map(function (e) {
                            return e.name + "=" + (isNaN(Number(e.value)) ? '"' + e.value + '"' : e.value);
                          })
                      : [];
                  return (this.value && r.unshift(this.value), r.length > 0 && (t += ":" + r.join(",")), t);
                }));
              var Dy = /^#(EXT[^:]*)(?::(.*))?$/,
                _y = /^#EXTM3U($|[ \t\n])/m,
                Py = /^([^,=]+)(?:,|$)/g,
                Oy = /([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,
                Ny = new Set(
                  "EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(
                    " ",
                  ),
                ),
                Fy = new Set(
                  "EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(
                    " ",
                  ),
                );
              function Uy() {}
              function By(e, t) {
                try {
                  var r = $y(e);
                  return Mn({
                    uri: e,
                    originalUri: e,
                    data: r.data,
                    headers: { "content-type": r.contentType },
                    originalRequest: t,
                  });
                } catch (i) {
                  return Cn(i);
                }
              }
              function $y(t) {
                var r = t.split(":");
                if (r.length < 2 || "data" != r[0]) throw new ze(2, 1, 1004, t);
                if ((r = r.slice(1).join(":").split(",")).length < 2) throw new ze(2, 1, 1004, t);
                var i = r[0];
                ((t = e.decodeURIComponent(r.slice(1).join(","))), (r = i.split(";")), (i = r[0]));
                var n = !1;
                return (
                  r.length > 1 && "base64" == r[r.length - 1] && ((n = !0), r.pop()),
                  { data: n ? at(t) : Je(t), contentType: i, Ih: r }
                );
              }
              function jy() {
                var t = this;
                ((this.g = this.h = null),
                  (this.G = 1),
                  (this.B = new Map()),
                  (this.M = new Map()),
                  (this.C = new Map()),
                  this.C.set("video", new Map()),
                  this.C.set("audio", new Map()),
                  this.C.set(gt, new Map()),
                  this.C.set("image", new Map()),
                  (this.dc = new Map()
                    .set("com.apple.streamingkeydelivery", function (r, i, n) {
                      return (function (t, r, i, n) {
                        var a, s, o, l, u;
                        return D(function (d) {
                          if (1 == d.g) {
                            if ("video/mp2t" == i) throw new ze(2, 4, 4040);
                            if ("apple" === e.shakaMediaKeysPolyfill) throw new ze(2, 4, 4041);
                            if (((a = Ty(r, "METHOD")), !["SAMPLE-AES", "SAMPLE-AES-CTR"].includes(a)))
                              return d.return(null);
                            ((s = "cenc"),
                              "SAMPLE-AES" == a && (s = "cbcs"),
                              (o = Ty(r, "URI")),
                              (l = dt("com.apple.fps", s, null, o)));
                            var h = new me(o).Db.replace(/-/g, "").toLowerCase();
                            return (u = 32 === h.length && /^[0-9a-f]+$/.test(h) ? h : null) || !n
                              ? d.A(2)
                              : b(d, LT(t, n), 3);
                          }
                          return (2 != d.g && (u = d.h), u && l.keyIds.add(u), d.return(l));
                        });
                      })(t, r, i, n);
                    })
                    .set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed", function (e) {
                      var r = Ty(e, "METHOD");
                      if (["SAMPLE-AES", "SAMPLE-AES-CTR"].includes(r)) {
                        var i = "cenc";
                        "SAMPLE-AES" == r && (i = "cbcs");
                        var n = Ty(e, "URI");
                        if (((r = $y(n.split("?")[0])), (n = n.split("?")[0]), !t.I.has(n))) {
                          var a = Oe(r.data);
                          t.I.set(n, a);
                        }
                        ((i = dt(
                          "com.widevine.alpha",
                          i,
                          [{ initDataType: "cenc", initData: t.I.get(n) }],
                          void 0,
                          r.Ih,
                        )),
                          (e = yy(e, "KEYID")) && i.keyIds.add(e.toLowerCase().substr(2)),
                          (e = Promise.resolve(i)));
                      } else e = Promise.resolve(null);
                      return e;
                    })
                    .set("com.microsoft.playready", function (e) {
                      var t = Ty(e, "METHOD");
                      if (["SAMPLE-AES", "SAMPLE-AES-CTR"].includes(t)) {
                        var r = "cenc";
                        ("SAMPLE-AES" == t && (r = "cbcs"),
                          (t = $y((e = Ty(e, "URI")).split("?")[0])),
                          (e = Oe(t.data)));
                        var i = new Uint8Array([
                          154, 4, 240, 121, 152, 64, 66, 134, 171, 146, 230, 91, 224, 136, 95, 149,
                        ]);
                        ((r = dt(
                          "com.microsoft.playready",
                          r,
                          [{ initDataType: "cenc", initData: (i = va(e, i, new Set(), 0)) }],
                          void 0,
                          t.Ih,
                        )),
                          (e = Yt(["<PLAYREADY>", nt(e), "</PLAYREADY>"].join("\n"))) &&
                            (r.licenseServerUri = Qg(e)),
                          (r = Promise.resolve(r)));
                      } else r = Promise.resolve(null);
                      return r;
                    })
                    .set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c", function (e) {
                      var r = Ty(e, "METHOD");
                      if (["SAMPLE-AES", "SAMPLE-AES-CTR"].includes(r)) {
                        var i = "cenc";
                        "SAMPLE-AES" == r && (i = "cbcs");
                        var n = Ty(e, "URI");
                        if (((r = $y(n.split("?")[0])), (n = n.split("?")[0]), !t.I.has(n))) {
                          var a = Oe(r.data);
                          t.I.set(n, a);
                        }
                        ((i = dt(
                          "com.huawei.wiseplay",
                          i,
                          [{ initDataType: "cenc", initData: t.I.get(n) }],
                          void 0,
                          r.Ih,
                        )),
                          (e = yy(e, "KEYID")) && i.keyIds.add(e.toLowerCase().substr(2)),
                          (e = Promise.resolve(i)));
                      } else e = Promise.resolve(null);
                      return e;
                    })),
                  (this.ob = new Set()),
                  (this.i = new Map()),
                  (this.l = null),
                  (this.H = ""),
                  (this.ab = new Cy()),
                  (this.N = -1),
                  (this.ma = 1 / 0),
                  (this.ba = this.zc = this.kb = !1),
                  (this.F = new Ri(function () {
                    t.X && !t.g.continueLoadingWhenPaused && (t.V.Ma(t.X, "timeupdate"), t.X.paused)
                      ? t.V.Aa(t.X, "timeupdate", function () {
                          return wT(t);
                        })
                      : wT(t);
                  })),
                  (this.Fa = UT),
                  (this.m = null),
                  (this.eb = 0),
                  (this.o = 1 / 0),
                  (this.Ua = this.Ta = this.T = 0),
                  (this.$ = new Un()),
                  (this.J = new Map()),
                  (this.K = new Map()),
                  (this.Da = new Map()),
                  (this.va = new Map()),
                  (this.O = new Map()),
                  (this.ya = new Map()),
                  (this.za = new Map()),
                  (this.yc = this.oa = !1),
                  (this.ac = new G(5)),
                  (this.j = null),
                  (this.R = !0),
                  (this.V = new re()),
                  (this.u = this.X = null),
                  (this.cc = function () {
                    return !1;
                  }),
                  (this.I = new Map()));
              }
              function Gy(e, t) {
                return AT(e) ? e.C.get(t.type) : t.rf;
              }
              function Vy(e, t) {
                var r,
                  i,
                  n,
                  a,
                  s,
                  o,
                  l,
                  u,
                  d,
                  h,
                  c,
                  f,
                  p,
                  v,
                  y,
                  T,
                  x,
                  I,
                  k,
                  R,
                  C,
                  L,
                  M,
                  _,
                  P,
                  O,
                  N,
                  F,
                  U,
                  B,
                  $,
                  j,
                  G,
                  V,
                  H;
                return D(function (D) {
                  switch (D.g) {
                    case 1:
                      if (t.stream.isAudioMuxedInVideo) return D.return();
                      for (r = [], i = g(t.P()), n = i.next(); !n.done; n = i.next())
                        ((a = n.value),
                          (s = new me(a)),
                          (o = s.g),
                          t.Ue &&
                            (t.Qb >= 0 && o.add("_HLS_msn", String(t.Qb)),
                            t.Rb >= 0 && o.add("_HLS_part", String(t.Rb))),
                          t.Ve && o.add("_HLS_skip", "YES"),
                          Me(o) && be(s, Se(o.toString())),
                          r.push(s.toString()));
                      return (E(D, 2), b(D, xT(e, r, !0).promise, 4));
                    case 4:
                      ((l = D.h), w(D, 3));
                      break;
                    case 2:
                      throw ((u = A(D)), e.h && e.h.disableStream(t.stream), u);
                    case 3:
                      if (!t.stream.segmentIndex) return D.return();
                      if (1 != (d = Ly(e.ab, l.data)).type) throw new ze(2, 4, 4017);
                      return (
                        (h = l.uri) == l.originalUri || t.P().includes(h) || t.Df.push(h),
                        (c = Ey(d.ha, "EXT-X-DEFINE")),
                        (f = qy(e, c, h)),
                        (p = t.stream),
                        (v = Gy(e, t)),
                        b(D, uT(e, d, p.mimeType, t.P, f), 5)
                      );
                    case 5:
                      for (
                        y = D.h,
                          T = y.keyIds,
                          x = y.drmInfos,
                          I = y.encrypted,
                          k = y.Qh,
                          p.encrypted || !I || k || (p.encrypted = !0),
                          (function (e, t) {
                            return (
                              e.size === t.size &&
                              [].concat(m(e)).every(function (e) {
                                return t.has(e);
                              })
                            );
                          })(p.keyIds, T) || ((p.keyIds = T), (p.drmInfos = x), e.h.newDrmInfo(p)),
                          R = yT(e, d, v, f, t.P, t.type),
                          C = R.segments,
                          (L = R.bandwidth) && (p.bandwidth = L),
                          M = Gl(p),
                          _ = g(C),
                          P = _.next();
                        !P.done;
                        P = _.next()
                      )
                        (O = P.value).ea && (O.ea.xd = M);
                      (p.segmentIndex.ke(C, e.l.Hb()),
                        C.length &&
                          ((N = Ay(d.ha, "EXT-X-MEDIA-SEQUENCE", 0)),
                          (U = (F = wy(d.ha, "EXT-X-SKIP")) ? Number(yy(F, "SKIPPED-SEGMENTS")) : 0),
                          (B = oT(N, C)),
                          ($ = B.Qb),
                          (j = B.Rb),
                          (t.Qb = $ + U),
                          (t.Rb = j),
                          (G = v.get(N)),
                          p.segmentIndex.Ya(G)),
                        (V = Dl(p.segmentIndex)) &&
                          ((t.Wc = V.startTime), (H = C[C.length - 1]), (t.Mc = H.endTime)),
                        wy(d.ha, "EXT-X-ENDLIST") && (t.be = !0),
                        cT(e, d),
                        vT(e, d.ha, p.type, f, t.P),
                        S(D));
                  }
                });
              }
              function Hy(e, t, r) {
                r = void 0 !== r && r;
                for (var i = -1 == e.N, n = g(t), a = n.next(); !a.done; a = n.next()) {
                  var s = (a = a.value).stream.segmentIndex,
                    o = Gy(e, a);
                  if ((s = Dl(s)))
                    for (var l = (o = g(o)).next(); !l.done; l = o.next()) {
                      var u = (l = g(l.value)).next().value;
                      if (l.next().value == s.startTime) {
                        (i && (e.N = Math.max(e.N, u)), (a.sg = u));
                        break;
                      }
                    }
                }
                if (!(e.N < 0))
                  for (i = (t = g(t)).next(); !i.done; i = t.next())
                    (aT(e, (i = i.value).type) || r) &&
                      (n = i.stream.segmentIndex) &&
                      (a = e.N - i.sg) > 0 &&
                      (n.g.splice(0, a), (n = Dl(n))) &&
                      ((n = -n.startTime), i.stream.segmentIndex.offset(n), Ky(e, i, n));
              }
              function Ky(e, t, r) {
                if (!(Math.abs(r) < 0.001)) {
                  ((t.Wc += r), (t.Mc += r));
                  for (var i = g((e = Gy(e, t))), n = i.next(); !n.done; n = i.next()) {
                    var a = g(n.value);
                    ((n = a.next().value), (a = a.next().value), e.set(n, a + r));
                  }
                  t.P();
                }
              }
              function Wy(e, t, r) {
                var i, n, a, s, o;
                return D(function (l) {
                  switch (l.g) {
                    case 1:
                      return t
                        ? ((i = qn),
                          (n = lu(t.P(), t.Jc(), t.Hc(), e.g.retryParameters)),
                          b(l, kT(e, n, i, { type: t instanceof Bs ? 1 : 0 }).promise, 2))
                        : l.return({ mimeType: null, data: null });
                    case 2:
                      if (((a = l.h), (s = a.data), !t.aesKey)) {
                        l.A(3);
                        break;
                      }
                      return b(l, au(s, t.aesKey, r), 4);
                    case 4:
                      s = l.h;
                    case 3:
                      return (
                        t instanceof Bs ? t.ue(s, !0) : t.ue(s),
                        (o = a.headers["content-type"]) && (o = o.split(";")[0].toLowerCase()),
                        l.return({ mimeType: o, data: s })
                      );
                  }
                });
              }
              function zy(e) {
                if (AT(e)) {
                  if (e.Fa == $T) {
                    for (var t = 1 / 0, r = 1 / 0, i = g(e.i.values()), n = i.next(); !n.done; n = i.next())
                      (n = n.value).stream.segmentIndex &&
                        "text" != n.stream.type &&
                        !n.stream.isAudioMuxedInVideo &&
                        ((t = Math.min(t, n.Mc)), (r = Math.min(r, n.Wc)));
                    ((t = t - r || 0),
                      isNaN(e.g.availabilityWindowOverride) || (t = e.g.availabilityWindowOverride),
                      e.l.Lf(t));
                  }
                } else e.l.Ab(rT(e));
                if (!e.l.o)
                  for (r = (t = g(e.i.values())).next(); !r.done; r = t.next())
                    !(r = r.value).stream.segmentIndex ||
                      ("audio" != r.type && "video" != r.type) ||
                      ((r = Dl(r.stream.segmentIndex)) && r.h && e.l.sh(r.h));
                e.l.qf();
              }
              function qy(e, t, r) {
                r = new me(r).g;
                for (var i = new Map(), n = (t = g(t)).next(); !n.done; n = t.next()) {
                  var a = n.value,
                    s = yy(a, "NAME"),
                    o = yy(a, "VALUE");
                  ((n = yy(a, "QUERYPARAM")),
                    (a = yy(a, "IMPORT")),
                    s && o && (i.has(s) || i.set(s, o)),
                    n && (s = r.get(n)[0]) && !i.has(s) && i.set(n, s),
                    a && (n = e.B.get(a)) && i.set(a, n));
                }
                return i;
              }
              function Xy(e) {
                var t = new Set([li(e.mimeType, e.codecs)]);
                (e.segmentIndex &&
                  e.segmentIndex.Fb(function (r) {
                    r.mimeType && t.add(li(r.mimeType, e.codecs));
                  }),
                  (e.fullMimeTypes = t));
              }
              function Yy(e, t, r) {
                for (
                  var i = { audio: [], video: [] },
                    n = new Map(),
                    a = [],
                    s = !1,
                    o = !1,
                    l = g(t),
                    u = l.next();
                  !u.done;
                  u = l.next()
                ) {
                  var d = u.value;
                  u = yy(d, "AUDIO");
                  var h = yy(d, "VIDEO"),
                    c = u || h;
                  c &&
                    (a.includes(c) || a.push(c),
                    (d = yy(d, "PATHWAY-ID")) && n.set(c, d),
                    u ? (s = !0) : h && (o = !0));
                }
                (a.length &&
                  r.length &&
                  (function (e, t, r) {
                    t = t.filter(function (e) {
                      var t = yy(e, "URI") || "";
                      return "SUBTITLES" != (e = yy(e, "TYPE")) && ("" != t || "AUDIO" == e);
                    });
                    for (var i = {}, n = (t = g(t)).next(); !n.done; n = t.next()) {
                      var a = my((n = n.value), !e.j);
                      i[a] ? i[a].push(n) : (i[a] = [n]);
                    }
                    for (var s in i) Zy(e, i[s], r, !1);
                  })(
                    e,
                    (r = r.filter(function (e) {
                      return a.includes(Ty(e, "GROUP-ID"));
                    })),
                    n,
                  ),
                  (r = (n = a.sort().join(",")) && e.M.has(n) ? e.M.get(n) : []),
                  s ? i.audio.push.apply(i.audio, m(r)) : o && i.video.push.apply(i.video, m(r)),
                  (o = !1));
                var f = t.map(function (e) {
                  return Ty(e, "URI");
                });
                return (
                  (s = i.audio.find(function (e) {
                    return (
                      e &&
                      e.P().find(function (e) {
                        return f.includes(e);
                      })
                    );
                  })),
                  (l = ft("video", (r = Qy(e, t[0])))),
                  (u = ft("audio", r)) && !l
                    ? ((s = "audio"),
                      (o =
                        i.audio.length > 0 &&
                        !i.audio.some(function (e) {
                          return e.stream.isAudioMuxedInVideo;
                        })))
                    : !i.audio.length && !i.video.length && u && l
                      ? ((s = "video"), (r = [[l, u].join()]))
                      : i.audio.length && s
                        ? ((s = "audio"), (o = !0))
                        : (s = i.video.length && !i.audio.length ? "audio" : "video"),
                  o ||
                    ((t = (function (e, t, r, i) {
                      for (var n = e.G++, a = [], s = g(t), o = s.next(); !o.done; o = s.next()) {
                        var l = o.value;
                        ((o = Ty(l, "URI")),
                          (l = yy(l, "PATHWAY-ID")),
                          e.j && l && Fm(e.j, n, l, o),
                          a.push(o));
                      }
                      if (((s = a.sort().join(",") + r.sort().join(",")), e.i.has(s))) return e.i.get(s);
                      o = a.join(",");
                      e: {
                        if (((t = yy(t[0], "CLOSED-CAPTIONS")), "video" == i)) {
                          if (e.g.disableText) {
                            ((e.R = !1), (t = null));
                            break e;
                          }
                          if (t) {
                            if ("NONE" != t) {
                              t = e.J.get(t);
                              break e;
                            }
                            e.R = !1;
                          } else if (!t && e.J.size)
                            for (t = (t = g(e.J.keys())).next(); !t.done; t = t.next()) {
                              t = e.J.get(t.value);
                              break e;
                            }
                        }
                        t = null;
                      }
                      return (
                        (r = ct(i, r)),
                        (i = tT(e, n, a, r, i, null, !1, o, null, t, null, !1, null, !1)),
                        e.i.set(s, i),
                        i
                      );
                    })(e, t, r, s)),
                    n && e.g.enableAudioGroups && (t.stream.groupId = n),
                    "audio" == t.stream.type &&
                      "audio" === s &&
                      i.audio.some(function (e) {
                        return e.stream.isAudioMuxedInVideo;
                      }) &&
                      ((e = i.audio[0].stream),
                      (t.stream.language = e.language),
                      (t.stream.channelsCount = e.channelsCount),
                      (t.stream.label = e.label),
                      (t.stream.audioSamplingRate = e.audioSamplingRate),
                      (t.stream.originalId = e.originalId),
                      (t.stream.originalLanguage = e.originalLanguage)),
                    (i[t.stream.type] = [t])),
                  i
                );
              }
              function Qy(e, t) {
                return (
                  (t = yy(t, "CODECS") || ""),
                  (e.ba = t.length > 0),
                  e.ba ||
                    e.g.hls.disableCodecGuessing ||
                    ((t = []),
                    e.g.disableVideo || t.push(e.g.hls.defaultVideoCodec),
                    e.g.disableAudio || t.push(e.g.hls.defaultAudioCodec),
                    (t = t.join(","))),
                  nu(t.split(/\s*,\s*/))
                );
              }
              function Jy(e, t, r, i, n, a, s, o, l, u, d, h) {
                for (var c = g(r), f = c.next(); !f.done; f = c.next())
                  ET(f.value.stream, n, a, s, o, l, null);
                for (
                  n = e.g.disableVideo,
                    (r.length && !n) || (r = [null]),
                    n &&
                      (t = t.filter(function (e) {
                        return !e.stream.isAudioMuxedInVideo;
                      })),
                    n = e.g.disableAudio,
                    (t.length && !n) || (t = [null]),
                    n = [],
                    a = (t = g(t)).next();
                  !a.done;
                  a = t.next()
                )
                  for (a = a.value, o = (s = g(r)).next(); !o.done; o = s.next()) {
                    var p = o.value;
                    ((o = a ? a.stream : null) && ((o.drmInfos = u), (o.keyIds = d)),
                      (l = p ? p.stream : null) &&
                        ((l.drmInfos = u), (l.keyIds = d), e.g.disableIFrames || cn(l, h)),
                      l && !o && (l.bandwidth = i),
                      !l && o && (o.bandwidth = i),
                      (c = a ? a.stream.drmInfos : null),
                      (f = p ? p.stream.drmInfos : null),
                      (p = p ? p.P().sort().join(",") : ""));
                    var m = a ? a.P().sort().join(",") : "",
                      v = [];
                    (o && o.codecs && v.push(o.codecs),
                      l && l.codecs && v.push(l.codecs),
                      (p = [p, m, v.sort()].join("-")),
                      (o && l && !Be(c, f)) ||
                        e.ob.has(p) ||
                        ((o = {
                          id: e.G++,
                          language: o ? o.language : "und",
                          disabledUntilTime: 0,
                          primary: (!!o && o.primary) || (!!l && l.primary),
                          audio: o,
                          video: l,
                          bandwidth: i,
                          allowedByApplication: !0,
                          allowedByKeySystem: !0,
                          decodingInfos: [],
                        }),
                        n.push(o),
                        e.ob.add(p)));
                  }
                return n;
              }
              function Zy(e, t, r, i) {
                i = void 0 === i || i;
                for (
                  var n = [], a = [], s = new Map(), o = g(t), l = o.next(), u = {};
                  !l.done;
                  u = { oi: void 0 }, l = o.next()
                ) {
                  ((l = l.value),
                    (u.oi = ++e.G),
                    (u = (function (e) {
                      return function () {
                        return "shaka://hls-muxed" + e.oi;
                      };
                    })(u)));
                  var d = i ? Ty(l, "URI") : yy(l, "URI") || u();
                  ((u = Ty(l, "GROUP-ID")),
                    n.push(d),
                    a.push(u),
                    s.set(u, d),
                    (l = yy(l, "PATHWAY-ID")) && r.set(u, l));
                }
                if (
                  ((i = a.sort().join(",")),
                  (l = t[0]),
                  (t = ""),
                  (o = (function (e) {
                    return ("subtitles" == (e = Ty(e, "TYPE").toLowerCase()) && (e = gt), e);
                  })(l)),
                  o == gt)
                )
                  t = yy(l, "CODECS") || "";
                else
                  for (u = (a = g(a)).next(); !u.done; u = a.next())
                    if (((u = u.value), e.K.has(u))) {
                      t = e.K.get(u);
                      break;
                    }
                if (((a = n.sort().join(",")), "audio" == o && i && (a += i), e.i.has(a))) return e.i.get(a);
                if (((u = e.G++), e.j))
                  for (d = (s = g(s)).next(); !d.done; d = s.next()) {
                    var h = g(d.value);
                    ((d = h.next().value), (h = h.next().value), (d = r.get(d)) && Fm(e.j, u, d, h));
                  }
                ((r = yy(l, "LANGUAGE")),
                  (s = yy(l, "NAME")),
                  (d = "YES" == yy(l, "DEFAULT")),
                  (h =
                    "audio" == o
                      ? (function (e) {
                          return (e = yy(e, "CHANNELS")) ? parseInt(e.split("/")[0], 10) : null;
                        })(l)
                      : null));
                var c =
                    "audio" == o &&
                    (function (e) {
                      return (
                        !!(e = yy(e, "CHANNELS")) &&
                        2 == (e = e.split("/")).length &&
                        ("JOC" === e[1] || e[1].includes("ATMOS"))
                      );
                    })(l),
                  f = yy(l, "CHARACTERISTICS"),
                  p = "YES" == yy(l, "FORCED");
                return (
                  (l =
                    "audio" == o
                      ? (function (e) {
                          return (e = yy(e, "SAMPLE-RATE")) ? parseInt(e, 10) : null;
                        })(l)
                      : null),
                  (n = tT(e, u, n, t, o, r, d, s, h, null, f, p, l, c)).stream &&
                    e.g.enableAudioGroups &&
                    (n.stream.groupId = i),
                  e.M.has(i) ? e.M.get(i).push(n) : e.M.set(i, [n]),
                  e.i.set(a, n),
                  n
                );
              }
              function eT(e, t) {
                var r = "video",
                  i = Ty(t, "URI"),
                  n = yy(t, "CODECS") || "";
                if (("mjpg" == n && (r = "image"), e.i.has(i))) return e.i.get(i);
                var a = yy(t, "LANGUAGE"),
                  s = yy(t, "NAME"),
                  o = yy(t, "CHARACTERISTICS");
                return (
                  (r = tT(e, e.G++, [i], n, r, a, !1, s, null, null, o, !1, null, !1)),
                  (a = g((n = yy(t, "RESOLUTION")) ? n.split("x") : [null, null])),
                  (n = a.next().value),
                  (a = a.next().value),
                  (r.stream.width = Number(n) || void 0),
                  (r.stream.height = Number(a) || void 0),
                  (t = yy(t, "BANDWIDTH")) && (r.stream.bandwidth = Number(t)),
                  e.i.set(i, r),
                  r
                );
              }
              function tT(e, t, r, i, n, a, s, o, l, u, d, h, c, f) {
                function p(t) {
                  var r, p, y, x, I, k, R, C, L, M, _, P, O, N, F, U, B, $;
                  return D(function (D) {
                    switch (D.g) {
                      case 1:
                        return ((r = mt), E(D, 2), b(D, t.promise, 4));
                      case 4:
                        if (((p = D.h), t.aborted)) return D.return();
                        if (
                          ((y = p.uri) != p.originalUri && (T.P().includes(y) || T.Df.push(y)),
                          1 != (x = Ly(e.ab, p.data)).type)
                        )
                          throw new ze(2, 4, 4017);
                        return (
                          (I = Ey(x.ha, "EXT-X-DEFINE")),
                          (k = qy(e, I, y)),
                          (R = !1),
                          ((!e.ba && e.g.hls.disableCodecGuessing) ||
                            (e.R && n == r.wa && !e.g.hls.disableClosedCaptionsDetection)) &&
                            x.segments.length > 0 &&
                            ((e.R = !1), (R = !0)),
                          (C = !e.ba && e.g.hls.disableCodecGuessing),
                          (L = AT(e)),
                          b(D, sT(e, 0, k, x, m, i, n, a, s, o, l, u, d, h, c, f, void 0, R, C), 5)
                        );
                      case 5:
                        if (((M = D.h), t.aborted)) return D.return();
                        ((_ = M.stream),
                          hT(e, x),
                          AT(e) && !L && fT(e, x),
                          (T.Wc = M.Wc),
                          (T.Mc = M.Mc),
                          (T.Ve = M.Ve),
                          (T.Ue = M.Ue),
                          (T.be = M.be),
                          (T.rf = M.rf),
                          (T.Qb = M.Qb),
                          (T.Rb = M.Rb),
                          (v.segmentIndex = _.segmentIndex),
                          (v.encrypted = _.encrypted),
                          (v.drmInfos = _.drmInfos),
                          (v.keyIds = _.keyIds),
                          (v.mimeType = _.mimeType),
                          (v.bandwidth = v.bandwidth || _.bandwidth),
                          (v.codecs = v.codecs || _.codecs),
                          (v.closedCaptions = v.closedCaptions || _.closedCaptions),
                          (v.width = v.width || _.width),
                          (v.height = v.height || _.height),
                          (v.hdr = v.hdr || _.hdr),
                          (v.colorGamut = v.colorGamut || _.colorGamut),
                          (v.frameRate = v.frameRate || _.frameRate),
                          "und" == v.language && "und" != _.language && (v.language = _.language),
                          (v.language = v.language || _.language),
                          (v.channelsCount = v.channelsCount || _.channelsCount),
                          (v.audioSamplingRate = v.audioSamplingRate || _.audioSamplingRate),
                          Xy(v),
                          v.drmInfos.length && e.h.newDrmInfo(v),
                          (P = !1),
                          ((!u && v.closedCaptions) ||
                            (u && v.closedCaptions && u.size != v.closedCaptions.size)) &&
                            (P = !0),
                          e.m && P && e.h.makeTextStreamsForClosedCaptions(e.m),
                          n == r.Na &&
                            (O = Dl(_.segmentIndex)) &&
                            O.ea &&
                            ((v.mimeType = "application/mp4"), Xy(v)),
                          (N = Gl(v)),
                          v.segmentIndex.Fb(function (e) {
                            e.ea && (e.ea.xd = N);
                          }),
                          (function (e) {
                            if (!e.m) return !1;
                            for (var t = [], r = [], i = (e = g(e.m.variants)).next(); !i.done; i = e.next())
                              ((i = i.value).video && t.push(i.video), i.audio && r.push(i.audio));
                            return !(
                              (t.length > 0 &&
                                !t.some(function (e) {
                                  return e.segmentIndex;
                                })) ||
                              (r.length > 0 &&
                                !r.some(function (e) {
                                  return e.segmentIndex;
                                }))
                            );
                          })(e) &&
                            (e.zc
                              ? nT(e, [T])
                              : ((e.zc = !0),
                                (F = Array.from(e.i.values())),
                                (U = F.filter(function (e) {
                                  return e.stream.segmentIndex;
                                })),
                                nT(e, U),
                                zy(e),
                                (B = e.o) > 0 && e.F.ka(B))),
                          vT(e, x.ha, v.type, k, m),
                          e.m && (e.m.startTime = e.u),
                          w(D, 0));
                        break;
                      case 2:
                        if ((($ = A(D)), v.closeSegmentIndex(), 7001 === $.code)) return D.return();
                        if (!e.h.disableStream(v)) throw $;
                        S(D);
                    }
                  });
                }
                function m() {
                  return e.j && r.length > 1 ? Um(e.j, t) : T.Df.concat(ky([e.H], r, e.B));
                }
                var v = lT(e, i, n, a, s, o, l, u, d, h, c, f);
                r.some(function (e) {
                  return e.startsWith("shaka://hls-muxed");
                }) && ((v.isAudioMuxedInVideo = !0), (v.mimeType = "video/mp2t"), Xy(v));
                var y,
                  T = {
                    stream: v,
                    type: n,
                    Df: [],
                    Wc: 0,
                    Mc: 0,
                    rf: new Map(),
                    Ve: !1,
                    Ue: !1,
                    be: !1,
                    sg: -1,
                    Qb: -1,
                    Rb: -1,
                    P: m,
                  },
                  x = null;
                return (
                  (v.createSegmentIndex = function () {
                    return (
                      x ||
                      (v.isAudioMuxedInVideo
                        ? ((v.segmentIndex = new Ml([])), Promise.resolve())
                        : ((y = xT(e, T.P(), !0)),
                          (x = new Promise(function (e) {
                            e(p(y));
                          }))))
                    );
                  }),
                  (v.closeSegmentIndex = function () {
                    (x && !v.segmentIndex && y.abort(),
                      v.segmentIndex && (v.segmentIndex.release(), (v.segmentIndex = null)),
                      (x = null));
                  }),
                  T
                );
              }
              function rT(e) {
                for (var t = 1 / 0, r = (e = g(e.i.values())).next(); !r.done; r = e.next())
                  (r = r.value).stream.segmentIndex &&
                    "text" != r.stream.type &&
                    !r.stream.isAudioMuxedInVideo &&
                    (t = Math.min(t, r.Mc));
                return t;
              }
              function iT(e, t) {
                for (var r = [], i = (t = g(t)).next(); !i.done; i = t.next())
                  (i = i.value).segmentIndex &&
                    i.segmentIndex.Fb(function (e) {
                      r.push(e);
                    });
                e.l.me(r);
              }
              function nT(e, t) {
                if (!AT(e))
                  for (var r = rT(e), i = g(t), n = i.next(); !n.done; n = i.next())
                    n.value.stream.segmentIndex.pd(0, r);
                (iT(
                  e,
                  t.map(function (e) {
                    return e.stream;
                  }),
                ),
                  (r = (i = Array.from(e.i.values()).filter(function (e) {
                    return e.stream.segmentIndex;
                  })).some(function (e) {
                    return "audio" == e.stream.type;
                  })),
                  (n = i.some(function (e) {
                    return "video" == e.stream.type;
                  })),
                  (i = AT(e) && !e.kb),
                  (r = !AT(e) && e.kb && !(r && n)),
                  e.g.hls.ignoreManifestProgramDateTime || i || r
                    ? Hy(e, t, i)
                    : ((function (e, t) {
                        if (e.ma == 1 / 0)
                          for (var r = (t = g(t)).next(); !r.done; r = t.next())
                            null != (r = Dl(r.value.stream.segmentIndex)) &&
                              null != r.h &&
                              (e.ma = Math.min(e.ma, r.h));
                        if ((t = e.ma) != 1 / 0)
                          for (var i = (r = g(e.i.values())).next(); !i.done; i = r.next())
                            if (!aT(e, (i = i.value).type)) {
                              var n = i.stream.segmentIndex;
                              if (null != n) {
                                var a = Dl(n);
                                if (a)
                                  if (null == a.h)
                                    W(
                                      "Missing EXT-X-PROGRAM-DATE-TIME for stream",
                                      i.P(),
                                      "Expect AV sync issues!",
                                    );
                                  else
                                    for (
                                      Ky(e, i, a.h - t - a.startTime), n = (i = g(n)).next();
                                      !n.done;
                                      n = i.next()
                                    )
                                      n.value.Dh(t);
                              }
                            }
                      })(e, t),
                      e.g.hls.ignoreManifestProgramDateTimeForTypes.length > 0 && Hy(e, t)));
              }
              function aT(e, t) {
                return (
                  !!e.g.hls.ignoreManifestProgramDateTime ||
                  e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)
                );
              }
              function sT(e, t, r, i, n, a, s, o, l, u, d, h, c, f, p, m, v, y, T) {
                var S, x, I, k, R, C, L, M, _, P, O, N, F, U, B, $, j, G, V, H, K, W, z, q, X, Y, Q, J, Z;
                return (
                  (y = void 0 === y || y),
                  (T = void 0 === T || T),
                  D(function (t) {
                    switch (t.g) {
                      case 1:
                        if (
                          ((S = i.segments || []),
                          (x = S.every(function (e) {
                            return !!wy(e.ha, "EXT-X-GAP");
                          })),
                          !S.length || x)
                        )
                          throw new ze(2, 4, 4053);
                        if (
                          ((function (e, t) {
                            var r = wy(t.ha, "EXT-X-PLAYLIST-TYPE");
                            ((t = wy(t.ha, "EXT-X-ENDLIST")),
                              (t = (r && "VOD" == r.value) || t),
                              (r = r && "EVENT" == r.value && !t),
                              (r = !t && !r),
                              IT(e, t ? UT : r ? $T : BT));
                          })(e, i),
                          AT(e) && cT(e, i),
                          (I = AT(e) ? e.C.get(s) : new Map()),
                          (k = yT(e, i, I, r, n, s)),
                          (R = k.segments),
                          (C = k.bandwidth),
                          (O = P = _ = M = L = null),
                          !(R.length > 0 && y))
                        ) {
                          t.A(2);
                          break;
                        }
                        return b(
                          t,
                          (function (e, t) {
                            var r, i, n, a, s, o, l, u, d, h, c, f, p, m, v, y;
                            return D(function (T) {
                              if (1 == T.g)
                                return (
                                  (r = ru(e.g.hls.mediaPlaylistFullMimeType)),
                                  t.length
                                    ? ((i = ST(e, t)),
                                      (n = i.segment),
                                      (a = i.segmentIndex),
                                      (s = n.P()),
                                      (o = ou(s[0])) && (l = MT.get(o))
                                        ? T.return(ru(l))
                                        : b(T, Promise.all([Wy(e, n.ea, 0), Wy(e, n, a)]), 2))
                                    : T.return(r)
                                );
                              if (
                                ((u = T.h),
                                (d = u[1].mimeType),
                                (h = u[0].data),
                                (c = u[1].data),
                                (f = "mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" ")),
                                (p = ["audio/mp4", "video/mp4", "video/iso.segment"]),
                                !(m = n.ea || p.includes(d)) && Ro(Oe(c)))
                              ) {
                                var S = c,
                                  E = e.g.disableAudio,
                                  x = e.g.disableVideo,
                                  w = e.g.disableText,
                                  A = Oe(S),
                                  I = new wo().parse(A),
                                  k = I.Yd();
                                A = I.Ng();
                                var R = [],
                                  C = !1,
                                  L = !1;
                                if (!E)
                                  switch (k.audio) {
                                    case "aac":
                                    case "aac-loas":
                                      I.ub().length && (R.push("mp4a.40.2"), (C = !0));
                                      break;
                                    case "mp3":
                                      I.ub().length && (R.push("mp4a.40.34"), (C = !0));
                                      break;
                                    case "ac3":
                                      I.ub().length && (R.push("ac-3"), (C = !0));
                                      break;
                                    case "ec3":
                                      I.ub().length && (R.push("ec-3"), (C = !0));
                                      break;
                                    case "opus":
                                      I.ub().length && (R.push("opus"), (C = !0));
                                  }
                                if (!x)
                                  switch (k.video) {
                                    case "avc":
                                      (A.codec ? R.push(A.codec) : R.push("avc1.42E01E"), (L = !0));
                                      break;
                                    case "hvc":
                                      (A.codec ? R.push(A.codec) : R.push("hvc1.1.6.L93.90"), (L = !0));
                                      break;
                                    case "av1":
                                      (R.push("av01.0.01M.08"), (L = !0));
                                  }
                                if (R.length) {
                                  if (((E = C && !L), (x = new Map()), L && !w)) {
                                    for (
                                      (w = new Lt("video/mp2t")).Af(S), L = (S = g(w.Zf())).next();
                                      !L.done;
                                      L = S.next()
                                    )
                                      ((L = L.value), x.set(L, L));
                                    w.Pd();
                                  }
                                  A = {
                                    type: E ? "audio" : "video",
                                    mimeType: "video/mp2t",
                                    codecs: R.join(", "),
                                    language: null,
                                    height: A.height,
                                    width: A.width,
                                    channelCount: null,
                                    sampleRate: null,
                                    closedCaptions: x,
                                    ze: null,
                                    colorGamut: null,
                                    frameRate: A.frameRate,
                                    timescale: null,
                                  };
                                } else A = null;
                                if ((v = A)) return T.return(v);
                              } else if ((m || f.includes(o)) && (y = iu(h, c, e.g.disableText)))
                                return T.return(y);
                              return d ? T.return(ru(d)) : T.return(r);
                            });
                          })(e, R),
                          3,
                        );
                      case 3:
                        ((N = t.h),
                          s != N.type && AT(e) && (e.C.set(N.type, e.C.get(s)), e.C.set(s, new Map())),
                          (s = N.type),
                          (o = N.language),
                          (d = N.channelCount),
                          (p = N.sampleRate),
                          e.g.disableText || (h = N.closedCaptions),
                          (M = N.height),
                          (L = N.width),
                          (_ = N.ze),
                          (P = N.colorGamut),
                          (O = N.frameRate),
                          T && ((v = N.mimeType), (a = N.codecs)));
                      case 2:
                        if (v) {
                          t.A(4);
                          break;
                        }
                        return b(
                          t,
                          (function (e, t, r, i) {
                            var n, a, s, o, l, u, d, h, c, f, p, g, m;
                            return D(function (v) {
                              switch (v.g) {
                                case 1:
                                  return (
                                    (n = qn),
                                    (a = ST(e, i)),
                                    2 == (s = a.segment).status
                                      ? v.return(bT(t))
                                      : ((l = s.P()),
                                        (u = ou(l[0])) && ((d = NT.get(t)), (h = d.get(u)) || (h = MT.get(u)))
                                          ? v.return(h)
                                          : (o = TT(t, r))
                                            ? v.return(o)
                                            : ((f = 1),
                                              (p = Vn(l, e.g.retryParameters)),
                                              E(v, 2),
                                              (p.method = "HEAD"),
                                              b(v, kT(e, p, n, { type: f }).promise, 4)))
                                  );
                                case 4:
                                  ((g = v.h), (c = g.headers["content-type"]), w(v, 3));
                                  break;
                                case 2:
                                  if (!(m = A(v)) || (1002 != m.code && 1001 != m.code)) {
                                    v.A(3);
                                    break;
                                  }
                                  return (
                                    (p.method = "GET"),
                                    e.g.hls.allowRangeRequestsToGuessMimeType &&
                                      (p.headers.Range = "bytes=0-0"),
                                    b(v, kT(e, p, n, { type: f }).promise, 6)
                                  );
                                case 6:
                                  ((g = v.h), (c = g.headers["content-type"]));
                                case 3:
                                  if (!c) {
                                    v.A(7);
                                    break;
                                  }
                                  if ("application/octet-stream" != (o = c.toLowerCase().split(";")[0])) {
                                    v.A(8);
                                    break;
                                  }
                                  if (g.data.byteLength) {
                                    v.A(9);
                                    break;
                                  }
                                  return ((p.method = "GET"), b(v, kT(e, p, n, { type: f }).promise, 10));
                                case 10:
                                  g = v.h;
                                case 9:
                                  Ro(Oe(g.data)) && (o = "video/mp2t");
                                case 8:
                                  if ("application/octet-stream" != o) return v.return(o);
                                case 7:
                                  return v.return(bT(t));
                              }
                            });
                          })(e, s, a, R),
                          5,
                        );
                      case 5:
                        ((v = t.h),
                          s != gt || a || "application/mp4" != v || !R[0] || R[0].ea || (v = "text/vtt"));
                      case 4:
                        return b(t, uT(e, i, v, n, r), 6);
                      case 6:
                        if (
                          ((F = t.h),
                          (U = F.drmInfos),
                          (B = F.keyIds),
                          ($ = F.encrypted),
                          (j = F.Qh),
                          $ && !U.length && !j)
                        )
                          throw new ze(2, 4, 4026);
                        return (
                          ((G = lT(e, a, s, o, l, u, d, h, c, f, p, m)).encrypted = $ && !j),
                          (G.drmInfos = U),
                          (G.keyIds = B),
                          (G.mimeType = v),
                          C && (G.bandwidth = C),
                          Xy(G),
                          "video" == s && (L || M || _ || P) && ET(G, L, M, O, _, null, P),
                          AT(e) && cT(e, i),
                          (V = R[0].startTime),
                          (H = R[R.length - 1]),
                          (K = H.endTime),
                          (W = new Ml(R)),
                          (G.segmentIndex = W),
                          (q = !!(z = wy(i.ha, "EXT-X-SERVER-CONTROL")) && null != vy(z, "CAN-SKIP-UNTIL")),
                          (X = !!z && null != vy(z, "CAN-BLOCK-RELOAD")),
                          (Y = Ay(i.ha, "EXT-X-MEDIA-SEQUENCE", 0)),
                          (Q = oT(Y, R)),
                          (J = Q.Qb),
                          (Z = Q.Rb),
                          t.return({
                            stream: G,
                            type: s,
                            Df: [],
                            P: n,
                            Wc: V,
                            Mc: K,
                            Ve: q,
                            Ue: X,
                            be: !1,
                            sg: -1,
                            Qb: J,
                            Rb: Z,
                            rf: I,
                          })
                        );
                    }
                  })
                );
              }
              function oT(e, t) {
                e = e + t.length - 1;
                var r = -1;
                if (!t.length) return { Qb: ++e, Rb: r };
                var i = (t = t[t.length - 1]).g;
                return t.g.length
                  ? ((r = i.length - 1), i[i.length - 1].isPreload() || (e++, (r = 0)), { Qb: e, Rb: r })
                  : (e++, t.o && (r = 0), { Qb: e, Rb: r });
              }
              function lT(e, t, r, i, n, a, s, o, l, u, d, h) {
                var c = TT(r, t) || bT(r),
                  f = [];
                if (l) for (var p = (l = g(l.split(","))).next(); !p.done; p = l.next()) f.push(p.value);
                return (
                  (p = void 0),
                  (l = null),
                  r == gt
                    ? (p =
                        f.includes("public.accessibility.transcribes-spoken-dialog") &&
                        f.includes("public.accessibility.describes-music-and-sound")
                          ? "caption"
                          : "subtitle")
                    : f.includes("public.accessibility.describes-video") && (l = "visually impaired"),
                  f.length || "subtitle" !== p || f.push("subtitle"),
                  (p = null),
                  "video" != r && (p = a),
                  Xy(
                    (e = {
                      id: e.G++,
                      originalId: a,
                      groupId: null,
                      createSegmentIndex: function () {
                        return Promise.resolve();
                      },
                      segmentIndex: null,
                      mimeType: c,
                      codecs: t,
                      kind: r == gt ? "subtitle" : void 0,
                      encrypted: !1,
                      drmInfos: [],
                      keyIds: new Set(),
                      language: Fi(i || "und"),
                      originalLanguage: i,
                      label: p,
                      type: r,
                      primary: n,
                      trickModeVideo: null,
                      dependencyStream: null,
                      emsgSchemeIdUris: null,
                      frameRate: void 0,
                      pixelAspectRatio: void 0,
                      width: void 0,
                      height: void 0,
                      bandwidth: void 0,
                      roles: f,
                      forced: u,
                      channelsCount: s,
                      audioSamplingRate: d,
                      spatialAudio: h,
                      closedCaptions: o,
                      hdr: void 0,
                      colorGamut: void 0,
                      videoLayout: void 0,
                      tilesLayout: void 0,
                      accessibilityPurpose: l,
                      external: !1,
                      fastSwitching: !1,
                      fullMimeTypes: new Set(),
                      isAudioMuxedInVideo: !1,
                      baseOriginalId: null,
                    }),
                  ),
                  e
                );
              }
              function uT(e, t, r, i, n) {
                var a, s, o, l, u, d, h, c, f, p, m, v, y, T, S, E, x, w, A, I, k, R, C, L, M, _, P, O, N;
                return D(function (D) {
                  switch (D.g) {
                    case 1:
                      if (((a = new Map()), !e.g.ignoreDrmInfo && t.segments))
                        for (s = g(t.segments), o = s.next(); !o.done; o = s.next())
                          if (((l = o.value), (u = Ey(l.ha, "EXT-X-KEY")), (d = null), u.length))
                            for (d = pT(e, t, l.ha, i, n), h = g(u), c = h.next(); !c.done; c = h.next())
                              ((f = c.value), a.set(f, d));
                      ((m = p = !1), (v = []), (y = new Set()), (T = g(a)), (S = T.next()));
                    case 2:
                      if (S.done) {
                        D.A(4);
                        break;
                      }
                      if (
                        ((E = S.value),
                        (x = g(E)),
                        (w = x.next().value),
                        (A = x.next().value),
                        (k = A),
                        "NONE" == (R = Ty((I = w), "METHOD")))
                      ) {
                        D.A(3);
                        break;
                      }
                      if (((p = !0), (C = yy(I, "KEYFORMAT") || "identity"), (L = null), RT(R))) {
                        ((m = !0), D.A(3));
                        break;
                      }
                      if ("identity" == C) return b(D, CT(e, I, r, i, k, n), 11);
                      if (!(M = e.dc.get(C))) {
                        ((_ = null), D.A(9));
                        break;
                      }
                      return b(D, M(I, r, k), 10);
                    case 10:
                      _ = D.h;
                    case 9:
                      ((L = _), D.A(6));
                      break;
                    case 11:
                      L = D.h;
                    case 6:
                      if (L) {
                        if (L.keyIds)
                          for (P = g(L.keyIds), O = P.next(); !O.done; O = P.next())
                            ((N = O.value), y.add(N));
                        v.push(L);
                      }
                    case 3:
                      ((S = T.next()), D.A(2));
                      break;
                    case 4:
                      return D.return({ drmInfos: v, keyIds: y, encrypted: p, Qh: m });
                  }
                });
              }
              function dT(t, r, i, n, a) {
                if (!e.crypto || !e.crypto.subtle)
                  throw (
                    z(
                      "Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)",
                    ),
                    new ze(2, 4, 4042)
                  );
                var s = 0,
                  o = yy(r, "IV", "");
                if (o) {
                  var l = st(o.substr(2));
                  if (16 != l.byteLength) throw new ze(2, 4, 4048);
                } else s = Ay(i.ha, "EXT-X-MEDIA-SEQUENCE", 0);
                var u = Iy(n(), Ty(r, "URI"), a),
                  d = u.sort().join("");
                if (((i = r.toString() + "-" + s + "-" + d), !t.va.has(i))) {
                  var h = { bitsKey: 128, blockCipherMode: "CBC", iv: l, firstMediaSequenceNumber: s };
                  switch (Ty(r, "METHOD")) {
                    case "AES-256":
                      h.bitsKey = 256;
                      break;
                    case "AES-256-CTR":
                      ((h.bitsKey = 256), (h.blockCipherMode = "CTR"));
                  }
                  ((h.fetchKey = function () {
                    var r, i, n, a;
                    return D(function (s) {
                      if (1 == s.g)
                        return (
                          t.O.has(d) ||
                            ((r = Vn(u, t.g.retryParameters)), (i = kT(t, r, 6).promise), t.O.set(d, i)),
                          b(s, t.O.get(d), 2)
                        );
                      if (3 != s.g) {
                        if (!(n = s.h).data || n.data.byteLength != h.bitsKey / 8) throw new ze(2, 4, 4049);
                        return (
                          (a = {
                            name: "CTR" == h.blockCipherMode ? "AES-CTR" : "AES-CBC",
                            length: h.bitsKey,
                          }),
                          b(s, e.crypto.subtle.importKey("raw", n.data, a, !0, ["decrypt"]), 3)
                        );
                      }
                      ((h.cryptoKey = s.h), (h.fetchKey = void 0), S(s));
                    });
                  }),
                    t.va.set(i, h));
                }
                return t.va.get(i);
              }
              function hT(e, t) {
                null == e.u && (t = wy(t.ha, "EXT-X-START")) && (e.u = Number(Ty(t, "TIME-OFFSET")));
              }
              function cT(e, t) {
                var r = 1 / 0,
                  i = t.segments;
                if (i.length)
                  for (var n = i.length - 1; n >= 0; ) {
                    var a = wy(i[n].ha, "EXTINF");
                    if (a) {
                      r = Number(a.value.split(",")[0]);
                      break;
                    }
                    n--;
                  }
                if (!(i = wy(t.ha, "EXT-X-TARGETDURATION"))) throw new ze(2, 4, 4024, "EXT-X-TARGETDURATION");
                ((i = Number(i.value)),
                  (n = wy(t.ha, "EXT-X-PART-INF")) && (e.T = Number(Ty(n, "PART-TARGET"))),
                  (t = wy(t.ha, "EXT-X-SERVER-CONTROL")),
                  e.oa && e.T
                    ? ((e.o = e.yc
                        ? 5 * e.T <= r
                          ? Math.min(e.T, e.o)
                          : Math.min(r, e.o)
                        : Math.min(e.T, e.o)),
                      (e.Ua = t ? Number(Ty(t, "PART-HOLD-BACK")) : 0))
                    : ((e.o = Math.min(r, e.o)),
                      (r = t ? vy(t, "HOLD-BACK") : null),
                      (e.Ta = r ? Number(r.value) : 0)),
                  (e.eb = Math.max(i, e.eb)));
              }
              function fT(e, t) {
                var r = 0;
                if (e.g.defaultPresentationDelay) r = e.g.defaultPresentationDelay;
                else if (e.Ua) r = e.Ua;
                else if (e.Ta) r = e.Ta;
                else
                  for (
                    var i = t.segments.length, n = i - Math.min(i, e.g.hls.liveSegmentsDelay);
                    n < i;
                    n++
                  ) {
                    var a = wy(t.segments[n].ha, "EXTINF");
                    r = a ? r + Number(a.value.split(",")[0]) : r + e.eb;
                  }
                (e.u && e.u < 0 && ((r = Math.min(-e.u, r)), (e.u += r)), e.l.Wi(0), e.l.rh(r), e.l.cd(!1));
              }
              function pT(e, t, r, i, n) {
                var a = wy(r, "EXT-X-MAP");
                if (!a) return null;
                var s = Ty(a, "URI"),
                  o = Iy(i(), s, n);
                if (((s = [o.toString(), yy(a, "BYTERANGE", "")].join("-")), !e.Da.has(s))) {
                  for (var l = void 0, u = null, d = !1, h = (r = g(r)).next(); !h.done; h = r.next())
                    "EXT-X-KEY" == (h = h.value).name
                      ? RT((d = Ty(h, "METHOD"))) && h.id < a.id
                        ? ((d = !1), (l = dT(e, h, t, i, n)))
                        : (d = "NONE" != d)
                      : "EXT-X-BYTERANGE" == h.name && h.id < a.id && (u = h);
                  ((t = (function (e, t, r, i, n) {
                    var a = 0,
                      s = null;
                    return (
                      !(t = yy(t, "BYTERANGE")) && r && (t = r.value),
                      t &&
                        ((a = t.split("@")),
                        (s = Number(a[0])),
                        (a = Number(a[1])),
                        (s = a + s - 1),
                        i && (r = s + 1 - a) % 16 && (s += 16 - (r % 16))),
                      new Fs(
                        function () {
                          return e;
                        },
                        a,
                        s,
                        null,
                        null,
                        null,
                        i,
                        n,
                      )
                    );
                  })(o, a, u, l, d)),
                    e.Da.set(s, t));
                }
                return e.Da.get(s);
              }
              function gT(t, r, i, n, a, s, o, l, u, d) {
                var h = n.ha,
                  c = wy(h, "EXTINF"),
                  f = 0,
                  p = 0,
                  m = null;
                n.wc.length && (t.m.isLowLatency = !0);
                var v = null;
                if (!t.g.hls.ignoreManifestProgramDateTime) {
                  var y = wy(h, "EXT-X-PROGRAM-DATE-TIME");
                  y && y.value && ((v = dr(y.value)), (t.kb = !0));
                }
                var T = Gs;
                if ((wy(h, "EXT-X-GAP") && (t.m.gapCount++, (T = 2)), !c)) {
                  if (0 == n.wc.length) throw new ze(2, 4, 4024, "EXTINF");
                  if (!t.oa) return null;
                }
                var b = [];
                y = !1;
                var S = null,
                  E = !1,
                  x = !1;
                if (t.oa && n.wc.length) {
                  f = r && e.ReadableStream && t.g.hls.allowLowLatencyByteRangeOptimization;
                  for (var w = v, A = {}, I = 0; I < n.wc.length; A = { Uf: void 0, pe: void 0 }, I++) {
                    var k = n.wc[I],
                      R = 0 == I ? i : b[b.length - 1],
                      C = 0 == I ? a : R.endTime,
                      L = Number(yy(k, "DURATION")) || t.T;
                    if (L) {
                      var M = C + L,
                        D = 0,
                        _ = null;
                      if (
                        ("EXT-X-PRELOAD-HINT" == k.name
                          ? ((D = (D = yy(k, "BYTERANGE-START")) ? Number(D) : 0),
                            (R = yy(k, "BYTERANGE-LENGTH"))
                              ? (_ = D + Number(R) - 1)
                              : D && (_ = Number.MAX_SAFE_INTEGER))
                          : ((D = (_ = g(mT(R, (D = yy(k, "BYTERANGE"))))).next().value),
                            (_ = _.next().value)),
                        (A.pe = yy(k, "URI")),
                        A.pe)
                      ) {
                        ((R = Gs),
                          "YES" == yy(k, "GAP") && (t.m.gapCount++, (R = 2), (E = !0)),
                          (A.Uf = null));
                        var P = (function (e) {
                          return function () {
                            return (null == e.Uf && (e.Uf = Iy(l(), e.pe, s)), e.Uf);
                          };
                        })(A);
                        (f && D >= 0 && null != _ && ((S = P), (y = !0)),
                          (C = new Bs(C, M, P, D, _, r, 0, 0, 1 / 0, [], "", null, w, R, d)),
                          "EXT-X-PRELOAD-HINT" == k.name && (C.Ug(), (x = !0)),
                          "YES" != yy(k, "INDEPENDENT") && I > 0 && C.wd(),
                          (k = u) ||
                            (b.length && b[0].mimeType
                              ? (k = b[0].mimeType)
                              : A.pe && ((A = ou(A.pe)), (k = NT.get(o).get(A) || null))),
                          k && ((C.mimeType = k), FT.has(k) && (C.ea = null)),
                          b.push(C),
                          w && (w += L));
                      }
                    }
                  }
                }
                if (c) {
                  if (0 == (c = Number(c.value.split(",")[0]))) return null;
                  f = a + c;
                } else {
                  if (!b.length) return null;
                  f = b[b.length - 1].endTime;
                }
                (y && (E || 0 != b[0].startByte ? ((y = !1), (S = null)) : (b = [])),
                  (c = wy(h, "EXT-X-BYTERANGE"))
                    ? ((p = (m = g(mT(i, c.value))).next().value), (m = m.next().value))
                    : b.length && ((p = b[0].startByte), (m = b[b.length - 1].endByte)),
                  (i = ""),
                  (c = null),
                  "image" == o &&
                    ((i = "1x1"), (o = wy(h, "EXT-X-TILES"))) &&
                    ((i = Ty(o, "LAYOUT")), (o = yy(o, "DURATION")) && (c = Number(o))));
                var O = null;
                return (
                  (r = new Bs(
                    a,
                    f,
                    function () {
                      return S ? S() : (null == O && (O = Iy(l(), n.g, s)), O || []);
                    },
                    p,
                    m,
                    r,
                    0,
                    0,
                    1 / 0,
                    b,
                    i,
                    c,
                    v,
                    T,
                    d,
                    b.length > 0 && !!n.g,
                  )),
                  u && ((r.mimeType = u), FT.has(u) && (r.ea = null)),
                  y && ((t.yc = !0), r.xi(), x && r.Ug()),
                  r
                );
              }
              function mT(e, t) {
                var r = 0,
                  i = null;
                return (
                  t &&
                    ((r = t.split("@")),
                    (t = Number(r[0])),
                    (i = (r = r[1] ? Number(r[1]) : e.endByte + 1) + t - 1)),
                  [r, i]
                );
              }
              function vT(e, t, r, i, n) {
                if ("video" == r || "audio" == r) {
                  var a = e.l.m;
                  if (a && !aT(e, r))
                    for (
                      t = (t = Ey(t, "EXT-X-DATERANGE"))
                        .filter(function (e) {
                          return null != vy(e, "START-DATE");
                        })
                        .sort(function (e, t) {
                          return (e = Ty(e, "START-DATE")) < (t = Ty(t, "START-DATE")) ? -1 : e > t ? 1 : 0;
                        }),
                        r = 0;
                      r < t.length;
                      r++
                    ) {
                      var s = t[r];
                      try {
                        var o = dr(Ty(s, "START-DATE"));
                        if (!isNaN(o)) {
                          var l = Math.max(0, o - a),
                            u = null,
                            d = yy(s, "END-DATE");
                          if (d) {
                            var h = dr(d);
                            if (!isNaN(h) && (u = h - a) < 0) continue;
                          }
                          if (null == u) {
                            var c = yy(s, "DURATION") || yy(s, "PLANNED-DURATION");
                            if (c) {
                              var f = parseFloat(c);
                              if ((isNaN(f) || (u = l + f), o - a + f < 0)) continue;
                            }
                          }
                          var p = yy(s, "CLASS") || "com.apple.quicktime.HLS",
                            m = "YES" == yy(s, "END-ON-NEXT");
                          if (null == u && m) {
                            for (var v = r + 1; v < t.length; v++)
                              if (p == (yy(t[v], "CLASS") || "com.apple.quicktime.HLS")) {
                                var y = dr(Ty(t[v], "START-DATE"));
                                if (!isNaN(y) && y && y > o) {
                                  u = Math.max(0, y - a);
                                  break;
                                }
                              }
                            if (null == u) continue;
                          }
                          v = ["CLASS", "START-DATE", "END-DATE", "DURATION", "END-ON-NEXT"];
                          for (var T = [], b = g(s.attributes), S = b.next(); !S.done; S = b.next()) {
                            var E = S.value;
                            if (!v.includes(E.name)) {
                              var x = Ry(E.value, i);
                              (("X-ASSET-URI" != E.name && "X-ASSET-LIST" != E.name) ||
                                (x = Iy(n(), E.value, i)[0]),
                                T.push({
                                  key: E.name,
                                  description: "",
                                  data: x,
                                  mimeType: null,
                                  pictureType: null,
                                }));
                            }
                          }
                          T.length > 1 && e.h.onMetadata(p, l, u, T);
                        }
                      } catch (w) {}
                    }
                }
              }
              function yT(e, t, r, i, n, a) {
                function s(e) {
                  if (!(e = ou(e))) return null;
                  var t = NT.get(a).get(e);
                  return (t || (t = MT.get(e)), t);
                }
                var o = t.segments,
                  l = null,
                  u = null,
                  d = null,
                  h = null,
                  c = void 0,
                  f = Ay(t.ha, "EXT-X-DISCONTINUITY-SEQUENCE", -1),
                  p = Ay(t.ha, "EXT-X-MEDIA-SEQUENCE", 0),
                  m = wy(t.ha, "EXT-X-SKIP"),
                  v = m ? Number(yy(m, "SKIPPED-SEGMENTS")) : 0,
                  y = p + v,
                  T = 0;
                (AT(e) && r.has(y) && (T = r.get(y)),
                  0 === T && e.Fa == $T && r.size > 0 && !r.has(y) && null != e.l.i && (T = e.l.Hb()));
                var b = [],
                  S = null;
                m = [];
                for (var E = 0; E < o.length; E++) {
                  var x = o[E];
                  (y = wy(x.ha, "EXT-X-MAP")) && y.id !== u && ((l = pT(e, t, x.ha, n, i)), (u = y.id));
                  var w = "";
                  ((y = x.g) && (w = ou(y)),
                    w !== h && ((d = s(y)), (h = w)),
                    (w = 0 == E ? T : S.endTime),
                    (y = p + v + E),
                    wy(x.ha, "EXT-X-DISCONTINUITY") && (f++, S && S.ea && (S.ea.g = w)));
                  for (var A = g(x.ha), I = A.next(); !I.done; I = A.next())
                    "EXT-X-KEY" == (I = I.value).name &&
                      (c = RT(Ty(I, "METHOD")) ? dT(e, I, t, n, i) : void 0);
                  if ((r.set(y, w), (w = gT(e, l, S, x, w, i, a, n, d, c)))) {
                    if (
                      ((S = Ay(x.ha, "EXT-X-BITRATE"))
                        ? (m.push({ bitrate: S, duration: w.endTime - w.startTime }), (w.bandwidth = S))
                        : w.endByte
                          ? (x = $s(w)) &&
                            ((x = (8 * x) / (S = w.endTime - w.startTime) / 1e3),
                            m.push({ bitrate: x, duration: S }),
                            (w.bandwidth = x))
                          : m.length &&
                            (((S = m.pop()).duration += w.endTime - w.startTime),
                            m.push(S),
                            (w.bandwidth = S.bitrate)),
                      w.bandwidth)
                    )
                      for (x = (S = g(w.g)).next(); !x.done; x = S.next()) x.value.bandwidth = w.bandwidth;
                    ((S = w), (w.i = f), (aT(e, a) && null != e.N && y < e.N) || b.push(w));
                  }
                }
                if (
                  ((t = void 0),
                  m.length &&
                    ((t = m.reduce(function (e, t) {
                      return e + t.duration;
                    }, 0)),
                    (t = Math.round(
                      (m.reduce(function (e, t) {
                        return e + t.bitrate * t.duration;
                      }, 0) /
                        t) *
                        1e3,
                    ))),
                  (m = b.some(function (e) {
                    return null != e.h;
                  })))
                )
                  for (
                    r = {}, i = 0;
                    i < b.length;
                    r = { Ze: void 0, Ye: void 0, Re: void 0, Zc: void 0, Qe: void 0 }, i++
                  )
                    if (((r.Zc = b[i]), null == r.Zc.h))
                      for (
                        r.Ye = 0,
                          r.Ze = i,
                          n = (function (e) {
                            return function () {
                              var t = b[e.Ze];
                              if (t) {
                                if (null != t.h) return t.h + e.Ye;
                                ((e.Ye -= t.endTime - t.startTime), (e.Ze += 1));
                              }
                              return null;
                            };
                          })(r),
                          r.Qe = 0,
                          r.Re = i,
                          o = (function (e) {
                            return function () {
                              var t = b[e.Re];
                              if (t) {
                                if ((t != e.Zc && (e.Qe += t.endTime - t.startTime), null != t.h))
                                  return t.h + e.Qe;
                                --e.Re;
                              }
                              return null;
                            };
                          })(r);
                        null == r.Zc.h;
                      )
                        ((r.Zc.h = o()), null == r.Zc.h && (r.Zc.h = n()));
                if (m)
                  for (i = (r = g(b)).next(); !i.done; i = r.next())
                    for (i = (n = i.value).h, o = (n = g(n.g)).next(); !o.done; o = n.next())
                      (((o = o.value).h = i), (i += o.endTime - o.startTime));
                if (((r = e.ma), m && r != 1 / 0 && !aT(e, a)))
                  for (m = (e = g(b)).next(); !m.done; m = e.next()) m.value.Dh(r);
                return { segments: b, bandwidth: t };
              }
              function TT(e, t) {
                if (e == gt) {
                  if ("vtt" == t || "wvtt" == t) return "text/vtt";
                  if (t && "" !== t) return "application/mp4";
                }
                return "image" != e || (t && "jpeg" != t)
                  ? "audio" == e && "mp4a.40.34" == t
                    ? "audio/mpeg"
                    : "mjpg" == t
                      ? "application/mp4"
                      : null
                  : "image/jpeg";
              }
              function bT(e) {
                return e == gt ? "text/vtt" : NT.get(e).get("mp4");
              }
              function ST(e, t) {
                for (
                  var r = t[(e = AT(e) ? Math.trunc((t.length - 1) / 2) : 0)];
                  2 == r.Kc() && e + 1 < t.length;
                )
                  r = t[++e];
                return { segment: r, segmentIndex: e };
              }
              function ET(e, t, r, i, n, a, s) {
                e &&
                  ((e.width = Number(t) || void 0),
                  (e.height = Number(r) || void 0),
                  (e.frameRate = Number(i) || void 0),
                  (e.hdr = n || void 0),
                  (e.videoLayout = a || void 0),
                  (e.colorGamut = s || void 0));
              }
              function xT(e, t, r) {
                return kT(e, Vn(t, e.g.retryParameters), 0, { type: r ? 2 : 3 });
              }
              function wT(e) {
                var t, r, i, n, a, s;
                return D(function (o) {
                  switch (o.g) {
                    case 1:
                      return e.h ? (E(o, 2), (t = Date.now()), b(o, e.update(), 4)) : o.return();
                    case 4:
                      ((r = Date.now()),
                        AT(e) &&
                          ((i = (r - t) / 1e3),
                          e.ac.sample(1, i),
                          (n = e.g.updatePeriod > 0 ? e.g.updatePeriod : e.o),
                          (a = Math.max(0, n - V(e.ac))),
                          e.F.ka(a)),
                        w(o, 3));
                      break;
                    case 2:
                      if (((s = A(o)), !e.h)) return o.return();
                      if (e.g.raiseFatalErrorOnManifestUpdateRequestFailure)
                        return (e.h.onError(s), o.return());
                      ((s.severity = 1), e.h.onError(s), e.F.ka(0.1));
                    case 3:
                      if (!e.h) return o.return();
                      (e.h.onManifestUpdated(), S(o));
                  }
                });
              }
              function AT(e) {
                return e.Fa != UT;
              }
              function IT(e, t) {
                ((e.Fa = t), e.l && e.l.cd(!AT(e)), AT(e) || e.F.stop());
              }
              function kT(e, t, r, i) {
                if (!e.$) throw new ze(2, 7, 7001);
                return (
                  i || (i = {}),
                  (i.isPreload = e.cc()),
                  (t = e.h.networkingEngine.request(r, t, i)),
                  Bn(e.$, t),
                  t
                );
              }
              function RT(e) {
                return "AES-128" == e || "AES-256" == e || "AES-256-CTR" == e;
              }
              function CT(t, r, i, n, a, s) {
                var o, l, u, d, h, c, f, p, g, m, v;
                return D(function (y) {
                  switch (y.g) {
                    case 1:
                      if ("video/mp2t" == i) throw new ze(2, 4, 4040);
                      if ("apple" === e.shakaMediaKeysPolyfill) throw new ze(2, 4, 4041);
                      if (((o = Ty(r, "METHOD")), !["SAMPLE-AES", "SAMPLE-AES-CTR"].includes(o)))
                        return y.return(null);
                      if ((l = Iy(n(), Ty(r, "URI"), s))[0].startsWith("data:text/plain;base64,")) {
                        ((u = ot(at(l[0].split("data:text/plain;base64,").pop()))), y.A(2));
                        break;
                      }
                      return (
                        (d = l.sort().join("")),
                        t.ya.has(d) ||
                          ((h = Vn(l, t.g.retryParameters)), (c = kT(t, h, 6).promise), t.ya.set(d, c)),
                        b(y, t.ya.get(d), 3)
                      );
                    case 3:
                      ((f = y.h), (u = ot(f.data)));
                    case 2:
                      if (((p = "00000000000000000000000000000000"), !a)) {
                        y.A(4);
                        break;
                      }
                      return b(y, LT(t, a), 5);
                    case 5:
                      (g = y.h) && (p = g);
                    case 4:
                      return (
                        (m = new Map()).set(p, u),
                        (v = "cenc"),
                        "SAMPLE-AES" == o && (v = "cbcs"),
                        y.return(ht(m, v))
                      );
                  }
                });
              }
              function LT(e, t) {
                var r, i, n;
                return D(function (a) {
                  return 1 == a.g
                    ? ((r = null),
                      e.za.has(t)
                        ? ((r = e.za.get(t)), a.A(2))
                        : ((i = lu(t.P(), t.Jc(), t.Hc(), e.g.retryParameters)),
                          b(a, kT(e, i, qn, { type: 0 }).promise, 3)))
                    : (2 != a.g &&
                        ((n = a.h),
                        t.ue(n.data),
                        (r = (function (e) {
                          var t = null;
                          return (
                            new aa()
                              .box("moov", sa)
                              .box("trak", sa)
                              .box("mdia", sa)
                              .box("minf", sa)
                              .box("stbl", sa)
                              .S("stsd", oa)
                              .box("encv", la)
                              .box("enca", ua)
                              .box("sinf", sa)
                              .box("schi", sa)
                              .S("tenc", function (e) {
                                ((e = e.reader).Y(), e.Y(), e.Y(), e.Y(), (e = e.Tb(16, !1)), (t = ot(e)));
                              })
                              .parse(e, !0),
                            t
                          );
                        })(n.data)),
                        e.za.set(t, r)),
                      a.return(r));
                });
              }
              (j("shaka.net.DataUriPlugin", Uy),
                (Uy.parse = By),
                jn("data", By),
                ((n = jy.prototype).configure = function (e, t) {
                  var r = this.h && e.updatePeriod != this.g.updatePeriod && e.updatePeriod >= 0;
                  ((this.g = e),
                    t && (this.cc = t),
                    this.j && this.j.configure(this.g),
                    r && this.m && this.m.presentationTimeline.W() && this.F.Jb());
                }),
                (n.start = function (e, t) {
                  var r,
                    i = this;
                  return D(function (n) {
                    return 1 == n.g
                      ? ((i.h = t), (i.oa = t.isLowLatencyMode()), b(n, xT(i, [e]).promise, 2))
                      : 3 != n.g
                        ? ((r = n.h),
                          (i.H = r.uri),
                          b(
                            n,
                            (function (e, t) {
                              var r,
                                i,
                                n,
                                a,
                                s,
                                o,
                                l,
                                u,
                                d,
                                h,
                                c,
                                f,
                                p,
                                v,
                                y,
                                T,
                                x,
                                w,
                                I,
                                k,
                                R,
                                C,
                                L,
                                M,
                                _,
                                P,
                                O,
                                N,
                                F,
                                U,
                                B,
                                $,
                                j,
                                G,
                                V,
                                H,
                                K,
                                W,
                                z,
                                q,
                                X,
                                Y,
                                Q;
                              return D(function (Z) {
                                switch (Z.g) {
                                  case 1:
                                    return (
                                      (r = mt),
                                      (i = Ly(e.ab, t)),
                                      (n = Ey(i.ha, "EXT-X-DEFINE")),
                                      (a = []),
                                      (s = []),
                                      (o = []),
                                      (e.l = new ll(null, 0)),
                                      e.l.cd(!0),
                                      (l = function () {
                                        return [e.H];
                                      }),
                                      (u = null),
                                      (d = new Map()),
                                      1 == i.type
                                        ? ((e.R = !1),
                                          ($ = Ey(i.ha, "EXT-X-DEFINE")),
                                          (d = qy(e, $, e.H)),
                                          (u = r.wa),
                                          (j = ""),
                                          (G = new Map()),
                                          b(
                                            Z,
                                            sT(
                                              e,
                                              e.G++,
                                              d,
                                              i,
                                              l,
                                              "",
                                              u,
                                              j,
                                              !0,
                                              "Media Playlist",
                                              null,
                                              G,
                                              null,
                                              !1,
                                              null,
                                              !1,
                                            ),
                                            7,
                                          ))
                                        : ((function (e, t) {
                                            for (
                                              var r = new me(e.H).g, i = (t = g(t)).next();
                                              !i.done;
                                              i = t.next()
                                            ) {
                                              var n = i.value;
                                              i = yy(n, "NAME");
                                              var a = yy(n, "VALUE");
                                              ((n = yy(n, "QUERYPARAM")),
                                                i && a && (e.B.has(i) || e.B.set(i, a)),
                                                n && (i = r.get(n)[0]) && !e.B.has(i) && e.B.set(n, i));
                                            }
                                          })(e, n),
                                          (h = Ey(i.ha, "EXT-X-MEDIA")),
                                          (c = Ey(i.ha, "EXT-X-STREAM-INF")),
                                          (f = Ey(i.ha, "EXT-X-IMAGE-STREAM-INF")),
                                          (p = Ey(i.ha, "EXT-X-I-FRAME-STREAM-INF")),
                                          (v = Ey(i.ha, "EXT-X-SESSION-KEY")),
                                          (y = Ey(i.ha, "EXT-X-SESSION-DATA")),
                                          (T = Ey(i.ha, "EXT-X-CONTENT-STEERING")),
                                          (function (e, t) {
                                            for (var r = (t = g(t)).next(); !r.done; r = t.next()) {
                                              var i = r.value,
                                                n = yy(i, "DATA-ID");
                                              r = yy(i, "URI");
                                              var a = yy(i, "LANGUAGE");
                                              ((i = yy(i, "VALUE")),
                                                (n = new Map().set("id", n)),
                                                r && n.set("uri", Iy([e.H], r, e.B)[0]),
                                                a && n.set("language", a),
                                                i && n.set("value", i),
                                                (r = new Pn("sessiondata", n)),
                                                e.h && e.h.onEvent(r));
                                            }
                                          })(e, y),
                                          b(
                                            Z,
                                            (function (e, t) {
                                              var r, i, n, a, s, o;
                                              return D(function (l) {
                                                if (!e.h || !e.g) return l.return();
                                                for (i = g(t), n = i.next(); !n.done; n = i.next())
                                                  if (
                                                    ((a = n.value),
                                                    (s = yy(a, "PATHWAY-ID")),
                                                    (o = yy(a, "SERVER-URI")),
                                                    s && o)
                                                  ) {
                                                    ((e.j = new Pm(e.h)),
                                                      e.j.configure(e.g),
                                                      (e.j.i = [e.H]),
                                                      e.j.setManifestType("HLS"),
                                                      (e.j.h = s),
                                                      (r = Om(e.j, o)));
                                                    break;
                                                  }
                                                return b(l, r, 0);
                                              });
                                            })(e, T),
                                            4,
                                          ))
                                    );
                                  case 4:
                                    if (!e.g.ignoreSupplementalCodecs) {
                                      for (
                                        x = [], w = g(c), I = w.next(), k = {};
                                        !I.done;
                                        k = { dj: void 0 }, I = w.next()
                                      )
                                        ((R = I.value),
                                          (C = yy(R, "SUPPLEMENTAL-CODECS")) &&
                                            ((k.dj = C.split(/\s*,\s*/).map(function (e) {
                                              return e.split("/")[0];
                                            })),
                                            (L = R.attributes.map(
                                              (function (e) {
                                                return function (t) {
                                                  var r = t.name,
                                                    i = t.value;
                                                  return (
                                                    "CODECS" == r &&
                                                      ((i = e.dj.join(",")),
                                                      (t = t.value.split(",")).length > 1 &&
                                                        (t = ft("audio", t)) &&
                                                        (i += "," + t)),
                                                    new Sy(r, i)
                                                  );
                                                };
                                              })(k),
                                            )),
                                            x.push(new gy(R.id, R.name, L, null))));
                                      for (
                                        c.push.apply(c, m(x)), M = [], _ = g(p), P = _.next(), O = {};
                                        !P.done;
                                        O = { ej: void 0 }, P = _.next()
                                      )
                                        ((N = P.value),
                                          (F = yy(N, "SUPPLEMENTAL-CODECS")) &&
                                            ((O.ej = F.split(/\s*,\s*/).map(function (e) {
                                              return e.split("/")[0];
                                            })),
                                            (U = N.attributes.map(
                                              (function (e) {
                                                return function (t) {
                                                  var r = t.name;
                                                  return (
                                                    (t = t.value),
                                                    "CODECS" == r && (t = e.ej.join(",")),
                                                    new Sy(r, t)
                                                  );
                                                };
                                              })(O),
                                            )),
                                            M.push(new gy(N.id, N.name, U, null))));
                                      p.push.apply(p, m(M));
                                    }
                                    return (
                                      (function (e, t) {
                                        for (var r = (t = g(t)).next(); !r.done; r = t.next()) {
                                          var i = r.value,
                                            n = yy(i, "AUDIO");
                                          r = yy(i, "VIDEO");
                                          var a = yy(i, "SUBTITLES");
                                          if (((i = Qy(e, i)), a)) {
                                            var s = ft(gt, i);
                                            (e.K.set(a, s), J(i, s));
                                          }
                                          (n &&
                                            ((a = ft("audio", i)) || (a = e.g.hls.defaultAudioCodec),
                                            e.K.set(n, a)),
                                            r &&
                                              ((n = ft("video", i)) || (n = e.g.hls.defaultVideoCodec),
                                              e.K.set(r, n)));
                                        }
                                      })(e, c),
                                      (function (e, t) {
                                        ((t = xy(t, "CLOSED-CAPTIONS")), (e.R = 0 == t.length));
                                        for (var r = (t = g(t)).next(); !r.done; r = t.next()) {
                                          var i = r.value,
                                            n = yy(i, "LANGUAGE");
                                          ((r = Fi(n || "und")),
                                            n || ((n = yy(i, "NAME")) && (r = n)),
                                            (n = Ty(i, "GROUP-ID")),
                                            (i = Ty(i, "INSTREAM-ID").replace("SERVICE", "svc")),
                                            e.J.get(n) || e.J.set(n, new Map()),
                                            e.J.get(n).set(i, r));
                                        }
                                      })(e, h),
                                      (B = (function (e, t) {
                                        return t
                                          .map(function (t) {
                                            return "video" !== (t = eT(e, t)).stream.type ? null : t.stream;
                                          })
                                          .filter(function (e) {
                                            return e;
                                          });
                                      })(e, p)),
                                      b(
                                        Z,
                                        (function (e, t, r, i, n, a, s) {
                                          var o,
                                            l,
                                            u,
                                            d,
                                            h,
                                            c,
                                            f,
                                            p,
                                            v,
                                            y,
                                            T,
                                            S,
                                            E,
                                            x,
                                            w,
                                            A,
                                            I,
                                            k,
                                            R,
                                            C,
                                            L,
                                            M,
                                            _,
                                            P,
                                            O,
                                            N,
                                            F,
                                            U,
                                            B,
                                            $,
                                            j,
                                            G,
                                            V,
                                            H,
                                            K,
                                            W;
                                          return D(function (D) {
                                            switch (D.g) {
                                              case 1:
                                                if (
                                                  ((o = []),
                                                  (l = new Set()),
                                                  e.g.ignoreDrmInfo || !(r.length > 0))
                                                ) {
                                                  D.A(2);
                                                  break;
                                                }
                                                ((u = g(r)), (d = u.next()));
                                              case 3:
                                                if (d.done) {
                                                  D.A(2);
                                                  break;
                                                }
                                                if (
                                                  ((h = d.value),
                                                  (c = Ty(h, "METHOD")),
                                                  (f = yy(h, "KEYFORMAT") || "identity"),
                                                  (p = null),
                                                  "NONE" == c)
                                                ) {
                                                  D.A(4);
                                                  break;
                                                }
                                                if (RT(c)) {
                                                  ((v = Iy(n(), Ty(h, "URI"), a)),
                                                    (y = v.sort().join("")),
                                                    e.O.has(y) ||
                                                      ((T = Vn(v, e.g.retryParameters)),
                                                      (S = kT(e, T, 6).promise),
                                                      e.O.set(y, S)),
                                                    D.A(4));
                                                  break;
                                                }
                                                if ("identity" == f)
                                                  return b(D, CT(e, h, "", n, null, a), 12);
                                                if (!(E = e.dc.get(f))) {
                                                  ((x = null), D.A(10));
                                                  break;
                                                }
                                                return b(D, E(h, "", null), 11);
                                              case 11:
                                                x = D.h;
                                              case 10:
                                                ((p = x), D.A(6));
                                                break;
                                              case 12:
                                                p = D.h;
                                              case 6:
                                                if (p) {
                                                  if (p.keyIds)
                                                    for (w = g(p.keyIds), A = w.next(); !A.done; A = w.next())
                                                      ((I = A.value), l.add(I));
                                                  o.push(p);
                                                }
                                              case 4:
                                                ((d = u.next()), D.A(3));
                                                break;
                                              case 2:
                                                for (k = {}, R = g(t), C = R.next(); !C.done; C = R.next())
                                                  ((L = C.value),
                                                    (M = my(L, !e.j)),
                                                    k[M] ? k[M].push(L) : (k[M] = [L]));
                                                for (P in ((_ = []), k))
                                                  ((O = k[P]),
                                                    (N = O[0]),
                                                    (F = yy(N, "FRAME-RATE")),
                                                    (U =
                                                      Number(Ty(N, "BANDWIDTH")) ||
                                                      Number(yy(N, "AVERAGE-BANDWIDTH"))),
                                                    (B = yy(N, "RESOLUTION")),
                                                    ($ = g(B ? B.split("x") : [null, null])),
                                                    (j = $.next().value),
                                                    (G = $.next().value),
                                                    (V = yy(N, "VIDEO-RANGE")),
                                                    (H = yy(N, "REQ-VIDEO-LAYOUT")) &&
                                                      H.includes(",") &&
                                                      ((K = H.split(",").filter(function (e) {
                                                        return "CH-STEREO" == e || "CH-MONO" == e;
                                                      })),
                                                      (H = K[0])),
                                                    (H = H || "CH-MONO"),
                                                    (W = Yy(e, O, i)),
                                                    _.push.apply(
                                                      _,
                                                      m(Jy(e, W.audio, W.video, U, j, G, F, V, H, o, l, s)),
                                                    ));
                                                return D.return(
                                                  _.filter(function (e) {
                                                    return null != e;
                                                  }),
                                                );
                                            }
                                          });
                                        })(e, c, v, h, l, e.B, B),
                                        5,
                                      )
                                    );
                                  case 5:
                                    return (
                                      (a = Z.h),
                                      (s = (function (e, t) {
                                        for (
                                          var r = xy(t, "SUBTITLES"), i = {}, n = (t = g(r)).next();
                                          !n.done;
                                          n = t.next()
                                        ) {
                                          var a = my((n = n.value), !e.j);
                                          i[a] ? i[a].push(n) : (i[a] = [n]);
                                        }
                                        if (((t = []), !e.g.disableText))
                                          for (var s in i)
                                            try {
                                              t.push(Zy(e, i[s], new Map()).stream);
                                            } catch (o) {
                                              if (!e.g.hls.ignoreTextStreamFailures) throw o;
                                            }
                                        for (s = g(r), r = s.next(); !r.done; r = s.next())
                                          if (
                                            ((i = Ty(r.value, "GROUP-ID")),
                                            (r = e.K.get(i)) && (i = e.M.get(i)))
                                          )
                                            for (i = g(i), n = i.next(); !n.done; n = i.next())
                                              (((n = n.value).stream.codecs = r),
                                                (n.stream.mimeType = TT(gt, r) || bT(gt)),
                                                Xy(n.stream));
                                        return t.filter(function (e) {
                                          return e;
                                        });
                                      })(e, h)),
                                      b(
                                        Z,
                                        (function (e, t, r) {
                                          var i, n;
                                          return D(function (a) {
                                            return 1 == a.g
                                              ? ((i = t
                                                  .map(function (t) {
                                                    var r, i;
                                                    return D(function (n) {
                                                      if (1 == n.g)
                                                        return e.g.disableThumbnails
                                                          ? n.return(null)
                                                          : (E(n, 2),
                                                            b(
                                                              n,
                                                              (function (e, t) {
                                                                var r, i, n, a, s, o, l, u, d, h;
                                                                return D(function (c) {
                                                                  return 1 == c.g
                                                                    ? ((r = Ty(t, "URI")),
                                                                      (i = yy(t, "CODECS", "jpeg") || ""),
                                                                      e.i.has(r)
                                                                        ? c.return(e.i.get(r))
                                                                        : ((n = yy(t, "LANGUAGE")),
                                                                          (a = yy(t, "NAME")),
                                                                          (s = yy(t, "CHARACTERISTICS")),
                                                                          (o = tT(
                                                                            e,
                                                                            e.G++,
                                                                            [r],
                                                                            i,
                                                                            "image",
                                                                            n,
                                                                            !1,
                                                                            a,
                                                                            null,
                                                                            null,
                                                                            s,
                                                                            !1,
                                                                            null,
                                                                            !1,
                                                                          )),
                                                                          (l = yy(t, "RESOLUTION"))
                                                                            ? b(
                                                                                c,
                                                                                o.stream.createSegmentIndex(),
                                                                                3,
                                                                              )
                                                                            : c.A(2)))
                                                                    : (2 != c.g &&
                                                                        ((u = Dl(o.stream.segmentIndex)),
                                                                        (d = u.tilesLayout) &&
                                                                          ((o.stream.width =
                                                                            Number(l.split("x")[0]) *
                                                                            Number(d.split("x")[0])),
                                                                          (o.stream.height =
                                                                            Number(l.split("x")[1]) *
                                                                            Number(d.split("x")[1]))),
                                                                        o.stream.closeSegmentIndex()),
                                                                      (h = yy(t, "BANDWIDTH")) &&
                                                                        (o.stream.bandwidth = Number(h)),
                                                                      e.i.set(r, o),
                                                                      c.return(o));
                                                                });
                                                              })(e, t),
                                                              4,
                                                            ));
                                                      if (2 != n.g) return ((r = n.h), n.return(r.stream));
                                                      if (((i = A(n)), e.g.hls.ignoreImageStreamFailures))
                                                        return n.return(null);
                                                      throw i;
                                                    });
                                                  })
                                                  .concat(
                                                    r.map(function (t) {
                                                      if (e.g.disableThumbnails) return null;
                                                      try {
                                                        var r = eT(e, t);
                                                        return "image" !== r.stream.type ? null : r.stream;
                                                      } catch (l) {
                                                        if (e.g.hls.ignoreImageStreamFailures) return null;
                                                        throw l;
                                                      }
                                                    }),
                                                  )),
                                                b(a, Promise.all(i), 2))
                                              : ((n = a.h),
                                                a.return(
                                                  n.filter(function (e) {
                                                    return e;
                                                  }),
                                                ));
                                          });
                                        })(e, f, p),
                                        6,
                                      )
                                    );
                                  case 6:
                                    ((o = Z.h), Z.A(3));
                                    break;
                                  case 7:
                                    ((V = Z.h),
                                      e.i.set(e.H, V),
                                      V.stream &&
                                        ((H = Gl(V.stream)),
                                        V.stream.segmentIndex.Fb(function (e) {
                                          e.ea && (e.ea.xd = H);
                                        })),
                                      (u = V.stream.type),
                                      (K = !0),
                                      ((e.g.disableAudio && "audio" == V.type) ||
                                        (e.g.disableVideo &&
                                          "video" == V.type &&
                                          !V.stream.codecs.includes(","))) &&
                                        (K = !1),
                                      K &&
                                        a.push({
                                          id: 0,
                                          language: Fi(j || "und"),
                                          disabledUntilTime: 0,
                                          primary: !0,
                                          audio: "audio" == V.type ? V.stream : null,
                                          video: "video" == V.type ? V.stream : null,
                                          bandwidth: V.stream.bandwidth || 0,
                                          allowedByApplication: !0,
                                          allowedByKeySystem: !0,
                                          decodingInfos: [],
                                        }));
                                  case 3:
                                    if (!e.h) throw new ze(2, 7, 7001);
                                    if (
                                      (hT(e, i),
                                      1 == i.type &&
                                        (AT(e) && (fT(e, i), (W = e.o), e.F.ka(W)),
                                        (z = Array.from(e.i.values())),
                                        nT(e, z),
                                        zy(e),
                                        vT(e, i.ha, u, d, l)),
                                      (e.m = {
                                        presentationTimeline: e.l,
                                        variants: a,
                                        textStreams: s,
                                        imageStreams: o,
                                        offlineSessionIds: [],
                                        sequenceMode: e.g.hls.sequenceMode,
                                        ignoreManifestTimestampsInSegmentsMode:
                                          e.g.hls.ignoreManifestTimestampsInSegmentsMode,
                                        type: "HLS",
                                        serviceDescription: null,
                                        nextUrl: null,
                                        periodCount: 1,
                                        gapCount: 0,
                                        isLowLatency: !1,
                                        startTime: e.u,
                                      }),
                                      e.ba || !e.g.hls.disableCodecGuessing)
                                    ) {
                                      Z.A(8);
                                      break;
                                    }
                                    for (q = [], X = g(e.m.variants), Y = X.next(); !Y.done; Y = X.next())
                                      ((Q = Y.value).audio &&
                                        "" === Q.audio.codecs &&
                                        q.push(Q.audio.createSegmentIndex()),
                                        Q.video &&
                                          "" === Q.video.codecs &&
                                          q.push(Q.video.createSegmentIndex()));
                                    return b(Z, Promise.all(q), 8);
                                  case 8:
                                    (e.h.makeTextStreamsForClosedCaptions(e.m), S(Z));
                                }
                              });
                            })(i, r.data),
                            3,
                          ))
                        : n.return(i.m);
                  });
                }),
                (n.stop = function () {
                  this.F && (this.F.stop(), (this.F = null));
                  var e = [];
                  return (
                    this.$ && (e.push(this.$.destroy()), (this.$ = null)),
                    (this.g = this.h = null),
                    this.ob.clear(),
                    (this.m = null),
                    this.i.clear(),
                    this.M.clear(),
                    this.K.clear(),
                    this.B.clear(),
                    this.Da.clear(),
                    this.va.clear(),
                    this.O.clear(),
                    this.ya.clear(),
                    this.za.clear(),
                    this.I.clear(),
                    this.j && this.j.destroy(),
                    this.V && (this.V.release(), (this.V = null)),
                    Promise.all(e)
                  );
                }),
                (n.update = function () {
                  var e,
                    t,
                    r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d = this;
                  return D(function (h) {
                    if (1 == h.g) {
                      if (!AT(d)) return h.return();
                      for (
                        e = [],
                          t = Array.from(d.i.values()),
                          d.o = 1 / 0,
                          d.m.gapCount = 0,
                          r = t.filter(function (e) {
                            return !e.stream.isAudioMuxedInVideo && e.stream.segmentIndex;
                          }),
                          i = g(r),
                          n = i.next();
                        !n.done;
                        n = i.next()
                      )
                        ((a = n.value), e.push(Vy(d, a)));
                      return b(h, Promise.all(e), 2);
                    }
                    for (
                      iT(
                        d,
                        r.map(function (e) {
                          return e.stream;
                        }),
                      ),
                        s = r.some(function (e) {
                          return 0 == e.be;
                        }),
                        r.length && !s && (IT(d, UT), zy(d)),
                        s && zy(d),
                        o = g(r),
                        l = o.next();
                      !l.done;
                      l = o.next()
                    )
                      (u = l.value).stream.isAudioMuxedInVideo ||
                        !u.stream.segmentIndex ||
                        Dl(u.stream.segmentIndex) ||
                        d.h.disableStream(u.stream);
                    S(h);
                  });
                }),
                (n.onExpirationUpdated = function () {}),
                (n.onInitialVariantChosen = function () {}),
                (n.banLocation = function (e) {
                  this.j && this.j.banLocation(e);
                }),
                (n.setMediaElement = function (e) {
                  this.X = e;
                }),
                j("shaka.hls.HlsParser", jy));
              var MT = new Map()
                  .set("aac", "audio/aac")
                  .set("ac3", "audio/ac3")
                  .set("ec3", "audio/ec3")
                  .set("mp3", "audio/mpeg"),
                DT = new Map()
                  .set("mp4", "audio/mp4")
                  .set("mp4a", "audio/mp4")
                  .set("m4s", "audio/mp4")
                  .set("m4i", "audio/mp4")
                  .set("m4a", "audio/mp4")
                  .set("m4f", "audio/mp4")
                  .set("cmfa", "audio/mp4")
                  .set("ts", "video/mp2t")
                  .set("tsa", "video/mp2t"),
                _T = new Map()
                  .set("mp4", "video/mp4")
                  .set("mp4v", "video/mp4")
                  .set("m4s", "video/mp4")
                  .set("m4i", "video/mp4")
                  .set("m4v", "video/mp4")
                  .set("m4f", "video/mp4")
                  .set("cmfv", "video/mp4")
                  .set("ts", "video/mp2t")
                  .set("tsv", "video/mp2t"),
                PT = new Map()
                  .set("mp4", "application/mp4")
                  .set("m4s", "application/mp4")
                  .set("m4i", "application/mp4")
                  .set("m4f", "application/mp4")
                  .set("cmft", "application/mp4")
                  .set("vtt", "text/vtt")
                  .set("webvtt", "text/vtt")
                  .set("ttml", "application/ttml+xml"),
                OT = new Map()
                  .set("jpg", "image/jpeg")
                  .set("png", "image/png")
                  .set("svg", "image/svg+xml")
                  .set("webp", "image/webp")
                  .set("avif", "image/avif"),
                NT = new Map().set("audio", DT).set("video", _T).set("text", PT).set("image", OT),
                FT = new Set(["video/mp2t"].concat(m(yi))),
                UT = "VOD",
                BT = "EVENT",
                $T = "LIVE";
              function jT(e) {
                return Qg(e);
              }
              (wt("application/x-mpegurl", function () {
                return new jy();
              }),
                wt("application/vnd.apple.mpegurl", function () {
                  return new jy();
                }));
              var GT = new Map()
                .set("com.microsoft.playready", jT)
                .set("com.microsoft.playready.recommendation", jT)
                .set("com.microsoft.playready.software", jT)
                .set("com.microsoft.playready.hardware", jT);
              function VT() {
                var e = this;
                ((this.h = this.g = null),
                  (this.l = []),
                  (this.j = null),
                  (this.u = 1),
                  (this.i = null),
                  (this.F = new G(5)),
                  (this.o = new Ri(function () {
                    !(function (e) {
                      var t;
                      D(function (r) {
                        switch (r.g) {
                          case 1:
                            return (E(r, 2), b(r, HT(e), 4));
                          case 4:
                            w(r, 3);
                            break;
                          case 2:
                            ((t = A(r)), e.h && ((t.severity = 1), e.h.onError(t)));
                          case 3:
                            if (!e.h) return r.return();
                            S(r);
                        }
                      });
                    })(e);
                  })),
                  (this.C = new Un()),
                  (this.m = new Map()),
                  (this.B = function () {
                    return !1;
                  }));
              }
              function HT(e) {
                var t, r, i, n, a, s, o;
                return D(function (l) {
                  if (1 == l.g)
                    return (
                      (t = Vn(e.l, e.g.retryParameters)),
                      (r = e.h.networkingEngine),
                      (i = Date.now()),
                      (n = r.request(0, t, { type: 5, isPreload: e.B() })),
                      Bn(e.C, n),
                      b(l, n.promise, 2)
                    );
                  if (((a = l.h), !e.h)) return l.return();
                  a.uri && !e.l.includes(a.uri) && e.l.unshift(a.uri);
                  var u = a.uri,
                    d = a.data,
                    h = e.g.mss.manifestPreprocessor;
                  if (h != nd) {
                    if (
                      (he(
                        "manifest.mss.manifestPreprocessor configuration",
                        "Please Use manifest.mss.manifestPreprocessorTXml instead.",
                      ),
                      !(d = Ev(d, "SmoothStreamingMedia")))
                    )
                      throw new ze(2, 4, 4046, u);
                    (h(d), (d = Je(d.outerHTML)));
                  }
                  var c = Xt(d, "SmoothStreamingMedia");
                  if (!c) throw new ze(2, 4, 4046, u);
                  if (
                    ((u = e.g.mss.manifestPreprocessorTXml) != ad && u(c),
                    e.i || (e.i = new ll(null, 0)),
                    (u = sr(c, "IsLive", vr, !1)))
                  )
                    throw new ze(2, 4, 4047);
                  (e.i.cd(!u),
                    (h = sr(c, "TimeScale", gr, 1e7)),
                    (d = sr(c, "DVRWindowLength", gr)),
                    u && (0 === d || isNaN(d)) && (d = 1 / 0));
                  var f,
                    p = sr(c, "CanSeek", vr, !1);
                  for (
                    0 === d && p && (d = 1 / 0),
                      p = null,
                      d && d > 0 && (p = d / h),
                      u && !isNaN(e.g.availabilityWindowOverride) && (p = e.g.availabilityWindowOverride),
                      null == p && (p = 1 / 0),
                      e.i.Lf(p),
                      d = sr(c, "Duration", gr, 1 / 0),
                      u || e.i.Ab(d / h),
                      u = { variants: [], textStreams: [], timescale: h, duration: d / h },
                      p = er(c, "Protection"),
                      h = e.g.mss.keySystemsBySystemId,
                      d = [],
                      f = (p = g(p)).next();
                    !f.done;
                    f = p.next()
                  )
                    d = d.concat(er(f.value, "ProtectionHeader"));
                  if (d.length) {
                    for (p = [], f = 0; f < d.length; f++) {
                      var v = d[f],
                        y = v.attributes.SystemID.toLowerCase(),
                        T = h[y];
                      if (T) {
                        var E;
                        e: {
                          if ((E = Yg(v)))
                            for (var x = (E = g(ir(E, "DATA"))).next(); !x.done; x = E.next())
                              if ((x = nr(x.value, "KID"))) {
                                ((E = at(tr(x))),
                                  (E = ot(
                                    (E = new Uint8Array(
                                      [E[3], E[2], E[1], E[0], E[5], E[4], E[7], E[6]].concat(m(E.slice(8))),
                                    )),
                                  )));
                                break e;
                              }
                          E = null;
                        }
                        ((y = dt(
                          T,
                          "cenc",
                          (y = [
                            {
                              initData: va((x = at(tr(v))), (y = st(y.replace(/-/g, ""))), new Set(), 0),
                              initDataType: "cenc",
                              keyId: E,
                            },
                          ]),
                        )),
                          E && y.keyIds.add(E),
                          (T = GT.get(T)) && (y.licenseServerUri = T(v)),
                          p.push(y));
                      }
                    }
                    h = p;
                  } else h = [];
                  for (
                    f = h, p = [], h = [], d = [], v = (c = g((c = er(c, "StreamIndex")))).next();
                    !v.done;
                    v = c.next()
                  ) {
                    ((T = er((v = v.value), "QualityLevel")),
                      (y = u.timescale),
                      (E = u.duration),
                      (x = er(v, "c")));
                    for (var w = [], A = 0, I = 0; I < x.length; ++I) {
                      var k = x[I],
                        R = x[I + 1],
                        C = sr(k, "t", gr),
                        L = sr(k, "d", gr);
                      if (((k = sr(k, "r", fr)), !L)) break;
                      if (((C = null != C ? C : A), (k = k || 0) && k--, k < 0))
                        if (R) {
                          if (null == (R = sr(R, "t", gr))) break;
                          if (C >= R) break;
                          k = Math.ceil((R - C) / L) - 1;
                        } else {
                          if (E == 1 / 0) break;
                          if (C / y >= E) break;
                          k = Math.ceil((E * y - C) / L) - 1;
                        }
                      for (R = 0; R <= k; ++R)
                        ((A = C + L), w.push({ start: C / y, end: A / y, Ld: C }), (C = A));
                    }
                    for (y = w, E = (T = g(T)).next(); !E.done; E = T.next())
                      (E = KT(e, v, E.value, y, f, u)) &&
                        ("audio" != E.type || e.g.disableAudio
                          ? "video" != E.type || e.g.disableVideo
                            ? E.type != gt || e.g.disableText || d.push(E)
                            : h.push(E)
                          : p.push(E));
                  }
                  for (c = [], f = (p = g(p.length > 0 ? p : [null])).next(); !f.done; f = p.next())
                    for (f = f.value, w = (v = g(h.length > 0 ? h : [null])).next(); !w.done; w = v.next())
                      ((y = (T = c).push),
                        (E = e),
                        (x = f),
                        (w = w.value),
                        (I = 0),
                        x && x.bandwidth && x.bandwidth > 0 && (I += x.bandwidth),
                        w && w.bandwidth && w.bandwidth > 0 && (I += w.bandwidth),
                        (E = {
                          id: E.u++,
                          language: x ? x.language : "und",
                          disabledUntilTime: 0,
                          primary: (!!x && x.primary) || (!!w && w.primary),
                          audio: x,
                          video: w,
                          bandwidth: I,
                          allowedByApplication: !0,
                          allowedByKeySystem: !0,
                          decodingInfos: [],
                        }),
                        y.call(T, E));
                  ((u.variants = c),
                    (u.textStreams = d),
                    e.j
                      ? ((e.j.variants = u.variants), (e.j.textStreams = u.textStreams), e.h.filter(e.j))
                      : ((e.j = {
                          presentationTimeline: e.i,
                          variants: u.variants,
                          textStreams: u.textStreams,
                          imageStreams: [],
                          offlineSessionIds: [],
                          sequenceMode: e.g.mss.sequenceMode,
                          ignoreManifestTimestampsInSegmentsMode: !1,
                          type: "MSS",
                          serviceDescription: null,
                          nextUrl: null,
                          periodCount: 1,
                          gapCount: 0,
                          isLowLatency: !1,
                          startTime: null,
                        }),
                        e.i.qf()),
                    Promise.resolve(),
                    (s = Date.now()),
                    (o = (s - i) / 1e3),
                    e.F.sample(1, o),
                    S(l));
                });
              }
              function KT(e, t, r, i, n, a) {
                var s = t.attributes.Type;
                if ("audio" !== s && "video" !== s && "text" !== s)
                  return (z("Ignoring unrecognized type:", s), null);
                var o = t.attributes.Language,
                  l = e.u++,
                  u = sr(r, "Bitrate", pr),
                  d = sr(r, "MaxWidth", pr),
                  h = sr(r, "MaxHeight", pr),
                  c = sr(r, "Channels", pr),
                  f = sr(r, "SamplingRate", pr),
                  p = a.duration;
                i.length && (p = i[i.length - 1].end - i[0].start);
                var m = e.i.getDuration();
                (e.i.Ab(Math.min(p, m)),
                  (m = t.attributes.Name) && (m += r.attributes.Index),
                  m || (m = String(l)));
                var v = {
                  id: l,
                  originalId: m,
                  groupId: null,
                  createSegmentIndex: function () {
                    return Promise.resolve();
                  },
                  closeSegmentIndex: function () {
                    return Promise.resolve();
                  },
                  segmentIndex: null,
                  mimeType: "",
                  codecs: "",
                  frameRate: void 0,
                  pixelAspectRatio: void 0,
                  bandwidth: u || 0,
                  width: d || void 0,
                  height: h || void 0,
                  kind: "",
                  encrypted: n.length > 0,
                  drmInfos: n,
                  keyIds: new Set(),
                  language: Fi(o || "und"),
                  originalLanguage: o,
                  label: "",
                  type: "",
                  primary: !1,
                  trickModeVideo: null,
                  dependencyStream: null,
                  emsgSchemeIdUris: [],
                  roles: [],
                  forced: !1,
                  channelsCount: c,
                  audioSamplingRate: f,
                  spatialAudio: !1,
                  closedCaptions: null,
                  hdr: void 0,
                  colorGamut: void 0,
                  videoLayout: void 0,
                  tilesLayout: void 0,
                  matchedStreams: [],
                  mssPrivateData: { duration: p, timescale: a.timescale, codecPrivateData: null },
                  accessibilityPurpose: null,
                  external: !1,
                  fastSwitching: !1,
                  fullMimeTypes: new Set(),
                  isAudioMuxedInVideo: !1,
                  baseOriginalId: null,
                };
                if (
                  ((n = t.attributes.Subtype) &&
                    ((n = zT.get(n)) && v.roles.push(n), "main" === n && (v.primary = !0)),
                  (null !== (n = r.attributes.FourCC) && "" !== n) || (n = t.attributes.FourCC),
                  !n)
                )
                  if ("audio" === s) n = "AAC";
                  else if ("video" === s)
                    return (
                      z(
                        'FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"',
                      ),
                      null
                    );
                if (!WT.includes(n.toUpperCase())) return (z("Codec not supported:", n), null);
                switch (
                  ((r = (function (e, t, r, i) {
                    if ((e = e.attributes.CodecPrivateData)) return e;
                    if ("audio" !== t) return null;
                    ((t = i.channelsCount || 2), (e = i.audioSamplingRate || 44100));
                    var n = {
                      96e3: 0,
                      88200: 1,
                      64e3: 2,
                      48e3: 3,
                      44100: 4,
                      32e3: 5,
                      24e3: 6,
                      22050: 7,
                      16e3: 8,
                      12e3: 9,
                      11025: 10,
                      8e3: 11,
                      7350: 12,
                    };
                    return (
                      (i = n[e]),
                      "AACH" === r
                        ? ((r = new Uint8Array(4)),
                          (e = n[2 * e]),
                          (r[0] = 40 | (i >> 1)),
                          (r[1] = (i << 7) | (t << 3) | (e >> 1)),
                          (r[2] = (e << 7) | 8),
                          (r[3] = 0),
                          ((t = new Uint16Array(2))[0] = (r[0] << 8) + r[1]),
                          (t[1] = (r[2] << 8) + r[3]),
                          t[0].toString(16) + t[1].toString(16))
                        : (((r = new Uint8Array(2))[0] = 16 | (i >> 1)),
                          (r[1] = (i << 7) | (t << 3)),
                          ((t = new Uint16Array(1))[0] = (r[0] << 8) + r[1]),
                          t[0].toString(16))
                    );
                  })(r, s, n, v)),
                  (v.mssPrivateData.codecPrivateData = r),
                  s)
                ) {
                  case "audio":
                    if (!r) return (z("Quality unsupported without CodecPrivateData", s), null);
                    ((v.type = "audio"),
                      (v.mimeType = "mss/audio/mp4"),
                      (v.codecs = (function (e, t) {
                        var r = 0;
                        return (
                          "AACH" === e && (r = 5),
                          t
                            ? 0 === r && (r = (248 & parseInt(t.substr(0, 2), 16)) >> 3)
                            : ((r = 2), "AACH" === e && (r = 5)),
                          "mp4a.40." + r
                        );
                      })(n, r)));
                    break;
                  case "video":
                    if (!r) return (z("Quality unsupported without CodecPrivateData", s), null);
                    ((v.type = "video"),
                      (v.mimeType = "mss/video/mp4"),
                      (v.codecs = (function (e) {
                        var t = /00000001[0-9]7/.exec(e);
                        return t.length && e ? "avc1." + e.substr(e.indexOf(t[0]) + 10, 6) : "";
                      })(r)));
                    break;
                  case "text":
                    ((v.type = gt),
                      (v.mimeType = "application/mp4"),
                      ("TTML" === n || "DFXP" === n) && (v.codecs = "stpp"));
                }
                return (
                  v.fullMimeTypes.add(li(v.mimeType, v.codecs)),
                  (v.createSegmentIndex = function () {
                    if (v.segmentIndex) return Promise.resolve();
                    if (e.m.has(v.id)) var r = e.m.get(v.id);
                    else
                      ((r = []),
                        "video" == v.type &&
                          (r = v.mssPrivateData.codecPrivateData.split("00000001").slice(1)),
                        (r = ds(
                          new us([
                            (r = {
                              id: v.id,
                              type: v.type,
                              codecs: v.codecs,
                              encrypted: v.encrypted,
                              timescale: v.mssPrivateData.timescale,
                              duration: v.mssPrivateData.duration,
                              Bb: r,
                              Ga: new Uint8Array([]),
                              Sa: new Uint8Array([]),
                              Za: 0,
                              $a: 0,
                              data: null,
                              stream: v,
                            }),
                          ]),
                        )),
                        e.m.set(v.id, r));
                    return (
                      (r = (function (e, t, r, i, n) {
                        var a = i.attributes.Url.replace("{bitrate}", String(r.bandwidth));
                        i = [];
                        for (var s = (n = g(n)).next(), o = {}; !s.done; o = { Pf: void 0 }, s = n.next())
                          ((o.Pf = s.value),
                            i.push(
                              new Bs(
                                o.Pf.start,
                                o.Pf.end,
                                (function (t) {
                                  return function () {
                                    return ut(e.l, [a.replace("{start time}", String(t.Pf.Ld))]);
                                  };
                                })(o),
                                0,
                                null,
                                t,
                                0,
                                0,
                                r.mssPrivateData.duration,
                              ),
                            ));
                        return i;
                      })(
                        e,
                        new Fs(
                          function () {
                            return [];
                          },
                          0,
                          null,
                          Gl(v),
                          v.mssPrivateData.timescale,
                          r,
                          null,
                          v.encrypted,
                        ),
                        v,
                        t,
                        i,
                      )),
                      (v.segmentIndex = new Ml(r)),
                      Promise.resolve()
                    );
                  }),
                  (v.closeSegmentIndex = function () {
                    v.segmentIndex && (v.segmentIndex.release(), (v.segmentIndex = null));
                  }),
                  v
                );
              }
              (((n = VT.prototype).configure = function (e, t) {
                ((this.g = e), t && (this.B = t));
              }),
                (n.start = function (e, t) {
                  var r = this;
                  return D(function (i) {
                    if (1 == i.g) return ((r.l = [e]), (r.h = t), b(i, HT(r), 2));
                    if (!r.h) throw new ze(2, 7, 7001);
                    return i.return(r.j);
                  });
                }),
                (n.stop = function () {
                  return (
                    (this.g = this.h = null),
                    (this.l = []),
                    (this.j = null),
                    null != this.o && (this.o.stop(), (this.o = null)),
                    this.m.clear(),
                    this.C.destroy()
                  );
                }),
                (n.update = function () {
                  var e,
                    t = this;
                  return D(function (r) {
                    return 1 == r.g
                      ? (E(r, 2), b(r, HT(t), 4))
                      : 2 != r.g
                        ? w(r, 0)
                        : ((e = A(r)), t.h && e ? (t.h.onError(e), void S(r)) : r.return());
                  });
                }),
                (n.onExpirationUpdated = function () {}),
                (n.onInitialVariantChosen = function () {}),
                (n.banLocation = function () {}),
                (n.setMediaElement = function () {}),
                j("shaka.mss.MssParser", VT));
              var WT = "AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),
                zT = new Map().set("CAPT", "main").set("SUBT", "alternate").set("DESC", "main");
              function qT(e, t, r, i, n, a, s) {
                if ((r >= 200 && r <= 299 && 202 != r) || 304 == r)
                  return {
                    uri: n || i,
                    originalUri: i,
                    data: t,
                    status: r,
                    headers: e,
                    fromCache: !!e["x-shaka-from-cache"],
                    originalRequest: a,
                  };
                a = null;
                try {
                  a = Qe(t);
                } catch (o) {}
                throw new ze(401 == r || 403 == r ? 2 : 1, 1, 1001, i, r, a, e, s, n || i);
              }
              function XT() {}
              function YT(e, t, r, i, n, a) {
                var s = new tb();
                try {
                  ea(t.headers).forEach(function (e, t) {
                    s.append(t, e);
                  });
                } catch (d) {
                  return Cn(new ze(1, 1, 1002, e, d, r));
                }
                var o = new ZT(),
                  l = { Vh: !1, ij: !1 };
                if (
                  ((e = (function (e, t, r, i, n, a, s, o, l) {
                    var u, d, h, c, f, p, g, m, v, y, T, x, I, k;
                    return D(function (R) {
                      switch (R.g) {
                        case 1:
                          return (
                            (u = JT),
                            (d = eb),
                            (c = new ArrayBuffer(0)),
                            (p = f = 0),
                            (g = {}),
                            (m = Date.now()),
                            E(R, 2),
                            b(R, u(e, i), 4)
                          );
                        case 4:
                          if (
                            ((h = R.h),
                            (g = (function (e) {
                              var t = {};
                              return (
                                e.forEach(function (e, r) {
                                  t[r.trim()] = e;
                                }),
                                t
                              );
                            })(h.headers)),
                            s(g),
                            "HEAD" == i.method)
                          ) {
                            R.A(5);
                            break;
                          }
                          return (
                            (y = (v = h.headers.get("Content-Length")) ? parseInt(v, 10) : 0),
                            h.body
                              ? ((T = h.clone().body.getReader()),
                                new d({
                                  start: function (e) {
                                    function t() {
                                      var r, i, n, s;
                                      return D(function (u) {
                                        switch (u.g) {
                                          case 1:
                                            return (E(u, 2), b(u, T.read(), 4));
                                          case 4:
                                            ((r = u.h), w(u, 3));
                                            break;
                                          case 2:
                                            return (A(u), u.return());
                                          case 3:
                                            if (r.done) {
                                              u.A(5);
                                              break;
                                            }
                                            if (((f += r.value.byteLength), !o)) {
                                              u.A(5);
                                              break;
                                            }
                                            return b(u, o(r.value), 5);
                                          case 5:
                                            ((i = Date.now()),
                                              (n = f - p),
                                              ((i - m > 100 && n >= l) || r.done) &&
                                                ((s = r.done ? 0 : y - f), a(i - m, n, s), (p = f), (m = i)),
                                              r.done ? e.close() : (e.enqueue(r.value), t()),
                                              S(u));
                                        }
                                      });
                                    }
                                    t();
                                  },
                                }),
                                b(R, h.arrayBuffer(), 8))
                              : b(R, h.arrayBuffer(), 9)
                          );
                        case 8:
                          ((c = R.h), R.A(5));
                          break;
                        case 9:
                          ((c = R.h), (x = Date.now()), a(x - m, c.byteLength, 0));
                        case 5:
                          (t.headers.Range &&
                            2 ==
                              (I = t.headers.Range.replace("bytes=", "")
                                .split("-")
                                .filter(function (e) {
                                  return e;
                                })
                                .map(function (e) {
                                  return parseInt(e, 10);
                                })).length &&
                            c.byteLength != I[1] - I[0] + 1 &&
                            z("Payload length does not match range requested bytes", t, h),
                            w(R, 3));
                          break;
                        case 2:
                          if (((k = A(R)), n.Vh)) throw new ze(1, 1, 7001, e, r);
                          if (n.ij) throw new ze(1, 1, 1003, e, r);
                          throw new ze(1, 1, 1002, e, k, r);
                        case 3:
                          return R.return(qT(g, c, h.status, e, h.url, t, r));
                      }
                    });
                  })(
                    e,
                    t,
                    r,
                    {
                      body: t.body || void 0,
                      headers: s,
                      method: t.method,
                      signal: o.signal,
                      credentials: t.allowCrossSiteCredentials ? "include" : void 0,
                    },
                    l,
                    i,
                    n,
                    t.streamDataCallback,
                    a.minBytesForProgressEvents || 0,
                  )),
                  (e = new Rn(e, function () {
                    return ((l.Vh = !0), o.abort(), Promise.resolve());
                  })),
                  (t = t.retryParameters.timeout))
                ) {
                  var u = new Ri(function () {
                    ((l.ij = !0), o.abort());
                  });
                  (u.ka(t / 1e3),
                    e.finally(function () {
                      u.stop();
                    }));
                }
                return e;
              }
              function QT() {
                if (!e.ReadableStream) return !1;
                try {
                  new ReadableStream({});
                } catch (pw) {
                  return !1;
                }
                return (
                  !!e.Response &&
                  !!new Response("").body &&
                  !(!e.fetch || "polyfill" in e.fetch || !e.AbortController)
                );
              }
              (wt("application/vnd.ms-sstr+xml", function () {
                return new VT();
              }),
                j("shaka.net.HttpFetchPlugin", XT),
                (XT.isSupported = QT),
                (XT.parse = YT));
              var JT = e.fetch,
                ZT = e.AbortController,
                eb = e.ReadableStream,
                tb = e.Headers;
              function rb() {}
              function ib(e, t, r, i, n, a) {
                var s = new nb(),
                  o = Date.now(),
                  l = 0;
                return new Rn(
                  new Promise(function (u, d) {
                    (s.open(t.method, e, !0),
                      (s.responseType = "arraybuffer"),
                      (s.timeout = t.retryParameters.timeout),
                      (s.withCredentials = t.allowCrossSiteCredentials));
                    var h = {};
                    for (var c in ((s.onabort = function () {
                      d(new ze(1, 1, 7001, e, r));
                    }),
                    (s.onreadystatechange = function () {
                      if (s.readyState === XMLHttpRequest.HEADERS_RECEIVED) {
                        for (
                          var e = s.getAllResponseHeaders().trim().split("\r\n"),
                            t = {},
                            r = (e = g(e)).next();
                          !r.done;
                          r = e.next()
                        )
                          t[(r = r.value.split(": "))[0].toLowerCase()] = r.slice(1).join(": ");
                        n((h = t));
                      }
                    }),
                    (s.onload = function (n) {
                      var a = s.response;
                      try {
                        i(Date.now() - o, n.loaded - l, 0);
                        var c = qT(h, a, s.status, e, s.responseURL, t, r);
                        u(c);
                      } catch (f) {
                        d(f);
                      }
                    }),
                    (s.onerror = function (t) {
                      d(new ze(1, 1, 1002, e, t, r));
                    }),
                    (s.ontimeout = function () {
                      d(new ze(1, 1, 1003, e, r));
                    }),
                    (s.onprogress = function (e) {
                      var t = Date.now(),
                        r = a.minBytesForProgressEvents || 0,
                        n = e.loaded - l;
                      ((t - o > 100 && n >= r) || (e.lengthComputable && e.loaded == e.total)) &&
                        (i(t - o, n, 4 == s.readyState ? 0 : e.total - e.loaded), (l = e.loaded), (o = t));
                    }),
                    t.headers))
                      try {
                        s.setRequestHeader(c.toLowerCase(), t.headers[c]);
                      } catch (f) {
                        throw new ze(1, 1, 1002, e, f, r);
                      }
                    s.send(t.body);
                  }),
                  function () {
                    return (s.abort(), Promise.resolve());
                  },
                );
              }
              (QT() && (jn("http", YT, 2, !0), jn("https", YT, 2, !0), jn("blob", YT, 2, !0)),
                j("shaka.net.HttpXHRPlugin", rb),
                (rb.parse = ib));
              var nb = e.XMLHttpRequest;
              function ab(e, t, r, i, n) {
                ((this.g = e), (this.i = t), (this.groupId = r), (this.h = i), (this.j = n));
              }
              function sb(e) {
                var t = e.$b(!1);
                return t
                  ? nt(t)
                  : e
                      .P()
                      .map(function (e) {
                        return "{" + encodeURI(e.split("#xywh=")[0]) + "}";
                      })
                      .join("") +
                      ":" +
                      e.startByte +
                      ":" +
                      e.endByte;
              }
              function ob(e, t) {
                return lu(e.g.P(), e.g.startByte, e.g.endByte, t.streaming.retryParameters);
              }
              function lb() {
                ((this.g = this.j = this.i = 0), (this.h = new Map()), (this.l = 0));
              }
              function ub(e, t) {
                e.i += t;
                var r = e.l;
                return (e.l++, e.h.set(r, t), r);
              }
              function db(e) {
                return 0 == e.i ? 0 : e.j / e.i;
              }
              function hb(e) {
                var t = this;
                ((this.u = e),
                  (this.i = new Map()),
                  (this.h = new Qn(function () {
                    return cb(t).catch(function () {});
                  })),
                  (this.j = []),
                  (this.o = function () {}),
                  (this.m = function () {}),
                  (this.g = new lb()),
                  (this.l = !1));
              }
              function cb(e) {
                e.l = !0;
                var t = e.j.map(function (e) {
                  return e();
                });
                return ((e.j = []), Promise.all(t));
              }
              function fb(e, t, r, i, n, a) {
                Jn(e.h);
                var s = (e.i.get(t) || Promise.resolve()).then(function () {
                  if (e.h.g) throw new ze(2, 9, 7001);
                  if (n) {
                    var t = Oe(r);
                    for (var s in (t = new ma(t)).data) {
                      var o = Number(s);
                      e.m(t.data[o], t.g[o]);
                    }
                  }
                  return (e.g.close(i, r.byteLength), e.o(db(e.g), e.g.g), a(r));
                });
                e.i.set(t, s);
              }
              function pb(e, t) {
                var r = this;
                ((this.i = e),
                  (this.h = e.objectStore(t)),
                  (this.g = new kn()),
                  (e.onabort = function (e) {
                    (e.preventDefault(), r.g.reject());
                  }),
                  (e.onerror = function (e) {
                    (e.preventDefault(), r.g.reject());
                  }),
                  (e.oncomplete = function () {
                    r.g.resolve();
                  }));
              }
              function gb(e, t) {
                return new Promise(function (r, i) {
                  var n = e.h.openCursor();
                  ((n.onerror = i),
                    (n.onsuccess = function () {
                      var e;
                      return D(function (i) {
                        if (1 == i.g)
                          return null == n.result
                            ? (r(), i.return())
                            : ((e = n.result), b(i, t(e.key, e.value, e), 2));
                        (e.continue(), S(i));
                      });
                    }));
                });
              }
              function mb(e) {
                ((this.h = e), (this.g = []));
              }
              function vb(e, t) {
                return yb(e, t, "readwrite");
              }
              function yb(e, t, r) {
                var i = new pb((r = e.h.transaction([t], r)), t);
                return (
                  e.g.push(i),
                  i.promise().then(
                    function () {
                      J(e.g, i);
                    },
                    function () {
                      J(e.g, i);
                    },
                  ),
                  i
                );
              }
              function Tb(e, t, r) {
                ((this.h = new mb(e)), (this.i = t), (this.g = r));
              }
              function bb(e) {
                return Promise.reject(new ze(2, 9, 9011, "Cannot add new value to " + e));
              }
              function Sb(e, t, r, i) {
                t = (e = vb(e.h, t)).store();
                for (var n = (r = g(r)).next(), a = {}; !n.done; a = { Tg: void 0 }, n = r.next())
                  ((a.Tg = n.value),
                    (t.delete(a.Tg).onsuccess = (function (e) {
                      return function () {
                        return i(e.Tg);
                      };
                    })(a)));
                return e.promise();
              }
              function Eb(e, t, r) {
                var i, n, a, s, o, l, u;
                return D(function (d) {
                  if (1 == d.g) {
                    for (
                      i = yb(e.h, t, "readonly"),
                        n = i.store(),
                        a = {},
                        s = [],
                        o = g(r),
                        l = o.next(),
                        u = {};
                      !l.done;
                      u = { Ef: void 0, lf: void 0 }, l = o.next()
                    )
                      ((u.lf = l.value),
                        (u.Ef = n.get(u.lf)),
                        (u.Ef.onsuccess = (function (e) {
                          return function () {
                            (null == e.Ef.result && s.push(e.lf), (a[e.lf] = e.Ef.result));
                          };
                        })(u)));
                    return b(d, i.promise(), 2);
                  }
                  if (s.length) throw new ze(2, 9, 9012, "Could not find values for " + s);
                  return d.return(
                    r.map(function (e) {
                      return a[e];
                    }),
                  );
                });
              }
              function xb(e) {
                this.g = new mb(e);
              }
              function wb() {
                this.g = new Map();
              }
              function Ab(e) {
                var t = null;
                if (
                  (e.g.forEach(function (e, r) {
                    e.getCells().forEach(function (e, i) {
                      e.hasFixedKeySpace() || t || (t = { path: { Pb: r, cb: i }, cb: e });
                    });
                  }),
                  t)
                )
                  return t;
                throw new ze(2, 9, 9013, "Could not find a cell that supports add-operations");
              }
              function Ib(e, t, r) {
                if (!(e = e.g.get(t))) throw new ze(2, 9, 9013, "Could not find mechanism with name " + t);
                if (!(t = e.getCells().get(r)))
                  throw new ze(2, 9, 9013, "Could not find cell with name " + r);
                return t;
              }
              function kb(e, t) {
                Rb.set(e, t);
              }
              (jn("http", ib, 1, !0),
                jn("https", ib, 1, !0),
                jn("blob", ib, 1, !0),
                (lb.prototype.close = function (e, t) {
                  if (this.h.has(e)) {
                    var r = this.h.get(e);
                    (this.h.delete(e), (this.j += r), (this.g += t));
                  }
                }),
                (hb.prototype.destroy = function () {
                  return this.h.destroy();
                }),
                (hb.prototype.queue = function (e, t, r, i, n) {
                  var a = this;
                  Jn(this.h);
                  var s = (this.i.get(e) || Promise.resolve()).then(function () {
                    var e, s, o, l, u, d, h;
                    return D(function (c) {
                      if (1 == c.g)
                        return b(
                          c,
                          (function (e, t) {
                            var r, i, n, a;
                            return D(function (s) {
                              return 1 == s.g
                                ? ((r = qn),
                                  (i = e.u.request(r, t)),
                                  (n = function () {
                                    return i.abort();
                                  }),
                                  e.j.push(n),
                                  b(s, i.promise, 2))
                                : ((a = s.h), J(e.j, n), s.return(a.data));
                            });
                          })(a, t),
                          2,
                        );
                      if (((e = c.h), a.h.g)) throw new ze(2, 9, 7001);
                      if (i)
                        for (l in ((s = Oe(e)), (o = new ma(s)).data))
                          ((u = Number(l)), (d = o.data[u]), (h = o.g[u]), a.m(d, h));
                      return (a.g.close(r, e.byteLength), a.o(db(a.g), a.g.g), c.return(n(e)));
                    });
                  });
                  return (this.i.set(e, s), s);
                }),
                (pb.prototype.abort = function () {
                  var e = this;
                  return D(function (t) {
                    if (1 == t.g) {
                      try {
                        e.i.abort();
                      } catch (r) {}
                      return (E(t, 2), b(t, e.g, 4));
                    }
                    if (2 != t.g) return w(t, 0);
                    (A(t), S(t));
                  });
                }),
                (pb.prototype.store = function () {
                  return this.h;
                }),
                (pb.prototype.promise = function () {
                  return this.g;
                }),
                (mb.prototype.destroy = function () {
                  return Promise.all(
                    this.g.map(function (e) {
                      return e.abort();
                    }),
                  );
                }),
                ((n = Tb.prototype).destroy = function () {
                  return this.h.destroy();
                }),
                (n.hasFixedKeySpace = function () {
                  return !0;
                }),
                (n.addSegments = function () {
                  return bb(this.i);
                }),
                (n.removeSegments = function (e, t) {
                  return Sb(this, this.i, e, t);
                }),
                (n.getSegments = function (e) {
                  var t,
                    r = this;
                  return D(function (i) {
                    return 1 == i.g
                      ? b(i, Eb(r, r.i, e), 2)
                      : ((t = i.h),
                        i.return(
                          t.map(function (e) {
                            return r.Xh(e);
                          }),
                        ));
                  });
                }),
                (n.addManifests = function () {
                  return bb(this.g);
                }),
                (n.updateManifest = function () {
                  return Promise.reject(new ze(2, 9, 9016, "Cannot modify values in " + this.g));
                }),
                (n.updateManifestExpiration = function (e, t) {
                  var r = vb(this.h, this.g),
                    i = r.store();
                  return (
                    (i.get(e).onsuccess = function (r) {
                      (r = r.target.result) && ((r.expiration = t), i.put(r, e));
                    }),
                    r.promise()
                  );
                }),
                (n.removeManifests = function (e, t) {
                  return Sb(this, this.g, e, t);
                }),
                (n.getManifests = function (e) {
                  var t,
                    r = this;
                  return D(function (i) {
                    return 1 == i.g
                      ? b(i, Eb(r, r.g, e), 2)
                      : ((t = i.h),
                        i.return(
                          Promise.all(
                            t.map(function (e) {
                              return r.Ud(e);
                            }),
                          ),
                        ));
                  });
                }),
                (n.getAllManifests = function () {
                  var e,
                    t,
                    r = this;
                  return D(function (i) {
                    return 1 == i.g
                      ? ((e = yb(r.h, r.g, "readonly")),
                        (t = new Map()),
                        b(
                          i,
                          gb(e, function (e, i) {
                            var n;
                            return D(function (a) {
                              if (1 == a.g) return b(a, r.Ud(i), 2);
                              ((n = a.h), t.set(e, n), S(a));
                            });
                          }),
                          2,
                        ))
                      : 3 != i.g
                        ? b(i, e.promise(), 3)
                        : i.return(t);
                  });
                }),
                (n.Xh = function (e) {
                  return e;
                }),
                (n.Ud = function (e) {
                  return Promise.resolve(e);
                }),
                (n.add = function (e, t) {
                  var r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u = this;
                  return D(function (d) {
                    if (1 == d.g) {
                      for (
                        r = vb(u.h, e), i = r.store(), n = [], a = g(t), s = a.next(), o = {};
                        !s.done;
                        o = { hh: void 0 }, s = a.next()
                      )
                        ((l = s.value),
                          (o.hh = i.add(l)),
                          (o.hh.onsuccess = (function (e) {
                            return function () {
                              n.push(e.hh.result);
                            };
                          })(o)));
                      return b(d, r.promise(), 2);
                    }
                    return d.return(n);
                  });
                }),
                (xb.prototype.destroy = function () {
                  return this.g.destroy();
                }),
                (xb.prototype.getAll = function () {
                  var e,
                    t,
                    r = this;
                  return D(function (i) {
                    return 1 == i.g
                      ? ((e = yb(r.g, "session-ids", "readonly")),
                        (t = []),
                        b(
                          i,
                          gb(e, function (e, r) {
                            t.push(r);
                          }),
                          2,
                        ))
                      : 3 != i.g
                        ? b(i, e.promise(), 3)
                        : i.return(t);
                  });
                }),
                (xb.prototype.add = function (e) {
                  for (
                    var t = vb(this.g, "session-ids"), r = t.store(), i = (e = g(e)).next();
                    !i.done;
                    i = e.next()
                  )
                    r.add(i.value);
                  return t.promise();
                }),
                (xb.prototype.remove = function (e) {
                  var t,
                    r = this;
                  return D(function (i) {
                    return 1 == i.g
                      ? b(
                          i,
                          gb((t = vb(r.g, "session-ids")), function (t, r, i) {
                            e.includes(r.sessionId) && i.delete();
                          }),
                          2,
                        )
                      : b(i, t.promise(), 0);
                  });
                }),
                (wb.prototype.destroy = function () {
                  for (var e = [], t = g(this.g.values()), r = t.next(); !r.done; r = t.next())
                    e.push(r.value.destroy());
                  return (this.g.clear(), Promise.all(e));
                }),
                (wb.prototype.init = function () {
                  var e = this;
                  Rb.forEach(function (t, r) {
                    (t = t()) && e.g.set(r, t);
                  });
                  for (var t = [], r = g(this.g.values()), i = r.next(); !i.done; i = r.next())
                    t.push(i.value.init());
                  return Promise.all(t);
                }),
                j("shaka.offline.StorageMuxer", wb),
                (wb.unregister = function (e) {
                  Rb.delete(e);
                }),
                (wb.register = kb),
                (wb.prototype.destroy = wb.prototype.destroy));
              var Rb = new Map();
              function Cb() {
                Tb.apply(this, arguments);
              }
              function Lb(e, t) {
                !(function (e) {
                  var t = e.streams.filter(function (e) {
                    return "audio" == e.contentType;
                  });
                  if (
                    ((e = e.streams.filter(function (e) {
                      return "video" == e.contentType;
                    })),
                    !t.every(function (e) {
                      return e.variantIds;
                    }) ||
                      !e.every(function (e) {
                        return e.variantIds;
                      }))
                  ) {
                    for (var r = g(t), i = r.next(); !i.done; i = r.next()) i.value.variantIds = [];
                    for (i = (r = g(e)).next(); !i.done; i = r.next()) i.value.variantIds = [];
                    if (((r = 0), e.length && !t.length)) {
                      i = r++;
                      for (var n = g(e), a = n.next(); !a.done; a = n.next()) a.value.variantIds.push(i);
                    }
                    if (!e.length && t.length)
                      for (i = r++, a = (n = g(t)).next(); !a.done; a = n.next()) a.value.variantIds.push(i);
                    if (e.length && t.length)
                      for (i = (t = g(t)).next(); !i.done; i = t.next())
                        for (i = i.value, a = (n = g(e)).next(); !a.done; a = n.next()) {
                          a = a.value;
                          var s = r++;
                          (i.variantIds.push(s), a.variantIds.push(s));
                        }
                  }
                })(e);
                for (var r = g(e.streams), i = r.next(); !i.done; i = r.next());
                return e.streams.map(function (r) {
                  return (function (e, t, r) {
                    var i = e.initSegmentUri ? Mb(e.initSegmentUri) : null,
                      n = t + e.presentationTimeOffset,
                      a = t + r;
                    return {
                      id: e.id,
                      originalId: null,
                      groupId: null,
                      primary: e.primary,
                      type: e.contentType,
                      mimeType: e.mimeType,
                      codecs: e.codecs,
                      frameRate: e.frameRate,
                      pixelAspectRatio: void 0,
                      hdr: void 0,
                      colorGamut: void 0,
                      videoLayout: void 0,
                      kind: e.kind,
                      language: e.language,
                      originalLanguage: e.language || null,
                      label: e.label,
                      width: e.width,
                      height: e.height,
                      initSegmentKey: i,
                      encrypted: e.encrypted,
                      keyIds: new Set([e.keyId]),
                      segments: e.segments.map(function (e) {
                        var r = Mb(e.uri);
                        return {
                          startTime: t + e.startTime,
                          endTime: t + e.endTime,
                          dataKey: r,
                          initSegmentKey: i,
                          appendWindowStart: t,
                          appendWindowEnd: a,
                          timestampOffset: n,
                          tilesLayout: "",
                          mimeType: null,
                          codecs: null,
                          thumbnailSprite: null,
                        };
                      }),
                      variantIds: e.variantIds,
                      roles: [],
                      forced: !1,
                      audioSamplingRate: null,
                      channelsCount: null,
                      spatialAudio: !1,
                      closedCaptions: null,
                      tilesLayout: void 0,
                      external: !1,
                      fastSwitching: !1,
                      isAudioMuxedInVideo: !1,
                    };
                  })(r, e.startTime, t);
                });
              }
              function Mb(e) {
                var t;
                if (
                  (t = /^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e)) ||
                  (t = /^offline:segment\/([0-9]+)$/.exec(e))
                )
                  return Number(t[1]);
                throw new ze(2, 9, 9004, "Could not parse uri " + e);
              }
              function Db() {
                Tb.apply(this, arguments);
              }
              function _b(e, t, r) {
                return {
                  id: e.id,
                  originalId: e.originalId,
                  groupId: null,
                  primary: e.primary,
                  type: e.contentType,
                  mimeType: e.mimeType,
                  codecs: e.codecs,
                  frameRate: e.frameRate,
                  pixelAspectRatio: e.pixelAspectRatio,
                  hdr: void 0,
                  colorGamut: void 0,
                  videoLayout: void 0,
                  kind: e.kind,
                  language: e.language,
                  originalLanguage: e.language || null,
                  label: e.label,
                  width: e.width,
                  height: e.height,
                  encrypted: e.encrypted,
                  keyIds: new Set([e.keyId]),
                  segments: e.segments.map(function (i) {
                    return {
                      startTime: t + i.startTime,
                      endTime: t + i.endTime,
                      initSegmentKey: e.initSegmentKey,
                      appendWindowStart: t,
                      appendWindowEnd: r,
                      timestampOffset: t - e.presentationTimeOffset,
                      dataKey: i.dataKey,
                      tilesLayout: "",
                      mimeType: null,
                      codecs: null,
                      thumbnailSprite: null,
                    };
                  }),
                  variantIds: e.variantIds,
                  roles: [],
                  forced: !1,
                  audioSamplingRate: null,
                  channelsCount: null,
                  spatialAudio: !1,
                  closedCaptions: null,
                  tilesLayout: void 0,
                  external: !1,
                  fastSwitching: !1,
                  isAudioMuxedInVideo: !1,
                };
              }
              function Pb() {
                Tb.apply(this, arguments);
              }
              function Ob() {
                this.m = this.j = this.i = this.h = this.g = this.l = null;
              }
              (f(Cb, Tb),
                (Cb.prototype.updateManifestExpiration = function (e, t) {
                  var r,
                    i,
                    n,
                    a = this;
                  return D(function (s) {
                    return (
                      (r = vb(a.h, a.g)),
                      (i = r.store()),
                      (n = new kn()),
                      (i.get(e).onsuccess = function (r) {
                        (r = r.target.result)
                          ? ((r.expiration = t), i.put(r), n.resolve())
                          : n.reject(new ze(2, 9, 9012, "Could not find values for " + e));
                      }),
                      b(s, Promise.all([r.promise(), n]), 0)
                    );
                  });
                }),
                (Cb.prototype.Ud = function (e) {
                  var t, r, i, n, a, s;
                  return D(function (o) {
                    if (1 == o.g) {
                      for (t = [], r = 0; r < e.periods.length; ++r)
                        ((i = r == e.periods.length - 1 ? e.duration : e.periods[r + 1].startTime),
                          (n = i - e.periods[r].startTime),
                          (a = Lb(e.periods[r], n)),
                          t.push(a));
                      return b(o, jm(t), 2);
                    }
                    return (
                      (s = o.h),
                      o.return({
                        creationTime: 0,
                        originalManifestUri: e.originalManifestUri,
                        duration: e.duration,
                        size: e.size,
                        expiration: null == e.expiration ? 1 / 0 : e.expiration,
                        streams: s,
                        sessionIds: e.sessionIds,
                        drmInfo: e.drmInfo,
                        appMetadata: e.appMetadata,
                        sequenceMode: !1,
                      })
                    );
                  });
                }),
                (Cb.prototype.Xh = function (e) {
                  return { data: e.data };
                }),
                f(Db, Tb),
                (Db.prototype.Ud = function (e) {
                  var t, r, i, n, a, s;
                  return D(function (o) {
                    if (1 == o.g) {
                      for (t = [], r = 0; r < e.periods.length; ++r) {
                        ((i = r == e.periods.length - 1 ? e.duration : e.periods[r + 1].startTime),
                          (n = i - e.periods[r].startTime));
                        for (
                          var l = e.periods[r], u = [], d = g(l.streams), h = d.next();
                          !h.done;
                          h = d.next()
                        )
                          0 != (h = h.value).variantIds.length && u.push(_b(h, l.startTime, l.startTime + n));
                        ((a = u), t.push(a));
                      }
                      return b(o, jm(t), 2);
                    }
                    return (
                      (s = o.h),
                      o.return({
                        appMetadata: e.appMetadata,
                        creationTime: 0,
                        drmInfo: e.drmInfo,
                        duration: e.duration,
                        expiration: null == e.expiration ? 1 / 0 : e.expiration,
                        originalManifestUri: e.originalManifestUri,
                        sessionIds: e.sessionIds,
                        size: e.size,
                        streams: s,
                        sequenceMode: !1,
                      })
                    );
                  });
                }),
                f(Pb, Tb),
                ((n = Pb.prototype).hasFixedKeySpace = function () {
                  return !1;
                }),
                (n.addSegments = function (e) {
                  return this.add(this.i, e);
                }),
                (n.addManifests = function (e) {
                  return this.add(this.g, e);
                }),
                (n.updateManifest = function (e, t) {
                  return (function (e, t, r) {
                    var i = (e = vb(e.h, e.g)).store();
                    return (
                      (i.get(t).onsuccess = function () {
                        i.put(r, t);
                      }),
                      e.promise()
                    );
                  })(this, e, t);
                }),
                (n.Ud = function (e) {
                  return (null == e.expiration && (e.expiration = 1 / 0), Promise.resolve(e));
                }),
                ((n = Ob.prototype).init = function () {
                  var t = this,
                    r = new kn(),
                    i = !1,
                    n = new Ri(function () {
                      ((i = !0), r.reject(new ze(2, 9, 9017)));
                    });
                  "number" == typeof Nb && Nb > 0 && n.ka(Nb);
                  var a = e.indexedDB.open("shaka_offline_db", 5);
                  return (
                    (a.onsuccess = function () {
                      if (!i) {
                        n.stop();
                        var e = a.result;
                        t.l = e;
                        var s = e.objectStoreNames;
                        ((s =
                          s.contains("manifest") && s.contains("segment")
                            ? new Cb(e, "segment", "manifest")
                            : null),
                          (t.g = s),
                          (s =
                            (s = e.objectStoreNames).contains("manifest-v2") && s.contains("segment-v2")
                              ? new Db(e, "segment-v2", "manifest-v2")
                              : null),
                          (t.h = s),
                          (s =
                            (s = e.objectStoreNames).contains("manifest-v3") && s.contains("segment-v3")
                              ? new Db(e, "segment-v3", "manifest-v3")
                              : null),
                          (t.i = s),
                          (s =
                            (s = e.objectStoreNames).contains("manifest-v5") && s.contains("segment-v5")
                              ? new Pb(e, "segment-v5", "manifest-v5")
                              : null),
                          (t.j = s),
                          (e = e.objectStoreNames.contains("session-ids") ? new xb(e) : null),
                          (t.m = e),
                          r.resolve());
                      }
                    }),
                    (a.onupgradeneeded = function () {
                      for (
                        var e = a.result, t = g(["segment-v5", "manifest-v5", "session-ids"]), r = t.next();
                        !r.done;
                        r = t.next()
                      )
                        ((r = r.value),
                          e.objectStoreNames.contains(r) || e.createObjectStore(r, { autoIncrement: !0 }));
                    }),
                    (a.onerror = function (e) {
                      i || (n.stop(), r.reject(new ze(2, 9, 9001, a.error)), e.preventDefault());
                    }),
                    r
                  );
                }),
                (n.destroy = function () {
                  var e = this;
                  return D(function (t) {
                    switch (t.g) {
                      case 1:
                        if (!e.g) {
                          t.A(2);
                          break;
                        }
                        return b(t, e.g.destroy(), 2);
                      case 2:
                        if (!e.h) {
                          t.A(4);
                          break;
                        }
                        return b(t, e.h.destroy(), 4);
                      case 4:
                        if (!e.i) {
                          t.A(6);
                          break;
                        }
                        return b(t, e.i.destroy(), 6);
                      case 6:
                        if (!e.j) {
                          t.A(8);
                          break;
                        }
                        return b(t, e.j.destroy(), 8);
                      case 8:
                        if (!e.m) {
                          t.A(10);
                          break;
                        }
                        return b(t, e.m.destroy(), 10);
                      case 10:
                        (e.l && e.l.close(), S(t));
                    }
                  });
                }),
                (n.getCells = function () {
                  var e = new Map();
                  return (
                    this.g && e.set("v1", this.g),
                    this.h && e.set("v2", this.h),
                    this.i && e.set("v3", this.i),
                    this.j && e.set("v5", this.j),
                    e
                  );
                }),
                (n.getEmeSessionCell = function () {
                  return this.m;
                }),
                (n.erase = function () {
                  var t = this;
                  return D(function (r) {
                    switch (r.g) {
                      case 1:
                        if (!t.g) {
                          r.A(2);
                          break;
                        }
                        return b(r, t.g.destroy(), 2);
                      case 2:
                        if (!t.h) {
                          r.A(4);
                          break;
                        }
                        return b(r, t.h.destroy(), 4);
                      case 4:
                        if (!t.i) {
                          r.A(6);
                          break;
                        }
                        return b(r, t.i.destroy(), 6);
                      case 6:
                        if (!t.j) {
                          r.A(8);
                          break;
                        }
                        return b(r, t.j.destroy(), 8);
                      case 8:
                        return (
                          t.l && t.l.close(),
                          b(
                            r,
                            (function () {
                              var t = new kn(),
                                r = e.indexedDB.deleteDatabase("shaka_offline_db");
                              return (
                                (r.onblocked = function () {}),
                                (r.onsuccess = function () {
                                  t.resolve();
                                }),
                                (r.onerror = function (e) {
                                  (t.reject(new ze(2, 9, 9001, r.error)), e.preventDefault());
                                }),
                                t
                              );
                            })(),
                            10,
                          )
                        );
                      case 10:
                        return (
                          (t.l = null),
                          (t.g = null),
                          (t.h = null),
                          (t.i = null),
                          (t.j = null),
                          b(r, t.init(), 0)
                        );
                    }
                  });
                }));
              var Nb = 5;
              function Fb(e, t, r, i) {
                ((this.g = e),
                  (this.i = t),
                  (this.h = r),
                  (this.l = i),
                  (this.j = ["offline:", e, "/", t, "/", r, "/", i].join("")));
              }
              function Ub(e) {
                if (null == (e = /^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e))) return null;
                var t = e[1];
                if ("manifest" != t && "segment" != t) return null;
                var r = e[2];
                if (!r) return null;
                var i = e[3];
                return i && null != t ? new Fb(t, r, i, Number(e[4])) : null;
              }
              function Bb(e, t) {
                ((this.h = e), (this.g = t));
              }
              function $b(e, t) {
                var r = new ll(null, 0);
                r.Ab(t.duration);
                var i = t.streams.filter(function (e) {
                    return "audio" == e.type;
                  }),
                  n = t.streams.filter(function (e) {
                    return "video" == e.type;
                  });
                ((i = (function (e, t, r, i) {
                  for (var n = new Set(), a = g(t), s = a.next(); !s.done; s = a.next())
                    for (var o = (s = g(s.value.variantIds)).next(); !o.done; o = s.next()) n.add(o.value);
                  for (a = g(r), s = a.next(); !s.done; s = a.next())
                    for (s = g(s.value.variantIds), o = s.next(); !o.done; o = s.next()) n.add(o.value);
                  for (a = new Map(), n = g(n), s = n.next(); !s.done; s = n.next())
                    ((s = s.value),
                      a.set(s, {
                        id: s,
                        language: "",
                        disabledUntilTime: 0,
                        primary: !1,
                        audio: null,
                        video: null,
                        bandwidth: 0,
                        allowedByApplication: !0,
                        allowedByKeySystem: !0,
                        decodingInfos: [],
                      }));
                  for (t = g(t), n = t.next(); !n.done; n = t.next())
                    for (
                      s = n.value, n = jb(e, s, i), s = g(s.variantIds), o = s.next();
                      !o.done;
                      o = s.next()
                    )
                      (((o = a.get(o.value)).language = n.language),
                        (o.primary = o.primary || n.primary),
                        (o.audio = n));
                  for (r = g(r), t = r.next(); !t.done; t = r.next())
                    for (
                      n = t.value, t = jb(e, n, i), n = g(n.variantIds), s = n.next();
                      !s.done;
                      s = n.next()
                    )
                      (((s = a.get(s.value)).primary = s.primary || t.primary), (s.video = t));
                  return a;
                })(e, i, n, r)),
                  (n = t.streams
                    .filter(function (e) {
                      return e.type == gt;
                    })
                    .map(function (t) {
                      return jb(e, t, r);
                    })));
                var a = t.streams
                    .filter(function (e) {
                      return "image" == e.type;
                    })
                    .map(function (t) {
                      return jb(e, t, r);
                    }),
                  s = t.drmInfo ? [t.drmInfo] : [];
                if (t.drmInfo)
                  for (var o = g(i.values()), l = o.next(); !l.done; l = o.next())
                    ((l = l.value).audio && l.audio.encrypted && (l.audio.drmInfos = s),
                      l.video && l.video.encrypted && (l.video.drmInfos = s));
                return {
                  presentationTimeline: r,
                  offlineSessionIds: t.sessionIds,
                  variants: Array.from(i.values()),
                  textStreams: n,
                  imageStreams: a,
                  sequenceMode: t.sequenceMode || !1,
                  ignoreManifestTimestampsInSegmentsMode: !1,
                  type: t.type || "UNKNOWN",
                  serviceDescription: null,
                  nextUrl: null,
                  periodCount: 1,
                  gapCount: 0,
                  isLowLatency: !1,
                  startTime: null,
                };
              }
              function jb(e, t, r) {
                var i = t.segments.map(function (r) {
                  return (function (e, t, r) {
                    var i = new Fb("segment", e.h, e.g, t.dataKey);
                    return (
                      (e = new Bs(
                        t.startTime,
                        t.endTime,
                        function () {
                          return [i.toString()];
                        },
                        0,
                        null,
                        null != t.initSegmentKey
                          ? (function (e, t) {
                              var r = new Fb("segment", e.h, e.g, t);
                              return new Fs(
                                function () {
                                  return [r.toString()];
                                },
                                0,
                                null,
                              );
                            })(e, t.initSegmentKey)
                          : null,
                        t.timestampOffset,
                        t.appendWindowStart,
                        t.appendWindowEnd,
                        [],
                        t.tilesLayout || "",
                      )),
                      (e.mimeType = t.mimeType || r.mimeType || ""),
                      (e.codecs = t.codecs || r.codecs || ""),
                      t.thumbnailSprite && e.Mf(t.thumbnailSprite),
                      e
                    );
                  })(e, r, t);
                });
                return (
                  r.me(i),
                  {
                    id: t.id,
                    originalId: t.originalId,
                    groupId: t.groupId,
                    createSegmentIndex: function () {
                      return Promise.resolve();
                    },
                    segmentIndex: new Ml(i),
                    mimeType: t.mimeType,
                    codecs: t.codecs,
                    width: t.width || void 0,
                    height: t.height || void 0,
                    frameRate: t.frameRate,
                    pixelAspectRatio: t.pixelAspectRatio,
                    hdr: t.hdr,
                    colorGamut: t.colorGamut,
                    videoLayout: t.videoLayout,
                    kind: t.kind,
                    encrypted: t.encrypted,
                    drmInfos: [],
                    keyIds: t.keyIds,
                    language: t.language,
                    originalLanguage: t.originalLanguage || null,
                    label: t.label,
                    type: t.type,
                    primary: t.primary,
                    trickModeVideo: null,
                    dependencyStream: null,
                    emsgSchemeIdUris: null,
                    roles: t.roles,
                    forced: t.forced,
                    channelsCount: t.channelsCount,
                    audioSamplingRate: t.audioSamplingRate,
                    spatialAudio: t.spatialAudio,
                    closedCaptions: t.closedCaptions,
                    tilesLayout: t.tilesLayout,
                    mssPrivateData: t.mssPrivateData,
                    accessibilityPurpose: null,
                    external: t.external,
                    fastSwitching: t.fastSwitching,
                    fullMimeTypes: new Set([li(t.mimeType, t.codecs)]),
                    isAudioMuxedInVideo: t.isAudioMuxedInVideo || !1,
                    baseOriginalId: null,
                  }
                );
              }
              function Gb() {
                this.g = null;
              }
              function Vb() {}
              function Hb(e, t) {
                var r = Ub(e);
                return (
                  (e =
                    r && "manifest" == r.g
                      ? Mn(
                          (e = {
                            uri: e,
                            originalUri: e,
                            data: new ArrayBuffer(0),
                            headers: { "content-type": "application/x-offline-manifest" },
                            originalRequest: t,
                          }),
                        )
                      : r && "segment" == r.g
                        ? (function (e, t, r) {
                            var i = new wb();
                            return Mn(void 0)
                              .Xa(function () {
                                return i.init();
                              })
                              .Xa(function () {
                                return Ib(i, t.Pb(), t.cb());
                              })
                              .Xa(function (e) {
                                return e.getSegments([t.key()]);
                              })
                              .Xa(function (e) {
                                return { uri: t, data: e[0].data, headers: {}, originalRequest: r };
                              })
                              .finally(function () {
                                return i.destroy();
                              });
                          })(r.key(), r, t)
                        : Cn(new ze(2, 1, 9004, e))),
                  e
                );
              }
              function Kb(e, t, r) {
                var i, n, a, s, o, l;
                return D(function (u) {
                  switch (u.g) {
                    case 1:
                      i = [];
                      for (var d = [], h = g(r), c = h.next(); !c.done; c = h.next()) {
                        c = c.value;
                        for (var f = !1, p = g(d), m = p.next(); !m.done; m = p.next())
                          if (Wb((m = m.value).info, c)) {
                            (m.sessionIds.push(c.sessionId), (f = !0));
                            break;
                          }
                        f || d.push({ info: c, sessionIds: [c.sessionId] });
                      }
                      ((n = g(d)), (a = n.next()));
                    case 2:
                      if (a.done) {
                        u.A(4);
                        break;
                      }
                      return (
                        (s = a.value),
                        (o = (function (e, t, r) {
                          var i, n;
                          return D(function (a) {
                            switch (a.g) {
                              case 1:
                                return (
                                  (i = new ya({
                                    vc: t,
                                    onError: function () {},
                                    zf: function () {},
                                    onExpirationUpdated: function () {},
                                    onEvent: function () {},
                                  })),
                                  E(a, 2),
                                  i.configure(e),
                                  b(
                                    a,
                                    (function (e, t, r, i, n, a) {
                                      var s, o, l, u, d;
                                      return D(function (h) {
                                        return 1 == h.g
                                          ? ((s = []),
                                            a.length && s.push(a[0].contentType),
                                            n.length && s.push(n[0].contentType),
                                            (o = function (e) {
                                              return (
                                                ((e = dt(t, e, null)).licenseServerUri = r),
                                                (e.serverCertificate = i),
                                                (e.persistentStateRequired = !0),
                                                (e.sessionType = "persistent-license"),
                                                e
                                              );
                                            }),
                                            (l = gn(s)).video &&
                                              ((u = o(a[0].encryptionScheme || "")),
                                              l.video.drmInfos.push(u)),
                                            l.audio &&
                                              ((d = o(n[0].encryptionScheme || "")),
                                              l.audio.drmInfos.push(d)),
                                            b(h, Yi([l], !0, e.O, []), 2))
                                          : (Jn(e.j), h.return(Aa(e, [l])));
                                      });
                                    })(
                                      i,
                                      r.info.keySystem,
                                      r.info.licenseUri,
                                      r.info.serverCertificate,
                                      r.info.audioCapabilities,
                                      r.info.videoCapabilities,
                                    ),
                                    4,
                                  )
                                );
                              case 4:
                                w(a, 3);
                                break;
                              case 2:
                                return (A(a), b(a, i.destroy(), 5));
                              case 5:
                                return a.return([]);
                              case 3:
                                return (
                                  (n = []),
                                  b(
                                    a,
                                    Promise.all(
                                      r.sessionIds.map(function (e) {
                                        return D(function (t) {
                                          return 1 == t.g
                                            ? (E(t, 2),
                                              b(
                                                t,
                                                (function (e, t) {
                                                  var r, i, n;
                                                  return D(function (a) {
                                                    return 1 == a.g
                                                      ? b(
                                                          a,
                                                          Ra(e, t, { initData: null, initDataType: null }),
                                                          2,
                                                        )
                                                      : 3 != a.g
                                                        ? (r = a.h)
                                                          ? ((i = []),
                                                            (n = e.i.get(r)) &&
                                                              ((n.Kb = new kn()), i.push(n.Kb)),
                                                            i.push(r.remove()),
                                                            b(a, Promise.all(i), 3))
                                                          : a.return()
                                                        : (e.i.delete(r), void S(a));
                                                  });
                                                })(i, e),
                                                4,
                                              ))
                                            : 2 != t.g
                                              ? (n.push(e), w(t, 0))
                                              : (A(t), void S(t));
                                        });
                                      }),
                                    ),
                                    6,
                                  )
                                );
                              case 6:
                                return b(a, i.destroy(), 7);
                              case 7:
                                return a.return(n);
                            }
                          });
                        })(e, t, s)),
                        b(u, o, 5)
                      );
                    case 5:
                      ((l = u.h), (i = i.concat(l)), (a = n.next()), u.A(2));
                      break;
                    case 4:
                      return u.return(i);
                  }
                });
              }
              function Wb(e, t) {
                function r(e, t) {
                  return e.robustness == t.robustness && e.contentType == t.contentType;
                }
                return (
                  e.keySystem == t.keySystem &&
                  e.licenseUri == t.licenseUri &&
                  Z(e.audioCapabilities, t.audioCapabilities, r) &&
                  Z(e.videoCapabilities, t.videoCapabilities, r)
                );
              }
              function zb(e, t) {
                var r = $b(new Bb(e.Pb(), e.cb()), t),
                  i = t.appMetadata || {};
                return (
                  (r = qb(r)),
                  {
                    offlineUri: e.toString(),
                    originalManifestUri: t.originalManifestUri,
                    duration: t.duration,
                    size: t.size,
                    expiration: t.expiration,
                    tracks: r,
                    appMetadata: i,
                    isIncomplete: t.isIncomplete || !1,
                  }
                );
              }
              function qb(e) {
                for (var t = [], r = ln(e.variants), i = (r = g(r)).next(); !i.done; i = r.next())
                  t.push(en(i.value));
                for (r = (e = g(e.textStreams)).next(); !r.done; r = e.next()) t.push(tn(r.value));
                return t;
              }
              function Xb() {
                this.g = new Map();
              }
              function Yb(e, t) {
                var r = t.audio,
                  i = t.video;
                if (
                  (r && !i && e.g.set(r.id, r.bandwidth || t.bandwidth),
                  !r && i && e.g.set(i.id, i.bandwidth || t.bandwidth),
                  r && i)
                ) {
                  var n = r.bandwidth || 393216,
                    a = i.bandwidth || t.bandwidth - n;
                  (a <= 0 && (a = t.bandwidth), e.g.set(r.id, n), e.g.set(i.id, a));
                }
              }
              function Qb(e, t) {
                e.g.set(t.id, t.bandwidth || 2048);
              }
              function Jb(e, t) {
                return (null == (e = e.g.get(t)) && (e = 0), e);
              }
              function Zb(e) {
                var t = this;
                if (e && e.constructor != Qh) throw new ze(2, 9, 9008);
                ((this.g = this.h = null),
                  e
                    ? ((this.h = e.g), (this.g = e.Yb()))
                    : ((this.h = td()), (this.g = new $n()), this.g.configure(this.h.networking)),
                  (this.i = []),
                  (this.l = []));
                var r = !e;
                ((this.j = new Qn(function () {
                  var e, i, n, a, s;
                  return D(function (o) {
                    switch (o.g) {
                      case 1:
                        return b(
                          o,
                          Promise.all(
                            t.l.map(function (e) {
                              return cb(e);
                            }),
                          ),
                          2,
                        );
                      case 2:
                        for (e = function () {}, i = [], n = g(t.i), a = n.next(); !a.done; a = n.next())
                          ((s = a.value), i.push(s.then(e, e)));
                        return b(o, Promise.all(i), 3);
                      case 3:
                        if (!r) {
                          o.A(4);
                          break;
                        }
                        return b(o, t.g.destroy(), 4);
                      case 4:
                        ((t.h = null), (t.g = null), S(o));
                    }
                  });
                })),
                  (this.m = 1e9));
              }
              function eS() {
                if (Qv(se()))
                  e: {
                    for (var e = g(Rb.values()), t = e.next(); !t.done; t = e.next())
                      if ((t = (t = t.value)())) {
                        (t.destroy(), (e = !0));
                        break e;
                      }
                    e = !1;
                  }
                else e = !1;
                return e;
              }
              function tS(e) {
                var t, r, i;
                return D(function (n) {
                  switch (n.g) {
                    case 1:
                      return b(n, (t = new wb()).init(), 2);
                    case 2:
                      return b(n, Ab(t), 3);
                    case 3:
                      return (
                        (r = n.h),
                        (i = new Fb("manifest", r.path.Pb, r.path.cb, e)),
                        b(n, t.destroy(), 4)
                      );
                    case 4:
                      return b(n, new Zb().remove(i.toString()), 0);
                  }
                });
              }
              function rS(e, t, r, i, n, a) {
                var s, o, l, u, d, h, c, f, p, m, v;
                return D(function (y) {
                  switch (y.g) {
                    case 1:
                      for (s = !1, E(y, 2), o = !0, l = g(r.streams), u = l.next(); !u.done; u = l.next())
                        for (d = u.value, h = g(d.segments), c = h.next(); !c.done; c = h.next())
                          ((f = c.value),
                            null != (p = f.pendingSegmentRefId ? i[f.pendingSegmentRefId] : null) &&
                              ((f.dataKey = p), (f.pendingSegmentRefId = void 0)),
                            null != (p = f.pendingInitSegmentRefId ? i[f.pendingInitSegmentRefId] : null) &&
                              ((f.initSegmentKey = p), (f.pendingInitSegmentRefId = void 0)),
                            f.pendingSegmentRefId && (o = !1),
                            f.pendingInitSegmentRefId && (o = !1));
                      return ((r.size += n), o && (r.isIncomplete = !1), b(y, e.updateManifest(t, r), 4));
                    case 4:
                      ((s = !0), a(), w(y, 0));
                      break;
                    case 2:
                      return ((m = A(y)), b(y, tS(t), 5));
                    case 5:
                      if (s) {
                        y.A(6);
                        break;
                      }
                      return (
                        (v = Object.values(i)),
                        b(
                          y,
                          e.removeSegments(v, function () {}),
                          6,
                        )
                      );
                    case 6:
                      throw m;
                  }
                });
              }
              function iS(e) {
                return e.variants.some(function (e) {
                  var t = e.audio && e.audio.encrypted;
                  return (e.video && e.video.encrypted) || t;
                });
              }
              function nS(e) {
                return e.variants.some(function (e) {
                  return (e.video ? e.video.drmInfos : [])
                    .concat(e.audio ? e.audio.drmInfos : [])
                    .some(function (e) {
                      return e.initData && e.initData.length;
                    });
                });
              }
              function aS(e, t, r, i) {
                if (
                  ((t.expiration = r.Zd()), (r = wa(r)), (t.sessionIds = i ? r : []), iS(e) && i && !r.length)
                )
                  throw new ze(2, 9, 9007);
              }
              function sS(e, t) {
                for (var r = [], i = g(e.streams), n = i.next(); !n.done; n = i.next())
                  ((n = n.value),
                    t && "video" == n.type
                      ? r.push({
                          contentType: li(n.mimeType, n.codecs),
                          robustness: e.drmInfo.videoRobustness,
                        })
                      : t ||
                        "audio" != n.type ||
                        r.push({
                          contentType: li(n.mimeType, n.codecs),
                          robustness: e.drmInfo.audioRobustness,
                        }));
                return r;
              }
              function oS(e, t, r) {
                return D(function (i) {
                  return b(
                    i,
                    (function (e, t, r, i) {
                      var n, a, s;
                      return D(function (o) {
                        return 1 == o.g
                          ? i.drmInfo
                            ? ((n = (function (e) {
                                var t = Array.from(e.g.keys());
                                if (!t.length)
                                  throw new ze(2, 9, 9e3, "No supported storage mechanisms found");
                                return e.g.get(t[0]).getEmeSessionCell();
                              })(r)),
                              (a = i.sessionIds.map(function (e) {
                                return {
                                  sessionId: e,
                                  keySystem: i.drmInfo.keySystem,
                                  licenseUri: i.drmInfo.licenseServerUri,
                                  serverCertificate: i.drmInfo.serverCertificate,
                                  audioCapabilities: sS(i, !1),
                                  videoCapabilities: sS(i, !0),
                                };
                              })),
                              b(o, Kb(t, e, a), 2))
                            : o.return()
                          : 3 != o.g
                            ? ((s = o.h), b(o, n.remove(s), 3))
                            : b(
                                o,
                                n.add(
                                  a.filter(function (e) {
                                    return !s.includes(e.sessionId);
                                  }),
                                ),
                                0,
                              );
                      });
                    })(e.g, e.h.drm, r, t),
                    0,
                  );
                });
              }
              function lS(e, t, r) {
                function i() {}
                var n = (function (e) {
                  for (var t = new Set(), r = (e = g(e.streams)).next(); !r.done; r = e.next())
                    for (var i = (r = g(r.value.segments)).next(); !i.done; i = r.next())
                      (null != (i = i.value).initSegmentKey && t.add(i.initSegmentKey), t.add(i.dataKey));
                  return Array.from(t);
                })(r);
                return (zb(t, r), Promise.all([e.removeSegments(n, i), e.removeManifests([t.key()], i)]));
              }
              function uS(e, t) {
                var r;
                return D(function (i) {
                  switch (i.g) {
                    case 1:
                      return (E(i, 2), b(i, su(t, e.g, e.h.streaming.retryParameters), 4));
                    case 4:
                      ((r = i.h), w(i, 3));
                      break;
                    case 2:
                      A(i);
                    case 3:
                      if (r) return i.return(r);
                      throw new ze(1, 2, 2011, t);
                  }
                });
              }
              function dS(e, t, r, i, n, a) {
                var s = {
                    id: i.id,
                    originalId: i.originalId,
                    groupId: i.groupId,
                    primary: i.primary,
                    type: i.type,
                    mimeType: i.mimeType,
                    codecs: i.codecs,
                    frameRate: i.frameRate,
                    pixelAspectRatio: i.pixelAspectRatio,
                    hdr: i.hdr,
                    colorGamut: i.colorGamut,
                    videoLayout: i.videoLayout,
                    kind: i.kind,
                    language: i.language,
                    originalLanguage: i.originalLanguage,
                    label: i.label,
                    width: i.width || null,
                    height: i.height || null,
                    encrypted: i.encrypted,
                    keyIds: i.keyIds,
                    segments: [],
                    variantIds: [],
                    roles: i.roles,
                    forced: i.forced,
                    channelsCount: i.channelsCount,
                    audioSamplingRate: i.audioSamplingRate,
                    spatialAudio: i.spatialAudio,
                    closedCaptions: i.closedCaptions,
                    tilesLayout: i.tilesLayout,
                    mssPrivateData: i.mssPrivateData,
                    external: i.external,
                    fastSwitching: i.fastSwitching,
                    isAudioMuxedInVideo: i.isAudioMuxedInVideo,
                  },
                  o = n.offline.numberOfParallelDownloads,
                  l = 0 === o ? i.id : 0;
                return (
                  (function (e, t, r) {
                    if (null != (t = e.segmentIndex.find(t)))
                      for (var i = e.segmentIndex.get(t); i; ) (r(i, t), (i = e.segmentIndex.get(++t)));
                  })(i, r.presentationTimeline.Hb(), function (r, n) {
                    var u = sb(r),
                      d = void 0;
                    if (!a.has(u)) {
                      var h = r.endTime - r.startTime;
                      ((h = Jb(t, i.id) * h), (h = ub(e.g, h)), a.set(u, new ab(r, h, l, !1, n)));
                    }
                    (r.ea &&
                      ((d = sb(r.ea)),
                      a.has(d) ||
                        ((h = 0.5 * Jb(t, i.id)), (h = ub(e.g, h)), a.set(d, new ab(r.ea, h, l, !0, n)))),
                      s.segments.push({
                        pendingInitSegmentRefId: d,
                        initSegmentKey: d ? 0 : null,
                        startTime: r.startTime,
                        endTime: r.endTime,
                        appendWindowStart: r.appendWindowStart,
                        appendWindowEnd: r.appendWindowEnd,
                        timestampOffset: r.timestampOffset,
                        tilesLayout: r.tilesLayout,
                        pendingSegmentRefId: u,
                        dataKey: 0,
                        mimeType: r.mimeType,
                        codecs: r.codecs,
                        thumbnailSprite: r.thumbnailSprite,
                      }),
                      0 !== o && (l = (l + 1) % o));
                  }),
                  s
                );
              }
              function hS(e) {
                if (e.j.g) throw new ze(2, 9, 7001);
              }
              function cS() {
                if (!eS()) throw new ze(2, 9, 9e3);
              }
              function fS(e, t) {
                return D(function (r) {
                  return 1 == r.g
                    ? (e.i.push(t), x(r, 2), b(r, t, 4))
                    : 2 != r.g
                      ? r.return(r.h)
                      : (I(r), J(e.i, t), k(r, 0));
                });
              }
              function pS(e) {
                for (var t = new Set(), r = g(e.variants), i = r.next(); !i.done; i = r.next())
                  ((i = i.value).audio && t.add(i.audio), i.video && t.add(i.video));
                for (i = (r = g(e.textStreams)).next(); !i.done; i = r.next()) t.add(i.value);
                for (r = (e = g(e.imageStreams)).next(); !r.done; r = e.next()) t.add(r.value);
                return t;
              }
              (j("shaka.offline.indexeddb.StorageMechanismOpenTimeout", Nb),
                kb("idb", function () {
                  return se().Ch() ? new Ob() : null;
                }),
                (Fb.prototype.Pb = function () {
                  return this.i;
                }),
                (Fb.prototype.cb = function () {
                  return this.h;
                }),
                (Fb.prototype.key = function () {
                  return this.l;
                }),
                (Fb.prototype.toString = function () {
                  return this.j;
                }),
                ((n = Gb.prototype).configure = function () {}),
                (n.start = function (e, t) {
                  var r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l = this;
                  return D(function (u) {
                    switch (u.g) {
                      case 1:
                        if (((r = Ub(e)), (l.g = r), null == r || "manifest" != r.g))
                          throw new ze(2, 1, 9004, e);
                        return ((i = new wb()), x(u, 2), b(u, i.init(), 4));
                      case 4:
                        return b(u, Ib(i, r.Pb(), r.cb()), 5);
                      case 5:
                        return b(u, u.h.getManifests([r.key()]), 6);
                      case 6:
                        return (
                          (n = u.h),
                          (a = n[0]),
                          (s = new Bb(r.Pb(), r.cb())),
                          (o = $b(s, a)),
                          t.makeTextStreamsForClosedCaptions(o),
                          u.return(o)
                        );
                      case 2:
                        return (I(u), b(u, i.destroy(), 7));
                      case 7:
                        k(u, 0);
                    }
                  });
                }),
                (n.stop = function () {
                  return Promise.resolve();
                }),
                (n.update = function () {}),
                (n.onExpirationUpdated = function (e, t) {
                  var r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u = this;
                  return D(function (d) {
                    switch (d.g) {
                      case 1:
                        return ((r = u.g), (i = new wb()), E(d, 2, 3), b(d, i.init(), 5));
                      case 5:
                        return b(d, Ib(i, r.Pb(), r.cb()), 6);
                      case 6:
                        return b(d, (n = d.h).getManifests([r.key()]), 7);
                      case 7:
                        if (
                          ((a = d.h),
                          (s = a[0]),
                          (o = s.sessionIds.includes(e)),
                          (l = null == s.expiration || s.expiration > t),
                          !o || !l)
                        ) {
                          d.A(3);
                          break;
                        }
                        return b(d, n.updateManifestExpiration(r.key(), t), 3);
                      case 3:
                        return (I(d), b(d, i.destroy(), 10));
                      case 10:
                        k(d, 0);
                        break;
                      case 2:
                        (A(d), d.A(3));
                    }
                  });
                }),
                (n.onInitialVariantChosen = function () {}),
                (n.banLocation = function () {}),
                (n.setMediaElement = function () {}),
                wt("application/x-offline-manifest", function () {
                  return new Gb();
                }),
                j("shaka.offline.OfflineScheme", Vb),
                (Vb.plugin = Hb),
                jn("offline", Hb),
                ((n = Zb.prototype).destroy = function () {
                  return this.j.destroy();
                }),
                (n.configure = function (e, t) {
                  return (2 == arguments.length && "string" == typeof e && (e = ju(e, t)), id(this.h, e));
                }),
                (n.getConfiguration = function () {
                  var e = td();
                  return (id(e, this.h, td()), e);
                }),
                (n.Yb = function () {
                  return this.g;
                }),
                (n.store = function (e, t, r, i, n) {
                  var a = this,
                    s = this.getConfiguration(),
                    o = new hb(this.g);
                  return (
                    this.l.push(o),
                    (t = (function (e, t, r, i, n, a, s, o) {
                      var l, u, d, h, c, f, p, m, v, y, T, x, R, C, L, M, _, P, O, N, F, U, B;
                      return D(function ($) {
                        switch ($.g) {
                          case 1:
                            return (
                              cS(),
                              (u = l = null),
                              (d = new wb()),
                              (f = c = h = null),
                              E($, 2, 3),
                              b($, a(), 5)
                            );
                          case 5:
                            return (
                              (l = $.h),
                              b(
                                $,
                                (function (e, t, r, i) {
                                  var n, a, s, o, l;
                                  return D(function (u) {
                                    if (1 == u.g)
                                      return (
                                        (n = null),
                                        (a = e.g),
                                        (s = {
                                          networkingEngine: a,
                                          filter: function () {
                                            return Promise.resolve();
                                          },
                                          makeTextStreamsForClosedCaptions: function () {},
                                          onTimelineRegionAdded: function () {},
                                          onEvent: function () {},
                                          onError: function (e) {
                                            n = e;
                                          },
                                          isLowLatencyMode: function () {
                                            return !1;
                                          },
                                          updateDuration: function () {},
                                          newDrmInfo: function () {},
                                          onManifestUpdated: function () {},
                                          getBandwidthEstimate: function () {
                                            return i.abr.defaultBandwidthEstimate;
                                          },
                                          onMetadata: function () {},
                                          disableStream: function () {},
                                          addFont: function () {},
                                        }),
                                        r.configure(i.manifest),
                                        hS(e),
                                        b(u, r.start(t, s), 2)
                                      );
                                    if (3 != u.g)
                                      return (
                                        (o = u.h),
                                        hS(e),
                                        (l = pS(o)),
                                        b(
                                          u,
                                          Promise.all(
                                            Zn(l, function (e) {
                                              return e.createSegmentIndex();
                                            }),
                                          ),
                                          3,
                                        )
                                      );
                                    if ((hS(e), n)) throw n;
                                    return u.return(o);
                                  });
                                })(e, t, l, s),
                                6,
                              )
                            );
                          case 6:
                            if (((p = $.h), hS(e), p.presentationTimeline.W() || p.presentationTimeline.Vc()))
                              throw new ze(2, 9, 9005, t);
                            ((m = g(i)), (v = m.next()));
                          case 7:
                            if (v.done) {
                              $.A(9);
                              break;
                            }
                            return (
                              (y = v.value),
                              b(
                                $,
                                (function (e, t, r) {
                                  var i, n, a, s, o, l, u, d, h, c, f, p, m, v, y;
                                  return D(function (T) {
                                    switch (T.g) {
                                      case 1:
                                        return b(T, uS(e, t), 2);
                                      case 2:
                                        if ("text/vtt" != (i = T.h)) throw new ze(1, 2, 2017, t);
                                        return b(
                                          T,
                                          (function (e, t, r) {
                                            var i, n, a;
                                            return D(function (s) {
                                              return 1 == s.g
                                                ? ((i = qn),
                                                  ((n = Vn([e], r)).method = "GET"),
                                                  b(s, t.request(i, n).promise, 2))
                                                : ((a = s.h), s.return(a.data));
                                            });
                                          })(t, e.g, e.h.streaming.retryParameters),
                                          3,
                                        );
                                      case 3:
                                        if (((n = T.h), !(a = Si(i)))) throw new ze(2, 2, 2014, i);
                                        for (
                                          s = a(),
                                            o = {
                                              periodStart: 0,
                                              segmentStart: 0,
                                              segmentEnd: r.presentationTimeline.getDuration(),
                                              vttOffset: 0,
                                            },
                                            l = Oe(n),
                                            u = s.parseMedia(l, o, t, []),
                                            d = [],
                                            h = g(u),
                                            c = h.next(),
                                            f = {};
                                          !c.done;
                                          f = { Vf: void 0, od: void 0 }, c = h.next()
                                        )
                                          ((f.od = c.value),
                                            (f.Vf = null),
                                            (p = (function (e) {
                                              return function () {
                                                return (
                                                  null == e.Vf && (e.Vf = ut([t], [e.od.payload])),
                                                  e.Vf || []
                                                );
                                              };
                                            })(f)),
                                            (m = new Bs(
                                              f.od.startTime,
                                              f.od.endTime,
                                              p,
                                              0,
                                              null,
                                              null,
                                              0,
                                              0,
                                              1 / 0,
                                            )),
                                            f.od.payload.includes("#xywh") &&
                                              4 === (v = f.od.payload.split("#xywh=")[1].split(",")).length &&
                                              m.Mf({
                                                height: parseInt(v[3], 10),
                                                positionX: parseInt(v[0], 10),
                                                positionY: parseInt(v[1], 10),
                                                width: parseInt(v[2], 10),
                                              }),
                                            d.push(m));
                                        if (((y = i), !d.length)) {
                                          T.A(4);
                                          break;
                                        }
                                        return b(T, su(d[0].P()[0], e.g, e.h.manifest.retryParameters), 5);
                                      case 5:
                                        y = T.h;
                                      case 4:
                                        return T.return({
                                          id: e.m++,
                                          originalId: null,
                                          groupId: null,
                                          createSegmentIndex: function () {
                                            return Promise.resolve();
                                          },
                                          segmentIndex: new Ml(d),
                                          mimeType: y || "",
                                          codecs: "",
                                          kind: "",
                                          encrypted: !1,
                                          drmInfos: [],
                                          keyIds: new Set(),
                                          language: "und",
                                          originalLanguage: null,
                                          label: null,
                                          type: "image",
                                          primary: !1,
                                          trickModeVideo: null,
                                          dependencyStream: null,
                                          emsgSchemeIdUris: null,
                                          roles: [],
                                          forced: !1,
                                          channelsCount: null,
                                          audioSamplingRate: null,
                                          spatialAudio: !1,
                                          closedCaptions: null,
                                          tilesLayout: "1x1",
                                          accessibilityPurpose: null,
                                          external: !0,
                                          fastSwitching: !1,
                                          fullMimeTypes: new Set([li(y || "", "")]),
                                          isAudioMuxedInVideo: !1,
                                          baseOriginalId: null,
                                        });
                                    }
                                  });
                                })(e, y, p),
                                10,
                              )
                            );
                          case 10:
                            ((T = $.h), p.imageStreams.push(T), hS(e), (v = m.next()), $.A(7));
                            break;
                          case 9:
                            ((x = g(n)), (R = x.next()));
                          case 11:
                            return R.done
                              ? (Fa(s.drm.clearKeys, p.variants),
                                (M = p.variants.some(function (e) {
                                  if (e.audio)
                                    for (var t = g(e.audio.drmInfos), r = t.next(); !r.done; r = t.next())
                                      if (r.value.licenseServerUri.startsWith("data:")) return !0;
                                  if (e.video)
                                    for (t = (e = g(e.video.drmInfos)).next(); !t.done; t = e.next())
                                      if (t.value.licenseServerUri.startsWith("data:")) return !0;
                                  return !1;
                                })),
                                (_ = s.offline.usePersistentLicense),
                                M && (_ = !1),
                                b(
                                  $,
                                  e.md(
                                    p,
                                    function (e) {
                                      f = f || e;
                                    },
                                    s,
                                    _,
                                  ),
                                  15,
                                ))
                              : ((C = R.value),
                                b(
                                  $,
                                  (function (e, t, r, i, n, a, s) {
                                    var o;
                                    return D(function (l) {
                                      if (1 == l.g) return a ? l.A(2) : b(l, uS(e, r), 3);
                                      if (
                                        (2 != l.g && (a = l.h),
                                        (o = {
                                          id: e.m++,
                                          originalId: null,
                                          groupId: null,
                                          createSegmentIndex: function () {
                                            return Promise.resolve();
                                          },
                                          segmentIndex: _l(0, t.presentationTimeline.getDuration(), [r]),
                                          mimeType: a || "",
                                          codecs: s || "",
                                          kind: n,
                                          encrypted: !1,
                                          drmInfos: [],
                                          keyIds: new Set(),
                                          language: i,
                                          originalLanguage: i,
                                          label: null,
                                          type: gt,
                                          primary: !1,
                                          trickModeVideo: null,
                                          dependencyStream: null,
                                          emsgSchemeIdUris: null,
                                          roles: [],
                                          forced: !1,
                                          channelsCount: null,
                                          audioSamplingRate: null,
                                          spatialAudio: !1,
                                          closedCaptions: null,
                                          accessibilityPurpose: null,
                                          external: !0,
                                          fastSwitching: !1,
                                          fullMimeTypes: new Set([li(a || "", s || "")]),
                                          isAudioMuxedInVideo: !1,
                                          baseOriginalId: null,
                                        }),
                                        !Ei(li(o.mimeType, o.codecs)))
                                      )
                                        throw new ze(2, 2, 2014, a);
                                      return l.return(o);
                                    });
                                  })(e, p, C.uri, C.language, C.kind, C.mime, C.codecs),
                                  14,
                                ));
                          case 14:
                            ((L = $.h), p.textStreams.push(L), hS(e), (R = x.next()), $.A(11));
                            break;
                          case 15:
                            if (((u = $.h), hS(e), f)) throw f;
                            return b(
                              $,
                              (function (e, t, r, i) {
                                var n,
                                  a,
                                  s,
                                  o,
                                  l,
                                  u,
                                  d,
                                  h,
                                  c,
                                  f,
                                  p,
                                  m,
                                  v,
                                  y,
                                  T,
                                  x,
                                  I,
                                  k,
                                  R,
                                  C,
                                  L,
                                  M,
                                  _,
                                  P,
                                  O,
                                  N,
                                  F,
                                  U,
                                  B;
                                return D(function (D) {
                                  switch (D.g) {
                                    case 1:
                                      return (
                                        (n = { width: 1 / 0, height: 1 / 0 }),
                                        (function (e, t, r) {
                                          e.variants = e.variants.filter(function (e) {
                                            return Ki(e, t, r);
                                          });
                                        })(e, r.restrictions, n),
                                        b(
                                          D,
                                          zi(t, e, i, r.drm.preferredKeySystems, r.drm.keySystemsMapping),
                                          2,
                                        )
                                      );
                                    case 2:
                                      for (
                                        a = [],
                                          s = r.preferredDecodingAttributes,
                                          o = r.preferredVideoCodecs,
                                          l = r.preferredAudioCodecs,
                                          u = r.preferredTextFormats,
                                          Hi(e, o, l, s, u),
                                          d = g(e.variants),
                                          h = d.next();
                                        !h.done;
                                        h = d.next()
                                      )
                                        ((c = h.value), a.push(en(c)));
                                      for (f = g(e.textStreams), p = f.next(); !p.done; p = f.next())
                                        ((m = p.value), a.push(tn(m)));
                                      for (v = g(e.imageStreams), y = v.next(); !y.done; y = v.next())
                                        ((T = y.value), a.push(rn(T)));
                                      return b(D, r.offline.trackSelectionCallback(a), 3);
                                    case 3:
                                      for (
                                        x = D.h,
                                          I = e.presentationTimeline.getDuration(),
                                          k = 0,
                                          R = g(x),
                                          C = R.next();
                                        !C.done;
                                        C = R.next()
                                      )
                                        ((L = C.value), (M = (L.bandwidth * I) / 8), (k += M));
                                      return (E(D, 4), b(D, r.offline.downloadSizeCallback(k), 6));
                                    case 6:
                                      if (!D.h) throw new ze(2, 9, 9014);
                                      w(D, 5);
                                      break;
                                    case 4:
                                      if ((_ = A(D)) instanceof ze) throw _;
                                      throw new ze(2, 9, 9015);
                                    case 5:
                                      for (
                                        P = new Set(), O = new Set(), N = new Set(), F = g(x), U = F.next();
                                        !U.done;
                                        U = F.next()
                                      )
                                        ("variant" == (B = U.value).type && P.add(B.id),
                                          "text" == B.type && O.add(B.id),
                                          "image" == B.type && N.add(B.id));
                                      ((e.variants = e.variants.filter(function (e) {
                                        return P.has(e.id);
                                      })),
                                        (e.textStreams = e.textStreams.filter(function (e) {
                                          return O.has(e.id);
                                        })),
                                        (e.imageStreams = e.imageStreams.filter(function (e) {
                                          return N.has(e.id);
                                        })),
                                        (function (e) {
                                          e.variants.map(function (e) {
                                            return e.video;
                                          });
                                          var t = new Set(
                                            e.variants.map(function (e) {
                                              return e.audio;
                                            }),
                                          );
                                          e = e.textStreams;
                                          for (var r = g(t), i = r.next(); !i.done; i = r.next())
                                            for (var n = (i = g(t)).next(); !n.done; n = i.next());
                                          for (t = g(e), r = t.next(); !r.done; r = t.next())
                                            for (r = g(e), i = r.next(); !i.done; i = r.next());
                                        })(e),
                                        S(D));
                                  }
                                });
                              })(p, u, s, _),
                              16,
                            );
                          case 16:
                            return b($, d.init(), 17);
                          case 17:
                            return (hS(e), b($, Ab(d), 18));
                          case 18:
                            return (
                              (h = $.h),
                              hS(e),
                              (P = (function (e, t, r, i, n, a, s) {
                                var o = (function (e, t, r) {
                                    return {
                                      offlineUri: null,
                                      originalManifestUri: e,
                                      duration: t.presentationTimeline.getDuration(),
                                      size: 0,
                                      expiration: 1 / 0,
                                      tracks: (t = qb(t)),
                                      appMetadata: r,
                                      isIncomplete: !1,
                                    };
                                  })(r, t, i),
                                  l = n.offline.progressCallback;
                                !(function (e, t, r) {
                                  ((e.o = t), (e.m = r));
                                })(
                                  a,
                                  function (e, t) {
                                    ((o.size = t), l(o, e));
                                  },
                                  function (t, r) {
                                    u && s && d == r && xa(e, "cenc", t);
                                  },
                                );
                                var u = iS(t) && !nS(t),
                                  d = null;
                                u && (d = gS.get(e.g.keySystem));
                                for (
                                  var h = new Xb(), c = g(t.textStreams), f = c.next();
                                  !f.done;
                                  f = c.next()
                                )
                                  h.g.set(f.value.id, 52);
                                for (c = g(t.imageStreams), f = c.next(); !f.done; f = c.next())
                                  Qb(h, f.value);
                                for (c = g(t.variants), f = c.next(); !f.done; f = c.next()) Yb(h, f.value);
                                return (
                                  (a = (function (e, t, r, i) {
                                    for (
                                      var n = new Map(), a = pS(r), s = new Map(), o = (a = g(a)).next();
                                      !o.done;
                                      o = a.next()
                                    ) {
                                      var l = dS(e, t, r, (o = o.value), i, n);
                                      s.set(o.id, l);
                                    }
                                    for (e = g(r.variants), t = e.next(); !t.done; t = e.next())
                                      ((t = t.value).audio && s.get(t.audio.id).variantIds.push(t.id),
                                        t.video && s.get(t.video.id).variantIds.push(t.id));
                                    return { streams: Array.from(s.values()), Gh: Array.from(n.values()) };
                                  })(a, h, t, n)),
                                  (n = a.streams),
                                  (a = a.Gh),
                                  (h = e.g) && s && (h.initData = []),
                                  {
                                    xk: {
                                      creationTime: Date.now(),
                                      originalManifestUri: r,
                                      duration: t.presentationTimeline.getDuration(),
                                      size: 0,
                                      expiration: e.Zd(),
                                      streams: n,
                                      sessionIds: s ? wa(e) : [],
                                      drmInfo: h,
                                      appMetadata: i,
                                      isIncomplete: !0,
                                      sequenceMode: t.sequenceMode,
                                      type: t.type,
                                    },
                                    Gh: a,
                                  }
                                );
                              })(u, p, t, r, s, o, _)),
                              (O = P.xk),
                              (N = P.Gh),
                              b($, h.cb.addManifests([O]), 19)
                            );
                          case 19:
                            if (((F = $.h), hS(e), (c = F[0]), hS(e), f)) throw f;
                            return b(
                              $,
                              (function (e, t, r, i, n, a, s, o, l, u) {
                                var d, h, c, f, p, m, v, y, T, x, I;
                                return D(function (k) {
                                  switch (k.g) {
                                    case 1:
                                      if (
                                        ((d = {}),
                                        (h = 0),
                                        (c = function () {
                                          if (e.j.g || n.l) throw new ze(2, 9, 7001);
                                        }),
                                        (f = function (e, t) {
                                          var f, p, m, v, y, T, E, x, w;
                                          return D(function (A) {
                                            if (1 == A.g) {
                                              for (
                                                f = g(e), p = f.next(), m = {};
                                                !p.done;
                                                m = { mc: void 0 }, p = f.next()
                                              )
                                                ((m.mc = p.value),
                                                  c(),
                                                  (v = ob(m.mc, a)),
                                                  (y = m.mc.i),
                                                  (T = m.mc.h),
                                                  (E = (function (e) {
                                                    return function (t) {
                                                      var r, i, n, a;
                                                      return D(function (o) {
                                                        switch (o.g) {
                                                          case 1:
                                                            if (
                                                              ((r = e.mc.g), (i = r.$b(!1)), !r.aesKey || i)
                                                            ) {
                                                              o.A(2);
                                                              break;
                                                            }
                                                            return b(o, au(t, r.aesKey, e.mc.j), 3);
                                                          case 3:
                                                            t = o.h;
                                                          case 2:
                                                            return (
                                                              (n = sb(r)),
                                                              b(o, s.addSegments([{ data: t }]), 4)
                                                            );
                                                          case 4:
                                                            ((a = o.h),
                                                              c(),
                                                              (d[n] = a[0]),
                                                              (h += t.byteLength),
                                                              S(o));
                                                        }
                                                      });
                                                    };
                                                  })(m)),
                                                  (x = m.mc.g),
                                                  (w = x.$b(!1))
                                                    ? fb(n, m.mc.groupId, w, y, T, E)
                                                    : n.queue(m.mc.groupId, v, y, T, E));
                                              return b(
                                                A,
                                                (function (e) {
                                                  return D(function (t) {
                                                    return 1 == t.g
                                                      ? b(t, Promise.all(e.i.values()), 2)
                                                      : t.return(e.g.g);
                                                  });
                                                })(n),
                                                2,
                                              );
                                            }
                                            return (
                                              c(),
                                              !t || n.l
                                                ? A.A(0)
                                                : (aS(o, i, l, u), b(A, s.updateManifest(r, i), 0))
                                            );
                                          });
                                        }),
                                        (p = !1),
                                        E(k, 2),
                                        !iS(o) || !p || nS(o))
                                      ) {
                                        k.A(4);
                                        break;
                                      }
                                      return b(
                                        k,
                                        f(
                                          t.filter(function (e) {
                                            return e.h;
                                          }),
                                          !0,
                                        ),
                                        5,
                                      );
                                    case 5:
                                      return (
                                        c(),
                                        (t = t.filter(function (e) {
                                          return !e.h;
                                        })),
                                        (m = d),
                                        (v = h),
                                        (d = {}),
                                        (h = 0),
                                        b(
                                          k,
                                          rS(s, r, i, m, v, function () {
                                            return hS(e);
                                          }),
                                          6,
                                        )
                                      );
                                    case 6:
                                      c();
                                    case 4:
                                      if (p) {
                                        k.A(7);
                                        break;
                                      }
                                      return b(k, f(t, !1), 8);
                                    case 8:
                                      return (
                                        c(),
                                        (y = d),
                                        (T = h),
                                        (d = {}),
                                        (h = 0),
                                        b(
                                          k,
                                          rS(s, r, i, y, T, function () {
                                            return c();
                                          }),
                                          9,
                                        )
                                      );
                                    case 9:
                                      c();
                                    case 7:
                                      w(k, 0);
                                      break;
                                    case 2:
                                      return (
                                        (x = A(k)),
                                        (I = Object.values(d)),
                                        b(
                                          k,
                                          s.removeSegments(I, function () {}),
                                          10,
                                        )
                                      );
                                    case 10:
                                      throw x;
                                  }
                                });
                              })(e, N, c, O, o, s, h.cb, p, u, _),
                              20,
                            );
                          case 20:
                            return (hS(e), aS(p, O, u, _), b($, h.cb.updateManifest(c, O), 21));
                          case 21:
                            return (
                              hS(e),
                              (U = new Fb("manifest", h.path.Pb, h.path.cb, c)),
                              $.return(zb(U, O))
                            );
                          case 3:
                            return (I($), b($, d.destroy(), 22));
                          case 22:
                            if (!l) {
                              $.A(23);
                              break;
                            }
                            return b($, l.stop(), 23);
                          case 23:
                            if (!u) {
                              $.A(25);
                              break;
                            }
                            return b($, u.destroy(), 25);
                          case 25:
                            k($, 0);
                            break;
                          case 2:
                            if (((B = A($)), null == c)) {
                              $.A(27);
                              break;
                            }
                            return b($, tS(c), 27);
                          case 27:
                            throw f || B;
                        }
                      });
                    })(
                      this,
                      e,
                      t || {},
                      i || [],
                      n || [],
                      function () {
                        var t;
                        return D(function (i) {
                          return 1 == i.g
                            ? r
                              ? i.A(2)
                              : b(i, su(e, a.g, s.manifest.retryParameters), 3)
                            : (2 != i.g && (r = i.h), (t = At(e, r || null)), i.return(t()));
                        });
                      },
                      s,
                      o,
                    )),
                    (t = new Rn(t, function () {
                      return cb(o);
                    })).finally(function () {
                      J(a.l, o);
                    }),
                    (function (e, t) {
                      var r = t.promise;
                      return (
                        e.i.push(r),
                        t.finally(function () {
                          J(e.i, r);
                        })
                      );
                    })(this, t)
                  );
                }),
                (n.remove = function (e) {
                  return fS(
                    this,
                    (function (e, t) {
                      var r, i, n, a, s, o;
                      return D(function (l) {
                        switch (l.g) {
                          case 1:
                            if ((cS(), null == (r = Ub(t)) || "manifest" != r.g)) throw new ze(2, 9, 9004, t);
                            return ((i = r), (n = new wb()), x(l, 2), b(l, n.init(), 4));
                          case 4:
                            return b(l, Ib(n, i.Pb(), i.cb()), 5);
                          case 5:
                            return b(l, (a = l.h).getManifests([i.key()]), 6);
                          case 6:
                            return ((s = l.h), (o = s[0]), b(l, Promise.all([oS(e, o, n), lS(a, i, o)]), 2));
                          case 2:
                            return (I(l), b(l, n.destroy(), 8));
                          case 8:
                            k(l, 0);
                        }
                      });
                    })(this, e),
                  );
                }),
                (n.Qk = function () {
                  return fS(
                    this,
                    (function (e) {
                      var t, r, i, n, a, s, o, l, u, d;
                      return D(function (h) {
                        switch (h.g) {
                          case 1:
                            return (
                              cS(),
                              (t = e.g),
                              (r = e.h.drm),
                              (i = new wb()),
                              (n = !1),
                              x(h, 2),
                              b(h, i.init(), 4)
                            );
                          case 4:
                            ((a = []),
                              (function (e, t) {
                                e.g.forEach(function (e) {
                                  t(e.getEmeSessionCell());
                                });
                              })(i, function (e) {
                                return a.push(e);
                              }),
                              (s = g(a)),
                              (o = s.next()));
                          case 5:
                            if (o.done) {
                              h.A(2);
                              break;
                            }
                            return b(h, (l = o.value).getAll(), 8);
                          case 8:
                            return ((u = h.h), b(h, Kb(r, t, u), 9));
                          case 9:
                            return ((d = h.h), b(h, l.remove(d), 10));
                          case 10:
                            (d.length != u.length && (n = !0), (o = s.next()), h.A(5));
                            break;
                          case 2:
                            return (I(h), b(h, i.destroy(), 11));
                          case 11:
                            k(h, 3);
                            break;
                          case 3:
                            return h.return(!n);
                        }
                      });
                    })(this),
                  );
                }),
                (n.list = function () {
                  return fS(
                    this,
                    D(function (i) {
                      switch (i.g) {
                        case 1:
                          return (cS(), (e = []), (t = new wb()), x(i, 2), b(i, t.init(), 4));
                        case 4:
                          return (
                            (r = Promise.resolve()),
                            (function (e, t) {
                              e.g.forEach(function (e, r) {
                                e.getCells().forEach(function (e, i) {
                                  t({ Pb: r, cb: i }, e);
                                });
                              });
                            })(t, function (t, i) {
                              r = r.then(function () {
                                return D(function (r) {
                                  if (1 == r.g) return b(r, i.getAllManifests(), 2);
                                  (r.h.forEach(function (r, i) {
                                    ((r = zb(new Fb("manifest", t.Pb, t.cb, i), r)), e.push(r));
                                  }),
                                    S(r));
                                });
                              });
                            }),
                            b(i, r, 2)
                          );
                        case 2:
                          return (I(i), b(i, t.destroy(), 6));
                        case 6:
                          k(i, 3);
                          break;
                        case 3:
                          return i.return(e);
                      }
                    }),
                  );
                  var e, t, r;
                }),
                (n.md = function (e, t, r, i) {
                  var n,
                    a = this;
                  return D(function (s) {
                    return 1 == s.g
                      ? ((n = new ya({
                          vc: a.g,
                          onError: t,
                          zf: function () {},
                          onExpirationUpdated: function () {},
                          onEvent: function () {},
                        })).configure(r.drm),
                        b(
                          s,
                          (function (e, t, r) {
                            return ((e.$ = !0), (e.C = new Map()), (e.R = r), ba(e, t, !1));
                          })(n, e.variants, i),
                          2,
                        ))
                      : 3 != s.g
                        ? b(s, Ea(n), 3)
                        : s.return(n);
                  });
                }),
                j("shaka.offline.Storage", Zb),
                (Zb.deleteAll = function () {
                  var e;
                  return D(function (t) {
                    return 1 == t.g
                      ? ((e = new wb()),
                        x(t, 2),
                        b(
                          t,
                          (function (e) {
                            var t, r;
                            return D(function (i) {
                              return 1 == i.g
                                ? ((t = Array.from(e.g.values())),
                                  (r = t.length > 0) ||
                                    Rb.forEach(function (e) {
                                      (e = e()) && t.push(e);
                                    }),
                                  b(
                                    i,
                                    Promise.all(
                                      t.map(function (e) {
                                        return e.erase();
                                      }),
                                    ),
                                    2,
                                  ))
                                : r
                                  ? i.A(0)
                                  : b(
                                      i,
                                      Promise.all(
                                        t.map(function (e) {
                                          return e.destroy();
                                        }),
                                      ),
                                      0,
                                    );
                            });
                          })(e),
                          2,
                        ))
                      : 5 != t.g
                        ? (I(t), b(t, e.destroy(), 5))
                        : k(t, 0);
                  });
                }),
                (Zb.prototype.list = Zb.prototype.list),
                (Zb.prototype.removeEmeSessions = Zb.prototype.Qk),
                (Zb.prototype.remove = Zb.prototype.remove),
                (Zb.prototype.store = Zb.prototype.store),
                (Zb.prototype.getNetworkingEngine = Zb.prototype.Yb),
                (Zb.prototype.getConfiguration = Zb.prototype.getConfiguration),
                (Zb.prototype.configure = Zb.prototype.configure),
                (Zb.prototype.destroy = Zb.prototype.destroy),
                (Zb.support = eS));
              var gS = new Map()
                .set("org.w3.clearkey", "1077efecc0b24d02ace33c1e52e2fb4b")
                .set("com.widevine.alpha", "edef8ba979d64acea3c827dcd51d21ed")
                .set("com.microsoft.playready", "9a04f07998404286ab92e65be0885f95")
                .set("com.microsoft.playready.recommendation", "9a04f07998404286ab92e65be0885f95")
                .set("com.microsoft.playready.software", "9a04f07998404286ab92e65be0885f95")
                .set("com.microsoft.playready.hardware", "9a04f07998404286ab92e65be0885f95")
                .set("com.huawei.wiseplay", "3d5e6d359b9a41e8b843dd3c6e72c42c");
              function mS() {}
              function vS(e, t) {
                for (e = { priority: t || 0, callback: e }, t = 0; t < bS.length; t++)
                  if (bS[t].priority < e.priority) return void bS.splice(t, 0, e);
                bS.push(e);
              }
              (ec("offline", eS),
                j("shaka.polyfill", mS),
                (mS.register = vS),
                (mS.installAll = function () {
                  for (var e = g(bS), t = e.next(); !t.done; t = e.next()) {
                    t = t.value;
                    try {
                      t.callback();
                    } catch (r) {
                      z("Error installing polyfill!", r);
                    }
                  }
                }));
              var yS,
                TS,
                bS = [];
              function SS(e, t, r) {
                ((this.g = e), (this.i = t || null), (this.h = r || null), (this.keySystem = e.keySystem));
              }
              function ES(e) {
                return e.startsWith("com.apple")
                  ? "cbcs"
                  : e.startsWith("com.widevine") ||
                      e.startsWith("com.microsoft") ||
                      e.startsWith("com.chromecast") ||
                      e.startsWith("org.w3") ||
                      e.startsWith("com.huawei")
                    ? "cenc"
                    : (z("EmeEncryptionSchemePolyfill: Unknown key system:", e, "Please contribute!"), null);
              }
              function xS(e) {
                if (!e) return !1;
                var t = (e = e.getConfiguration()).audioCapabilities && e.audioCapabilities[0];
                return !(
                  !(e = (e.videoCapabilities && e.videoCapabilities[0]) || t) || void 0 === e.encryptionScheme
                );
              }
              function wS(e, t) {
                return !(e && e != t && (("cbcs" != e && "cbcs-1-9" != e) || !se().ed()));
              }
              function AS() {}
              function IS() {
                se().Of() &&
                  !yS &&
                  !navigator.emeEncryptionSchemePolyfilled &&
                  navigator.requestMediaKeySystemAccess &&
                  MediaKeySystemAccess.prototype.getConfiguration &&
                  ((yS = navigator.requestMediaKeySystemAccess),
                  (navigator.requestMediaKeySystemAccess = kS),
                  (navigator.emeEncryptionSchemePolyfilled = !0));
              }
              function kS(e, t) {
                var r,
                  i = this;
                return D(function (n) {
                  return 1 == n.g
                    ? b(n, yS.call(i, e, t), 2)
                    : xS((r = n.h))
                      ? ((navigator.requestMediaKeySystemAccess = yS), n.return(r))
                      : ((navigator.requestMediaKeySystemAccess = RS), n.return(RS.call(i, e, t)));
                });
              }
              function RS(e, t) {
                var r,
                  i,
                  n,
                  a,
                  s,
                  o,
                  l,
                  u,
                  d,
                  h,
                  c,
                  f,
                  p = this;
                return D(function (m) {
                  if (1 == m.g) {
                    for (r = ES(e), i = [], n = g(t), a = n.next(); !a.done; a = n.next())
                      ((s = a.value),
                        (o = CS(s.videoCapabilities, r)),
                        (l = CS(s.audioCapabilities, r)),
                        (s.videoCapabilities && s.videoCapabilities.length && !o.length) ||
                          (s.audioCapabilities && s.audioCapabilities.length && !l.length) ||
                          (((u = Object.assign({}, s)).videoCapabilities = o),
                          (u.audioCapabilities = l),
                          i.push(u)));
                    if (!i.length)
                      throw (
                        ((d = Error("Unsupported keySystem or supportedConfigurations.")).name =
                          "NotSupportedError"),
                        (d.code = DOMException.NOT_SUPPORTED_ERR),
                        d
                      );
                    return b(m, yS.call(p, e, i), 2);
                  }
                  return (
                    (h = m.h),
                    (f = c = null),
                    i[0] &&
                      (i[0].videoCapabilities && (c = i[0].videoCapabilities[0].encryptionScheme),
                      i[0].audioCapabilities && (f = i[0].audioCapabilities[0].encryptionScheme)),
                    m.return(new SS(h, c, f))
                  );
                });
              }
              function CS(e, t) {
                return e
                  ? e.filter(function (e) {
                      return wS(e.encryptionScheme, t);
                    })
                  : e;
              }
              function LS() {}
              function MS() {
                se().Of() &&
                  !TS &&
                  !navigator.mediaCapabilitiesEncryptionSchemePolyfilled &&
                  navigator.mediaCapabilities &&
                  ((TS = navigator.mediaCapabilities.decodingInfo),
                  (navigator.mediaCapabilities.decodingInfo = DS),
                  (navigator.mediaCapabilitiesEncryptionSchemePolyfilled = !0));
              }
              function DS(e) {
                var t,
                  r,
                  i = this;
                return D(function (n) {
                  switch (n.g) {
                    case 1:
                      return b(n, TS.call(i, e), 2);
                    case 2:
                      if (!(t = n.h).supported || !e.keySystemConfiguration) return n.return(t);
                      if (xS((r = t.keySystemAccess)))
                        return ((navigator.mediaCapabilities.decodingInfo = TS), n.return(t));
                      if (((navigator.mediaCapabilities.decodingInfo = _S), r)) {
                        n.A(3);
                        break;
                      }
                      return b(n, PS(e), 4);
                    case 4:
                      return ((t.keySystemAccess = n.h), n.return(t));
                    case 3:
                      return n.return(_S.call(i, e));
                  }
                });
              }
              function _S(e) {
                var t,
                  r,
                  i,
                  n,
                  a,
                  s,
                  o,
                  l = this;
                return D(function (u) {
                  switch (u.g) {
                    case 1:
                      return (
                        (r = t = null),
                        !e.keySystemConfiguration ||
                        ((i = e.keySystemConfiguration),
                        (n = i.keySystem),
                        (r = i.audio && i.audio.encryptionScheme),
                        (t = i.video && i.video.encryptionScheme),
                        (a = ES(n)),
                        (s = {
                          powerEfficient: !1,
                          smooth: !1,
                          supported: !1,
                          keySystemAccess: null,
                          configuration: e,
                        }),
                        wS(r, a) && wS(t, a))
                          ? b(u, TS.call(l, e), 2)
                          : u.return(s)
                      );
                    case 2:
                      if ((o = u.h).keySystemAccess) {
                        ((o.keySystemAccess = new SS(o.keySystemAccess, t, r)), u.A(3));
                        break;
                      }
                      if (!e.keySystemConfiguration) {
                        u.A(3);
                        break;
                      }
                      return b(u, PS(e), 5);
                    case 5:
                      o.keySystemAccess = u.h;
                    case 3:
                      return u.return(o);
                  }
                });
              }
              function PS(e) {
                var t, r;
                return D(function (i) {
                  if (1 == i.g) {
                    var n = e.keySystemConfiguration,
                      a = [],
                      s = [];
                    return (
                      n.audio &&
                        a.push({
                          robustness: n.audio.robustness || "",
                          contentType: e.audio.contentType,
                          encryptionScheme: n.audio.encryptionScheme,
                        }),
                      n.video &&
                        s.push({
                          robustness: n.video.robustness || "",
                          contentType: e.video.contentType,
                          encryptionScheme: n.video.encryptionScheme,
                        }),
                      (n = {
                        initDataTypes: n.initDataType ? [n.initDataType] : [],
                        distinctiveIdentifier: n.distinctiveIdentifier,
                        persistentState: n.persistentState,
                        sessionTypes: n.sessionTypes,
                      }),
                      a.length && (n.audioCapabilities = a),
                      s.length && (n.videoCapabilities = s),
                      (t = n),
                      b(i, navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem, [t]), 2)
                    );
                  }
                  return ((r = i.h), i.return(r));
                });
              }
              function OS() {}
              function NS() {
                se().hc() ||
                  (navigator.mediaCapabilities || (navigator.mediaCapabilities = {}),
                  (OS.originalMcap = navigator.mediaCapabilities),
                  (navigator.mediaCapabilities.decodingInfo = FS));
              }
              function FS(t) {
                var r, i, n, a, s, o, l;
                return D(function (u) {
                  switch (u.g) {
                    case 1:
                      if (
                        ((r = {
                          supported: !1,
                          powerEfficient: !0,
                          smooth: !0,
                          keySystemAccess: null,
                          configuration: t,
                        }),
                        se(),
                        (i = t.video),
                        (n = t.audio),
                        "media-source" != t.type)
                      ) {
                        if ("file" != t.type) return u.return(r);
                        if (
                          (i && ((a = i.contentType), "" == eo().canPlayType(a))) ||
                          (n && ((s = n.contentType), "" == eo().canPlayType(s)))
                        )
                          return u.return(r);
                        u.A(2);
                        break;
                      }
                      if (!Qv()) return u.return(r);
                      if (!i) {
                        u.A(3);
                        break;
                      }
                      return b(
                        u,
                        (function (t) {
                          var r;
                          return D(function (i) {
                            return 1 == i.g
                              ? "CAST" !== se().Oa()
                                ? i.A(2)
                                : b(
                                    i,
                                    (function (t) {
                                      var r, i, n, a;
                                      return D(function (s) {
                                        if (1 == s.g) {
                                          if (
                                            !(e.cast && cast.__platform__ && cast.__platform__.canDisplayType)
                                          )
                                            return s.return(Ja(t.contentType));
                                          switch (
                                            ((r = t.contentType),
                                            t.width &&
                                              t.height &&
                                              t.width > 1280 &&
                                              t.height > 720 &&
                                              (r += "; width=" + t.width + "; height=" + t.height),
                                            t.framerate &&
                                              ((i = Math.round(t.framerate)) < 24 || i > 30) &&
                                              (r += "; framerate=" + t.framerate),
                                            t.transferFunction || "")
                                          ) {
                                            case "":
                                            case "srgb":
                                              break;
                                            case "pq":
                                              r += "; eotf=smpte2084";
                                              break;
                                            case "hlg":
                                              r += "; eotf=arib-std-b67";
                                              break;
                                            default:
                                              return s.return(!1);
                                          }
                                          return (
                                            (n = !1),
                                            (a = HS).has(r)
                                              ? ((n = a.get(r)), s.A(2))
                                              : b(s, cast.__platform__.canDisplayType(r), 3)
                                          );
                                        }
                                        return (2 != s.g && ((n = s.h), a.set(r, n)), s.return(n));
                                      });
                                    })(t),
                                    3,
                                  )
                              : 2 != i.g
                                ? ((r = i.h), i.return(r))
                                : i.return(Ja(t.contentType));
                          });
                        })(i),
                        4,
                      );
                    case 4:
                      if (!u.h) return u.return(r);
                    case 3:
                      if (n) {
                        var d = se().Oa(),
                          h = n.contentType;
                        if (("CAST" === d && n.spatialRendering && (h += "; spatialRendering=true"), !Ja(h)))
                          return u.return(r);
                      }
                    case 2:
                      return t.keySystemConfiguration
                        ? ((o = t.keySystemConfiguration),
                          b(
                            u,
                            (function (e, t, r) {
                              var i, n, a, s, o, l, u, d, h, c, f, p;
                              return D(function (g) {
                                switch (g.g) {
                                  case 1:
                                    ((i = []),
                                      (n = []),
                                      (a = []),
                                      r.audio &&
                                        ((s = {
                                          robustness: r.audio.robustness || "",
                                          contentType: t.contentType,
                                        }),
                                        se().Bi() &&
                                          t.contentType.includes('codecs="ac-3"') &&
                                          (s.contentType = 'audio/mp4; codecs="ec-3"'),
                                        r.audio.encryptionScheme &&
                                          ((s.encryptionScheme = r.audio.encryptionScheme),
                                          a.push(r.audio.encryptionScheme)),
                                        i.push(s)),
                                      r.video &&
                                        ((o = {
                                          robustness: r.video.robustness || "",
                                          contentType: e.contentType,
                                        }),
                                        r.video.encryptionScheme &&
                                          ((o.encryptionScheme = r.video.encryptionScheme),
                                          a.push(r.video.encryptionScheme)),
                                        n.push(o)),
                                      (l = {
                                        initDataTypes: [r.initDataType],
                                        distinctiveIdentifier: r.distinctiveIdentifier,
                                        persistentState: r.persistentState,
                                        sessionTypes: r.sessionTypes,
                                      }),
                                      i.length && (l.audioCapabilities = i),
                                      n.length && (l.videoCapabilities = n),
                                      (u = e ? e.contentType : ""),
                                      (d = t ? t.contentType : ""),
                                      (h = pi(u) + ";" + fi(u)),
                                      (c = pi(d) + ";" + fi(d)),
                                      (f = r.keySystem),
                                      (p = null),
                                      E(g, 2));
                                    var m = He(h, c, f, a);
                                    if (We.has(m)) {
                                      ((m = He(h, c, f, a)), (p = We.get(m) || null), g.A(4));
                                      break;
                                    }
                                    return b(g, navigator.requestMediaKeySystemAccess(r.keySystem, [l]), 5);
                                  case 5:
                                    m = p = g.h;
                                    var v = He(h, c, f, a);
                                    We.set(v, m);
                                  case 4:
                                    w(g, 3);
                                    break;
                                  case 2:
                                    A(g);
                                  case 3:
                                    return g.return(p);
                                }
                              });
                            })(i, n, o),
                            6,
                          ))
                        : ((r.supported = !0), u.return(r));
                    case 6:
                      (l = u.h) && ((r.supported = !0), (r.keySystemAccess = l));
                    case 5:
                      return u.return(r);
                  }
                });
              }
              ((SS.prototype.getConfiguration = function () {
                var e = this.g.getConfiguration();
                if (e.videoCapabilities)
                  for (var t = g(e.videoCapabilities), r = t.next(); !r.done; r = t.next())
                    r.value.encryptionScheme = this.i;
                if (e.audioCapabilities)
                  for (r = (t = g(e.audioCapabilities)).next(); !r.done; r = t.next())
                    r.value.encryptionScheme = this.h;
                return e;
              }),
                (SS.prototype.createMediaKeys = function () {
                  return this.g.createMediaKeys();
                }),
                (mS.EmeEncryptionScheme = AS),
                (AS.install = IS),
                vS(IS),
                (mS.MCapEncryptionScheme = LS),
                (LS.install = MS),
                vS(MS, -2),
                (mS.MediaCapabilities = OS),
                (OS.install = NS),
                (OS.originalMcap = null));
              var US,
                BS,
                $S,
                jS,
                GS,
                VS,
                HS = new Map();
              function KS() {}
              function WS() {
                var t = se(),
                  r = "WEBKIT" === t.Ha() ? t.Ba() : null;
                for (
                  (e.MediaSource || e.ManagedMediaSource) &&
                    r &&
                    e.MediaSource &&
                    (r <= 12
                      ? (zS(),
                        (function () {
                          var e = SourceBuffer.prototype.remove;
                          SourceBuffer.prototype.remove = function (t, r) {
                            return e.call(this, t, r - 0.001);
                          };
                        })())
                      : r <= 15 && zS()),
                    r = (t = g(t.Li())).next();
                  !r.done;
                  r = t.next()
                )
                  qS(r.value);
                ((e.MediaSource || e.ManagedMediaSource) &&
                  (function () {
                    if (e.MediaSource) {
                      var t = MediaSource.isTypeSupported.bind(MediaSource);
                      MediaSource.isTypeSupported = function (e) {
                        return "mp2t" != hi(e) && t(e);
                      };
                    }
                    if (e.ManagedMediaSource) {
                      var r = ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);
                      e.ManagedMediaSource.isTypeSupported = function (e) {
                        return "mp2t" != hi(e) && r(e);
                      };
                    }
                  })(),
                  e.MediaSource &&
                    MediaSource.isTypeSupported('video/webm; codecs="vp9"') &&
                    !MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"') &&
                    (function () {
                      var e = MediaSource.isTypeSupported;
                      se().fj() &&
                        (MediaSource.isTypeSupported = function (t) {
                          var r = t.split(/ *; */),
                            i = r.findIndex(function (e) {
                              return e.startsWith("codecs=");
                            });
                          if (i < 0) return e(t);
                          var n = r[i]
                              .replace("codecs=", "")
                              .replace(/"/g, "")
                              .split(/\s*,\s*/),
                            a = n.findIndex(function (e) {
                              return e.startsWith("vp09");
                            });
                          return (
                            a >= 0 &&
                              ((n[a] = "vp9"), (r[i] = 'codecs="' + n.join(",") + '"'), (t = r.join("; "))),
                            e(t)
                          );
                        });
                    })());
              }
              function zS() {
                var e = MediaSource.prototype.addSourceBuffer;
                MediaSource.prototype.addSourceBuffer = function () {
                  var t = e.apply(this, _.apply(0, arguments));
                  return ((t.abort = function () {}), t);
                };
              }
              function qS(t) {
                var r = MediaSource.isTypeSupported.bind(MediaSource);
                if (
                  ((MediaSource.isTypeSupported = function (e) {
                    return fi(e) != t && r(e);
                  }),
                  e.ManagedMediaSource)
                ) {
                  var i = ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);
                  e.ManagedMediaSource.isTypeSupported = function (e) {
                    return fi(e) != t && i(e);
                  };
                }
              }
              function XS() {}
              function YS(t) {
                e.HTMLVideoElement &&
                  e.WebKitMediaKeys &&
                  e.shakaMediaKeysPolyfill != sE &&
                  (void 0 !== t &&
                    t &&
                    ((US = !0),
                    (BS = Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype, "mediaKeys")),
                    ($S = HTMLMediaElement.prototype.setMediaKeys),
                    (jS = e.MediaKeys),
                    (GS = e.MediaKeySystemAccess),
                    (VS = navigator.requestMediaKeySystemAccess)),
                  delete HTMLMediaElement.prototype.mediaKeys,
                  (HTMLMediaElement.prototype.mediaKeys = null),
                  (HTMLMediaElement.prototype.setMediaKeys = JS),
                  (e.MediaKeys = tE),
                  (e.MediaKeySystemAccess = eE),
                  (navigator.requestMediaKeySystemAccess = QS),
                  (e.shakaMediaKeysPolyfill = sE),
                  mn.clear(),
                  We.clear());
              }
              function QS(e, t) {
                try {
                  var r = new eE(e, t);
                  return Promise.resolve(r);
                } catch (i) {
                  return Promise.reject(i);
                }
              }
              function JS(e) {
                var t = this.mediaKeys;
                return (
                  t && t != e && rE(t, null),
                  delete this.mediaKeys,
                  (this.mediaKeys = e) ? rE(e, this) : Promise.resolve()
                );
              }
              function ZS(e) {
                if (Fe((e = Oe(e.initData))).getUint32(0, !0) + 4 != e.byteLength)
                  throw new RangeError("Malformed FairPlay init data");
                e = Je((e = Ye(e.subarray(4), !0)));
                var t = new Event("encrypted");
                ((t.initDataType = "skd"), (t.initData = Pe(e)), this.dispatchEvent(t));
              }
              function eE(e, t) {
                if (((this.keySystem = e), e.startsWith("com.apple.fps")))
                  for (t = (e = g(t)).next(); !t.done; t = e.next()) {
                    var r = t.value;
                    if ("required" == r.persistentState) t = null;
                    else {
                      t = {
                        audioCapabilities: [],
                        videoCapabilities: [],
                        persistentState: "optional",
                        distinctiveIdentifier: "optional",
                        initDataTypes: r.initDataTypes,
                        sessionTypes: ["temporary"],
                        label: r.label,
                      };
                      var i = !1,
                        n = !1;
                      if (r.audioCapabilities)
                        for (var a = g(r.audioCapabilities), s = a.next(); !s.done; s = a.next())
                          (s = s.value).contentType &&
                            ((i = !0),
                            WebKitMediaKeys.isTypeSupported(this.keySystem, s.contentType.split(";")[0]) &&
                              (t.audioCapabilities.push(s), (n = !0)));
                      if (r.videoCapabilities)
                        for (a = (r = g(r.videoCapabilities)).next(); !a.done; a = r.next())
                          (a = a.value).contentType &&
                            ((i = !0),
                            WebKitMediaKeys.isTypeSupported(this.keySystem, a.contentType.split(";")[0]) &&
                              (t.videoCapabilities.push(a), (n = !0)));
                      (i || (n = WebKitMediaKeys.isTypeSupported(this.keySystem, "video/mp4")),
                        (t = n ? t : null));
                    }
                    if (t) return void (this.g = t);
                  }
                throw (
                  ((e = Error("Unsupported keySystem")).name = "NotSupportedError"),
                  (e.code = DOMException.NOT_SUPPORTED_ERR),
                  e
                );
              }
              function tE(e) {
                ((this.h = new WebKitMediaKeys(e)), (this.g = new re()));
              }
              function rE(e, t) {
                if ((e.g.Qa(), !t)) return Promise.resolve();
                e.g.D(t, "webkitneedkey", ZS);
                try {
                  return (
                    pl(t, HTMLMediaElement.HAVE_METADATA, e.g, function () {
                      t.webkitSetMediaKeys(e.h);
                    }),
                    Promise.resolve()
                  );
                } catch (r) {
                  return Promise.reject(r);
                }
              }
              function iE(e) {
                (Fn.call(this),
                  (this.i = null),
                  (this.l = e),
                  (this.g = this.h = null),
                  (this.j = new re()),
                  (this.sessionId = ""),
                  (this.expiration = NaN),
                  (this.closed = new kn()),
                  (this.keyStatuses = new aE()),
                  (this.onkeystatuseschange = null));
              }
              function nE(e, t) {
                var r = e.keyStatuses;
                ((r.size = null == t ? 0 : 1),
                  (r.g = t),
                  (t = new Pn("keystatuseschange")),
                  e.dispatchEvent(t),
                  e.onkeystatuseschange && e.onkeystatuseschange(t));
              }
              function aE() {
                ((this.size = 0), (this.g = void 0));
              }
              (vS(NS, -1),
                (mS.MediaSource = KS),
                (KS.install = WS),
                vS(WS),
                (mS.PatchedMediaKeysApple = XS),
                (XS.uninstall = function () {
                  e.shakaMediaKeysPolyfill == sE &&
                    US &&
                    ((US = !1),
                    Object.defineProperty(HTMLMediaElement.prototype, "mediaKeys", BS),
                    (HTMLMediaElement.prototype.setMediaKeys = $S),
                    (e.MediaKeys = jS),
                    (e.MediaKeySystemAccess = GS),
                    (navigator.requestMediaKeySystemAccess = VS),
                    (BS = VS = $S = GS = jS = null),
                    (e.shakaMediaKeysPolyfill = ""),
                    mn.clear(),
                    We.clear());
                }),
                (XS.install = YS),
                (eE.prototype.createMediaKeys = function () {
                  var e = new tE(this.keySystem);
                  return Promise.resolve(e);
                }),
                (eE.prototype.getConfiguration = function () {
                  return this.g;
                }),
                (tE.prototype.createSession = function (e) {
                  if ("temporary" != (e = e || "temporary"))
                    throw new TypeError("Session type " + e + " is unsupported on this platform.");
                  return new iE(this.h);
                }),
                (tE.prototype.setServerCertificate = function () {
                  return Promise.resolve(!1);
                }),
                (tE.prototype.getStatusForPolicy = function () {
                  return Promise.resolve("usable");
                }),
                f(iE, Fn),
                ((n = iE.prototype).generateRequest = function (e, t) {
                  var r = this;
                  this.h = new kn();
                  try {
                    var i = this.l.createSession("video/mp4", Oe(t));
                    ((this.i = i),
                      (this.sessionId = i.sessionId || ""),
                      this.j.D(this.i, "webkitkeymessage", function (e) {
                        (r.h && (r.h.resolve(), (r.h = null)),
                          (e = new Pn(
                            "message",
                            (e = new Map()
                              .set(
                                "messageType",
                                null == r.keyStatuses.Kc() ? "license-request" : "license-renewal",
                              )
                              .set("message", Pe(e.message))),
                          )),
                          r.dispatchEvent(e));
                      }),
                      this.j.D(i, "webkitkeyadded", function () {
                        r.g && (nE(r, "usable"), r.g.resolve(), (r.g = null));
                      }),
                      this.j.D(i, "webkitkeyerror", function () {
                        var e = Error("EME PatchedMediaKeysApple key error");
                        if (((e.errorCode = r.i.error), null != r.h)) (r.h.reject(e), (r.h = null));
                        else if (null != r.g) (r.g.reject(e), (r.g = null));
                        else
                          switch (r.i.error.code) {
                            case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:
                            case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:
                              nE(r, "output-not-allowed");
                              break;
                            default:
                              nE(r, "internal-error");
                          }
                      }),
                      nE(this, "status-pending"));
                  } catch (n) {
                    this.h.reject(n);
                  }
                  return this.h;
                }),
                (n.load = function () {
                  return Promise.reject(Error("MediaKeySession.load not yet supported"));
                }),
                (n.update = function (e) {
                  this.g = new kn();
                  try {
                    this.i.update(Oe(e));
                  } catch (t) {
                    this.g.reject(t);
                  }
                  return this.g;
                }),
                (n.close = function () {
                  try {
                    (this.i.close(), this.closed.resolve(), this.j.Qa());
                  } catch (pw) {
                    this.closed.reject(pw);
                  }
                  return this.closed;
                }),
                (n.remove = function () {
                  return Promise.reject(
                    Error(
                      "MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform",
                    ),
                  );
                }),
                ((n = aE.prototype).Kc = function () {
                  return this.g;
                }),
                (n.forEach = function (e) {
                  this.g && e(this.g, Ke.value());
                }),
                (n.get = function (e) {
                  if (this.has(e)) return this.g;
                }),
                (n.has = function (e) {
                  var t = Ke.value();
                  return !(!this.g || !_e(e, t));
                }),
                (n.entries = function () {}),
                (n.keys = function () {}),
                (n.values = function () {}));
              var sE = "apple";
              function oE() {}
              function lE() {
                if (e.MediaKeys) {
                  var t = se();
                  (MediaKeys.prototype.setServerCertificate && t.we()) ||
                    (MediaKeys.prototype.setServerCertificate = uE);
                }
              }
              function uE() {
                return Promise.resolve(!1);
              }
              function dE() {}
              function hE() {
                if (
                  !(
                    !e.HTMLVideoElement ||
                    (navigator.requestMediaKeySystemAccess && MediaKeySystemAccess.prototype.getConfiguration)
                  )
                ) {
                  if (HTMLMediaElement.prototype.webkitGenerateKeyRequest) wE = "webkit";
                  else if (!HTMLMediaElement.prototype.generateKeyRequest) return;
                  ((navigator.requestMediaKeySystemAccess = fE),
                    delete HTMLMediaElement.prototype.mediaKeys,
                    (HTMLMediaElement.prototype.mediaKeys = null),
                    (HTMLMediaElement.prototype.setMediaKeys = pE),
                    (e.MediaKeys = mE),
                    (e.MediaKeySystemAccess = gE),
                    (e.shakaMediaKeysPolyfill = AE));
                }
              }
              function cE(e) {
                return wE ? wE + e.charAt(0).toUpperCase() + e.slice(1) : e;
              }
              function fE(e, t) {
                try {
                  var r = new gE(e, t);
                  return Promise.resolve(r);
                } catch (i) {
                  return Promise.reject(i);
                }
              }
              function pE(e) {
                var t = this.mediaKeys;
                return (
                  t && t != e && vE(t, null),
                  delete this.mediaKeys,
                  (this.mediaKeys = e) && vE(e, this),
                  Promise.resolve()
                );
              }
              function gE(e, t) {
                this.g = this.keySystem = e;
                var r = !1;
                "org.w3.clearkey" == e && ((this.g = "webkit-org.w3.clearkey"), (r = !1));
                var i = !1,
                  n = document.getElementsByTagName("video");
                n = n.length ? n[0] : document.createElement("video");
                for (var a = (t = g(t)).next(); !a.done; a = t.next()) {
                  var s = {
                      audioCapabilities: [],
                      videoCapabilities: [],
                      persistentState: "optional",
                      distinctiveIdentifier: "optional",
                      initDataTypes: (a = a.value).initDataTypes,
                      sessionTypes: ["temporary"],
                      label: a.label,
                    },
                    o = !1;
                  if (a.audioCapabilities)
                    for (var l = g(a.audioCapabilities), u = l.next(); !u.done; u = l.next())
                      (u = u.value).contentType &&
                        ((o = !0),
                        n.canPlayType(u.contentType.split(";")[0], this.g) &&
                          (s.audioCapabilities.push(u), (i = !0)));
                  if (a.videoCapabilities)
                    for (u = (l = g(a.videoCapabilities)).next(); !u.done; u = l.next())
                      (u = u.value).contentType &&
                        ((o = !0),
                        n.canPlayType(u.contentType, this.g) && (s.videoCapabilities.push(u), (i = !0)));
                  if (
                    (o || (i = n.canPlayType("video/mp4", this.g) || n.canPlayType("video/webm", this.g)),
                    "required" == a.persistentState &&
                      (r
                        ? ((s.persistentState = "required"), (s.sessionTypes = ["persistent-license"]))
                        : (i = !1)),
                    i)
                  )
                    return void (this.h = s);
                }
                throw (
                  (r = "Unsupported keySystem"),
                  ("org.w3.clearkey" != e && "com.widevine.alpha" != e) ||
                    (r = "None of the requested configurations were supported."),
                  ((e = Error(r)).name = "NotSupportedError"),
                  (e.code = DOMException.NOT_SUPPORTED_ERR),
                  e
                );
              }
              function mE(e) {
                ((this.l = e), (this.h = null), (this.g = new re()), (this.i = []), (this.j = new Map()));
              }
              function vE(e, t) {
                ((e.h = t), e.g.Qa());
                var r = wE;
                t &&
                  (e.g.D(t, r + "needkey", function (t) {
                    var r = new CustomEvent("encrypted");
                    ((r.initDataType = "cenc"), (r.initData = Pe(t.initData)), e.h.dispatchEvent(r));
                  }),
                  e.g.D(t, r + "keymessage", function (t) {
                    var r = yE(e, t.sessionId);
                    r &&
                      ((t = new Pn(
                        "message",
                        (t = new Map()
                          .set(
                            "messageType",
                            null == r.keyStatuses.Kc() ? "licenserequest" : "licenserenewal",
                          )
                          .set("message", t.message)),
                      )),
                      r.h && (r.h.resolve(), (r.h = null)),
                      r.dispatchEvent(t));
                  }),
                  e.g.D(t, r + "keyadded", function (t) {
                    (t = yE(e, t.sessionId)) && t.ready();
                  }),
                  e.g.D(t, r + "keyerror", function (t) {
                    var r = yE(e, t.sessionId);
                    if (r) {
                      var i = Error("EME v0.1b key error"),
                        n = t.errorCode;
                      ((n.systemCode = t.systemCode),
                        (i.errorCode = n),
                        !t.sessionId && r.h
                          ? (45 == t.systemCode && (i.message = "Unsupported session type."),
                            r.h.reject(i),
                            (r.h = null))
                          : t.sessionId && r.g
                            ? (r.g.reject(i), (r.g = null))
                            : ((i = t.systemCode),
                              t.errorCode.code == MediaKeyError.MEDIA_KEYERR_OUTPUT
                                ? EE(r, "output-restricted")
                                : EE(r, 1 == i ? "expired" : "internal-error")));
                    }
                  }));
              }
              function yE(e, t) {
                var r = e.j.get(t);
                return r || ((r = e.i.shift()) ? ((r.sessionId = t), e.j.set(t, r), r) : null);
              }
              function TE(e, t, r) {
                (Fn.call(this),
                  (this.j = e),
                  (this.m = !1),
                  (this.g = this.h = null),
                  (this.i = t),
                  (this.l = r),
                  (this.sessionId = ""),
                  (this.expiration = NaN),
                  (this.closed = new kn()),
                  (this.keyStatuses = new xE()),
                  (this.onkeystatuseschange = null));
              }
              function bE(e, t, r) {
                if (e.m) return Promise.reject(Error("The session is already initialized."));
                e.m = !0;
                try {
                  if ("persistent-license" == e.l)
                    if (r) var i = Oe(Je("LOAD_SESSION|" + r));
                    else {
                      var n = Je("PERSISTENT|");
                      i = lt(n, t);
                    }
                  else i = Oe(t);
                } catch (s) {
                  return Promise.reject(s);
                }
                e.h = new kn();
                var a = cE("generateKeyRequest");
                try {
                  e.j[a](e.i, i);
                } catch (s) {
                  if ("InvalidStateError" != s.name) return ((e.h = null), Promise.reject(s));
                  new Ri(function () {
                    try {
                      e.j[a](e.i, i);
                    } catch (t) {
                      (e.h.reject(t), (e.h = null));
                    }
                  }).ka(0.01);
                }
                return e.h;
              }
              function SE(e, t, r) {
                if (e.g)
                  e.g
                    .then(function () {
                      return SE(e, t, r);
                    })
                    .catch(function () {
                      return SE(e, t, r);
                    });
                else {
                  if (((e.g = t), "webkit-org.w3.clearkey" == e.i)) {
                    var i = Xe(r),
                      n = JSON.parse(i);
                    ("oct" != n.keys[0].kty &&
                      (e.g.reject(Error("Response is not a valid JSON Web Key Set.")), (e.g = null)),
                      (i = at(n.keys[0].k)),
                      (n = at(n.keys[0].kid)));
                  } else ((i = Oe(r)), (n = null));
                  var a = cE("addKey");
                  try {
                    e.j[a](e.i, i, n, e.sessionId);
                  } catch (s) {
                    (e.g.reject(s), (e.g = null));
                  }
                }
              }
              function EE(e, t) {
                var r = e.keyStatuses;
                ((r.size = null == t ? 0 : 1),
                  (r.g = t),
                  (t = new Pn("keystatuseschange")),
                  e.dispatchEvent(t),
                  e.onkeystatuseschange && e.onkeystatuseschange(t));
              }
              function xE() {
                ((this.size = 0), (this.g = void 0));
              }
              (vS(function () {
                e.HTMLVideoElement &&
                  e.WebKitMediaKeys &&
                  ((navigator.requestMediaKeySystemAccess &&
                    MediaKeySystemAccess.prototype.getConfiguration) ||
                    YS());
              }),
                (mS.PatchedMediaKeysCert = oE),
                (oE.install = lE),
                vS(lE),
                (mS.PatchedMediaKeysWebkit = dE),
                (dE.install = hE),
                (gE.prototype.createMediaKeys = function () {
                  var e = new mE(this.g);
                  return Promise.resolve(e);
                }),
                (gE.prototype.getConfiguration = function () {
                  return this.h;
                }),
                (mE.prototype.createSession = function (e) {
                  if ("temporary" != (e = e || "temporary") && "persistent-license" != e)
                    throw new TypeError("Session type " + e + " is unsupported on this platform.");
                  var t = this.h || document.createElement("video");
                  return (t.src || (t.src = "about:blank"), (e = new TE(t, this.l, e)), this.i.push(e), e);
                }),
                (mE.prototype.setServerCertificate = function () {
                  return Promise.resolve(!1);
                }),
                (mE.prototype.getStatusForPolicy = function () {
                  return Promise.resolve("usable");
                }),
                f(TE, Fn),
                ((n = TE.prototype).ready = function () {
                  (EE(this, "usable"), this.g && this.g.resolve(), (this.g = null));
                }),
                (n.generateRequest = function (e, t) {
                  return bE(this, t, null);
                }),
                (n.load = function (e) {
                  return "persistent-license" == this.l
                    ? bE(this, null, e)
                    : Promise.reject(Error("Not a persistent session."));
                }),
                (n.update = function (e) {
                  var t = new kn();
                  return (SE(this, t, e), t);
                }),
                (n.close = function () {
                  if ("persistent-license" != this.l) {
                    if (!this.sessionId)
                      return (this.closed.reject(Error("The session is not callable.")), this.closed);
                    var e = cE("cancelKeyRequest");
                    try {
                      this.j[e](this.i, this.sessionId);
                    } catch (t) {}
                  }
                  return (this.closed.resolve(), this.closed);
                }),
                (n.remove = function () {
                  return "persistent-license" != this.l
                    ? Promise.reject(Error("Not a persistent session."))
                    : this.close();
                }),
                ((n = xE.prototype).Kc = function () {
                  return this.g;
                }),
                (n.forEach = function (e) {
                  this.g && e(this.g, Ke.value());
                }),
                (n.get = function (e) {
                  if (this.has(e)) return this.g;
                }),
                (n.has = function (e) {
                  var t = Ke.value();
                  return !(!this.g || !_e(e, t));
                }),
                (n.entries = function () {}),
                (n.keys = function () {}),
                (n.values = function () {}));
              var wE = "",
                AE = "webkit";
              function IE() {}
              function kE() {
                e.crypto && ("randomUUID" in e.crypto || (e.crypto.randomUUID = RE));
              }
              function RE() {
                var e = URL.createObjectURL(new Blob()),
                  t = e.toString();
                return (URL.revokeObjectURL(e), t.substr(t.lastIndexOf("/") + 1));
              }
              function CE() {}
              function LE() {
                var e = Symbol.prototype;
                "description" in e || Object.defineProperty(e, "description", { get: ME });
              }
              function ME() {
                var e = /\((.*)\)/.exec(this.toString());
                return e ? e[1] : void 0;
              }
              function DE() {}
              function _E() {
                for (
                  var e = g([
                      Uint8Array,
                      Uint8ClampedArray,
                      Uint16Array,
                      Uint32Array,
                      Int8Array,
                      Int16Array,
                      Int32Array,
                      Float32Array,
                      Float64Array,
                    ]),
                    t = e.next();
                  !t.done;
                  t = e.next()
                )
                  ((t = t.value).prototype.indexOf || (t.prototype.indexOf = PE),
                    t.prototype.lastIndexOf || (t.prototype.lastIndexOf = OE),
                    t.prototype.includes || (t.prototype.includes = NE));
              }
              function PE(e, t) {
                return Array.prototype.indexOf.call(this, e, t);
              }
              function OE(e, t) {
                return Array.prototype.lastIndexOf.call(this, e, t);
              }
              function NE(e, t) {
                return -1 !== this.indexOf(e, t);
              }
              function FE() {}
              function UE() {
                if (e.HTMLMediaElement) {
                  var t = HTMLMediaElement.prototype.play;
                  HTMLMediaElement.prototype.play = function () {
                    var e = t.apply(this);
                    return (e && e.catch(function () {}), e);
                  };
                }
              }
              function BE() {}
              function $E() {
                if (e.HTMLVideoElement) {
                  var t = HTMLVideoElement.prototype;
                  !t.getVideoPlaybackQuality &&
                    ("webkitDroppedFrameCount" in t || "number" == typeof eo().webkitDroppedFrameCount) &&
                    (t.getVideoPlaybackQuality = jE);
                }
              }
              function jE() {
                return {
                  droppedVideoFrames: this.webkitDroppedFrameCount,
                  totalVideoFrames: this.webkitDecodedFrameCount,
                  corruptedVideoFrames: 0,
                  creationTime: NaN,
                  totalFrameDelay: 0,
                };
              }
              function GE() {}
              function VE() {
                if (!e.VTTCue && e.TextTrackCue) {
                  var t = null,
                    r = TextTrackCue.length;
                  if (3 == r) t = HE;
                  else if (6 == r) t = KE;
                  else {
                    try {
                      var i = !!HE(1, 2, "");
                    } catch (n) {
                      i = !1;
                    }
                    i && (t = HE);
                  }
                  t &&
                    (e.VTTCue = function (e, r, i) {
                      return t(e, r, i);
                    });
                }
              }
              function HE(t, r, i) {
                return new e.TextTrackCue(t, r, i);
              }
              function KE(t, r, i) {
                return new e.TextTrackCue(t + "-" + r + "-" + i, t, r, i);
              }
              function WE(e) {
                (Fn.call(this),
                  (this.g = e),
                  (this.m = null),
                  (this.h = []),
                  (this.j = -1),
                  (this.i = this.l = null),
                  (this.o = new re()));
              }
              function zE() {}
              (vS(hE),
                (mS.RandomUUID = IE),
                (IE.install = kE),
                vS(kE),
                (mS.Symbol = CE),
                (CE.install = LE),
                vS(LE),
                (mS.TypedArray = DE),
                (DE.install = _E),
                vS(_E),
                (mS.VideoPlayPromise = FE),
                (FE.install = UE),
                vS(UE),
                (mS.VideoPlaybackQuality = BE),
                (BE.install = $E),
                vS($E),
                (mS.VTTCue = GE),
                (GE.install = VE),
                vS(VE),
                f(WE, Fn),
                ((n = WE.prototype).destroy = function () {
                  var e = this;
                  return D(function (t) {
                    if (1 == t.g) return b(t, e.removeAllItems(), 2);
                    ((e.g = null), e.o && (e.o.release(), (e.o = null)), Fn.prototype.release.call(e), S(t));
                  });
                }),
                (n.configure = function (e) {
                  this.m = e;
                }),
                (n.getConfiguration = function () {
                  return this.m;
                }),
                (n.getCurrentItem = function () {
                  return this.h.length && this.j >= 0 && this.j < this.h.length ? this.h[this.j] : null;
                }),
                (n.getCurrentItemIndex = function () {
                  return this.j;
                }),
                (n.getItems = function () {
                  return this.h.slice();
                }),
                (n.insertItems = function (e) {
                  (this.h.push.apply(this.h, m(e)), this.dispatchEvent(new Pn("itemsinserted")));
                }),
                (n.removeAllItems = function () {
                  var e,
                    t,
                    r,
                    i,
                    n = this;
                  return D(function (a) {
                    if (1 == a.g) return (n.o.Qa(), n.h.length && n.j >= 0 ? b(a, n.g.Cc(), 2) : a.A(2));
                    if (4 != a.g) {
                      for (
                        e = [],
                          n.i && (n.i.preloadManager.l || e.push(n.i.preloadManager.destroy()), (n.i = null)),
                          n.l && (n.l.preloadManager.l || e.push(n.l.preloadManager.destroy()), (n.l = null)),
                          t = g(n.h),
                          r = t.next();
                        !r.done;
                        r = t.next()
                      )
                        (i = r.value).preloadManager &&
                          !i.preloadManager.l &&
                          e.push(i.preloadManager.destroy());
                      return e.length ? b(a, Promise.all(e), 4) : a.A(4);
                    }
                    ((n.h = []), (n.j = -1), n.dispatchEvent(new Pn("itemsremoved")), S(a));
                  });
                }),
                (n.playItem = function (e) {
                  var t,
                    r,
                    i,
                    n,
                    a,
                    s,
                    o,
                    l,
                    u,
                    d,
                    h,
                    c,
                    f,
                    p,
                    m,
                    v,
                    y,
                    T = this;
                  return D(function (x) {
                    switch (x.g) {
                      case 1:
                        if ((T.o.Qa(), !T.h.length || e >= T.h.length)) throw new ze(2, 7, 7007);
                        if (
                          ((t = T.getCurrentItem()),
                          (r = T.h[e]),
                          T.j != e && ((T.j = e), T.dispatchEvent(new Pn("currentitemchanged"))),
                          (i = T.g.bf()),
                          (n = T.m ? T.m.preloadNextUrlWindow : 0) > 0 &&
                            ((a = !1),
                            T.o.D(i, "timeupdate", function () {
                              var e, t, r, s;
                              return D(function (o) {
                                switch (o.g) {
                                  case 1:
                                    if (T.l || T.h.length <= 1 || a || T.g.W() || !i.duration)
                                      return o.return();
                                    if (((e = T.g.Ra().end - i.currentTime), isNaN(e))) {
                                      o.A(0);
                                      break;
                                    }
                                    if (!(e <= n)) {
                                      o.A(0);
                                      break;
                                    }
                                    if (
                                      ((t = T.m && T.m.repeatMode),
                                      (r = null),
                                      T.j + 1 < T.h.length ? (r = T.h[T.j + 1]) : 1 == t && (r = T.h[0]),
                                      !r || (r.preloadManager && !r.preloadManager.l))
                                    ) {
                                      o.A(0);
                                      break;
                                    }
                                    return (
                                      (a = !0),
                                      (s = null),
                                      E(o, 5),
                                      b(o, T.g.preload(r.manifestUri, r.startTime, r.mimeType, r.config), 7)
                                    );
                                  case 7:
                                    ((s = o.h), w(o, 6));
                                    break;
                                  case 5:
                                    (A(o), (s = null));
                                  case 6:
                                    ((T.l = { item: r, preloadManager: s }), (a = !1), S(o));
                                }
                              });
                            })),
                          T.o.D(T.g, "complete", function () {
                            var e = T.m && T.m.repeatMode,
                              t = !1;
                            if (2 == e) t = !0;
                            else {
                              var r = T.j + 1;
                              r < T.h.length
                                ? T.playItem(r)
                                : 1 == e && (1 == T.h.length ? (t = !0) : T.playItem(0));
                            }
                            t &&
                              (i.paused
                                ? ((i.currentTime = T.g.Ra().start), i.play())
                                : T.o.D(i, "paused", function () {
                                    ((i.currentTime = T.g.Ra().start), i.play());
                                  }));
                          }),
                          (s = r.manifestUri),
                          r.preloadManager && !r.preloadManager.l && (s = r.preloadManager),
                          (o = !1),
                          T.l && T.l.item == r && T.l.preloadManager
                            ? (s = T.l.preloadManager)
                            : T.i &&
                              T.i.item == r &&
                              T.i.preloadManager &&
                              ((s = T.i.preloadManager), (o = !0)),
                          !T.i)
                        ) {
                          x.A(2);
                          break;
                        }
                        if (o || T.i.preloadManager.l) {
                          x.A(3);
                          break;
                        }
                        return b(x, T.i.preloadManager.destroy(), 3);
                      case 3:
                        T.i = null;
                      case 2:
                        if (!(T.m && T.m.preloadPrevItem && t && T.g.$d() === nf)) {
                          x.A(5);
                          break;
                        }
                        return ((l = null), E(x, 6), b(x, T.g.jj(), 8));
                      case 8:
                        ((l = x.h), w(x, 7));
                        break;
                      case 6:
                        (A(x), (l = null));
                      case 7:
                        T.i = { item: t, preloadManager: l };
                      case 5:
                        return (
                          r.config && (T.g.Oi(), T.g.configure(r.config)),
                          b(x, T.g.load(s, r.startTime, r.mimeType), 9)
                        );
                      case 9:
                        if (((T.l = null), r.extraText))
                          for (u = g(r.extraText), d = u.next(); !d.done; d = u.next())
                            (h = d.value).mime
                              ? T.g.Rd(h.uri, h.language, h.kind, h.mime, h.codecs)
                              : T.g.Rd(h.uri, h.language, h.kind);
                        if (r.extraThumbnail)
                          for (c = g(r.extraThumbnail), f = c.next(); !f.done; f = c.next())
                            ((p = f.value), T.g.Pe(p));
                        if (r.extraChapter)
                          for (m = g(r.extraChapter), v = m.next(); !v.done; v = m.next())
                            ((y = v.value), T.g.Oe(y.uri, y.language, y.mime));
                        S(x);
                    }
                  });
                }),
                j("shaka.queue.QueueManager", WE),
                (WE.prototype.playItem = WE.prototype.playItem),
                (WE.prototype.removeAllItems = WE.prototype.removeAllItems),
                (WE.prototype.insertItems = WE.prototype.insertItems),
                (WE.prototype.getItems = WE.prototype.getItems),
                (WE.prototype.getCurrentItemIndex = WE.prototype.getCurrentItemIndex),
                (WE.prototype.getCurrentItem = WE.prototype.getCurrentItem),
                (WE.prototype.getConfiguration = WE.prototype.getConfiguration),
                (WE.prototype.configure = WE.prototype.configure),
                (WE.prototype.destroy = WE.prototype.destroy),
                (uf = function (e) {
                  return new WE(e);
                }),
                (zE.prototype.parseInit = function () {}),
                (zE.prototype.setSequenceMode = function () {}),
                (zE.prototype.setManifestType = function () {}),
                (zE.prototype.parseMedia = function (e, t) {
                  for (
                    var r = null, i = [], n = (e = g((e = Xe(e).split(/\r?\n/)))).next();
                    !n.done;
                    n = e.next()
                  )
                    if ((n = n.value) && !/^\s+$/.test(n) && (n = qE.exec(n))) {
                      var a = XE.exec(n[1]);
                      ((n = new kr(
                        (a = 60 * parseInt(a[1], 10) + parseFloat(a[2].replace(",", "."))),
                        t.segmentEnd ? t.segmentEnd : a + 2,
                        n[2],
                      )),
                        r && ((r.endTime = a), i.push(r)),
                        (r = n));
                    }
                  return (r && i.push(r), i);
                }),
                j("shaka.text.LrcTextParser", zE),
                (zE.prototype.parseMedia = zE.prototype.parseMedia),
                (zE.prototype.setManifestType = zE.prototype.setManifestType),
                (zE.prototype.setSequenceMode = zE.prototype.setSequenceMode),
                (zE.prototype.parseInit = zE.prototype.parseInit));
              var qE = /^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,
                XE = /^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;
              function YE() {
                this.g = "UNKNOWN";
              }
              function QE(e, t, r, i, n, a, s, o, l, u, d, h, c, f) {
                var p = d;
                if (Jt(t)) {
                  if (!h) return null;
                  var m = { tagName: "span", children: [tr(t)], attributes: {}, parent: null };
                } else m = t;
                for (
                  var v = null, y = g(Ax), T = y.next();
                  !T.done && !(v = ax(m, "backgroundImage", n, "#", T.value)[0]);
                  T = y.next()
                );
                y = null;
                var b = /^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;
                if ((T = ur(m, Ax, "backgroundImage")) && b.test(T)) {
                  if ((y = parseInt(T.split(":").pop(), 10) - 1) >= f.length) return null;
                  y = f[y];
                } else
                  c &&
                    T &&
                    !T.startsWith("#") &&
                    ((b = new me(c)), (T = new me(T)), (T = b.resolve(T).toString()) && (y = T));
                if (
                  (("p" == t.tagName || v || y) && (h = !0),
                  (t = h),
                  (T = "default" == (m.attributes["xml:space"] || (l ? "default" : "preserve"))),
                  (l = []),
                  !(b = m.children.every(Jt)))
                )
                  for (var S = g(m.children), E = S.next(); !E.done; E = S.next())
                    (E = QE(e, E.value, r, i, n, a, s, o, T, u, m, h, c, f)) && l.push(E);
                if (
                  ((n = null != d),
                  (c = tr(m)),
                  (c = m.children.length && c && /\S/.test(c)),
                  !(
                    (S = m.attributes.begin || m.attributes.end || m.attributes.dur) ||
                    c ||
                    "br" == m.tagName ||
                    0 != l.length ||
                    (n && !T)
                  ))
                )
                  return null;
                for (c = (f = ox(m, i)).start, f = f.end; p && p.tagName && "tt" != p.tagName; )
                  ((c = (f = sx(p, i, c, f)).start), (f = f.end), (p = p.parent));
                if (
                  (null == c && (c = 0),
                  (c += r.periodStart),
                  (f = null == f ? 1 / 0 : f + r.periodStart),
                  "HLS" !== e.g && ((c = Math.max(c, r.segmentStart)), (f = Math.min(f, r.segmentEnd))),
                  !S && l.length > 0)
                )
                  for (c = 1 / 0, f = 0, i = (r = g(l)).next(); !i.done; i = r.next())
                    ((i = i.value), (c = Math.min(c, i.startTime)), (f = Math.max(f, i.endTime)));
                if ("br" == m.tagName) return (((e = new kr(c, f, "")).lineBreak = !0), e);
                if (
                  ((r = ""),
                  b && ((r = et(tr(m) || "")), T && (r = r.replace(/\s+/g, " "))),
                  ((r = new kr(c, f, r)).nestedCues = l),
                  h || (r.isContainer = !0),
                  u && (r.cellResolution = u),
                  (u = ax(m, "region", s, "")[0]),
                  m.attributes.region && u && u.attributes["xml:id"])
                ) {
                  var x = u.attributes["xml:id"];
                  r.region = o.filter(function (e) {
                    return e.id == x;
                  })[0];
                }
                return (
                  (o = u),
                  d && n && !m.attributes.region && !m.attributes.style && (o = ax(d, "region", s, "")[0]),
                  (function (e, t, r, i, n, a, s, o, l) {
                    if (
                      ("rtl" == tx(e, r, i, s, "direction", (o = o || l)) && (t.direction = "rtl"),
                      "tb" == (l = tx(e, r, i, s, "writingMode", o)) || "tblr" == l
                        ? (t.writingMode = "vertical-lr")
                        : "tbrl" == l
                          ? (t.writingMode = "vertical-rl")
                          : "rltb" == l || "rl" == l
                            ? (t.direction = "rtl")
                            : l && (t.direction = Br),
                      (l = tx(e, r, i, s, "textAlign", !0))
                        ? ((t.positionAlign = Ex.get(l)),
                          (t.lineAlign = Sx.get(l)),
                          (t.textAlign = Nr[l.toUpperCase()]))
                        : (t.textAlign = Or),
                      (l = tx(e, r, i, s, "displayAlign", !0)) && (t.displayAlign = Ur[l.toUpperCase()]),
                      (l = tx(e, r, i, s, "color", o)) && (t.color = ZE(l)),
                      (l = tx(e, r, i, s, "backgroundColor", o)) && (t.backgroundColor = ZE(l)),
                      (l = tx(e, r, i, s, "border", o)) && (t.border = l),
                      (l = tx(e, r, i, s, "fontFamily", o)))
                    )
                      switch (l) {
                        case "monospaceSerif":
                          t.fontFamily = "Courier New,Liberation Mono,Courier,monospace";
                          break;
                        case "proportionalSansSerif":
                          t.fontFamily = "Arial,Helvetica,Liberation Sans,sans-serif";
                          break;
                        case "sansSerif":
                          t.fontFamily = "sans-serif";
                          break;
                        case "monospaceSansSerif":
                          t.fontFamily = "Consolas,monospace";
                          break;
                        case "proportionalSerif":
                          t.fontFamily = "serif";
                          break;
                        default:
                          t.fontFamily = l
                            .split(",")
                            .filter(function (e) {
                              return "default" != e;
                            })
                            .join(",");
                      }
                    switch (
                      ((l = tx(e, r, i, s, "fontWeight", o)) && "bold" == l && (t.fontWeight = zr),
                      (l = tx(e, r, i, s, "wrapOption", o)),
                      (t.wrapLine = !l || "noWrap" != l),
                      (l = tx(e, r, i, s, "lineHeight", o)) && l.match(fx) && (t.lineHeight = l),
                      (l = tx(e, r, i, s, "fontSize", o)) && (l.match(fx) || l.match(cx)) && (t.fontSize = l),
                      (l = tx(e, r, i, s, "fontStyle", o)) && (t.fontStyle = Yr[l.toUpperCase()]),
                      n
                        ? ((a = n.attributes.imageType || n.attributes.imagetype),
                          (l = n.attributes.encoding),
                          (n = tr(n).trim()),
                          "PNG" == a &&
                            "Base64" == l &&
                            n &&
                            (t.backgroundImage = "data:image/png;base64," + n))
                        : a && (t.backgroundImage = a),
                      (n = tx(e, r, i, s, "textOutline", o)) &&
                        ((n = n.split(" "))[0].match(fx)
                          ? (t.textStrokeColor = t.color)
                          : ((t.textStrokeColor = ZE(n[0])), n.shift()),
                        n[0] && n[0].match(fx) ? (t.textStrokeWidth = n[0]) : (t.textStrokeColor = "")),
                      (n = tx(e, r, i, s, "letterSpacing", o)) && n.match(fx) && (t.letterSpacing = n),
                      (n = tx(e, r, i, s, "linePadding", o)) && n.match(fx) && (t.linePadding = n),
                      (n = tx(e, r, i, s, "opacity", o)) && (t.opacity = parseFloat(n)),
                      (n = rx(e, i, s, "textDecoration")) && ex(t, n),
                      (n = ix(e, r, s, "textDecoration")) && ex(t, n),
                      (n = tx(e, r, i, s, "textCombine", o)) && (t.textCombineUpright = n),
                      tx(e, r, i, s, "ruby", o))
                    ) {
                      case "container":
                        t.rubyTag = "ruby";
                        break;
                      case "text":
                        t.rubyTag = "rt";
                    }
                  })(e, r, m, o, v, y, a, t, 0 == l.length),
                  r
                );
              }
              function JE(e, t, r, i) {
                var n = new Ot(),
                  a = t.attributes["xml:id"];
                if (!a) return null;
                ((n.id = a),
                  (a = null),
                  i && (a = hx.exec(i) || px.exec(i)),
                  (i = a ? Number(a[1]) : null),
                  (a = a ? Number(a[2]) : null));
                var s,
                  o = rx(e, t, r, "extent");
                if (o) {
                  var l = (s = hx.exec(o)) || px.exec(o);
                  null != l &&
                    ((n.width = Number(l[1])),
                    (n.height = Number(l[2])),
                    s ||
                      (null != i && (n.width = (100 * n.width) / i),
                      null != a && (n.height = (100 * n.height) / a)),
                    (n.widthUnits = s || null != i ? Nt : 0),
                    (n.heightUnits = s || null != a ? Nt : 0));
                }
                return (
                  (e = rx(e, t, r, "origin")) &&
                    null != (l = (s = hx.exec(e)) || px.exec(e)) &&
                    ((n.viewportAnchorX = Number(l[1])),
                    (n.viewportAnchorY = Number(l[2])),
                    s
                      ? o ||
                        ((n.width = 100 - n.viewportAnchorX),
                        (n.widthUnits = Nt),
                        (n.height = 100 - n.viewportAnchorY),
                        (n.heightUnits = Nt))
                      : (null != a && (n.viewportAnchorY = (100 * n.viewportAnchorY) / a),
                        null != i && (n.viewportAnchorX = (100 * n.viewportAnchorX) / i)),
                    (n.viewportAnchorUnits = s || null != i ? Nt : 0)),
                  n
                );
              }
              function ZE(e) {
                var t = e.match(/rgba\(([^)]+)\)/);
                return t && 4 == (t = t[1].split(",")).length
                  ? ((t[3] = String(Number(t[3]) / 255)), "rgba(" + t.join(",") + ")")
                  : e;
              }
              function ex(e, t) {
                for (var r = (t = g(t.split(" "))).next(); !r.done; r = t.next())
                  switch (r.value) {
                    case "underline":
                      e.textDecoration.includes(Qr) || e.textDecoration.push(Qr);
                      break;
                    case "noUnderline":
                      e.textDecoration.includes(Qr) && J(e.textDecoration, Qr);
                      break;
                    case "lineThrough":
                      e.textDecoration.includes("lineThrough") || e.textDecoration.push("lineThrough");
                      break;
                    case "noLineThrough":
                      e.textDecoration.includes("lineThrough") && J(e.textDecoration, "lineThrough");
                      break;
                    case "overline":
                      e.textDecoration.includes("overline") || e.textDecoration.push("overline");
                      break;
                    case "noOverline":
                      e.textDecoration.includes("overline") && J(e.textDecoration, "overline");
                  }
              }
              function tx(e, t, r, i, n, a) {
                return ((a = void 0 === a || a), (t = ix(e, t, i, n)) ? t : a ? rx(e, r, i, n) : null);
              }
              function rx(e, t, r, i) {
                if (!t) return null;
                var n = ur(t, wx, i);
                return n || nx(e, t, r, i);
              }
              function ix(e, t, r, i) {
                var n = ur(t, wx, i);
                return n || nx(e, t, r, i);
              }
              function nx(e, t, r, i) {
                t = ax(t, "style", r, "");
                for (var n = null, a = 0; a < t.length; a++) {
                  var s = or(t[a], "urn:ebu:tt:style", i);
                  (s || (s = ur(t[a], wx, i)), s || (s = ix(e, t[a], r, i)), s && (n = s));
                }
                return n;
              }
              function ax(e, t, r, i, n) {
                var a = [];
                if (!e || r.length < 1) return a;
                var s = e;
                for (e = null; !e && !(e = n ? or(s, n, t) : s.attributes[t]) && (s = s.parent); );
                if ((t = e))
                  for (n = (t = g(t.split(" "))).next(); !n.done; n = t.next())
                    for (n = n.value, s = (e = g(r)).next(); !s.done; s = e.next())
                      if (i + (s = s.value).attributes["xml:id"] == n) {
                        a.push(s);
                        break;
                      }
                return a;
              }
              function sx(e, t, r, i) {
                return (
                  (e = ox(e, t)),
                  null == r ? (r = e.start) : null != e.start && (r += e.start),
                  null == i ? (i = e.end) : null != e.start && (i += e.start),
                  { start: r, end: i }
                );
              }
              function ox(e, t) {
                var r = lx(e.attributes.begin, t),
                  i = lx(e.attributes.end, t);
                return (
                  (e = lx(e.attributes.dur, t)),
                  null == i && null != e && (i = r + e),
                  { start: r, end: i }
                );
              }
              function lx(e, t) {
                var r = null;
                if (gx.test(e)) {
                  ((e = gx.exec(e)), (r = Number(e[1])));
                  var i = Number(e[2]),
                    n = Number(e[3]),
                    a = Number(e[4]);
                  r = (n += (a += (Number(e[5]) || 0) / t.h) / t.frameRate) + 60 * i + 3600 * r;
                } else if (mx.test(e)) r = ux(mx, e);
                else if (vx.test(e)) r = ux(vx, e);
                else if (yx.test(e)) ((e = yx.exec(e)), (r = Number(e[1]) / t.frameRate));
                else if (Tx.test(e)) ((e = Tx.exec(e)), (r = Number(e[1]) / t.g));
                else if (bx.test(e)) r = ux(bx, e);
                else if (e) throw new ze(2, 2, 2001, "Could not parse cue time range in TTML");
                return r;
              }
              function ux(e, t) {
                return null == (e = e.exec(t)) || "" == e[0]
                  ? null
                  : (Number(e[4]) || 0) / 1e3 +
                      (Number(e[3]) || 0) +
                      60 * (Number(e[2]) || 0) +
                      3600 * (Number(e[1]) || 0);
              }
              function dx(e, t, r, i) {
                ((this.frameRate = Number(e) || 30),
                  (this.h = Number(t) || 1),
                  (this.g = Number(i)),
                  0 == this.g && (this.g = e ? this.frameRate * this.h : 1),
                  r && (e = /^(\d+) (\d+)$/g.exec(r)) && (this.frameRate *= Number(e[1]) / Number(e[2])));
              }
              (bi("application/x-subtitle-lrc", function () {
                return new zE();
              }),
                (YE.prototype.parseInit = function () {}),
                (YE.prototype.setSequenceMode = function () {}),
                (YE.prototype.setManifestType = function (e) {
                  this.g = e;
                }),
                (YE.prototype.parseMedia = function (e, t, r, i) {
                  var n = Xe(e);
                  if (((e = []), "" == n)) return e;
                  var a = Yt(n, "tt", !0);
                  if (!a) throw new ze(2, 2, 2005, "Failed to parse TTML.");
                  if (!(n = ir(a, "body")[0])) return [];
                  var s = ur(a, xx, "frameRate"),
                    o = ur(a, xx, "subFrameRate"),
                    l = ur(a, xx, "frameRateMultiplier"),
                    u = ur(a, xx, "tickRate"),
                    d = ur(a, xx, "cellResolution"),
                    h = a.attributes["xml:space"] || "default",
                    c = ur(a, wx, "extent");
                  if ("default" != h && "preserve" != h)
                    throw new ze(2, 2, 2005, "Invalid xml:space value: " + h);
                  ((h = "default" == h),
                    (s = new dx(s, o, l, u)),
                    (d = (function (e) {
                      return e && (e = /^(\d+) (\d+)$/.exec(e))
                        ? { columns: parseInt(e[1], 10), rows: parseInt(e[2], 10) }
                        : null;
                    })(d)),
                    (o = ((o = ir(a, "metadata")[0]) ? o.children : []).filter(function (e) {
                      return "\n" != e;
                    })),
                    (l = ir(a, "style")),
                    (u = []));
                  for (var f = g((a = ir(a, "region"))), p = f.next(); !p.done; p = f.next())
                    (p = JE(this, p.value, l, c)) && u.push(p);
                  if (er(n, "p").length) throw new ze(2, 2, 2001, "<p> can only be inside <div> in TTML");
                  for (f = (c = g(er(n, "div"))).next(); !f.done; f = c.next())
                    if (er(f.value, "span").length)
                      throw new ze(2, 2, 2001, "<span> can only be inside <p> in TTML");
                  return (
                    (t = QE(this, n, t, s, o, l, a, u, h, d, null, !1, r, i)) &&
                      (t.backgroundColor || (t.backgroundColor = "transparent"), e.push(t)),
                    e
                  );
                }),
                j("shaka.text.TtmlTextParser", YE),
                (YE.prototype.parseMedia = YE.prototype.parseMedia),
                (YE.prototype.setManifestType = YE.prototype.setManifestType),
                (YE.prototype.setSequenceMode = YE.prototype.setSequenceMode),
                (YE.prototype.parseInit = YE.prototype.parseInit));
              var hx = /^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,
                cx = /^(\d{1,4}(?:\.\d+)?|100)%$/,
                fx = /^(\d+px|\d+em|\d*\.?\d+c)$/,
                px = /^(\d+)px (\d+)px$/,
                gx = /^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,
                mx = /^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,
                vx = /^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,
                yx = /^(\d*(?:\.\d*)?)f$/,
                Tx = /^(\d*(?:\.\d*)?)t$/,
                bx = RegExp(
                  "^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$",
                ),
                Sx = new Map()
                  .set("left", Gr)
                  .set("center", "center")
                  .set("right", "end")
                  .set("start", Gr)
                  .set("end", "end"),
                Ex = new Map().set("left", "line-left").set("center", "center").set("right", "line-right"),
                xx = ["http://www.w3.org/ns/ttml#parameter", "http://www.w3.org/2006/10/ttaf1#parameter"],
                wx = ["http://www.w3.org/ns/ttml#styling", "http://www.w3.org/2006/10/ttaf1#styling"],
                Ax = [
                  "http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",
                  "http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt",
                ];
              function Ix() {
                this.g = new YE();
              }
              function kx() {
                this.g = "UNKNOWN";
              }
              function Rx(e, t, r) {
                var i;
                (i = /^align:(start|middle|center|end|left|right)$/.exec(t))
                  ? ((t = i[1]), (e.textAlign = "middle" == t ? Or : Nr[t.toUpperCase()]))
                  : (i = /^vertical:(lr|rl)$/.exec(t))
                    ? (e.writingMode = "lr" == i[1] ? "vertical-lr" : "vertical-rl")
                    : (i = /^size:([\d.]+)%$/.exec(t))
                      ? (e.size = Number(i[1]))
                      : (i =
                            /^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(
                              t,
                            ))
                        ? ((e.position = Number(i[1])),
                          i[2] &&
                            ((t = i[2]),
                            (e.positionAlign =
                              "line-left" == t || "start" == t
                                ? "line-left"
                                : "line-right" == t || "end" == t
                                  ? "line-right"
                                  : "center" == t || "middle" == t
                                    ? "center"
                                    : Pr)))
                        : (i = /^region:(.*)$/.exec(t))
                          ? (t = (function (e, t) {
                              return (
                                (e = e.filter(function (e) {
                                  return e.id == t;
                                })),
                                e.length ? e[0] : null
                              );
                            })(r, i[1])) && (e.region = t)
                          : (r = /^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))
                            ? ((e.lineInterpretation = 1),
                              (e.line = Number(r[1])),
                              r[2] && (e.lineAlign = Vr[r[2].toUpperCase()]))
                            : (r = /^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)) &&
                              ((e.lineInterpretation = jr),
                              (e.line = Number(r[1])),
                              r[2] && (e.lineAlign = Vr[r[2].toUpperCase()]));
              }
              function Cx() {
                this.g = null;
              }
              function Lx(e, t, r) {
                var i, n, a;
                return (
                  new aa()
                    .box(
                      "payl",
                      da(function (e) {
                        i = Xe(e);
                      }, !1),
                    )
                    .box(
                      "iden",
                      da(function (e) {
                        n = Xe(e);
                      }, !1),
                    )
                    .box(
                      "sttg",
                      da(function (e) {
                        a = Xe(e);
                      }, !1),
                    )
                    .parse(e),
                  i
                    ? (function (e, t, r, i, n) {
                        if ((Lr((e = new kr(i, n, e))), t && (e.id = t), r))
                          for (t = new Ut(r), r = jt(t); r; ) (Rx(e, r, []), Bt(t), (r = jt(t)));
                        return e;
                      })(i, n, a, t, r)
                    : null
                );
              }
              function Mx() {}
              function Dx() {
                this.g = new kx();
              }
              function _x() {}
              function Px(e, t) {
                var r = t.Fontname;
                if (
                  (r && (e.fontFamily = r),
                  (r = t.Fontsize) && (e.fontSize = r + "px"),
                  (r = t.PrimaryColour) && (r = Ox(r)) && (e.color = r),
                  (r = t.BackColour) && (r = Ox(r)) && (e.backgroundColor = r),
                  t.Bold && (e.fontWeight = zr),
                  t.Italic && (e.fontStyle = Xr),
                  t.Underline && e.textDecoration.push(Qr),
                  (r = t.Spacing) && (e.letterSpacing = r + "px"),
                  (r = t.Alignment))
                )
                  switch (parseInt(r, 10)) {
                    case 1:
                      ((e.displayAlign = Fr), (e.textAlign = "start"));
                      break;
                    case 2:
                      ((e.displayAlign = Fr), (e.textAlign = Or));
                      break;
                    case 3:
                      ((e.displayAlign = Fr), (e.textAlign = "end"));
                      break;
                    case 5:
                      ((e.displayAlign = "before"), (e.textAlign = "start"));
                      break;
                    case 6:
                      ((e.displayAlign = "before"), (e.textAlign = Or));
                      break;
                    case 7:
                      ((e.displayAlign = "before"), (e.textAlign = "end"));
                      break;
                    case 9:
                      ((e.displayAlign = "center"), (e.textAlign = "start"));
                      break;
                    case 10:
                      ((e.displayAlign = "center"), (e.textAlign = Or));
                      break;
                    case 11:
                      ((e.displayAlign = "center"), (e.textAlign = "end"));
                  }
                (t = t.AlphaLevel) && (e.opacity = parseFloat(t));
              }
              function Ox(e) {
                return (e = parseInt(e.replace("&H", ""), 16)) >= 0
                  ? "rgba(" +
                      (255 & e) +
                      "," +
                      ((e >> 8) & 255) +
                      "," +
                      ((e >> 16) & 255) +
                      "," +
                      (((e >> 24) & 255) ^ 255) / 255 +
                      ")"
                  : null;
              }
              function Nx(e) {
                return (
                  3600 * ((e = $x.exec(e))[1] ? parseInt(e[1].replace(":", ""), 10) : 0) +
                  60 * parseInt(e[2], 10) +
                  parseFloat(e[3])
                );
              }
              (bi("application/ttml+xml", function () {
                return new YE();
              }),
                (Ix.prototype.parseInit = function (e) {
                  var t = !1;
                  if (
                    (new aa()
                      .box("moov", sa)
                      .box("trak", sa)
                      .box("mdia", sa)
                      .box("minf", sa)
                      .box("stbl", sa)
                      .S("stsd", oa)
                      .box("stpp", function (e) {
                        ((t = !0), e.parser.stop());
                      })
                      .parse(e),
                    !t)
                  )
                    throw new ze(2, 2, 2007);
                }),
                (Ix.prototype.setSequenceMode = function (e) {
                  this.g.setSequenceMode(e);
                }),
                (Ix.prototype.setManifestType = function (e) {
                  this.g.setManifestType(e);
                }),
                (Ix.prototype.parseMedia = function (e, t, r) {
                  var i = [],
                    n = null,
                    a = [],
                    s = new Map(),
                    o = [];
                  if (
                    (new aa()
                      .box("moof", sa)
                      .box("traf", sa)
                      .S("tfhd", function (e) {
                        n = ts(e.reader, e.flags).Xd;
                      })
                      .S("trun", function (e) {
                        for (
                          var t = (e = g((e = ns(e.reader, e.version, e.flags)).mh)).next();
                          !t.done;
                          t = e.next()
                        )
                          o.push(t.value.sampleSize || n || 0);
                      })
                      .S("subs", function (e) {
                        for (var t = e.reader, r = t.U(), i = -1, n = 0; n < r; n++) {
                          var a = t.U();
                          ((i += a), (a = t.Ca()));
                          for (var o = [], l = 0; l < a; l++)
                            (1 == e.version ? o.push(t.U()) : o.push(t.Ca()), t.Y(), t.Y(), t.U());
                          s.set(i, o);
                        }
                      })
                      .box(
                        "mdat",
                        da(function (e) {
                          a.push(e);
                        }, !1),
                      )
                      .parse(e, !1),
                    0 == a.length)
                  )
                    throw new ze(2, 2, 2007);
                  for (var l = lt.apply(rt, m(a)), u = 0, d = 0; d < o.length; d++) {
                    var h = Oe(l, u, o[d]);
                    u += o[d];
                    var c = s.get(d);
                    if (c && c.length) {
                      h = Oe(h, 0, c[0]);
                      for (var f = [], p = c[0], v = 1; v < c.length; v++) {
                        var y = Oe(e, p, c[v]);
                        ((y = it(y)), f.push("data:image/png;base64," + y), (p += c[v]));
                      }
                      i = i.concat(this.g.parseMedia(h, t, r, f));
                    } else i = i.concat(this.g.parseMedia(h, t, r, []));
                  }
                  return i;
                }),
                j("shaka.text.Mp4TtmlParser", Ix),
                (Ix.prototype.parseMedia = Ix.prototype.parseMedia),
                (Ix.prototype.setManifestType = Ix.prototype.setManifestType),
                (Ix.prototype.setSequenceMode = Ix.prototype.setSequenceMode),
                (Ix.prototype.parseInit = Ix.prototype.parseInit),
                bi('application/mp4; codecs="stpp"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.im1i"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.im1t"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.im2i"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.im2t"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.etd1"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.etd1|im1t"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.ttml.im1t|etd1"', function () {
                  return new Ix();
                }),
                bi('application/mp4; codecs="stpp.TTML.im1t"', function () {
                  return new Ix();
                }),
                (kx.prototype.parseInit = function () {}),
                (kx.prototype.setSequenceMode = function () {}),
                (kx.prototype.setManifestType = function (e) {
                  this.g = e;
                }),
                (kx.prototype.parseMedia = function (e, t) {
                  var r = (e = (e = Xe(e)).replace(/\r\n|\r(?=[^\n]|$)/gm, "\n")).split(/\n{2,}/m);
                  if (!/^WEBVTT($|[ \t\n])/m.test(r[0])) throw new ze(2, 2, 2e3);
                  if (((e = t.vttOffset), "HLS" == this.g && r[0].includes("X-TIMESTAMP-MAP"))) {
                    var i = r[0];
                    if (
                      ((e = i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m)),
                      (i = i.match(/MPEGTS:(\d+)/m)),
                      !e || !i)
                    )
                      throw new ze(2, 2, 2e3);
                    if (null == (e = Vt(e[1]))) throw new ze(2, 2, 2e3);
                    i = Number(i[1]);
                    for (var n = t.segmentStart - t.periodStart; n >= 95443.7176888889; )
                      ((n -= 95443.7176888889), (i += 8589934592));
                    e = t.periodStart + i / 9e4 - e;
                  }
                  for (t = [], n = (i = g(r[0].split("\n"))).next(); !n.done; n = i.next())
                    if (((n = n.value), /^Region:/.test(n))) {
                      n = new Ut(n);
                      var a = new Ot();
                      (jt(n), Bt(n));
                      for (var s = jt(n); s; ) {
                        var o = a,
                          l = s;
                        ((s = /^id=(.*)$/.exec(l))
                          ? (o.id = s[1])
                          : (s = /^width=(\d{1,2}|100)%$/.exec(l))
                            ? (o.width = Number(s[1]))
                            : (s = /^lines=(\d+)$/.exec(l))
                              ? ((o.height = Number(s[1])), (o.heightUnits = 2))
                              : (s = /^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))
                                ? ((o.regionAnchorX = Number(s[1])), (o.regionAnchorY = Number(s[2])))
                                : (s = /^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))
                                  ? ((o.viewportAnchorX = Number(s[1])), (o.viewportAnchorY = Number(s[2])))
                                  : /^scroll=up$/.exec(l) && (o.scroll = "up"),
                          Bt(n),
                          (s = jt(n)));
                      }
                      t.push(a);
                    }
                  for (Mr((i = new Map())), n = [], a = (r = g(r.slice(1))).next(); !a.done; a = r.next()) {
                    if (
                      (1 != (a = a.value.split("\n")).length || a[0]) &&
                      !/^NOTE($|[ \t])/.test(a[0]) &&
                      "STYLE" == a[0]
                    ) {
                      for (o = [], s = -1, l = 1; l < a.length; l++)
                        (a[l].includes("::cue") && (o.push([]), (s = o.length - 1)),
                          -1 != s && (o[s].push(a[l]), a[l].includes("}") && (s = -1)));
                      for (s = (o = g(o)).next(); !s.done; s = o.next()) {
                        var u = s.value;
                        ((s = "global"),
                          (l = u[0].match(/\((.*)\)/)) && (s = l.pop()),
                          (l = u.slice(1, -1)),
                          u[0].includes("}") && (u = /\{(.*?)\}/.exec(u[0])) && (l = u[1].split(";")),
                          (u = i.get(s)) || (u = new kr(0, 0, "")));
                        for (var d = !1, h = 0; h < l.length; h++) {
                          var c = /^\s*([^:]+):\s*(.*)/.exec(l[h]);
                          if (c) {
                            var f = c[2].trim().replace(";", "");
                            switch (c[1].trim()) {
                              case "background-color":
                              case "background":
                                ((d = !0), (u.backgroundColor = f));
                                break;
                              case "color":
                                ((d = !0), (u.color = f));
                                break;
                              case "font-family":
                                ((d = !0), (u.fontFamily = f));
                                break;
                              case "font-size":
                                ((d = !0), (u.fontSize = f));
                                break;
                              case "font-weight":
                                (parseInt(f, 10) >= 700 || "bold" == f) && ((d = !0), (u.fontWeight = zr));
                                break;
                              case "font-style":
                                switch (f) {
                                  case "normal":
                                    ((d = !0), (u.fontStyle = qr));
                                    break;
                                  case "italic":
                                    ((d = !0), (u.fontStyle = Xr));
                                    break;
                                  case "oblique":
                                    ((d = !0), (u.fontStyle = "oblique"));
                                }
                                break;
                              case "opacity":
                                ((d = !0), (u.opacity = parseFloat(f)));
                                break;
                              case "text-combine-upright":
                                ((d = !0), (u.textCombineUpright = f));
                                break;
                              case "text-shadow":
                                ((d = !0), (u.textShadow = f));
                                break;
                              case "white-space":
                                ((d = !0), (u.wrapLine = "noWrap" != f));
                            }
                          }
                        }
                        d && i.set(s, u);
                      }
                    }
                    if (
                      ((d = e),
                      (1 == (u = a).length && !u[0]) ||
                        /^NOTE($|[ \t])/.test(u[0]) ||
                        "STYLE" == u[0] ||
                        "REGION" == u[0])
                    )
                      a = null;
                    else if (
                      ((a = null),
                      u[0].includes("--\x3e") || ((a = u[0]), u.splice(0, 1)),
                      (s = Gt((o = new Ut(u[0])))),
                      (h = $t(o, /[ \t]+--\x3e[ \t]+/g)),
                      (l = Gt(o)),
                      null == s || null == h || null == l)
                    )
                      (z("Failed to parse VTT time code. Cue skipped:", a, u), (a = null));
                    else {
                      for (
                        l += d,
                          (s += d) < 0 && (s = 0),
                          d = u.slice(1).join("\n").trim(),
                          i.has("global")
                            ? (((u = i.get("global").clone()).startTime = s),
                              (u.endTime = l),
                              (u.payload = d))
                            : (u = new kr(s, l, d)),
                          Bt(o),
                          s = jt(o);
                        s;
                      )
                        (Rx(u, s, t), Bt(o), (s = jt(o)));
                      (Lr(u, i), null != a && (u.id = a), (a = u));
                    }
                    a && n.push(a);
                  }
                  return n;
                }),
                j("shaka.text.VttTextParser", kx),
                (kx.prototype.parseMedia = kx.prototype.parseMedia),
                (kx.prototype.setManifestType = kx.prototype.setManifestType),
                (kx.prototype.setSequenceMode = kx.prototype.setSequenceMode),
                (kx.prototype.parseInit = kx.prototype.parseInit),
                bi("text/vtt", function () {
                  return new kx();
                }),
                bi('text/vtt; codecs="vtt"', function () {
                  return new kx();
                }),
                bi('text/vtt; codecs="wvtt"', function () {
                  return new kx();
                }),
                (Cx.prototype.parseInit = function (e) {
                  var t = this,
                    r = !1;
                  if (
                    (new aa()
                      .box("moov", sa)
                      .box("trak", sa)
                      .box("mdia", sa)
                      .S("mdhd", function (e) {
                        ((e = is(e.reader, e.version)), (t.g = e.timescale));
                      })
                      .box("minf", sa)
                      .box("stbl", sa)
                      .S("stsd", oa)
                      .box("wvtt", function () {
                        r = !0;
                      })
                      .parse(e),
                    !this.g)
                  )
                    throw new ze(2, 2, 2008);
                  if (!r) throw new ze(2, 2, 2008);
                }),
                (Cx.prototype.setSequenceMode = function () {}),
                (Cx.prototype.setManifestType = function () {}),
                (Cx.prototype.parseMedia = function (e, t) {
                  if (!e.length) return [];
                  if (!this.g) throw new ze(2, 2, 2008);
                  var r,
                    i = 0,
                    n = [],
                    a = [],
                    s = !1,
                    o = !1,
                    l = !1,
                    u = null;
                  if (
                    (new aa()
                      .box("moof", sa)
                      .box("traf", sa)
                      .S("tfdt", function (e) {
                        ((s = !0), (i = rs(e.reader, e.version).baseMediaDecodeTime));
                      })
                      .S("tfhd", function (e) {
                        u = ts(e.reader, e.flags).Wd;
                      })
                      .S("trun", function (e) {
                        ((o = !0), (n = ns(e.reader, e.version, e.flags).mh));
                      })
                      .box(
                        "mdat",
                        da(function (e) {
                          ((l = !0), (r = e));
                        }, !1),
                      )
                      .parse(e, !1),
                    !l && !s && !o)
                  )
                    throw new ze(2, 2, 2008);
                  e = i;
                  for (var d = new ra(r, 0), h = g(n), c = h.next(); !c.done; c = h.next()) {
                    var f = (c = c.value).nh || u,
                      p = c.Gf ? i + c.Gf : e;
                    e = p + (f || 0);
                    var m = 0;
                    do {
                      var v = d.U();
                      m += v;
                      var y = null;
                      ("vttc" == ca(d.U()) ? v > 8 && (y = d.Tb(v - 8, !1)) : d.skip(v - 8),
                        f &&
                          y &&
                          ((v = Lx(y, t.periodStart + p / this.g, t.periodStart + e / this.g)), a.push(v)));
                    } while (c.sampleSize && m < c.sampleSize);
                  }
                  return a.filter(Mi);
                }),
                j("shaka.text.Mp4VttParser", Cx),
                (Cx.prototype.parseMedia = Cx.prototype.parseMedia),
                (Cx.prototype.setManifestType = Cx.prototype.setManifestType),
                (Cx.prototype.setSequenceMode = Cx.prototype.setSequenceMode),
                (Cx.prototype.parseInit = Cx.prototype.parseInit),
                bi('application/mp4; codecs="wvtt"', function () {
                  return new Cx();
                }),
                (Mx.prototype.parseInit = function () {}),
                (Mx.prototype.setSequenceMode = function () {}),
                (Mx.prototype.setManifestType = function () {}),
                (Mx.prototype.parseMedia = function (e) {
                  var t = Xe(e).replace(/\r+/g, "");
                  if (((e = []), "" == (t = t.trim()))) return e;
                  for (var r = (t = g(t.split("\n\n"))).next(); !r.done; r = t.next()) {
                    var i = new Ut((r = r.value.split("\n"))[0]),
                      n = Gt(i),
                      a = $t(i, /,/g);
                    if (((i = Gt(i)), null == n || null == a || null == i))
                      throw new ze(2, 2, 2001, "Could not parse cue time range in SubViewer");
                    e.push(new kr(n, i, r.slice(1).join("\n").trim()));
                  }
                  return e;
                }),
                j("shaka.text.SbvTextParser", Mx),
                (Mx.prototype.parseMedia = Mx.prototype.parseMedia),
                (Mx.prototype.setManifestType = Mx.prototype.setManifestType),
                (Mx.prototype.setSequenceMode = Mx.prototype.setSequenceMode),
                (Mx.prototype.parseInit = Mx.prototype.parseInit),
                bi("text/x-subviewer", function () {
                  return new Mx();
                }),
                (Dx.prototype.parseInit = function () {}),
                (Dx.prototype.setSequenceMode = function () {}),
                (Dx.prototype.setManifestType = function () {}),
                (Dx.prototype.parseMedia = function (e, t, r) {
                  var i = Xe(e);
                  if (((e = "WEBVTT\n\n"), "" != i))
                    for (
                      var n = (i = g((i = (i = i.replace(/\r+/g, "")).trim()).split("\n\n"))).next();
                      !n.done;
                      n = i.next()
                    )
                      ((n = n.value.split(/\n/))[0].match(/\d+/) && n.shift(),
                        (n[0] = n[0].replace(/,/g, ".")),
                        (e +=
                          n
                            .join("\n")
                            .replace(/{b}/g, "<b>")
                            .replace(/{\/b}/g, "</b>")
                            .replace(/{i}/g, "<i>")
                            .replace(/{\/i}/g, "</i>")
                            .replace(/{u}/g, "<u>")
                            .replace(/{\/u}/g, "</u>") + "\n\n"));
                  return ((e = Oe(Je(e))), this.g.parseMedia(e, t, r, []));
                }),
                j("shaka.text.SrtTextParser", Dx),
                (Dx.prototype.parseMedia = Dx.prototype.parseMedia),
                (Dx.prototype.setManifestType = Dx.prototype.setManifestType),
                (Dx.prototype.setSequenceMode = Dx.prototype.setSequenceMode),
                (Dx.prototype.parseInit = Dx.prototype.parseInit),
                bi("text/srt", function () {
                  return new Dx();
                }),
                (_x.prototype.parseInit = function () {}),
                (_x.prototype.setSequenceMode = function () {}),
                (_x.prototype.setManifestType = function () {}),
                (_x.prototype.parseMedia = function (e) {
                  var t = "",
                    r = "",
                    i = null,
                    n = null;
                  for (n = (e = g((n = Xe(e).split(/\r?\n\s*\r?\n/)))).next(); !n.done; n = e.next()) {
                    var a = n.value;
                    ((n = a),
                      (a = Fx.exec(a)) && ((i = a[1]), (n = a[2])),
                      "V4 Styles" == i || "V4+ Styles" == i
                        ? ((t = n), (t = r ? t + "\n" + n : n))
                        : "Events" == i && (r = r ? r + "\n" + n : n));
                  }
                  for (i = [], n = null, e = (t = g(t.split(/\r?\n/))).next(); !e.done; e = t.next())
                    if (((e = e.value), !/^\s*;/.test(e) && (a = Ux.exec(e))))
                      if (((e = a[1].trim()), (a = a[2].trim()), "Format" == e)) n = a.split(Bx);
                      else if ("Style" == e) {
                        ((e = a.split(Bx)), (a = {}));
                        for (var s = 0; s < n.length && s < e.length; s++) a[n[s]] = e[s];
                        i.push(a);
                      }
                  for (
                    n = [], t = null, a = (r = g(r.split(/\r?\n/))).next(), e = {};
                    !a.done;
                    e = { aj: void 0 }, a = r.next()
                  )
                    if (((a = a.value), !/^\s*;/.test(a) && (s = Ux.exec(a))))
                      if (((a = s[1].trim()), (s = s[2].trim()), "Format" == a)) t = s.split(Bx);
                      else if ("Dialogue" == a) {
                        ((s = s.split(Bx)), (a = {}));
                        for (var o = 0; o < t.length && o < s.length; o++) a[t[o]] = s[o];
                        ((s = new kr(
                          (o = Nx(a.Start)),
                          Nx(a.End),
                          s
                            .slice(t.length - 1)
                            .join(",")
                            .replace(/\\N/g, "\n")
                            .replace(/\{[^}]+\}/g, ""),
                        )),
                          (e.aj = a.Style),
                          (e = i.find(
                            (function (e) {
                              return function (t) {
                                return t.Name == e.aj;
                              };
                            })(e),
                          )) && Px(s, e),
                          n.push(s));
                      }
                  return n;
                }),
                j("shaka.text.SsaTextParser", _x),
                (_x.prototype.parseMedia = _x.prototype.parseMedia),
                (_x.prototype.setManifestType = _x.prototype.setManifestType),
                (_x.prototype.setSequenceMode = _x.prototype.setSequenceMode),
                (_x.prototype.parseInit = _x.prototype.parseInit));
              var Fx = /^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,
                Ux = /^\s*([^:]+):\s*(.*)/,
                Bx = /\s*,\s*/,
                $x = /^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;
              function jx(e, t) {
                var r = 1 & e[t + 1] ? 7 : 9;
                return t + r <= e.length &&
                  (e = (((3 & e[t + 3]) << 11) | (e[t + 4] << 3) | ((224 & e[t + 5]) >>> 5)) - r) > 0
                  ? { ee: r, ra: e }
                  : null;
              }
              function Gx(e, t) {
                var r = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350],
                  i = (60 & e[t + 2]) >>> 2;
                if (i > r.length - 1) return null;
                var n = ((192 & e[t + 2]) >>> 6) + 1,
                  a = (1 & e[t + 2]) << 2;
                return (
                  (a |= (192 & e[t + 3]) >>> 6),
                  { sampleRate: r[i], channelCount: a, codec: "mp4a.40." + n }
                );
              }
              function Vx(e, t) {
                if (t + 1 < e.length && 255 === e[t] && 240 == (246 & e[t + 1])) {
                  var r = 1 & e[t + 1] ? 7 : 9;
                  if (t + r >= e.length) return !1;
                  var i = ((3 & e[t + 3]) << 11) | (e[t + 4] << 3) | ((224 & e[t + 5]) >>> 5);
                  return (
                    !(i <= r) &&
                    ((t += i) === e.length || (t + 1 < e.length && 255 === e[t] && 240 == (246 & e[t + 1])))
                  );
                }
                return !1;
              }
              function Hx(e) {
                ((this.j = e), (this.h = 0), (this.g = new Map()), (this.i = null));
              }
              function Kx(e, t) {
                if (t + 8 > e.length || 11 !== e[t] || 119 !== e[t + 1]) return null;
                var r = e[t + 4] >> 6;
                if (r >= 3) return null;
                var i = 63 & e[t + 4],
                  n =
                    2 *
                    [
                      64, 69, 96, 64, 70, 96, 80, 87, 120, 80, 88, 120, 96, 104, 144, 96, 105, 144, 112, 121,
                      168, 112, 122, 168, 128, 139, 192, 128, 140, 192, 160, 174, 240, 160, 175, 240, 192,
                      208, 288, 192, 209, 288, 224, 243, 336, 224, 244, 336, 256, 278, 384, 256, 279, 384,
                      320, 348, 480, 320, 349, 480, 384, 417, 576, 384, 418, 576, 448, 487, 672, 448, 488,
                      672, 512, 557, 768, 512, 558, 768, 640, 696, 960, 640, 697, 960, 768, 835, 1152, 768,
                      836, 1152, 896, 975, 1344, 896, 976, 1344, 1024, 1114, 1536, 1024, 1115, 1536, 1152,
                      1253, 1728, 1152, 1254, 1728, 1280, 1393, 1920, 1280, 1394, 1920,
                    ][3 * i + r];
                if (t + n > e.length) return null;
                var a = e[t + 6] >> 5,
                  s = 0;
                (2 === a ? (s += 2) : (1 & a && 1 !== a && (s += 2), 4 & a && (s += 2)),
                  (s = (((e[t + 6] << 8) | e[t + 7]) >> (12 - s)) & 1));
                var o = 7 & e[t + 5];
                return (
                  (e = new Uint8Array([
                    (r << 6) | ((e[t + 5] >> 3) << 1) | (o >> 2),
                    ((3 & o) << 6) | (a << 3) | (s << 2) | (i >> 4),
                    (i << 4) & 224,
                  ])),
                  {
                    sampleRate: [48e3, 44100, 32e3][r],
                    channelCount: [2, 1, 2, 3, 3, 4, 4, 5][a] + s,
                    Ga: e,
                    ra: n,
                  }
                );
              }
              function Wx(e, t) {
                if (11 === e[t] && 119 === e[t + 1]) {
                  var r,
                    i,
                    n = 0,
                    a = 5;
                  for (t += a; a > 0; ) {
                    i = e[t];
                    var s = Math.min(a, 8),
                      o = 8 - s;
                    ((r = (i & (r = (4278190080 >>> (24 + o)) << o)) >> o),
                      (n = n ? (n << s) | r : r),
                      (t += 1),
                      (a -= s));
                  }
                  if (n < 16) return !0;
                }
                return !1;
              }
              function zx(e) {
                ((this.j = e), (this.h = 0), (this.g = new Map()), (this.i = null));
              }
              function qx(e, t) {
                if (t + 8 > e.length || 2935 != ((e[t] << 8) | e[t + 1])) return null;
                var r = new co(e.subarray(t + 2));
                (po(r, 2), po(r, 3));
                var i = (go(r, 11) + 1) << 1,
                  n = go(r, 2);
                if (3 == n) {
                  n = [24e3, 22060, 16e3][(n = go(r, 2))];
                  var a = 3;
                } else ((n = [48e3, 44100, 32e3][n]), (a = go(r, 2)));
                var s = go(r, 3),
                  o = go(r, 1);
                return (
                  (r = go(r, 5)),
                  t + i > e.byteLength
                    ? null
                    : ((e = Math.floor((i * n) / (16 * [1, 2, 3, 6][a]))),
                      (e = new Uint8Array([
                        (8160 & e) >> 5,
                        (31 & e) << 3,
                        (n << 6) | (r << 1),
                        (s << 1) | o,
                        0,
                      ])),
                      { sampleRate: n, channelCount: [2, 1, 2, 3, 3, 4, 4, 5][s] + o, Ga: e, ra: i })
                );
              }
              function Xx(e) {
                ((this.j = e), (this.h = 0), (this.g = new Map()), (this.i = null));
              }
              (bi("text/x-ssa", function () {
                return new _x();
              }),
                ((n = Hx.prototype).destroy = function () {
                  this.g.clear();
                }),
                (n.isSupported = function (e) {
                  return "audio/aac" == e.toLowerCase().split(";")[0] && Ja(this.convertCodecs("audio", e));
                }),
                (n.convertCodecs = function (e, t) {
                  return "audio/aac" == t.toLowerCase().split(";")[0]
                    ? 'audio/mp4; codecs="' + (gi(t) || "mp4a.40.2") + '"'
                    : t;
                }),
                (n.getOriginalMimeType = function () {
                  return this.j;
                }),
                (n.transmux = function (e, t, r, i) {
                  for (var n = Oe(e), a = uo(n), s = a.length; s < n.length && !Vx(n, s); s++);
                  if (
                    ((e = 1e3 * r.endTime),
                    (a = lo(a)).length &&
                      r &&
                      (a = a.find(function (e) {
                        return "com.apple.streaming.transportStreamTimestamp" === e.description;
                      })) &&
                      (e = a.data),
                    !(a = Gx(n, s)))
                  )
                    return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                  ((t.audioSamplingRate = a.sampleRate), (t.channelsCount = a.channelCount));
                  for (var o = []; s < n.length; ) {
                    var l = jx(n, s);
                    if (!l) return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                    var u = l.ee + l.ra;
                    (s + u <= n.length &&
                      o.push({
                        data: n.subarray(s + l.ee, s + u),
                        size: l.ra,
                        duration: 1024,
                        sb: 0,
                        flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                      }),
                      (s += u));
                  }
                  return (
                    (n = a.sampleRate),
                    (e = Math.floor((e * n) / 1e3)),
                    (i = new us([
                      (i = {
                        id: t.id,
                        type: "audio",
                        codecs: a.codec,
                        encrypted: t.encrypted && t.drmInfos.length > 0,
                        timescale: n,
                        duration: i,
                        Bb: [],
                        Ga: new Uint8Array([]),
                        Sa: new Uint8Array([]),
                        Za: 0,
                        $a: 0,
                        data: { sequenceNumber: this.h, baseMediaDecodeTime: e, zb: o },
                        stream: t,
                      }),
                    ])),
                    (r = t.id + "_" + r.i),
                    this.g.has(r) ? (t = this.g.get(r)) : ((t = ds(i)), this.g.set(r, t)),
                    (r = this.i !== t),
                    (i = gs(i)),
                    (this.i = t),
                    this.h++,
                    Promise.resolve({ data: i, init: r ? t : null })
                  );
                }),
                j("shaka.transmuxer.AacTransmuxer", Hx),
                (Hx.prototype.transmux = Hx.prototype.transmux),
                (Hx.prototype.getOriginalMimeType = Hx.prototype.getOriginalMimeType),
                (Hx.prototype.convertCodecs = Hx.prototype.convertCodecs),
                (Hx.prototype.isSupported = Hx.prototype.isSupported),
                (Hx.prototype.destroy = Hx.prototype.destroy),
                ei(
                  "audio/aac",
                  function () {
                    return new Hx("audio/aac");
                  },
                  ii,
                ),
                ((n = zx.prototype).destroy = function () {
                  this.g.clear();
                }),
                (n.isSupported = function (e) {
                  return "audio/ac3" == e.toLowerCase().split(";")[0] && Ja(this.convertCodecs("audio", e));
                }),
                (n.convertCodecs = function (e, t) {
                  return "audio/ac3" == t.toLowerCase().split(";")[0]
                    ? se().se()
                      ? 'audio/mp4; codecs="ec-3"'
                      : 'audio/mp4; codecs="ac-3"'
                    : t;
                }),
                (n.getOriginalMimeType = function () {
                  return this.j;
                }),
                (n.transmux = function (e, t, r, i) {
                  for (var n = uo((e = Oe(e))), a = n.length; a < e.length && !Wx(e, a); a++);
                  var s = 1e3 * r.endTime;
                  ((n = lo(n)).length &&
                    r &&
                    (n = n.find(function (e) {
                      return "com.apple.streaming.transportStreamTimestamp" === e.description;
                    })) &&
                    (s = n.data),
                    (n = 0));
                  for (var o = new Uint8Array([]), l = []; a < e.length; ) {
                    var u = Kx(e, a);
                    if (!u) return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                    ((t.audioSamplingRate = u.sampleRate),
                      (t.channelsCount = u.channelCount),
                      (n = u.sampleRate),
                      (o = u.Ga),
                      l.push({
                        data: e.subarray(a, a + u.ra),
                        size: u.ra,
                        duration: 1536,
                        sb: 0,
                        flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                      }),
                      (a += u.ra));
                  }
                  return (
                    (e = Math.floor((s * n) / 1e3)),
                    (i = new us([
                      (i = {
                        id: t.id,
                        type: "audio",
                        codecs: "ac-3",
                        encrypted: t.encrypted && t.drmInfos.length > 0,
                        timescale: n,
                        duration: i,
                        Bb: [],
                        Ga: o,
                        Sa: new Uint8Array([]),
                        Za: 0,
                        $a: 0,
                        data: { sequenceNumber: this.h, baseMediaDecodeTime: e, zb: l },
                        stream: t,
                      }),
                    ])),
                    (r = t.id + "_" + r.i),
                    this.g.has(r) ? (t = this.g.get(r)) : ((t = ds(i)), this.g.set(r, t)),
                    (r = this.i !== t),
                    (i = gs(i)),
                    (this.i = t),
                    this.h++,
                    Promise.resolve({ data: i, init: r ? t : null })
                  );
                }),
                j("shaka.transmuxer.Ac3Transmuxer", zx),
                (zx.prototype.transmux = zx.prototype.transmux),
                (zx.prototype.getOriginalMimeType = zx.prototype.getOriginalMimeType),
                (zx.prototype.convertCodecs = zx.prototype.convertCodecs),
                (zx.prototype.isSupported = zx.prototype.isSupported),
                (zx.prototype.destroy = zx.prototype.destroy),
                ei(
                  "audio/ac3",
                  function () {
                    return new zx("audio/ac3");
                  },
                  ii,
                ),
                ((n = Xx.prototype).destroy = function () {
                  this.g.clear();
                }),
                (n.isSupported = function (e) {
                  return "audio/ec3" == e.toLowerCase().split(";")[0] && Ja(this.convertCodecs("audio", e));
                }),
                (n.convertCodecs = function (e, t) {
                  return "audio/ec3" == t.toLowerCase().split(";")[0] ? 'audio/mp4; codecs="ec-3"' : t;
                }),
                (n.getOriginalMimeType = function () {
                  return this.j;
                }),
                (n.transmux = function (e, t, r, i) {
                  for (
                    var n = uo((e = Oe(e))), a = n.length;
                    a < e.length && 2935 != ((e[a] << 8) | e[a + 1]);
                    a++
                  );
                  var s = 1e3 * r.endTime;
                  ((n = lo(n)).length &&
                    r &&
                    (n = n.find(function (e) {
                      return "com.apple.streaming.transportStreamTimestamp" === e.description;
                    })) &&
                    (s = n.data),
                    (n = 0));
                  for (var o = new Uint8Array([]), l = []; a < e.length; ) {
                    var u = qx(e, a);
                    if (!u) return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                    ((t.audioSamplingRate = u.sampleRate),
                      (t.channelsCount = u.channelCount),
                      (n = u.sampleRate),
                      (o = u.Ga),
                      l.push({
                        data: e.subarray(a, a + u.ra),
                        size: u.ra,
                        duration: 1536,
                        sb: 0,
                        flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                      }),
                      (a += u.ra));
                  }
                  return (
                    (e = Math.floor((s * n) / 1e3)),
                    (i = new us([
                      (i = {
                        id: t.id,
                        type: "audio",
                        codecs: "ec-3",
                        encrypted: t.encrypted && t.drmInfos.length > 0,
                        timescale: n,
                        duration: i,
                        Bb: [],
                        Ga: o,
                        Sa: new Uint8Array([]),
                        Za: 0,
                        $a: 0,
                        data: { sequenceNumber: this.h, baseMediaDecodeTime: e, zb: l },
                        stream: t,
                      }),
                    ])),
                    (r = t.id + "_" + r.i),
                    this.g.has(r) ? (t = this.g.get(r)) : ((t = ds(i)), this.g.set(r, t)),
                    (r = this.i !== t),
                    (i = gs(i)),
                    (this.i = t),
                    this.h++,
                    Promise.resolve({ data: i, init: r ? t : null })
                  );
                }),
                j("shaka.transmuxer.Ec3Transmuxer", Xx),
                (Xx.prototype.transmux = Xx.prototype.transmux),
                (Xx.prototype.getOriginalMimeType = Xx.prototype.getOriginalMimeType),
                (Xx.prototype.convertCodecs = Xx.prototype.convertCodecs),
                (Xx.prototype.isSupported = Xx.prototype.isSupported),
                (Xx.prototype.destroy = Xx.prototype.destroy),
                ei(
                  "audio/ec3",
                  function () {
                    return new Xx("audio/ec3");
                  },
                  ii,
                ));
              var Yx = [100, 110, 122, 244, 44, 83, 86, 118, 128, 138, 139, 134];
              function Qx(e) {
                if (!e.length) return null;
                var t = e.find(function (e) {
                    return 32 == e.type;
                  }),
                  r = e.find(function (e) {
                    return 33 == e.type;
                  }),
                  i = e.find(function (e) {
                    return 34 == e.type;
                  });
                if (!t || !r || !i) return null;
                var n = (function (e) {
                  var t = new co(e, !0);
                  return (
                    So(t),
                    So(t),
                    go(t, 4),
                    go(t, 2),
                    go(t, 6),
                    (e = go(t, 3)),
                    (t = bo(t)),
                    { Xg: e + 1, Eh: t }
                  );
                })(t.fullData);
                e = (function (e) {
                  (So((e = new co(e, !0))), So(e));
                  var t = 0,
                    r = 0,
                    i = 0,
                    n = 0;
                  go(e, 4);
                  var a = go(e, 3);
                  bo(e);
                  for (
                    var s = go(e, 2),
                      o = go(e, 1),
                      l = go(e, 5),
                      u = So(e),
                      d = So(e),
                      h = So(e),
                      c = So(e),
                      f = So(e),
                      p = So(e),
                      g = So(e),
                      m = So(e),
                      v = So(e),
                      y = So(e),
                      T = So(e),
                      b = [],
                      S = [],
                      E = 0;
                    E < a;
                    E++
                  )
                    (b.push(bo(e)), S.push(bo(e)));
                  if (a > 0) for (E = a; E < 8; E++) go(e, 2);
                  for (E = 0; E < a; E++) (b[E] && go(e, 88), S[E] && So(e));
                  (yo(e),
                    3 == (b = yo(e)) && go(e, 1),
                    (S = yo(e)),
                    (E = yo(e)),
                    bo(e) && ((t += yo(e)), (r += yo(e)), (i += yo(e)), (n += yo(e))));
                  var x = yo(e),
                    w = yo(e),
                    A = yo(e);
                  if (bo(e)) for (var I = 0; I <= a; I++) (yo(e), yo(e), yo(e));
                  else (yo(e), yo(e), yo(e));
                  if ((yo(e), yo(e), yo(e), yo(e), yo(e), yo(e), bo(e) && bo(e)))
                    for (I = 0; I < 4; I++)
                      for (var k = 0; k < (3 === I ? 2 : 6); k++)
                        if (bo(e)) {
                          var R = Math.min(64, 1 << (4 + (I << 1)));
                          I > 1 && To(e);
                          for (var C = 0; C < R; C++) To(e);
                        } else yo(e);
                  for (bo(e), bo(e), bo(e) && (So(e), yo(e), yo(e), bo(e)), I = yo(e), R = k = 0; R < I; R++)
                    if (((C = !1), 0 !== R && (C = bo(e)), C)) {
                      (R === I && yo(e), bo(e), yo(e));
                      for (var L = (C = 0); L <= k; L++) {
                        var M = bo(e),
                          D = !1;
                        (M || (D = bo(e)), (M || D) && C++);
                      }
                      k = C;
                    } else {
                      for (k = (L = yo(e)) + (C = yo(e)), M = 0; M < L; M++) (yo(e), bo(e));
                      for (L = 0; L < C; L++) (yo(e), bo(e));
                    }
                  if (bo(e))
                    for (I = yo(e), k = 0; k < I; k++) {
                      for (R = 0; R < A + 4; R++) go(e, 1);
                      go(e, 1);
                    }
                  if (((I = A = 1), (k = !0), (R = 1), (L = C = 0), bo(e), bo(e), bo(e))) {
                    if (bo(e)) {
                      D = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];
                      var _ = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1];
                      (M = So(e)) > 0 && M <= 16
                        ? ((A = D[M - 1]), (I = _[M - 1]))
                        : 255 === M && ((A = go(e, 16)), (I = go(e, 16)));
                    }
                    if (
                      (bo(e) && bo(e),
                      bo(e) && (go(e, 3), bo(e), bo(e) && (So(e), So(e), So(e))),
                      bo(e) && (yo(e), yo(e)),
                      bo(e),
                      bo(e),
                      bo(e),
                      (M = bo(e)) && (vo(e), vo(e), vo(e), vo(e)),
                      bo(e) && ((R = go(e, 32)), (C = go(e, 32)), bo(e) && yo(e), bo(e)))
                    ) {
                      ((_ = !1),
                        (M = bo(e)),
                        (D = bo(e)),
                        (M || D) &&
                          ((_ = bo(e)) && (So(e), go(e, 5), bo(e), go(e, 5)),
                          go(e, 4),
                          go(e, 4),
                          _ && go(e, 4),
                          go(e, 5),
                          go(e, 5),
                          go(e, 5)));
                      for (var P = 0; P <= a; P++) {
                        var O = !0,
                          N = 1;
                        (k = bo(e)) || (O = bo(e));
                        var F = !1;
                        if ((O ? yo(e) : (F = bo(e)), F || (N = yo(e) + 1), M)) {
                          for (O = 0; O < N; O++) (yo(e), yo(e), _ && (yo(e), yo(e)));
                          bo(e);
                        }
                        if (D) {
                          for (O = 0; O < N; O++) (yo(e), yo(e), _ && (yo(e), yo(e)));
                          bo(e);
                        }
                      }
                    }
                    bo(e) && (bo(e), bo(e), bo(e), (L = yo(e)), yo(e), yo(e), yo(e), yo(e));
                  }
                  return {
                    Cg: T,
                    Ig: s,
                    Jg: o,
                    Hg: l,
                    Dg: u,
                    Eg: d,
                    Fg: h,
                    Gg: c,
                    wg: f,
                    xg: p,
                    yg: g,
                    zg: m,
                    Ag: v,
                    Bg: y,
                    uf: L,
                    kg: b,
                    jg: x,
                    ig: w,
                    width: S - (t + r) * (1 === b || 2 === b ? 2 : 1),
                    height: E - (i + n) * (1 === b ? 2 : 1),
                    Uk: A,
                    Tk: I,
                    vg: C / R,
                    ug: k,
                  };
                })(r.fullData);
                var a = (function (e) {
                  var t = new co(e, !0);
                  (So(t),
                    So(t),
                    yo(t),
                    yo(t),
                    bo(t),
                    bo(t),
                    go(t, 3),
                    bo(t),
                    bo(t),
                    yo(t),
                    yo(t),
                    To(t),
                    bo(t),
                    bo(t),
                    bo(t) && yo(t),
                    To(t),
                    To(t),
                    bo(t),
                    bo(t),
                    bo(t),
                    bo(t),
                    (e = bo(t)),
                    (t = bo(t)));
                  var r = 1;
                  return (t && e ? (r = 0) : t ? (r = 3) : e && (r = 2), { Zg: r });
                })(i.fullData);
                return (
                  (t = (function (e, t, r, i) {
                    var n = new Uint8Array(23 + (5 + e.byteLength) + (5 + t.byteLength) + (5 + r.byteLength));
                    for (
                      n[0] = 1,
                        n[1] = ((3 & i.Ig) << 6) | ((i.Jg ? 1 : 0) << 5) | (31 & i.Hg),
                        n[2] = i.Dg,
                        n[3] = i.Eg,
                        n[4] = i.Fg,
                        n[5] = i.Gg,
                        n[6] = i.wg,
                        n[7] = i.xg,
                        n[8] = i.yg,
                        n[9] = i.zg,
                        n[10] = i.Ag,
                        n[11] = i.Bg,
                        n[12] = i.Cg,
                        n[13] = 240 | ((3840 & i.uf) >> 8),
                        n[14] = 255 & i.uf,
                        n[15] = 252 | (3 & i.Zg),
                        n[16] = 252 | (3 & i.kg),
                        n[17] = 248 | (7 & i.jg),
                        n[18] = 248 | (7 & i.ig),
                        n[19] = 0,
                        n[20] = parseInt(i.vg, 10),
                        n[21] = ((3 & (i.ug ? 1 : 0)) << 6) | ((7 & i.Xg) << 3) | ((i.Eh ? 1 : 0) << 2) | 3,
                        n[22] = 3,
                        e = [e, t, r],
                        t = 23,
                        r = e.length - 1,
                        i = 0;
                      i < e.length;
                      i += 1
                    )
                      (n.set(new Uint8Array([(32 + i) | (i === r ? 128 : 0), 0, 1]), t),
                        (t += 3),
                        n.set(new Uint8Array([e[i].byteLength >> 8, 255 & e[i].byteLength]), t),
                        (t += 2),
                        n.set(e[i], t),
                        (t += e[i].byteLength));
                    return n;
                  })(t.fullData, r.fullData, i.fullData, {
                    Xg: n.Xg,
                    Eh: n.Eh,
                    Ig: e.Ig,
                    Jg: e.Jg,
                    Cg: e.Cg,
                    Hg: e.Hg,
                    Dg: e.Dg,
                    Eg: e.Eg,
                    Fg: e.Fg,
                    Gg: e.Gg,
                    wg: e.wg,
                    xg: e.xg,
                    yg: e.yg,
                    zg: e.zg,
                    Ag: e.Ag,
                    Bg: e.Bg,
                    uf: e.uf,
                    kg: e.kg,
                    jg: e.jg,
                    ig: e.ig,
                    Zg: a.Zg,
                    vg: e.vg,
                    ug: e.ug,
                  })),
                  { height: e.height, width: e.width, Sa: t, Za: e.Uk, $a: e.Tk }
                );
              }
              function Jx(e, t) {
                var r = (e[t + 1] >> 3) & 3,
                  i = (e[t + 1] >> 1) & 3,
                  n = (e[t + 2] >> 4) & 15,
                  a = (e[t + 2] >> 2) & 3;
                if (1 !== r && 0 !== n && 15 !== n && 3 !== a) {
                  var s = e[t + 3] >> 6;
                  ((n = 1e3 * tw[14 * (3 === r ? 3 - i : 3 === i ? 3 : 4) + n - 1]),
                    (a = rw[3 * (3 === r ? 0 : 2 === r ? 1 : 2) + a]),
                    (r = iw[r][i]));
                  var o = nw[i],
                    l = Math.floor((r * n) / a + ((e[t + 2] >> 1) & 1)) * o,
                    u = (navigator.userAgent || "").match(/Chrome\/(\d+)/i);
                  return (
                    (u = u ? parseInt(u[1], 10) : 0) &&
                      u <= 87 &&
                      2 === i &&
                      n >= 224e3 &&
                      0 === s &&
                      (e[t + 3] |= 128),
                    { sampleRate: a, channelCount: 3 === s ? 1 : 2, ra: l, Sk: 8 * r * o }
                  );
                }
                return null;
              }
              function Zx(e, t) {
                return !(255 !== e[t] || 224 & ~e[t + 1] || !(6 & e[t + 1]));
              }
              function ew(e, t) {
                if (t + 1 < e.length && Zx(e, t)) {
                  var r = Jx(e, t),
                    i = 4;
                  return (r && r.ra && (i = r.ra), (t += i) === e.length || (t + 1 < e.length && Zx(e, t)));
                }
                return !1;
              }
              var tw = [
                  32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, 32, 48, 56, 64, 80, 96,
                  112, 128, 160, 192, 224, 256, 320, 384, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224,
                  256, 320, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256, 8, 16, 24, 32, 40,
                  48, 56, 64, 80, 96, 112, 128, 144, 160,
                ],
                rw = [44100, 48e3, 32e3, 22050, 24e3, 16e3, 11025, 12e3, 8e3],
                iw = [
                  [0, 72, 144, 12],
                  [0, 0, 0, 0],
                  [0, 72, 144, 12],
                  [0, 144, 144, 12],
                ],
                nw = [0, 1, 1, 4];
              function aw(e) {
                ((this.j = e), (this.h = 0), (this.g = new Map()), (this.i = null));
              }
              function sw(e) {
                ((this.h = e), (this.g = null));
              }
              /*
      		 @license
      		 MSS Transmuxer
      		 Copyright 2015 Dash Industry Forum
      		 SPDX-License-Identifier: BSD-3-Clause
      		*/
              function ow(e) {
                ((this.h = e),
                  (this.g = Xv.get("ISOBoxer")()) &&
                    (function (e) {
                      function t() {
                        (this._procFullBox(),
                          1 & this.flags &&
                            (this._procField("AlgorithmID", "uint", 24),
                            this._procField("IV_size", "uint", 8),
                            this._procFieldArray("KID", 16, "uint", 8)),
                          this._procField("sample_count", "uint", 32),
                          this._procEntries("entry", this.sample_count, function (e) {
                            (this._procEntryField(e, "InitializationVector", "data", 8),
                              2 & this.flags &&
                                (this._procEntryField(e, "NumberOfEntries", "uint", 16),
                                this._procSubEntries(
                                  e,
                                  "clearAndCryptedData",
                                  e.NumberOfEntries,
                                  function (e) {
                                    (this._procEntryField(e, "BytesOfClearData", "uint", 16),
                                      this._procEntryField(e, "BytesOfEncryptedData", "uint", 32));
                                  },
                                )));
                          }));
                      }
                      (e.g.addBoxProcessor("saio", function () {
                        (this._procFullBox(),
                          1 & this.flags &&
                            (this._procField("aux_info_type", "uint", 32),
                            this._procField("aux_info_type_parameter", "uint", 32)),
                          this._procField("entry_count", "uint", 32),
                          this._procFieldArray(
                            "offset",
                            this.entry_count,
                            "uint",
                            1 === this.version ? 64 : 32,
                          ));
                      }),
                        e.g.addBoxProcessor("saiz", function () {
                          (this._procFullBox(),
                            1 & this.flags &&
                              (this._procField("aux_info_type", "uint", 32),
                              this._procField("aux_info_type_parameter", "uint", 32)),
                            this._procField("default_sample_info_size", "uint", 8),
                            this._procField("sample_count", "uint", 32),
                            0 === this.default_sample_info_size &&
                              this._procFieldArray("sample_info_size", this.sample_count, "uint", 8));
                        }),
                        e.g.addBoxProcessor("senc", t),
                        e.g.addBoxProcessor("uuid", function () {
                          for (var e = !0, r = 0; r < 16; r++) this.usertype[r] !== uw[r] && (e = !1);
                          e && (this._parsing && (this.type = "sepiff"), t.call(this));
                        }));
                    })(this));
              }
              function lw(e, t) {
                for (var r = 8, i = 0; i < e.boxes.length && e.boxes[i].type !== t; i++) r += e.boxes[i].size;
                return r;
              }
              (((n = aw.prototype).destroy = function () {
                this.g.clear();
              }),
                (n.isSupported = function (e) {
                  return "audio/mpeg" == e.toLowerCase().split(";")[0] && Ja(this.convertCodecs("audio", e));
                }),
                (n.convertCodecs = function (e, t) {
                  return "audio/mpeg" == t.toLowerCase().split(";")[0] ? 'audio/mp4; codecs="mp3"' : t;
                }),
                (n.getOriginalMimeType = function () {
                  return this.j;
                }),
                (n.transmux = function (e, t, r, i) {
                  for (var n = Oe(e), a = uo(n).length; a < n.length && !ew(n, a); a++);
                  var s;
                  for (e = []; a < n.length; ) {
                    var o = Jx(n, a);
                    if (!o) return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                    (s || (s = o),
                      a + o.ra <= n.length &&
                        e.push({
                          data: n.subarray(a, a + o.ra),
                          size: o.ra,
                          duration: 1152,
                          sb: 0,
                          flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                        }),
                      (a += o.ra));
                  }
                  return s
                    ? ((n = ((9e4 * s.Sk) / s.sampleRate) * this.h),
                      (i = new us([
                        (i = {
                          id: t.id,
                          type: "audio",
                          codecs: "mp3",
                          encrypted: t.encrypted && t.drmInfos.length > 0,
                          timescale: s.sampleRate,
                          duration: i,
                          Bb: [],
                          Ga: new Uint8Array([]),
                          Sa: new Uint8Array([]),
                          Za: 0,
                          $a: 0,
                          data: { sequenceNumber: this.h, baseMediaDecodeTime: n, zb: e },
                          stream: t,
                        }),
                      ])),
                      (r = t.id + "_" + r.i),
                      this.g.has(r) ? (t = this.g.get(r)) : ((t = ds(i)), this.g.set(r, t)),
                      (r = this.i !== t),
                      (i = gs(i)),
                      (this.i = t),
                      this.h++,
                      Promise.resolve({ data: i, init: r ? t : null }))
                    : Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                }),
                j("shaka.transmuxer.Mp3Transmuxer", aw),
                (aw.prototype.transmux = aw.prototype.transmux),
                (aw.prototype.getOriginalMimeType = aw.prototype.getOriginalMimeType),
                (aw.prototype.convertCodecs = aw.prototype.convertCodecs),
                (aw.prototype.isSupported = aw.prototype.isSupported),
                (aw.prototype.destroy = aw.prototype.destroy),
                ei(
                  "audio/mpeg",
                  function () {
                    return new aw("audio/mpeg");
                  },
                  ii,
                ),
                ((n = sw.prototype).destroy = function () {}),
                (n.isSupported = function (e) {
                  if ("video/mp2t" != e.toLowerCase().split(";")[0]) return !1;
                  var t = gi(e).split(","),
                    r = ft("audio", t);
                  return (
                    (t = ft("video", t)),
                    !(!r || t || "mp3" != ci(r)) && Ja(this.convertCodecs("audio", e))
                  );
                }),
                (n.convertCodecs = function (e, t) {
                  return "video/mp2t" == t.toLowerCase().split(";")[0] ? "audio/mpeg" : t;
                }),
                (n.getOriginalMimeType = function () {
                  return this.h;
                }),
                (n.transmux = function (e, t, r, i, n) {
                  if (
                    (this.g ? this.g.clearData() : (this.g = new wo()),
                    this.g.Kf(r.i),
                    (e = Oe(e)),
                    "mp3" != (e = this.g.parse(e)).Yd().audio || "audio" != n)
                  )
                    return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                  for (r = new Uint8Array([]), n = g(e.ub()), e = n.next(); !e.done; e = n.next())
                    if ((e = e.value.data))
                      for (t = 0; t < e.length; )
                        (i = Jx(e, t))
                          ? (t + i.ra <= e.length && (r = lt(r, e.subarray(t, t + i.ra))), (t += i.ra))
                          : t++;
                  return Promise.resolve(r);
                }),
                j("shaka.transmuxer.MpegTsTransmuxer", sw),
                (sw.prototype.transmux = sw.prototype.transmux),
                (sw.prototype.getOriginalMimeType = sw.prototype.getOriginalMimeType),
                (sw.prototype.convertCodecs = sw.prototype.convertCodecs),
                (sw.prototype.isSupported = sw.prototype.isSupported),
                (sw.prototype.destroy = sw.prototype.destroy),
                ei(
                  "video/mp2t",
                  function () {
                    return new sw("video/mp2t");
                  },
                  ni,
                ),
                ((n = ow.prototype).destroy = function () {}),
                (n.isSupported = function (e, t) {
                  var r = e.startsWith("mss/");
                  return (
                    !(!this.g || !r) &&
                    (t
                      ? Ja(this.convertCodecs(t, e))
                      : ((t = this.convertCodecs("audio", e)),
                        (e = this.convertCodecs("video", e)),
                        Ja(t) || Ja(e)))
                  );
                }),
                (n.convertCodecs = function (e, t) {
                  return t.replace("mss/", "");
                }),
                (n.getOriginalMimeType = function () {
                  return this.h;
                }),
                (n.transmux = function (e, t, r) {
                  if (!r) return Promise.resolve(Oe(e));
                  if (!t.mssPrivateData) return Promise.reject(new ze(2, 3, 3020, r ? r.P()[0] : null));
                  try {
                    var i,
                      n = this.g.parseBuffer(e),
                      a = n.fetch("tfhd");
                    a.track_ID = t.id + 1;
                    var s = n.fetch("tfdt"),
                      o = n.fetch("traf");
                    null === s &&
                      (((s = this.g.createFullBox("tfdt", o, a)).version = 1),
                      (s.flags = 0),
                      (s.baseMediaDecodeTime = Math.floor(r.startTime * t.mssPrivateData.timescale)));
                    var l = n.fetch("trun"),
                      u = n.fetch("tfxd");
                    u && u._parent.boxes.splice(u._parent.boxes.indexOf(u), 1);
                    var d = n.fetch("tfrf");
                    d && d._parent.boxes.splice(d._parent.boxes.indexOf(d), 1);
                    var h = n.fetch("sepiff");
                    if (null !== h) {
                      ((h.type = "senc"), (h.usertype = void 0));
                      var c = n.fetch("saio");
                      if (null === c) {
                        (((c = this.g.createFullBox("saio", o)).version = 0),
                          (c.flags = 0),
                          (c.entry_count = 1),
                          (c.offset = [0]));
                        var f = this.g.createFullBox("saiz", o);
                        if (
                          ((f.version = 0),
                          (f.flags = 0),
                          (f.sample_count = h.sample_count),
                          (f.default_sample_info_size = 0),
                          (f.sample_info_size = []),
                          2 & h.flags)
                        )
                          for (i = 0; i < h.sample_count; i += 1)
                            f.sample_info_size[i] = 10 + 6 * h.entry[i].NumberOfEntries;
                        else f.default_sample_info_size = 8;
                      }
                    }
                    ((a.flags &= 16777214), (a.flags |= 131072), (l.flags |= 1));
                    var p = n.fetch("moof");
                    l.data_offset = p.getLength() + 8;
                    var g = n.fetch("saio");
                    null !== g && (g.offset[0] = lw(p, "traf") + lw(o, "senc") + 16);
                    var m = Oe(n.write());
                    return Promise.resolve(m);
                  } catch (v) {
                    return v instanceof ze
                      ? Promise.reject(v)
                      : Promise.reject(new ze(2, 3, 3022, r ? r.P()[0] : null));
                  }
                }),
                j("shaka.transmuxer.MssTransmuxer", ow),
                (ow.prototype.transmux = ow.prototype.transmux),
                (ow.prototype.getOriginalMimeType = ow.prototype.getOriginalMimeType),
                (ow.prototype.convertCodecs = ow.prototype.convertCodecs),
                (ow.prototype.isSupported = ow.prototype.isSupported),
                (ow.prototype.destroy = ow.prototype.destroy));
              var uw = new Uint8Array([
                162, 57, 79, 82, 90, 155, 79, 20, 162, 68, 108, 66, 124, 100, 141, 244,
              ]);
              function dw(e) {
                ((this.m = e), (this.g = 0), (this.j = new Map()), (this.l = this.i = this.h = null));
              }
              (ei(
                "mss/audio/mp4",
                function () {
                  return new ow("mss/audio/mp4");
                },
                ii,
              ),
                ei(
                  "mss/video/mp4",
                  function () {
                    return new ow("mss/video/mp4");
                  },
                  ii,
                ),
                ((n = dw.prototype).destroy = function () {
                  (this.j.clear(), this.i && this.i.destroy());
                }),
                (n.isSupported = function (e, t) {
                  if ("video/mp2t" != e.toLowerCase().split(";")[0]) return !1;
                  var r = e;
                  t && (r = this.convertCodecs(t, e));
                  var i = gi(r).split(",");
                  return (
                    (r = ft("audio", i)),
                    (i = ft("video", i)),
                    !((r && ((r = ci(r)), !hw.includes(r))) || (i && ((r = ci(i)), !cw.includes(r)))) &&
                      (t
                        ? Ja(this.convertCodecs(t, e))
                        : ((t = this.convertCodecs("audio", e)),
                          (e = this.convertCodecs("video", e)),
                          Ja(t) || Ja(e)))
                  );
                }),
                (n.convertCodecs = function (e, t) {
                  return "video/mp2t" == t.toLowerCase().split(";")[0]
                    ? ((t = gi(t)
                        .replace("mp4a.40.34", "mp3")
                        .split(",")
                        .map(function (e) {
                          return Ji(e, "audio/mp4");
                        })
                        .map(Zi)
                        .join(",")),
                      "audio" == e ? 'audio/mp4; codecs="' + t + '"' : 'video/mp4; codecs="' + t + '"')
                    : t;
                }),
                (n.getOriginalMimeType = function () {
                  return this.m;
                }),
                (n.transmux = function (e, t, r, i, n) {
                  var a = Oe(e);
                  if ("audio" == n && !Ro(a)) {
                    for (var s = uo(a), o = s.length; o < a.length; o++)
                      if (ew(a, o)) return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                    for (o = s.length; o < a.length; o++)
                      if (Vx(a, o))
                        return (this.i || (this.i = new Hx("audio/aac")), this.i.transmux(e, t, r, i, n));
                    return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                  }
                  (this.h ? this.h.clearData() : (this.h = new wo()), this.h.Kf(r.i));
                  var l = this.h.parse(a),
                    u = [],
                    d = l.Yd();
                  try {
                    var h = null;
                    if ("video" == n) {
                      switch (d.video) {
                        case "avc":
                          var c = [],
                            f = null,
                            p = l.ud(),
                            v = (function (e) {
                              function t(e) {
                                n = {
                                  data: new Uint8Array([]),
                                  frame: !1,
                                  isKeyframe: !1,
                                  pts: e.pts,
                                  dts: e.dts,
                                  nalus: [],
                                };
                              }
                              function r() {
                                if (n && n.nalus.length && n.frame) {
                                  for (var e = [], t = g(n.nalus), r = t.next(); !r.done; r = t.next()) {
                                    var a = (r = r.value).fullData.byteLength,
                                      s = new Uint8Array(4);
                                    ((s[0] = (a >> 24) & 255),
                                      (s[1] = (a >> 16) & 255),
                                      (s[2] = (a >> 8) & 255),
                                      (s[3] = 255 & a),
                                      e.push(s),
                                      e.push(r.fullData));
                                  }
                                  ((n.data = lt.apply(rt, m(e))), i.push(n));
                                }
                              }
                              for (var i = [], n = null, a = !1, s = 0; s < e.length; s++) {
                                var o = e[s],
                                  l = o.nalus,
                                  u = !1;
                                n && l.length && !a && (r(), t(o));
                                for (var d = (l = g(o.nalus)).next(); !d.done; d = l.next()) {
                                  var h = !1;
                                  switch ((d = d.value).type) {
                                    case 1:
                                      var c = !1;
                                      h = !0;
                                      var f = d.data;
                                      (u &&
                                        f.length > 4 &&
                                        (2 === (f = xo(new co(f))) || 4 === f || 7 === f || 9 === f) &&
                                        (c = !0),
                                        c && n && n.frame && !n.isKeyframe && (r(), (n = null)),
                                        n || t(o),
                                        (n.frame = !0),
                                        (n.isKeyframe = c));
                                      break;
                                    case 5:
                                      ((h = !0),
                                        n && n.frame && !n.isKeyframe && (r(), (n = null)),
                                        n || t(o),
                                        (n.frame = !0),
                                        (n.isKeyframe = !0));
                                      break;
                                    case 6:
                                    case 8:
                                    case 12:
                                      h = !0;
                                      break;
                                    case 7:
                                      u = h = !0;
                                      break;
                                    case 9:
                                      ((a = h = !0), n && n.frame && (r(), (n = null)), n || t(o));
                                      break;
                                    default:
                                      h = !1;
                                  }
                                  n && h && n.nalus.push(d);
                                }
                              }
                              return (r(), i);
                            })(p);
                          if (!v.length) throw new ze(2, 3, 3023, r ? r.P()[0] : null);
                          for (var y = 0; y < v.length; y++) {
                            var T,
                              b = v[y];
                            (null == f && (f = b.dts),
                              (T =
                                y + 1 < v.length
                                  ? (v[y + 1].dts || 0) - (b.dts || 0)
                                  : v.length > 1
                                    ? (b.dts || 0) - (v[y - 1].dts || 0)
                                    : 9e4 * (r.endTime - r.startTime)),
                              c.push({
                                data: b.data,
                                size: b.data.byteLength,
                                duration: T,
                                sb: Math.round((b.pts || 0) - (b.dts || 0)),
                                flags: {
                                  xb: 0,
                                  mb: 0,
                                  jb: 0,
                                  hb: 0,
                                  ib: b.isKeyframe ? 2 : 1,
                                  yb: b.isKeyframe ? 0 : 1,
                                },
                              }));
                          }
                          for (var S = [], E = g(p), x = E.next(); !x.done; x = E.next())
                            S.push.apply(S, m(x.value.nalus));
                          var w = (function (e) {
                            if (!e.length) return null;
                            var t = e.find(function (e) {
                              return 7 == e.type;
                            });
                            if (
                              ((e = e.find(function (e) {
                                return 8 == e.type;
                              })),
                              !t || !e)
                            )
                              return null;
                            var r = new co(t.data),
                              i = So(r);
                            if (
                              (So(r),
                              So(r),
                              vo(r),
                              Yx.includes(i) &&
                                (3 === (i = yo(r)) && po(r, 1), vo(r), vo(r), po(r, 1), bo(r)))
                            ) {
                              i = 3 !== i ? 8 : 12;
                              for (var n = 0; n < i; n++) bo(r) && Eo(r, n < 6 ? 16 : 64);
                            }
                            if ((vo(r), 0 === (i = yo(r)))) yo(r);
                            else if (1 === i)
                              for (po(r, 1), vo(r), vo(r), i = yo(r), n = 0; n < i; n++) vo(r);
                            (vo(r), po(r, 1));
                            var a = yo(r),
                              s = yo(r),
                              o = go(r, 1);
                            (0 === o && po(r, 1), po(r, 1));
                            var l = 0,
                              u = 0,
                              d = 0,
                              h = 0;
                            if (
                              (bo(r) && ((l = yo(r)), (u = yo(r)), (d = yo(r)), (h = yo(r))),
                              (n = i = 1),
                              bo(r) && bo(r))
                            ) {
                              var c = So(r);
                              c > 0 && c <= 16
                                ? ((i = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2][c - 1]),
                                  (n = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1][c - 1]))
                                : 255 === c && ((i = go(r, 16)), (n = go(r, 16)));
                            }
                            return (
                              (r = (2 - o) * (s + 1) * 16 - 2 * d - 2 * h),
                              (a = 16 * (a + 1) - 2 * l - 2 * u),
                              (l = []),
                              (t = t.fullData),
                              l.push((t.byteLength >>> 8) & 255),
                              l.push(255 & t.byteLength),
                              (l = l.concat.apply(l, m(t))),
                              (t = []),
                              (e = e.fullData),
                              t.push((e.byteLength >>> 8) & 255),
                              t.push(255 & e.byteLength),
                              (t = t.concat.apply(t, m(e))),
                              {
                                height: r,
                                width: a,
                                Sa: (e = new Uint8Array([1, l[3], l[4], l[5], 255, 225].concat(l, [1], t))),
                                Za: i,
                                $a: n,
                              }
                            );
                          })(S);
                          if (!w || null == f) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          ((t.height = w.height),
                            (t.width = w.width),
                            (h = {
                              id: t.id,
                              type: "video",
                              codecs: "avc1",
                              encrypted: t.encrypted && t.drmInfos.length > 0,
                              timescale: 9e4,
                              duration: i,
                              Bb: [],
                              Ga: new Uint8Array([]),
                              Sa: w.Sa,
                              Za: w.Za,
                              $a: w.$a,
                              data: { sequenceNumber: this.g, baseMediaDecodeTime: f, zb: c },
                              stream: t,
                            }));
                          break;
                        case "hvc":
                          var A = [],
                            I = null,
                            k = [],
                            R = l.ud();
                          if (!R.length) throw new ze(2, 3, 3023, r ? r.P()[0] : null);
                          for (var C = 0; C < R.length; C++) {
                            var L = R[C],
                              M = L.nalus;
                            k.push.apply(k, m(M));
                            for (var D = !1, _ = [], P = !1, O = g(M), N = O.next(); !N.done; N = O.next()) {
                              var F = N.value;
                              switch (F.type) {
                                case 1:
                                case 0:
                                  var U = (P = !0);
                                  break;
                                case 19:
                                case 20:
                                case 21:
                                  D = U = P = !0;
                                  break;
                                case 32:
                                case 33:
                                case 34:
                                case 39:
                                case 40:
                                  U = !0;
                                  break;
                                case 35:
                                  P = U = !0;
                                  break;
                                default:
                                  U = !1;
                              }
                              if (P && U) {
                                var B = F.fullData.byteLength,
                                  $ = new Uint8Array(4);
                                (($[0] = (B >> 24) & 255),
                                  ($[1] = (B >> 16) & 255),
                                  ($[2] = (B >> 8) & 255),
                                  ($[3] = 255 & B),
                                  _.push($),
                                  _.push(F.fullData));
                              }
                            }
                            var j,
                              G = _.length ? { data: lt.apply(rt, m(_)), isKeyframe: D } : null;
                            G &&
                              (null == I && null != L.dts && (I = L.dts),
                              (j =
                                C + 1 < R.length
                                  ? (R[C + 1].dts || 0) - (L.dts || 0)
                                  : R.length > 1
                                    ? (L.dts || 0) - (R[C - 1].dts || 0)
                                    : 9e4 * (r.endTime - r.startTime)),
                              A.push({
                                data: G.data,
                                size: G.data.byteLength,
                                duration: j,
                                sb: Math.round((L.pts || 0) - (L.dts || 0)),
                                flags: {
                                  xb: 0,
                                  mb: 0,
                                  jb: 0,
                                  hb: 0,
                                  ib: G.isKeyframe ? 2 : 1,
                                  yb: G.isKeyframe ? 0 : 1,
                                },
                              }));
                          }
                          var V = Qx(k);
                          if (!V || null == I) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          ((t.height = V.height),
                            (t.width = V.width),
                            (h = {
                              id: t.id,
                              type: "video",
                              codecs: "hvc1",
                              encrypted: t.encrypted && t.drmInfos.length > 0,
                              timescale: 9e4,
                              duration: i,
                              Bb: [],
                              Ga: new Uint8Array([]),
                              Sa: V.Sa,
                              Za: V.Za,
                              $a: V.$a,
                              data: { sequenceNumber: this.g, baseMediaDecodeTime: I, zb: A },
                              stream: t,
                            }));
                      }
                      h && (u.push(h), (h = null));
                    }
                    if ("audio" == n) {
                      switch (d.audio) {
                        case "aac":
                          for (
                            var H, K = [], W = null, z = null, q = null, X = g(l.ub()), Y = X.next();
                            !Y.done;
                            Y = X.next()
                          ) {
                            var Q = Y.value,
                              J = Q.data;
                            if (J) {
                              var Z = 0;
                              if (-1 == z && q) ((J = lt(q, Q.data)), (z = null));
                              else if (null != z && q) {
                                Z = Math.max(0, z);
                                var ee = lt(q, J.subarray(0, Z));
                                (K.push({
                                  data: ee,
                                  size: ee.byteLength,
                                  duration: 1024,
                                  sb: 0,
                                  flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                                }),
                                  (z = q = null));
                              }
                              if (!(H = Gx(J, Z))) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                              for (
                                t.audioSamplingRate = H.sampleRate,
                                  t.channelsCount = H.channelCount,
                                  null == W && null !== Q.pts && (W = Q.pts);
                                Z < J.length;
                              ) {
                                var te = jx(J, Z);
                                if (!te) {
                                  ((q = J.subarray(Z, J.length)), (z = -1));
                                  break;
                                }
                                var re = te.ee + te.ra;
                                (0 != (z = Math.max(0, Z + re - J.length))
                                  ? (q = J.subarray(Z + te.ee, Z + re))
                                  : Z + re <= J.length &&
                                    K.push({
                                      data: J.subarray(Z + te.ee, Z + re),
                                      size: te.ra,
                                      duration: 1024,
                                      sb: 0,
                                      flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                                    }),
                                  (Z += re));
                              }
                            }
                          }
                          if (!H || null == W) {
                            W = 9e4 * r.startTime;
                            var ie = ft("audio", t.codecs.split(","));
                            if (!ie || !t.channelsCount || !t.audioSamplingRate)
                              throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                            H = { sampleRate: t.audioSamplingRate, channelCount: t.channelsCount, codec: ie };
                            var ne = (function (e, t) {
                              if ("mp4a.40.2" === e) {
                                if (1 === t) return new Uint8Array([0, 200, 0, 128, 35, 128]);
                                if (2 === t) return new Uint8Array([33, 0, 73, 144, 2, 25, 0, 35, 128]);
                                if (3 === t)
                                  return new Uint8Array([0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 142]);
                                if (4 === t)
                                  return new Uint8Array([
                                    0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 128, 44, 128, 8, 2, 56,
                                  ]);
                                if (5 === t)
                                  return new Uint8Array([
                                    0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130, 48, 4, 153, 0, 33,
                                    144, 2, 56,
                                  ]);
                                if (6 === t)
                                  return new Uint8Array([
                                    0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130, 48, 4, 153, 0, 33,
                                    144, 2, 0, 178, 0, 32, 8, 224,
                                  ]);
                              } else {
                                if (1 === t)
                                  return new Uint8Array([
                                    1, 64, 34, 128, 163, 78, 230, 128, 186, 8, 0, 0, 0, 28, 6, 241, 193, 10,
                                    90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                                    90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                                    90, 90, 90, 90, 94,
                                  ]);
                                if (2 === t || 3 === t)
                                  return new Uint8Array([
                                    1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0, 149, 0, 6, 241,
                                    161, 10, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                                    90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                                    90, 90, 90, 90, 94,
                                  ]);
                              }
                              return null;
                            })(ie, t.channelsCount);
                            if (!ne) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                            for (var ae = W + 9e4 * (r.endTime - r.startTime), se = W; se < ae; )
                              (K.push({
                                data: ne,
                                size: ne.byteLength,
                                duration: 1024,
                                sb: 0,
                                flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                              }),
                                (se += (1024 / H.sampleRate) * 9e4));
                          }
                          var oe = H.sampleRate,
                            le = (W / 9e4) * oe;
                          h = {
                            id: t.id,
                            type: "audio",
                            codecs: H.codec,
                            encrypted: t.encrypted && t.drmInfos.length > 0,
                            timescale: oe,
                            duration: i,
                            Bb: [],
                            Ga: new Uint8Array([]),
                            Sa: new Uint8Array([]),
                            Za: 0,
                            $a: 0,
                            data: { sequenceNumber: this.g, baseMediaDecodeTime: le, zb: K },
                            stream: t,
                          };
                          break;
                        case "ac3":
                          for (
                            var ue = [],
                              de = 0,
                              he = new Uint8Array([]),
                              ce = null,
                              fe = g(l.ub()),
                              pe = fe.next();
                            !pe.done;
                            pe = fe.next()
                          ) {
                            var ge = pe.value,
                              me = ge.data;
                            null == ce && null !== ge.pts && (ce = ge.pts);
                            for (var ve = 0; ve < me.length; ) {
                              var ye = Kx(me, ve);
                              ye
                                ? ((t.audioSamplingRate = ye.sampleRate),
                                  (t.channelsCount = ye.channelCount),
                                  (de = ye.sampleRate),
                                  (he = ye.Ga),
                                  ue.push({
                                    data: me.subarray(ve, ve + ye.ra),
                                    size: ye.ra,
                                    duration: 1536,
                                    sb: 0,
                                    flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                                  }),
                                  (ve += ye.ra))
                                : ve++;
                            }
                          }
                          if (0 == de || 0 == he.byteLength || null == ce)
                            throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          var Te = (ce / 9e4) * de;
                          h = {
                            id: t.id,
                            type: "audio",
                            codecs: "ac-3",
                            encrypted: t.encrypted && t.drmInfos.length > 0,
                            timescale: de,
                            duration: i,
                            Bb: [],
                            Ga: he,
                            Sa: new Uint8Array([]),
                            Za: 0,
                            $a: 0,
                            data: { sequenceNumber: this.g, baseMediaDecodeTime: Te, zb: ue },
                            stream: t,
                          };
                          break;
                        case "ec3":
                          for (
                            var be = [],
                              Se = 0,
                              Ee = new Uint8Array([]),
                              xe = null,
                              we = g(l.ub()),
                              Ae = we.next();
                            !Ae.done;
                            Ae = we.next()
                          ) {
                            var Ie = Ae.value,
                              ke = Ie.data;
                            null == xe && null !== Ie.pts && (xe = Ie.pts);
                            for (var Re = 0; Re < ke.length; ) {
                              var Ce = qx(ke, Re);
                              Ce
                                ? ((t.audioSamplingRate = Ce.sampleRate),
                                  (t.channelsCount = Ce.channelCount),
                                  (Se = Ce.sampleRate),
                                  (Ee = Ce.Ga),
                                  be.push({
                                    data: ke.subarray(Re, Re + Ce.ra),
                                    size: Ce.ra,
                                    duration: 1536,
                                    sb: 0,
                                    flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                                  }),
                                  (Re += Ce.ra))
                                : Re++;
                            }
                          }
                          if (0 == Se || 0 == Ee.byteLength || null == xe)
                            throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          var Le = (xe / 9e4) * Se;
                          h = {
                            id: t.id,
                            type: "audio",
                            codecs: "ec-3",
                            encrypted: t.encrypted && t.drmInfos.length > 0,
                            timescale: Se,
                            duration: i,
                            Bb: [],
                            Ga: Ee,
                            Sa: new Uint8Array([]),
                            Za: 0,
                            $a: 0,
                            data: { sequenceNumber: this.g, baseMediaDecodeTime: Le, zb: be },
                            stream: t,
                          };
                          break;
                        case "mp3":
                          for (
                            var Me, De = [], _e = null, Pe = g(l.ub()), Ne = Pe.next();
                            !Ne.done;
                            Ne = Pe.next()
                          ) {
                            var Fe = Ne.value,
                              Ue = Fe.data;
                            if (Ue) {
                              null == _e && null !== Fe.pts && (_e = Fe.pts);
                              for (var Be = 0; Be < Ue.length; ) {
                                var $e = Jx(Ue, Be);
                                $e
                                  ? (Me || (Me = $e),
                                    Be + $e.ra <= Ue.length &&
                                      De.push({
                                        data: Ue.subarray(Be, Be + $e.ra),
                                        size: $e.ra,
                                        duration: 1152,
                                        sb: 0,
                                        flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                                      }),
                                    (Be += $e.ra))
                                  : Be++;
                              }
                            }
                          }
                          if (!Me || null == _e) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          var je = Me.sampleRate,
                            Ge = (_e / 9e4) * je;
                          h = {
                            id: t.id,
                            type: "audio",
                            codecs: "mp3",
                            encrypted: t.encrypted && t.drmInfos.length > 0,
                            timescale: je,
                            duration: i,
                            Bb: [],
                            Ga: new Uint8Array([]),
                            Sa: new Uint8Array([]),
                            Za: 0,
                            $a: 0,
                            data: { sequenceNumber: this.g, baseMediaDecodeTime: Ge, zb: De },
                            stream: t,
                          };
                          break;
                        case "opus":
                          var Ve = [],
                            He = null,
                            Ke = l.H;
                          if (!Ke) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          var We = [];
                          switch (Ke.uj) {
                            case 1:
                            case 2:
                              We = [0];
                              break;
                            case 0:
                              We = [255, 1, 1, 0, 1];
                              break;
                            case 128:
                              We = [255, 2, 0, 0, 1];
                              break;
                            case 3:
                              We = [1, 2, 1, 0, 2, 1];
                              break;
                            case 4:
                              We = [1, 2, 2, 0, 1, 2, 3];
                              break;
                            case 5:
                              We = [1, 3, 2, 0, 4, 1, 2, 3];
                              break;
                            case 6:
                              We = [1, 4, 2, 0, 4, 1, 2, 3, 5];
                              break;
                            case 7:
                              We = [1, 4, 2, 0, 4, 1, 2, 3, 5, 6];
                              break;
                            case 8:
                              We = [1, 5, 3, 0, 6, 1, 2, 3, 4, 5, 7];
                              break;
                            case 130:
                              We = [1, 1, 2, 0, 1];
                              break;
                            case 131:
                              We = [1, 1, 3, 0, 1, 2];
                              break;
                            case 132:
                              We = [1, 1, 4, 0, 1, 2, 3];
                              break;
                            case 133:
                              We = [1, 1, 5, 0, 1, 2, 3, 4];
                              break;
                            case 134:
                              We = [1, 1, 6, 0, 1, 2, 3, 4, 5];
                              break;
                            case 135:
                              We = [1, 1, 7, 0, 1, 2, 3, 4, 5, 6];
                              break;
                            case 136:
                              We = [1, 1, 8, 0, 1, 2, 3, 4, 5, 6, 7];
                          }
                          for (
                            var qe = new Uint8Array(
                                [
                                  0,
                                  Ke.channelCount,
                                  0,
                                  0,
                                  (Ke.sampleRate >>> 24) & 255,
                                  (Ke.sampleRate >>> 17) & 255,
                                  (Ke.sampleRate >>> 8) & 255,
                                  (Ke.sampleRate >>> 0) & 255,
                                  0,
                                  0,
                                ].concat(m(We)),
                              ),
                              Xe = Ke.sampleRate,
                              Ye = g(l.ub()),
                              Qe = Ye.next();
                            !Qe.done;
                            Qe = Ye.next()
                          ) {
                            var Je = Qe.value,
                              Ze = Je.data;
                            null == He && null !== Je.pts && (He = Je.pts);
                            for (var et = 0; et < Ze.length; ) {
                              for (
                                var tt = !!(16 & Ze[et + 1]), it = !!(8 & Ze[et + 1]), nt = et + 2, at = 0;
                                255 === Ze[nt];
                              )
                                ((at += 255), (nt += 1));
                              ((at += Ze[nt]), (nt += 1), (nt += tt ? 2 : 0), (nt += it ? 2 : 0));
                              var st = Ze.slice(nt, nt + at);
                              (Ve.push({
                                data: st,
                                size: st.byteLength,
                                duration: 960,
                                sb: 0,
                                flags: { xb: 0, mb: 0, jb: 0, hb: 0, ib: 2, yb: 0 },
                              }),
                                (et = nt + at));
                            }
                          }
                          if (0 == qe.byteLength || null == He) throw new ze(2, 3, 3018, r ? r.P()[0] : null);
                          ((t.audioSamplingRate = Ke.sampleRate), (t.channelsCount = Ke.channelCount));
                          var ot = (He / 9e4) * Xe;
                          h = {
                            id: t.id,
                            type: "audio",
                            codecs: "opus",
                            encrypted: t.encrypted && t.drmInfos.length > 0,
                            timescale: Xe,
                            duration: i,
                            Bb: [],
                            Ga: qe,
                            Sa: new Uint8Array([]),
                            Za: 0,
                            $a: 0,
                            data: { sequenceNumber: this.g, baseMediaDecodeTime: ot, zb: Ve },
                            stream: t,
                          };
                      }
                      h && (u.push(h), (h = null));
                    }
                  } catch (gt) {
                    return gt && 3023 == gt.code ? Promise.resolve(new Uint8Array([])) : Promise.reject(gt);
                  }
                  if (!u.length) return Promise.reject(new ze(2, 3, 3018, r ? r.P()[0] : null));
                  var ut = new us(u),
                    dt = t.id + "_" + r.i;
                  if (this.j.has(dt)) var ht = this.j.get(dt);
                  else ((ht = ds(ut)), this.j.set(dt, ht));
                  var ct = this.l !== ht,
                    pt = gs(ut);
                  return ((this.l = ht), this.g++, Promise.resolve({ data: pt, init: ct ? ht : null }));
                }),
                j("shaka.transmuxer.TsTransmuxer", dw),
                (dw.prototype.transmux = dw.prototype.transmux),
                (dw.prototype.getOriginalMimeType = dw.prototype.getOriginalMimeType),
                (dw.prototype.convertCodecs = dw.prototype.convertCodecs),
                (dw.prototype.isSupported = dw.prototype.isSupported),
                (dw.prototype.destroy = dw.prototype.destroy));
              var hw = ["aac", "ac-3", "ec-3", "mp3", "opus"],
                cw = ["avc", "hevc"];
              function fw() {}
              (ei(
                "video/mp2t",
                function () {
                  return new dw("video/mp2t");
                },
                ai,
              ),
                f(fw, Hu),
                j("shaka.util.FairPlayUtils", fw));
            }.call(t, e, e, void 0),
            t.shaka))
              hl[r] = t.shaka[r];
          })());
        var pl,
          gl,
          ml = {
            lightning: {
              debug: !1,
              focusDebug: !1,
              fontSettings: { fontFamily: "Roboto", color: 4294967295, fontSize: 40 },
              animationSettings: { easing: "ease-in-out", duration: 250 },
              rendererOptions: {
                appHeight: 1080,
                appWidth: 1920,
                numImageWorkers: 2,
                fontEngines: [
                  class extends dt {
                    constructor(e) {
                      (super(e),
                        o(this, "ssdfFontFamilies", {}),
                        o(this, "msdfFontFamilies", {}),
                        o(this, "fontFamilyArray", [this.ssdfFontFamilies, this.msdfFontFamilies]),
                        o(this, "sdfShader", void 0),
                        o(this, "rendererBounds", void 0),
                        o(this, "type", "sdf"),
                        (this.sdfShader = this.stage.shManager.loadShader("SdfShader", {
                          transform: new Float32Array(),
                          color: 0,
                          size: 0,
                          scrollY: 0,
                          distanceRange: 0,
                          debug: !1,
                        }).shader),
                        (this.rendererBounds = {
                          x1: 0,
                          y1: 0,
                          x2: this.stage.options.appWidth,
                          y2: this.stage.options.appHeight,
                        }));
                    }
                    getPropertySetters() {
                      return {
                        fontFamily: (e, t) => {
                          ((e.props.fontFamily = t), this.releaseFontFace(e), this.invalidateLayoutCache(e));
                        },
                        fontWeight: (e, t) => {
                          ((e.props.fontWeight = t), this.releaseFontFace(e), this.invalidateLayoutCache(e));
                        },
                        fontStyle: (e, t) => {
                          ((e.props.fontStyle = t), this.releaseFontFace(e), this.invalidateLayoutCache(e));
                        },
                        fontStretch: (e, t) => {
                          ((e.props.fontStretch = t), this.releaseFontFace(e), this.invalidateLayoutCache(e));
                        },
                        fontSize: (e, t) => {
                          ((e.props.fontSize = t), this.invalidateLayoutCache(e));
                        },
                        text: (e, t) => {
                          ((e.props.text = t), this.invalidateLayoutCache(e));
                        },
                        textAlign: (e, t) => {
                          ((e.props.textAlign = t), this.invalidateLayoutCache(e));
                        },
                        color: (e, t) => {
                          e.props.color = t;
                        },
                        x: (e, t) => {
                          ((e.props.x = t),
                            e.elementBounds.valid &&
                              (this.setElementBoundsX(e),
                              !e.renderWindow.valid &&
                                E(e.elementBounds, this.rendererBounds) &&
                                this.scheduleUpdateState(e)));
                        },
                        y: (e, t) => {
                          ((e.props.y = t),
                            e.elementBounds.valid &&
                              (this.setElementBoundsY(e),
                              !e.renderWindow.valid &&
                                E(e.elementBounds, this.rendererBounds) &&
                                this.scheduleUpdateState(e)));
                        },
                        contain: (e, t) => {
                          ((e.props.contain = t), this.invalidateLayoutCache(e));
                        },
                        width: (e, t) => {
                          ((e.props.width = t), "none" !== e.props.contain && this.invalidateLayoutCache(e));
                        },
                        height: (e, t) => {
                          ((e.props.height = t), "both" === e.props.contain && this.invalidateLayoutCache(e));
                        },
                        offsetY: (e, t) => {
                          ((e.props.offsetY = t), this.invalidateLayoutCache(e));
                        },
                        scrollable: (e, t) => {
                          ((e.props.scrollable = t), this.invalidateLayoutCache(e));
                        },
                        scrollY: (e, t) => {
                          ((e.props.scrollY = t), this.scheduleUpdateState(e));
                        },
                        letterSpacing: (e, t) => {
                          ((e.props.letterSpacing = t), this.invalidateLayoutCache(e));
                        },
                        lineHeight: (e, t) => {
                          ((e.props.lineHeight = t),
                            (e.resLineHeight = void 0),
                            this.invalidateLayoutCache(e));
                        },
                        maxLines: (e, t) => {
                          ((e.props.maxLines = t), this.invalidateLayoutCache(e));
                        },
                        textBaseline: (e, t) => {
                          ((e.props.textBaseline = t), this.invalidateLayoutCache(e));
                        },
                        verticalAlign: (e, t) => {
                          ((e.props.verticalAlign = t), this.invalidateLayoutCache(e));
                        },
                        overflowSuffix: (e, t) => {
                          ((e.props.overflowSuffix = t), this.invalidateLayoutCache(e));
                        },
                        debug: (e, t) => {
                          e.props.debug = t;
                        },
                      };
                    }
                    canRenderFont(e) {
                      var t = e.fontFamily;
                      return (
                        t in this.ssdfFontFamilies ||
                        t in this.msdfFontFamilies ||
                        "$$SDF_FAILURE_TEST$$" === t
                      );
                    }
                    isFontFaceSupported(e) {
                      return e instanceof Pt;
                    }
                    addFontFace(e) {
                      var t = e.fontFamily,
                        r =
                          "ssdf" === e.type
                            ? this.ssdfFontFamilies
                            : "msdf" === e.type
                              ? this.msdfFontFamilies
                              : void 0;
                      if (r) {
                        var i = r[t];
                        (i || ((i = new Set()), (r[t] = i)), i.add(e));
                      } else console.warn(`Invalid font face type: ${e.type}`);
                    }
                    createState(e) {
                      return {
                        props: e,
                        status: "initialState",
                        updateScheduled: !1,
                        emitter: new v(),
                        lineCache: [],
                        forceFullLayoutCalc: !1,
                        renderWindow: {
                          screen: { x1: 0, y1: 0, x2: 0, y2: 0 },
                          sdf: { x1: 0, y1: 0, x2: 0, y2: 0 },
                          firstLineIdx: 0,
                          numLines: 0,
                          valid: !1,
                        },
                        elementBounds: { x1: 0, y1: 0, x2: 0, y2: 0, valid: !1 },
                        clippingRect: { x: 0, y: 0, width: 0, height: 0, valid: !1 },
                        bufferNumFloats: 0,
                        bufferNumQuads: 0,
                        vertexBuffer: void 0,
                        webGlBuffers: null,
                        bufferUploaded: !1,
                        textH: void 0,
                        textW: void 0,
                        distanceRange: 0,
                        trFontFace: void 0,
                        isRenderable: !1,
                        resLineHeight: void 0,
                        debugData: {
                          updateCount: 0,
                          layoutCount: 0,
                          lastLayoutNumCharacters: 0,
                          layoutSum: 0,
                          drawSum: 0,
                          drawCount: 0,
                          bufferSize: 0,
                        },
                      };
                    }
                    updateState(e) {
                      var t = e.trFontFace,
                        r = e.textH,
                        i = e.lineCache,
                        n = e.debugData,
                        a = e.forceFullLayoutCalc;
                      if (
                        (n.updateCount++,
                        "initialState" === e.status && this.setStatus(e, "loading"),
                        void 0 === t)
                      ) {
                        if (((t = this.resolveFontFace(e.props)), (e.trFontFace = t), void 0 === t)) {
                          var s = `SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;
                          return (console.error(s), void this.setStatus(e, "failed", new Error(s)));
                        }
                        t.texture.setRenderableOwner(e.props.fontFamily, !0);
                      }
                      if (!1 !== t.loaded) {
                        (t.data, t.metrics);
                        var o = e.props,
                          l = o.text,
                          u = o.fontSize,
                          d = o.x,
                          h = o.y,
                          c = o.contain,
                          f = o.width,
                          p = o.height,
                          g = o.verticalAlign,
                          m = o.scrollable,
                          v = o.overflowSuffix,
                          y = o.maxLines,
                          T = "both" === c && m ? e.props.scrollY : 0,
                          b = e.renderWindow,
                          S = t.data.info.size,
                          x = u / S,
                          w = e.resLineHeight;
                        if (void 0 === w) {
                          var A = e.props.lineHeight;
                          ((w =
                            void 0 === A
                              ? (function (e, t) {
                                  return t * (e.ascender - e.descender + e.lineGap);
                                })(t.metrics, u)
                              : A),
                            (e.resLineHeight = w));
                        }
                        var I = w / x;
                        e.distanceRange = x * t.data.distanceField.distanceRange;
                        var k = 24 * l.length,
                          R = e.vertexBuffer;
                        (!R || R.length < k) && (R = new Float32Array(2 * k));
                        var C = e.elementBounds;
                        if (
                          (C.valid || (this.setElementBoundsX(e), this.setElementBoundsY(e), (C.valid = !0)),
                          !a && b.valid)
                        ) {
                          var L = b.screen;
                          if (
                            d + L.x1 <= C.x1 &&
                            d + L.x2 >= C.x2 &&
                            h - T + L.y1 <= C.y1 &&
                            h - T + L.y2 >= C.y2
                          )
                            return void this.setStatus(e, "loaded");
                          ((b.valid = !1), this.setStatus(e, "loading"));
                        }
                        var M = e.props,
                          D = M.offsetY,
                          _ = M.textAlign;
                        if (!b.valid) {
                          if (!E(C, this.rendererBounds)) return;
                          ll(b, d, h, T, w, "both" === c ? C.y2 - C.y1 : 0, C, x);
                        }
                        var P = (function (e, t, r, i, n, a, s, o, l) {
                          var u = Math.min(Math.max(s.firstLineIdx, 0), o.length),
                            d = r.metrics;
                          r.data;
                          var h = (d.ascender - d.descender) * e,
                            c = 0;
                          "middle" === i ? (c = (t - h) / 2) : "bottom" === i && (c = t - h);
                          var f = n / a,
                            p = r.data.common.base,
                            g = f + (d.ascender * e - p) + u * t + c;
                          if (!(l && g >= l / a)) return { sdfX: 0, sdfY: g, lineIndex: u };
                        })(S, I, t, g, D, x, b, i, r);
                        if (P) {
                          var O = e.props.letterSpacing,
                            N = ol(
                              P.lineIndex,
                              P.sdfX,
                              P.sdfY,
                              l,
                              _,
                              f,
                              p,
                              u,
                              w,
                              O,
                              R,
                              c,
                              i,
                              b.sdf,
                              t,
                              a,
                              m,
                              v,
                              y,
                            );
                          ((e.bufferUploaded = !1),
                            (e.bufferNumFloats = N.bufferNumFloats),
                            (e.bufferNumQuads = N.bufferNumQuads),
                            (e.vertexBuffer = R),
                            (e.renderWindow = b),
                            (n.lastLayoutNumCharacters = N.layoutNumCharacters),
                            (n.bufferSize = R.byteLength),
                            N.fullyProcessed && ((e.textW = N.maxX * x), (e.textH = N.numLines * I * x)),
                            this.setStatus(e, "loaded"));
                        } else this.setStatus(e, "loaded");
                      } else
                        t.once("loaded", () => {
                          this.scheduleUpdateState(e);
                        });
                    }
                    renderQuads(e, t, r, i, n, a) {
                      var s, o;
                      if (e.vertexBuffer) {
                        var l,
                          u,
                          d = this.stage.renderer,
                          c = e.props,
                          f = c.fontSize,
                          p = c.color,
                          g = c.contain,
                          m = c.scrollable,
                          v = c.zIndex,
                          y = c.debug,
                          T = "both" === g && m ? e.props.scrollY : 0,
                          b = e.textW,
                          S = void 0 === b ? 0 : b,
                          E = e.textH,
                          A = void 0 === E ? 0 : E,
                          I = e.distanceRange,
                          k = e.vertexBuffer,
                          R = e.bufferUploaded,
                          C = e.trFontFace,
                          L = e.elementBounds,
                          M = e.webGlBuffers;
                        if (!M) {
                          var D = d.glw,
                            _ = 4 * Float32Array.BYTES_PER_ELEMENT,
                            P = D.createBuffer();
                          ((e.webGlBuffers = new Rt([
                            {
                              buffer: P,
                              attributes: {
                                a_position: {
                                  name: "a_position",
                                  size: 2,
                                  type: D.FLOAT,
                                  normalized: !1,
                                  stride: _,
                                  offset: 0,
                                },
                                a_textureCoordinate: {
                                  name: "a_textureCoordinate",
                                  size: 2,
                                  type: D.FLOAT,
                                  normalized: !1,
                                  stride: _,
                                  offset: 2 * Float32Array.BYTES_PER_ELEMENT,
                                },
                              },
                            },
                          ])),
                            (e.bufferUploaded = !1),
                            e.webGlBuffers,
                            (M = e.webGlBuffers));
                        }
                        if (!R) {
                          var O,
                            N,
                            F = d.glw,
                            U =
                              null !==
                                (O =
                                  null === (N = M) || void 0 === N
                                    ? void 0
                                    : N.getBuffer("a_textureCoordinate")) && void 0 !== O
                                ? O
                                : null;
                          (F.arrayBufferData(U, k, F.STATIC_DRAW), (e.bufferUploaded = !0));
                        }
                        if (m && "both" === g) {
                          L.valid;
                          var B =
                            ((l = L),
                            (u = ul)
                              ? ((u.x = l.x1),
                                (u.y = l.y1),
                                (u.width = l.x2 - l.x1),
                                (u.height = l.y2 - l.y1),
                                u)
                              : { x: l.x1, y: l.y1, width: l.x2 - l.x1, height: l.y2 - l.y1 });
                          r.valid
                            ? ((e.clippingRect.valid = !0), (r = x(r, B, e.clippingRect)))
                            : ((e.clippingRect.valid = !0), (r = w(B, e.clippingRect)));
                        }
                        var $ = new St(
                            d.glw,
                            d.options,
                            M,
                            this.sdfShader,
                            {
                              transform: t.getFloatArr(),
                              color: h(p, i),
                              size: f / ((null === (s = C.data) || void 0 === s ? void 0 : s.info.size) || 0),
                              scrollY: T,
                              distanceRange: I,
                              debug: y.sdfShaderDebug,
                            },
                            i,
                            r,
                            { height: A, width: S },
                            0,
                            v,
                            !1,
                            n,
                            a,
                          ),
                          j = (null === (o = e.trFontFace) || void 0 === o ? void 0 : o.texture).ctxTexture;
                        ($.addTexture(j),
                          ($.length = e.bufferNumFloats),
                          ($.numQuads = e.bufferNumQuads),
                          d.addRenderOp($));
                      }
                    }
                    setIsRenderable(e, t) {
                      var r;
                      (super.setIsRenderable(e, t),
                        null === (r = e.trFontFace) ||
                          void 0 === r ||
                          r.texture.setRenderableOwner(e.props.fontFamily, t));
                    }
                    destroyState(e) {
                      var t;
                      (super.destroyState(e),
                        null === (t = e.trFontFace) ||
                          void 0 === t ||
                          t.texture.setRenderableOwner(e.props.fontFamily, !1));
                    }
                    resolveFontFace(e) {
                      return this.stage.fontManager.resolveFontFace(this.fontFamilyArray, e, "sdf");
                    }
                    releaseFontFace(e) {
                      ((e.resLineHeight = void 0),
                        e.trFontFace &&
                          (e.trFontFace.texture.setRenderableOwner(e.props.fontFamily, !1),
                          (e.trFontFace = void 0)));
                    }
                    invalidateLayoutCache(e) {
                      ((e.renderWindow.valid = !1),
                        (e.elementBounds.valid = !1),
                        (e.textH = void 0),
                        (e.textW = void 0),
                        (e.lineCache = []),
                        this.setStatus(e, "loading"),
                        this.scheduleUpdateState(e));
                    }
                    setElementBoundsX(e) {
                      var t = e.props,
                        r = t.x,
                        i = t.contain,
                        n = t.width,
                        a = e.elementBounds;
                      ((a.x1 = r), (a.x2 = "none" !== i ? r + n : 1 / 0));
                    }
                    setElementBoundsY(e) {
                      var t = e.props,
                        r = t.y,
                        i = t.contain,
                        n = t.height,
                        a = e.elementBounds;
                      ((a.y1 = r), (a.y2 = "both" === i ? r + n : 1 / 0));
                    }
                  },
                ],
                renderEngine: class extends pt {
                  constructor(e) {
                    (super(e),
                      o(this, "glw", void 0),
                      o(this, "system", void 0),
                      o(this, "quadBuffer", void 0),
                      o(this, "fQuadBuffer", void 0),
                      o(this, "uiQuadBuffer", void 0),
                      o(this, "renderOps", []),
                      o(this, "curBufferIdx", 0),
                      o(this, "curRenderOp", null),
                      o(this, "rttNodes", []),
                      o(this, "activeRttNode", null),
                      o(this, "defShaderCtrl", void 0),
                      o(this, "defaultShader", void 0),
                      o(this, "quadBufferCollection", void 0),
                      o(this, "clearColor", { raw: 0, normalized: [0, 0, 0, 0] }),
                      o(this, "quadBufferUsage", 0),
                      o(this, "numQuadsRendered", 0),
                      o(this, "renderToTextureActive", !1),
                      (this.quadBuffer = new ArrayBuffer(this.stage.options.quadBufferSize)),
                      (this.fQuadBuffer = new Float32Array(this.quadBuffer)),
                      (this.uiQuadBuffer = new Uint32Array(this.quadBuffer)),
                      (this.mode = "webgl"));
                    var t = e.canvas,
                      r = e.clearColor,
                      i = e.bufferMemory,
                      n = (function (e, t = !1, r) {
                        var i = {
                            alpha: !0,
                            antialias: !1,
                            depth: !1,
                            stencil: !0,
                            desynchronized: !1,
                            powerPreference: "high-performance",
                            premultipliedAlpha: !0,
                            preserveDrawingBuffer: !1,
                          },
                          n =
                            e.getContext(t ? "webgl2" : "webgl", i) || e.getContext("experimental-webgl", i);
                        if (!n) throw new Error("Unable to create WebGL context");
                        return r
                          ? new Proxy(n, {
                              get(e, t) {
                                var i = e[t];
                                return "function" == typeof i ? (r.increment(String(t)), i.bind(e)) : i;
                              },
                            })
                          : n;
                      })(t, e.forceWebGL2, e.contextSpy),
                      a = (this.glw = new Ct(n));
                    (a.viewport(0, 0, t.width, t.height),
                      this.updateClearColor(r),
                      a.setBlend(!0),
                      a.blendFunc(a.ONE, a.ONE_MINUS_SRC_ALPHA),
                      (function (e, t) {
                        for (
                          var r = ~~(t / 80), i = new Uint16Array(6 * r), n = 0, a = 0;
                          n < r;
                          n += 6, a += 4
                        )
                          ((i[n] = a),
                            (i[n + 1] = a + 1),
                            (i[n + 2] = a + 2),
                            (i[n + 3] = a + 2),
                            (i[n + 4] = a + 1),
                            (i[n + 5] = a + 3));
                        var s = e.createBuffer();
                        e.elementArrayBufferData(s, i, e.STATIC_DRAW);
                      })(a, i),
                      (this.system = { parameters: Et(this.glw), extensions: xt(this.glw) }),
                      (this.shManager.renderer = this),
                      (this.defShaderCtrl = this.shManager.loadShader("DefaultShader")),
                      (this.defaultShader = this.defShaderCtrl.shader));
                    var s = a.createBuffer(),
                      l = 8 * Float32Array.BYTES_PER_ELEMENT;
                    this.quadBufferCollection = new Rt([
                      {
                        buffer: s,
                        attributes: {
                          a_position: {
                            name: "a_position",
                            size: 2,
                            type: a.FLOAT,
                            normalized: !1,
                            stride: l,
                            offset: 0,
                          },
                          a_textureCoordinate: {
                            name: "a_textureCoordinate",
                            size: 2,
                            type: a.FLOAT,
                            normalized: !1,
                            stride: l,
                            offset: 2 * Float32Array.BYTES_PER_ELEMENT,
                          },
                          a_color: {
                            name: "a_color",
                            size: 4,
                            type: a.UNSIGNED_BYTE,
                            normalized: !0,
                            stride: l,
                            offset: 4 * Float32Array.BYTES_PER_ELEMENT,
                          },
                          a_textureIndex: {
                            name: "a_textureIndex",
                            size: 1,
                            type: a.FLOAT,
                            normalized: !1,
                            stride: l,
                            offset: 5 * Float32Array.BYTES_PER_ELEMENT,
                          },
                          a_nodeCoordinate: {
                            name: "a_nodeCoordinate",
                            size: 2,
                            type: a.FLOAT,
                            normalized: !1,
                            stride: l,
                            offset: 6 * Float32Array.BYTES_PER_ELEMENT,
                          },
                        },
                      },
                    ]);
                  }
                  reset() {
                    var e = this.glw;
                    ((this.curBufferIdx = 0),
                      (this.curRenderOp = null),
                      (this.renderOps.length = 0),
                      e.setScissorTest(!1),
                      e.clear());
                  }
                  getShaderManager() {
                    return this.shManager;
                  }
                  createCtxTexture(e) {
                    return e instanceof Se
                      ? new kt(this.glw, this.txMemManager, e)
                      : e instanceof Ee
                        ? new Lt(this.glw, this.txMemManager, e)
                        : new It(this.glw, this.txMemManager, e);
                  }
                  addQuad(e) {
                    var t = this.fQuadBuffer,
                      r = this.uiQuadBuffer,
                      i = e.texture;
                    if (e.shader !== this.defaultShader) {
                      if (1 == p(e.shaderProps, "$dimensions")) {
                        var n = e.shaderProps.$dimensions;
                        ((n.width = e.width), (n.height = e.height));
                      }
                      !0 === p(e.shaderProps, "$alpha") && (e.shaderProps.$alpha = e.alpha);
                    }
                    var a = this.curBufferIdx,
                      s = (this.curRenderOp, { width: e.width, height: e.height });
                    !1 === this.reuseRenderOp(e) &&
                      (this.newRenderOp(
                        e.shader,
                        e.shaderProps,
                        e.alpha,
                        s,
                        e.clippingRect,
                        a,
                        e.rtt,
                        e.parentHasRenderTexture,
                        e.framebufferDimensions,
                      ),
                      this.curRenderOp);
                    var o = void 0,
                      l = 0,
                      u = 0,
                      d = 1,
                      h = 1;
                    if (i.type === m.subTexture) {
                      var c = i.props,
                        f = c.x,
                        g = c.y,
                        v = c.width,
                        y = c.height,
                        T = i.parentTexture.dimensions || { width: 0, height: 0 },
                        b = T.width,
                        S = void 0 === b ? 0 : b,
                        E = T.height,
                        x = void 0 === E ? 0 : E;
                      ((d = (l = f / S) + v / S),
                        (h = (u = g / x) + y / x),
                        (o = (i = i.parentTexture).ctxTexture));
                    } else
                      ((l = (o = i.ctxTexture).txCoordX1),
                        (u = o.txCoordY1),
                        (d = o.txCoordX2),
                        (h = o.txCoordY2));
                    if (
                      i.type === m.image &&
                      null !== e.textureOptions &&
                      void 0 !== e.textureOptions.resizeMode &&
                      null !== i.dimensions
                    ) {
                      var w = e.textureOptions.resizeMode,
                        A = i.dimensions,
                        I = A.width,
                        k = A.height;
                      if ("cover" === w.type) {
                        var R = e.width / I,
                          C = e.height / k,
                          L = Math.max(R, C),
                          M = 1 / L;
                        if (L && R && R < L) {
                          var D,
                            _ = M * e.width;
                          d = (l = (1 - _ / I) * (null !== (D = w.clipX) && void 0 !== D ? D : 0.5)) + _ / I;
                        }
                        if (L && C && C < L) {
                          var P,
                            O = M * e.height;
                          h = (u = (1 - O / k) * (null !== (P = w.clipY) && void 0 !== P ? P : 0.5)) + O / k;
                        }
                      }
                    }
                    var N = 0;
                    if (null !== e.textureOptions) {
                      if (!0 === e.textureOptions.flipX) {
                        var F = [d, l];
                        ((l = F[0]), (d = F[1]));
                      }
                      N = +(e.textureOptions.flipY || !1);
                    }
                    if (N ^ +(i.type === m.renderToTexture)) {
                      var U = [h, u];
                      ((u = U[0]), (h = U[1]));
                    }
                    var B = this.addTexture(o, a);
                    if ((this.curRenderOp, e.renderCoords))
                      ((t[a++] = e.renderCoords.x1),
                        (t[a++] = e.renderCoords.y1),
                        (t[a++] = l),
                        (t[a++] = u),
                        (r[a++] = e.colorTl),
                        (t[a++] = B),
                        (t[a++] = 0),
                        (t[a++] = 0),
                        (t[a++] = e.renderCoords.x2),
                        (t[a++] = e.renderCoords.y2),
                        (t[a++] = d),
                        (t[a++] = u),
                        (r[a++] = e.colorTr),
                        (t[a++] = B),
                        (t[a++] = 1),
                        (t[a++] = 0),
                        (t[a++] = e.renderCoords.x4),
                        (t[a++] = e.renderCoords.y4),
                        (t[a++] = l),
                        (t[a++] = h),
                        (r[a++] = e.colorBl),
                        (t[a++] = B),
                        (t[a++] = 0),
                        (t[a++] = 1),
                        (t[a++] = e.renderCoords.x3),
                        (t[a++] = e.renderCoords.y3),
                        (t[a++] = d),
                        (t[a++] = h),
                        (r[a++] = e.colorBr),
                        (t[a++] = B),
                        (t[a++] = 1),
                        (t[a++] = 1));
                    else if (0 !== e.tb || 0 !== e.tc)
                      ((t[a++] = e.tx),
                        (t[a++] = e.ty),
                        (t[a++] = l),
                        (t[a++] = u),
                        (r[a++] = e.colorTl),
                        (t[a++] = B),
                        (t[a++] = 0),
                        (t[a++] = 0),
                        (t[a++] = e.tx + e.width * e.ta),
                        (t[a++] = e.ty + e.width * e.tc),
                        (t[a++] = d),
                        (t[a++] = u),
                        (r[a++] = e.colorTr),
                        (t[a++] = B),
                        (t[a++] = 1),
                        (t[a++] = 0),
                        (t[a++] = e.tx + e.height * e.tb),
                        (t[a++] = e.ty + e.height * e.td),
                        (t[a++] = l),
                        (t[a++] = h),
                        (r[a++] = e.colorBl),
                        (t[a++] = B),
                        (t[a++] = 0),
                        (t[a++] = 1),
                        (t[a++] = e.tx + e.width * e.ta + e.height * e.tb),
                        (t[a++] = e.ty + e.width * e.tc + e.height * e.td),
                        (t[a++] = d),
                        (t[a++] = h),
                        (r[a++] = e.colorBr),
                        (t[a++] = B),
                        (t[a++] = 1),
                        (t[a++] = 1));
                    else {
                      var $ = e.tx + e.width * e.ta,
                        j = e.ty + e.height * e.td;
                      ((t[a++] = e.tx),
                        (t[a++] = e.ty),
                        (t[a++] = l),
                        (t[a++] = u),
                        (r[a++] = e.colorTl),
                        (t[a++] = B),
                        (t[a++] = 0),
                        (t[a++] = 0),
                        (t[a++] = $),
                        (t[a++] = e.ty),
                        (t[a++] = d),
                        (t[a++] = u),
                        (r[a++] = e.colorTr),
                        (t[a++] = B),
                        (t[a++] = 1),
                        (t[a++] = 0),
                        (t[a++] = e.tx),
                        (t[a++] = j),
                        (t[a++] = l),
                        (t[a++] = h),
                        (r[a++] = e.colorBl),
                        (t[a++] = B),
                        (t[a++] = 0),
                        (t[a++] = 1),
                        (t[a++] = $),
                        (t[a++] = j),
                        (t[a++] = d),
                        (t[a++] = h),
                        (r[a++] = e.colorBr),
                        (t[a++] = B),
                        (t[a++] = 1),
                        (t[a++] = 1));
                    }
                    (this.curRenderOp.numQuads++, (this.curBufferIdx = a));
                  }
                  newRenderOp(e, t, r, i, n, a, s, o, l) {
                    var u = new St(
                      this.glw,
                      this.options,
                      this.quadBufferCollection,
                      e,
                      t,
                      r,
                      n,
                      i,
                      a,
                      0,
                      s,
                      o,
                      l,
                    );
                    ((this.curRenderOp = u), this.renderOps.push(u));
                  }
                  addTexture(e, t, r) {
                    var i = this.curRenderOp,
                      n = i.addTexture(e);
                    if (4294967295 === n) {
                      if (r) throw new Error("Unable to add texture to render op");
                      return (
                        this.newRenderOp(i.shader, i.shaderProps, i.alpha, i.dimensions, i.clippingRect, t),
                        this.addTexture(e, t, !0)
                      );
                    }
                    return n;
                  }
                  reuseRenderOp(e) {
                    var t,
                      r,
                      i,
                      n = e.shader,
                      a = e.shaderProps,
                      s = e.parentHasRenderTexture,
                      o = e.rtt,
                      l = e.clippingRect;
                    return (
                      (null === (t = this.curRenderOp) || void 0 === t ? void 0 : t.shader) === n &&
                      !1 !=
                        ((r = this.curRenderOp.clippingRect) === (i = l) ||
                          (null !== r &&
                            null !== i &&
                            r.x === i.x &&
                            r.y === i.y &&
                            r.width === i.width &&
                            r.height === i.height)) &&
                      !0 !== s &&
                      !0 !== o &&
                      (this.curRenderOp.shader === this.defaultShader ||
                        !1 !== this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps, a))
                    );
                  }
                  addRenderOp(e) {
                    (this.renderOps.push(e), (this.curRenderOp = null));
                  }
                  render(e = "screen") {
                    var t = this.glw,
                      r = this.quadBuffer,
                      i = new Float32Array(r, 0, this.curBufferIdx),
                      n = this.quadBufferCollection.getBuffer("a_position") || null;
                    t.arrayBufferData(n, i, t.STATIC_DRAW);
                    for (var a = 0, s = this.renderOps.length; a < s; a++) this.renderOps[a].draw();
                    this.quadBufferUsage = this.curBufferIdx * i.BYTES_PER_ELEMENT;
                    var o = 8 * i.BYTES_PER_ELEMENT * 4;
                    this.numQuadsRendered = this.quadBufferUsage / o;
                  }
                  getQuadCount() {
                    return this.numQuadsRendered;
                  }
                  renderToTexture(e) {
                    for (var t = 0; t < this.rttNodes.length; t++) if (this.rttNodes[t] === e) return;
                    this.insertRTTNodeInOrder(e);
                  }
                  insertRTTNodeInOrder(e) {
                    for (var t = this.rttNodes.length, r = e; r && r.parent; ) {
                      var i = this.rttNodes.indexOf(r.parent);
                      if (-1 !== i) {
                        t = i;
                        break;
                      }
                      r = r.parent;
                    }
                    var n = this.findMaxChildRTTIndex(e);
                    (-1 !== n && (t = Math.max(t, n + 1)), this.rttNodes.splice(t, 0, e));
                  }
                  findMaxChildRTTIndex(e) {
                    var t = -1,
                      r = e => {
                        var i = this.rttNodes.indexOf(e);
                        -1 !== i && (t = Math.max(t, i));
                        var n,
                          a = l(e.children);
                        try {
                          for (a.s(); !(n = a.n()).done; ) {
                            var s = n.value;
                            r(s);
                          }
                        } catch (o) {
                          a.e(o);
                        } finally {
                          a.f();
                        }
                      };
                    return (r(e), t);
                  }
                  renderRTTNodes() {
                    for (var e = this.glw, t = (this.stage.txManager, 0); t < this.rttNodes.length; t++) {
                      var r = this.rttNodes[t];
                      if (
                        void 0 !== r &&
                        !1 !== r.hasRTTupdates &&
                        0 !== r.worldAlpha &&
                        (!0 !== r.strictBounds || r.renderState !== _.OutOfBounds) &&
                        null !== r.texture &&
                        "loaded" === r.texture.state
                      ) {
                        ((this.activeRttNode = r), u(r.texture));
                        var i = r.texture.ctxTexture;
                        ((this.renderToTextureActive = !0),
                          e.bindFramebuffer(i.framebuffer),
                          e.viewport(0, 0, i.w, i.h),
                          e.clearColor(0, 0, 0, 0),
                          e.clear());
                        for (var n = 0; n < r.children.length; n++) {
                          var a = r.children[n];
                          void 0 !== a && (this.stage.addQuads(a), (a.hasRTTupdates = !1));
                        }
                        (this.render(), (this.renderOps.length = 0), (r.hasRTTupdates = !1));
                      }
                    }
                    var s = this.clearColor.normalized;
                    (e.clearColor(s[0], s[1], s[2], s[3]),
                      e.bindFramebuffer(null),
                      e.viewport(0, 0, this.glw.canvas.width, this.glw.canvas.height),
                      (this.renderToTextureActive = !1));
                  }
                  removeRTTNode(e) {
                    var t = this.rttNodes.indexOf(e);
                    -1 !== t && this.rttNodes.splice(t, 1);
                  }
                  getBufferInfo() {
                    return {
                      totalAvailable: this.stage.options.quadBufferSize,
                      totalUsed: this.quadBufferUsage,
                    };
                  }
                  getDefShaderCtr() {
                    return this.defShaderCtrl;
                  }
                  updateClearColor(e) {
                    if (this.clearColor.raw !== e) {
                      var t = this.glw,
                        r = b(e);
                      (t.clearColor(r[0], r[1], r[2], r[3]),
                        (this.clearColor = { raw: e, normalized: r }),
                        t.clear());
                    }
                  }
                },
                deviceLogicalPixelRatio: 1,
                devicePhysicalPixelRatio: 1,
                boundsMargin: 20,
                createImageBitmapSupport: "auto",
              },
            },
            keys: {
              Back: ["Escape", 461, 27],
              Backspace: ["Backspace", 8],
              Left: ["ArrowLeft", 37],
              Right: ["ArrowRight", 39],
              Up: ["ArrowUp", 38],
              Down: ["ArrowDown", 40],
              Enter: ["Enter", 13],
            },
            keyHoldOptions: {
              userKeyHoldMap: { EnterHold: ["Enter", 13], BackHold: ["b", 66] },
              holdThreshold: 1e3,
            },
          },
          vl = new URLSearchParams(window.location.search).get("posterSize") || "w185",
          yl = {
            headers: {
              "Content-Type": "application/json",
              Authorization:
                "Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxODU4MjY0ZTM2ZWQ1NzZkYzM3ZDU5MjJmNzM3MWRmNiIsIm5iZiI6MTY2NzIzOTgzMS45MDIwMDAyLCJzdWIiOiI2MzYwMGY5NzFkYmM4ODAwOTBmNTIxMDAiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.LXx9-LdX9JsiY0DhpmjYcYitlqPJqntNHVv-HGZXpww",
            },
          };
        function Tl(e, t = vl) {
          return gl + t + e;
        }
        function bl(e, r = {}) {
          return fetch("https://api.themoviedb.org/3" + e, t(t({}, yl), r)).then(e => e.json());
        }
        function Sl() {
          return bl("/configuration").then(e => {
            var t;
            return ((pl = e), (gl = null === (t = e.images) || void 0 === t ? void 0 : t.secure_base_url), e);
          });
        }
        var El = {
          get: function (e, t = {}) {
            return pl ? bl(e, t) : Sl().then(() => bl(e, t));
          },
          loadConfig: Sl,
        };
        function xl() {
          return (xl = s(
            i().m(function e(t) {
              var r, n, a;
              return i().w(
                function (e) {
                  for (;;)
                    switch ((e.p = e.n)) {
                      case 0:
                        return ((e.p = 0), (e.n = 1), El.get("/discover/movie"));
                      case 1:
                        return (
                          (r = e.v),
                          (n = t ? r.results.slice(0, 5) : r.results),
                          e.a(
                            2,
                            n.map(e => ({
                              title: e.title,
                              poster_path: e.poster_path,
                              overview: e.overview,
                              backdrop_path: e.backdrop_path,
                              id: e.id,
                            })),
                          )
                        );
                      case 2:
                        throw ((e.p = 2), (a = e.v), console.error(a), a);
                      case 3:
                        return e.a(2);
                    }
                },
                e,
                null,
                [[0, 2]],
              );
            }),
          )).apply(this, arguments);
        }
        function wl() {
          return (wl = s(
            i().m(function e() {
              var t, r;
              return i().w(
                function (e) {
                  for (;;)
                    switch ((e.p = e.n)) {
                      case 0:
                        return ((e.p = 0), (e.n = 1), El.get("/discover/movie"));
                      case 1:
                        return (
                          (t = e.v),
                          e.a(
                            2,
                            t.results.map(e => ({
                              title: e.title,
                              poster_path: e.poster_path,
                              overview: e.overview,
                              backdrop_path: e.backdrop_path,
                              id: e.id,
                            })),
                          )
                        );
                      case 2:
                        throw ((e.p = 2), (r = e.v), console.error(r), r);
                      case 3:
                        return e.a(2);
                    }
                },
                e,
                null,
                [[0, 2]],
              );
            }),
          )).apply(this, arguments);
        }
        function Al() {
          return (Al = s(
            i().m(function e(t) {
              var r, n, a;
              return i().w(
                function (e) {
                  for (;;)
                    switch ((e.p = e.n)) {
                      case 0:
                        return ((e.p = 0), (e.n = 1), El.get("/discover/tv"));
                      case 1:
                        return (
                          (r = e.v),
                          (n = t ? r.results.slice(0, 5) : r.results),
                          e.a(
                            2,
                            n.map(e => ({
                              title: e.name,
                              poster_path: e.poster_path,
                              overview: e.overview,
                              backdrop_path: e.backdrop_path,
                              id: e.id,
                            })),
                          )
                        );
                      case 2:
                        throw ((e.p = 2), (a = e.v), console.error(a), a);
                      case 3:
                        return e.a(2);
                    }
                },
                e,
                null,
                [[0, 2]],
              );
            }),
          )).apply(this, arguments);
        }
        function Il() {
          var e = [];
          return (
            e.push({
              title: "MOVIES",
              items: Wr(() =>
                (function (e) {
                  return xl.apply(this, arguments);
                })(!0),
              )[0],
            }),
            e.push({
              title: "SERIES",
              items: Wr(() =>
                (function (e) {
                  return Al.apply(this, arguments);
                })(!0),
              )[0],
            }),
            { rows: e }
          );
        }
        function kl() {
          var e = Wr(() =>
            (function () {
              return wl.apply(this, arguments);
            })(),
          );
          return { movies: r(e, 1)[0] };
        }
        var Rl = "" + new URL("logo-CWMc854L.png", n.meta.url).href,
          Cl = { display: "flex", flexDirection: "column", justifyContent: "center", alignItems: "center" },
          Ll = { fontFamily: "Roboto", fontSize: 32, color: 1465341951, $focus: { color: 4294967295 } },
          Ml = { width: "100%", height: 4, y: 4, color: 4278190335, alpha: 0, $focus: { alpha: 1 } };
        function Dl(e) {
          return Vi(
            Ji,
            zi(
              {
                forwardStates: !0,
                get style() {
                  return Cl;
                },
              },
              e,
              {
                get children() {
                  return [
                    Vi(Zi, {
                      get style() {
                        return Ll;
                      },
                      get children() {
                        return e.children;
                      },
                    }),
                    Vi(Ji, {
                      get style() {
                        return Ml;
                      },
                    }),
                  ];
                },
              },
            ),
          );
        }
        var _l = [
            { label: "Home", path: "/" },
            { label: "Movies", path: "/movies" },
          ],
          Pl = e => {
            var t,
              r,
              i = vn(),
              n = () => ("/" === ts() || i(-1), !0);
            return Vi(Ji, {
              onUp: () => t.setFocus(),
              onDown: () => r.setFocus(),
              onBack: n,
              onBackspace: n,
              get children() {
                return [
                  Vi(Ji, { x: 32, y: 32, src: Rl, width: 301, height: 60, zIndex: 200 }),
                  Vi(wa, {
                    x: 400,
                    y: 37,
                    gap: 20,
                    ref(e) {
                      "function" == typeof t ? t(e) : (t = e);
                    },
                    zIndex: 200,
                    get children() {
                      return Vi(Ii, {
                        each: _l,
                        children: t =>
                          Vi(
                            Dl,
                            zi(e, {
                              width: 118,
                              height: 49,
                              onEnter: () => i(t.path),
                              onClick: () => i(t.path),
                              get children() {
                                return t.label;
                              },
                            }),
                          ),
                      });
                    },
                  }),
                  Vi(Ji, {
                    y: 0,
                    ref(e) {
                      "function" == typeof r ? r(e) : (r = e);
                    },
                    forwardFocus: 0,
                    get children() {
                      return e.children;
                    },
                  }),
                ];
              },
            });
          },
          Ol = { scale: 1, $focus: { scale: 1.1 } },
          Nl = {
            fontFamily: "Inter",
            fontWeight: 400,
            fontSize: 24,
            maxLines: 1,
            contain: "width",
            lineHeight: 1,
            color: 4294967193,
            $focus: { color: 4294967295 },
          },
          Fl = { borderRadius: 6, $focus: { border: { width: 6, color: 3978044671 } } },
          Ul = e => {
            var t = e.item,
              r = (t.id, t.title),
              i = t.poster_path;
            return Vi(Ji, {
              id: "card",
              get width() {
                return e.style.width;
              },
              get height() {
                return e.style.height;
              },
              display: "flex",
              flexDirection: "column",
              gap: 16,
              style: Ol,
              forwardStates: !0,
              onEnter: () => e.onEnter(),
              get children() {
                return [
                  Vi(Ji, {
                    id: "pic",
                    style: Fl,
                    get src() {
                      return Tl(i, "w342");
                    },
                  }),
                  Vi(Zi, {
                    id: "text",
                    get y() {
                      return e.style.height;
                    },
                    get width() {
                      return e.style.width;
                    },
                    style: Nl,
                    children: r,
                  }),
                ];
              },
            });
          },
          Bl = "" + new URL("background-D7NRJyvC.jpg", n.meta.url).href,
          $l = { width: 229, height: 300 },
          jl = { width: 1920, height: 1080 },
          Gl = {
            width: 312,
            height: 837,
            alignItems: "center",
            justifyContent: "center",
            borderRadius: 16,
            gap: 16,
            color: 255,
          },
          Vl = {
            width: 280,
            height: 136,
            color: 404232447,
            borderRadius: 16,
            display: "flex",
            flexDirection: "column",
            justifyContent: "center",
            alignItems: "center",
            gap: 24,
            $focus: { border: { width: 4, color: 3978044671 } },
          },
          Hl = { fontFamily: "Inter", fontWeight: 400, fontSize: 16, lineHeight: 1, height: 19 },
          Kl = e =>
            Vi(Ji, {
              style: Vl,
              id: "card",
              get children() {
                return [
                  Vi(Ji, {
                    width: 45,
                    height: 45,
                    get src() {
                      return "static/images/channels/" + e.channel.image;
                    },
                  }),
                  Vi(Zi, {
                    style: Hl,
                    get children() {
                      return e.channel.name;
                    },
                  }),
                ];
              },
            }),
          Wl = [
            { name: "CBS", image: "CBS.png" },
            { name: "NBC", image: "NBC.png" },
            { name: "ABC", image: "ABC.png" },
            { name: "Fox", image: "FOX.png" },
            { name: "Fox News Channel", image: "FNC.png" },
          ],
          zl = {
            fontFamily: "Inter",
            fontWeight: 700,
            fontSize: 24,
            lineHeight: 1,
            width: 280,
            height: 29,
            display: "flex",
            justifyContent: "center",
            alignSelf: "center",
          },
          ql = () =>
            Vi(Ta, {
              get style() {
                return Gl;
              },
              flexBoundary: "fixed",
              get children() {
                return [
                  Vi(Ji, {
                    style: zl,
                    skipFocus: !0,
                    get children() {
                      return Vi(Zi, { style: zl, children: "Top 5 Channels" });
                    },
                  }),
                  Vi(Ii, { each: Wl, children: e => Vi(Kl, { channel: e }) }),
                ];
              },
            }),
          Xl = {
            borderRadius: 30,
            width: 352,
            height: 67,
            top: 19,
            color: 791621631,
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
            $focus: { color: 3978044671 },
          },
          Yl = { fontFace: "Inter", fontWeight: 600, fontSize: 24, letterSpacing: 0.06, display: "flex" },
          Ql = e =>
            Vi(Ji, {
              style: Xl,
              get children() {
                return Vi(Zi, { style: Yl, children: "GO TO LIVE PLAYER" });
              },
            });
        function Jl() {
          var e = vn();
          return {
            toDetails(t, r) {
              e(`/${r.toLowerCase()}/details/${t}`);
            },
          };
        }
        var Zl = "" + new URL("zabrinutiMita-BE4z5ffO.png", n.meta.url).href,
          eu = e => {
            var t;
            return (
              e.xPos,
              e.yPos,
              e.width,
              e.height,
              Xr(() => {
                t.animate({ rotation: 2 * Math.PI }, { duration: 1e3, repeat: -1, easing: "linear" }).start();
              }),
              [
                Vi(Ji, {
                  ref(e) {
                    "function" == typeof t ? t(e) : (t = e);
                  },
                  src: Zl,
                  width: 120,
                  height: 120,
                  zIndex: 200,
                  x: 960,
                  y: 540,
                  mountX: 0.5,
                  mountY: 0.5,
                }),
                Vi(Zi, { x: 880, y: 620, children: "Loading..." }),
              ]
            );
          },
          tu = { fontFamily: "Inter", fontWeight: 700, fontSize: 24, letterSpacing: 0.06, color: 4294967295 },
          ru = e => {
            (Ha(1920), za(1080), Oa(Bl));
            var t = () => {
              Oa(Bl);
            };
            Ca("movies");
            var r = Jl().toDetails;
            return Vi(ki, {
              get when() {
                return e.data.rows[0].items();
              },
              get fallback() {
                return Vi(eu, {});
              },
              get children() {
                return Vi(Ji, {
                  get style() {
                    return jl;
                  },
                  forwardFocus: 1,
                  onFocus: t,
                  get children() {
                    return [
                      Vi(Ji, { id: "gradient", width: 1920, height: 1080, colorTl: 353703423, colorBr: 0 }),
                      Vi(Ta, {
                        y: 125,
                        x: 62,
                        gap: 5,
                        get children() {
                          return [
                            Vi(wa, {
                              id: "homeContainer",
                              scroll: "none",
                              get children() {
                                return [
                                  Vi(Ta, {
                                    id: "mediaContainer",
                                    width: 1241,
                                    height: 404,
                                    autofocus: !0,
                                    get children() {
                                      return Vi(Ii, {
                                        get each() {
                                          return e.data.rows;
                                        },
                                        children: e => [
                                          Vi(Zi, {
                                            style: tu,
                                            skipFocus: !0,
                                            get children() {
                                              return e.title;
                                            },
                                          }),
                                          Vi(wa, {
                                            width: 1241,
                                            height: 359,
                                            gap: 24,
                                            scroll: "none",
                                            get children() {
                                              return Vi(Ii, {
                                                get each() {
                                                  return e.items();
                                                },
                                                children: t =>
                                                  Vi(Ul, {
                                                    item: t,
                                                    get style() {
                                                      return $l;
                                                    },
                                                    onEnter: () => r(t.id, e.title),
                                                  }),
                                              });
                                            },
                                          }),
                                        ],
                                      });
                                    },
                                  }),
                                  Vi(ql, {}),
                                ];
                              },
                            }),
                            Vi(Ql, {}),
                          ];
                        },
                      }),
                    ];
                  },
                });
              },
            });
          },
          iu = { width: 440, height: 265, scale: 1, $focus: { scale: 1.1 } },
          nu = {
            fontWeight: 400,
            fontSize: 24,
            maxLines: 1,
            contain: "width",
            lineHeight: 1,
            color: 4294967193,
            $focus: { color: 4294967295 },
          },
          au = { borderRadius: 6, $focus: { border: { width: 6, color: 3978044671 } } },
          su = e => {
            var t = e.item,
              r = t.title,
              i = t.poster_path;
            return Vi(Ji, {
              id: "card",
              get item() {
                return e.item;
              },
              get width() {
                return e.style.width;
              },
              get height() {
                return e.style.height;
              },
              display: "flex",
              flexDirection: "column",
              style: iu,
              gap: 16,
              forwardStates: !0,
              focusable: !0,
              onEnter: () => e.onEnter(),
              get children() {
                return [
                  Vi(Ji, {
                    id: "picture",
                    style: au,
                    get src() {
                      return Tl(i, "w92");
                    },
                  }),
                  Vi(Zi, {
                    id: "text",
                    get y() {
                      return e.style.height;
                    },
                    get width() {
                      return e.style.width;
                    },
                    style: nu,
                    children: r,
                  }),
                ];
              },
            });
          },
          ou = { fontWeight: 700, fontSize: 24, letterSpacing: 0.06, color: 4294967295 },
          lu = e => {
            var t = Jl().toDetails;
            (Ha(1920), za(697), Oa(" "));
            var r = () => location.hash.endsWith("movies"),
              i = Wn(e => {
                r() && Oa(e);
              }, 400),
              n = Wn((e, t) => {
                r() && (Ua(e), ja(t));
              }, 400);
            return (
              Xr(() => {
                var t, r;
                as(0);
                var i = null === (t = (r = e.data).movies) || void 0 === t ? void 0 : t.call(r);
                if (null != i && i.length) {
                  var n = i[0];
                  null != n &&
                    n.backdrop_path &&
                    (Ha(1920),
                    za(697),
                    Oa(`https://image.tmdb.org/t/p/w300/${n.backdrop_path}`),
                    Ua(n.title || n.name || ""),
                    ja(n.overview || ""));
                }
              }),
              Vi(ki, {
                get when() {
                  var t;
                  return null === (t = e.data.movies()) || void 0 === t ? void 0 : t.length;
                },
                get fallback() {
                  return Vi(eu, {});
                },
                get children() {
                  return Vi(Ji, {
                    forwardFocus: 4,
                    focusable: !0,
                    get children() {
                      return [
                        Vi(Ji, {
                          width: 1920,
                          height: 1080,
                          colorTl: 353703423,
                          colorTr: "rgba(21,21,21,0.6)",
                          colorBl: 353703423,
                          colorBr: "rgba(21,21,21,0.6)",
                        }),
                        Vi(Ji, {
                          width: 1920,
                          height: 1080,
                          colorTl: 353703423,
                          colorTr: 353703423,
                          colorBl: "rgba(21,21,21,0)",
                          colorBr: "rgba(21,21,21,0)",
                        }),
                        Vi(Zi, {
                          x: 69,
                          y: 258,
                          fontSize: 28,
                          fontWeight: 600,
                          color: 4294967295,
                          fontFamily: "Inter",
                          get children() {
                            return Fa();
                          },
                        }),
                        Vi(Zi, {
                          width: 698,
                          height: 124,
                          x: 69,
                          y: 316,
                          fontSize: 22,
                          fontWeight: 600,
                          contain: "width",
                          fontFamily: "Inter",
                          lineHeight: 31,
                          get children() {
                            return $a();
                          },
                        }),
                        Vi(wa, {
                          y: 697,
                          x: 64,
                          gap: 24,
                          width: 1241,
                          scroll: "center",
                          throttleInput: 50,
                          autofocus: !0,
                          get selected() {
                            return ns();
                          },
                          onSelectedChanged: (e, t, r, a) => {
                            as(e);
                            var s = t.children[e],
                              o = null == s ? void 0 : s.item;
                            null != o &&
                              o.backdrop_path &&
                              (Ha(1920),
                              za(697),
                              i(`https://image.tmdb.org/t/p/w300/${o.backdrop_path}`),
                              n(o.title || o.name || "", o.overview || ""));
                          },
                          get children() {
                            return Vi(Ii, {
                              get each() {
                                var t;
                                return null !== (t = e.data.movies()) && void 0 !== t ? t : [];
                              },
                              children: e => Vi(su, { item: e, style: ou, onEnter: () => t(e.id, "movies") }),
                            });
                          },
                        }),
                      ];
                    },
                  });
                },
              })
            );
          };
        function uu(e) {
          return du.apply(this, arguments);
        }
        function du() {
          return (du = s(
            i().m(function e(t) {
              var r;
              return i().w(function (e) {
                for (;;)
                  switch (e.n) {
                    case 0:
                      return ((e.n = 1), El.get("/movie/" + t));
                    case 1:
                      return ((r = e.v), e.a(2, r));
                  }
              }, e);
            }),
          )).apply(this, arguments);
        }
        function hu(e) {
          return cu.apply(this, arguments);
        }
        function cu() {
          return (cu = s(
            i().m(function e(t) {
              var r, n, a, s, o, l, u, d, h, c, f;
              return i().w(function (e) {
                for (;;)
                  switch (e.n) {
                    case 0:
                      return ((e.n = 1), El.get("/tv/" + t));
                    case 1:
                      return (
                        (r = e.v),
                        (n = r.name),
                        (a = r.genres),
                        (s = r.episode_run_time),
                        (o = r.origin_country),
                        (l = r.first_air_date),
                        (u = r.poster_path),
                        (d = r.overview),
                        (h = r.backdrop_path),
                        (c = r.id),
                        (f = r.vote_average),
                        e.a(2, {
                          title: n,
                          genres: a,
                          runtime: s,
                          origin_country: o,
                          release_date: l,
                          poster_path: u,
                          overview: d,
                          backdrop_path: h,
                          id: c,
                          vote_average: f,
                        })
                      );
                  }
              }, e);
            }),
          )).apply(this, arguments);
        }
        var fu = {
            width: 112,
            height: 64,
            borderRadius: 300,
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
            color: 791621631,
            $focus: { color: 3978044671 },
          },
          pu = e => (
            vn(),
            Vi(Ji, {
              style: fu,
              onEnter: () => history.back(),
              get children() {
                return Vi(Ji, {
                  src: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAABQ0lEQVR4AczXgQ2CMBCFYWESR3EUnUSdRDfRUXQSfH9jyBmptEJzZ3qhtli+FFrOfrPgMwzDSbFfMMTsT/8GCnbT6EfFRfWdjk3KX0CBwFnUtolOg1YDJ3DXruuuGqtJqQJmcIcmsvegxUAPHMYioBeuCOiJmwV6434CI+CywCi4SaBwF3XYTZh9rulWoutly8cqfuPsu9UVh3oERsSNwAkcfU+1k614RbqTvRBUCFA2yFQ8I2VJ3OKHVUWr98pE7kKdFbaAps0zDtiYwY0qJ+nA6JBKyu9od4yUwiUgJCA6WuRRzydwNfuVEQghIvIDCFLB1IaZyS+gZpEFEgb5BdQMsmjCICeBkZBZYB2Ss9vETyCX9H4mZ4HeyCKgJ7IYOIO0GTinrhZVQK6aeSbTu5v+taMaCMAg+a9y1nc2drpWjxcAAAD//5aIUZAAAAAGSURBVAMA7GtAR3aIKhkAAAAASUVORK5CYII=",
                  width: 48,
                  height: 48,
                });
              },
            })
          ),
          gu = {
            width: 286,
            height: 78,
            borderRadius: 300,
            gap: 10,
            color: 791621631,
            display: "flex",
            flexDirection: "row",
            justifyContent: "center",
            alignItems: "center",
            $focus: { color: 3978044671 },
          },
          mu = { fontFamily: "Inter", fontWeight: 600, fontSize: 20, lineHeight: 1, letterSpacing: 0.08 },
          vu = e => {
            var t = vn();
            return Vi(Ji, {
              style: gu,
              onEnter: () => {
                t("/player");
              },
              get children() {
                return [
                  Vi(Ji, {
                    src: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAA7ElEQVR4AaSQCxHCQAxE2ypAAjgACTgABRQFrQOKAloHVAFIwAE4AAfg4Hh7c2Wm9P+ZbJPcZTfJBR6fMSYyxqRgTjrIAkghjBRE4El+ADPiXqYJ/rsmMO+I7PCdJoG6IomeEbkAxXU19qxJwF7y24DWtboE4FtrXKuvgFS0itbS+yjWmTdEwBL4LYHWOuFHCYgnxDxwPGYCkQu8pwhkvu/nYwRutF9BjvGD3uAFIYS4Bg9ia30nOFKtrjm+ZF0CGndBxwR8SkyXNAlo3C0kjavYlVedBH77uOti3KvLW11AFxXuqcpA67jcV+wLAAD//znRRWQAAAAGSURBVAMAUnpQLAZjcHYAAAAASUVORK5CYII=",
                    width: 24,
                    height: 24,
                  }),
                  Vi(Zi, { style: mu, children: "WATCH NOW" }),
                ];
              },
            });
          },
          yu = { fontFamily: "Inter", fontWeight: 400, fontSize: 20, lineHeight: 29, letterSpacing: 0 },
          Tu = () => {
            var e = mn().params,
              t = e.id,
              i = r(
                Wr(() => t, "movies" === e.mediaType ? uu : hu),
                1,
              )[0],
              n = vn();
            (Ha(1920), za(1080), Oa(" "));
            var a = () => (n(-1), !0);
            return Vi(Ji, {
              onBack: a,
              onBackspace: a,
              get children() {
                return Vi(ki, {
                  get when() {
                    return i();
                  },
                  get children() {
                    return Vi(Ta, {
                      width: 1083,
                      height: 700,
                      x: 69,
                      y: 65,
                      gap: 44,
                      display: "flex",
                      flexDirection: "column",
                      forwardFocus: 1,
                      get children() {
                        return [
                          Vi(pu, {}),
                          Vi(Ji, {
                            width: 1083,
                            height: 592,
                            gap: 25,
                            display: "flex",
                            flexDirection: "column",
                            id: "data",
                            forwardFocus: 1,
                            autofocus: !0,
                            get children() {
                              return [
                                Vi(Ji, {
                                  id: "metaData",
                                  width: 1083,
                                  height: 82,
                                  display: "flex",
                                  flexDirection: "column",
                                  get children() {
                                    return [
                                      Vi(Zi, { style: yu, children: "Drama" }),
                                      Vi(Zi, { style: yu, children: "98 Minutes" }),
                                      Vi(Zi, { style: yu, children: "US - 1987 - PG - IMDb: 7.7" }),
                                    ];
                                  },
                                }),
                                Vi(Ji, {
                                  id: "generalData",
                                  width: 1083,
                                  height: 485,
                                  display: "flex",
                                  gap: 60,
                                  forwardFocus: 1,
                                  get children() {
                                    return [
                                      Vi(Ji, {
                                        width: 325,
                                        height: 485,
                                        get src() {
                                          var e;
                                          return Tl(
                                            null === (e = i()) || void 0 === e ? void 0 : e.poster_path,
                                            "w342",
                                          );
                                        },
                                      }),
                                      Vi(Ji, {
                                        id: "baseInfo",
                                        width: 698,
                                        height: 435,
                                        gap: 37,
                                        display: "flex",
                                        flexDirection: "column",
                                        alignSelf: "center",
                                        forwardFocus: 2,
                                        get children() {
                                          return [
                                            Vi(Ji, {
                                              id: "titleAndDescription",
                                              width: 698,
                                              height: 182,
                                              gap: 40,
                                              display: "flex",
                                              flexDirection: "column",
                                              get children() {
                                                return [
                                                  " ",
                                                  Vi(Zi, {
                                                    fontFamily: "Inter",
                                                    fontWeight: 600,
                                                    fontSize: 28,
                                                    letterSpacing: 0,
                                                    contain: "width",
                                                    get children() {
                                                      var e;
                                                      return null === (e = i()) || void 0 === e
                                                        ? void 0
                                                        : e.title;
                                                    },
                                                  }),
                                                  Vi(Zi, {
                                                    fontFamily: "Inter",
                                                    fontWeight: 600,
                                                    fontSize: 22,
                                                    lineHeight: 31,
                                                    letterSpacing: 0,
                                                    contain: "width",
                                                    maxLines: 4,
                                                    get children() {
                                                      var e;
                                                      return null === (e = i()) || void 0 === e
                                                        ? void 0
                                                        : e.overview;
                                                    },
                                                  }),
                                                ];
                                              },
                                            }),
                                            Vi(Ji, {
                                              id: "castAndCrew",
                                              width: 698,
                                              height: 101,
                                              gap: 8,
                                              display: "flex",
                                              flexDirection: "column",
                                              get children() {
                                                return [
                                                  Vi(Ji, {
                                                    display: "flex",
                                                    width: 698,
                                                    get children() {
                                                      return Vi(Zi, {
                                                        fontFamily: "Inter",
                                                        fontWeight: 400,
                                                        fontSize: 22,
                                                        contain: "width",
                                                        maxLines: 2,
                                                        children:
                                                          "Director: Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari",
                                                      });
                                                    },
                                                  }),
                                                  Vi(Ji, {
                                                    display: "flex",
                                                    width: 698,
                                                    get children() {
                                                      return Vi(Zi, {
                                                        fontFamily: "Inter",
                                                        fontWeight: 400,
                                                        fontSize: 22,
                                                        contain: "width",
                                                        maxLines: 2,
                                                        children:
                                                          "Cast: Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari, Enzo G. Castellari",
                                                      });
                                                    },
                                                  }),
                                                ];
                                              },
                                            }),
                                            Vi(vu, {}),
                                          ];
                                        },
                                      }),
                                    ];
                                  },
                                }),
                              ];
                            },
                          }),
                        ];
                      },
                    });
                  },
                });
              },
            });
          },
          bu =
            Number.isFinite ||
            function (e) {
              return "number" == typeof e && isFinite(e);
            },
          Su =
            Number.isSafeInteger ||
            function (e) {
              return "number" == typeof e && Math.abs(e) <= Eu;
            },
          Eu = Number.MAX_SAFE_INTEGER || 9007199254740991,
          xu = (function (e) {
            return (
              (e.NETWORK_ERROR = "networkError"),
              (e.MEDIA_ERROR = "mediaError"),
              (e.KEY_SYSTEM_ERROR = "keySystemError"),
              (e.MUX_ERROR = "muxError"),
              (e.OTHER_ERROR = "otherError"),
              e
            );
          })({}),
          wu = (function (e) {
            return (
              (e.KEY_SYSTEM_NO_KEYS = "keySystemNoKeys"),
              (e.KEY_SYSTEM_NO_ACCESS = "keySystemNoAccess"),
              (e.KEY_SYSTEM_NO_SESSION = "keySystemNoSession"),
              (e.KEY_SYSTEM_NO_CONFIGURED_LICENSE = "keySystemNoConfiguredLicense"),
              (e.KEY_SYSTEM_LICENSE_REQUEST_FAILED = "keySystemLicenseRequestFailed"),
              (e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED = "keySystemServerCertificateRequestFailed"),
              (e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED = "keySystemServerCertificateUpdateFailed"),
              (e.KEY_SYSTEM_SESSION_UPDATE_FAILED = "keySystemSessionUpdateFailed"),
              (e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED = "keySystemStatusOutputRestricted"),
              (e.KEY_SYSTEM_STATUS_INTERNAL_ERROR = "keySystemStatusInternalError"),
              (e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR = "keySystemDestroyMediaKeysError"),
              (e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR = "keySystemDestroyCloseSessionError"),
              (e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR = "keySystemDestroyRemoveSessionError"),
              (e.MANIFEST_LOAD_ERROR = "manifestLoadError"),
              (e.MANIFEST_LOAD_TIMEOUT = "manifestLoadTimeOut"),
              (e.MANIFEST_PARSING_ERROR = "manifestParsingError"),
              (e.MANIFEST_INCOMPATIBLE_CODECS_ERROR = "manifestIncompatibleCodecsError"),
              (e.LEVEL_EMPTY_ERROR = "levelEmptyError"),
              (e.LEVEL_LOAD_ERROR = "levelLoadError"),
              (e.LEVEL_LOAD_TIMEOUT = "levelLoadTimeOut"),
              (e.LEVEL_PARSING_ERROR = "levelParsingError"),
              (e.LEVEL_SWITCH_ERROR = "levelSwitchError"),
              (e.AUDIO_TRACK_LOAD_ERROR = "audioTrackLoadError"),
              (e.AUDIO_TRACK_LOAD_TIMEOUT = "audioTrackLoadTimeOut"),
              (e.SUBTITLE_LOAD_ERROR = "subtitleTrackLoadError"),
              (e.SUBTITLE_TRACK_LOAD_TIMEOUT = "subtitleTrackLoadTimeOut"),
              (e.FRAG_LOAD_ERROR = "fragLoadError"),
              (e.FRAG_LOAD_TIMEOUT = "fragLoadTimeOut"),
              (e.FRAG_DECRYPT_ERROR = "fragDecryptError"),
              (e.FRAG_PARSING_ERROR = "fragParsingError"),
              (e.FRAG_GAP = "fragGap"),
              (e.REMUX_ALLOC_ERROR = "remuxAllocError"),
              (e.KEY_LOAD_ERROR = "keyLoadError"),
              (e.KEY_LOAD_TIMEOUT = "keyLoadTimeOut"),
              (e.BUFFER_ADD_CODEC_ERROR = "bufferAddCodecError"),
              (e.BUFFER_INCOMPATIBLE_CODECS_ERROR = "bufferIncompatibleCodecsError"),
              (e.BUFFER_APPEND_ERROR = "bufferAppendError"),
              (e.BUFFER_APPENDING_ERROR = "bufferAppendingError"),
              (e.BUFFER_STALLED_ERROR = "bufferStalledError"),
              (e.BUFFER_FULL_ERROR = "bufferFullError"),
              (e.BUFFER_SEEK_OVER_HOLE = "bufferSeekOverHole"),
              (e.BUFFER_NUDGE_ON_STALL = "bufferNudgeOnStall"),
              (e.ASSET_LIST_LOAD_ERROR = "assetListLoadError"),
              (e.ASSET_LIST_LOAD_TIMEOUT = "assetListLoadTimeout"),
              (e.ASSET_LIST_PARSING_ERROR = "assetListParsingError"),
              (e.INTERSTITIAL_ASSET_ITEM_ERROR = "interstitialAssetItemError"),
              (e.INTERNAL_EXCEPTION = "internalException"),
              (e.INTERNAL_ABORTED = "aborted"),
              (e.ATTACH_MEDIA_ERROR = "attachMediaError"),
              (e.UNKNOWN = "unknown"),
              e
            );
          })({}),
          Au = (function (e) {
            return (
              (e.MEDIA_ATTACHING = "hlsMediaAttaching"),
              (e.MEDIA_ATTACHED = "hlsMediaAttached"),
              (e.MEDIA_DETACHING = "hlsMediaDetaching"),
              (e.MEDIA_DETACHED = "hlsMediaDetached"),
              (e.MEDIA_ENDED = "hlsMediaEnded"),
              (e.STALL_RESOLVED = "hlsStallResolved"),
              (e.BUFFER_RESET = "hlsBufferReset"),
              (e.BUFFER_CODECS = "hlsBufferCodecs"),
              (e.BUFFER_CREATED = "hlsBufferCreated"),
              (e.BUFFER_APPENDING = "hlsBufferAppending"),
              (e.BUFFER_APPENDED = "hlsBufferAppended"),
              (e.BUFFER_EOS = "hlsBufferEos"),
              (e.BUFFERED_TO_END = "hlsBufferedToEnd"),
              (e.BUFFER_FLUSHING = "hlsBufferFlushing"),
              (e.BUFFER_FLUSHED = "hlsBufferFlushed"),
              (e.MANIFEST_LOADING = "hlsManifestLoading"),
              (e.MANIFEST_LOADED = "hlsManifestLoaded"),
              (e.MANIFEST_PARSED = "hlsManifestParsed"),
              (e.LEVEL_SWITCHING = "hlsLevelSwitching"),
              (e.LEVEL_SWITCHED = "hlsLevelSwitched"),
              (e.LEVEL_LOADING = "hlsLevelLoading"),
              (e.LEVEL_LOADED = "hlsLevelLoaded"),
              (e.LEVEL_UPDATED = "hlsLevelUpdated"),
              (e.LEVEL_PTS_UPDATED = "hlsLevelPtsUpdated"),
              (e.LEVELS_UPDATED = "hlsLevelsUpdated"),
              (e.AUDIO_TRACKS_UPDATED = "hlsAudioTracksUpdated"),
              (e.AUDIO_TRACK_SWITCHING = "hlsAudioTrackSwitching"),
              (e.AUDIO_TRACK_SWITCHED = "hlsAudioTrackSwitched"),
              (e.AUDIO_TRACK_LOADING = "hlsAudioTrackLoading"),
              (e.AUDIO_TRACK_LOADED = "hlsAudioTrackLoaded"),
              (e.AUDIO_TRACK_UPDATED = "hlsAudioTrackUpdated"),
              (e.SUBTITLE_TRACKS_UPDATED = "hlsSubtitleTracksUpdated"),
              (e.SUBTITLE_TRACKS_CLEARED = "hlsSubtitleTracksCleared"),
              (e.SUBTITLE_TRACK_SWITCH = "hlsSubtitleTrackSwitch"),
              (e.SUBTITLE_TRACK_LOADING = "hlsSubtitleTrackLoading"),
              (e.SUBTITLE_TRACK_LOADED = "hlsSubtitleTrackLoaded"),
              (e.SUBTITLE_TRACK_UPDATED = "hlsSubtitleTrackUpdated"),
              (e.SUBTITLE_FRAG_PROCESSED = "hlsSubtitleFragProcessed"),
              (e.CUES_PARSED = "hlsCuesParsed"),
              (e.NON_NATIVE_TEXT_TRACKS_FOUND = "hlsNonNativeTextTracksFound"),
              (e.INIT_PTS_FOUND = "hlsInitPtsFound"),
              (e.FRAG_LOADING = "hlsFragLoading"),
              (e.FRAG_LOAD_EMERGENCY_ABORTED = "hlsFragLoadEmergencyAborted"),
              (e.FRAG_LOADED = "hlsFragLoaded"),
              (e.FRAG_DECRYPTED = "hlsFragDecrypted"),
              (e.FRAG_PARSING_INIT_SEGMENT = "hlsFragParsingInitSegment"),
              (e.FRAG_PARSING_USERDATA = "hlsFragParsingUserdata"),
              (e.FRAG_PARSING_METADATA = "hlsFragParsingMetadata"),
              (e.FRAG_PARSED = "hlsFragParsed"),
              (e.FRAG_BUFFERED = "hlsFragBuffered"),
              (e.FRAG_CHANGED = "hlsFragChanged"),
              (e.FPS_DROP = "hlsFpsDrop"),
              (e.FPS_DROP_LEVEL_CAPPING = "hlsFpsDropLevelCapping"),
              (e.MAX_AUTO_LEVEL_UPDATED = "hlsMaxAutoLevelUpdated"),
              (e.ERROR = "hlsError"),
              (e.DESTROYING = "hlsDestroying"),
              (e.KEY_LOADING = "hlsKeyLoading"),
              (e.KEY_LOADED = "hlsKeyLoaded"),
              (e.LIVE_BACK_BUFFER_REACHED = "hlsLiveBackBufferReached"),
              (e.BACK_BUFFER_REACHED = "hlsBackBufferReached"),
              (e.STEERING_MANIFEST_LOADED = "hlsSteeringManifestLoaded"),
              (e.ASSET_LIST_LOADING = "hlsAssetListLoading"),
              (e.ASSET_LIST_LOADED = "hlsAssetListLoaded"),
              (e.INTERSTITIALS_UPDATED = "hlsInterstitialsUpdated"),
              (e.INTERSTITIALS_BUFFERED_TO_BOUNDARY = "hlsInterstitialsBufferedToBoundary"),
              (e.INTERSTITIAL_ASSET_PLAYER_CREATED = "hlsInterstitialAssetPlayerCreated"),
              (e.INTERSTITIAL_STARTED = "hlsInterstitialStarted"),
              (e.INTERSTITIAL_ASSET_STARTED = "hlsInterstitialAssetStarted"),
              (e.INTERSTITIAL_ASSET_ENDED = "hlsInterstitialAssetEnded"),
              (e.INTERSTITIAL_ASSET_ERROR = "hlsInterstitialAssetError"),
              (e.INTERSTITIAL_ENDED = "hlsInterstitialEnded"),
              (e.INTERSTITIALS_PRIMARY_RESUMED = "hlsInterstitialsPrimaryResumed"),
              (e.PLAYOUT_LIMIT_REACHED = "hlsPlayoutLimitReached"),
              (e.EVENT_CUE_ENTER = "hlsEventCueEnter"),
              e
            );
          })({}),
          Iu = "manifest",
          ku = "level",
          Ru = "audioTrack",
          Cu = "subtitleTrack",
          Lu = "main",
          Mu = "audio",
          Du = "subtitle";
        class _u {
          constructor(e, t = 0, r = 0) {
            ((this.halfLife = void 0),
              (this.alpha_ = void 0),
              (this.estimate_ = void 0),
              (this.totalWeight_ = void 0),
              (this.halfLife = e),
              (this.alpha_ = e ? Math.exp(Math.log(0.5) / e) : 0),
              (this.estimate_ = t),
              (this.totalWeight_ = r));
          }
          sample(e, t) {
            var r = Math.pow(this.alpha_, e);
            ((this.estimate_ = t * (1 - r) + r * this.estimate_), (this.totalWeight_ += e));
          }
          getTotalWeight() {
            return this.totalWeight_;
          }
          getEstimate() {
            if (this.alpha_) {
              var e = 1 - Math.pow(this.alpha_, this.totalWeight_);
              if (e) return this.estimate_ / e;
            }
            return this.estimate_;
          }
        }
        class Pu {
          constructor(e, t, r, i = 100) {
            ((this.defaultEstimate_ = void 0),
              (this.minWeight_ = void 0),
              (this.minDelayMs_ = void 0),
              (this.slow_ = void 0),
              (this.fast_ = void 0),
              (this.defaultTTFB_ = void 0),
              (this.ttfb_ = void 0),
              (this.defaultEstimate_ = r),
              (this.minWeight_ = 0.001),
              (this.minDelayMs_ = 50),
              (this.slow_ = new _u(e)),
              (this.fast_ = new _u(t)),
              (this.defaultTTFB_ = i),
              (this.ttfb_ = new _u(e)));
          }
          update(e, t) {
            var r = this.slow_,
              i = this.fast_,
              n = this.ttfb_;
            (r.halfLife !== e && (this.slow_ = new _u(e, r.getEstimate(), r.getTotalWeight())),
              i.halfLife !== t && (this.fast_ = new _u(t, i.getEstimate(), i.getTotalWeight())),
              n.halfLife !== e && (this.ttfb_ = new _u(e, n.getEstimate(), n.getTotalWeight())));
          }
          sample(e, t) {
            var r = (e = Math.max(e, this.minDelayMs_)) / 1e3,
              i = (8 * t) / r;
            (this.fast_.sample(r, i), this.slow_.sample(r, i));
          }
          sampleTTFB(e) {
            var t = e / 1e3,
              r = Math.sqrt(2) * Math.exp(-Math.pow(t, 2) / 2);
            this.ttfb_.sample(r, Math.max(e, 5));
          }
          canEstimate() {
            return this.fast_.getTotalWeight() >= this.minWeight_;
          }
          getEstimate() {
            return this.canEstimate()
              ? Math.min(this.fast_.getEstimate(), this.slow_.getEstimate())
              : this.defaultEstimate_;
          }
          getEstimateTTFB() {
            return this.ttfb_.getTotalWeight() >= this.minWeight_
              ? this.ttfb_.getEstimate()
              : this.defaultTTFB_;
          }
          get defaultEstimate() {
            return this.defaultEstimate_;
          }
          destroy() {}
        }
        function Ou(e, t, r) {
          return (
            (t = (function (e) {
              var t = (function (e, t) {
                if ("object" != typeof e || !e) return e;
                var r = e[Symbol.toPrimitive];
                if (void 0 !== r) {
                  var i = r.call(e, t);
                  if ("object" != typeof i) return i;
                  throw new TypeError("@@toPrimitive must return a primitive value.");
                }
                return ("string" === t ? String : Number)(e);
              })(e, "string");
              return "symbol" == typeof t ? t : t + "";
            })(t)) in e
              ? Object.defineProperty(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 })
              : (e[t] = r),
            e
          );
        }
        function Nu() {
          return (
            (Nu = Object.assign
              ? Object.assign.bind()
              : function (e) {
                  for (var t = 1; t < arguments.length; t++) {
                    var r = arguments[t];
                    for (var i in r) ({}).hasOwnProperty.call(r, i) && (e[i] = r[i]);
                  }
                  return e;
                }),
            Nu.apply(null, arguments)
          );
        }
        function Fu(e, t) {
          var r = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var i = Object.getOwnPropertySymbols(e);
            (t &&
              (i = i.filter(function (t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              r.push.apply(r, i));
          }
          return r;
        }
        function Uu(e) {
          for (var t = 1; t < arguments.length; t++) {
            var r = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? Fu(Object(r), !0).forEach(function (t) {
                  Ou(e, t, r[t]);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r))
                : Fu(Object(r)).forEach(function (t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));
                  });
          }
          return e;
        }
        class Bu {
          constructor(e, t) {
            ((this.trace = void 0),
              (this.debug = void 0),
              (this.log = void 0),
              (this.warn = void 0),
              (this.info = void 0),
              (this.error = void 0));
            var r = `[${e}]:`;
            ((this.trace = $u),
              (this.debug = t.debug.bind(null, r)),
              (this.log = t.log.bind(null, r)),
              (this.warn = t.warn.bind(null, r)),
              (this.info = t.info.bind(null, r)),
              (this.error = t.error.bind(null, r)));
          }
        }
        var $u = function () {},
          ju = { trace: $u, debug: $u, log: $u, warn: $u, info: $u, error: $u };
        function Gu() {
          return Nu({}, ju);
        }
        function Vu(e, t, r) {
          return t[e]
            ? t[e].bind(t)
            : (function (e, t) {
                var r = self.console[e];
                return r ? r.bind(self.console, `${t ? "[" + t + "] " : ""}[${e}] >`) : $u;
              })(e, r);
        }
        var Hu = Gu();
        var Ku = Hu;
        function Wu(e = !0) {
          if ("undefined" != typeof self)
            return (
              ((e || !self.MediaSource) && self.ManagedMediaSource) ||
              self.MediaSource ||
              self.WebKitMediaSource
            );
        }
        function zu(e, t) {
          var r = Object.keys(e),
            i = Object.keys(t),
            n = r.length,
            a = i.length;
          return !n || !a || (n === a && !r.some(e => -1 === i.indexOf(e)));
        }
        function qu(e, t = !1) {
          if ("undefined" != typeof TextDecoder) {
            var r = new TextDecoder("utf-8").decode(e);
            if (t) {
              var i = r.indexOf("\0");
              return -1 !== i ? r.substring(0, i) : r;
            }
            return r.replace(/\0/g, "");
          }
          for (var n, a, s, o = e.length, l = "", u = 0; u < o; ) {
            if (0 === (n = e[u++]) && t) return l;
            if (0 !== n && 3 !== n)
              switch (n >> 4) {
                case 0:
                case 1:
                case 2:
                case 3:
                case 4:
                case 5:
                case 6:
                case 7:
                  l += String.fromCharCode(n);
                  break;
                case 12:
                case 13:
                  ((a = e[u++]), (l += String.fromCharCode(((31 & n) << 6) | (63 & a))));
                  break;
                case 14:
                  ((a = e[u++]),
                    (s = e[u++]),
                    (l += String.fromCharCode(((15 & n) << 12) | ((63 & a) << 6) | (63 & s))));
              }
          }
          return l;
        }
        function Xu(e) {
          for (var t = "", r = 0; r < e.length; r++) {
            var i = e[r].toString(16);
            (i.length < 2 && (i = "0" + i), (t += i));
          }
          return t;
        }
        function Yu(e) {
          return Uint8Array.from(
            e
              .replace(/^0x/, "")
              .replace(/([\da-fA-F]{2}) ?/g, "0x$1 ")
              .replace(/ +$/, "")
              .split(" "),
          ).buffer;
        }
        function Qu(e) {
          return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
        }
        var Ju,
          Zu = { exports: {} };
        var ed =
          (Ju ||
            ((Ju = 1),
            (function (e) {
              var t, r, i, n, a;
              ((t =
                /^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/),
                (r = /^(?=([^\/?#]*))\1([^]*)$/),
                (i = /(?:\/|^)\.(?=\/)/g),
                (n = /(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g),
                (a = {
                  buildAbsoluteURL: function (e, t, i) {
                    if (((i = i || {}), (e = e.trim()), !(t = t.trim()))) {
                      if (!i.alwaysNormalize) return e;
                      var n = a.parseURL(e);
                      if (!n) throw new Error("Error trying to parse base URL.");
                      return ((n.path = a.normalizePath(n.path)), a.buildURLFromParts(n));
                    }
                    var s = a.parseURL(t);
                    if (!s) throw new Error("Error trying to parse relative URL.");
                    if (s.scheme)
                      return i.alwaysNormalize
                        ? ((s.path = a.normalizePath(s.path)), a.buildURLFromParts(s))
                        : t;
                    var o = a.parseURL(e);
                    if (!o) throw new Error("Error trying to parse base URL.");
                    if (!o.netLoc && o.path && "/" !== o.path[0]) {
                      var l = r.exec(o.path);
                      ((o.netLoc = l[1]), (o.path = l[2]));
                    }
                    o.netLoc && !o.path && (o.path = "/");
                    var u = {
                      scheme: o.scheme,
                      netLoc: s.netLoc,
                      path: null,
                      params: s.params,
                      query: s.query,
                      fragment: s.fragment,
                    };
                    if (!s.netLoc && ((u.netLoc = o.netLoc), "/" !== s.path[0]))
                      if (s.path) {
                        var d = o.path,
                          h = d.substring(0, d.lastIndexOf("/") + 1) + s.path;
                        u.path = a.normalizePath(h);
                      } else
                        ((u.path = o.path),
                          s.params || ((u.params = o.params), s.query || (u.query = o.query)));
                    return (
                      null === u.path && (u.path = i.alwaysNormalize ? a.normalizePath(s.path) : s.path),
                      a.buildURLFromParts(u)
                    );
                  },
                  parseURL: function (e) {
                    var r = t.exec(e);
                    return r
                      ? {
                          scheme: r[1] || "",
                          netLoc: r[2] || "",
                          path: r[3] || "",
                          params: r[4] || "",
                          query: r[5] || "",
                          fragment: r[6] || "",
                        }
                      : null;
                  },
                  normalizePath: function (e) {
                    for (
                      e = e.split("").reverse().join("").replace(i, "");
                      e.length !== (e = e.replace(n, "")).length;
                    );
                    return e.split("").reverse().join("");
                  },
                  buildURLFromParts: function (e) {
                    return e.scheme + e.netLoc + e.path + e.params + e.query + e.fragment;
                  },
                }),
                (e.exports = a));
            })(Zu)),
          Zu.exports);
        class td {
          constructor() {
            ((this.aborted = !1),
              (this.loaded = 0),
              (this.retry = 0),
              (this.total = 0),
              (this.chunkCount = 0),
              (this.bwEstimate = 0),
              (this.loading = { start: 0, first: 0, end: 0 }),
              (this.parsing = { start: 0, end: 0 }),
              (this.buffering = { start: 0, first: 0, end: 0 }));
          }
        }
        var rd = "audio",
          id = "video",
          nd = "audiovideo";
        class ad {
          constructor(e) {
            var t, r, i;
            ((this._byteRange = null),
              (this._url = null),
              (this._stats = null),
              (this._streams = null),
              (this.base = void 0),
              (this.relurl = void 0),
              "string" == typeof e && (e = { url: e }),
              (this.base = e),
              (i = ud((t = this), (r = "stats"))) && ((i.enumerable = !0), Object.defineProperty(t, r, i)));
          }
          setByteRange(e, t) {
            var r,
              i = e.split("@", 2);
            ((r = 1 === i.length ? (null == t ? void 0 : t.byteRangeEndOffset) || 0 : parseInt(i[1])),
              (this._byteRange = [r, parseInt(i[0]) + r]));
          }
          get baseurl() {
            return this.base.url;
          }
          get byteRange() {
            return null === this._byteRange ? [] : this._byteRange;
          }
          get byteRangeStartOffset() {
            return this.byteRange[0];
          }
          get byteRangeEndOffset() {
            return this.byteRange[1];
          }
          get elementaryStreams() {
            return (
              null === this._streams && (this._streams = { [rd]: null, [id]: null, [nd]: null }),
              this._streams
            );
          }
          set elementaryStreams(e) {
            this._streams = e;
          }
          get hasStats() {
            return null !== this._stats;
          }
          get hasStreams() {
            return null !== this._streams;
          }
          get stats() {
            return (null === this._stats && (this._stats = new td()), this._stats);
          }
          set stats(e) {
            this._stats = e;
          }
          get url() {
            return (
              !this._url &&
                this.baseurl &&
                this.relurl &&
                (this._url = ed.buildAbsoluteURL(this.baseurl, this.relurl, { alwaysNormalize: !0 })),
              this._url || ""
            );
          }
          set url(e) {
            this._url = e;
          }
          clearElementaryStreamInfo() {
            var e = this.elementaryStreams;
            ((e[rd] = null), (e[id] = null), (e[nd] = null));
          }
        }
        function sd(e) {
          return "initSegment" !== e.sn;
        }
        class od extends ad {
          constructor(e, t) {
            (super(t),
              (this._decryptdata = null),
              (this._programDateTime = null),
              (this._ref = null),
              (this._bitrate = void 0),
              (this.rawProgramDateTime = null),
              (this.tagList = []),
              (this.duration = 0),
              (this.sn = 0),
              (this.levelkeys = void 0),
              (this.type = void 0),
              (this.loader = null),
              (this.keyLoader = null),
              (this.level = -1),
              (this.cc = 0),
              (this.startPTS = void 0),
              (this.endPTS = void 0),
              (this.startDTS = void 0),
              (this.endDTS = void 0),
              (this.start = 0),
              (this.playlistOffset = 0),
              (this.deltaPTS = void 0),
              (this.maxStartPTS = void 0),
              (this.minEndPTS = void 0),
              (this.data = void 0),
              (this.bitrateTest = !1),
              (this.title = null),
              (this.initSegment = null),
              (this.endList = void 0),
              (this.gap = void 0),
              (this.urlId = 0),
              (this.type = e));
          }
          get byteLength() {
            if (this.hasStats) {
              var e = this.stats.total;
              if (e) return e;
            }
            if (this.byteRange.length) {
              var t = this.byteRange[0],
                r = this.byteRange[1];
              if (bu(t) && bu(r)) return r - t;
            }
            return null;
          }
          get bitrate() {
            return this.byteLength
              ? (8 * this.byteLength) / this.duration
              : this._bitrate
                ? this._bitrate
                : null;
          }
          set bitrate(e) {
            this._bitrate = e;
          }
          get decryptdata() {
            var e,
              t = this.levelkeys;
            if (!t || t.NONE) return null;
            if (t.identity) this._decryptdata || (this._decryptdata = t.identity.getDecryptData(this.sn));
            else if (null == (e = this._decryptdata) || !e.keyId) {
              var r = Object.keys(t);
              if (1 === r.length) {
                var i = (this._decryptdata = t[r[0]] || null);
                i && (this._decryptdata = i.getDecryptData(this.sn, t));
              }
            }
            return this._decryptdata;
          }
          get end() {
            return this.start + this.duration;
          }
          get endProgramDateTime() {
            if (null === this.programDateTime) return null;
            var e = bu(this.duration) ? this.duration : 0;
            return this.programDateTime + 1e3 * e;
          }
          get encrypted() {
            var e;
            if (null != (e = this._decryptdata) && e.encrypted) return !0;
            if (this.levelkeys) {
              var t,
                r = Object.keys(this.levelkeys),
                i = r.length;
              if (i > 1 || (1 === i && null != (t = this.levelkeys[r[0]]) && t.encrypted)) return !0;
            }
            return !1;
          }
          get programDateTime() {
            return (
              null === this._programDateTime &&
                this.rawProgramDateTime &&
                (this.programDateTime = Date.parse(this.rawProgramDateTime)),
              this._programDateTime
            );
          }
          set programDateTime(e) {
            bu(e) ? (this._programDateTime = e) : (this._programDateTime = this.rawProgramDateTime = null);
          }
          get ref() {
            return sd(this)
              ? (this._ref ||
                  (this._ref = {
                    base: this.base,
                    start: this.start,
                    duration: this.duration,
                    sn: this.sn,
                    programDateTime: this.programDateTime,
                  }),
                this._ref)
              : null;
          }
          addStart(e) {
            this.setStart(this.start + e);
          }
          setStart(e) {
            ((this.start = e), this._ref && (this._ref.start = e));
          }
          setDuration(e) {
            ((this.duration = e), this._ref && (this._ref.duration = e));
          }
          setKeyFormat(e) {
            var t = this.levelkeys;
            if (t) {
              var r,
                i = t[e];
              !i ||
                (null != (r = this._decryptdata) && r.keyId) ||
                (this._decryptdata = i.getDecryptData(this.sn, t));
            }
          }
          abortRequests() {
            var e, t;
            (null == (e = this.loader) || e.abort(), null == (t = this.keyLoader) || t.abort());
          }
          setElementaryStreamInfo(e, t, r, i, n, a = !1) {
            var s = this.elementaryStreams,
              o = s[e];
            o
              ? ((o.startPTS = Math.min(o.startPTS, t)),
                (o.endPTS = Math.max(o.endPTS, r)),
                (o.startDTS = Math.min(o.startDTS, i)),
                (o.endDTS = Math.max(o.endDTS, n)))
              : (s[e] = { startPTS: t, endPTS: r, startDTS: i, endDTS: n, partial: a });
          }
        }
        class ld extends ad {
          constructor(e, t, r, i, n) {
            (super(r),
              (this.fragOffset = 0),
              (this.duration = 0),
              (this.gap = !1),
              (this.independent = !1),
              (this.relurl = void 0),
              (this.fragment = void 0),
              (this.index = void 0),
              (this.duration = e.decimalFloatingPoint("DURATION")),
              (this.gap = e.bool("GAP")),
              (this.independent = e.bool("INDEPENDENT")),
              (this.relurl = e.enumeratedString("URI")),
              (this.fragment = t),
              (this.index = i));
            var a = e.enumeratedString("BYTERANGE");
            (a && this.setByteRange(a, n), n && (this.fragOffset = n.fragOffset + n.duration));
          }
          get start() {
            return this.fragment.start + this.fragOffset;
          }
          get end() {
            return this.start + this.duration;
          }
          get loaded() {
            var e = this.elementaryStreams;
            return !!(e.audio || e.video || e.audiovideo);
          }
        }
        function ud(e, t) {
          var r = Object.getPrototypeOf(e);
          if (r) {
            var i = Object.getOwnPropertyDescriptor(r, t);
            return i || ud(r, t);
          }
        }
        var dd = Math.pow(2, 32) - 1,
          hd = [].push,
          cd = { video: 1, audio: 2, id3: 3, text: 4 };
        function fd(e) {
          return String.fromCharCode.apply(null, e);
        }
        function pd(e, t) {
          var r = (e[t] << 8) | e[t + 1];
          return r < 0 ? 65536 + r : r;
        }
        function gd(e, t) {
          var r = vd(e, t);
          return r < 0 ? 4294967296 + r : r;
        }
        function md(e, t) {
          var r = gd(e, t);
          return ((r *= Math.pow(2, 32)), (r += gd(e, t + 4)));
        }
        function vd(e, t) {
          return (e[t] << 24) | (e[t + 1] << 16) | (e[t + 2] << 8) | e[t + 3];
        }
        function yd(e, t) {
          var r = [];
          if (!t.length) return r;
          for (var i = e.byteLength, n = 0; n < i; ) {
            var a = gd(e, n),
              s = a > 1 ? n + a : i;
            if (fd(e.subarray(n + 4, n + 8)) === t[0])
              if (1 === t.length) r.push(e.subarray(n + 8, s));
              else {
                var o = yd(e.subarray(n + 8, s), t.slice(1));
                o.length && hd.apply(r, o);
              }
            n = s;
          }
          return r;
        }
        function Td(e) {
          var t = [],
            r = e[0],
            i = 8,
            n = gd(e, i);
          i += 4;
          var a = 0,
            s = 0;
          (0 === r
            ? ((a = gd(e, i)), (s = gd(e, i + 4)), (i += 8))
            : ((a = md(e, i)), (s = md(e, i + 8)), (i += 16)),
            (i += 2));
          var o = e.length + s,
            l = pd(e, i);
          i += 2;
          for (var u = 0; u < l; u++) {
            var d = i,
              h = gd(e, d);
            d += 4;
            var c = 2147483647 & h;
            if (1 === (2147483648 & h) >>> 31)
              return (Ku.warn("SIDX has hierarchical references (not supported)"), null);
            var f = gd(e, d);
            ((d += 4),
              t.push({
                referenceSize: c,
                subsegmentDuration: f,
                info: { duration: f / n, start: o, end: o + c - 1 },
              }),
              (o += c),
              (i = d += 4));
          }
          return { earliestPresentationTime: a, timescale: n, version: r, referencesCount: l, references: t };
        }
        function bd(e) {
          for (var t = [], r = yd(e, ["moov", "trak"]), i = 0; i < r.length; i++) {
            var n = r[i],
              a = yd(n, ["tkhd"])[0];
            if (a) {
              var s = a[0],
                o = gd(a, 0 === s ? 12 : 20),
                l = yd(n, ["mdia", "mdhd"])[0];
              if (l) {
                var u = gd(l, 0 === (s = l[0]) ? 12 : 20),
                  d = yd(n, ["mdia", "hdlr"])[0];
                if (d) {
                  var h = fd(d.subarray(8, 12)),
                    c = { soun: rd, vide: id }[h],
                    f = Sd(yd(n, ["mdia", "minf", "stbl", "stsd"])[0]);
                  c
                    ? ((t[o] = { timescale: u, type: c, stsd: f }), (t[c] = Uu({ timescale: u, id: o }, f)))
                    : (t[o] = { timescale: u, type: h, stsd: f });
                }
              }
            }
          }
          return (
            yd(e, ["moov", "mvex", "trex"]).forEach(e => {
              var r = gd(e, 4),
                i = t[r];
              i && (i.default = { duration: gd(e, 12), flags: gd(e, 20) });
            }),
            t
          );
        }
        function Sd(e) {
          var t,
            r = e.subarray(8),
            i = r.subarray(86),
            n = fd(r.subarray(4, 8)),
            a = n,
            s = "enca" === n || "encv" === n;
          if (s) {
            var o = yd(r, [n])[0];
            yd(o.subarray("enca" === n ? 28 : 78), ["sinf"]).forEach(e => {
              var t = yd(e, ["schm"])[0];
              if (t) {
                var r = fd(t.subarray(4, 8));
                if ("cbcs" === r || "cenc" === r) {
                  var i = yd(e, ["frma"])[0];
                  i && (a = fd(i));
                }
              }
            });
          }
          var l = a;
          switch (a) {
            case "avc1":
            case "avc2":
            case "avc3":
            case "avc4":
              var u = yd(i, ["avcC"])[0];
              u &&
                u.length > 3 &&
                ((a += "." + wd(u[1]) + wd(u[2]) + wd(u[3])), (t = Ed("avc1" === l ? "dva1" : "dvav", i)));
              break;
            case "mp4a":
              var d = yd(r, [n])[0],
                h = yd(d.subarray(28), ["esds"])[0];
              if (h && h.length > 7) {
                var c = 4;
                if (3 !== h[c++]) break;
                ((c = xd(h, c)), (c += 2));
                var f = h[c++];
                if ((128 & f && (c += 2), 64 & f && (c += h[c++]), 4 !== h[c++])) break;
                c = xd(h, c);
                var p = h[c++];
                if (64 !== p) break;
                if (((a += "." + wd(p)), (c += 12), 5 !== h[c++])) break;
                c = xd(h, c);
                var g = h[c++],
                  m = (248 & g) >> 3;
                (31 === m && (m += 1 + ((7 & g) << 3) + ((224 & h[c]) >> 5)), (a += "." + m));
              }
              break;
            case "hvc1":
            case "hev1":
              var v = yd(i, ["hvcC"])[0];
              if (v && v.length > 12) {
                var y = v[1],
                  T = ["", "A", "B", "C"][y >> 6],
                  b = 31 & y,
                  S = gd(v, 2),
                  E = (32 & y) >> 5 ? "H" : "L",
                  x = v[12],
                  w = v.subarray(6, 12);
                ((a += "." + T + b),
                  (a +=
                    "." +
                    (function (e) {
                      for (var t = 0, r = 0; r < 32; r++) t |= ((e >> r) & 1) << (31 - r);
                      return t >>> 0;
                    })(S)
                      .toString(16)
                      .toUpperCase()),
                  (a += "." + E + x));
                for (var A = "", I = w.length; I--; ) {
                  var k = w[I];
                  if (k || A) A = "." + k.toString(16).toUpperCase() + A;
                }
                a += A;
              }
              t = Ed("hev1" == l ? "dvhe" : "dvh1", i);
              break;
            case "dvh1":
            case "dvhe":
            case "dvav":
            case "dva1":
            case "dav1":
              a = Ed(a, i) || a;
              break;
            case "vp09":
              var R = yd(i, ["vpcC"])[0];
              if (R && R.length > 6) {
                var C = R[4],
                  L = R[5],
                  M = (R[6] >> 4) & 15;
                a += "." + Ad(C) + "." + Ad(L) + "." + Ad(M);
              }
              break;
            case "av01":
              var D = yd(i, ["av1C"])[0];
              if (D && D.length > 2) {
                var _ = D[1] >>> 5,
                  P = 31 & D[1],
                  O = D[2] >>> 7 ? "H" : "M",
                  N = (64 & D[2]) >> 6,
                  F = (32 & D[2]) >> 5,
                  U = 2 === _ && N ? (F ? 12 : 10) : N ? 10 : 8,
                  B = (16 & D[2]) >> 4,
                  $ = (8 & D[2]) >> 3,
                  j = (4 & D[2]) >> 2,
                  G = 3 & D[2];
                ((a +=
                  "." +
                  _ +
                  "." +
                  Ad(P) +
                  O +
                  "." +
                  Ad(U) +
                  "." +
                  B +
                  "." +
                  $ +
                  j +
                  G +
                  "." +
                  Ad(1) +
                  "." +
                  Ad(1) +
                  "." +
                  Ad(1) +
                  ".0"),
                  (t = Ed("dav1", i)));
              }
          }
          return { codec: a, encrypted: s, supplemental: t };
        }
        function Ed(e, t) {
          var r = yd(t, ["dvvC"]),
            i = r.length ? r[0] : yd(t, ["dvcC"])[0];
          if (i) {
            var n = (i[2] >> 1) & 127,
              a = ((i[2] << 5) & 32) | ((i[3] >> 3) & 31);
            return e + "." + Ad(n) + "." + Ad(a);
          }
        }
        function xd(e, t) {
          for (var r = t + 5; 128 & e[t++] && t < r; );
          return t;
        }
        function wd(e) {
          return ("0" + e.toString(16).toUpperCase()).slice(-2);
        }
        function Ad(e) {
          return (e < 10 ? "0" : "") + e;
        }
        function Id(e, t) {
          yd(e, ["moov", "trak"]).forEach(e => {
            var r = yd(e, ["mdia", "minf", "stbl", "stsd"])[0];
            if (r) {
              var i = r.subarray(8),
                n = yd(i, ["enca"]),
                a = n.length > 0;
              (a || (n = yd(i, ["encv"])),
                n.forEach(e => {
                  yd(a ? e.subarray(28) : e.subarray(78), ["sinf"]).forEach(e => {
                    var r = kd(e);
                    r && t(r, a);
                  });
                }));
            }
          });
        }
        function kd(e) {
          var t = yd(e, ["schm"])[0];
          if (t) {
            var r = fd(t.subarray(4, 8));
            if ("cbcs" === r || "cenc" === r) {
              var i = yd(e, ["schi", "tenc"])[0];
              if (i) return i;
            }
          }
        }
        function Rd(e, t) {
          var r = new Uint8Array(e.length + t.length);
          return (r.set(e), r.set(t, e.length), r);
        }
        function Cd(e, t) {
          var r = [],
            i = t.samples,
            n = t.timescale,
            a = t.id,
            s = !1;
          return (
            yd(i, ["moof"]).map(o => {
              var l = o.byteOffset - 8;
              yd(o, ["traf"]).map(o => {
                var u = yd(o, ["tfdt"]).map(e => {
                  var t = e[0],
                    r = gd(e, 4);
                  return (1 === t && ((r *= Math.pow(2, 32)), (r += gd(e, 8))), r / n);
                })[0];
                return (
                  void 0 !== u && (e = u),
                  yd(o, ["tfhd"]).map(u => {
                    var d = gd(u, 4),
                      h = 16777215 & gd(u, 0),
                      c = 0,
                      f = !!(16 & h),
                      p = 0,
                      g = !!(32 & h),
                      m = 8;
                    d === a &&
                      (!!(1 & h) && (m += 8),
                      !!(2 & h) && (m += 4),
                      !!(8 & h) && ((c = gd(u, m)), (m += 4)),
                      f && ((p = gd(u, m)), (m += 4)),
                      g && (m += 4),
                      "video" === t.type && (s = Ld(t.codec)),
                      yd(o, ["trun"]).map(a => {
                        var o = a[0],
                          u = 16777215 & gd(a, 0),
                          d = !!(1 & u),
                          h = 0,
                          f = !!(4 & u),
                          g = !!(256 & u),
                          m = 0,
                          v = !!(512 & u),
                          y = 0,
                          T = !!(1024 & u),
                          b = !!(2048 & u),
                          S = 0,
                          E = gd(a, 4),
                          x = 8;
                        (d && ((h = gd(a, x)), (x += 4)), f && (x += 4));
                        for (var w = h + l, A = 0; A < E; A++) {
                          if (
                            (g ? ((m = gd(a, x)), (x += 4)) : (m = c),
                            v ? ((y = gd(a, x)), (x += 4)) : (y = p),
                            T && (x += 4),
                            b && ((S = 0 === o ? gd(a, x) : vd(a, x)), (x += 4)),
                            t.type === id)
                          )
                            for (var I = 0; I < y; ) {
                              var k = gd(i, w);
                              if (Md(s, i[(w += 4)])) Dd(i.subarray(w, w + k), s ? 2 : 1, e + S / n, r);
                              ((w += k), (I += k + 4));
                            }
                          e += m / n;
                        }
                      }));
                  })
                );
              });
            }),
            r
          );
        }
        function Ld(e) {
          if (!e) return !1;
          var t = e.substring(0, 4);
          return "hvc1" === t || "hev1" === t || "dvh1" === t || "dvhe" === t;
        }
        function Md(e, t) {
          if (e) {
            var r = (t >> 1) & 63;
            return 39 === r || 40 === r;
          }
          return 6 === (31 & t);
        }
        function Dd(e, t, r, i) {
          var n = _d(e),
            a = 0;
          a += t;
          for (var s = 0, o = 0, l = 0; a < n.length; ) {
            s = 0;
            do {
              if (a >= n.length) break;
              s += l = n[a++];
            } while (255 === l);
            o = 0;
            do {
              if (a >= n.length) break;
              o += l = n[a++];
            } while (255 === l);
            var u = n.length - a,
              d = a;
            if (o < u) a += o;
            else if (o > u) {
              Ku.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);
              break;
            }
            if (4 === s) {
              if (181 === n[d++]) {
                var h = pd(n, d);
                if (((d += 2), 49 === h)) {
                  var c = gd(n, d);
                  if (((d += 4), 1195456820 === c)) {
                    var f = n[d++];
                    if (3 === f) {
                      var p = n[d++],
                        g = 64 & p,
                        m = g ? 2 + 3 * (31 & p) : 0,
                        v = new Uint8Array(m);
                      if (g) {
                        v[0] = p;
                        for (var y = 1; y < m; y++) v[y] = n[d++];
                      }
                      i.push({ type: f, payloadType: s, pts: r, bytes: v });
                    }
                  }
                }
              }
            } else if (5 === s && o > 16) {
              for (var T = [], b = 0; b < 16; b++) {
                var S = n[d++].toString(16);
                (T.push(1 == S.length ? "0" + S : S),
                  (3 !== b && 5 !== b && 7 !== b && 9 !== b) || T.push("-"));
              }
              for (var E = o - 16, x = new Uint8Array(E), w = 0; w < E; w++) x[w] = n[d++];
              i.push({ payloadType: s, pts: r, uuid: T.join(""), userData: qu(x), userDataBytes: x });
            }
          }
        }
        function _d(e) {
          for (var t = e.byteLength, r = [], i = 1; i < t - 2; )
            0 === e[i] && 0 === e[i + 1] && 3 === e[i + 2] ? (r.push(i + 2), (i += 2)) : i++;
          if (0 === r.length) return e;
          var n = t - r.length,
            a = new Uint8Array(n),
            s = 0;
          for (i = 0; i < n; s++, i++) (s === r[0] && (s++, r.shift()), (a[i] = e[s]));
          return a;
        }
        function Pd(e, t, r) {
          if (16 !== e.byteLength) throw new RangeError("Invalid system id");
          var i, n;
          ((i = new Uint8Array()), (n = new Uint8Array()));
          var a = new Uint8Array(4);
          return (
            r.byteLength > 0 && new DataView(a.buffer).setUint32(0, r.byteLength, !1),
            (function (e, ...t) {
              for (var r = t.length, i = 8, n = r; n--; ) i += t[n].byteLength;
              var a = new Uint8Array(i);
              for (
                a[0] = (i >> 24) & 255,
                  a[1] = (i >> 16) & 255,
                  a[2] = (i >> 8) & 255,
                  a[3] = 255 & i,
                  a.set(e, 4),
                  n = 0,
                  i = 8;
                n < r;
                n++
              )
                (a.set(t[n], i), (i += t[n].byteLength));
              return a;
            })([112, 115, 115, 104], new Uint8Array([0, 0, 0, 0]), e, n, i, a, r)
          );
        }
        function Od(e) {
          var t = e.getUint32(0),
            r = e.byteOffset,
            i = e.byteLength;
          if (i < t) return { offset: r, size: i };
          if (1886614376 !== e.getUint32(4)) return { offset: r, size: t };
          var n = e.getUint32(8) >>> 24;
          if (0 !== n && 1 !== n) return { offset: r, size: t };
          var a = e.buffer,
            s = Xu(new Uint8Array(a, r + 12, 16)),
            o = null,
            l = 0;
          if (0 === n) l = 28;
          else {
            var u = e.getUint32(28);
            if (!u || i < 32 + 16 * u) return { offset: r, size: t };
            o = [];
            for (var d = 0; d < u; d++) o.push(new Uint8Array(a, r + 32 + 16 * d, 16));
            l = 32 + 16 * u;
          }
          if (!l) return { offset: r, size: t };
          var h = e.getUint32(l);
          return t - 32 < h
            ? { offset: r, size: t }
            : { version: n, systemId: s, kids: o, data: new Uint8Array(a, r + l + 4, h), offset: r, size: t };
        }
        var Nd = () => /\(Windows.+Firefox\//i.test(navigator.userAgent),
          Fd = {
            audio: {
              a3ds: 1,
              "ac-3": 0.95,
              "ac-4": 1,
              alac: 0.9,
              alaw: 1,
              dra1: 1,
              "dts+": 1,
              "dts-": 1,
              dtsc: 1,
              dtse: 1,
              dtsh: 1,
              "ec-3": 0.9,
              enca: 1,
              fLaC: 0.9,
              flac: 0.9,
              FLAC: 0.9,
              g719: 1,
              g726: 1,
              m4ae: 1,
              mha1: 1,
              mha2: 1,
              mhm1: 1,
              mhm2: 1,
              mlpa: 1,
              mp4a: 1,
              "raw ": 1,
              Opus: 1,
              opus: 1,
              samr: 1,
              sawb: 1,
              sawp: 1,
              sevc: 1,
              sqcp: 1,
              ssmv: 1,
              twos: 1,
              ulaw: 1,
            },
            video: {
              avc1: 1,
              avc2: 1,
              avc3: 1,
              avc4: 1,
              avcp: 1,
              av01: 0.8,
              dav1: 0.8,
              drac: 1,
              dva1: 1,
              dvav: 1,
              dvh1: 0.7,
              dvhe: 0.7,
              encv: 1,
              hev1: 0.75,
              hvc1: 0.75,
              mjp2: 1,
              mp4v: 1,
              mvc1: 1,
              mvc2: 1,
              mvc3: 1,
              mvc4: 1,
              resv: 1,
              rv60: 1,
              s263: 1,
              svc1: 1,
              svc2: 1,
              "vc-1": 1,
              vp08: 1,
              vp09: 0.9,
            },
            text: { stpp: 1, wvtt: 1 },
          };
        function Ud(e, t) {
          var r = Fd[t];
          return !!r && !!r[e.slice(0, 4)];
        }
        function Bd(e, t, r = !0) {
          return !e.split(",").some(e => !$d(e, t, r));
        }
        function $d(e, t, r = !0) {
          var i,
            n = Wu(r);
          return null != (i = null == n ? void 0 : n.isTypeSupported(jd(e, t))) && i;
        }
        function jd(e, t) {
          return `${t}/mp4;codecs=${e}`;
        }
        function Gd(e) {
          if (e) {
            var t = e.substring(0, 4);
            return Fd.video[t];
          }
          return 2;
        }
        function Vd(e) {
          var t = Nd();
          return e.split(",").reduce((e, r) => {
            var i = t && Ld(r) ? 9 : Fd.video[r];
            return i ? (2 * i + e) / (e ? 3 : 2) : (Fd.audio[r] + e) / (e ? 2 : 1);
          }, 0);
        }
        var Hd = {};
        var Kd = /flac|opus|mp4a\.40\.34/i;
        function Wd(e, t = !0) {
          return e.replace(Kd, e =>
            (function (e, t = !0) {
              if (Hd[e]) return Hd[e];
              for (
                var r = { flac: ["flac", "fLaC", "FLAC"], opus: ["opus", "Opus"], "mp4a.40.34": ["mp3"] }[e],
                  i = 0;
                i < r.length;
                i++
              ) {
                var n;
                if ($d(r[i], "audio", t)) return ((Hd[e] = r[i]), r[i]);
                if ("mp3" === r[i] && null != (n = Wu(t)) && n.isTypeSupported("audio/mpeg")) return "";
              }
              return e;
            })(e.toLowerCase(), t),
          );
        }
        function zd(e, t) {
          if (
            e &&
            (e.length > 4 || -1 !== ["ac-3", "ec-3", "alac", "fLaC", "Opus"].indexOf(e)) &&
            (qd(e, "audio") || qd(e, "video"))
          )
            return e;
          if (t) {
            var r = t.split(",");
            if (r.length > 1) {
              if (e)
                for (var i = r.length; i--; ) if (r[i].substring(0, 4) === e.substring(0, 4)) return r[i];
              return r[0];
            }
          }
          return t || e;
        }
        function qd(e, t) {
          return Ud(e, t) && $d(e, t);
        }
        function Xd(e) {
          if (e.startsWith("av01.")) {
            for (
              var t = e.split("."), r = ["0", "111", "01", "01", "01", "0"], i = t.length;
              i > 4 && i < 10;
              i++
            )
              t[i] = r[i - 4];
            return t.join(".");
          }
          return e;
        }
        function Yd(e) {
          var t = Wu(e) || { isTypeSupported: () => !1 };
          return {
            mpeg: t.isTypeSupported("audio/mpeg"),
            mp3: t.isTypeSupported('audio/mp4; codecs="mp3"'),
            ac3: t.isTypeSupported('audio/mp4; codecs="ac-3"'),
          };
        }
        function Qd(e) {
          return e.replace(/^.+codecs=["']?([^"']+).*$/, "$1");
        }
        var Jd = { supported: !1, smooth: !1, powerEfficient: !1 },
          Zd = {
            supported: !0,
            configurations: [],
            decodingInfoResults: [{ supported: !0, powerEfficient: !0, smooth: !0 }],
          };
        function eh(e, t) {
          return { supported: !1, configurations: t, decodingInfoResults: [Jd], error: e };
        }
        function th(e, t, r, i = {}) {
          var n = e.videoCodec;
          if ((!n && !e.audioCodec) || !r) return Promise.resolve(Zd);
          for (
            var a = [],
              s = (function (e) {
                var t,
                  r = null == (t = e.videoCodec) ? void 0 : t.split(","),
                  i = ih(e),
                  n = e.width || 640,
                  a = e.height || 480,
                  s = e.frameRate || 30,
                  o = e.videoRange.toLowerCase();
                return r
                  ? r.map(e => {
                      var t = {
                        contentType: jd(Xd(e), "video"),
                        width: n,
                        height: a,
                        bitrate: i,
                        framerate: s,
                      };
                      return ("sdr" !== o && (t.transferFunction = o), t);
                    })
                  : [];
              })(e),
              o = s.length,
              l = (function (e, t, r) {
                var i,
                  n = null == (i = e.audioCodec) ? void 0 : i.split(","),
                  a = ih(e);
                if (n && e.audioGroups)
                  return e.audioGroups.reduce((e, i) => {
                    var s,
                      o = i ? (null == (s = t.groups[i]) ? void 0 : s.tracks) : null;
                    return o
                      ? o.reduce((e, t) => {
                          if (t.groupId === i) {
                            var s = parseFloat(t.channels || "");
                            n.forEach(t => {
                              var i = { contentType: jd(t, "audio"), bitrate: r ? rh(t, a) : a };
                              (s && (i.channels = "" + s), e.push(i));
                            });
                          }
                          return e;
                        }, e)
                      : e;
                  }, []);
                return [];
              })(e, t, o > 0),
              u = l.length,
              d = o || 1 * u || 1;
            d--;
          ) {
            var h = { type: "media-source" };
            if ((o && (h.video = s[d % o]), u)) {
              h.audio = l[d % u];
              var c = h.audio.bitrate;
              h.video && c && (h.video.bitrate -= c);
            }
            a.push(h);
          }
          if (n) {
            var f = navigator.userAgent;
            if (n.split(",").some(e => Ld(e)) && Nd())
              return Promise.resolve(
                eh(
                  new Error(
                    `Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${f})`,
                  ),
                  a,
                ),
              );
          }
          return Promise.all(
            a.map(e => {
              var t = (function (e) {
                var t = "",
                  r = e.audio,
                  i = e.video;
                if (i) {
                  t += `${Qd(i.contentType)}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction || "sd"}_${Math.ceil(i.bitrate / 1e5)}`;
                }
                if (r) {
                  t += `${i ? "_" : ""}${Qd(r.contentType)}_c${r.channels}`;
                }
                return t;
              })(e);
              return i[t] || (i[t] = r.decodingInfo(e));
            }),
          )
            .then(e => ({ supported: !e.some(e => !e.supported), configurations: a, decodingInfoResults: e }))
            .catch(e => ({ supported: !1, configurations: a, decodingInfoResults: [], error: e }));
        }
        function rh(e, t) {
          if (t <= 1) return 1;
          var r = 128e3;
          return ("ec-3" === e ? (r = 768e3) : "ac-3" === e && (r = 64e4), Math.min(t / 2, r));
        }
        function ih(e) {
          return 1e3 * Math.ceil(Math.max(0.9 * e.bitrate, e.averageBitrate) / 1e3) || 1;
        }
        var nh = ["NONE", "TYPE-0", "TYPE-1", null];
        var ah = ["SDR", "PQ", "HLG"];
        var sh = "",
          oh = "YES",
          lh = "v2";
        function uh(e) {
          var t = e.canSkipUntil,
            r = e.canSkipDateRanges,
            i = e.age;
          return t && i < t / 2 ? (r ? lh : oh) : sh;
        }
        class dh {
          constructor(e, t, r) {
            ((this.msn = void 0),
              (this.part = void 0),
              (this.skip = void 0),
              (this.msn = e),
              (this.part = t),
              (this.skip = r));
          }
          addDirectives(e) {
            var t = new self.URL(e);
            return (
              void 0 !== this.msn && t.searchParams.set("_HLS_msn", this.msn.toString()),
              void 0 !== this.part && t.searchParams.set("_HLS_part", this.part.toString()),
              this.skip && t.searchParams.set("_HLS_skip", this.skip),
              t.href
            );
          }
        }
        class hh {
          constructor(e) {
            if (
              ((this._attrs = void 0),
              (this.audioCodec = void 0),
              (this.bitrate = void 0),
              (this.codecSet = void 0),
              (this.url = void 0),
              (this.frameRate = void 0),
              (this.height = void 0),
              (this.id = void 0),
              (this.name = void 0),
              (this.supplemental = void 0),
              (this.videoCodec = void 0),
              (this.width = void 0),
              (this.details = void 0),
              (this.fragmentError = 0),
              (this.loadError = 0),
              (this.loaded = void 0),
              (this.realBitrate = 0),
              (this.supportedPromise = void 0),
              (this.supportedResult = void 0),
              (this._avgBitrate = 0),
              (this._audioGroups = void 0),
              (this._subtitleGroups = void 0),
              (this._urlId = 0),
              (this.url = [e.url]),
              (this._attrs = [e.attrs]),
              (this.bitrate = e.bitrate),
              e.details && (this.details = e.details),
              (this.id = e.id || 0),
              (this.name = e.name),
              (this.width = e.width || 0),
              (this.height = e.height || 0),
              (this.frameRate = e.attrs.optionalFloat("FRAME-RATE", 0)),
              (this._avgBitrate = e.attrs.decimalInteger("AVERAGE-BANDWIDTH")),
              (this.audioCodec = e.audioCodec),
              (this.videoCodec = e.videoCodec),
              (this.codecSet = [e.videoCodec, e.audioCodec]
                .filter(e => !!e)
                .map(e => e.substring(0, 4))
                .join(",")),
              "supplemental" in e)
            ) {
              var t;
              this.supplemental = e.supplemental;
              var r = null == (t = e.supplemental) ? void 0 : t.videoCodec;
              r && r !== e.videoCodec && (this.codecSet += `,${r.substring(0, 4)}`);
            }
            (this.addGroupId("audio", e.attrs.AUDIO), this.addGroupId("text", e.attrs.SUBTITLES));
          }
          get maxBitrate() {
            return Math.max(this.realBitrate, this.bitrate);
          }
          get averageBitrate() {
            return this._avgBitrate || this.realBitrate || this.bitrate;
          }
          get attrs() {
            return this._attrs[0];
          }
          get codecs() {
            return this.attrs.CODECS || "";
          }
          get pathwayId() {
            return this.attrs["PATHWAY-ID"] || ".";
          }
          get videoRange() {
            return this.attrs["VIDEO-RANGE"] || "SDR";
          }
          get score() {
            return this.attrs.optionalFloat("SCORE", 0);
          }
          get uri() {
            return this.url[0] || "";
          }
          hasAudioGroup(e) {
            return ch(this._audioGroups, e);
          }
          hasSubtitleGroup(e) {
            return ch(this._subtitleGroups, e);
          }
          get audioGroups() {
            return this._audioGroups;
          }
          get subtitleGroups() {
            return this._subtitleGroups;
          }
          addGroupId(e, t) {
            if (t)
              if ("audio" === e) {
                var r = this._audioGroups;
                (r || (r = this._audioGroups = []), -1 === r.indexOf(t) && r.push(t));
              } else if ("text" === e) {
                var i = this._subtitleGroups;
                (i || (i = this._subtitleGroups = []), -1 === i.indexOf(t) && i.push(t));
              }
          }
          get urlId() {
            return 0;
          }
          set urlId(e) {}
          get audioGroupIds() {
            return this.audioGroups ? [this.audioGroupId] : void 0;
          }
          get textGroupIds() {
            return this.subtitleGroups ? [this.textGroupId] : void 0;
          }
          get audioGroupId() {
            var e;
            return null == (e = this.audioGroups) ? void 0 : e[0];
          }
          get textGroupId() {
            var e;
            return null == (e = this.subtitleGroups) ? void 0 : e[0];
          }
          addFallback() {}
        }
        function ch(e, t) {
          return !(!t || !e) && -1 !== e.indexOf(t);
        }
        function fh(e, t) {
          var r = !1,
            i = [];
          if ((e && ((r = "SDR" !== e), (i = [e])), t)) {
            var n = "SDR" !== (i = t.allowedVideoRanges || ah.slice(0)).join("") && !t.videoCodec;
            (r =
              void 0 !== t.preferHDR
                ? t.preferHDR
                : n &&
                  (function () {
                    if ("function" == typeof matchMedia) {
                      var e = matchMedia("(dynamic-range: high)"),
                        t = matchMedia("bad query");
                      if (e.media !== t.media) return !0 === e.matches;
                    }
                    return !1;
                  })()) || (i = ["SDR"]);
          }
          return { preferHDR: r, allowedVideoRanges: i };
        }
        var ph = (e, t) =>
          JSON.stringify(
            e,
            (e => {
              var t = new WeakSet();
              return (r, i) => {
                if ((e && (i = e(r, i)), "object" == typeof i && null !== i)) {
                  if (t.has(i)) return;
                  t.add(i);
                }
                return i;
              };
            })(t),
          );
        function gh(e, t) {
          Ku.log(`[abr] start candidates with "${e}" ignored because ${t}`);
        }
        function mh(e) {
          return e.reduce(
            (e, t) => {
              var r = e.groups[t.groupId];
              (r ||
                (r = e.groups[t.groupId] =
                  { tracks: [], channels: { 2: 0 }, hasDefault: !1, hasAutoSelect: !1 }),
                r.tracks.push(t));
              var i = t.channels || "2";
              return (
                (r.channels[i] = (r.channels[i] || 0) + 1),
                (r.hasDefault = r.hasDefault || t.default),
                (r.hasAutoSelect = r.hasAutoSelect || t.autoselect),
                r.hasDefault && (e.hasDefaultAudio = !0),
                r.hasAutoSelect && (e.hasAutoSelectAudio = !0),
                e
              );
            },
            { hasDefaultAudio: !1, hasAutoSelectAudio: !1, groups: {} },
          );
        }
        function vh(e) {
          return e
            ? {
                lang: e.lang,
                assocLang: e.assocLang,
                characteristics: e.characteristics,
                channels: e.channels,
                audioCodec: e.audioCodec,
              }
            : e;
        }
        function yh(e, t, r) {
          if ("attrs" in e) {
            var i = t.indexOf(e);
            if (-1 !== i) return i;
          }
          for (var n = 0; n < t.length; n++) {
            if (Th(e, t[n], r)) return n;
          }
          return -1;
        }
        function Th(e, t, r) {
          var i = e.groupId,
            n = e.name,
            a = e.lang,
            s = e.assocLang,
            o = e.default,
            l = e.forced;
          return (
            (void 0 === i || t.groupId === i) &&
            (void 0 === n || t.name === n) &&
            (void 0 === a ||
              (function (e, t = "--") {
                if (e.length === t.length) return e === t;
                return e.startsWith(t) || t.startsWith(e);
              })(a, t.lang)) &&
            (void 0 === a || t.assocLang === s) &&
            (void 0 === o || t.default === o) &&
            (void 0 === l || t.forced === l) &&
            (!("characteristics" in e) ||
              (function (e, t = "") {
                var r = e.split(","),
                  i = t.split(",");
                return r.length === i.length && !r.some(e => -1 === i.indexOf(e));
              })(e.characteristics || "", t.characteristics)) &&
            (void 0 === r || r(e, t))
          );
        }
        function bh(e, t) {
          var r = e.audioCodec,
            i = e.channels;
          return !(
            (void 0 !== r && (t.audioCodec || "").substring(0, 4) !== r.substring(0, 4)) ||
            (void 0 !== i && i !== (t.channels || "2"))
          );
        }
        function Sh(e, t, r) {
          for (var i = t; i > -1; i--) if (r(e[i])) return i;
          for (var n = t + 1; n < e.length; n++) if (r(e[n])) return n;
          return -1;
        }
        function Eh(e, t) {
          var r;
          return !!e && e !== (null == (r = t.loadLevelObj) ? void 0 : r.uri);
        }
        var xh = function (e, t) {
          for (var r = 0, i = e.length - 1, n = null, a = null; r <= i; ) {
            var s = t((a = e[(n = ((r + i) / 2) | 0)]));
            if (s > 0) r = n + 1;
            else {
              if (!(s < 0)) return a;
              i = n - 1;
            }
          }
          return null;
        };
        function wh(e, t, r = 0, i = 0, n = 0.005) {
          var a = null;
          if (e) {
            a = t[1 + e.sn - t[0].sn] || null;
            var s = e.endDTS - r;
            (s > 0 && s < 15e-7 && (r += 15e-7),
              a && e.level !== a.level && a.end <= e.end && (a = t[2 + e.sn - t[0].sn] || null));
          } else 0 === r && 0 === t[0].start && (a = t[0]);
          if (
            a &&
            (((!e || e.level === a.level) && 0 === Ah(r, i, a)) ||
              (function (e, t, r) {
                if (t && 0 === t.start && t.level < e.level && (t.endPTS || 0) > 0) {
                  var i = t.tagList.reduce((e, t) => ("INF" === t[0] && (e += parseFloat(t[1])), e), r);
                  return e.start <= i;
                }
                return !1;
              })(a, e, Math.min(n, i)))
          )
            return a;
          var o = xh(t, Ah.bind(null, r, i));
          return !o || (o === e && a) ? a : o;
        }
        function Ah(e = 0, t = 0, r) {
          if (r.start <= e && r.start + r.duration > e) return 0;
          var i = Math.min(t, r.duration + (r.deltaPTS ? r.deltaPTS : 0));
          return r.start + r.duration - i <= e ? 1 : r.start - i > e && r.start ? -1 : 0;
        }
        function Ih(e, t, r) {
          var i = 1e3 * Math.min(t, r.duration + (r.deltaPTS ? r.deltaPTS : 0));
          return (r.endProgramDateTime || 0) - i > e;
        }
        function kh(e, t, r) {
          if (e && e.startCC <= t && e.endCC >= t) {
            var i,
              n = e.fragments,
              a = e.fragmentHint;
            return (
              a && (n = n.concat(a)),
              xh(n, e => (e.cc < t ? 1 : e.cc > t ? -1 : ((i = e), e.end <= r ? 1 : e.start > r ? -1 : 0))),
              i || null
            );
          }
          return null;
        }
        function Rh(e) {
          switch (e.details) {
            case wu.FRAG_LOAD_TIMEOUT:
            case wu.KEY_LOAD_TIMEOUT:
            case wu.LEVEL_LOAD_TIMEOUT:
            case wu.MANIFEST_LOAD_TIMEOUT:
              return !0;
          }
          return !1;
        }
        function Ch(e) {
          return e.details.startsWith("key");
        }
        function Lh(e) {
          return Ch(e) && !!e.frag && !e.frag.decryptdata;
        }
        function Mh(e, t) {
          var r = Rh(t);
          return e.default[(r ? "timeout" : "error") + "Retry"];
        }
        function Dh(e, t) {
          var r = "linear" === e.backoff ? 1 : Math.pow(2, t);
          return Math.min(r * e.retryDelayMs, e.maxRetryDelayMs);
        }
        function _h(e) {
          return Uu(Uu({}, e), { errorRetry: null, timeoutRetry: null });
        }
        function Ph(e, t, r, i) {
          if (!e) return !1;
          var n = null == i ? void 0 : i.code,
            a =
              t < e.maxNumRetry &&
              ((function (e) {
                return Oh(e) || (!!e && (e < 400 || e > 499));
              })(n) ||
                !!r);
          return e.shouldRetry ? e.shouldRetry(e, t, r, i, a) : a;
        }
        function Oh(e) {
          return 0 === e && !1 === navigator.onLine;
        }
        var Nh = 0,
          Fh = 2,
          Uh = 3,
          Bh = 5,
          $h = 0,
          jh = 1,
          Gh = 2,
          Vh = 4;
        function Hh(e) {
          var t = { action: Nh, flags: $h };
          return (e && (t.resolved = !0), t);
        }
        var Kh = "NOT_LOADED",
          Wh = "APPENDING",
          zh = "PARTIAL",
          qh = "OK";
        class Xh {
          constructor(e) {
            ((this.activePartLists = Object.create(null)),
              (this.endListFragments = Object.create(null)),
              (this.fragments = Object.create(null)),
              (this.timeRanges = Object.create(null)),
              (this.bufferPadding = 0.2),
              (this.hls = void 0),
              (this.hasGaps = !1),
              (this.hls = e),
              this._registerListeners());
          }
          _registerListeners() {
            var e = this.hls;
            e &&
              (e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.on(Au.BUFFER_APPENDED, this.onBufferAppended, this),
              e.on(Au.FRAG_BUFFERED, this.onFragBuffered, this),
              e.on(Au.FRAG_LOADED, this.onFragLoaded, this));
          }
          _unregisterListeners() {
            var e = this.hls;
            e &&
              (e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.off(Au.BUFFER_APPENDED, this.onBufferAppended, this),
              e.off(Au.FRAG_BUFFERED, this.onFragBuffered, this),
              e.off(Au.FRAG_LOADED, this.onFragLoaded, this));
          }
          destroy() {
            (this._unregisterListeners(),
              (this.hls =
                this.fragments =
                this.activePartLists =
                this.endListFragments =
                this.timeRanges =
                  null));
          }
          getAppendedFrag(e, t) {
            var r = this.activePartLists[t];
            if (r)
              for (var i = r.length; i--; ) {
                var n = r[i];
                if (!n) break;
                if (n.start <= e && e <= n.end && n.loaded) return n;
              }
            return this.getBufferedFrag(e, t);
          }
          getBufferedFrag(e, t) {
            return this.getFragAtPos(e, t, !0);
          }
          getFragAtPos(e, t, r) {
            for (var i = this.fragments, n = Object.keys(i), a = n.length; a--; ) {
              var s = i[n[a]];
              if ((null == s ? void 0 : s.body.type) === t && (!r || s.buffered)) {
                var o = s.body;
                if (o.start <= e && e <= o.end) return o;
              }
            }
            return null;
          }
          detectEvictedFragments(e, t, r, i, n) {
            this.timeRanges && (this.timeRanges[e] = t);
            var a = (null == i ? void 0 : i.fragment.sn) || -1;
            Object.keys(this.fragments).forEach(i => {
              var s = this.fragments[i];
              if (s && !(a >= s.body.sn))
                if (s.buffered || (s.loaded && !n)) {
                  var o = s.range[e];
                  o &&
                    (0 !== o.time.length
                      ? o.time.some(e => {
                          var r = !this.isTimeBuffered(e.startPTS, e.endPTS, t);
                          return (r && this.removeFragment(s.body), r);
                        })
                      : this.removeFragment(s.body));
                } else s.body.type === r && this.removeFragment(s.body);
            });
          }
          detectPartialFragments(e) {
            var t = this.timeRanges;
            if (t && "initSegment" !== e.frag.sn) {
              var r = e.frag,
                i = Qh(r),
                n = this.fragments[i];
              if (!(!n || (n.buffered && r.gap))) {
                var a = !r.relurl;
                (Object.keys(t).forEach(i => {
                  var s = r.elementaryStreams[i];
                  if (s) {
                    var o = t[i],
                      l = a || !0 === s.partial;
                    n.range[i] = this.getBufferedTimes(r, e.part, l, o);
                  }
                }),
                  (n.loaded = null),
                  Object.keys(n.range).length
                    ? (this.bufferedEnd(n, r), Yh(n) || this.removeParts(r.sn - 1, r.type))
                    : this.removeFragment(n.body));
              }
            }
          }
          bufferedEnd(e, t) {
            ((e.buffered = !0),
              (e.body.endList = t.endList || e.body.endList) && (this.endListFragments[e.body.type] = e));
          }
          removeParts(e, t) {
            var r = this.activePartLists[t];
            r && (this.activePartLists[t] = Jh(r, t => t.fragment.sn >= e));
          }
          fragBuffered(e, t) {
            var r = Qh(e),
              i = this.fragments[r];
            (!i &&
              t &&
              ((i = this.fragments[r] =
                { body: e, appendedPTS: null, loaded: null, buffered: !1, range: Object.create(null) }),
              e.gap && (this.hasGaps = !0)),
              i && ((i.loaded = null), this.bufferedEnd(i, e)));
          }
          getBufferedTimes(e, t, r, i) {
            for (
              var n = { time: [], partial: r },
                a = e.start,
                s = e.end,
                o = e.minEndPTS || s,
                l = e.maxStartPTS || a,
                u = 0;
              u < i.length;
              u++
            ) {
              var d = i.start(u) - this.bufferPadding,
                h = i.end(u) + this.bufferPadding;
              if (l >= d && o <= h) {
                n.time.push({ startPTS: Math.max(a, i.start(u)), endPTS: Math.min(s, i.end(u)) });
                break;
              }
              if (a < h && s > d) {
                var c = Math.max(a, i.start(u)),
                  f = Math.min(s, i.end(u));
                f > c && ((n.partial = !0), n.time.push({ startPTS: c, endPTS: f }));
              } else if (s <= d) break;
            }
            return n;
          }
          getPartialFragment(e) {
            var t,
              r,
              i,
              n = null,
              a = 0,
              s = this.bufferPadding,
              o = this.fragments;
            return (
              Object.keys(o).forEach(l => {
                var u = o[l];
                u &&
                  Yh(u) &&
                  ((r = u.body.start - s),
                  (i = u.body.end + s),
                  e >= r && e <= i && ((t = Math.min(e - r, i - e)), a <= t && ((n = u.body), (a = t))));
              }),
              n
            );
          }
          isEndListAppended(e) {
            var t = this.endListFragments[e];
            return void 0 !== t && (t.buffered || Yh(t));
          }
          getState(e) {
            var t = Qh(e),
              r = this.fragments[t];
            return r ? (r.buffered ? (Yh(r) ? zh : qh) : Wh) : Kh;
          }
          isTimeBuffered(e, t, r) {
            for (var i, n, a = 0; a < r.length; a++) {
              if (
                ((i = r.start(a) - this.bufferPadding), (n = r.end(a) + this.bufferPadding), e >= i && t <= n)
              )
                return !0;
              if (t <= i) return !1;
            }
            return !1;
          }
          onManifestLoading() {
            this.removeAllFragments();
          }
          onFragLoaded(e, t) {
            if ("initSegment" !== t.frag.sn && !t.frag.bitrateTest) {
              var r = t.frag,
                i = t.part ? null : t,
                n = Qh(r);
              this.fragments[n] = {
                body: r,
                appendedPTS: null,
                loaded: i,
                buffered: !1,
                range: Object.create(null),
              };
            }
          }
          onBufferAppended(e, t) {
            var r = t.frag,
              i = t.part,
              n = t.timeRanges,
              a = t.type;
            if ("initSegment" !== r.sn) {
              var s = r.type;
              if (i) {
                var o = this.activePartLists[s];
                (o || (this.activePartLists[s] = o = []), o.push(i));
              }
              this.timeRanges = n;
              var l = n[a];
              this.detectEvictedFragments(a, l, s, i);
            }
          }
          onFragBuffered(e, t) {
            this.detectPartialFragments(t);
          }
          hasFragment(e) {
            var t = Qh(e);
            return !!this.fragments[t];
          }
          hasFragments(e) {
            var t = this.fragments,
              r = Object.keys(t);
            if (!e) return r.length > 0;
            for (var i = r.length; i--; ) {
              var n = t[r[i]];
              if ((null == n ? void 0 : n.body.type) === e) return !0;
            }
            return !1;
          }
          hasParts(e) {
            var t;
            return !(null == (t = this.activePartLists[e]) || !t.length);
          }
          removeFragmentsInRange(e, t, r, i, n) {
            (i && !this.hasGaps) ||
              Object.keys(this.fragments).forEach(a => {
                var s = this.fragments[a];
                if (s) {
                  var o = s.body;
                  o.type !== r ||
                    (i && !o.gap) ||
                    (o.start < t && o.end > e && (s.buffered || n) && this.removeFragment(o));
                }
              });
          }
          removeFragment(e) {
            var t = Qh(e);
            e.clearElementaryStreamInfo();
            var r = this.activePartLists[e.type];
            if (r) {
              var i = e.sn;
              this.activePartLists[e.type] = Jh(r, e => e.fragment.sn !== i);
            }
            (delete this.fragments[t], e.endList && delete this.endListFragments[e.type]);
          }
          removeAllFragments() {
            var e;
            ((this.fragments = Object.create(null)),
              (this.endListFragments = Object.create(null)),
              (this.activePartLists = Object.create(null)),
              (this.hasGaps = !1));
            var t = null == (e = this.hls) || null == (e = e.latestLevelDetails) ? void 0 : e.partList;
            t && t.forEach(e => e.clearElementaryStreamInfo());
          }
        }
        function Yh(e) {
          var t, r, i;
          return (
            e.buffered &&
            !!(
              e.body.gap ||
              (null != (t = e.range.video) && t.partial) ||
              (null != (r = e.range.audio) && r.partial) ||
              (null != (i = e.range.audiovideo) && i.partial)
            )
          );
        }
        function Qh(e) {
          return `${e.type}_${e.level}_${e.sn}`;
        }
        function Jh(e, t) {
          return e.filter(e => {
            var r = t(e);
            return (r || e.clearElementaryStreamInfo(), r);
          });
        }
        var Zh = 0,
          ec = 1;
        class tc {
          constructor(e, t, r) {
            ((this.subtle = void 0),
              (this.aesIV = void 0),
              (this.aesMode = void 0),
              (this.subtle = e),
              (this.aesIV = t),
              (this.aesMode = r));
          }
          decrypt(e, t) {
            switch (this.aesMode) {
              case Zh:
                return this.subtle.decrypt({ name: "AES-CBC", iv: this.aesIV }, t, e);
              case ec:
                return this.subtle.decrypt({ name: "AES-CTR", counter: this.aesIV, length: 64 }, t, e);
              default:
                throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`);
            }
          }
        }
        class rc {
          constructor() {
            ((this.rcon = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54]),
              (this.subMix = [
                new Uint32Array(256),
                new Uint32Array(256),
                new Uint32Array(256),
                new Uint32Array(256),
              ]),
              (this.invSubMix = [
                new Uint32Array(256),
                new Uint32Array(256),
                new Uint32Array(256),
                new Uint32Array(256),
              ]),
              (this.sBox = new Uint32Array(256)),
              (this.invSBox = new Uint32Array(256)),
              (this.key = new Uint32Array(0)),
              (this.ksRows = 0),
              (this.keySize = 0),
              (this.keySchedule = void 0),
              (this.invKeySchedule = void 0),
              this.initTable());
          }
          uint8ArrayToUint32Array_(e) {
            for (var t = new DataView(e), r = new Uint32Array(4), i = 0; i < 4; i++)
              r[i] = t.getUint32(4 * i);
            return r;
          }
          initTable() {
            var e = this.sBox,
              t = this.invSBox,
              r = this.subMix,
              i = r[0],
              n = r[1],
              a = r[2],
              s = r[3],
              o = this.invSubMix,
              l = o[0],
              u = o[1],
              d = o[2],
              h = o[3],
              c = new Uint32Array(256),
              f = 0,
              p = 0,
              g = 0;
            for (g = 0; g < 256; g++) c[g] = g < 128 ? g << 1 : (g << 1) ^ 283;
            for (g = 0; g < 256; g++) {
              var m = p ^ (p << 1) ^ (p << 2) ^ (p << 3) ^ (p << 4);
              ((m = (m >>> 8) ^ (255 & m) ^ 99), (e[f] = m), (t[m] = f));
              var v = c[f],
                y = c[v],
                T = c[y],
                b = (257 * c[m]) ^ (16843008 * m);
              ((i[f] = (b << 24) | (b >>> 8)),
                (n[f] = (b << 16) | (b >>> 16)),
                (a[f] = (b << 8) | (b >>> 24)),
                (s[f] = b),
                (b = (16843009 * T) ^ (65537 * y) ^ (257 * v) ^ (16843008 * f)),
                (l[m] = (b << 24) | (b >>> 8)),
                (u[m] = (b << 16) | (b >>> 16)),
                (d[m] = (b << 8) | (b >>> 24)),
                (h[m] = b),
                f ? ((f = v ^ c[c[c[T ^ v]]]), (p ^= c[c[p]])) : (f = p = 1));
            }
          }
          expandKey(e) {
            for (var t = this.uint8ArrayToUint32Array_(e), r = !0, i = 0; i < t.length && r; )
              ((r = t[i] === this.key[i]), i++);
            if (!r) {
              this.key = t;
              var n = (this.keySize = t.length);
              if (4 !== n && 6 !== n && 8 !== n) throw new Error("Invalid aes key size=" + n);
              var a,
                s,
                o,
                l,
                u = (this.ksRows = 4 * (n + 6 + 1)),
                d = (this.keySchedule = new Uint32Array(u)),
                h = (this.invKeySchedule = new Uint32Array(u)),
                c = this.sBox,
                f = this.rcon,
                p = this.invSubMix,
                g = p[0],
                m = p[1],
                v = p[2],
                y = p[3];
              for (a = 0; a < u; a++)
                a < n
                  ? (o = d[a] = t[a])
                  : ((l = o),
                    a % n === 0
                      ? ((l =
                          (c[(l = (l << 8) | (l >>> 24)) >>> 24] << 24) |
                          (c[(l >>> 16) & 255] << 16) |
                          (c[(l >>> 8) & 255] << 8) |
                          c[255 & l]),
                        (l ^= f[(a / n) | 0] << 24))
                      : n > 6 &&
                        a % n === 4 &&
                        (l =
                          (c[l >>> 24] << 24) |
                          (c[(l >>> 16) & 255] << 16) |
                          (c[(l >>> 8) & 255] << 8) |
                          c[255 & l]),
                    (d[a] = o = (d[a - n] ^ l) >>> 0));
              for (s = 0; s < u; s++)
                ((a = u - s),
                  (l = 3 & s ? d[a] : d[a - 4]),
                  (h[s] =
                    s < 4 || a <= 4
                      ? l
                      : g[c[l >>> 24]] ^ m[c[(l >>> 16) & 255]] ^ v[c[(l >>> 8) & 255]] ^ y[c[255 & l]]),
                  (h[s] = h[s] >>> 0));
            }
          }
          networkToHostOrderSwap(e) {
            return (e << 24) | ((65280 & e) << 8) | ((16711680 & e) >> 8) | (e >>> 24);
          }
          decrypt(e, t, r) {
            for (
              var i,
                n,
                a,
                s,
                o,
                l,
                u,
                d,
                h,
                c,
                f,
                p,
                g,
                m,
                v = this.keySize + 6,
                y = this.invKeySchedule,
                T = this.invSBox,
                b = this.invSubMix,
                S = b[0],
                E = b[1],
                x = b[2],
                w = b[3],
                A = this.uint8ArrayToUint32Array_(r),
                I = A[0],
                k = A[1],
                R = A[2],
                C = A[3],
                L = new Int32Array(e),
                M = new Int32Array(L.length),
                D = this.networkToHostOrderSwap;
              t < L.length;
            ) {
              for (
                h = D(L[t]),
                  c = D(L[t + 1]),
                  f = D(L[t + 2]),
                  p = D(L[t + 3]),
                  o = h ^ y[0],
                  l = p ^ y[1],
                  u = f ^ y[2],
                  d = c ^ y[3],
                  g = 4,
                  m = 1;
                m < v;
                m++
              )
                ((i = S[o >>> 24] ^ E[(l >> 16) & 255] ^ x[(u >> 8) & 255] ^ w[255 & d] ^ y[g]),
                  (n = S[l >>> 24] ^ E[(u >> 16) & 255] ^ x[(d >> 8) & 255] ^ w[255 & o] ^ y[g + 1]),
                  (a = S[u >>> 24] ^ E[(d >> 16) & 255] ^ x[(o >> 8) & 255] ^ w[255 & l] ^ y[g + 2]),
                  (s = S[d >>> 24] ^ E[(o >> 16) & 255] ^ x[(l >> 8) & 255] ^ w[255 & u] ^ y[g + 3]),
                  (o = i),
                  (l = n),
                  (u = a),
                  (d = s),
                  (g += 4));
              ((i =
                (T[o >>> 24] << 24) ^
                (T[(l >> 16) & 255] << 16) ^
                (T[(u >> 8) & 255] << 8) ^
                T[255 & d] ^
                y[g]),
                (n =
                  (T[l >>> 24] << 24) ^
                  (T[(u >> 16) & 255] << 16) ^
                  (T[(d >> 8) & 255] << 8) ^
                  T[255 & o] ^
                  y[g + 1]),
                (a =
                  (T[u >>> 24] << 24) ^
                  (T[(d >> 16) & 255] << 16) ^
                  (T[(o >> 8) & 255] << 8) ^
                  T[255 & l] ^
                  y[g + 2]),
                (s =
                  (T[d >>> 24] << 24) ^
                  (T[(o >> 16) & 255] << 16) ^
                  (T[(l >> 8) & 255] << 8) ^
                  T[255 & u] ^
                  y[g + 3]),
                (M[t] = D(i ^ I)),
                (M[t + 1] = D(s ^ k)),
                (M[t + 2] = D(a ^ R)),
                (M[t + 3] = D(n ^ C)),
                (I = h),
                (k = c),
                (R = f),
                (C = p),
                (t += 4));
            }
            return M.buffer;
          }
        }
        class ic {
          constructor(e, t, r) {
            ((this.subtle = void 0),
              (this.key = void 0),
              (this.aesMode = void 0),
              (this.subtle = e),
              (this.key = t),
              (this.aesMode = r));
          }
          expandKey() {
            var e = (function (e) {
              switch (e) {
                case Zh:
                  return "AES-CBC";
                case ec:
                  return "AES-CTR";
                default:
                  throw new Error(`[FastAESKey] invalid aes mode ${e}`);
              }
            })(this.aesMode);
            return this.subtle.importKey("raw", this.key, { name: e }, !1, ["encrypt", "decrypt"]);
          }
        }
        class nc {
          constructor(e, { removePKCS7Padding: t = !0 } = {}) {
            if (
              ((this.logEnabled = !0),
              (this.removePKCS7Padding = void 0),
              (this.subtle = null),
              (this.softwareDecrypter = null),
              (this.key = null),
              (this.fastAesKey = null),
              (this.remainderData = null),
              (this.currentIV = null),
              (this.currentResult = null),
              (this.useSoftware = void 0),
              (this.enableSoftwareAES = void 0),
              (this.enableSoftwareAES = e.enableSoftwareAES),
              (this.removePKCS7Padding = t),
              t)
            )
              try {
                var r = self.crypto;
                r && (this.subtle = r.subtle || r.webkitSubtle);
              } catch (i) {}
            this.useSoftware = !this.subtle;
          }
          destroy() {
            ((this.subtle = null),
              (this.softwareDecrypter = null),
              (this.key = null),
              (this.fastAesKey = null),
              (this.remainderData = null),
              (this.currentIV = null),
              (this.currentResult = null));
          }
          isSync() {
            return this.useSoftware;
          }
          flush() {
            var e = this.currentResult,
              t = this.remainderData;
            if (!e || t) return (this.reset(), null);
            var r,
              i,
              n,
              a = new Uint8Array(e);
            return (
              this.reset(),
              this.removePKCS7Padding
                ? ((i = (r = a).byteLength),
                  (n = i && new DataView(r.buffer).getUint8(i - 1)) ? r.slice(0, i - n) : r)
                : a
            );
          }
          reset() {
            ((this.currentResult = null),
              (this.currentIV = null),
              (this.remainderData = null),
              this.softwareDecrypter && (this.softwareDecrypter = null));
          }
          decrypt(e, t, r, i) {
            return this.useSoftware
              ? new Promise((n, a) => {
                  var s = ArrayBuffer.isView(e) ? e : new Uint8Array(e);
                  this.softwareDecrypt(s, t, r, i);
                  var o = this.flush();
                  o ? n(o.buffer) : a(new Error("[softwareDecrypt] Failed to decrypt data"));
                })
              : this.webCryptoDecrypt(new Uint8Array(e), t, r, i);
          }
          softwareDecrypt(e, t, r, i) {
            var n = this.currentIV,
              a = this.currentResult,
              s = this.remainderData;
            if (i !== Zh || 16 !== t.byteLength)
              return (Ku.warn("SoftwareDecrypt: can only handle AES-128-CBC"), null);
            (this.logOnce("JS AES decrypt"), s && ((e = Rd(s, e)), (this.remainderData = null)));
            var o = this.getValidChunk(e);
            if (!o.length) return null;
            n && (r = n);
            var l = this.softwareDecrypter;
            (l || (l = this.softwareDecrypter = new rc()), l.expandKey(t));
            var u = a;
            return (
              (this.currentResult = l.decrypt(o.buffer, 0, r)),
              (this.currentIV = o.slice(-16).buffer),
              u || null
            );
          }
          webCryptoDecrypt(e, t, r, i) {
            if (this.key !== t || !this.fastAesKey) {
              if (!this.subtle) return Promise.resolve(this.onWebCryptoError(e, t, r, i));
              ((this.key = t), (this.fastAesKey = new ic(this.subtle, t, i)));
            }
            return this.fastAesKey
              .expandKey()
              .then(t =>
                this.subtle
                  ? (this.logOnce("WebCrypto AES decrypt"),
                    new tc(this.subtle, new Uint8Array(r), i).decrypt(e.buffer, t))
                  : Promise.reject(new Error("web crypto not initialized")),
              )
              .catch(
                n => (
                  Ku.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${n.name}: ${n.message}`),
                  this.onWebCryptoError(e, t, r, i)
                ),
              );
          }
          onWebCryptoError(e, t, r, i) {
            var n = this.enableSoftwareAES;
            if (n) {
              ((this.useSoftware = !0), (this.logEnabled = !0), this.softwareDecrypt(e, t, r, i));
              var a = this.flush();
              if (a) return a.buffer;
            }
            throw new Error("WebCrypto" + (n ? " and softwareDecrypt" : "") + ": failed to decrypt data");
          }
          getValidChunk(e) {
            var t = e,
              r = e.length - (e.length % 16);
            return (r !== e.length && ((t = e.slice(0, r)), (this.remainderData = e.slice(r))), t);
          }
          logOnce(e) {
            this.logEnabled && (Ku.log(`[decrypter]: ${e}`), (this.logEnabled = !1));
          }
        }
        var ac = Math.pow(2, 17);
        class sc {
          constructor(e) {
            ((this.config = void 0), (this.loader = null), (this.partLoadTimeout = -1), (this.config = e));
          }
          destroy() {
            this.loader && (this.loader.destroy(), (this.loader = null));
          }
          abort() {
            this.loader && this.loader.abort();
          }
          load(e, t) {
            var r = e.url;
            if (!r)
              return Promise.reject(
                new uc({
                  type: xu.NETWORK_ERROR,
                  details: wu.FRAG_LOAD_ERROR,
                  fatal: !1,
                  frag: e,
                  error: new Error("Fragment does not have a " + (r ? "part list" : "url")),
                  networkDetails: null,
                }),
              );
            this.abort();
            var i = this.config,
              n = i.fLoader,
              a = i.loader;
            return new Promise((s, o) => {
              if ((this.loader && this.loader.destroy(), e.gap)) {
                if (e.tagList.some(e => "GAP" === e[0])) return void o(lc(e));
                e.gap = !1;
              }
              var l = (this.loader = n ? new n(i) : new a(i)),
                u = oc(e);
              e.loader = l;
              var d = _h(i.fragLoadPolicy.default),
                h = {
                  loadPolicy: d,
                  timeout: d.maxLoadTimeMs,
                  maxRetry: 0,
                  retryDelay: 0,
                  maxRetryDelay: 0,
                  highWaterMark: "initSegment" === e.sn ? 1 / 0 : ac,
                };
              e.stats = l.stats;
              var c = {
                onSuccess: (t, r, i, n) => {
                  this.resetLoader(e, l);
                  var a = t.data;
                  (i.resetIV &&
                    e.decryptdata &&
                    ((e.decryptdata.iv = new Uint8Array(a.slice(0, 16))), (a = a.slice(16))),
                    s({ frag: e, part: null, payload: a, networkDetails: n }));
                },
                onError: (t, i, n, a) => {
                  (this.resetLoader(e, l),
                    o(
                      new uc({
                        type: xu.NETWORK_ERROR,
                        details: wu.FRAG_LOAD_ERROR,
                        fatal: !1,
                        frag: e,
                        response: Uu({ url: r, data: void 0 }, t),
                        error: new Error(`HTTP Error ${t.code} ${t.text}`),
                        networkDetails: n,
                        stats: a,
                      }),
                    ));
                },
                onAbort: (t, r, i) => {
                  (this.resetLoader(e, l),
                    o(
                      new uc({
                        type: xu.NETWORK_ERROR,
                        details: wu.INTERNAL_ABORTED,
                        fatal: !1,
                        frag: e,
                        error: new Error("Aborted"),
                        networkDetails: i,
                        stats: t,
                      }),
                    ));
                },
                onTimeout: (t, r, i) => {
                  (this.resetLoader(e, l),
                    o(
                      new uc({
                        type: xu.NETWORK_ERROR,
                        details: wu.FRAG_LOAD_TIMEOUT,
                        fatal: !1,
                        frag: e,
                        error: new Error(`Timeout after ${h.timeout}ms`),
                        networkDetails: i,
                        stats: t,
                      }),
                    ));
                },
              };
              (t &&
                (c.onProgress = (r, i, n, a) => t({ frag: e, part: null, payload: n, networkDetails: a })),
                l.load(u, h, c));
            });
          }
          loadPart(e, t, r) {
            this.abort();
            var i = this.config,
              n = i.fLoader,
              a = i.loader;
            return new Promise((s, o) => {
              if ((this.loader && this.loader.destroy(), e.gap || t.gap)) o(lc(e, t));
              else {
                var l = (this.loader = n ? new n(i) : new a(i)),
                  u = oc(e, t);
                e.loader = l;
                var d = _h(i.fragLoadPolicy.default),
                  h = {
                    loadPolicy: d,
                    timeout: d.maxLoadTimeMs,
                    maxRetry: 0,
                    retryDelay: 0,
                    maxRetryDelay: 0,
                    highWaterMark: ac,
                  };
                ((t.stats = l.stats),
                  l.load(u, h, {
                    onSuccess: (i, n, a, o) => {
                      (this.resetLoader(e, l), this.updateStatsFromPart(e, t));
                      var u = { frag: e, part: t, payload: i.data, networkDetails: o };
                      (r(u), s(u));
                    },
                    onError: (r, i, n, a) => {
                      (this.resetLoader(e, l),
                        o(
                          new uc({
                            type: xu.NETWORK_ERROR,
                            details: wu.FRAG_LOAD_ERROR,
                            fatal: !1,
                            frag: e,
                            part: t,
                            response: Uu({ url: u.url, data: void 0 }, r),
                            error: new Error(`HTTP Error ${r.code} ${r.text}`),
                            networkDetails: n,
                            stats: a,
                          }),
                        ));
                    },
                    onAbort: (r, i, n) => {
                      ((e.stats.aborted = t.stats.aborted),
                        this.resetLoader(e, l),
                        o(
                          new uc({
                            type: xu.NETWORK_ERROR,
                            details: wu.INTERNAL_ABORTED,
                            fatal: !1,
                            frag: e,
                            part: t,
                            error: new Error("Aborted"),
                            networkDetails: n,
                            stats: r,
                          }),
                        ));
                    },
                    onTimeout: (r, i, n) => {
                      (this.resetLoader(e, l),
                        o(
                          new uc({
                            type: xu.NETWORK_ERROR,
                            details: wu.FRAG_LOAD_TIMEOUT,
                            fatal: !1,
                            frag: e,
                            part: t,
                            error: new Error(`Timeout after ${h.timeout}ms`),
                            networkDetails: n,
                            stats: r,
                          }),
                        ));
                    },
                  }));
              }
            });
          }
          updateStatsFromPart(e, t) {
            var r = e.stats,
              i = t.stats,
              n = i.total;
            if (((r.loaded += i.loaded), n)) {
              var a = Math.round(e.duration / t.duration),
                s = Math.min(Math.round(r.loaded / n), a),
                o = (a - s) * Math.round(r.loaded / s);
              r.total = r.loaded + o;
            } else r.total = Math.max(r.loaded, r.total);
            var l = r.loading,
              u = i.loading;
            (l.start ? (l.first += u.first - u.start) : ((l.start = u.start), (l.first = u.first)),
              (l.end = u.end));
          }
          resetLoader(e, t) {
            ((e.loader = null),
              this.loader === t && (self.clearTimeout(this.partLoadTimeout), (this.loader = null)),
              t.destroy());
          }
        }
        function oc(e, t = null) {
          var r,
            i = t || e,
            n = {
              frag: e,
              part: t,
              responseType: "arraybuffer",
              url: i.url,
              headers: {},
              rangeStart: 0,
              rangeEnd: 0,
            },
            a = i.byteRangeStartOffset,
            s = i.byteRangeEndOffset;
          if (bu(a) && bu(s)) {
            var o,
              l = a,
              u = s;
            if (
              "initSegment" === e.sn &&
              ("AES-128" === (r = null == (o = e.decryptdata) ? void 0 : o.method) || "AES-256" === r)
            ) {
              var d = s - a;
              (d % 16 && (u = s + (16 - (d % 16))), 0 !== a && ((n.resetIV = !0), (l = a - 16)));
            }
            ((n.rangeStart = l), (n.rangeEnd = u));
          }
          return n;
        }
        function lc(e, t) {
          var r = new Error(`GAP ${e.gap ? "tag" : "attribute"} found`),
            i = {
              type: xu.MEDIA_ERROR,
              details: wu.FRAG_GAP,
              fatal: !1,
              frag: e,
              error: r,
              networkDetails: null,
            };
          return (t && (i.part = t), ((t || e).stats.aborted = !0), new uc(i));
        }
        class uc extends Error {
          constructor(e) {
            (super(e.error.message), (this.data = void 0), (this.data = e));
          }
        }
        class dc extends Bu {
          constructor(e, t) {
            (super(e, t),
              (this._boundTick = void 0),
              (this._tickTimer = null),
              (this._tickInterval = null),
              (this._tickCallCount = 0),
              (this._boundTick = this.tick.bind(this)));
          }
          destroy() {
            (this.onHandlerDestroying(), this.onHandlerDestroyed());
          }
          onHandlerDestroying() {
            (this.clearNextTick(), this.clearInterval());
          }
          onHandlerDestroyed() {}
          hasInterval() {
            return !!this._tickInterval;
          }
          hasNextTick() {
            return !!this._tickTimer;
          }
          setInterval(e) {
            return (
              !this._tickInterval &&
              ((this._tickCallCount = 0), (this._tickInterval = self.setInterval(this._boundTick, e)), !0)
            );
          }
          clearInterval() {
            return (
              !!this._tickInterval &&
              (self.clearInterval(this._tickInterval), (this._tickInterval = null), !0)
            );
          }
          clearNextTick() {
            return !!this._tickTimer && (self.clearTimeout(this._tickTimer), (this._tickTimer = null), !0);
          }
          tick() {
            (this._tickCallCount++,
              1 === this._tickCallCount &&
                (this.doTick(), this._tickCallCount > 1 && this.tickImmediate(), (this._tickCallCount = 0)));
          }
          tickImmediate() {
            (this.clearNextTick(), (this._tickTimer = self.setTimeout(this._boundTick, 0)));
          }
          doTick() {}
        }
        class hc {
          constructor(e, t, r, i = 0, n = -1, a = !1) {
            ((this.level = void 0),
              (this.sn = void 0),
              (this.part = void 0),
              (this.id = void 0),
              (this.size = void 0),
              (this.partial = void 0),
              (this.transmuxing = { start: 0, executeStart: 0, executeEnd: 0, end: 0 }),
              (this.buffering = {
                audio: { start: 0, executeStart: 0, executeEnd: 0, end: 0 },
                video: { start: 0, executeStart: 0, executeEnd: 0, end: 0 },
                audiovideo: { start: 0, executeStart: 0, executeEnd: 0, end: 0 },
              }),
              (this.level = e),
              (this.sn = t),
              (this.id = r),
              (this.size = i),
              (this.part = n),
              (this.partial = a));
          }
        }
        var cc = { length: 0, start: () => 0, end: () => 0 };
        class fc {
          static isBuffered(e, t) {
            if (e)
              for (var r = fc.getBuffered(e), i = r.length; i--; )
                if (t >= r.start(i) && t <= r.end(i)) return !0;
            return !1;
          }
          static bufferedRanges(e) {
            if (e) {
              var t = fc.getBuffered(e);
              return fc.timeRangesToArray(t);
            }
            return [];
          }
          static timeRangesToArray(e) {
            for (var t = [], r = 0; r < e.length; r++) t.push({ start: e.start(r), end: e.end(r) });
            return t;
          }
          static bufferInfo(e, t, r) {
            if (e) {
              var i = fc.bufferedRanges(e);
              if (i.length) return fc.bufferedInfo(i, t, r);
            }
            return { len: 0, start: t, end: t, bufferedIndex: -1 };
          }
          static bufferedInfo(e, t, r) {
            ((t = Math.max(0, t)), e.length > 1 && e.sort((e, t) => e.start - t.start || t.end - e.end));
            var i = -1,
              n = [];
            if (r)
              for (var a = 0; a < e.length; a++) {
                t >= e[a].start && t <= e[a].end && (i = a);
                var s = n.length;
                if (s) {
                  var o = n[s - 1].end;
                  e[a].start - o < r ? e[a].end > o && (n[s - 1].end = e[a].end) : n.push(e[a]);
                } else n.push(e[a]);
              }
            else n = e;
            for (var l, u = 0, d = t, h = t, c = 0; c < n.length; c++) {
              var f = n[c].start,
                p = n[c].end;
              if ((-1 === i && t >= f && t <= p && (i = c), t + r >= f && t < p))
                ((d = f), (u = (h = p) - t));
              else if (t + r < f) {
                l = f;
                break;
              }
            }
            return { len: u, start: d || 0, end: h || 0, nextStart: l, buffered: e, bufferedIndex: i };
          }
          static getBuffered(e) {
            try {
              return e.buffered || cc;
            } catch (t) {
              return (Ku.log("failed to get media.buffered", t), cc);
            }
          }
        }
        var pc = /\{\$([a-zA-Z0-9-_]+)\}/g;
        function gc(e) {
          return pc.test(e);
        }
        function mc(e, t) {
          if (null !== e.variableList || e.hasVariableRefs) {
            var r = e.variableList;
            return t.replace(pc, t => {
              var i = t.substring(2, t.length - 1),
                n = null == r ? void 0 : r[i];
              return void 0 === n
                ? (e.playlistParsingError ||
                    (e.playlistParsingError = new Error(
                      `Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`,
                    )),
                  t)
                : n;
            });
          }
          return t;
        }
        function vc(e, t, r) {
          var i,
            n,
            a = e.variableList;
          if ((a || (e.variableList = a = {}), "QUERYPARAM" in t)) {
            i = t.QUERYPARAM;
            try {
              var s = new self.URL(r).searchParams;
              if (!s.has(i)) throw new Error(`"${i}" does not match any query parameter in URI: "${r}"`);
              n = s.get(i);
            } catch (o) {
              e.playlistParsingError ||
                (e.playlistParsingError = new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`));
            }
          } else ((i = t.NAME), (n = t.VALUE));
          i in a
            ? e.playlistParsingError ||
              (e.playlistParsingError = new Error(
                `EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`,
              ))
            : (a[i] = n || "");
        }
        function yc(e, t, r) {
          var i = t.IMPORT;
          if (r && i in r) {
            var n = e.variableList;
            (n || (e.variableList = n = {}), (n[i] = r[i]));
          } else
            e.playlistParsingError ||
              (e.playlistParsingError = new Error(
                `EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`,
              ));
        }
        var Tc = /^(\d+)x(\d+)$/,
          bc = /(.+?)=(".*?"|.*?)(?:,|$)/g;
        class Sc {
          constructor(e, t) {
            ("string" == typeof e && (e = Sc.parseAttrList(e, t)), Nu(this, e));
          }
          get clientAttrs() {
            return Object.keys(this).filter(e => "X-" === e.substring(0, 2));
          }
          decimalInteger(e) {
            var t = parseInt(this[e], 10);
            return t > Number.MAX_SAFE_INTEGER ? 1 / 0 : t;
          }
          hexadecimalInteger(e) {
            if (this[e]) {
              var t = (this[e] || "0x").slice(2);
              t = (1 & t.length ? "0" : "") + t;
              for (var r = new Uint8Array(t.length / 2), i = 0; i < t.length / 2; i++)
                r[i] = parseInt(t.slice(2 * i, 2 * i + 2), 16);
              return r;
            }
            return null;
          }
          hexadecimalIntegerAsNumber(e) {
            var t = parseInt(this[e], 16);
            return t > Number.MAX_SAFE_INTEGER ? 1 / 0 : t;
          }
          decimalFloatingPoint(e) {
            return parseFloat(this[e]);
          }
          optionalFloat(e, t) {
            var r = this[e];
            return r ? parseFloat(r) : t;
          }
          enumeratedString(e) {
            return this[e];
          }
          enumeratedStringList(e, t) {
            var r = this[e];
            return (r ? r.split(/[ ,]+/) : []).reduce((e, t) => ((e[t.toLowerCase()] = !0), e), t);
          }
          bool(e) {
            return "YES" === this[e];
          }
          decimalResolution(e) {
            var t = Tc.exec(this[e]);
            if (null !== t) return { width: parseInt(t[1], 10), height: parseInt(t[2], 10) };
          }
          static parseAttrList(e, t) {
            var r,
              i = {};
            for (bc.lastIndex = 0; null !== (r = bc.exec(e)); ) {
              var n = r[1].trim(),
                a = r[2],
                s = 0 === a.indexOf('"') && a.lastIndexOf('"') === a.length - 1,
                o = !1;
              if (s) a = a.slice(1, -1);
              else
                switch (n) {
                  case "IV":
                  case "SCTE35-CMD":
                  case "SCTE35-IN":
                  case "SCTE35-OUT":
                    o = !0;
                }
              if (t && (s || o)) a = mc(t, a);
              else if (!o && !s)
                switch (n) {
                  case "CLOSED-CAPTIONS":
                    if ("NONE" === a) break;
                  case "ALLOWED-CPC":
                  case "CLASS":
                  case "ASSOC-LANGUAGE":
                  case "AUDIO":
                  case "BYTERANGE":
                  case "CHANNELS":
                  case "CHARACTERISTICS":
                  case "CODECS":
                  case "DATA-ID":
                  case "END-DATE":
                  case "GROUP-ID":
                  case "ID":
                  case "IMPORT":
                  case "INSTREAM-ID":
                  case "KEYFORMAT":
                  case "KEYFORMATVERSIONS":
                  case "LANGUAGE":
                  case "NAME":
                  case "PATHWAY-ID":
                  case "QUERYPARAM":
                  case "RECENTLY-REMOVED-DATERANGES":
                  case "SERVER-URI":
                  case "STABLE-RENDITION-ID":
                  case "STABLE-VARIANT-ID":
                  case "START-DATE":
                  case "SUBTITLES":
                  case "SUPPLEMENTAL-CODECS":
                  case "URI":
                  case "VALUE":
                  case "VIDEO":
                  case "X-ASSET-LIST":
                  case "X-ASSET-URI":
                    Ku.warn(`${e}: attribute ${n} is missing quotes`);
                }
              i[n] = a;
            }
            return i;
          }
        }
        function Ec(e) {
          return (
            "ID" !== e &&
            "CLASS" !== e &&
            "CUE" !== e &&
            "START-DATE" !== e &&
            "DURATION" !== e &&
            "END-DATE" !== e &&
            "END-ON-NEXT" !== e
          );
        }
        function xc(e) {
          return "SCTE35-OUT" === e || "SCTE35-IN" === e || "SCTE35-CMD" === e;
        }
        class wc {
          constructor(e, t, r = 0) {
            var i;
            if (
              ((this.attr = void 0),
              (this.tagAnchor = void 0),
              (this.tagOrder = void 0),
              (this._startDate = void 0),
              (this._endDate = void 0),
              (this._dateAtEnd = void 0),
              (this._cue = void 0),
              (this._badValueForSameId = void 0),
              (this.tagAnchor = (null == t ? void 0 : t.tagAnchor) || null),
              (this.tagOrder = null != (i = null == t ? void 0 : t.tagOrder) ? i : r),
              t)
            ) {
              var n = t.attr;
              for (var a in n)
                if (Object.prototype.hasOwnProperty.call(e, a) && e[a] !== n[a]) {
                  (Ku.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),
                    (this._badValueForSameId = a));
                  break;
                }
              e = Nu(new Sc({}), n, e);
            }
            if (
              ((this.attr = e),
              t
                ? ((this._startDate = t._startDate),
                  (this._cue = t._cue),
                  (this._endDate = t._endDate),
                  (this._dateAtEnd = t._dateAtEnd))
                : (this._startDate = new Date(e["START-DATE"])),
              "END-DATE" in this.attr)
            ) {
              var s = (null == t ? void 0 : t.endDate) || new Date(this.attr["END-DATE"]);
              bu(s.getTime()) && (this._endDate = s);
            }
          }
          get id() {
            return this.attr.ID;
          }
          get class() {
            return this.attr.CLASS;
          }
          get cue() {
            var e = this._cue;
            return void 0 === e
              ? (this._cue = this.attr.enumeratedStringList(this.attr.CUE ? "CUE" : "X-CUE", {
                  pre: !1,
                  post: !1,
                  once: !1,
                }))
              : e;
          }
          get startTime() {
            var e = this.tagAnchor;
            return null === e || null === e.programDateTime
              ? (Ku.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`), NaN)
              : e.start + (this.startDate.getTime() - e.programDateTime) / 1e3;
          }
          get startDate() {
            return this._startDate;
          }
          get endDate() {
            var e = this._endDate || this._dateAtEnd;
            if (e) return e;
            var t = this.duration;
            return null !== t ? (this._dateAtEnd = new Date(this._startDate.getTime() + 1e3 * t)) : null;
          }
          get duration() {
            if ("DURATION" in this.attr) {
              var e = this.attr.decimalFloatingPoint("DURATION");
              if (bu(e)) return e;
            } else if (this._endDate) return (this._endDate.getTime() - this._startDate.getTime()) / 1e3;
            return null;
          }
          get plannedDuration() {
            return "PLANNED-DURATION" in this.attr
              ? this.attr.decimalFloatingPoint("PLANNED-DURATION")
              : null;
          }
          get endOnNext() {
            return this.attr.bool("END-ON-NEXT");
          }
          get isInterstitial() {
            return "com.apple.hls.interstitial" === this.class;
          }
          get isValid() {
            return (
              !!this.id &&
              !this._badValueForSameId &&
              bu(this.startDate.getTime()) &&
              (null === this.duration || this.duration >= 0) &&
              (!this.endOnNext || !!this.class) &&
              (!this.attr.CUE || (!this.cue.pre && !this.cue.post) || this.cue.pre !== this.cue.post) &&
              (!this.isInterstitial || "X-ASSET-URI" in this.attr || "X-ASSET-LIST" in this.attr)
            );
          }
        }
        class Ac {
          constructor(e) {
            ((this.PTSKnown = !1),
              (this.alignedSliding = !1),
              (this.averagetargetduration = void 0),
              (this.endCC = 0),
              (this.endSN = 0),
              (this.fragments = void 0),
              (this.fragmentHint = void 0),
              (this.partList = null),
              (this.dateRanges = void 0),
              (this.dateRangeTagCount = 0),
              (this.live = !0),
              (this.requestScheduled = -1),
              (this.ageHeader = 0),
              (this.advancedDateTime = void 0),
              (this.updated = !0),
              (this.advanced = !0),
              (this.misses = 0),
              (this.startCC = 0),
              (this.startSN = 0),
              (this.startTimeOffset = null),
              (this.targetduration = 0),
              (this.totalduration = 0),
              (this.type = null),
              (this.url = void 0),
              (this.m3u8 = ""),
              (this.version = null),
              (this.canBlockReload = !1),
              (this.canSkipUntil = 0),
              (this.canSkipDateRanges = !1),
              (this.skippedSegments = 0),
              (this.recentlyRemovedDateranges = void 0),
              (this.partHoldBack = 0),
              (this.holdBack = 0),
              (this.partTarget = 0),
              (this.preloadHint = void 0),
              (this.renditionReports = void 0),
              (this.tuneInGoal = 0),
              (this.deltaUpdateFailed = void 0),
              (this.driftStartTime = 0),
              (this.driftEndTime = 0),
              (this.driftStart = 0),
              (this.driftEnd = 0),
              (this.encryptedFragments = void 0),
              (this.playlistParsingError = null),
              (this.variableList = null),
              (this.hasVariableRefs = !1),
              (this.appliedTimelineOffset = void 0),
              (this.fragments = []),
              (this.encryptedFragments = []),
              (this.dateRanges = {}),
              (this.url = e));
          }
          reloaded(e) {
            if (!e) return ((this.advanced = !0), void (this.updated = !0));
            var t = this.lastPartSn - e.lastPartSn,
              r = this.lastPartIndex - e.lastPartIndex;
            ((this.updated = this.endSN !== e.endSN || !!r || !!t || !this.live),
              (this.advanced = this.endSN > e.endSN || t > 0 || (0 === t && r > 0)),
              this.updated || this.advanced
                ? (this.misses = Math.floor(0.6 * e.misses))
                : (this.misses = e.misses + 1));
          }
          hasKey(e) {
            return this.encryptedFragments.some(t => {
              var r = t.decryptdata;
              return (r || (t.setKeyFormat(e.keyFormat), (r = t.decryptdata)), !!r && e.matches(r));
            });
          }
          get hasProgramDateTime() {
            return !!this.fragments.length && bu(this.fragments[this.fragments.length - 1].programDateTime);
          }
          get levelTargetDuration() {
            return this.averagetargetduration || this.targetduration || 10;
          }
          get drift() {
            var e = this.driftEndTime - this.driftStartTime;
            return e > 0 ? (1e3 * (this.driftEnd - this.driftStart)) / e : 1;
          }
          get edge() {
            return this.partEnd || this.fragmentEnd;
          }
          get partEnd() {
            var e;
            return null != (e = this.partList) && e.length
              ? this.partList[this.partList.length - 1].end
              : this.fragmentEnd;
          }
          get fragmentEnd() {
            return this.fragments.length ? this.fragments[this.fragments.length - 1].end : 0;
          }
          get fragmentStart() {
            return this.fragments.length ? this.fragments[0].start : 0;
          }
          get age() {
            return this.advancedDateTime ? Math.max(Date.now() - this.advancedDateTime, 0) / 1e3 : 0;
          }
          get lastPartIndex() {
            var e;
            return null != (e = this.partList) && e.length
              ? this.partList[this.partList.length - 1].index
              : -1;
          }
          get maxPartIndex() {
            var e = this.partList;
            if (e) {
              var t = this.lastPartIndex;
              if (-1 !== t) {
                for (var r = e.length; r--; ) if (e[r].index > t) return e[r].index;
                return t;
              }
            }
            return 0;
          }
          get lastPartSn() {
            var e;
            return null != (e = this.partList) && e.length
              ? this.partList[this.partList.length - 1].fragment.sn
              : this.endSN;
          }
          get expired() {
            if (this.live && this.age && this.misses < 3) {
              var e = this.partEnd - this.fragmentStart;
              return this.age > Math.max(e, this.totalduration) + this.levelTargetDuration;
            }
            return !1;
          }
        }
        function Ic(e, t) {
          return e.length === t.length && !e.some((e, r) => e !== t[r]);
        }
        function kc(e, t) {
          return (!e && !t) || (!(!e || !t) && Ic(e, t));
        }
        function Rc(e) {
          return "AES-128" === e || "AES-256" === e || "AES-256-CTR" === e;
        }
        function Cc(e) {
          switch (e) {
            case "AES-128":
            case "AES-256":
              return Zh;
            case "AES-256-CTR":
              return ec;
            default:
              throw new Error(`invalid full segment method ${e}`);
          }
        }
        function Lc(e) {
          return Uint8Array.from(atob(e), e => e.charCodeAt(0));
        }
        function Mc(e) {
          return Uint8Array.from(unescape(encodeURIComponent(e)), e => e.charCodeAt(0));
        }
        function Dc(e) {
          var t = function (e, t, r) {
            var i = e[t];
            ((e[t] = e[r]), (e[r] = i));
          };
          (t(e, 0, 3), t(e, 1, 2), t(e, 4, 5), t(e, 6, 7));
        }
        function _c(e) {
          var t,
            r,
            i = e.split(":"),
            n = null;
          if ("data" === i[0] && 2 === i.length) {
            var a = i[1].split(";"),
              s = a[a.length - 1].split(",");
            if (2 === s.length) {
              var o = "base64" === s[0],
                l = s[1];
              o
                ? (a.splice(-1, 1), (n = Lc(l)))
                : ((t = Mc(l).subarray(0, 16)), (r = new Uint8Array(16)).set(t, 16 - t.length), (n = r));
            }
          }
          return n;
        }
        var Pc = "undefined" != typeof self ? self : void 0,
          Oc = {
            CLEARKEY: "org.w3.clearkey",
            FAIRPLAY: "com.apple.fps",
            PLAYREADY: "com.microsoft.playready",
            WIDEVINE: "com.widevine.alpha",
          },
          Nc = "org.w3.clearkey",
          Fc = "com.apple.streamingkeydelivery",
          Uc = "com.microsoft.playready",
          Bc = "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";
        function $c(e) {
          switch (e) {
            case Fc:
              return Oc.FAIRPLAY;
            case Uc:
              return Oc.PLAYREADY;
            case Bc:
              return Oc.WIDEVINE;
            case Nc:
              return Oc.CLEARKEY;
          }
        }
        function jc(e) {
          switch (e) {
            case Oc.FAIRPLAY:
              return Fc;
            case Oc.PLAYREADY:
              return Uc;
            case Oc.WIDEVINE:
              return Bc;
            case Oc.CLEARKEY:
              return Nc;
          }
        }
        function Gc(e) {
          var t = e.drmSystems,
            r = e.widevineLicenseUrl,
            i = t ? [Oc.FAIRPLAY, Oc.WIDEVINE, Oc.PLAYREADY, Oc.CLEARKEY].filter(e => !!t[e]) : [];
          return (!i[Oc.WIDEVINE] && r && i.push(Oc.WIDEVINE), i);
        }
        var Vc,
          Hc =
            null != Pc && null != (Vc = Pc.navigator) && Vc.requestMediaKeySystemAccess
              ? self.navigator.requestMediaKeySystemAccess.bind(self.navigator)
              : null;
        function Kc(e) {
          var t = new Uint16Array(e.buffer, e.byteOffset, e.byteLength / 2),
            r = String.fromCharCode.apply(null, Array.from(t)),
            i = r.substring(r.indexOf("<"), r.length),
            n = new DOMParser().parseFromString(i, "text/xml").getElementsByTagName("KID")[0];
          if (n) {
            var a = n.childNodes[0] ? n.childNodes[0].nodeValue : n.getAttribute("VALUE");
            if (a) {
              var s = Lc(a).subarray(0, 16);
              return (Dc(s), s);
            }
          }
          return null;
        }
        var Wc = {};
        class zc {
          static clearKeyUriToKeyIdMap() {
            Wc = {};
          }
          static setKeyIdForUri(e, t) {
            Wc[e] = t;
          }
          static addKeyIdForUri(e) {
            var t = Object.keys(Wc).length % Number.MAX_SAFE_INTEGER,
              r = new Uint8Array(16);
            return (new DataView(r.buffer, 12, 4).setUint32(0, t), (Wc[e] = r), r);
          }
          constructor(e, t, r, i = [1], n = null, a) {
            ((this.uri = void 0),
              (this.method = void 0),
              (this.keyFormat = void 0),
              (this.keyFormatVersions = void 0),
              (this.encrypted = void 0),
              (this.isCommonEncryption = void 0),
              (this.iv = null),
              (this.key = null),
              (this.keyId = null),
              (this.pssh = null),
              (this.method = e),
              (this.uri = t),
              (this.keyFormat = r),
              (this.keyFormatVersions = i),
              (this.iv = n),
              (this.encrypted = !!e && "NONE" !== e),
              (this.isCommonEncryption = this.encrypted && !Rc(e)),
              null != a && a.startsWith("0x") && (this.keyId = new Uint8Array(Yu(a))));
          }
          matches(e) {
            return (
              e.uri === this.uri &&
              e.method === this.method &&
              e.encrypted === this.encrypted &&
              e.keyFormat === this.keyFormat &&
              Ic(e.keyFormatVersions, this.keyFormatVersions) &&
              kc(e.iv, this.iv) &&
              kc(e.keyId, this.keyId)
            );
          }
          isSupported() {
            if (this.method) {
              if (Rc(this.method) || "NONE" === this.method) return !0;
              if ("identity" === this.keyFormat) return "SAMPLE-AES" === this.method;
              switch (this.keyFormat) {
                case Fc:
                case Bc:
                case Uc:
                case Nc:
                  return -1 !== ["SAMPLE-AES", "SAMPLE-AES-CENC", "SAMPLE-AES-CTR"].indexOf(this.method);
              }
            }
            return !1;
          }
          getDecryptData(e, t) {
            if (!this.encrypted || !this.uri) return null;
            if (Rc(this.method)) {
              var r = this.iv;
              return (
                r ||
                  ("number" != typeof e &&
                    (Ku.warn(
                      `missing IV for initialization segment with method="${this.method}" - compliance issue`,
                    ),
                    (e = 0)),
                  (r = (function (e) {
                    for (var t = new Uint8Array(16), r = 12; r < 16; r++) t[r] = (e >> (8 * (15 - r))) & 255;
                    return t;
                  })(e))),
                new zc(this.method, this.uri, "identity", this.keyFormatVersions, r)
              );
            }
            if (this.keyId) {
              var i = Wc[this.uri];
              if ((i && !Ic(this.keyId, i) && zc.setKeyIdForUri(this.uri, this.keyId), this.pssh))
                return this;
            }
            var n,
              a = _c(this.uri);
            if (a)
              switch (this.keyFormat) {
                case Bc:
                  if (((this.pssh = a), !this.keyId)) {
                    var s = (function (e) {
                      var t = [];
                      if (e instanceof ArrayBuffer)
                        for (var r = e.byteLength, i = 0; i + 32 < r; ) {
                          var n = Od(new DataView(e, i));
                          (t.push(n), (i += n.size));
                        }
                      return t;
                    })(a.buffer);
                    if (s.length) {
                      var o,
                        l = s[0];
                      this.keyId = null != (o = l.kids) && o.length ? l.kids[0] : null;
                    }
                  }
                  this.keyId || (this.keyId = qc(t));
                  break;
                case Uc:
                  var u = new Uint8Array([
                    154, 4, 240, 121, 152, 64, 66, 134, 171, 146, 230, 91, 224, 136, 95, 149,
                  ]);
                  ((this.pssh = Pd(u, 0, a)), (this.keyId = Kc(a)));
                  break;
                default:
                  var d = a.subarray(0, 16);
                  if (16 !== d.length) {
                    var h = new Uint8Array(16);
                    (h.set(d, 16 - d.length), (d = h));
                  }
                  this.keyId = d;
              }
            (this.keyId && 16 === this.keyId.byteLength) ||
              ((n = (function (e) {
                var t = null == e ? void 0 : e[Bc];
                if (t) return t.keyId;
                return null;
              })(t)),
              n || (n = qc(t)) || (n = Wc[this.uri]),
              n && ((this.keyId = n), zc.setKeyIdForUri(this.uri, n)));
            return this;
          }
        }
        function qc(e) {
          var t = null == e ? void 0 : e[Uc];
          if (t) {
            var r = _c(t.uri);
            if (r) return Kc(r);
          }
          return null;
        }
        var Xc =
            /#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,
          Yc = /#EXT-X-MEDIA:(.*)/g,
          Qc = /^#EXT(?:INF|-X-TARGETDURATION):/m,
          Jc = new RegExp(
            [
              /#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,
              /(?!#) *(\S[^\r\n]*)/.source,
              /#.*/.source,
            ].join("|"),
            "g",
          ),
          Zc = new RegExp(
            [
              /#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/
                .source,
              /#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,
              /#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,
              /(#)([^:]*):(.*)/.source,
              /(#)(.*)(?:.*)\r?\n?/.source,
            ].join("|"),
          );
        class ef {
          static findGroup(e, t) {
            for (var r = 0; r < e.length; r++) {
              var i = e[r];
              if (i.id === t) return i;
            }
          }
          static resolve(e, t) {
            return ed.buildAbsoluteURL(t, e, { alwaysNormalize: !0 });
          }
          static isMediaPlaylist(e) {
            return Qc.test(e);
          }
          static parseMasterPlaylist(e, t) {
            var r,
              i = {
                contentSteering: null,
                levels: [],
                playlistParsingError: null,
                sessionData: null,
                sessionKeys: null,
                startTimeOffset: null,
                variableList: null,
                hasVariableRefs: gc(e),
              },
              n = [];
            if (((Xc.lastIndex = 0), !e.startsWith("#EXTM3U")))
              return ((i.playlistParsingError = new Error("no EXTM3U delimiter")), i);
            for (; null != (r = Xc.exec(e)); )
              if (r[1]) {
                var a,
                  s = new Sc(r[1], i),
                  o = mc(i, r[2]),
                  l = {
                    attrs: s,
                    bitrate: s.decimalInteger("BANDWIDTH") || s.decimalInteger("AVERAGE-BANDWIDTH"),
                    name: s.NAME,
                    url: ef.resolve(o, t),
                  },
                  u = s.decimalResolution("RESOLUTION");
                (u && ((l.width = u.width), (l.height = u.height)), sf(s.CODECS, l));
                var d = s["SUPPLEMENTAL-CODECS"];
                (d && ((l.supplemental = {}), sf(d, l.supplemental)),
                  (null != (a = l.unknownCodecs) && a.length) || n.push(l),
                  i.levels.push(l));
              } else if (r[3]) {
                var h = r[3],
                  c = r[4];
                switch (h) {
                  case "SESSION-DATA":
                    var f = new Sc(c, i),
                      p = f["DATA-ID"];
                    p && (null === i.sessionData && (i.sessionData = {}), (i.sessionData[p] = f));
                    break;
                  case "SESSION-KEY":
                    var g = nf(c, t, i);
                    g.encrypted && g.isSupported()
                      ? (null === i.sessionKeys && (i.sessionKeys = []), i.sessionKeys.push(g))
                      : Ku.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);
                    break;
                  case "DEFINE":
                    vc(i, new Sc(c, i), t);
                    break;
                  case "CONTENT-STEERING":
                    var m = new Sc(c, i);
                    i.contentSteering = {
                      uri: ef.resolve(m["SERVER-URI"], t),
                      pathwayId: m["PATHWAY-ID"] || ".",
                    };
                    break;
                  case "START":
                    i.startTimeOffset = af(c);
                }
              }
            var v = n.length > 0 && n.length < i.levels.length;
            return (
              (i.levels = v ? n : i.levels),
              0 === i.levels.length && (i.playlistParsingError = new Error("no levels found in manifest")),
              i
            );
          }
          static parseMasterPlaylistMedia(e, t, r) {
            var i,
              n = {},
              a = r.levels,
              s = {
                AUDIO: a.map(e => ({ id: e.attrs.AUDIO, audioCodec: e.audioCodec })),
                SUBTITLES: a.map(e => ({ id: e.attrs.SUBTITLES, textCodec: e.textCodec })),
                "CLOSED-CAPTIONS": [],
              },
              o = 0;
            for (Yc.lastIndex = 0; null !== (i = Yc.exec(e)); ) {
              var l = new Sc(i[1], r),
                u = l.TYPE;
              if (u) {
                var d = s[u],
                  h = n[u] || [];
                n[u] = h;
                var c = l.LANGUAGE,
                  f = l["ASSOC-LANGUAGE"],
                  p = l.CHANNELS,
                  g = l.CHARACTERISTICS,
                  m = l["INSTREAM-ID"],
                  v = {
                    attrs: l,
                    bitrate: 0,
                    id: o++,
                    groupId: l["GROUP-ID"] || "",
                    name: l.NAME || c || "",
                    type: u,
                    default: l.bool("DEFAULT"),
                    autoselect: l.bool("AUTOSELECT"),
                    forced: l.bool("FORCED"),
                    lang: c,
                    url: l.URI ? ef.resolve(l.URI, t) : "",
                  };
                if (
                  (f && (v.assocLang = f),
                  p && (v.channels = p),
                  g && (v.characteristics = g),
                  m && (v.instreamId = m),
                  null != d && d.length)
                ) {
                  var y = ef.findGroup(d, v.groupId) || d[0];
                  (of(v, y, "audioCodec"), of(v, y, "textCodec"));
                }
                h.push(v);
              }
            }
            return n;
          }
          static parseLevelPlaylist(e, t, r, i, n, a) {
            var s,
              o,
              l,
              u,
              d,
              h = { url: t },
              c = new Ac(t),
              f = c.fragments,
              p = [],
              g = null,
              m = 0,
              v = 0,
              y = 0,
              T = 0,
              b = 0,
              S = null,
              E = new od(i, h),
              x = -1,
              w = !1,
              A = null;
            if (
              ((Jc.lastIndex = 0),
              (c.m3u8 = e),
              (c.hasVariableRefs = gc(e)),
              "#EXTM3U" !== (null == (s = Jc.exec(e)) ? void 0 : s[0]))
            )
              return ((c.playlistParsingError = new Error("Missing format identifier #EXTM3U")), c);
            for (; null !== (o = Jc.exec(e)); ) {
              w &&
                ((w = !1),
                ((E = new od(i, h)).playlistOffset = y),
                E.setStart(y),
                (E.sn = m),
                (E.cc = T),
                b && (E.bitrate = b),
                (E.level = r),
                g &&
                  ((E.initSegment = g),
                  g.rawProgramDateTime &&
                    ((E.rawProgramDateTime = g.rawProgramDateTime), (g.rawProgramDateTime = null)),
                  A && (E.setByteRange(A), (A = null))));
              var I = o[1];
              if (I) {
                E.duration = parseFloat(I);
                var k = (" " + o[2]).slice(1);
                ((E.title = k || null), E.tagList.push(k ? ["INF", I, k] : ["INF", I]));
              } else if (o[3]) {
                if (bu(E.duration)) {
                  ((E.playlistOffset = y),
                    E.setStart(y),
                    u && df(E, u, c),
                    (E.sn = m),
                    (E.level = r),
                    (E.cc = T),
                    f.push(E));
                  var R = (" " + o[3]).slice(1);
                  ((E.relurl = mc(c, R)), lf(E, S, p), (S = E), (y += E.duration), m++, (v = 0), (w = !0));
                }
              } else {
                if (!(o = o[0].match(Zc))) {
                  Ku.warn("No matches on slow regex match for level playlist!");
                  continue;
                }
                for (l = 1; l < o.length && void 0 === o[l]; l++);
                var C = (" " + o[l]).slice(1),
                  L = (" " + o[l + 1]).slice(1),
                  M = o[l + 2] ? (" " + o[l + 2]).slice(1) : null;
                switch (C) {
                  case "BYTERANGE":
                    S ? E.setByteRange(L, S) : E.setByteRange(L);
                    break;
                  case "PROGRAM-DATE-TIME":
                    ((E.rawProgramDateTime = L),
                      E.tagList.push(["PROGRAM-DATE-TIME", L]),
                      -1 === x && (x = f.length));
                    break;
                  case "PLAYLIST-TYPE":
                    (c.type && hf(c, C, o), (c.type = L.toUpperCase()));
                    break;
                  case "MEDIA-SEQUENCE":
                    (0 !== c.startSN ? hf(c, C, o) : f.length > 0 && cf(c, C, o),
                      (m = c.startSN = parseInt(L)));
                    break;
                  case "SKIP":
                    c.skippedSegments && hf(c, C, o);
                    var D = new Sc(L, c),
                      _ = D.decimalInteger("SKIPPED-SEGMENTS");
                    if (bu(_)) {
                      c.skippedSegments += _;
                      for (var P = _; P--; ) f.push(null);
                      m += _;
                    }
                    var O = D.enumeratedString("RECENTLY-REMOVED-DATERANGES");
                    O &&
                      (c.recentlyRemovedDateranges = (c.recentlyRemovedDateranges || []).concat(
                        O.split("\t"),
                      ));
                    break;
                  case "TARGETDURATION":
                    (0 !== c.targetduration && hf(c, C, o), (c.targetduration = Math.max(parseInt(L), 1)));
                    break;
                  case "VERSION":
                    (null !== c.version && hf(c, C, o), (c.version = parseInt(L)));
                    break;
                  case "INDEPENDENT-SEGMENTS":
                    break;
                  case "ENDLIST":
                    (c.live || hf(c, C, o), (c.live = !1));
                    break;
                  case "#":
                    (L || M) && E.tagList.push(M ? [L, M] : [L]);
                    break;
                  case "DISCONTINUITY":
                    (T++, E.tagList.push(["DIS"]));
                    break;
                  case "GAP":
                    ((E.gap = !0), E.tagList.push([C]));
                    break;
                  case "BITRATE":
                    (E.tagList.push([C, L]), (b = 1e3 * parseInt(L)), bu(b) ? (E.bitrate = b) : (b = 0));
                    break;
                  case "DATERANGE":
                    var N = new Sc(L, c),
                      F = new wc(N, c.dateRanges[N.ID], c.dateRangeTagCount);
                    (c.dateRangeTagCount++,
                      F.isValid || c.skippedSegments
                        ? (c.dateRanges[F.id] = F)
                        : Ku.warn(`Ignoring invalid DATERANGE tag: "${L}"`),
                      E.tagList.push(["EXT-X-DATERANGE", L]));
                    break;
                  case "DEFINE":
                    var U = new Sc(L, c);
                    "IMPORT" in U ? yc(c, U, a) : vc(c, U, t);
                    break;
                  case "DISCONTINUITY-SEQUENCE":
                    (0 !== c.startCC ? hf(c, C, o) : f.length > 0 && cf(c, C, o),
                      (c.startCC = T = parseInt(L)));
                    break;
                  case "KEY":
                    var B = nf(L, t, c);
                    if (B.isSupported()) {
                      if ("NONE" === B.method) {
                        u = void 0;
                        break;
                      }
                      u || (u = {});
                      var $ = u[B.keyFormat];
                      (null != $ && $.matches(B)) || ($ && (u = Nu({}, u)), (u[B.keyFormat] = B));
                    } else Ku.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${L}"`);
                    break;
                  case "START":
                    c.startTimeOffset = af(L);
                    break;
                  case "MAP":
                    var j = new Sc(L, c);
                    if (E.duration) {
                      var G = new od(i, h);
                      (uf(G, j, r, u),
                        (g = G),
                        (E.initSegment = g),
                        g.rawProgramDateTime &&
                          !E.rawProgramDateTime &&
                          (E.rawProgramDateTime = g.rawProgramDateTime));
                    } else {
                      var V = E.byteRangeEndOffset;
                      if (V) {
                        var H = E.byteRangeStartOffset;
                        A = `${V - H}@${H}`;
                      } else A = null;
                      (uf(E, j, r, u), (g = E), (w = !0));
                    }
                    g.cc = T;
                    break;
                  case "SERVER-CONTROL":
                    (d && hf(c, C, o),
                      (d = new Sc(L)),
                      (c.canBlockReload = d.bool("CAN-BLOCK-RELOAD")),
                      (c.canSkipUntil = d.optionalFloat("CAN-SKIP-UNTIL", 0)),
                      (c.canSkipDateRanges = c.canSkipUntil > 0 && d.bool("CAN-SKIP-DATERANGES")),
                      (c.partHoldBack = d.optionalFloat("PART-HOLD-BACK", 0)),
                      (c.holdBack = d.optionalFloat("HOLD-BACK", 0)));
                    break;
                  case "PART-INF":
                    c.partTarget && hf(c, C, o);
                    var K = new Sc(L);
                    c.partTarget = K.decimalFloatingPoint("PART-TARGET");
                    break;
                  case "PART":
                    var W = c.partList;
                    W || (W = c.partList = []);
                    var z = v > 0 ? W[W.length - 1] : void 0,
                      q = v++,
                      X = new Sc(L, c),
                      Y = new ld(X, E, h, q, z);
                    (W.push(Y), (E.duration += Y.duration));
                    break;
                  case "PRELOAD-HINT":
                    var Q = new Sc(L, c);
                    c.preloadHint = Q;
                    break;
                  case "RENDITION-REPORT":
                    var J = new Sc(L, c);
                    ((c.renditionReports = c.renditionReports || []), c.renditionReports.push(J));
                    break;
                  default:
                    Ku.warn(`line parsed but not handled: ${o}`);
                }
              }
            }
            (S && !S.relurl
              ? (f.pop(), (y -= S.duration), c.partList && (c.fragmentHint = S))
              : c.partList && (lf(E, S, p), (E.cc = T), (c.fragmentHint = E), u && df(E, u, c)),
              c.targetduration || (c.playlistParsingError = new Error("Missing Target Duration")));
            var Z = f.length,
              ee = f[0],
              te = f[Z - 1];
            if ((y += c.skippedSegments * c.targetduration) > 0 && Z && te) {
              c.averagetargetduration = y / Z;
              var re = te.sn;
              ((c.endSN = "initSegment" !== re ? re : 0),
                c.live || (te.endList = !0),
                x > 0 &&
                  (!(function (e, t) {
                    for (var r = e[t], i = t; i--; ) {
                      var n = e[i];
                      if (!n) return;
                      ((n.programDateTime = r.programDateTime - 1e3 * n.duration), (r = n));
                    }
                  })(f, x),
                  ee && p.unshift(ee)));
            }
            return (
              c.fragmentHint && (y += c.fragmentHint.duration),
              (c.totalduration = y),
              p.length && c.dateRangeTagCount && ee && tf(p, c),
              (c.endCC = T),
              c
            );
          }
        }
        function tf(e, t) {
          var r = e.length;
          if (!r) {
            if (!t.hasProgramDateTime) return;
            var i = t.fragments[t.fragments.length - 1];
            (e.push(i), r++);
          }
          for (
            var n = e[r - 1],
              a = t.live ? 1 / 0 : t.totalduration,
              s = Object.keys(t.dateRanges),
              o = s.length;
            o--;
          ) {
            var l = t.dateRanges[s[o]],
              u = l.startDate.getTime();
            l.tagAnchor = n.ref;
            for (var d = r; d--; ) {
              var h;
              if ((null == (h = e[d]) ? void 0 : h.sn) < t.startSN) break;
              var c = rf(t, u, e, d, a);
              if (-1 !== c) {
                l.tagAnchor = t.fragments[c].ref;
                break;
              }
            }
          }
        }
        function rf(e, t, r, i, n) {
          var a = r[i];
          if (a) {
            var s,
              o = a.programDateTime;
            if (t >= o || 0 === i)
              if (t <= o + 1e3 * (((null == (s = r[i + 1]) ? void 0 : s.start) || n) - a.start)) {
                var l = r[i].sn - e.startSN;
                if (l < 0) return -1;
                var u = e.fragments;
                if (u.length > r.length)
                  for (var d = (r[i + 1] || u[u.length - 1]).sn - e.startSN; d > l; d--) {
                    var h = u[d].programDateTime;
                    if (t >= h && t < h + 1e3 * u[d].duration) return d;
                  }
                return l;
              }
          }
          return -1;
        }
        function nf(e, t, r) {
          var i,
            n,
            a = new Sc(e, r),
            s = null != (i = a.METHOD) ? i : "",
            o = a.URI,
            l = a.hexadecimalInteger("IV"),
            u = a.KEYFORMATVERSIONS,
            d = null != (n = a.KEYFORMAT) ? n : "identity";
          o && a.IV && !l && Ku.error(`Invalid IV: ${a.IV}`);
          var h = o ? ef.resolve(o, t) : "",
            c = (u || "1").split("/").map(Number).filter(Number.isFinite);
          return new zc(s, h, d, c, l, a.KEYID);
        }
        function af(e) {
          var t = new Sc(e).decimalFloatingPoint("TIME-OFFSET");
          return bu(t) ? t : null;
        }
        function sf(e, t) {
          var r = (e || "").split(/[ ,]+/).filter(e => e);
          (["video", "audio", "text"].forEach(e => {
            var i = r.filter(t => Ud(t, e));
            i.length &&
              ((t[`${e}Codec`] = i.map(e => e.split("/")[0]).join(",")),
              (r = r.filter(e => -1 === i.indexOf(e))));
          }),
            (t.unknownCodecs = r));
        }
        function of(e, t, r) {
          var i = t[r];
          i && (e[r] = i);
        }
        function lf(e, t, r) {
          e.rawProgramDateTime
            ? r.push(e)
            : null != t && t.programDateTime && (e.programDateTime = t.endProgramDateTime);
        }
        function uf(e, t, r, i) {
          ((e.relurl = t.URI),
            t.BYTERANGE && e.setByteRange(t.BYTERANGE),
            (e.level = r),
            (e.sn = "initSegment"),
            i && (e.levelkeys = i),
            (e.initSegment = null));
        }
        function df(e, t, r) {
          e.levelkeys = t;
          var i = r.encryptedFragments;
          (i.length && i[i.length - 1].levelkeys === t) ||
            !Object.keys(t).some(e => t[e].isCommonEncryption) ||
            i.push(e);
        }
        function hf(e, t, r) {
          e.playlistParsingError = new Error(`#EXT-X-${t} must not appear more than once (${r[0]})`);
        }
        function cf(e, t, r) {
          e.playlistParsingError = new Error(
            `#EXT-X-${t} must appear before the first Media Segment (${r[0]})`,
          );
        }
        function ff(e, t) {
          var r = t.startPTS;
          if (bu(r)) {
            var i,
              n = 0;
            (t.sn > e.sn ? ((n = r - e.start), (i = e)) : ((n = e.start - r), (i = t)),
              i.duration !== n && i.setDuration(n));
          } else if (t.sn > e.sn) {
            e.cc === t.cc && e.minEndPTS
              ? t.setStart(e.start + (e.minEndPTS - e.start))
              : t.setStart(e.start + e.duration);
          } else t.setStart(Math.max(e.start - t.duration, 0));
        }
        function pf(e, t, r, i, n, a, s) {
          i - r <= 0 &&
            (s.warn("Fragment should have a positive duration", t),
            (i = r + t.duration),
            (a = n + t.duration));
          var o = r,
            l = i,
            u = t.startPTS,
            d = t.endPTS;
          if (bu(u)) {
            var h = Math.abs(u - r);
            (e && h > e.totalduration
              ? s.warn(`media timestamps and playlist times differ by ${h}s for level ${t.level} ${e.url}`)
              : bu(t.deltaPTS)
                ? (t.deltaPTS = Math.max(h, t.deltaPTS))
                : (t.deltaPTS = h),
              (o = Math.max(r, u)),
              (r = Math.min(r, u)),
              (n = void 0 !== t.startDTS ? Math.min(n, t.startDTS) : n),
              (l = Math.min(i, d)),
              (i = Math.max(i, d)),
              (a = void 0 !== t.endDTS ? Math.max(a, t.endDTS) : a));
          }
          var c = r - t.start;
          (0 !== t.start && t.setStart(r),
            t.setDuration(i - t.start),
            (t.startPTS = r),
            (t.maxStartPTS = o),
            (t.startDTS = n),
            (t.endPTS = i),
            (t.minEndPTS = l),
            (t.endDTS = a));
          var f,
            p = t.sn;
          if (!e || p < e.startSN || p > e.endSN) return 0;
          var g = p - e.startSN,
            m = e.fragments;
          for (m[g] = t, f = g; f > 0; f--) ff(m[f], m[f - 1]);
          for (f = g; f < m.length - 1; f++) ff(m[f], m[f + 1]);
          return (
            e.fragmentHint && ff(m[m.length - 1], e.fragmentHint),
            (e.PTSKnown = e.alignedSliding = !0),
            c
          );
        }
        function gf(e, t, r) {
          if (e !== t) {
            for (var i, n = null, a = e.fragments, s = a.length - 1; s >= 0; s--) {
              var o = a[s].initSegment;
              if (o) {
                n = o;
                break;
              }
            }
            (e.fragmentHint && delete e.fragmentHint.endPTS,
              (function (e, t, r) {
                for (
                  var i = t.skippedSegments,
                    n = Math.max(e.startSN, t.startSN) - t.startSN,
                    a = (e.fragmentHint ? 1 : 0) + (i ? t.endSN : Math.min(e.endSN, t.endSN)) - t.startSN,
                    s = t.startSN - e.startSN,
                    o = t.fragmentHint ? t.fragments.concat(t.fragmentHint) : t.fragments,
                    l = e.fragmentHint ? e.fragments.concat(e.fragmentHint) : e.fragments,
                    u = n;
                  u <= a;
                  u++
                ) {
                  var d = l[s + u],
                    h = o[u];
                  if ((i && !h && d && (h = t.fragments[u] = d), d && h)) {
                    r(d, h, u, o);
                    var c = d.relurl,
                      f = h.relurl;
                    if (c && wf(c, f))
                      return void (t.playlistParsingError = mf(
                        `media sequence mismatch ${h.sn}:`,
                        e,
                        t,
                        d,
                        h,
                      ));
                    if (d.cc !== h.cc)
                      return void (t.playlistParsingError = mf(
                        `discontinuity sequence mismatch (${d.cc}!=${h.cc})`,
                        e,
                        t,
                        d,
                        h,
                      ));
                  }
                }
              })(e, t, (e, r, a, s) => {
                if ((!t.startCC || t.skippedSegments) && r.cc !== e.cc) {
                  for (var o = e.cc - r.cc, l = a; l < s.length; l++) s[l].cc += o;
                  t.endCC = s[s.length - 1].cc;
                }
                (bu(e.startPTS) &&
                  bu(e.endPTS) &&
                  (r.setStart((r.startPTS = e.startPTS)),
                  (r.startDTS = e.startDTS),
                  (r.maxStartPTS = e.maxStartPTS),
                  (r.endPTS = e.endPTS),
                  (r.endDTS = e.endDTS),
                  (r.minEndPTS = e.minEndPTS),
                  r.setDuration(e.endPTS - e.startPTS),
                  r.duration && (i = r),
                  (t.PTSKnown = t.alignedSliding = !0)),
                  e.hasStreams && (r.elementaryStreams = e.elementaryStreams),
                  (r.loader = e.loader),
                  e.hasStats && (r.stats = e.stats),
                  e.initSegment && ((r.initSegment = e.initSegment), (n = e.initSegment)));
              }));
            var l = t.fragments,
              u = t.fragmentHint ? l.concat(t.fragmentHint) : l;
            if (
              (n &&
                u.forEach(e => {
                  var t;
                  !e ||
                    (e.initSegment && e.initSegment.relurl !== (null == (t = n) ? void 0 : t.relurl)) ||
                    (e.initSegment = n);
                }),
              t.skippedSegments)
            ) {
              if (((t.deltaUpdateFailed = l.some(e => !e)), t.deltaUpdateFailed)) {
                r.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");
                for (var d = t.skippedSegments; d--; ) l.shift();
                t.startSN = l[0].sn;
              } else {
                t.canSkipDateRanges &&
                  (t.dateRanges = (function (e, t, r) {
                    var i = t.dateRanges,
                      n = t.recentlyRemovedDateranges,
                      a = Nu({}, e);
                    n &&
                      n.forEach(e => {
                        delete a[e];
                      });
                    var s = Object.keys(a).length;
                    if (!s) return i;
                    return (
                      Object.keys(i).forEach(e => {
                        var t = a[e],
                          n = new wc(i[e].attr, t);
                        n.isValid
                          ? ((a[e] = n), t || (n.tagOrder += s))
                          : r.warn(
                              `Ignoring invalid Playlist Delta Update DATERANGE tag: "${ph(i[e].attr)}"`,
                            );
                      }),
                      a
                    );
                  })(e.dateRanges, t, r));
                var h = e.fragments.filter(e => e.rawProgramDateTime);
                if (e.hasProgramDateTime && !t.hasProgramDateTime)
                  for (var c = 1; c < u.length; c++) null === u[c].programDateTime && lf(u[c], u[c - 1], h);
                tf(h, t);
              }
              t.endCC = l[l.length - 1].cc;
            }
            if (!t.startCC) {
              var f,
                p = bf(e, t.startSN - 1);
              t.startCC = null != (f = null == p ? void 0 : p.cc) ? f : l[0].cc;
            }
            (!(function (e, t, r) {
              if (e && t)
                for (var i = 0, n = 0, a = e.length; n <= a; n++) {
                  var s = e[n],
                    o = t[n + i];
                  s && o && s.index === o.index && s.fragment.sn === o.fragment.sn ? r(s, o) : i--;
                }
            })(e.partList, t.partList, (e, t) => {
              ((t.elementaryStreams = e.elementaryStreams), (t.stats = e.stats));
            }),
              i ? pf(t, i, i.startPTS, i.endPTS, i.startDTS, i.endDTS, r) : vf(e, t),
              l.length && (t.totalduration = t.edge - l[0].start),
              (t.driftStartTime = e.driftStartTime),
              (t.driftStart = e.driftStart));
            var g = t.advancedDateTime;
            if (t.advanced && g) {
              var m = t.edge;
              (t.driftStart || ((t.driftStartTime = g), (t.driftStart = m)),
                (t.driftEndTime = g),
                (t.driftEnd = m));
            } else
              ((t.driftEndTime = e.driftEndTime),
                (t.driftEnd = e.driftEnd),
                (t.advancedDateTime = e.advancedDateTime));
            -1 === t.requestScheduled && (t.requestScheduled = e.requestScheduled);
          }
        }
        function mf(e, t, r, i, n) {
          return new Error(
            `${e} ${n.url}\nPlaylist starting @${t.startSN}\n${t.m3u8}\n\nPlaylist starting @${r.startSN}\n${r.m3u8}`,
          );
        }
        function vf(e, t, r = !0) {
          var i = t.startSN + t.skippedSegments - e.startSN,
            n = e.fragments,
            a = i >= 0,
            s = 0;
          if (a && i < n.length) s = n[i].start;
          else if (a && t.startSN === e.endSN + 1) s = e.fragmentEnd;
          else if (a && r) s = e.fragmentStart + i * t.levelTargetDuration;
          else {
            if (t.skippedSegments || 0 !== t.fragmentStart) return;
            s = e.fragmentStart;
          }
          yf(t, s);
        }
        function yf(e, t) {
          if (t) {
            for (var r = e.fragments, i = e.skippedSegments; i < r.length; i++) r[i].addStart(t);
            e.fragmentHint && e.fragmentHint.addStart(t);
          }
        }
        function Tf(e, t = 1 / 0) {
          var r = 1e3 * e.targetduration;
          if (e.updated) {
            var i = e.fragments;
            if (i.length && 4 * r > t) {
              var n = 1e3 * i[i.length - 1].duration;
              n < r && (r = n);
            }
          } else r /= 2;
          return Math.round(r);
        }
        function bf(e, t, r) {
          if (!e) return null;
          var i = e.fragments[t - e.startSN];
          return i || ((i = e.fragmentHint) && i.sn === t ? i : t < e.startSN && r && r.sn === t ? r : null);
        }
        function Sf(e, t, r) {
          return e ? Ef(e.partList, t, r) : null;
        }
        function Ef(e, t, r) {
          if (e)
            for (var i = e.length; i--; ) {
              var n = e[i];
              if (n.index === r && n.fragment.sn === t) return n;
            }
          return null;
        }
        function xf(e) {
          e.forEach((e, t) => {
            var r;
            null == (r = e.details) ||
              r.fragments.forEach(e => {
                ((e.level = t), e.initSegment && (e.initSegment.level = t));
              });
          });
        }
        function wf(e, t) {
          return !(e === t || !t) && Af(e) !== Af(t);
        }
        function Af(e) {
          return e.replace(/\?[^?]*$/, "");
        }
        function If(e, t) {
          for (var r = 0, i = e.length; r < i; r++) {
            var n;
            if ((null == (n = e[r]) ? void 0 : n.cc) === t) return e[r];
          }
          return null;
        }
        function kf(e, t) {
          var r = e.start + t;
          ((e.startPTS = r), e.setStart(r), (e.endPTS = r + e.duration));
        }
        function Rf(e, t) {
          for (var r = t.fragments, i = 0, n = r.length; i < n; i++) kf(r[i], e);
          (t.fragmentHint && kf(t.fragmentHint, e), (t.alignedSliding = !0));
        }
        function Cf(e, t) {
          if (
            (function (e, t) {
              return !!(e && t.startCC < e.endCC && t.endCC > e.startCC);
            })(t, e)
          ) {
            var r = Math.min(t.endCC, e.endCC),
              i = If(t.fragments, r),
              n = If(e.fragments, r);
            if (i && n)
              (Ku.log(`Aligning playlist at start of dicontinuity sequence ${r}`), Rf(i.start - n.start, e));
          }
        }
        function Lf(e, t) {
          if (e.hasProgramDateTime && t.hasProgramDateTime) {
            var r = e.fragments,
              i = t.fragments;
            if (r.length && i.length) {
              var n,
                a,
                s = Math.min(t.endCC, e.endCC);
              (t.startCC < s && e.startCC < s && ((n = If(i, s)), (a = If(r, s))),
                (n && a) || (a = If(r, (n = i[Math.floor(i.length / 2)]).cc) || r[Math.floor(r.length / 2)]));
              var o = n.programDateTime,
                l = a.programDateTime;
              if (o && l) Rf((l - o) / 1e3 - (a.start - n.start), e);
            }
          }
        }
        function Mf(e, t, r) {
          (Df(e, t, r), e.addEventListener(t, r));
        }
        function Df(e, t, r) {
          e.removeEventListener(t, r);
        }
        var _f = function (e) {
            for (var t = "", r = e.length, i = 0; i < r; i++)
              t += `[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;
            return t;
          },
          Pf = "STOPPED",
          Of = "IDLE",
          Nf = "KEY_LOADING",
          Ff = "FRAG_LOADING",
          Uf = "FRAG_LOADING_WAITING_RETRY",
          Bf = "WAITING_TRACK",
          $f = "PARSING",
          jf = "PARSED",
          Gf = "ENDED",
          Vf = "ERROR",
          Hf = "WAITING_INIT_PTS",
          Kf = "WAITING_LEVEL";
        class Wf extends dc {
          constructor(e, t, r, i, n) {
            (super(i, e.logger),
              (this.hls = void 0),
              (this.fragPrevious = null),
              (this.fragCurrent = null),
              (this.fragmentTracker = void 0),
              (this.transmuxer = null),
              (this._state = Pf),
              (this.playlistType = void 0),
              (this.media = null),
              (this.mediaBuffer = null),
              (this.config = void 0),
              (this.bitrateTest = !1),
              (this.lastCurrentTime = 0),
              (this.nextLoadPosition = 0),
              (this.startPosition = 0),
              (this.startTimeOffset = null),
              (this.retryDate = 0),
              (this.levels = null),
              (this.fragmentLoader = void 0),
              (this.keyLoader = void 0),
              (this.levelLastLoaded = null),
              (this.startFragRequested = !1),
              (this.decrypter = void 0),
              (this.initPTS = []),
              (this.buffering = !0),
              (this.loadingParts = !1),
              (this.loopSn = void 0),
              (this.onMediaSeeking = () => {
                var e = this.config,
                  t = this.fragCurrent,
                  r = this.media,
                  i = this.mediaBuffer,
                  n = this.state,
                  a = r ? r.currentTime : 0,
                  s = fc.bufferInfo(i || r, a, e.maxBufferHole),
                  o = !s.len;
                if (
                  (this.log(
                    `Media seeking to ${bu(a) ? a.toFixed(3) : a}, state: ${n}, ${o ? "out of" : "in"} buffer`,
                  ),
                  this.state === Gf)
                )
                  this.resetLoadingState();
                else if (t) {
                  var l = e.maxFragLookUpTolerance,
                    u = t.start - l,
                    d = t.start + t.duration + l;
                  if (o || d < s.start || u > s.end) {
                    var h = a > d;
                    (a < u || h) &&
                      (h &&
                        t.loader &&
                        (this.log(`Cancelling fragment load for seek (sn: ${t.sn})`),
                        t.abortRequests(),
                        this.resetLoadingState()),
                      (this.fragPrevious = null));
                  }
                }
                if (
                  r &&
                  (this.fragmentTracker.removeFragmentsInRange(a, 1 / 0, this.playlistType, !0),
                  a > this.lastCurrentTime && (this.lastCurrentTime = a),
                  !this.loadingParts)
                ) {
                  var c = Math.max(s.end, a),
                    f = this.shouldLoadParts(this.getLevelDetails(), c);
                  f &&
                    (this.log(
                      `LL-Part loading ON after seeking to ${a.toFixed(2)} with buffer @${c.toFixed(2)}`,
                    ),
                    (this.loadingParts = f));
                }
                (this.hls.hasEnoughToStart ||
                  (this.log(
                    `Setting ${o ? "startPosition" : "nextLoadPosition"} to ${a} for seek without enough to start`,
                  ),
                  (this.nextLoadPosition = a),
                  o && (this.startPosition = a)),
                  o && this.state === Of && this.tickImmediate());
              }),
              (this.onMediaEnded = () => {
                (this.log("setting startPosition to 0 because media ended"),
                  (this.startPosition = this.lastCurrentTime = 0));
              }),
              (this.playlistType = n),
              (this.hls = e),
              (this.fragmentLoader = new sc(e.config)),
              (this.keyLoader = r),
              (this.fragmentTracker = t),
              (this.config = e.config),
              (this.decrypter = new nc(e.config)));
          }
          registerListeners() {
            var e = this.hls;
            (e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.on(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
              e.on(Au.ERROR, this.onError, this));
          }
          unregisterListeners() {
            var e = this.hls;
            (e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.off(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
              e.off(Au.ERROR, this.onError, this));
          }
          doTick() {
            this.onTickEnd();
          }
          onTickEnd() {}
          startLoad(e) {}
          stopLoad() {
            if (this.state !== Pf) {
              (this.fragmentLoader.abort(), this.keyLoader.abort(this.playlistType));
              var e = this.fragCurrent;
              (null != e && e.loader && (e.abortRequests(), this.fragmentTracker.removeFragment(e)),
                this.resetTransmuxer(),
                (this.fragCurrent = null),
                (this.fragPrevious = null),
                this.clearInterval(),
                this.clearNextTick(),
                (this.state = Pf));
            }
          }
          get startPositionValue() {
            var e = this.nextLoadPosition,
              t = this.startPosition;
            return -1 === t && e ? e : t;
          }
          get bufferingEnabled() {
            return this.buffering;
          }
          pauseBuffering() {
            this.buffering = !1;
          }
          resumeBuffering() {
            this.buffering = !0;
          }
          get inFlightFrag() {
            return { frag: this.fragCurrent, state: this.state };
          }
          _streamEnded(e, t) {
            if (t.live || !this.media) return !1;
            var r = e.end || 0,
              i = this.config.timelineOffset || 0;
            if (r <= i) return !1;
            var n = e.buffered;
            this.config.maxBufferHole && n && n.length > 1 && (e = fc.bufferedInfo(n, e.start, 0));
            var a = e.nextStart;
            if (a && a > i && a < t.edge) return !1;
            if (this.media.currentTime < e.start) return !1;
            var s = t.partList;
            if (null != s && s.length) {
              var o = s[s.length - 1];
              return fc.isBuffered(this.media, o.start + o.duration / 2);
            }
            var l = t.fragments[t.fragments.length - 1].type;
            return this.fragmentTracker.isEndListAppended(l);
          }
          getLevelDetails() {
            if (this.levels && null !== this.levelLastLoaded) return this.levelLastLoaded.details;
          }
          get timelineOffset() {
            var e,
              t = this.config.timelineOffset;
            return t ? (null == (e = this.getLevelDetails()) ? void 0 : e.appliedTimelineOffset) || t : 0;
          }
          onMediaAttached(e, t) {
            var r = (this.media = this.mediaBuffer = t.media);
            (Mf(r, "seeking", this.onMediaSeeking), Mf(r, "ended", this.onMediaEnded));
            var i = this.config;
            this.levels && i.autoStartLoad && this.state === Pf && this.startLoad(i.startPosition);
          }
          onMediaDetaching(e, t) {
            var r = !!t.transferMedia,
              i = this.media;
            if (null !== i) {
              if (
                (i.ended &&
                  (this.log("MSE detaching and video ended, reset startPosition"),
                  (this.startPosition = this.lastCurrentTime = 0)),
                Df(i, "seeking", this.onMediaSeeking),
                Df(i, "ended", this.onMediaEnded),
                this.keyLoader && !r && this.keyLoader.detach(),
                (this.media = this.mediaBuffer = null),
                (this.loopSn = void 0),
                r)
              )
                return (this.resetLoadingState(), void this.resetTransmuxer());
              ((this.loadingParts = !1), this.fragmentTracker.removeAllFragments(), this.stopLoad());
            }
          }
          onManifestLoading() {
            ((this.initPTS = []),
              (this.levels = this.levelLastLoaded = this.fragCurrent = null),
              (this.lastCurrentTime = this.startPosition = 0),
              (this.startFragRequested = !1));
          }
          onError(e, t) {}
          onManifestLoaded(e, t) {
            this.startTimeOffset = t.startTimeOffset;
          }
          onHandlerDestroying() {
            (this.stopLoad(),
              this.transmuxer && (this.transmuxer.destroy(), (this.transmuxer = null)),
              super.onHandlerDestroying(),
              (this.hls = this.onMediaSeeking = this.onMediaEnded = null));
          }
          onHandlerDestroyed() {
            ((this.state = Pf),
              this.fragmentLoader && this.fragmentLoader.destroy(),
              this.keyLoader && this.keyLoader.destroy(),
              this.decrypter && this.decrypter.destroy(),
              (this.hls =
                this.log =
                this.warn =
                this.decrypter =
                this.keyLoader =
                this.fragmentLoader =
                this.fragmentTracker =
                  null),
              super.onHandlerDestroyed());
          }
          loadFragment(e, t, r) {
            ((this.startFragRequested = !0), this._loadFragForPlayback(e, t, r));
          }
          _loadFragForPlayback(e, t, r) {
            this._doFragLoad(e, t, r, e => {
              var t = e.frag;
              if (this.fragContextChanged(t))
                return (
                  this.warn(
                    `${t.type} sn: ${t.sn}${e.part ? " part: " + e.part.index : ""} of ${this.fragInfo(t, !1, e.part)}) was dropped during download.`,
                  ),
                  void this.fragmentTracker.removeFragment(t)
                );
              (t.stats.chunkCount++, this._handleFragmentLoadProgress(e));
            })
              .then(e => {
                if (e) {
                  var t = this.state,
                    r = e.frag;
                  this.fragContextChanged(r)
                    ? (t === Ff || (!this.fragCurrent && t === $f)) &&
                      (this.fragmentTracker.removeFragment(r), (this.state = Of))
                    : ("payload" in e &&
                        (this.log(`Loaded ${r.type} sn: ${r.sn} of ${this.playlistLabel()} ${r.level}`),
                        this.hls.trigger(Au.FRAG_LOADED, e)),
                      this._handleFragmentLoadComplete(e));
                }
              })
              .catch(t => {
                this.state !== Pf &&
                  this.state !== Vf &&
                  (this.warn(`Frag error: ${(null == t ? void 0 : t.message) || t}`),
                  this.resetFragmentLoading(e));
              });
          }
          clearTrackerIfNeeded(e) {
            var t,
              r = this.fragmentTracker;
            if (r.getState(e) === Wh) {
              var i = e.type,
                n = this.getFwdBufferInfo(this.mediaBuffer, i),
                a = Math.max(e.duration, n ? n.len : this.config.maxBufferLength),
                s = this.backtrackFragment;
              (1 === (s ? e.sn - s.sn : 0) || this.reduceMaxBufferLength(a, e.duration)) &&
                r.removeFragment(e);
            } else
              0 === (null == (t = this.mediaBuffer) ? void 0 : t.buffered.length)
                ? r.removeAllFragments()
                : r.hasParts(e.type) &&
                  (r.detectPartialFragments({ frag: e, part: null, stats: e.stats, id: e.type }),
                  r.getState(e) === zh && r.removeFragment(e));
          }
          checkLiveUpdate(e) {
            if (e.updated && !e.live) {
              var t = e.fragments[e.fragments.length - 1];
              this.fragmentTracker.detectPartialFragments({
                frag: t,
                part: null,
                stats: t.stats,
                id: t.type,
              });
            }
            e.fragments[0] || (e.deltaUpdateFailed = !0);
          }
          waitForLive(e) {
            var t = e.details;
            return (
              (null == t ? void 0 : t.live) && "EVENT" !== t.type && (this.levelLastLoaded !== e || t.expired)
            );
          }
          flushMainBuffer(e, t, r = null) {
            if (e - t) {
              var i = { startOffset: e, endOffset: t, type: r };
              this.hls.trigger(Au.BUFFER_FLUSHING, i);
            }
          }
          _loadInitSegment(e, t) {
            this._doFragLoad(e, t)
              .then(e => {
                var t = null == e ? void 0 : e.frag;
                if (!t || this.fragContextChanged(t) || !this.levels) throw new Error("init load aborted");
                return e;
              })
              .then(e => {
                var t = this.hls,
                  r = e.frag,
                  i = e.payload,
                  n = r.decryptdata;
                if (i && i.byteLength > 0 && null != n && n.key && n.iv && Rc(n.method)) {
                  var a = self.performance.now();
                  return this.decrypter
                    .decrypt(new Uint8Array(i), n.key.buffer, n.iv.buffer, Cc(n.method))
                    .catch(e => {
                      throw (
                        t.trigger(Au.ERROR, {
                          type: xu.MEDIA_ERROR,
                          details: wu.FRAG_DECRYPT_ERROR,
                          fatal: !1,
                          error: e,
                          reason: e.message,
                          frag: r,
                        }),
                        e
                      );
                    })
                    .then(i => {
                      var n = self.performance.now();
                      return (
                        t.trigger(Au.FRAG_DECRYPTED, {
                          frag: r,
                          payload: i,
                          stats: { tstart: a, tdecrypt: n },
                        }),
                        (e.payload = i),
                        this.completeInitSegmentLoad(e)
                      );
                    });
                }
                return this.completeInitSegmentLoad(e);
              })
              .catch(t => {
                this.state !== Pf && this.state !== Vf && (this.warn(t), this.resetFragmentLoading(e));
              });
          }
          completeInitSegmentLoad(e) {
            if (!this.levels) throw new Error("init load aborted, missing levels");
            var t = e.frag.stats;
            (this.state !== Pf && (this.state = Of),
              (e.frag.data = new Uint8Array(e.payload)),
              (t.parsing.start = t.buffering.start = self.performance.now()),
              (t.parsing.end = t.buffering.end = self.performance.now()),
              this.tick());
          }
          unhandledEncryptionError(e, t) {
            var r,
              i,
              n = e.tracks;
            if (
              n &&
              !t.encrypted &&
              ((null != (r = n.audio) && r.encrypted) || (null != (i = n.video) && i.encrypted)) &&
              (!this.config.emeEnabled || !this.keyLoader.emeController)
            ) {
              var a = this.media,
                s = new Error(
                  `Encrypted track with no key in ${this.fragInfo(t)} (media ${a ? "attached mediaKeys: " + a.mediaKeys : "detached"})`,
                );
              return (
                this.warn(s.message),
                !a || a.mediaKeys
                  ? !1
                  : (this.hls.trigger(Au.ERROR, {
                      type: xu.KEY_SYSTEM_ERROR,
                      details: wu.KEY_SYSTEM_NO_KEYS,
                      fatal: !1,
                      error: s,
                      frag: t,
                    }),
                    this.resetTransmuxer(),
                    !0)
              );
            }
            return !1;
          }
          fragContextChanged(e) {
            var t = this.fragCurrent;
            return !e || !t || e.sn !== t.sn || e.level !== t.level;
          }
          fragBufferedComplete(e, t) {
            var r = this.mediaBuffer ? this.mediaBuffer : this.media;
            if (
              (this.log(
                `Buffered ${e.type} sn: ${e.sn}${t ? " part: " + t.index : ""} of ${this.fragInfo(e, !1, t)} > buffer:${r ? _f(fc.getBuffered(r)) : "(detached)"})`,
              ),
              sd(e))
            ) {
              var i;
              if (e.type !== Du) {
                var n = e.elementaryStreams;
                if (!Object.keys(n).some(e => !!n[e])) return void (this.state = Of);
              }
              var a = null == (i = this.levels) ? void 0 : i[e.level];
              null != a &&
                a.fragmentError &&
                (this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),
                (a.fragmentError = 0));
            }
            this.state = Of;
          }
          _handleFragmentLoadComplete(e) {
            var t = this.transmuxer;
            if (t) {
              var r = e.frag,
                i = e.part,
                n = e.partsLoaded,
                a = !n || 0 === n.length || n.some(e => !e),
                s = new hc(r.level, r.sn, r.stats.chunkCount + 1, 0, i ? i.index : -1, !a);
              t.flush(s);
            }
          }
          _handleFragmentLoadProgress(e) {}
          _doFragLoad(e, t, r = null, i) {
            var n;
            this.fragCurrent = e;
            var a = t.details;
            if (!this.levels || !a) throw new Error(`frag load aborted, missing level${a ? "" : " detail"}s`);
            var s = null;
            if (!e.encrypted || (null != (n = e.decryptdata) && n.key))
              e.encrypted ||
                ((s = this.keyLoader.loadClear(e, a.encryptedFragments, this.startFragRequested)) &&
                  this.log("[eme] blocking frag load until media-keys acquired"));
            else if (
              (this.log(
                `Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`,
              ),
              (this.state = Nf),
              (this.fragCurrent = e),
              (s = this.keyLoader.load(e).then(e => {
                if (!this.fragContextChanged(e.frag))
                  return (this.hls.trigger(Au.KEY_LOADED, e), this.state === Nf && (this.state = Of), e);
              })),
              this.hls.trigger(Au.KEY_LOADING, { frag: e }),
              null === this.fragCurrent)
            )
              return (this.log("context changed in KEY_LOADING"), Promise.resolve(null));
            var o,
              l = this.fragPrevious;
            if (sd(e) && (!l || e.sn !== l.sn)) {
              var u = this.shouldLoadParts(t.details, e.end);
              u !== this.loadingParts &&
                (this.log(
                  `LL-Part loading ${u ? "ON" : "OFF"} loading sn ${null == l ? void 0 : l.sn}->${e.sn}`,
                ),
                (this.loadingParts = u));
            }
            if (((r = Math.max(e.start, r || 0)), this.loadingParts && sd(e))) {
              var d = a.partList;
              if (d && i) {
                r > a.fragmentEnd && a.fragmentHint && (e = a.fragmentHint);
                var h = this.getNextPart(d, e, r);
                if (h > -1) {
                  var c,
                    f = d[h];
                  return (
                    (e = this.fragCurrent = f.fragment),
                    this.log(
                      `Loading ${e.type} sn: ${e.sn} part: ${f.index} (${h}/${d.length - 1}) of ${this.fragInfo(e, !1, f)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(r.toFixed(3))}`,
                    ),
                    (this.nextLoadPosition = f.start + f.duration),
                    (this.state = Ff),
                    (c = s
                      ? s
                          .then(r =>
                            !r || this.fragContextChanged(r.frag) ? null : this.doFragPartsLoad(e, f, t, i),
                          )
                          .catch(e => this.handleFragLoadError(e))
                      : this.doFragPartsLoad(e, f, t, i).catch(e => this.handleFragLoadError(e))),
                    this.hls.trigger(Au.FRAG_LOADING, { frag: e, part: f, targetBufferTime: r }),
                    null === this.fragCurrent
                      ? Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts"))
                      : c
                  );
                }
                if (!e.url || this.loadedEndOfParts(d, r)) return Promise.resolve(null);
              }
            }
            if (sd(e) && this.loadingParts)
              (this.log(
                `LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${null == (o = a.partList) ? void 0 : o.filter(e => e.loaded).map(e => `[${e.start}-${e.end}]`)}`,
              ),
                (this.loadingParts = !1));
            else if (!e.url) return Promise.resolve(null);
            (this.log(
              `Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e, !1)}) cc: ${e.cc} ${"[" + a.startSN + "-" + a.endSN + "]"}, target: ${parseFloat(r.toFixed(3))}`,
            ),
              bu(e.sn) && !this.bitrateTest && (this.nextLoadPosition = e.start + e.duration),
              (this.state = Ff));
            var p,
              g = this.config.progressive && e.type !== Du;
            return (
              (p =
                g && s
                  ? s
                      .then(t =>
                        !t || this.fragContextChanged(t.frag) ? null : this.fragmentLoader.load(e, i),
                      )
                      .catch(e => this.handleFragLoadError(e))
                  : Promise.all([this.fragmentLoader.load(e, g ? i : void 0), s])
                      .then(([e]) => (!g && i && i(e), e))
                      .catch(e => this.handleFragLoadError(e))),
              this.hls.trigger(Au.FRAG_LOADING, { frag: e, targetBufferTime: r }),
              null === this.fragCurrent
                ? Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING"))
                : p
            );
          }
          doFragPartsLoad(e, t, r, i) {
            return new Promise((n, a) => {
              var s,
                o = [],
                l = null == (s = r.details) ? void 0 : s.partList,
                u = t => {
                  this.fragmentLoader
                    .loadPart(e, t, i)
                    .then(i => {
                      o[t.index] = i;
                      var a = i.part;
                      this.hls.trigger(Au.FRAG_LOADED, i);
                      var s = Sf(r.details, e.sn, t.index + 1) || Ef(l, e.sn, t.index + 1);
                      if (!s) return n({ frag: e, part: a, partsLoaded: o });
                      u(s);
                    })
                    .catch(a);
                };
              u(t);
            });
          }
          handleFragLoadError(e) {
            if ("data" in e) {
              var t = e.data;
              t.frag && t.details === wu.INTERNAL_ABORTED
                ? this.handleFragLoadAborted(t.frag, t.part)
                : t.frag && t.type === xu.KEY_SYSTEM_ERROR
                  ? (t.frag.abortRequests(),
                    this.resetStartWhenNotLoaded(),
                    this.resetFragmentLoading(t.frag))
                  : this.hls.trigger(Au.ERROR, t);
            } else
              this.hls.trigger(Au.ERROR, {
                type: xu.OTHER_ERROR,
                details: wu.INTERNAL_EXCEPTION,
                err: e,
                error: e,
                fatal: !0,
              });
            return null;
          }
          _handleTransmuxerFlush(e) {
            var t = this.getCurrentContext(e);
            if (t && this.state === $f) {
              var r = t.frag,
                i = t.part,
                n = t.level,
                a = self.performance.now();
              ((r.stats.parsing.end = a), i && (i.stats.parsing.end = a));
              var s = this.getLevelDetails(),
                o = (s && r.sn > s.endSN) || this.shouldLoadParts(s, r.end);
              (o !== this.loadingParts &&
                (this.log(
                  `LL-Part loading ${o ? "ON" : "OFF"} after parsing segment ending @${r.end.toFixed(2)}`,
                ),
                (this.loadingParts = o)),
                this.updateLevelTiming(r, i, n, e.partial));
            } else this.fragCurrent || this.state === Pf || this.state === Vf || (this.state = Of);
          }
          shouldLoadParts(e, t) {
            if (this.config.lowLatencyMode) {
              if (!e) return this.loadingParts;
              if (e.partList) {
                var r,
                  i,
                  n = e.partList[0];
                if (n.fragment.type === Du) return !1;
                if (t >= n.end + ((null == (r = e.fragmentHint) ? void 0 : r.duration) || 0))
                  if (
                    (this.hls.hasEnoughToStart
                      ? (null == (i = this.media) ? void 0 : i.currentTime) || this.lastCurrentTime
                      : this.getLoadPosition()) >
                    n.start - n.fragment.duration
                  )
                    return !0;
              }
            }
            return !1;
          }
          getCurrentContext(e) {
            var t = this.levels,
              r = this.fragCurrent,
              i = e.level,
              n = e.sn,
              a = e.part;
            if (null == t || !t[i])
              return (
                this.warn(
                  `Levels object was unset while buffering fragment ${n} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`,
                ),
                null
              );
            var s = t[i],
              o = s.details,
              l = a > -1 ? Sf(o, n, a) : null,
              u = l ? l.fragment : bf(o, n, r);
            return u ? (r && r !== u && (u.stats = r.stats), { frag: u, part: l, level: s }) : null;
          }
          bufferFragmentData(e, t, r, i, n) {
            if (this.state === $f) {
              var a = e.data1,
                s = e.data2,
                o = a;
              if ((s && (o = Rd(a, s)), o.length)) {
                var l = this.initPTS[t.cc],
                  u = l ? -l.baseTime / l.timescale : void 0,
                  d = { type: e.type, frag: t, part: r, chunkMeta: i, offset: u, parent: t.type, data: o };
                if ((this.hls.trigger(Au.BUFFER_APPENDING, d), e.dropped && e.independent && !r)) {
                  if (n) return;
                  this.flushBufferGap(t);
                }
              }
            }
          }
          flushBufferGap(e) {
            var t = this.media;
            if (t)
              if (fc.isBuffered(t, t.currentTime)) {
                var r = t.currentTime,
                  i = fc.bufferInfo(t, r, 0),
                  n = e.duration,
                  a = Math.min(2 * this.config.maxFragLookUpTolerance, 0.25 * n),
                  s = Math.max(Math.min(e.start - a, i.end - a), r + a);
                e.start - s > a && this.flushMainBuffer(s, e.start);
              } else this.flushMainBuffer(0, e.start);
          }
          getFwdBufferInfo(e, t) {
            var r,
              i = this.getLoadPosition();
            if (!bu(i)) return null;
            var n =
              this.lastCurrentTime > i || (null != (r = this.media) && r.paused)
                ? 0
                : this.config.maxBufferHole;
            return this.getFwdBufferInfoAtPos(e, i, t, n);
          }
          getFwdBufferInfoAtPos(e, t, r, i) {
            var n = fc.bufferInfo(e, t, i);
            if (0 === n.len && void 0 !== n.nextStart) {
              var a = this.fragmentTracker.getBufferedFrag(t, r);
              if (a && (n.nextStart <= a.end || a.gap)) {
                var s = Math.max(Math.min(n.nextStart, a.end) - t, i);
                return fc.bufferInfo(e, t, s);
              }
            }
            return n;
          }
          getMaxBufferLength(e) {
            var t,
              r = this.config;
            return (
              (t = e ? Math.max((8 * r.maxBufferSize) / e, r.maxBufferLength) : r.maxBufferLength),
              Math.min(t, r.maxMaxBufferLength)
            );
          }
          reduceMaxBufferLength(e, t) {
            var r = this.config,
              i = Math.max(Math.min(e - t, r.maxBufferLength), t),
              n = Math.max(e - 3 * t, r.maxMaxBufferLength / 2, i);
            return n >= i && ((r.maxMaxBufferLength = n), this.warn(`Reduce max buffer length to ${n}s`), !0);
          }
          getAppendedFrag(e, t = Lu) {
            var r = this.fragmentTracker ? this.fragmentTracker.getAppendedFrag(e, t) : null;
            return r && "fragment" in r ? r.fragment : r;
          }
          getNextFragment(e, t) {
            var r = t.fragments,
              i = r.length;
            if (!i) return null;
            var n = this.config,
              a = r[0].start,
              s = n.lowLatencyMode && !!t.partList,
              o = null;
            if (t.live) {
              var l = n.initialLiveManifestSize;
              if (i < l)
                return (this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`), null);
              if ((!t.PTSKnown && !this.startFragRequested && -1 === this.startPosition) || e < a) {
                var u;
                (s &&
                  !this.loadingParts &&
                  (this.log("LL-Part loading ON for initial live fragment"), (this.loadingParts = !0)),
                  (o = this.getInitialLiveFragment(t)));
                var d = this.hls.startPosition,
                  h = this.hls.liveSyncPosition,
                  c = o ? (-1 !== d && d >= a ? d : h) || o.start : e;
                (this.log(
                  `Setting startPosition to ${c} to match start frag at live edge. mainStart: ${d} liveSyncPosition: ${h} frag.start: ${null == (u = o) ? void 0 : u.start}`,
                ),
                  (this.startPosition = this.nextLoadPosition = c));
              }
            } else e <= a && (o = r[0]);
            if (!o) {
              var f = this.loadingParts ? t.partEnd : t.fragmentEnd;
              o = this.getFragmentAtPosition(e, f, t);
            }
            var p = this.filterReplacedPrimary(o, t);
            if (!p && o) {
              var g = o.sn - t.startSN;
              p = this.filterReplacedPrimary(r[g + 1] || null, t);
            }
            return this.mapToInitFragWhenRequired(p);
          }
          isLoopLoading(e, t) {
            var r = this.fragmentTracker.getState(e);
            return (r === qh || (r === zh && !!e.gap)) && this.nextLoadPosition > t;
          }
          getNextFragmentLoopLoading(e, t, r, i, n) {
            var a = null;
            if (e.gap && (a = this.getNextFragment(this.nextLoadPosition, t)) && !a.gap && r.nextStart) {
              var s = this.getFwdBufferInfoAtPos(
                this.mediaBuffer ? this.mediaBuffer : this.media,
                r.nextStart,
                i,
                0,
              );
              if (null !== s && r.len + s.len >= n) {
                var o = a.sn;
                return (
                  this.loopSn !== o &&
                    (this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${o}`),
                    (this.loopSn = o)),
                  null
                );
              }
            }
            return ((this.loopSn = void 0), a);
          }
          get primaryPrefetch() {
            var e;
            if (
              zf(this.config) &&
              (null == (e = this.hls.interstitialsManager) || null == (e = e.playingItem) ? void 0 : e.event)
            )
              return !0;
            return !1;
          }
          filterReplacedPrimary(e, t) {
            if (!e) return e;
            if (zf(this.config) && e.type !== Du) {
              var r = this.hls.interstitialsManager,
                i = null == r ? void 0 : r.bufferingItem;
              if (i) {
                var n = i.event;
                if (n) {
                  if (n.appendInPlace || Math.abs(e.start - i.start) > 1 || 0 === i.start) return null;
                } else {
                  if (e.end <= i.start && !1 === (null == t ? void 0 : t.live)) return null;
                  if (e.start > i.end && i.nextEvent && (i.nextEvent.appendInPlace || e.start - i.end > 1))
                    return null;
                }
              }
              var a = null == r ? void 0 : r.playerQueue;
              if (a)
                for (var s = a.length; s--; ) {
                  var o = a[s].interstitial;
                  if (o.appendInPlace && e.start >= o.startTime && e.end <= o.resumeTime) return null;
                }
            }
            return e;
          }
          mapToInitFragWhenRequired(e) {
            return null == e || !e.initSegment || e.initSegment.data || this.bitrateTest ? e : e.initSegment;
          }
          getNextPart(e, t, r) {
            for (var i = -1, n = !1, a = !0, s = 0, o = e.length; s < o; s++) {
              var l = e[s];
              if (((a = a && !l.independent), i > -1 && r < l.start)) break;
              var u = l.loaded;
              (u
                ? (i = -1)
                : (n || ((l.independent || a) && l.fragment === t)) &&
                  (l.fragment !== t &&
                    this.warn(`Need buffer at ${r} but next unloaded part starts at ${l.start}`),
                  (i = s)),
                (n = u));
            }
            return i;
          }
          loadedEndOfParts(e, t) {
            for (var r, i = e.length; i--; ) {
              if (!(r = e[i]).loaded) return !1;
              if (t > r.start) return !0;
            }
            return !1;
          }
          getInitialLiveFragment(e) {
            var t = e.fragments,
              r = this.fragPrevious,
              i = null;
            if (r) {
              if (
                (e.hasProgramDateTime &&
                  (this.log(
                    `Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`,
                  ),
                  (i = (function (e, t, r) {
                    if (null === t || !Array.isArray(e) || !e.length || !bu(t)) return null;
                    if (t < (e[0].programDateTime || 0)) return null;
                    if (t >= (e[e.length - 1].endProgramDateTime || 0)) return null;
                    for (var i = 0; i < e.length; ++i) {
                      var n = e[i];
                      if (Ih(t, r, n)) return n;
                    }
                    return null;
                  })(t, r.endProgramDateTime, this.config.maxFragLookUpTolerance))),
                !i)
              ) {
                var n = r.sn + 1;
                if (n >= e.startSN && n <= e.endSN) {
                  var a = t[n - e.startSN];
                  r.cc === a.cc &&
                    ((i = a), this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`));
                }
                i ||
                  ((i = kh(e, r.cc, r.end)) &&
                    this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`));
              }
            } else {
              var s = this.hls.liveSyncPosition;
              null !== s && (i = this.getFragmentAtPosition(s, this.bitrateTest ? e.fragmentEnd : e.edge, e));
            }
            return i;
          }
          getFragmentAtPosition(e, t, r) {
            var i,
              n,
              a = this.config,
              s = this.fragPrevious,
              o = r.fragments,
              l = r.endSN,
              u = r.fragmentHint,
              d = a.maxFragLookUpTolerance,
              h = r.partList,
              c = !!(this.loadingParts && null != h && h.length && u);
            (c &&
              !this.bitrateTest &&
              h[h.length - 1].fragment.sn === u.sn &&
              ((o = o.concat(u)), (l = u.sn)),
            e < t)
              ? (i = wh(
                  s,
                  o,
                  e,
                  e < this.lastCurrentTime ||
                    e > t - d ||
                    (null != (n = this.media) && n.paused) ||
                    !this.startFragRequested
                    ? 0
                    : d,
                ))
              : (i = o[o.length - 1]);
            if (i) {
              var f = i.sn - r.startSN,
                p = this.fragmentTracker.getState(i);
              if (
                ((p === qh || (p === zh && i.gap)) && (s = i),
                s && i.sn === s.sn && (!c || h[0].fragment.sn > i.sn || !r.live))
              )
                if (i.level === s.level) {
                  var g = o[f + 1];
                  i = i.sn < l && this.fragmentTracker.getState(g) !== qh ? g : null;
                }
            }
            return i;
          }
          alignPlaylists(e, t, r) {
            var i = e.fragments.length;
            if (!i) return (this.warn("No fragments in live playlist"), 0);
            var n = e.fragmentStart,
              a = !t,
              s = e.alignedSliding && bu(n);
            if (a || (!s && !n)) {
              !(function (e, t) {
                e &&
                  (Cf(t, e),
                  t.alignedSliding || Lf(t, e),
                  t.alignedSliding || t.skippedSegments || vf(e, t, !1));
              })(r, e);
              var o = e.fragmentStart;
              return (
                this.log(
                  `Live playlist sliding: ${o.toFixed(2)} start-sn: ${t ? t.startSN : "na"}->${e.startSN} fragments: ${i}`,
                ),
                o
              );
            }
            return n;
          }
          waitForCdnTuneIn(e) {
            return (
              e.live &&
              e.canBlockReload &&
              e.partTarget &&
              e.tuneInGoal > Math.max(e.partHoldBack, 3 * e.partTarget)
            );
          }
          setStartPosition(e, t) {
            var r = this.startPosition;
            r < t && (r = -1);
            var i = this.timelineOffset;
            if (-1 === r) {
              var n = null !== this.startTimeOffset,
                a = n ? this.startTimeOffset : e.startTimeOffset;
              (null !== a && bu(a)
                ? ((r = t + a),
                  a < 0 && (r += e.edge),
                  (r = Math.min(Math.max(t, r), t + e.totalduration)),
                  this.log(
                    `Setting startPosition to ${r} for start time offset ${a} found in ${n ? "multivariant" : "media"} playlist`,
                  ),
                  (this.startPosition = r))
                : e.live
                  ? ((r = this.hls.liveSyncPosition || t),
                    this.log(`Setting startPosition to -1 to start at live edge ${r}`),
                    (this.startPosition = -1))
                  : (this.log("setting startPosition to 0 by default"), (this.startPosition = r = 0)),
                (this.lastCurrentTime = r + i));
            }
            this.nextLoadPosition = r + i;
          }
          getLoadPosition() {
            var e,
              t = this.media,
              r = 0;
            return (
              null != (e = this.hls) && e.hasEnoughToStart && t
                ? (r = t.currentTime)
                : this.nextLoadPosition >= 0 && (r = this.nextLoadPosition),
              r
            );
          }
          handleFragLoadAborted(e, t) {
            this.transmuxer &&
              e.type === this.playlistType &&
              sd(e) &&
              e.stats.aborted &&
              (this.log(
                `Fragment ${e.sn}${t ? " part " + t.index : ""} of ${this.playlistLabel()} ${e.level} was aborted`,
              ),
              this.resetFragmentLoading(e));
          }
          resetFragmentLoading(e) {
            (this.fragCurrent && (this.fragContextChanged(e) || this.state === Uf)) || (this.state = Of);
          }
          onFragmentOrKeyLoadError(e, t) {
            var r;
            if (t.chunkMeta && !t.frag) {
              var i = this.getCurrentContext(t.chunkMeta);
              i && (t.frag = i.frag);
            }
            var n = t.frag;
            if (n && n.type === e && this.levels)
              if (this.fragContextChanged(n)) {
                var a;
                this.warn(
                  `Frag load error must match current frag to retry ${n.url} > ${null == (a = this.fragCurrent) ? void 0 : a.url}`,
                );
              } else {
                var s = t.details === wu.FRAG_GAP;
                s && this.fragmentTracker.fragBuffered(n, !0);
                var o = t.errorAction;
                if (o) {
                  var l = o.action,
                    u = o.flags,
                    d = o.retryCount,
                    h = void 0 === d ? 0 : d,
                    c = o.retryConfig,
                    f = !!c,
                    p = f && l === Bh,
                    g = f && !o.resolved && u === jh,
                    m = null == (r = this.hls.latestLevelDetails) ? void 0 : r.live;
                  if (!p && g && sd(n) && !n.endList && m && !Lh(t))
                    (this.resetFragmentErrors(e), this.treatAsGap(n), (o.resolved = !0));
                  else if ((p || g) && h < c.maxNumRetry) {
                    var v,
                      y = Oh(null == (v = t.response) ? void 0 : v.code),
                      T = Dh(c, h);
                    if (
                      (this.resetStartWhenNotLoaded(),
                      (this.retryDate = self.performance.now() + T),
                      (this.state = Uf),
                      (o.resolved = !0),
                      y)
                    )
                      return (
                        this.log("Waiting for connection (offline)"),
                        (this.retryDate = 1 / 0),
                        void (t.reason = "offline")
                      );
                    this.warn(
                      `Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${h + 1}/${c.maxNumRetry} in ${T}ms`,
                    );
                  } else if (c) {
                    if ((this.resetFragmentErrors(e), !(h < c.maxNumRetry)))
                      return void this.warn(`${t.details} reached or exceeded max retry (${h})`);
                    s || l === Uh || (o.resolved = !0);
                  } else this.state = l === Fh ? Kf : Vf;
                  this.tickImmediate();
                } else this.state = Vf;
              }
          }
          checkRetryDate() {
            var e = self.performance.now(),
              t = this.retryDate,
              r = t === 1 / 0;
            (!t || e >= t || (r && !Oh(0))) &&
              (r && this.log("Connection restored (online)"),
              this.resetStartWhenNotLoaded(),
              (this.state = Of));
          }
          reduceLengthAndFlushBuffer(e) {
            if (this.state === $f || this.state === jf) {
              var t = e.frag,
                r = e.parent,
                i = this.getFwdBufferInfo(this.mediaBuffer, r),
                n = i && i.len > 0.5;
              n && this.reduceMaxBufferLength(i.len, (null == t ? void 0 : t.duration) || 10);
              var a = !n;
              return (
                a &&
                  this.warn(
                    `Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`,
                  ),
                t && (this.fragmentTracker.removeFragment(t), (this.nextLoadPosition = t.start)),
                this.resetLoadingState(),
                a
              );
            }
            return !1;
          }
          resetFragmentErrors(e) {
            (e === Mu && (this.fragCurrent = null),
              this.hls.hasEnoughToStart || (this.startFragRequested = !1),
              this.state !== Pf && (this.state = Of));
          }
          afterBufferFlushed(e, t, r) {
            if (e) {
              var i = fc.getBuffered(e);
              (this.fragmentTracker.detectEvictedFragments(t, i, r),
                this.state === Gf && this.resetLoadingState());
            }
          }
          resetLoadingState() {
            (this.log("Reset loading state"),
              (this.fragCurrent = null),
              (this.fragPrevious = null),
              this.state !== Pf && (this.state = Of));
          }
          resetStartWhenNotLoaded() {
            if (!this.hls.hasEnoughToStart) {
              this.startFragRequested = !1;
              var e = this.levelLastLoaded,
                t = e ? e.details : null;
              null != t && t.live
                ? (this.log("resetting startPosition for live start"),
                  (this.startPosition = -1),
                  this.setStartPosition(t, t.fragmentStart),
                  this.resetLoadingState())
                : (this.nextLoadPosition = this.startPosition);
            }
          }
          resetWhenMissingContext(e) {
            (this.log(
              `Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${-1 === e.level ? "<removed>" : e.level}. This chunk will not be buffered.`,
            ),
              this.removeUnbufferedFrags(),
              this.resetStartWhenNotLoaded(),
              this.resetLoadingState());
          }
          removeUnbufferedFrags(e = 0) {
            this.fragmentTracker.removeFragmentsInRange(e, 1 / 0, this.playlistType, !1, !0);
          }
          updateLevelTiming(e, t, r, i) {
            var n = r.details;
            if (n) {
              if (
                !Object.keys(e.elementaryStreams).reduce((t, a) => {
                  var s = e.elementaryStreams[a];
                  if (s) {
                    var o = s.endPTS - s.startPTS;
                    if (o <= 0)
                      return (
                        this.warn(`Could not parse fragment ${e.sn} ${a} duration reliably (${o})`),
                        t || !1
                      );
                    var l = i ? 0 : pf(n, e, s.startPTS, s.endPTS, s.startDTS, s.endDTS, this);
                    return (
                      this.hls.trigger(Au.LEVEL_PTS_UPDATED, {
                        details: n,
                        level: r,
                        drift: l,
                        type: a,
                        frag: e,
                        start: s.startPTS,
                        end: s.endPTS,
                      }),
                      !0
                    );
                  }
                  return t;
                }, !1)
              ) {
                var a,
                  s = null === (null == (a = this.transmuxer) ? void 0 : a.error);
                if (
                  ((0 === r.fragmentError || (s && (r.fragmentError < 2 || e.endList))) &&
                    this.treatAsGap(e, r),
                  s)
                ) {
                  var o = new Error(
                    `Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`,
                  );
                  if (
                    (this.warn(o.message),
                    this.hls.trigger(Au.ERROR, {
                      type: xu.MEDIA_ERROR,
                      details: wu.FRAG_PARSING_ERROR,
                      fatal: !1,
                      error: o,
                      frag: e,
                      reason: `Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`,
                    }),
                    !this.hls)
                  )
                    return;
                  this.resetTransmuxer();
                }
              }
              ((this.state = jf),
                this.log(
                  `Parsed ${e.type} sn: ${e.sn}${t ? " part: " + t.index : ""} of ${this.fragInfo(e, !1, t)})`,
                ),
                this.hls.trigger(Au.FRAG_PARSED, { frag: e, part: t }));
            } else this.warn("level.details undefined");
          }
          playlistLabel() {
            return this.playlistType === Lu ? "level" : "track";
          }
          fragInfo(e, t = !0, r) {
            var i, n;
            return `${this.playlistLabel()} ${e.level} (${r ? "part" : "frag"}:[${(null != (i = t && !r ? e.startPTS : (r || e).start) ? i : NaN).toFixed(3)}-${(null != (n = t && !r ? e.endPTS : (r || e).end) ? n : NaN).toFixed(3)}]${r && "main" === e.type ? "INDEPENDENT=" + (r.independent ? "YES" : "NO") : ""}`;
          }
          treatAsGap(e, t) {
            (t && t.fragmentError++,
              (e.gap = !0),
              this.fragmentTracker.removeFragment(e),
              this.fragmentTracker.fragBuffered(e, !0));
          }
          resetTransmuxer() {
            var e;
            null == (e = this.transmuxer) || e.reset();
          }
          recoverWorkerError(e) {
            "demuxerWorker" === e.event &&
              (this.fragmentTracker.removeAllFragments(),
              this.transmuxer && (this.transmuxer.destroy(), (this.transmuxer = null)),
              this.resetStartWhenNotLoaded(),
              this.resetLoadingState());
          }
          set state(e) {
            var t = this._state;
            t !== e && ((this._state = e), this.log(`${t}->${e}`));
          }
          get state() {
            return this._state;
          }
        }
        function zf(e) {
          return !!e.interstitialsController && !1 !== e.enableInterstitialPlayback;
        }
        class qf {
          constructor() {
            ((this.chunks = []), (this.dataLength = 0));
          }
          push(e) {
            (this.chunks.push(e), (this.dataLength += e.length));
          }
          flush() {
            var e,
              t = this.chunks,
              r = this.dataLength;
            return t.length
              ? ((e =
                  1 === t.length
                    ? t[0]
                    : (function (e, t) {
                        for (var r = new Uint8Array(t), i = 0, n = 0; n < e.length; n++) {
                          var a = e[n];
                          (r.set(a, i), (i += a.length));
                        }
                        return r;
                      })(t, r)),
                this.reset(),
                e)
              : new Uint8Array(0);
          }
          reset() {
            ((this.chunks.length = 0), (this.dataLength = 0));
          }
        }
        var Xf,
          Yf = { exports: {} };
        var Qf =
            (Xf ||
              ((Xf = 1),
              (function (e) {
                var t = Object.prototype.hasOwnProperty,
                  r = "~";
                function i() {}
                function n(e, t, r) {
                  ((this.fn = e), (this.context = t), (this.once = r || !1));
                }
                function a(e, t, i, a, s) {
                  if ("function" != typeof i) throw new TypeError("The listener must be a function");
                  var o = new n(i, a || e, s),
                    l = r ? r + t : t;
                  return (
                    e._events[l]
                      ? e._events[l].fn
                        ? (e._events[l] = [e._events[l], o])
                        : e._events[l].push(o)
                      : ((e._events[l] = o), e._eventsCount++),
                    e
                  );
                }
                function s(e, t) {
                  0 === --e._eventsCount ? (e._events = new i()) : delete e._events[t];
                }
                function o() {
                  ((this._events = new i()), (this._eventsCount = 0));
                }
                (Object.create && ((i.prototype = Object.create(null)), new i().__proto__ || (r = !1)),
                  (o.prototype.eventNames = function () {
                    var e,
                      i,
                      n = [];
                    if (0 === this._eventsCount) return n;
                    for (i in (e = this._events)) t.call(e, i) && n.push(r ? i.slice(1) : i);
                    return Object.getOwnPropertySymbols ? n.concat(Object.getOwnPropertySymbols(e)) : n;
                  }),
                  (o.prototype.listeners = function (e) {
                    var t = r ? r + e : e,
                      i = this._events[t];
                    if (!i) return [];
                    if (i.fn) return [i.fn];
                    for (var n = 0, a = i.length, s = new Array(a); n < a; n++) s[n] = i[n].fn;
                    return s;
                  }),
                  (o.prototype.listenerCount = function (e) {
                    var t = r ? r + e : e,
                      i = this._events[t];
                    return i ? (i.fn ? 1 : i.length) : 0;
                  }),
                  (o.prototype.emit = function (e, t, i, n, a, s) {
                    var o = r ? r + e : e;
                    if (!this._events[o]) return !1;
                    var l,
                      u,
                      d = this._events[o],
                      h = arguments.length;
                    if (d.fn) {
                      switch ((d.once && this.removeListener(e, d.fn, void 0, !0), h)) {
                        case 1:
                          return (d.fn.call(d.context), !0);
                        case 2:
                          return (d.fn.call(d.context, t), !0);
                        case 3:
                          return (d.fn.call(d.context, t, i), !0);
                        case 4:
                          return (d.fn.call(d.context, t, i, n), !0);
                        case 5:
                          return (d.fn.call(d.context, t, i, n, a), !0);
                        case 6:
                          return (d.fn.call(d.context, t, i, n, a, s), !0);
                      }
                      for (u = 1, l = new Array(h - 1); u < h; u++) l[u - 1] = arguments[u];
                      d.fn.apply(d.context, l);
                    } else {
                      var c,
                        f = d.length;
                      for (u = 0; u < f; u++)
                        switch ((d[u].once && this.removeListener(e, d[u].fn, void 0, !0), h)) {
                          case 1:
                            d[u].fn.call(d[u].context);
                            break;
                          case 2:
                            d[u].fn.call(d[u].context, t);
                            break;
                          case 3:
                            d[u].fn.call(d[u].context, t, i);
                            break;
                          case 4:
                            d[u].fn.call(d[u].context, t, i, n);
                            break;
                          default:
                            if (!l) for (c = 1, l = new Array(h - 1); c < h; c++) l[c - 1] = arguments[c];
                            d[u].fn.apply(d[u].context, l);
                        }
                    }
                    return !0;
                  }),
                  (o.prototype.on = function (e, t, r) {
                    return a(this, e, t, r, !1);
                  }),
                  (o.prototype.once = function (e, t, r) {
                    return a(this, e, t, r, !0);
                  }),
                  (o.prototype.removeListener = function (e, t, i, n) {
                    var a = r ? r + e : e;
                    if (!this._events[a]) return this;
                    if (!t) return (s(this, a), this);
                    var o = this._events[a];
                    if (o.fn) o.fn !== t || (n && !o.once) || (i && o.context !== i) || s(this, a);
                    else {
                      for (var l = 0, u = [], d = o.length; l < d; l++)
                        (o[l].fn !== t || (n && !o[l].once) || (i && o[l].context !== i)) && u.push(o[l]);
                      u.length ? (this._events[a] = 1 === u.length ? u[0] : u) : s(this, a);
                    }
                    return this;
                  }),
                  (o.prototype.removeAllListeners = function (e) {
                    var t;
                    return (
                      e
                        ? ((t = r ? r + e : e), this._events[t] && s(this, t))
                        : ((this._events = new i()), (this._eventsCount = 0)),
                      this
                    );
                  }),
                  (o.prototype.off = o.prototype.removeListener),
                  (o.prototype.addListener = o.prototype.on),
                  (o.prefixed = r),
                  (o.EventEmitter = o),
                  (e.exports = o));
              })(Yf)),
            Yf.exports),
          Jf = Qu(Qf),
          Zf = "1.6.15",
          ep = {};
        function tp(e, t) {
          return (
            t + 10 <= e.length &&
            51 === e[t] &&
            68 === e[t + 1] &&
            73 === e[t + 2] &&
            e[t + 3] < 255 &&
            e[t + 4] < 255 &&
            e[t + 6] < 128 &&
            e[t + 7] < 128 &&
            e[t + 8] < 128 &&
            e[t + 9] < 128
          );
        }
        function rp(e, t) {
          return (
            t + 10 <= e.length &&
            73 === e[t] &&
            68 === e[t + 1] &&
            51 === e[t + 2] &&
            e[t + 3] < 255 &&
            e[t + 4] < 255 &&
            e[t + 6] < 128 &&
            e[t + 7] < 128 &&
            e[t + 8] < 128 &&
            e[t + 9] < 128
          );
        }
        function ip(e, t) {
          var r = 0;
          return (
            (r = (127 & e[t]) << 21),
            (r |= (127 & e[t + 1]) << 14),
            (r |= (127 & e[t + 2]) << 7),
            (r |= 127 & e[t + 3])
          );
        }
        function np(e, t) {
          for (var r = t, i = 0; rp(e, t); ) {
            ((i += 10), (i += ip(e, t + 6)), tp(e, t + 10) && (i += 10), (t += i));
          }
          if (i > 0) return e.subarray(r, r + i);
        }
        function ap(e, t) {
          return 255 === e[t] && 240 == (246 & e[t + 1]);
        }
        function sp(e, t) {
          return 1 & e[t + 1] ? 7 : 9;
        }
        function op(e, t) {
          return ((3 & e[t + 3]) << 11) | (e[t + 4] << 3) | ((224 & e[t + 5]) >>> 5);
        }
        function lp(e, t) {
          return t + 1 < e.length && ap(e, t);
        }
        function up(e, t) {
          if (lp(e, t)) {
            var r = sp(e, t);
            if (t + r >= e.length) return !1;
            var i = op(e, t);
            if (i <= r) return !1;
            var n = t + i;
            return n === e.length || lp(e, n);
          }
          return !1;
        }
        function dp(e, t, r, i, n) {
          if (!e.samplerate) {
            var a = (function (e, t, r, i) {
              var n = t[r + 2],
                a = (n >> 2) & 15;
              if (!(a > 12)) {
                var s = 1 + ((n >> 6) & 3),
                  o = ((t[r + 3] >> 6) & 3) | ((1 & n) << 2),
                  l = "mp4a.40." + s,
                  u = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350][a],
                  d = a;
                (5 !== s && 29 !== s) || (d -= 3);
                var h = [(s << 3) | ((14 & d) >> 1), ((1 & d) << 7) | (o << 3)];
                return (
                  Ku.log(
                    `manifest codec:${i}, parsed codec:${l}, channels:${o}, rate:${u} (ADTS object type:${s} sampling index:${a})`,
                  ),
                  { config: h, samplerate: u, channelCount: o, codec: l, parsedCodec: l, manifestCodec: i }
                );
              }
              var c = new Error(`invalid ADTS sampling index:${a}`);
              e.emit(Au.ERROR, Au.ERROR, {
                type: xu.MEDIA_ERROR,
                details: wu.FRAG_PARSING_ERROR,
                fatal: !0,
                error: c,
                reason: c.message,
              });
            })(t, r, i, n);
            if (!a) return;
            Nu(e, a);
          }
        }
        function hp(e) {
          return 9216e4 / e;
        }
        function cp(e, t, r, i, n) {
          var a,
            s = i + n * hp(e.samplerate),
            o = (function (e, t) {
              var r = sp(e, t);
              if (t + r <= e.length) {
                var i = op(e, t) - r;
                if (i > 0) return { headerLength: r, frameLength: i };
              }
            })(t, r);
          if (o) {
            var l = o.frameLength,
              u = o.headerLength,
              d = u + l,
              h = Math.max(0, r + d - t.length);
            h
              ? (a = new Uint8Array(d - u)).set(t.subarray(r + u, t.length), 0)
              : (a = t.subarray(r + u, r + d));
            var c = { unit: a, pts: s };
            return (h || e.samples.push(c), { sample: c, length: d, missing: h });
          }
          var f = t.length - r;
          return (
            (a = new Uint8Array(f)).set(t.subarray(r, t.length), 0),
            { sample: { unit: a, pts: s }, length: f, missing: -1 }
          );
        }
        function fp(e, t) {
          return rp(e, t) && ip(e, t + 6) + 10 <= e.length - t;
        }
        function pp(e, t = 0, r = 1 / 0) {
          return (function (e, t, r, i) {
            var n = (function (e) {
                return e instanceof ArrayBuffer ? e : e.buffer;
              })(e),
              a = 1;
            "BYTES_PER_ELEMENT" in i && (a = i.BYTES_PER_ELEMENT);
            var s =
                ((h = e),
                h && h.buffer instanceof ArrayBuffer && void 0 !== h.byteLength && void 0 !== h.byteOffset
                  ? e.byteOffset
                  : 0),
              o = (s + e.byteLength) / a,
              l = (s + t) / a,
              u = Math.floor(Math.max(0, Math.min(l, o))),
              d = Math.floor(Math.min(u + Math.max(r, 0), o));
            var h;
            return new i(n, u, d - u);
          })(e, t, r, Uint8Array);
        }
        function gp(e) {
          var t = { key: e.type, description: "", data: "", mimeType: null, pictureType: null };
          if (!(e.size < 2))
            if (3 === e.data[0]) {
              var r = e.data.subarray(1).indexOf(0);
              if (-1 !== r) {
                var i = qu(pp(e.data, 1, r)),
                  n = e.data[2 + r],
                  a = e.data.subarray(3 + r).indexOf(0);
                if (-1 !== a) {
                  var s,
                    o = qu(pp(e.data, 3 + r, a));
                  return (
                    (s =
                      "--\x3e" === i
                        ? qu(pp(e.data, 4 + r + a))
                        : (function (e) {
                            return e instanceof ArrayBuffer
                              ? e
                              : 0 == e.byteOffset && e.byteLength == e.buffer.byteLength
                                ? e.buffer
                                : new Uint8Array(e).buffer;
                          })(e.data.subarray(4 + r + a))),
                    (t.mimeType = i),
                    (t.pictureType = n),
                    (t.description = o),
                    (t.data = s),
                    t
                  );
                }
              }
            } else console.log("Ignore frame with unrecognized character encoding");
        }
        function mp(e) {
          return "PRIV" === e.type
            ? (function (e) {
                if (!(e.size < 2)) {
                  var t = qu(e.data, !0),
                    r = new Uint8Array(e.data.subarray(t.length + 1));
                  return { key: e.type, info: t, data: r.buffer };
                }
              })(e)
            : "W" === e.type[0]
              ? (function (e) {
                  if ("WXXX" === e.type) {
                    if (e.size < 2) return;
                    var t = 1,
                      r = qu(e.data.subarray(t), !0);
                    t += r.length + 1;
                    var i = qu(e.data.subarray(t));
                    return { key: e.type, info: r, data: i };
                  }
                  var n = qu(e.data);
                  return { key: e.type, info: "", data: n };
                })(e)
              : "APIC" === e.type
                ? gp(e)
                : (function (e) {
                    if (!(e.size < 2)) {
                      if ("TXXX" === e.type) {
                        var t = 1,
                          r = qu(e.data.subarray(t), !0);
                        t += r.length + 1;
                        var i = qu(e.data.subarray(t));
                        return { key: e.type, info: r, data: i };
                      }
                      var n = qu(e.data.subarray(1));
                      return { key: e.type, info: "", data: n };
                    }
                  })(e);
        }
        function vp(e) {
          var t = String.fromCharCode(e[0], e[1], e[2], e[3]),
            r = ip(e, 4);
          return { type: t, size: r, data: e.subarray(10, 10 + r) };
        }
        function yp(e) {
          for (var t = 0, r = []; rp(e, t); ) {
            var i = ip(e, t + 6);
            (e[t + 5] >> 6) & 1 && (t += 10);
            for (var n = (t += 10) + i; t + 10 < n; ) {
              var a = vp(e.subarray(t)),
                s = mp(a);
              (s && r.push(s), (t += a.size + 10));
            }
            tp(e, t) && (t += 10);
          }
          return r;
        }
        function Tp(e) {
          return e && "PRIV" === e.key && "com.apple.streaming.transportStreamTimestamp" === e.info;
        }
        function bp(e) {
          if (8 === e.data.byteLength) {
            var t = new Uint8Array(e.data),
              r = 1 & t[3],
              i = (t[4] << 23) + (t[5] << 15) + (t[6] << 7) + t[7];
            return ((i /= 45), r && (i += 47721858.84), Math.round(i));
          }
        }
        function Sp(e) {
          for (var t = yp(e), r = 0; r < t.length; r++) {
            var i = t[r];
            if (Tp(i)) return bp(i);
          }
        }
        var Ep = (function (e) {
          return (
            (e.audioId3 = "org.id3"),
            (e.dateRange = "com.apple.quicktime.HLS"),
            (e.emsg = "https://aomedia.org/emsg/ID3"),
            (e.misbklv = "urn:misb:KLV:bin:1910.1"),
            e
          );
        })({});
        function xp(e = "", t = 9e4) {
          return { type: e, id: -1, pid: -1, inputTimeScale: t, sequenceNumber: -1, samples: [], dropped: 0 };
        }
        class wp {
          constructor() {
            ((this._audioTrack = void 0),
              (this._id3Track = void 0),
              (this.frameIndex = 0),
              (this.cachedData = null),
              (this.basePTS = null),
              (this.initPTS = null),
              (this.lastPTS = null));
          }
          resetInitSegment(e, t, r, i) {
            this._id3Track = {
              type: "id3",
              id: 3,
              pid: -1,
              inputTimeScale: 9e4,
              sequenceNumber: 0,
              samples: [],
              dropped: 0,
            };
          }
          resetTimeStamp(e) {
            ((this.initPTS = e), this.resetContiguity());
          }
          resetContiguity() {
            ((this.basePTS = null), (this.lastPTS = null), (this.frameIndex = 0));
          }
          canParse(e, t) {
            return !1;
          }
          appendFrame(e, t, r) {}
          demux(e, t) {
            this.cachedData && ((e = Rd(this.cachedData, e)), (this.cachedData = null));
            var r,
              i = np(e, 0),
              n = i ? i.length : 0,
              a = this._audioTrack,
              s = this._id3Track,
              o = i ? Sp(i) : void 0,
              l = e.length;
            for (
              (null === this.basePTS || (0 === this.frameIndex && bu(o))) &&
                ((this.basePTS = Ap(o, t, this.initPTS)), (this.lastPTS = this.basePTS)),
                null === this.lastPTS && (this.lastPTS = this.basePTS),
                i &&
                  i.length > 0 &&
                  s.samples.push({
                    pts: this.lastPTS,
                    dts: this.lastPTS,
                    data: i,
                    type: Ep.audioId3,
                    duration: Number.POSITIVE_INFINITY,
                  });
              n < l;
            ) {
              if (this.canParse(e, n)) {
                var u = this.appendFrame(a, e, n);
                u ? (this.frameIndex++, (this.lastPTS = u.sample.pts), (r = n += u.length)) : (n = l);
              } else
                fp(e, n)
                  ? ((i = np(e, n)),
                    s.samples.push({
                      pts: this.lastPTS,
                      dts: this.lastPTS,
                      data: i,
                      type: Ep.audioId3,
                      duration: Number.POSITIVE_INFINITY,
                    }),
                    (r = n += i.length))
                  : n++;
              if (n === l && r !== l) {
                var d = e.slice(r);
                this.cachedData ? (this.cachedData = Rd(this.cachedData, d)) : (this.cachedData = d);
              }
            }
            return { audioTrack: a, videoTrack: xp(), id3Track: s, textTrack: xp() };
          }
          demuxSampleAes(e, t, r) {
            return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`));
          }
          flush(e) {
            var t = this.cachedData;
            return (
              t && ((this.cachedData = null), this.demux(t, 0)),
              { audioTrack: this._audioTrack, videoTrack: xp(), id3Track: this._id3Track, textTrack: xp() }
            );
          }
          destroy() {
            ((this.cachedData = null), (this._audioTrack = this._id3Track = void 0));
          }
        }
        var Ap = (e, t, r) => (bu(e) ? 90 * e : 9e4 * t + (r ? (9e4 * r.baseTime) / r.timescale : 0)),
          Ip = null,
          kp = [
            32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, 32, 48, 56, 64, 80, 96, 112,
            128, 160, 192, 224, 256, 320, 384, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320,
            32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256, 8, 16, 24, 32, 40, 48, 56, 64, 80,
            96, 112, 128, 144, 160,
          ],
          Rp = [44100, 48e3, 32e3, 22050, 24e3, 16e3, 11025, 12e3, 8e3],
          Cp = [
            [0, 72, 144, 12],
            [0, 0, 0, 0],
            [0, 72, 144, 12],
            [0, 144, 144, 12],
          ],
          Lp = [0, 1, 1, 4];
        function Mp(e, t, r, i, n) {
          if (!(r + 24 > t.length)) {
            var a = Dp(t, r);
            if (a && r + a.frameLength <= t.length) {
              var s = i + n * ((9e4 * a.samplesPerFrame) / a.sampleRate),
                o = { unit: t.subarray(r, r + a.frameLength), pts: s, dts: s };
              return (
                (e.config = []),
                (e.channelCount = a.channelCount),
                (e.samplerate = a.sampleRate),
                e.samples.push(o),
                { sample: o, length: a.frameLength, missing: 0 }
              );
            }
          }
        }
        function Dp(e, t) {
          var r = (e[t + 1] >> 3) & 3,
            i = (e[t + 1] >> 1) & 3,
            n = (e[t + 2] >> 4) & 15,
            a = (e[t + 2] >> 2) & 3;
          if (1 !== r && 0 !== n && 15 !== n && 3 !== a) {
            var s = (e[t + 2] >> 1) & 1,
              o = e[t + 3] >> 6,
              l = 1e3 * kp[14 * (3 === r ? 3 - i : 3 === i ? 3 : 4) + n - 1],
              u = Rp[3 * (3 === r ? 0 : 2 === r ? 1 : 2) + a],
              d = 3 === o ? 1 : 2,
              h = Cp[r][i],
              c = Lp[i],
              f = 8 * h * c,
              p = Math.floor((h * l) / u + s) * c;
            if (null === Ip) {
              var g = (navigator.userAgent || "").match(/Chrome\/(\d+)/i);
              Ip = g ? parseInt(g[1]) : 0;
            }
            return (
              !!Ip && Ip <= 87 && 2 === i && l >= 224e3 && 0 === o && (e[t + 3] = 128 | e[t + 3]),
              { sampleRate: u, channelCount: d, frameLength: p, samplesPerFrame: f }
            );
          }
        }
        function _p(e, t) {
          return !(255 !== e[t] || 224 & ~e[t + 1] || !(6 & e[t + 1]));
        }
        function Pp(e, t) {
          return t + 1 < e.length && _p(e, t);
        }
        function Op(e, t) {
          if (t + 1 < e.length && _p(e, t)) {
            var r = Dp(e, t),
              i = 4;
            null != r && r.frameLength && (i = r.frameLength);
            var n = t + i;
            return n === e.length || Pp(e, n);
          }
          return !1;
        }
        var Np = (e, t) => {
          var r = 0,
            i = 5;
          t += i;
          for (var n = new Uint32Array(1), a = new Uint32Array(1), s = new Uint8Array(1); i > 0; ) {
            s[0] = e[t];
            var o = Math.min(i, 8),
              l = 8 - o;
            ((a[0] = (4278190080 >>> (24 + l)) << l),
              (n[0] = (s[0] & a[0]) >> l),
              (r = r ? (r << o) | n[0] : n[0]),
              (t += 1),
              (i -= o));
          }
          return r;
        };
        class Fp extends wp {
          constructor(e) {
            (super(), (this.observer = void 0), (this.observer = e));
          }
          resetInitSegment(e, t, r, i) {
            (super.resetInitSegment(e, t, r, i),
              (this._audioTrack = {
                container: "audio/ac-3",
                type: "audio",
                id: 2,
                pid: -1,
                sequenceNumber: 0,
                segmentCodec: "ac3",
                samples: [],
                manifestCodec: t,
                duration: i,
                inputTimeScale: 9e4,
                dropped: 0,
              }));
          }
          canParse(e, t) {
            return t + 64 < e.length;
          }
          appendFrame(e, t, r) {
            var i = Up(e, t, r, this.basePTS, this.frameIndex);
            if (-1 !== i) return { sample: e.samples[e.samples.length - 1], length: i, missing: 0 };
          }
          static probe(e) {
            if (!e) return !1;
            var t = np(e, 0);
            if (!t) return !1;
            var r = t.length;
            return 11 === e[r] && 119 === e[r + 1] && void 0 !== Sp(t) && Np(e, r) < 16;
          }
        }
        function Up(e, t, r, i, n) {
          if (r + 8 > t.length) return -1;
          if (11 !== t[r] || 119 !== t[r + 1]) return -1;
          var a = t[r + 4] >> 6;
          if (a >= 3) return -1;
          var s = [48e3, 44100, 32e3][a],
            o = 63 & t[r + 4],
            l =
              2 *
              [
                64, 69, 96, 64, 70, 96, 80, 87, 120, 80, 88, 120, 96, 104, 144, 96, 105, 144, 112, 121, 168,
                112, 122, 168, 128, 139, 192, 128, 140, 192, 160, 174, 240, 160, 175, 240, 192, 208, 288, 192,
                209, 288, 224, 243, 336, 224, 244, 336, 256, 278, 384, 256, 279, 384, 320, 348, 480, 320, 349,
                480, 384, 417, 576, 384, 418, 576, 448, 487, 672, 448, 488, 672, 512, 557, 768, 512, 558, 768,
                640, 696, 960, 640, 697, 960, 768, 835, 1152, 768, 836, 1152, 896, 975, 1344, 896, 976, 1344,
                1024, 1114, 1536, 1024, 1115, 1536, 1152, 1253, 1728, 1152, 1254, 1728, 1280, 1393, 1920,
                1280, 1394, 1920,
              ][3 * o + a];
          if (r + l > t.length) return -1;
          var u = t[r + 6] >> 5,
            d = 0;
          2 === u ? (d += 2) : (1 & u && 1 !== u && (d += 2), 4 & u && (d += 2));
          var h = (((t[r + 6] << 8) | t[r + 7]) >> (12 - d)) & 1,
            c = [2, 1, 2, 3, 3, 4, 4, 5][u] + h,
            f = t[r + 5] >> 3,
            p = 7 & t[r + 5],
            g = new Uint8Array([
              (a << 6) | (f << 1) | (p >> 2),
              ((3 & p) << 6) | (u << 3) | (h << 2) | (o >> 4),
              (o << 4) & 224,
            ]),
            m = i + n * ((1536 / s) * 9e4),
            v = t.subarray(r, r + l);
          return (
            (e.config = g),
            (e.channelCount = c),
            (e.samplerate = s),
            e.samples.push({ unit: v, pts: m }),
            l
          );
        }
        var Bp = /\/emsg[-/]ID3/i;
        function $p(e, t) {
          return bu(e.presentationTime)
            ? e.presentationTime / e.timeScale
            : t + e.presentationTimeDelta / e.timeScale;
        }
        class jp {
          constructor(e, t, r) {
            ((this.keyData = void 0),
              (this.decrypter = void 0),
              (this.keyData = r),
              (this.decrypter = new nc(t, { removePKCS7Padding: !1 })));
          }
          decryptBuffer(e) {
            return this.decrypter.decrypt(e, this.keyData.key.buffer, this.keyData.iv.buffer, Zh);
          }
          decryptAacSample(e, t, r) {
            var i = e[t].unit;
            if (!(i.length <= 16)) {
              var n = i.subarray(16, i.length - (i.length % 16)),
                a = n.buffer.slice(n.byteOffset, n.byteOffset + n.length);
              this.decryptBuffer(a)
                .then(n => {
                  var a = new Uint8Array(n);
                  (i.set(a, 16), this.decrypter.isSync() || this.decryptAacSamples(e, t + 1, r));
                })
                .catch(r);
            }
          }
          decryptAacSamples(e, t, r) {
            for (; ; t++) {
              if (t >= e.length) return void r();
              if (!(e[t].unit.length < 32) && (this.decryptAacSample(e, t, r), !this.decrypter.isSync()))
                return;
            }
          }
          getAvcEncryptedData(e) {
            for (
              var t = 16 * Math.floor((e.length - 48) / 160) + 16, r = new Int8Array(t), i = 0, n = 32;
              n < e.length - 16;
              n += 160, i += 16
            )
              r.set(e.subarray(n, n + 16), i);
            return r;
          }
          getAvcDecryptedUnit(e, t) {
            for (var r = new Uint8Array(t), i = 0, n = 32; n < e.length - 16; n += 160, i += 16)
              e.set(r.subarray(i, i + 16), n);
            return e;
          }
          decryptAvcSample(e, t, r, i, n) {
            var a = _d(n.data),
              s = this.getAvcEncryptedData(a);
            this.decryptBuffer(s.buffer)
              .then(s => {
                ((n.data = this.getAvcDecryptedUnit(a, s)),
                  this.decrypter.isSync() || this.decryptAvcSamples(e, t, r + 1, i));
              })
              .catch(i);
          }
          decryptAvcSamples(e, t, r, i) {
            if (e instanceof Uint8Array) throw new Error("Cannot decrypt samples of type Uint8Array");
            for (; ; t++, r = 0) {
              if (t >= e.length) return void i();
              for (var n = e[t].units; !(r >= n.length); r++) {
                var a = n[r];
                if (
                  !(
                    a.data.length <= 48 ||
                    (1 !== a.type && 5 !== a.type) ||
                    (this.decryptAvcSample(e, t, r, i, a), this.decrypter.isSync())
                  )
                )
                  return;
              }
            }
          }
        }
        class Gp {
          constructor() {
            this.VideoSample = null;
          }
          createVideoSample(e, t, r) {
            return { key: e, frame: !1, pts: t, dts: r, units: [], length: 0 };
          }
          getLastNalUnit(e) {
            var t,
              r,
              i = this.VideoSample;
            if (((i && 0 !== i.units.length) || (i = e[e.length - 1]), null != (t = i) && t.units)) {
              var n = i.units;
              r = n[n.length - 1];
            }
            return r;
          }
          pushAccessUnit(e, t) {
            if (e.units.length && e.frame) {
              if (void 0 === e.pts) {
                var r = t.samples,
                  i = r.length;
                if (!i) return void t.dropped++;
                var n = r[i - 1];
                ((e.pts = n.pts), (e.dts = n.dts));
              }
              t.samples.push(e);
            }
          }
          parseNALu(e, t, r) {
            var i,
              n,
              a = t.byteLength,
              s = e.naluState || 0,
              o = s,
              l = [],
              u = 0,
              d = -1,
              h = 0;
            for (-1 === s && ((d = 0), (h = this.getNALuType(t, 0)), (s = 0), (u = 1)); u < a; )
              if (((i = t[u++]), s))
                if (1 !== s)
                  if (i)
                    if (1 === i) {
                      if (((n = u - s - 1), d >= 0)) {
                        var c = { data: t.subarray(d, n), type: h };
                        l.push(c);
                      } else {
                        var f = this.getLastNalUnit(e.samples);
                        f &&
                          (o && u <= 4 - o && f.state && (f.data = f.data.subarray(0, f.data.byteLength - o)),
                          n > 0 && ((f.data = Rd(f.data, t.subarray(0, n))), (f.state = 0)));
                      }
                      u < a ? ((d = u), (h = this.getNALuType(t, u)), (s = 0)) : (s = -1);
                    } else s = 0;
                  else s = 3;
                else s = i ? 0 : 2;
              else s = i ? 0 : 1;
            if (d >= 0 && s >= 0) {
              var p = { data: t.subarray(d, a), type: h, state: s };
              l.push(p);
            }
            if (0 === l.length) {
              var g = this.getLastNalUnit(e.samples);
              g && (g.data = Rd(g.data, t));
            }
            return ((e.naluState = s), l);
          }
        }
        class Vp {
          constructor(e) {
            ((this.data = void 0),
              (this.bytesAvailable = void 0),
              (this.word = void 0),
              (this.bitsAvailable = void 0),
              (this.data = e),
              (this.bytesAvailable = e.byteLength),
              (this.word = 0),
              (this.bitsAvailable = 0));
          }
          loadWord() {
            var e = this.data,
              t = this.bytesAvailable,
              r = e.byteLength - t,
              i = new Uint8Array(4),
              n = Math.min(4, t);
            if (0 === n) throw new Error("no bytes available");
            (i.set(e.subarray(r, r + n)),
              (this.word = new DataView(i.buffer).getUint32(0)),
              (this.bitsAvailable = 8 * n),
              (this.bytesAvailable -= n));
          }
          skipBits(e) {
            var t;
            ((e = Math.min(e, 8 * this.bytesAvailable + this.bitsAvailable)),
              this.bitsAvailable > e
                ? ((this.word <<= e), (this.bitsAvailable -= e))
                : ((e -= this.bitsAvailable),
                  (e -= (t = e >> 3) << 3),
                  (this.bytesAvailable -= t),
                  this.loadWord(),
                  (this.word <<= e),
                  (this.bitsAvailable -= e)));
          }
          readBits(e) {
            var t = Math.min(this.bitsAvailable, e),
              r = this.word >>> (32 - t);
            if (
              (e > 32 && Ku.error("Cannot read more than 32 bits at a time"),
              (this.bitsAvailable -= t),
              this.bitsAvailable > 0)
            )
              this.word <<= t;
            else {
              if (!(this.bytesAvailable > 0)) throw new Error("no bits available");
              this.loadWord();
            }
            return (t = e - t) > 0 && this.bitsAvailable ? (r << t) | this.readBits(t) : r;
          }
          skipLZ() {
            var e;
            for (e = 0; e < this.bitsAvailable; ++e)
              if (this.word & (2147483648 >>> e)) return ((this.word <<= e), (this.bitsAvailable -= e), e);
            return (this.loadWord(), e + this.skipLZ());
          }
          skipUEG() {
            this.skipBits(1 + this.skipLZ());
          }
          skipEG() {
            this.skipBits(1 + this.skipLZ());
          }
          readUEG() {
            var e = this.skipLZ();
            return this.readBits(e + 1) - 1;
          }
          readEG() {
            var e = this.readUEG();
            return 1 & e ? (1 + e) >>> 1 : -1 * (e >>> 1);
          }
          readBoolean() {
            return 1 === this.readBits(1);
          }
          readUByte() {
            return this.readBits(8);
          }
          readUShort() {
            return this.readBits(16);
          }
          readUInt() {
            return this.readBits(32);
          }
        }
        class Hp extends Gp {
          parsePES(e, t, r, i) {
            var n,
              a = this.parseNALu(e, r.data, i),
              s = this.VideoSample,
              o = !1;
            ((r.data = null),
              s &&
                a.length &&
                !e.audFound &&
                (this.pushAccessUnit(s, e),
                (s = this.VideoSample = this.createVideoSample(!1, r.pts, r.dts))),
              a.forEach(i => {
                var a, l;
                switch (i.type) {
                  case 1:
                    var u = !1;
                    n = !0;
                    var d,
                      h = i.data;
                    if (o && h.length > 4) {
                      var c = this.readSliceType(h);
                      (2 !== c && 4 !== c && 7 !== c && 9 !== c) || (u = !0);
                    }
                    if (u)
                      null != (d = s) &&
                        d.frame &&
                        !s.key &&
                        (this.pushAccessUnit(s, e), (s = this.VideoSample = null));
                    (s || (s = this.VideoSample = this.createVideoSample(!0, r.pts, r.dts)),
                      (s.frame = !0),
                      (s.key = u));
                    break;
                  case 5:
                    ((n = !0),
                      null != (a = s) &&
                        a.frame &&
                        !s.key &&
                        (this.pushAccessUnit(s, e), (s = this.VideoSample = null)),
                      s || (s = this.VideoSample = this.createVideoSample(!0, r.pts, r.dts)),
                      (s.key = !0),
                      (s.frame = !0));
                    break;
                  case 6:
                    ((n = !0), Dd(i.data, 1, r.pts, t.samples));
                    break;
                  case 7:
                    var f, p;
                    ((n = !0), (o = !0));
                    var g = i.data,
                      m = this.readSPS(g);
                    if (
                      !e.sps ||
                      e.width !== m.width ||
                      e.height !== m.height ||
                      (null == (f = e.pixelRatio) ? void 0 : f[0]) !== m.pixelRatio[0] ||
                      (null == (p = e.pixelRatio) ? void 0 : p[1]) !== m.pixelRatio[1]
                    ) {
                      ((e.width = m.width),
                        (e.height = m.height),
                        (e.pixelRatio = m.pixelRatio),
                        (e.sps = [g]));
                      for (var v = g.subarray(1, 4), y = "avc1.", T = 0; T < 3; T++) {
                        var b = v[T].toString(16);
                        (b.length < 2 && (b = "0" + b), (y += b));
                      }
                      e.codec = y;
                    }
                    break;
                  case 8:
                    ((n = !0), (e.pps = [i.data]));
                    break;
                  case 9:
                    ((n = !0),
                      (e.audFound = !0),
                      null != (l = s) && l.frame && (this.pushAccessUnit(s, e), (s = null)),
                      s || (s = this.VideoSample = this.createVideoSample(!1, r.pts, r.dts)));
                    break;
                  case 12:
                    n = !0;
                    break;
                  default:
                    n = !1;
                }
                s && n && s.units.push(i);
              }),
              i && s && (this.pushAccessUnit(s, e), (this.VideoSample = null)));
          }
          getNALuType(e, t) {
            return 31 & e[t];
          }
          readSliceType(e) {
            var t = new Vp(e);
            return (t.readUByte(), t.readUEG(), t.readUEG());
          }
          skipScalingList(e, t) {
            for (var r = 8, i = 8, n = 0; n < e; n++)
              (0 !== i && (i = (r + t.readEG() + 256) % 256), (r = 0 === i ? r : i));
          }
          readSPS(e) {
            var t,
              r,
              i,
              n = new Vp(e),
              a = 0,
              s = 0,
              o = 0,
              l = 0,
              u = n.readUByte.bind(n),
              d = n.readBits.bind(n),
              h = n.readUEG.bind(n),
              c = n.readBoolean.bind(n),
              f = n.skipBits.bind(n),
              p = n.skipEG.bind(n),
              g = n.skipUEG.bind(n),
              m = this.skipScalingList.bind(this);
            u();
            var v = u();
            if (
              (d(5),
              f(3),
              u(),
              g(),
              100 === v ||
                110 === v ||
                122 === v ||
                244 === v ||
                44 === v ||
                83 === v ||
                86 === v ||
                118 === v ||
                128 === v)
            ) {
              var y = h();
              if ((3 === y && f(1), g(), g(), f(1), c()))
                for (r = 3 !== y ? 8 : 12, i = 0; i < r; i++) c() && m(i < 6 ? 16 : 64, n);
            }
            g();
            var T = h();
            if (0 === T) h();
            else if (1 === T) for (f(1), p(), p(), t = h(), i = 0; i < t; i++) p();
            (g(), f(1));
            var b = h(),
              S = h(),
              E = d(1);
            (0 === E && f(1), f(1), c() && ((a = h()), (s = h()), (o = h()), (l = h())));
            var x = [1, 1];
            if (c() && c())
              switch (u()) {
                case 1:
                  x = [1, 1];
                  break;
                case 2:
                  x = [12, 11];
                  break;
                case 3:
                  x = [10, 11];
                  break;
                case 4:
                  x = [16, 11];
                  break;
                case 5:
                  x = [40, 33];
                  break;
                case 6:
                  x = [24, 11];
                  break;
                case 7:
                  x = [20, 11];
                  break;
                case 8:
                  x = [32, 11];
                  break;
                case 9:
                  x = [80, 33];
                  break;
                case 10:
                  x = [18, 11];
                  break;
                case 11:
                  x = [15, 11];
                  break;
                case 12:
                  x = [64, 33];
                  break;
                case 13:
                  x = [160, 99];
                  break;
                case 14:
                  x = [4, 3];
                  break;
                case 15:
                  x = [3, 2];
                  break;
                case 16:
                  x = [2, 1];
                  break;
                case 255:
                  x = [(u() << 8) | u(), (u() << 8) | u()];
              }
            return {
              width: Math.ceil(16 * (b + 1) - 2 * a - 2 * s),
              height: (2 - E) * (S + 1) * 16 - (E ? 2 : 4) * (o + l),
              pixelRatio: x,
            };
          }
        }
        class Kp extends Gp {
          constructor(...e) {
            (super(...e), (this.initVPS = null));
          }
          parsePES(e, t, r, i) {
            var n,
              a = this.parseNALu(e, r.data, i),
              s = this.VideoSample,
              o = !1;
            ((r.data = null),
              s &&
                a.length &&
                !e.audFound &&
                (this.pushAccessUnit(s, e),
                (s = this.VideoSample = this.createVideoSample(!1, r.pts, r.dts))),
              a.forEach(i => {
                var a, l;
                switch (i.type) {
                  case 0:
                  case 1:
                  case 2:
                  case 3:
                  case 4:
                  case 5:
                  case 6:
                  case 7:
                  case 8:
                  case 9:
                    (s || (s = this.VideoSample = this.createVideoSample(!1, r.pts, r.dts)),
                      (s.frame = !0),
                      (n = !0));
                    break;
                  case 16:
                  case 17:
                  case 18:
                  case 21:
                    var u;
                    if (((n = !0), o))
                      null != (u = s) &&
                        u.frame &&
                        !s.key &&
                        (this.pushAccessUnit(s, e), (s = this.VideoSample = null));
                    (s || (s = this.VideoSample = this.createVideoSample(!0, r.pts, r.dts)),
                      (s.key = !0),
                      (s.frame = !0));
                    break;
                  case 19:
                  case 20:
                    ((n = !0),
                      null != (a = s) &&
                        a.frame &&
                        !s.key &&
                        (this.pushAccessUnit(s, e), (s = this.VideoSample = null)),
                      s || (s = this.VideoSample = this.createVideoSample(!0, r.pts, r.dts)),
                      (s.key = !0),
                      (s.frame = !0));
                    break;
                  case 39:
                    ((n = !0), Dd(i.data, 2, r.pts, t.samples));
                    break;
                  case 32:
                    ((n = !0),
                      e.vps ||
                        ("object" != typeof e.params && (e.params = {}),
                        (e.params = Nu(e.params, this.readVPS(i.data))),
                        (this.initVPS = i.data)),
                      (e.vps = [i.data]));
                    break;
                  case 33:
                    if (
                      ((n = !0),
                      (o = !0),
                      void 0 === e.vps ||
                        e.vps[0] === this.initVPS ||
                        void 0 === e.sps ||
                        this.matchSPS(e.sps[0], i.data) ||
                        ((this.initVPS = e.vps[0]), (e.sps = e.pps = void 0)),
                      !e.sps)
                    ) {
                      var d = this.readSPS(i.data);
                      for (var h in ((e.width = d.width),
                      (e.height = d.height),
                      (e.pixelRatio = d.pixelRatio),
                      (e.codec = d.codecString),
                      (e.sps = []),
                      "object" != typeof e.params && (e.params = {}),
                      d.params))
                        e.params[h] = d.params[h];
                    }
                    (this.pushParameterSet(e.sps, i.data, e.vps),
                      s || (s = this.VideoSample = this.createVideoSample(!0, r.pts, r.dts)),
                      (s.key = !0));
                    break;
                  case 34:
                    if (((n = !0), "object" == typeof e.params)) {
                      if (!e.pps) {
                        e.pps = [];
                        var c = this.readPPS(i.data);
                        for (var f in c) e.params[f] = c[f];
                      }
                      this.pushParameterSet(e.pps, i.data, e.vps);
                    }
                    break;
                  case 35:
                    ((n = !0),
                      (e.audFound = !0),
                      null != (l = s) && l.frame && (this.pushAccessUnit(s, e), (s = null)),
                      s || (s = this.VideoSample = this.createVideoSample(!1, r.pts, r.dts)));
                    break;
                  default:
                    n = !1;
                }
                s && n && s.units.push(i);
              }),
              i && s && (this.pushAccessUnit(s, e), (this.VideoSample = null)));
          }
          pushParameterSet(e, t, r) {
            ((r && r[0] === this.initVPS) || (!r && !e.length)) && e.push(t);
          }
          getNALuType(e, t) {
            return (126 & e[t]) >>> 1;
          }
          ebsp2rbsp(e) {
            for (var t = new Uint8Array(e.byteLength), r = 0, i = 0; i < e.byteLength; i++)
              (i >= 2 && 3 === e[i] && 0 === e[i - 1] && 0 === e[i - 2]) || ((t[r] = e[i]), r++);
            return new Uint8Array(t.buffer, 0, r);
          }
          pushAccessUnit(e, t) {
            (super.pushAccessUnit(e, t), this.initVPS && (this.initVPS = null));
          }
          readVPS(e) {
            var t = new Vp(e);
            return (
              t.readUByte(),
              t.readUByte(),
              t.readBits(4),
              t.skipBits(2),
              t.readBits(6),
              { numTemporalLayers: t.readBits(3) + 1, temporalIdNested: t.readBoolean() }
            );
          }
          readSPS(e) {
            var t = new Vp(this.ebsp2rbsp(e));
            (t.readUByte(), t.readUByte(), t.readBits(4));
            var r = t.readBits(3);
            t.readBoolean();
            for (
              var i = t.readBits(2),
                n = t.readBoolean(),
                a = t.readBits(5),
                s = t.readUByte(),
                o = t.readUByte(),
                l = t.readUByte(),
                u = t.readUByte(),
                d = t.readUByte(),
                h = t.readUByte(),
                c = t.readUByte(),
                f = t.readUByte(),
                p = t.readUByte(),
                g = t.readUByte(),
                m = t.readUByte(),
                v = [],
                y = [],
                T = 0;
              T < r;
              T++
            )
              (v.push(t.readBoolean()), y.push(t.readBoolean()));
            if (r > 0) for (var b = r; b < 8; b++) t.readBits(2);
            for (var S = 0; S < r; S++)
              (v[S] &&
                (t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte(),
                t.readUByte()),
                y[S] && t.readUByte());
            t.readUEG();
            var E = t.readUEG();
            3 == E && t.skipBits(1);
            var x = t.readUEG(),
              w = t.readUEG(),
              A = t.readBoolean(),
              I = 0,
              k = 0,
              R = 0,
              C = 0;
            A && ((I += t.readUEG()), (k += t.readUEG()), (R += t.readUEG()), (C += t.readUEG()));
            for (
              var L = t.readUEG(), M = t.readUEG(), D = t.readUEG(), _ = t.readBoolean() ? 0 : r;
              _ <= r;
              _++
            )
              (t.skipUEG(), t.skipUEG(), t.skipUEG());
            if (
              (t.skipUEG(),
              t.skipUEG(),
              t.skipUEG(),
              t.skipUEG(),
              t.skipUEG(),
              t.skipUEG(),
              t.readBoolean()) &&
              t.readBoolean()
            )
              for (var P = 0; P < 4; P++)
                for (var O = 0; O < (3 === P ? 2 : 6); O++) {
                  if (t.readBoolean()) {
                    var N = Math.min(64, 1 << (4 + (P << 1)));
                    P > 1 && t.readEG();
                    for (var F = 0; F < N; F++) t.readEG();
                  } else t.readUEG();
                }
            (t.readBoolean(),
              t.readBoolean(),
              t.readBoolean() && (t.readUByte(), t.skipUEG(), t.skipUEG(), t.readBoolean()));
            for (var U = t.readUEG(), B = 0, $ = 0; $ < U; $++) {
              var j = !1;
              if ((0 !== $ && (j = t.readBoolean()), j)) {
                ($ === U && t.readUEG(), t.readBoolean(), t.readUEG());
                for (var G = 0, V = 0; V <= B; V++) {
                  var H = t.readBoolean(),
                    K = !1;
                  (H || (K = t.readBoolean()), (H || K) && G++);
                }
                B = G;
              } else {
                var W = t.readUEG(),
                  z = t.readUEG();
                B = W + z;
                for (var q = 0; q < W; q++) (t.readUEG(), t.readBoolean());
                for (var X = 0; X < z; X++) (t.readUEG(), t.readBoolean());
              }
            }
            if (t.readBoolean())
              for (var Y = t.readUEG(), Q = 0; Q < Y; Q++) {
                for (var J = 0; J < D + 4; J++) t.readBits(1);
                t.readBits(1);
              }
            var Z = 0,
              ee = 1,
              te = 1,
              re = !0,
              ie = 1,
              ne = 0;
            (t.readBoolean(), t.readBoolean());
            if (t.readBoolean()) {
              if (t.readBoolean()) {
                var ae = t.readUByte();
                ae > 0 && ae < 16
                  ? ((ee = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2][ae - 1]),
                    (te = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1][ae - 1]))
                  : 255 === ae && ((ee = t.readBits(16)), (te = t.readBits(16)));
              }
              if ((t.readBoolean() && t.readBoolean(), t.readBoolean()))
                (t.readBits(3),
                  t.readBoolean(),
                  t.readBoolean() && (t.readUByte(), t.readUByte(), t.readUByte()));
              if (
                (t.readBoolean() && (t.readUEG(), t.readUEG()),
                t.readBoolean(),
                t.readBoolean(),
                t.readBoolean(),
                t.readBoolean() && (t.skipUEG(), t.skipUEG(), t.skipUEG(), t.skipUEG()),
                t.readBoolean())
              )
                if (
                  ((ie = t.readBits(32)),
                  (ne = t.readBits(32)),
                  t.readBoolean() && t.readUEG(),
                  t.readBoolean())
                ) {
                  var se = t.readBoolean(),
                    oe = t.readBoolean(),
                    le = !1;
                  (se || oe) &&
                    ((le = t.readBoolean()) && (t.readUByte(), t.readBits(5), t.readBoolean(), t.readBits(5)),
                    t.readBits(4),
                    t.readBits(4),
                    le && t.readBits(4),
                    t.readBits(5),
                    t.readBits(5),
                    t.readBits(5));
                  for (var ue = 0; ue <= r; ue++) {
                    var de = !1;
                    (re = t.readBoolean()) || t.readBoolean() ? t.readEG() : (de = t.readBoolean());
                    var he = de ? 1 : t.readUEG() + 1;
                    if (se)
                      for (var ce = 0; ce < he; ce++)
                        (t.readUEG(), t.readUEG(), le && (t.readUEG(), t.readUEG()), t.skipBits(1));
                    if (oe)
                      for (var fe = 0; fe < he; fe++)
                        (t.readUEG(), t.readUEG(), le && (t.readUEG(), t.readUEG()), t.skipBits(1));
                  }
                }
              t.readBoolean() && (t.readBoolean(), t.readBoolean(), t.readBoolean(), (Z = t.readUEG()));
            }
            var pe = x,
              ge = w;
            if (A) {
              var me = 1,
                ve = 1;
              (1 === E ? (me = ve = 2) : 2 == E && (me = 2),
                (pe = x - me * k - me * I),
                (ge = w - ve * C - ve * R));
            }
            for (
              var ye = i ? ["A", "B", "C"][i] : "", Te = (s << 24) | (o << 16) | (l << 8) | u, be = 0, Se = 0;
              Se < 32;
              Se++
            )
              be = (be | (((Te >> Se) & 1) << (31 - Se))) >>> 0;
            var Ee = be.toString(16);
            return (
              1 === a && "2" === Ee && (Ee = "6"),
              {
                codecString: `hvc1.${ye}${a}.${Ee}.${n ? "H" : "L"}${m}.B0`,
                params: {
                  general_tier_flag: n,
                  general_profile_idc: a,
                  general_profile_space: i,
                  general_profile_compatibility_flags: [s, o, l, u],
                  general_constraint_indicator_flags: [d, h, c, f, p, g],
                  general_level_idc: m,
                  bit_depth: L + 8,
                  bit_depth_luma_minus8: L,
                  bit_depth_chroma_minus8: M,
                  min_spatial_segmentation_idc: Z,
                  chroma_format_idc: E,
                  frame_rate: { fixed: re, fps: ne / ie },
                },
                width: pe,
                height: ge,
                pixelRatio: [ee, te],
              }
            );
          }
          readPPS(e) {
            var t = new Vp(this.ebsp2rbsp(e));
            (t.readUByte(),
              t.readUByte(),
              t.skipUEG(),
              t.skipUEG(),
              t.skipBits(2),
              t.skipBits(3),
              t.skipBits(2),
              t.skipUEG(),
              t.skipUEG(),
              t.skipEG(),
              t.skipBits(2),
              t.readBoolean() && t.skipUEG(),
              t.skipEG(),
              t.skipEG(),
              t.skipBits(4));
            var r = t.readBoolean(),
              i = t.readBoolean(),
              n = 1;
            return (i && r ? (n = 0) : i ? (n = 3) : r && (n = 2), { parallelismType: n });
          }
          matchSPS(e, t) {
            return (
              String.fromCharCode.apply(null, e).substr(3) === String.fromCharCode.apply(null, t).substr(3)
            );
          }
        }
        var Wp = 188;
        class zp {
          constructor(e, t, r, i) {
            ((this.logger = void 0),
              (this.observer = void 0),
              (this.config = void 0),
              (this.typeSupported = void 0),
              (this.sampleAes = null),
              (this.pmtParsed = !1),
              (this.audioCodec = void 0),
              (this.videoCodec = void 0),
              (this._pmtId = -1),
              (this._videoTrack = void 0),
              (this._audioTrack = void 0),
              (this._id3Track = void 0),
              (this._txtTrack = void 0),
              (this.aacOverFlow = null),
              (this.remainderData = null),
              (this.videoParser = void 0),
              (this.observer = e),
              (this.config = t),
              (this.typeSupported = r),
              (this.logger = i),
              (this.videoParser = null));
          }
          static probe(e, t) {
            var r = zp.syncOffset(e);
            return (r > 0 && t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`), -1 !== r);
          }
          static syncOffset(e) {
            for (var t = e.length, r = Math.min(940, t - Wp) + 1, i = 0; i < r; ) {
              for (var n = !1, a = -1, s = 0, o = i; o < t; o += Wp) {
                if (71 !== e[o] || (t - o !== Wp && 71 !== e[o + Wp])) {
                  if (s) return -1;
                  break;
                }
                if (
                  (s++,
                  -1 === a && 0 !== (a = o) && (r = Math.min(a + 18612, e.length - Wp) + 1),
                  n || (n = 0 === qp(e, o)),
                  n && s > 1 && ((0 === a && s > 2) || o + Wp > r))
                )
                  return a;
              }
              i++;
            }
            return -1;
          }
          static createTrack(e, t) {
            return {
              container: "video" === e || "audio" === e ? "video/mp2t" : void 0,
              type: e,
              id: cd[e],
              pid: -1,
              inputTimeScale: 9e4,
              sequenceNumber: 0,
              samples: [],
              dropped: 0,
              duration: "audio" === e ? t : void 0,
            };
          }
          resetInitSegment(e, t, r, i) {
            ((this.pmtParsed = !1),
              (this._pmtId = -1),
              (this._videoTrack = zp.createTrack("video")),
              (this._videoTrack.duration = i),
              (this._audioTrack = zp.createTrack("audio", i)),
              (this._id3Track = zp.createTrack("id3")),
              (this._txtTrack = zp.createTrack("text")),
              (this._audioTrack.segmentCodec = "aac"),
              (this.videoParser = null),
              (this.aacOverFlow = null),
              (this.remainderData = null),
              (this.audioCodec = t),
              (this.videoCodec = r));
          }
          resetTimeStamp() {}
          resetContiguity() {
            var e = this._audioTrack,
              t = this._videoTrack,
              r = this._id3Track;
            (e && (e.pesData = null),
              t && (t.pesData = null),
              r && (r.pesData = null),
              (this.aacOverFlow = null),
              (this.remainderData = null));
          }
          demux(e, t, r = !1, i = !1) {
            var n;
            r || (this.sampleAes = null);
            var a = this._videoTrack,
              s = this._audioTrack,
              o = this._id3Track,
              l = this._txtTrack,
              u = a.pid,
              d = a.pesData,
              h = s.pid,
              c = o.pid,
              f = s.pesData,
              p = o.pesData,
              g = null,
              m = this.pmtParsed,
              v = this._pmtId,
              y = e.length;
            if (
              (this.remainderData &&
                ((y = (e = Rd(this.remainderData, e)).length), (this.remainderData = null)),
              y < Wp && !i)
            )
              return ((this.remainderData = e), { audioTrack: s, videoTrack: a, id3Track: o, textTrack: l });
            var T = Math.max(0, zp.syncOffset(e));
            (y -= (y - T) % Wp) < e.byteLength &&
              !i &&
              (this.remainderData = new Uint8Array(e.buffer, y, e.buffer.byteLength - y));
            for (var b = 0, S = T; S < y; S += Wp)
              if (71 === e[S]) {
                var E = !!(64 & e[S + 1]),
                  x = qp(e, S),
                  w = void 0;
                if ((48 & e[S + 3]) >> 4 > 1) {
                  if ((w = S + 5 + e[S + 4]) === S + Wp) continue;
                } else w = S + 4;
                switch (x) {
                  case u:
                    (E &&
                      (d &&
                        (n = Zp(d, this.logger)) &&
                        (this.readyVideoParser(a.segmentCodec),
                        null !== this.videoParser && this.videoParser.parsePES(a, l, n, !1)),
                      (d = { data: [], size: 0 })),
                      d && (d.data.push(e.subarray(w, S + Wp)), (d.size += S + Wp - w)));
                    break;
                  case h:
                    if (E) {
                      if (f && (n = Zp(f, this.logger)))
                        switch (s.segmentCodec) {
                          case "aac":
                            this.parseAACPES(s, n);
                            break;
                          case "mp3":
                            this.parseMPEGPES(s, n);
                            break;
                          case "ac3":
                            this.parseAC3PES(s, n);
                        }
                      f = { data: [], size: 0 };
                    }
                    f && (f.data.push(e.subarray(w, S + Wp)), (f.size += S + Wp - w));
                    break;
                  case c:
                    (E &&
                      (p && (n = Zp(p, this.logger)) && this.parseID3PES(o, n), (p = { data: [], size: 0 })),
                      p && (p.data.push(e.subarray(w, S + Wp)), (p.size += S + Wp - w)));
                    break;
                  case 0:
                    (E && (w += e[w] + 1), (v = this._pmtId = Xp(e, w)));
                    break;
                  case v:
                    E && (w += e[w] + 1);
                    var A = Yp(e, w, this.typeSupported, r, this.observer, this.logger);
                    ((u = A.videoPid) > 0 && ((a.pid = u), (a.segmentCodec = A.segmentVideoCodec)),
                      (h = A.audioPid) > 0 && ((s.pid = h), (s.segmentCodec = A.segmentAudioCodec)),
                      (c = A.id3Pid) > 0 && (o.pid = c),
                      null === g ||
                        m ||
                        (this.logger.warn(
                          `MPEG-TS PMT found at ${S} after unknown PID '${g}'. Backtracking to sync byte @${T} to parse all TS packets.`,
                        ),
                        (g = null),
                        (S = T - 188)),
                      (m = this.pmtParsed = !0));
                    break;
                  case 17:
                  case 8191:
                    break;
                  default:
                    g = x;
                }
              } else b++;
            (b > 0 &&
              Qp(
                this.observer,
                new Error(`Found ${b} TS packet/s that do not start with 0x47`),
                void 0,
                this.logger,
              ),
              (a.pesData = d),
              (s.pesData = f),
              (o.pesData = p));
            var I = { audioTrack: s, videoTrack: a, id3Track: o, textTrack: l };
            return (i && this.extractRemainingSamples(I), I);
          }
          flush() {
            var e,
              t = this.remainderData;
            return (
              (this.remainderData = null),
              (e = t
                ? this.demux(t, -1, !1, !0)
                : {
                    videoTrack: this._videoTrack,
                    audioTrack: this._audioTrack,
                    id3Track: this._id3Track,
                    textTrack: this._txtTrack,
                  }),
              this.extractRemainingSamples(e),
              this.sampleAes ? this.decrypt(e, this.sampleAes) : e
            );
          }
          extractRemainingSamples(e) {
            var t,
              r = e.audioTrack,
              i = e.videoTrack,
              n = e.id3Track,
              a = e.textTrack,
              s = i.pesData,
              o = r.pesData,
              l = n.pesData;
            if (
              (s && (t = Zp(s, this.logger))
                ? (this.readyVideoParser(i.segmentCodec),
                  null !== this.videoParser && (this.videoParser.parsePES(i, a, t, !0), (i.pesData = null)))
                : (i.pesData = s),
              o && (t = Zp(o, this.logger)))
            ) {
              switch (r.segmentCodec) {
                case "aac":
                  this.parseAACPES(r, t);
                  break;
                case "mp3":
                  this.parseMPEGPES(r, t);
                  break;
                case "ac3":
                  this.parseAC3PES(r, t);
              }
              r.pesData = null;
            } else
              (null != o &&
                o.size &&
                this.logger.log("last AAC PES packet truncated,might overlap between fragments"),
                (r.pesData = o));
            l && (t = Zp(l, this.logger)) ? (this.parseID3PES(n, t), (n.pesData = null)) : (n.pesData = l);
          }
          demuxSampleAes(e, t, r) {
            var i = this.demux(e, r, !0, !this.config.progressive),
              n = (this.sampleAes = new jp(this.observer, this.config, t));
            return this.decrypt(i, n);
          }
          readyVideoParser(e) {
            null === this.videoParser &&
              ("avc" === e ? (this.videoParser = new Hp()) : "hevc" === e && (this.videoParser = new Kp()));
          }
          decrypt(e, t) {
            return new Promise(r => {
              var i = e.audioTrack,
                n = e.videoTrack;
              i.samples && "aac" === i.segmentCodec
                ? t.decryptAacSamples(i.samples, 0, () => {
                    n.samples
                      ? t.decryptAvcSamples(n.samples, 0, 0, () => {
                          r(e);
                        })
                      : r(e);
                  })
                : n.samples &&
                  t.decryptAvcSamples(n.samples, 0, 0, () => {
                    r(e);
                  });
            });
          }
          destroy() {
            (this.observer && this.observer.removeAllListeners(),
              (this.config = this.logger = this.observer = null),
              (this.aacOverFlow = this.videoParser = this.remainderData = this.sampleAes = null),
              (this._videoTrack = this._audioTrack = this._id3Track = this._txtTrack = void 0));
          }
          parseAACPES(e, t) {
            var r,
              i,
              n,
              a = 0,
              s = this.aacOverFlow,
              o = t.data;
            if (s) {
              this.aacOverFlow = null;
              var l = s.missing,
                u = s.sample.unit.byteLength;
              if (-1 === l) o = Rd(s.sample.unit, o);
              else {
                var d = u - l;
                (s.sample.unit.set(o.subarray(0, l), d), e.samples.push(s.sample), (a = s.missing));
              }
            }
            for (r = a, i = o.length; r < i - 1 && !lp(o, r); r++);
            if (r !== a) {
              var h,
                c = r < i - 1;
              if (
                ((h = c
                  ? `AAC PES did not start with ADTS header,offset:${r}`
                  : "No ADTS header found in AAC PES"),
                Qp(this.observer, new Error(h), c, this.logger),
                !c)
              )
                return;
            }
            if ((dp(e, this.observer, o, r, this.audioCodec), void 0 !== t.pts)) n = t.pts;
            else {
              if (!s) return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");
              var f = hp(e.samplerate);
              n = s.sample.pts + f;
            }
            for (var p, g = 0; r < i; ) {
              if (((r += (p = cp(e, o, r, n, g)).length), p.missing)) {
                this.aacOverFlow = p;
                break;
              }
              for (g++; r < i - 1 && !lp(o, r); r++);
            }
          }
          parseMPEGPES(e, t) {
            var r = t.data,
              i = r.length,
              n = 0,
              a = 0,
              s = t.pts;
            if (void 0 !== s)
              for (; a < i; )
                if (Pp(r, a)) {
                  var o = Mp(e, r, a, s, n);
                  if (!o) break;
                  ((a += o.length), n++);
                } else a++;
            else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");
          }
          parseAC3PES(e, t) {
            var r = t.data,
              i = t.pts;
            if (void 0 !== i)
              for (var n, a = r.length, s = 0, o = 0; o < a && (n = Up(e, r, o, i, s++)) > 0; ) o += n;
            else this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");
          }
          parseID3PES(e, t) {
            if (void 0 !== t.pts) {
              var r = Nu({}, t, {
                type: this._videoTrack ? Ep.emsg : Ep.audioId3,
                duration: Number.POSITIVE_INFINITY,
              });
              e.samples.push(r);
            } else this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");
          }
        }
        function qp(e, t) {
          return ((31 & e[t + 1]) << 8) + e[t + 2];
        }
        function Xp(e, t) {
          return ((31 & e[t + 10]) << 8) | e[t + 11];
        }
        function Yp(e, t, r, i, n, a) {
          var s = {
              audioPid: -1,
              videoPid: -1,
              id3Pid: -1,
              segmentVideoCodec: "avc",
              segmentAudioCodec: "aac",
            },
            o = t + 3 + (((15 & e[t + 1]) << 8) | e[t + 2]) - 4;
          for (t += 12 + (((15 & e[t + 10]) << 8) | e[t + 11]); t < o; ) {
            var l = qp(e, t),
              u = ((15 & e[t + 3]) << 8) | e[t + 4];
            switch (e[t]) {
              case 207:
                if (!i) {
                  Jp("ADTS AAC", a);
                  break;
                }
              case 15:
                -1 === s.audioPid && (s.audioPid = l);
                break;
              case 21:
                -1 === s.id3Pid && (s.id3Pid = l);
                break;
              case 219:
                if (!i) {
                  Jp("H.264", a);
                  break;
                }
              case 27:
                -1 === s.videoPid && (s.videoPid = l);
                break;
              case 3:
              case 4:
                r.mpeg || r.mp3
                  ? -1 === s.audioPid && ((s.audioPid = l), (s.segmentAudioCodec = "mp3"))
                  : a.log("MPEG audio found, not supported in this browser");
                break;
              case 193:
                if (!i) {
                  Jp("AC-3", a);
                  break;
                }
              case 129:
                r.ac3
                  ? -1 === s.audioPid && ((s.audioPid = l), (s.segmentAudioCodec = "ac3"))
                  : a.log("AC-3 audio found, not supported in this browser");
                break;
              case 6:
                if (-1 === s.audioPid && u > 0)
                  for (var d = t + 5, h = u; h > 2; ) {
                    if (106 === e[d])
                      !0 !== r.ac3
                        ? a.log("AC-3 audio found, not supported in this browser for now")
                        : ((s.audioPid = l), (s.segmentAudioCodec = "ac3"));
                    var c = e[d + 1] + 2;
                    ((d += c), (h -= c));
                  }
                break;
              case 194:
              case 135:
                return (Qp(n, new Error("Unsupported EC-3 in M2TS found"), void 0, a), s);
              case 36:
                -1 === s.videoPid &&
                  ((s.videoPid = l), (s.segmentVideoCodec = "hevc"), a.log("HEVC in M2TS found"));
            }
            t += u + 5;
          }
          return s;
        }
        function Qp(e, t, r, i) {
          (i.warn(`parsing error: ${t.message}`),
            e.emit(Au.ERROR, Au.ERROR, {
              type: xu.MEDIA_ERROR,
              details: wu.FRAG_PARSING_ERROR,
              fatal: !1,
              levelRetry: r,
              error: t,
              reason: t.message,
            }));
        }
        function Jp(e, t) {
          t.log(`${e} with AES-128-CBC encryption found in unencrypted stream`);
        }
        function Zp(e, t) {
          var r,
            i,
            n,
            a,
            s,
            o = 0,
            l = e.data;
          if (!e || 0 === e.size) return null;
          for (; l[0].length < 19 && l.length > 1; ) ((l[0] = Rd(l[0], l[1])), l.splice(1, 1));
          if (1 === ((r = l[0])[0] << 16) + (r[1] << 8) + r[2]) {
            if ((i = (r[4] << 8) + r[5]) && i > e.size - 6) return null;
            var u = r[7];
            192 & u &&
              ((a =
                536870912 * (14 & r[9]) +
                4194304 * (255 & r[10]) +
                16384 * (254 & r[11]) +
                128 * (255 & r[12]) +
                (254 & r[13]) / 2),
              64 & u
                ? a -
                    (s =
                      536870912 * (14 & r[14]) +
                      4194304 * (255 & r[15]) +
                      16384 * (254 & r[16]) +
                      128 * (255 & r[17]) +
                      (254 & r[18]) / 2) >
                    54e5 &&
                  (t.warn(`${Math.round((a - s) / 9e4)}s delta between PTS and DTS, align them`), (a = s))
                : (s = a));
            var d = (n = r[8]) + 9;
            if (e.size <= d) return null;
            e.size -= d;
            for (var h = new Uint8Array(e.size), c = 0, f = l.length; c < f; c++) {
              var p = (r = l[c]).byteLength;
              if (d) {
                if (d > p) {
                  d -= p;
                  continue;
                }
                ((r = r.subarray(d)), (p -= d), (d = 0));
              }
              (h.set(r, o), (o += p));
            }
            return (i && (i -= n + 3), { data: h, pts: a, dts: s, len: i });
          }
          return null;
        }
        class eg {
          static getSilentFrame(e, t) {
            if ("mp4a.40.2" === e) {
              if (1 === t) return new Uint8Array([0, 200, 0, 128, 35, 128]);
              if (2 === t) return new Uint8Array([33, 0, 73, 144, 2, 25, 0, 35, 128]);
              if (3 === t) return new Uint8Array([0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 142]);
              if (4 === t)
                return new Uint8Array([
                  0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 128, 44, 128, 8, 2, 56,
                ]);
              if (5 === t)
                return new Uint8Array([
                  0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130, 48, 4, 153, 0, 33, 144, 2, 56,
                ]);
              if (6 === t)
                return new Uint8Array([
                  0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130, 48, 4, 153, 0, 33, 144, 2, 0, 178, 0,
                  32, 8, 224,
                ]);
            } else {
              if (1 === t)
                return new Uint8Array([
                  1, 64, 34, 128, 163, 78, 230, 128, 186, 8, 0, 0, 0, 28, 6, 241, 193, 10, 90, 90, 90, 90, 90,
                  90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                  90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94,
                ]);
              if (2 === t)
                return new Uint8Array([
                  1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0, 149, 0, 6, 241, 161, 10, 90, 90, 90,
                  90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                  90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94,
                ]);
              if (3 === t)
                return new Uint8Array([
                  1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0, 149, 0, 6, 241, 161, 10, 90, 90, 90,
                  90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                  90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94,
                ]);
            }
          }
        }
        var tg = Math.pow(2, 32) - 1;
        class rg {
          static init() {
            var e;
            for (e in ((rg.types = {
              avc1: [],
              avcC: [],
              hvc1: [],
              hvcC: [],
              btrt: [],
              dinf: [],
              dref: [],
              esds: [],
              ftyp: [],
              hdlr: [],
              mdat: [],
              mdhd: [],
              mdia: [],
              mfhd: [],
              minf: [],
              moof: [],
              moov: [],
              mp4a: [],
              ".mp3": [],
              dac3: [],
              "ac-3": [],
              mvex: [],
              mvhd: [],
              pasp: [],
              sdtp: [],
              stbl: [],
              stco: [],
              stsc: [],
              stsd: [],
              stsz: [],
              stts: [],
              tfdt: [],
              tfhd: [],
              traf: [],
              trak: [],
              trun: [],
              trex: [],
              tkhd: [],
              vmhd: [],
              smhd: [],
            }),
            rg.types))
              rg.types.hasOwnProperty(e) &&
                (rg.types[e] = [e.charCodeAt(0), e.charCodeAt(1), e.charCodeAt(2), e.charCodeAt(3)]);
            var t = new Uint8Array([
                0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100,
                101, 111, 72, 97, 110, 100, 108, 101, 114, 0,
              ]),
              r = new Uint8Array([
                0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117,
                110, 100, 72, 97, 110, 100, 108, 101, 114, 0,
              ]);
            rg.HDLR_TYPES = { video: t, audio: r };
            var i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1]),
              n = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
            ((rg.STTS = rg.STSC = rg.STCO = n),
              (rg.STSZ = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])),
              (rg.VMHD = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0])),
              (rg.SMHD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0])),
              (rg.STSD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1])));
            var a = new Uint8Array([105, 115, 111, 109]),
              s = new Uint8Array([97, 118, 99, 49]),
              o = new Uint8Array([0, 0, 0, 1]);
            ((rg.FTYP = rg.box(rg.types.ftyp, a, o, a, s)),
              (rg.DINF = rg.box(rg.types.dinf, rg.box(rg.types.dref, i))));
          }
          static box(e, ...t) {
            for (var r = 8, i = t.length, n = i; i--; ) r += t[i].byteLength;
            var a = new Uint8Array(r);
            for (
              a[0] = (r >> 24) & 255,
                a[1] = (r >> 16) & 255,
                a[2] = (r >> 8) & 255,
                a[3] = 255 & r,
                a.set(e, 4),
                i = 0,
                r = 8;
              i < n;
              i++
            )
              (a.set(t[i], r), (r += t[i].byteLength));
            return a;
          }
          static hdlr(e) {
            return rg.box(rg.types.hdlr, rg.HDLR_TYPES[e]);
          }
          static mdat(e) {
            return rg.box(rg.types.mdat, e);
          }
          static mdhd(e, t) {
            t *= e;
            var r = Math.floor(t / (tg + 1)),
              i = Math.floor(t % (tg + 1));
            return rg.box(
              rg.types.mdhd,
              new Uint8Array([
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                3,
                (e >> 24) & 255,
                (e >> 16) & 255,
                (e >> 8) & 255,
                255 & e,
                r >> 24,
                (r >> 16) & 255,
                (r >> 8) & 255,
                255 & r,
                i >> 24,
                (i >> 16) & 255,
                (i >> 8) & 255,
                255 & i,
                85,
                196,
                0,
                0,
              ]),
            );
          }
          static mdia(e) {
            return rg.box(
              rg.types.mdia,
              rg.mdhd(e.timescale || 0, e.duration || 0),
              rg.hdlr(e.type),
              rg.minf(e),
            );
          }
          static mfhd(e) {
            return rg.box(
              rg.types.mfhd,
              new Uint8Array([0, 0, 0, 0, e >> 24, (e >> 16) & 255, (e >> 8) & 255, 255 & e]),
            );
          }
          static minf(e) {
            return "audio" === e.type
              ? rg.box(rg.types.minf, rg.box(rg.types.smhd, rg.SMHD), rg.DINF, rg.stbl(e))
              : rg.box(rg.types.minf, rg.box(rg.types.vmhd, rg.VMHD), rg.DINF, rg.stbl(e));
          }
          static moof(e, t, r) {
            return rg.box(rg.types.moof, rg.mfhd(e), rg.traf(r, t));
          }
          static moov(e) {
            for (var t = e.length, r = []; t--; ) r[t] = rg.trak(e[t]);
            return rg.box.apply(
              null,
              [rg.types.moov, rg.mvhd(e[0].timescale || 0, e[0].duration || 0)].concat(r).concat(rg.mvex(e)),
            );
          }
          static mvex(e) {
            for (var t = e.length, r = []; t--; ) r[t] = rg.trex(e[t]);
            return rg.box.apply(null, [rg.types.mvex, ...r]);
          }
          static mvhd(e, t) {
            t *= e;
            var r = Math.floor(t / (tg + 1)),
              i = Math.floor(t % (tg + 1)),
              n = new Uint8Array([
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                3,
                (e >> 24) & 255,
                (e >> 16) & 255,
                (e >> 8) & 255,
                255 & e,
                r >> 24,
                (r >> 16) & 255,
                (r >> 8) & 255,
                255 & r,
                i >> 24,
                (i >> 16) & 255,
                (i >> 8) & 255,
                255 & i,
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                64,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                255,
                255,
                255,
                255,
              ]);
            return rg.box(rg.types.mvhd, n);
          }
          static sdtp(e) {
            var t,
              r,
              i = e.samples || [],
              n = new Uint8Array(4 + i.length);
            for (t = 0; t < i.length; t++)
              ((r = i[t].flags), (n[t + 4] = (r.dependsOn << 4) | (r.isDependedOn << 2) | r.hasRedundancy));
            return rg.box(rg.types.sdtp, n);
          }
          static stbl(e) {
            return rg.box(
              rg.types.stbl,
              rg.stsd(e),
              rg.box(rg.types.stts, rg.STTS),
              rg.box(rg.types.stsc, rg.STSC),
              rg.box(rg.types.stsz, rg.STSZ),
              rg.box(rg.types.stco, rg.STCO),
            );
          }
          static avc1(e) {
            var t,
              r,
              i,
              n = [],
              a = [];
            for (t = 0; t < e.sps.length; t++)
              ((i = (r = e.sps[t]).byteLength),
                n.push((i >>> 8) & 255),
                n.push(255 & i),
                (n = n.concat(Array.prototype.slice.call(r))));
            for (t = 0; t < e.pps.length; t++)
              ((i = (r = e.pps[t]).byteLength),
                a.push((i >>> 8) & 255),
                a.push(255 & i),
                (a = a.concat(Array.prototype.slice.call(r))));
            var s = rg.box(
                rg.types.avcC,
                new Uint8Array(
                  [1, n[3], n[4], n[5], 255, 224 | e.sps.length].concat(n).concat([e.pps.length]).concat(a),
                ),
              ),
              o = e.width,
              l = e.height,
              u = e.pixelRatio[0],
              d = e.pixelRatio[1];
            return rg.box(
              rg.types.avc1,
              new Uint8Array([
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                (o >> 8) & 255,
                255 & o,
                (l >> 8) & 255,
                255 & l,
                0,
                72,
                0,
                0,
                0,
                72,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                18,
                100,
                97,
                105,
                108,
                121,
                109,
                111,
                116,
                105,
                111,
                110,
                47,
                104,
                108,
                115,
                46,
                106,
                115,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                24,
                17,
                17,
              ]),
              s,
              rg.box(rg.types.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192])),
              rg.box(
                rg.types.pasp,
                new Uint8Array([
                  u >> 24,
                  (u >> 16) & 255,
                  (u >> 8) & 255,
                  255 & u,
                  d >> 24,
                  (d >> 16) & 255,
                  (d >> 8) & 255,
                  255 & d,
                ]),
              ),
            );
          }
          static esds(e) {
            var t = e.config;
            return new Uint8Array([
              0,
              0,
              0,
              0,
              3,
              25,
              0,
              1,
              0,
              4,
              17,
              64,
              21,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              5,
              2,
              ...t,
              6,
              1,
              2,
            ]);
          }
          static audioStsd(e) {
            var t = e.samplerate || 0;
            return new Uint8Array([
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              1,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              e.channelCount || 0,
              0,
              16,
              0,
              0,
              0,
              0,
              (t >> 8) & 255,
              255 & t,
              0,
              0,
            ]);
          }
          static mp4a(e) {
            return rg.box(rg.types.mp4a, rg.audioStsd(e), rg.box(rg.types.esds, rg.esds(e)));
          }
          static mp3(e) {
            return rg.box(rg.types[".mp3"], rg.audioStsd(e));
          }
          static ac3(e) {
            return rg.box(rg.types["ac-3"], rg.audioStsd(e), rg.box(rg.types.dac3, e.config));
          }
          static stsd(e) {
            var t = e.segmentCodec;
            if ("audio" === e.type) {
              if ("aac" === t) return rg.box(rg.types.stsd, rg.STSD, rg.mp4a(e));
              if ("ac3" === t && e.config) return rg.box(rg.types.stsd, rg.STSD, rg.ac3(e));
              if ("mp3" === t && "mp3" === e.codec) return rg.box(rg.types.stsd, rg.STSD, rg.mp3(e));
            } else {
              if (!e.pps || !e.sps) throw new Error("video track missing pps or sps");
              if ("avc" === t) return rg.box(rg.types.stsd, rg.STSD, rg.avc1(e));
              if ("hevc" === t && e.vps) return rg.box(rg.types.stsd, rg.STSD, rg.hvc1(e));
            }
            throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`);
          }
          static tkhd(e) {
            var t = e.id,
              r = (e.duration || 0) * (e.timescale || 0),
              i = e.width || 0,
              n = e.height || 0,
              a = Math.floor(r / (tg + 1)),
              s = Math.floor(r % (tg + 1));
            return rg.box(
              rg.types.tkhd,
              new Uint8Array([
                1,
                0,
                0,
                7,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                3,
                (t >> 24) & 255,
                (t >> 16) & 255,
                (t >> 8) & 255,
                255 & t,
                0,
                0,
                0,
                0,
                a >> 24,
                (a >> 16) & 255,
                (a >> 8) & 255,
                255 & a,
                s >> 24,
                (s >> 16) & 255,
                (s >> 8) & 255,
                255 & s,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                64,
                0,
                0,
                0,
                (i >> 8) & 255,
                255 & i,
                0,
                0,
                (n >> 8) & 255,
                255 & n,
                0,
                0,
              ]),
            );
          }
          static traf(e, t) {
            var r = rg.sdtp(e),
              i = e.id,
              n = Math.floor(t / (tg + 1)),
              a = Math.floor(t % (tg + 1));
            return rg.box(
              rg.types.traf,
              rg.box(
                rg.types.tfhd,
                new Uint8Array([0, 0, 0, 0, i >> 24, (i >> 16) & 255, (i >> 8) & 255, 255 & i]),
              ),
              rg.box(
                rg.types.tfdt,
                new Uint8Array([
                  1,
                  0,
                  0,
                  0,
                  n >> 24,
                  (n >> 16) & 255,
                  (n >> 8) & 255,
                  255 & n,
                  a >> 24,
                  (a >> 16) & 255,
                  (a >> 8) & 255,
                  255 & a,
                ]),
              ),
              rg.trun(e, r.length + 16 + 20 + 8 + 16 + 8 + 8),
              r,
            );
          }
          static trak(e) {
            return ((e.duration = e.duration || 4294967295), rg.box(rg.types.trak, rg.tkhd(e), rg.mdia(e)));
          }
          static trex(e) {
            var t = e.id;
            return rg.box(
              rg.types.trex,
              new Uint8Array([
                0,
                0,
                0,
                0,
                t >> 24,
                (t >> 16) & 255,
                (t >> 8) & 255,
                255 & t,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                1,
              ]),
            );
          }
          static trun(e, t) {
            var r,
              i,
              n,
              a,
              s,
              o,
              l = e.samples || [],
              u = l.length,
              d = 12 + 16 * u,
              h = new Uint8Array(d);
            for (
              t += 8 + d,
                h.set(
                  [
                    "video" === e.type ? 1 : 0,
                    0,
                    15,
                    1,
                    (u >>> 24) & 255,
                    (u >>> 16) & 255,
                    (u >>> 8) & 255,
                    255 & u,
                    (t >>> 24) & 255,
                    (t >>> 16) & 255,
                    (t >>> 8) & 255,
                    255 & t,
                  ],
                  0,
                ),
                r = 0;
              r < u;
              r++
            )
              ((n = (i = l[r]).duration),
                (a = i.size),
                (s = i.flags),
                (o = i.cts),
                h.set(
                  [
                    (n >>> 24) & 255,
                    (n >>> 16) & 255,
                    (n >>> 8) & 255,
                    255 & n,
                    (a >>> 24) & 255,
                    (a >>> 16) & 255,
                    (a >>> 8) & 255,
                    255 & a,
                    (s.isLeading << 2) | s.dependsOn,
                    (s.isDependedOn << 6) | (s.hasRedundancy << 4) | (s.paddingValue << 1) | s.isNonSync,
                    61440 & s.degradPrio,
                    15 & s.degradPrio,
                    (o >>> 24) & 255,
                    (o >>> 16) & 255,
                    (o >>> 8) & 255,
                    255 & o,
                  ],
                  12 + 16 * r,
                ));
            return rg.box(rg.types.trun, h);
          }
          static initSegment(e) {
            rg.types || rg.init();
            var t = rg.moov(e);
            return Rd(rg.FTYP, t);
          }
          static hvc1(e) {
            for (
              var t = e.params,
                r = [e.vps, e.sps, e.pps],
                i = new Uint8Array([
                  1,
                  (t.general_profile_space << 6) | (t.general_tier_flag ? 32 : 0) | t.general_profile_idc,
                  t.general_profile_compatibility_flags[0],
                  t.general_profile_compatibility_flags[1],
                  t.general_profile_compatibility_flags[2],
                  t.general_profile_compatibility_flags[3],
                  t.general_constraint_indicator_flags[0],
                  t.general_constraint_indicator_flags[1],
                  t.general_constraint_indicator_flags[2],
                  t.general_constraint_indicator_flags[3],
                  t.general_constraint_indicator_flags[4],
                  t.general_constraint_indicator_flags[5],
                  t.general_level_idc,
                  240 | (t.min_spatial_segmentation_idc >> 8),
                  255 & t.min_spatial_segmentation_idc,
                  252 | t.parallelismType,
                  252 | t.chroma_format_idc,
                  248 | t.bit_depth_luma_minus8,
                  248 | t.bit_depth_chroma_minus8,
                  0,
                  parseInt(t.frame_rate.fps),
                  3 |
                    (t.temporal_id_nested << 2) |
                    (t.num_temporal_layers << 3) |
                    (t.frame_rate.fixed ? 64 : 0),
                  r.length,
                ]),
                n = i.length,
                a = 0;
              a < r.length;
              a += 1
            ) {
              n += 3;
              for (var s = 0; s < r[a].length; s += 1) n += 2 + r[a][s].length;
            }
            var o = new Uint8Array(n);
            (o.set(i, 0), (n = i.length));
            for (var l = r.length - 1, u = 0; u < r.length; u += 1) {
              (o.set(new Uint8Array([(32 + u) | (u === l ? 128 : 0), 0, r[u].length]), n), (n += 3));
              for (var d = 0; d < r[u].length; d += 1)
                (o.set(new Uint8Array([r[u][d].length >> 8, 255 & r[u][d].length]), n),
                  (n += 2),
                  o.set(r[u][d], n),
                  (n += r[u][d].length));
            }
            var h = rg.box(rg.types.hvcC, o),
              c = e.width,
              f = e.height,
              p = e.pixelRatio[0],
              g = e.pixelRatio[1];
            return rg.box(
              rg.types.hvc1,
              new Uint8Array([
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                (c >> 8) & 255,
                255 & c,
                (f >> 8) & 255,
                255 & f,
                0,
                72,
                0,
                0,
                0,
                72,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                18,
                100,
                97,
                105,
                108,
                121,
                109,
                111,
                116,
                105,
                111,
                110,
                47,
                104,
                108,
                115,
                46,
                106,
                115,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                24,
                17,
                17,
              ]),
              h,
              rg.box(rg.types.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192])),
              rg.box(
                rg.types.pasp,
                new Uint8Array([
                  p >> 24,
                  (p >> 16) & 255,
                  (p >> 8) & 255,
                  255 & p,
                  g >> 24,
                  (g >> 16) & 255,
                  (g >> 8) & 255,
                  255 & g,
                ]),
              ),
            );
          }
        }
        ((rg.types = void 0),
          (rg.HDLR_TYPES = void 0),
          (rg.STTS = void 0),
          (rg.STSC = void 0),
          (rg.STCO = void 0),
          (rg.STSZ = void 0),
          (rg.VMHD = void 0),
          (rg.SMHD = void 0),
          (rg.STSD = void 0),
          (rg.FTYP = void 0),
          (rg.DINF = void 0));
        function ig(e, t, r = 1, i = !1) {
          var n = e * t * r;
          return i ? Math.round(n) : n;
        }
        function ng(e, t = !1) {
          return ig(e, 1e3, 1 / 9e4, t);
        }
        function ag(e) {
          var t = e.baseTime,
            r = e.timescale;
          return `${t / r} (${t}/${r}) trackId: ${e.trackId}`;
        }
        var sg,
          og = null,
          lg = null;
        function ug(e, t, r, i) {
          return {
            duration: t,
            size: r,
            cts: i,
            flags: {
              isLeading: 0,
              isDependedOn: 0,
              hasRedundancy: 0,
              degradPrio: 0,
              dependsOn: e ? 2 : 1,
              isNonSync: e ? 0 : 1,
            },
          };
        }
        class dg extends Bu {
          constructor(e, t, r, i) {
            if (
              (super("mp4-remuxer", i),
              (this.observer = void 0),
              (this.config = void 0),
              (this.typeSupported = void 0),
              (this.ISGenerated = !1),
              (this._initPTS = null),
              (this._initDTS = null),
              (this.nextVideoTs = null),
              (this.nextAudioTs = null),
              (this.videoSampleDuration = null),
              (this.isAudioContiguous = !1),
              (this.isVideoContiguous = !1),
              (this.videoTrackConfig = void 0),
              (this.observer = e),
              (this.config = t),
              (this.typeSupported = r),
              (this.ISGenerated = !1),
              null === og)
            ) {
              var n = (navigator.userAgent || "").match(/Chrome\/(\d+)/i);
              og = n ? parseInt(n[1]) : 0;
            }
            if (null === lg) {
              var a = navigator.userAgent.match(/Safari\/(\d+)/i);
              lg = a ? parseInt(a[1]) : 0;
            }
          }
          destroy() {
            this.config = this.videoTrackConfig = this._initPTS = this._initDTS = null;
          }
          resetTimeStamp(e) {
            var t = this._initPTS;
            ((t &&
              e &&
              e.trackId === t.trackId &&
              e.baseTime === t.baseTime &&
              e.timescale === t.timescale) ||
              this.log(`Reset initPTS: ${t ? ag(t) : t} > ${e ? ag(e) : e}`),
              (this._initPTS = this._initDTS = e));
          }
          resetNextTimestamp() {
            (this.log("reset next timestamp"), (this.isVideoContiguous = !1), (this.isAudioContiguous = !1));
          }
          resetInitSegment() {
            (this.log("ISGenerated flag reset"), (this.ISGenerated = !1), (this.videoTrackConfig = void 0));
          }
          getVideoStartPts(e) {
            var t = !1,
              r = e[0].pts,
              i = e.reduce((e, i) => {
                var n = i.pts,
                  a = n - e;
                return (a < -4294967296 && ((t = !0), (a = (n = hg(n, r)) - e)), a > 0 ? e : n);
              }, r);
            return (t && this.debug("PTS rollover detected"), i);
          }
          remux(e, t, r, i, n, a, s, o) {
            var l,
              u,
              d,
              h,
              c,
              f,
              p = n,
              g = n,
              m = e.pid > -1,
              v = t.pid > -1,
              y = t.samples.length,
              T = e.samples.length > 0,
              b = (s && y > 0) || y > 1;
            if (((!m || T) && (!v || b)) || this.ISGenerated || s) {
              if (this.ISGenerated) {
                var S,
                  E,
                  x,
                  w,
                  A = this.videoTrackConfig;
                ((A &&
                  (t.width !== A.width ||
                    t.height !== A.height ||
                    (null == (S = t.pixelRatio) ? void 0 : S[0]) !==
                      (null == (E = A.pixelRatio) ? void 0 : E[0]) ||
                    (null == (x = t.pixelRatio) ? void 0 : x[1]) !==
                      (null == (w = A.pixelRatio) ? void 0 : w[1]))) ||
                  (!A && b) ||
                  (null === this.nextAudioTs && T)) &&
                  this.resetInitSegment();
              }
              this.ISGenerated || (d = this.generateIS(e, t, n, a));
              var I,
                k = this.isVideoContiguous,
                R = -1;
              if (
                b &&
                ((R = (function (e) {
                  for (var t = 0; t < e.length; t++) if (e[t].key) return t;
                  return -1;
                })(t.samples)),
                !k && this.config.forceKeyFrameOnDiscontinuity)
              )
                if (((f = !0), R > 0)) {
                  this.warn(`Dropped ${R} out of ${y} video samples due to a missing keyframe`);
                  var C = this.getVideoStartPts(t.samples);
                  ((t.samples = t.samples.slice(R)),
                    (t.dropped += R),
                    (I = g += (t.samples[0].pts - C) / t.inputTimeScale));
                } else -1 === R && (this.warn(`No keyframe found out of ${y} video samples`), (f = !1));
              if (this.ISGenerated) {
                if (T && b) {
                  var L = this.getVideoStartPts(t.samples),
                    M = (hg(e.samples[0].pts, L) - L) / t.inputTimeScale;
                  ((p += Math.max(0, M)), (g += Math.max(0, -M)));
                }
                if (T) {
                  if (
                    (e.samplerate ||
                      (this.warn("regenerate InitSegment as audio detected"),
                      (d = this.generateIS(e, t, n, a))),
                    (u = this.remuxAudio(e, p, this.isAudioContiguous, a, v || b || o === Mu ? g : void 0)),
                    b)
                  ) {
                    var D = u ? u.endPTS - u.startPTS : 0;
                    (t.inputTimeScale ||
                      (this.warn("regenerate InitSegment as video detected"),
                      (d = this.generateIS(e, t, n, a))),
                      (l = this.remuxVideo(t, g, k, D)));
                  }
                } else b && (l = this.remuxVideo(t, g, k, 0));
                l && ((l.firstKeyFrame = R), (l.independent = -1 !== R), (l.firstKeyFramePTS = I));
              }
            }
            return (
              this.ISGenerated &&
                this._initPTS &&
                this._initDTS &&
                (r.samples.length && (c = cg(r, n, this._initPTS, this._initDTS)),
                i.samples.length && (h = fg(i, n, this._initPTS))),
              { audio: u, video: l, initSegment: d, independent: f, text: h, id3: c }
            );
          }
          computeInitPts(e, t, r, i) {
            var n = Math.round(r * t),
              a = hg(e, n);
            if (a < n + t)
              for (this.log(`Adjusting PTS for rollover in timeline near ${(n - a) / t} ${i}`); a < n + t; )
                a += 8589934592;
            return a - n;
          }
          generateIS(e, t, r, i) {
            var n,
              a,
              s,
              o = e.samples,
              l = t.samples,
              u = this.typeSupported,
              d = {},
              h = this._initPTS,
              c = !h || i,
              f = "audio/mp4",
              p = -1;
            if ((c && (n = a = 1 / 0), e.config && o.length)) {
              switch (((e.timescale = e.samplerate), e.segmentCodec)) {
                case "mp3":
                  u.mpeg ? ((f = "audio/mpeg"), (e.codec = "")) : u.mp3 && (e.codec = "mp3");
                  break;
                case "ac3":
                  e.codec = "ac-3";
              }
              ((d.audio = {
                id: "audio",
                container: f,
                codec: e.codec,
                initSegment: "mp3" === e.segmentCodec && u.mpeg ? new Uint8Array(0) : rg.initSegment([e]),
                metadata: { channelCount: e.channelCount },
              }),
                c &&
                  ((p = e.id),
                  (s = e.inputTimeScale),
                  h && s === h.timescale
                    ? (c = !1)
                    : (n = a = this.computeInitPts(o[0].pts, s, r, "audio"))));
            }
            if (t.sps && t.pps && l.length) {
              if (
                ((t.timescale = t.inputTimeScale),
                (d.video = {
                  id: "main",
                  container: "video/mp4",
                  codec: t.codec,
                  initSegment: rg.initSegment([t]),
                  metadata: { width: t.width, height: t.height },
                }),
                c)
              )
                if (((p = t.id), (s = t.inputTimeScale), h && s === h.timescale)) c = !1;
                else {
                  var g = this.getVideoStartPts(l),
                    m = hg(l[0].dts, g),
                    v = this.computeInitPts(m, s, r, "video"),
                    y = this.computeInitPts(g, s, r, "video");
                  ((a = Math.min(a, v)), (n = Math.min(n, y)));
                }
              this.videoTrackConfig = { width: t.width, height: t.height, pixelRatio: t.pixelRatio };
            }
            if (Object.keys(d).length)
              return (
                (this.ISGenerated = !0),
                c
                  ? (h &&
                      this.warn(
                        `Timestamps at playlist time: ${i ? "" : "~"}${r} ${n / s} != initPTS: ${h.baseTime / h.timescale} (${h.baseTime}/${h.timescale}) trackId: ${h.trackId}`,
                      ),
                    this.log(
                      `Found initPTS at playlist time: ${r} offset: ${n / s} (${n}/${s}) trackId: ${p}`,
                    ),
                    (this._initPTS = { baseTime: n, timescale: s, trackId: p }),
                    (this._initDTS = { baseTime: a, timescale: s, trackId: p }))
                  : (n = s = void 0),
                { tracks: d, initPTS: n, timescale: s, trackId: p }
              );
          }
          remuxVideo(e, t, r, i) {
            var n,
              a,
              s = e.inputTimeScale,
              o = e.samples,
              l = [],
              u = o.length,
              d = this._initPTS,
              h = (d.baseTime * s) / d.timescale,
              c = this.nextVideoTs,
              f = 8,
              p = this.videoSampleDuration,
              g = Number.POSITIVE_INFINITY,
              m = Number.NEGATIVE_INFINITY,
              v = !1;
            if (!r || null === c) {
              var y = h + t * s,
                T = o[0].pts - hg(o[0].dts, o[0].pts);
              og && null !== c && Math.abs(y - T - (c + h)) < 15e3 ? (r = !0) : (c = y - T - h);
            }
            for (var b = c + h, S = 0; S < u; S++) {
              var E = o[S];
              ((E.pts = hg(E.pts, b)), (E.dts = hg(E.dts, b)), E.dts < o[S > 0 ? S - 1 : S].dts && (v = !0));
            }
            (v &&
              o.sort(function (e, t) {
                var r = e.dts - t.dts,
                  i = e.pts - t.pts;
                return r || i;
              }),
              (n = o[0].dts));
            var x = (a = o[o.length - 1].dts) - n,
              w = x ? Math.round(x / (u - 1)) : p || e.inputTimeScale / 30;
            if (r) {
              var A = n - b,
                I = A > w,
                k = A < -1;
              if (
                (I || k) &&
                (I
                  ? this.warn(
                      `${(e.segmentCodec || "").toUpperCase()}: ${ng(A, !0)} ms (${A}dts) hole between fragments detected at ${t.toFixed(3)}`,
                    )
                  : this.warn(
                      `${(e.segmentCodec || "").toUpperCase()}: ${ng(-A, !0)} ms (${A}dts) overlapping between fragments detected at ${t.toFixed(3)}`,
                    ),
                !k || b >= o[0].pts || og)
              ) {
                n = b;
                var R = o[0].pts - A;
                if (I) ((o[0].dts = n), (o[0].pts = R));
                else
                  for (var C = !0, L = 0; L < o.length && !(o[L].dts > R && C); L++) {
                    var M = o[L].pts;
                    if (((o[L].dts -= A), (o[L].pts -= A), L < o.length - 1)) {
                      var D = o[L + 1].pts;
                      C = D <= o[L].pts == D <= M;
                    }
                  }
                this.log(
                  `Video: Initial PTS/DTS adjusted: ${ng(R, !0)}/${ng(n, !0)}, delta: ${ng(A, !0)} ms`,
                );
              }
            }
            for (var _ = 0, P = 0, O = (n = Math.max(0, n)), N = 0; N < u; N++) {
              for (var F = o[N], U = F.units, B = U.length, $ = 0, j = 0; j < B; j++) $ += U[j].data.length;
              ((P += $),
                (_ += B),
                (F.length = $),
                F.dts < O ? ((F.dts = O), (O += (w / 4) | 0 || 1)) : (O = F.dts),
                (g = Math.min(F.pts, g)),
                (m = Math.max(F.pts, m)));
            }
            a = o[u - 1].dts;
            var G,
              V = P + 4 * _ + 8;
            try {
              G = new Uint8Array(V);
            } catch (be) {
              return void this.observer.emit(Au.ERROR, Au.ERROR, {
                type: xu.MUX_ERROR,
                details: wu.REMUX_ALLOC_ERROR,
                fatal: !1,
                error: be,
                bytes: V,
                reason: `fail allocating video mdat ${V}`,
              });
            }
            var H = new DataView(G.buffer);
            (H.setUint32(0, V), G.set(rg.types.mdat, 4));
            for (
              var K = !1,
                W = Number.POSITIVE_INFINITY,
                z = Number.POSITIVE_INFINITY,
                q = Number.NEGATIVE_INFINITY,
                X = Number.NEGATIVE_INFINITY,
                Y = 0;
              Y < u;
              Y++
            ) {
              for (var Q = o[Y], J = Q.units, Z = 0, ee = 0, te = J.length; ee < te; ee++) {
                var re = J[ee],
                  ie = re.data,
                  ne = re.data.byteLength;
                (H.setUint32(f, ne), (f += 4), G.set(ie, f), (f += ne), (Z += 4 + ne));
              }
              var ae = void 0;
              if (Y < u - 1) ((p = o[Y + 1].dts - Q.dts), (ae = o[Y + 1].pts - Q.pts));
              else {
                var se = this.config,
                  oe = Y > 0 ? Q.dts - o[Y - 1].dts : w;
                if (
                  ((ae = Y > 0 ? Q.pts - o[Y - 1].pts : w),
                  se.stretchShortVideoTrack && null !== this.nextAudioTs)
                ) {
                  var le = Math.floor(se.maxBufferHole * s),
                    ue = (i ? g + i * s : this.nextAudioTs + h) - Q.pts;
                  ue > le
                    ? ((p = ue - oe) < 0 ? (p = oe) : (K = !0),
                      this.log(
                        `It is approximately ${ue / 90} ms to the next segment; using duration ${p / 90} ms for the last video frame.`,
                      ))
                    : (p = oe);
                } else p = oe;
              }
              var de = Math.round(Q.pts - Q.dts);
              ((W = Math.min(W, p)),
                (q = Math.max(q, p)),
                (z = Math.min(z, ae)),
                (X = Math.max(X, ae)),
                l.push(ug(Q.key, p, Z, de)));
            }
            if (l.length)
              if (og) {
                if (og < 70) {
                  var he = l[0].flags;
                  ((he.dependsOn = 2), (he.isNonSync = 0));
                }
              } else if (lg && X - z < q - W && w / q < 0.025 && 0 === l[0].cts) {
                this.warn(
                  "Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.",
                );
                for (var ce = n, fe = 0, pe = l.length; fe < pe; fe++) {
                  var ge = ce + l[fe].duration,
                    me = ce + l[fe].cts;
                  if (fe < pe - 1) {
                    var ve = ge + l[fe + 1].cts;
                    l[fe].duration = ve - me;
                  } else l[fe].duration = fe ? l[fe - 1].duration : w;
                  ((l[fe].cts = 0), (ce = ge));
                }
              }
            var ye = a + (p = K || !p ? w : p);
            ((this.nextVideoTs = c = ye - h), (this.videoSampleDuration = p), (this.isVideoContiguous = !0));
            var Te = {
              data1: rg.moof(e.sequenceNumber++, n, Nu(e, { samples: l })),
              data2: G,
              startPTS: (g - h) / s,
              endPTS: (m + p - h) / s,
              startDTS: (n - h) / s,
              endDTS: c / s,
              type: "video",
              hasAudio: !1,
              hasVideo: !0,
              nb: l.length,
              dropped: e.dropped,
            };
            return ((e.samples = []), (e.dropped = 0), Te);
          }
          getSamplesPerFrame(e) {
            switch (e.segmentCodec) {
              case "mp3":
                return 1152;
              case "ac3":
                return 1536;
              default:
                return 1024;
            }
          }
          remuxAudio(e, t, r, i, n) {
            var a = e.inputTimeScale,
              s = a / (e.samplerate ? e.samplerate : a),
              o = this.getSamplesPerFrame(e),
              l = o * s,
              u = this._initPTS,
              d = "mp3" === e.segmentCodec && this.typeSupported.mpeg,
              h = [],
              c = void 0 !== n,
              f = e.samples,
              p = d ? 0 : 8,
              g = this.nextAudioTs || -1,
              m = (u.baseTime * a) / u.timescale,
              v = m + t * a;
            if (
              ((this.isAudioContiguous = r =
                r ||
                (f.length &&
                  g > 0 &&
                  ((i && Math.abs(v - (g + m)) < 9e3) || Math.abs(hg(f[0].pts, v) - (g + m)) < 20 * l))),
              f.forEach(function (e) {
                e.pts = hg(e.pts, v);
              }),
              !r || g < 0)
            ) {
              var y = f.length;
              if (
                ((f = f.filter(e => e.pts >= 0)),
                y !== f.length && this.warn(`Removed ${f.length - y} of ${y} samples (initPTS ${m} / ${a})`),
                !f.length)
              )
                return;
              g = 0 === n ? 0 : i && !c ? Math.max(0, v - m) : f[0].pts - m;
            }
            if ("aac" === e.segmentCodec)
              for (var T = this.config.maxAudioFramesDrift, b = 0, S = g + m; b < f.length; b++) {
                var E = f[b],
                  x = E.pts,
                  w = x - S,
                  A = Math.abs((1e3 * w) / a);
                if (w <= -T * l && c)
                  0 === b &&
                    (this.warn(
                      `Audio frame @ ${(x / a).toFixed(3)}s overlaps marker by ${Math.round((1e3 * w) / a)} ms.`,
                    ),
                    (this.nextAudioTs = g = x - m),
                    (S = x));
                else if (w >= T * l && A < 1e4 && c) {
                  var I = Math.round(w / l);
                  for (S = x - I * l; S < 0 && I && l; ) (I--, (S += l));
                  (0 === b && (this.nextAudioTs = g = S - m),
                    this.warn(
                      `Injecting ${I} audio frames @ ${((S - m) / a).toFixed(3)}s due to ${Math.round((1e3 * w) / a)} ms gap.`,
                    ));
                  for (var k = 0; k < I; k++) {
                    var R = eg.getSilentFrame(e.parsedCodec || e.manifestCodec || e.codec, e.channelCount);
                    (R ||
                      (this.log(
                        "Unable to get silent frame for given audio codec; duplicating last frame instead.",
                      ),
                      (R = E.unit.subarray())),
                      f.splice(b, 0, { unit: R, pts: S }),
                      (S += l),
                      b++);
                  }
                }
                ((E.pts = S), (S += l));
              }
            for (var C, L = null, M = null, D = 0, _ = f.length; _--; ) D += f[_].unit.byteLength;
            for (var P = 0, O = f.length; P < O; P++) {
              var N = f[P],
                F = N.unit,
                U = N.pts;
              if (null !== M) {
                h[P - 1].duration = Math.round((U - M) / s);
              } else {
                if ((r && "aac" === e.segmentCodec && (U = g + m), (L = U), !(D > 0))) return;
                D += p;
                try {
                  C = new Uint8Array(D);
                } catch (W) {
                  return void this.observer.emit(Au.ERROR, Au.ERROR, {
                    type: xu.MUX_ERROR,
                    details: wu.REMUX_ALLOC_ERROR,
                    fatal: !1,
                    error: W,
                    bytes: D,
                    reason: `fail allocating audio mdat ${D}`,
                  });
                }
                d || (new DataView(C.buffer).setUint32(0, D), C.set(rg.types.mdat, 4));
              }
              C.set(F, p);
              var B = F.byteLength;
              ((p += B), h.push(ug(!0, o, B, 0)), (M = U));
            }
            var $ = h.length;
            if ($) {
              var j = h[h.length - 1];
              ((g = M - m), (this.nextAudioTs = g + s * j.duration));
              var G = d ? new Uint8Array(0) : rg.moof(e.sequenceNumber++, L / s, Nu({}, e, { samples: h }));
              e.samples = [];
              var V = (L - m) / a,
                H = this.nextAudioTs / a,
                K = {
                  data1: G,
                  data2: C,
                  startPTS: V,
                  endPTS: H,
                  startDTS: V,
                  endDTS: H,
                  type: "audio",
                  hasAudio: !0,
                  hasVideo: !1,
                  nb: $,
                };
              return ((this.isAudioContiguous = !0), K);
            }
          }
        }
        function hg(e, t) {
          var r;
          if (null === t) return e;
          for (r = t < e ? -8589934592 : 8589934592; Math.abs(e - t) > 4294967296; ) e += r;
          return e;
        }
        function cg(e, t, r, i) {
          var n = e.samples.length;
          if (n) {
            for (var a = e.inputTimeScale, s = 0; s < n; s++) {
              var o = e.samples[s];
              ((o.pts = hg(o.pts - (r.baseTime * a) / r.timescale, t * a) / a),
                (o.dts = hg(o.dts - (i.baseTime * a) / i.timescale, t * a) / a));
            }
            var l = e.samples;
            return ((e.samples = []), { samples: l });
          }
        }
        function fg(e, t, r) {
          var i = e.samples.length;
          if (i) {
            for (var n = e.inputTimeScale, a = 0; a < i; a++) {
              var s = e.samples[a];
              s.pts = hg(s.pts - (r.baseTime * n) / r.timescale, t * n) / n;
            }
            e.samples.sort((e, t) => e.pts - t.pts);
            var o = e.samples;
            return ((e.samples = []), { samples: o });
          }
        }
        function pg(e, t, r = !1) {
          return void 0 !== (null == e ? void 0 : e.start)
            ? (e.start + (r ? e.duration : 0)) / e.timescale
            : t;
        }
        function gg(e, t, r) {
          var i = e.codec;
          if (i && i.length > 4) return i;
          if (t === rd) {
            if ("ec-3" === i || "ac-3" === i || "alac" === i) return i;
            if ("fLaC" === i || "Opus" === i) {
              return Wd(i, !1);
            }
            return (r.warn(`Unhandled audio codec "${i}" in mp4 MAP`), i || "mp4a");
          }
          return (r.warn(`Unhandled video codec "${i}" in mp4 MAP`), i || "avc1");
        }
        try {
          sg = self.performance.now.bind(self.performance);
        } catch (Zy) {
          sg = Date.now;
        }
        var mg = [
          {
            demux: class {
              constructor(e, t) {
                ((this.remainderData = null),
                  (this.timeOffset = 0),
                  (this.config = void 0),
                  (this.videoTrack = void 0),
                  (this.audioTrack = void 0),
                  (this.id3Track = void 0),
                  (this.txtTrack = void 0),
                  (this.config = t));
              }
              resetTimeStamp() {}
              resetInitSegment(e, t, r, i) {
                var n = (this.videoTrack = xp("video", 1)),
                  a = (this.audioTrack = xp("audio", 1)),
                  s = (this.txtTrack = xp("text", 1));
                if (((this.id3Track = xp("id3", 1)), (this.timeOffset = 0), null != e && e.byteLength)) {
                  var o = bd(e);
                  if (o.video) {
                    var l = o.video,
                      u = l.id,
                      d = l.timescale,
                      h = l.codec,
                      c = l.supplemental;
                    ((n.id = u), (n.timescale = s.timescale = d), (n.codec = h), (n.supplemental = c));
                  }
                  if (o.audio) {
                    var f = o.audio,
                      p = f.id,
                      g = f.timescale,
                      m = f.codec;
                    ((a.id = p), (a.timescale = g), (a.codec = m));
                  }
                  ((s.id = cd.text), (n.sampleDuration = 0), (n.duration = a.duration = i));
                }
              }
              resetContiguity() {
                this.remainderData = null;
              }
              static probe(e) {
                return (function (e) {
                  for (var t = e.byteLength, r = 0; r < t; ) {
                    var i = gd(e, r);
                    if (i > 8 && 109 === e[r + 4] && 111 === e[r + 5] && 111 === e[r + 6] && 102 === e[r + 7])
                      return !0;
                    r = i > 1 ? r + i : t;
                  }
                  return !1;
                })(e);
              }
              demux(e, t) {
                this.timeOffset = t;
                var r = e,
                  i = this.videoTrack,
                  n = this.txtTrack;
                if (this.config.progressive) {
                  this.remainderData && (r = Rd(this.remainderData, e));
                  var a = (function (e) {
                    var t = { valid: null, remainder: null },
                      r = yd(e, ["moof"]);
                    if (r.length < 2) return ((t.remainder = e), t);
                    var i = r[r.length - 1];
                    return (
                      (t.valid = e.slice(0, i.byteOffset - 8)),
                      (t.remainder = e.slice(i.byteOffset - 8)),
                      t
                    );
                  })(r);
                  ((this.remainderData = a.remainder), (i.samples = a.valid || new Uint8Array()));
                } else i.samples = r;
                var s = this.extractID3Track(i, t);
                return (
                  (n.samples = Cd(t, i)),
                  { videoTrack: i, audioTrack: this.audioTrack, id3Track: s, textTrack: this.txtTrack }
                );
              }
              flush() {
                var e = this.timeOffset,
                  t = this.videoTrack,
                  r = this.txtTrack;
                ((t.samples = this.remainderData || new Uint8Array()), (this.remainderData = null));
                var i = this.extractID3Track(t, this.timeOffset);
                return (
                  (r.samples = Cd(e, t)),
                  { videoTrack: t, audioTrack: xp(), id3Track: i, textTrack: xp() }
                );
              }
              extractID3Track(e, t) {
                var r = this.id3Track;
                if (e.samples.length) {
                  var i = yd(e.samples, ["emsg"]);
                  i &&
                    i.forEach(e => {
                      var i = (function (e) {
                        var t = e[0],
                          r = "",
                          i = "",
                          n = 0,
                          a = 0,
                          s = 0,
                          o = 0,
                          l = 0,
                          u = 0;
                        if (0 === t) {
                          for (; "\0" !== fd(e.subarray(u, u + 1)); )
                            ((r += fd(e.subarray(u, u + 1))), (u += 1));
                          for (r += fd(e.subarray(u, u + 1)), u += 1; "\0" !== fd(e.subarray(u, u + 1)); )
                            ((i += fd(e.subarray(u, u + 1))), (u += 1));
                          ((i += fd(e.subarray(u, u + 1))),
                            (u += 1),
                            (n = gd(e, 12)),
                            (a = gd(e, 16)),
                            (o = gd(e, 20)),
                            (l = gd(e, 24)),
                            (u = 28));
                        } else if (1 === t) {
                          n = gd(e, (u += 4));
                          var d = gd(e, (u += 4)),
                            h = gd(e, (u += 4));
                          for (
                            u += 4,
                              s = Math.pow(2, 32) * d + h,
                              Su(s) ||
                                ((s = Number.MAX_SAFE_INTEGER),
                                Ku.warn(
                                  "Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box",
                                )),
                              o = gd(e, u),
                              l = gd(e, (u += 4)),
                              u += 4;
                            "\0" !== fd(e.subarray(u, u + 1));
                          )
                            ((r += fd(e.subarray(u, u + 1))), (u += 1));
                          for (r += fd(e.subarray(u, u + 1)), u += 1; "\0" !== fd(e.subarray(u, u + 1)); )
                            ((i += fd(e.subarray(u, u + 1))), (u += 1));
                          ((i += fd(e.subarray(u, u + 1))), (u += 1));
                        }
                        return {
                          schemeIdUri: r,
                          value: i,
                          timeScale: n,
                          presentationTime: s,
                          presentationTimeDelta: a,
                          eventDuration: o,
                          id: l,
                          payload: e.subarray(u, e.byteLength),
                        };
                      })(e);
                      if (Bp.test(i.schemeIdUri)) {
                        var n = $p(i, t),
                          a =
                            4294967295 === i.eventDuration
                              ? Number.POSITIVE_INFINITY
                              : i.eventDuration / i.timeScale;
                        a <= 0.001 && (a = Number.POSITIVE_INFINITY);
                        var s = i.payload;
                        r.samples.push({
                          data: s,
                          len: s.byteLength,
                          dts: n,
                          pts: n,
                          type: Ep.emsg,
                          duration: a,
                        });
                      } else if (
                        this.config.enableEmsgKLVMetadata &&
                        i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")
                      ) {
                        var o = $p(i, t);
                        r.samples.push({
                          data: i.payload,
                          len: i.payload.byteLength,
                          dts: o,
                          pts: o,
                          type: Ep.misbklv,
                          duration: Number.POSITIVE_INFINITY,
                        });
                      }
                    });
                }
                return r;
              }
              demuxSampleAes(e, t, r) {
                return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"));
              }
              destroy() {
                ((this.config = null),
                  (this.remainderData = null),
                  (this.videoTrack = this.audioTrack = this.id3Track = this.txtTrack = void 0));
              }
            },
            remux: class extends Bu {
              constructor(e, t, r, i) {
                (super("passthrough-remuxer", i),
                  (this.emitInitSegment = !1),
                  (this.audioCodec = void 0),
                  (this.videoCodec = void 0),
                  (this.initData = void 0),
                  (this.initPTS = null),
                  (this.initTracks = void 0),
                  (this.lastEndTime = null),
                  (this.isVideoContiguous = !1));
              }
              destroy() {}
              resetTimeStamp(e) {
                this.lastEndTime = null;
                var t = this.initPTS;
                (t && e && t.baseTime === e.baseTime && t.timescale === e.timescale) || (this.initPTS = e);
              }
              resetNextTimestamp() {
                ((this.isVideoContiguous = !1), (this.lastEndTime = null));
              }
              resetInitSegment(e, t, r, i) {
                ((this.audioCodec = t),
                  (this.videoCodec = r),
                  this.generateInitSegment(e, i),
                  (this.emitInitSegment = !0));
              }
              generateInitSegment(e, t) {
                var r = this.audioCodec,
                  i = this.videoCodec;
                if (null == e || !e.byteLength)
                  return ((this.initTracks = void 0), void (this.initData = void 0));
                var n = (this.initData = bd(e)),
                  a = n.audio,
                  s = n.video;
                if (t)
                  !(function (e, t) {
                    if (e && t) {
                      var r = t.keyId;
                      r &&
                        t.isCommonEncryption &&
                        Id(e, (e, t) => {
                          var i = e.subarray(8, 24);
                          i.some(e => 0 !== e) ||
                            (Ku.log(
                              `[eme] Patching keyId in 'enc${t ? "a" : "v"}>sinf>>tenc' box: ${Xu(i)} -> ${Xu(r)}`,
                            ),
                            e.set(r, 8));
                        });
                    }
                  })(e, t);
                else {
                  var o = a || s;
                  null != o &&
                    o.encrypted &&
                    this.warn(`Init segment with encrypted track with has no key ("${o.codec}")!`);
                }
                (a && (r = gg(a, rd, this)), s && (i = gg(s, id, this)));
                var l = {};
                (a && s
                  ? (l.audiovideo = {
                      container: "video/mp4",
                      codec: r + "," + i,
                      supplemental: s.supplemental,
                      encrypted: s.encrypted,
                      initSegment: e,
                      id: "main",
                    })
                  : a
                    ? (l.audio = {
                        container: "audio/mp4",
                        codec: r,
                        encrypted: a.encrypted,
                        initSegment: e,
                        id: "audio",
                      })
                    : s
                      ? (l.video = {
                          container: "video/mp4",
                          codec: i,
                          supplemental: s.supplemental,
                          encrypted: s.encrypted,
                          initSegment: e,
                          id: "main",
                        })
                      : this.warn("initSegment does not contain moov or trak boxes."),
                  (this.initTracks = l));
              }
              remux(e, t, r, i, n, a) {
                var s,
                  o,
                  l = this.initPTS,
                  u = this.lastEndTime,
                  d = { audio: void 0, video: void 0, text: i, id3: r, initSegment: void 0 };
                bu(u) || (u = this.lastEndTime = n || 0);
                var h = t.samples;
                if (!h.length) return d;
                var c = { initPTS: void 0, timescale: void 0, trackId: void 0 },
                  f = this.initData;
                if (
                  ((null != (s = f) && s.length) || (this.generateInitSegment(h), (f = this.initData)),
                  null == (o = f) || !o.length)
                )
                  return (this.warn("Failed to generate initSegment."), d);
                this.emitInitSegment && ((c.tracks = this.initTracks), (this.emitInitSegment = !1));
                var p = (function (e, t, r) {
                    for (var i = {}, n = yd(e, ["moof", "traf"]), a = 0; a < n.length; a++) {
                      var s = n[a],
                        o = yd(s, ["tfhd"])[0],
                        l = gd(o, 4),
                        u = t[l];
                      if (u) {
                        i[l] ||
                          (i[l] = {
                            start: NaN,
                            duration: 0,
                            sampleCount: 0,
                            timescale: u.timescale,
                            type: u.type,
                          });
                        var d = i[l],
                          h = yd(s, ["tfdt"])[0];
                        if (h) {
                          var c = h[0],
                            f = gd(h, 4);
                          (1 === c &&
                            (f === dd
                              ? r.warn(
                                  "[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time",
                                )
                              : ((f *= dd + 1), (f += gd(h, 8)))),
                            bu(f) && (!bu(d.start) || f < d.start) && (d.start = f));
                        }
                        var p = u.default,
                          g = gd(o, 0) | (null == p ? void 0 : p.flags),
                          m = (null == p ? void 0 : p.duration) || 0;
                        8 & g && (m = gd(o, 2 & g ? 12 : 8));
                        for (
                          var v = yd(s, ["trun"]), y = d.start || 0, T = 0, b = m, S = 0;
                          S < v.length;
                          S++
                        ) {
                          var E = v[S],
                            x = gd(E, 4),
                            w = d.sampleCount;
                          d.sampleCount += x;
                          var A = 1 & E[3],
                            I = 4 & E[3],
                            k = 1 & E[2],
                            R = 2 & E[2],
                            C = 4 & E[2],
                            L = 8 & E[2],
                            M = 8,
                            D = x;
                          for (
                            A && (M += 4),
                              I &&
                                x &&
                                (1 & E[M + 1] || void 0 !== d.keyFrameIndex || (d.keyFrameIndex = w),
                                (M += 4),
                                k ? ((b = gd(E, M)), (M += 4)) : (b = m),
                                R && (M += 4),
                                L && (M += 4),
                                (y += b),
                                (T += b),
                                D--);
                            D--;
                          )
                            (k ? ((b = gd(E, M)), (M += 4)) : (b = m),
                              R && (M += 4),
                              C &&
                                (1 & E[M + 1] ||
                                  (void 0 === d.keyFrameIndex &&
                                    ((d.keyFrameIndex = d.sampleCount - (D + 1)), (d.keyFrameStart = y))),
                                (M += 4)),
                              L && (M += 4),
                              (y += b),
                              (T += b));
                          !T && m && (T += m * x);
                        }
                        d.duration += T;
                      }
                    }
                    if (!Object.keys(i).some(e => i[e].duration)) {
                      for (var _ = 1 / 0, P = 0, O = yd(e, ["sidx"]), N = 0; N < O.length; N++) {
                        var F = Td(O[N]);
                        if (null != F && F.references) {
                          _ = Math.min(_, F.earliestPresentationTime / F.timescale);
                          var U = F.references.reduce((e, t) => e + t.info.duration || 0, 0);
                          P = Math.max(P, U + F.earliestPresentationTime / F.timescale);
                        }
                      }
                      P &&
                        bu(P) &&
                        Object.keys(i).forEach(e => {
                          i[e].duration || (i[e].duration = P * i[e].timescale - i[e].start);
                        });
                    }
                    return i;
                  })(h, f, this),
                  g = f.audio ? p[f.audio.id] : null,
                  m = f.video ? p[f.video.id] : null,
                  v = pg(m, 1 / 0),
                  y = pg(g, 1 / 0),
                  T = pg(m, 0, !0),
                  b = pg(g, 0, !0),
                  S = n,
                  E = 0,
                  x = g && (!m || (!l && y < v) || (l && l.trackId === f.audio.id)),
                  w = x ? g : m;
                if (w) {
                  var A = w.timescale,
                    I = w.start - n * A,
                    k = x ? f.audio.id : f.video.id;
                  ((S = w.start / A),
                    (E = x ? b - y : T - v),
                    (!a && l) ||
                      (!(function (e, t, r, i) {
                        if (null === e) return !0;
                        var n = Math.max(i, 1),
                          a = t - e.baseTime / e.timescale;
                        return Math.abs(a - r) > n;
                      })(l, S, n, E) &&
                        A === l.timescale) ||
                      (l &&
                        this.warn(
                          `Timestamps at playlist time: ${a ? "" : "~"}${n} ${I / A} != initPTS: ${l.baseTime / l.timescale} (${l.baseTime}/${l.timescale}) trackId: ${l.trackId}`,
                        ),
                      this.log(
                        `Found initPTS at playlist time: ${n} offset: ${S - n} (${I}/${A}) trackId: ${k}`,
                      ),
                      (l = null),
                      (c.initPTS = I),
                      (c.timescale = A),
                      (c.trackId = k)));
                } else this.warn(`No audio or video samples found for initPTS at playlist time: ${n}`);
                l
                  ? ((c.initPTS = l.baseTime), (c.timescale = l.timescale), (c.trackId = l.trackId))
                  : ((c.timescale && void 0 !== c.trackId && void 0 !== c.initPTS) ||
                      (this.warn("Could not set initPTS"),
                      (c.initPTS = S),
                      (c.timescale = 1),
                      (c.trackId = -1)),
                    (this.initPTS = l = { baseTime: c.initPTS, timescale: c.timescale, trackId: c.trackId }));
                var R = S - l.baseTime / l.timescale,
                  C = R + E;
                E > 0
                  ? (this.lastEndTime = C)
                  : (this.warn("Duration parsed from mp4 should be greater than zero"),
                    this.resetNextTimestamp());
                var L = !!f.audio,
                  M = !!f.video,
                  D = "";
                (L && (D += "audio"), M && (D += "video"));
                var _ = {
                  data1: h,
                  startPTS: R,
                  startDTS: R,
                  endPTS: C,
                  endDTS: C,
                  type: D,
                  hasAudio: L,
                  hasVideo: M,
                  nb: 1,
                  dropped: 0,
                  encrypted: (!!f.audio && f.audio.encrypted) || (!!f.video && f.video.encrypted),
                };
                ((d.audio = L && !M ? _ : void 0), (d.video = M ? _ : void 0));
                var P = null == m ? void 0 : m.sampleCount;
                if (P) {
                  var O = m.keyFrameIndex,
                    N = -1 !== O;
                  ((_.nb = P),
                    (_.dropped = 0 === O || this.isVideoContiguous ? 0 : N ? O : P),
                    (_.independent = N),
                    (_.firstKeyFrame = O),
                    N &&
                      m.keyFrameStart &&
                      (_.firstKeyFramePTS = (m.keyFrameStart - l.baseTime) / l.timescale),
                    this.isVideoContiguous || (d.independent = N),
                    this.isVideoContiguous || (this.isVideoContiguous = N),
                    _.dropped &&
                      this.warn(
                        `fmp4 does not start with IDR: firstIDR ${O}/${P} dropped: ${_.dropped} start: ${_.firstKeyFramePTS || "NA"}`,
                      ));
                }
                return (
                  (d.initSegment = c),
                  (d.id3 = cg(r, n, l, l)),
                  i.samples.length && (d.text = fg(i, n, l)),
                  d
                );
              }
            },
          },
          { demux: zp, remux: dg },
          {
            demux: class extends wp {
              constructor(e, t) {
                (super(),
                  (this.observer = void 0),
                  (this.config = void 0),
                  (this.observer = e),
                  (this.config = t));
              }
              resetInitSegment(e, t, r, i) {
                (super.resetInitSegment(e, t, r, i),
                  (this._audioTrack = {
                    container: "audio/adts",
                    type: "audio",
                    id: 2,
                    pid: -1,
                    sequenceNumber: 0,
                    segmentCodec: "aac",
                    samples: [],
                    manifestCodec: t,
                    duration: i,
                    inputTimeScale: 9e4,
                    dropped: 0,
                  }));
              }
              static probe(e, t) {
                if (!e) return !1;
                var r = np(e, 0),
                  i = (null == r ? void 0 : r.length) || 0;
                if (Op(e, i)) return !1;
                for (var n = e.length; i < n; i++) if (up(e, i)) return (t.log("ADTS sync word found !"), !0);
                return !1;
              }
              canParse(e, t) {
                return (function (e, t) {
                  return (
                    (function (e, t) {
                      return t + 5 < e.length;
                    })(e, t) &&
                    ap(e, t) &&
                    op(e, t) <= e.length - t
                  );
                })(e, t);
              }
              appendFrame(e, t, r) {
                dp(e, this.observer, t, r, e.manifestCodec);
                var i = cp(e, t, r, this.basePTS, this.frameIndex);
                if (i && 0 === i.missing) return i;
              }
            },
            remux: dg,
          },
          {
            demux: class extends wp {
              resetInitSegment(e, t, r, i) {
                (super.resetInitSegment(e, t, r, i),
                  (this._audioTrack = {
                    container: "audio/mpeg",
                    type: "audio",
                    id: 2,
                    pid: -1,
                    sequenceNumber: 0,
                    segmentCodec: "mp3",
                    samples: [],
                    manifestCodec: t,
                    duration: i,
                    inputTimeScale: 9e4,
                    dropped: 0,
                  }));
              }
              static probe(e) {
                if (!e) return !1;
                var t = np(e, 0),
                  r = (null == t ? void 0 : t.length) || 0;
                if (t && 11 === e[r] && 119 === e[r + 1] && void 0 !== Sp(t) && Np(e, r) <= 16) return !1;
                for (var i = e.length; r < i; r++)
                  if (Op(e, r)) return (Ku.log("MPEG Audio sync word found !"), !0);
                return !1;
              }
              canParse(e, t) {
                return (function (e, t) {
                  return _p(e, t) && 4 <= e.length - t;
                })(e, t);
              }
              appendFrame(e, t, r) {
                if (null !== this.basePTS) return Mp(e, t, r, this.basePTS, this.frameIndex);
              }
            },
            remux: dg,
          },
        ];
        mg.splice(2, 0, { demux: Fp, remux: dg });
        class vg {
          constructor(e, t, r, i, n, a) {
            ((this.asyncResult = !1),
              (this.logger = void 0),
              (this.observer = void 0),
              (this.typeSupported = void 0),
              (this.config = void 0),
              (this.id = void 0),
              (this.demuxer = void 0),
              (this.remuxer = void 0),
              (this.decrypter = void 0),
              (this.probe = void 0),
              (this.decryptionPromise = null),
              (this.transmuxConfig = void 0),
              (this.currentTransmuxState = void 0),
              (this.observer = e),
              (this.typeSupported = t),
              (this.config = r),
              (this.id = n),
              (this.logger = a));
          }
          configure(e) {
            ((this.transmuxConfig = e), this.decrypter && this.decrypter.reset());
          }
          push(e, t, r, i) {
            var n = r.transmuxing;
            n.executeStart = sg();
            var a = new Uint8Array(e),
              s = this.currentTransmuxState,
              o = this.transmuxConfig;
            i && (this.currentTransmuxState = i);
            var l = i || s,
              u = l.contiguous,
              d = l.discontinuity,
              h = l.trackSwitch,
              c = l.accurateTimeOffset,
              f = l.timeOffset,
              p = l.initSegmentChange,
              g = o.audioCodec,
              m = o.videoCodec,
              v = o.defaultInitPts,
              y = o.duration,
              T = o.initSegmentData,
              b = (function (e, t) {
                var r = null;
                e.byteLength > 0 &&
                  null != (null == t ? void 0 : t.key) &&
                  null !== t.iv &&
                  null != t.method &&
                  (r = t);
                return r;
              })(a, t);
            if (b && Rc(b.method)) {
              var S = this.getDecrypter(),
                E = Cc(b.method);
              if (!S.isSync())
                return (
                  (this.asyncResult = !0),
                  (this.decryptionPromise = S.webCryptoDecrypt(a, b.key.buffer, b.iv.buffer, E).then(e => {
                    var t = this.push(e, null, r);
                    return ((this.decryptionPromise = null), t);
                  })),
                  this.decryptionPromise
                );
              var x = S.softwareDecrypt(a, b.key.buffer, b.iv.buffer, E);
              if (r.part > -1) {
                var w = S.flush();
                x = w ? w.buffer : w;
              }
              if (!x) return ((n.executeEnd = sg()), yg(r));
              a = new Uint8Array(x);
            }
            var A = this.needsProbing(d, h);
            if (A) {
              var I = this.configureTransmuxer(a);
              if (I)
                return (
                  this.logger.warn(`[transmuxer] ${I.message}`),
                  this.observer.emit(Au.ERROR, Au.ERROR, {
                    type: xu.MEDIA_ERROR,
                    details: wu.FRAG_PARSING_ERROR,
                    fatal: !1,
                    error: I,
                    reason: I.message,
                  }),
                  (n.executeEnd = sg()),
                  yg(r)
                );
            }
            ((d || h || p || A) && this.resetInitSegment(T, g, m, y, t),
              (d || p || A) && this.resetInitialTimestamp(v),
              u || this.resetContiguity());
            var k = this.transmux(a, b, f, c, r);
            this.asyncResult = Tg(k);
            var R = this.currentTransmuxState;
            return (
              (R.contiguous = !0),
              (R.discontinuity = !1),
              (R.trackSwitch = !1),
              (n.executeEnd = sg()),
              k
            );
          }
          flush(e) {
            var t = e.transmuxing;
            t.executeStart = sg();
            var r = this.decrypter,
              i = this.currentTransmuxState,
              n = this.decryptionPromise;
            if (n) return ((this.asyncResult = !0), n.then(() => this.flush(e)));
            var a = [],
              s = i.timeOffset;
            if (r) {
              var o = r.flush();
              o && a.push(this.push(o.buffer, null, e));
            }
            var l = this.demuxer,
              u = this.remuxer;
            if (!l || !u) {
              t.executeEnd = sg();
              var d = [yg(e)];
              return this.asyncResult ? Promise.resolve(d) : d;
            }
            var h = l.flush(s);
            return Tg(h)
              ? ((this.asyncResult = !0), h.then(t => (this.flushRemux(a, t, e), a)))
              : (this.flushRemux(a, h, e), this.asyncResult ? Promise.resolve(a) : a);
          }
          flushRemux(e, t, r) {
            var i = t.audioTrack,
              n = t.videoTrack,
              a = t.id3Track,
              s = t.textTrack,
              o = this.currentTransmuxState,
              l = o.accurateTimeOffset,
              u = o.timeOffset;
            this.logger.log(
              `[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part > -1 ? " part: " + r.part : ""} of ${this.id === Lu ? "level" : "track"} ${r.level}`,
            );
            var d = this.remuxer.remux(i, n, a, s, u, l, !0, this.id);
            (e.push({ remuxResult: d, chunkMeta: r }), (r.transmuxing.executeEnd = sg()));
          }
          resetInitialTimestamp(e) {
            var t = this.demuxer,
              r = this.remuxer;
            t && r && (t.resetTimeStamp(e), r.resetTimeStamp(e));
          }
          resetContiguity() {
            var e = this.demuxer,
              t = this.remuxer;
            e && t && (e.resetContiguity(), t.resetNextTimestamp());
          }
          resetInitSegment(e, t, r, i, n) {
            var a = this.demuxer,
              s = this.remuxer;
            a && s && (a.resetInitSegment(e, t, r, i), s.resetInitSegment(e, t, r, n));
          }
          destroy() {
            (this.demuxer && (this.demuxer.destroy(), (this.demuxer = void 0)),
              this.remuxer && (this.remuxer.destroy(), (this.remuxer = void 0)));
          }
          transmux(e, t, r, i, n) {
            return t && "SAMPLE-AES" === t.method
              ? this.transmuxSampleAes(e, t, r, i, n)
              : this.transmuxUnencrypted(e, r, i, n);
          }
          transmuxUnencrypted(e, t, r, i) {
            var n = this.demuxer.demux(e, t, !1, !this.config.progressive),
              a = n.audioTrack,
              s = n.videoTrack,
              o = n.id3Track,
              l = n.textTrack;
            return { remuxResult: this.remuxer.remux(a, s, o, l, t, r, !1, this.id), chunkMeta: i };
          }
          transmuxSampleAes(e, t, r, i, n) {
            return this.demuxer.demuxSampleAes(e, t, r).then(e => ({
              remuxResult: this.remuxer.remux(
                e.audioTrack,
                e.videoTrack,
                e.id3Track,
                e.textTrack,
                r,
                i,
                !1,
                this.id,
              ),
              chunkMeta: n,
            }));
          }
          configureTransmuxer(e) {
            for (
              var t, r = this.config, i = this.observer, n = this.typeSupported, a = 0, s = mg.length;
              a < s;
              a++
            ) {
              var o;
              if (null != (o = mg[a].demux) && o.probe(e, this.logger)) {
                t = mg[a];
                break;
              }
            }
            if (!t) return new Error("Failed to find demuxer by probing fragment data");
            var l = this.demuxer,
              u = this.remuxer,
              d = t.remux,
              h = t.demux;
            ((u && u instanceof d) || (this.remuxer = new d(i, r, n, this.logger)),
              (l && l instanceof h) ||
                ((this.demuxer = new h(i, r, n, this.logger)), (this.probe = h.probe)));
          }
          needsProbing(e, t) {
            return !this.demuxer || !this.remuxer || e || t;
          }
          getDecrypter() {
            var e = this.decrypter;
            return (e || (e = this.decrypter = new nc(this.config)), e);
          }
        }
        var yg = e => ({ remuxResult: {}, chunkMeta: e });
        function Tg(e) {
          return "then" in e && e.then instanceof Function;
        }
        class bg {
          constructor(e, t, r, i, n) {
            ((this.audioCodec = void 0),
              (this.videoCodec = void 0),
              (this.initSegmentData = void 0),
              (this.duration = void 0),
              (this.defaultInitPts = void 0),
              (this.audioCodec = e),
              (this.videoCodec = t),
              (this.initSegmentData = r),
              (this.duration = i),
              (this.defaultInitPts = n || null));
          }
        }
        class Sg {
          constructor(e, t, r, i, n, a) {
            ((this.discontinuity = void 0),
              (this.contiguous = void 0),
              (this.accurateTimeOffset = void 0),
              (this.trackSwitch = void 0),
              (this.timeOffset = void 0),
              (this.initSegmentChange = void 0),
              (this.discontinuity = e),
              (this.contiguous = t),
              (this.accurateTimeOffset = r),
              (this.trackSwitch = i),
              (this.timeOffset = n),
              (this.initSegmentChange = a));
          }
        }
        var Eg = 0;
        class xg {
          constructor(e, t, r, i) {
            ((this.error = null),
              (this.hls = void 0),
              (this.id = void 0),
              (this.instanceNo = Eg++),
              (this.observer = void 0),
              (this.frag = null),
              (this.part = null),
              (this.useWorker = void 0),
              (this.workerContext = null),
              (this.transmuxer = null),
              (this.onTransmuxComplete = void 0),
              (this.onFlush = void 0),
              (this.onWorkerMessage = e => {
                var t = e.data,
                  r = this.hls;
                if (r && null != t && t.event && t.instanceNo === this.instanceNo)
                  switch (t.event) {
                    case "init":
                      var i,
                        n = null == (i = this.workerContext) ? void 0 : i.objectURL;
                      n && self.URL.revokeObjectURL(n);
                      break;
                    case "transmuxComplete":
                      this.handleTransmuxComplete(t.data);
                      break;
                    case "flush":
                      this.onFlush(t.data);
                      break;
                    case "workerLog":
                      r.logger[t.data.logType] && r.logger[t.data.logType](t.data.message);
                      break;
                    default:
                      ((t.data = t.data || {}),
                        (t.data.frag = this.frag),
                        (t.data.part = this.part),
                        (t.data.id = this.id),
                        r.trigger(t.event, t.data));
                  }
              }),
              (this.onWorkerError = e => {
                if (this.hls) {
                  var t = new Error(`${e.message}  (${e.filename}:${e.lineno})`);
                  ((this.hls.config.enableWorker = !1),
                    this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),
                    this.hls.trigger(Au.ERROR, {
                      type: xu.OTHER_ERROR,
                      details: wu.INTERNAL_EXCEPTION,
                      fatal: !1,
                      event: "demuxerWorker",
                      error: t,
                    }));
                }
              }));
            var n = e.config;
            ((this.hls = e),
              (this.id = t),
              (this.useWorker = !!n.enableWorker),
              (this.onTransmuxComplete = r),
              (this.onFlush = i));
            var a = (e, t) => {
              (((t = t || {}).frag = this.frag || void 0),
                e === Au.ERROR && ((t.parent = this.id), (t.part = this.part), (this.error = t.error)),
                this.hls.trigger(e, t));
            };
            ((this.observer = new Jf()),
              this.observer.on(Au.FRAG_DECRYPTED, a),
              this.observer.on(Au.ERROR, a));
            var s = Yd(n.preferManagedMediaSource);
            if (this.useWorker && "undefined" != typeof Worker) {
              var o = this.hls.logger;
              if (n.workerPath || "function" == typeof __HLS_WORKER_BUNDLE__) {
                try {
                  n.workerPath
                    ? (o.log(`loading Web Worker ${n.workerPath} for "${t}"`),
                      (this.workerContext = (function (e) {
                        var t = ep[e];
                        if (t) return (t.clientCount++, t);
                        var r = new self.URL(e, self.location.href).href,
                          i = { worker: new self.Worker(r), scriptURL: r, clientCount: 1 };
                        return ((ep[e] = i), i);
                      })(n.workerPath)))
                    : (o.log(`injecting Web Worker for "${t}"`),
                      (this.workerContext = (function () {
                        var e = ep[Zf];
                        if (e) return (e.clientCount++, e);
                        var t = new self.Blob(
                            [
                              `var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`,
                            ],
                            { type: "text/javascript" },
                          ),
                          r = self.URL.createObjectURL(t),
                          i = { worker: new self.Worker(r), objectURL: r, clientCount: 1 };
                        return ((ep[Zf] = i), i);
                      })()));
                  var l = this.workerContext.worker;
                  (l.addEventListener("message", this.onWorkerMessage),
                    l.addEventListener("error", this.onWorkerError),
                    l.postMessage({
                      instanceNo: this.instanceNo,
                      cmd: "init",
                      typeSupported: s,
                      id: t,
                      config: ph(n),
                    }));
                } catch (Zy) {
                  (o.warn(`Error setting up "${t}" Web Worker, fallback to inline`, Zy),
                    this.terminateWorker(),
                    (this.error = null),
                    (this.transmuxer = new vg(this.observer, s, n, "", t, e.logger)));
                }
                return;
              }
            }
            this.transmuxer = new vg(this.observer, s, n, "", t, e.logger);
          }
          reset() {
            if (((this.frag = null), (this.part = null), this.workerContext)) {
              var e = this.instanceNo;
              this.instanceNo = Eg++;
              var t = this.hls.config,
                r = Yd(t.preferManagedMediaSource);
              this.workerContext.worker.postMessage({
                instanceNo: this.instanceNo,
                cmd: "reset",
                resetNo: e,
                typeSupported: r,
                id: this.id,
                config: ph(t),
              });
            }
          }
          terminateWorker() {
            if (this.workerContext) {
              var e = this.workerContext.worker;
              ((this.workerContext = null),
                e.removeEventListener("message", this.onWorkerMessage),
                e.removeEventListener("error", this.onWorkerError),
                (function (e) {
                  var t = ep[e || Zf];
                  if (t && 1 === t.clientCount--) {
                    var r = t.worker,
                      i = t.objectURL;
                    (delete ep[e || Zf], i && self.URL.revokeObjectURL(i), r.terminate());
                  }
                })(this.hls.config.workerPath));
            }
          }
          destroy() {
            if (this.workerContext)
              (this.terminateWorker(), (this.onWorkerMessage = this.onWorkerError = null));
            else {
              var e = this.transmuxer;
              e && (e.destroy(), (this.transmuxer = null));
            }
            var t = this.observer;
            (t && t.removeAllListeners(),
              (this.frag = null),
              (this.part = null),
              (this.observer = null),
              (this.hls = null));
          }
          push(e, t, r, i, n, a, s, o, l, u) {
            var d, h;
            l.transmuxing.start = self.performance.now();
            var c = this.instanceNo,
              f = this.transmuxer,
              p = a ? a.start : n.start,
              g = n.decryptdata,
              m = this.frag,
              v = !(m && n.cc === m.cc),
              y = !(m && l.level === m.level),
              T = m ? l.sn - m.sn : -1,
              b = this.part ? l.part - this.part.index : -1,
              S = 0 === T && l.id > 1 && l.id === (null == m ? void 0 : m.stats.chunkCount),
              E = !y && (1 === T || (0 === T && (1 === b || (S && b <= 0)))),
              x = self.performance.now();
            ((y || T || 0 === n.stats.parsing.start) && (n.stats.parsing.start = x),
              !a || (!b && E) || (a.stats.parsing.start = x));
            var w = !(
                m &&
                (null == (d = n.initSegment) ? void 0 : d.url) ===
                  (null == (h = m.initSegment) ? void 0 : h.url)
              ),
              A = new Sg(v, E, o, y, p, w);
            if (!E || v || w) {
              this.hls.logger.log(
                `[transmuxer-interface]: Starting new transmux session for ${n.type} sn: ${l.sn}${l.part > -1 ? " part: " + l.part : ""} ${this.id === Lu ? "level" : "track"}: ${l.level} id: ${l.id}\n        discontinuity: ${v}\n        trackSwitch: ${y}\n        contiguous: ${E}\n        accurateTimeOffset: ${o}\n        timeOffset: ${p}\n        initSegmentChange: ${w}`,
              );
              var I = new bg(r, i, t, s, u);
              this.configureTransmuxer(I);
            }
            if (((this.frag = n), (this.part = a), this.workerContext))
              this.workerContext.worker.postMessage(
                { instanceNo: c, cmd: "demux", data: e, decryptdata: g, chunkMeta: l, state: A },
                e instanceof ArrayBuffer ? [e] : [],
              );
            else if (f) {
              var k = f.push(e, g, l, A);
              Tg(k)
                ? k
                    .then(e => {
                      this.handleTransmuxComplete(e);
                    })
                    .catch(e => {
                      this.transmuxerError(e, l, "transmuxer-interface push error");
                    })
                : this.handleTransmuxComplete(k);
            }
          }
          flush(e) {
            e.transmuxing.start = self.performance.now();
            var t = this.instanceNo,
              r = this.transmuxer;
            if (this.workerContext)
              this.workerContext.worker.postMessage({ instanceNo: t, cmd: "flush", chunkMeta: e });
            else if (r) {
              var i = r.flush(e);
              Tg(i)
                ? i
                    .then(t => {
                      this.handleFlushResult(t, e);
                    })
                    .catch(t => {
                      this.transmuxerError(t, e, "transmuxer-interface flush error");
                    })
                : this.handleFlushResult(i, e);
            }
          }
          transmuxerError(e, t, r) {
            this.hls &&
              ((this.error = e),
              this.hls.trigger(Au.ERROR, {
                type: xu.MEDIA_ERROR,
                details: wu.FRAG_PARSING_ERROR,
                chunkMeta: t,
                frag: this.frag || void 0,
                part: this.part || void 0,
                fatal: !1,
                error: e,
                err: e,
                reason: r,
              }));
          }
          handleFlushResult(e, t) {
            (e.forEach(e => {
              this.handleTransmuxComplete(e);
            }),
              this.onFlush(t));
          }
          configureTransmuxer(e) {
            var t = this.instanceNo,
              r = this.transmuxer;
            this.workerContext
              ? this.workerContext.worker.postMessage({ instanceNo: t, cmd: "configure", config: e })
              : r && r.configure(e);
          }
          handleTransmuxComplete(e) {
            ((e.chunkMeta.transmuxing.end = self.performance.now()), this.onTransmuxComplete(e));
          }
        }
        class wg extends Bu {
          constructor(e, t) {
            (super(t, e.logger), (this.hls = void 0), (this.canLoad = !1), (this.timer = -1), (this.hls = e));
          }
          destroy() {
            (this.clearTimer(), (this.hls = this.log = this.warn = null));
          }
          clearTimer() {
            -1 !== this.timer && (self.clearTimeout(this.timer), (this.timer = -1));
          }
          startLoad() {
            ((this.canLoad = !0), this.loadPlaylist());
          }
          stopLoad() {
            ((this.canLoad = !1), this.clearTimer());
          }
          switchParams(e, t, r) {
            var i = null == t ? void 0 : t.renditionReports;
            if (i) {
              for (var n = -1, a = 0; a < i.length; a++) {
                var s = i[a],
                  o = void 0;
                try {
                  o = new self.URL(s.URI, t.url).href;
                } catch (f) {
                  (this.warn(`Could not construct new URL for Rendition Report: ${f}`), (o = s.URI || ""));
                }
                if (o === e) {
                  n = a;
                  break;
                }
                o === e.substring(0, o.length) && (n = a);
              }
              if (-1 !== n) {
                var l = i[n],
                  u = parseInt(l["LAST-MSN"]) || t.lastPartSn,
                  d = parseInt(l["LAST-PART"]) || t.lastPartIndex;
                if (this.hls.config.lowLatencyMode) {
                  var h = Math.min(t.age - t.partTarget, t.targetduration);
                  d >= 0 && h > t.partTarget && (d += 1);
                }
                var c = r && uh(r);
                return new dh(u, d >= 0 ? d : void 0, c);
              }
            }
          }
          loadPlaylist(e) {
            this.clearTimer();
          }
          loadingPlaylist(e, t) {
            this.clearTimer();
          }
          shouldLoadPlaylist(e) {
            return this.canLoad && !!e && !!e.url && (!e.details || e.details.live);
          }
          getUrlWithDirectives(e, t) {
            if (t)
              try {
                return t.addDirectives(e);
              } catch (r) {
                this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`);
              }
            return e;
          }
          playlistLoaded(e, t, r) {
            var i = t.details,
              n = t.stats,
              a = self.performance.now(),
              s = n.loading.first ? Math.max(0, a - n.loading.first) : 0;
            i.advancedDateTime = Date.now() - s;
            var o = this.hls.config.timelineOffset;
            if (o !== i.appliedTimelineOffset) {
              var l = Math.max(o || 0, 0);
              ((i.appliedTimelineOffset = l),
                i.fragments.forEach(e => {
                  e.setStart(e.playlistOffset + l);
                }));
            }
            if (i.live || (null != r && r.live)) {
              var u = "levelInfo" in t ? t.levelInfo : t.track;
              if ((i.reloaded(r), r && i.fragments.length > 0)) {
                gf(r, i, this);
                var d = i.playlistParsingError;
                if (d) {
                  this.warn(d);
                  var h = this.hls;
                  if (!h.config.ignorePlaylistParsingErrors) {
                    var c,
                      f = t.networkDetails;
                    return void h.trigger(Au.ERROR, {
                      type: xu.NETWORK_ERROR,
                      details: wu.LEVEL_PARSING_ERROR,
                      fatal: !1,
                      url: i.url,
                      error: d,
                      reason: d.message,
                      level: t.level || void 0,
                      parent: null == (c = i.fragments[0]) ? void 0 : c.type,
                      networkDetails: f,
                      stats: n,
                    });
                  }
                  i.playlistParsingError = null;
                }
              }
              -1 === i.requestScheduled && (i.requestScheduled = n.loading.start);
              var p,
                g = this.hls.mainForwardBufferInfo,
                m = g ? g.end - g.len : 0,
                v = Tf(i, 1e3 * (i.edge - m));
              if (
                (i.requestScheduled + v < a ? (i.requestScheduled = a) : (i.requestScheduled += v),
                this.log(
                  `live playlist ${e} ${i.advanced ? "REFRESHED " + i.lastPartSn + "-" + i.lastPartIndex : i.updated ? "UPDATED" : "MISSED"}`,
                ),
                !this.canLoad || !i.live)
              )
                return;
              var y = void 0,
                T = void 0;
              if (i.canBlockReload && i.endSN && i.advanced) {
                var b = this.hls.config.lowLatencyMode,
                  S = i.lastPartSn,
                  E = i.endSN,
                  x = i.lastPartIndex,
                  w = S === E;
                -1 !== x
                  ? w
                    ? ((y = E + 1), (T = b ? 0 : x))
                    : ((y = S), (T = b ? x + 1 : i.maxPartIndex))
                  : (y = E + 1);
                var A = i.age,
                  I = A + i.ageHeader,
                  k = Math.min(I - i.partTarget, 1.5 * i.targetduration);
                if (k > 0) {
                  if (I > 3 * i.targetduration)
                    (this.log(
                      `Playlist last advanced ${A.toFixed(2)}s ago. Omitting segment and part directives.`,
                    ),
                      (y = void 0),
                      (T = void 0));
                  else if (null != r && r.tuneInGoal && I - i.partTarget > r.tuneInGoal)
                    (this.warn(
                      `CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${k} with playlist age: ${i.age}`,
                    ),
                      (k = 0));
                  else {
                    var R = Math.floor(k / i.targetduration);
                    if (((y += R), void 0 !== T)) T += Math.round((k % i.targetduration) / i.partTarget);
                    this.log(
                      `CDN Tune-in age: ${i.ageHeader}s last advanced ${A.toFixed(2)}s goal: ${k} skip sn ${R} to part ${T}`,
                    );
                  }
                  i.tuneInGoal = k;
                }
                if (((p = this.getDeliveryDirectives(i, t.deliveryDirectives, y, T)), b || !w))
                  return ((i.requestScheduled = a), void this.loadingPlaylist(u, p));
              } else
                (i.canBlockReload || i.canSkipUntil) &&
                  (p = this.getDeliveryDirectives(i, t.deliveryDirectives, y, T));
              (p &&
                void 0 !== y &&
                i.canBlockReload &&
                (i.requestScheduled = n.loading.first + Math.max(v - 2 * s, v / 2)),
                this.scheduleLoading(u, p, i));
            } else this.clearTimer();
          }
          scheduleLoading(e, t, r) {
            var i = r || e.details;
            if (i) {
              var n = self.performance.now(),
                a = i.requestScheduled;
              if (n >= a) this.loadingPlaylist(e, t);
              else {
                var s = a - n;
                (this.log(`reload live playlist ${e.name || e.bitrate + "bps"} in ${Math.round(s)} ms`),
                  this.clearTimer(),
                  (this.timer = self.setTimeout(() => this.loadingPlaylist(e, t), s)));
              }
            } else this.loadingPlaylist(e, t);
          }
          getDeliveryDirectives(e, t, r, i) {
            var n = uh(e);
            return (
              null != t && t.skip && e.deltaUpdateFailed && ((r = t.msn), (i = t.part), (n = sh)),
              new dh(r, i, n)
            );
          }
          checkRetry(e) {
            var t = e.details,
              r = Rh(e),
              i = e.errorAction,
              n = i || {},
              a = n.action,
              s = n.retryCount,
              o = void 0 === s ? 0 : s,
              l = n.retryConfig,
              u = !!i && !!l && (a === Bh || (!i.resolved && a === Fh));
            if (u) {
              var d;
              if (o >= l.maxNumRetry) return !1;
              if (r && null != (d = e.context) && d.deliveryDirectives)
                (this.warn(
                  `Retrying playlist loading ${o + 1}/${l.maxNumRetry} after "${t}" without delivery-directives`,
                ),
                  this.loadPlaylist());
              else {
                var h = Dh(l, o);
                (this.clearTimer(),
                  (this.timer = self.setTimeout(() => this.loadPlaylist(), h)),
                  this.warn(`Retrying playlist loading ${o + 1}/${l.maxNumRetry} after "${t}" in ${h}ms`));
              }
              ((e.levelRetry = !0), (i.resolved = !0));
            }
            return u;
          }
        }
        function Ag(e, t) {
          if (e.length !== t.length) return !1;
          for (var r = 0; r < e.length; r++) if (!Ig(e[r].attrs, t[r].attrs)) return !1;
          return !0;
        }
        function Ig(e, t, r) {
          var i = e["STABLE-RENDITION-ID"];
          return i && !r
            ? i === t["STABLE-RENDITION-ID"]
            : !(
                r || [
                  "LANGUAGE",
                  "NAME",
                  "CHARACTERISTICS",
                  "AUTOSELECT",
                  "DEFAULT",
                  "FORCED",
                  "ASSOC-LANGUAGE",
                ]
              ).some(r => e[r] !== t[r]);
        }
        function kg(e, t) {
          return (
            t.label.toLowerCase() === e.name.toLowerCase() &&
            (!t.language || t.language.toLowerCase() === (e.lang || "").toLowerCase())
          );
        }
        class Rg {
          constructor(e) {
            ((this.tracks = void 0),
              (this.queues = { video: [], audio: [], audiovideo: [] }),
              (this.tracks = e));
          }
          destroy() {
            this.tracks = this.queues = null;
          }
          append(e, t, r) {
            if (null !== this.queues && null !== this.tracks) {
              var i = this.queues[t];
              (i.push(e), 1 !== i.length || r || this.executeNext(t));
            }
          }
          appendBlocker(e) {
            return new Promise(t => {
              var r = {
                label: "async-blocker",
                execute: t,
                onStart: () => {},
                onComplete: () => {},
                onError: () => {},
              };
              this.append(r, e);
            });
          }
          prependBlocker(e) {
            return new Promise(t => {
              if (this.queues) {
                var r = {
                  label: "async-blocker-prepend",
                  execute: t,
                  onStart: () => {},
                  onComplete: () => {},
                  onError: () => {},
                };
                this.queues[e].unshift(r);
              }
            });
          }
          removeBlockers() {
            null !== this.queues &&
              [this.queues.video, this.queues.audio, this.queues.audiovideo].forEach(e => {
                var t,
                  r = null == (t = e[0]) ? void 0 : t.label;
                ("async-blocker" !== r && "async-blocker-prepend" !== r) || (e[0].execute(), e.splice(0, 1));
              });
          }
          unblockAudio(e) {
            null !== this.queues && this.queues.audio[0] === e && this.shiftAndExecuteNext("audio");
          }
          executeNext(e) {
            if (null !== this.queues && null !== this.tracks) {
              var t = this.queues[e];
              if (t.length) {
                var r = t[0];
                try {
                  r.execute();
                } catch (a) {
                  var i;
                  if ((r.onError(a), null === this.queues || null === this.tracks)) return;
                  var n = null == (i = this.tracks[e]) ? void 0 : i.buffer;
                  (null != n && n.updating) || this.shiftAndExecuteNext(e);
                }
              }
            }
          }
          shiftAndExecuteNext(e) {
            null !== this.queues && (this.queues[e].shift(), this.executeNext(e));
          }
          current(e) {
            var t;
            return (null == (t = this.queues) ? void 0 : t[e][0]) || null;
          }
          toString() {
            var e = this.queues,
              t = this.tracks;
            return null === e || null === t
              ? "<destroyed>"
              : `\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`;
          }
          list(e) {
            var t, r;
            return (null != (t = this.queues) && t[e]) || (null != (r = this.tracks) && r[e])
              ? `${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`
              : "";
          }
          listSbInfo(e) {
            var t,
              r = null == (t = this.tracks) ? void 0 : t[e],
              i = null == r ? void 0 : r.buffer;
            return i
              ? `SourceBuffer${i.updating ? " updating" : ""}${r.ended ? " ended" : ""}${r.ending ? " ending" : ""}`
              : "none";
          }
          listOps(e) {
            var t;
            return (null == (t = this.queues) ? void 0 : t[e].map(e => e.label).join(", ")) || "";
          }
        }
        var Cg = /(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,
          Lg = "HlsJsTrackRemovedError";
        class Mg extends Error {
          constructor(e) {
            (super(e), (this.name = Lg));
          }
        }
        function Dg(e) {
          var t = e.querySelectorAll("source");
          [].slice.call(t).forEach(t => {
            e.removeChild(t);
          });
        }
        function _g(e) {
          return "audio" === e ? 1 : 0;
        }
        class Pg {
          constructor(e) {
            ((this.hls = void 0),
              (this.autoLevelCapping = void 0),
              (this.firstLevel = void 0),
              (this.media = void 0),
              (this.restrictedLevels = void 0),
              (this.timer = void 0),
              (this.clientRect = void 0),
              (this.streamController = void 0),
              (this.hls = e),
              (this.autoLevelCapping = Number.POSITIVE_INFINITY),
              (this.firstLevel = -1),
              (this.media = null),
              (this.restrictedLevels = []),
              (this.timer = void 0),
              (this.clientRect = null),
              this.registerListeners());
          }
          setStreamController(e) {
            this.streamController = e;
          }
          destroy() {
            (this.hls && this.unregisterListener(),
              this.timer && this.stopCapping(),
              (this.media = null),
              (this.clientRect = null),
              (this.hls = this.streamController = null));
          }
          registerListeners() {
            var e = this.hls;
            (e.on(Au.FPS_DROP_LEVEL_CAPPING, this.onFpsDropLevelCapping, this),
              e.on(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
              e.on(Au.MANIFEST_PARSED, this.onManifestParsed, this),
              e.on(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
              e.on(Au.BUFFER_CODECS, this.onBufferCodecs, this),
              e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this));
          }
          unregisterListener() {
            var e = this.hls;
            (e.off(Au.FPS_DROP_LEVEL_CAPPING, this.onFpsDropLevelCapping, this),
              e.off(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
              e.off(Au.MANIFEST_PARSED, this.onManifestParsed, this),
              e.off(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
              e.off(Au.BUFFER_CODECS, this.onBufferCodecs, this),
              e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this));
          }
          onFpsDropLevelCapping(e, t) {
            var r = this.hls.levels[t.droppedLevel];
            this.isLevelAllowed(r) &&
              this.restrictedLevels.push({ bitrate: r.bitrate, height: r.height, width: r.width });
          }
          onMediaAttaching(e, t) {
            ((this.media = t.media instanceof HTMLVideoElement ? t.media : null),
              (this.clientRect = null),
              this.timer && this.hls.levels.length && this.detectPlayerSize());
          }
          onManifestParsed(e, t) {
            var r = this.hls;
            ((this.restrictedLevels = []),
              (this.firstLevel = t.firstLevel),
              r.config.capLevelToPlayerSize && t.video && this.startCapping());
          }
          onLevelsUpdated(e, t) {
            this.timer && bu(this.autoLevelCapping) && this.detectPlayerSize();
          }
          onBufferCodecs(e, t) {
            this.hls.config.capLevelToPlayerSize && t.video && this.startCapping();
          }
          onMediaDetaching() {
            (this.stopCapping(), (this.media = null));
          }
          detectPlayerSize() {
            if (this.media) {
              if (this.mediaHeight <= 0 || this.mediaWidth <= 0) return void (this.clientRect = null);
              var e = this.hls.levels;
              if (e.length) {
                var t = this.hls,
                  r = this.getMaxLevel(e.length - 1);
                (r !== this.autoLevelCapping &&
                  t.logger.log(
                    `Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`,
                  ),
                  (t.autoLevelCapping = r),
                  t.autoLevelEnabled &&
                    t.autoLevelCapping > this.autoLevelCapping &&
                    this.streamController &&
                    this.streamController.nextLevelSwitch(),
                  (this.autoLevelCapping = t.autoLevelCapping));
              }
            }
          }
          getMaxLevel(e) {
            var t = this.hls.levels;
            if (!t.length) return -1;
            var r = t.filter((t, r) => this.isLevelAllowed(t) && r <= e);
            return (
              (this.clientRect = null),
              Pg.getMaxLevelByMediaSize(r, this.mediaWidth, this.mediaHeight)
            );
          }
          startCapping() {
            this.timer ||
              ((this.autoLevelCapping = Number.POSITIVE_INFINITY),
              self.clearInterval(this.timer),
              (this.timer = self.setInterval(this.detectPlayerSize.bind(this), 1e3)),
              this.detectPlayerSize());
          }
          stopCapping() {
            ((this.restrictedLevels = []),
              (this.firstLevel = -1),
              (this.autoLevelCapping = Number.POSITIVE_INFINITY),
              this.timer && (self.clearInterval(this.timer), (this.timer = void 0)));
          }
          getDimensions() {
            if (this.clientRect) return this.clientRect;
            var e = this.media,
              t = { width: 0, height: 0 };
            if (e) {
              var r = e.getBoundingClientRect();
              ((t.width = r.width),
                (t.height = r.height),
                t.width ||
                  t.height ||
                  ((t.width = r.right - r.left || e.width || 0),
                  (t.height = r.bottom - r.top || e.height || 0)));
            }
            return ((this.clientRect = t), t);
          }
          get mediaWidth() {
            return this.getDimensions().width * this.contentScaleFactor;
          }
          get mediaHeight() {
            return this.getDimensions().height * this.contentScaleFactor;
          }
          get contentScaleFactor() {
            var e = 1;
            if (!this.hls.config.ignoreDevicePixelRatio)
              try {
                e = self.devicePixelRatio;
              } catch (t) {}
            return Math.min(e, this.hls.config.maxDevicePixelRatio);
          }
          isLevelAllowed(e) {
            return !this.restrictedLevels.some(
              t => e.bitrate === t.bitrate && e.width === t.width && e.height === t.height,
            );
          }
          static getMaxLevelByMediaSize(e, t, r) {
            if (null == e || !e.length) return -1;
            for (
              var i = (e, t) => !t || e.width !== t.width || e.height !== t.height,
                n = e.length - 1,
                a = Math.max(t, r),
                s = 0;
              s < e.length;
              s += 1
            ) {
              var o = e[s];
              if ((o.width >= a || o.height >= a) && i(o, e[s + 1])) {
                n = s;
                break;
              }
            }
            return n;
          }
        }
        var Og = {
            MANIFEST: "m",
            AUDIO: "a",
            VIDEO: "v",
            MUXED: "av",
            INIT: "i",
            CAPTION: "c",
            TIMED_TEXT: "tt",
            KEY: "k",
            OTHER: "o",
          },
          Ng = { HLS: "h" };
        class Fg {
          constructor(e, t) {
            (Array.isArray(e) && (e = e.map(e => (e instanceof Fg ? e : new Fg(e)))),
              (this.value = e),
              (this.params = t));
          }
        }
        function Ug(e, t, r, i) {
          return new Error(
            `failed to ${e} "${((n = t), Array.isArray(n) ? JSON.stringify(n) : n instanceof Map ? "Map{}" : n instanceof Set ? "Set{}" : "object" == typeof n ? JSON.stringify(n) : String(n))}" as ${r}`,
            { cause: i },
          );
          var n;
        }
        function Bg(e, t, r) {
          return Ug("serialize", e, t, r);
        }
        class $g {
          constructor(e) {
            this.description = e;
          }
        }
        var jg = "Bare Item";
        function Gg(e) {
          if (!1 === ArrayBuffer.isView(e)) throw Bg(e, "Byte Sequence");
          return `:${((t = e), btoa(String.fromCharCode(...t)))}:`;
          var t;
        }
        function Vg(e) {
          if (
            (function (e) {
              return e < -999999999999999 || 999999999999999 < e;
            })(e)
          )
            throw Bg(e, "Integer");
          return e.toString();
        }
        function Hg(e, t) {
          if (e < 0) return -Hg(-e, t);
          var r = Math.pow(10, t);
          if (Math.abs(((e * r) % 1) - 0.5) < Number.EPSILON) {
            var i = Math.floor(e * r);
            return (i % 2 == 0 ? i : i + 1) / r;
          }
          return Math.round(e * r) / r;
        }
        function Kg(e) {
          var t = Hg(e, 3);
          if (Math.floor(Math.abs(t)).toString().length > 12) throw Bg(e, "Decimal");
          var r = t.toString();
          return r.includes(".") ? r : `${r}.0`;
        }
        var Wg = /[\x00-\x1f\x7f]+/;
        function zg(e) {
          var t,
            r = (t = e).description || t.toString().slice(7, -1);
          if (!1 === /^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(r)) throw Bg(r, "Token");
          return r;
        }
        function qg(e) {
          switch (typeof e) {
            case "number":
              if (!bu(e)) throw Bg(e, jg);
              return Number.isInteger(e) ? Vg(e) : Kg(e);
            case "string":
              return (function (e) {
                if (Wg.test(e)) throw Bg(e, "String");
                return `"${e.replace(/\\/g, "\\\\").replace(/"/g, '\\"')}"`;
              })(e);
            case "symbol":
              return zg(e);
            case "boolean":
              return (function (e) {
                if ("boolean" != typeof e) throw Bg(e, "Boolean");
                return e ? "?1" : "?0";
              })(e);
            case "object":
              if (e instanceof Date)
                return (function (e) {
                  return `@${Vg(e.getTime() / 1e3)}`;
                })(e);
              if (e instanceof Uint8Array) return Gg(e);
              if (e instanceof $g) return zg(e);
            default:
              throw Bg(e, jg);
          }
        }
        function Xg(e) {
          if (!1 === /^[a-z*][a-z0-9\-_.*]*$/.test(e)) throw Bg(e, "Key");
          return e;
        }
        function Yg(e) {
          return null == e
            ? ""
            : Object.entries(e)
                .map(([e, t]) => (!0 === t ? `;${Xg(e)}` : `;${Xg(e)}=${qg(t)}`))
                .join("");
        }
        function Qg(e) {
          return e instanceof Fg ? `${qg(e.value)}${Yg(e.params)}` : qg(e);
        }
        function Jg(e, t = { whitespace: !0 }) {
          if ("object" != typeof e || null == e) throw Bg(e, "Dict");
          var r = e instanceof Map ? e.entries() : Object.entries(e),
            i = (null == t ? void 0 : t.whitespace) ? " " : "";
          return Array.from(r)
            .map(([e, t]) => {
              t instanceof Fg == !1 && (t = new Fg(t));
              var r,
                i = Xg(e);
              return (
                !0 === t.value
                  ? (i += Yg(t.params))
                  : ((i += "="),
                    Array.isArray(t.value)
                      ? (i += `(${(r = t).value.map(Qg).join(" ")})${Yg(r.params)}`)
                      : (i += Qg(t))),
                i
              );
            })
            .join(`,${i}`);
        }
        function Zg(e, t) {
          return Jg(e, t);
        }
        var em = "CMCD-Object",
          tm = "CMCD-Request",
          rm = "CMCD-Session",
          im = "CMCD-Status",
          nm = {
            br: em,
            ab: em,
            d: em,
            ot: em,
            tb: em,
            tpb: em,
            lb: em,
            tab: em,
            lab: em,
            url: em,
            pb: tm,
            bl: tm,
            tbl: tm,
            dl: tm,
            ltc: tm,
            mtp: tm,
            nor: tm,
            nrr: tm,
            rc: tm,
            sn: tm,
            sta: tm,
            su: tm,
            ttfb: tm,
            ttfbb: tm,
            ttlb: tm,
            cmsdd: tm,
            cmsds: tm,
            smrt: tm,
            df: tm,
            cs: tm,
            ts: tm,
            cid: rm,
            pr: rm,
            sf: rm,
            sid: rm,
            st: rm,
            v: rm,
            msd: rm,
            bs: im,
            bsd: im,
            cdn: im,
            rtp: im,
            bg: im,
            pt: im,
            ec: im,
            e: im,
          },
          am = tm;
        function sm(e, t) {
          var r = {};
          if (!e) return r;
          var i,
            n = Object.keys(e),
            a = t
              ? ((i = t),
                Object.keys(i).reduce((e, t) => {
                  var r;
                  return (null === (r = i[t]) || void 0 === r || r.forEach(r => (e[r] = t)), e);
                }, {}))
              : {};
          return n.reduce((t, r) => {
            var i,
              n = nm[r] || a[r] || am;
            return (((null !== (i = t[n]) && void 0 !== i ? i : (t[n] = {}))[r] = e[r]), t);
          }, r);
        }
        var om = "event";
        var lm = e => Math.round(e),
          um = (e, t) =>
            Array.isArray(e)
              ? e.map(e => um(e, t))
              : e instanceof Fg && "string" == typeof e.value
                ? new Fg(um(e.value, t), e.params)
                : (t.baseUrl &&
                    (e = (function (e, t) {
                      var r = new URL(e),
                        i = new URL(t);
                      if (r.origin !== i.origin) return e;
                      for (
                        var n = r.pathname.split("/").slice(1), a = i.pathname.split("/").slice(1, -1);
                        n[0] === a[0];
                      )
                        (n.shift(), a.shift());
                      for (; a.length; ) (a.shift(), n.unshift(".."));
                      return n.join("/") + r.search + r.hash;
                    })(e, t.baseUrl)),
                  1 === t.version ? encodeURIComponent(e) : e),
          dm = e => 100 * lm(e / 100),
          hm = {
            br: lm,
            d: lm,
            bl: dm,
            dl: dm,
            mtp: dm,
            nor: (e, t) => {
              var r = e;
              return (
                t.version >= 2 &&
                  (e instanceof Fg && "string" == typeof e.value
                    ? (r = new Fg([e]))
                    : "string" == typeof e && (r = [e])),
                um(r, t)
              );
            },
            rtp: dm,
            tb: lm,
          },
          cm = "request",
          fm = "response",
          pm = [
            "ab",
            "bg",
            "bl",
            "br",
            "bs",
            "bsd",
            "cdn",
            "cid",
            "cs",
            "df",
            "ec",
            "lab",
            "lb",
            "ltc",
            "msd",
            "mtp",
            "pb",
            "pr",
            "pt",
            "sf",
            "sid",
            "sn",
            "st",
            "sta",
            "tab",
            "tb",
            "tbl",
            "tpb",
            "ts",
            "v",
          ],
          gm = ["e"],
          mm = /^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;
        function vm(e) {
          return mm.test(e);
        }
        var ym = ["d", "dl", "nor", "ot", "rtp", "su"];
        var Tm = ["cmsdd", "cmsds", "rc", "smrt", "ttfb", "ttfbb", "ttlb", "url"];
        var bm = [
          "bl",
          "br",
          "bs",
          "cid",
          "d",
          "dl",
          "mtp",
          "nor",
          "nrr",
          "ot",
          "pr",
          "rtp",
          "sf",
          "sid",
          "st",
          "su",
          "tb",
          "v",
        ];
        function Sm(e) {
          return bm.includes(e) || vm(e);
        }
        var Em = {
          [fm]: function (e) {
            return pm.includes(e) || ym.includes(e) || Tm.includes(e) || vm(e);
          },
          [om]: function (e) {
            return pm.includes(e) || gm.includes(e) || vm(e);
          },
          [cm]: function (e) {
            return pm.includes(e) || ym.includes(e) || vm(e);
          },
        };
        function xm(e, t = {}) {
          var r = {};
          if (null == e || "object" != typeof e) return r;
          var i = t.version || e.v || 1,
            n = t.reportingMode || cm,
            a = 1 === i ? Sm : Em[n],
            s = Object.keys(e).filter(a),
            o = t.filter;
          "function" == typeof o && (s = s.filter(o));
          var l = n === fm || n === om;
          (l && !s.includes("ts") && s.push("ts"), i > 1 && !s.includes("v") && s.push("v"));
          var u = Nu({}, hm, t.formatters),
            d = { version: i, reportingMode: n, baseUrl: t.baseUrl };
          return (
            s.sort().forEach(t => {
              var n = e[t],
                a = u[t];
              if (("function" == typeof a && (n = a(n, d)), "v" === t)) {
                if (1 === i) return;
                n = i;
              }
              ("pr" == t && 1 === n) ||
                (l && "ts" === t && !bu(n) && (n = Date.now()),
                (function (e) {
                  return "number" == typeof e ? bu(e) : null != e && "" !== e && !1 !== e;
                })(n) &&
                  ((function (e) {
                    return ["ot", "sf", "st", "e", "sta"].includes(e);
                  })(t) &&
                    "string" == typeof n &&
                    (n = new $g(n)),
                  (r[t] = n)));
            }),
            r
          );
        }
        function wm(e, t, r) {
          return Nu(
            e,
            (function (e, t = {}) {
              var r = {};
              if (!e) return r;
              var i = sm(xm(e, t), null == t ? void 0 : t.customHeaderMap);
              return Object.entries(i).reduce((e, [t, r]) => {
                var i = Zg(r, { whitespace: !1 });
                return (i && (e[t] = i), e);
              }, r);
            })(t, r),
          );
        }
        function Am(e, t = {}) {
          if (!e) return "";
          var r = (function (e, t = {}) {
            return e ? Zg(xm(e, t), { whitespace: !1 }) : "";
          })(e, t);
          return encodeURIComponent(r);
        }
        var Im = /CMCD=[^&#]+/;
        function km(e, t, r) {
          var i = (function (e, t = {}) {
            return e ? `CMCD=${Am(e, t)}` : "";
          })(t, r);
          if (!i) return e;
          if (Im.test(e)) return e.replace(Im, i);
          var n = e.includes("?") ? "&" : "?";
          return `${e}${n}${i}`;
        }
        function Rm(e, t, r, i) {
          e &&
            Object.keys(t).forEach(n => {
              var a = e
                .filter(e => e.groupId === n)
                .map(e => {
                  var a = Nu({}, e);
                  return (
                    (a.details = void 0),
                    (a.attrs = new Sc(a.attrs)),
                    (a.url = a.attrs.URI =
                      Cm(e.url, e.attrs["STABLE-RENDITION-ID"], "PER-RENDITION-URIS", r)),
                    (a.groupId = a.attrs["GROUP-ID"] = t[n]),
                    (a.attrs["PATHWAY-ID"] = i),
                    a
                  );
                });
              e.push(...a);
            });
        }
        function Cm(e, t, r, i) {
          var n,
            a = i.HOST,
            s = i.PARAMS,
            o = i[r];
          t && (n = null == o ? void 0 : o[t]) && (e = n);
          var l = new self.URL(e);
          return (
            a && !n && (l.host = a),
            s &&
              Object.keys(s)
                .sort()
                .forEach(e => {
                  e && l.searchParams.set(e, s[e]);
                }),
            l.href
          );
        }
        class Lm extends Bu {
          constructor(e) {
            var t;
            (super("eme", e.logger),
              (t = this),
              (this.hls = void 0),
              (this.config = void 0),
              (this.media = null),
              (this.mediaResolved = void 0),
              (this.keyFormatPromise = null),
              (this.keySystemAccessPromises = {}),
              (this._requestLicenseFailureCount = 0),
              (this.mediaKeySessions = []),
              (this.keyIdToKeySessionPromise = {}),
              (this.mediaKeys = null),
              (this.setMediaKeysQueue = Lm.CDMCleanupPromise ? [Lm.CDMCleanupPromise] : []),
              (this.bannedKeyIds = {}),
              (this.onMediaEncrypted = e => {
                var r = e.initDataType,
                  i = e.initData,
                  n = `"${e.type}" event: init data type: "${r}"`;
                if ((this.debug(n), null !== i)) {
                  if (!this.keyFormatPromise) {
                    var a = Object.keys(this.keySystemAccessPromises);
                    a.length || (a = Gc(this.config));
                    var s = a.map(jc).filter(e => !!e);
                    this.keyFormatPromise = this.getKeyFormatPromise(s);
                  }
                  this.keyFormatPromise
                    .then(a => {
                      var s = $c(a);
                      if ("sinf" === r && s === Oc.FAIRPLAY) {
                        var o;
                        try {
                          var l = fd(new Uint8Array(i)),
                            u = kd(Lc(JSON.parse(l).sinf));
                          if (!u) throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");
                          o = new Uint8Array(u.subarray(8, 24));
                        } catch (v) {
                          return void this.warn(`${n} Failed to parse sinf: ${v}`);
                        }
                        for (
                          var d,
                            h = Xu(o),
                            c = this.keyIdToKeySessionPromise,
                            f = this.mediaKeySessions,
                            p = c[h],
                            g = function () {
                              var e = f[m],
                                n = e.decryptdata;
                              if (!n.keyId) return 0;
                              var a = Xu(n.keyId);
                              return Ic(o, n.keyId) || -1 !== n.uri.replace(/-/g, "").indexOf(h)
                                ? (p = c[a])
                                  ? (n.pssh ||
                                      (delete c[a],
                                      (n.pssh = new Uint8Array(i)),
                                      (n.keyId = o),
                                      (p = c[h] =
                                        p.then(() =>
                                          t.generateRequestWithPreferredKeySession(
                                            e,
                                            r,
                                            i,
                                            "encrypted-event-key-match",
                                          ),
                                        )).catch(e => t.handleError(e))),
                                    1)
                                  : 0
                                : void 0;
                            },
                            m = 0;
                          m < f.length && (0 === (d = g()) || 1 !== d);
                          m++
                        );
                        p ||
                          this.handleError(
                            new Error(
                              `Key ID ${h} not encountered in playlist. Key-system sessions ${f.length}.`,
                            ),
                          );
                      } else
                        this.log(
                          `Ignoring "${e.type}" event with init data type: "${r}" for selected key-system ${s}`,
                        );
                    })
                    .catch(e => this.handleError(e));
                }
              }),
              (this.onWaitingForKey = e => {
                this.log(`"${e.type}" event`);
              }),
              (this.hls = e),
              (this.config = e.config),
              this.registerListeners());
          }
          destroy() {
            (this.onDestroying(), this.onMediaDetached());
            var e = this.config;
            ((e.requestMediaKeySystemAccessFunc = null),
              (e.licenseXhrSetup = e.licenseResponseCallback = void 0),
              (e.drmSystems = e.drmSystemOptions = {}),
              (this.hls = this.config = this.keyIdToKeySessionPromise = null),
              (this.onMediaEncrypted = this.onWaitingForKey = null));
          }
          registerListeners() {
            (this.hls.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              this.hls.on(Au.MEDIA_DETACHED, this.onMediaDetached, this),
              this.hls.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              this.hls.on(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
              this.hls.on(Au.DESTROYING, this.onDestroying, this));
          }
          unregisterListeners() {
            (this.hls.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              this.hls.off(Au.MEDIA_DETACHED, this.onMediaDetached, this),
              this.hls.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              this.hls.off(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
              this.hls.off(Au.DESTROYING, this.onDestroying, this));
          }
          getLicenseServerUrl(e) {
            var t = this.config,
              r = t.drmSystems,
              i = t.widevineLicenseUrl,
              n = null == r ? void 0 : r[e];
            return n ? n.licenseUrl : e === Oc.WIDEVINE && i ? i : void 0;
          }
          getLicenseServerUrlOrThrow(e) {
            var t = this.getLicenseServerUrl(e);
            if (void 0 === t) throw new Error(`no license server URL configured for key-system "${e}"`);
            return t;
          }
          getServerCertificateUrl(e) {
            var t = this.config.drmSystems,
              r = null == t ? void 0 : t[e];
            if (r) return r.serverCertificateUrl;
            this.log(`No Server Certificate in config.drmSystems["${e}"]`);
          }
          attemptKeySystemAccess(e) {
            var t = this.hls.levels,
              r = (e, t, r) => !!e && r.indexOf(e) === t,
              i = t.map(e => e.audioCodec).filter(r),
              n = t.map(e => e.videoCodec).filter(r);
            return (
              i.length + n.length === 0 && n.push("avc1.42e01e"),
              new Promise((t, r) => {
                var a = e => {
                  var s = e.shift();
                  this.getMediaKeysPromise(s, i, n)
                    .then(e => t({ keySystem: s, mediaKeys: e }))
                    .catch(t => {
                      e.length
                        ? a(e)
                        : r(
                            t instanceof _m
                              ? t
                              : new _m(
                                  {
                                    type: xu.KEY_SYSTEM_ERROR,
                                    details: wu.KEY_SYSTEM_NO_ACCESS,
                                    error: t,
                                    fatal: !0,
                                  },
                                  t.message,
                                ),
                          );
                    });
                };
                a(e);
              })
            );
          }
          requestMediaKeySystemAccess(e, t) {
            var r = this.config.requestMediaKeySystemAccessFunc;
            if ("function" != typeof r) {
              var i = `Configured requestMediaKeySystemAccess is not a function ${r}`;
              return (
                null === Hc &&
                  "http:" === self.location.protocol &&
                  (i = `navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),
                Promise.reject(new Error(i))
              );
            }
            return r(e, t);
          }
          getMediaKeysPromise(e, t, r) {
            var i,
              n = (function (e, t, r, i) {
                var n;
                switch (e) {
                  case Oc.FAIRPLAY:
                    n = ["cenc", "sinf"];
                    break;
                  case Oc.WIDEVINE:
                  case Oc.PLAYREADY:
                    n = ["cenc"];
                    break;
                  case Oc.CLEARKEY:
                    n = ["cenc", "keyids"];
                    break;
                  default:
                    throw new Error(`Unknown key-system: ${e}`);
                }
                return (function (e, t, r, i) {
                  return [
                    {
                      initDataTypes: e,
                      persistentState: i.persistentState || "optional",
                      distinctiveIdentifier: i.distinctiveIdentifier || "optional",
                      sessionTypes: i.sessionTypes || [i.sessionType || "temporary"],
                      audioCapabilities: t.map(e => ({
                        contentType: `audio/mp4; codecs=${e}`,
                        robustness: i.audioRobustness || "",
                        encryptionScheme: i.audioEncryptionScheme || null,
                      })),
                      videoCapabilities: r.map(e => ({
                        contentType: `video/mp4; codecs=${e}`,
                        robustness: i.videoRobustness || "",
                        encryptionScheme: i.videoEncryptionScheme || null,
                      })),
                    },
                  ];
                })(n, t, r, i);
              })(e, t, r, this.config.drmSystemOptions || {}),
              a = this.keySystemAccessPromises[e],
              s = null == (i = a) ? void 0 : i.keySystemAccess;
            if (!s) {
              (this.log(`Requesting encrypted media "${e}" key-system access with config: ${ph(n)}`),
                (s = this.requestMediaKeySystemAccess(e, n)));
              var o = (a = this.keySystemAccessPromises[e] = { keySystemAccess: s });
              return (
                s.catch(t => {
                  this.log(`Failed to obtain access to key-system "${e}": ${t}`);
                }),
                s.then(t => {
                  this.log(`Access for key-system "${t.keySystem}" obtained`);
                  var r = this.fetchServerCertificate(e);
                  this.log(`Create media-keys for "${e}"`);
                  var i = (o.mediaKeys = t
                    .createMediaKeys()
                    .then(
                      t => (
                        this.log(`Media-keys created for "${e}"`),
                        (o.hasMediaKeys = !0),
                        r.then(r => (r ? this.setMediaKeysServerCertificate(t, e, r) : t))
                      ),
                    ));
                  return (
                    i.catch(t => {
                      this.error(`Failed to create media-keys for "${e}"}: ${t}`);
                    }),
                    i
                  );
                })
              );
            }
            return s.then(() => a.mediaKeys);
          }
          createMediaKeySessionContext({ decryptdata: e, keySystem: t, mediaKeys: r }) {
            this.log(`Creating key-system session "${t}" keyId: ${Xu(e.keyId || [])} keyUri: ${e.uri}`);
            var i = r.createSession(),
              n = {
                decryptdata: e,
                keySystem: t,
                mediaKeys: r,
                mediaKeysSession: i,
                keyStatus: "status-pending",
              };
            return (this.mediaKeySessions.push(n), n);
          }
          renewKeySession(e) {
            var t = e.decryptdata;
            if (t.pssh) {
              var r = this.createMediaKeySessionContext(e),
                i = Mm(t);
              this.keyIdToKeySessionPromise[i] = this.generateRequestWithPreferredKeySession(
                r,
                "cenc",
                t.pssh.buffer,
                "expired",
              );
            } else this.warn("Could not renew expired session. Missing pssh initData.");
            this.removeSession(e);
          }
          updateKeySession(e, t) {
            var r = e.mediaKeysSession;
            return (
              this.log(
                `Updating key-session "${r.sessionId}" for keyId ${Xu(e.decryptdata.keyId || [])}\n      } (data length: ${t.byteLength})`,
              ),
              r.update(t)
            );
          }
          getSelectedKeySystemFormats() {
            return Object.keys(this.keySystemAccessPromises)
              .map(e => ({ keySystem: e, hasMediaKeys: this.keySystemAccessPromises[e].hasMediaKeys }))
              .filter(({ hasMediaKeys: e }) => !!e)
              .map(({ keySystem: e }) => jc(e))
              .filter(e => !!e);
          }
          getKeySystemAccess(e) {
            return this.getKeySystemSelectionPromise(e).then(({ keySystem: e, mediaKeys: t }) =>
              this.attemptSetMediaKeys(e, t),
            );
          }
          selectKeySystem(e) {
            return new Promise((t, r) => {
              this.getKeySystemSelectionPromise(e)
                .then(({ keySystem: e }) => {
                  var i = jc(e);
                  i ? t(i) : r(new Error(`Unable to find format for key-system "${e}"`));
                })
                .catch(r);
            });
          }
          selectKeySystemFormat(e) {
            var t = Object.keys(e.levelkeys || {});
            return (
              this.keyFormatPromise ||
                (this.log(
                  `Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`,
                ),
                (this.keyFormatPromise = this.getKeyFormatPromise(t))),
              this.keyFormatPromise
            );
          }
          getKeyFormatPromise(e) {
            var t = Gc(this.config),
              r = e.map($c).filter(e => !!e && -1 !== t.indexOf(e));
            return this.selectKeySystem(r);
          }
          getKeyStatus(e) {
            for (var t = this.mediaKeySessions, r = 0; r < t.length; r++) {
              var i = Dm(e, t[r]);
              if (i) return i;
            }
          }
          loadKey(e) {
            var t = e.keyInfo.decryptdata,
              r = Mm(t),
              i = this.bannedKeyIds[r];
            if (i || "internal-error" === this.getKeyStatus(t)) {
              var n = Pm(i || "internal-error", t);
              return (this.handleError(n, e.frag), Promise.reject(n));
            }
            var a = `(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;
            this.log(`Starting session for key ${a}`);
            var s = this.keyIdToKeySessionPromise[r];
            if (!s) {
              var o = this.getKeySystemForKeyPromise(t)
                .then(
                  ({ keySystem: r, mediaKeys: i }) => (
                    this.throwIfDestroyed(),
                    this.log(
                      `Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${a}`,
                    ),
                    this.attemptSetMediaKeys(r, i).then(
                      () => (
                        this.throwIfDestroyed(),
                        this.createMediaKeySessionContext({ keySystem: r, mediaKeys: i, decryptdata: t })
                      ),
                    )
                  ),
                )
                .then(e => {
                  var r = t.pssh ? t.pssh.buffer : null;
                  return this.generateRequestWithPreferredKeySession(e, "cenc", r, "playlist-key");
                });
              return (o.catch(t => this.handleError(t, e.frag)), (this.keyIdToKeySessionPromise[r] = o), o);
            }
            return (
              s.catch(r => {
                if (r instanceof _m) {
                  var i = Uu({}, r.data);
                  "internal-error" === this.getKeyStatus(t) && (i.decryptdata = t);
                  var n = new _m(i, r.message);
                  this.handleError(n, e.frag);
                }
              }),
              s
            );
          }
          throwIfDestroyed(e = "Invalid state") {
            if (!this.hls) throw new Error("invalid state");
          }
          handleError(e, t) {
            if (this.hls)
              if (e instanceof _m) {
                t && (e.data.frag = t);
                var r = e.data.decryptdata;
                (this.error(`${e.message}${r ? ` (${Xu(r.keyId || [])})` : ""}`),
                  this.hls.trigger(Au.ERROR, e.data));
              } else
                (this.error(e.message),
                  this.hls.trigger(Au.ERROR, {
                    type: xu.KEY_SYSTEM_ERROR,
                    details: wu.KEY_SYSTEM_NO_KEYS,
                    error: e,
                    fatal: !0,
                  }));
          }
          getKeySystemForKeyPromise(e) {
            var t = Mm(e),
              r = this.keyIdToKeySessionPromise[t];
            if (!r) {
              var i = $c(e.keyFormat),
                n = i ? [i] : Gc(this.config);
              return this.attemptKeySystemAccess(n);
            }
            return r;
          }
          getKeySystemSelectionPromise(e) {
            if ((e.length || (e = Gc(this.config)), 0 === e.length))
              throw new _m(
                { type: xu.KEY_SYSTEM_ERROR, details: wu.KEY_SYSTEM_NO_CONFIGURED_LICENSE, fatal: !0 },
                `Missing key-system license configuration options ${ph({ drmSystems: this.config.drmSystems })}`,
              );
            return this.attemptKeySystemAccess(e);
          }
          attemptSetMediaKeys(e, t) {
            if (((this.mediaResolved = void 0), this.mediaKeys === t)) return Promise.resolve();
            var r = this.setMediaKeysQueue.slice();
            this.log(`Setting media-keys for "${e}"`);
            var i = Promise.all(r).then(() =>
              this.media
                ? this.media.setMediaKeys(t)
                : new Promise((e, r) => {
                    this.mediaResolved = () => {
                      if (((this.mediaResolved = void 0), !this.media))
                        return r(new Error("Attempted to set mediaKeys without media element attached"));
                      ((this.mediaKeys = t), this.media.setMediaKeys(t).then(e).catch(r));
                    };
                  }),
            );
            return (
              (this.mediaKeys = t),
              this.setMediaKeysQueue.push(i),
              i.then(() => {
                (this.log(`Media-keys set for "${e}"`),
                  r.push(i),
                  (this.setMediaKeysQueue = this.setMediaKeysQueue.filter(e => -1 === r.indexOf(e))));
              })
            );
          }
          generateRequestWithPreferredKeySession(e, t, r, i) {
            var n,
              a =
                null == (n = this.config.drmSystems) || null == (n = n[e.keySystem])
                  ? void 0
                  : n.generateRequest;
            if (a)
              try {
                var s = a.call(this.hls, t, r, e);
                if (!s) throw new Error("Invalid response from configured generateRequest filter");
                ((t = s.initDataType),
                  (r = s.initData ? s.initData : null),
                  (e.decryptdata.pssh = r ? new Uint8Array(r) : null));
              } catch (p) {
                if ((this.warn(p.message), this.hls && this.hls.config.debug)) throw p;
              }
            if (null === r)
              return (this.log(`Skipping key-session request for "${i}" (no initData)`), Promise.resolve(e));
            var o = Mm(e.decryptdata),
              l = e.decryptdata.uri;
            this.log(
              `Generating key-session request for "${i}" keyId: ${o} URI: ${l} (init data type: ${t} length: ${r.byteLength})`,
            );
            var u = new Jf(),
              d = (e._onmessage = t => {
                var r = e.mediaKeysSession;
                if (r) {
                  var i = t.messageType,
                    n = t.message;
                  (this.log(
                    `"${i}" message event for session "${r.sessionId}" message size: ${n.byteLength}`,
                  ),
                    "license-request" === i || "license-renewal" === i
                      ? this.renewLicense(e, n).catch(e => {
                          u.eventNames().length ? u.emit("error", e) : this.handleError(e);
                        })
                      : "license-release" === i
                        ? e.keySystem === Oc.FAIRPLAY &&
                          this.updateKeySession(e, Mc("acknowledged"))
                            .then(() => this.removeSession(e))
                            .catch(e => this.handleError(e))
                        : this.warn(`unhandled media key message type "${i}"`));
                } else u.emit("error", new Error("invalid state"));
              }),
              h = (e, t) => {
                var r;
                ((t.keyStatus = e),
                  e.startsWith("usable")
                    ? u.emit("resolved")
                    : "internal-error" === e || "output-restricted" === e || "output-downscaled" === e
                      ? (r = Pm(e, t.decryptdata))
                      : "expired" === e
                        ? (r = new Error(`key expired (keyId: ${o})`))
                        : "released" === e
                          ? (r = new Error("key released"))
                          : "status-pending" === e ||
                            this.warn(`unhandled key status change "${e}" (keyId: ${o})`),
                  r && (u.eventNames().length ? u.emit("error", r) : this.handleError(r)));
              },
              c = (e._onkeystatuseschange = t => {
                if (e.mediaKeysSession) {
                  var r = this.getKeyStatuses(e);
                  if (Object.keys(r).some(e => "status-pending" !== r[e])) {
                    if ("expired" === r[o])
                      return (
                        this.log(`Expired key ${ph(r)} in key-session "${e.mediaKeysSession.sessionId}"`),
                        void this.renewKeySession(e)
                      );
                    var i = r[o];
                    if (i) h(i, e);
                    else {
                      var n;
                      (e.keyStatusTimeouts || (e.keyStatusTimeouts = {}),
                        (n = e.keyStatusTimeouts)[o] ||
                          (n[o] = self.setTimeout(() => {
                            if (e.mediaKeysSession && this.mediaKeys) {
                              var t = this.getKeyStatus(e.decryptdata);
                              if (t && "status-pending" !== t)
                                return (
                                  this.log(
                                    `No status for keyId ${o} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${t} from other session.`,
                                  ),
                                  h(t, e)
                                );
                              (this.log(
                                `key status for ${o} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`,
                              ),
                                h((i = "internal-error"), e));
                            }
                          }, 1e3)),
                        this.log(`No status for keyId ${o} (${ph(r)}).`));
                    }
                  }
                } else u.emit("error", new Error("invalid state"));
              });
            (Mf(e.mediaKeysSession, "message", d), Mf(e.mediaKeysSession, "keystatuseschange", c));
            var f = new Promise((e, t) => {
              (u.on("error", t), u.on("resolved", e));
            });
            return e.mediaKeysSession
              .generateRequest(t, r)
              .then(() => {
                this.log(
                  `Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${o} URI: ${l}`,
                );
              })
              .catch(t => {
                throw new _m(
                  {
                    type: xu.KEY_SYSTEM_ERROR,
                    details: wu.KEY_SYSTEM_NO_SESSION,
                    error: t,
                    decryptdata: e.decryptdata,
                    fatal: !1,
                  },
                  `Error generating key-session request: ${t}`,
                );
              })
              .then(() => f)
              .catch(
                t => (
                  u.removeAllListeners(),
                  this.removeSession(e).then(() => {
                    throw t;
                  })
                ),
              )
              .then(() => (u.removeAllListeners(), e));
          }
          getKeyStatuses(e) {
            var t = {};
            return (
              e.mediaKeysSession.keyStatuses.forEach((r, i) => {
                if ("string" == typeof i && "object" == typeof r) {
                  var n = i;
                  ((i = r), (r = n));
                }
                var a =
                  "buffer" in i ? new Uint8Array(i.buffer, i.byteOffset, i.byteLength) : new Uint8Array(i);
                if (e.keySystem === Oc.PLAYREADY && 16 === a.length) {
                  var s = Xu(a);
                  ((t[s] = r), Dc(a));
                }
                var o = Xu(a);
                ("internal-error" === r && (this.bannedKeyIds[o] = r),
                  this.log(
                    `key status change "${r}" for keyStatuses keyId: ${o} key-session "${e.mediaKeysSession.sessionId}"`,
                  ),
                  (t[o] = r));
              }),
              t
            );
          }
          fetchServerCertificate(e) {
            var t = this.config,
              r = new (0, t.loader)(t),
              i = this.getServerCertificateUrl(e);
            return i
              ? (this.log(`Fetching server certificate for "${e}"`),
                new Promise((n, a) => {
                  var s = { responseType: "arraybuffer", url: i },
                    o = t.certLoadPolicy.default,
                    l = {
                      loadPolicy: o,
                      timeout: o.maxLoadTimeMs,
                      maxRetry: 0,
                      retryDelay: 0,
                      maxRetryDelay: 0,
                    },
                    u = {
                      onSuccess: (e, t, r, i) => {
                        n(e.data);
                      },
                      onError: (t, r, n, o) => {
                        a(
                          new _m(
                            {
                              type: xu.KEY_SYSTEM_ERROR,
                              details: wu.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,
                              fatal: !0,
                              networkDetails: n,
                              response: Uu({ url: s.url, data: void 0 }, t),
                            },
                            `"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`,
                          ),
                        );
                      },
                      onTimeout: (t, r, n) => {
                        a(
                          new _m(
                            {
                              type: xu.KEY_SYSTEM_ERROR,
                              details: wu.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,
                              fatal: !0,
                              networkDetails: n,
                              response: { url: s.url, data: void 0 },
                            },
                            `"${e}" certificate request timed out (${i})`,
                          ),
                        );
                      },
                      onAbort: (e, t, r) => {
                        a(new Error("aborted"));
                      },
                    };
                  r.load(s, l, u);
                }))
              : Promise.resolve();
          }
          setMediaKeysServerCertificate(e, t, r) {
            return new Promise((i, n) => {
              e.setServerCertificate(r)
                .then(n => {
                  (this.log(
                    `setServerCertificate ${n ? "success" : "not supported by CDM"} (${r.byteLength}) on "${t}"`,
                  ),
                    i(e));
                })
                .catch(e => {
                  n(
                    new _m(
                      {
                        type: xu.KEY_SYSTEM_ERROR,
                        details: wu.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,
                        error: e,
                        fatal: !0,
                      },
                      e.message,
                    ),
                  );
                });
            });
          }
          renewLicense(e, t) {
            return this.requestLicense(e, new Uint8Array(t)).then(t =>
              this.updateKeySession(e, new Uint8Array(t)).catch(t => {
                throw new _m(
                  {
                    type: xu.KEY_SYSTEM_ERROR,
                    details: wu.KEY_SYSTEM_SESSION_UPDATE_FAILED,
                    decryptdata: e.decryptdata,
                    error: t,
                    fatal: !1,
                  },
                  t.message,
                );
              }),
            );
          }
          unpackPlayReadyKeyMessage(e, t) {
            var r = String.fromCharCode.apply(null, new Uint16Array(t.buffer));
            if (!r.includes("PlayReadyKeyMessage"))
              return (e.setRequestHeader("Content-Type", "text/xml; charset=utf-8"), t);
            var i = new DOMParser().parseFromString(r, "application/xml"),
              n = i.querySelectorAll("HttpHeader");
            if (n.length > 0)
              for (var a, s = 0, o = n.length; s < o; s++) {
                var l,
                  u,
                  d = null == (l = (a = n[s]).querySelector("name")) ? void 0 : l.textContent,
                  h = null == (u = a.querySelector("value")) ? void 0 : u.textContent;
                d && h && e.setRequestHeader(d, h);
              }
            var c = i.querySelector("Challenge"),
              f = null == c ? void 0 : c.textContent;
            if (!f) throw new Error("Cannot find <Challenge> in key message");
            return Mc(atob(f));
          }
          setupLicenseXHR(e, t, r, i) {
            var n = this.config.licenseXhrSetup;
            return n
              ? Promise.resolve()
                  .then(() => {
                    if (!r.decryptdata) throw new Error("Key removed");
                    return n.call(this.hls, e, t, r, i);
                  })
                  .catch(a => {
                    if (!r.decryptdata) throw a;
                    return (e.open("POST", t, !0), n.call(this.hls, e, t, r, i));
                  })
                  .then(r => (e.readyState || e.open("POST", t, !0), { xhr: e, licenseChallenge: r || i }))
              : (e.open("POST", t, !0), Promise.resolve({ xhr: e, licenseChallenge: i }));
          }
          requestLicense(e, t) {
            var r = this.config.keyLoadPolicy.default;
            return new Promise((i, n) => {
              var a = this.getLicenseServerUrlOrThrow(e.keySystem);
              this.log(`Sending license request to URL: ${a}`);
              var s = new XMLHttpRequest();
              ((s.responseType = "arraybuffer"),
                (s.onreadystatechange = () => {
                  if (!this.hls || !e.mediaKeysSession) return n(new Error("invalid state"));
                  if (4 === s.readyState)
                    if (200 === s.status) {
                      this._requestLicenseFailureCount = 0;
                      var o = s.response;
                      this.log(`License received ${o instanceof ArrayBuffer ? o.byteLength : o}`);
                      var l = this.config.licenseResponseCallback;
                      if (l)
                        try {
                          o = l.call(this.hls, s, a, e);
                        } catch (c) {
                          this.error(c);
                        }
                      i(o);
                    } else {
                      var u = r.errorRetry,
                        d = u ? u.maxNumRetry : 0;
                      if (
                        (this._requestLicenseFailureCount++,
                        this._requestLicenseFailureCount > d || (s.status >= 400 && s.status < 500))
                      )
                        n(
                          new _m(
                            {
                              type: xu.KEY_SYSTEM_ERROR,
                              details: wu.KEY_SYSTEM_LICENSE_REQUEST_FAILED,
                              decryptdata: e.decryptdata,
                              fatal: !0,
                              networkDetails: s,
                              response: { url: a, data: void 0, code: s.status, text: s.statusText },
                            },
                            `License Request XHR failed (${a}). Status: ${s.status} (${s.statusText})`,
                          ),
                        );
                      else {
                        var h = d - this._requestLicenseFailureCount + 1;
                        (this.warn(`Retrying license request, ${h} attempts left`),
                          this.requestLicense(e, t).then(i, n));
                      }
                    }
                }),
                e.licenseXhr && e.licenseXhr.readyState !== XMLHttpRequest.DONE && e.licenseXhr.abort(),
                (e.licenseXhr = s),
                this.setupLicenseXHR(s, a, e, t)
                  .then(({ xhr: t, licenseChallenge: r }) => {
                    (e.keySystem == Oc.PLAYREADY && (r = this.unpackPlayReadyKeyMessage(t, r)), t.send(r));
                  })
                  .catch(n));
            });
          }
          onDestroying() {
            (this.unregisterListeners(), this._clear());
          }
          onMediaAttached(e, t) {
            if (this.config.emeEnabled) {
              var r = t.media;
              ((this.media = r),
                Mf(r, "encrypted", this.onMediaEncrypted),
                Mf(r, "waitingforkey", this.onWaitingForKey));
              var i = this.mediaResolved;
              i ? i() : (this.mediaKeys = r.mediaKeys);
            }
          }
          onMediaDetached() {
            var e = this.media;
            e &&
              (Df(e, "encrypted", this.onMediaEncrypted),
              Df(e, "waitingforkey", this.onWaitingForKey),
              (this.media = null),
              (this.mediaKeys = null));
          }
          _clear() {
            var e;
            ((this._requestLicenseFailureCount = 0),
              (this.keyIdToKeySessionPromise = {}),
              (this.bannedKeyIds = {}));
            var t = this.mediaResolved;
            if ((t && t(), this.mediaKeys || this.mediaKeySessions.length)) {
              var r = this.media,
                i = this.mediaKeySessions.slice();
              ((this.mediaKeySessions = []), (this.mediaKeys = null), zc.clearKeyUriToKeyIdMap());
              var n = i.length;
              Lm.CDMCleanupPromise = Promise.all(
                i
                  .map(e => this.removeSession(e))
                  .concat(
                    (null == r || null == (e = r.setMediaKeys(null))
                      ? void 0
                      : e.catch(e => {
                          (this.log(`Could not clear media keys: ${e}`),
                            this.hls &&
                              this.hls.trigger(Au.ERROR, {
                                type: xu.OTHER_ERROR,
                                details: wu.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,
                                fatal: !1,
                                error: new Error(`Could not clear media keys: ${e}`),
                              }));
                        })) || Promise.resolve(),
                  ),
              )
                .catch(e => {
                  (this.log(`Could not close sessions and clear media keys: ${e}`),
                    this.hls &&
                      this.hls.trigger(Au.ERROR, {
                        type: xu.OTHER_ERROR,
                        details: wu.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,
                        fatal: !1,
                        error: new Error(`Could not close sessions and clear media keys: ${e}`),
                      }));
                })
                .then(() => {
                  n && this.log("finished closing key sessions and clearing media keys");
                });
            }
          }
          onManifestLoading() {
            this._clear();
          }
          onManifestLoaded(e, { sessionKeys: t }) {
            if (t && this.config.emeEnabled && !this.keyFormatPromise) {
              var r = t.reduce((e, t) => (-1 === e.indexOf(t.keyFormat) && e.push(t.keyFormat), e), []);
              (this.log(`Selecting key-system from session-keys ${r.join(", ")}`),
                (this.keyFormatPromise = this.getKeyFormatPromise(r)));
            }
          }
          removeSession(e) {
            var t = e.mediaKeysSession,
              r = e.licenseXhr,
              i = e.decryptdata;
            if (t) {
              (this.log(
                `Remove licenses and keys and close session "${t.sessionId}" keyId: ${Xu((null == i ? void 0 : i.keyId) || [])}`,
              ),
                e._onmessage && (t.removeEventListener("message", e._onmessage), (e._onmessage = void 0)),
                e._onkeystatuseschange &&
                  (t.removeEventListener("keystatuseschange", e._onkeystatuseschange),
                  (e._onkeystatuseschange = void 0)),
                r && r.readyState !== XMLHttpRequest.DONE && r.abort(),
                (e.mediaKeysSession = e.decryptdata = e.licenseXhr = void 0));
              var n = this.mediaKeySessions.indexOf(e);
              n > -1 && this.mediaKeySessions.splice(n, 1);
              var a = e.keyStatusTimeouts;
              a && Object.keys(a).forEach(e => self.clearTimeout(a[e]));
              var s = (function (e) {
                var t;
                return !(
                  !e ||
                  ("persistent-license" !== e.sessionType &&
                    (null == (t = e.sessionTypes) || !t.some(e => "persistent-license" === e)))
                );
              })(this.config.drmSystemOptions)
                ? new Promise((e, r) => {
                    (self.setTimeout(() => r(new Error("MediaKeySession.remove() timeout")), 8e3),
                      t.remove().then(e).catch(r));
                  })
                : Promise.resolve();
              return s
                .catch(e => {
                  (this.log(`Could not remove session: ${e}`),
                    this.hls &&
                      this.hls.trigger(Au.ERROR, {
                        type: xu.OTHER_ERROR,
                        details: wu.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,
                        fatal: !1,
                        error: new Error(`Could not remove session: ${e}`),
                      }));
                })
                .then(() => t.close())
                .catch(e => {
                  (this.log(`Could not close session: ${e}`),
                    this.hls &&
                      this.hls.trigger(Au.ERROR, {
                        type: xu.OTHER_ERROR,
                        details: wu.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,
                        fatal: !1,
                        error: new Error(`Could not close session: ${e}`),
                      }));
                });
            }
            return Promise.resolve();
          }
        }
        function Mm(e) {
          if (!e) throw new Error("Could not read keyId of undefined decryptdata");
          if (null === e.keyId) throw new Error("keyId is null");
          return Xu(e.keyId);
        }
        function Dm(e, t) {
          return e.keyId && t.mediaKeysSession.keyStatuses.has(e.keyId)
            ? t.mediaKeysSession.keyStatuses.get(e.keyId)
            : e.matches(t.decryptdata)
              ? t.keyStatus
              : void 0;
        }
        Lm.CDMCleanupPromise = void 0;
        class _m extends Error {
          constructor(e, t) {
            (super(t),
              (this.data = void 0),
              e.error || (e.error = new Error(t)),
              (this.data = e),
              (e.err = e.error));
          }
        }
        function Pm(e, t) {
          var r = "output-restricted" === e,
            i = r ? wu.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED : wu.KEY_SYSTEM_STATUS_INTERNAL_ERROR;
          return new _m(
            { type: xu.KEY_SYSTEM_ERROR, details: i, fatal: !1, decryptdata: t },
            r ? "HDCP level output restricted" : `key status changed to "${e}"`,
          );
        }
        function Om(e, t) {
          var r;
          try {
            r = new Event("addtrack");
          } catch (Zy) {
            (r = document.createEvent("Event")).initEvent("addtrack", !1, !1);
          }
          ((r.track = e), t.dispatchEvent(r));
        }
        function Nm(e, t) {
          var r = e.mode;
          if (("disabled" === r && (e.mode = "hidden"), e.cues && !e.cues.getCueById(t.id)))
            try {
              if ((e.addCue(t), !e.cues.getCueById(t.id))) throw new Error(`addCue is failed for: ${t}`);
            } catch (Zy) {
              Ku.debug(`[texttrack-utils]: ${Zy}`);
              try {
                var i = new self.TextTrackCue(t.startTime, t.endTime, t.text);
                ((i.id = t.id), e.addCue(i));
              } catch (n) {
                Ku.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`);
              }
            }
          "disabled" === r && (e.mode = r);
        }
        function Fm(e, t) {
          var r = e.mode;
          if (("disabled" === r && (e.mode = "hidden"), e.cues))
            for (var i = e.cues.length; i--; )
              (t && e.cues[i].removeEventListener("enter", t), e.removeCue(e.cues[i]));
          "disabled" === r && (e.mode = r);
        }
        function Um(e, t, r, i) {
          var n = e.mode;
          if (("disabled" === n && (e.mode = "hidden"), e.cues && e.cues.length > 0))
            for (
              var a = (function (e, t, r) {
                  var i = [],
                    n = (function (e, t) {
                      if (t <= e[0].startTime) return 0;
                      var r = e.length - 1;
                      if (t > e[r].endTime) return -1;
                      var i,
                        n = 0,
                        a = r;
                      for (; n <= a; )
                        if (t < e[(i = Math.floor((a + n) / 2))].startTime) a = i - 1;
                        else {
                          if (!(t > e[i].startTime && n < r)) return i;
                          n = i + 1;
                        }
                      return e[n].startTime - t < t - e[a].startTime ? n : a;
                    })(e, t);
                  if (n > -1)
                    for (var a = n, s = e.length; a < s; a++) {
                      var o = e[a];
                      if (o.startTime >= t && o.endTime <= r) i.push(o);
                      else if (o.startTime > r) return i;
                    }
                  return i;
                })(e.cues, t, r),
                s = 0;
              s < a.length;
              s++
            )
              (i && !i(a[s])) || e.removeCue(a[s]);
          "disabled" === n && (e.mode = n);
        }
        function Bm(e) {
          for (var t = [], r = 0; r < e.length; r++) {
            var i = e[r];
            ("subtitles" !== i.kind && "captions" !== i.kind) || !i.label || t.push(e[r]);
          }
          return t;
        }
        function $m(e) {
          for (var t = 5381, r = e.length; r; ) t = (33 * t) ^ e.charCodeAt(--r);
          return (t >>> 0).toString();
        }
        var jm = 0.025,
          Gm = (function (e) {
            return ((e[(e.Point = 0)] = "Point"), (e[(e.Range = 1)] = "Range"), e);
          })({});
        function Vm(e, t, r) {
          return `${e.identifier}-${r + 1}-${$m(t)}`;
        }
        class Hm {
          constructor(e, t) {
            ((this.base = void 0),
              (this._duration = null),
              (this._timelineStart = null),
              (this.appendInPlaceDisabled = void 0),
              (this.appendInPlaceStarted = void 0),
              (this.dateRange = void 0),
              (this.hasPlayed = !1),
              (this.cumulativeDuration = 0),
              (this.resumeOffset = NaN),
              (this.playoutLimit = NaN),
              (this.restrictions = { skip: !1, jump: !1 }),
              (this.snapOptions = { out: !1, in: !1 }),
              (this.assetList = []),
              (this.assetListLoader = void 0),
              (this.assetListResponse = null),
              (this.resumeAnchor = void 0),
              (this.error = void 0),
              (this.resetOnResume = void 0),
              (this.base = t),
              (this.dateRange = e),
              this.setDateRange(e));
          }
          setDateRange(e) {
            ((this.dateRange = e),
              (this.resumeOffset = e.attr.optionalFloat("X-RESUME-OFFSET", this.resumeOffset)),
              (this.playoutLimit = e.attr.optionalFloat("X-PLAYOUT-LIMIT", this.playoutLimit)),
              (this.restrictions = e.attr.enumeratedStringList("X-RESTRICT", this.restrictions)),
              (this.snapOptions = e.attr.enumeratedStringList("X-SNAP", this.snapOptions)));
          }
          reset() {
            var e;
            ((this.appendInPlaceStarted = !1),
              null == (e = this.assetListLoader) || e.destroy(),
              (this.assetListLoader = void 0),
              this.supplementsPrimary ||
                ((this.assetListResponse = null), (this.assetList = []), (this._duration = null)));
          }
          isAssetPastPlayoutLimit(e) {
            var t;
            if (e > 0 && e >= this.assetList.length) return !0;
            var r = this.playoutLimit;
            return (
              !(e <= 0 || isNaN(r)) &&
              (0 === r || ((null == (t = this.assetList[e]) ? void 0 : t.startOffset) || 0) > r)
            );
          }
          findAssetIndex(e) {
            return this.assetList.indexOf(e);
          }
          get identifier() {
            return this.dateRange.id;
          }
          get startDate() {
            return this.dateRange.startDate;
          }
          get startTime() {
            var e = this.dateRange.startTime;
            if (this.snapOptions.out) {
              var t = this.dateRange.tagAnchor;
              if (t) return Km(e, t);
            }
            return e;
          }
          get startOffset() {
            return this.cue.pre ? 0 : this.startTime;
          }
          get startIsAligned() {
            if (0 === this.startTime || this.snapOptions.out) return !0;
            var e = this.dateRange.tagAnchor;
            if (e) {
              var t = this.dateRange.startTime;
              return t - Km(t, e) < 0.1;
            }
            return !1;
          }
          get resumptionOffset() {
            var e = this.resumeOffset,
              t = bu(e) ? e : this.duration;
            return this.cumulativeDuration + t;
          }
          get resumeTime() {
            var e = this.startOffset + this.resumptionOffset;
            if (this.snapOptions.in) {
              var t = this.resumeAnchor;
              if (t) return Km(e, t);
            }
            return e;
          }
          get appendInPlace() {
            return (
              !!this.appendInPlaceStarted ||
              (!this.appendInPlaceDisabled &&
                !(
                  this.cue.once ||
                  this.cue.pre ||
                  !this.startIsAligned ||
                  !(
                    (isNaN(this.playoutLimit) && isNaN(this.resumeOffset)) ||
                    (this.resumeOffset && this.duration && Math.abs(this.resumeOffset - this.duration) < jm)
                  )
                ))
            );
          }
          set appendInPlace(e) {
            this.appendInPlaceStarted ? (this.resetOnResume = !e) : (this.appendInPlaceDisabled = !e);
          }
          get timelineStart() {
            return null !== this._timelineStart ? this._timelineStart : this.startTime;
          }
          set timelineStart(e) {
            this._timelineStart = e;
          }
          get duration() {
            var e,
              t = this.playoutLimit;
            return (
              (e =
                null !== this._duration
                  ? this._duration
                  : this.dateRange.duration
                    ? this.dateRange.duration
                    : this.dateRange.plannedDuration || 0),
              !isNaN(t) && t < e && (e = t),
              e
            );
          }
          set duration(e) {
            this._duration = e;
          }
          get cue() {
            return this.dateRange.cue;
          }
          get timelineOccupancy() {
            return "RANGE" === this.dateRange.attr["X-TIMELINE-OCCUPIES"] ? Gm.Range : Gm.Point;
          }
          get supplementsPrimary() {
            return "PRIMARY" === this.dateRange.attr["X-TIMELINE-STYLE"];
          }
          get contentMayVary() {
            return "NO" !== this.dateRange.attr["X-CONTENT-MAY-VARY"];
          }
          get assetUrl() {
            return this.dateRange.attr["X-ASSET-URI"];
          }
          get assetListUrl() {
            return this.dateRange.attr["X-ASSET-LIST"];
          }
          get baseUrl() {
            return this.base.url;
          }
          get assetListLoaded() {
            return this.assetList.length > 0 || null !== this.assetListResponse;
          }
          toString() {
            return `["${(e = this).identifier}" ${e.cue.pre ? "<pre>" : e.cue.post ? "<post>" : ""}${e.timelineStart.toFixed(2)}-${e.resumeTime.toFixed(2)}]`;
            var e;
          }
        }
        function Km(e, t) {
          return e - t.start < t.duration / 2 && !(Math.abs(e - (t.start + t.duration)) < jm)
            ? t.start
            : t.start + t.duration;
        }
        function Wm(e, t, r) {
          var i = new self.URL(e, r);
          return ("data:" !== i.protocol && i.searchParams.set("_HLS_primary_id", t), i);
        }
        function zm(e, t) {
          for (; null != (r = e.assetList[++t]) && r.error; ) var r;
          return t;
        }
        function qm(e) {
          var t = e.timelineStart,
            r = e.duration || 0;
          return `["${e.identifier}" ${t.toFixed(2)}-${(t + r).toFixed(2)}]`;
        }
        class Xm {
          constructor(e, t, r, i) {
            ((this.hls = void 0),
              (this.interstitial = void 0),
              (this.assetItem = void 0),
              (this.tracks = null),
              (this.hasDetails = !1),
              (this.mediaAttached = null),
              (this._currentTime = void 0),
              (this._bufferedEosTime = void 0),
              (this.checkPlayout = () => {
                this.reachedPlayout(this.currentTime) &&
                  this.hls &&
                  this.hls.trigger(Au.PLAYOUT_LIMIT_REACHED, {});
              }));
            var n = (this.hls = new e(t));
            ((this.interstitial = r), (this.assetItem = i));
            var a = () => {
              this.hasDetails = !0;
            };
            (n.once(Au.LEVEL_LOADED, a),
              n.once(Au.AUDIO_TRACK_LOADED, a),
              n.once(Au.SUBTITLE_TRACK_LOADED, a),
              n.on(Au.MEDIA_ATTACHING, (e, { media: t }) => {
                (this.removeMediaListeners(),
                  (this.mediaAttached = t),
                  this.interstitial.playoutLimit &&
                    (t.addEventListener("timeupdate", this.checkPlayout),
                    this.appendInPlace &&
                      n.on(Au.BUFFER_APPENDED, () => {
                        var e = this.bufferedEnd;
                        this.reachedPlayout(e) &&
                          ((this._bufferedEosTime = e), n.trigger(Au.BUFFERED_TO_END, void 0));
                      })));
              }));
          }
          get appendInPlace() {
            return this.interstitial.appendInPlace;
          }
          loadSource() {
            var e = this.hls;
            if (e)
              if (e.url) e.levels.length && !e.started && e.startLoad(-1, !0);
              else {
                var t = this.assetItem.uri;
                try {
                  t = Wm(t, e.config.primarySessionId || "").href;
                } catch (r) {}
                e.loadSource(t);
              }
          }
          bufferedInPlaceToEnd(e) {
            var t;
            if (!this.appendInPlace) return !1;
            if (null != (t = this.hls) && t.bufferedToEnd) return !0;
            if (!e) return !1;
            var r = Math.min(this._bufferedEosTime || 1 / 0, this.duration),
              i = this.timelineOffset,
              n = fc.bufferInfo(e, i, 0);
            return this.getAssetTime(n.end) >= r - 0.02;
          }
          reachedPlayout(e) {
            var t = this.interstitial.playoutLimit;
            return this.startOffset + e >= t;
          }
          get destroyed() {
            var e;
            return !(null != (e = this.hls) && e.userConfig);
          }
          get assetId() {
            return this.assetItem.identifier;
          }
          get interstitialId() {
            return this.assetItem.parentIdentifier;
          }
          get media() {
            var e;
            return (null == (e = this.hls) ? void 0 : e.media) || null;
          }
          get bufferedEnd() {
            var e = this.media || this.mediaAttached;
            if (!e) return this._bufferedEosTime ? this._bufferedEosTime : this.currentTime;
            var t = fc.bufferInfo(e, e.currentTime, 0.001);
            return this.getAssetTime(t.end);
          }
          get currentTime() {
            var e = this.media || this.mediaAttached;
            return e ? this.getAssetTime(e.currentTime) : this._currentTime || 0;
          }
          get duration() {
            var e = this.assetItem.duration;
            if (!e) return 0;
            var t = this.interstitial.playoutLimit;
            if (t) {
              var r = t - this.startOffset;
              if (r > 0 && r < e) return r;
            }
            return e;
          }
          get remaining() {
            var e = this.duration;
            return e ? Math.max(0, e - this.currentTime) : 0;
          }
          get startOffset() {
            return this.assetItem.startOffset;
          }
          get timelineOffset() {
            var e;
            return (null == (e = this.hls) ? void 0 : e.config.timelineOffset) || 0;
          }
          set timelineOffset(e) {
            var t = this.timelineOffset;
            if (e !== t) {
              var r = e - t;
              if (Math.abs(r) > 1 / 9e4 && this.hls) {
                if (this.hasDetails) throw new Error("Cannot set timelineOffset after playlists are loaded");
                this.hls.config.timelineOffset = e;
              }
            }
          }
          getAssetTime(e) {
            var t = this.timelineOffset,
              r = this.duration;
            return Math.min(Math.max(0, e - t), r);
          }
          removeMediaListeners() {
            var e = this.mediaAttached;
            e &&
              ((this._currentTime = e.currentTime),
              this.bufferSnapShot(),
              e.removeEventListener("timeupdate", this.checkPlayout));
          }
          bufferSnapShot() {
            var e;
            this.mediaAttached &&
              null != (e = this.hls) &&
              e.bufferedToEnd &&
              (this._bufferedEosTime = this.bufferedEnd);
          }
          destroy() {
            (this.removeMediaListeners(),
              this.hls && this.hls.destroy(),
              (this.hls = null),
              (this.tracks = this.mediaAttached = this.checkPlayout = null));
          }
          attachMedia(e) {
            var t;
            (this.loadSource(), null == (t = this.hls) || t.attachMedia(e));
          }
          detachMedia() {
            var e;
            (this.removeMediaListeners(),
              (this.mediaAttached = null),
              null == (e = this.hls) || e.detachMedia());
          }
          resumeBuffering() {
            var e;
            null == (e = this.hls) || e.resumeBuffering();
          }
          pauseBuffering() {
            var e;
            null == (e = this.hls) || e.pauseBuffering();
          }
          transferMedia() {
            var e;
            return (this.bufferSnapShot(), (null == (e = this.hls) ? void 0 : e.transferMedia()) || null);
          }
          resetDetails() {
            var e = this.hls;
            if (e && this.hasDetails) {
              e.stopLoad();
              var t = e => delete e.details;
              (e.levels.forEach(t),
                e.allAudioTracks.forEach(t),
                e.allSubtitleTracks.forEach(t),
                (this.hasDetails = !1));
            }
          }
          on(e, t, r) {
            var i;
            null == (i = this.hls) || i.on(e, t);
          }
          once(e, t, r) {
            var i;
            null == (i = this.hls) || i.once(e, t);
          }
          off(e, t, r) {
            var i;
            null == (i = this.hls) || i.off(e, t);
          }
          toString() {
            var e;
            return `HlsAssetPlayer: ${qm(this.assetItem)} ${null == (e = this.hls) ? void 0 : e.sessionId} ${this.appendInPlace ? "append-in-place" : ""}`;
          }
        }
        class Ym extends Bu {
          constructor(e, t) {
            (super("interstitials-sched", t),
              (this.onScheduleUpdate = void 0),
              (this.eventMap = {}),
              (this.events = null),
              (this.items = null),
              (this.durations = { primary: 0, playout: 0, integrated: 0 }),
              (this.onScheduleUpdate = e));
          }
          destroy() {
            (this.reset(), (this.onScheduleUpdate = null));
          }
          reset() {
            ((this.eventMap = {}),
              this.setDurations(0, 0, 0),
              this.events && this.events.forEach(e => e.reset()),
              (this.events = this.items = null));
          }
          resetErrorsInRange(e, t) {
            return this.events
              ? this.events.reduce(
                  (r, i) => (e <= i.startOffset && t > i.startOffset ? (delete i.error, r + 1) : r),
                  0,
                )
              : 0;
          }
          get duration() {
            var e = this.items;
            return e ? e[e.length - 1].end : 0;
          }
          get length() {
            return this.items ? this.items.length : 0;
          }
          getEvent(e) {
            return (e && this.eventMap[e]) || null;
          }
          hasEvent(e) {
            return e in this.eventMap;
          }
          findItemIndex(e, t) {
            if (e.event) return this.findEventIndex(e.event.identifier);
            var r = -1;
            e.nextEvent
              ? (r = this.findEventIndex(e.nextEvent.identifier) - 1)
              : e.previousEvent && (r = this.findEventIndex(e.previousEvent.identifier) + 1);
            var i = this.items;
            if (i)
              for (
                i[r] || (void 0 === t && (t = e.start), (r = this.findItemIndexAtTime(t)));
                r >= 0 && null != (n = i[r]) && n.event;
              ) {
                var n;
                r--;
              }
            return r;
          }
          findItemIndexAtTime(e, t) {
            var r = this.items;
            if (r)
              for (var i = 0; i < r.length; i++) {
                var n = r[i];
                if ((t && "primary" !== t && (n = n[t]), e === n.start || (e > n.start && e < n.end)))
                  return i;
              }
            return -1;
          }
          findJumpRestrictedIndex(e, t) {
            var r = this.items;
            if (r)
              for (var i = e; i <= t && r[i]; i++) {
                var n = r[i].event;
                if (null != n && n.restrictions.jump && !n.appendInPlace) return i;
              }
            return -1;
          }
          findEventIndex(e) {
            var t = this.items;
            if (t)
              for (var r = t.length; r--; ) {
                var i;
                if ((null == (i = t[r].event) ? void 0 : i.identifier) === e) return r;
              }
            return -1;
          }
          findAssetIndex(e, t) {
            var r = e.assetList,
              i = r.length;
            if (i > 1)
              for (var n = 0; n < i; n++) {
                var a = r[n];
                if (!a.error) {
                  var s = a.timelineStart;
                  if (t === s || (t > s && (t < s + (a.duration || 0) || n === i - 1))) return n;
                }
              }
            return 0;
          }
          get assetIdAtEnd() {
            var e,
              t = null == (e = this.items) || null == (e = e[this.length - 1]) ? void 0 : e.event;
            if (t) {
              var r = t.assetList,
                i = r[r.length - 1];
              if (i) return i.identifier;
            }
            return null;
          }
          parseInterstitialDateRanges(e, t) {
            var r = e.main.details,
              i = r.dateRanges,
              n = this.events,
              a = this.parseDateRanges(i, { url: r.url }, t),
              s = Object.keys(i),
              o = n ? n.filter(e => !s.includes(e.identifier)) : [];
            (a.length &&
              a.sort((e, t) => {
                var r = e.cue.pre,
                  i = e.cue.post,
                  n = t.cue.pre,
                  a = t.cue.post;
                if (r && !n) return -1;
                if (n && !r) return 1;
                if (i && !a) return 1;
                if (a && !i) return -1;
                if (!(r || n || i || a)) {
                  var s = e.startTime,
                    o = t.startTime;
                  if (s !== o) return s - o;
                }
                return e.dateRange.tagOrder - t.dateRange.tagOrder;
              }),
              (this.events = a),
              o.forEach(e => {
                this.removeEvent(e);
              }),
              this.updateSchedule(e, o));
          }
          updateSchedule(e, t = [], r = !1) {
            var i = this.events || [];
            if (i.length || t.length || this.length < 2) {
              var n = this.items,
                a = this.parseSchedule(i, e);
              (r ||
                t.length ||
                (null == n ? void 0 : n.length) !== a.length ||
                a.some(
                  (e, t) =>
                    Math.abs(e.playout.start - n[t].playout.start) > 0.005 ||
                    Math.abs(e.playout.end - n[t].playout.end) > 0.005,
                )) &&
                ((this.items = a), this.onScheduleUpdate(t, n));
            }
          }
          parseDateRanges(e, t, r) {
            for (var i = [], n = Object.keys(e), a = 0; a < n.length; a++) {
              var s = n[a],
                o = e[s];
              if (o.isInterstitial) {
                var l = this.eventMap[s];
                (l
                  ? l.setDateRange(o)
                  : ((l = new Hm(o, t)), (this.eventMap[s] = l), !1 === r && (l.appendInPlace = r)),
                  i.push(l));
              }
            }
            return i;
          }
          parseSchedule(e, t) {
            var r = [],
              i = t.main.details,
              n = i.live ? 1 / 0 : i.edge,
              a = 0;
            if ((e = e.filter(e => !(e.error || (e.cue.once && e.hasPlayed)))).length) {
              this.resolveOffsets(e, t);
              var s = 0,
                o = 0;
              if (
                (e.forEach((t, i) => {
                  var l = t.cue.pre,
                    u = t.cue.post,
                    d = e[i - 1] || null,
                    h = t.appendInPlace,
                    c = u ? n : t.startOffset,
                    f = t.duration,
                    p = t.timelineOccupancy === Gm.Range ? f : 0,
                    g = t.resumptionOffset,
                    m = (null == d ? void 0 : d.startTime) === c,
                    v = c + t.cumulativeDuration,
                    y = h ? v + f : c + g;
                  if (l || (!u && c <= 0)) {
                    var T = o;
                    ((o += p), (t.timelineStart = v));
                    var b = a;
                    ((a += f),
                      r.push({
                        event: t,
                        start: v,
                        end: y,
                        playout: { start: b, end: a },
                        integrated: { start: T, end: o },
                      }));
                  } else {
                    if (!(c <= n)) return;
                    if (!m) {
                      var S = c - s;
                      if (S > 0.033) {
                        var E = s,
                          x = o;
                        o += S;
                        var w = a;
                        a += S;
                        var A = {
                          previousEvent: e[i - 1] || null,
                          nextEvent: t,
                          start: E,
                          end: E + S,
                          playout: { start: w, end: a },
                          integrated: { start: x, end: o },
                        };
                        r.push(A);
                      } else S > 0 && d && ((d.cumulativeDuration += S), (r[r.length - 1].end = c));
                    }
                    (u && (y = v), (t.timelineStart = v));
                    var I = o;
                    o += p;
                    var k = a;
                    ((a += f),
                      r.push({
                        event: t,
                        start: v,
                        end: y,
                        playout: { start: k, end: a },
                        integrated: { start: I, end: o },
                      }));
                  }
                  var R = t.resumeTime;
                  s = u || R > n ? n : R;
                }),
                s < n)
              ) {
                var l,
                  u = s,
                  d = o,
                  h = n - s;
                o += h;
                var c = a;
                ((a += h),
                  r.push({
                    previousEvent: (null == (l = r[r.length - 1]) ? void 0 : l.event) || null,
                    nextEvent: null,
                    start: s,
                    end: u + h,
                    playout: { start: c, end: a },
                    integrated: { start: d, end: o },
                  }));
              }
              this.setDurations(n, a, o);
            } else {
              (r.push({
                previousEvent: null,
                nextEvent: null,
                start: 0,
                end: n,
                playout: { start: 0, end: n },
                integrated: { start: 0, end: n },
              }),
                this.setDurations(n, n, n));
            }
            return r;
          }
          setDurations(e, t, r) {
            this.durations = { primary: e, playout: t, integrated: r };
          }
          resolveOffsets(e, t) {
            var r = t.main.details,
              i = r.live ? 1 / 0 : r.edge,
              n = 0,
              a = -1;
            e.forEach((s, o) => {
              var l = s.cue.pre,
                u = s.cue.post,
                d = l ? 0 : u ? i : s.startTime;
              (this.updateAssetDurations(s),
              a === d ? (s.cumulativeDuration = n) : ((n = 0), (a = d)),
              !u &&
                s.snapOptions.in &&
                (s.resumeAnchor = wh(null, r.fragments, s.startOffset + s.resumptionOffset, 0, 0) || void 0),
              s.appendInPlace && !s.appendInPlaceStarted) &&
                (this.primaryCanResumeInPlaceAt(s, t) || (s.appendInPlace = !1));
              !s.appendInPlace &&
                o + 1 < e.length &&
                e[o + 1].startTime - e[o].resumeTime < 0.033 &&
                ((e[o + 1].appendInPlace = !1),
                e[o + 1].appendInPlace &&
                  this.warn(`Could not change append strategy for abutting event ${s}`));
              var h = bu(s.resumeOffset) ? s.resumeOffset : s.duration;
              n += h;
            });
          }
          primaryCanResumeInPlaceAt(e, t) {
            var r = e.resumeTime,
              i = e.startTime + e.resumptionOffset;
            return Math.abs(r - i) > jm
              ? (this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${i}`),
                !1)
              : !Object.keys(t).some(i => {
                  var n = t[i].details,
                    a = n.edge;
                  if (r >= a)
                    return (this.log(`"${e.identifier}" resumption ${r} past ${i} playlist end ${a}`), !1);
                  var s = wh(null, n.fragments, r);
                  if (!s)
                    return (
                      this.log(
                        `"${e.identifier}" resumption ${r} does not align with any fragments in ${i} playlist (${n.fragStart}-${n.fragmentEnd})`,
                      ),
                      !0
                    );
                  var o = "audio" === i ? 0.175 : 0;
                  return (
                    !(Math.abs(s.start - r) < jm + o || Math.abs(s.end - r) < jm + o) &&
                    (this.log(
                      `"${e.identifier}" resumption ${r} not aligned with ${i} fragment bounds (${s.start}-${s.end} sn: ${s.sn} cc: ${s.cc})`,
                    ),
                    !0)
                  );
                });
          }
          updateAssetDurations(e) {
            if (e.assetListLoaded) {
              for (var t = e.timelineStart, r = 0, i = !1, n = !1, a = 0; a < e.assetList.length; a++) {
                var s = e.assetList[a],
                  o = t + r;
                ((s.startOffset = r),
                  (s.timelineStart = o),
                  i || (i = null === s.duration),
                  n || (n = !!s.error),
                  (r += s.error ? 0 : s.duration || 0));
              }
              e.duration = i && !n ? Math.max(r, e.duration) : r;
            }
          }
          removeEvent(e) {
            (e.reset(), delete this.eventMap[e.identifier]);
          }
        }
        function Qm(e) {
          return `[${e.event ? '"' + e.event.identifier + '"' : "primary"}: ${e.start.toFixed(2)}-${e.end.toFixed(2)}]`;
        }
        class Jm {
          constructor(e) {
            ((this.hls = void 0), (this.hls = e));
          }
          destroy() {
            this.hls = null;
          }
          loadAssetList(e, t) {
            var r,
              i = e.assetListUrl;
            try {
              r = Wm(i, this.hls.sessionId, e.baseUrl);
            } catch (h) {
              var n = this.assignAssetListError(e, wu.ASSET_LIST_LOAD_ERROR, h, i);
              return void this.hls.trigger(Au.ERROR, n);
            }
            t && "data:" !== r.protocol && r.searchParams.set("_HLS_start_offset", "" + t);
            var a = this.hls.config,
              s = new (0, a.loader)(a),
              o = { responseType: "json", url: r.href },
              l = a.interstitialAssetListLoadPolicy.default,
              u = { loadPolicy: l, timeout: l.maxLoadTimeMs, maxRetry: 0, retryDelay: 0, maxRetryDelay: 0 },
              d = {
                onSuccess: (t, r, i, n) => {
                  var a = t.data,
                    s = null == a ? void 0 : a.ASSETS;
                  if (Array.isArray(s))
                    ((e.assetListResponse = a),
                      this.hls.trigger(Au.ASSET_LIST_LOADED, {
                        event: e,
                        assetListResponse: a,
                        networkDetails: n,
                      }));
                  else {
                    var o = this.assignAssetListError(
                      e,
                      wu.ASSET_LIST_PARSING_ERROR,
                      new Error("Invalid interstitial asset list"),
                      i.url,
                      r,
                      n,
                    );
                    this.hls.trigger(Au.ERROR, o);
                  }
                },
                onError: (t, r, i, n) => {
                  var a = this.assignAssetListError(
                    e,
                    wu.ASSET_LIST_LOAD_ERROR,
                    new Error(`Error loading X-ASSET-LIST: HTTP status ${t.code} ${t.text} (${r.url})`),
                    r.url,
                    n,
                    i,
                  );
                  this.hls.trigger(Au.ERROR, a);
                },
                onTimeout: (t, r, i) => {
                  var n = this.assignAssetListError(
                    e,
                    wu.ASSET_LIST_LOAD_TIMEOUT,
                    new Error(`Timeout loading X-ASSET-LIST (${r.url})`),
                    r.url,
                    t,
                    i,
                  );
                  this.hls.trigger(Au.ERROR, n);
                },
              };
            return (s.load(o, u, d), this.hls.trigger(Au.ASSET_LIST_LOADING, { event: e }), s);
          }
          assignAssetListError(e, t, r, i, n, a) {
            return (
              (e.error = r),
              {
                type: xu.NETWORK_ERROR,
                details: t,
                fatal: !1,
                interstitial: e,
                url: i,
                error: r,
                networkDetails: a,
                stats: n,
              }
            );
          }
        }
        function Zm(e) {
          var t;
          null == e || null == (t = e.play()) || t.catch(() => {});
        }
        function ev(e, t) {
          return `[${e}] Advancing timeline position to ${t}`;
        }
        class tv {
          constructor(e) {
            this.buffered = void 0;
            var t = (t, r, i) => {
              if ((r >>>= 0) > i - 1)
                throw new DOMException(
                  `Failed to execute '${t}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${i})`,
                );
              return e[r][t];
            };
            this.buffered = {
              get length() {
                return e.length;
              },
              end: r => t("end", r, e.length),
              start: r => t("start", r, e.length),
            };
          }
        }
        var rv = {
            42: 225,
            92: 233,
            94: 237,
            95: 243,
            96: 250,
            123: 231,
            124: 247,
            125: 209,
            126: 241,
            127: 9608,
            128: 174,
            129: 176,
            130: 189,
            131: 191,
            132: 8482,
            133: 162,
            134: 163,
            135: 9834,
            136: 224,
            137: 32,
            138: 232,
            139: 226,
            140: 234,
            141: 238,
            142: 244,
            143: 251,
            144: 193,
            145: 201,
            146: 211,
            147: 218,
            148: 220,
            149: 252,
            150: 8216,
            151: 161,
            152: 42,
            153: 8217,
            154: 9473,
            155: 169,
            156: 8480,
            157: 8226,
            158: 8220,
            159: 8221,
            160: 192,
            161: 194,
            162: 199,
            163: 200,
            164: 202,
            165: 203,
            166: 235,
            167: 206,
            168: 207,
            169: 239,
            170: 212,
            171: 217,
            172: 249,
            173: 219,
            174: 171,
            175: 187,
            176: 195,
            177: 227,
            178: 205,
            179: 204,
            180: 236,
            181: 210,
            182: 242,
            183: 213,
            184: 245,
            185: 123,
            186: 125,
            187: 92,
            188: 94,
            189: 95,
            190: 124,
            191: 8764,
            192: 196,
            193: 228,
            194: 214,
            195: 246,
            196: 223,
            197: 165,
            198: 164,
            199: 9475,
            200: 197,
            201: 229,
            202: 216,
            203: 248,
            204: 9487,
            205: 9491,
            206: 9495,
            207: 9499,
          },
          iv = e => String.fromCharCode(rv[e] || e),
          nv = 15,
          av = 100,
          sv = { 17: 1, 18: 3, 21: 5, 22: 7, 23: 9, 16: 11, 19: 12, 20: 14 },
          ov = { 17: 2, 18: 4, 21: 6, 22: 8, 23: 10, 19: 13, 20: 15 },
          lv = { 25: 1, 26: 3, 29: 5, 30: 7, 31: 9, 24: 11, 27: 12, 28: 14 },
          uv = { 25: 2, 26: 4, 29: 6, 30: 8, 31: 10, 27: 13, 28: 15 },
          dv = ["white", "green", "blue", "cyan", "red", "yellow", "magenta", "black", "transparent"];
        class hv {
          constructor() {
            ((this.time = null), (this.verboseLevel = 0));
          }
          log(e, t) {
            if (this.verboseLevel >= e) {
              var r = "function" == typeof t ? t() : t;
              Ku.log(`${this.time} [${e}] ${r}`);
            }
          }
        }
        var cv = function (e) {
          for (var t = [], r = 0; r < e.length; r++) t.push(e[r].toString(16));
          return t;
        };
        class fv {
          constructor() {
            ((this.foreground = "white"),
              (this.underline = !1),
              (this.italics = !1),
              (this.background = "black"),
              (this.flash = !1));
          }
          reset() {
            ((this.foreground = "white"),
              (this.underline = !1),
              (this.italics = !1),
              (this.background = "black"),
              (this.flash = !1));
          }
          setStyles(e) {
            for (
              var t = ["foreground", "underline", "italics", "background", "flash"], r = 0;
              r < t.length;
              r++
            ) {
              var i = t[r];
              e.hasOwnProperty(i) && (this[i] = e[i]);
            }
          }
          isDefault() {
            return (
              "white" === this.foreground &&
              !this.underline &&
              !this.italics &&
              "black" === this.background &&
              !this.flash
            );
          }
          equals(e) {
            return (
              this.foreground === e.foreground &&
              this.underline === e.underline &&
              this.italics === e.italics &&
              this.background === e.background &&
              this.flash === e.flash
            );
          }
          copy(e) {
            ((this.foreground = e.foreground),
              (this.underline = e.underline),
              (this.italics = e.italics),
              (this.background = e.background),
              (this.flash = e.flash));
          }
          toString() {
            return (
              "color=" +
              this.foreground +
              ", underline=" +
              this.underline +
              ", italics=" +
              this.italics +
              ", background=" +
              this.background +
              ", flash=" +
              this.flash
            );
          }
        }
        class pv {
          constructor() {
            ((this.uchar = " "), (this.penState = new fv()));
          }
          reset() {
            ((this.uchar = " "), this.penState.reset());
          }
          setChar(e, t) {
            ((this.uchar = e), this.penState.copy(t));
          }
          setPenState(e) {
            this.penState.copy(e);
          }
          equals(e) {
            return this.uchar === e.uchar && this.penState.equals(e.penState);
          }
          copy(e) {
            ((this.uchar = e.uchar), this.penState.copy(e.penState));
          }
          isEmpty() {
            return " " === this.uchar && this.penState.isDefault();
          }
        }
        class gv {
          constructor(e) {
            ((this.chars = []),
              (this.pos = 0),
              (this.currPenState = new fv()),
              (this.cueStartTime = null),
              (this.logger = void 0));
            for (var t = 0; t < av; t++) this.chars.push(new pv());
            this.logger = e;
          }
          equals(e) {
            for (var t = 0; t < av; t++) if (!this.chars[t].equals(e.chars[t])) return !1;
            return !0;
          }
          copy(e) {
            for (var t = 0; t < av; t++) this.chars[t].copy(e.chars[t]);
          }
          isEmpty() {
            for (var e = !0, t = 0; t < av; t++)
              if (!this.chars[t].isEmpty()) {
                e = !1;
                break;
              }
            return e;
          }
          setCursor(e) {
            (this.pos !== e && (this.pos = e),
              this.pos < 0
                ? (this.logger.log(3, "Negative cursor position " + this.pos), (this.pos = 0))
                : this.pos > av &&
                  (this.logger.log(3, "Too large cursor position " + this.pos), (this.pos = av)));
          }
          moveCursor(e) {
            var t = this.pos + e;
            if (e > 1)
              for (var r = this.pos + 1; r < t + 1; r++) this.chars[r].setPenState(this.currPenState);
            this.setCursor(t);
          }
          backSpace() {
            (this.moveCursor(-1), this.chars[this.pos].setChar(" ", this.currPenState));
          }
          insertChar(e) {
            e >= 144 && this.backSpace();
            var t = iv(e);
            this.pos >= av
              ? this.logger.log(
                  0,
                  () =>
                    "Cannot insert " +
                    e.toString(16) +
                    " (" +
                    t +
                    ") at position " +
                    this.pos +
                    ". Skipping it!",
                )
              : (this.chars[this.pos].setChar(t, this.currPenState), this.moveCursor(1));
          }
          clearFromPos(e) {
            var t;
            for (t = e; t < av; t++) this.chars[t].reset();
          }
          clear() {
            (this.clearFromPos(0), (this.pos = 0), this.currPenState.reset());
          }
          clearToEndOfRow() {
            this.clearFromPos(this.pos);
          }
          getTextString() {
            for (var e = [], t = !0, r = 0; r < av; r++) {
              var i = this.chars[r].uchar;
              (" " !== i && (t = !1), e.push(i));
            }
            return t ? "" : e.join("");
          }
          setPenStyles(e) {
            (this.currPenState.setStyles(e), this.chars[this.pos].setPenState(this.currPenState));
          }
        }
        class mv {
          constructor(e) {
            ((this.rows = []),
              (this.currRow = 14),
              (this.nrRollUpRows = null),
              (this.lastOutputScreen = null),
              (this.logger = void 0));
            for (var t = 0; t < nv; t++) this.rows.push(new gv(e));
            this.logger = e;
          }
          reset() {
            for (var e = 0; e < nv; e++) this.rows[e].clear();
            this.currRow = 14;
          }
          equals(e) {
            for (var t = !0, r = 0; r < nv; r++)
              if (!this.rows[r].equals(e.rows[r])) {
                t = !1;
                break;
              }
            return t;
          }
          copy(e) {
            for (var t = 0; t < nv; t++) this.rows[t].copy(e.rows[t]);
          }
          isEmpty() {
            for (var e = !0, t = 0; t < nv; t++)
              if (!this.rows[t].isEmpty()) {
                e = !1;
                break;
              }
            return e;
          }
          backSpace() {
            this.rows[this.currRow].backSpace();
          }
          clearToEndOfRow() {
            this.rows[this.currRow].clearToEndOfRow();
          }
          insertChar(e) {
            this.rows[this.currRow].insertChar(e);
          }
          setPen(e) {
            this.rows[this.currRow].setPenStyles(e);
          }
          moveCursor(e) {
            this.rows[this.currRow].moveCursor(e);
          }
          setCursor(e) {
            (this.logger.log(2, "setCursor: " + e), this.rows[this.currRow].setCursor(e));
          }
          setPAC(e) {
            this.logger.log(2, () => "pacData = " + ph(e));
            var t = e.row - 1;
            if (
              (this.nrRollUpRows && t < this.nrRollUpRows - 1 && (t = this.nrRollUpRows - 1),
              this.nrRollUpRows && this.currRow !== t)
            ) {
              for (var r = 0; r < nv; r++) this.rows[r].clear();
              var i = this.currRow + 1 - this.nrRollUpRows,
                n = this.lastOutputScreen;
              if (n) {
                var a = n.rows[i].cueStartTime,
                  s = this.logger.time;
                if (null !== a && null !== s && a < s)
                  for (var o = 0; o < this.nrRollUpRows; o++)
                    this.rows[t - this.nrRollUpRows + o + 1].copy(n.rows[i + o]);
              }
            }
            this.currRow = t;
            var l = this.rows[this.currRow];
            if (null !== e.indent) {
              var u = e.indent,
                d = Math.max(u - 1, 0);
              (l.setCursor(e.indent), (e.color = l.chars[d].penState.foreground));
            }
            var h = {
              foreground: e.color,
              underline: e.underline,
              italics: e.italics,
              background: "black",
              flash: !1,
            };
            this.setPen(h);
          }
          setBkgData(e) {
            (this.logger.log(2, () => "bkgData = " + ph(e)),
              this.backSpace(),
              this.setPen(e),
              this.insertChar(32));
          }
          setRollUpRows(e) {
            this.nrRollUpRows = e;
          }
          rollUp() {
            if (null !== this.nrRollUpRows) {
              this.logger.log(1, () => this.getDisplayText());
              var e = this.currRow + 1 - this.nrRollUpRows,
                t = this.rows.splice(e, 1)[0];
              (t.clear(), this.rows.splice(this.currRow, 0, t), this.logger.log(2, "Rolling up"));
            } else this.logger.log(3, "roll_up but nrRollUpRows not set yet");
          }
          getDisplayText(e) {
            e = e || !1;
            for (var t = [], r = "", i = -1, n = 0; n < nv; n++) {
              var a = this.rows[n].getTextString();
              a && ((i = n + 1), e ? t.push("Row " + i + ": '" + a + "'") : t.push(a.trim()));
            }
            return (t.length > 0 && (r = e ? "[" + t.join(" | ") + "]" : t.join("\n")), r);
          }
          getTextAndFormat() {
            return this.rows;
          }
        }
        class vv {
          constructor(e, t, r) {
            ((this.chNr = void 0),
              (this.outputFilter = void 0),
              (this.mode = void 0),
              (this.verbose = void 0),
              (this.displayedMemory = void 0),
              (this.nonDisplayedMemory = void 0),
              (this.lastOutputScreen = void 0),
              (this.currRollUpRow = void 0),
              (this.writeScreen = void 0),
              (this.cueStartTime = void 0),
              (this.logger = void 0),
              (this.chNr = e),
              (this.outputFilter = t),
              (this.mode = null),
              (this.verbose = 0),
              (this.displayedMemory = new mv(r)),
              (this.nonDisplayedMemory = new mv(r)),
              (this.lastOutputScreen = new mv(r)),
              (this.currRollUpRow = this.displayedMemory.rows[14]),
              (this.writeScreen = this.displayedMemory),
              (this.mode = null),
              (this.cueStartTime = null),
              (this.logger = r));
          }
          reset() {
            ((this.mode = null),
              this.displayedMemory.reset(),
              this.nonDisplayedMemory.reset(),
              this.lastOutputScreen.reset(),
              this.outputFilter.reset(),
              (this.currRollUpRow = this.displayedMemory.rows[14]),
              (this.writeScreen = this.displayedMemory),
              (this.mode = null),
              (this.cueStartTime = null));
          }
          getHandler() {
            return this.outputFilter;
          }
          setHandler(e) {
            this.outputFilter = e;
          }
          setPAC(e) {
            this.writeScreen.setPAC(e);
          }
          setBkgData(e) {
            this.writeScreen.setBkgData(e);
          }
          setMode(e) {
            e !== this.mode &&
              ((this.mode = e),
              this.logger.log(2, () => "MODE=" + e),
              "MODE_POP-ON" === this.mode
                ? (this.writeScreen = this.nonDisplayedMemory)
                : ((this.writeScreen = this.displayedMemory), this.writeScreen.reset()),
              "MODE_ROLL-UP" !== this.mode &&
                ((this.displayedMemory.nrRollUpRows = null), (this.nonDisplayedMemory.nrRollUpRows = null)),
              (this.mode = e));
          }
          insertChars(e) {
            for (var t = 0; t < e.length; t++) this.writeScreen.insertChar(e[t]);
            var r = this.writeScreen === this.displayedMemory ? "DISP" : "NON_DISP";
            (this.logger.log(2, () => r + ": " + this.writeScreen.getDisplayText(!0)),
              ("MODE_PAINT-ON" !== this.mode && "MODE_ROLL-UP" !== this.mode) ||
                (this.logger.log(1, () => "DISPLAYED: " + this.displayedMemory.getDisplayText(!0)),
                this.outputDataUpdate()));
          }
          ccRCL() {
            (this.logger.log(2, "RCL - Resume Caption Loading"), this.setMode("MODE_POP-ON"));
          }
          ccBS() {
            (this.logger.log(2, "BS - BackSpace"),
              "MODE_TEXT" !== this.mode &&
                (this.writeScreen.backSpace(),
                this.writeScreen === this.displayedMemory && this.outputDataUpdate()));
          }
          ccAOF() {}
          ccAON() {}
          ccDER() {
            (this.logger.log(2, "DER- Delete to End of Row"),
              this.writeScreen.clearToEndOfRow(),
              this.outputDataUpdate());
          }
          ccRU(e) {
            (this.logger.log(2, "RU(" + e + ") - Roll Up"),
              (this.writeScreen = this.displayedMemory),
              this.setMode("MODE_ROLL-UP"),
              this.writeScreen.setRollUpRows(e));
          }
          ccFON() {
            (this.logger.log(2, "FON - Flash On"), this.writeScreen.setPen({ flash: !0 }));
          }
          ccRDC() {
            (this.logger.log(2, "RDC - Resume Direct Captioning"), this.setMode("MODE_PAINT-ON"));
          }
          ccTR() {
            (this.logger.log(2, "TR"), this.setMode("MODE_TEXT"));
          }
          ccRTD() {
            (this.logger.log(2, "RTD"), this.setMode("MODE_TEXT"));
          }
          ccEDM() {
            (this.logger.log(2, "EDM - Erase Displayed Memory"),
              this.displayedMemory.reset(),
              this.outputDataUpdate(!0));
          }
          ccCR() {
            (this.logger.log(2, "CR - Carriage Return"),
              this.writeScreen.rollUp(),
              this.outputDataUpdate(!0));
          }
          ccENM() {
            (this.logger.log(2, "ENM - Erase Non-displayed Memory"), this.nonDisplayedMemory.reset());
          }
          ccEOC() {
            if ((this.logger.log(2, "EOC - End Of Caption"), "MODE_POP-ON" === this.mode)) {
              var e = this.displayedMemory;
              ((this.displayedMemory = this.nonDisplayedMemory),
                (this.nonDisplayedMemory = e),
                (this.writeScreen = this.nonDisplayedMemory),
                this.logger.log(1, () => "DISP: " + this.displayedMemory.getDisplayText()));
            }
            this.outputDataUpdate(!0);
          }
          ccTO(e) {
            (this.logger.log(2, "TO(" + e + ") - Tab Offset"), this.writeScreen.moveCursor(e));
          }
          ccMIDROW(e) {
            var t = { flash: !1 };
            if (((t.underline = e % 2 == 1), (t.italics = e >= 46), t.italics)) t.foreground = "white";
            else {
              var r = Math.floor(e / 2) - 16;
              t.foreground = ["white", "green", "blue", "cyan", "red", "yellow", "magenta"][r];
            }
            (this.logger.log(2, "MIDROW: " + ph(t)), this.writeScreen.setPen(t));
          }
          outputDataUpdate(e = !1) {
            var t = this.logger.time;
            null !== t &&
              this.outputFilter &&
              (null !== this.cueStartTime || this.displayedMemory.isEmpty()
                ? this.displayedMemory.equals(this.lastOutputScreen) ||
                  (this.outputFilter.newCue(this.cueStartTime, t, this.lastOutputScreen),
                  e && this.outputFilter.dispatchCue && this.outputFilter.dispatchCue(),
                  (this.cueStartTime = this.displayedMemory.isEmpty() ? null : t))
                : (this.cueStartTime = t),
              this.lastOutputScreen.copy(this.displayedMemory));
          }
          cueSplitAtTime(e) {
            this.outputFilter &&
              (this.displayedMemory.isEmpty() ||
                (this.outputFilter.newCue &&
                  this.outputFilter.newCue(this.cueStartTime, e, this.displayedMemory),
                (this.cueStartTime = e)));
          }
        }
        class yv {
          constructor(e, t, r) {
            ((this.channels = void 0),
              (this.currentChannel = 0),
              (this.cmdHistory = { a: null, b: null }),
              (this.logger = void 0));
            var i = (this.logger = new hv());
            this.channels = [null, new vv(e, t, i), new vv(e + 1, r, i)];
          }
          getHandler(e) {
            return this.channels[e].getHandler();
          }
          setHandler(e, t) {
            this.channels[e].setHandler(t);
          }
          addData(e, t) {
            var r = this;
            this.logger.time = e;
            for (
              var i = function (e) {
                  var i = 127 & t[e],
                    n = 127 & t[e + 1],
                    a = !1,
                    s = null;
                  if (0 === i && 0 === n) return 0;
                  r.logger.log(3, () => "[" + cv([t[e], t[e + 1]]) + "] -> (" + cv([i, n]) + ")");
                  var o = r.cmdHistory;
                  if (i >= 16 && i <= 31) {
                    if (
                      (function (e, t, r) {
                        return r.a === e && r.b === t;
                      })(i, n, o)
                    )
                      return (
                        Tv(null, null, o),
                        r.logger.log(3, () => "Repeated command (" + cv([i, n]) + ") is dropped"),
                        0
                      );
                    (Tv(i, n, r.cmdHistory),
                      (a = r.parseCmd(i, n)) || (a = r.parseMidrow(i, n)),
                      a || (a = r.parsePAC(i, n)),
                      a || (a = r.parseBackgroundAttributes(i, n)));
                  } else Tv(null, null, o);
                  if (!a && (s = r.parseChars(i, n))) {
                    var l = r.currentChannel;
                    if (l && l > 0) r.channels[l].insertChars(s);
                    else r.logger.log(2, "No channel found yet. TEXT-MODE?");
                  }
                  a ||
                    s ||
                    r.logger.log(
                      2,
                      () => "Couldn't parse cleaned data " + cv([i, n]) + " orig: " + cv([t[e], t[e + 1]]),
                    );
                },
                n = 0;
              n < t.length;
              n += 2
            )
              i(n);
          }
          parseCmd(e, t) {
            if (
              !((20 === e || 28 === e || 21 === e || 29 === e) && t >= 32 && t <= 47) &&
              !((23 === e || 31 === e) && t >= 33 && t <= 35)
            )
              return !1;
            var r = 20 === e || 21 === e || 23 === e ? 1 : 2,
              i = this.channels[r];
            return (
              20 === e || 21 === e || 28 === e || 29 === e
                ? 32 === t
                  ? i.ccRCL()
                  : 33 === t
                    ? i.ccBS()
                    : 34 === t
                      ? i.ccAOF()
                      : 35 === t
                        ? i.ccAON()
                        : 36 === t
                          ? i.ccDER()
                          : 37 === t
                            ? i.ccRU(2)
                            : 38 === t
                              ? i.ccRU(3)
                              : 39 === t
                                ? i.ccRU(4)
                                : 40 === t
                                  ? i.ccFON()
                                  : 41 === t
                                    ? i.ccRDC()
                                    : 42 === t
                                      ? i.ccTR()
                                      : 43 === t
                                        ? i.ccRTD()
                                        : 44 === t
                                          ? i.ccEDM()
                                          : 45 === t
                                            ? i.ccCR()
                                            : 46 === t
                                              ? i.ccENM()
                                              : 47 === t && i.ccEOC()
                : i.ccTO(t - 32),
              (this.currentChannel = r),
              !0
            );
          }
          parseMidrow(e, t) {
            var r = 0;
            if ((17 === e || 25 === e) && t >= 32 && t <= 47) {
              if ((r = 17 === e ? 1 : 2) !== this.currentChannel)
                return (this.logger.log(0, "Mismatch channel in midrow parsing"), !1);
              var i = this.channels[r];
              return !!i && (i.ccMIDROW(t), this.logger.log(3, () => "MIDROW (" + cv([e, t]) + ")"), !0);
            }
            return !1;
          }
          parsePAC(e, t) {
            var r;
            if (
              !(((e >= 17 && e <= 23) || (e >= 25 && e <= 31)) && t >= 64 && t <= 127) &&
              !((16 === e || 24 === e) && t >= 64 && t <= 95)
            )
              return !1;
            var i = e <= 23 ? 1 : 2;
            r = t >= 64 && t <= 95 ? (1 === i ? sv[e] : lv[e]) : 1 === i ? ov[e] : uv[e];
            var n = this.channels[i];
            return !!n && (n.setPAC(this.interpretPAC(r, t)), (this.currentChannel = i), !0);
          }
          interpretPAC(e, t) {
            var r,
              i = { color: null, italics: !1, indent: null, underline: !1, row: e };
            return (
              (r = t > 95 ? t - 96 : t - 64),
              (i.underline = !(1 & ~r)),
              r <= 13
                ? (i.color = ["white", "green", "blue", "cyan", "red", "yellow", "magenta", "white"][
                    Math.floor(r / 2)
                  ])
                : r <= 15
                  ? ((i.italics = !0), (i.color = "white"))
                  : (i.indent = 4 * Math.floor((r - 16) / 2)),
              i
            );
          }
          parseChars(e, t) {
            var r,
              i,
              n = null,
              a = null;
            (e >= 25 ? ((r = 2), (a = e - 8)) : ((r = 1), (a = e)), a >= 17 && a <= 19)
              ? ((i = 17 === a ? t + 80 : 18 === a ? t + 112 : t + 144),
                this.logger.log(2, () => "Special char '" + iv(i) + "' in channel " + r),
                (n = [i]))
              : e >= 32 && e <= 127 && (n = 0 === t ? [e] : [e, t]);
            return (n && this.logger.log(3, () => "Char codes =  " + cv(n).join(",")), n);
          }
          parseBackgroundAttributes(e, t) {
            var r;
            if (
              !((16 === e || 24 === e) && t >= 32 && t <= 47) &&
              !((23 === e || 31 === e) && t >= 45 && t <= 47)
            )
              return !1;
            var i = {};
            16 === e || 24 === e
              ? ((r = Math.floor((t - 32) / 2)),
                (i.background = dv[r]),
                t % 2 == 1 && (i.background = i.background + "_semi"))
              : 45 === t
                ? (i.background = "transparent")
                : ((i.foreground = "black"), 47 === t && (i.underline = !0));
            var n = e <= 23 ? 1 : 2;
            return (this.channels[n].setBkgData(i), !0);
          }
          reset() {
            for (var e = 0; e < Object.keys(this.channels).length; e++) {
              var t = this.channels[e];
              t && t.reset();
            }
            Tv(null, null, this.cmdHistory);
          }
          cueSplitAtTime(e) {
            for (var t = 0; t < this.channels.length; t++) {
              var r = this.channels[t];
              r && r.cueSplitAtTime(e);
            }
          }
        }
        function Tv(e, t, r) {
          ((r.a = e), (r.b = t));
        }
        var bv = (function () {
          if (null != Pc && Pc.VTTCue) return self.VTTCue;
          var e = ["", "lr", "rl"],
            t = ["start", "middle", "end", "left", "right"];
          function r(e, t) {
            if ("string" != typeof t) return !1;
            if (!Array.isArray(e)) return !1;
            var r = t.toLowerCase();
            return !!~e.indexOf(r) && r;
          }
          function i(e) {
            return r(t, e);
          }
          function n(e, ...t) {
            for (var r = 1; r < arguments.length; r++) {
              var i = arguments[r];
              for (var n in i) e[n] = i[n];
            }
            return e;
          }
          function a(t, a, s) {
            var o = this,
              l = { enumerable: !0 };
            o.hasBeenReset = !1;
            var u = "",
              d = !1,
              h = t,
              c = a,
              f = s,
              p = null,
              g = "",
              m = !0,
              v = "auto",
              y = "start",
              T = 50,
              b = "middle",
              S = 50,
              E = "middle";
            (Object.defineProperty(
              o,
              "id",
              n({}, l, {
                get: function () {
                  return u;
                },
                set: function (e) {
                  u = "" + e;
                },
              }),
            ),
              Object.defineProperty(
                o,
                "pauseOnExit",
                n({}, l, {
                  get: function () {
                    return d;
                  },
                  set: function (e) {
                    d = !!e;
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "startTime",
                n({}, l, {
                  get: function () {
                    return h;
                  },
                  set: function (e) {
                    if ("number" != typeof e) throw new TypeError("Start time must be set to a number.");
                    ((h = e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "endTime",
                n({}, l, {
                  get: function () {
                    return c;
                  },
                  set: function (e) {
                    if ("number" != typeof e) throw new TypeError("End time must be set to a number.");
                    ((c = e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "text",
                n({}, l, {
                  get: function () {
                    return f;
                  },
                  set: function (e) {
                    ((f = "" + e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "region",
                n({}, l, {
                  get: function () {
                    return p;
                  },
                  set: function (e) {
                    ((p = e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "vertical",
                n({}, l, {
                  get: function () {
                    return g;
                  },
                  set: function (t) {
                    var i = (function (t) {
                      return r(e, t);
                    })(t);
                    if (!1 === i) throw new SyntaxError("An invalid or illegal string was specified.");
                    ((g = i), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "snapToLines",
                n({}, l, {
                  get: function () {
                    return m;
                  },
                  set: function (e) {
                    ((m = !!e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "line",
                n({}, l, {
                  get: function () {
                    return v;
                  },
                  set: function (e) {
                    if ("number" != typeof e && "auto" !== e)
                      throw new SyntaxError("An invalid number or illegal string was specified.");
                    ((v = e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "lineAlign",
                n({}, l, {
                  get: function () {
                    return y;
                  },
                  set: function (e) {
                    var t = i(e);
                    if (!t) throw new SyntaxError("An invalid or illegal string was specified.");
                    ((y = t), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "position",
                n({}, l, {
                  get: function () {
                    return T;
                  },
                  set: function (e) {
                    if (e < 0 || e > 100) throw new Error("Position must be between 0 and 100.");
                    ((T = e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "positionAlign",
                n({}, l, {
                  get: function () {
                    return b;
                  },
                  set: function (e) {
                    var t = i(e);
                    if (!t) throw new SyntaxError("An invalid or illegal string was specified.");
                    ((b = t), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "size",
                n({}, l, {
                  get: function () {
                    return S;
                  },
                  set: function (e) {
                    if (e < 0 || e > 100) throw new Error("Size must be between 0 and 100.");
                    ((S = e), (this.hasBeenReset = !0));
                  },
                }),
              ),
              Object.defineProperty(
                o,
                "align",
                n({}, l, {
                  get: function () {
                    return E;
                  },
                  set: function (e) {
                    var t = i(e);
                    if (!t) throw new SyntaxError("An invalid or illegal string was specified.");
                    ((E = t), (this.hasBeenReset = !0));
                  },
                }),
              ),
              (o.displayState = void 0));
          }
          return (
            (a.prototype.getCueAsHTML = function () {
              return self.WebVTT.convertCueToDOMTree(self, this.text);
            }),
            a
          );
        })();
        class Sv {
          decode(e, t) {
            if (!e) return "";
            if ("string" != typeof e) throw new Error("Error - expected string data.");
            return decodeURIComponent(encodeURIComponent(e));
          }
        }
        function Ev(e) {
          function t(e, t, r, i) {
            return 3600 * (0 | e) + 60 * (0 | t) + (0 | r) + parseFloat(i || 0);
          }
          var r = e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);
          return r ? (parseFloat(r[2]) > 59 ? t(r[2], r[3], 0, r[4]) : t(r[1], r[2], r[3], r[4])) : null;
        }
        class xv {
          constructor() {
            this.values = Object.create(null);
          }
          set(e, t) {
            this.get(e) || "" === t || (this.values[e] = t);
          }
          get(e, t, r) {
            return r ? (this.has(e) ? this.values[e] : t[r]) : this.has(e) ? this.values[e] : t;
          }
          has(e) {
            return e in this.values;
          }
          alt(e, t, r) {
            for (var i = 0; i < r.length; ++i)
              if (t === r[i]) {
                this.set(e, t);
                break;
              }
          }
          integer(e, t) {
            /^-?\d+$/.test(t) && this.set(e, parseInt(t, 10));
          }
          percent(e, t) {
            if (/^([\d]{1,3})(\.[\d]*)?%$/.test(t)) {
              var r = parseFloat(t);
              if (r >= 0 && r <= 100) return (this.set(e, r), !0);
            }
            return !1;
          }
        }
        function wv(e, t, r, i) {
          var n = i ? e.split(i) : [e];
          for (var a in n)
            if ("string" == typeof n[a]) {
              var s = n[a].split(r);
              if (2 === s.length) t(s[0], s[1]);
            }
        }
        var Av = new bv(0, 0, ""),
          Iv = "middle" === Av.align ? "middle" : "center";
        function kv(e, t, r) {
          var i = e;
          function n() {
            var t = Ev(e);
            if (null === t) throw new Error("Malformed timestamp: " + i);
            return ((e = e.replace(/^[^\sa-zA-Z-]+/, "")), t);
          }
          function a() {
            e = e.replace(/^\s+/, "");
          }
          if ((a(), (t.startTime = n()), a(), "--\x3e" !== e.slice(0, 3)))
            throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): " + i);
          ((e = e.slice(3)),
            a(),
            (t.endTime = n()),
            a(),
            (function (e, t) {
              var i = new xv();
              (wv(
                e,
                function (e, t) {
                  var n;
                  switch (e) {
                    case "region":
                      for (var a = r.length - 1; a >= 0; a--)
                        if (r[a].id === t) {
                          i.set(e, r[a].region);
                          break;
                        }
                      break;
                    case "vertical":
                      i.alt(e, t, ["rl", "lr"]);
                      break;
                    case "line":
                      ((n = t.split(",")),
                        i.integer(e, n[0]),
                        i.percent(e, n[0]) && i.set("snapToLines", !1),
                        i.alt(e, n[0], ["auto"]),
                        2 === n.length && i.alt("lineAlign", n[1], ["start", Iv, "end"]));
                      break;
                    case "position":
                      ((n = t.split(",")),
                        i.percent(e, n[0]),
                        2 === n.length &&
                          i.alt("positionAlign", n[1], [
                            "start",
                            Iv,
                            "end",
                            "line-left",
                            "line-right",
                            "auto",
                          ]));
                      break;
                    case "size":
                      i.percent(e, t);
                      break;
                    case "align":
                      i.alt(e, t, ["start", Iv, "end", "left", "right"]);
                  }
                },
                /:/,
                /\s/,
              ),
                (t.region = i.get("region", null)),
                (t.vertical = i.get("vertical", "")));
              var n = i.get("line", "auto");
              ("auto" === n && -1 === Av.line && (n = -1),
                (t.line = n),
                (t.lineAlign = i.get("lineAlign", "start")),
                (t.snapToLines = i.get("snapToLines", !0)),
                (t.size = i.get("size", 100)),
                (t.align = i.get("align", Iv)));
              var a = i.get("position", "auto");
              ("auto" === a &&
                50 === Av.position &&
                (a =
                  "start" === t.align || "left" === t.align
                    ? 0
                    : "end" === t.align || "right" === t.align
                      ? 100
                      : 50),
                (t.position = a));
            })(e, t));
        }
        function Rv(e) {
          return e.replace(/<br(?: \/)?>/gi, "\n");
        }
        class Cv {
          constructor() {
            ((this.state = "INITIAL"),
              (this.buffer = ""),
              (this.decoder = new Sv()),
              (this.regionList = []),
              (this.cue = null),
              (this.oncue = void 0),
              (this.onparsingerror = void 0),
              (this.onflush = void 0));
          }
          parse(e) {
            var t = this;
            function r() {
              var e = t.buffer,
                r = 0;
              for (e = Rv(e); r < e.length && "\r" !== e[r] && "\n" !== e[r]; ) ++r;
              var i = e.slice(0, r);
              return ("\r" === e[r] && ++r, "\n" === e[r] && ++r, (t.buffer = e.slice(r)), i);
            }
            function i(e) {
              wv(e, function (e, t) {}, /:/);
            }
            e && (t.buffer += t.decoder.decode(e, { stream: !0 }));
            try {
              var n = "";
              if ("INITIAL" === t.state) {
                if (!/\r\n|\n/.test(t.buffer)) return this;
                var a = (n = r()).match(/^()?WEBVTT([ \t].*)?$/);
                if (null == a || !a[0]) throw new Error("Malformed WebVTT signature.");
                t.state = "HEADER";
              }
              for (var s = !1; t.buffer; ) {
                if (!/\r\n|\n/.test(t.buffer)) return this;
                switch ((s ? (s = !1) : (n = r()), t.state)) {
                  case "HEADER":
                    /:/.test(n) ? i(n) : n || (t.state = "ID");
                    continue;
                  case "NOTE":
                    n || (t.state = "ID");
                    continue;
                  case "ID":
                    if (/^NOTE($|[ \t])/.test(n)) {
                      t.state = "NOTE";
                      break;
                    }
                    if (!n) continue;
                    if (((t.cue = new bv(0, 0, "")), (t.state = "CUE"), -1 === n.indexOf("--\x3e"))) {
                      t.cue.id = n;
                      continue;
                    }
                  case "CUE":
                    if (!t.cue) {
                      t.state = "BADCUE";
                      continue;
                    }
                    try {
                      kv(n, t.cue, t.regionList);
                    } catch (l) {
                      ((t.cue = null), (t.state = "BADCUE"));
                      continue;
                    }
                    t.state = "CUETEXT";
                    continue;
                  case "CUETEXT":
                    var o = -1 !== n.indexOf("--\x3e");
                    if (!n || (o && (s = !0))) {
                      (t.oncue && t.cue && t.oncue(t.cue), (t.cue = null), (t.state = "ID"));
                      continue;
                    }
                    if (null === t.cue) continue;
                    (t.cue.text && (t.cue.text += "\n"), (t.cue.text += n));
                    continue;
                  case "BADCUE":
                    n || (t.state = "ID");
                }
              }
            } catch (l) {
              ("CUETEXT" === t.state && t.cue && t.oncue && t.oncue(t.cue),
                (t.cue = null),
                (t.state = "INITIAL" === t.state ? "BADWEBVTT" : "BADCUE"));
            }
            return this;
          }
          flush() {
            var e = this;
            try {
              if (
                ((e.cue || "HEADER" === e.state) && ((e.buffer += "\n\n"), e.parse()),
                "INITIAL" === e.state || "BADWEBVTT" === e.state)
              )
                throw new Error("Malformed WebVTT signature.");
            } catch (t) {
              e.onparsingerror && e.onparsingerror(t);
            }
            return (e.onflush && e.onflush(), this);
          }
        }
        var Lv = /\r\n|\n\r|\n|\r/g,
          Mv = function (e, t, r = 0) {
            return e.slice(r, r + t.length) === t;
          };
        function Dv(e, t, r) {
          return $m(e.toString()) + $m(t.toString()) + $m(r);
        }
        function _v(e, t, r, i, n, a, s) {
          var o,
            l = new Cv(),
            u = qu(new Uint8Array(e)).trim().replace(Lv, "\n").split("\n"),
            d = [],
            h = t
              ? (function (e, t = 1) {
                  return ig(e, 9e4, 1 / t);
                })(t.baseTime, t.timescale)
              : 0,
            c = "00:00.000",
            f = 0,
            p = 0,
            g = !0;
          ((l.oncue = function (e) {
            var a = r[i],
              s = r.ccOffset,
              l = (f - h) / 9e4;
            if (
              (null != a &&
                a.new &&
                (void 0 !== p
                  ? (s = r.ccOffset = a.start)
                  : (function (e, t, r) {
                      var i = e[t],
                        n = e[i.prevCC];
                      if (!n || (!n.new && i.new))
                        return ((e.ccOffset = e.presentationOffset = i.start), void (i.new = !1));
                      for (; null != (a = n) && a.new; ) {
                        var a;
                        ((e.ccOffset += i.start - n.start), (i.new = !1), (n = e[(i = n).prevCC]));
                      }
                      e.presentationOffset = r;
                    })(r, i, l)),
              l)
            ) {
              if (!t) return void (o = new Error("Missing initPTS for VTT MPEGTS"));
              s = l - r.presentationOffset;
            }
            var u = e.endTime - e.startTime,
              c = hg(9e4 * (e.startTime + s - p), 9e4 * n) / 9e4;
            ((e.startTime = Math.max(c, 0)), (e.endTime = Math.max(c + u, 0)));
            var g = e.text.trim();
            ((e.text = decodeURIComponent(encodeURIComponent(g))),
              e.id || (e.id = Dv(e.startTime, e.endTime, g)),
              e.endTime > 0 && d.push(e));
          }),
            (l.onparsingerror = function (e) {
              o = e;
            }),
            (l.onflush = function () {
              o ? s(o) : a(d);
            }),
            u.forEach(e => {
              if (g) {
                if (Mv(e, "X-TIMESTAMP-MAP=")) {
                  ((g = !1),
                    e
                      .slice(16)
                      .split(",")
                      .forEach(e => {
                        Mv(e, "LOCAL:") ? (c = e.slice(6)) : Mv(e, "MPEGTS:") && (f = parseInt(e.slice(7)));
                      }));
                  try {
                    p =
                      (function (e) {
                        var t = parseInt(e.slice(-3)),
                          r = parseInt(e.slice(-6, -4)),
                          i = parseInt(e.slice(-9, -7)),
                          n = e.length > 9 ? parseInt(e.substring(0, e.indexOf(":"))) : 0;
                        if (!(bu(t) && bu(r) && bu(i) && bu(n)))
                          throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);
                        return ((t += 1e3 * r), (t += 6e4 * i), t + 36e5 * n);
                      })(c) / 1e3;
                  } catch (t) {
                    o = t;
                  }
                  return;
                }
                "" === e && (g = !1);
              }
              l.parse(e + "\n");
            }),
            l.flush());
        }
        var Pv = "stpp.ttml.im1t",
          Ov = /^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,
          Nv = /^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,
          Fv = { left: "start", center: "center", right: "end", start: "start", end: "end" };
        function Uv(e, t, r, i) {
          var n = yd(new Uint8Array(e), ["mdat"]);
          if (0 !== n.length) {
            var a = n.map(e => qu(e)),
              s = (function (e, t, r = 1, i = !1) {
                return ig(e, t, 1 / r, i);
              })(t.baseTime, 1, t.timescale);
            try {
              a.forEach(e =>
                r(
                  (function (e, t) {
                    var r = new DOMParser().parseFromString(e, "text/xml"),
                      i = r.getElementsByTagName("tt")[0];
                    if (!i) throw new Error("Invalid ttml");
                    var n = { frameRate: 30, subFrameRate: 1, frameRateMultiplier: 0, tickRate: 0 },
                      a = Object.keys(n).reduce(
                        (e, t) => ((e[t] = i.getAttribute(`ttp:${t}`) || n[t]), e),
                        {},
                      ),
                      s = "preserve" !== i.getAttribute("xml:space"),
                      o = $v(Bv(i, "styling", "style")),
                      l = $v(Bv(i, "layout", "region")),
                      u = Bv(i, "body", "[begin]");
                    return [].map
                      .call(u, e => {
                        var r = jv(e, s);
                        if (!r || !e.hasAttribute("begin")) return null;
                        var i = Hv(e.getAttribute("begin"), a),
                          n = Hv(e.getAttribute("dur"), a),
                          u = Hv(e.getAttribute("end"), a);
                        if (null === i) throw Vv(e);
                        if (null === u) {
                          if (null === n) throw Vv(e);
                          u = i + n;
                        }
                        var d = new bv(i - t, u - t, r);
                        d.id = Dv(d.startTime, d.endTime, d.text);
                        var h = (function (e, t, r) {
                            var i = "http://www.w3.org/ns/ttml#styling",
                              n = null,
                              a = [
                                "displayAlign",
                                "textAlign",
                                "color",
                                "backgroundColor",
                                "fontSize",
                                "fontFamily",
                              ],
                              s = null != e && e.hasAttribute("style") ? e.getAttribute("style") : null;
                            s && r.hasOwnProperty(s) && (n = r[s]);
                            return a.reduce((r, a) => {
                              var s = Gv(t, i, a) || Gv(e, i, a) || Gv(n, i, a);
                              return (s && (r[a] = s), r);
                            }, {});
                          })(l[e.getAttribute("region")], o[e.getAttribute("style")], o),
                          c = h.textAlign;
                        if (c) {
                          var f = Fv[c];
                          (f && (d.lineAlign = f), (d.align = c));
                        }
                        return (Nu(d, h), d);
                      })
                      .filter(e => null !== e);
                  })(e, s),
                ),
              );
            } catch (o) {
              i(o);
            }
          } else i(new Error("Could not parse IMSC1 mdat"));
        }
        function Bv(e, t, r) {
          var i = e.getElementsByTagName(t)[0];
          return i ? [].slice.call(i.querySelectorAll(r)) : [];
        }
        function $v(e) {
          return e.reduce((e, t) => {
            var r = t.getAttribute("xml:id");
            return (r && (e[r] = t), e);
          }, {});
        }
        function jv(e, t) {
          return [].slice.call(e.childNodes).reduce((e, r, i) => {
            var n;
            return "br" === r.nodeName && i
              ? e + "\n"
              : null != (n = r.childNodes) && n.length
                ? jv(r, t)
                : t
                  ? e + r.textContent.trim().replace(/\s+/g, " ")
                  : e + r.textContent;
          }, "");
        }
        function Gv(e, t, r) {
          return e && e.hasAttributeNS(t, r) ? e.getAttributeNS(t, r) : null;
        }
        function Vv(e) {
          return new Error(`Could not parse ttml timestamp ${e}`);
        }
        function Hv(e, t) {
          if (!e) return null;
          var r = Ev(e);
          return (
            null === r &&
              (Ov.test(e)
                ? (r = (function (e, t) {
                    var r = Ov.exec(e),
                      i = (0 | r[4]) + (0 | r[5]) / t.subFrameRate;
                    return 3600 * (0 | r[1]) + 60 * (0 | r[2]) + (0 | r[3]) + i / t.frameRate;
                  })(e, t))
                : Nv.test(e) &&
                  (r = (function (e, t) {
                    var r = Nv.exec(e),
                      i = Number(r[1]);
                    switch (r[2]) {
                      case "h":
                        return 3600 * i;
                      case "m":
                        return 60 * i;
                      case "ms":
                        return 1e3 * i;
                      case "f":
                        return i / t.frameRate;
                      case "t":
                        return i / t.tickRate;
                    }
                    return i;
                  })(e, t))),
            r
          );
        }
        class Kv {
          constructor(e, t) {
            ((this.timelineController = void 0),
              (this.cueRanges = []),
              (this.trackName = void 0),
              (this.startTime = null),
              (this.endTime = null),
              (this.screen = null),
              (this.timelineController = e),
              (this.trackName = t));
          }
          dispatchCue() {
            null !== this.startTime &&
              (this.timelineController.addCues(
                this.trackName,
                this.startTime,
                this.endTime,
                this.screen,
                this.cueRanges,
              ),
              (this.startTime = null));
          }
          newCue(e, t, r) {
            ((null === this.startTime || this.startTime > e) && (this.startTime = e),
              (this.endTime = t),
              (this.screen = r),
              this.timelineController.createCaptionsTrack(this.trackName));
          }
          reset() {
            ((this.cueRanges = []), (this.startTime = null));
          }
        }
        function Wv(e) {
          return e.characteristics &&
            /transcribes-spoken-dialog/gi.test(e.characteristics) &&
            /describes-music-and-sound/gi.test(e.characteristics)
            ? "captions"
            : "subtitles";
        }
        function zv(e, t) {
          return !!e && e.kind === Wv(t) && kg(t, e);
        }
        function qv(e, t, r, i) {
          return Math.min(t, i) - Math.max(e, r);
        }
        var Xv = /\s/,
          Yv = {
            newCue(e, t, r, i) {
              for (
                var n, a, s, o, l, u = [], d = self.VTTCue || self.TextTrackCue, h = 0;
                h < i.rows.length;
                h++
              )
                if (((s = !0), (o = 0), (l = ""), !(n = i.rows[h]).isEmpty())) {
                  for (var c, f = 0; f < n.chars.length; f++)
                    Xv.test(n.chars[f].uchar) && s ? o++ : ((l += n.chars[f].uchar), (s = !1));
                  ((n.cueStartTime = t), t === r && (r += 1e-4), o >= 16 ? o-- : o++);
                  var p = Rv(l.trim()),
                    g = Dv(t, r, p);
                  (null != e && null != (c = e.cues) && c.getCueById(g)) ||
                    (((a = new d(t, r, p)).id = g),
                    (a.line = h + 1),
                    (a.align = "left"),
                    (a.position = 10 + Math.min(80, 10 * Math.floor((8 * o) / 32))),
                    u.push(a));
                }
              return (
                e &&
                  u.length &&
                  (u.sort((e, t) =>
                    "auto" === e.line || "auto" === t.line
                      ? 0
                      : e.line > 8 && t.line > 8
                        ? t.line - e.line
                        : e.line - t.line,
                  ),
                  u.forEach(t => Nm(e, t))),
                u
              );
            },
          };
        var Qv = /(\d+)-(\d+)\/(\d+)/;
        class Jv {
          constructor(e) {
            ((this.fetchSetup = void 0),
              (this.requestTimeout = void 0),
              (this.request = null),
              (this.response = null),
              (this.controller = void 0),
              (this.context = null),
              (this.config = null),
              (this.callbacks = null),
              (this.stats = void 0),
              (this.loader = null),
              (this.fetchSetup = e.fetchSetup || Zv),
              (this.controller = new self.AbortController()),
              (this.stats = new td()));
          }
          destroy() {
            ((this.loader = this.callbacks = this.context = this.config = this.request = null),
              this.abortInternal(),
              (this.response = null),
              (this.fetchSetup = this.controller = this.stats = null));
          }
          abortInternal() {
            this.controller &&
              !this.stats.loading.end &&
              ((this.stats.aborted = !0), this.controller.abort());
          }
          abort() {
            var e;
            (this.abortInternal(),
              null != (e = this.callbacks) &&
                e.onAbort &&
                this.callbacks.onAbort(this.stats, this.context, this.response));
          }
          load(e, t, r) {
            var i = this.stats;
            if (i.loading.start) throw new Error("Loader can only be used once.");
            i.loading.start = self.performance.now();
            var n = (function (e, t) {
                var r = {
                  method: "GET",
                  mode: "cors",
                  credentials: "same-origin",
                  signal: t,
                  headers: new self.Headers(Nu({}, e.headers)),
                };
                e.rangeEnd && r.headers.set("Range", "bytes=" + e.rangeStart + "-" + String(e.rangeEnd - 1));
                return r;
              })(e, this.controller.signal),
              a = "arraybuffer" === e.responseType,
              s = a ? "byteLength" : "length",
              o = t.loadPolicy,
              l = o.maxTimeToFirstByteMs,
              u = o.maxLoadTimeMs;
            ((this.context = e),
              (this.config = t),
              (this.callbacks = r),
              (this.request = this.fetchSetup(e, n)),
              self.clearTimeout(this.requestTimeout),
              (t.timeout = l && bu(l) ? l : u),
              (this.requestTimeout = self.setTimeout(() => {
                this.callbacks && (this.abortInternal(), this.callbacks.onTimeout(i, e, this.response));
              }, t.timeout)),
              (Tg(this.request) ? this.request.then(self.fetch) : self.fetch(this.request))
                .then(r => {
                  var n;
                  this.response = this.loader = r;
                  var s = Math.max(self.performance.now(), i.loading.start);
                  if (
                    (self.clearTimeout(this.requestTimeout),
                    (t.timeout = u),
                    (this.requestTimeout = self.setTimeout(
                      () => {
                        this.callbacks &&
                          (this.abortInternal(), this.callbacks.onTimeout(i, e, this.response));
                      },
                      u - (s - i.loading.start),
                    )),
                    !r.ok)
                  ) {
                    var o = r.status,
                      l = r.statusText;
                    throw new ey(l || "fetch, bad network response", o, r);
                  }
                  ((i.loading.first = s),
                    (i.total =
                      (function (e) {
                        var t = e.get("Content-Range");
                        if (t) {
                          var r = (function (e) {
                            var t = Qv.exec(e);
                            if (t) return parseInt(t[2]) - parseInt(t[1]) + 1;
                          })(t);
                          if (bu(r)) return r;
                        }
                        var i = e.get("Content-Length");
                        if (i) return parseInt(i);
                      })(r.headers) || i.total));
                  var d = null == (n = this.callbacks) ? void 0 : n.onProgress;
                  return d && bu(t.highWaterMark)
                    ? this.loadProgressively(r, i, e, t.highWaterMark, d)
                    : a
                      ? r.arrayBuffer()
                      : "json" === e.responseType
                        ? r.json()
                        : r.text();
                })
                .then(r => {
                  var n,
                    a,
                    o = this.response;
                  if (!o) throw new Error("loader destroyed");
                  (self.clearTimeout(this.requestTimeout),
                    (i.loading.end = Math.max(self.performance.now(), i.loading.first)));
                  var l = r[s];
                  l && (i.loaded = i.total = l);
                  var u = { url: o.url, data: r, code: o.status },
                    d = null == (n = this.callbacks) ? void 0 : n.onProgress;
                  (d && !bu(t.highWaterMark) && d(i, e, r, o),
                    null == (a = this.callbacks) || a.onSuccess(u, i, e, o));
                })
                .catch(t => {
                  var r;
                  if ((self.clearTimeout(this.requestTimeout), !i.aborted)) {
                    var n = (t && t.code) || 0,
                      a = t ? t.message : null;
                    null == (r = this.callbacks) ||
                      r.onError({ code: n, text: a }, e, t ? t.details : null, i);
                  }
                }));
          }
          getCacheAge() {
            var e = null;
            if (this.response) {
              var t = this.response.headers.get("age");
              e = t ? parseFloat(t) : null;
            }
            return e;
          }
          getResponseHeader(e) {
            return this.response ? this.response.headers.get(e) : null;
          }
          loadProgressively(e, t, r, i = 0, n) {
            var a = new qf(),
              s = e.body.getReader(),
              o = () =>
                s
                  .read()
                  .then(s => {
                    if (s.done)
                      return (
                        a.dataLength && n(t, r, a.flush().buffer, e),
                        Promise.resolve(new ArrayBuffer(0))
                      );
                    var l = s.value,
                      u = l.length;
                    return (
                      (t.loaded += u),
                      u < i || a.dataLength
                        ? (a.push(l), a.dataLength >= i && n(t, r, a.flush().buffer, e))
                        : n(t, r, l.buffer, e),
                      o()
                    );
                  })
                  .catch(() => Promise.reject());
            return o();
          }
        }
        function Zv(e, t) {
          return new self.Request(e.url, t);
        }
        class ey extends Error {
          constructor(e, t, r) {
            (super(e), (this.code = void 0), (this.details = void 0), (this.code = t), (this.details = r));
          }
        }
        var ty = /^age:\s*[\d.]+\s*$/im;
        class ry {
          constructor(e) {
            ((this.xhrSetup = void 0),
              (this.requestTimeout = void 0),
              (this.retryTimeout = void 0),
              (this.retryDelay = void 0),
              (this.config = null),
              (this.callbacks = null),
              (this.context = null),
              (this.loader = null),
              (this.stats = void 0),
              (this.xhrSetup = (e && e.xhrSetup) || null),
              (this.stats = new td()),
              (this.retryDelay = 0));
          }
          destroy() {
            ((this.callbacks = null),
              this.abortInternal(),
              (this.loader = null),
              (this.config = null),
              (this.context = null),
              (this.xhrSetup = null));
          }
          abortInternal() {
            var e = this.loader;
            (self.clearTimeout(this.requestTimeout),
              self.clearTimeout(this.retryTimeout),
              e &&
                ((e.onreadystatechange = null),
                (e.onprogress = null),
                4 !== e.readyState && ((this.stats.aborted = !0), e.abort())));
          }
          abort() {
            var e;
            (this.abortInternal(),
              null != (e = this.callbacks) &&
                e.onAbort &&
                this.callbacks.onAbort(this.stats, this.context, this.loader));
          }
          load(e, t, r) {
            if (this.stats.loading.start) throw new Error("Loader can only be used once.");
            ((this.stats.loading.start = self.performance.now()),
              (this.context = e),
              (this.config = t),
              (this.callbacks = r),
              this.loadInternal());
          }
          loadInternal() {
            var e = this.config,
              t = this.context;
            if (e && t) {
              var r = (this.loader = new self.XMLHttpRequest()),
                i = this.stats;
              ((i.loading.first = 0), (i.loaded = 0), (i.aborted = !1));
              var n = this.xhrSetup;
              n
                ? Promise.resolve()
                    .then(() => {
                      if (this.loader === r && !this.stats.aborted) return n(r, t.url);
                    })
                    .catch(e => {
                      if (this.loader === r && !this.stats.aborted)
                        return (r.open("GET", t.url, !0), n(r, t.url));
                    })
                    .then(() => {
                      this.loader !== r || this.stats.aborted || this.openAndSendXhr(r, t, e);
                    })
                    .catch(e => {
                      var n;
                      null == (n = this.callbacks) || n.onError({ code: r.status, text: e.message }, t, r, i);
                    })
                : this.openAndSendXhr(r, t, e);
            }
          }
          openAndSendXhr(e, t, r) {
            e.readyState || e.open("GET", t.url, !0);
            var i = t.headers,
              n = r.loadPolicy,
              a = n.maxTimeToFirstByteMs,
              s = n.maxLoadTimeMs;
            if (i) for (var o in i) e.setRequestHeader(o, i[o]);
            (t.rangeEnd && e.setRequestHeader("Range", "bytes=" + t.rangeStart + "-" + (t.rangeEnd - 1)),
              (e.onreadystatechange = this.readystatechange.bind(this)),
              (e.onprogress = this.loadprogress.bind(this)),
              (e.responseType = t.responseType),
              self.clearTimeout(this.requestTimeout),
              (r.timeout = a && bu(a) ? a : s),
              (this.requestTimeout = self.setTimeout(this.loadtimeout.bind(this), r.timeout)),
              e.send());
          }
          readystatechange() {
            var e = this.context,
              t = this.loader,
              r = this.stats;
            if (e && t) {
              var i = t.readyState,
                n = this.config;
              if (
                !r.aborted &&
                i >= 2 &&
                (0 === r.loading.first &&
                  ((r.loading.first = Math.max(self.performance.now(), r.loading.start)),
                  n.timeout !== n.loadPolicy.maxLoadTimeMs &&
                    (self.clearTimeout(this.requestTimeout),
                    (n.timeout = n.loadPolicy.maxLoadTimeMs),
                    (this.requestTimeout = self.setTimeout(
                      this.loadtimeout.bind(this),
                      n.loadPolicy.maxLoadTimeMs - (r.loading.first - r.loading.start),
                    )))),
                4 === i)
              ) {
                (self.clearTimeout(this.requestTimeout),
                  (t.onreadystatechange = null),
                  (t.onprogress = null));
                var a = t.status,
                  s = "text" === t.responseType ? t.responseText : null;
                if (a >= 200 && a < 300) {
                  var o = null != s ? s : t.response;
                  if (null != o) {
                    var l, u;
                    r.loading.end = Math.max(self.performance.now(), r.loading.first);
                    var d = "arraybuffer" === t.responseType ? o.byteLength : o.length;
                    ((r.loaded = r.total = d),
                      (r.bwEstimate = (8e3 * r.total) / (r.loading.end - r.loading.first)));
                    var h = null == (l = this.callbacks) ? void 0 : l.onProgress;
                    h && h(r, e, o, t);
                    var c = { url: t.responseURL, data: o, code: a };
                    return void (null == (u = this.callbacks) || u.onSuccess(c, r, e, t));
                  }
                }
                var f,
                  p = n.loadPolicy.errorRetry;
                if (Ph(p, r.retry, !1, { url: e.url, data: void 0, code: a })) this.retry(p);
                else
                  (Ku.error(`${a} while loading ${e.url}`),
                    null == (f = this.callbacks) || f.onError({ code: a, text: t.statusText }, e, t, r));
              }
            }
          }
          loadtimeout() {
            if (this.config) {
              var e = this.config.loadPolicy.timeoutRetry;
              if (Ph(e, this.stats.retry, !0)) this.retry(e);
              else {
                var t;
                Ku.warn(`timeout while loading ${null == (t = this.context) ? void 0 : t.url}`);
                var r = this.callbacks;
                r && (this.abortInternal(), r.onTimeout(this.stats, this.context, this.loader));
              }
            }
          }
          retry(e) {
            var t = this.context,
              r = this.stats;
            ((this.retryDelay = Dh(e, r.retry)),
              r.retry++,
              Ku.warn(
                `${status ? "HTTP Status " + status : "Timeout"} while loading ${null == t ? void 0 : t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`,
              ),
              this.abortInternal(),
              (this.loader = null),
              self.clearTimeout(this.retryTimeout),
              (this.retryTimeout = self.setTimeout(this.loadInternal.bind(this), this.retryDelay)));
          }
          loadprogress(e) {
            var t = this.stats;
            ((t.loaded = e.loaded), e.lengthComputable && (t.total = e.total));
          }
          getCacheAge() {
            var e = null;
            if (this.loader && ty.test(this.loader.getAllResponseHeaders())) {
              var t = this.loader.getResponseHeader("age");
              e = t ? parseFloat(t) : null;
            }
            return e;
          }
          getResponseHeader(e) {
            return this.loader &&
              new RegExp(`^${e}:\\s*[\\d.]+\\s*$`, "im").test(this.loader.getAllResponseHeaders())
              ? this.loader.getResponseHeader(e)
              : null;
          }
        }
        var iy = Uu(
          Uu(
            {
              autoStartLoad: !0,
              startPosition: -1,
              defaultAudioCodec: void 0,
              debug: !1,
              capLevelOnFPSDrop: !1,
              capLevelToPlayerSize: !1,
              ignoreDevicePixelRatio: !1,
              maxDevicePixelRatio: Number.POSITIVE_INFINITY,
              preferManagedMediaSource: !0,
              initialLiveManifestSize: 1,
              maxBufferLength: 30,
              backBufferLength: 1 / 0,
              frontBufferFlushThreshold: 1 / 0,
              startOnSegmentBoundary: !1,
              maxBufferSize: 6e7,
              maxFragLookUpTolerance: 0.25,
              maxBufferHole: 0.1,
              detectStallWithCurrentTimeMs: 1250,
              highBufferWatchdogPeriod: 2,
              nudgeOffset: 0.1,
              nudgeMaxRetry: 3,
              nudgeOnVideoHole: !0,
              liveSyncMode: "edge",
              liveSyncDurationCount: 3,
              liveSyncOnStallIncrease: 1,
              liveMaxLatencyDurationCount: 1 / 0,
              liveSyncDuration: void 0,
              liveMaxLatencyDuration: void 0,
              maxLiveSyncPlaybackRate: 1,
              liveDurationInfinity: !1,
              liveBackBufferLength: null,
              maxMaxBufferLength: 600,
              enableWorker: !0,
              workerPath: null,
              enableSoftwareAES: !0,
              startLevel: void 0,
              startFragPrefetch: !1,
              fpsDroppedMonitoringPeriod: 5e3,
              fpsDroppedMonitoringThreshold: 0.2,
              appendErrorMaxRetry: 3,
              ignorePlaylistParsingErrors: !1,
              loader: ry,
              fLoader: void 0,
              pLoader: void 0,
              xhrSetup: void 0,
              licenseXhrSetup: void 0,
              licenseResponseCallback: void 0,
              abrController: class extends Bu {
                constructor(e) {
                  (super("abr", e.logger),
                    (this.hls = void 0),
                    (this.lastLevelLoadSec = 0),
                    (this.lastLoadedFragLevel = -1),
                    (this.firstSelection = -1),
                    (this._nextAutoLevel = -1),
                    (this.nextAutoLevelKey = ""),
                    (this.audioTracksByGroup = null),
                    (this.codecTiers = null),
                    (this.timer = -1),
                    (this.fragCurrent = null),
                    (this.partCurrent = null),
                    (this.bitrateTestDelay = 0),
                    (this.rebufferNotice = -1),
                    (this.supportedCache = {}),
                    (this.bwEstimator = void 0),
                    (this._abandonRulesCheck = e => {
                      var t,
                        r = this.fragCurrent,
                        i = this.partCurrent,
                        n = this.hls,
                        a = n.autoLevelEnabled,
                        s = n.media;
                      if (r && s) {
                        var o = performance.now(),
                          l = i ? i.stats : r.stats,
                          u = i ? i.duration : r.duration,
                          d = o - l.loading.start,
                          h = n.minAutoLevel,
                          c = r.level,
                          f = this._nextAutoLevel;
                        if (l.aborted || (l.loaded && l.loaded === l.total) || c <= h)
                          return (this.clearTimer(), void (this._nextAutoLevel = -1));
                        if (a) {
                          var p = f > -1 && f !== c,
                            g = !!e || p;
                          if (g || (!s.paused && s.playbackRate && s.readyState)) {
                            var m = n.mainForwardBufferInfo;
                            if (g || null !== m) {
                              var v = this.bwEstimator.getEstimateTTFB(),
                                y = Math.abs(s.playbackRate);
                              if (!(d <= Math.max(v, (u / (2 * y)) * 1e3))) {
                                var T = m ? m.len / y : 0,
                                  b = l.loading.first ? l.loading.first - l.loading.start : -1,
                                  S = l.loaded && b > -1,
                                  E = this.getBwEstimate(),
                                  x = n.levels,
                                  w = x[c],
                                  A = Math.max(
                                    l.loaded,
                                    Math.round((u * (r.bitrate || w.averageBitrate)) / 8),
                                  ),
                                  I = S ? d - b : d;
                                I < 1 && S && (I = Math.min(d, (8 * l.loaded) / E));
                                var k = S ? (1e3 * l.loaded) / I : 0,
                                  R = v / 1e3,
                                  C = k ? (A - l.loaded) / k : (8 * A) / E + R;
                                if (!(C <= T)) {
                                  var L,
                                    M = k ? 8 * k : E,
                                    D =
                                      !0 ===
                                      (null ==
                                      (t = (null == e ? void 0 : e.details) || this.hls.latestLevelDetails)
                                        ? void 0
                                        : t.live),
                                    _ = this.hls.config.abrBandWidthUpFactor,
                                    P = Number.POSITIVE_INFINITY;
                                  for (L = c - 1; L > h; L--) {
                                    var O = x[L].maxBitrate,
                                      N = !x[L].details || D;
                                    if ((P = this.getTimeToLoadFrag(R, M, u * O, N)) < Math.min(T, u + R))
                                      break;
                                  }
                                  if (!(P >= C || P > 10 * u)) {
                                    S
                                      ? this.bwEstimator.sample(d - Math.min(v, b), l.loaded)
                                      : this.bwEstimator.sampleTTFB(d);
                                    var F = x[L].maxBitrate;
                                    this.getBwEstimate() * _ > F && this.resetEstimator(F);
                                    var U = this.findBestLevel(F, h, L, 0, T, 1, 1);
                                    (U > -1 && (L = U),
                                      this.warn(
                                        `Fragment ${r.sn}${i ? " part " + i.index : ""} of level ${c} is loading too slowly;\n      Fragment duration: ${r.duration.toFixed(3)}\n      Time to underbuffer: ${T.toFixed(3)} s\n      Estimated load time for current fragment: ${C.toFixed(3)} s\n      Estimated load time for down switch fragment: ${P.toFixed(3)} s\n      TTFB estimate: ${0 | b} ms\n      Current BW estimate: ${bu(E) ? 0 | E : "Unknown"} bps\n      New BW estimate: ${0 | this.getBwEstimate()} bps\n      Switching to level ${L} @ ${0 | F} bps`,
                                      ),
                                      (n.nextLoadLevel = n.nextAutoLevel = L),
                                      this.clearTimer());
                                    var B = () => {
                                      if (
                                        (this.clearTimer(),
                                        this.fragCurrent === r && this.hls.loadLevel === L && L > 0)
                                      ) {
                                        var e = this.getStarvationDelay();
                                        if (
                                          (this.warn(
                                            `Aborting inflight request ${L > 0 ? "and switching down" : ""}\n      Fragment duration: ${r.duration.toFixed(3)} s\n      Time to underbuffer: ${e.toFixed(3)} s`,
                                          ),
                                          r.abortRequests(),
                                          (this.fragCurrent = this.partCurrent = null),
                                          L > h)
                                        ) {
                                          var t = this.findBestLevel(
                                            this.hls.levels[h].bitrate,
                                            h,
                                            L,
                                            0,
                                            e,
                                            1,
                                            1,
                                          );
                                          (-1 === t && (t = h),
                                            (this.hls.nextLoadLevel = this.hls.nextAutoLevel = t),
                                            this.resetEstimator(this.hls.levels[t].bitrate));
                                        }
                                      }
                                    };
                                    (p || C > 2 * P ? B() : (this.timer = self.setInterval(B, 1e3 * P)),
                                      n.trigger(Au.FRAG_LOAD_EMERGENCY_ABORTED, {
                                        frag: r,
                                        part: i,
                                        stats: l,
                                      }));
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }),
                    (this.hls = e),
                    (this.bwEstimator = this.initEstimator()),
                    this.registerListeners());
                }
                resetEstimator(e) {
                  (e &&
                    (this.log(`setting initial bwe to ${e}`), (this.hls.config.abrEwmaDefaultEstimate = e)),
                    (this.firstSelection = -1),
                    (this.bwEstimator = this.initEstimator()));
                }
                initEstimator() {
                  var e = this.hls.config;
                  return new Pu(e.abrEwmaSlowVoD, e.abrEwmaFastVoD, e.abrEwmaDefaultEstimate);
                }
                registerListeners() {
                  var e = this.hls;
                  (e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                    e.on(Au.FRAG_LOADING, this.onFragLoading, this),
                    e.on(Au.FRAG_LOADED, this.onFragLoaded, this),
                    e.on(Au.FRAG_BUFFERED, this.onFragBuffered, this),
                    e.on(Au.LEVEL_SWITCHING, this.onLevelSwitching, this),
                    e.on(Au.LEVEL_LOADED, this.onLevelLoaded, this),
                    e.on(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
                    e.on(Au.MAX_AUTO_LEVEL_UPDATED, this.onMaxAutoLevelUpdated, this),
                    e.on(Au.ERROR, this.onError, this));
                }
                unregisterListeners() {
                  var e = this.hls;
                  e &&
                    (e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                    e.off(Au.FRAG_LOADING, this.onFragLoading, this),
                    e.off(Au.FRAG_LOADED, this.onFragLoaded, this),
                    e.off(Au.FRAG_BUFFERED, this.onFragBuffered, this),
                    e.off(Au.LEVEL_SWITCHING, this.onLevelSwitching, this),
                    e.off(Au.LEVEL_LOADED, this.onLevelLoaded, this),
                    e.off(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
                    e.off(Au.MAX_AUTO_LEVEL_UPDATED, this.onMaxAutoLevelUpdated, this),
                    e.off(Au.ERROR, this.onError, this));
                }
                destroy() {
                  (this.unregisterListeners(),
                    this.clearTimer(),
                    (this.hls = this._abandonRulesCheck = this.supportedCache = null),
                    (this.fragCurrent = this.partCurrent = null));
                }
                onManifestLoading(e, t) {
                  ((this.lastLoadedFragLevel = -1),
                    (this.firstSelection = -1),
                    (this.lastLevelLoadSec = 0),
                    (this.supportedCache = {}),
                    (this.fragCurrent = this.partCurrent = null),
                    this.onLevelsUpdated(),
                    this.clearTimer());
                }
                onLevelsUpdated() {
                  (this.lastLoadedFragLevel > -1 &&
                    this.fragCurrent &&
                    (this.lastLoadedFragLevel = this.fragCurrent.level),
                    (this._nextAutoLevel = -1),
                    this.onMaxAutoLevelUpdated(),
                    (this.codecTiers = null),
                    (this.audioTracksByGroup = null));
                }
                onMaxAutoLevelUpdated() {
                  ((this.firstSelection = -1), (this.nextAutoLevelKey = ""));
                }
                onFragLoading(e, t) {
                  var r = t.frag;
                  if (!this.ignoreFragment(r)) {
                    var i;
                    if (!r.bitrateTest)
                      ((this.fragCurrent = r), (this.partCurrent = null != (i = t.part) ? i : null));
                    (this.clearTimer(), (this.timer = self.setInterval(this._abandonRulesCheck, 100)));
                  }
                }
                onLevelSwitching(e, t) {
                  this.clearTimer();
                }
                onError(e, t) {
                  if (!t.fatal)
                    switch (t.details) {
                      case wu.BUFFER_ADD_CODEC_ERROR:
                      case wu.BUFFER_APPEND_ERROR:
                        ((this.lastLoadedFragLevel = -1), (this.firstSelection = -1));
                        break;
                      case wu.FRAG_LOAD_TIMEOUT:
                        var r = t.frag,
                          i = this.fragCurrent,
                          n = this.partCurrent;
                        if (r && i && r.sn === i.sn && r.level === i.level) {
                          var a = performance.now(),
                            s = n ? n.stats : r.stats,
                            o = a - s.loading.start,
                            l = s.loading.first ? s.loading.first - s.loading.start : -1;
                          if (s.loaded && l > -1) {
                            var u = this.bwEstimator.getEstimateTTFB();
                            this.bwEstimator.sample(o - Math.min(u, l), s.loaded);
                          } else this.bwEstimator.sampleTTFB(o);
                        }
                    }
                }
                getTimeToLoadFrag(e, t, r, i) {
                  return e + r / t + (i ? e + this.lastLevelLoadSec : 0);
                }
                onLevelLoaded(e, t) {
                  var r = this.hls.config,
                    i = t.stats.loading,
                    n = i.end - i.first;
                  (bu(n) && (this.lastLevelLoadSec = n / 1e3),
                    t.details.live
                      ? this.bwEstimator.update(r.abrEwmaSlowLive, r.abrEwmaFastLive)
                      : this.bwEstimator.update(r.abrEwmaSlowVoD, r.abrEwmaFastVoD),
                    this.timer > -1 && this._abandonRulesCheck(t.levelInfo));
                }
                onFragLoaded(e, { frag: t, part: r }) {
                  var i = r ? r.stats : t.stats;
                  if (
                    (t.type === Lu && this.bwEstimator.sampleTTFB(i.loading.first - i.loading.start),
                    !this.ignoreFragment(t))
                  ) {
                    if (
                      (this.clearTimer(),
                      t.level === this._nextAutoLevel && (this._nextAutoLevel = -1),
                      (this.firstSelection = -1),
                      this.hls.config.abrMaxWithRealBitrate)
                    ) {
                      var n = r ? r.duration : t.duration,
                        a = this.hls.levels[t.level],
                        s = (a.loaded ? a.loaded.bytes : 0) + i.loaded,
                        o = (a.loaded ? a.loaded.duration : 0) + n;
                      ((a.loaded = { bytes: s, duration: o }), (a.realBitrate = Math.round((8 * s) / o)));
                    }
                    if (t.bitrateTest) {
                      var l = { stats: i, frag: t, part: r, id: t.type };
                      (this.onFragBuffered(Au.FRAG_BUFFERED, l), (t.bitrateTest = !1));
                    } else this.lastLoadedFragLevel = t.level;
                  }
                }
                onFragBuffered(e, t) {
                  var r = t.frag,
                    i = t.part,
                    n = null != i && i.stats.loaded ? i.stats : r.stats;
                  if (!n.aborted && !this.ignoreFragment(r)) {
                    var a =
                      n.parsing.end -
                      n.loading.start -
                      Math.min(n.loading.first - n.loading.start, this.bwEstimator.getEstimateTTFB());
                    (this.bwEstimator.sample(a, n.loaded),
                      (n.bwEstimate = this.getBwEstimate()),
                      r.bitrateTest ? (this.bitrateTestDelay = a / 1e3) : (this.bitrateTestDelay = 0));
                  }
                }
                ignoreFragment(e) {
                  return e.type !== Lu || "initSegment" === e.sn;
                }
                clearTimer() {
                  this.timer > -1 && (self.clearInterval(this.timer), (this.timer = -1));
                }
                get firstAutoLevel() {
                  var e = this.hls,
                    t = e.maxAutoLevel,
                    r = e.minAutoLevel,
                    i = this.getBwEstimate(),
                    n = this.hls.config.maxStarvationDelay,
                    a = this.findBestLevel(i, r, t, 0, n, 1, 1);
                  if (a > -1) return a;
                  var s = this.hls.firstLevel,
                    o = Math.min(Math.max(s, r), t);
                  return (
                    this.warn(
                      `Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${o}`,
                    ),
                    o
                  );
                }
                get forcedAutoLevel() {
                  return this.nextAutoLevelKey ? -1 : this._nextAutoLevel;
                }
                get nextAutoLevel() {
                  var e = this.forcedAutoLevel,
                    t = this.bwEstimator.canEstimate(),
                    r = this.lastLoadedFragLevel > -1;
                  if (!(-1 === e || (t && r && this.nextAutoLevelKey !== this.getAutoLevelKey()))) return e;
                  var i = t && r ? this.getNextABRAutoLevel() : this.firstAutoLevel;
                  if (-1 !== e) {
                    var n = this.hls.levels;
                    if (n.length > Math.max(e, i) && n[e].loadError <= n[i].loadError) return e;
                  }
                  return ((this._nextAutoLevel = i), (this.nextAutoLevelKey = this.getAutoLevelKey()), i);
                }
                getAutoLevelKey() {
                  return `${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`;
                }
                getNextABRAutoLevel() {
                  var e = this.fragCurrent,
                    t = this.partCurrent,
                    r = this.hls;
                  if (r.levels.length <= 1) return r.loadLevel;
                  var i = r.maxAutoLevel,
                    n = r.config,
                    a = r.minAutoLevel,
                    s = t ? t.duration : e ? e.duration : 0,
                    o = this.getBwEstimate(),
                    l = this.getStarvationDelay(),
                    u = n.abrBandWidthFactor,
                    d = n.abrBandWidthUpFactor;
                  if (l) {
                    var h = this.findBestLevel(o, a, i, l, 0, u, d);
                    if (h >= 0) return ((this.rebufferNotice = -1), h);
                  }
                  var c = s ? Math.min(s, n.maxStarvationDelay) : n.maxStarvationDelay;
                  if (!l) {
                    var f = this.bitrateTestDelay;
                    if (f)
                      ((c = (s ? Math.min(s, n.maxLoadingDelay) : n.maxLoadingDelay) - f),
                        this.info(
                          `bitrate test took ${Math.round(1e3 * f)}ms, set first fragment max fetchDuration to ${Math.round(1e3 * c)} ms`,
                        ),
                        (u = d = 1));
                  }
                  var p = this.findBestLevel(o, a, i, l, c, u, d);
                  if (
                    (this.rebufferNotice !== p &&
                      ((this.rebufferNotice = p),
                      this.info(
                        `${l ? "rebuffering expected" : "buffer is empty"}, optimal quality level ${p}`,
                      )),
                    p > -1)
                  )
                    return p;
                  var g = r.levels[a],
                    m = r.loadLevelObj;
                  return m && (null == g ? void 0 : g.bitrate) < m.bitrate ? a : r.loadLevel;
                }
                getStarvationDelay() {
                  var e = this.hls,
                    t = e.media;
                  if (!t) return 1 / 0;
                  var r = t && 0 !== t.playbackRate ? Math.abs(t.playbackRate) : 1,
                    i = e.mainForwardBufferInfo;
                  return (i ? i.len : 0) / r;
                }
                getBwEstimate() {
                  return this.bwEstimator.canEstimate()
                    ? this.bwEstimator.getEstimate()
                    : this.hls.config.abrEwmaDefaultEstimate;
                }
                findBestLevel(e, t, r, i, n, a, s) {
                  var o,
                    l = this,
                    u = i + n,
                    d = this.lastLoadedFragLevel,
                    h = -1 === d ? this.hls.firstLevel : d,
                    c = this.fragCurrent,
                    f = this.partCurrent,
                    p = this.hls,
                    g = p.levels,
                    m = p.allAudioTracks,
                    v = p.loadLevel,
                    y = p.config;
                  if (1 === g.length) return 0;
                  var T,
                    b = g[h],
                    S = !(null == (o = this.hls.latestLevelDetails) || !o.live),
                    E = -1 === v || -1 === d,
                    x = "SDR",
                    w = (null == b ? void 0 : b.frameRate) || 0,
                    A = y.audioPreference,
                    I = y.videoPreference,
                    k = this.audioTracksByGroup || (this.audioTracksByGroup = mh(m)),
                    R = -1;
                  if (E) {
                    if (-1 !== this.firstSelection) return this.firstSelection;
                    var C =
                        this.codecTiers ||
                        (this.codecTiers = (function (e, t, r, i) {
                          return e.slice(r, i + 1).reduce((e, r, i) => {
                            if (!r.codecSet) return e;
                            var n = r.audioGroups,
                              a = e[r.codecSet];
                            (a ||
                              (e[r.codecSet] = a =
                                {
                                  minBitrate: 1 / 0,
                                  minHeight: 1 / 0,
                                  minFramerate: 1 / 0,
                                  minIndex: i,
                                  maxScore: 0,
                                  videoRanges: { SDR: 0 },
                                  channels: { 2: 0 },
                                  hasDefaultAudio: !n,
                                  fragmentError: 0,
                                }),
                              (a.minBitrate = Math.min(a.minBitrate, r.bitrate)));
                            var s = Math.min(r.height, r.width);
                            return (
                              (a.minHeight = Math.min(a.minHeight, s)),
                              (a.minFramerate = Math.min(a.minFramerate, r.frameRate)),
                              (a.minIndex = Math.min(a.minIndex, i)),
                              (a.maxScore = Math.max(a.maxScore, r.score)),
                              (a.fragmentError += r.fragmentError),
                              (a.videoRanges[r.videoRange] = (a.videoRanges[r.videoRange] || 0) + 1),
                              n &&
                                n.forEach(e => {
                                  if (e) {
                                    var r = t.groups[e];
                                    r &&
                                      ((a.hasDefaultAudio =
                                        a.hasDefaultAudio || t.hasDefaultAudio
                                          ? r.hasDefault
                                          : r.hasAutoSelect || (!t.hasDefaultAudio && !t.hasAutoSelectAudio)),
                                      Object.keys(r.channels).forEach(e => {
                                        a.channels[e] = (a.channels[e] || 0) + r.channels[e];
                                      }));
                                  }
                                }),
                              e
                            );
                          }, {});
                        })(g, k, t, r)),
                      L = (function (e, t, r, i, n) {
                        for (
                          var a = Object.keys(e),
                            s = null == i ? void 0 : i.channels,
                            o = null == i ? void 0 : i.audioCodec,
                            l = null == n ? void 0 : n.videoCodec,
                            u = s && 2 === parseInt(s),
                            d = !1,
                            h = !1,
                            c = 1 / 0,
                            f = 1 / 0,
                            p = 1 / 0,
                            g = 1 / 0,
                            m = 0,
                            v = [],
                            y = fh(t, n),
                            T = y.preferHDR,
                            b = y.allowedVideoRanges,
                            S = function () {
                              var t = e[a[E]];
                              (d || (d = t.channels[2] > 0),
                                (c = Math.min(c, t.minHeight)),
                                (f = Math.min(f, t.minFramerate)),
                                (p = Math.min(p, t.minBitrate)),
                                b.filter(e => t.videoRanges[e] > 0).length > 0 && (h = !0));
                            },
                            E = a.length;
                          E--;
                        )
                          S();
                        ((c = bu(c) ? c : 0), (f = bu(f) ? f : 0));
                        var x = Math.max(1080, c),
                          w = Math.max(30, f);
                        ((p = bu(p) ? p : r), (r = Math.max(p, r)), h || (t = void 0));
                        var A = a.length > 1;
                        return {
                          codecSet: a.reduce(
                            (t, i) => {
                              var n = e[i];
                              if (i === t) return t;
                              if (((v = h ? b.filter(e => n.videoRanges[e] > 0) : []), A)) {
                                if (n.minBitrate > r)
                                  return (
                                    gh(i, `min bitrate of ${n.minBitrate} > current estimate of ${r}`),
                                    t
                                  );
                                if (!n.hasDefaultAudio)
                                  return (gh(i, "no renditions with default or auto-select sound found"), t);
                                if (o && i.indexOf(o.substring(0, 4)) % 5 != 0)
                                  return (gh(i, `audio codec preference "${o}" not found`), t);
                                if (s && !u) {
                                  if (!n.channels[s])
                                    return (
                                      gh(
                                        i,
                                        `no renditions with ${s} channel sound found (channels options: ${Object.keys(n.channels)})`,
                                      ),
                                      t
                                    );
                                } else if ((!o || u) && d && 0 === n.channels[2])
                                  return (gh(i, "no renditions with stereo sound found"), t);
                                if (n.minHeight > x)
                                  return (gh(i, `min resolution of ${n.minHeight} > maximum of ${x}`), t);
                                if (n.minFramerate > w)
                                  return (gh(i, `min framerate of ${n.minFramerate} > maximum of ${w}`), t);
                                if (!v.some(e => n.videoRanges[e] > 0))
                                  return (gh(i, `no variants with VIDEO-RANGE of ${ph(v)} found`), t);
                                if (l && i.indexOf(l.substring(0, 4)) % 5 != 0)
                                  return (gh(i, `video codec preference "${l}" not found`), t);
                                if (n.maxScore < m)
                                  return (gh(i, `max score of ${n.maxScore} < selected max of ${m}`), t);
                              }
                              return t && (Vd(i) >= Vd(t) || n.fragmentError > e[t].fragmentError)
                                ? t
                                : ((g = n.minIndex), (m = n.maxScore), i);
                            },
                            void 0,
                          ),
                          videoRanges: v,
                          preferHDR: T,
                          minFramerate: f,
                          minBitrate: p,
                          minIndex: g,
                        };
                      })(C, x, e, A, I),
                      M = L.codecSet,
                      D = L.videoRanges,
                      _ = L.minFramerate,
                      P = L.minBitrate,
                      O = L.minIndex,
                      N = L.preferHDR;
                    ((R = O),
                      (T = M),
                      (x = N ? D[D.length - 1] : D[0]),
                      (w = _),
                      (e = Math.max(e, P)),
                      this.log(`picked start tier ${ph(L)}`));
                  } else ((T = null == b ? void 0 : b.codecSet), (x = null == b ? void 0 : b.videoRange));
                  for (
                    var F,
                      U,
                      B = f ? f.duration : c ? c.duration : 0,
                      $ = this.bwEstimator.getEstimateTTFB() / 1e3,
                      j = [],
                      G = function () {
                        var t = g[V],
                          o = V > h;
                        if (!t) return 0;
                        if (y.useMediaCapabilities && !t.supportedResult && !t.supportedPromise) {
                          var c = navigator.mediaCapabilities;
                          "function" == typeof (null == c ? void 0 : c.decodingInfo) &&
                          (function (e, t, r, i, n, a) {
                            var s = e.videoCodec,
                              o = e.audioCodec ? e.audioGroups : null,
                              l = null == a ? void 0 : a.audioCodec,
                              u = null == a ? void 0 : a.channels,
                              d = u ? parseInt(u) : l ? 1 / 0 : 2,
                              h = null;
                            if (null != o && o.length)
                              try {
                                h =
                                  1 === o.length && o[0]
                                    ? t.groups[o[0]].channels
                                    : o.reduce(
                                        (e, r) => {
                                          if (r) {
                                            var i = t.groups[r];
                                            if (!i) throw new Error(`Audio track group ${r} not found`);
                                            Object.keys(i.channels).forEach(t => {
                                              e[t] = (e[t] || 0) + i.channels[t];
                                            });
                                          }
                                          return e;
                                        },
                                        { 2: 0 },
                                      );
                              } catch (c) {
                                return !0;
                              }
                            return (
                              (void 0 !== s &&
                                (s.split(",").some(e => Ld(e)) ||
                                  (e.width > 1920 && e.height > 1088) ||
                                  (e.height > 1920 && e.width > 1088) ||
                                  e.frameRate > Math.max(i, 30) ||
                                  ("SDR" !== e.videoRange && e.videoRange !== r) ||
                                  e.bitrate > Math.max(n, 8e6))) ||
                              (!!h && bu(d) && Object.keys(h).some(e => parseInt(e) > d))
                            );
                          })(t, k, x, w, e, A)
                            ? ((t.supportedPromise = th(t, k, c, l.supportedCache)),
                              t.supportedPromise
                                .then(e => {
                                  if (l.hls) {
                                    t.supportedResult = e;
                                    var r = l.hls.levels,
                                      i = r.indexOf(t);
                                    e.error
                                      ? l.warn(
                                          `MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${ph(e)}`,
                                        )
                                      : e.supported
                                        ? e.decodingInfoResults.some(
                                            e => !1 === e.smooth || !1 === e.powerEfficient,
                                          ) &&
                                          l.log(
                                            `MediaCapabilities decodingInfo for level ${i} not smooth or powerEfficient: ${ph(e)}`,
                                          )
                                        : (l.warn(
                                            `Unsupported MediaCapabilities decodingInfo result for level ${i} ${ph(e)}`,
                                          ),
                                          i > -1 &&
                                            r.length > 1 &&
                                            (l.log(`Removing unsupported level ${i}`),
                                            l.hls.removeLevel(i),
                                            -1 === l.hls.loadLevel && (l.hls.nextLoadLevel = 0)));
                                  }
                                })
                                .catch(e => {
                                  l.warn(`Error handling MediaCapabilities decodingInfo: ${e}`);
                                }))
                            : (t.supportedResult = Zd);
                        }
                        if (
                          ((T && t.codecSet !== T) ||
                            (x && t.videoRange !== x) ||
                            (o && w > t.frameRate) ||
                            (!o && w > 0 && w < t.frameRate) ||
                            (null != (F = t.supportedResult) &&
                              null != (F = F.decodingInfoResults) &&
                              F.some(e => !1 === e.smooth))) &&
                          (!E || V !== R)
                        )
                          return (j.push(V), 0);
                        var p,
                          m = t.details,
                          b =
                            (f
                              ? null == m
                                ? void 0
                                : m.partTarget
                              : null == m
                                ? void 0
                                : m.averagetargetduration) || B;
                        p = o ? s * e : a * e;
                        var I = B && i >= 2 * B && 0 === n ? t.averageBitrate : t.maxBitrate,
                          C = l.getTimeToLoadFrag($, p, I * b, void 0 === m);
                        if (
                          p >= I &&
                          (V === d || (0 === t.loadError && 0 === t.fragmentError)) &&
                          (C <= $ || !bu(C) || (S && !l.bitrateTestDelay) || C < u)
                        ) {
                          var L = l.forcedAutoLevel;
                          return (
                            V === v ||
                              (-1 !== L && L === v) ||
                              (j.length &&
                                l.trace(
                                  `Skipped level(s) ${j.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${g[j[0]].codecs}" ${g[j[0]].videoRange}; not compatible with "${T}" ${x}`,
                                ),
                              l.info(
                                `switch candidate:${h}->${V} adjustedbw(${Math.round(p)})-bitrate=${Math.round(p - I)} ttfb:${$.toFixed(1)} avgDuration:${b.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${C.toFixed(1)} firstSelection:${E} codecSet:${t.codecSet} videoRange:${t.videoRange} hls.loadLevel:${v}`,
                              )),
                            E && (l.firstSelection = V),
                            { v: V }
                          );
                        }
                      },
                      V = r;
                    V >= t;
                    V--
                  )
                    if (0 !== (U = G()) && U) return U.v;
                  return -1;
                }
                set nextAutoLevel(e) {
                  var t = this.deriveNextAutoLevel(e);
                  this._nextAutoLevel !== t && ((this.nextAutoLevelKey = ""), (this._nextAutoLevel = t));
                }
                deriveNextAutoLevel(e) {
                  var t = this.hls,
                    r = t.maxAutoLevel,
                    i = t.minAutoLevel;
                  return Math.min(Math.max(e, i), r);
                }
              },
              bufferController: class extends Bu {
                constructor(e, t) {
                  var r;
                  (super("buffer-controller", e.logger),
                    (this.hls = void 0),
                    (this.fragmentTracker = void 0),
                    (this.details = null),
                    (this._objectUrl = null),
                    (this.operationQueue = null),
                    (this.bufferCodecEventsTotal = 0),
                    (this.media = null),
                    (this.mediaSource = null),
                    (this.lastMpegAudioChunk = null),
                    (this.blockedAudioAppend = null),
                    (this.lastVideoAppendEnd = 0),
                    (this.appendSource = void 0),
                    (this.transferData = void 0),
                    (this.overrides = void 0),
                    (this.appendErrors = { audio: 0, video: 0, audiovideo: 0 }),
                    (this.tracks = {}),
                    (this.sourceBuffers = [
                      [null, null],
                      [null, null],
                    ]),
                    (this._onEndStreaming = e => {
                      var t;
                      this.hls &&
                        "open" === (null == (t = this.mediaSource) ? void 0 : t.readyState) &&
                        this.hls.pauseBuffering();
                    }),
                    (this._onStartStreaming = e => {
                      this.hls && this.hls.resumeBuffering();
                    }),
                    (this._onMediaSourceOpen = e => {
                      var t = this.media,
                        r = this.mediaSource;
                      (e && this.log("Media source opened"),
                        t &&
                          r &&
                          (r.removeEventListener("sourceopen", this._onMediaSourceOpen),
                          t.removeEventListener("emptied", this._onMediaEmptied),
                          this.updateDuration(),
                          this.hls.trigger(Au.MEDIA_ATTACHED, { media: t, mediaSource: r }),
                          null !== this.mediaSource && this.checkPendingTracks()));
                    }),
                    (this._onMediaSourceClose = () => {
                      this.log("Media source closed");
                    }),
                    (this._onMediaSourceEnded = () => {
                      this.log("Media source ended");
                    }),
                    (this._onMediaEmptied = () => {
                      var e = this.mediaSrc,
                        t = this._objectUrl;
                      e !== t &&
                        this.error(`Media element src was set while attaching MediaSource (${t} > ${e})`);
                    }),
                    (this.hls = e),
                    (this.fragmentTracker = t),
                    (this.appendSource =
                      ((r = Wu(e.config.preferManagedMediaSource)),
                      "undefined" != typeof self && r === self.ManagedMediaSource)),
                    this.initTracks(),
                    this.registerListeners());
                }
                hasSourceTypes() {
                  return Object.keys(this.tracks).length > 0;
                }
                destroy() {
                  (this.unregisterListeners(),
                    (this.details = null),
                    (this.lastMpegAudioChunk = this.blockedAudioAppend = null),
                    (this.transferData = this.overrides = void 0),
                    this.operationQueue && (this.operationQueue.destroy(), (this.operationQueue = null)),
                    (this.hls = this.fragmentTracker = null),
                    (this._onMediaSourceOpen = this._onMediaSourceClose = null),
                    (this._onMediaSourceEnded = null),
                    (this._onStartStreaming = this._onEndStreaming = null));
                }
                registerListeners() {
                  var e = this.hls;
                  (e.on(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                    e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                    e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                    e.on(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                    e.on(Au.BUFFER_RESET, this.onBufferReset, this),
                    e.on(Au.BUFFER_APPENDING, this.onBufferAppending, this),
                    e.on(Au.BUFFER_CODECS, this.onBufferCodecs, this),
                    e.on(Au.BUFFER_EOS, this.onBufferEos, this),
                    e.on(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
                    e.on(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
                    e.on(Au.FRAG_PARSED, this.onFragParsed, this),
                    e.on(Au.FRAG_CHANGED, this.onFragChanged, this),
                    e.on(Au.ERROR, this.onError, this));
                }
                unregisterListeners() {
                  var e = this.hls;
                  (e.off(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                    e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                    e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                    e.off(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                    e.off(Au.BUFFER_RESET, this.onBufferReset, this),
                    e.off(Au.BUFFER_APPENDING, this.onBufferAppending, this),
                    e.off(Au.BUFFER_CODECS, this.onBufferCodecs, this),
                    e.off(Au.BUFFER_EOS, this.onBufferEos, this),
                    e.off(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
                    e.off(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
                    e.off(Au.FRAG_PARSED, this.onFragParsed, this),
                    e.off(Au.FRAG_CHANGED, this.onFragChanged, this),
                    e.off(Au.ERROR, this.onError, this));
                }
                transferMedia() {
                  var e = this.media,
                    t = this.mediaSource;
                  if (!e) return null;
                  var i = {};
                  if (this.operationQueue) {
                    var n = this.isUpdating();
                    n || this.operationQueue.removeBlockers();
                    var a = this.isQueued();
                    ((n || a) &&
                      this.warn(
                        `Transfering MediaSource with${a ? " operations in queue" : ""}${n ? " updating SourceBuffer(s)" : ""} ${this.operationQueue}`,
                      ),
                      this.operationQueue.destroy());
                  }
                  var s = this.transferData;
                  return (
                    !this.sourceBufferCount && s && s.mediaSource === t
                      ? Nu(i, s.tracks)
                      : this.sourceBuffers.forEach(e => {
                          var t = r(e, 1)[0];
                          (t && ((i[t] = Nu({}, this.tracks[t])), this.removeBuffer(t)),
                            (e[0] = e[1] = null));
                        }),
                    { media: e, mediaSource: t, tracks: i }
                  );
                }
                initTracks() {
                  ((this.sourceBuffers = [
                    [null, null],
                    [null, null],
                  ]),
                    (this.tracks = {}),
                    this.resetQueue(),
                    this.resetAppendErrors(),
                    (this.lastMpegAudioChunk = this.blockedAudioAppend = null),
                    (this.lastVideoAppendEnd = 0));
                }
                onManifestLoading() {
                  ((this.bufferCodecEventsTotal = 0), (this.details = null));
                }
                onManifestParsed(e, t) {
                  var r,
                    i = 2;
                  (((t.audio && !t.video) || !t.altAudio) && (i = 1),
                    (this.bufferCodecEventsTotal = i),
                    this.log(`${i} bufferCodec event(s) expected.`),
                    null != (r = this.transferData) &&
                      r.mediaSource &&
                      this.sourceBufferCount &&
                      i &&
                      this.bufferCreated());
                }
                onMediaAttaching(e, t) {
                  var r = (this.media = t.media);
                  this.transferData = this.overrides = void 0;
                  var i = Wu(this.appendSource);
                  if (i) {
                    var n = !!t.mediaSource;
                    (n || t.overrides) && ((this.transferData = t), (this.overrides = t.overrides));
                    var a = (this.mediaSource = t.mediaSource || new i());
                    if ((this.assignMediaSource(a), n)) ((this._objectUrl = r.src), this.attachTransferred());
                    else {
                      var s = (this._objectUrl = self.URL.createObjectURL(a));
                      if (this.appendSource)
                        try {
                          r.removeAttribute("src");
                          var o = self.ManagedMediaSource;
                          ((r.disableRemotePlayback = r.disableRemotePlayback || (o && a instanceof o)),
                            Dg(r),
                            (function (e, t) {
                              var r = self.document.createElement("source");
                              ((r.type = "video/mp4"), (r.src = t), e.appendChild(r));
                            })(r, s),
                            r.load());
                        } catch (l) {
                          r.src = s;
                        }
                      else r.src = s;
                    }
                    r.addEventListener("emptied", this._onMediaEmptied);
                  }
                }
                assignMediaSource(e) {
                  var t, r;
                  (this.log(
                    `${(null == (t = this.transferData) ? void 0 : t.mediaSource) === e ? "transferred" : "created"} media source: ${null == (r = e.constructor) ? void 0 : r.name}`,
                  ),
                    e.addEventListener("sourceopen", this._onMediaSourceOpen),
                    e.addEventListener("sourceended", this._onMediaSourceEnded),
                    e.addEventListener("sourceclose", this._onMediaSourceClose),
                    this.appendSource &&
                      (e.addEventListener("startstreaming", this._onStartStreaming),
                      e.addEventListener("endstreaming", this._onEndStreaming)));
                }
                attachTransferred() {
                  var e = this.media,
                    t = this.transferData;
                  if (t && e) {
                    var r = this.tracks,
                      i = t.tracks,
                      n = i ? Object.keys(i) : null,
                      a = n ? n.length : 0,
                      s = () => {
                        Promise.resolve().then(() => {
                          this.media && this.mediaSourceOpenOrEnded && this._onMediaSourceOpen();
                        });
                      };
                    if (i && n && a) {
                      if (!this.tracksReady)
                        return (
                          (this.hls.config.startFragPrefetch = !0),
                          void this.log("attachTransferred: waiting for SourceBuffer track info")
                        );
                      if (
                        (this.log(
                          `attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${ph(r, (e, t) => ("initSegment" === e ? void 0 : t))};\ntransfer tracks: ${ph(i, (e, t) => ("initSegment" === e ? void 0 : t))}}`,
                        ),
                        !zu(i, r))
                      ) {
                        ((t.mediaSource = null), (t.tracks = void 0));
                        var o = e.currentTime,
                          l = this.details,
                          u = Math.max(o, (null == l ? void 0 : l.fragments[0].start) || 0);
                        return u - o > 1
                          ? void this.log(
                              `attachTransferred: waiting for playback to reach new tracks start time ${o} -> ${u}`,
                            )
                          : (this.warn(
                              `attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(r)}") start time: ${u} currentTime: ${o}`,
                            ),
                            this.onMediaDetaching(Au.MEDIA_DETACHING, {}),
                            this.onMediaAttaching(Au.MEDIA_ATTACHING, t),
                            void (e.currentTime = u));
                      }
                      ((this.transferData = void 0),
                        n.forEach(e => {
                          var t = e,
                            r = i[t];
                          if (r) {
                            var n = r.buffer;
                            if (n) {
                              var a = this.fragmentTracker,
                                s = r.id;
                              if (a.hasFragments(s) || a.hasParts(s)) {
                                var o = fc.getBuffered(n);
                                a.detectEvictedFragments(t, o, s, null, !0);
                              }
                              var l = _g(t),
                                u = [t, n];
                              ((this.sourceBuffers[l] = u),
                                n.updating && this.operationQueue && this.operationQueue.prependBlocker(t),
                                this.trackSourceBuffer(t, r));
                            }
                          }
                        }),
                        s(),
                        this.bufferCreated());
                    } else (this.log("attachTransferred: MediaSource w/o SourceBuffers"), s());
                  }
                }
                get mediaSourceOpenOrEnded() {
                  var e,
                    t = null == (e = this.mediaSource) ? void 0 : e.readyState;
                  return "open" === t || "ended" === t;
                }
                onMediaDetaching(e, t) {
                  var r = !!t.transferMedia;
                  this.transferData = this.overrides = void 0;
                  var i = this.media,
                    n = this.mediaSource,
                    a = this._objectUrl;
                  if (n) {
                    if ((this.log("media source " + (r ? "transferring" : "detaching")), r))
                      (this.sourceBuffers.forEach(([e]) => {
                        e && this.removeBuffer(e);
                      }),
                        this.resetQueue());
                    else {
                      if (this.mediaSourceOpenOrEnded) {
                        var s = "open" === n.readyState;
                        try {
                          for (var o = n.sourceBuffers, l = o.length; l--; )
                            (s && o[l].abort(), n.removeSourceBuffer(o[l]));
                          s && n.endOfStream();
                        } catch (Zy) {
                          this.warn(`onMediaDetaching: ${Zy.message} while calling endOfStream`);
                        }
                      }
                      this.sourceBufferCount && this.onBufferReset();
                    }
                    (n.removeEventListener("sourceopen", this._onMediaSourceOpen),
                      n.removeEventListener("sourceended", this._onMediaSourceEnded),
                      n.removeEventListener("sourceclose", this._onMediaSourceClose),
                      this.appendSource &&
                        (n.removeEventListener("startstreaming", this._onStartStreaming),
                        n.removeEventListener("endstreaming", this._onEndStreaming)),
                      (this.mediaSource = null),
                      (this._objectUrl = null));
                  }
                  (i &&
                    (i.removeEventListener("emptied", this._onMediaEmptied),
                    r ||
                      (a && self.URL.revokeObjectURL(a),
                      this.mediaSrc === a
                        ? (i.removeAttribute("src"), this.appendSource && Dg(i), i.load())
                        : this.warn("media|source.src was changed by a third party - skip cleanup")),
                    (this.media = null)),
                    this.hls.trigger(Au.MEDIA_DETACHED, t));
                }
                onBufferReset() {
                  (this.sourceBuffers.forEach(([e]) => {
                    e && this.resetBuffer(e);
                  }),
                    this.initTracks());
                }
                resetBuffer(e) {
                  var t,
                    r = null == (t = this.tracks[e]) ? void 0 : t.buffer;
                  if ((this.removeBuffer(e), r))
                    try {
                      var i;
                      null != (i = this.mediaSource) &&
                        i.sourceBuffers.length &&
                        this.mediaSource.removeSourceBuffer(r);
                    } catch (Zy) {
                      this.warn(`onBufferReset ${e}`, Zy);
                    }
                  delete this.tracks[e];
                }
                removeBuffer(e) {
                  (this.removeBufferListeners(e), (this.sourceBuffers[_g(e)] = [null, null]));
                  var t = this.tracks[e];
                  t && (t.buffer = void 0);
                }
                resetQueue() {
                  (this.operationQueue && this.operationQueue.destroy(),
                    (this.operationQueue = new Rg(this.tracks)));
                }
                onBufferCodecs(e, t) {
                  var r,
                    i = this.tracks,
                    n = Object.keys(t);
                  this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);
                  var a =
                      ("audiovideo" in t && (i.audio || i.video)) ||
                      (i.audiovideo && ("audio" in t || "video" in t)),
                    s = !a && this.sourceBufferCount && this.media && n.some(e => !i[e]);
                  a || s
                    ? this.warn(`Unsupported transition between "${Object.keys(i)}" and "${n}" SourceBuffers`)
                    : (n.forEach(e => {
                        var r,
                          n,
                          a = t[e],
                          s = a.id,
                          o = a.codec,
                          l = a.levelCodec,
                          u = a.container,
                          d = a.metadata,
                          h = a.supplemental,
                          c = i[e],
                          f = null == (r = this.transferData) || null == (r = r.tracks) ? void 0 : r[e],
                          p = null != f && f.buffer ? f : c,
                          g = (null == p ? void 0 : p.pendingCodec) || (null == p ? void 0 : p.codec),
                          m = null == p ? void 0 : p.levelCodec;
                        c ||
                          (c = i[e] =
                            {
                              buffer: void 0,
                              listeners: [],
                              codec: o,
                              supplemental: h,
                              container: u,
                              levelCodec: l,
                              metadata: d,
                              id: s,
                            });
                        var v = zd(g, m),
                          y = null == v ? void 0 : v.replace(Cg, "$1"),
                          T = zd(o, l),
                          b = null == (n = T) ? void 0 : n.replace(Cg, "$1");
                        T &&
                          v &&
                          y !== b &&
                          ("audio" === e.slice(0, 5) && (T = Wd(T, this.appendSource)),
                          this.log(`switching codec ${g} to ${T}`),
                          T !== (c.pendingCodec || c.codec) && (c.pendingCodec = T),
                          (c.container = u),
                          this.appendChangeType(e, u, T));
                      }),
                      (this.tracksReady || this.sourceBufferCount) && (t.tracks = this.sourceBufferTracks),
                      this.sourceBufferCount ||
                        (this.bufferCodecEventsTotal > 1 &&
                          !this.tracks.video &&
                          !t.video &&
                          "main" === (null == (r = t.audio) ? void 0 : r.id) &&
                          (this.log("Main audio-only"), (this.bufferCodecEventsTotal = 1)),
                        this.mediaSourceOpenOrEnded && this.checkPendingTracks()));
                }
                get sourceBufferTracks() {
                  return Object.keys(this.tracks).reduce((e, t) => {
                    var r = this.tracks[t];
                    return (
                      (e[t] = { id: r.id, container: r.container, codec: r.codec, levelCodec: r.levelCodec }),
                      e
                    );
                  }, {});
                }
                appendChangeType(e, t, r) {
                  var i = `${t};codecs=${r}`,
                    n = {
                      label: `change-type=${i}`,
                      execute: () => {
                        var n = this.tracks[e];
                        if (n) {
                          var a = n.buffer;
                          null != a &&
                            a.changeType &&
                            (this.log(`changing ${e} sourceBuffer type to ${i}`),
                            a.changeType(i),
                            (n.codec = r),
                            (n.container = t));
                        }
                        this.shiftAndExecuteNext(e);
                      },
                      onStart: () => {},
                      onComplete: () => {},
                      onError: t => {
                        this.warn(`Failed to change ${e} SourceBuffer type`, t);
                      },
                    };
                  this.append(n, e, this.isPending(this.tracks[e]));
                }
                blockAudio(e) {
                  var t,
                    r = e.start,
                    i = r + 0.05 * e.duration;
                  if (
                    !(!0 === (null == (t = this.fragmentTracker.getAppendedFrag(r, Lu)) ? void 0 : t.gap))
                  ) {
                    var n = {
                      label: "block-audio",
                      execute: () => {
                        var e,
                          t = this.tracks.video;
                        (this.lastVideoAppendEnd > i ||
                          (null != t && t.buffer && fc.isBuffered(t.buffer, i)) ||
                          !0 ===
                            (null == (e = this.fragmentTracker.getAppendedFrag(i, Lu)) ? void 0 : e.gap)) &&
                          ((this.blockedAudioAppend = null), this.shiftAndExecuteNext("audio"));
                      },
                      onStart: () => {},
                      onComplete: () => {},
                      onError: e => {
                        this.warn("Error executing block-audio operation", e);
                      },
                    };
                    ((this.blockedAudioAppend = { op: n, frag: e }), this.append(n, "audio", !0));
                  }
                }
                unblockAudio() {
                  var e = this.blockedAudioAppend,
                    t = this.operationQueue;
                  e && t && ((this.blockedAudioAppend = null), t.unblockAudio(e.op));
                }
                onBufferAppending(e, t) {
                  var r = this.tracks,
                    i = t.data,
                    n = t.type,
                    a = t.parent,
                    s = t.frag,
                    o = t.part,
                    l = t.chunkMeta,
                    u = t.offset,
                    d = l.buffering[n],
                    h = s.sn,
                    c = s.cc,
                    f = self.performance.now();
                  d.start = f;
                  var p = s.stats.buffering,
                    g = o ? o.stats.buffering : null;
                  (0 === p.start && (p.start = f), g && 0 === g.start && (g.start = f));
                  var m = r.audio,
                    v = !1;
                  "audio" === n &&
                    "audio/mpeg" === (null == m ? void 0 : m.container) &&
                    ((v = !this.lastMpegAudioChunk || 1 === l.id || this.lastMpegAudioChunk.sn !== l.sn),
                    (this.lastMpegAudioChunk = l));
                  var y = r.video,
                    T = null == y ? void 0 : y.buffer;
                  if (T && "initSegment" !== h) {
                    var b = o || s,
                      S = this.blockedAudioAppend;
                    if ("audio" !== n || "main" === a || this.blockedAudioAppend || y.ending || y.ended) {
                      if ("video" === n) {
                        var E = b.end;
                        if (S) {
                          var x = S.frag.start;
                          (E > x || E < this.lastVideoAppendEnd || fc.isBuffered(T, x)) &&
                            this.unblockAudio();
                        }
                        this.lastVideoAppendEnd = E;
                      }
                    } else {
                      var w = b.start + 0.05 * b.duration,
                        A = T.buffered,
                        I = this.currentOp("video");
                      A.length || I
                        ? !I && !fc.isBuffered(T, w) && this.lastVideoAppendEnd < w && this.blockAudio(b)
                        : this.blockAudio(b);
                    }
                  }
                  var k = (o || s).start,
                    R = {
                      label: `append-${n}`,
                      execute: () => {
                        var e;
                        d.executeStart = self.performance.now();
                        var t = null == (e = this.tracks[n]) ? void 0 : e.buffer;
                        (t &&
                          (v
                            ? this.updateTimestampOffset(t, k, 0.1, n, h, c)
                            : void 0 !== u && bu(u) && this.updateTimestampOffset(t, u, 1e-6, n, h, c)),
                          this.appendExecutor(i, n));
                      },
                      onStart: () => {},
                      onComplete: () => {
                        var e = self.performance.now();
                        ((d.executeEnd = d.end = e),
                          0 === p.first && (p.first = e),
                          g && 0 === g.first && (g.first = e));
                        var t = {};
                        (this.sourceBuffers.forEach(([e, r]) => {
                          e && (t[e] = fc.getBuffered(r));
                        }),
                          (this.appendErrors[n] = 0),
                          "audio" === n || "video" === n
                            ? (this.appendErrors.audiovideo = 0)
                            : ((this.appendErrors.audio = 0), (this.appendErrors.video = 0)),
                          this.hls.trigger(Au.BUFFER_APPENDED, {
                            type: n,
                            frag: s,
                            part: o,
                            chunkMeta: l,
                            parent: s.type,
                            timeRanges: t,
                          }));
                      },
                      onError: e => {
                        var t,
                          r = {
                            type: xu.MEDIA_ERROR,
                            parent: s.type,
                            details: wu.BUFFER_APPEND_ERROR,
                            sourceBufferName: n,
                            frag: s,
                            part: o,
                            chunkMeta: l,
                            error: e,
                            err: e,
                            fatal: !1,
                          },
                          i = null == (t = this.media) ? void 0 : t.error;
                        if (
                          e.code === DOMException.QUOTA_EXCEEDED_ERR ||
                          "QuotaExceededError" == e.name ||
                          "quota" in e
                        )
                          r.details = wu.BUFFER_FULL_ERROR;
                        else if (
                          e.code === DOMException.INVALID_STATE_ERR &&
                          this.mediaSourceOpenOrEnded &&
                          !i
                        )
                          r.errorAction = Hh(!0);
                        else if (e.name === Lg && 0 === this.sourceBufferCount) r.errorAction = Hh(!0);
                        else {
                          var a = ++this.appendErrors[n];
                          (this.warn(
                            `Failed ${a}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${n}" sourceBuffer (${i || "no media error"})`,
                          ),
                            (a >= this.hls.config.appendErrorMaxRetry || i) && (r.fatal = !0));
                        }
                        this.hls.trigger(Au.ERROR, r);
                      },
                    };
                  (this.log(
                    `queuing "${n}" append sn: ${h}${o ? " p: " + o.index : ""} of ${s.type === Lu ? "level" : "track"} ${s.level} cc: ${c}`,
                  ),
                    this.append(R, n, this.isPending(this.tracks[n])));
                }
                getFlushOp(e, t, r) {
                  return (
                    this.log(`queuing "${e}" remove ${t}-${r}`),
                    {
                      label: "remove",
                      execute: () => {
                        this.removeExecutor(e, t, r);
                      },
                      onStart: () => {},
                      onComplete: () => {
                        this.hls.trigger(Au.BUFFER_FLUSHED, { type: e });
                      },
                      onError: i => {
                        this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`, i);
                      },
                    }
                  );
                }
                onBufferFlushing(e, t) {
                  var r = t.type,
                    i = t.startOffset,
                    n = t.endOffset;
                  r
                    ? this.append(this.getFlushOp(r, i, n), r)
                    : this.sourceBuffers.forEach(([e]) => {
                        e && this.append(this.getFlushOp(e, i, n), e);
                      });
                }
                onFragParsed(e, t) {
                  var r = t.frag,
                    i = t.part,
                    n = [],
                    a = i ? i.elementaryStreams : r.elementaryStreams;
                  a[nd] ? n.push("audiovideo") : (a[rd] && n.push("audio"), a[id] && n.push("video"));
                  (0 === n.length &&
                    this.warn(
                      `Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`,
                    ),
                    this.blockBuffers(() => {
                      var e = self.performance.now();
                      ((r.stats.buffering.end = e), i && (i.stats.buffering.end = e));
                      var t = i ? i.stats : r.stats;
                      this.hls.trigger(Au.FRAG_BUFFERED, { frag: r, part: i, stats: t, id: r.type });
                    }, n).catch(e => {
                      (this.warn(`Fragment buffered callback ${e}`),
                        this.stepOperationQueue(this.sourceBufferTypes));
                    }));
                }
                onFragChanged(e, t) {
                  this.trimBuffers();
                }
                get bufferedToEnd() {
                  return (
                    this.sourceBufferCount > 0 &&
                    !this.sourceBuffers.some(([e]) => {
                      if (e) {
                        var t = this.tracks[e];
                        if (t) return !t.ended || t.ending;
                      }
                      return !1;
                    })
                  );
                }
                onBufferEos(e, t) {
                  var r;
                  this.sourceBuffers.forEach(([e]) => {
                    if (e) {
                      var r = this.tracks[e];
                      (t.type && t.type !== e) ||
                        ((r.ending = !0), r.ended || ((r.ended = !0), this.log(`${e} buffer reached EOS`)));
                    }
                  });
                  var i = !1 !== (null == (r = this.overrides) ? void 0 : r.endOfStream);
                  this.sourceBufferCount > 0 &&
                  !this.sourceBuffers.some(([e]) => {
                    var t;
                    return e && !(null != (t = this.tracks[e]) && t.ended);
                  })
                    ? i
                      ? (this.log("Queueing EOS"),
                        this.blockUntilOpen(() => {
                          this.tracksEnded();
                          var e = this.mediaSource;
                          e && "open" === e.readyState
                            ? (this.log("Calling mediaSource.endOfStream()"),
                              e.endOfStream(),
                              this.hls.trigger(Au.BUFFERED_TO_END, void 0))
                            : e &&
                              this.log(
                                `Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`,
                              );
                        }))
                      : (this.tracksEnded(), this.hls.trigger(Au.BUFFERED_TO_END, void 0))
                    : "video" === t.type && this.unblockAudio();
                }
                tracksEnded() {
                  this.sourceBuffers.forEach(([e]) => {
                    if (null !== e) {
                      var t = this.tracks[e];
                      t && (t.ending = !1);
                    }
                  });
                }
                onLevelUpdated(e, { details: t }) {
                  t.fragments.length && ((this.details = t), this.updateDuration());
                }
                updateDuration() {
                  this.blockUntilOpen(() => {
                    var e = this.getDurationAndRange();
                    e && this.updateMediaSource(e);
                  });
                }
                onError(e, t) {
                  if (t.details === wu.BUFFER_APPEND_ERROR && t.frag) {
                    var r,
                      i = null == (r = t.errorAction) ? void 0 : r.nextAutoLevel;
                    bu(i) && i !== t.frag.level && this.resetAppendErrors();
                  }
                }
                resetAppendErrors() {
                  this.appendErrors = { audio: 0, video: 0, audiovideo: 0 };
                }
                trimBuffers() {
                  var e = this.hls,
                    t = this.details,
                    r = this.media;
                  if (r && null !== t && this.sourceBufferCount) {
                    var i = e.config,
                      n = r.currentTime,
                      a = t.levelTargetDuration,
                      s =
                        t.live && null !== i.liveBackBufferLength
                          ? i.liveBackBufferLength
                          : i.backBufferLength;
                    if (bu(s) && s >= 0) {
                      var o = Math.max(s, a),
                        l = Math.floor(n / a) * a - o;
                      this.flushBackBuffer(n, a, l);
                    }
                    var u = i.frontBufferFlushThreshold;
                    if (bu(u) && u > 0) {
                      var d = Math.max(i.maxBufferLength, u),
                        h = Math.max(d, a),
                        c = Math.floor(n / a) * a + h;
                      this.flushFrontBuffer(n, a, c);
                    }
                  }
                }
                flushBackBuffer(e, t, r) {
                  this.sourceBuffers.forEach(([e, t]) => {
                    if (t) {
                      var i = fc.getBuffered(t);
                      if (i.length > 0 && r > i.start(0)) {
                        var n;
                        this.hls.trigger(Au.BACK_BUFFER_REACHED, { bufferEnd: r });
                        var a = this.tracks[e];
                        if (null != (n = this.details) && n.live)
                          this.hls.trigger(Au.LIVE_BACK_BUFFER_REACHED, { bufferEnd: r });
                        else if (null != a && a.ended)
                          return void this.log(
                            `Cannot flush ${e} back buffer while SourceBuffer is in ended state`,
                          );
                        this.hls.trigger(Au.BUFFER_FLUSHING, { startOffset: 0, endOffset: r, type: e });
                      }
                    }
                  });
                }
                flushFrontBuffer(e, t, r) {
                  this.sourceBuffers.forEach(([t, i]) => {
                    if (i) {
                      var n = fc.getBuffered(i),
                        a = n.length;
                      if (a < 2) return;
                      var s = n.start(a - 1),
                        o = n.end(a - 1);
                      if (r > s || (e >= s && e <= o)) return;
                      this.hls.trigger(Au.BUFFER_FLUSHING, { startOffset: s, endOffset: 1 / 0, type: t });
                    }
                  });
                }
                getDurationAndRange() {
                  var e,
                    t = this.details,
                    r = this.mediaSource;
                  if (!t || !this.media || "open" !== (null == r ? void 0 : r.readyState)) return null;
                  var i = t.edge;
                  if (t.live && this.hls.config.liveDurationInfinity) {
                    if (t.fragments.length && r.setLiveSeekableRange) {
                      var n = Math.max(0, t.fragmentStart);
                      return { duration: 1 / 0, start: n, end: Math.max(n, i) };
                    }
                    return { duration: 1 / 0 };
                  }
                  var a = null == (e = this.overrides) ? void 0 : e.duration;
                  if (a) return bu(a) ? { duration: a } : null;
                  var s = this.media.duration;
                  return (i > (bu(r.duration) ? r.duration : 0) && i > s) || !bu(s) ? { duration: i } : null;
                }
                updateMediaSource({ duration: e, start: t, end: r }) {
                  var i = this.mediaSource;
                  this.media &&
                    i &&
                    "open" === i.readyState &&
                    (i.duration !== e &&
                      (bu(e) && this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),
                      (i.duration = e)),
                    void 0 !== t &&
                      void 0 !== r &&
                      (this.log(
                        `MediaSource duration is set to ${i.duration}. Setting seekable range to ${t}-${r}.`,
                      ),
                      i.setLiveSeekableRange(t, r)));
                }
                get tracksReady() {
                  var e = this.pendingTrackCount;
                  return (
                    e > 0 && (e >= this.bufferCodecEventsTotal || this.isPending(this.tracks.audiovideo))
                  );
                }
                checkPendingTracks() {
                  var e = this.bufferCodecEventsTotal,
                    t = this.pendingTrackCount,
                    r = this.tracks;
                  if (
                    (this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${ph(r)}`),
                    this.tracksReady)
                  ) {
                    var i,
                      n = null == (i = this.transferData) ? void 0 : i.tracks;
                    n && Object.keys(n).length ? this.attachTransferred() : this.createSourceBuffers();
                  }
                }
                bufferCreated() {
                  if (this.sourceBufferCount) {
                    var e = {};
                    (this.sourceBuffers.forEach(([t, r]) => {
                      if (t) {
                        var i = this.tracks[t];
                        e[t] = {
                          buffer: r,
                          container: i.container,
                          codec: i.codec,
                          supplemental: i.supplemental,
                          levelCodec: i.levelCodec,
                          id: i.id,
                          metadata: i.metadata,
                        };
                      }
                    }),
                      this.hls.trigger(Au.BUFFER_CREATED, { tracks: e }),
                      this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),
                      this.sourceBuffers.forEach(([e]) => {
                        this.executeNext(e);
                      }));
                  } else {
                    var t = new Error("could not create source buffer for media codec(s)");
                    this.hls.trigger(Au.ERROR, {
                      type: xu.MEDIA_ERROR,
                      details: wu.BUFFER_INCOMPATIBLE_CODECS_ERROR,
                      fatal: !0,
                      error: t,
                      reason: t.message,
                    });
                  }
                }
                createSourceBuffers() {
                  var e = this.tracks,
                    t = this.sourceBuffers,
                    r = this.mediaSource;
                  if (!r) throw new Error("createSourceBuffers called when mediaSource was null");
                  for (var i in e) {
                    var n = i,
                      a = e[n];
                    if (this.isPending(a)) {
                      var s = this.getTrackCodec(a, n),
                        o = `${a.container};codecs=${s}`;
                      ((a.codec = s),
                        this.log(
                          `creating sourceBuffer(${o})${this.currentOp(n) ? " Queued" : ""} ${ph(a)}`,
                        ));
                      try {
                        var l = r.addSourceBuffer(o),
                          u = _g(n),
                          d = [n, l];
                        ((t[u] = d), (a.buffer = l));
                      } catch (c) {
                        var h;
                        return (
                          this.error(`error while trying to add sourceBuffer: ${c.message}`),
                          this.shiftAndExecuteNext(n),
                          null == (h = this.operationQueue) || h.removeBlockers(),
                          delete this.tracks[n],
                          void this.hls.trigger(Au.ERROR, {
                            type: xu.MEDIA_ERROR,
                            details: wu.BUFFER_ADD_CODEC_ERROR,
                            fatal: !1,
                            error: c,
                            sourceBufferName: n,
                            mimeType: o,
                            parent: a.id,
                          })
                        );
                      }
                      this.trackSourceBuffer(n, a);
                    }
                  }
                  this.bufferCreated();
                }
                getTrackCodec(e, t) {
                  var r = e.supplemental,
                    i = e.codec;
                  r &&
                    ("video" === t || "audiovideo" === t) &&
                    Bd(r, "video") &&
                    (i = (function (e, t) {
                      var r = [];
                      if (e)
                        for (var i = e.split(","), n = 0; n < i.length; n++)
                          Ud(i[n], "video") || r.push(i[n]);
                      return (t && r.push(t), r.join(","));
                    })(i, r));
                  var n = zd(i, e.levelCodec);
                  return n ? ("audio" === t.slice(0, 5) ? Wd(n, this.appendSource) : n) : "";
                }
                trackSourceBuffer(e, t) {
                  var r = t.buffer;
                  if (r) {
                    var i = this.getTrackCodec(t, e);
                    ((this.tracks[e] = {
                      buffer: r,
                      codec: i,
                      container: t.container,
                      levelCodec: t.levelCodec,
                      supplemental: t.supplemental,
                      metadata: t.metadata,
                      id: t.id,
                      listeners: [],
                    }),
                      this.removeBufferListeners(e),
                      this.addBufferListener(e, "updatestart", this.onSBUpdateStart),
                      this.addBufferListener(e, "updateend", this.onSBUpdateEnd),
                      this.addBufferListener(e, "error", this.onSBUpdateError),
                      this.appendSource &&
                        this.addBufferListener(e, "bufferedchange", (e, t) => {
                          var r = t.removedRanges;
                          null != r && r.length && this.hls.trigger(Au.BUFFER_FLUSHED, { type: e });
                        }));
                  }
                }
                get mediaSrc() {
                  var e,
                    t,
                    r =
                      (null == (e = this.media) || null == (t = e.querySelector)
                        ? void 0
                        : t.call(e, "source")) || this.media;
                  return null == r ? void 0 : r.src;
                }
                onSBUpdateStart(e) {
                  var t = this.currentOp(e);
                  t && t.onStart();
                }
                onSBUpdateEnd(e) {
                  var t;
                  if ("closed" !== (null == (t = this.mediaSource) ? void 0 : t.readyState)) {
                    var r = this.currentOp(e);
                    r && (r.onComplete(), this.shiftAndExecuteNext(e));
                  } else this.resetBuffer(e);
                }
                onSBUpdateError(e, t) {
                  var r,
                    i = new Error(
                      `${e} SourceBuffer error. MediaSource readyState: ${null == (r = this.mediaSource) ? void 0 : r.readyState}`,
                    );
                  (this.error(`${i}`, t),
                    this.hls.trigger(Au.ERROR, {
                      type: xu.MEDIA_ERROR,
                      details: wu.BUFFER_APPENDING_ERROR,
                      sourceBufferName: e,
                      error: i,
                      fatal: !1,
                    }));
                  var n = this.currentOp(e);
                  n && n.onError(i);
                }
                updateTimestampOffset(e, t, r, i, n, a) {
                  var s = t - e.timestampOffset;
                  Math.abs(s) >= r &&
                    (this.log(`Updating ${i} SourceBuffer timestampOffset to ${t} (sn: ${n} cc: ${a})`),
                    (e.timestampOffset = t));
                }
                removeExecutor(e, t, r) {
                  var i = this.media,
                    n = this.mediaSource,
                    a = this.tracks[e],
                    s = null == a ? void 0 : a.buffer;
                  if (!i || !n || !s)
                    return (
                      this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),
                      void this.shiftAndExecuteNext(e)
                    );
                  var o = bu(i.duration) ? i.duration : 1 / 0,
                    l = bu(n.duration) ? n.duration : 1 / 0,
                    u = Math.max(0, t),
                    d = Math.min(r, o, l);
                  d > u && (!a.ending || a.ended)
                    ? ((a.ended = !1),
                      this.log(`Removing [${u},${d}] from the ${e} SourceBuffer`),
                      s.remove(u, d))
                    : this.shiftAndExecuteNext(e);
                }
                appendExecutor(e, t) {
                  var r = this.tracks[t],
                    i = null == r ? void 0 : r.buffer;
                  if (!i)
                    throw new Mg(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);
                  ((r.ending = !1), (r.ended = !1), i.appendBuffer(e));
                }
                blockUntilOpen(e) {
                  if (this.isUpdating() || this.isQueued())
                    this.blockBuffers(e).catch(e => {
                      (this.warn(`SourceBuffer blocked callback ${e}`),
                        this.stepOperationQueue(this.sourceBufferTypes));
                    });
                  else
                    try {
                      e();
                    } catch (t) {
                      this.warn(`Callback run without blocking ${this.operationQueue} ${t}`);
                    }
                }
                isUpdating() {
                  return this.sourceBuffers.some(([e, t]) => e && t.updating);
                }
                isQueued() {
                  return this.sourceBuffers.some(([e]) => e && !!this.currentOp(e));
                }
                isPending(e) {
                  return !!e && !e.buffer;
                }
                blockBuffers(e, t = this.sourceBufferTypes) {
                  if (!t.length)
                    return (
                      this.log("Blocking operation requested, but no SourceBuffers exist"),
                      Promise.resolve().then(e)
                    );
                  var r = this.operationQueue,
                    i = t.map(e => this.appendBlocker(e));
                  return (
                    t.length > 1 && !!this.blockedAudioAppend && this.unblockAudio(),
                    Promise.all(i).then(t => {
                      r === this.operationQueue && (e(), this.stepOperationQueue(this.sourceBufferTypes));
                    })
                  );
                }
                stepOperationQueue(e) {
                  e.forEach(e => {
                    var t,
                      r = null == (t = this.tracks[e]) ? void 0 : t.buffer;
                    r && !r.updating && this.shiftAndExecuteNext(e);
                  });
                }
                append(e, t, r) {
                  this.operationQueue && this.operationQueue.append(e, t, r);
                }
                appendBlocker(e) {
                  if (this.operationQueue) return this.operationQueue.appendBlocker(e);
                }
                currentOp(e) {
                  return this.operationQueue ? this.operationQueue.current(e) : null;
                }
                executeNext(e) {
                  e && this.operationQueue && this.operationQueue.executeNext(e);
                }
                shiftAndExecuteNext(e) {
                  this.operationQueue && this.operationQueue.shiftAndExecuteNext(e);
                }
                get pendingTrackCount() {
                  return Object.keys(this.tracks).reduce(
                    (e, t) => e + (this.isPending(this.tracks[t]) ? 1 : 0),
                    0,
                  );
                }
                get sourceBufferCount() {
                  return this.sourceBuffers.reduce((e, [t]) => e + (t ? 1 : 0), 0);
                }
                get sourceBufferTypes() {
                  return this.sourceBuffers.map(([e]) => e).filter(e => !!e);
                }
                addBufferListener(e, t, r) {
                  var i = this.tracks[e];
                  if (i) {
                    var n = i.buffer;
                    if (n) {
                      var a = r.bind(this, e);
                      (i.listeners.push({ event: t, listener: a }), n.addEventListener(t, a));
                    }
                  }
                }
                removeBufferListeners(e) {
                  var t = this.tracks[e];
                  if (t) {
                    var r = t.buffer;
                    r &&
                      (t.listeners.forEach(e => {
                        r.removeEventListener(e.event, e.listener);
                      }),
                      (t.listeners.length = 0));
                  }
                }
              },
              capLevelController: Pg,
              errorController: class extends Bu {
                constructor(e) {
                  (super("error-controller", e.logger),
                    (this.hls = void 0),
                    (this.playlistError = 0),
                    (this.hls = e),
                    this.registerListeners());
                }
                registerListeners() {
                  var e = this.hls;
                  (e.on(Au.ERROR, this.onError, this),
                    e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                    e.on(Au.LEVEL_UPDATED, this.onLevelUpdated, this));
                }
                unregisterListeners() {
                  var e = this.hls;
                  e &&
                    (e.off(Au.ERROR, this.onError, this),
                    e.off(Au.ERROR, this.onErrorOut, this),
                    e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                    e.off(Au.LEVEL_UPDATED, this.onLevelUpdated, this));
                }
                destroy() {
                  (this.unregisterListeners(), (this.hls = null));
                }
                startLoad(e) {}
                stopLoad() {
                  this.playlistError = 0;
                }
                getVariantLevelIndex(e) {
                  return (null == e ? void 0 : e.type) === Lu ? e.level : this.getVariantIndex();
                }
                getVariantIndex() {
                  var e,
                    t = this.hls,
                    r = t.currentLevel;
                  return (null != (e = t.loadLevelObj) && e.details) || -1 === r ? t.loadLevel : r;
                }
                variantHasKey(e, t) {
                  if (e) {
                    var r;
                    if (null != (r = e.details) && r.hasKey(t)) return !0;
                    var i = e.audioGroups;
                    if (i)
                      return this.hls.allAudioTracks
                        .filter(e => i.indexOf(e.groupId) >= 0)
                        .some(e => {
                          var r;
                          return null == (r = e.details) ? void 0 : r.hasKey(t);
                        });
                  }
                  return !1;
                }
                onManifestLoading() {
                  this.playlistError = 0;
                }
                onLevelUpdated() {
                  this.playlistError = 0;
                }
                onError(e, t) {
                  var r;
                  if (!t.fatal) {
                    var i = this.hls,
                      n = t.context;
                    switch (t.details) {
                      case wu.FRAG_LOAD_ERROR:
                      case wu.FRAG_LOAD_TIMEOUT:
                      case wu.KEY_LOAD_ERROR:
                      case wu.KEY_LOAD_TIMEOUT:
                        return void (t.errorAction = this.getFragRetryOrSwitchAction(t));
                      case wu.FRAG_PARSING_ERROR:
                        if (null != (r = t.frag) && r.gap) return void (t.errorAction = Hh());
                      case wu.FRAG_GAP:
                      case wu.FRAG_DECRYPT_ERROR:
                        return (
                          (t.errorAction = this.getFragRetryOrSwitchAction(t)),
                          void (t.errorAction.action = Fh)
                        );
                      case wu.LEVEL_EMPTY_ERROR:
                      case wu.LEVEL_PARSING_ERROR:
                        var a,
                          s = t.parent === Lu ? t.level : i.loadLevel;
                        return void (t.details === wu.LEVEL_EMPTY_ERROR &&
                        null != (a = t.context) &&
                        null != (a = a.levelDetails) &&
                        a.live
                          ? (t.errorAction = this.getPlaylistRetryOrSwitchAction(t, s))
                          : ((t.levelRetry = !1), (t.errorAction = this.getLevelSwitchAction(t, s))));
                      case wu.LEVEL_LOAD_ERROR:
                      case wu.LEVEL_LOAD_TIMEOUT:
                        return void (
                          "number" == typeof (null == n ? void 0 : n.level) &&
                          (t.errorAction = this.getPlaylistRetryOrSwitchAction(t, n.level))
                        );
                      case wu.AUDIO_TRACK_LOAD_ERROR:
                      case wu.AUDIO_TRACK_LOAD_TIMEOUT:
                      case wu.SUBTITLE_LOAD_ERROR:
                      case wu.SUBTITLE_TRACK_LOAD_TIMEOUT:
                        if (n) {
                          var o = i.loadLevelObj;
                          if (
                            o &&
                            ((n.type === Ru && o.hasAudioGroup(n.groupId)) ||
                              (n.type === Cu && o.hasSubtitleGroup(n.groupId)))
                          )
                            return (
                              (t.errorAction = this.getPlaylistRetryOrSwitchAction(t, i.loadLevel)),
                              (t.errorAction.action = Fh),
                              void (t.errorAction.flags = jh)
                            );
                        }
                        return;
                      case wu.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:
                        return void (t.errorAction = { action: Fh, flags: Gh });
                      case wu.KEY_SYSTEM_SESSION_UPDATE_FAILED:
                      case wu.KEY_SYSTEM_STATUS_INTERNAL_ERROR:
                      case wu.KEY_SYSTEM_NO_SESSION:
                        return void (t.errorAction = { action: Fh, flags: Vh });
                      case wu.BUFFER_ADD_CODEC_ERROR:
                      case wu.REMUX_ALLOC_ERROR:
                      case wu.BUFFER_APPEND_ERROR:
                        var l;
                        if (!t.errorAction)
                          t.errorAction = this.getLevelSwitchAction(
                            t,
                            null != (l = t.level) ? l : i.loadLevel,
                          );
                        return;
                      case wu.INTERNAL_EXCEPTION:
                      case wu.BUFFER_APPENDING_ERROR:
                      case wu.BUFFER_FULL_ERROR:
                      case wu.LEVEL_SWITCH_ERROR:
                      case wu.BUFFER_STALLED_ERROR:
                      case wu.BUFFER_SEEK_OVER_HOLE:
                      case wu.BUFFER_NUDGE_ON_STALL:
                        return void (t.errorAction = Hh());
                    }
                    t.type === xu.KEY_SYSTEM_ERROR && ((t.levelRetry = !1), (t.errorAction = Hh()));
                  }
                }
                getPlaylistRetryOrSwitchAction(e, t) {
                  var r = Mh(this.hls.config.playlistLoadPolicy, e),
                    i = this.playlistError++;
                  if (Ph(r, i, Rh(e), e.response))
                    return { action: Bh, flags: $h, retryConfig: r, retryCount: i };
                  var n = this.getLevelSwitchAction(e, t);
                  return (r && ((n.retryConfig = r), (n.retryCount = i)), n);
                }
                getFragRetryOrSwitchAction(e) {
                  var t = this.hls,
                    r = this.getVariantLevelIndex(e.frag),
                    i = t.levels[r],
                    n = t.config,
                    a = n.fragLoadPolicy,
                    s = n.keyLoadPolicy,
                    o = Mh(Ch(e) ? s : a, e),
                    l = t.levels.reduce((e, t) => e + t.fragmentError, 0);
                  if (
                    i &&
                    (e.details !== wu.FRAG_GAP && i.fragmentError++, !Lh(e) && Ph(o, l, Rh(e), e.response))
                  )
                    return { action: Bh, flags: $h, retryConfig: o, retryCount: l };
                  var u = this.getLevelSwitchAction(e, r);
                  return (o && ((u.retryConfig = o), (u.retryCount = l)), u);
                }
                getLevelSwitchAction(e, t) {
                  var r = this.hls;
                  null == t && (t = r.loadLevel);
                  var i = this.hls.levels[t];
                  if (i) {
                    var n,
                      a,
                      s = e.details;
                    (i.loadError++, s === wu.BUFFER_APPEND_ERROR && i.fragmentError++);
                    var o = -1,
                      l = r.levels,
                      u = r.loadLevel,
                      d = r.minAutoLevel,
                      h = r.maxAutoLevel;
                    r.autoLevelEnabled || r.config.preserveManualLevelOnError || (r.loadLevel = -1);
                    for (
                      var c,
                        f,
                        p,
                        g = null == (n = e.frag) ? void 0 : n.type,
                        m =
                          ((g === Mu && s === wu.FRAG_PARSING_ERROR) ||
                            ("audio" === e.sourceBufferName &&
                              (s === wu.BUFFER_ADD_CODEC_ERROR || s === wu.BUFFER_APPEND_ERROR))) &&
                          l.some(({ audioCodec: e }) => i.audioCodec !== e),
                        v =
                          "video" === e.sourceBufferName &&
                          (s === wu.BUFFER_ADD_CODEC_ERROR || s === wu.BUFFER_APPEND_ERROR) &&
                          l.some(({ codecSet: e, audioCodec: t }) => i.codecSet !== e && i.audioCodec === t),
                        y = null != (a = e.context) ? a : {},
                        T = y.type,
                        b = y.groupId,
                        S = function () {
                          var t = (E + u) % l.length;
                          if (t !== u && t >= d && t <= h && 0 === l[t].loadError) {
                            var r = l[t];
                            if (s === wu.FRAG_GAP && g === Lu && e.frag) {
                              var n = l[t].details;
                              if (n) {
                                var a = wh(e.frag, n.fragments, e.frag.start);
                                if (null != a && a.gap) return 0;
                              }
                            } else {
                              if ((T === Ru && r.hasAudioGroup(b)) || (T === Cu && r.hasSubtitleGroup(b)))
                                return 0;
                              if (
                                (g === Mu &&
                                  null != (c = i.audioGroups) &&
                                  c.some(e => r.hasAudioGroup(e))) ||
                                (g === Du &&
                                  null != (f = i.subtitleGroups) &&
                                  f.some(e => r.hasSubtitleGroup(e))) ||
                                (m && i.audioCodec === r.audioCodec) ||
                                (v && i.codecSet === r.codecSet) ||
                                (!m && i.codecSet !== r.codecSet)
                              )
                                return 0;
                            }
                            return ((o = t), 1);
                          }
                        },
                        E = l.length;
                      E-- && (0 === (p = S()) || 1 !== p);
                    );
                    if (o > -1 && r.loadLevel !== o)
                      return (
                        (e.levelRetry = !0),
                        (this.playlistError = 0),
                        { action: Fh, flags: $h, nextAutoLevel: o }
                      );
                  }
                  return { action: Fh, flags: jh };
                }
                onErrorOut(e, t) {
                  var r;
                  switch (null == (r = t.errorAction) ? void 0 : r.action) {
                    case Nh:
                      break;
                    case Fh:
                      (this.sendAlternateToPenaltyBox(t),
                        t.errorAction.resolved || t.details === wu.FRAG_GAP
                          ? /MediaSource readyState: ended/.test(t.error.message) &&
                            (this.warn(
                              `MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`,
                            ),
                            this.hls.recoverMediaError())
                          : (t.fatal = !0));
                  }
                  t.fatal && this.hls.stopLoad();
                }
                sendAlternateToPenaltyBox(e) {
                  var t = this.hls,
                    r = e.errorAction;
                  if (r) {
                    var i = r.flags,
                      n = r.nextAutoLevel;
                    switch (i) {
                      case $h:
                        this.switchLevel(e, n);
                        break;
                      case Gh:
                        var a = this.getVariantLevelIndex(e.frag),
                          s = t.levels[a],
                          o = null == s ? void 0 : s.attrs["HDCP-LEVEL"];
                        if (((r.hdcpLevel = o), "NONE" === o))
                          this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");
                        else if (o) {
                          ((t.maxHdcpLevel = nh[nh.indexOf(o) - 1]),
                            (r.resolved = !0),
                            this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`));
                          break;
                        }
                      case Vh:
                        var l = e.decryptdata;
                        if (l) {
                          for (var u = this.hls.levels, d = u.length, h = d; h--; ) {
                            var c, f;
                            if (this.variantHasKey(u[h], l))
                              (this.log(
                                `Banned key found in level ${h} (${u[h].bitrate}bps) or audio group "${null == (c = u[h].audioGroups) ? void 0 : c.join(",")}" (${null == (f = e.frag) ? void 0 : f.type} fragment) ${Xu(l.keyId || [])}`,
                              ),
                                u[h].fragmentError++,
                                u[h].loadError++,
                                this.log(`Removing level ${h} with key error (${e.error})`),
                                this.hls.removeLevel(h));
                          }
                          var p = e.frag;
                          if (this.hls.levels.length < d) r.resolved = !0;
                          else if (p && p.type !== Lu) {
                            var g = p.decryptdata;
                            g && !l.matches(g) && (r.resolved = !0);
                          }
                        }
                    }
                    r.resolved || this.switchLevel(e, n);
                  }
                }
                switchLevel(e, t) {
                  if (
                    void 0 !== t &&
                    e.errorAction &&
                    (this.warn(`switching to level ${t} after ${e.details}`),
                    (this.hls.nextAutoLevel = t),
                    (e.errorAction.resolved = !0),
                    (this.hls.nextLoadLevel = this.hls.nextAutoLevel),
                    e.details === wu.BUFFER_ADD_CODEC_ERROR &&
                      e.mimeType &&
                      "audiovideo" !== e.sourceBufferName)
                  )
                    for (var r = Qd(e.mimeType), i = this.hls.levels, n = i.length; n--; )
                      i[n][`${e.sourceBufferName}Codec`] === r &&
                        (this.log(`Removing level ${n} for ${e.details} ("${r}" not supported)`),
                        this.hls.removeLevel(n));
                }
              },
              fpsController: class {
                constructor(e) {
                  ((this.hls = void 0),
                    (this.isVideoPlaybackQualityAvailable = !1),
                    (this.timer = void 0),
                    (this.media = null),
                    (this.lastTime = void 0),
                    (this.lastDroppedFrames = 0),
                    (this.lastDecodedFrames = 0),
                    (this.streamController = void 0),
                    (this.hls = e),
                    this.registerListeners());
                }
                setStreamController(e) {
                  this.streamController = e;
                }
                registerListeners() {
                  (this.hls.on(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                    this.hls.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this));
                }
                unregisterListeners() {
                  (this.hls.off(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                    this.hls.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this));
                }
                destroy() {
                  (this.timer && clearInterval(this.timer),
                    this.unregisterListeners(),
                    (this.isVideoPlaybackQualityAvailable = !1),
                    (this.media = null));
                }
                onMediaAttaching(e, t) {
                  var r = this.hls.config;
                  if (r.capLevelOnFPSDrop) {
                    var i = t.media instanceof self.HTMLVideoElement ? t.media : null;
                    ((this.media = i),
                      i &&
                        "function" == typeof i.getVideoPlaybackQuality &&
                        (this.isVideoPlaybackQualityAvailable = !0),
                      self.clearInterval(this.timer),
                      (this.timer = self.setInterval(
                        this.checkFPSInterval.bind(this),
                        r.fpsDroppedMonitoringPeriod,
                      )));
                  }
                }
                onMediaDetaching() {
                  this.media = null;
                }
                checkFPS(e, t, r) {
                  var i = performance.now();
                  if (t) {
                    if (this.lastTime) {
                      var n = i - this.lastTime,
                        a = r - this.lastDroppedFrames,
                        s = t - this.lastDecodedFrames,
                        o = (1e3 * a) / n,
                        l = this.hls;
                      if (
                        (l.trigger(Au.FPS_DROP, {
                          currentDropped: a,
                          currentDecoded: s,
                          totalDroppedFrames: r,
                        }),
                        o > 0 && a > l.config.fpsDroppedMonitoringThreshold * s)
                      ) {
                        var u = l.currentLevel;
                        (l.logger.warn(
                          "drop FPS ratio greater than max allowed value for currentLevel: " + u,
                        ),
                          u > 0 &&
                            (-1 === l.autoLevelCapping || l.autoLevelCapping >= u) &&
                            ((u -= 1),
                            l.trigger(Au.FPS_DROP_LEVEL_CAPPING, { level: u, droppedLevel: l.currentLevel }),
                            (l.autoLevelCapping = u),
                            this.streamController.nextLevelSwitch()));
                      }
                    }
                    ((this.lastTime = i), (this.lastDroppedFrames = r), (this.lastDecodedFrames = t));
                  }
                }
                checkFPSInterval() {
                  var e = this.media;
                  if (e)
                    if (this.isVideoPlaybackQualityAvailable) {
                      var t = e.getVideoPlaybackQuality();
                      this.checkFPS(e, t.totalVideoFrames, t.droppedVideoFrames);
                    } else this.checkFPS(e, e.webkitDecodedFrameCount, e.webkitDroppedFrameCount);
                }
              },
              stretchShortVideoTrack: !1,
              maxAudioFramesDrift: 1,
              forceKeyFrameOnDiscontinuity: !0,
              abrEwmaFastLive: 3,
              abrEwmaSlowLive: 9,
              abrEwmaFastVoD: 3,
              abrEwmaSlowVoD: 9,
              abrEwmaDefaultEstimate: 5e5,
              abrEwmaDefaultEstimateMax: 5e6,
              abrBandWidthFactor: 0.95,
              abrBandWidthUpFactor: 0.7,
              abrMaxWithRealBitrate: !1,
              maxStarvationDelay: 4,
              maxLoadingDelay: 4,
              minAutoBitrate: 0,
              emeEnabled: !1,
              widevineLicenseUrl: void 0,
              drmSystems: {},
              drmSystemOptions: {},
              requestMediaKeySystemAccessFunc: Hc,
              requireKeySystemAccessOnStart: !1,
              testBandwidth: !0,
              progressive: !1,
              lowLatencyMode: !0,
              cmcd: void 0,
              enableDateRangeMetadataCues: !0,
              enableEmsgMetadataCues: !0,
              enableEmsgKLVMetadata: !1,
              enableID3MetadataCues: !0,
              enableInterstitialPlayback: !0,
              interstitialAppendInPlace: !0,
              interstitialLiveLookAhead: 10,
              useMediaCapabilities: !0,
              preserveManualLevelOnError: !1,
              certLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 8e3,
                  maxLoadTimeMs: 2e4,
                  timeoutRetry: null,
                  errorRetry: null,
                },
              },
              keyLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 8e3,
                  maxLoadTimeMs: 2e4,
                  timeoutRetry: {
                    maxNumRetry: 1,
                    retryDelayMs: 1e3,
                    maxRetryDelayMs: 2e4,
                    backoff: "linear",
                  },
                  errorRetry: { maxNumRetry: 8, retryDelayMs: 1e3, maxRetryDelayMs: 2e4, backoff: "linear" },
                },
              },
              manifestLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 1 / 0,
                  maxLoadTimeMs: 2e4,
                  timeoutRetry: { maxNumRetry: 2, retryDelayMs: 0, maxRetryDelayMs: 0 },
                  errorRetry: { maxNumRetry: 1, retryDelayMs: 1e3, maxRetryDelayMs: 8e3 },
                },
              },
              playlistLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 1e4,
                  maxLoadTimeMs: 2e4,
                  timeoutRetry: { maxNumRetry: 2, retryDelayMs: 0, maxRetryDelayMs: 0 },
                  errorRetry: { maxNumRetry: 2, retryDelayMs: 1e3, maxRetryDelayMs: 8e3 },
                },
              },
              fragLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 1e4,
                  maxLoadTimeMs: 12e4,
                  timeoutRetry: { maxNumRetry: 4, retryDelayMs: 0, maxRetryDelayMs: 0 },
                  errorRetry: { maxNumRetry: 6, retryDelayMs: 1e3, maxRetryDelayMs: 8e3 },
                },
              },
              steeringManifestLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 1e4,
                  maxLoadTimeMs: 2e4,
                  timeoutRetry: { maxNumRetry: 2, retryDelayMs: 0, maxRetryDelayMs: 0 },
                  errorRetry: { maxNumRetry: 1, retryDelayMs: 1e3, maxRetryDelayMs: 8e3 },
                },
              },
              interstitialAssetListLoadPolicy: {
                default: {
                  maxTimeToFirstByteMs: 1e4,
                  maxLoadTimeMs: 3e4,
                  timeoutRetry: { maxNumRetry: 0, retryDelayMs: 0, maxRetryDelayMs: 0 },
                  errorRetry: { maxNumRetry: 0, retryDelayMs: 1e3, maxRetryDelayMs: 8e3 },
                },
              },
              manifestLoadingTimeOut: 1e4,
              manifestLoadingMaxRetry: 1,
              manifestLoadingRetryDelay: 1e3,
              manifestLoadingMaxRetryTimeout: 64e3,
              levelLoadingTimeOut: 1e4,
              levelLoadingMaxRetry: 4,
              levelLoadingRetryDelay: 1e3,
              levelLoadingMaxRetryTimeout: 64e3,
              fragLoadingTimeOut: 2e4,
              fragLoadingMaxRetry: 6,
              fragLoadingRetryDelay: 1e3,
              fragLoadingMaxRetryTimeout: 64e3,
            },
            {
              cueHandler: Yv,
              enableWebVTT: !0,
              enableIMSC1: !0,
              enableCEA708Captions: !0,
              captionsTextTrack1Label: "English",
              captionsTextTrack1LanguageCode: "en",
              captionsTextTrack2Label: "Spanish",
              captionsTextTrack2LanguageCode: "es",
              captionsTextTrack3Label: "Unknown CC",
              captionsTextTrack3LanguageCode: "",
              captionsTextTrack4Label: "Unknown CC",
              captionsTextTrack4LanguageCode: "",
              renderTextTracksNatively: !0,
            },
          ),
          {},
          {
            subtitleStreamController: class extends Wf {
              constructor(e, t, r) {
                (super(e, t, r, "subtitle-stream-controller", Du),
                  (this.currentTrackId = -1),
                  (this.tracksBuffered = []),
                  (this.mainDetails = null),
                  this.registerListeners());
              }
              onHandlerDestroying() {
                (this.unregisterListeners(), super.onHandlerDestroying(), (this.mainDetails = null));
              }
              registerListeners() {
                super.registerListeners();
                var e = this.hls;
                (e.on(Au.LEVEL_LOADED, this.onLevelLoaded, this),
                  e.on(Au.SUBTITLE_TRACKS_UPDATED, this.onSubtitleTracksUpdated, this),
                  e.on(Au.SUBTITLE_TRACK_SWITCH, this.onSubtitleTrackSwitch, this),
                  e.on(Au.SUBTITLE_TRACK_LOADED, this.onSubtitleTrackLoaded, this),
                  e.on(Au.SUBTITLE_FRAG_PROCESSED, this.onSubtitleFragProcessed, this),
                  e.on(Au.BUFFER_FLUSHING, this.onBufferFlushing, this));
              }
              unregisterListeners() {
                super.unregisterListeners();
                var e = this.hls;
                (e.off(Au.LEVEL_LOADED, this.onLevelLoaded, this),
                  e.off(Au.SUBTITLE_TRACKS_UPDATED, this.onSubtitleTracksUpdated, this),
                  e.off(Au.SUBTITLE_TRACK_SWITCH, this.onSubtitleTrackSwitch, this),
                  e.off(Au.SUBTITLE_TRACK_LOADED, this.onSubtitleTrackLoaded, this),
                  e.off(Au.SUBTITLE_FRAG_PROCESSED, this.onSubtitleFragProcessed, this),
                  e.off(Au.BUFFER_FLUSHING, this.onBufferFlushing, this));
              }
              startLoad(e, t) {
                (this.stopLoad(),
                  (this.state = Of),
                  this.setInterval(500),
                  (this.nextLoadPosition = this.lastCurrentTime = e + this.timelineOffset),
                  (this.startPosition = t ? -1 : e),
                  this.tick());
              }
              onManifestLoading() {
                (super.onManifestLoading(), (this.mainDetails = null));
              }
              onMediaDetaching(e, t) {
                ((this.tracksBuffered = []), super.onMediaDetaching(e, t));
              }
              onLevelLoaded(e, t) {
                this.mainDetails = t.details;
              }
              onSubtitleFragProcessed(e, t) {
                var r = t.frag,
                  i = t.success;
                if (
                  (this.fragContextChanged(r) || (sd(r) && (this.fragPrevious = r), (this.state = Of)), i)
                ) {
                  var n = this.tracksBuffered[this.currentTrackId];
                  if (n) {
                    for (var a, s = r.start, o = 0; o < n.length; o++)
                      if (s >= n[o].start && s <= n[o].end) {
                        a = n[o];
                        break;
                      }
                    var l = r.start + r.duration;
                    (a ? (a.end = l) : ((a = { start: s, end: l }), n.push(a)),
                      this.fragmentTracker.fragBuffered(r),
                      this.fragBufferedComplete(r, null),
                      this.media && this.tick());
                  }
                }
              }
              onBufferFlushing(e, t) {
                var r = t.startOffset,
                  i = t.endOffset;
                if (0 === r && i !== Number.POSITIVE_INFINITY) {
                  var n = i - 1;
                  if (n <= 0) return;
                  ((t.endOffsetSubtitles = Math.max(0, n)),
                    this.tracksBuffered.forEach(e => {
                      for (var t = 0; t < e.length; )
                        if (e[t].end <= n) e.shift();
                        else {
                          if (!(e[t].start < n)) break;
                          ((e[t].start = n), t++);
                        }
                    }),
                    this.fragmentTracker.removeFragmentsInRange(r, n, Du));
                }
              }
              onError(e, t) {
                var r = t.frag;
                (null == r ? void 0 : r.type) === Du &&
                  (t.details === wu.FRAG_GAP && this.fragmentTracker.fragBuffered(r, !0),
                  this.fragCurrent && this.fragCurrent.abortRequests(),
                  this.state !== Pf && (this.state = Of));
              }
              onSubtitleTracksUpdated(e, { subtitleTracks: t }) {
                this.levels && Ag(this.levels, t)
                  ? (this.levels = t.map(e => new hh(e)))
                  : ((this.tracksBuffered = []),
                    (this.levels = t.map(e => {
                      var t = new hh(e);
                      return ((this.tracksBuffered[t.id] = []), t);
                    })),
                    this.fragmentTracker.removeFragmentsInRange(0, Number.POSITIVE_INFINITY, Du),
                    (this.fragPrevious = null),
                    (this.mediaBuffer = null));
              }
              onSubtitleTrackSwitch(e, t) {
                var r;
                if (
                  ((this.currentTrackId = t.id),
                  null != (r = this.levels) && r.length && -1 !== this.currentTrackId)
                ) {
                  var i = this.levels[this.currentTrackId];
                  (null != i && i.details
                    ? (this.mediaBuffer = this.mediaBufferTimeRanges)
                    : (this.mediaBuffer = null),
                    i && this.state !== Pf && this.setInterval(500));
                } else this.clearInterval();
              }
              onSubtitleTrackLoaded(e, t) {
                var r,
                  i = this.currentTrackId,
                  n = this.levels,
                  a = t.details,
                  s = t.id;
                if (n) {
                  var o = n[s];
                  if (!(s >= n.length) && o) {
                    (this.log(
                      `Subtitle track ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn ? `[part-${a.lastPartSn}-${a.lastPartIndex}]` : ""},duration:${a.totalduration}`,
                    ),
                      (this.mediaBuffer = this.mediaBufferTimeRanges));
                    var l = 0;
                    if (a.live || (null != (r = o.details) && r.live)) {
                      if (a.deltaUpdateFailed) return;
                      var u = this.mainDetails;
                      if (!u) return void (this.startFragRequested = !1);
                      var d,
                        h = u.fragments[0];
                      if (o.details)
                        0 ===
                          (l = this.alignPlaylists(
                            a,
                            o.details,
                            null == (d = this.levelLastLoaded) ? void 0 : d.details,
                          )) &&
                          h &&
                          yf(a, (l = h.start));
                      else
                        a.hasProgramDateTime && u.hasProgramDateTime
                          ? (Lf(a, u), (l = a.fragmentStart))
                          : h && yf(a, (l = h.start));
                      u && !this.startFragRequested && this.setStartPosition(u, l);
                    }
                    if (((o.details = a), (this.levelLastLoaded = o), s === i))
                      if (
                        (this.hls.trigger(Au.SUBTITLE_TRACK_UPDATED, {
                          details: a,
                          id: s,
                          groupId: t.groupId,
                        }),
                        this.tick(),
                        a.live && !this.fragCurrent && this.media && this.state === Of)
                      )
                        wh(null, a.fragments, this.media.currentTime, 0) ||
                          (this.warn("Subtitle playlist not aligned with playback"), (o.details = void 0));
                  }
                } else this.warn(`Subtitle tracks were reset while loading level ${s}`);
              }
              _handleFragmentLoadComplete(e) {
                var t = e.frag,
                  r = e.payload,
                  i = t.decryptdata,
                  n = this.hls;
                if (
                  !this.fragContextChanged(t) &&
                  r &&
                  r.byteLength > 0 &&
                  null != i &&
                  i.key &&
                  i.iv &&
                  Rc(i.method)
                ) {
                  var a = performance.now();
                  this.decrypter
                    .decrypt(new Uint8Array(r), i.key.buffer, i.iv.buffer, Cc(i.method))
                    .catch(e => {
                      throw (
                        n.trigger(Au.ERROR, {
                          type: xu.MEDIA_ERROR,
                          details: wu.FRAG_DECRYPT_ERROR,
                          fatal: !1,
                          error: e,
                          reason: e.message,
                          frag: t,
                        }),
                        e
                      );
                    })
                    .then(e => {
                      var r = performance.now();
                      n.trigger(Au.FRAG_DECRYPTED, {
                        frag: t,
                        payload: e,
                        stats: { tstart: a, tdecrypt: r },
                      });
                    })
                    .catch(e => {
                      (this.warn(`${e.name}: ${e.message}`), (this.state = Of));
                    });
                }
              }
              doTick() {
                if (this.media) {
                  if (this.state === Of) {
                    var e = this.currentTrackId,
                      t = this.levels,
                      r = null == t ? void 0 : t[e];
                    if (!r || !t.length || !r.details) return;
                    if (this.waitForLive(r)) return;
                    var i = this.config,
                      n = this.getLoadPosition(),
                      a = fc.bufferedInfo(this.tracksBuffered[this.currentTrackId] || [], n, i.maxBufferHole),
                      s = a.end,
                      o = a.len,
                      l = r.details;
                    if (o > this.hls.maxBufferLength + l.levelTargetDuration) return;
                    var u = l.fragments,
                      d = u.length,
                      h = l.edge,
                      c = null,
                      f = this.fragPrevious;
                    if (s < h) {
                      var p = i.maxFragLookUpTolerance,
                        g = s > h - p ? 0 : p;
                      !(c = wh(f, u, Math.max(u[0].start, s), g)) && f && f.start < u[0].start && (c = u[0]);
                    } else c = u[d - 1];
                    if (!(c = this.filterReplacedPrimary(c, r.details))) return;
                    var m = u[c.sn - l.startSN - 1];
                    if (
                      (m && m.cc === c.cc && this.fragmentTracker.getState(m) === Kh && (c = m),
                      this.fragmentTracker.getState(c) === Kh)
                    ) {
                      var v = this.mapToInitFragWhenRequired(c);
                      v && this.loadFragment(v, r, s);
                    }
                  }
                } else this.state = Of;
              }
              loadFragment(e, t, r) {
                sd(e) ? super.loadFragment(e, t, r) : this._loadInitSegment(e, t);
              }
              get mediaBufferTimeRanges() {
                return new tv(this.tracksBuffered[this.currentTrackId] || []);
              }
            },
            subtitleTrackController: class extends wg {
              constructor(e) {
                (super(e, "subtitle-track-controller"),
                  (this.media = null),
                  (this.tracks = []),
                  (this.groupIds = null),
                  (this.tracksInGroup = []),
                  (this.trackId = -1),
                  (this.currentTrack = null),
                  (this.selectDefaultTrack = !0),
                  (this.queuedDefaultTrack = -1),
                  (this.useTextTrackPolling = !1),
                  (this.subtitlePollingInterval = -1),
                  (this._subtitleDisplay = !0),
                  (this.asyncPollTrackChange = () => this.pollTrackChange(0)),
                  (this.onTextTracksChanged = () => {
                    if (
                      (this.useTextTrackPolling || self.clearInterval(this.subtitlePollingInterval),
                      this.media && this.hls.config.renderTextTracksNatively)
                    ) {
                      for (var e = null, t = Bm(this.media.textTracks), r = 0; r < t.length; r++)
                        if ("hidden" === t[r].mode) e = t[r];
                        else if ("showing" === t[r].mode) {
                          e = t[r];
                          break;
                        }
                      var i = this.findTrackForTextTrack(e);
                      this.subtitleTrack !== i && this.setSubtitleTrack(i);
                    }
                  }),
                  this.registerListeners());
              }
              destroy() {
                (this.unregisterListeners(),
                  (this.tracks.length = 0),
                  (this.tracksInGroup.length = 0),
                  (this.currentTrack = null),
                  (this.onTextTracksChanged = this.asyncPollTrackChange = null),
                  super.destroy());
              }
              get subtitleDisplay() {
                return this._subtitleDisplay;
              }
              set subtitleDisplay(e) {
                ((this._subtitleDisplay = e), this.trackId > -1 && this.toggleTrackModes());
              }
              registerListeners() {
                var e = this.hls;
                (e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
                  e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                  e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.on(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                  e.on(Au.LEVEL_LOADING, this.onLevelLoading, this),
                  e.on(Au.LEVEL_SWITCHING, this.onLevelSwitching, this),
                  e.on(Au.SUBTITLE_TRACK_LOADED, this.onSubtitleTrackLoaded, this),
                  e.on(Au.ERROR, this.onError, this));
              }
              unregisterListeners() {
                var e = this.hls;
                (e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
                  e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                  e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.off(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                  e.off(Au.LEVEL_LOADING, this.onLevelLoading, this),
                  e.off(Au.LEVEL_SWITCHING, this.onLevelSwitching, this),
                  e.off(Au.SUBTITLE_TRACK_LOADED, this.onSubtitleTrackLoaded, this),
                  e.off(Au.ERROR, this.onError, this));
              }
              onMediaAttached(e, t) {
                ((this.media = t.media),
                  this.media &&
                    (this.queuedDefaultTrack > -1 &&
                      ((this.subtitleTrack = this.queuedDefaultTrack), (this.queuedDefaultTrack = -1)),
                    (this.useTextTrackPolling = !(
                      this.media.textTracks && "onchange" in this.media.textTracks
                    )),
                    this.useTextTrackPolling
                      ? this.pollTrackChange(500)
                      : this.media.textTracks.addEventListener("change", this.asyncPollTrackChange)));
              }
              pollTrackChange(e) {
                (self.clearInterval(this.subtitlePollingInterval),
                  (this.subtitlePollingInterval = self.setInterval(this.onTextTracksChanged, e)));
              }
              onMediaDetaching(e, t) {
                var r = this.media;
                if (r) {
                  var i = !!t.transferMedia;
                  if (
                    (self.clearInterval(this.subtitlePollingInterval),
                    this.useTextTrackPolling ||
                      r.textTracks.removeEventListener("change", this.asyncPollTrackChange),
                    this.trackId > -1 && (this.queuedDefaultTrack = this.trackId),
                    (this.subtitleTrack = -1),
                    (this.media = null),
                    !i)
                  )
                    Bm(r.textTracks).forEach(e => {
                      Fm(e);
                    });
                }
              }
              onManifestLoading() {
                ((this.tracks = []),
                  (this.groupIds = null),
                  (this.tracksInGroup = []),
                  (this.trackId = -1),
                  (this.currentTrack = null),
                  (this.selectDefaultTrack = !0));
              }
              onManifestParsed(e, t) {
                this.tracks = t.subtitleTracks;
              }
              onSubtitleTrackLoaded(e, t) {
                var r = t.id,
                  i = t.groupId,
                  n = t.details,
                  a = this.tracksInGroup[r];
                if (a && a.groupId === i) {
                  var s = a.details;
                  ((a.details = t.details),
                    this.log(
                      `Subtitle track ${r} "${a.name}" lang:${a.lang} group:${i} loaded [${n.startSN}-${n.endSN}]`,
                    ),
                    r === this.trackId && this.playlistLoaded(r, t, s));
                } else
                  this.warn(
                    `Subtitle track with id:${r} and group:${i} not found in active group ${null == a ? void 0 : a.groupId}`,
                  );
              }
              onLevelLoading(e, t) {
                this.switchLevel(t.level);
              }
              onLevelSwitching(e, t) {
                this.switchLevel(t.level);
              }
              switchLevel(e) {
                var t = this.hls.levels[e];
                if (t) {
                  var r = t.subtitleGroups || null,
                    i = this.groupIds,
                    n = this.currentTrack;
                  if (
                    !r ||
                    (null == i ? void 0 : i.length) !== (null == r ? void 0 : r.length) ||
                    (null != r && r.some(e => -1 === (null == i ? void 0 : i.indexOf(e))))
                  ) {
                    ((this.groupIds = r), (this.trackId = -1), (this.currentTrack = null));
                    var a = this.tracks.filter(e => !r || -1 !== r.indexOf(e.groupId));
                    if (a.length)
                      (this.selectDefaultTrack && !a.some(e => e.default) && (this.selectDefaultTrack = !1),
                        a.forEach((e, t) => {
                          e.id = t;
                        }));
                    else if (!n && !this.tracksInGroup.length) return;
                    this.tracksInGroup = a;
                    var s = this.hls.config.subtitlePreference;
                    if (!n && s) {
                      this.selectDefaultTrack = !1;
                      var o = yh(s, a);
                      if (o > -1) n = a[o];
                      else {
                        var l = yh(s, this.tracks);
                        n = this.tracks[l];
                      }
                    }
                    var u = this.findTrackId(n);
                    -1 === u && n && (u = this.findTrackId(null));
                    var d = { subtitleTracks: a };
                    (this.log(
                      `Updating subtitle tracks, ${a.length} track(s) found in "${null == r ? void 0 : r.join(",")}" group-id`,
                    ),
                      this.hls.trigger(Au.SUBTITLE_TRACKS_UPDATED, d),
                      -1 !== u && -1 === this.trackId && this.setSubtitleTrack(u));
                  }
                }
              }
              findTrackId(e) {
                for (var t = this.tracksInGroup, r = this.selectDefaultTrack, i = 0; i < t.length; i++) {
                  var n = t[i];
                  if ((!r || n.default) && (r || e) && (!e || Th(n, e))) return i;
                }
                if (e) {
                  for (var a = 0; a < t.length; a++) {
                    var s = t[a];
                    if (Ig(e.attrs, s.attrs, ["LANGUAGE", "ASSOC-LANGUAGE", "CHARACTERISTICS"])) return a;
                  }
                  for (var o = 0; o < t.length; o++) {
                    var l = t[o];
                    if (Ig(e.attrs, l.attrs, ["LANGUAGE"])) return o;
                  }
                }
                return -1;
              }
              findTrackForTextTrack(e) {
                if (e)
                  for (var t = this.tracksInGroup, r = 0; r < t.length; r++) {
                    if (kg(t[r], e)) return r;
                  }
                return -1;
              }
              onError(e, t) {
                !t.fatal &&
                  t.context &&
                  (t.context.type !== Cu ||
                    t.context.id !== this.trackId ||
                    (this.groupIds && -1 === this.groupIds.indexOf(t.context.groupId)) ||
                    this.checkRetry(t));
              }
              get allSubtitleTracks() {
                return this.tracks;
              }
              get subtitleTracks() {
                return this.tracksInGroup;
              }
              get subtitleTrack() {
                return this.trackId;
              }
              set subtitleTrack(e) {
                ((this.selectDefaultTrack = !1), this.setSubtitleTrack(e));
              }
              setSubtitleOption(e) {
                if (((this.hls.config.subtitlePreference = e), e)) {
                  if (-1 === e.id) return (this.setSubtitleTrack(-1), null);
                  var t = this.allSubtitleTracks;
                  if (((this.selectDefaultTrack = !1), t.length)) {
                    var r = this.currentTrack;
                    if (r && Th(e, r)) return r;
                    var i = yh(e, this.tracksInGroup);
                    if (i > -1) {
                      var n = this.tracksInGroup[i];
                      return (this.setSubtitleTrack(i), n);
                    }
                    if (r) return null;
                    var a = yh(e, t);
                    if (a > -1) return t[a];
                  }
                }
                return null;
              }
              loadPlaylist(e) {
                (super.loadPlaylist(),
                  this.shouldLoadPlaylist(this.currentTrack) && this.scheduleLoading(this.currentTrack, e));
              }
              loadingPlaylist(e, t) {
                super.loadingPlaylist(e, t);
                var r = e.id,
                  i = e.groupId,
                  n = this.getUrlWithDirectives(e.url, t),
                  a = e.details,
                  s = null == a ? void 0 : a.age;
                (this.log(
                  `Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${i}${void 0 !== (null == t ? void 0 : t.msn) ? " at sn " + t.msn + " part " + t.part : ""}${s && a.live ? " age " + s.toFixed(1) + ((a.type && " " + a.type) || "") : ""} ${n}`,
                ),
                  this.hls.trigger(Au.SUBTITLE_TRACK_LOADING, {
                    url: n,
                    id: r,
                    groupId: i,
                    deliveryDirectives: t || null,
                    track: e,
                  }));
              }
              toggleTrackModes() {
                var e = this.media;
                if (e) {
                  var t,
                    r = Bm(e.textTracks),
                    i = this.currentTrack;
                  if (
                    (i &&
                      ((t = r.filter(e => kg(i, e))[0]) ||
                        this.warn(
                          `Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`,
                        )),
                    [].slice.call(r).forEach(e => {
                      "disabled" !== e.mode && e !== t && (e.mode = "disabled");
                    }),
                    t)
                  ) {
                    var n = this.subtitleDisplay ? "showing" : "hidden";
                    t.mode !== n && (t.mode = n);
                  }
                }
              }
              setSubtitleTrack(e) {
                var t = this.tracksInGroup;
                if (this.media)
                  if (e < -1 || e >= t.length || !bu(e)) this.warn(`Invalid subtitle track id: ${e}`);
                  else {
                    this.selectDefaultTrack = !1;
                    var r = this.currentTrack,
                      i = t[e] || null;
                    if (((this.trackId = e), (this.currentTrack = i), this.toggleTrackModes(), i)) {
                      var n = !!i.details && !i.details.live;
                      if (e !== this.trackId || i !== r || !n) {
                        this.log(
                          `Switching to subtitle-track ${e}` +
                            (i ? ` "${i.name}" lang:${i.lang} group:${i.groupId}` : ""),
                        );
                        var a = i.id,
                          s = i.groupId,
                          o = void 0 === s ? "" : s,
                          l = i.name,
                          u = i.type,
                          d = i.url;
                        this.hls.trigger(Au.SUBTITLE_TRACK_SWITCH, {
                          id: a,
                          groupId: o,
                          name: l,
                          type: u,
                          url: d,
                        });
                        var h = this.switchParams(i.url, null == r ? void 0 : r.details, i.details);
                        this.loadPlaylist(h);
                      }
                    } else this.hls.trigger(Au.SUBTITLE_TRACK_SWITCH, { id: e });
                  }
                else this.queuedDefaultTrack = e;
              }
            },
            timelineController: class {
              constructor(e) {
                ((this.hls = void 0),
                  (this.media = null),
                  (this.config = void 0),
                  (this.enabled = !0),
                  (this.Cues = void 0),
                  (this.textTracks = []),
                  (this.tracks = []),
                  (this.initPTS = []),
                  (this.unparsedVttFrags = []),
                  (this.captionsTracks = {}),
                  (this.nonNativeCaptionsTracks = {}),
                  (this.cea608Parser1 = void 0),
                  (this.cea608Parser2 = void 0),
                  (this.lastCc = -1),
                  (this.lastSn = -1),
                  (this.lastPartIndex = -1),
                  (this.prevCC = -1),
                  (this.vttCCs = {
                    ccOffset: 0,
                    presentationOffset: 0,
                    0: { start: 0, prevCC: -1, new: !0 },
                  }),
                  (this.captionsProperties = void 0),
                  (this.hls = e),
                  (this.config = e.config),
                  (this.Cues = e.config.cueHandler),
                  (this.captionsProperties = {
                    textTrack1: {
                      label: this.config.captionsTextTrack1Label,
                      languageCode: this.config.captionsTextTrack1LanguageCode,
                    },
                    textTrack2: {
                      label: this.config.captionsTextTrack2Label,
                      languageCode: this.config.captionsTextTrack2LanguageCode,
                    },
                    textTrack3: {
                      label: this.config.captionsTextTrack3Label,
                      languageCode: this.config.captionsTextTrack3LanguageCode,
                    },
                    textTrack4: {
                      label: this.config.captionsTextTrack4Label,
                      languageCode: this.config.captionsTextTrack4LanguageCode,
                    },
                  }),
                  e.on(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                  e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                  e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.on(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
                  e.on(Au.SUBTITLE_TRACKS_UPDATED, this.onSubtitleTracksUpdated, this),
                  e.on(Au.FRAG_LOADING, this.onFragLoading, this),
                  e.on(Au.FRAG_LOADED, this.onFragLoaded, this),
                  e.on(Au.FRAG_PARSING_USERDATA, this.onFragParsingUserdata, this),
                  e.on(Au.FRAG_DECRYPTED, this.onFragDecrypted, this),
                  e.on(Au.INIT_PTS_FOUND, this.onInitPtsFound, this),
                  e.on(Au.SUBTITLE_TRACKS_CLEARED, this.onSubtitleTracksCleared, this),
                  e.on(Au.BUFFER_FLUSHING, this.onBufferFlushing, this));
              }
              destroy() {
                var e = this.hls;
                (e.off(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                  e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                  e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.off(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
                  e.off(Au.SUBTITLE_TRACKS_UPDATED, this.onSubtitleTracksUpdated, this),
                  e.off(Au.FRAG_LOADING, this.onFragLoading, this),
                  e.off(Au.FRAG_LOADED, this.onFragLoaded, this),
                  e.off(Au.FRAG_PARSING_USERDATA, this.onFragParsingUserdata, this),
                  e.off(Au.FRAG_DECRYPTED, this.onFragDecrypted, this),
                  e.off(Au.INIT_PTS_FOUND, this.onInitPtsFound, this),
                  e.off(Au.SUBTITLE_TRACKS_CLEARED, this.onSubtitleTracksCleared, this),
                  e.off(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
                  (this.hls = this.config = this.media = null),
                  (this.cea608Parser1 = this.cea608Parser2 = void 0));
              }
              initCea608Parsers() {
                var e = new Kv(this, "textTrack1"),
                  t = new Kv(this, "textTrack2"),
                  r = new Kv(this, "textTrack3"),
                  i = new Kv(this, "textTrack4");
                ((this.cea608Parser1 = new yv(1, e, t)), (this.cea608Parser2 = new yv(3, r, i)));
              }
              addCues(e, t, r, i, n) {
                for (var a = !1, s = n.length; s--; ) {
                  var o = n[s],
                    l = qv(o[0], o[1], t, r);
                  if (
                    l >= 0 &&
                    ((o[0] = Math.min(o[0], t)), (o[1] = Math.max(o[1], r)), (a = !0), l / (r - t) > 0.5)
                  )
                    return;
                }
                if ((a || n.push([t, r]), this.config.renderTextTracksNatively)) {
                  var u = this.captionsTracks[e];
                  this.Cues.newCue(u, t, r, i);
                } else {
                  var d = this.Cues.newCue(null, t, r, i);
                  this.hls.trigger(Au.CUES_PARSED, { type: "captions", cues: d, track: e });
                }
              }
              onInitPtsFound(e, { frag: t, id: r, initPTS: i, timescale: n, trackId: a }) {
                var s = this.unparsedVttFrags;
                (r === Lu && (this.initPTS[t.cc] = { baseTime: i, timescale: n, trackId: a }),
                  s.length &&
                    ((this.unparsedVttFrags = []),
                    s.forEach(e => {
                      this.initPTS[e.frag.cc]
                        ? this.onFragLoaded(Au.FRAG_LOADED, e)
                        : this.hls.trigger(Au.SUBTITLE_FRAG_PROCESSED, {
                            success: !1,
                            frag: e.frag,
                            error: new Error("Subtitle discontinuity domain does not match main"),
                          });
                    })));
              }
              getExistingTrack(e, t) {
                var r = this.media;
                if (r)
                  for (var i = 0; i < r.textTracks.length; i++) {
                    var n = r.textTracks[i];
                    if (
                      zv(n, {
                        name: e,
                        lang: t,
                        characteristics: "transcribes-spoken-dialog,describes-music-and-sound",
                      })
                    )
                      return n;
                  }
                return null;
              }
              createCaptionsTrack(e) {
                this.config.renderTextTracksNatively
                  ? this.createNativeTrack(e)
                  : this.createNonNativeTrack(e);
              }
              createNativeTrack(e) {
                if (!this.captionsTracks[e]) {
                  var t = this.captionsProperties,
                    r = this.captionsTracks,
                    i = this.media,
                    n = t[e],
                    a = n.label,
                    s = n.languageCode,
                    o = this.getExistingTrack(a, s);
                  if (o) ((r[e] = o), Fm(r[e]), Om(r[e], i));
                  else {
                    var l = this.createTextTrack("captions", a, s);
                    l && ((l[e] = !0), (r[e] = l));
                  }
                }
              }
              createNonNativeTrack(e) {
                if (!this.nonNativeCaptionsTracks[e]) {
                  var t = this.captionsProperties[e];
                  if (t) {
                    var r = {
                      _id: e,
                      label: t.label,
                      kind: "captions",
                      default: !!t.media && !!t.media.default,
                      closedCaptions: t.media,
                    };
                    ((this.nonNativeCaptionsTracks[e] = r),
                      this.hls.trigger(Au.NON_NATIVE_TEXT_TRACKS_FOUND, { tracks: [r] }));
                  }
                }
              }
              createTextTrack(e, t, r) {
                var i = this.media;
                if (i) return i.addTextTrack(e, t, r);
              }
              onMediaAttaching(e, t) {
                ((this.media = t.media), t.mediaSource || this._cleanTracks());
              }
              onMediaDetaching(e, t) {
                var r = !!t.transferMedia;
                if (((this.media = null), !r)) {
                  var i = this.captionsTracks;
                  (Object.keys(i).forEach(e => {
                    (Fm(i[e]), delete i[e]);
                  }),
                    (this.nonNativeCaptionsTracks = {}));
                }
              }
              onManifestLoading() {
                ((this.lastCc = -1),
                  (this.lastSn = -1),
                  (this.lastPartIndex = -1),
                  (this.prevCC = -1),
                  (this.vttCCs = {
                    ccOffset: 0,
                    presentationOffset: 0,
                    0: { start: 0, prevCC: -1, new: !0 },
                  }),
                  this._cleanTracks(),
                  (this.tracks = []),
                  (this.captionsTracks = {}),
                  (this.nonNativeCaptionsTracks = {}),
                  (this.textTracks = []),
                  (this.unparsedVttFrags = []),
                  (this.initPTS = []),
                  this.cea608Parser1 &&
                    this.cea608Parser2 &&
                    (this.cea608Parser1.reset(), this.cea608Parser2.reset()));
              }
              _cleanTracks() {
                var e = this.media;
                if (e) {
                  var t = e.textTracks;
                  if (t) for (var r = 0; r < t.length; r++) Fm(t[r]);
                }
              }
              onSubtitleTracksUpdated(e, t) {
                var r = t.subtitleTracks || [],
                  i = r.some(e => e.textCodec === Pv);
                if (this.config.enableWebVTT || (i && this.config.enableIMSC1)) {
                  if (Ag(this.tracks, r)) return void (this.tracks = r);
                  if (((this.textTracks = []), (this.tracks = r), this.config.renderTextTracksNatively)) {
                    var n = this.media,
                      a = n ? Bm(n.textTracks) : null;
                    if (
                      (this.tracks.forEach((e, t) => {
                        var r;
                        if (a) {
                          for (var i = null, n = 0; n < a.length; n++)
                            if (a[n] && zv(a[n], e)) {
                              ((i = a[n]), (a[n] = null));
                              break;
                            }
                          i && (r = i);
                        }
                        if (r) Fm(r);
                        else {
                          var s = Wv(e);
                          (r = this.createTextTrack(s, e.name, e.lang)) && (r.mode = "disabled");
                        }
                        r && this.textTracks.push(r);
                      }),
                      null != a && a.length)
                    ) {
                      var s = a.filter(e => null !== e).map(e => e.label);
                      s.length &&
                        this.hls.logger.warn(
                          `Media element contains unused subtitle tracks: ${s.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`,
                        );
                    }
                  } else if (this.tracks.length) {
                    var o = this.tracks.map(e => ({
                      label: e.name,
                      kind: e.type.toLowerCase(),
                      default: e.default,
                      subtitleTrack: e,
                    }));
                    this.hls.trigger(Au.NON_NATIVE_TEXT_TRACKS_FOUND, { tracks: o });
                  }
                }
              }
              onManifestLoaded(e, t) {
                this.config.enableCEA708Captions &&
                  t.captions &&
                  t.captions.forEach(e => {
                    var t = /(?:CC|SERVICE)([1-4])/.exec(e.instreamId);
                    if (t) {
                      var r = `textTrack${t[1]}`,
                        i = this.captionsProperties[r];
                      i && ((i.label = e.name), e.lang && (i.languageCode = e.lang), (i.media = e));
                    }
                  });
              }
              closedCaptionsForLevel(e) {
                var t = this.hls.levels[e.level];
                return null == t ? void 0 : t.attrs["CLOSED-CAPTIONS"];
              }
              onFragLoading(e, t) {
                if (this.enabled && t.frag.type === Lu) {
                  var r,
                    i,
                    n = this.cea608Parser1,
                    a = this.cea608Parser2,
                    s = this.lastSn,
                    o = t.frag,
                    l = o.cc,
                    u = o.sn,
                    d = null != (r = null == (i = t.part) ? void 0 : i.index) ? r : -1;
                  (n &&
                    a &&
                    (u !== s + 1 || (u === s && d !== this.lastPartIndex + 1) || l !== this.lastCc) &&
                    (n.reset(), a.reset()),
                    (this.lastCc = l),
                    (this.lastSn = u),
                    (this.lastPartIndex = d));
                }
              }
              onFragLoaded(e, t) {
                var r = t.frag,
                  i = t.payload;
                if (r.type === Du)
                  if (i.byteLength) {
                    var n = r.decryptdata,
                      a = "stats" in t;
                    if (null == n || !n.encrypted || a) {
                      var s = this.tracks[r.level],
                        o = this.vttCCs;
                      (o[r.cc] ||
                        ((o[r.cc] = { start: r.start, prevCC: this.prevCC, new: !0 }), (this.prevCC = r.cc)),
                        s && s.textCodec === Pv ? this._parseIMSC1(r, i) : this._parseVTTs(t));
                    }
                  } else
                    this.hls.trigger(Au.SUBTITLE_FRAG_PROCESSED, {
                      success: !1,
                      frag: r,
                      error: new Error("Empty subtitle payload"),
                    });
              }
              _parseIMSC1(e, t) {
                var r = this.hls;
                Uv(
                  t,
                  this.initPTS[e.cc],
                  t => {
                    (this._appendCues(t, e.level),
                      r.trigger(Au.SUBTITLE_FRAG_PROCESSED, { success: !0, frag: e }));
                  },
                  t => {
                    (r.logger.log(`Failed to parse IMSC1: ${t}`),
                      r.trigger(Au.SUBTITLE_FRAG_PROCESSED, { success: !1, frag: e, error: t }));
                  },
                );
              }
              _parseVTTs(e) {
                var t,
                  r = e.frag,
                  i = e.payload,
                  n = this.initPTS,
                  a = this.unparsedVttFrags,
                  s = n.length - 1;
                if (n[r.cc] || -1 !== s) {
                  var o = this.hls;
                  _v(
                    null != (t = r.initSegment) && t.data
                      ? Rd(r.initSegment.data, new Uint8Array(i)).buffer
                      : i,
                    this.initPTS[r.cc],
                    this.vttCCs,
                    r.cc,
                    r.start,
                    e => {
                      (this._appendCues(e, r.level),
                        o.trigger(Au.SUBTITLE_FRAG_PROCESSED, { success: !0, frag: r }));
                    },
                    t => {
                      var n = "Missing initPTS for VTT MPEGTS" === t.message;
                      (n ? a.push(e) : this._fallbackToIMSC1(r, i),
                        o.logger.log(`Failed to parse VTT cue: ${t}`),
                        (n && s > r.cc) ||
                          o.trigger(Au.SUBTITLE_FRAG_PROCESSED, { success: !1, frag: r, error: t }));
                    },
                  );
                } else a.push(e);
              }
              _fallbackToIMSC1(e, t) {
                var r = this.tracks[e.level];
                r.textCodec ||
                  Uv(
                    t,
                    this.initPTS[e.cc],
                    () => {
                      ((r.textCodec = Pv), this._parseIMSC1(e, t));
                    },
                    () => {
                      r.textCodec = "wvtt";
                    },
                  );
              }
              _appendCues(e, t) {
                var r = this.hls;
                if (this.config.renderTextTracksNatively) {
                  var i = this.textTracks[t];
                  if (!i || "disabled" === i.mode) return;
                  e.forEach(e => Nm(i, e));
                } else {
                  var n = this.tracks[t];
                  if (!n) return;
                  var a = n.default ? "default" : "subtitles" + t;
                  r.trigger(Au.CUES_PARSED, { type: "subtitles", cues: e, track: a });
                }
              }
              onFragDecrypted(e, t) {
                t.frag.type === Du && this.onFragLoaded(Au.FRAG_LOADED, t);
              }
              onSubtitleTracksCleared() {
                ((this.tracks = []), (this.captionsTracks = {}));
              }
              onFragParsingUserdata(e, t) {
                if (this.enabled && this.config.enableCEA708Captions) {
                  var r = t.frag,
                    i = t.samples;
                  if (r.type !== Lu || "NONE" !== this.closedCaptionsForLevel(r))
                    for (var n = 0; n < i.length; n++) {
                      var a = i[n].bytes;
                      if (a) {
                        this.cea608Parser1 || this.initCea608Parsers();
                        var s = this.extractCea608Data(a);
                        (this.cea608Parser1.addData(i[n].pts, s[0]),
                          this.cea608Parser2.addData(i[n].pts, s[1]));
                      }
                    }
                }
              }
              onBufferFlushing(e, { startOffset: t, endOffset: r, endOffsetSubtitles: i, type: n }) {
                var a = this.media;
                if (a && !(a.currentTime < r)) {
                  if (!n || "video" === n) {
                    var s = this.captionsTracks;
                    Object.keys(s).forEach(e => Um(s[e], t, r));
                  }
                  if (this.config.renderTextTracksNatively && 0 === t && void 0 !== i) {
                    var o = this.textTracks;
                    Object.keys(o).forEach(e => Um(o[e], t, i));
                  }
                }
              }
              extractCea608Data(e) {
                for (var t = [[], []], r = 31 & e[0], i = 2, n = 0; n < r; n++) {
                  var a = e[i++],
                    s = 127 & e[i++],
                    o = 127 & e[i++];
                  if (0 !== s || 0 !== o)
                    if (!!(4 & a)) {
                      var l = 3 & a;
                      (0 !== l && 1 !== l) || (t[l].push(s), t[l].push(o));
                    }
                }
                return t;
              }
            },
            audioStreamController: class extends Wf {
              constructor(e, t, r) {
                (super(e, t, r, "audio-stream-controller", Mu),
                  (this.mainAnchor = null),
                  (this.mainFragLoading = null),
                  (this.audioOnly = !1),
                  (this.bufferedTrack = null),
                  (this.switchingTrack = null),
                  (this.trackId = -1),
                  (this.waitingData = null),
                  (this.mainDetails = null),
                  (this.flushing = !1),
                  (this.bufferFlushed = !1),
                  (this.cachedTrackLoadedData = null),
                  this.registerListeners());
              }
              onHandlerDestroying() {
                (this.unregisterListeners(), super.onHandlerDestroying(), this.resetItem());
              }
              resetItem() {
                this.mainDetails =
                  this.mainAnchor =
                  this.mainFragLoading =
                  this.bufferedTrack =
                  this.switchingTrack =
                  this.waitingData =
                  this.cachedTrackLoadedData =
                    null;
              }
              registerListeners() {
                super.registerListeners();
                var e = this.hls;
                (e.on(Au.LEVEL_LOADED, this.onLevelLoaded, this),
                  e.on(Au.AUDIO_TRACKS_UPDATED, this.onAudioTracksUpdated, this),
                  e.on(Au.AUDIO_TRACK_SWITCHING, this.onAudioTrackSwitching, this),
                  e.on(Au.AUDIO_TRACK_LOADED, this.onAudioTrackLoaded, this),
                  e.on(Au.BUFFER_RESET, this.onBufferReset, this),
                  e.on(Au.BUFFER_CREATED, this.onBufferCreated, this),
                  e.on(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
                  e.on(Au.BUFFER_FLUSHED, this.onBufferFlushed, this),
                  e.on(Au.INIT_PTS_FOUND, this.onInitPtsFound, this),
                  e.on(Au.FRAG_LOADING, this.onFragLoading, this),
                  e.on(Au.FRAG_BUFFERED, this.onFragBuffered, this));
              }
              unregisterListeners() {
                var e = this.hls;
                e &&
                  (super.unregisterListeners(),
                  e.off(Au.LEVEL_LOADED, this.onLevelLoaded, this),
                  e.off(Au.AUDIO_TRACKS_UPDATED, this.onAudioTracksUpdated, this),
                  e.off(Au.AUDIO_TRACK_SWITCHING, this.onAudioTrackSwitching, this),
                  e.off(Au.AUDIO_TRACK_LOADED, this.onAudioTrackLoaded, this),
                  e.off(Au.BUFFER_RESET, this.onBufferReset, this),
                  e.off(Au.BUFFER_CREATED, this.onBufferCreated, this),
                  e.off(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
                  e.off(Au.BUFFER_FLUSHED, this.onBufferFlushed, this),
                  e.off(Au.INIT_PTS_FOUND, this.onInitPtsFound, this),
                  e.off(Au.FRAG_LOADING, this.onFragLoading, this),
                  e.off(Au.FRAG_BUFFERED, this.onFragBuffered, this));
              }
              onInitPtsFound(e, { frag: t, id: r, initPTS: i, timescale: n, trackId: a }) {
                if (r === Lu) {
                  var s = t.cc,
                    o = this.fragCurrent;
                  if (
                    ((this.initPTS[s] = { baseTime: i, timescale: n, trackId: a }),
                    this.log(`InitPTS for cc: ${s} found from main: ${i / n} (${i}/${n}) trackId: ${a}`),
                    (this.mainAnchor = t),
                    this.state === Hf)
                  ) {
                    var l = this.waitingData;
                    ((!l && !this.loadingParts) || (l && l.frag.cc !== s)) &&
                      this.syncWithAnchor(t, null == l ? void 0 : l.frag);
                  } else
                    !this.hls.hasEnoughToStart && o && o.cc !== s
                      ? (o.abortRequests(), this.syncWithAnchor(t, o))
                      : this.state === Of && this.tick();
                }
              }
              getLoadPosition() {
                return !this.startFragRequested && this.nextLoadPosition >= 0
                  ? this.nextLoadPosition
                  : super.getLoadPosition();
              }
              syncWithAnchor(e, t) {
                var r,
                  i = (null == (r = this.mainFragLoading) ? void 0 : r.frag) || null;
                if (!t || (null == i ? void 0 : i.cc) !== t.cc) {
                  var n = (i || e).cc,
                    a = kh(this.getLevelDetails(), n, this.getLoadPosition());
                  a &&
                    (this.log(`Syncing with main frag at ${a.start} cc ${a.cc}`),
                    (this.startFragRequested = !1),
                    (this.nextLoadPosition = a.start),
                    this.resetLoadingState(),
                    this.state === Of && this.doTickIdle());
                }
              }
              startLoad(e, t) {
                if (!this.levels) return ((this.startPosition = e), void (this.state = Pf));
                var r = this.lastCurrentTime;
                (this.stopLoad(),
                  this.setInterval(100),
                  r > 0 && -1 === e
                    ? (this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),
                      (e = r),
                      (this.state = Of))
                    : (this.state = Bf),
                  (this.nextLoadPosition = this.lastCurrentTime = e + this.timelineOffset),
                  (this.startPosition = t ? -1 : e),
                  this.tick());
              }
              doTick() {
                switch (this.state) {
                  case Of:
                    this.doTickIdle();
                    break;
                  case Bf:
                    var e = this.levels,
                      t = this.trackId,
                      r = null == e ? void 0 : e[t],
                      i = null == r ? void 0 : r.details;
                    if (i && !this.waitForLive(r)) {
                      if (this.waitForCdnTuneIn(i)) break;
                      this.state = Hf;
                    }
                    break;
                  case Uf:
                    this.checkRetryDate();
                    break;
                  case Hf:
                    var n = this.waitingData;
                    if (n) {
                      var a = n.frag,
                        s = n.part,
                        o = n.cache,
                        l = n.complete,
                        u = this.mainAnchor;
                      if (void 0 !== this.initPTS[a.cc]) {
                        ((this.waitingData = null), (this.state = Ff));
                        var d = { frag: a, part: s, payload: o.flush().buffer, networkDetails: null };
                        (this._handleFragmentLoadProgress(d), l && super._handleFragmentLoadComplete(d));
                      } else u && u.cc !== n.frag.cc && this.syncWithAnchor(u, n.frag);
                    } else this.state = Of;
                }
                this.onTickEnd();
              }
              resetLoadingState() {
                var e = this.waitingData;
                (e && (this.fragmentTracker.removeFragment(e.frag), (this.waitingData = null)),
                  super.resetLoadingState());
              }
              onTickEnd() {
                var e = this.media;
                null != e && e.readyState && (this.lastCurrentTime = e.currentTime);
              }
              doTickIdle() {
                var e,
                  t = this.hls,
                  r = this.levels,
                  i = this.media,
                  n = this.trackId,
                  a = t.config;
                if (
                  this.buffering &&
                  (i || this.primaryPrefetch || (!this.startFragRequested && a.startFragPrefetch)) &&
                  null != r &&
                  r[n]
                ) {
                  var s = r[n],
                    o = s.details;
                  if (!o || this.waitForLive(s) || this.waitForCdnTuneIn(o))
                    return ((this.state = Bf), void (this.startFragRequested = !1));
                  var l = this.mediaBuffer ? this.mediaBuffer : this.media;
                  this.bufferFlushed && l && ((this.bufferFlushed = !1), this.afterBufferFlushed(l, rd, Mu));
                  var u = this.getFwdBufferInfo(l, Mu);
                  if (null !== u) {
                    if (!this.switchingTrack && this._streamEnded(u, o))
                      return (t.trigger(Au.BUFFER_EOS, { type: "audio" }), void (this.state = Gf));
                    var d = u.len,
                      h = t.maxBufferLength,
                      c = o.fragments,
                      f = c[0].start,
                      p = this.getLoadPosition(),
                      g = this.flushing ? p : u.end;
                    if (this.switchingTrack && i) {
                      var m = p;
                      o.PTSKnown &&
                        m < f &&
                        (u.end > f || u.nextStart) &&
                        (this.log("Alt audio track ahead of main track, seek to start of alt audio track"),
                        (i.currentTime = f + 0.05));
                    }
                    if (!(d >= h && !this.switchingTrack && g < c[c.length - 1].start)) {
                      var v = this.getNextFragment(g, o);
                      if (
                        (v &&
                          this.isLoopLoading(v, g) &&
                          (v = this.getNextFragmentLoopLoading(v, o, u, Lu, h)),
                        v)
                      ) {
                        var y = (null == (e = this.mainFragLoading) ? void 0 : e.frag) || null;
                        if (
                          !this.audioOnly &&
                          this.startFragRequested &&
                          y &&
                          sd(v) &&
                          !v.endList &&
                          (!o.live || (!this.loadingParts && g < this.hls.liveSyncPosition)) &&
                          (this.fragmentTracker.getState(y) === qh && (this.mainFragLoading = y = null),
                          y && sd(y))
                        ) {
                          if (v.start > y.end) {
                            var T = this.fragmentTracker.getFragAtPos(g, Lu);
                            T &&
                              T.end > y.end &&
                              ((y = T), (this.mainFragLoading = { frag: T, targetBufferTime: null }));
                          }
                          if (v.start > y.end) return;
                        }
                        this.loadFragment(v, s, g);
                      } else this.bufferFlushed = !0;
                    }
                  }
                }
              }
              onMediaDetaching(e, t) {
                ((this.bufferFlushed = this.flushing = !1), super.onMediaDetaching(e, t));
              }
              onAudioTracksUpdated(e, { audioTracks: t }) {
                (this.resetTransmuxer(), (this.levels = t.map(e => new hh(e))));
              }
              onAudioTrackSwitching(e, t) {
                var r = !!t.url;
                this.trackId = t.id;
                var i = this.fragCurrent;
                (i && (i.abortRequests(), this.removeUnbufferedFrags(i.start)),
                  this.resetLoadingState(),
                  r
                    ? ((this.switchingTrack = t),
                      this.flushAudioIfNeeded(t),
                      this.state !== Pf && (this.setInterval(100), (this.state = Of), this.tick()))
                    : (this.resetTransmuxer(),
                      (this.switchingTrack = null),
                      (this.bufferedTrack = t),
                      this.clearInterval()));
              }
              onManifestLoading() {
                (super.onManifestLoading(),
                  (this.bufferFlushed = this.flushing = this.audioOnly = !1),
                  this.resetItem(),
                  (this.trackId = -1));
              }
              onLevelLoaded(e, t) {
                this.mainDetails = t.details;
                var r = this.cachedTrackLoadedData;
                r && ((this.cachedTrackLoadedData = null), this.onAudioTrackLoaded(Au.AUDIO_TRACK_LOADED, r));
              }
              onAudioTrackLoaded(e, t) {
                var r,
                  i = this.levels,
                  n = t.details,
                  a = t.id,
                  s = t.groupId,
                  o = t.track;
                if (i) {
                  var l = this.mainDetails;
                  if (!l || n.endCC > l.endCC || l.expired)
                    return ((this.cachedTrackLoadedData = t), void (this.state !== Pf && (this.state = Bf)));
                  ((this.cachedTrackLoadedData = null),
                    this.log(
                      `Audio track ${a} "${o.name}" of "${s}" loaded [${n.startSN},${n.endSN}]${n.lastPartSn ? `[part-${n.lastPartSn}-${n.lastPartIndex}]` : ""},duration:${n.totalduration}`,
                    ));
                  var u = i[a],
                    d = 0;
                  if (n.live || (null != (r = u.details) && r.live)) {
                    if ((this.checkLiveUpdate(n), n.deltaUpdateFailed)) return;
                    var h;
                    if (u.details)
                      d = this.alignPlaylists(
                        n,
                        u.details,
                        null == (h = this.levelLastLoaded) ? void 0 : h.details,
                      );
                    n.alignedSliding || (Cf(n, l), n.alignedSliding || Lf(n, l), (d = n.fragmentStart));
                  }
                  ((u.details = n),
                    (this.levelLastLoaded = u),
                    this.startFragRequested || this.setStartPosition(l, d),
                    this.hls.trigger(Au.AUDIO_TRACK_UPDATED, { details: n, id: a, groupId: t.groupId }),
                    this.state !== Bf || this.waitForCdnTuneIn(n) || (this.state = Of),
                    this.tick());
                } else this.warn(`Audio tracks reset while loading track ${a} "${o.name}" of "${s}"`);
              }
              _handleFragmentLoadProgress(e) {
                var t,
                  r = e.frag,
                  i = e.part,
                  n = e.payload,
                  a = this.config,
                  s = this.trackId,
                  o = this.levels;
                if (o) {
                  var l = o[s];
                  if (l) {
                    var u = l.details;
                    if (!u)
                      return (
                        this.warn("Audio track details undefined on fragment load progress"),
                        void this.removeUnbufferedFrags(r.start)
                      );
                    var d = a.defaultAudioCodec || l.audioCodec || "mp4a.40.2",
                      h = this.transmuxer;
                    h ||
                      (h = this.transmuxer =
                        new xg(
                          this.hls,
                          Mu,
                          this._handleTransmuxComplete.bind(this),
                          this._handleTransmuxerFlush.bind(this),
                        ));
                    var c = this.initPTS[r.cc],
                      f = null == (t = r.initSegment) ? void 0 : t.data;
                    if (void 0 !== c) {
                      var p = i ? i.index : -1,
                        g = -1 !== p,
                        m = new hc(r.level, r.sn, r.stats.chunkCount, n.byteLength, p, g);
                      h.push(n, f, d, "", r, i, u.totalduration, !1, m, c);
                    } else {
                      (this.log(
                        `Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${u.startSN} ,${u.endSN}],track ${s}`,
                      ),
                        (this.waitingData = this.waitingData || {
                          frag: r,
                          part: i,
                          cache: new qf(),
                          complete: !1,
                        }).cache.push(new Uint8Array(n)),
                        this.state !== Pf && (this.state = Hf));
                    }
                  } else this.warn("Audio track is undefined on fragment load progress");
                } else
                  this.warn(
                    `Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`,
                  );
              }
              _handleFragmentLoadComplete(e) {
                this.waitingData ? (this.waitingData.complete = !0) : super._handleFragmentLoadComplete(e);
              }
              onBufferReset() {
                this.mediaBuffer = null;
              }
              onBufferCreated(e, t) {
                this.bufferFlushed = this.flushing = !1;
                var r = t.tracks.audio;
                r && (this.mediaBuffer = r.buffer || null);
              }
              onFragLoading(e, t) {
                !this.audioOnly &&
                  t.frag.type === Lu &&
                  sd(t.frag) &&
                  ((this.mainFragLoading = t), this.state === Of && this.tick());
              }
              onFragBuffered(e, t) {
                var r = t.frag,
                  i = t.part;
                if (r.type === Mu)
                  if (this.fragContextChanged(r))
                    this.warn(
                      `Fragment ${r.sn}${i ? " p: " + i.index : ""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack ? this.switchingTrack.name : "false"}`,
                    );
                  else {
                    if (sd(r)) {
                      this.fragPrevious = r;
                      var n = this.switchingTrack;
                      n &&
                        ((this.bufferedTrack = n),
                        (this.switchingTrack = null),
                        this.hls.trigger(Au.AUDIO_TRACK_SWITCHED, Uu({}, n)));
                    }
                    (this.fragBufferedComplete(r, i), this.media && this.tick());
                  }
                else
                  this.audioOnly ||
                    r.type !== Lu ||
                    r.elementaryStreams.video ||
                    r.elementaryStreams.audiovideo ||
                    ((this.audioOnly = !0), (this.mainFragLoading = null));
              }
              onError(e, t) {
                var r;
                if (t.fatal) this.state = Vf;
                else
                  switch (t.details) {
                    case wu.FRAG_GAP:
                    case wu.FRAG_PARSING_ERROR:
                    case wu.FRAG_DECRYPT_ERROR:
                    case wu.FRAG_LOAD_ERROR:
                    case wu.FRAG_LOAD_TIMEOUT:
                    case wu.KEY_LOAD_ERROR:
                    case wu.KEY_LOAD_TIMEOUT:
                      this.onFragmentOrKeyLoadError(Mu, t);
                      break;
                    case wu.AUDIO_TRACK_LOAD_ERROR:
                    case wu.AUDIO_TRACK_LOAD_TIMEOUT:
                    case wu.LEVEL_PARSING_ERROR:
                      t.levelRetry ||
                        this.state !== Bf ||
                        (null == (r = t.context) ? void 0 : r.type) !== Ru ||
                        (this.state = Of);
                      break;
                    case wu.BUFFER_ADD_CODEC_ERROR:
                    case wu.BUFFER_APPEND_ERROR:
                      if ("audio" !== t.parent) return;
                      this.reduceLengthAndFlushBuffer(t) || this.resetLoadingState();
                      break;
                    case wu.BUFFER_FULL_ERROR:
                      if ("audio" !== t.parent) return;
                      this.reduceLengthAndFlushBuffer(t) &&
                        ((this.bufferedTrack = null),
                        super.flushMainBuffer(0, Number.POSITIVE_INFINITY, "audio"));
                      break;
                    case wu.INTERNAL_EXCEPTION:
                      this.recoverWorkerError(t);
                  }
              }
              onBufferFlushing(e, { type: t }) {
                t !== id && (this.flushing = !0);
              }
              onBufferFlushed(e, { type: t }) {
                if (t !== id) {
                  ((this.flushing = !1), (this.bufferFlushed = !0), this.state === Gf && (this.state = Of));
                  var r = this.mediaBuffer || this.media;
                  r && (this.afterBufferFlushed(r, t, Mu), this.tick());
                }
              }
              _handleTransmuxComplete(e) {
                var t,
                  r = "audio",
                  i = this.hls,
                  n = e.remuxResult,
                  a = e.chunkMeta,
                  s = this.getCurrentContext(a);
                if (s) {
                  var o = s.frag,
                    l = s.part,
                    u = s.level,
                    d = u.details,
                    h = n.audio,
                    c = n.text,
                    f = n.id3,
                    p = n.initSegment;
                  if (!this.fragContextChanged(o) && d) {
                    if (
                      ((this.state = $f),
                      this.switchingTrack && h && this.completeAudioSwitch(this.switchingTrack),
                      null != p && p.tracks)
                    ) {
                      var g = o.initSegment || o;
                      if (this.unhandledEncryptionError(p, o)) return;
                      (this._bufferInitSegment(u, p.tracks, g, a),
                        i.trigger(Au.FRAG_PARSING_INIT_SEGMENT, { frag: g, id: r, tracks: p.tracks }));
                    }
                    if (h) {
                      var m = h.startPTS,
                        v = h.endPTS,
                        y = h.startDTS,
                        T = h.endDTS;
                      (l && (l.elementaryStreams[rd] = { startPTS: m, endPTS: v, startDTS: y, endDTS: T }),
                        o.setElementaryStreamInfo(rd, m, v, y, T),
                        this.bufferFragmentData(h, o, l, a));
                    }
                    if (null != f && null != (t = f.samples) && t.length) {
                      var b = Nu({ id: r, frag: o, details: d }, f);
                      i.trigger(Au.FRAG_PARSING_METADATA, b);
                    }
                    if (c) {
                      var S = Nu({ id: r, frag: o, details: d }, c);
                      i.trigger(Au.FRAG_PARSING_USERDATA, S);
                    }
                  } else this.fragmentTracker.removeFragment(o);
                } else this.resetWhenMissingContext(a);
              }
              _bufferInitSegment(e, t, r, i) {
                if (
                  this.state === $f &&
                  (t.video && delete t.video, t.audiovideo && delete t.audiovideo, t.audio)
                ) {
                  var n = t.audio;
                  n.id = Mu;
                  var a = e.audioCodec;
                  (this.log(
                    `Init audio buffer, container:${n.container}, codecs[level/parsed]=[${a}/${n.codec}]`,
                  ),
                    a && 1 === a.split(",").length && (n.levelCodec = a),
                    this.hls.trigger(Au.BUFFER_CODECS, t));
                  var s = n.initSegment;
                  if (null != s && s.byteLength) {
                    var o = { type: "audio", frag: r, part: null, chunkMeta: i, parent: r.type, data: s };
                    this.hls.trigger(Au.BUFFER_APPENDING, o);
                  }
                  this.tickImmediate();
                }
              }
              loadFragment(e, t, r) {
                var i,
                  n = this.fragmentTracker.getState(e);
                if (this.switchingTrack || n === Kh || n === zh)
                  if (sd(e))
                    if (null != (i = t.details) && i.live && !this.initPTS[e.cc]) {
                      (this.log(
                        `Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`,
                      ),
                        (this.state = Hf));
                      var a = this.mainDetails;
                      a && a.fragmentStart !== t.details.fragmentStart && Lf(t.details, a);
                    } else super.loadFragment(e, t, r);
                  else this._loadInitSegment(e, t);
                else this.clearTrackerIfNeeded(e);
              }
              flushAudioIfNeeded(e) {
                if (this.media && this.bufferedTrack) {
                  var t = this.bufferedTrack;
                  Th(
                    {
                      name: t.name,
                      lang: t.lang,
                      assocLang: t.assocLang,
                      characteristics: t.characteristics,
                      audioCodec: t.audioCodec,
                      channels: t.channels,
                    },
                    e,
                    bh,
                  ) ||
                    (Eh(e.url, this.hls)
                      ? (this.log("Switching audio track : flushing all audio"),
                        super.flushMainBuffer(0, Number.POSITIVE_INFINITY, "audio"),
                        (this.bufferedTrack = null))
                      : (this.bufferedTrack = e));
                }
              }
              completeAudioSwitch(e) {
                var t = this.hls;
                (this.flushAudioIfNeeded(e),
                  (this.bufferedTrack = e),
                  (this.switchingTrack = null),
                  t.trigger(Au.AUDIO_TRACK_SWITCHED, Uu({}, e)));
              }
            },
            audioTrackController: class extends wg {
              constructor(e) {
                (super(e, "audio-track-controller"),
                  (this.tracks = []),
                  (this.groupIds = null),
                  (this.tracksInGroup = []),
                  (this.trackId = -1),
                  (this.currentTrack = null),
                  (this.selectDefaultTrack = !0),
                  this.registerListeners());
              }
              registerListeners() {
                var e = this.hls;
                (e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.on(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                  e.on(Au.LEVEL_LOADING, this.onLevelLoading, this),
                  e.on(Au.LEVEL_SWITCHING, this.onLevelSwitching, this),
                  e.on(Au.AUDIO_TRACK_LOADED, this.onAudioTrackLoaded, this),
                  e.on(Au.ERROR, this.onError, this));
              }
              unregisterListeners() {
                var e = this.hls;
                (e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.off(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                  e.off(Au.LEVEL_LOADING, this.onLevelLoading, this),
                  e.off(Au.LEVEL_SWITCHING, this.onLevelSwitching, this),
                  e.off(Au.AUDIO_TRACK_LOADED, this.onAudioTrackLoaded, this),
                  e.off(Au.ERROR, this.onError, this));
              }
              destroy() {
                (this.unregisterListeners(),
                  (this.tracks.length = 0),
                  (this.tracksInGroup.length = 0),
                  (this.currentTrack = null),
                  super.destroy());
              }
              onManifestLoading() {
                ((this.tracks = []),
                  (this.tracksInGroup = []),
                  (this.groupIds = null),
                  (this.currentTrack = null),
                  (this.trackId = -1),
                  (this.selectDefaultTrack = !0));
              }
              onManifestParsed(e, t) {
                this.tracks = t.audioTracks || [];
              }
              onAudioTrackLoaded(e, t) {
                var r = t.id,
                  i = t.groupId,
                  n = t.details,
                  a = this.tracksInGroup[r];
                if (a && a.groupId === i) {
                  var s = a.details;
                  ((a.details = t.details),
                    this.log(
                      `Audio track ${r} "${a.name}" lang:${a.lang} group:${i} loaded [${n.startSN}-${n.endSN}]`,
                    ),
                    r === this.trackId && this.playlistLoaded(r, t, s));
                } else
                  this.warn(
                    `Audio track with id:${r} and group:${i} not found in active group ${null == a ? void 0 : a.groupId}`,
                  );
              }
              onLevelLoading(e, t) {
                this.switchLevel(t.level);
              }
              onLevelSwitching(e, t) {
                this.switchLevel(t.level);
              }
              switchLevel(e) {
                var t = this.hls.levels[e];
                if (t) {
                  var r = t.audioGroups || null,
                    i = this.groupIds,
                    n = this.currentTrack;
                  if (
                    !r ||
                    (null == i ? void 0 : i.length) !== (null == r ? void 0 : r.length) ||
                    (null != r && r.some(e => -1 === (null == i ? void 0 : i.indexOf(e))))
                  ) {
                    ((this.groupIds = r), (this.trackId = -1), (this.currentTrack = null));
                    var a = this.tracks.filter(e => !r || -1 !== r.indexOf(e.groupId));
                    if (a.length)
                      (this.selectDefaultTrack && !a.some(e => e.default) && (this.selectDefaultTrack = !1),
                        a.forEach((e, t) => {
                          e.id = t;
                        }));
                    else if (!n && !this.tracksInGroup.length) return;
                    this.tracksInGroup = a;
                    var s = this.hls.config.audioPreference;
                    if (!n && s) {
                      var o = yh(s, a, bh);
                      if (o > -1) n = a[o];
                      else {
                        var l = yh(s, this.tracks);
                        n = this.tracks[l];
                      }
                    }
                    var u = this.findTrackId(n);
                    -1 === u && n && (u = this.findTrackId(null));
                    var d = { audioTracks: a };
                    (this.log(
                      `Updating audio tracks, ${a.length} track(s) found in group(s): ${null == r ? void 0 : r.join(",")}`,
                    ),
                      this.hls.trigger(Au.AUDIO_TRACKS_UPDATED, d));
                    var h = this.trackId;
                    if (-1 !== u && -1 === h) this.setAudioTrack(u);
                    else if (a.length && -1 === h) {
                      var c,
                        f = new Error(
                          `No audio track selected for current audio group-ID(s): ${null == (c = this.groupIds) ? void 0 : c.join(",")} track count: ${a.length}`,
                        );
                      (this.warn(f.message),
                        this.hls.trigger(Au.ERROR, {
                          type: xu.MEDIA_ERROR,
                          details: wu.AUDIO_TRACK_LOAD_ERROR,
                          fatal: !0,
                          error: f,
                        }));
                    }
                  }
                }
              }
              onError(e, t) {
                !t.fatal &&
                  t.context &&
                  (t.context.type !== Ru ||
                    t.context.id !== this.trackId ||
                    (this.groupIds && -1 === this.groupIds.indexOf(t.context.groupId)) ||
                    this.checkRetry(t));
              }
              get allAudioTracks() {
                return this.tracks;
              }
              get audioTracks() {
                return this.tracksInGroup;
              }
              get audioTrack() {
                return this.trackId;
              }
              set audioTrack(e) {
                ((this.selectDefaultTrack = !1), this.setAudioTrack(e));
              }
              setAudioOption(e) {
                var t = this.hls;
                if (((t.config.audioPreference = e), e)) {
                  var r = this.allAudioTracks;
                  if (((this.selectDefaultTrack = !1), r.length)) {
                    var i = this.currentTrack;
                    if (i && Th(e, i, bh)) return i;
                    var n = yh(e, this.tracksInGroup, bh);
                    if (n > -1) {
                      var a = this.tracksInGroup[n];
                      return (this.setAudioTrack(n), a);
                    }
                    if (i) {
                      var s = t.loadLevel;
                      -1 === s && (s = t.firstAutoLevel);
                      var o = (function (e, t, r, i, n) {
                        var a = t[i],
                          s = t.reduce((e, t, r) => {
                            var i = t.uri;
                            return ((e[i] || (e[i] = [])).push(r), e);
                          }, {})[a.uri];
                        s.length > 1 && (i = Math.max.apply(Math, s));
                        var o = a.videoRange,
                          l = a.frameRate,
                          u = a.codecSet.substring(0, 4),
                          d = Sh(t, i, t => {
                            if (t.videoRange !== o || t.frameRate !== l || t.codecSet.substring(0, 4) !== u)
                              return !1;
                            var i = t.audioGroups,
                              a = r.filter(e => !i || -1 !== i.indexOf(e.groupId));
                            return yh(e, a, n) > -1;
                          });
                        return d > -1
                          ? d
                          : Sh(t, i, t => {
                              var i = t.audioGroups,
                                a = r.filter(e => !i || -1 !== i.indexOf(e.groupId));
                              return yh(e, a, n) > -1;
                            });
                      })(e, t.levels, r, s, bh);
                      if (-1 === o) return null;
                      t.nextLoadLevel = o;
                    }
                    if (e.channels || e.audioCodec) {
                      var l = yh(e, r);
                      if (l > -1) return r[l];
                    }
                  }
                }
                return null;
              }
              setAudioTrack(e) {
                var t = this.tracksInGroup;
                if (e < 0 || e >= t.length) this.warn(`Invalid audio track id: ${e}`);
                else {
                  this.selectDefaultTrack = !1;
                  var r = this.currentTrack,
                    i = t[e],
                    n = i.details && !i.details.live;
                  if (
                    !(
                      (e === this.trackId && i === r && n) ||
                      (this.log(
                        `Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`,
                      ),
                      (this.trackId = e),
                      (this.currentTrack = i),
                      this.hls.trigger(Au.AUDIO_TRACK_SWITCHING, Uu({}, i)),
                      n)
                    )
                  ) {
                    var a = this.switchParams(i.url, null == r ? void 0 : r.details, i.details);
                    this.loadPlaylist(a);
                  }
                }
              }
              findTrackId(e) {
                for (var t = this.tracksInGroup, r = 0; r < t.length; r++) {
                  var i = t[r];
                  if ((!this.selectDefaultTrack || i.default) && (!e || Th(e, i, bh))) return r;
                }
                if (e) {
                  for (
                    var n = e.name,
                      a = e.lang,
                      s = e.assocLang,
                      o = e.characteristics,
                      l = e.audioCodec,
                      u = e.channels,
                      d = 0;
                    d < t.length;
                    d++
                  ) {
                    if (
                      Th(
                        { name: n, lang: a, assocLang: s, characteristics: o, audioCodec: l, channels: u },
                        t[d],
                        bh,
                      )
                    )
                      return d;
                  }
                  for (var h = 0; h < t.length; h++) {
                    var c = t[h];
                    if (Ig(e.attrs, c.attrs, ["LANGUAGE", "ASSOC-LANGUAGE", "CHARACTERISTICS"])) return h;
                  }
                  for (var f = 0; f < t.length; f++) {
                    var p = t[f];
                    if (Ig(e.attrs, p.attrs, ["LANGUAGE"])) return f;
                  }
                }
                return -1;
              }
              loadPlaylist(e) {
                super.loadPlaylist();
                var t = this.currentTrack;
                this.shouldLoadPlaylist(t) && Eh(t.url, this.hls) && this.scheduleLoading(t, e);
              }
              loadingPlaylist(e, t) {
                super.loadingPlaylist(e, t);
                var r = e.id,
                  i = e.groupId,
                  n = this.getUrlWithDirectives(e.url, t),
                  a = e.details,
                  s = null == a ? void 0 : a.age;
                (this.log(
                  `Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${i}${void 0 !== (null == t ? void 0 : t.msn) ? " at sn " + t.msn + " part " + t.part : ""}${s && a.live ? " age " + s.toFixed(1) + ((a.type && " " + a.type) || "") : ""} ${n}`,
                ),
                  this.hls.trigger(Au.AUDIO_TRACK_LOADING, {
                    url: n,
                    id: r,
                    groupId: i,
                    deliveryDirectives: t || null,
                    track: e,
                  }));
              }
            },
            emeController: Lm,
            cmcdController: class {
              constructor(e) {
                ((this.hls = void 0),
                  (this.config = void 0),
                  (this.media = void 0),
                  (this.sid = void 0),
                  (this.cid = void 0),
                  (this.useHeaders = !1),
                  (this.includeKeys = void 0),
                  (this.initialized = !1),
                  (this.starved = !1),
                  (this.buffering = !0),
                  (this.audioBuffer = void 0),
                  (this.videoBuffer = void 0),
                  (this.onWaiting = () => {
                    (this.initialized && (this.starved = !0), (this.buffering = !0));
                  }),
                  (this.onPlaying = () => {
                    (this.initialized || (this.initialized = !0), (this.buffering = !1));
                  }),
                  (this.applyPlaylistData = e => {
                    try {
                      this.apply(e, { ot: Og.MANIFEST, su: !this.initialized });
                    } catch (t) {
                      this.hls.logger.warn("Could not generate manifest CMCD data.", t);
                    }
                  }),
                  (this.applyFragmentData = e => {
                    try {
                      var t = e.frag,
                        r = e.part,
                        i = this.hls.levels[t.level],
                        n = this.getObjectType(t),
                        a = { d: 1e3 * (r || t).duration, ot: n };
                      (n !== Og.VIDEO && n !== Og.AUDIO && n != Og.MUXED) ||
                        ((a.br = i.bitrate / 1e3),
                        (a.tb = this.getTopBandwidth(n) / 1e3),
                        (a.bl = this.getBufferLength(n)));
                      var s = r ? this.getNextPart(r) : this.getNextFrag(t);
                      (null != s && s.url && s.url !== t.url && (a.nor = s.url), this.apply(e, a));
                    } catch (o) {
                      this.hls.logger.warn("Could not generate segment CMCD data.", o);
                    }
                  }),
                  (this.hls = e));
                var t = (this.config = e.config),
                  r = t.cmcd;
                null != r &&
                  ((t.pLoader = this.createPlaylistLoader()),
                  (t.fLoader = this.createFragmentLoader()),
                  (this.sid = r.sessionId || e.sessionId),
                  (this.cid = r.contentId),
                  (this.useHeaders = !0 === r.useHeaders),
                  (this.includeKeys = r.includeKeys),
                  this.registerListeners());
              }
              registerListeners() {
                var e = this.hls;
                (e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
                  e.on(Au.MEDIA_DETACHED, this.onMediaDetached, this),
                  e.on(Au.BUFFER_CREATED, this.onBufferCreated, this));
              }
              unregisterListeners() {
                var e = this.hls;
                (e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
                  e.off(Au.MEDIA_DETACHED, this.onMediaDetached, this),
                  e.off(Au.BUFFER_CREATED, this.onBufferCreated, this));
              }
              destroy() {
                (this.unregisterListeners(),
                  this.onMediaDetached(),
                  (this.hls = this.config = this.audioBuffer = this.videoBuffer = null),
                  (this.onWaiting = this.onPlaying = this.media = null));
              }
              onMediaAttached(e, t) {
                ((this.media = t.media),
                  this.media.addEventListener("waiting", this.onWaiting),
                  this.media.addEventListener("playing", this.onPlaying));
              }
              onMediaDetached() {
                this.media &&
                  (this.media.removeEventListener("waiting", this.onWaiting),
                  this.media.removeEventListener("playing", this.onPlaying),
                  (this.media = null));
              }
              onBufferCreated(e, t) {
                var r, i;
                ((this.audioBuffer = null == (r = t.tracks.audio) ? void 0 : r.buffer),
                  (this.videoBuffer = null == (i = t.tracks.video) ? void 0 : i.buffer));
              }
              createData() {
                var e;
                return {
                  v: 1,
                  sf: Ng.HLS,
                  sid: this.sid,
                  cid: this.cid,
                  pr: null == (e = this.media) ? void 0 : e.playbackRate,
                  mtp: this.hls.bandwidthEstimate / 1e3,
                };
              }
              apply(e, t = {}) {
                Nu(t, this.createData());
                var r = t.ot === Og.INIT || t.ot === Og.VIDEO || t.ot === Og.MUXED;
                (this.starved && r && ((t.bs = !0), (t.su = !0), (this.starved = !1)),
                  null == t.su && (t.su = this.buffering));
                var i = this.includeKeys;
                i && (t = Object.keys(t).reduce((e, r) => (i.includes(r) && (e[r] = t[r]), e), {}));
                var n = { baseUrl: e.url };
                this.useHeaders
                  ? (e.headers || (e.headers = {}), wm(e.headers, t, n))
                  : (e.url = km(e.url, t, n));
              }
              getNextFrag(e) {
                var t,
                  r = null == (t = this.hls.levels[e.level]) ? void 0 : t.details;
                if (r) {
                  var i = e.sn - r.startSN;
                  return r.fragments[i + 1];
                }
              }
              getNextPart(e) {
                var t,
                  r = e.index,
                  i = e.fragment,
                  n = null == (t = this.hls.levels[i.level]) || null == (t = t.details) ? void 0 : t.partList;
                if (n)
                  for (var a = i.sn, s = n.length - 1; s >= 0; s--) {
                    var o = n[s];
                    if (o.index === r && o.fragment.sn === a) return n[s + 1];
                  }
              }
              getObjectType(e) {
                var t = e.type;
                return "subtitle" === t
                  ? Og.TIMED_TEXT
                  : "initSegment" === e.sn
                    ? Og.INIT
                    : "audio" === t
                      ? Og.AUDIO
                      : "main" === t
                        ? this.hls.audioTracks.length
                          ? Og.VIDEO
                          : Og.MUXED
                        : void 0;
              }
              getTopBandwidth(e) {
                var t,
                  r = 0,
                  i = this.hls;
                if (e === Og.AUDIO) t = i.audioTracks;
                else {
                  var n = i.maxAutoLevel,
                    a = n > -1 ? n + 1 : i.levels.length;
                  t = i.levels.slice(0, a);
                }
                return (
                  t.forEach(e => {
                    e.bitrate > r && (r = e.bitrate);
                  }),
                  r > 0 ? r : NaN
                );
              }
              getBufferLength(e) {
                var t = this.media,
                  r = e === Og.AUDIO ? this.audioBuffer : this.videoBuffer;
                return r && t ? 1e3 * fc.bufferInfo(r, t.currentTime, this.config.maxBufferHole).len : NaN;
              }
              createPlaylistLoader() {
                var e = this.config.pLoader,
                  t = this.applyPlaylistData,
                  r = e || this.config.loader;
                return class {
                  constructor(e) {
                    ((this.loader = void 0), (this.loader = new r(e)));
                  }
                  get stats() {
                    return this.loader.stats;
                  }
                  get context() {
                    return this.loader.context;
                  }
                  destroy() {
                    this.loader.destroy();
                  }
                  abort() {
                    this.loader.abort();
                  }
                  load(e, r, i) {
                    (t(e), this.loader.load(e, r, i));
                  }
                };
              }
              createFragmentLoader() {
                var e = this.config.fLoader,
                  t = this.applyFragmentData,
                  r = e || this.config.loader;
                return class {
                  constructor(e) {
                    ((this.loader = void 0), (this.loader = new r(e)));
                  }
                  get stats() {
                    return this.loader.stats;
                  }
                  get context() {
                    return this.loader.context;
                  }
                  destroy() {
                    this.loader.destroy();
                  }
                  abort() {
                    this.loader.abort();
                  }
                  load(e, r, i) {
                    (t(e), this.loader.load(e, r, i));
                  }
                };
              }
            },
            contentSteeringController: class extends Bu {
              constructor(e) {
                (super("content-steering", e.logger),
                  (this.hls = void 0),
                  (this.loader = null),
                  (this.uri = null),
                  (this.pathwayId = "."),
                  (this._pathwayPriority = null),
                  (this.timeToLoad = 300),
                  (this.reloadTimer = -1),
                  (this.updated = 0),
                  (this.started = !1),
                  (this.enabled = !0),
                  (this.levels = null),
                  (this.audioTracks = null),
                  (this.subtitleTracks = null),
                  (this.penalizedPathways = {}),
                  (this.hls = e),
                  this.registerListeners());
              }
              registerListeners() {
                var e = this.hls;
                (e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.on(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
                  e.on(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                  e.on(Au.ERROR, this.onError, this));
              }
              unregisterListeners() {
                var e = this.hls;
                e &&
                  (e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.off(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
                  e.off(Au.MANIFEST_PARSED, this.onManifestParsed, this),
                  e.off(Au.ERROR, this.onError, this));
              }
              pathways() {
                return (this.levels || []).reduce(
                  (e, t) => (-1 === e.indexOf(t.pathwayId) && e.push(t.pathwayId), e),
                  [],
                );
              }
              get pathwayPriority() {
                return this._pathwayPriority;
              }
              set pathwayPriority(e) {
                this.updatePathwayPriority(e);
              }
              startLoad() {
                if (((this.started = !0), this.clearTimeout(), this.enabled && this.uri)) {
                  if (this.updated) {
                    var e = 1e3 * this.timeToLoad - (performance.now() - this.updated);
                    if (e > 0) return void this.scheduleRefresh(this.uri, e);
                  }
                  this.loadSteeringManifest(this.uri);
                }
              }
              stopLoad() {
                ((this.started = !1),
                  this.loader && (this.loader.destroy(), (this.loader = null)),
                  this.clearTimeout());
              }
              clearTimeout() {
                -1 !== this.reloadTimer && (self.clearTimeout(this.reloadTimer), (this.reloadTimer = -1));
              }
              destroy() {
                (this.unregisterListeners(),
                  this.stopLoad(),
                  (this.hls = null),
                  (this.levels = this.audioTracks = this.subtitleTracks = null));
              }
              removeLevel(e) {
                var t = this.levels;
                t && (this.levels = t.filter(t => t !== e));
              }
              onManifestLoading() {
                (this.stopLoad(),
                  (this.enabled = !0),
                  (this.timeToLoad = 300),
                  (this.updated = 0),
                  (this.uri = null),
                  (this.pathwayId = "."),
                  (this.levels = this.audioTracks = this.subtitleTracks = null));
              }
              onManifestLoaded(e, t) {
                var r = t.contentSteering;
                null !== r &&
                  ((this.pathwayId = r.pathwayId), (this.uri = r.uri), this.started && this.startLoad());
              }
              onManifestParsed(e, t) {
                ((this.audioTracks = t.audioTracks), (this.subtitleTracks = t.subtitleTracks));
              }
              onError(e, t) {
                var r = t.errorAction;
                if ((null == r ? void 0 : r.action) === Fh && r.flags === jh) {
                  var i = this.levels,
                    n = this._pathwayPriority,
                    a = this.pathwayId;
                  if (t.context) {
                    var s = t.context,
                      o = s.groupId,
                      l = s.pathwayId,
                      u = s.type;
                    o && i ? (a = this.getPathwayForGroupId(o, u, a)) : l && (a = l);
                  }
                  (a in this.penalizedPathways || (this.penalizedPathways[a] = performance.now()),
                    !n && i && (n = this.pathways()),
                    n && n.length > 1 && (this.updatePathwayPriority(n), (r.resolved = this.pathwayId !== a)),
                    t.details !== wu.BUFFER_APPEND_ERROR || t.fatal
                      ? r.resolved ||
                        this.warn(
                          `Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${i ? i.length : i} priorities: ${ph(n)} penalized: ${ph(this.penalizedPathways)}`,
                        )
                      : (r.resolved = !0));
                }
              }
              filterParsedLevels(e) {
                this.levels = e;
                var t = this.getLevelsForPathway(this.pathwayId);
                if (0 === t.length) {
                  var r = e[0].pathwayId;
                  (this.log(
                    `No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`,
                  ),
                    (t = this.getLevelsForPathway(r)),
                    (this.pathwayId = r));
                }
                return (
                  t.length !== e.length &&
                    this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),
                  t
                );
              }
              getLevelsForPathway(e) {
                return null === this.levels ? [] : this.levels.filter(t => e === t.pathwayId);
              }
              updatePathwayPriority(e) {
                var t;
                this._pathwayPriority = e;
                var r = this.penalizedPathways,
                  i = performance.now();
                Object.keys(r).forEach(e => {
                  i - r[e] > 3e5 && delete r[e];
                });
                for (var n = 0; n < e.length; n++) {
                  var a = e[n];
                  if (!(a in r)) {
                    if (a === this.pathwayId) return;
                    var s = this.hls.nextLoadLevel,
                      o = this.hls.levels[s];
                    if ((t = this.getLevelsForPathway(a)).length > 0) {
                      (this.log(`Setting Pathway to "${a}"`),
                        (this.pathwayId = a),
                        xf(t),
                        this.hls.trigger(Au.LEVELS_UPDATED, { levels: t }));
                      var l = this.hls.levels[s];
                      o &&
                        l &&
                        this.levels &&
                        (l.attrs["STABLE-VARIANT-ID"] !== o.attrs["STABLE-VARIANT-ID"] &&
                          l.bitrate !== o.bitrate &&
                          this.log(`Unstable Pathways change from bitrate ${o.bitrate} to ${l.bitrate}`),
                        (this.hls.nextLoadLevel = s));
                      break;
                    }
                  }
                }
              }
              getPathwayForGroupId(e, t, r) {
                for (var i = this.getLevelsForPathway(r).concat(this.levels || []), n = 0; n < i.length; n++)
                  if ((t === Ru && i[n].hasAudioGroup(e)) || (t === Cu && i[n].hasSubtitleGroup(e)))
                    return i[n].pathwayId;
                return r;
              }
              clonePathways(e) {
                var t = this.levels;
                if (t) {
                  var r = {},
                    i = {};
                  e.forEach(e => {
                    var n = e.ID,
                      a = e["BASE-ID"],
                      s = e["URI-REPLACEMENT"];
                    if (!t.some(e => e.pathwayId === n)) {
                      var o = this.getLevelsForPathway(a).map(e => {
                        var t = new Sc(e.attrs);
                        t["PATHWAY-ID"] = n;
                        var a = t.AUDIO && `${t.AUDIO}_clone_${n}`,
                          o = t.SUBTITLES && `${t.SUBTITLES}_clone_${n}`;
                        (a && ((r[t.AUDIO] = a), (t.AUDIO = a)),
                          o && ((i[t.SUBTITLES] = o), (t.SUBTITLES = o)));
                        var l = Cm(e.uri, t["STABLE-VARIANT-ID"], "PER-VARIANT-URIS", s),
                          u = new hh({
                            attrs: t,
                            audioCodec: e.audioCodec,
                            bitrate: e.bitrate,
                            height: e.height,
                            name: e.name,
                            url: l,
                            videoCodec: e.videoCodec,
                            width: e.width,
                          });
                        if (e.audioGroups)
                          for (var d = 1; d < e.audioGroups.length; d++)
                            u.addGroupId("audio", `${e.audioGroups[d]}_clone_${n}`);
                        if (e.subtitleGroups)
                          for (var h = 1; h < e.subtitleGroups.length; h++)
                            u.addGroupId("text", `${e.subtitleGroups[h]}_clone_${n}`);
                        return u;
                      });
                      (t.push(...o), Rm(this.audioTracks, r, s, n), Rm(this.subtitleTracks, i, s, n));
                    }
                  });
                }
              }
              loadSteeringManifest(e) {
                var t,
                  r = this.hls.config,
                  i = r.loader;
                (this.loader && this.loader.destroy(), (this.loader = new i(r)));
                try {
                  t = new self.URL(e);
                } catch (d) {
                  return ((this.enabled = !1), void this.log(`Failed to parse Steering Manifest URI: ${e}`));
                }
                if ("data:" !== t.protocol) {
                  var n = 0 | (this.hls.bandwidthEstimate || r.abrEwmaDefaultEstimate);
                  (t.searchParams.set("_HLS_pathway", this.pathwayId),
                    t.searchParams.set("_HLS_throughput", "" + n));
                }
                var a = { responseType: "json", url: t.href },
                  s = r.steeringManifestLoadPolicy.default,
                  o = s.errorRetry || s.timeoutRetry || {},
                  l = {
                    loadPolicy: s,
                    timeout: s.maxLoadTimeMs,
                    maxRetry: o.maxNumRetry || 0,
                    retryDelay: o.retryDelayMs || 0,
                    maxRetryDelay: o.maxRetryDelayMs || 0,
                  },
                  u = {
                    onSuccess: (e, r, i, n) => {
                      this.log(`Loaded steering manifest: "${t}"`);
                      var a = e.data;
                      if (1 === (null == a ? void 0 : a.VERSION)) {
                        ((this.updated = performance.now()), (this.timeToLoad = a.TTL));
                        var s = a["RELOAD-URI"],
                          o = a["PATHWAY-CLONES"],
                          l = a["PATHWAY-PRIORITY"];
                        if (s)
                          try {
                            this.uri = new self.URL(s, t).href;
                          } catch (d) {
                            return (
                              (this.enabled = !1),
                              void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${s}`)
                            );
                          }
                        (this.scheduleRefresh(this.uri || i.url), o && this.clonePathways(o));
                        var u = { steeringManifest: a, url: t.toString() };
                        (this.hls.trigger(Au.STEERING_MANIFEST_LOADED, u),
                          l && this.updatePathwayPriority(l));
                      } else this.log(`Steering VERSION ${a.VERSION} not supported!`);
                    },
                    onError: (e, t, r, i) => {
                      if (
                        (this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),
                        this.stopLoad(),
                        410 === e.code)
                      )
                        return (
                          (this.enabled = !1),
                          void this.log(`Steering manifest ${t.url} no longer available`)
                        );
                      var n = 1e3 * this.timeToLoad;
                      if (429 !== e.code) this.scheduleRefresh(this.uri || t.url, n);
                      else {
                        var a = this.loader;
                        if ("function" == typeof (null == a ? void 0 : a.getResponseHeader)) {
                          var s = a.getResponseHeader("Retry-After");
                          s && (n = 1e3 * parseFloat(s));
                        }
                        this.log(`Steering manifest ${t.url} rate limited`);
                      }
                    },
                    onTimeout: (e, t, r) => {
                      (this.log(`Timeout loading steering manifest (${t.url})`),
                        this.scheduleRefresh(this.uri || t.url));
                    },
                  };
                (this.log(`Requesting steering manifest: ${t}`), this.loader.load(a, l, u));
              }
              scheduleRefresh(e, t = 1e3 * this.timeToLoad) {
                (this.clearTimeout(),
                  (this.reloadTimer = self.setTimeout(() => {
                    var t,
                      r = null == (t = this.hls) ? void 0 : t.media;
                    !r || r.ended
                      ? this.scheduleRefresh(e, 1e3 * this.timeToLoad)
                      : this.loadSteeringManifest(e);
                  }, t)));
              }
            },
            interstitialsController: class extends Bu {
              constructor(e, t) {
                (super("interstitials", e.logger),
                  (this.HlsPlayerClass = void 0),
                  (this.hls = void 0),
                  (this.assetListLoader = void 0),
                  (this.mediaSelection = null),
                  (this.altSelection = null),
                  (this.media = null),
                  (this.detachedData = null),
                  (this.requiredTracks = null),
                  (this.manager = null),
                  (this.playerQueue = []),
                  (this.bufferedPos = -1),
                  (this.timelinePos = -1),
                  (this.schedule = void 0),
                  (this.playingItem = null),
                  (this.bufferingItem = null),
                  (this.waitingItem = null),
                  (this.endedItem = null),
                  (this.playingAsset = null),
                  (this.endedAsset = null),
                  (this.bufferingAsset = null),
                  (this.shouldPlay = !1),
                  (this.onPlay = () => {
                    this.shouldPlay = !0;
                  }),
                  (this.onPause = () => {
                    this.shouldPlay = !1;
                  }),
                  (this.onSeeking = () => {
                    var e = this.currentTime;
                    if (void 0 !== e && !this.playbackDisabled && this.schedule) {
                      var t = e - this.timelinePos;
                      if (!(Math.abs(t) < 1 / 7056e5)) {
                        var r = t <= -0.01;
                        ((this.timelinePos = e), (this.bufferedPos = e));
                        var i = this.playingItem;
                        if (i) {
                          if (r) this.schedule.resetErrorsInRange(e, e - t) && this.updateSchedule(!0);
                          if ((this.checkBuffer(), (r && e < i.start) || e >= i.end)) {
                            var n,
                              a = this.findItemIndex(i),
                              s = this.schedule.findItemIndexAtTime(e);
                            if (
                              (-1 === s &&
                                ((s = a + (r ? -1 : 1)),
                                this.log(
                                  `seeked ${r ? "back " : ""}to position not covered by schedule ${e} (resolving from ${a} to ${s})`,
                                )),
                              !this.isInterstitial(i) &&
                                null != (n = this.media) &&
                                n.paused &&
                                (this.shouldPlay = !1),
                              !r && s > a)
                            ) {
                              var o = this.schedule.findJumpRestrictedIndex(a + 1, s);
                              if (o > a) return void this.setSchedulePosition(o);
                            }
                            this.setSchedulePosition(s);
                          } else {
                            var l = this.playingAsset;
                            if (l) {
                              var u,
                                d = l.timelineStart,
                                h = l.duration || 0;
                              if ((r && e < d) || e >= d + h)
                                (null != (u = i.event) &&
                                  u.appendInPlace &&
                                  (this.clearAssetPlayers(i.event, i), this.flushFrontBuffer(e)),
                                  this.setScheduleToAssetAtTime(e, l));
                            } else if (this.playingLastItem && this.isInterstitial(i)) {
                              var c = i.event.assetList[0];
                              c &&
                                ((this.endedItem = this.playingItem),
                                (this.playingItem = null),
                                this.setScheduleToAssetAtTime(e, c));
                            }
                          }
                        } else this.checkBuffer();
                      }
                    }
                  }),
                  (this.onTimeupdate = () => {
                    var e = this.currentTime;
                    if (void 0 !== e && !this.playbackDisabled && e > this.timelinePos) {
                      ((this.timelinePos = e), e > this.bufferedPos && this.checkBuffer());
                      var t = this.playingItem;
                      if (t && !this.playingLastItem) {
                        if (e >= t.end) {
                          this.timelinePos = t.end;
                          var r = this.findItemIndex(t);
                          this.setSchedulePosition(r + 1);
                        }
                        var i = this.playingAsset;
                        if (i)
                          e >= i.timelineStart + (i.duration || 0) && this.setScheduleToAssetAtTime(e, i);
                      }
                    }
                  }),
                  (this.onScheduleUpdate = (e, t) => {
                    var r = this.schedule;
                    if (r) {
                      var i = this.playingItem,
                        n = r.events || [],
                        a = r.items || [],
                        s = r.durations,
                        o = e.map(e => e.identifier),
                        l = !(!n.length && !o.length);
                      ((l || t) &&
                        this.log(
                          `INTERSTITIALS_UPDATED (${n.length}): ${n}\nSchedule: ${a.map(e => Qm(e))} pos: ${this.timelinePos}`,
                        ),
                        o.length && this.log(`Removed events ${o}`));
                      var u = null,
                        d = null;
                      (i &&
                        ((u = this.updateItem(i, this.timelinePos)),
                        this.itemsMatch(i, u)
                          ? (this.playingItem = u)
                          : (this.waitingItem = this.endedItem = null)),
                        (this.waitingItem = this.updateItem(this.waitingItem)),
                        (this.endedItem = this.updateItem(this.endedItem)));
                      var h = this.bufferingItem;
                      if (
                        (h &&
                          ((d = this.updateItem(h, this.bufferedPos)),
                          this.itemsMatch(h, d)
                            ? (this.bufferingItem = d)
                            : h.event &&
                              ((this.bufferingItem = this.playingItem),
                              this.clearInterstitial(h.event, null))),
                        e.forEach(e => {
                          e.assetList.forEach(e => {
                            this.clearAssetPlayer(e.identifier, null);
                          });
                        }),
                        this.playerQueue.forEach(e => {
                          if (e.interstitial.appendInPlace) {
                            var t = e.assetItem.timelineStart,
                              r = e.timelineOffset - t;
                            if (r)
                              try {
                                e.timelineOffset = t;
                              } catch (i) {
                                Math.abs(r) > jm &&
                                  this.warn(`${i} ("${e.assetId}" ${e.timelineOffset}->${t})`);
                              }
                          }
                        }),
                        l || t)
                      ) {
                        if (
                          (this.hls.trigger(Au.INTERSTITIALS_UPDATED, {
                            events: n.slice(0),
                            schedule: a.slice(0),
                            durations: s,
                            removedIds: o,
                          }),
                          this.isInterstitial(i) && o.includes(i.event.identifier))
                        )
                          return (
                            this.warn(`Interstitial "${i.event.identifier}" removed while playing`),
                            void this.primaryFallback(i.event)
                          );
                        (i && this.trimInPlace(u, i),
                          h && d !== u && this.trimInPlace(d, h),
                          this.checkBuffer());
                      }
                    }
                  }),
                  (this.hls = e),
                  (this.HlsPlayerClass = t),
                  (this.assetListLoader = new Jm(e)),
                  (this.schedule = new Ym(this.onScheduleUpdate, e.logger)),
                  this.registerListeners());
              }
              registerListeners() {
                var e = this.hls;
                e &&
                  (e.on(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                  e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
                  e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                  e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.on(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
                  e.on(Au.AUDIO_TRACK_SWITCHING, this.onAudioTrackSwitching, this),
                  e.on(Au.AUDIO_TRACK_UPDATED, this.onAudioTrackUpdated, this),
                  e.on(Au.SUBTITLE_TRACK_SWITCH, this.onSubtitleTrackSwitch, this),
                  e.on(Au.SUBTITLE_TRACK_UPDATED, this.onSubtitleTrackUpdated, this),
                  e.on(Au.EVENT_CUE_ENTER, this.onInterstitialCueEnter, this),
                  e.on(Au.ASSET_LIST_LOADED, this.onAssetListLoaded, this),
                  e.on(Au.BUFFER_APPENDED, this.onBufferAppended, this),
                  e.on(Au.BUFFER_FLUSHED, this.onBufferFlushed, this),
                  e.on(Au.BUFFERED_TO_END, this.onBufferedToEnd, this),
                  e.on(Au.MEDIA_ENDED, this.onMediaEnded, this),
                  e.on(Au.ERROR, this.onError, this),
                  e.on(Au.DESTROYING, this.onDestroying, this));
              }
              unregisterListeners() {
                var e = this.hls;
                e &&
                  (e.off(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
                  e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
                  e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
                  e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
                  e.off(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
                  e.off(Au.AUDIO_TRACK_SWITCHING, this.onAudioTrackSwitching, this),
                  e.off(Au.AUDIO_TRACK_UPDATED, this.onAudioTrackUpdated, this),
                  e.off(Au.SUBTITLE_TRACK_SWITCH, this.onSubtitleTrackSwitch, this),
                  e.off(Au.SUBTITLE_TRACK_UPDATED, this.onSubtitleTrackUpdated, this),
                  e.off(Au.EVENT_CUE_ENTER, this.onInterstitialCueEnter, this),
                  e.off(Au.ASSET_LIST_LOADED, this.onAssetListLoaded, this),
                  e.off(Au.BUFFER_CODECS, this.onBufferCodecs, this),
                  e.off(Au.BUFFER_APPENDED, this.onBufferAppended, this),
                  e.off(Au.BUFFER_FLUSHED, this.onBufferFlushed, this),
                  e.off(Au.BUFFERED_TO_END, this.onBufferedToEnd, this),
                  e.off(Au.MEDIA_ENDED, this.onMediaEnded, this),
                  e.off(Au.ERROR, this.onError, this),
                  e.off(Au.DESTROYING, this.onDestroying, this));
              }
              startLoad() {
                this.resumeBuffering();
              }
              stopLoad() {
                this.pauseBuffering();
              }
              resumeBuffering() {
                var e;
                null == (e = this.getBufferingPlayer()) || e.resumeBuffering();
              }
              pauseBuffering() {
                var e;
                null == (e = this.getBufferingPlayer()) || e.pauseBuffering();
              }
              destroy() {
                (this.unregisterListeners(),
                  this.stopLoad(),
                  this.assetListLoader && this.assetListLoader.destroy(),
                  this.emptyPlayerQueue(),
                  this.clearScheduleState(),
                  this.schedule && this.schedule.destroy(),
                  (this.media =
                    this.detachedData =
                    this.mediaSelection =
                    this.requiredTracks =
                    this.altSelection =
                    this.schedule =
                    this.manager =
                      null),
                  (this.hls = this.HlsPlayerClass = this.log = null),
                  (this.assetListLoader = null),
                  (this.onPlay = this.onPause = this.onSeeking = this.onTimeupdate = null),
                  (this.onScheduleUpdate = null));
              }
              onDestroying() {
                var e = this.primaryMedia || this.media;
                e && this.removeMediaListeners(e);
              }
              removeMediaListeners(e) {
                (Df(e, "play", this.onPlay),
                  Df(e, "pause", this.onPause),
                  Df(e, "seeking", this.onSeeking),
                  Df(e, "timeupdate", this.onTimeupdate));
              }
              onMediaAttaching(e, t) {
                var r = (this.media = t.media);
                (Mf(r, "seeking", this.onSeeking),
                  Mf(r, "timeupdate", this.onTimeupdate),
                  Mf(r, "play", this.onPlay),
                  Mf(r, "pause", this.onPause));
              }
              onMediaAttached(e, t) {
                var r = this.effectivePlayingItem,
                  i = this.detachedData;
                if (((this.detachedData = null), null === r)) this.checkStart();
                else if (!i) {
                  this.clearScheduleState();
                  var n = this.findItemIndex(r);
                  this.setSchedulePosition(n);
                }
              }
              clearScheduleState() {
                (this.log("clear schedule state"),
                  (this.playingItem =
                    this.bufferingItem =
                    this.waitingItem =
                    this.endedItem =
                    this.playingAsset =
                    this.endedAsset =
                    this.bufferingAsset =
                      null));
              }
              onMediaDetaching(e, t) {
                var r = !!t.transferMedia,
                  i = this.media;
                if (((this.media = null), !r && (i && this.removeMediaListeners(i), this.detachedData))) {
                  var n = this.getBufferingPlayer();
                  (n &&
                    (this.log(`Removing schedule state for detachedData and ${n}`),
                    (this.playingAsset =
                      this.endedAsset =
                      this.bufferingAsset =
                      this.bufferingItem =
                      this.waitingItem =
                      this.detachedData =
                        null),
                    n.detachMedia()),
                    (this.shouldPlay = !1));
                }
              }
              get interstitialsManager() {
                if (!this.hls) return null;
                if (this.manager) return this.manager;
                var e = this,
                  t = () => e.bufferingItem || e.waitingItem,
                  r = t => (t ? e.getAssetPlayer(t.identifier) : t),
                  i = (t, i, a, s, o) => {
                    if (t) {
                      var l = t[i].start,
                        u = t.event;
                      if (u) {
                        if ("playout" === i || u.timelineOccupancy !== Gm.Point) {
                          var d = r(a);
                          (null == d ? void 0 : d.interstitial) === u &&
                            (l += d.assetItem.startOffset + d[o]);
                        }
                      } else l += ("bufferedPos" === s ? n() : e[s]) - t.start;
                      return l;
                    }
                    return 0;
                  },
                  n = () => {
                    var t = e.bufferedPos;
                    return t === Number.MAX_VALUE ? a("primary") : Math.max(t, 0);
                  },
                  a = t => {
                    var r, i;
                    return null != (r = e.primaryDetails) && r.live
                      ? e.primaryDetails.edge
                      : (null == (i = e.schedule) ? void 0 : i.durations[t]) || 0;
                  },
                  s = (t, n) => {
                    var a,
                      s,
                      o = e.effectivePlayingItem;
                    if ((null == o || null == (a = o.event) || !a.restrictions.skip) && e.schedule) {
                      e.log(`seek to ${t} "${n}"`);
                      var l = e.effectivePlayingItem,
                        u = e.schedule.findItemIndexAtTime(t, n),
                        d = null == (s = e.schedule.items) ? void 0 : s[u],
                        h = e.getBufferingPlayer(),
                        c = null == h ? void 0 : h.interstitial,
                        f = null == c ? void 0 : c.appendInPlace,
                        p = l && e.itemsMatch(l, d);
                      if (l && (f || p)) {
                        var g = r(e.playingAsset),
                          m = (null == g ? void 0 : g.media) || e.primaryMedia;
                        if (m) {
                          var v =
                              "primary" === n
                                ? m.currentTime
                                : i(l, n, e.playingAsset, "timelinePos", "currentTime"),
                            y = t - v,
                            T = (f ? v : m.currentTime) + y;
                          if (T >= 0 && (!g || f || T <= g.duration)) return void (m.currentTime = T);
                        }
                      }
                      if (d) {
                        var b = t;
                        if ("primary" !== n) {
                          var S = t - d[n].start;
                          b = d.start + S;
                        }
                        var E = !e.isInterstitial(d);
                        if (
                          (e.isInterstitial(l) && !l.event.appendInPlace) ||
                          (!E && !d.event.appendInPlace)
                        ) {
                          if (l) {
                            var x = e.findItemIndex(l);
                            if (u > x) {
                              var w = e.schedule.findJumpRestrictedIndex(x + 1, u);
                              if (w > x) return void e.setSchedulePosition(w);
                            }
                            var A = 0;
                            if (E) ((e.timelinePos = b), e.checkBuffer());
                            else
                              for (
                                var I = d.event.assetList, k = t - (d[n] || d).start, R = I.length;
                                R--;
                              ) {
                                var C = I[R];
                                if (C.duration && k >= C.startOffset && k < C.startOffset + C.duration) {
                                  A = R;
                                  break;
                                }
                              }
                            e.setSchedulePosition(u, A);
                          }
                        } else {
                          var L = e.media || (f ? (null == h ? void 0 : h.media) : null);
                          L && (L.currentTime = b);
                        }
                      }
                    }
                  },
                  o = () => {
                    var r = e.effectivePlayingItem;
                    if (e.isInterstitial(r)) return r;
                    var i = t();
                    return e.isInterstitial(i) ? i : null;
                  },
                  l = {
                    get bufferedEnd() {
                      var r,
                        n = t(),
                        a = e.bufferingItem;
                      return (
                        (a &&
                          a === n &&
                          (i(a, "playout", e.bufferingAsset, "bufferedPos", "bufferedEnd") -
                            a.playout.start ||
                            (null == (r = e.bufferingAsset) ? void 0 : r.startOffset))) ||
                        0
                      );
                    },
                    get currentTime() {
                      var t = o(),
                        r = e.effectivePlayingItem;
                      return r && r === t
                        ? i(r, "playout", e.effectivePlayingAsset, "timelinePos", "currentTime") -
                            r.playout.start
                        : 0;
                    },
                    set currentTime(t) {
                      var r = o(),
                        i = e.effectivePlayingItem;
                      i && i === r && s(t + i.playout.start, "playout");
                    },
                    get duration() {
                      var e = o();
                      return e ? e.playout.end - e.playout.start : 0;
                    },
                    get assetPlayers() {
                      var t,
                        r = null == (t = o()) ? void 0 : t.event.assetList;
                      return r ? r.map(t => e.getAssetPlayer(t.identifier)) : [];
                    },
                    get playingIndex() {
                      var t,
                        r = null == (t = o()) ? void 0 : t.event;
                      return r && e.effectivePlayingAsset ? r.findAssetIndex(e.effectivePlayingAsset) : -1;
                    },
                    get scheduleItem() {
                      return o();
                    },
                  };
                return (this.manager = {
                  get events() {
                    var t;
                    return (null == (t = e.schedule) || null == (t = t.events) ? void 0 : t.slice(0)) || [];
                  },
                  get schedule() {
                    var t;
                    return (null == (t = e.schedule) || null == (t = t.items) ? void 0 : t.slice(0)) || [];
                  },
                  get interstitialPlayer() {
                    return o() ? l : null;
                  },
                  get playerQueue() {
                    return e.playerQueue.slice(0);
                  },
                  get bufferingAsset() {
                    return e.bufferingAsset;
                  },
                  get bufferingItem() {
                    return t();
                  },
                  get bufferingIndex() {
                    var r = t();
                    return e.findItemIndex(r);
                  },
                  get playingAsset() {
                    return e.effectivePlayingAsset;
                  },
                  get playingItem() {
                    return e.effectivePlayingItem;
                  },
                  get playingIndex() {
                    var t = e.effectivePlayingItem;
                    return e.findItemIndex(t);
                  },
                  primary: {
                    get bufferedEnd() {
                      return n();
                    },
                    get currentTime() {
                      var t = e.timelinePos;
                      return t > 0 ? t : 0;
                    },
                    set currentTime(e) {
                      s(e, "primary");
                    },
                    get duration() {
                      return a("primary");
                    },
                    get seekableStart() {
                      var t;
                      return (null == (t = e.primaryDetails) ? void 0 : t.fragmentStart) || 0;
                    },
                  },
                  integrated: {
                    get bufferedEnd() {
                      return i(t(), "integrated", e.bufferingAsset, "bufferedPos", "bufferedEnd");
                    },
                    get currentTime() {
                      return i(
                        e.effectivePlayingItem,
                        "integrated",
                        e.effectivePlayingAsset,
                        "timelinePos",
                        "currentTime",
                      );
                    },
                    set currentTime(e) {
                      s(e, "integrated");
                    },
                    get duration() {
                      return a("integrated");
                    },
                    get seekableStart() {
                      var t;
                      return ((t, r) => {
                        var i;
                        if (0 !== t && "primary" !== r && null != (i = e.schedule) && i.length) {
                          var n,
                            a = e.schedule.findItemIndexAtTime(t),
                            s = null == (n = e.schedule.items) ? void 0 : n[a];
                          if (s) return t + (s[r].start - s.start);
                        }
                        return t;
                      })((null == (t = e.primaryDetails) ? void 0 : t.fragmentStart) || 0, "integrated");
                    },
                  },
                  skip: () => {
                    var t = e.effectivePlayingItem,
                      r = null == t ? void 0 : t.event;
                    if (r && !r.restrictions.skip) {
                      var i = e.findItemIndex(t);
                      if (r.appendInPlace) {
                        var n = t.playout.start + t.event.duration;
                        s(n + 0.001, "playout");
                      } else e.advanceAfterAssetEnded(r, i, 1 / 0);
                    }
                  },
                });
              }
              get effectivePlayingItem() {
                return this.waitingItem || this.playingItem || this.endedItem;
              }
              get effectivePlayingAsset() {
                return this.playingAsset || this.endedAsset;
              }
              get playingLastItem() {
                var e,
                  t = this.playingItem,
                  r = null == (e = this.schedule) ? void 0 : e.items;
                return !!(this.playbackStarted && t && r) && this.findItemIndex(t) === r.length - 1;
              }
              get playbackStarted() {
                return null !== this.effectivePlayingItem;
              }
              get currentTime() {
                var e, t;
                if (null !== this.mediaSelection) {
                  var r = this.waitingItem || this.playingItem;
                  if (!this.isInterstitial(r) || r.event.appendInPlace) {
                    var i = this.media;
                    !i &&
                      null != (e = this.bufferingItem) &&
                      null != (e = e.event) &&
                      e.appendInPlace &&
                      (i = this.primaryMedia);
                    var n = null == (t = i) ? void 0 : t.currentTime;
                    if (void 0 !== n && bu(n)) return n;
                  }
                }
              }
              get primaryMedia() {
                var e;
                return this.media || (null == (e = this.detachedData) ? void 0 : e.media) || null;
              }
              isInterstitial(e) {
                return !(null == e || !e.event);
              }
              retreiveMediaSource(e, t) {
                var r = this.getAssetPlayer(e);
                r && this.transferMediaFromPlayer(r, t);
              }
              transferMediaFromPlayer(e, t) {
                var r = e.interstitial.appendInPlace,
                  i = e.media;
                if (r && i === this.primaryMedia) {
                  if (
                    ((this.bufferingAsset = null),
                    (!t || (this.isInterstitial(t) && !t.event.appendInPlace)) && t && i)
                  )
                    return void (this.detachedData = { media: i });
                  var n = e.transferMedia();
                  (this.log(`transfer MediaSource from ${e} ${ph(n)}`), (this.detachedData = n));
                } else t && i && (this.shouldPlay || (this.shouldPlay = !i.paused));
              }
              transferMediaTo(e, t) {
                var r, i;
                if (e.media !== t) {
                  var n,
                    a = null,
                    s = this.hls,
                    o = e !== s,
                    l = o && e.interstitial.appendInPlace,
                    u = null == (r = this.detachedData) ? void 0 : r.mediaSource;
                  if (s.media) (l && ((a = s.transferMedia()), (this.detachedData = a)), (n = "Primary"));
                  else if (u) {
                    var d = this.getBufferingPlayer();
                    d ? ((a = d.transferMedia()), (n = `${d}`)) : (n = "detached MediaSource");
                  } else n = "detached media";
                  if (!a)
                    if (u) ((a = this.detachedData), this.log(`using detachedData: MediaSource ${ph(a)}`));
                    else if (!this.detachedData || s.media === t) {
                      var h = this.playerQueue;
                      (h.length > 1 &&
                        h.forEach(e => {
                          if (o && e.interstitial.appendInPlace !== l) {
                            var t = e.interstitial;
                            (this.clearInterstitial(e.interstitial, null),
                              (t.appendInPlace = !1),
                              t.appendInPlace &&
                                this.warn(`Could not change append strategy for queued assets ${t}`));
                          }
                        }),
                        this.hls.detachMedia(),
                        (this.detachedData = { media: t }));
                    }
                  var c =
                      a &&
                      "mediaSource" in a &&
                      "closed" !== (null == (i = a.mediaSource) ? void 0 : i.readyState),
                    f = c && a ? a : t;
                  this.log(
                    `${c ? "transfering MediaSource" : "attaching media"} to ${o ? e : "Primary"} from ${n} (media.currentTime: ${t.currentTime})`,
                  );
                  var p = this.schedule;
                  if (f === a && p) {
                    var g = o && e.assetId === p.assetIdAtEnd;
                    f.overrides = { duration: p.duration, endOfStream: !o || g, cueRemoval: !o };
                  }
                  e.attachMedia(f);
                }
              }
              onInterstitialCueEnter() {
                this.onTimeupdate();
              }
              checkStart() {
                var e = this.schedule,
                  t = null == e ? void 0 : e.events;
                if (t && !this.playbackDisabled && this.media) {
                  -1 === this.bufferedPos && (this.bufferedPos = 0);
                  var r = this.timelinePos,
                    i = this.effectivePlayingItem;
                  if (-1 === r) {
                    var n = this.hls.startPosition;
                    if ((this.log(ev("checkStart", n)), (this.timelinePos = n), t.length && t[0].cue.pre)) {
                      var a = e.findEventIndex(t[0].identifier);
                      this.setSchedulePosition(a);
                    } else if (n >= 0 || !this.primaryLive) {
                      var s = (this.timelinePos = n > 0 ? n : 0),
                        o = e.findItemIndexAtTime(s);
                      this.setSchedulePosition(o);
                    }
                  } else if (i && !this.playingItem) {
                    var l = e.findItemIndex(i);
                    this.setSchedulePosition(l);
                  }
                }
              }
              advanceAssetBuffering(e, t) {
                var r = e.event,
                  i = r.findAssetIndex(t),
                  n = zm(r, i);
                if (r.isAssetPastPlayoutLimit(n)) {
                  if (this.schedule) {
                    var a,
                      s = null == (a = this.schedule.items) ? void 0 : a[this.findItemIndex(e) + 1];
                    s && this.bufferedToItem(s);
                  }
                } else this.bufferedToEvent(e, n);
              }
              advanceAfterAssetEnded(e, t, r) {
                var i = zm(e, r);
                if (e.isAssetPastPlayoutLimit(i)) {
                  if (this.schedule) {
                    var n = this.schedule.items;
                    if (n) {
                      var a = t + 1;
                      if (a >= n.length) return void this.setSchedulePosition(-1);
                      var s = e.resumeTime;
                      (this.timelinePos < s &&
                        (this.log(ev("advanceAfterAssetEnded", s)),
                        (this.timelinePos = s),
                        e.appendInPlace && this.advanceInPlace(s),
                        this.checkBuffer(this.bufferedPos < s)),
                        this.setSchedulePosition(a));
                    }
                  }
                } else {
                  if (e.appendInPlace) {
                    var o = e.assetList[i];
                    o && this.advanceInPlace(o.timelineStart);
                  }
                  this.setSchedulePosition(t, i);
                }
              }
              setScheduleToAssetAtTime(e, t) {
                var r = this.schedule;
                if (r) {
                  var i = t.parentIdentifier,
                    n = r.getEvent(i);
                  if (n) {
                    var a = r.findEventIndex(i),
                      s = r.findAssetIndex(n, e);
                    this.advanceAfterAssetEnded(n, a, s - 1);
                  }
                }
              }
              setSchedulePosition(e, t) {
                var r,
                  i = null == (r = this.schedule) ? void 0 : r.items;
                if (i && !this.playbackDisabled) {
                  var n = e >= 0 ? i[e] : null;
                  this.log(`setSchedulePosition ${e}, ${t} (${n ? Qm(n) : n}) pos: ${this.timelinePos}`);
                  var a = this.waitingItem || this.playingItem,
                    s = this.playingLastItem;
                  if (this.isInterstitial(a)) {
                    var o = a.event,
                      l = this.playingAsset,
                      u = null == l ? void 0 : l.identifier,
                      d = u ? this.getAssetPlayer(u) : null;
                    if (
                      d &&
                      u &&
                      (!this.eventItemsMatch(a, n) || (void 0 !== t && u !== o.assetList[t].identifier))
                    ) {
                      var h,
                        c = o.findAssetIndex(l);
                      if (
                        (this.log(`INTERSTITIAL_ASSET_ENDED ${c + 1}/${o.assetList.length} ${qm(l)}`),
                        (this.endedAsset = l),
                        (this.playingAsset = null),
                        this.hls.trigger(Au.INTERSTITIAL_ASSET_ENDED, {
                          asset: l,
                          assetListIndex: c,
                          event: o,
                          schedule: i.slice(0),
                          scheduleIndex: e,
                          player: d,
                        }),
                        a !== this.playingItem)
                      )
                        return void (
                          this.itemsMatch(a, this.playingItem) &&
                          !this.playingAsset &&
                          this.advanceAfterAssetEnded(o, this.findItemIndex(this.playingItem), c)
                        );
                      (this.retreiveMediaSource(u, n),
                        !d.media || (null != (h = this.detachedData) && h.mediaSource) || d.detachMedia());
                    }
                    if (
                      !this.eventItemsMatch(a, n) &&
                      ((this.endedItem = a),
                      (this.playingItem = null),
                      this.log(`INTERSTITIAL_ENDED ${o} ${Qm(a)}`),
                      (o.hasPlayed = !0),
                      this.hls.trigger(Au.INTERSTITIAL_ENDED, {
                        event: o,
                        schedule: i.slice(0),
                        scheduleIndex: e,
                      }),
                      o.cue.once)
                    ) {
                      var f;
                      this.updateSchedule();
                      var p = null == (f = this.schedule) ? void 0 : f.items;
                      if (n && p) {
                        var g = this.findItemIndex(n);
                        this.advanceSchedule(g, p, t, a, s);
                      }
                      return;
                    }
                  }
                  this.advanceSchedule(e, i, t, a, s);
                }
              }
              advanceSchedule(e, t, r, i, n) {
                var a = this.schedule;
                if (a) {
                  var s = t[e] || null,
                    o = this.primaryMedia,
                    l = this.playerQueue;
                  if (
                    (l.length &&
                      l.forEach(t => {
                        var r = t.interstitial,
                          i = a.findEventIndex(r.identifier);
                        (i < e || i > e + 1) && this.clearInterstitial(r, s);
                      }),
                    this.isInterstitial(s))
                  ) {
                    this.timelinePos = Math.min(Math.max(this.timelinePos, s.start), s.end);
                    var u = s.event;
                    if (void 0 === r) {
                      var d = zm(u, (r = a.findAssetIndex(u, this.timelinePos)) - 1);
                      if (u.isAssetPastPlayoutLimit(d) || (u.appendInPlace && this.timelinePos === s.end))
                        return void this.advanceAfterAssetEnded(u, e, r);
                      r = d;
                    }
                    var h = this.waitingItem;
                    this.assetsBuffered(s, o) || this.setBufferingItem(s);
                    var c = this.preloadAssets(u, r);
                    if (
                      (this.eventItemsMatch(s, h || i) ||
                        ((this.waitingItem = s),
                        this.log(`INTERSTITIAL_STARTED ${Qm(s)} ${u.appendInPlace ? "append in place" : ""}`),
                        this.hls.trigger(Au.INTERSTITIAL_STARTED, {
                          event: u,
                          schedule: t.slice(0),
                          scheduleIndex: e,
                        })),
                      !u.assetListLoaded)
                    )
                      return void this.log(`Waiting for ASSET-LIST to complete loading ${u}`);
                    if (
                      (u.assetListLoader && (u.assetListLoader.destroy(), (u.assetListLoader = void 0)), !o)
                    )
                      return void this.log(`Waiting for attachMedia to start Interstitial ${u}`);
                    ((this.waitingItem = this.endedItem = null), (this.playingItem = s));
                    var f = u.assetList[r];
                    if (!f) return void this.advanceAfterAssetEnded(u, e, r || 0);
                    if ((c || (c = this.getAssetPlayer(f.identifier)), null === c || c.destroyed)) {
                      var p = u.assetList.length;
                      (this.warn(`asset ${r + 1}/${p} player destroyed ${u}`),
                        (c = this.createAssetPlayer(u, f, r)).loadSource());
                    }
                    if (
                      !this.eventItemsMatch(s, this.bufferingItem) &&
                      u.appendInPlace &&
                      this.isAssetBuffered(f)
                    )
                      return;
                    (this.startAssetPlayer(c, r, t, e, o), this.shouldPlay && Zm(c.media));
                  } else
                    s
                      ? (this.resumePrimary(s, e, i), this.shouldPlay && Zm(this.hls.media))
                      : n &&
                        this.isInterstitial(i) &&
                        ((this.endedItem = null),
                        (this.playingItem = i),
                        i.event.appendInPlace || this.attachPrimary(a.durations.primary, null));
                }
              }
              get playbackDisabled() {
                return !1 === this.hls.config.enableInterstitialPlayback;
              }
              get primaryDetails() {
                var e;
                return null == (e = this.mediaSelection) ? void 0 : e.main.details;
              }
              get primaryLive() {
                var e;
                return !(null == (e = this.primaryDetails) || !e.live);
              }
              resumePrimary(e, t, r) {
                var i, n;
                if (
                  ((this.playingItem = e),
                  (this.playingAsset = this.endedAsset = null),
                  (this.waitingItem = this.endedItem = null),
                  this.bufferedToItem(e),
                  this.log(`resuming ${Qm(e)}`),
                  null == (i = this.detachedData) || !i.mediaSource)
                ) {
                  var a = this.timelinePos;
                  ((a < e.start || a >= e.end) &&
                    ((a = this.getPrimaryResumption(e, t)),
                    this.log(ev("resumePrimary", a)),
                    (this.timelinePos = a)),
                    this.attachPrimary(a, e));
                }
                if (r) {
                  var s = null == (n = this.schedule) ? void 0 : n.items;
                  s &&
                    (this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Qm(e)}`),
                    this.hls.trigger(Au.INTERSTITIALS_PRIMARY_RESUMED, {
                      schedule: s.slice(0),
                      scheduleIndex: t,
                    }),
                    this.checkBuffer());
                }
              }
              getPrimaryResumption(e, t) {
                var r = e.start;
                if (this.primaryLive) {
                  var i = this.primaryDetails;
                  if (0 === t) return this.hls.startPosition;
                  if (i && (r < i.fragmentStart || r > i.edge)) return this.hls.liveSyncPosition || -1;
                }
                return r;
              }
              isAssetBuffered(e) {
                var t = this.getAssetPlayer(e.identifier);
                return null != t && t.hls
                  ? t.hls.bufferedToEnd
                  : fc.bufferInfo(this.primaryMedia, this.timelinePos, 0).end + 1 >=
                      e.timelineStart + (e.duration || 0);
              }
              attachPrimary(e, t, r) {
                (t ? this.setBufferingItem(t) : (this.bufferingItem = this.playingItem),
                  (this.bufferingAsset = null));
                var i = this.primaryMedia;
                if (i) {
                  var n = this.hls;
                  (n.media
                    ? this.checkBuffer()
                    : (this.transferMediaTo(n, i), r && this.startLoadingPrimaryAt(e, r)),
                    r ||
                      (this.log(ev("attachPrimary", e)),
                      (this.timelinePos = e),
                      this.startLoadingPrimaryAt(e, r)));
                }
              }
              startLoadingPrimaryAt(e, t) {
                var r,
                  i = this.hls;
                !i.loadingEnabled ||
                !i.media ||
                Math.abs(
                  ((null == (r = i.mainForwardBufferInfo) ? void 0 : r.start) || i.media.currentTime) - e,
                ) > 0.5
                  ? i.startLoad(e, t)
                  : i.bufferingEnabled || i.resumeBuffering();
              }
              onManifestLoading() {
                var e;
                (this.stopLoad(),
                  null == (e = this.schedule) || e.reset(),
                  this.emptyPlayerQueue(),
                  this.clearScheduleState(),
                  (this.shouldPlay = !1),
                  (this.bufferedPos = this.timelinePos = -1),
                  (this.mediaSelection = this.altSelection = this.manager = this.requiredTracks = null),
                  this.hls.off(Au.BUFFER_CODECS, this.onBufferCodecs, this),
                  this.hls.on(Au.BUFFER_CODECS, this.onBufferCodecs, this));
              }
              onLevelUpdated(e, t) {
                if (-1 !== t.level && this.schedule) {
                  var r = this.hls.levels[t.level];
                  if (r.details) {
                    var i = Uu(Uu({}, this.mediaSelection || this.altSelection), {}, { main: r });
                    ((this.mediaSelection = i),
                      this.schedule.parseInterstitialDateRanges(i, this.hls.config.interstitialAppendInPlace),
                      !this.effectivePlayingItem && this.schedule.items && this.checkStart());
                  }
                }
              }
              onAudioTrackUpdated(e, t) {
                var r = this.hls.audioTracks[t.id],
                  i = this.mediaSelection;
                if (i) {
                  var n = Uu(Uu({}, i), {}, { audio: r });
                  this.mediaSelection = n;
                } else this.altSelection = Uu(Uu({}, this.altSelection), {}, { audio: r });
              }
              onSubtitleTrackUpdated(e, t) {
                var r = this.hls.subtitleTracks[t.id],
                  i = this.mediaSelection;
                if (i) {
                  var n = Uu(Uu({}, i), {}, { subtitles: r });
                  this.mediaSelection = n;
                } else this.altSelection = Uu(Uu({}, this.altSelection), {}, { subtitles: r });
              }
              onAudioTrackSwitching(e, t) {
                var r = vh(t);
                this.playerQueue.forEach(({ hls: e }) => e && (e.setAudioOption(t) || e.setAudioOption(r)));
              }
              onSubtitleTrackSwitch(e, t) {
                var r = vh(t);
                this.playerQueue.forEach(
                  ({ hls: e }) => e && (e.setSubtitleOption(t) || (-1 !== t.id && e.setSubtitleOption(r))),
                );
              }
              onBufferCodecs(e, t) {
                var r = t.tracks;
                r && (this.requiredTracks = r);
              }
              onBufferAppended(e, t) {
                this.checkBuffer();
              }
              onBufferFlushed(e, t) {
                var r = this.playingItem;
                if (r && !this.itemsMatch(r, this.bufferingItem) && !this.isInterstitial(r)) {
                  var i = this.timelinePos;
                  ((this.bufferedPos = i), this.checkBuffer());
                }
              }
              onBufferedToEnd(e) {
                if (this.schedule) {
                  var t = this.schedule.events;
                  if (this.bufferedPos < Number.MAX_VALUE && t) {
                    for (var r = 0; r < t.length; r++) {
                      var i = t[r];
                      if (i.cue.post) {
                        var n,
                          a = this.schedule.findEventIndex(i.identifier),
                          s = null == (n = this.schedule.items) ? void 0 : n[a];
                        this.isInterstitial(s) &&
                          this.eventItemsMatch(s, this.bufferingItem) &&
                          this.bufferedToItem(s, 0);
                        break;
                      }
                    }
                    this.bufferedPos = Number.MAX_VALUE;
                  }
                }
              }
              onMediaEnded(e) {
                var t = this.playingItem;
                if (!this.playingLastItem && t) {
                  var r = this.findItemIndex(t);
                  this.setSchedulePosition(r + 1);
                } else this.shouldPlay = !1;
              }
              updateItem(e, t) {
                var r,
                  i = null == (r = this.schedule) ? void 0 : r.items;
                return (e && i && i[this.findItemIndex(e, t)]) || null;
              }
              trimInPlace(e, t) {
                if (this.isInterstitial(e) && e.event.appendInPlace && t.end - e.end > 0.25) {
                  e.event.assetList.forEach((t, r) => {
                    e.event.isAssetPastPlayoutLimit(r) && this.clearAssetPlayer(t.identifier, null);
                  });
                  var r = e.end + 0.25,
                    i = fc.bufferInfo(this.primaryMedia, r, 0);
                  if (i.end > r || (i.nextStart || 0) > r) {
                    this.log(`trim buffered interstitial ${Qm(e)} (was ${Qm(t)})`);
                    (this.attachPrimary(r, null, !0), this.flushFrontBuffer(r));
                  }
                }
              }
              itemsMatch(e, t) {
                return (
                  !!t &&
                  (e === t ||
                    (e.event && t.event && this.eventItemsMatch(e, t)) ||
                    (!e.event && !t.event && this.findItemIndex(e) === this.findItemIndex(t)))
                );
              }
              eventItemsMatch(e, t) {
                var r;
                return (
                  !!t && (e === t || e.event.identifier === (null == (r = t.event) ? void 0 : r.identifier))
                );
              }
              findItemIndex(e, t) {
                return e && this.schedule ? this.schedule.findItemIndex(e, t) : -1;
              }
              updateSchedule(e = !1) {
                var t,
                  r = this.mediaSelection;
                r && (null == (t = this.schedule) || t.updateSchedule(r, [], e));
              }
              checkBuffer(e) {
                var t,
                  r = null == (t = this.schedule) ? void 0 : t.items;
                if (r) {
                  var i = fc.bufferInfo(this.primaryMedia, this.timelinePos, 0);
                  (e && (this.bufferedPos = this.timelinePos),
                    e || (e = i.len < 1),
                    this.updateBufferedPos(i.end, r, e));
                }
              }
              updateBufferedPos(e, t, r) {
                var i = this.schedule,
                  n = this.bufferingItem;
                if (!(this.bufferedPos > e) && i)
                  if (1 === t.length && this.itemsMatch(t[0], n)) this.bufferedPos = e;
                  else {
                    var a = this.playingItem,
                      s = this.findItemIndex(a),
                      o = i.findItemIndexAtTime(e);
                    if (this.bufferedPos < e) {
                      var l,
                        u = this.findItemIndex(n),
                        d = Math.min(u + 1, t.length - 1),
                        h = t[d];
                      if (
                        (((-1 === o && n && e >= n.end) ||
                          (null != (l = h.event) && l.appendInPlace && e + 0.01 >= h.start)) &&
                          (o = d),
                        this.isInterstitial(n))
                      ) {
                        var c = n.event;
                        if (d - s > 1 && !1 === c.appendInPlace) return;
                        if (0 === c.assetList.length && c.assetListLoader) return;
                      }
                      if (((this.bufferedPos = e), o > u && o > s)) this.bufferedToItem(h);
                      else {
                        var f = this.primaryDetails;
                        this.primaryLive &&
                          f &&
                          e > f.edge - f.targetduration &&
                          h.start < f.edge + this.hls.config.interstitialLiveLookAhead &&
                          this.isInterstitial(h) &&
                          this.preloadAssets(h.event, 0);
                      }
                    } else
                      r &&
                        a &&
                        !this.itemsMatch(a, n) &&
                        (o === s ? this.bufferedToItem(a) : o === s + 1 && this.bufferedToItem(t[o]));
                  }
              }
              assetsBuffered(e, t) {
                return (
                  0 !== e.event.assetList.length &&
                  !e.event.assetList.some(e => {
                    var r = this.getAssetPlayer(e.identifier);
                    return !(null != r && r.bufferedInPlaceToEnd(t));
                  })
                );
              }
              setBufferingItem(e) {
                var t = this.bufferingItem,
                  r = this.schedule;
                if (!this.itemsMatch(e, t) && r) {
                  var i = r.items,
                    n = r.events;
                  if (!i || !n) return t;
                  var a = this.isInterstitial(e),
                    s = this.getBufferingPlayer();
                  ((this.bufferingItem = e),
                    (this.bufferedPos = Math.max(e.start, Math.min(e.end, this.timelinePos))));
                  var o = s ? s.remaining : t ? t.end - this.timelinePos : 0;
                  if (
                    (this.log(
                      `INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Qm(e)}` +
                        (t ? ` (${o.toFixed(2)} remaining)` : ""),
                    ),
                    !this.playbackDisabled)
                  )
                    if (a) {
                      var l = r.findAssetIndex(e.event, this.bufferedPos);
                      e.event.assetList.forEach((e, t) => {
                        var r = this.getAssetPlayer(e.identifier);
                        r && (t === l && r.loadSource(), r.resumeBuffering());
                      });
                    } else (this.hls.resumeBuffering(), this.playerQueue.forEach(e => e.pauseBuffering()));
                  this.hls.trigger(Au.INTERSTITIALS_BUFFERED_TO_BOUNDARY, {
                    events: n.slice(0),
                    schedule: i.slice(0),
                    bufferingIndex: this.findItemIndex(e),
                    playingIndex: this.findItemIndex(this.playingItem),
                  });
                } else this.bufferingItem !== e && (this.bufferingItem = e);
                return t;
              }
              bufferedToItem(e, t = 0) {
                var r = this.setBufferingItem(e);
                if (!this.playbackDisabled)
                  if (this.isInterstitial(e)) this.bufferedToEvent(e, t);
                  else if (null !== r) {
                    this.bufferingAsset = null;
                    var i = this.detachedData;
                    if (i)
                      if (i.mediaSource) {
                        this.attachPrimary(e.start, e, !0);
                      } else this.preloadPrimary(e);
                    else this.preloadPrimary(e);
                  }
              }
              preloadPrimary(e) {
                var t = this.findItemIndex(e),
                  r = this.getPrimaryResumption(e, t);
                this.startLoadingPrimaryAt(r);
              }
              bufferedToEvent(e, t) {
                var r = e.event,
                  i = 0 === r.assetList.length && !r.assetListLoader,
                  n = r.cue.once;
                if (i || !n) {
                  var a = this.preloadAssets(r, t);
                  if (null != a && a.interstitial.appendInPlace) {
                    var s = this.primaryMedia;
                    s && this.bufferAssetPlayer(a, s);
                  }
                }
              }
              preloadAssets(e, t) {
                var r = e.assetUrl,
                  i = e.assetList.length,
                  n = 0 === i && !e.assetListLoader,
                  a = e.cue.once;
                if (n) {
                  var s,
                    o = e.timelineStart;
                  if (e.appendInPlace) {
                    var l,
                      u = this.playingItem;
                    this.isInterstitial(u) ||
                      (null == u || null == (l = u.nextEvent) ? void 0 : l.identifier) !== e.identifier ||
                      this.flushFrontBuffer(o + 0.25);
                  }
                  var d = 0;
                  if (
                    (!this.playingItem &&
                      this.primaryLive &&
                      -1 === (d = this.hls.startPosition) &&
                      (d = this.hls.liveSyncPosition || 0),
                    d && !e.cue.pre && !e.cue.post)
                  ) {
                    var h = d - o;
                    h > 0 && (s = Math.round(1e3 * h) / 1e3);
                  }
                  if (
                    (this.log(
                      `Load interstitial asset ${t + 1}/${r ? 1 : i} ${e}${s ? ` live-start: ${d} start-offset: ${s}` : ""}`,
                    ),
                    r)
                  )
                    return this.createAsset(e, 0, 0, o, e.duration, r);
                  var c = this.assetListLoader.loadAssetList(e, s);
                  c && (e.assetListLoader = c);
                } else if (!a && i) {
                  for (var f = t; f < i; f++) {
                    var p = e.assetList[f],
                      g = this.getAssetPlayerQueueIndex(p.identifier);
                    (-1 !== g && !this.playerQueue[g].destroyed) ||
                      p.error ||
                      this.createAssetPlayer(e, p, f);
                  }
                  var m = e.assetList[t];
                  if (m) {
                    var v = this.getAssetPlayer(m.identifier);
                    return (v && v.loadSource(), v);
                  }
                }
                return null;
              }
              flushFrontBuffer(e) {
                var t = this.requiredTracks;
                t &&
                  (this.log(`Removing front buffer starting at ${e}`),
                  Object.keys(t).forEach(t => {
                    this.hls.trigger(Au.BUFFER_FLUSHING, { startOffset: e, endOffset: 1 / 0, type: t });
                  }));
              }
              getAssetPlayerQueueIndex(e) {
                for (var t = this.playerQueue, r = 0; r < t.length; r++) if (e === t[r].assetId) return r;
                return -1;
              }
              getAssetPlayer(e) {
                var t = this.getAssetPlayerQueueIndex(e);
                return this.playerQueue[t] || null;
              }
              getBufferingPlayer() {
                var e = this.playerQueue,
                  t = this.primaryMedia;
                if (t) for (var r = 0; r < e.length; r++) if (e[r].media === t) return e[r];
                return null;
              }
              createAsset(e, t, r, i, n, a) {
                var s = {
                  parentIdentifier: e.identifier,
                  identifier: Vm(e, a, t),
                  duration: n,
                  startOffset: r,
                  timelineStart: i,
                  uri: a,
                };
                return this.createAssetPlayer(e, s, t);
              }
              createAssetPlayer(e, t, r) {
                var i = this.hls,
                  n = i.userConfig,
                  a = n.videoPreference,
                  s = i.loadLevelObj || i.levels[i.currentLevel];
                (a || s) &&
                  ((a = Nu({}, a)),
                  s.videoCodec && (a.videoCodec = s.videoCodec),
                  s.videoRange && (a.allowedVideoRanges = [s.videoRange]));
                var o = i.audioTracks[i.audioTrack],
                  l = i.subtitleTracks[i.subtitleTrack],
                  u = 0;
                if (this.primaryLive || e.appendInPlace) {
                  var d = this.timelinePos - t.timelineStart;
                  if (d > 1) {
                    var h = t.duration;
                    h && d < h && (u = d);
                  }
                }
                var c = t.identifier,
                  f = Uu(
                    Uu({}, n),
                    {},
                    {
                      maxMaxBufferLength: Math.min(180, i.config.maxMaxBufferLength),
                      autoStartLoad: !0,
                      startFragPrefetch: !0,
                      primarySessionId: i.sessionId,
                      assetPlayerId: c,
                      abrEwmaDefaultEstimate: i.bandwidthEstimate,
                      interstitialsController: void 0,
                      startPosition: u,
                      liveDurationInfinity: !1,
                      testBandwidth: !1,
                      videoPreference: a,
                      audioPreference: o || n.audioPreference,
                      subtitlePreference: l || n.subtitlePreference,
                    },
                  );
                e.appendInPlace &&
                  ((e.appendInPlaceStarted = !0), t.timelineStart && (f.timelineOffset = t.timelineStart));
                var p = f.cmcd;
                (null != p && p.sessionId && p.contentId && (f.cmcd = Nu({}, p, { contentId: $m(t.uri) })),
                  this.getAssetPlayer(c) && this.warn(`Duplicate date range identifier ${e} and asset ${c}`));
                var g = new Xm(this.HlsPlayerClass, f, e, t);
                (this.playerQueue.push(g), (e.assetList[r] = t));
                var m = !0,
                  v = i => {
                    if (i.live) {
                      var n,
                        a = new Error(`Interstitials MUST be VOD assets ${e}`),
                        s = {
                          fatal: !0,
                          type: xu.OTHER_ERROR,
                          details: wu.INTERSTITIAL_ASSET_ITEM_ERROR,
                          error: a,
                        },
                        o = (null == (n = this.schedule) ? void 0 : n.findEventIndex(e.identifier)) || -1;
                      this.handleAssetItemError(s, e, o, r, a.message);
                    } else {
                      var l = i.edge - i.fragmentStart,
                        u = t.duration;
                      (m || null === u || l > u) &&
                        ((m = !1),
                        this.log(`Interstitial asset "${c}" duration change ${u} > ${l}`),
                        (t.duration = l),
                        this.updateSchedule());
                    }
                  };
                (g.on(Au.LEVEL_UPDATED, (e, { details: t }) => v(t)),
                  g.on(Au.LEVEL_PTS_UPDATED, (e, { details: t }) => v(t)),
                  g.on(Au.EVENT_CUE_ENTER, () => this.onInterstitialCueEnter()));
                var y = (e, t) => {
                  var r = this.getAssetPlayer(c);
                  if (r && t.tracks) {
                    (r.off(Au.BUFFER_CODECS, y), (r.tracks = t.tracks));
                    var i = this.primaryMedia;
                    this.bufferingAsset === r.assetItem && i && !r.media && this.bufferAssetPlayer(r, i);
                  }
                };
                g.on(Au.BUFFER_CODECS, y);
                g.on(Au.BUFFERED_TO_END, () => {
                  var r,
                    i = this.getAssetPlayer(c);
                  if ((this.log(`buffered to end of asset ${i}`), i && this.schedule)) {
                    var n = this.schedule.findEventIndex(e.identifier),
                      a = null == (r = this.schedule.items) ? void 0 : r[n];
                    this.isInterstitial(a) && this.advanceAssetBuffering(a, t);
                  }
                });
                var T = t => () => {
                  if (this.getAssetPlayer(c) && this.schedule) {
                    this.shouldPlay = !0;
                    var r = this.schedule.findEventIndex(e.identifier);
                    this.advanceAfterAssetEnded(e, r, t);
                  }
                };
                return (
                  g.once(Au.MEDIA_ENDED, T(r)),
                  g.once(Au.PLAYOUT_LIMIT_REACHED, T(1 / 0)),
                  g.on(Au.ERROR, (t, i) => {
                    if (this.schedule) {
                      var n = this.getAssetPlayer(c);
                      if (i.details === wu.BUFFER_STALLED_ERROR)
                        return null != n && n.appendInPlace
                          ? void this.handleInPlaceStall(e)
                          : (this.onTimeupdate(), void this.checkBuffer(!0));
                      this.handleAssetItemError(
                        i,
                        e,
                        this.schedule.findEventIndex(e.identifier),
                        r,
                        `Asset player error ${i.error} ${e}`,
                      );
                    }
                  }),
                  g.on(Au.DESTROYING, () => {
                    if (this.getAssetPlayer(c) && this.schedule) {
                      var t = new Error(`Asset player destroyed unexpectedly ${c}`),
                        i = {
                          fatal: !0,
                          type: xu.OTHER_ERROR,
                          details: wu.INTERSTITIAL_ASSET_ITEM_ERROR,
                          error: t,
                        };
                      this.handleAssetItemError(
                        i,
                        e,
                        this.schedule.findEventIndex(e.identifier),
                        r,
                        t.message,
                      );
                    }
                  }),
                  this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${qm(t)}`),
                  this.hls.trigger(Au.INTERSTITIAL_ASSET_PLAYER_CREATED, {
                    asset: t,
                    assetListIndex: r,
                    event: e,
                    player: g,
                  }),
                  g
                );
              }
              clearInterstitial(e, t) {
                (this.clearAssetPlayers(e, t), e.reset());
              }
              clearAssetPlayers(e, t) {
                e.assetList.forEach(e => {
                  this.clearAssetPlayer(e.identifier, t);
                });
              }
              resetAssetPlayer(e) {
                var t = this.getAssetPlayerQueueIndex(e);
                if (-1 !== t) {
                  this.log(`reset asset player "${e}" after error`);
                  var r = this.playerQueue[t];
                  (this.transferMediaFromPlayer(r, null), r.resetDetails());
                }
              }
              clearAssetPlayer(e, t) {
                var r = this.getAssetPlayerQueueIndex(e);
                if (-1 !== r) {
                  var i = this.playerQueue[r];
                  (this.log(`clear ${i} toSegment: ${t ? Qm(t) : t}`),
                    this.transferMediaFromPlayer(i, t),
                    this.playerQueue.splice(r, 1),
                    i.destroy());
                }
              }
              emptyPlayerQueue() {
                for (var e; (e = this.playerQueue.pop()); ) e.destroy();
                this.playerQueue = [];
              }
              startAssetPlayer(e, t, r, i, n) {
                var a = e.interstitial,
                  s = e.assetItem,
                  o = e.assetId,
                  l = a.assetList.length,
                  u = this.playingAsset;
                ((this.endedAsset = null),
                  (this.playingAsset = s),
                  (u && u.identifier === o) ||
                    (u && (this.clearAssetPlayer(u.identifier, r[i]), delete u.error),
                    this.log(`INTERSTITIAL_ASSET_STARTED ${t + 1}/${l} ${qm(s)}`),
                    this.hls.trigger(Au.INTERSTITIAL_ASSET_STARTED, {
                      asset: s,
                      assetListIndex: t,
                      event: a,
                      schedule: r.slice(0),
                      scheduleIndex: i,
                      player: e,
                    })),
                  this.bufferAssetPlayer(e, n));
              }
              bufferAssetPlayer(e, t) {
                var r, i;
                if (this.schedule) {
                  var n = e.interstitial,
                    a = e.assetItem,
                    s = this.schedule.findEventIndex(n.identifier),
                    o = null == (r = this.schedule.items) ? void 0 : r[s];
                  if (o) {
                    (e.loadSource(), this.setBufferingItem(o), (this.bufferingAsset = a));
                    var l = this.getBufferingPlayer();
                    if (l !== e) {
                      var u = n.appendInPlace;
                      if (!u || !1 !== (null == l ? void 0 : l.interstitial.appendInPlace)) {
                        var d =
                          (null == l ? void 0 : l.tracks) ||
                          (null == (i = this.detachedData) ? void 0 : i.tracks) ||
                          this.requiredTracks;
                        if (u && a !== this.playingAsset) {
                          if (!e.tracks) return void this.log(`Waiting for track info before buffering ${e}`);
                          if (d && !zu(d, e.tracks)) {
                            var h = new Error(
                                `Asset ${qm(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`,
                              ),
                              c = {
                                fatal: !0,
                                type: xu.OTHER_ERROR,
                                details: wu.INTERSTITIAL_ASSET_ITEM_ERROR,
                                error: h,
                              },
                              f = n.findAssetIndex(a);
                            return void this.handleAssetItemError(c, n, s, f, h.message);
                          }
                        }
                        this.transferMediaTo(e, t);
                      }
                    }
                  }
                }
              }
              handleInPlaceStall(e) {
                var t = this.schedule,
                  r = this.primaryMedia;
                if (t && r) {
                  var i = r.currentTime,
                    n = t.findAssetIndex(e, i),
                    a = e.assetList[n];
                  if (a) {
                    var s = this.getAssetPlayer(a.identifier);
                    if (s) {
                      var o = s.currentTime || i - a.timelineStart,
                        l = s.duration - o;
                      if (
                        (this.warn(`Stalled at ${o} of ${o + l} in ${s} ${e} (media.currentTime: ${i})`),
                        o && (l / r.playbackRate < 0.5 || s.bufferedInPlaceToEnd(r)) && s.hls)
                      ) {
                        var u = t.findEventIndex(e.identifier);
                        this.advanceAfterAssetEnded(e, u, n);
                      }
                    }
                  }
                }
              }
              advanceInPlace(e) {
                var t = this.primaryMedia;
                t && t.currentTime < e && (t.currentTime = e);
              }
              handleAssetItemError(e, t, r, i, n) {
                if (e.details !== wu.BUFFER_STALLED_ERROR) {
                  var a = t.assetList[i] || null;
                  if ((this.warn(`INTERSTITIAL_ASSET_ERROR ${a ? qm(a) : a} ${e.error}`), this.schedule)) {
                    var s = (null == a ? void 0 : a.identifier) || "",
                      o = this.getAssetPlayerQueueIndex(s),
                      l = this.playerQueue[o] || null,
                      u = this.schedule.items,
                      d = Nu({}, e, {
                        fatal: !1,
                        errorAction: Hh(!0),
                        asset: a,
                        assetListIndex: i,
                        event: t,
                        schedule: u,
                        scheduleIndex: r,
                        player: l,
                      });
                    if ((this.hls.trigger(Au.INTERSTITIAL_ASSET_ERROR, d), e.fatal)) {
                      var h = this.playingAsset,
                        c = this.bufferingAsset,
                        f = new Error(n);
                      if (
                        (a && (this.clearAssetPlayer(s, null), (a.error = f)),
                        t.assetList.some(e => !e.error))
                      )
                        for (var p = i; p < t.assetList.length; p++)
                          this.resetAssetPlayer(t.assetList[p].identifier);
                      else t.error = f;
                      (this.updateSchedule(!0),
                        t.error
                          ? this.primaryFallback(t)
                          : h && h.identifier === s
                            ? this.advanceAfterAssetEnded(t, r, i)
                            : c &&
                              c.identifier === s &&
                              this.isInterstitial(this.bufferingItem) &&
                              this.advanceAssetBuffering(this.bufferingItem, c));
                    }
                  }
                }
              }
              primaryFallback(e) {
                var t = e.timelineStart,
                  r = this.effectivePlayingItem,
                  i = this.timelinePos;
                if (r) {
                  (this.log(
                    `Fallback to primary from event "${e.identifier}" start: ${t} pos: ${i} playing: ${Qm(r)} error: ${e.error}`,
                  ),
                    -1 === i && (i = this.hls.startPosition));
                  var n = this.updateItem(r, i);
                  (this.itemsMatch(r, n) && this.clearInterstitial(e, null),
                    e.appendInPlace && (this.attachPrimary(t, null), this.flushFrontBuffer(t)));
                } else if (-1 === i) return void this.checkStart();
                if (this.schedule) {
                  var a = this.schedule.findItemIndexAtTime(i);
                  this.setSchedulePosition(a);
                }
              }
              onAssetListLoaded(e, t) {
                var r,
                  i,
                  n = t.event,
                  a = n.identifier,
                  s = t.assetListResponse.ASSETS;
                if (null != (r = this.schedule) && r.hasEvent(a)) {
                  var o = n.timelineStart,
                    l = n.duration,
                    u = 0;
                  (s.forEach((e, t) => {
                    var r = parseFloat(e.DURATION);
                    (this.createAsset(n, t, u, o + u, r, e.URI), (u += r));
                  }),
                    (n.duration = u),
                    this.log(`Loaded asset-list with duration: ${u} (was: ${l}) ${n}`));
                  var d = this.waitingItem,
                    h = (null == d ? void 0 : d.event.identifier) === a;
                  this.updateSchedule();
                  var c = null == (i = this.bufferingItem) ? void 0 : i.event;
                  if (h) {
                    var f,
                      p = this.schedule.findEventIndex(a),
                      g = null == (f = this.schedule.items) ? void 0 : f[p];
                    if (g) {
                      if (!this.playingItem && this.timelinePos > g.end)
                        if (this.schedule.findItemIndexAtTime(this.timelinePos) !== p)
                          return (
                            (n.error = new Error(
                              `Interstitial ${s.length ? "no longer within playback range" : "asset-list is empty"} ${this.timelinePos} ${n}`,
                            )),
                            this.log(n.error.message),
                            this.updateSchedule(!0),
                            void this.primaryFallback(n)
                          );
                      this.setBufferingItem(g);
                    }
                    this.setSchedulePosition(p);
                  } else if ((null == c ? void 0 : c.identifier) === a) {
                    var m = n.assetList[0];
                    if (m) {
                      var v = this.getAssetPlayer(m.identifier);
                      if (c.appendInPlace) {
                        var y = this.primaryMedia;
                        v && y && this.bufferAssetPlayer(v, y);
                      } else v && v.loadSource();
                    }
                  }
                }
              }
              onError(e, t) {
                if (this.schedule)
                  switch (t.details) {
                    case wu.ASSET_LIST_PARSING_ERROR:
                    case wu.ASSET_LIST_LOAD_ERROR:
                    case wu.ASSET_LIST_LOAD_TIMEOUT:
                      var r = t.interstitial;
                      r && (this.updateSchedule(!0), this.primaryFallback(r));
                      break;
                    case wu.BUFFER_STALLED_ERROR:
                      var i = this.endedItem || this.waitingItem || this.playingItem;
                      if (this.isInterstitial(i) && i.event.appendInPlace)
                        return void this.handleInPlaceStall(i.event);
                      (this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),
                        this.onTimeupdate(),
                        this.checkBuffer(!0));
                  }
              }
            },
          },
        );
        function ny(e) {
          return e && "object" == typeof e
            ? Array.isArray(e)
              ? e.map(ny)
              : Object.keys(e).reduce((t, r) => ((t[r] = ny(e[r])), t), {})
            : e;
        }
        function ay(e, t) {
          var r = e.loader;
          r !== Jv && r !== ry
            ? (t.log("[config]: Custom loader detected, cannot enable progressive streaming"),
              (e.progressive = !1))
            : (function () {
                if (self.fetch && self.AbortController && self.ReadableStream && self.Request)
                  try {
                    return (new self.ReadableStream({}), !0);
                  } catch (e) {}
                return !1;
              })() &&
              ((e.loader = Jv),
              (e.progressive = !0),
              (e.enableSoftwareAES = !0),
              t.log("[config]: Progressive streaming enabled, using FetchLoader"));
        }
        class sy extends dc {
          constructor(e, t) {
            (super("gap-controller", e.logger),
              (this.hls = void 0),
              (this.fragmentTracker = void 0),
              (this.media = null),
              (this.mediaSource = void 0),
              (this.nudgeRetry = 0),
              (this.stallReported = !1),
              (this.stalled = null),
              (this.moved = !1),
              (this.seeking = !1),
              (this.buffered = {}),
              (this.lastCurrentTime = 0),
              (this.ended = 0),
              (this.waiting = 0),
              (this.onMediaPlaying = () => {
                ((this.ended = 0), (this.waiting = 0));
              }),
              (this.onMediaWaiting = () => {
                var e;
                (null != (e = this.media) && e.seeking) ||
                  ((this.waiting = self.performance.now()), this.tick());
              }),
              (this.onMediaEnded = () => {
                var e;
                this.hls &&
                  ((this.ended = (null == (e = this.media) ? void 0 : e.currentTime) || 1),
                  this.hls.trigger(Au.MEDIA_ENDED, { stalled: !1 }));
              }),
              (this.hls = e),
              (this.fragmentTracker = t),
              this.registerListeners());
          }
          registerListeners() {
            var e = this.hls;
            e &&
              (e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.on(Au.BUFFER_APPENDED, this.onBufferAppended, this));
          }
          unregisterListeners() {
            var e = this.hls;
            e &&
              (e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.off(Au.BUFFER_APPENDED, this.onBufferAppended, this));
          }
          destroy() {
            (super.destroy(),
              this.unregisterListeners(),
              (this.media = this.hls = this.fragmentTracker = null),
              (this.mediaSource = void 0));
          }
          onMediaAttached(e, t) {
            (this.setInterval(100), (this.mediaSource = t.mediaSource));
            var r = (this.media = t.media);
            (Mf(r, "playing", this.onMediaPlaying),
              Mf(r, "waiting", this.onMediaWaiting),
              Mf(r, "ended", this.onMediaEnded));
          }
          onMediaDetaching(e, t) {
            this.clearInterval();
            var r = this.media;
            (r &&
              (Df(r, "playing", this.onMediaPlaying),
              Df(r, "waiting", this.onMediaWaiting),
              Df(r, "ended", this.onMediaEnded),
              (this.media = null)),
              (this.mediaSource = void 0));
          }
          onBufferAppended(e, t) {
            this.buffered = t.timeRanges;
          }
          get hasBuffered() {
            return Object.keys(this.buffered).length > 0;
          }
          tick() {
            var e;
            if (null != (e = this.media) && e.readyState && this.hasBuffered) {
              var t = this.media.currentTime;
              (this.poll(t, this.lastCurrentTime), (this.lastCurrentTime = t));
            }
          }
          poll(e, t) {
            var r,
              i,
              n = null == (r = this.hls) ? void 0 : r.config;
            if (n) {
              var a = this.media;
              if (a) {
                var s = a.seeking,
                  o = this.seeking && !s,
                  l = !this.seeking && s,
                  u = (a.paused && !s) || a.ended || 0 === a.playbackRate;
                if (((this.seeking = s), e !== t))
                  return (
                    t && (this.ended = 0),
                    (this.moved = !0),
                    s ||
                      ((this.nudgeRetry = 0),
                      n.nudgeOnVideoHole && !u && e > t && this.nudgeOnVideoHole(e, t)),
                    void (0 === this.waiting && this.stallResolved(e))
                  );
                if (l || o) o && this.stallResolved(e);
                else {
                  if (u)
                    return (
                      (this.nudgeRetry = 0),
                      this.stallResolved(e),
                      void (
                        !this.ended &&
                        a.ended &&
                        this.hls &&
                        ((this.ended = e || 1), this.hls.trigger(Au.MEDIA_ENDED, { stalled: !1 }))
                      )
                    );
                  if (fc.getBuffered(a).length) {
                    var d = fc.bufferInfo(a, e, 0),
                      h = d.nextStart || 0,
                      c = this.fragmentTracker;
                    if (s && c && this.hls) {
                      var f = oy(this.hls.inFlightFragments, e),
                        p = d.len > 2,
                        g = !h || f || (h - e > 2 && !c.getPartialFragment(e));
                      if (p || g) return;
                      this.moved = !1;
                    }
                    var m = null == (i = this.hls) ? void 0 : i.latestLevelDetails;
                    if (!this.moved && null !== this.stalled && c) {
                      if (!(d.len > 0) && !h) return;
                      var v = Math.max(h, d.start || 0) - e,
                        y = !(null == m || !m.live) ? 2 * m.targetduration : 2,
                        T = uy(e, c);
                      if (v > 0 && (v <= y || T)) return void (a.paused || this._trySkipBufferHole(T));
                    }
                    var b = n.detectStallWithCurrentTimeMs,
                      S = self.performance.now(),
                      E = this.waiting,
                      x = this.stalled;
                    if (null === x) {
                      if (!(E > 0 && S - E < b)) return void (this.stalled = S);
                      x = this.stalled = E;
                    }
                    var w = S - x;
                    if (!s && (w >= b || E) && this.hls) {
                      var A;
                      if (
                        "ended" === (null == (A = this.mediaSource) ? void 0 : A.readyState) &&
                        (null == m || !m.live) &&
                        Math.abs(e - ((null == m ? void 0 : m.edge) || 0)) < 1
                      ) {
                        if (this.ended) return;
                        return (
                          (this.ended = e || 1),
                          void this.hls.trigger(Au.MEDIA_ENDED, { stalled: !0 })
                        );
                      }
                      if ((this._reportStall(d), !this.media || !this.hls)) return;
                    }
                    var I = fc.bufferInfo(a, e, n.maxBufferHole);
                    this._tryFixBufferStall(I, w, e);
                  } else this.nudgeRetry = 0;
                }
              }
            }
          }
          stallResolved(e) {
            var t = this.stalled;
            if (t && this.hls && ((this.stalled = null), this.stallReported)) {
              var r = self.performance.now() - t;
              (this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),
                (this.stallReported = !1),
                (this.waiting = 0),
                this.hls.trigger(Au.STALL_RESOLVED, {}));
            }
          }
          nudgeOnVideoHole(e, t) {
            var r,
              i = this.buffered.video;
            if (
              this.hls &&
              this.media &&
              this.fragmentTracker &&
              null != (r = this.buffered.audio) &&
              r.length &&
              i &&
              i.length > 1 &&
              e > i.end(0)
            ) {
              var n = fc.bufferedInfo(fc.timeRangesToArray(this.buffered.audio), e, 0);
              if (n.len > 1 && t >= n.start) {
                var a = fc.timeRangesToArray(i),
                  s = fc.bufferedInfo(a, t, 0).bufferedIndex;
                if (s > -1 && s < a.length - 1) {
                  var o = fc.bufferedInfo(a, e, 0).bufferedIndex,
                    l = a[s].end,
                    u = a[s + 1].start;
                  if ((-1 === o || o > s) && u - l < 1 && e - l < 2) {
                    var d = new Error(
                      `nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${l} -> ${u} buffered index: ${o}`,
                    );
                    (this.warn(d.message), (this.media.currentTime += 1e-6));
                    var h = uy(e, this.fragmentTracker);
                    h && "fragment" in h ? (h = h.fragment) : h || (h = void 0);
                    var c = fc.bufferInfo(this.media, e, 0);
                    this.hls.trigger(Au.ERROR, {
                      type: xu.MEDIA_ERROR,
                      details: wu.BUFFER_SEEK_OVER_HOLE,
                      fatal: !1,
                      error: d,
                      reason: d.message,
                      frag: h,
                      buffer: c.len,
                      bufferInfo: c,
                    });
                  }
                }
              }
            }
          }
          _tryFixBufferStall(e, t, r) {
            var i,
              n,
              a = this.fragmentTracker,
              s = this.media,
              o = null == (i = this.hls) ? void 0 : i.config;
            if (s && a && o) {
              var l = null == (n = this.hls) ? void 0 : n.latestLevelDetails,
                u = uy(r, a);
              if (u || (null != l && l.live && r < l.fragmentStart))
                if (this._trySkipBufferHole(u) || !this.media) return;
              var d = e.buffered,
                h = this.adjacentTraversal(e, r);
              ((d && d.length > 1 && e.len > o.maxBufferHole) ||
                (e.nextStart && (e.nextStart - r < o.maxBufferHole || h))) &&
                (t > 1e3 * o.highBufferWatchdogPeriod || this.waiting) &&
                (this.warn("Trying to nudge playhead over buffer-hole"), this._tryNudgeBuffer(e));
            }
          }
          adjacentTraversal(e, t) {
            var r = this.fragmentTracker,
              i = e.nextStart;
            if (r && i) {
              var n = r.getFragAtPos(t, Lu),
                a = r.getFragAtPos(i, Lu);
              if (n && a) return a.sn - n.sn < 2;
            }
            return !1;
          }
          _reportStall(e) {
            var t = this.hls,
              r = this.media,
              i = this.stallReported,
              n = this.stalled;
            if (!i && null !== n && r && t) {
              this.stallReported = !0;
              var a = new Error(`Playback stalling at @${r.currentTime} due to low buffer (${ph(e)})`);
              (this.warn(a.message),
                t.trigger(Au.ERROR, {
                  type: xu.MEDIA_ERROR,
                  details: wu.BUFFER_STALLED_ERROR,
                  fatal: !1,
                  error: a,
                  buffer: e.len,
                  bufferInfo: e,
                  stalled: { start: n },
                }));
            }
          }
          _trySkipBufferHole(e) {
            var t,
              r = this.fragmentTracker,
              i = this.media,
              n = null == (t = this.hls) ? void 0 : t.config;
            if (!i || !r || !n) return 0;
            var a = i.currentTime,
              s = fc.bufferInfo(i, a, 0),
              o = a < s.start ? s.start : s.nextStart;
            if (o && this.hls) {
              var l = s.len <= n.maxBufferHole,
                u = s.len > 0 && s.len < 1 && i.readyState < 3,
                d = o - a;
              if (d > 0 && (l || u)) {
                if (d > n.maxBufferHole) {
                  var h = !1;
                  if (0 === a) {
                    var c = r.getAppendedFrag(0, Lu);
                    c && o < c.end && (h = !0);
                  }
                  if (!h && e) {
                    var f;
                    if (null == (f = this.hls.loadLevelObj) || !f.details) return 0;
                    if (oy(this.hls.inFlightFragments, o)) return 0;
                    for (var p = !1, g = e.end; g < o; ) {
                      var m = uy(g, r);
                      if (!m) {
                        p = !0;
                        break;
                      }
                      g += m.duration;
                    }
                    if (p) return 0;
                  }
                }
                var v = Math.max(o + 0.05, a + 0.1);
                if (
                  (this.warn(`skipping hole, adjusting currentTime from ${a} to ${v}`),
                  (this.moved = !0),
                  (i.currentTime = v),
                  null == e || !e.gap)
                ) {
                  var y = new Error(`fragment loaded with buffer holes, seeking from ${a} to ${v}`),
                    T = {
                      type: xu.MEDIA_ERROR,
                      details: wu.BUFFER_SEEK_OVER_HOLE,
                      fatal: !1,
                      error: y,
                      reason: y.message,
                      buffer: s.len,
                      bufferInfo: s,
                    };
                  (e && ("fragment" in e ? (T.part = e) : (T.frag = e)), this.hls.trigger(Au.ERROR, T));
                }
                return v;
              }
            }
            return 0;
          }
          _tryNudgeBuffer(e) {
            var t = this.hls,
              r = this.media,
              i = this.nudgeRetry,
              n = null == t ? void 0 : t.config;
            if (!r || !n) return 0;
            var a = r.currentTime;
            if ((this.nudgeRetry++, i < n.nudgeMaxRetry)) {
              var s = a + (i + 1) * n.nudgeOffset,
                o = new Error(`Nudging 'currentTime' from ${a} to ${s}`);
              (this.warn(o.message),
                (r.currentTime = s),
                t.trigger(Au.ERROR, {
                  type: xu.MEDIA_ERROR,
                  details: wu.BUFFER_NUDGE_ON_STALL,
                  error: o,
                  fatal: !1,
                  buffer: e.len,
                  bufferInfo: e,
                }));
            } else {
              var l = new Error(
                `Playhead still not moving while enough data buffered @${a} after ${n.nudgeMaxRetry} nudges`,
              );
              (this.error(l.message),
                t.trigger(Au.ERROR, {
                  type: xu.MEDIA_ERROR,
                  details: wu.BUFFER_STALLED_ERROR,
                  error: l,
                  fatal: !0,
                  buffer: e.len,
                  bufferInfo: e,
                }));
            }
          }
        }
        function oy(e, t) {
          var r = ly(e.main);
          if (r && r.start <= t) return r;
          var i = ly(e.audio);
          return i && i.start <= t ? i : null;
        }
        function ly(e) {
          if (!e) return null;
          switch (e.state) {
            case Of:
            case Pf:
            case Gf:
            case Vf:
              return null;
          }
          return e.frag;
        }
        function uy(e, t) {
          return t.getAppendedFrag(e, Lu) || t.getPartialFragment(e);
        }
        function dy() {
          if ("undefined" != typeof self) return self.VTTCue || self.TextTrackCue;
        }
        function hy(e, t, r, i, n) {
          var a = new e(t, r, "");
          try {
            ((a.value = i), n && (a.type = n));
          } catch (s) {
            a = new e(t, r, ph(n ? Uu({ type: n }, i) : i));
          }
          return a;
        }
        var cy = (() => {
          var e = dy();
          try {
            e && new e(0, Number.POSITIVE_INFINITY, "");
          } catch (t) {
            return Number.MAX_VALUE;
          }
          return Number.POSITIVE_INFINITY;
        })();
        class fy {
          constructor(e) {
            ((this.hls = void 0),
              (this.id3Track = null),
              (this.media = null),
              (this.dateRangeCuesAppended = {}),
              (this.removeCues = !0),
              (this.assetCue = void 0),
              (this.onEventCueEnter = () => {
                this.hls && this.hls.trigger(Au.EVENT_CUE_ENTER, {});
              }),
              (this.hls = e),
              this._registerListeners());
          }
          destroy() {
            (this._unregisterListeners(),
              (this.id3Track = null),
              (this.media = null),
              (this.dateRangeCuesAppended = {}),
              (this.hls = this.onEventCueEnter = null));
          }
          _registerListeners() {
            var e = this.hls;
            e &&
              (e.on(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
              e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.on(Au.FRAG_PARSING_METADATA, this.onFragParsingMetadata, this),
              e.on(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
              e.on(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
              e.on(Au.LEVEL_PTS_UPDATED, this.onLevelPtsUpdated, this));
          }
          _unregisterListeners() {
            var e = this.hls;
            e &&
              (e.off(Au.MEDIA_ATTACHING, this.onMediaAttaching, this),
              e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.off(Au.FRAG_PARSING_METADATA, this.onFragParsingMetadata, this),
              e.off(Au.BUFFER_FLUSHING, this.onBufferFlushing, this),
              e.off(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
              e.off(Au.LEVEL_PTS_UPDATED, this.onLevelPtsUpdated, this));
          }
          onMediaAttaching(e, t) {
            var r;
            ((this.media = t.media),
              !1 === (null == (r = t.overrides) ? void 0 : r.cueRemoval) && (this.removeCues = !1));
          }
          onMediaAttached() {
            var e,
              t = null == (e = this.hls) ? void 0 : e.latestLevelDetails;
            t && this.updateDateRangeCues(t);
          }
          onMediaDetaching(e, t) {
            ((this.media = null),
              !!t.transferMedia ||
                (this.id3Track &&
                  (this.removeCues && Fm(this.id3Track, this.onEventCueEnter), (this.id3Track = null)),
                (this.dateRangeCuesAppended = {})));
          }
          onManifestLoading() {
            this.dateRangeCuesAppended = {};
          }
          createTrack(e) {
            var t = this.getID3Track(e.textTracks);
            return ((t.mode = "hidden"), t);
          }
          getID3Track(e) {
            if (this.media) {
              for (var t = 0; t < e.length; t++) {
                var r = e[t];
                if ("metadata" === r.kind && "id3" === r.label) return (Om(r, this.media), r);
              }
              return this.media.addTextTrack("metadata", "id3");
            }
          }
          onFragParsingMetadata(e, t) {
            if (this.media && this.hls) {
              var r = this.hls.config,
                i = r.enableEmsgMetadataCues,
                n = r.enableID3MetadataCues;
              if (i || n) {
                var a = t.samples;
                this.id3Track || (this.id3Track = this.createTrack(this.media));
                var s = dy();
                if (s)
                  for (var o = 0; o < a.length; o++) {
                    var l = a[o].type;
                    if ((l !== Ep.emsg || i) && n) {
                      var u = yp(a[o].data),
                        d = a[o].pts,
                        h = d + a[o].duration;
                      (h > cy && (h = cy), h - d <= 0 && (h = d + 0.25));
                      for (var c = 0; c < u.length; c++) {
                        var f = u[c];
                        if (!Tp(f)) {
                          this.updateId3CueEnds(d, l);
                          var p = hy(s, d, h, f, l);
                          p && this.id3Track.addCue(p);
                        }
                      }
                    }
                  }
              }
            }
          }
          updateId3CueEnds(e, t) {
            var r,
              i = null == (r = this.id3Track) ? void 0 : r.cues;
            if (i)
              for (var n = i.length; n--; ) {
                var a = i[n];
                a.type === t && a.startTime < e && a.endTime === cy && (a.endTime = e);
              }
          }
          onBufferFlushing(e, { startOffset: t, endOffset: r, type: i }) {
            var n = this.id3Track,
              a = this.hls;
            if (a) {
              var s = a.config,
                o = s.enableEmsgMetadataCues,
                l = s.enableID3MetadataCues;
              if (n && (o || l))
                Um(
                  n,
                  t,
                  r,
                  "audio" === i
                    ? e => e.type === Ep.audioId3 && l
                    : "video" === i
                      ? e => e.type === Ep.emsg && o
                      : e => (e.type === Ep.audioId3 && l) || (e.type === Ep.emsg && o),
                );
            }
          }
          onLevelUpdated(e, { details: t }) {
            this.updateDateRangeCues(t, !0);
          }
          onLevelPtsUpdated(e, t) {
            Math.abs(t.drift) > 0.01 && this.updateDateRangeCues(t.details);
          }
          updateDateRangeCues(e, t) {
            var r = this;
            if (this.hls && this.media) {
              var i = this.hls.config,
                n = i.assetPlayerId,
                a = i.timelineOffset,
                s = i.enableDateRangeMetadataCues,
                o = i.interstitialsController;
              if (s) {
                var l = dy();
                if (n && a && !o) {
                  var u = e.fragmentStart,
                    d = e.fragmentEnd,
                    h = this.assetCue;
                  h
                    ? ((h.startTime = u), (h.endTime = d))
                    : l &&
                      (h = this.assetCue =
                        hy(
                          l,
                          u,
                          d,
                          { assetPlayerId: this.hls.config.assetPlayerId },
                          "hlsjs.interstitial.asset",
                        )) &&
                      ((h.id = n),
                      this.id3Track || (this.id3Track = this.createTrack(this.media)),
                      this.id3Track.addCue(h),
                      h.addEventListener("enter", this.onEventCueEnter));
                }
                if (e.hasProgramDateTime) {
                  var c,
                    f = this.id3Track,
                    p = e.dateRanges,
                    g = Object.keys(p),
                    m = this.dateRangeCuesAppended;
                  if (f && t)
                    if (null != (c = f.cues) && c.length)
                      for (
                        var v,
                          y = Object.keys(m).filter(e => !g.includes(e)),
                          T = function () {
                            var e = y[b],
                              t = null == (v = m[e]) ? void 0 : v.cues;
                            (delete m[e],
                              t &&
                                Object.keys(t).forEach(e => {
                                  var i = t[e];
                                  if (i) {
                                    i.removeEventListener("enter", r.onEventCueEnter);
                                    try {
                                      f.removeCue(i);
                                    } catch (n) {}
                                  }
                                }));
                          },
                          b = y.length;
                        b--;
                      )
                        T();
                    else m = this.dateRangeCuesAppended = {};
                  var S = e.fragments[e.fragments.length - 1];
                  if (0 !== g.length && bu(null == S ? void 0 : S.programDateTime)) {
                    this.id3Track || (this.id3Track = this.createTrack(this.media));
                    for (
                      var E = function () {
                          var e = g[x],
                            t = p[e],
                            i = t.startTime,
                            n = m[e],
                            a = (null == n ? void 0 : n.cues) || {},
                            s = (null == n ? void 0 : n.durationKnown) || !1,
                            u = cy,
                            d = t.duration;
                          if (t.endDate && null !== d) ((u = i + d), (s = !0));
                          else if (t.endOnNext && !s) {
                            var h = g.reduce((e, r) => {
                              if (r !== t.id) {
                                var i = p[r];
                                if (
                                  i.class === t.class &&
                                  i.startDate > t.startDate &&
                                  (!e || t.startDate < e.startDate)
                                )
                                  return i;
                              }
                              return e;
                            }, null);
                            h && ((u = h.startTime), (s = !0));
                          }
                          for (var c = Object.keys(t.attr), f = 0; f < c.length; f++) {
                            var v = c[f];
                            if (Ec(v)) {
                              var y = a[v];
                              if (y)
                                !s || (null != n && n.durationKnown)
                                  ? Math.abs(y.startTime - i) > 0.01 && ((y.startTime = i), (y.endTime = u))
                                  : (y.endTime = u);
                              else if (l) {
                                var T = t.attr[v];
                                xc(v) && (T = Yu(T));
                                var b = hy(l, i, u, { key: v, data: T }, Ep.dateRange);
                                b &&
                                  ((b.id = e),
                                  r.id3Track.addCue(b),
                                  (a[v] = b),
                                  o &&
                                    (("X-ASSET-LIST" !== v && "X-ASSET-URL" !== v) ||
                                      b.addEventListener("enter", r.onEventCueEnter)));
                              }
                            }
                          }
                          m[e] = { cues: a, dateRange: t, durationKnown: s };
                        },
                        x = 0;
                      x < g.length;
                      x++
                    )
                      E();
                  }
                }
              }
            }
          }
        }
        class py {
          constructor(e) {
            ((this.hls = void 0),
              (this.config = void 0),
              (this.media = null),
              (this.currentTime = 0),
              (this.stallCount = 0),
              (this._latency = null),
              (this._targetLatencyUpdated = !1),
              (this.onTimeupdate = () => {
                var e = this.media,
                  t = this.levelDetails;
                if (e && t) {
                  this.currentTime = e.currentTime;
                  var r = this.computeLatency();
                  if (null !== r) {
                    this._latency = r;
                    var i = this.config,
                      n = i.lowLatencyMode,
                      a = i.maxLiveSyncPlaybackRate;
                    if (n && 1 !== a && t.live) {
                      var s = this.targetLatency;
                      if (null !== s) {
                        var o = r - s;
                        if (
                          o < Math.min(this.maxLatency, s + t.targetduration) &&
                          o > 0.05 &&
                          this.forwardBufferLength > 1
                        ) {
                          var l = Math.min(2, Math.max(1, a)),
                            u = Math.round((2 / (1 + Math.exp(-0.75 * o - this.edgeStalled))) * 20) / 20,
                            d = Math.min(l, Math.max(1, u));
                          this.changeMediaPlaybackRate(e, d);
                        } else
                          1 !== e.playbackRate && 0 !== e.playbackRate && this.changeMediaPlaybackRate(e, 1);
                      }
                    }
                  }
                }
              }),
              (this.hls = e),
              (this.config = e.config),
              this.registerListeners());
          }
          get levelDetails() {
            var e;
            return (null == (e = this.hls) ? void 0 : e.latestLevelDetails) || null;
          }
          get latency() {
            return this._latency || 0;
          }
          get maxLatency() {
            var e = this.config;
            if (void 0 !== e.liveMaxLatencyDuration) return e.liveMaxLatencyDuration;
            var t = this.levelDetails;
            return t ? e.liveMaxLatencyDurationCount * t.targetduration : 0;
          }
          get targetLatency() {
            var e = this.levelDetails;
            if (null === e || null === this.hls) return null;
            var t = e.holdBack,
              r = e.partHoldBack,
              i = e.targetduration,
              n = this.config,
              a = n.liveSyncDuration,
              s = n.liveSyncDurationCount,
              o = n.lowLatencyMode,
              l = this.hls.userConfig,
              u = (o && r) || t;
            (this._targetLatencyUpdated || l.liveSyncDuration || l.liveSyncDurationCount || 0 === u) &&
              (u = void 0 !== a ? a : s * i);
            var d = i;
            return u + Math.min(this.stallCount * this.config.liveSyncOnStallIncrease, d);
          }
          set targetLatency(e) {
            ((this.stallCount = 0), (this.config.liveSyncDuration = e), (this._targetLatencyUpdated = !0));
          }
          get liveSyncPosition() {
            var e = this.estimateLiveEdge(),
              t = this.targetLatency;
            if (null === e || null === t) return null;
            var r = this.levelDetails;
            if (null === r) return null;
            var i = r.edge,
              n = e - t - this.edgeStalled,
              a = i - r.totalduration,
              s = i - ((this.config.lowLatencyMode && r.partTarget) || r.targetduration);
            return Math.min(Math.max(a, n), s);
          }
          get drift() {
            var e = this.levelDetails;
            return null === e ? 1 : e.drift;
          }
          get edgeStalled() {
            var e = this.levelDetails;
            if (null === e) return 0;
            var t = 3 * ((this.config.lowLatencyMode && e.partTarget) || e.targetduration);
            return Math.max(e.age - t, 0);
          }
          get forwardBufferLength() {
            var e = this.media,
              t = this.levelDetails;
            if (!e || !t) return 0;
            var r = e.buffered.length;
            return (r ? e.buffered.end(r - 1) : t.edge) - this.currentTime;
          }
          destroy() {
            (this.unregisterListeners(), this.onMediaDetaching(), (this.hls = null));
          }
          registerListeners() {
            var e = this.hls;
            e &&
              (e.on(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.on(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.on(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
              e.on(Au.ERROR, this.onError, this));
          }
          unregisterListeners() {
            var e = this.hls;
            e &&
              (e.off(Au.MEDIA_ATTACHED, this.onMediaAttached, this),
              e.off(Au.MEDIA_DETACHING, this.onMediaDetaching, this),
              e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.off(Au.LEVEL_UPDATED, this.onLevelUpdated, this),
              e.off(Au.ERROR, this.onError, this));
          }
          onMediaAttached(e, t) {
            ((this.media = t.media), this.media.addEventListener("timeupdate", this.onTimeupdate));
          }
          onMediaDetaching() {
            this.media &&
              (this.media.removeEventListener("timeupdate", this.onTimeupdate), (this.media = null));
          }
          onManifestLoading() {
            ((this._latency = null), (this.stallCount = 0));
          }
          onLevelUpdated(e, { details: t }) {
            (t.advanced && this.onTimeupdate(),
              !t.live && this.media && this.media.removeEventListener("timeupdate", this.onTimeupdate));
          }
          onError(e, t) {
            var r;
            t.details === wu.BUFFER_STALLED_ERROR &&
              (this.stallCount++,
              this.hls &&
                null != (r = this.levelDetails) &&
                r.live &&
                this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"));
          }
          changeMediaPlaybackRate(e, t) {
            var r, i;
            e.playbackRate !== t &&
              (null == (r = this.hls) ||
                r.logger.debug(
                  `[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null == (i = this.targetLatency) ? void 0 : i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`,
                ),
              (e.playbackRate = t));
          }
          estimateLiveEdge() {
            var e = this.levelDetails;
            return null === e ? null : e.edge + e.age;
          }
          computeLatency() {
            var e = this.estimateLiveEdge();
            return null === e ? null : e - this.currentTime;
          }
        }
        class gy extends wg {
          constructor(e, t) {
            (super(e, "level-controller"),
              (this._levels = []),
              (this._firstLevel = -1),
              (this._maxAutoLevel = -1),
              (this._startLevel = void 0),
              (this.currentLevel = null),
              (this.currentLevelIndex = -1),
              (this.manualLevelIndex = -1),
              (this.steering = void 0),
              (this.onParsedComplete = void 0),
              (this.steering = t),
              this._registerListeners());
          }
          _registerListeners() {
            var e = this.hls;
            (e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.on(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
              e.on(Au.LEVEL_LOADED, this.onLevelLoaded, this),
              e.on(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
              e.on(Au.FRAG_BUFFERED, this.onFragBuffered, this),
              e.on(Au.ERROR, this.onError, this));
          }
          _unregisterListeners() {
            var e = this.hls;
            (e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.off(Au.MANIFEST_LOADED, this.onManifestLoaded, this),
              e.off(Au.LEVEL_LOADED, this.onLevelLoaded, this),
              e.off(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
              e.off(Au.FRAG_BUFFERED, this.onFragBuffered, this),
              e.off(Au.ERROR, this.onError, this));
          }
          destroy() {
            (this._unregisterListeners(), (this.steering = null), this.resetLevels(), super.destroy());
          }
          stopLoad() {
            (this._levels.forEach(e => {
              ((e.loadError = 0), (e.fragmentError = 0));
            }),
              super.stopLoad());
          }
          resetLevels() {
            ((this._startLevel = void 0),
              (this.manualLevelIndex = -1),
              (this.currentLevelIndex = -1),
              (this.currentLevel = null),
              (this._levels = []),
              (this._maxAutoLevel = -1));
          }
          onManifestLoading(e, t) {
            this.resetLevels();
          }
          onManifestLoaded(e, t) {
            var r = this.hls.config.preferManagedMediaSource,
              i = [],
              n = {},
              a = {},
              s = !1,
              o = !1,
              l = !1;
            (t.levels.forEach(e => {
              var t = e.attrs,
                u = e.audioCodec,
                d = e.videoCodec;
              (u && (e.audioCodec = u = Wd(u, r) || void 0),
                d &&
                  (d = e.videoCodec =
                    (function (e) {
                      for (var t = e.split(","), r = 0; r < t.length; r++) {
                        var i = t[r].split(".");
                        i.length > 2 &&
                          "avc1" === i[0] &&
                          (t[r] =
                            `avc1.${parseInt(i[1]).toString(16)}${("000" + parseInt(i[2]).toString(16)).slice(-4)}`);
                      }
                      return t.join(",");
                    })(d)));
              var h = e.width,
                c = e.height,
                f = e.unknownCodecs,
                p = (null == f ? void 0 : f.length) || 0;
              if (
                (s || (s = !(!h || !c)),
                o || (o = !!d),
                l || (l = !!u),
                p || (u && !this.isAudioSupported(u)) || (d && !this.isVideoSupported(d)))
              )
                this.log(`Some or all CODECS not supported "${t.CODECS}"`);
              else {
                var g = t.CODECS,
                  m = t["FRAME-RATE"],
                  v = t["HDCP-LEVEL"],
                  y = t["PATHWAY-ID"],
                  T = t.RESOLUTION,
                  b = t["VIDEO-RANGE"],
                  S = `${`${y || "."}-`}${e.bitrate}-${T}-${m}-${g}-${b}-${v}`;
                if (n[S])
                  if (n[S].uri === e.url || e.attrs["PATHWAY-ID"])
                    (n[S].addGroupId("audio", t.AUDIO), n[S].addGroupId("text", t.SUBTITLES));
                  else {
                    var E = (a[S] += 1);
                    e.attrs["PATHWAY-ID"] = new Array(E + 1).join(".");
                    var x = this.createLevel(e);
                    ((n[S] = x), i.push(x));
                  }
                else {
                  var w = this.createLevel(e);
                  ((n[S] = w), (a[S] = 1), i.push(w));
                }
              }
            }),
              this.filterAndSortMediaOptions(i, t, s, o, l));
          }
          createLevel(e) {
            var t = new hh(e),
              r = e.supplemental;
            if (null != r && r.videoCodec && !this.isVideoSupported(r.videoCodec)) {
              var i = new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);
              (this.log(i.message), (t.supportedResult = eh(i, [])));
            }
            return t;
          }
          isAudioSupported(e) {
            return Bd(e, "audio", this.hls.config.preferManagedMediaSource);
          }
          isVideoSupported(e) {
            return Bd(e, "video", this.hls.config.preferManagedMediaSource);
          }
          filterAndSortMediaOptions(e, t, r, i, n) {
            var a,
              s = [],
              o = [],
              l = e,
              u = (null == (a = t.stats) ? void 0 : a.parsing) || {};
            if (
              ((r || i) &&
                n &&
                (l = l.filter(({ videoCodec: e, videoRange: t, width: r, height: i }) => {
                  return (!!e || !(!r || !i)) && !!(n = t) && ah.indexOf(n) > -1;
                  var n;
                })),
              0 === l.length)
            )
              return (
                Promise.resolve().then(() => {
                  if (this.hls) {
                    var e = "no level with compatible codecs found in manifest",
                      r = e;
                    t.levels.length &&
                      ((r = `one or more CODECS in variant not supported: ${ph(t.levels.map(e => e.attrs.CODECS).filter((e, t, r) => r.indexOf(e) === t))}`),
                      this.warn(r),
                      (e += ` (${r})`));
                    var i = new Error(e);
                    this.hls.trigger(Au.ERROR, {
                      type: xu.MEDIA_ERROR,
                      details: wu.MANIFEST_INCOMPATIBLE_CODECS_ERROR,
                      fatal: !0,
                      url: t.url,
                      error: i,
                      reason: r,
                    });
                  }
                }),
                void (u.end = performance.now())
              );
            (t.audioTracks &&
              my((s = t.audioTracks.filter(e => !e.audioCodec || this.isAudioSupported(e.audioCodec)))),
              t.subtitles && my((o = t.subtitles)));
            var d = l.slice(0);
            l.sort((e, t) => {
              if (e.attrs["HDCP-LEVEL"] !== t.attrs["HDCP-LEVEL"])
                return (e.attrs["HDCP-LEVEL"] || "") > (t.attrs["HDCP-LEVEL"] || "") ? 1 : -1;
              if (r && e.height !== t.height) return e.height - t.height;
              if (e.frameRate !== t.frameRate) return e.frameRate - t.frameRate;
              if (e.videoRange !== t.videoRange) return ah.indexOf(e.videoRange) - ah.indexOf(t.videoRange);
              if (e.videoCodec !== t.videoCodec) {
                var i = Gd(e.videoCodec),
                  n = Gd(t.videoCodec);
                if (i !== n) return n - i;
              }
              if (e.uri === t.uri && e.codecSet !== t.codecSet) {
                var a = Vd(e.codecSet),
                  s = Vd(t.codecSet);
                if (a !== s) return s - a;
              }
              return e.averageBitrate !== t.averageBitrate ? e.averageBitrate - t.averageBitrate : 0;
            });
            var h = d[0];
            if (this.steering && (l = this.steering.filterParsedLevels(l)).length !== d.length)
              for (var c = 0; c < d.length; c++)
                if (d[c].pathwayId === l[0].pathwayId) {
                  h = d[c];
                  break;
                }
            this._levels = l;
            for (var f = 0; f < l.length; f++)
              if (l[f] === h) {
                var p;
                this._firstLevel = f;
                var g = h.bitrate,
                  m = this.hls.bandwidthEstimate;
                if (
                  (this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${g}`),
                  void 0 === (null == (p = this.hls.userConfig) ? void 0 : p.abrEwmaDefaultEstimate))
                ) {
                  var v = Math.min(g, this.hls.config.abrEwmaDefaultEstimateMax);
                  v > m && m === this.hls.abrEwmaDefaultEstimate && (this.hls.bandwidthEstimate = v);
                }
                break;
              }
            var y = n && !i,
              T = this.hls.config,
              b = !(!T.audioStreamController || !T.audioTrackController),
              S = {
                levels: l,
                audioTracks: s,
                subtitleTracks: o,
                sessionData: t.sessionData,
                sessionKeys: t.sessionKeys,
                firstLevel: this._firstLevel,
                stats: t.stats,
                audio: n,
                video: i,
                altAudio: b && !y && s.some(e => !!e.url),
              };
            ((u.end = performance.now()), this.hls.trigger(Au.MANIFEST_PARSED, S));
          }
          get levels() {
            return 0 === this._levels.length ? null : this._levels;
          }
          get loadLevelObj() {
            return this.currentLevel;
          }
          get level() {
            return this.currentLevelIndex;
          }
          set level(e) {
            var t = this._levels;
            if (0 !== t.length) {
              if (e < 0 || e >= t.length) {
                var r = new Error("invalid level idx"),
                  i = e < 0;
                if (
                  (this.hls.trigger(Au.ERROR, {
                    type: xu.OTHER_ERROR,
                    details: wu.LEVEL_SWITCH_ERROR,
                    level: e,
                    fatal: i,
                    error: r,
                    reason: r.message,
                  }),
                  i)
                )
                  return;
                e = Math.min(e, t.length - 1);
              }
              var n = this.currentLevelIndex,
                a = this.currentLevel,
                s = a ? a.attrs["PATHWAY-ID"] : void 0,
                o = t[e],
                l = o.attrs["PATHWAY-ID"];
              if (((this.currentLevelIndex = e), (this.currentLevel = o), n !== e || !a || s !== l)) {
                this.log(
                  `Switching to level ${e} (${o.height ? o.height + "p " : ""}${o.videoRange ? o.videoRange + " " : ""}${o.codecSet ? o.codecSet + " " : ""}@${o.bitrate})${l ? " with Pathway " + l : ""} from level ${n}${s ? " with Pathway " + s : ""}`,
                );
                var u = {
                  level: e,
                  attrs: o.attrs,
                  details: o.details,
                  bitrate: o.bitrate,
                  averageBitrate: o.averageBitrate,
                  maxBitrate: o.maxBitrate,
                  realBitrate: o.realBitrate,
                  width: o.width,
                  height: o.height,
                  codecSet: o.codecSet,
                  audioCodec: o.audioCodec,
                  videoCodec: o.videoCodec,
                  audioGroups: o.audioGroups,
                  subtitleGroups: o.subtitleGroups,
                  loaded: o.loaded,
                  loadError: o.loadError,
                  fragmentError: o.fragmentError,
                  name: o.name,
                  id: o.id,
                  uri: o.uri,
                  url: o.url,
                  urlId: 0,
                  audioGroupIds: o.audioGroupIds,
                  textGroupIds: o.textGroupIds,
                };
                this.hls.trigger(Au.LEVEL_SWITCHING, u);
                var d = o.details;
                if (!d || d.live) {
                  var h = this.switchParams(o.uri, null == a ? void 0 : a.details, d);
                  this.loadPlaylist(h);
                }
              }
            }
          }
          get manualLevel() {
            return this.manualLevelIndex;
          }
          set manualLevel(e) {
            ((this.manualLevelIndex = e),
              void 0 === this._startLevel && (this._startLevel = e),
              -1 !== e && (this.level = e));
          }
          get firstLevel() {
            return this._firstLevel;
          }
          set firstLevel(e) {
            this._firstLevel = e;
          }
          get startLevel() {
            if (void 0 === this._startLevel) {
              var e = this.hls.config.startLevel;
              return void 0 !== e ? e : this.hls.firstAutoLevel;
            }
            return this._startLevel;
          }
          set startLevel(e) {
            this._startLevel = e;
          }
          get pathways() {
            return this.steering ? this.steering.pathways() : [];
          }
          get pathwayPriority() {
            return this.steering ? this.steering.pathwayPriority : null;
          }
          set pathwayPriority(e) {
            if (this.steering) {
              var t = this.steering.pathways(),
                r = e.filter(e => -1 !== t.indexOf(e));
              if (e.length < 1)
                return void this.warn(
                  `pathwayPriority ${e} should contain at least one pathway from list: ${t}`,
                );
              this.steering.pathwayPriority = r;
            }
          }
          onError(e, t) {
            !t.fatal &&
              t.context &&
              t.context.type === ku &&
              t.context.level === this.level &&
              this.checkRetry(t);
          }
          onFragBuffered(e, { frag: t }) {
            if (void 0 !== t && t.type === Lu) {
              var r = t.elementaryStreams;
              if (!Object.keys(r).some(e => !!r[e])) return;
              var i = this._levels[t.level];
              null != i &&
                i.loadError &&
                (this.log(`Resetting level error count of ${i.loadError} on frag buffered`),
                (i.loadError = 0));
            }
          }
          onLevelLoaded(e, t) {
            var r,
              i,
              n = t.level,
              a = t.details,
              s = t.levelInfo;
            if (!s)
              return (
                this.warn(`Invalid level index ${n}`),
                void (null != (i = t.deliveryDirectives) && i.skip && (a.deltaUpdateFailed = !0))
              );
            if (s === this.currentLevel || t.withoutMultiVariant) {
              0 === s.fragmentError && (s.loadError = 0);
              var o = s.details;
              (o === t.details && o.advanced && (o = void 0), this.playlistLoaded(n, t, o));
            } else null != (r = t.deliveryDirectives) && r.skip && (a.deltaUpdateFailed = !0);
          }
          loadPlaylist(e) {
            (super.loadPlaylist(),
              this.shouldLoadPlaylist(this.currentLevel) && this.scheduleLoading(this.currentLevel, e));
          }
          loadingPlaylist(e, t) {
            super.loadingPlaylist(e, t);
            var r = this.getUrlWithDirectives(e.uri, t),
              i = this.currentLevelIndex,
              n = e.attrs["PATHWAY-ID"],
              a = e.details,
              s = null == a ? void 0 : a.age;
            (this.log(
              `Loading level index ${i}${void 0 !== (null == t ? void 0 : t.msn) ? " at sn " + t.msn + " part " + t.part : ""}${n ? " Pathway " + n : ""}${s && a.live ? " age " + s.toFixed(1) + ((a.type && " " + a.type) || "") : ""} ${r}`,
            ),
              this.hls.trigger(Au.LEVEL_LOADING, {
                url: r,
                level: i,
                levelInfo: e,
                pathwayId: e.attrs["PATHWAY-ID"],
                id: 0,
                deliveryDirectives: t || null,
              }));
          }
          get nextLoadLevel() {
            return -1 !== this.manualLevelIndex ? this.manualLevelIndex : this.hls.nextAutoLevel;
          }
          set nextLoadLevel(e) {
            ((this.level = e), -1 === this.manualLevelIndex && (this.hls.nextAutoLevel = e));
          }
          removeLevel(e) {
            var t;
            if (1 !== this._levels.length) {
              var r = this._levels.filter(
                (t, r) =>
                  r !== e ||
                  (this.steering && this.steering.removeLevel(t),
                  t === this.currentLevel &&
                    ((this.currentLevel = null),
                    (this.currentLevelIndex = -1),
                    t.details && t.details.fragments.forEach(e => (e.level = -1))),
                  !1),
              );
              (xf(r),
                (this._levels = r),
                this.currentLevelIndex > -1 &&
                  null != (t = this.currentLevel) &&
                  t.details &&
                  (this.currentLevelIndex = this.currentLevel.details.fragments[0].level),
                this.manualLevelIndex > -1 && (this.manualLevelIndex = this.currentLevelIndex));
              var i = r.length - 1;
              ((this._firstLevel = Math.min(this._firstLevel, i)),
                this._startLevel && (this._startLevel = Math.min(this._startLevel, i)),
                this.hls.trigger(Au.LEVELS_UPDATED, { levels: r }));
            }
          }
          onLevelsUpdated(e, { levels: t }) {
            this._levels = t;
          }
          checkMaxAutoUpdated() {
            var e = this.hls,
              t = e.autoLevelCapping,
              r = e.maxAutoLevel,
              i = e.maxHdcpLevel;
            this._maxAutoLevel !== r &&
              ((this._maxAutoLevel = r),
              this.hls.trigger(Au.MAX_AUTO_LEVEL_UPDATED, {
                autoLevelCapping: t,
                levels: this.levels,
                maxAutoLevel: r,
                minAutoLevel: this.hls.minAutoLevel,
                maxHdcpLevel: i,
              }));
          }
        }
        function my(e) {
          var t = {};
          e.forEach(e => {
            var r = e.groupId || "";
            ((e.id = t[r] = t[r] || 0), t[r]++);
          });
        }
        function vy() {
          return self.SourceBuffer || self.WebKitSourceBuffer;
        }
        function yy() {
          if (!Wu()) return !1;
          var e = vy();
          return (
            !e ||
            (e.prototype &&
              "function" == typeof e.prototype.appendBuffer &&
              "function" == typeof e.prototype.remove)
          );
        }
        class Ty extends Wf {
          constructor(e, t, r) {
            (super(e, t, r, "stream-controller", Lu),
              (this.audioCodecSwap = !1),
              (this.level = -1),
              (this._forceStartLoad = !1),
              (this._hasEnoughToStart = !1),
              (this.altAudio = 0),
              (this.audioOnly = !1),
              (this.fragPlaying = null),
              (this.fragLastKbps = 0),
              (this.couldBacktrack = !1),
              (this.backtrackFragment = null),
              (this.audioCodecSwitch = !1),
              (this.videoBuffer = null),
              (this.onMediaPlaying = () => {
                this.tick();
              }),
              (this.onMediaSeeked = () => {
                var e = this.media,
                  t = e ? e.currentTime : null;
                if (
                  null !== t &&
                  bu(t) &&
                  (this.log(`Media seeked to ${t.toFixed(3)}`), this.getBufferedFrag(t))
                ) {
                  var r = this.getFwdBufferInfoAtPos(e, t, Lu, 0);
                  null !== r && 0 !== r.len
                    ? this.tick()
                    : this.warn(
                        `Main forward buffer length at ${t} on "seeked" event ${r ? r.len : "empty"})`,
                      );
                }
              }),
              this.registerListeners());
          }
          registerListeners() {
            super.registerListeners();
            var e = this.hls;
            (e.on(Au.MANIFEST_PARSED, this.onManifestParsed, this),
              e.on(Au.LEVEL_LOADING, this.onLevelLoading, this),
              e.on(Au.LEVEL_LOADED, this.onLevelLoaded, this),
              e.on(Au.FRAG_LOAD_EMERGENCY_ABORTED, this.onFragLoadEmergencyAborted, this),
              e.on(Au.AUDIO_TRACK_SWITCHING, this.onAudioTrackSwitching, this),
              e.on(Au.AUDIO_TRACK_SWITCHED, this.onAudioTrackSwitched, this),
              e.on(Au.BUFFER_CREATED, this.onBufferCreated, this),
              e.on(Au.BUFFER_FLUSHED, this.onBufferFlushed, this),
              e.on(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
              e.on(Au.FRAG_BUFFERED, this.onFragBuffered, this));
          }
          unregisterListeners() {
            super.unregisterListeners();
            var e = this.hls;
            (e.off(Au.MANIFEST_PARSED, this.onManifestParsed, this),
              e.off(Au.LEVEL_LOADED, this.onLevelLoaded, this),
              e.off(Au.FRAG_LOAD_EMERGENCY_ABORTED, this.onFragLoadEmergencyAborted, this),
              e.off(Au.AUDIO_TRACK_SWITCHING, this.onAudioTrackSwitching, this),
              e.off(Au.AUDIO_TRACK_SWITCHED, this.onAudioTrackSwitched, this),
              e.off(Au.BUFFER_CREATED, this.onBufferCreated, this),
              e.off(Au.BUFFER_FLUSHED, this.onBufferFlushed, this),
              e.off(Au.LEVELS_UPDATED, this.onLevelsUpdated, this),
              e.off(Au.FRAG_BUFFERED, this.onFragBuffered, this));
          }
          onHandlerDestroying() {
            ((this.onMediaPlaying = this.onMediaSeeked = null),
              this.unregisterListeners(),
              super.onHandlerDestroying());
          }
          startLoad(e, t) {
            if (this.levels) {
              var r = this.lastCurrentTime,
                i = this.hls;
              if ((this.stopLoad(), this.setInterval(100), (this.level = -1), !this.startFragRequested)) {
                var n = i.startLevel;
                (-1 === n &&
                  (i.config.testBandwidth && this.levels.length > 1
                    ? ((n = 0), (this.bitrateTest = !0))
                    : (n = i.firstAutoLevel)),
                  (i.nextLoadLevel = n),
                  (this.level = i.loadLevel),
                  (this._hasEnoughToStart = !!t));
              }
              (r > 0 &&
                -1 === e &&
                !t &&
                (this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`), (e = r)),
                (this.state = Of),
                (this.nextLoadPosition = this.lastCurrentTime = e + this.timelineOffset),
                (this.startPosition = t ? -1 : e),
                this.tick());
            } else ((this._forceStartLoad = !0), (this.state = Pf));
          }
          stopLoad() {
            ((this._forceStartLoad = !1), super.stopLoad());
          }
          doTick() {
            switch (this.state) {
              case Kf:
                var e = this.levels,
                  t = this.level,
                  r = null == e ? void 0 : e[t],
                  i = null == r ? void 0 : r.details;
                if (i && (!i.live || (this.levelLastLoaded === r && !this.waitForLive(r)))) {
                  if (this.waitForCdnTuneIn(i)) break;
                  this.state = Of;
                  break;
                }
                if (this.hls.nextLoadLevel !== this.level) {
                  this.state = Of;
                  break;
                }
                break;
              case Uf:
                this.checkRetryDate();
            }
            (this.state === Of && this.doTickIdle(), this.onTickEnd());
          }
          onTickEnd() {
            var e;
            (super.onTickEnd(),
              null != (e = this.media) &&
                e.readyState &&
                !1 === this.media.seeking &&
                (this.lastCurrentTime = this.media.currentTime),
              this.checkFragmentChanged());
          }
          doTickIdle() {
            var e = this.hls,
              t = this.levelLastLoaded,
              r = this.levels,
              i = this.media;
            if (
              null !== t &&
              (i || this.primaryPrefetch || (!this.startFragRequested && e.config.startFragPrefetch)) &&
              (!this.altAudio || !this.audioOnly)
            ) {
              var n = this.buffering ? e.nextLoadLevel : e.loadLevel;
              if (null != r && r[n]) {
                var a = r[n],
                  s = this.getMainFwdBufferInfo();
                if (null !== s) {
                  var o = this.getLevelDetails();
                  if (o && this._streamEnded(s, o)) {
                    var l = {};
                    return (
                      2 === this.altAudio && (l.type = "video"),
                      this.hls.trigger(Au.BUFFER_EOS, l),
                      void (this.state = Gf)
                    );
                  }
                  if (this.buffering) {
                    (e.loadLevel !== n &&
                      -1 === e.manualLevel &&
                      this.log(`Adapting to level ${n} from level ${this.level}`),
                      (this.level = e.nextLoadLevel = n));
                    var u = a.details;
                    if (!u || this.state === Kf || this.waitForLive(a))
                      return ((this.level = n), (this.state = Kf), void (this.startFragRequested = !1));
                    var d = s.len,
                      h = this.getMaxBufferLength(a.maxBitrate);
                    if (!(d >= h)) {
                      this.backtrackFragment &&
                        this.backtrackFragment.start > s.end &&
                        (this.backtrackFragment = null);
                      var c = this.backtrackFragment ? this.backtrackFragment.start : s.end,
                        f = this.getNextFragment(c, u);
                      if (
                        this.couldBacktrack &&
                        !this.fragPrevious &&
                        f &&
                        sd(f) &&
                        this.fragmentTracker.getState(f) !== qh
                      ) {
                        var p,
                          g = (null != (p = this.backtrackFragment) ? p : f).sn - u.startSN,
                          m = u.fragments[g - 1];
                        m && f.cc === m.cc && ((f = m), this.fragmentTracker.removeFragment(m));
                      } else this.backtrackFragment && s.len && (this.backtrackFragment = null);
                      if (f && this.isLoopLoading(f, c)) {
                        if (!f.gap) {
                          var v = this.audioOnly && !this.altAudio ? rd : id,
                            y = (v === id ? this.videoBuffer : this.mediaBuffer) || this.media;
                          y && this.afterBufferFlushed(y, v, Lu);
                        }
                        f = this.getNextFragmentLoopLoading(f, u, s, Lu, h);
                      }
                      f &&
                        (!f.initSegment || f.initSegment.data || this.bitrateTest || (f = f.initSegment),
                        this.loadFragment(f, a, c));
                    }
                  }
                }
              }
            }
          }
          loadFragment(e, t, r) {
            var i = this.fragmentTracker.getState(e);
            i === Kh || i === zh
              ? sd(e)
                ? this.bitrateTest
                  ? (this.log(
                      `Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`,
                    ),
                    this._loadBitrateTestFrag(e, t))
                  : super.loadFragment(e, t, r)
                : this._loadInitSegment(e, t)
              : this.clearTrackerIfNeeded(e);
          }
          getBufferedFrag(e) {
            return this.fragmentTracker.getBufferedFrag(e, Lu);
          }
          followingBufferedFrag(e) {
            return e ? this.getBufferedFrag(e.end + 0.5) : null;
          }
          immediateLevelSwitch() {
            (this.abortCurrentFrag(), this.flushMainBuffer(0, Number.POSITIVE_INFINITY));
          }
          nextLevelSwitch() {
            var e = this.levels,
              t = this.media;
            if (null != t && t.readyState) {
              var r,
                i = this.getAppendedFrag(t.currentTime);
              i && i.start > 1 && this.flushMainBuffer(0, i.start - 1);
              var n = this.getLevelDetails();
              if (null != n && n.live) {
                var a = this.getMainFwdBufferInfo();
                if (!a || a.len < 2 * n.targetduration) return;
              }
              if (!t.paused && e) {
                var s = e[this.hls.nextLoadLevel],
                  o = this.fragLastKbps;
                r = o && this.fragCurrent ? (this.fragCurrent.duration * s.maxBitrate) / (1e3 * o) + 1 : 0;
              } else r = 0;
              var l = this.getBufferedFrag(t.currentTime + r);
              if (l) {
                var u = this.followingBufferedFrag(l);
                if (u) {
                  this.abortCurrentFrag();
                  var d = u.maxStartPTS ? u.maxStartPTS : u.start,
                    h = u.duration,
                    c = Math.max(
                      l.end,
                      d +
                        Math.min(
                          Math.max(
                            h - this.config.maxFragLookUpTolerance,
                            h * (this.couldBacktrack ? 0.5 : 0.125),
                          ),
                          h * (this.couldBacktrack ? 0.75 : 0.25),
                        ),
                    );
                  this.flushMainBuffer(c, Number.POSITIVE_INFINITY);
                }
              }
            }
          }
          abortCurrentFrag() {
            var e = this.fragCurrent;
            switch (
              ((this.fragCurrent = null),
              (this.backtrackFragment = null),
              e && (e.abortRequests(), this.fragmentTracker.removeFragment(e)),
              this.state)
            ) {
              case Nf:
              case Ff:
              case Uf:
              case $f:
              case jf:
                this.state = Of;
            }
            this.nextLoadPosition = this.getLoadPosition();
          }
          flushMainBuffer(e, t) {
            super.flushMainBuffer(e, t, 2 === this.altAudio ? "video" : null);
          }
          onMediaAttached(e, t) {
            super.onMediaAttached(e, t);
            var r = t.media;
            (Mf(r, "playing", this.onMediaPlaying), Mf(r, "seeked", this.onMediaSeeked));
          }
          onMediaDetaching(e, t) {
            var r = this.media;
            (r && (Df(r, "playing", this.onMediaPlaying), Df(r, "seeked", this.onMediaSeeked)),
              (this.videoBuffer = null),
              (this.fragPlaying = null),
              super.onMediaDetaching(e, t),
              !!t.transferMedia || (this._hasEnoughToStart = !1));
          }
          onManifestLoading() {
            (super.onManifestLoading(),
              this.log("Trigger BUFFER_RESET"),
              this.hls.trigger(Au.BUFFER_RESET, void 0),
              (this.couldBacktrack = !1),
              (this.fragLastKbps = 0),
              (this.fragPlaying = this.backtrackFragment = null),
              (this.altAudio = 0),
              (this.audioOnly = !1));
          }
          onManifestParsed(e, t) {
            for (var r, i, n = !1, a = !1, s = 0; s < t.levels.length; s++) {
              var o = t.levels[s].audioCodec;
              o && ((n = n || -1 !== o.indexOf("mp4a.40.2")), (a = a || -1 !== o.indexOf("mp4a.40.5")));
            }
            ((this.audioCodecSwitch =
              n &&
              a &&
              !(
                "function" == typeof (null == (i = vy()) || null == (r = i.prototype) ? void 0 : r.changeType)
              )),
              this.audioCodecSwitch &&
                this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),
              (this.levels = t.levels),
              (this.startFragRequested = !1));
          }
          onLevelLoading(e, t) {
            if (this.levels && this.state === Of) {
              var r = t.levelInfo;
              (!r.details ||
                (r.details.live && (this.levelLastLoaded !== r || r.details.expired)) ||
                this.waitForCdnTuneIn(r.details)) &&
                (this.state = Kf);
            }
          }
          onLevelLoaded(e, t) {
            var r,
              i = this.levels,
              n = this.startFragRequested,
              a = t.level,
              s = t.details,
              o = s.totalduration;
            if (i) {
              this.log(
                `Level ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn ? `[part-${s.lastPartSn}-${s.lastPartIndex}]` : ""}, cc [${s.startCC}, ${s.endCC}] duration:${o}`,
              );
              var l = t.levelInfo,
                u = this.fragCurrent;
              !u ||
                (this.state !== Ff && this.state !== Uf) ||
                (u.level !== t.level && u.loader && this.abortCurrentFrag());
              var d = 0;
              if (s.live || (null != (r = l.details) && r.live)) {
                var h;
                if ((this.checkLiveUpdate(s), s.deltaUpdateFailed)) return;
                d = this.alignPlaylists(
                  s,
                  l.details,
                  null == (h = this.levelLastLoaded) ? void 0 : h.details,
                );
              }
              if (
                ((l.details = s),
                (this.levelLastLoaded = l),
                n || this.setStartPosition(s, d),
                this.hls.trigger(Au.LEVEL_UPDATED, { details: s, level: a }),
                this.state === Kf)
              ) {
                if (this.waitForCdnTuneIn(s)) return;
                this.state = Of;
              }
              (n && s.live && this.synchronizeToLiveEdge(s), this.tick());
            } else this.warn(`Levels were reset while loading level ${a}`);
          }
          synchronizeToLiveEdge(e) {
            var t = this.config,
              r = this.media;
            if (r) {
              var i = this.hls.liveSyncPosition,
                n = this.getLoadPosition(),
                a = e.fragmentStart,
                s = e.edge,
                o = n >= a - t.maxFragLookUpTolerance && n <= s;
              if (null !== i && r.duration > i && (n < i || !o)) {
                var l =
                  void 0 !== t.liveMaxLatencyDuration
                    ? t.liveMaxLatencyDuration
                    : t.liveMaxLatencyDurationCount * e.targetduration;
                if (
                  ((!o && r.readyState < 4) || n < s - l) &&
                  (this._hasEnoughToStart || (this.nextLoadPosition = i), r.readyState)
                )
                  if (
                    (this.warn(
                      `Playback: ${n.toFixed(3)} is located too far from the end of live sliding playlist: ${s}, reset currentTime to : ${i.toFixed(3)}`,
                    ),
                    "buffered" === this.config.liveSyncMode)
                  ) {
                    var u,
                      d = fc.bufferInfo(r, i, 0);
                    if (null == (u = d.buffered) || !u.length) return void (r.currentTime = i);
                    if (d.start <= n) return void (r.currentTime = i);
                    var h = fc.bufferedInfo(d.buffered, n, 0).nextStart;
                    h && (r.currentTime = h);
                  } else r.currentTime = i;
              }
            }
          }
          _handleFragmentLoadProgress(e) {
            var t,
              r = e.frag,
              i = e.part,
              n = e.payload,
              a = this.levels;
            if (a) {
              var s = a[r.level];
              if (s) {
                var o = s.details;
                if (!o)
                  return (
                    this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),
                    void this.fragmentTracker.removeFragment(r)
                  );
                var l = s.videoCodec,
                  u = o.PTSKnown || !o.live,
                  d = null == (t = r.initSegment) ? void 0 : t.data,
                  h = this._getAudioCodec(s),
                  c = (this.transmuxer =
                    this.transmuxer ||
                    new xg(
                      this.hls,
                      Lu,
                      this._handleTransmuxComplete.bind(this),
                      this._handleTransmuxerFlush.bind(this),
                    )),
                  f = i ? i.index : -1,
                  p = -1 !== f,
                  g = new hc(r.level, r.sn, r.stats.chunkCount, n.byteLength, f, p),
                  m = this.initPTS[r.cc];
                c.push(n, d, h, l, r, i, o.totalduration, u, g, m);
              } else this.warn(`Level ${r.level} not found on progress`);
            } else
              this.warn(
                `Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`,
              );
          }
          onAudioTrackSwitching(e, t) {
            var r = this.hls,
              i = 0 !== this.altAudio;
            if (Eh(t.url, r)) this.altAudio = 1;
            else {
              if (this.mediaBuffer !== this.media) {
                (this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),
                  (this.mediaBuffer = this.media));
                var n = this.fragCurrent;
                (n &&
                  (this.log("Switching to main audio track, cancel main fragment load"),
                  n.abortRequests(),
                  this.fragmentTracker.removeFragment(n)),
                  this.resetTransmuxer(),
                  this.resetLoadingState());
              } else this.audioOnly && this.resetTransmuxer();
              if (i)
                return (
                  (this.altAudio = 0),
                  this.fragmentTracker.removeAllFragments(),
                  r.once(Au.BUFFER_FLUSHED, () => {
                    this.hls && this.hls.trigger(Au.AUDIO_TRACK_SWITCHED, t);
                  }),
                  void r.trigger(Au.BUFFER_FLUSHING, {
                    startOffset: 0,
                    endOffset: Number.POSITIVE_INFINITY,
                    type: null,
                  })
                );
              r.trigger(Au.AUDIO_TRACK_SWITCHED, t);
            }
          }
          onAudioTrackSwitched(e, t) {
            var r = Eh(t.url, this.hls);
            if (r) {
              var i = this.videoBuffer;
              i &&
                this.mediaBuffer !== i &&
                (this.log(
                  "Switching on alternate audio, use video.buffered to schedule main fragment loading",
                ),
                (this.mediaBuffer = i));
            }
            ((this.altAudio = r ? 2 : 0), this.tick());
          }
          onBufferCreated(e, t) {
            var r,
              i,
              n = t.tracks,
              a = !1;
            for (var s in n) {
              var o = n[s];
              if ("main" === o.id) {
                if (((i = s), (r = o), "video" === s)) {
                  var l = n[s];
                  l && (this.videoBuffer = l.buffer);
                }
              } else a = !0;
            }
            a && r
              ? (this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),
                (this.mediaBuffer = r.buffer))
              : (this.mediaBuffer = this.media);
          }
          onFragBuffered(e, t) {
            var r = t.frag,
              i = t.part,
              n = r.type === Lu;
            if (n) {
              if (this.fragContextChanged(r))
                return (
                  this.warn(
                    `Fragment ${r.sn}${i ? " p: " + i.index : ""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`,
                  ),
                  void (this.state === jf && (this.state = Of))
                );
              var a = i ? i.stats : r.stats;
              ((this.fragLastKbps = Math.round((8 * a.total) / (a.buffering.end - a.loading.first))),
                sd(r) && (this.fragPrevious = r),
                this.fragBufferedComplete(r, i));
            }
            var s = this.media;
            s &&
              (!this._hasEnoughToStart &&
                fc.getBuffered(s).length &&
                ((this._hasEnoughToStart = !0), this.seekToStartPos()),
              n && this.tick());
          }
          get hasEnoughToStart() {
            return this._hasEnoughToStart;
          }
          onError(e, t) {
            var r;
            if (t.fatal) this.state = Vf;
            else
              switch (t.details) {
                case wu.FRAG_GAP:
                case wu.FRAG_PARSING_ERROR:
                case wu.FRAG_DECRYPT_ERROR:
                case wu.FRAG_LOAD_ERROR:
                case wu.FRAG_LOAD_TIMEOUT:
                case wu.KEY_LOAD_ERROR:
                case wu.KEY_LOAD_TIMEOUT:
                  this.onFragmentOrKeyLoadError(Lu, t);
                  break;
                case wu.LEVEL_LOAD_ERROR:
                case wu.LEVEL_LOAD_TIMEOUT:
                case wu.LEVEL_PARSING_ERROR:
                  t.levelRetry ||
                    this.state !== Kf ||
                    (null == (r = t.context) ? void 0 : r.type) !== ku ||
                    (this.state = Of);
                  break;
                case wu.BUFFER_ADD_CODEC_ERROR:
                case wu.BUFFER_APPEND_ERROR:
                  if ("main" !== t.parent) return;
                  this.reduceLengthAndFlushBuffer(t) && this.resetLoadingState();
                  break;
                case wu.BUFFER_FULL_ERROR:
                  if ("main" !== t.parent) return;
                  if (this.reduceLengthAndFlushBuffer(t))
                    !this.config.interstitialsController && this.config.assetPlayerId
                      ? (this._hasEnoughToStart = !0)
                      : this.flushMainBuffer(0, Number.POSITIVE_INFINITY);
                  break;
                case wu.INTERNAL_EXCEPTION:
                  this.recoverWorkerError(t);
              }
          }
          onFragLoadEmergencyAborted() {
            ((this.state = Of),
              this._hasEnoughToStart ||
                ((this.startFragRequested = !1), (this.nextLoadPosition = this.lastCurrentTime)),
              this.tickImmediate());
          }
          onBufferFlushed(e, { type: t }) {
            if (t !== rd || !this.altAudio) {
              var r = (t === id ? this.videoBuffer : this.mediaBuffer) || this.media;
              r && (this.afterBufferFlushed(r, t, Lu), this.tick());
            }
          }
          onLevelsUpdated(e, t) {
            (this.level > -1 &&
              this.fragCurrent &&
              ((this.level = this.fragCurrent.level),
              -1 === this.level && this.resetWhenMissingContext(this.fragCurrent)),
              (this.levels = t.levels));
          }
          swapAudioCodec() {
            this.audioCodecSwap = !this.audioCodecSwap;
          }
          seekToStartPos() {
            var e = this.media;
            if (e) {
              var t = e.currentTime,
                r = this.startPosition;
              if (r >= 0 && t < r) {
                if (e.seeking) return void this.log(`could not seek to ${r}, already seeking at ${t}`);
                var i = this.timelineOffset;
                i && r && (r += i);
                var n = this.getLevelDetails(),
                  a = fc.getBuffered(e),
                  s = a.length ? a.start(0) : 0,
                  o = s - r,
                  l = Math.max(this.config.maxBufferHole, this.config.maxFragLookUpTolerance);
                ((this.config.startOnSegmentBoundary ||
                  (o > 0 &&
                    (o < l || (this.loadingParts && o < 2 * ((null == n ? void 0 : n.partTarget) || 0))))) &&
                  (this.log(`adjusting start position by ${o} to match buffer start`),
                  (r += o),
                  (this.startPosition = r)),
                  t < r &&
                    (this.log(`seek to target start position ${r} from current time ${t} buffer start ${s}`),
                    (e.currentTime = r)));
              }
            }
          }
          _getAudioCodec(e) {
            var t = this.config.defaultAudioCodec || e.audioCodec;
            return (
              this.audioCodecSwap &&
                t &&
                (this.log("Swapping audio codec"),
                (t = -1 !== t.indexOf("mp4a.40.5") ? "mp4a.40.2" : "mp4a.40.5")),
              t
            );
          }
          _loadBitrateTestFrag(e, t) {
            ((e.bitrateTest = !0),
              this._doFragLoad(e, t)
                .then(e => {
                  var r = this.hls,
                    i = null == e ? void 0 : e.frag;
                  if (i && !this.fragContextChanged(i)) {
                    ((t.fragmentError = 0),
                      (this.state = Of),
                      (this.startFragRequested = !1),
                      (this.bitrateTest = !1));
                    var n = i.stats;
                    ((n.parsing.start =
                      n.parsing.end =
                      n.buffering.start =
                      n.buffering.end =
                        self.performance.now()),
                      r.trigger(Au.FRAG_LOADED, e),
                      (i.bitrateTest = !1));
                  }
                })
                .catch(t => {
                  this.state !== Pf && this.state !== Vf && (this.warn(t), this.resetFragmentLoading(e));
                }));
          }
          _handleTransmuxComplete(e) {
            var t = this.playlistType,
              r = this.hls,
              i = e.remuxResult,
              n = e.chunkMeta,
              a = this.getCurrentContext(n);
            if (a) {
              var s = a.frag,
                o = a.part,
                l = a.level,
                u = i.video,
                d = i.text,
                h = i.id3,
                c = i.initSegment,
                f = l.details,
                p = this.altAudio ? void 0 : i.audio;
              if (this.fragContextChanged(s)) this.fragmentTracker.removeFragment(s);
              else {
                if (((this.state = $f), c)) {
                  var g = c.tracks;
                  if (g) {
                    var m = s.initSegment || s;
                    if (this.unhandledEncryptionError(c, s)) return;
                    (this._bufferInitSegment(l, g, m, n),
                      r.trigger(Au.FRAG_PARSING_INIT_SEGMENT, { frag: m, id: t, tracks: g }));
                  }
                  var v = c.initPTS,
                    y = c.timescale,
                    T = this.initPTS[s.cc];
                  if (bu(v) && (!T || T.baseTime !== v || T.timescale !== y)) {
                    var b = c.trackId;
                    ((this.initPTS[s.cc] = { baseTime: v, timescale: y, trackId: b }),
                      r.trigger(Au.INIT_PTS_FOUND, { frag: s, id: t, initPTS: v, timescale: y, trackId: b }));
                  }
                }
                if (u && f) {
                  p && "audiovideo" === u.type && this.logMuxedErr(s);
                  var S = f.fragments[s.sn - 1 - f.startSN],
                    E = s.sn === f.startSN,
                    x = !S || s.cc > S.cc;
                  if (!1 !== i.independent) {
                    var w = u.startPTS,
                      A = u.endPTS,
                      I = u.startDTS,
                      k = u.endDTS;
                    if (o) o.elementaryStreams[u.type] = { startPTS: w, endPTS: A, startDTS: I, endDTS: k };
                    else if (
                      (u.firstKeyFrame && u.independent && 1 === n.id && !x && (this.couldBacktrack = !0),
                      u.dropped && u.independent)
                    ) {
                      var R = this.getMainFwdBufferInfo(),
                        C = (R ? R.end : this.getLoadPosition()) + this.config.maxBufferHole,
                        L = u.firstKeyFramePTS ? u.firstKeyFramePTS : w;
                      if (!E && C < L - this.config.maxBufferHole && !x) return void this.backtrack(s);
                      (x && (s.gap = !0), s.setElementaryStreamInfo(u.type, s.start, A, s.start, k, !0));
                    } else E && w - (f.appliedTimelineOffset || 0) > 2 && (s.gap = !0);
                    (s.setElementaryStreamInfo(u.type, w, A, I, k),
                      this.backtrackFragment && (this.backtrackFragment = s),
                      this.bufferFragmentData(u, s, o, n, E || x));
                  } else {
                    if (!E && !x) return void this.backtrack(s);
                    s.gap = !0;
                  }
                }
                if (p) {
                  var M = p.startPTS,
                    D = p.endPTS,
                    _ = p.startDTS,
                    P = p.endDTS;
                  (o && (o.elementaryStreams[rd] = { startPTS: M, endPTS: D, startDTS: _, endDTS: P }),
                    s.setElementaryStreamInfo(rd, M, D, _, P),
                    this.bufferFragmentData(p, s, o, n));
                }
                if (f && null != h && h.samples.length) {
                  var O = { id: t, frag: s, details: f, samples: h.samples };
                  r.trigger(Au.FRAG_PARSING_METADATA, O);
                }
                if (f && d) {
                  var N = { id: t, frag: s, details: f, samples: d.samples };
                  r.trigger(Au.FRAG_PARSING_USERDATA, N);
                }
              }
            } else this.resetWhenMissingContext(n);
          }
          logMuxedErr(e) {
            this.warn(
              `${sd(e) ? "Media" : "Init"} segment with muxed audiovideo where only video expected: ${e.url}`,
            );
          }
          _bufferInitSegment(e, t, r, i) {
            if (this.state === $f) {
              ((this.audioOnly = !!t.audio && !t.video),
                this.altAudio && !this.audioOnly && (delete t.audio, t.audiovideo && this.logMuxedErr(r)));
              var n = t.audio,
                a = t.video,
                s = t.audiovideo;
              if (n) {
                var o = e.audioCodec,
                  l = zd(n.codec, o);
                "mp4a" === l && (l = "mp4a.40.5");
                var u = navigator.userAgent.toLowerCase();
                if (this.audioCodecSwitch) {
                  l && (l = -1 !== l.indexOf("mp4a.40.5") ? "mp4a.40.2" : "mp4a.40.5");
                  var d = n.metadata;
                  d &&
                    "channelCount" in d &&
                    1 !== (d.channelCount || 1) &&
                    -1 === u.indexOf("firefox") &&
                    (l = "mp4a.40.5");
                }
                (l &&
                  -1 !== l.indexOf("mp4a.40.5") &&
                  -1 !== u.indexOf("android") &&
                  "audio/mpeg" !== n.container &&
                  ((l = "mp4a.40.2"), this.log(`Android: force audio codec to ${l}`)),
                  o && o !== l && this.log(`Swapping manifest audio codec "${o}" for "${l}"`),
                  (n.levelCodec = l),
                  (n.id = Lu),
                  this.log(
                    `Init audio buffer, container:${n.container}, codecs[selected/level/parsed]=[${l || ""}/${o || ""}/${n.codec}]`,
                  ),
                  delete t.audiovideo);
              }
              if (a) {
                ((a.levelCodec = e.videoCodec), (a.id = Lu));
                var h = a.codec;
                if (4 === (null == h ? void 0 : h.length))
                  switch (h) {
                    case "hvc1":
                    case "hev1":
                      a.codec = "hvc1.1.6.L120.90";
                      break;
                    case "av01":
                      a.codec = "av01.0.04M.08";
                      break;
                    case "avc1":
                      a.codec = "avc1.42e01e";
                  }
                (this.log(
                  `Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec || ""}/${h}]${a.codec !== h ? " parsed-corrected=" + a.codec : ""}${a.supplemental ? " supplemental=" + a.supplemental : ""}`,
                ),
                  delete t.audiovideo);
              }
              s &&
                (this.log(
                  `Init audiovideo buffer, container:${s.container}, codecs[level/parsed]=[${e.codecs}/${s.codec}]`,
                ),
                delete t.video,
                delete t.audio);
              var c = Object.keys(t);
              if (c.length) {
                if ((this.hls.trigger(Au.BUFFER_CODECS, t), !this.hls)) return;
                c.forEach(e => {
                  var n = t[e].initSegment;
                  null != n &&
                    n.byteLength &&
                    this.hls.trigger(Au.BUFFER_APPENDING, {
                      type: e,
                      data: n,
                      frag: r,
                      part: null,
                      chunkMeta: i,
                      parent: r.type,
                    });
                });
              }
              this.tickImmediate();
            }
          }
          getMainFwdBufferInfo() {
            var e = this.mediaBuffer && 2 === this.altAudio ? this.mediaBuffer : this.media;
            return this.getFwdBufferInfo(e, Lu);
          }
          get maxBufferLength() {
            var e = this.levels,
              t = this.level,
              r = null == e ? void 0 : e[t];
            return r ? this.getMaxBufferLength(r.maxBitrate) : this.config.maxBufferLength;
          }
          backtrack(e) {
            ((this.couldBacktrack = !0),
              (this.backtrackFragment = e),
              this.resetTransmuxer(),
              this.flushBufferGap(e),
              this.fragmentTracker.removeFragment(e),
              (this.fragPrevious = null),
              (this.nextLoadPosition = e.start),
              (this.state = Of));
          }
          checkFragmentChanged() {
            var e = this.media,
              t = null;
            if (e && e.readyState > 1 && !1 === e.seeking) {
              var r = e.currentTime;
              if (
                (fc.isBuffered(e, r)
                  ? (t = this.getAppendedFrag(r))
                  : fc.isBuffered(e, r + 0.1) && (t = this.getAppendedFrag(r + 0.1)),
                t)
              ) {
                this.backtrackFragment = null;
                var i = this.fragPlaying,
                  n = t.level;
                (i && t.sn === i.sn && i.level === n) ||
                  ((this.fragPlaying = t),
                  this.hls.trigger(Au.FRAG_CHANGED, { frag: t }),
                  (i && i.level === n) || this.hls.trigger(Au.LEVEL_SWITCHED, { level: n }));
              }
            }
          }
          get nextLevel() {
            var e = this.nextBufferedFrag;
            return e ? e.level : -1;
          }
          get currentFrag() {
            var e;
            if (this.fragPlaying) return this.fragPlaying;
            var t = (null == (e = this.media) ? void 0 : e.currentTime) || this.lastCurrentTime;
            return bu(t) ? this.getAppendedFrag(t) : null;
          }
          get currentProgramDateTime() {
            var e,
              t = (null == (e = this.media) ? void 0 : e.currentTime) || this.lastCurrentTime;
            if (bu(t)) {
              var r = this.getLevelDetails(),
                i = this.currentFrag || (r ? wh(null, r.fragments, t) : null);
              if (i) {
                var n = i.programDateTime;
                if (null !== n) {
                  var a = n + 1e3 * (t - i.start);
                  return new Date(a);
                }
              }
            }
            return null;
          }
          get currentLevel() {
            var e = this.currentFrag;
            return e ? e.level : -1;
          }
          get nextBufferedFrag() {
            var e = this.currentFrag;
            return e ? this.followingBufferedFrag(e) : null;
          }
          get forceStartLoad() {
            return this._forceStartLoad;
          }
        }
        class by extends Bu {
          constructor(e, t) {
            (super("key-loader", t),
              (this.config = void 0),
              (this.keyIdToKeyInfo = {}),
              (this.emeController = null),
              (this.config = e));
          }
          abort(e) {
            for (var t in this.keyIdToKeyInfo) {
              var r = this.keyIdToKeyInfo[t].loader;
              if (r) {
                var i;
                if (e && e !== (null == (i = r.context) ? void 0 : i.frag.type)) return;
                r.abort();
              }
            }
          }
          detach() {
            for (var e in this.keyIdToKeyInfo) {
              var t = this.keyIdToKeyInfo[e];
              (t.mediaKeySessionContext || t.decryptdata.isCommonEncryption) && delete this.keyIdToKeyInfo[e];
            }
          }
          destroy() {
            for (var e in (this.detach(), this.keyIdToKeyInfo)) {
              var t = this.keyIdToKeyInfo[e].loader;
              t && t.destroy();
            }
            this.keyIdToKeyInfo = {};
          }
          createKeyLoadError(e, t = wu.KEY_LOAD_ERROR, r, i, n) {
            return new uc({
              type: xu.NETWORK_ERROR,
              details: t,
              fatal: !1,
              frag: e,
              response: n,
              error: r,
              networkDetails: i,
            });
          }
          loadClear(e, t, r) {
            var i = this;
            if (
              this.emeController &&
              this.config.emeEnabled &&
              !this.emeController.getSelectedKeySystemFormats().length
            ) {
              if (t.length)
                for (
                  var n,
                    a = function () {
                      var n = t[s];
                      if ((e.cc <= n.cc && (!sd(e) || !sd(n) || e.sn < n.sn)) || (!r && s == o - 1))
                        return {
                          v: i.emeController.selectKeySystemFormat(n).then(e => {
                            if (i.emeController) {
                              n.setKeyFormat(e);
                              var t = $c(e);
                              return t ? i.emeController.getKeySystemAccess([t]) : void 0;
                            }
                          }),
                        };
                    },
                    s = 0,
                    o = t.length;
                  s < o;
                  s++
                )
                  if ((n = a())) return n.v;
              if (this.config.requireKeySystemAccessOnStart) {
                var l = Gc(this.config);
                if (l.length) return this.emeController.getKeySystemAccess(l);
              }
            }
            return null;
          }
          load(e) {
            return !e.decryptdata && e.encrypted && this.emeController && this.config.emeEnabled
              ? this.emeController.selectKeySystemFormat(e).then(t => this.loadInternal(e, t))
              : this.loadInternal(e);
          }
          loadInternal(e, t) {
            var r, i;
            t && e.setKeyFormat(t);
            var n = e.decryptdata;
            if (!n) {
              var a = new Error(
                t
                  ? `Expected frag.decryptdata to be defined after setting format ${t}`
                  : `Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController && this.config.emeEnabled})`,
              );
              return Promise.reject(this.createKeyLoadError(e, wu.KEY_LOAD_ERROR, a));
            }
            var s = n.uri;
            if (!s)
              return Promise.reject(
                this.createKeyLoadError(e, wu.KEY_LOAD_ERROR, new Error(`Invalid key URI: "${s}"`)),
              );
            var o = Sy(n),
              l = this.keyIdToKeyInfo[o];
            if (null != (r = l) && r.decryptdata.key)
              return ((n.key = l.decryptdata.key), Promise.resolve({ frag: e, keyInfo: l }));
            if (this.emeController && null != (i = l) && i.keyLoadPromise)
              switch (this.emeController.getKeyStatus(l.decryptdata)) {
                case "usable":
                case "usable-in-future":
                  return l.keyLoadPromise.then(t => {
                    var r = t.keyInfo;
                    return ((n.key = r.decryptdata.key), { frag: e, keyInfo: r });
                  });
              }
            switch (
              (this.log(
                `${this.keyIdToKeyInfo[o] ? "Rel" : "L"}oading${n.keyId ? " keyId: " + Xu(n.keyId) : ""} URI: ${n.uri} from ${e.type} ${e.level}`,
              ),
              (l = this.keyIdToKeyInfo[o] =
                { decryptdata: n, keyLoadPromise: null, loader: null, mediaKeySessionContext: null }),
              n.method)
            ) {
              case "SAMPLE-AES":
              case "SAMPLE-AES-CENC":
              case "SAMPLE-AES-CTR":
                return "identity" === n.keyFormat ? this.loadKeyHTTP(l, e) : this.loadKeyEME(l, e);
              case "AES-128":
              case "AES-256":
              case "AES-256-CTR":
                return this.loadKeyHTTP(l, e);
              default:
                return Promise.reject(
                  this.createKeyLoadError(
                    e,
                    wu.KEY_LOAD_ERROR,
                    new Error(`Key supplied with unsupported METHOD: "${n.method}"`),
                  ),
                );
            }
          }
          loadKeyEME(e, t) {
            var r = { frag: t, keyInfo: e };
            if (this.emeController && this.config.emeEnabled) {
              var i;
              if (!e.decryptdata.keyId && null != (i = t.initSegment) && i.data) {
                var n = (function (e) {
                  var t = [];
                  return (Id(e, e => t.push(e.subarray(8, 24))), t);
                })(t.initSegment.data);
                if (n.length) {
                  var a = n[0];
                  (a.some(e => 0 !== e)
                    ? (this.log(`Using keyId found in init segment ${Xu(a)}`),
                      zc.setKeyIdForUri(e.decryptdata.uri, a))
                    : ((a = zc.addKeyIdForUri(e.decryptdata.uri)),
                      this.log(`Generating keyId to patch media ${Xu(a)}`)),
                    (e.decryptdata.keyId = a));
                }
              }
              if (!e.decryptdata.keyId && !sd(t)) return Promise.resolve(r);
              var s = this.emeController.loadKey(r);
              return (e.keyLoadPromise = s.then(t => ((e.mediaKeySessionContext = t), r))).catch(r => {
                throw ((e.keyLoadPromise = null), "data" in r && (r.data.frag = t), r);
              });
            }
            return Promise.resolve(r);
          }
          loadKeyHTTP(e, t) {
            var r = this.config,
              i = new (0, r.loader)(r);
            return (
              (t.keyLoader = e.loader = i),
              (e.keyLoadPromise = new Promise((n, a) => {
                var s = { keyInfo: e, frag: t, responseType: "arraybuffer", url: e.decryptdata.uri },
                  o = r.keyLoadPolicy.default,
                  l = {
                    loadPolicy: o,
                    timeout: o.maxLoadTimeMs,
                    maxRetry: 0,
                    retryDelay: 0,
                    maxRetryDelay: 0,
                  },
                  u = {
                    onSuccess: (e, t, r, i) => {
                      var s = r.frag,
                        o = r.keyInfo,
                        l = Sy(o.decryptdata);
                      if (!s.decryptdata || o !== this.keyIdToKeyInfo[l])
                        return a(
                          this.createKeyLoadError(
                            s,
                            wu.KEY_LOAD_ERROR,
                            new Error("after key load, decryptdata unset or changed"),
                            i,
                          ),
                        );
                      ((o.decryptdata.key = s.decryptdata.key = new Uint8Array(e.data)),
                        (s.keyLoader = null),
                        (o.loader = null),
                        n({ frag: s, keyInfo: o }));
                    },
                    onError: (e, r, i, n) => {
                      (this.resetLoader(r),
                        a(
                          this.createKeyLoadError(
                            t,
                            wu.KEY_LOAD_ERROR,
                            new Error(`HTTP Error ${e.code} loading key ${e.text}`),
                            i,
                            Uu({ url: s.url, data: void 0 }, e),
                          ),
                        ));
                    },
                    onTimeout: (e, r, i) => {
                      (this.resetLoader(r),
                        a(
                          this.createKeyLoadError(
                            t,
                            wu.KEY_LOAD_TIMEOUT,
                            new Error("key loading timed out"),
                            i,
                          ),
                        ));
                    },
                    onAbort: (e, r, i) => {
                      (this.resetLoader(r),
                        a(
                          this.createKeyLoadError(
                            t,
                            wu.INTERNAL_ABORTED,
                            new Error("key loading aborted"),
                            i,
                          ),
                        ));
                    },
                  };
                i.load(s, l, u);
              }))
            );
          }
          resetLoader(e) {
            var t = e.frag,
              r = e.keyInfo,
              i = e.url,
              n = r.loader;
            t.keyLoader === n && ((t.keyLoader = null), (r.loader = null));
            var a = Sy(r.decryptdata) || i;
            (delete this.keyIdToKeyInfo[a], n && n.destroy());
          }
        }
        function Sy(e) {
          if (e.keyFormat !== Fc) {
            var t = e.keyId;
            if (t) return Xu(t);
          }
          return e.uri;
        }
        function Ey(e) {
          switch (e.type) {
            case Ru:
              return Mu;
            case Cu:
              return Du;
            default:
              return Lu;
          }
        }
        function xy(e, t) {
          var r = e.url;
          return ((void 0 !== r && 0 !== r.indexOf("data:")) || (r = t.url), r);
        }
        class wy {
          constructor(e) {
            ((this.hls = void 0),
              (this.loaders = Object.create(null)),
              (this.variableList = null),
              (this.onManifestLoaded = this.checkAutostartLoad),
              (this.hls = e),
              this.registerListeners());
          }
          startLoad(e) {}
          stopLoad() {
            this.destroyInternalLoaders();
          }
          registerListeners() {
            var e = this.hls;
            (e.on(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.on(Au.LEVEL_LOADING, this.onLevelLoading, this),
              e.on(Au.AUDIO_TRACK_LOADING, this.onAudioTrackLoading, this),
              e.on(Au.SUBTITLE_TRACK_LOADING, this.onSubtitleTrackLoading, this),
              e.on(Au.LEVELS_UPDATED, this.onLevelsUpdated, this));
          }
          unregisterListeners() {
            var e = this.hls;
            (e.off(Au.MANIFEST_LOADING, this.onManifestLoading, this),
              e.off(Au.LEVEL_LOADING, this.onLevelLoading, this),
              e.off(Au.AUDIO_TRACK_LOADING, this.onAudioTrackLoading, this),
              e.off(Au.SUBTITLE_TRACK_LOADING, this.onSubtitleTrackLoading, this),
              e.off(Au.LEVELS_UPDATED, this.onLevelsUpdated, this));
          }
          createInternalLoader(e) {
            var t = this.hls.config,
              r = t.pLoader,
              i = t.loader,
              n = new (r || i)(t);
            return ((this.loaders[e.type] = n), n);
          }
          getInternalLoader(e) {
            return this.loaders[e.type];
          }
          resetInternalLoader(e) {
            this.loaders[e] && delete this.loaders[e];
          }
          destroyInternalLoaders() {
            for (var e in this.loaders) {
              var t = this.loaders[e];
              (t && t.destroy(), this.resetInternalLoader(e));
            }
          }
          destroy() {
            ((this.variableList = null), this.unregisterListeners(), this.destroyInternalLoaders());
          }
          onManifestLoading(e, t) {
            var r = t.url;
            ((this.variableList = null),
              this.load({
                id: null,
                level: 0,
                responseType: "text",
                type: Iu,
                url: r,
                deliveryDirectives: null,
                levelOrTrack: null,
              }));
          }
          onLevelLoading(e, t) {
            var r = t.id,
              i = t.level,
              n = t.pathwayId,
              a = t.url,
              s = t.deliveryDirectives,
              o = t.levelInfo;
            this.load({
              id: r,
              level: i,
              pathwayId: n,
              responseType: "text",
              type: ku,
              url: a,
              deliveryDirectives: s,
              levelOrTrack: o,
            });
          }
          onAudioTrackLoading(e, t) {
            var r = t.id,
              i = t.groupId,
              n = t.url,
              a = t.deliveryDirectives,
              s = t.track;
            this.load({
              id: r,
              groupId: i,
              level: null,
              responseType: "text",
              type: Ru,
              url: n,
              deliveryDirectives: a,
              levelOrTrack: s,
            });
          }
          onSubtitleTrackLoading(e, t) {
            var r = t.id,
              i = t.groupId,
              n = t.url,
              a = t.deliveryDirectives,
              s = t.track;
            this.load({
              id: r,
              groupId: i,
              level: null,
              responseType: "text",
              type: Cu,
              url: n,
              deliveryDirectives: a,
              levelOrTrack: s,
            });
          }
          onLevelsUpdated(e, t) {
            var r = this.loaders[ku];
            if (r) {
              var i = r.context;
              i && !t.levels.some(e => e === i.levelOrTrack) && (r.abort(), delete this.loaders[ku]);
            }
          }
          load(e) {
            var t,
              r,
              i,
              n = this.hls.config,
              a = this.getInternalLoader(e);
            if (a) {
              var s = this.hls.logger,
                o = a.context;
              if (
                o &&
                o.levelOrTrack === e.levelOrTrack &&
                (o.url === e.url || (o.deliveryDirectives && !e.deliveryDirectives))
              )
                return void (o.url === e.url
                  ? s.log(`[playlist-loader]: ignore ${e.url} ongoing request`)
                  : s.log(`[playlist-loader]: ignore ${e.url} in favor of ${o.url}`));
              (s.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`), a.abort());
            }
            if (
              ((r =
                e.type === Iu
                  ? n.manifestLoadPolicy.default
                  : Nu({}, n.playlistLoadPolicy.default, { timeoutRetry: null, errorRetry: null })),
              (a = this.createInternalLoader(e)),
              bu(null == (t = e.deliveryDirectives) ? void 0 : t.part)) &&
              (e.type === ku && null !== e.level
                ? (i = this.hls.levels[e.level].details)
                : e.type === Ru && null !== e.id
                  ? (i = this.hls.audioTracks[e.id].details)
                  : e.type === Cu && null !== e.id && (i = this.hls.subtitleTracks[e.id].details),
              i)
            ) {
              var l = i.partTarget,
                u = i.targetduration;
              if (l && u) {
                var d = 1e3 * Math.max(3 * l, 0.8 * u);
                r = Nu({}, r, {
                  maxTimeToFirstByteMs: Math.min(d, r.maxTimeToFirstByteMs),
                  maxLoadTimeMs: Math.min(d, r.maxTimeToFirstByteMs),
                });
              }
            }
            var h = r.errorRetry || r.timeoutRetry || {},
              c = {
                loadPolicy: r,
                timeout: r.maxLoadTimeMs,
                maxRetry: h.maxNumRetry || 0,
                retryDelay: h.retryDelayMs || 0,
                maxRetryDelay: h.maxRetryDelayMs || 0,
              },
              f = {
                onSuccess: (e, t, r, i) => {
                  var n = this.getInternalLoader(r);
                  this.resetInternalLoader(r.type);
                  var a = e.data;
                  ((t.parsing.start = performance.now()),
                    ef.isMediaPlaylist(a) || r.type !== Iu
                      ? this.handleTrackOrLevelPlaylist(e, t, r, i || null, n)
                      : this.handleMasterPlaylist(e, t, r, i));
                },
                onError: (e, t, r, i) => {
                  this.handleNetworkError(t, r, !1, e, i);
                },
                onTimeout: (e, t, r) => {
                  this.handleNetworkError(t, r, !0, void 0, e);
                },
              };
            a.load(e, c, f);
          }
          checkAutostartLoad() {
            if (this.hls) {
              var e = this.hls,
                t = e.config,
                r = t.autoStartLoad,
                i = t.startPosition,
                n = e.forceStartLoad;
              (r || n) &&
                (this.hls.logger.log(`${r ? "auto" : "force"} startLoad with configured startPosition ${i}`),
                this.hls.startLoad(i));
            }
          }
          handleMasterPlaylist(e, t, r, i) {
            var n = this.hls,
              a = e.data,
              s = xy(e, r),
              o = ef.parseMasterPlaylist(a, s);
            if (o.playlistParsingError)
              return (
                (t.parsing.end = performance.now()),
                void this.handleManifestParsingError(e, r, o.playlistParsingError, i, t)
              );
            var l = o.contentSteering,
              u = o.levels,
              d = o.sessionData,
              h = o.sessionKeys,
              c = o.startTimeOffset,
              f = o.variableList;
            ((this.variableList = f),
              u.forEach(e => {
                var t = e.unknownCodecs;
                if (t)
                  for (
                    var r = this.hls.config.preferManagedMediaSource,
                      i = e.audioCodec,
                      n = e.videoCodec,
                      a = t.length;
                    a--;
                  ) {
                    var s = t[a];
                    Bd(s, "audio", r)
                      ? ((e.audioCodec = i = i ? `${i},${s}` : s),
                        (Fd.audio[i.substring(0, 4)] = 2),
                        t.splice(a, 1))
                      : Bd(s, "video", r) &&
                        ((e.videoCodec = n = n ? `${n},${s}` : s),
                        (Fd.video[n.substring(0, 4)] = 2),
                        t.splice(a, 1));
                  }
              }));
            var p = ef.parseMasterPlaylistMedia(a, s, o),
              g = p.AUDIO,
              m = void 0 === g ? [] : g,
              v = p.SUBTITLES,
              y = p["CLOSED-CAPTIONS"];
            m.length &&
              (m.some(e => !e.url) ||
                !u[0].audioCodec ||
                u[0].attrs.AUDIO ||
                (this.hls.logger.log(
                  "[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one",
                ),
                m.unshift({
                  type: "main",
                  name: "main",
                  groupId: "main",
                  default: !1,
                  autoselect: !1,
                  forced: !1,
                  id: -1,
                  attrs: new Sc({}),
                  bitrate: 0,
                  url: "",
                })));
            n.trigger(Au.MANIFEST_LOADED, {
              levels: u,
              audioTracks: m,
              subtitles: v,
              captions: y,
              contentSteering: l,
              url: s,
              stats: t,
              networkDetails: i,
              sessionData: d,
              sessionKeys: h,
              startTimeOffset: c,
              variableList: f,
            });
          }
          handleTrackOrLevelPlaylist(e, t, r, i, n) {
            var a = this.hls,
              s = r.id,
              o = r.level,
              l = r.type,
              u = xy(e, r),
              d = bu(o) ? o : bu(s) ? s : 0,
              h = Ey(r),
              c = ef.parseLevelPlaylist(e.data, u, d, h, 0, this.variableList);
            if (l === Iu) {
              var f = { attrs: new Sc({}), bitrate: 0, details: c, name: "", url: u };
              ((c.requestScheduled = t.loading.start + Tf(c, 0)),
                a.trigger(Au.MANIFEST_LOADED, {
                  levels: [f],
                  audioTracks: [],
                  url: u,
                  stats: t,
                  networkDetails: i,
                  sessionData: null,
                  sessionKeys: null,
                  contentSteering: null,
                  startTimeOffset: null,
                  variableList: null,
                }));
            }
            ((t.parsing.end = performance.now()),
              (r.levelDetails = c),
              this.handlePlaylistLoaded(c, e, t, r, i, n));
          }
          handleManifestParsingError(e, t, r, i, n) {
            this.hls.trigger(Au.ERROR, {
              type: xu.NETWORK_ERROR,
              details: wu.MANIFEST_PARSING_ERROR,
              fatal: t.type === Iu,
              url: e.url,
              err: r,
              error: r,
              reason: r.message,
              response: e,
              context: t,
              networkDetails: i,
              stats: n,
            });
          }
          handleNetworkError(e, t, r = !1, i, n) {
            var a = `A network ${r ? "timeout" : "error" + (i ? " (status " + i.code + ")" : "")} occurred while loading ${e.type}`;
            e.type === ku
              ? (a += `: ${e.level} id: ${e.id}`)
              : (e.type !== Ru && e.type !== Cu) || (a += ` id: ${e.id} group-id: "${e.groupId}"`);
            var s = new Error(a);
            this.hls.logger.warn(`[playlist-loader]: ${a}`);
            var o = wu.UNKNOWN,
              l = !1,
              u = this.getInternalLoader(e);
            switch (e.type) {
              case Iu:
                ((o = r ? wu.MANIFEST_LOAD_TIMEOUT : wu.MANIFEST_LOAD_ERROR), (l = !0));
                break;
              case ku:
                ((o = r ? wu.LEVEL_LOAD_TIMEOUT : wu.LEVEL_LOAD_ERROR), (l = !1));
                break;
              case Ru:
                ((o = r ? wu.AUDIO_TRACK_LOAD_TIMEOUT : wu.AUDIO_TRACK_LOAD_ERROR), (l = !1));
                break;
              case Cu:
                ((o = r ? wu.SUBTITLE_TRACK_LOAD_TIMEOUT : wu.SUBTITLE_LOAD_ERROR), (l = !1));
            }
            u && this.resetInternalLoader(e.type);
            var d = {
              type: xu.NETWORK_ERROR,
              details: o,
              fatal: l,
              url: e.url,
              loader: u,
              context: e,
              error: s,
              networkDetails: t,
              stats: n,
            };
            if (i) {
              var h = (null == t ? void 0 : t.url) || e.url;
              d.response = Uu({ url: h, data: void 0 }, i);
            }
            this.hls.trigger(Au.ERROR, d);
          }
          handlePlaylistLoaded(e, t, r, i, n, a) {
            var s = this.hls,
              o = i.type,
              l = i.level,
              u = i.levelOrTrack,
              d = i.id,
              h = i.groupId,
              c = i.deliveryDirectives,
              f = xy(t, i),
              p = Ey(i),
              g = "number" == typeof i.level && p === Lu ? l : void 0,
              m = e.playlistParsingError;
            if (m) {
              if ((this.hls.logger.warn(`${m} ${e.url}`), !s.config.ignorePlaylistParsingErrors))
                return void s.trigger(Au.ERROR, {
                  type: xu.NETWORK_ERROR,
                  details: wu.LEVEL_PARSING_ERROR,
                  fatal: !1,
                  url: f,
                  error: m,
                  reason: m.message,
                  response: t,
                  context: i,
                  level: g,
                  parent: p,
                  networkDetails: n,
                  stats: r,
                });
              e.playlistParsingError = null;
            }
            if (e.fragments.length)
              switch (
                (e.live &&
                  a &&
                  (a.getCacheAge && (e.ageHeader = a.getCacheAge() || 0),
                  (a.getCacheAge && !isNaN(e.ageHeader)) || (e.ageHeader = 0)),
                o)
              ) {
                case Iu:
                case ku:
                  if (g)
                    if (u) {
                      if (u !== s.levels[g]) {
                        var v = s.levels.indexOf(u);
                        v > -1 && (g = v);
                      }
                    } else g = 0;
                  s.trigger(Au.LEVEL_LOADED, {
                    details: e,
                    levelInfo: u || s.levels[0],
                    level: g || 0,
                    id: d || 0,
                    stats: r,
                    networkDetails: n,
                    deliveryDirectives: c,
                    withoutMultiVariant: o === Iu,
                  });
                  break;
                case Ru:
                  s.trigger(Au.AUDIO_TRACK_LOADED, {
                    details: e,
                    track: u,
                    id: d || 0,
                    groupId: h || "",
                    stats: r,
                    networkDetails: n,
                    deliveryDirectives: c,
                  });
                  break;
                case Cu:
                  s.trigger(Au.SUBTITLE_TRACK_LOADED, {
                    details: e,
                    track: u,
                    id: d || 0,
                    groupId: h || "",
                    stats: r,
                    networkDetails: n,
                    deliveryDirectives: c,
                  });
              }
            else {
              var y = (e.playlistParsingError = new Error("No Segments found in Playlist"));
              s.trigger(Au.ERROR, {
                type: xu.NETWORK_ERROR,
                details: wu.LEVEL_EMPTY_ERROR,
                fatal: !1,
                url: f,
                error: y,
                reason: y.message,
                response: t,
                context: i,
                level: g,
                parent: p,
                networkDetails: n,
                stats: r,
              });
            }
          }
        }
        class Ay {
          static get version() {
            return Zf;
          }
          static isMSESupported() {
            return yy();
          }
          static isSupported() {
            return (function () {
              if (!yy()) return !1;
              var e = Wu();
              return (
                "function" == typeof (null == e ? void 0 : e.isTypeSupported) &&
                (["avc1.42E01E,mp4a.40.2", "av01.0.01M.08", "vp09.00.50.08"].some(t =>
                  e.isTypeSupported(jd(t, "video")),
                ) ||
                  ["mp4a.40.2", "fLaC"].some(t => e.isTypeSupported(jd(t, "audio"))))
              );
            })();
          }
          static getMediaSource() {
            return Wu();
          }
          static get Events() {
            return Au;
          }
          static get MetadataSchema() {
            return Ep;
          }
          static get ErrorTypes() {
            return xu;
          }
          static get ErrorDetails() {
            return wu;
          }
          static get DefaultConfig() {
            return Ay.defaultConfig ? Ay.defaultConfig : iy;
          }
          static set DefaultConfig(e) {
            Ay.defaultConfig = e;
          }
          constructor(e = {}) {
            ((this.config = void 0),
              (this.userConfig = void 0),
              (this.logger = void 0),
              (this.coreComponents = void 0),
              (this.networkControllers = void 0),
              (this._emitter = new Jf()),
              (this._autoLevelCapping = -1),
              (this._maxHdcpLevel = null),
              (this.abrController = void 0),
              (this.bufferController = void 0),
              (this.capLevelController = void 0),
              (this.latencyController = void 0),
              (this.levelController = void 0),
              (this.streamController = void 0),
              (this.audioStreamController = void 0),
              (this.subtititleStreamController = void 0),
              (this.audioTrackController = void 0),
              (this.subtitleTrackController = void 0),
              (this.interstitialsController = void 0),
              (this.gapController = void 0),
              (this.emeController = void 0),
              (this.cmcdController = void 0),
              (this._media = null),
              (this._url = null),
              (this._sessionId = void 0),
              (this.triggeringException = void 0),
              (this.started = !1));
            var t = (this.logger = (function (e, t, r) {
                var i = Gu();
                if (("object" == typeof console && !0 === e) || "object" == typeof e) {
                  var n = ["debug", "log", "info", "warn", "error"];
                  n.forEach(t => {
                    i[t] = Vu(t, e, r);
                  });
                  try {
                    i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.15`);
                  } catch (a) {
                    return Gu();
                  }
                  n.forEach(t => {
                    Hu[t] = Vu(t, e);
                  });
                } else Nu(Hu, i);
                return i;
              })(e.debug || !1, "Hls instance", e.assetPlayerId)),
              r = (this.config = (function (e, t, r) {
                if (
                  (t.liveSyncDurationCount || t.liveMaxLatencyDurationCount) &&
                  (t.liveSyncDuration || t.liveMaxLatencyDuration)
                )
                  throw new Error(
                    "Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration",
                  );
                if (
                  void 0 !== t.liveMaxLatencyDurationCount &&
                  (void 0 === t.liveSyncDurationCount ||
                    t.liveMaxLatencyDurationCount <= t.liveSyncDurationCount)
                )
                  throw new Error(
                    'Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"',
                  );
                if (
                  void 0 !== t.liveMaxLatencyDuration &&
                  (void 0 === t.liveSyncDuration || t.liveMaxLatencyDuration <= t.liveSyncDuration)
                )
                  throw new Error(
                    'Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"',
                  );
                var i = ny(e),
                  n = ["TimeOut", "MaxRetry", "RetryDelay", "MaxRetryTimeout"];
                return (
                  ["manifest", "level", "frag"].forEach(e => {
                    var a = `${"level" === e ? "playlist" : e}LoadPolicy`,
                      s = void 0 === t[a],
                      o = [];
                    (n.forEach(r => {
                      var n = `${e}Loading${r}`,
                        l = t[n];
                      if (void 0 !== l && s) {
                        o.push(n);
                        var u = i[a].default;
                        switch (((t[a] = { default: u }), r)) {
                          case "TimeOut":
                            ((u.maxLoadTimeMs = l), (u.maxTimeToFirstByteMs = l));
                            break;
                          case "MaxRetry":
                            ((u.errorRetry.maxNumRetry = l), (u.timeoutRetry.maxNumRetry = l));
                            break;
                          case "RetryDelay":
                            ((u.errorRetry.retryDelayMs = l), (u.timeoutRetry.retryDelayMs = l));
                            break;
                          case "MaxRetryTimeout":
                            ((u.errorRetry.maxRetryDelayMs = l), (u.timeoutRetry.maxRetryDelayMs = l));
                        }
                      }
                    }),
                      o.length &&
                        r.warn(
                          `hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${a}": ${ph(t[a])}`,
                        ));
                  }),
                  Uu(Uu({}, i), t)
                );
              })(Ay.DefaultConfig, e, t));
            ((this.userConfig = e), r.progressive && ay(r, t));
            var i = r.abrController,
              n = r.bufferController,
              a = r.capLevelController,
              s = r.errorController,
              o = r.fpsController,
              l = new s(this),
              u = (this.abrController = new i(this)),
              d = new Xh(this),
              h = r.interstitialsController,
              c = h ? (this.interstitialsController = new h(this, Ay)) : null,
              f = (this.bufferController = new n(this, d)),
              p = (this.capLevelController = new a(this)),
              g = new o(this),
              m = new wy(this),
              v = r.contentSteeringController,
              y = v ? new v(this) : null,
              T = (this.levelController = new gy(this, y)),
              b = new fy(this),
              S = new by(this.config, this.logger),
              E = (this.streamController = new Ty(this, d, S)),
              x = (this.gapController = new sy(this, d));
            (p.setStreamController(E), g.setStreamController(E));
            var w = [m, T, E];
            (c && w.splice(1, 0, c), y && w.splice(1, 0, y), (this.networkControllers = w));
            var A = [u, f, x, p, g, b, d];
            this.audioTrackController = this.createController(r.audioTrackController, w);
            var I = r.audioStreamController;
            (I && w.push((this.audioStreamController = new I(this, d, S))),
              (this.subtitleTrackController = this.createController(r.subtitleTrackController, w)));
            var k = r.subtitleStreamController;
            (k && w.push((this.subtititleStreamController = new k(this, d, S))),
              this.createController(r.timelineController, A),
              (S.emeController = this.emeController = this.createController(r.emeController, A)),
              (this.cmcdController = this.createController(r.cmcdController, A)),
              (this.latencyController = this.createController(py, A)),
              (this.coreComponents = A),
              w.push(l));
            var R = l.onErrorOut;
            ("function" == typeof R && this.on(Au.ERROR, R, l),
              this.on(Au.MANIFEST_LOADED, m.onManifestLoaded, m));
          }
          createController(e, t) {
            if (e) {
              var r = new e(this);
              return (t && t.push(r), r);
            }
            return null;
          }
          on(e, t, r = this) {
            this._emitter.on(e, t, r);
          }
          once(e, t, r = this) {
            this._emitter.once(e, t, r);
          }
          removeAllListeners(e) {
            this._emitter.removeAllListeners(e);
          }
          off(e, t, r = this, i) {
            this._emitter.off(e, t, r, i);
          }
          listeners(e) {
            return this._emitter.listeners(e);
          }
          emit(e, t, r) {
            return this._emitter.emit(e, t, r);
          }
          trigger(e, t) {
            if (this.config.debug) return this.emit(e, e, t);
            try {
              return this.emit(e, e, t);
            } catch (i) {
              if (
                (this.logger.error(
                  "An internal error happened while handling event " +
                    e +
                    '. Error message: "' +
                    i.message +
                    '". Here is a stacktrace:',
                  i,
                ),
                !this.triggeringException)
              ) {
                this.triggeringException = !0;
                var r = e === Au.ERROR;
                (this.trigger(Au.ERROR, {
                  type: xu.OTHER_ERROR,
                  details: wu.INTERNAL_EXCEPTION,
                  fatal: r,
                  event: e,
                  error: i,
                }),
                  (this.triggeringException = !1));
              }
            }
            return !1;
          }
          listenerCount(e) {
            return this._emitter.listenerCount(e);
          }
          destroy() {
            (this.logger.log("destroy"),
              this.trigger(Au.DESTROYING, void 0),
              this.detachMedia(),
              this.removeAllListeners(),
              (this._autoLevelCapping = -1),
              (this._url = null),
              this.networkControllers.forEach(e => e.destroy()),
              (this.networkControllers.length = 0),
              this.coreComponents.forEach(e => e.destroy()),
              (this.coreComponents.length = 0));
            var e = this.config;
            ((e.xhrSetup = e.fetchSetup = void 0), (this.userConfig = null));
          }
          attachMedia(e) {
            if (!e || ("media" in e && !e.media)) {
              var t = new Error(`attachMedia failed: invalid argument (${e})`);
              this.trigger(Au.ERROR, {
                type: xu.OTHER_ERROR,
                details: wu.ATTACH_MEDIA_ERROR,
                fatal: !0,
                error: t,
              });
            } else {
              (this.logger.log("attachMedia"),
                this._media &&
                  (this.logger.warn("media must be detached before attaching"), this.detachMedia()));
              var r = "media" in e,
                i = r ? e.media : e,
                n = r ? e : { media: i };
              ((this._media = i), this.trigger(Au.MEDIA_ATTACHING, n));
            }
          }
          detachMedia() {
            (this.logger.log("detachMedia"), this.trigger(Au.MEDIA_DETACHING, {}), (this._media = null));
          }
          transferMedia() {
            this._media = null;
            var e = this.bufferController.transferMedia();
            return (this.trigger(Au.MEDIA_DETACHING, { transferMedia: e }), e);
          }
          loadSource(e) {
            this.stopLoad();
            var t = this.media,
              r = this._url,
              i = (this._url = ed.buildAbsoluteURL(self.location.href, e, { alwaysNormalize: !0 }));
            ((this._autoLevelCapping = -1),
              (this._maxHdcpLevel = null),
              this.logger.log(`loadSource:${i}`),
              t &&
                r &&
                (r !== i || this.bufferController.hasSourceTypes()) &&
                (this.detachMedia(), this.attachMedia(t)),
              this.trigger(Au.MANIFEST_LOADING, { url: e }));
          }
          get url() {
            return this._url;
          }
          get hasEnoughToStart() {
            return this.streamController.hasEnoughToStart;
          }
          get startPosition() {
            return this.streamController.startPositionValue;
          }
          startLoad(e = -1, t) {
            (this.logger.log(`startLoad(${e + (t ? ", <skip seek to start>" : "")})`),
              (this.started = !0),
              this.resumeBuffering());
            for (
              var r = 0;
              r < this.networkControllers.length &&
              (this.networkControllers[r].startLoad(e, t), this.started && this.networkControllers);
              r++
            );
          }
          stopLoad() {
            (this.logger.log("stopLoad"), (this.started = !1));
            for (
              var e = 0;
              e < this.networkControllers.length &&
              (this.networkControllers[e].stopLoad(), !this.started && this.networkControllers);
              e++
            );
          }
          get loadingEnabled() {
            return this.started;
          }
          get bufferingEnabled() {
            return this.streamController.bufferingEnabled;
          }
          resumeBuffering() {
            this.bufferingEnabled ||
              (this.logger.log("resume buffering"),
              this.networkControllers.forEach(e => {
                e.resumeBuffering && e.resumeBuffering();
              }));
          }
          pauseBuffering() {
            this.bufferingEnabled &&
              (this.logger.log("pause buffering"),
              this.networkControllers.forEach(e => {
                e.pauseBuffering && e.pauseBuffering();
              }));
          }
          get inFlightFragments() {
            var e = { [Lu]: this.streamController.inFlightFrag };
            return (
              this.audioStreamController && (e[Mu] = this.audioStreamController.inFlightFrag),
              this.subtititleStreamController && (e[Du] = this.subtititleStreamController.inFlightFrag),
              e
            );
          }
          swapAudioCodec() {
            (this.logger.log("swapAudioCodec"), this.streamController.swapAudioCodec());
          }
          recoverMediaError() {
            this.logger.log("recoverMediaError");
            var e = this._media,
              t = null == e ? void 0 : e.currentTime;
            (this.detachMedia(), e && (this.attachMedia(e), t && this.startLoad(t)));
          }
          removeLevel(e) {
            this.levelController.removeLevel(e);
          }
          get sessionId() {
            var e = this._sessionId;
            return (
              e ||
                (e = this._sessionId =
                  (function () {
                    try {
                      return crypto.randomUUID();
                    } catch (i) {
                      try {
                        var e = URL.createObjectURL(new Blob()),
                          t = e.toString();
                        return (URL.revokeObjectURL(e), t.slice(t.lastIndexOf("/") + 1));
                      } catch (i) {
                        var r = new Date().getTime();
                        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, e => {
                          var t = ((r + 16 * Math.random()) % 16) | 0;
                          return ((r = Math.floor(r / 16)), ("x" == e ? t : (3 & t) | 8).toString(16));
                        });
                      }
                    }
                  })()),
              e
            );
          }
          get levels() {
            var e = this.levelController.levels;
            return e || [];
          }
          get latestLevelDetails() {
            return this.streamController.getLevelDetails() || null;
          }
          get loadLevelObj() {
            return this.levelController.loadLevelObj;
          }
          get currentLevel() {
            return this.streamController.currentLevel;
          }
          set currentLevel(e) {
            (this.logger.log(`set currentLevel:${e}`),
              (this.levelController.manualLevel = e),
              this.streamController.immediateLevelSwitch());
          }
          get nextLevel() {
            return this.streamController.nextLevel;
          }
          set nextLevel(e) {
            (this.logger.log(`set nextLevel:${e}`),
              (this.levelController.manualLevel = e),
              this.streamController.nextLevelSwitch());
          }
          get loadLevel() {
            return this.levelController.level;
          }
          set loadLevel(e) {
            (this.logger.log(`set loadLevel:${e}`), (this.levelController.manualLevel = e));
          }
          get nextLoadLevel() {
            return this.levelController.nextLoadLevel;
          }
          set nextLoadLevel(e) {
            this.levelController.nextLoadLevel = e;
          }
          get firstLevel() {
            return Math.max(this.levelController.firstLevel, this.minAutoLevel);
          }
          set firstLevel(e) {
            (this.logger.log(`set firstLevel:${e}`), (this.levelController.firstLevel = e));
          }
          get startLevel() {
            var e = this.levelController.startLevel;
            return -1 === e && this.abrController.forcedAutoLevel > -1
              ? this.abrController.forcedAutoLevel
              : e;
          }
          set startLevel(e) {
            (this.logger.log(`set startLevel:${e}`),
              -1 !== e && (e = Math.max(e, this.minAutoLevel)),
              (this.levelController.startLevel = e));
          }
          get capLevelToPlayerSize() {
            return this.config.capLevelToPlayerSize;
          }
          set capLevelToPlayerSize(e) {
            var t = !!e;
            t !== this.config.capLevelToPlayerSize &&
              (t
                ? this.capLevelController.startCapping()
                : (this.capLevelController.stopCapping(),
                  (this.autoLevelCapping = -1),
                  this.streamController.nextLevelSwitch()),
              (this.config.capLevelToPlayerSize = t));
          }
          get autoLevelCapping() {
            return this._autoLevelCapping;
          }
          get bandwidthEstimate() {
            var e = this.abrController.bwEstimator;
            return e ? e.getEstimate() : NaN;
          }
          set bandwidthEstimate(e) {
            this.abrController.resetEstimator(e);
          }
          get abrEwmaDefaultEstimate() {
            var e = this.abrController.bwEstimator;
            return e ? e.defaultEstimate : NaN;
          }
          get ttfbEstimate() {
            var e = this.abrController.bwEstimator;
            return e ? e.getEstimateTTFB() : NaN;
          }
          set autoLevelCapping(e) {
            this._autoLevelCapping !== e &&
              (this.logger.log(`set autoLevelCapping:${e}`),
              (this._autoLevelCapping = e),
              this.levelController.checkMaxAutoUpdated());
          }
          get maxHdcpLevel() {
            return this._maxHdcpLevel;
          }
          set maxHdcpLevel(e) {
            (function (e) {
              return nh.indexOf(e) > -1;
            })(e) &&
              this._maxHdcpLevel !== e &&
              ((this._maxHdcpLevel = e), this.levelController.checkMaxAutoUpdated());
          }
          get autoLevelEnabled() {
            return -1 === this.levelController.manualLevel;
          }
          get manualLevel() {
            return this.levelController.manualLevel;
          }
          get minAutoLevel() {
            var e = this.levels,
              t = this.config.minAutoBitrate;
            if (!e) return 0;
            for (var r = e.length, i = 0; i < r; i++) if (e[i].maxBitrate >= t) return i;
            return 0;
          }
          get maxAutoLevel() {
            var e,
              t = this.levels,
              r = this.autoLevelCapping,
              i = this.maxHdcpLevel;
            if (((e = -1 === r && null != t && t.length ? t.length - 1 : r), i))
              for (var n = e; n--; ) {
                var a = t[n].attrs["HDCP-LEVEL"];
                if (a && a <= i) return n;
              }
            return e;
          }
          get firstAutoLevel() {
            return this.abrController.firstAutoLevel;
          }
          get nextAutoLevel() {
            return this.abrController.nextAutoLevel;
          }
          set nextAutoLevel(e) {
            this.abrController.nextAutoLevel = e;
          }
          get playingDate() {
            return this.streamController.currentProgramDateTime;
          }
          get mainForwardBufferInfo() {
            return this.streamController.getMainFwdBufferInfo();
          }
          get maxBufferLength() {
            return this.streamController.maxBufferLength;
          }
          setAudioOption(e) {
            var t;
            return (null == (t = this.audioTrackController) ? void 0 : t.setAudioOption(e)) || null;
          }
          setSubtitleOption(e) {
            var t;
            return (null == (t = this.subtitleTrackController) ? void 0 : t.setSubtitleOption(e)) || null;
          }
          get allAudioTracks() {
            var e = this.audioTrackController;
            return e ? e.allAudioTracks : [];
          }
          get audioTracks() {
            var e = this.audioTrackController;
            return e ? e.audioTracks : [];
          }
          get audioTrack() {
            var e = this.audioTrackController;
            return e ? e.audioTrack : -1;
          }
          set audioTrack(e) {
            var t = this.audioTrackController;
            t && (t.audioTrack = e);
          }
          get allSubtitleTracks() {
            var e = this.subtitleTrackController;
            return e ? e.allSubtitleTracks : [];
          }
          get subtitleTracks() {
            var e = this.subtitleTrackController;
            return e ? e.subtitleTracks : [];
          }
          get subtitleTrack() {
            var e = this.subtitleTrackController;
            return e ? e.subtitleTrack : -1;
          }
          get media() {
            return this._media;
          }
          set subtitleTrack(e) {
            var t = this.subtitleTrackController;
            t && (t.subtitleTrack = e);
          }
          get subtitleDisplay() {
            var e = this.subtitleTrackController;
            return !!e && e.subtitleDisplay;
          }
          set subtitleDisplay(e) {
            var t = this.subtitleTrackController;
            t && (t.subtitleDisplay = e);
          }
          get lowLatencyMode() {
            return this.config.lowLatencyMode;
          }
          set lowLatencyMode(e) {
            this.config.lowLatencyMode = e;
          }
          get liveSyncPosition() {
            return this.latencyController.liveSyncPosition;
          }
          get latency() {
            return this.latencyController.latency;
          }
          get maxLatency() {
            return this.latencyController.maxLatency;
          }
          get targetLatency() {
            return this.latencyController.targetLatency;
          }
          set targetLatency(e) {
            this.latencyController.targetLatency = e;
          }
          get drift() {
            return this.latencyController.drift;
          }
          get forceStartLoad() {
            return this.streamController.forceStartLoad;
          }
          get pathways() {
            return this.levelController.pathways;
          }
          get pathwayPriority() {
            return this.levelController.pathwayPriority;
          }
          set pathwayPriority(e) {
            this.levelController.pathwayPriority = e;
          }
          get bufferedToEnd() {
            var e;
            return !(null == (e = this.bufferController) || !e.bufferedToEnd);
          }
          get interstitialsManager() {
            var e;
            return (null == (e = this.interstitialsController) ? void 0 : e.interstitialsManager) || null;
          }
          getMediaDecodingInfo(e, t = this.allAudioTracks) {
            return th(e, mh(t), navigator.mediaCapabilities);
          }
        }
        Ay.defaultConfig = void 0;
        var Iy = null,
          ky = null,
          Ry = !1,
          Cy = r(Gr(!1), 2),
          Ly = Cy[0],
          My = Cy[1],
          Dy = r(Gr(0), 2),
          _y = Dy[0],
          Py = Dy[1],
          Oy = r(Gr(0), 2),
          Ny = Oy[0],
          Fy = Oy[1],
          Uy = r(Gr(!1), 2),
          By = Uy[0],
          $y = Uy[1],
          jy = e => {
            !Ry && ky && e();
          },
          Gy = e => {
            ((Ry = !1),
              (Iy = new Ay({
                debug: !1,
                enableWorker: !1,
                liveBackBufferLength: 30,
                maxBufferLength: 30,
                backBufferLength: 30,
              })),
              e instanceof HTMLVideoElement
                ? (ky = e)
                : (((ky = document.createElement("video")).style.cssText =
                    "position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1"),
                  (ky.preload = "auto"),
                  (ky.autoplay = !1),
                  (ky.muted = !1),
                  (ky.playsInline = !0),
                  ky.setAttribute("webkit-playsinline", "true"),
                  document.body.insertBefore(ky, document.body.firstChild)),
              ky &&
                (ky.addEventListener("playing", () => jy(() => My(!0))),
                ky.addEventListener("pause", () => jy(() => My(!1))),
                ky.addEventListener("timeupdate", () => jy(() => Py(ky.currentTime))),
                ky.addEventListener("loadedmetadata", () =>
                  jy(() => {
                    (Fy(ky.duration || 0), Ya(!1), $y(!1));
                  }),
                ),
                ky.addEventListener("waiting", () => jy(() => $y(!0))),
                ky.addEventListener("canplay", () => jy(() => $y(!1))),
                ky.addEventListener("seeking", () => jy(() => $y(!0)))));
          },
          Vy = e => {
            Iy && ky && !Ry && (Ya(!0), $y(!0), Iy.attachMedia(ky), Ry || Iy.loadSource(e.streamUrl));
          },
          Hy = (function () {
            var e = s(
              i().m(function e() {
                return i().w(function (e) {
                  for (;;)
                    switch (e.n) {
                      case 0:
                        if (ky && !Ry) {
                          e.n = 1;
                          break;
                        }
                        return e.a(2);
                      case 1:
                        return ((e.n = 2), ky.play().catch(() => {}));
                      case 2:
                        return e.a(2);
                    }
                }, e);
              }),
            );
            return function () {
              return e.apply(this, arguments);
            };
          })(),
          Ky = () => {
            if (((Ry = !0), Iy)) {
              try {
                (Iy.stopLoad(), Iy.detachMedia(), Iy.destroy());
              } catch (e) {}
              Iy = null;
            }
            if (ky) {
              try {
                (ky.pause(), ky.removeAttribute("src"), ky.load(), ky.remove());
              } catch (t) {}
              ky = null;
            }
            (My(!1), $y(!1), Py(0), Fy(0), Ya(!1));
          },
          Wy = e => {
            var t = Math.floor(e / 3600),
              r = Math.floor((e % 3600) / 60),
              i = Math.floor(e % 60);
            return `${String(t).padStart(2, "0")}:${String(r).padStart(2, "0")}:${String(i).padStart(2, "0")}`;
          },
          zy = "static/images/player/",
          qy = { width: 66, height: 66, color: 4294967117, $focus: { color: 3978044671 } },
          Xy = { fontFace: "Inter", fontWeight: 700, fontSize: 26, lineHeight: 1, letterSpacing: 0 },
          Yy = () => {
            var e,
              t,
              r,
              n = vn(),
              a = () => {
                Ly() ? ky && !Ry && ky.pause() : Hy();
              },
              o = () => {
                ky && !Ry && (ky.currentTime = Math.max(ky.currentTime - 5, 0));
              },
              l = () => {
                ky && !Ry && (ky.currentTime = Math.min(ky.currentTime + 5, ky.duration || 1 / 0));
              },
              u = () => {
                (n(-1), Ky());
              };
            return (
              Ca("navbar"),
              Oa(" "),
              Xr(
                s(
                  i().m(function t() {
                    return i().w(function (t) {
                      for (;;)
                        switch (t.n) {
                          case 0:
                            (ls(!0),
                              Ya(!0),
                              (e = document.querySelector('[data-testid="player"]')),
                              Gy(e),
                              Vy({ streamUrl: "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8" }),
                              document.querySelector("video"),
                              Hy());
                          case 1:
                            return t.a(2);
                        }
                    }, t);
                  }),
                ),
              ),
              Yr(() => {
                (ls(!1), Ky());
              }),
              [
                Vi(ki, {
                  get when() {
                    return !Xa();
                  },
                  get fallback() {
                    return Vi(eu, {});
                  },
                  get children() {
                    return Vi(Ji, {
                      onBackspace: () => {
                        (Ky(), n(-1));
                      },
                      get children() {
                        return [
                          Vi(Ji, {
                            id: "gradient",
                            width: 1920,
                            height: 1080,
                            colorBottom: 255,
                            colorTop: "#0000000",
                          }),
                          Vi(Ji, {
                            display: "flex",
                            flexDirection: "column",
                            justifyContent: "center",
                            width: 1680,
                            height: 126,
                            x: 115,
                            y: 836,
                            color: "#0000000",
                            scroll: "none",
                            get children() {
                              return [
                                Vi(Ji, {
                                  get children() {
                                    return [
                                      Vi(Ji, {
                                        style: qy,
                                        src: zy + "back.png",
                                        onEnter: u,
                                        ref(e) {
                                          "function" == typeof t ? t(e) : (t = e);
                                        },
                                        onRight: () => {
                                          var e;
                                          null === (e = r) || void 0 === e || e.setFocus();
                                        },
                                      }),
                                      Vi(wa, {
                                        ref(e) {
                                          "function" == typeof r ? r(e) : (r = e);
                                        },
                                        width: 1690,
                                        height: 60,
                                        alignItems: "center",
                                        justifyContent: "center",
                                        scroll: "none",
                                        autofocus: !0,
                                        selected: 1,
                                        onLeft: () => {
                                          var e;
                                          null === (e = t) || void 0 === e || e.setFocus();
                                        },
                                        onUp: e => {
                                          e.stopPropagation();
                                        },
                                        get children() {
                                          return [
                                            Vi(Ji, {
                                              style: qy,
                                              src: zy + "rewind.png",
                                              onEnter: o,
                                              width: 66,
                                              height: 66,
                                            }),
                                            Vi(Ji, {
                                              style: qy,
                                              get src() {
                                                return zy + (Ly() ? "pause.png" : "play.png");
                                              },
                                              onEnter: a,
                                              width: 90,
                                              height: 90,
                                            }),
                                            Vi(Ji, {
                                              style: qy,
                                              src: zy + "forward.png",
                                              onEnter: l,
                                              width: 66,
                                              height: 66,
                                            }),
                                          ];
                                        },
                                      }),
                                    ];
                                  },
                                }),
                                Vi(Ji, {
                                  height: 31,
                                  display: "flex",
                                  flexDirection: "row",
                                  justifyContent: "spaceBetween",
                                  alignItems: "center",
                                  get children() {
                                    return [
                                      Vi(Zi, {
                                        style: Xy,
                                        width: 119,
                                        height: 31,
                                        get children() {
                                          return Wy(_y());
                                        },
                                      }),
                                      Vi(Ji, {
                                        width: 1404,
                                        height: 9,
                                        color: 3654932764,
                                        get children() {
                                          return Vi(Ji, {
                                            color: 3978044671,
                                            get width() {
                                              return (_y() / Ny()) * 1404;
                                            },
                                          });
                                        },
                                      }),
                                      Vi(Zi, {
                                        style: Xy,
                                        width: 119,
                                        height: 31,
                                        get children() {
                                          return Wy(Ny());
                                        },
                                      }),
                                    ];
                                  },
                                }),
                              ];
                            },
                          }),
                        ];
                      },
                    });
                  },
                }),
                Vi(ki, {
                  get when() {
                    return By();
                  },
                  get children() {
                    return Vi(eu, {});
                  },
                }),
              ]
            );
          };
        nl(Ft, ml.lightning);
        var Qy,
          Jy = ((Qy = Ft.rendererOptions),
          (Fi = (function (e, t = "app") {
            return (Ot = new vt(e, t));
          })(Qy, "app")),
          (Ft.setActiveElement = Li),
          ($i.lng = Fi.root),
          ($i.rendered = !0),
          Fi.on("idle", () => {
            ((Xi = !0), Yi());
          }),
          { renderer: Fi, rootNode: $i, render: ji }).render;
        (!(function (e) {
          var r,
            i = l(e);
          try {
            for (i.s(); !(r = i.n()).done; ) {
              var n = r.value;
              "webgl" !== Ot.stage.renderer.mode || !("type" in n) || ("msdf" !== n.type && "ssdf" !== n.type)
                ? "fontUrl" in n && Ot.stage.fontManager.addFontFace(new Tt(n))
                : Ot.stage.fontManager.addFontFace(new Pt(n.type, t(t({}, n), {}, { stage: Ot.stage })));
            }
          } catch (Zy) {
            i.e(Zy);
          } finally {
            i.f();
          }
        })(cs),
          Jy(
            () => (
              ((e, t) => {
                var r = Qr(),
                  i = Jr.bind(void 0, r);
                Ft.setActiveElement = e => i(() => Li(e));
                var n = dr({ userKeyMap: e, keyHoldOptions: t, ownerContext: i }),
                  a = n.cleanup,
                  s = n.focusPath;
                (Hr(
                  qr(
                    Ci,
                    () => {
                      Dn([...s()]);
                    },
                    { defer: !0 },
                  ),
                ),
                  Yr(a));
              })(ml.keys, ml.keyHoldOptions),
              Vi(Ia, {
                get children() {
                  return Vi(ta, {
                    root: ds,
                    get children() {
                      return [
                        Vi(Da, {
                          id: "navbar",
                          path: "",
                          component: Pl,
                          get children() {
                            return [
                              Vi(Da, {
                                id: "home",
                                path: "/",
                                component: ru,
                                preload: Il,
                                shouldDispose: () => "/movies" === Ja(),
                              }),
                              Vi(Da, {
                                id: "movies",
                                path: "/movies",
                                component: lu,
                                preload: kl,
                                shouldDispose: () => "/" === Ja(),
                              }),
                            ];
                          },
                        }),
                        Vi(Rn, { path: "/:mediaType/details/:id", component: Tu }),
                        Vi(Rn, {
                          path: "player",
                          get children() {
                            return Vi(Rn, { component: Yy });
                          },
                        }),
                      ];
                    },
                  });
                },
              })
            ),
          ));
      },
    };
  });
})();
