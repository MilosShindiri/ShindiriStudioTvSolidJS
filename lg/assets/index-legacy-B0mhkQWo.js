!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach(function(e){s(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function s(n,r,a,o){var s=r&&r.prototype instanceof l?r:l,d=Object.create(s.prototype);return i(d,"_invoke",function(n,r,i){var a,o,s,l=0,d=i||[],c=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,o=0,s=e,h.n=n,u}};function p(n,r){for(o=n,s=r,t=0;!c&&l&&!i&&t<d.length;t++){var i,a=d[t],p=h.p,f=a[2];n>3?(i=f===r)&&(s=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((i=n<2&&p<a[1])?(o=0,h.v=r,h.n=a[1]):p<f&&(i=n<3||a[0]>r||r>f)&&(a[4]=n,a[5]=r,h.n=f,o=0))}if(i||n>1)return u;throw c=!0,r}return function(i,d,f){if(l>1)throw TypeError("Generator is already running");for(c&&1===d&&p(d,f),o=d,s=f;(t=o<2?e:s)||!c;){a||(o?o<3?(o>1&&(h.n=-1),p(o,s)):h.n=s:h.v=s);try{if(l=2,a){if(o||(i="next"),t=a[i]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,o<2&&(o=0)}else 1===o&&(t=a.return)&&t.call(a),o<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),o=1);a=e}else if((t=(c=h.n<0)?s:n.call(r,h))!==u)break}catch(t){a=e,o=1,s=t}finally{l=1}}return{value:t,done:c}}}(n,a,o),!0),d}var u={};function l(){}function d(){}function c(){}t=Object.getPrototypeOf;var h=[][a]?t(t([][a]())):(i(t={},a,function(){return this}),t),p=c.prototype=l.prototype=Object.create(h);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,i(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=c,i(p,"constructor",c),i(c,"constructor",d),d.displayName="GeneratorFunction",i(c,o,"GeneratorFunction"),i(p),i(p,o,"Generator"),i(p,a,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:s,m:f}})()}function i(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}i=function(e,t,n,r){function o(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},i(e,t,n,r)}function a(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)})}}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}System.register([],function(e,i){"use strict";return{execute:function(){var a=r().m($o);e({F:function(e){var t="fallback"in e&&{fallback:()=>e.fallback};return Yn(function(e,t,r={}){var i=[],a=[],o=[],s=0,u=t.length>1?[]:null;return Zn(()=>wr(o)),()=>{var l,d,c=e()||[],h=c.length;return c[Pn],Jn(()=>{var e,t,n,f,g,m,v,y,b;if(0===h)0!==s&&(wr(o),o=[],i=[],a=[],s=0,u&&(u=[])),r.fallback&&(i=[Tr],a[0]=Xn(e=>(o[0]=e,r.fallback())),s=1);else if(0===s){for(a=new Array(h),d=0;d<h;d++)i[d]=c[d],a[d]=Xn(p);s=h}else{for(n=new Array(h),f=new Array(h),u&&(g=new Array(h)),m=0,v=Math.min(s,h);m<v&&i[m]===c[m];m++);for(v=s-1,y=h-1;v>=m&&y>=m&&i[v]===c[y];v--,y--)n[y]=a[v],f[y]=o[v],u&&(g[y]=u[v]);for(e=new Map,t=new Array(y+1),d=y;d>=m;d--)b=c[d],l=e.get(b),t[d]=void 0===l?-1:l,e.set(b,d);for(l=m;l<=v;l++)b=i[l],void 0!==(d=e.get(b))&&-1!==d?(n[d]=a[l],f[d]=o[l],u&&(g[d]=u[l]),d=t[d],e.set(b,d)):o[l]();for(d=m;d<h;d++)d in n?(a[d]=n[d],o[d]=f[d],u&&(u[d]=g[d],u[d](d))):a[d]=Xn(p);a=a.slice(0,s=h),i=c.slice(0)}return a});function p(e){if(o[d]=e,u){var r=n(Wn(d),2),i=r[0],a=r[1];return u[d]=a,t(c[d],i)}return t(c[d])}}}(()=>e.each,e.children,t||void 0))},b:Wn,g:function(e,t=ss){return as+t+e},i:function(e){var t;return null==e||null===(t=e.states)||void 0===t?void 0:t.has(Bt.focusStateKey)}});var l=function(e,t,n){var r=Promise.resolve();function i(e){var t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{var n,r=u(t||[]);try{for(r.s();!(n=r.n()).done;){var a=n.value;"rejected"===a.status&&i(a.reason)}}catch(o){r.e(o)}finally{r.f()}return e().catch(i)})};function d(e,t){}function c(e,t,n){var r=Math.trunc(e>>>24),i=Math.trunc(e>>>16&255),a=Math.trunc(e>>>8&255),o=Math.trunc(255&e),s=Math.trunc(t>>>24),u=Math.trunc(t>>>16&255),l=Math.trunc(t>>>8&255),d=Math.trunc(255&t);return(Math.round(s*n+r*(1-n))<<24|Math.round(u*n+i*(1-n))<<16|Math.round(l*n+a*(1-n))<<8|Math.round(d*n+o*(1-n)))>>>0}function h(e,t){return(e>>>24<<24|(e>>>16&255)<<16|(e>>>8&255)<<8|Math.trunc((255&e)*t))>>>0}var p=!0;function f(e,t,n=!1){var r=(255&e)/255*t,i=p?r:1,a=Math.trunc((e>>>24)*i),o=Math.trunc((e>>>16&255)*i),s=Math.trunc((e>>>8&255)*i),u=Math.trunc(255*r);return n?(u<<24|s<<16|o<<8|a)>>>0:(a<<24|o<<16|s<<8|u)>>>0}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var m,v=1;class y{constructor(){s(this,"eventListeners",{})}on(e,t){var n=this.eventListeners[e];n||(n=[]),n.push(t),this.eventListeners[e]=n}off(e,t){var n=this.eventListeners[e];if(n)if(t){var r=n.indexOf(t);r>=0&&n.splice(r,1)}else delete this.eventListeners[e]}once(e,t){var n=(r,i)=>{this.off(e,n),t(r,i)};this.on(e,n)}emit(e,t){var n=this.eventListeners[e];n&&[...n].forEach(e=>{e(this,t)})}removeAllListeners(){this.eventListeners={}}}!function(e){e[e.generic=0]="generic",e[e.color=1]="color",e[e.image=2]="image",e[e.noise=3]="noise",e[e.renderToTexture=4]="renderToTexture",e[e.subTexture=5]="subTexture"}(m||(m={}));class b extends y{constructor(e){super(),s(this,"txManager",void 0),s(this,"_dimensions",null),s(this,"_error",null),s(this,"state","initial"),s(this,"renderableOwners",[]),s(this,"renderable",!1),s(this,"type",m.generic),s(this,"preventCleanup",!1),s(this,"ctxTexture",void 0),s(this,"textureData",null),s(this,"memUsed",0),s(this,"retryCount",0),s(this,"maxRetryCount",void 0),s(this,"createdAt",Date.now()),s(this,"gracePeriodExpired",!1),this.txManager=e,this.maxRetryCount=e.maxRetryCount}get dimensions(){return this._dimensions}get error(){return this._error}isWithinStartupGracePeriod(){return!this.gracePeriodExpired&&(!(Date.now()-this.createdAt>=b.STARTUP_GRACE_PERIOD)||(this.gracePeriodExpired=!0,!1))}canBeCleanedUp(){return!this.preventCleanup&&(!this.isWithinStartupGracePeriod()&&(!0!==this.renderable&&!(this.renderableOwners.length>0)))}setRenderableOwner(e,t){var n=this.renderableOwners.length,r=this.renderableOwners.indexOf(e);if(!0===t){-1===r&&this.renderableOwners.push(e);var i,a=this.renderableOwners.length;if(n!==a&&1===a)this.renderable=!0,null===(i=this.onChangeIsRenderable)||void 0===i||i.call(this,!0),this.load()}else{-1!==r&&this.renderableOwners.splice(r,1);var o,s=this.renderableOwners.length;if(n!==s&&0===s)this.renderable=!1,null===(o=this.onChangeIsRenderable)||void 0===o||o.call(this,!1)}}load(){this.retryCount>this.maxRetryCount||this.txManager.loadTexture(this)}loadCtxTexture(){return void 0===this.ctxTexture&&(this.ctxTexture=this.txManager.renderer.createCtxTexture(this)),this.ctxTexture}free(){var e;null===(e=this.ctxTexture)||void 0===e||e.free()}release(){var e;null===(e=this.ctxTexture)||void 0===e||e.release(),this.ctxTexture=void 0,this.freeTextureData()}destroy(){"loaded"===this.state&&this.free(),this.freeTextureData()}freeTextureData(){queueMicrotask(()=>{this.textureData=null})}setState(e,t){if(this.state!==e){var n=null;"loaded"===e?(this._error=null,void 0!==t&&"width"in t==!0&&"height"in t==!0&&void 0!==t.width&&void 0!==t.height&&(this._dimensions=t),n=this._dimensions):"failed"===e?(this._error=t,n=this._error,this.retryCount+=1,queueMicrotask(()=>{this.release()})):"loading"===e?(this._error=null,this._dimensions=null):this._error=null,this.state=e,this.emit(e,n)}}getTextureData(){var e=this;return o(r().m(function t(){return r().w(function(t){for(;;)switch(t.n){case 0:if(null!==e.textureData){t.n=2;break}return t.n=1,e.getTextureSource();case 1:e.textureData=t.v;case 2:return t.a(2,e.textureData)}},t)}))()}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}retry(){this.release(),this.retryCount=0,this.load()}}s(b,"STARTUP_GRACE_PERIOD",2e3);var x=/^(data|ftps?|https?):/,T=e=>[(e>>>24)/255,(e>>>16&255)/255,(e>>>8&255)/255,(255&e)/255];function w(e,t,n,r,i){return i?(i.x1=e,i.y1=t,i.x2=n,i.y2=r,i):{x1:e,y1:t,x2:n,y2:r}}function S(e,t){return e.x1<t.x2&&e.x2>t.x1&&e.y1<t.y2&&e.y2>t.y1}function A(e,t,n){var r=Math.max(e.x,t.x),i=Math.max(e.y,t.y),a=Math.min(e.x+e.width,t.x+t.width)-r,o=Math.min(e.y+e.height,t.y+t.height)-i;return a>0&&o>0?n?(n.x=r,n.y=i,n.width=a,n.height=o,n):{x:r,y:i,width:a,height:o}:n?(n.x=0,n.y=0,n.width=0,n.height=0,n):{x:0,y:0,width:0,height:0}}function E(e,t){return t?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):{x:e.x,y:e.y,width:e.width,height:e.height}}function k(e,t){return e.x1<=t.x2&&e.y1<=t.y2&&e.x2>=t.x1&&e.y2>=t.y1}function I(e,t,n){return!(e<n.x1||e>n.x2||t<n.y1||t>n.y2)}function C(e,t){return w(e.x1-t[3],e.y1-t[0],e.x2+t[1],e.y2+t[2])}function M(e){return!0===e.startsWith("data:")}function R(e){for(var t,n=(null===(t=(e=e.replace(/^data:/,"")).match(/image\/[^;]+/))||void 0===t?void 0:t[0])||"",r=e.replace(/^[^,]+,/,""),i=1024,a=atob(r),o=a.length,s=Math.ceil(o/i),u=new Array(s),l=0;l<s;++l){for(var d=l*i,c=Math.min(d+i,o),h=new Array(c-d),p=d,f=0;p<c;++f,++p){var g;h[f]=null===(g=a[p])||void 0===g?void 0:g.charCodeAt(0)}u[l]=new Uint8Array(h)}return new Blob(u,{type:n})}class _{constructor(){s(this,"ta",void 0),s(this,"tb",void 0),s(this,"tx",void 0),s(this,"tc",void 0),s(this,"td",void 0),s(this,"ty",void 0),s(this,"_floatArr",null),s(this,"mutation",void 0),this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return P}static multiply(e,t,n){var r=e.ta*t.ta+e.tb*t.tc,i=e.ta*t.tb+e.tb*t.td,a=e.ta*t.tx+e.tb*t.ty+e.tx,o=e.tc*t.ta+e.td*t.tc,s=e.tc*t.tb+e.td*t.td,u=e.tc*t.tx+e.td*t.ty+e.ty;return n||(n=new _),n.ta=r,n.tb=i,n.tx=a,n.tc=o,n.td=s,n.ty=u,n.mutation=!0,n}static identity(e){return e||(e=new _),e.ta=1,e.tb=0,e.tx=0,e.tc=0,e.td=1,e.ty=0,e.mutation=!0,e}static translate(e,t,n){return n||(n=new _),n.ta=1,n.tb=0,n.tx=e,n.tc=0,n.td=1,n.ty=t,n.mutation=!0,n}static scale(e,t,n){return n||(n=new _),n.ta=e,n.tb=0,n.tx=0,n.tc=0,n.td=t,n.ty=0,n.mutation=!0,n}static rotate(e,t){var n=Math.cos(e),r=Math.sin(e);return t||(t=new _),t.ta=n,t.tb=-r,t.tx=0,t.tc=r,t.td=n,t.ty=0,t.mutation=!0,t}static copy(e,t){return t||(t=new _),t.ta=e.ta,t.tc=e.tc,t.tb=e.tb,t.td=e.td,t.tx=e.tx,t.ty=e.ty,t.mutation=!0,t}translate(e,t){return this.tx=this.ta*e+this.tb*t+this.tx,this.ty=this.tc*e+this.td*t+this.ty,this.mutation=!0,this}scale(e,t){return this.ta=this.ta*e,this.tb=this.tb*t,this.tc=this.tc*e,this.td=this.td*t,this.mutation=!0,this}rotate(e){if(0===e||!(e%Math.PI*2))return this;var t=Math.cos(e),n=Math.sin(e),r=this.ta*t+this.tb*n,i=this.tb*t-this.ta*n,a=this.tc*t+this.td*n,o=this.td*t-this.tc*n;return this.ta=r,this.tb=i,this.tc=a,this.td=o,this.mutation=!0,this}multiply(e){return _.multiply(this,e,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}var P=new _;class D{constructor(e){s(this,"data",void 0),this.data=new Float32Array(8),e&&(this.data[0]=e[0],this.data[2]=e[2],this.data[4]=e[4],this.data[6]=e[6],this.data[1]=e[1],this.data[3]=e[3],this.data[5]=e[5],this.data[7]=e[7])}static translate(e,t,n,r,i,a,o,s,u){return u||(u=new D),u.data[0]=e,u.data[2]=n,u.data[4]=i,u.data[6]=o,u.data[1]=t,u.data[3]=r,u.data[5]=a,u.data[7]=s,u}get x1(){return this.data[0]}get x2(){return this.data[2]}get x3(){return this.data[4]}get x4(){return this.data[6]}get y1(){return this.data[1]}get y2(){return this.data[3]}get y3(){return this.data[5]}get y4(){return this.data[7]}}var L,N=(e,t,n,r)=>{var i=3*e,a=3*(n-e)-i,o=1-i-a,s=3*t,u=3*(r-t)-s,l=1-s-u;return function(e){if(e>=1)return 1;if(e<=0)return 0;for(var t,n,r=.5,d=0;d<20;d++){if((n=e-r*(r*(r*o+a)+i))>-1e-8&&n<1e-8)return r*(r*(r*l+u)+s);if((t=r*(r*(3*o)+2*a)+i)>1e-10&&t<1e-10)break;r+=n/t}for(var c=0,h=1,p=0;p<20;p++){if((n=e-(r=.5*(c+h))*(r*(r*o+a)+i))>-1e-8&&n<1e-8)return r*(r*(r*l+u)+s);n<0?h=r:c=r}}},O={},U={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},B=e=>e,j=e=>{if("linear"===e)return B;if(void 0!==O[e])return O[e]||B;if("step-start"===e)return()=>1;if("step-end"===e)return e=>1===e?1:0;var t=U[e];if(void 0!==t){var r=n(t,4),i=r[0],a=r[1],o=r[2],s=r[3],u=N(i,a,o,s);return O[e]=u,u}return e.startsWith("cubic-bezier")?(e=>{var t=e.match(/-?\d*\.?\d+/g);if(t){var r=n(t,4),i=r[0],a=r[1],o=r[2],s=r[3],u=parseFloat(i||"0.42"),l=parseFloat(a||"0"),d=parseFloat(o||"1"),c=parseFloat(s||"1"),h=N(u,l,d,c);return O[e]=h,h}return console.warn("Unknown cubic-bezier timing: "+e),B})(e):(console.warn("Unknown timing function: "+e),B)};function F(e){return(e/1024/1024).toFixed(2)}class V extends y{constructor(e,t,r){var i,a,o,u,l,d;for(var c in super(),s(this,"node",void 0),s(this,"props",void 0),s(this,"settings",void 0),s(this,"progress",0),s(this,"delayFor",0),s(this,"delay",0),s(this,"timingFunction",void 0),s(this,"propValuesMap",{}),s(this,"dynPropValuesMap",void 0),this.node=e,this.props=t,t)if("shaderProps"!==c)void 0===this.propValuesMap.props&&(this.propValuesMap.props={}),this.propValuesMap.props[c]={start:e[c]||0,target:t[c]};else if("DynamicShader"!==e.shader.type)for(var h in this.propValuesMap.shaderProps={},t.shaderProps)this.propValuesMap.shaderProps[h]={start:e.shader.props[h],target:t.shaderProps[h]};else{var p=Object.keys(t.shaderProps),f=p.length;this.dynPropValuesMap={};for(var g=0;g<f;g++){var m=p[g],v=t.shaderProps[m];this.dynPropValuesMap[m]={};for(var y=Object.entries(v),b=y.length,x=0;x<b;x++){var T=n(y[x],2),w=T[0],S=T[1];this.dynPropValuesMap[m][w]={start:e.shader.props[m][w],target:S}}}}var A=r.easing||"linear",E=null!==(i=r.delay)&&void 0!==i?i:0;this.settings={duration:null!==(a=r.duration)&&void 0!==a?a:0,delay:E,easing:A,loop:null!==(o=r.loop)&&void 0!==o&&o,repeat:null!==(u=r.repeat)&&void 0!==u?u:0,repeatDelay:null!==(l=r.repeatDelay)&&void 0!==l?l:0,stopMethod:null!==(d=r.stopMethod)&&void 0!==d&&d},this.timingFunction=j(A),this.delayFor=E,this.delay=E}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,t){for(var r=Object.entries(t),i=r.length,a=0;a<i;a++){var o=n(r[a],2),s=o[0],u=o[1];e[s]=u.start}}restore(){if(this.reset(),void 0!==this.propValuesMap.props&&this.restoreValues(this.node,this.propValuesMap.props),void 0!==this.propValuesMap.shaderProps&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),void 0!==this.dynPropValuesMap){var e=Object.keys(this.dynPropValuesMap),t=e.length;if(t>0)for(var n=0;n<t;n++){var r=e[n];this.restoreValues(this.node.shader.props[r],this.dynPropValuesMap[r])}}}reverseValues(e){for(var t=Object.entries(e),r=t.length,i=0;i<r;i++){var a=n(t[i],2),o=a[0],s=a[1];e[o]={start:s.target,target:s.start}}}reverse(){if(this.progress=0,void 0!==this.propValuesMap.props&&this.reverseValues(this.propValuesMap.props),void 0!==this.propValuesMap.shaderProps&&this.reverseValues(this.propValuesMap.shaderProps),void 0!==this.dynPropValuesMap){var e=Object.keys(this.dynPropValuesMap),t=e.length;if(t>0)for(var n=0;n<t;n++){var r=e[n];this.reverseValues(this.dynPropValuesMap[r])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,t,n){return(this.timingFunction(e)||e)*(n-t)+t}updateValue(e,t,n,r){if(1===this.progress)return t;if(0===this.progress)return n;var i=t;return-1!==e.indexOf("color")?n===i?n:c(n,i,r&&this.timingFunction(this.progress)||this.progress):r?this.applyEasing(this.progress,n,i):n+(i-n)*this.progress}updateValues(e,t,r){for(var i=Object.entries(t),a=i.length,o=0;o<a;o++){var s=n(i[o],2),u=s[0],l=s[1];e[u]=this.updateValue(u,l.target,l.start,r)}}update(e){var t=this.settings,n=t.duration,r=t.loop,i=t.easing,a=t.stopMethod,o=this.delayFor;if(this.node.destroyed)this.emit("destroyed",{});else if(0!==n||0!==o){if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(0!==n)if(0===this.progress&&this.emit("animating",{}),this.progress+=e/n,this.progress>1&&(this.progress=r?0:1,this.delayFor=this.delay,a))this.emit("finished",{});else{if(void 0!==this.propValuesMap.props&&this.updateValues(this.node,this.propValuesMap.props,i),void 0!==this.propValuesMap.shaderProps&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,i),void 0!==this.dynPropValuesMap){var s=Object.keys(this.dynPropValuesMap),u=s.length;if(u>0)for(var l=0;l<u;l++){var d=s[l];this.updateValues(this.node.shader.props[d],this.dynPropValuesMap[d],i)}}this.progress<1&&this.emit("tick",{progress:this.progress}),1===this.progress&&this.emit("finished",{})}else this.emit("finished",{})}else this.emit("finished",{})}}class H extends y{constructor(e,t){super(),s(this,"manager",void 0),s(this,"animation",void 0),s(this,"stoppedPromise",void 0),s(this,"stoppedResolve",null),s(this,"state",void 0),this.manager=e,this.animation=t,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this),this.onTick=this.onTick.bind(this),this.onDestroy=this.onDestroy.bind(this)}start(){return"running"!==this.state&&"scheduled"!==this.state&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="scheduled"),this}stop(){return this.unregisterAnimation(),null!==this.stoppedResolve&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.animation.on("tick",this.onTick),this.animation.on("destroyed",this.onDestroy),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating),this.animation.off("tick",this.onTick),this.animation.off("destroy",this.onDestroy)}makeStoppedPromise(){null===this.stoppedResolve&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onDestroy(){this.unregisterAnimation(),this.state="stopped"}onFinished(){var e=this.animation.settings,t=e.loop;if("reverse"===e.stopMethod)return this.animation.once("finished",this.onFinished),void this.animation.reverse();t||(this.unregisterAnimation(),null!==this.stoppedResolve&&(this.stoppedResolve(),this.stoppedResolve=null),this.emit("stopped",this),this.state="stopped")}onAnimating(){this.state="running",this.emit("animating",this)}onTick(e,t){this.emit("tick",t)}}!function(e){e[e.Init=0]="Init",e[e.OutOfBounds=2]="OutOfBounds",e[e.InBounds=4]="InBounds",e[e.InViewport=8]="InViewport"}(L||(L={}));var G,z=new Map;z.set(L.Init,"init"),z.set(L.OutOfBounds,"outOfBounds"),z.set(L.InBounds,"inBounds"),z.set(L.InViewport,"inViewport"),function(e){e[e.Children=1]="Children",e[e.ScaleRotate=2]="ScaleRotate",e[e.Local=4]="Local",e[e.Global=8]="Global",e[e.Clipping=16]="Clipping",e[e.CalculatedZIndex=32]="CalculatedZIndex",e[e.ZIndexSortedChildren=64]="ZIndexSortedChildren",e[e.PremultipliedColors=128]="PremultipliedColors",e[e.WorldAlpha=256]="WorldAlpha",e[e.RenderState=512]="RenderState",e[e.IsRenderable=1024]="IsRenderable",e[e.RenderTexture=2048]="RenderTexture",e[e.ParentRenderTexture=4096]="ParentRenderTexture",e[e.RenderBounds=8192]="RenderBounds",e[e.None=0]="None",e[e.All=14335]="All"}(G||(G={}));class X extends y{constructor(e,n){super(),s(this,"stage",void 0),s(this,"children",[]),s(this,"_id",v++),s(this,"props",void 0),s(this,"updateType",G.All),s(this,"childUpdateType",G.None),s(this,"globalTransform",void 0),s(this,"scaleRotateTransform",void 0),s(this,"localTransform",void 0),s(this,"sceneGlobalTransform",void 0),s(this,"renderCoords",void 0),s(this,"sceneRenderCoords",void 0),s(this,"renderBound",void 0),s(this,"strictBound",void 0),s(this,"preloadBound",void 0),s(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1}),s(this,"isRenderable",!1),s(this,"renderState",L.Init),s(this,"worldAlpha",1),s(this,"premultipliedColorTl",0),s(this,"premultipliedColorTr",0),s(this,"premultipliedColorBl",0),s(this,"premultipliedColorBr",0),s(this,"calcZIndex",0),s(this,"hasRTTupdates",!1),s(this,"parentHasRenderTexture",!1),s(this,"rttParent",null),s(this,"destroyed",!1),s(this,"onTextureLoaded",(e,t)=>{var n;this.autosizeNode(t),this.setUpdateType(G.IsRenderable),this.stage.requestRender(),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),t.width>1&&t.height>1&&this.emit("loaded",{type:"texture",dimensions:t}),"contain"===(null===(n=this.props.textureOptions)||void 0===n||null===(n=n.resizeMode)||void 0===n?void 0:n.type)&&this.setUpdateType(G.Local)}),s(this,"onTextureFailed",(e,t)=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(G.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),null!==this.texture&&this.texture.retryCount>this.texture.maxRetryCount&&this.emit("failed",{type:"texture",error:t})}),s(this,"onTextureFreed",()=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(G.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.emit("freed",{type:"texture"})}),this.stage=e,this.props=t(t({},n),{},{parent:null,texture:null,src:null,rtt:!1}),this.parent=n.parent,this.texture=n.texture,this.src=n.src,this.rtt=n.rtt,this.interactive=n.interactive,n.boundsMargin&&(this.boundsMargin=Array.isArray(n.boundsMargin)?n.boundsMargin:[n.boundsMargin,n.boundsMargin,n.boundsMargin,n.boundsMargin]),this.setUpdateType(G.ScaleRotate|G.Local|G.RenderBounds|G.RenderState),this.stage.defaultTexture&&"loaded"!==this.stage.defaultTexture.state&&this.stage.defaultTexture.once("loaded",()=>{this.setUpdateType(G.IsRenderable)})}loadTexture(){var e=this.props.texture;queueMicrotask(()=>{var t,n;!0===this.textureOptions.preload&&this.stage.txManager.loadTexture(e),e.preventCleanup=null!==(t=null===(n=this.props.textureOptions)||void 0===n?void 0:n.preventCleanup)&&void 0!==t&&t,e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed),"loaded"===e.state?(e.dimensions,this.onTextureLoaded(e,e.dimensions)):"failed"===e.state?(e.error,this.onTextureFailed(e,e.error)):"freed"===e.state&&this.onTextureFreed(e),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate()})}unloadTexture(){null!==this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this._id,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;var t=this.props.parent;t&&0===(t.updateType&G.Children)&&t.setUpdateType(G.Children)}sortChildren(){this.children.sort((e,t)=>e.calcZIndex-t.calcZIndex)}updateScaleRotateTransform(){var e=this.props,t=e.rotation,n=e.scaleX,r=e.scaleY;this.scaleRotateTransform=0!==t||1!==n||1!==r?_.rotate(t,this.scaleRotateTransform).scale(n,r):void 0}updateLocalTransform(){var e,t=this.props,n=t.x,r=t.y,i=t.width,a=t.height,o=this.props.mountX*i,s=this.props.mountY*a;if(this.scaleRotateTransform){var u=this.props.pivotX*i,l=this.props.pivotY*a;this.localTransform=_.translate(n-o+u,r-s+l,this.localTransform).multiply(this.scaleRotateTransform).translate(-u,-l)}else this.localTransform=_.translate(n-o,r-s,this.localTransform);var d=this.props.texture;if(d&&d.dimensions&&"contain"===(null===(e=this.props.textureOptions)||void 0===e||null===(e=e.resizeMode)||void 0===e?void 0:e.type)){var c=1,h=1,p=0,f=0,g=d.dimensions,m=g.width,v=g.height;if(m/v>i/a){var y=v*(i/m);f=(a-y)/2,h=y/a}else{var b=m*(a/v);p=(i-b)/2,c=b/i}this.localTransform.translate(p,f).scale(c,h)}this.setUpdateType(G.Global)}update(e,t){this.updateType&G.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(G.Local)),this.updateType&G.Local&&(this.updateLocalTransform(),this.setUpdateType(G.Global));var n=this.props.parent,r=null;if(this.updateType&G.RenderTexture&&this.rtt&&(this.hasRTTupdates=!0),this.updateType&G.Global&&(this.localTransform,!0===this.parentHasRenderTexture&&!0===(null==n?void 0:n.rtt)?(this.globalTransform=_.identity(),this.sceneGlobalTransform=_.copy((null==n?void 0:n.globalTransform)||_.identity()).multiply(this.localTransform)):!0===this.parentHasRenderTexture&&!1===(null==n?void 0:n.rtt)?(this.sceneGlobalTransform=_.copy((null==n?void 0:n.sceneGlobalTransform)||this.localTransform).multiply(this.localTransform),this.globalTransform=_.copy((null==n?void 0:n.globalTransform)||this.localTransform,this.globalTransform)):this.globalTransform=_.copy((null==n?void 0:n.globalTransform)||this.localTransform,this.globalTransform),null!==n&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(G.RenderState|G.Children),this.childUpdateType|=G.Global,!0===this.clipping&&(this.setUpdateType(G.Clipping|G.RenderBounds),this.childUpdateType|=G.RenderBounds)),this.updateType&G.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(G.RenderState),this.setUpdateType(G.Children),this.childUpdateType|=G.RenderBounds),this.updateType&G.RenderState&&(r=this.checkRenderBounds(),this.setUpdateType(G.IsRenderable),r!==L.OutOfBounds&&this.updateRenderState(r)),this.updateType&G.WorldAlpha&&(this.worldAlpha=n?n.worldAlpha*this.props.alpha:this.props.alpha,this.setUpdateType(G.Children|G.PremultipliedColors|G.IsRenderable),this.childUpdateType|=G.WorldAlpha),this.updateType&G.IsRenderable&&this.updateIsRenderable(),this.updateType&G.Clipping&&(this.calculateClippingRect(t),this.setUpdateType(G.Children),this.childUpdateType|=G.Clipping,this.childUpdateType|=G.RenderBounds),this.updateType&G.PremultipliedColors&&(this.premultipliedColorTl=f(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=f(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=f(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=f(this.props.colorBr,this.worldAlpha,!0))),null!==n&&this.updateType&G.CalculatedZIndex&&(this.calculateZIndex(),n.setUpdateType(G.ZIndexSortedChildren)),!0!==this.props.strictBounds||this.renderState!==L.OutOfBounds){if(this.updateType&G.Children&&this.children.length>0)for(var i=0,a=this.children.length;i<a;i++){var o=this.children[i];if(o.setUpdateType(this.childUpdateType),0!==o.updateType){var s=this.clippingRect;!0===this.rtt&&(s={x:0,y:0,width:0,height:0,valid:!1}),o.update(e,s)}}this.parentHasRenderTexture&&this.updateType>0&&this.notifyParentRTTOfUpdate(),this.updateType&G.ZIndexSortedChildren&&this.sortChildren(),r===L.OutOfBounds&&(this.updateRenderState(r),this.updateIsRenderable(),!0===this.rtt&&r===L.OutOfBounds&&this.notifyChildrenRTTOfUpdate(r)),this.updateType=0,this.childUpdateType=0}else this.updateType&=~G.RenderBounds}findParentRTTNode(){for(var e=this.parent;e&&!e.rtt;)e=e.parent;return e}getRTTParentRenderState(){var e=this.rttParent||this.findParentRTTNode();return e?e.renderState:null}notifyChildrenRTTOfUpdate(e){var t,n=u(this.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.updateRenderState(e),r.updateIsRenderable(),r.notifyChildrenRTTOfUpdate(e)}}catch(i){n.e(i)}finally{n.f()}}notifyParentRTTOfUpdate(){if(null!==this.parent){var e=this.rttParent||this.findParentRTTNode();e&&(e.hasRTTupdates=!0,e.setUpdateType(G.RenderTexture),!0===e.parentHasRenderTexture&&e.notifyParentRTTOfUpdate())}}checkRenderBounds(){return this.renderBound,this.strictBound,this.preloadBound,k(this.renderBound,this.strictBound)?L.InViewport:k(this.renderBound,this.preloadBound)?L.InBounds:(e=this.renderBound,t=this.strictBound,e.x1<t.x1&&e.x2>t.x2&&e.y1<t.y1&&e.y2>t.y2?L.InViewport:null===this.parent||0!==this.props.width&&0!==this.props.height?L.OutOfBounds:this.parent.renderState);var e,t}updateBoundingRect(){var e=this.sceneGlobalTransform||this.globalTransform,t=this.sceneRenderCoords||this.renderCoords,n=e.tb,r=e.tc,i=t.x1,a=t.y1,o=t.x3,s=t.y3;if(0===n||0===r)this.renderBound=w(i,a,o,s,this.renderBound);else{var u=t.x2,l=t.x4,d=t.y2,c=t.y4;this.renderBound=w(Math.min(i,u,o,l),Math.min(a,d,s,c),Math.max(i,u,o,l),Math.max(a,d,s,c),this.renderBound)}}createRenderBounds(){if(this.stage,null!==this.parent&&void 0!==this.parent.strictBound){var e=this.parent.strictBound;this.strictBound=w(e.x1,e.y1,e.x2,e.y2),this.preloadBound=C(this.strictBound,this.boundsMargin)}else this.strictBound=this.stage.strictBound,this.preloadBound=this.stage.preloadBound;if(!1!==this.props.clipping&&void 0!==this.renderBound&&!1!==k(this.renderBound,this.strictBound)){var t=this.props,n=t.x,r=t.y,i=t.width,a=t.height,o=this.sceneGlobalTransform||this.globalTransform||{},s=o.tx,u=o.ty,l=null!=s?s:n,d=null!=u?u:r;this.strictBound=w(l,d,l+i,d+a,this.strictBound),this.preloadBound=C(this.strictBound,this.boundsMargin)}}updateRenderState(e){if(e!==this.renderState){var t=this.renderState;this.renderState=e;var n=z.get(e);this.emit(n,{previous:t,current:e})}}updateIsRenderable(){var e=!1,t=!1;if(!1===this.checkBasicRenderability())return this.updateTextureOwnership(!1),void this.setRenderable(!1);if(null!==this.texture){if(this.texture.retryCount>this.texture.maxRetryCount)return this.updateTextureOwnership(!1),void this.setRenderable(!1);t=!0,e="loaded"===this.texture.state}else!this.hasShader()&&!0!==this.hasColorProperties()||!0!==this.hasDimensions()||this.stage.defaultTexture&&"loaded"===this.stage.defaultTexture.state&&(e=!0);this.updateTextureOwnership(t),this.setRenderable(e)}checkBasicRenderability(){return 0!==this.worldAlpha&&!0!==this.isOutOfBounds()}setRenderable(e){this.isRenderable=e}updateTextureOwnership(e){var t;null===(t=this.texture)||void 0===t||t.setRenderableOwner(this._id,e)}isOutOfBounds(){return this.renderState<=L.OutOfBounds}hasDimensions(){return 0!==this.props.width&&0!==this.props.height}hasColorProperties(){return 0!==this.props.color||0!==this.props.colorTop||0!==this.props.colorBottom||0!==this.props.colorLeft||0!==this.props.colorRight||0!==this.props.colorTl||0!==this.props.colorTr||0!==this.props.colorBl||0!==this.props.colorBr}hasShader(){return null!==this.props.shader}calculateRenderCoords(){var e=this.width,t=this.height,n=this.globalTransform,r=n.tx,i=n.ty,a=n.ta,o=n.tb,s=n.tc,u=n.td;if(0===o&&0===s){var l=r,d=r+e*a,c=i,h=i+t*u;this.renderCoords=D.translate(l,c,d,c,d,h,l,h,this.renderCoords)}else this.renderCoords=D.translate(r,i,r+e*a,i+e*s,r+e*a+t*o,i+e*s+t*u,r+t*o,i+t*u,this.renderCoords);if(void 0!==this.sceneGlobalTransform){var p=this.sceneGlobalTransform,f=p.tx,g=p.ty,m=p.ta,v=p.tb,y=p.tc,b=p.td;if(0===v&&0===y){var x=f,T=f+e*m,w=g,S=g+t*b;this.sceneRenderCoords=D.translate(x,w,T,w,T,S,x,S,this.sceneRenderCoords)}else this.sceneRenderCoords=D.translate(f,g,f+e*m,g+e*y,f+e*m+t*v,g+e*y+t*b,f+t*v,g+t*b,this.sceneRenderCoords)}}calculateClippingRect(e){this.globalTransform;var t=this.clippingRect,n=this.props,r=this.globalTransform,i=n.clipping,a=0!==r.tb||0!==r.tc;!0===i&&!1===a?(t.x=r.tx,t.y=r.ty,t.width=this.width*r.ta,t.height=this.height*r.td,t.valid=!0):t.valid=!1,!0===e.valid&&!0===t.valid?A(e,t,t):!0===e.valid&&(E(e,t),t.valid=!0)}calculateZIndex(){var e,t,n=this.props,r=n.zIndex||0,i=(null===(e=n.parent)||void 0===e?void 0:e.zIndex)||0,a=r;null!==(t=n.parent)&&void 0!==t&&t.zIndexLocked&&(a=r<i?r:i),this.calcZIndex=a}destroy(){if(!0!==this.destroyed){for(this.destroyed=!0,this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,this.renderCoords=void 0,this.renderBound=void 0,this.strictBound=void 0,this.preloadBound=void 0,this.globalTransform=void 0,this.scaleRotateTransform=void 0,this.localTransform=void 0,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;this.children.length>0;){var e;null===(e=this.children[0])||void 0===e||e.destroy()}this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}}renderQuads(e){if(this.parentHasRenderTexture){if(!e.renderToTextureActive)return;if(this.parentRenderTexture!==e.activeRttNode)return}this.globalTransform,this.renderCoords,e.addQuad({width:this.props.width,height:this.props.height,colorTl:this.premultipliedColorTl,colorTr:this.premultipliedColorTr,colorBl:this.premultipliedColorBl,colorBr:this.premultipliedColorBr,texture:this.texture||this.stage.defaultTexture,textureOptions:this.textureOptions,zIndex:this.zIndex,shader:this.shader.shader,shaderProps:this.shader.getResolvedProps(),alpha:this.worldAlpha,clippingRect:this.clippingRect,tx:this.globalTransform.tx,ty:this.globalTransform.ty,ta:this.globalTransform.ta,tb:this.globalTransform.tb,tc:this.globalTransform.tc,td:this.globalTransform.td,renderCoords:this.renderCoords,rtt:this.rtt,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get data(){return this.props.data}set data(e){this.props.data=e}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(G.Local))}get absX(){var e,t;return this.props.x+-this.props.width*this.props.mountX+((null===(e=this.props.parent)||void 0===e?void 0:e.absX)||(null===(t=this.props.parent)||void 0===t||null===(t=t.globalTransform)||void 0===t?void 0:t.tx)||0)}get absY(){var e,t;return this.props.y+-this.props.height*this.props.mountY+(null!==(e=null===(t=this.props.parent)||void 0===t?void 0:t.absY)&&void 0!==e?e:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(G.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(G.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(G.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(G.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(G.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(G.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(G.ScaleRotate))}get mount(){return this.props.mount}set mount(e){this.props.mountX===e&&this.props.mountY===e||(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(G.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(G.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(G.Local))}get pivot(){return this.props.pivot}set pivot(e){this.props.pivotX===e&&this.props.pivotY===e||(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(G.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(G.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(G.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(G.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(G.PremultipliedColors|G.WorldAlpha|G.Children|G.IsRenderable),this.childUpdateType|=G.WorldAlpha}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get boundsMargin(){var e,t,n;return null!==(e=null!==(t=this.props.boundsMargin)&&void 0!==t?t:null===(n=this.parent)||void 0===n?void 0:n.boundsMargin)&&void 0!==e?e:this.stage.boundsMargin}set boundsMargin(e){if(e!==this.props.boundsMargin){if(null===e)this.props.boundsMargin=e;else{var t=Array.isArray(e)?e:[e,e,e,e];this.props.boundsMargin=t}this.setUpdateType(G.RenderBounds)}}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(G.Clipping|G.RenderBounds|G.Children),this.childUpdateType|=G.Global|G.Clipping}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(G.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){this.props.colorTl===e&&this.props.colorTr===e||(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(G.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){this.props.colorBl===e&&this.props.colorBr===e||(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(G.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){this.props.colorTl===e&&this.props.colorBl===e||(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(G.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){this.props.colorTr===e&&this.props.colorBr===e||(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(G.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(G.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(G.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(G.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(G.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(G.CalculatedZIndex|G.Children);for(var t=0,n=this.children.length;t<n;t++)this.children[t].setUpdateType(G.CalculatedZIndex)}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(G.CalculatedZIndex|G.Children);for(var t=0,n=this.children.length;t<n;t++)this.children[t].setUpdateType(G.CalculatedZIndex)}get parent(){return this.props.parent}set parent(e){var t=this.props.parent;if(t!==e){if(this.props.parent=e,t){var n=t.children.indexOf(this);t.children.splice(n,1),t.setUpdateType(G.Children|G.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(G.All),e.setUpdateType(G.Children|G.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.applyRTTInheritance(e)),this.updateScaleRotateTransform(),this.setUpdateType(G.RenderBounds|G.Children)}}get preventCleanup(){return this.props.textureOptions.preventCleanup||!1}set preventCleanup(e){this.props.textureOptions.preventCleanup=e}get rtt(){return this.props.rtt}set rtt(e){this.props.rtt!==e&&(this.props.rtt=e,!0===e?(this.initRenderTexture(),this.markChildrenWithRTT()):this.cleanupRenderTexture(),this.setUpdateType(G.RenderTexture),!0===this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate())}initRenderTexture(){this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.stage.renderer.renderToTexture(this)}cleanupRenderTexture(){this.unloadTexture(),this.clearRTTInheritance(),this.hasRTTupdates=!1,this.texture=null}markChildrenWithRTT(e=null){var t,n=u((e||this).children);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.setUpdateType(G.All),r.parentHasRenderTexture=!0,r.markChildrenWithRTT()}}catch(i){n.e(i)}finally{n.f()}}applyRTTInheritance(e){e.rtt&&e.setUpdateType(G.RenderTexture),this.markChildrenWithRTT(e)}clearRTTInheritance(){if(!this.rtt){var e,t=u(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parentHasRenderTexture=!1,n.rttParent=null,n.setUpdateType(G.All),n.clearRTTInheritance()}}catch(r){t.e(r)}finally{t.f()}}}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(G.IsRenderable))}get src(){return this.props.src}set src(e){this.props.src!==e&&(this.props.src=e,this.texture=e?this.stage.txManager.createTexture("ImageTexture",{src:e,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight,maxRetryCount:this.props.textureOptions.maxRetryCount}):null)}set imageType(e){this.props.imageType!==e&&(this.props.imageType=e)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(e){this.props.srcHeight=e}get srcWidth(){return this.props.srcWidth}set srcWidth(e){this.props.srcWidth=e}get srcX(){return this.props.srcX}set srcX(e){this.props.srcX=e}get srcY(){return this.props.srcY}set srcY(e){this.props.srcY=e}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){for(var e=this.parent;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){this.props.texture!==e&&(this.props.texture&&this.unloadTexture(),this.props.texture=e,null!==e&&(e.setRenderableOwner(this._id,this.isRenderable),this.loadTexture()),this.setUpdateType(G.IsRenderable))}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}get strictBounds(){return this.props.strictBounds}set strictBounds(e){e!==this.props.strictBounds&&(this.props.strictBounds=e,this.setUpdateType(G.RenderBounds|G.Children),this.childUpdateType|=G.RenderBounds|G.Children)}set interactive(e){this.props.interactive=e,!0===e&&this.stage.interactiveNodes.add(this)}get interactive(){return this.props.interactive}animate(e,t){var n=new V(this,e,t);return new H(this.stage.animationManager,n)}flush(){}}var W=()=>performance?performance.now():Date.now();class K{constructor(){s(this,"activeAnimations",new Set)}registerAnimation(e){this.activeAnimations.add(e)}unregisterAnimation(e){this.activeAnimations.delete(e)}update(e){this.activeAnimations.forEach(t=>{t.update(e)})}}function q(){self.onmessage=e=>{var t=e.data.src,n=e.data.id,r=e.data.premultiplyAlpha;e.data.sx,e.data.sy,e.data.sw,e.data.sh,function(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){if(200!==i.status&&0!==i.status)return r(new Error("Failed to load image: "+i.statusText));var e=i.response;void 0!==t||e.type.indexOf("image/png"),createImageBitmap(e).then(function(e){n({data:e,premultiplyAlpha:t})}).catch(function(e){r(e)})},i.onerror=function(){r(new Error("Network error occurred while trying to fetch the image."))},i.send()})}(t,r).then(function(e){self.postMessage({id:n,src:t,data:e},[e.data])}).catch(function(e){self.postMessage({id:n,src:t,error:e.message})})}}class Y{constructor(e,t){s(this,"imageWorkersEnabled",!0),s(this,"messageManager",{}),s(this,"workers",[]),s(this,"workerIndex",0),s(this,"nextId",0),this.workers=this.createWorkers(e,t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(e){var t=e.data,r=t.id,i=t.data,a=t.error,o=this.messageManager[r];if(o){var s=n(o,2),u=s[0],l=s[1];delete this.messageManager[r],a?l(new Error(a)):u(i)}}createWorkers(e=1,t){var n=`(${q.toString()})()`;!0===t.options&&(n=n.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;")),!0===t.full&&(n=(n=n.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;")).replace("var supportsFullCreateImageBitmap = false;","var supportsFullCreateImageBitmap = true;")),n=n.replace('"use strict";',"");for(var r=new Blob([n],{type:"application/javascript"}),i=(self.URL?URL:webkitURL).createObjectURL(r),a=[],o=0;o<e;o++)a.push(new Worker(i));return a}getNextWorker(){var e=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,e}getImage(e,t,n,r,i,a){return new Promise((o,s)=>{try{if(this.workers){var u=this.nextId++;this.messageManager[u]=[o,s];var l=this.getNextWorker();l&&l.postMessage({id:u,src:e,premultiplyAlpha:t,sx:n,sy:r,sw:i,sh:a})}}catch(d){s(d)}})}}class $ extends b{constructor(e,t){super(e),s(this,"type",m.color),s(this,"props",void 0),this.props=$.resolveDefaults(t)}get color(){return this.props.color}set color(e){this.props.color=e}getTextureSource(){var e=this;return o(r().m(function t(){var n;return r().w(function(t){for(;;)if(0===t.n)return n=new Uint8Array(4),4294967295===e.color?(n[0]=255,n[1]=255,n[2]=255,n[3]=255):(n[0]=e.color>>16&255,n[1]=e.color>>8&255,n[2]=255&e.color,n[3]=e.color>>>24&255),t.a(2,{data:n,premultiplyAlpha:!0})},t)}))()}static makeCacheKey(e){return`ColorTexture,${$.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}}s($,"z$__type__Props",void 0);var J={0:35841,1:35843,2:35840,3:35842,6:36196,7:33776,8:33778,9:33778,10:33779,11:33779},Q={"4x4":37808,"5x5":37809,"6x6":37810,"8x8":37811,"10x10":37812,"12x12":37813},Z=[171,75,84,88,32,49,49,187,13,10,26,10],ee=function(){var e=o(r().m(function e(t){var n,i,a,o,s,u,l;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(t);case 1:if((n=e.v).ok){e.n=2;break}throw new Error(`Failed to fetch compressed texture: ${n.status} ${n.statusText}`);case 2:return e.n=3,n.arrayBuffer();case 3:if(!((i=e.v).byteLength<16)){e.n=4;break}throw new Error(`File too small to be a valid compressed texture (${i.byteLength} bytes). Expected at least 16 bytes for header inspection.`);case 4:if(a=new DataView(i),55727696!==(o=a.getUint32(0,!0))){e.n=5;break}return e.a(2,ae(a));case 5:if(1554098963!==o){e.n=6;break}return e.a(2,ne(a));case 6:s=!0,u=0;case 7:if(!(u<Z.length)){e.n=9;break}if(a.getUint8(u)===Z[u]){e.n=8;break}return s=!1,e.a(3,9);case 8:u++,e.n=7;break;case 9:if(!0!==s){e.n=10;break}return e.a(2,re(a));case 10:throw new Error("Unrecognized compressed texture format");case 11:e.n=13;break;case 12:throw e.p=12,l=e.v,new Error(`Failed to load compressed texture from ${t}: ${l}`);case 13:return e.a(2)}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}();function te(e,t){return e.getUint8(t)+(e.getUint8(t+1)<<8)+(e.getUint8(t+2)<<16)}var ne=function(){var e=o(r().m(function e(t){var n,i,a,o,s,u,l,d,c;return r().w(function(e){for(;;)switch(e.n){case 0:if(n=t.getUint8(4),i=t.getUint8(5),a=te(t,7),o=te(t,10),0!==a&&0!==o){e.n=1;break}throw new Error(`Invalid ASTC texture dimensions: ${a}x${o}`);case 1:if(s=Math.ceil(a/n)*Math.ceil(o/i)*16,u=t.byteLength-16,s===u){e.n=2;break}throw new Error(`Invalid ASTC texture data size: expected ${s}, got ${u}`);case 2:if(void 0!==(l=Q[`${n}x${i}`])){e.n=3;break}throw new Error(`Unsupported ASTC block size: ${n}x${i}`);case 3:return d=t.buffer,(c=[]).push(d.slice(16)),e.a(2,{data:{blockInfo:fe[l],glInternalFormat:l,mipmaps:c,width:a,height:o,type:"astc"},premultiplyAlpha:!1})}},e)}));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=o(r().m(function e(t){var n,i,a,o,s,u,l,d,c,h,p,f,g,m,v;return r().w(function(e){for(;;)switch(e.n){case 0:if(n=t.getUint32(12,!0),!1!==(i=67305985===n)||16909060===n){e.n=1;break}throw new Error("Invalid KTX endianness value");case 1:if(a=t.getUint32(16,i),o=t.getUint32(24,i),0===a&&0===o){e.n=2;break}throw new Error(`KTX texture is not compressed (glType: ${a}, glFormat: ${o})`);case 2:if(s=t.getUint32(28,i),void 0!==fe[s]){e.n=3;break}throw new Error(`Unsupported KTX compressed texture format: 0x${s.toString(16)}`);case 3:if(u=t.getUint32(36,i),l=t.getUint32(40,i),0!==u&&0!==l){e.n=4;break}throw new Error(`Invalid KTX texture dimensions: ${u}x${l}`);case 4:if(0!==(d=t.getUint32(56,i))){e.n=5;break}throw new Error("KTX texture has no mipmap levels");case 5:if(c=t.getUint32(60,i),h=[],p=t.buffer,!((f=64+c)>t.byteLength)){e.n=6;break}throw new Error("Invalid KTX file: key/value data exceeds file size");case 6:for(g=0;g<d;g++)m=t.getUint32(f,i),v=(f+=4)+m,h.push(p.slice(f,v)),(f=v)%4!=0&&(f+=4-f%4);return e.a(2,{data:{blockInfo:fe[s],glInternalFormat:s,mipmaps:h,width:u,height:l,type:"ktx"},premultiplyAlpha:!1})}},e)}));return function(t){return e.apply(this,arguments)}}();function ie(e,t,n){var r=2===n?16:8;return Math.max(e,r)*Math.max(t,8)*n/8}var ae=function(){var e=o(r().m(function e(t){var n,i,a,o,s,u,l,d,c,h,p,f,g,m,v,y,b,x,T;return r().w(function(e){for(;;)switch(e.n){case 0:if(n=t.getUint32(8,!0),void 0!==(i=J[n])){e.n=1;break}throw new Error(`Unsupported PVR pixel format: 0x${n.toString(16)}`);case 1:if(a=t.getInt32(24,!0),0!==(o=t.getInt32(28,!0))&&0!==a){e.n=2;break}throw new Error(`Invalid PVR texture dimensions: ${o}x${a}`);case 2:if(s=t.getInt32(44,!0),u=t.getUint32(48,!0),l=t.buffer,!((d=52+u)>l.byteLength)){e.n=3;break}throw new Error("Invalid PVR file: metadata exceeds file size");case 3:c=[],h=fe[i],p=0;case 4:if(!(p<s)){e.n=8;break}if(f=t.getUint32(d,!0),g=l.byteLength-(d+4),!(f>0&&f<=g)){e.n=5;break}return m=d+=4,v=d+f,c.push(l.slice(m,v)),d=(d=v)+3&-4,e.a(3,7);case 5:if(0!==n&&1!==n&&2!==n&&3!==n){e.n=6;break}return y=ie(o>>p,a>>p,0===n||1===n?2:4),c.push(l.slice(d,d+y)),d=(d+=y)+3&-4,e.a(3,7);case 6:void 0!==h&&(b=Math.ceil((o>>p)/h.width),x=Math.ceil((a>>p)/h.height),T=b*x*h.bytes,c.push(l.slice(d,d+T)),d=(d+=T)+3&-4);case 7:p++,e.n=4;break;case 8:return e.a(2,{data:{blockInfo:fe[i],glInternalFormat:i,mipmaps:c,width:o,height:a,type:"pvr"},premultiplyAlpha:!1})}},e)}));return function(t){return e.apply(this,arguments)}}(),oe={width:4,height:4,bytes:8},se={width:4,height:4,bytes:16},ue={width:5,height:5,bytes:16},le={width:6,height:6,bytes:16},de={width:8,height:4,bytes:8},ce={width:8,height:8,bytes:16},he={width:10,height:10,bytes:16},pe={width:12,height:12,bytes:16},fe={33776:oe,33777:oe,33778:se,33779:se,36196:oe,37492:oe,37493:oe,37496:se,37497:se,35840:oe,35842:oe,35841:de,35843:de,37808:se,37840:se,37809:ue,37841:ue,37810:le,37842:le,37811:ce,37843:ce,37812:he,37844:he,37813:pe,37845:pe},ge={ktx:function(e,t,n){var r=n.glInternalFormat,i=n.mipmaps,a=n.width,o=n.height,s=n.blockInfo;e.bindTexture(t);for(var u=s.width,l=s.height,d=a,c=o,h=0;h<i.length;h++){var p=new Uint8Array(i[h]),f=Math.ceil(d/u)*u,g=Math.ceil(c/l)*l,m=Math.ceil(d/u)*Math.ceil(c/l)*s.bytes;if(p.byteLength<m){var v=new Uint8Array(m);v.set(p),p=v}e.compressedTexImage2D(h,r,f,g,0,p),d=Math.max(1,d>>1),c=Math.max(1,c>>1)}e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,i.length>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)},pvr:function(e,t,n){var r=n.glInternalFormat,i=n.mipmaps,a=n.width,o=n.height;e.bindTexture(t);for(var s=a,u=o,l=0;l<i.length;l++)e.compressedTexImage2D(l,r,s,u,0,new Uint8Array(i[l])),s=Math.max(1,s>>1),u=Math.max(1,u>>1);e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,i.length>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)},astc:function(e,t,n){if(null===e.getExtension("WEBGL_compressed_texture_astc"))throw new Error("ASTC compressed textures not supported by this device");e.bindTexture(t);var r=n.glInternalFormat,i=n.mipmaps,a=n.width,o=n.height,s=new Uint8Array(i[0]);e.compressedTexImage2D(0,r,a,o,0,s),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR)}};var me=(e,t,n,r,i,a,o)=>new Promise((s,u)=>{var l=document.createElement("canvas"),d=l.getContext("2d");d.imageSmoothingEnabled=!0;var c=new Image;c.onload=()=>{var e=null!=r?r:0,u=null!=i?i:0,h=t||c.width,p=n||c.height;l.width=h,l.height=p,d.drawImage(c,0,0,h,p),s({data:d.getImageData(e,u,null!=a?a:h,null!=o?o:p),premultiplyAlpha:!1})},c.onerror=e=>{u(e)},c.src=e});function ve(e,t=""){return new Promise((n,r)=>{var i=new XMLHttpRequest;i.responseType=t,i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(0===i.status||200===i.status?n(i.response):r(i.statusText))},i.open("GET",e,!0),i.send(null)})}class ye extends b{constructor(e,t){var n,r=ye.resolveDefaults(t);super(e),s(this,"type",m.image),s(this,"props",void 0),this.props=r,this.maxRetryCount=null!==(n=r.maxRetryCount)&&void 0!==n?n:this.txManager.maxRetryCount}hasAlphaChannel(e){return-1!==e.indexOf("image/png")}loadImageFallback(e,t){return o(r().m(function n(){var i;return r().w(function(n){for(;;)if(0===n.n)return i=new Image,"string"==typeof e&&!1===M(e)&&(i.crossOrigin="anonymous"),n.a(2,new Promise((n,r)=>{i.onload=()=>{n({data:i,premultiplyAlpha:t})},i.onerror=e=>{var t=e instanceof Error?e.message:e instanceof Event?`Image loading failed for ${i.src}`:"Unknown image loading error";r(new Error(`Image loading failed: ${t}`))},e instanceof Blob?i.src=URL.createObjectURL(e):i.src=e}))},n)}))()}createImageBitmap(e,t,n,i,a,s){var u=this;return o(r().m(function o(){var l,d,c,h,p,f,g,m,v;return r().w(function(r){for(;;)switch(r.p=r.n){case 0:if(l=null!=t?t:e.type.includes("image/png"),!0!==(d=u.txManager.imageBitmapSupported).full||null===a||null===s){r.n=4;break}return r.p=1,r.n=2,createImageBitmap(e,n||0,i||0,a,s,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"});case 2:return c=r.v,r.a(2,{data:c,premultiplyAlpha:l});case 3:throw r.p=3,p=r.v,new Error(`Failed to create image bitmap with crop: ${p}`);case 4:if(!0!==d.basic){r.n=8;break}return r.p=5,r.n=6,createImageBitmap(e);case 6:return f=r.v,g=l,r.a(2,{data:f,premultiplyAlpha:g});case 7:throw r.p=7,m=r.v,new Error(`Failed to create basic image bitmap: ${m}`);case 8:return r.p=8,r.n=9,createImageBitmap(e,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"});case 9:return h=r.v,r.a(2,{data:h,premultiplyAlpha:l});case 10:throw r.p=10,v=r.v,new Error(`Failed to create image bitmap with options: ${v}`);case 11:return r.a(2)}},o,null,[[8,10],[5,7],[1,3]])}))()}loadImage(e){var t=this;return o(r().m(function n(){var i,a,o,s,u,l,d,c,h;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:if(i=t.props,a=i.premultiplyAlpha,o=i.sx,s=i.sy,u=i.sw,l=i.sh,!0!==t.txManager.hasCreateImageBitmap){n.n=8;break}if(!1!==M(e)||!0!==t.txManager.hasWorker||null===t.txManager.imageWorkerManager){n.n=3;break}return n.p=1,n.a(2,t.txManager.imageWorkerManager.getImage(e,a,o,s,u,l));case 2:throw n.p=2,c=n.v,new Error(`Failed to load image via worker: ${c}`);case 3:if(!0!==M(e)){n.n=4;break}d=R(e),n.n=7;break;case 4:return n.p=4,n.n=5,ve(e,"blob");case 5:d=n.v,n.n=7;break;case 6:throw n.p=6,h=n.v,new Error(`Failed to fetch image blob from ${e}: ${h}`);case 7:return n.a(2,t.createImageBitmap(d,a,o,s,u,l));case 8:return n.a(2,t.loadImageFallback(e,null==a||a))}},n,null,[[4,6],[1,2]])}))()}getTextureSource(){var e=this;return o(r().m(function t(){var n,i,a;return r().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,e.determineImageTypeAndLoadImage();case 1:i=t.v,t.n=3;break;case 2:return t.p=2,a=t.v,e.setState("failed",a),t.a(2,{data:null});case 3:if(null!==i.data){t.n=4;break}return e.setState("failed",Error("ImageTexture: No image data")),t.a(2,{data:null});case 4:return t.a(2,{data:i.data,premultiplyAlpha:null===(n=e.props.premultiplyAlpha)||void 0===n||n})}},t,null,[[0,2]])}))()}determineImageTypeAndLoadImage(){var e=this.props,t=e.src,n=e.premultiplyAlpha,r=e.type;if(null===t)return{data:null};if("string"!=typeof t){if(t instanceof Blob){if(!0===this.txManager.hasCreateImageBitmap){var i=this.props,a=i.sx,o=i.sy,s=i.sw,u=i.sh;return this.createImageBitmap(t,n,a,o,s,u)}return this.loadImageFallback(t,null==n||n)}return t instanceof ImageData?{data:t,premultiplyAlpha:n}:{data:t(),premultiplyAlpha:n}}var l=function(e){if("file:"===self.location.protocol&&!x.test(e)){var t=self.location.pathname.split("/");t.pop();var n=t.join("/"),r=self.location.protocol+"//"+n;return"."===e.charAt(0)&&(e=e.slice(1)),"/"===e.charAt(0)&&(e=e.slice(1)),r+"/"+e}return new URL(e,self.location.href).href}(t);return"regular"===r?this.loadImage(l):"svg"===r||!0===/\.(svg)(\?.*)?$/.test(t)?me(l,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):"compressed"===r||!0===function(e){return/\.(ktx|pvr)$/.test(e)}(t)?ee(l):this.loadImage(l)}static makeCacheKey(e){var t,n=ye.resolveDefaults(e),r=n.key||n.src;if("string"!=typeof r)return!1;var i,a,o="";null!==n.sh&&null!==n.sw&&(o+=",",o+=null!==(i=n.sx)&&void 0!==i?i:"",o+=null!==(a=n.sy)&&void 0!==a?a:"",o+=n.sw||"",o+=n.sh||"");return`ImageTexture,${r},${null!==(t=n.premultiplyAlpha)&&void 0!==t?t:"true"}${o}`}static resolveDefaults(e){var t,n,r,i,a,o,s,u,l,d,c;return{src:null!==(t=e.src)&&void 0!==t?t:"",premultiplyAlpha:null===(n=e.premultiplyAlpha)||void 0===n||n,key:null!==(r=e.key)&&void 0!==r?r:null,type:null!==(i=e.type)&&void 0!==i?i:null,width:null!==(a=e.width)&&void 0!==a?a:null,height:null!==(o=e.height)&&void 0!==o?o:null,sx:null!==(s=e.sx)&&void 0!==s?s:null,sy:null!==(u=e.sy)&&void 0!==u?u:null,sw:null!==(l=e.sw)&&void 0!==l?l:null,sh:null!==(d=e.sh)&&void 0!==d?d:null,maxRetryCount:null!==(c=e.maxRetryCount)&&void 0!==c?c:null}}}s(ye,"z$__type__Props",void 0);class be extends b{constructor(e,t){super(e),s(this,"props",void 0),s(this,"type",m.noise),this.props=be.resolveDefaults(t)}getTextureSource(){var e=this;return o(r().m(function t(){var n,i,a,o,s,u,l;return r().w(function(t){for(;;)if(0===t.n){for(n=e.props,i=n.width,a=n.height,o=i*a*4,s=new Uint8ClampedArray(o),u=0;u<o;u+=4)l=Math.floor(256*Math.random()),s[u]=l,s[u+1]=l,s[u+2]=l,s[u+3]=255;return t.a(2,{data:new ImageData(s,i,a)})}},t)}))()}static makeCacheKey(e){if(void 0===e.cacheId)return!1;var t=be.resolveDefaults(e);return`NoiseTexture,${t.width},${t.height},${t.cacheId}`}static resolveDefaults(e){var t,n,r;return{width:null!==(t=e.width)&&void 0!==t?t:128,height:null!==(n=e.height)&&void 0!==n?n:128,cacheId:null!==(r=e.cacheId)&&void 0!==r?r:0}}}s(be,"z$__type__Props",void 0);var xe,Te=0;class we extends b{constructor(e,t){super(e),s(this,"props",void 0),s(this,"parentTexture",void 0),s(this,"type",m.subTexture),s(this,"subtextureId","subtexture-"+Te++),s(this,"onParentTxLoaded",()=>{this.forwardParentTxState("loaded",{width:this.props.width,height:this.props.height})}),s(this,"onParentTxFailed",(e,t)=>{this.retryCount=this.parentTexture.retryCount-1,this.forwardParentTxState("failed",t)}),s(this,"onParentTxLoading",()=>{this.forwardParentTxState("loading")}),s(this,"onParentTxFreed",()=>{this.forwardParentTxState("freed")}),this.props=we.resolveDefaults(t||{}),this.props.texture,this.props.texture,this.parentTexture=e.resolveParentTexture(this.props.texture),this.renderableOwners.length>0&&this.parentTexture.setRenderableOwner(this.subtextureId,!0),queueMicrotask(()=>{var e=this.parentTexture;"loaded"===e.state&&e.dimensions?this.onParentTxLoaded(e,e.dimensions):"loading"===e.state?this.onParentTxLoading():"failed"===e.state&&e.error?this.onParentTxFailed(e,e.error):"freed"===e.state&&this.onParentTxFreed(),e.on("loading",this.onParentTxLoading),e.on("loaded",this.onParentTxLoaded),e.on("failed",this.onParentTxFailed),e.on("freed",this.onParentTxFreed)})}forwardParentTxState(e,t){this.setState(e,t)}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this.subtextureId,e)}getTextureSource(){var e=this;return o(r().m(function t(){return r().w(function(t){for(;;)if(0===t.n)return t.a(2,{data:e.props})},t)}))()}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}}s(we,"z$__type__Props",void 0);class Se extends b{constructor(e,t){super(e),s(this,"props",void 0),s(this,"type",m.renderToTexture),this.props=Se.resolveDefaults(t||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}getTextureSource(){return o(r().m(function e(){return r().w(function(e){for(;;)if(0===e.n)return e.a(2,{data:null,premultiplyAlpha:null})},e)}))()}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}}function Ae(){return(Ae=o(r().m(function e(){var t,n,i,a,o,s,u,l,d,c;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=new Uint8Array([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1,0,0,0,1,1,3,0,0,0,37,219,86,202,0,0,0,3,80,76,84,69,0,0,0,167,122,61,218,0,0,0,1,116,82,78,83,0,64,230,216,102,0,0,0,10,73,68,65,84,8,215,99,96,0,0,0,2,0,1,226,33,188,51,0,0,0,0,73,69,78,68,174,66,96,130]),i={basic:!1,options:!1,full:!1},a=new Blob([n],{type:"image/png"}),e.n=1,createImageBitmap(a);case 1:return o=e.v,null===(t=o.close)||void 0===t||t.call(o),i.basic=!0,e.p=2,u={premultiplyAlpha:"none"},e.n=3,createImageBitmap(a,u);case 3:l=e.v,null===(s=l.close)||void 0===s||s.call(l),i.options=!0,e.n=5;break;case 4:e.p=4,e.v;case 5:return e.p=5,e.n=6,createImageBitmap(a,0,0,1,1,{premultiplyAlpha:"none"});case 6:c=e.v,null===(d=c.close)||void 0===d||d.call(c),i.full=!0,e.n=8;break;case 7:e.p=7,e.v;case 8:return e.a(2,i)}},e,null,[[5,7],[2,4]])}))).apply(this,arguments)}s(Se,"z$__type__Props",void 0),function(e){e.MEMORY_THRESHOLD_EXCEEDED="MEMORY_THRESHOLD_EXCEEDED",e.TEXTURE_DATA_NULL="TEXTURE_DATA_NULL",e.TEXTURE_TYPE_NOT_REGISTERED="TEXTURE_TYPE_NOT_REGISTERED"}(xe||(xe={}));var Ee={[xe.MEMORY_THRESHOLD_EXCEEDED]:"Memory threshold exceeded",[xe.TEXTURE_DATA_NULL]:"Texture data is null",[xe.TEXTURE_TYPE_NOT_REGISTERED]:"Texture type is not registered"};class ke extends Error{constructor(e,t){var n=Object.values(xe).includes(e),r=n?e:void 0;super(n&&r?null!=t?t:Ee[r]:String(e)),s(this,"code",void 0),this.name=new.target.name,r&&(this.code=r)}}class Ie extends y{constructor(e,t){super(),s(this,"keyCache",new Map),s(this,"inverseKeyCache",new WeakMap),s(this,"txConstructors",{}),s(this,"maxRetryCount",void 0),s(this,"priorityQueue",[]),s(this,"uploadTextureQueue",[]),s(this,"initialized",!1),s(this,"stage",void 0),s(this,"numImageWorkers",void 0),s(this,"imageWorkerManager",null),s(this,"hasCreateImageBitmap",!!self.createImageBitmap),s(this,"imageBitmapSupported",{basic:!1,options:!1,full:!1}),s(this,"hasWorker",!!self.Worker),s(this,"renderer",void 0),s(this,"frameTime",0);var n=t.numImageWorkers,r=t.createImageBitmapSupport,i=t.maxRetryCount;this.stage=e,this.numImageWorkers=n,this.maxRetryCount=i,"auto"===r?function(){return Ae.apply(this,arguments)}().then(e=>{this.initialize(e)}).catch(()=>{console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.initialized=!0,this.emit("initialized")}):this.initialize({basic:"basic"===r,options:"options"===r,full:"full"===r}),this.registerTextureType("ImageTexture",ye),this.registerTextureType("ColorTexture",$),this.registerTextureType("NoiseTexture",be),this.registerTextureType("SubTexture",we),this.registerTextureType("RenderTexture",Se)}registerTextureType(e,t){this.txConstructors[e]=t}initialize(e){this.hasCreateImageBitmap=e.basic||e.options||e.full,this.imageBitmapSupported=e,this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.hasCreateImageBitmap&&this.hasWorker&&this.numImageWorkers>0?this.imageWorkerManager=new Y(this.numImageWorkers,e):console.warn("[Lightning] Imageworker is 0 or not supported on this browser. Image loading will be slower."),this.initialized=!0,this.emit("initialized")}enqueueUploadTexture(e){!1===this.uploadTextureQueue.includes(e)&&this.uploadTextureQueue.push(e)}createTexture(e,t){var n,r=this.txConstructors[e];if(!r)throw new ke(xe.TEXTURE_TYPE_NOT_REGISTERED,`Texture type "${e}" is not registered`);var i=r.makeCacheKey(t);return i&&this.keyCache.has(i)?n=this.keyCache.get(i):(n=new r(this,t),i&&this.initTextureToCache(n,i)),n}loadTexture(e,t){var n=this;return o(r().m(function i(){return r().w(function(r){for(;;)switch(r.n){case 0:if(e.type!==m.subTexture){r.n=1;break}return r.a(2);case 1:if("loaded"!==e.state){r.n=2;break}return r.a(2);case 2:if("loading"!==e.state){r.n=3;break}return r.a(2);case 3:if(!1!==n.initialized){r.n=4;break}return n.priorityQueue.push(e),r.a(2);case 4:return e.setState("loading"),r.n=5,e.getTextureData().catch(t=>(console.error(t),e.setState("failed"),null));case 5:if(null!==r.v&&"failed"!==e.state){r.n=6;break}return r.a(2);case 6:if(!0!==(e.type!==m.image||!0===t)){r.n=8;break}return r.n=7,n.uploadTexture(e).catch(t=>{console.error("Failed to upload texture:",t),e.setState("failed")});case 7:return r.a(2);case 8:n.enqueueUploadTexture(e);case 9:return r.a(2)}},i)}))()}uploadTexture(e){var t=this;return o(r().m(function n(){var i;return r().w(function(n){for(;;)switch(n.n){case 0:if(!0!==t.stage.txMemManager.doNotExceedCriticalThreshold||!0!==t.stage.txMemManager.criticalCleanupRequested){n.n=1;break}return e.setState("failed",new ke(xe.MEMORY_THRESHOLD_EXCEEDED)),n.a(2);case 1:if("failed"!==e.state&&"freed"!==e.state){n.n=2;break}return n.a(2);case 2:if("loaded"!==e.state){n.n=3;break}return n.a(2);case 3:if(null!==e.textureData){n.n=4;break}return e.setState("failed",new ke(xe.TEXTURE_DATA_NULL,"Texture data is null, cannot upload texture")),n.a(2);case 4:if(null===(i=e.loadCtxTexture())||"loaded"!==i.state){n.n=5;break}return e.setState("loaded"),n.a(2);case 5:return n.n=6,i.load();case 6:return n.a(2)}},n)}))()}isProcessingTexture(e){return!0===this.uploadTextureQueue.includes(e)}processSome(e){var t=this;return o(r().m(function n(){var i,a,o,s,u;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:if(!1!==t.initialized){n.n=1;break}return n.a(2);case 1:i=W();case 2:if(!(t.priorityQueue.length>0&&W()-i<e)){n.n=8;break}return a=t.priorityQueue.pop(),n.p=3,n.n=4,a.getTextureData();case 4:return n.n=5,t.uploadTexture(a);case 5:n.n=7;break;case 6:n.p=6,s=n.v,console.error("Failed to process priority texture:",s);case 7:n.n=2;break;case 8:if(!(t.uploadTextureQueue.length>0&&W()-i<e)){n.n=13;break}return o=t.uploadTextureQueue.shift(),n.p=9,n.n=10,t.uploadTexture(o);case 10:n.n=12;break;case 11:n.p=11,u=n.v,console.error("Failed to upload texture:",u);case 12:n.n=8;break;case 13:return n.a(2)}},n,null,[[9,11],[3,6]])}))()}hasUpdates(){return this.uploadTextureQueue.length>0}initTextureToCache(e,t){var n=this.keyCache,r=this.inverseKeyCache;n.set(t,e),r.set(e,t)}getTextureFromCache(e){return this.keyCache.get(e)}removeTextureFromCache(e){var t=this.inverseKeyCache,n=this.keyCache,r=t.get(e);r&&n.delete(r)}resolveParentTexture(e){if(null==e||!e.props)return e;var t=ye.makeCacheKey(e.props),n=t?this.getTextureFromCache(t):void 0;return null!=n?n:e}}var Ce={normal:400,bold:700,bolder:900,lighter:100},Me=e=>"number"==typeof e?e:Ce[e]||400;class Re{constructor(e){s(this,"textRenderers",void 0),s(this,"fontCache",new Map),this.textRenderers=e}addFontFace(e){for(var t in this.textRenderers){var n=this.textRenderers[t];n&&n.isFontFaceSupported(e)&&n.addFontFace(e)}}resolveFontFace(e,t,n){var r=t.fontFamily,i=t.fontWeight,a=t.fontStyle,o=t.fontStretch,s=`${n}_${r}_${a}_${i}_${o}`;if(!0===this.fontCache.has(s))return this.fontCache.get(s);var l=function(e,t,n,r,i){var a,o=Me(n),s=u(e);try{for(s.s();!(a=s.n()).done;){var l=a.value[t];if(l){if(1===l.size)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),l.values().next().value;var d,c=new Map,h=u(l);try{for(h.s();!(d=h.n()).done;){var p=d.value,f=Me(p.descriptors.weight);if(f===o&&p.descriptors.style===r&&p.descriptors.stretch===i)return p;c.set(f,p)}}catch(m){h.e(m)}finally{h.f()}var g=`TrFontManager: No exact match: '${t} Weight: ${o} Style: ${r} Stretch: ${i}'`;if(console.error(g),400===o&&c.has(500))return c.get(500);if(500===o&&c.has(400))return c.get(400);if(o<400){for(;o>0;){if(c.has(o))return c.get(o);o-=100}o=600}for(;o<1e3;){if(c.has(o))return c.get(o);o+=100}for(o=500;o>0;){if(c.has(o))return c.get(o);o-=100}}}}catch(m){s.e(m)}finally{s.f()}}(e,r,i,a,o);return void 0!==l&&this.fontCache.set(s,l),l}}class _e{static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}function Pe(e,t,n){var r=e.createShader(t);if(!r){var i=e.getError();throw new Error(`Unable to create the shader: ${t===e.VERTEX_SHADER?"VERTEX_SHADER":"FRAGMENT_SHADER"}.${i?` WebGlContext Error: ${i}`:""}`)}if(e.shaderSource(r,n),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.error(e.getShaderInfoLog(r)),e.deleteShader(r)}class De extends _e{constructor(e){super(),s(this,"buffersBound",!1),s(this,"program",void 0),s(this,"vao",void 0),s(this,"renderer",void 0),s(this,"glw",void 0),s(this,"attributeLocations",void 0),s(this,"uniformLocations",void 0),s(this,"supportsIndexedTextures",void 0);var t=this.renderer=e.renderer,n=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;var r=n.isWebGl2(),i=r&&e.webgl2Extensions||!r&&e.webgl1Extensions||[],a=r?"2.0":"1.0";i.forEach(e=>{if(!n.getExtension(e))throw new Error(`Shader "${this.constructor.name}" requires extension "${e}" for WebGL ${a} but wasn't found`)});var o=e.shaderSources||this.constructor.shaderSources;if(!o)throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);r&&null!=o&&o.webGl2&&(o.fragment=o.webGl2.fragment,o.vertex=o.webGl2.vertex,delete o.webGl2);var u=t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,l=o.vertex instanceof Function?o.vertex(u):o.vertex,d=o.fragment instanceof Function?o.fragment(u):o.fragment,c=Pe(n,n.VERTEX_SHADER,l),h=Pe(n,n.FRAGMENT_SHADER,d);if(!c||!h)throw new Error(`Unable to create the following shader(s): ${[!c&&"VERTEX_SHADER",!h&&"FRAGMENT_SHADER"].filter(Boolean).join(" and ")}`);var p=function(e,t,n){var r=e.createProgram();if(!r)throw new Error("Unable to create program");if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;console.warn(e.getProgramInfoLog(r)),e.deleteProgram(r)}(n,c,h);if(!p)throw new Error("Unable to create program");this.program=p,this.attributeLocations=n.getAttributeLocations(this.program),this.uniformLocations=n.getUniformLocations(this.program)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(var e=this.glw,t=this.attributeLocations.length,n=0;n<t;n++)e.disableVertexAttribArray(n)}canBatchShaderProps(e,t){return!1}bindRenderOp(e,t){var n;this.bindBufferCollection(e.buffers),e.textures.length>0&&null!==(n=e.textures[0])&&void 0!==n&&n.ctxTexture&&this.bindTextures(e.textures);var r=e.glw,i=e.parentHasRenderTexture;if(!e.renderToTexture||!i){if(i){var a=e.framebufferDimensions||{},o=a.width,s=a.height;r.uniform1f(this.getUniformLocation("u_pixelRatio"),1),r.uniform2f(this.getUniformLocation("u_resolution"),null!=o?o:0,null!=s?s:0)}else r.uniform1f(this.getUniformLocation("u_pixelRatio"),e.options.pixelRatio),r.uniform2f(this.getUniformLocation("u_resolution"),r.canvas.width,r.canvas.height);if(t){if(g(t,"$dimensions")){var u=t.$dimensions;u||(u=e.dimensions),r.uniform2f(this.getUniformLocation("u_dimensions"),u.width,u.height)}if(g(t,"$alpha")){var l=t.$alpha;l||(l=e.alpha),r.uniform1f(this.getUniformLocation("u_alpha"),l)}this.bindProps(t)}}}getUniformLocation(e){return this.uniformLocations[e]||null}bindBufferCollection(e){for(var t=this.glw,n=this.attributeLocations,r=n.length,i=0;i<r;i++){var a=n[i],o=e.getBuffer(a),s=e.getAttributeInfo(a);void 0!==o&&void 0!==s&&(t.enableVertexAttribArray(i),t.vertexAttribPointer(o,i,s.size,s.type,s.normalized,s.stride,s.offset))}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}s(De,"shaderSources",void 0);class Le extends De{constructor(e){super({renderer:e})}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}}s(Le,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_nodeCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class Ne extends De{constructor(e){super({renderer:e}),s(this,"supportsIndexedTextures",!0)}bindTextures(e){var t=this.renderer,n=this.glw;if(e.length>t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((e,t)=>{n.activeTexture(t),n.bindTexture(e.ctxTexture)});var r=Array.from(Array(e.length).keys());this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"),r)}}s(Ne,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>`\n      #define txUnits ${e}\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {\n        ${Array.from(Array(e).keys()).map(e=>`\n          ${0!==e?"else ":""}if (idx == ${e}) {\n            return texture2D(textures[${e}], uv);\n          }\n        `).join("")}\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    `});class Oe{static getEffectKey(e){return""}static getMethodParameters(e,t){var n=[];for(var r in e){var i=e[r],a="";i.size&&(a=`[${i.size(t)}]`),n.push(`${i.type} ${r}${a}`)}return n.join(",")}constructor(e){s(this,"priority",1),s(this,"name",""),s(this,"ref",void 0),s(this,"target",void 0),s(this,"passParameters",""),s(this,"declaredUniforms",""),s(this,"uniformInfo",{});var t=e.ref,n=e.target,r=e.props,i=void 0===r?{}:r;this.ref=t,this.target=n;var a={},o=[],u="",l=this.constructor.uniforms||{};for(var d in l){var c=l[d],h=c.type,p=`${t}_${d}`,f="";c.size&&(f=`[${c.size(i)}]`),o.push(p),u+=`uniform ${h} ${p}${f};`,a[d]={name:p,uniform:l[d].method}}this.passParameters=o.join(","),this.declaredUniforms=u,this.uniformInfo=a}static resolveDefaults(e){return{}}static makeEffectKey(e){return!1}}s(Oe,"uniforms",{}),s(Oe,"methods",void 0),s(Oe,"onShaderMask",void 0),s(Oe,"onColorize",void 0),s(Oe,"onEffectMask",void 0);var Ue=new Map,Be=(e,t)=>{var n=JSON.stringify(e);if(Ue.has(n))return Ue.get(n);for(var r=[],i=(e=null!=e?e:[]).length,a=0;a<i;a++){for(var o=e[a],s=o.name,u=o.type,l=o.props,d={name:s,type:u,props:{}},c=t[u],h=c.resolveDefaults(l),p=c.uniforms,f=Object.keys(p),g=f.length,m=0;m<g;m++){var v=f[m],y=p[v],b={value:h[v],programValue:void 0,method:y.method,updateOnBind:y.updateOnBind||!1,hasValidator:void 0!==y.validator,hasProgramValueUpdater:void 0!==y.updateProgramValue},x=b.hasValidator&&y.validator(h[v],h)||h[v];h[v]!==x&&(b.validatedValue=x),b.hasProgramValueUpdater&&y.updateProgramValue(b),void 0===b.programValue&&(b.programValue=b.value),d.props[v]=b}r.push(d)}return Ue.set(n,r),r};class je extends De{constructor(e,t,n){var r=je.createShader(t,n);super({renderer:e,shaderSources:{vertex:r.vertex,fragment:r.fragment}}),s(this,"effects",[]),this.effects=r.effects}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindUniformMethods(e){for(var t=this,n=this.glw,r=e.effects,i=r.length,a=0;a<i;a++)for(var o=this.effects[a].uniformInfo,s=r[a],u=Object.keys(s.props),l=u.length,d=function(){var e=u[c],r=s.props[e].method,i=t.getUniformLocation(o[e].name);return"uniform2fv"===r||"uniform2iv"===r||"uniform3iv"===r||"uniform4fv"===r||"uniform4iv"===r||"uniformMatrix2fv"===r||"uniformMatrix3fv"===r||"uniformMatrix4fv"===r||"uniform1f"===r||"uniform1fv"===r||"uniform1i"===r||"uniform1iv"===r?(s.props[e].setUniformValue=function(){n[r](i,this.programValue)},0):"uniform2f"===r||"uniform2i"===r?(s.props[e].setUniformValue=function(){n[r](i,this.programValue[0],this.programValue[1])},0):"uniform3f"===r||"uniform3i"===r?(s.props[e].setUniformValue=function(){n[r](i,this.programValue[0],this.programValue[1],this.programValue[2])},0):"uniform4f"===r||"uniform4i"===r?(s.props[e].setUniformValue=function(){n[r](i,this.programValue[0],this.programValue[1],this.programValue[2],this.programValue[3])},0):void 0},c=0;c<l;c++)d()}bindProps(e){for(var t=e.effects,n=t.length,r=0;r<n;r++)for(var i=t[r],a=Object.keys(i.props),o=a.length,s=0;s<o;s++){var u=a[s],l=i.props[u];if(!0===l.updateOnBind){var d,c=null===(d=this.renderer.shManager.getRegisteredEffects()[i.type])||void 0===d?void 0:d.uniforms[u];null==c||c.updateProgramValue(i.props[u],e)}l.setUniformValue()}}canBatchShaderProps(e,t){if(e.$alpha!==t.$alpha||e.$dimensions.width!==t.$dimensions.width||e.$dimensions.height!==t.$dimensions.height||e.effects.length!==t.effects.length)return!1;for(var n=e.effects.length,r=0;r<n;r++){var i=e.effects[r],a=t.effects[r];if(i.type!==a.type)return!1;for(var o in i.props)if(a.props&&!a.props[o]||i.props[o].value!==a.props[o].value)return!1}return!0}static createShader(e,t){var n={},r={},i="",a=[],o=[],s=e.effects.map(e=>{var r=t[e.type],s=r.getEffectKey(e.props||{});n[s]=n[s]?++n[s]:1;var u=n[s];1===u&&o.push({key:s,type:e.type,props:e.props});var l=new r({ref:`${s}${1===u?"":u}`,target:s,props:e.props});return i+=l.declaredUniforms,a.push(...Object.values(l.uniformInfo)),l}),u="";null==o||o.forEach(e=>{var n,i=t[e.type],a=i.resolveDefaults(null!==(n=e.props)&&void 0!==n?n:{}),o=[];for(var s in i.methods){var l=s,d=i.methods[s];r[s]&&r[s]!==d&&(l=je.resolveMethodDuplicate(s,d,r)),r[l]=d.replace("function",l),o.push({m:s,cm:l})}var c=i.onShaderMask instanceof Function?i.onShaderMask(a):i.onShaderMask,h=i.onColorize instanceof Function?i.onColorize(a):i.onColorize,p=i.onEffectMask instanceof Function?i.onEffectMask(a):i.onEffectMask;o.forEach(e=>{var t=e.m,n=e.cm,r=new RegExp(`\\$${t}`,"g");c&&(c=c.replace(r,n)),h&&(h=h.replace(r,n)),p&&(p=p.replace(r,n))});var f=i.getMethodParameters(i.uniforms,a),g=f.length>0?`, ${f}`:"";c&&(u+=`\n        float fx_${e.key}_onShaderMask(float shaderMask ${g}) {\n          ${c}\n        }\n        `),h&&(u+=`\n          vec4 fx_${e.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${g}) {\n            ${h}\n          }\n        `),p&&(u+=`\n          vec4 fx_${e.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${g}) {\n            ${p}\n          }\n        `)});var l="";for(var d in r)l+=r[d];for(var c="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",h="\n\n    ",p=0;p<s.length;p++){var f=s[p],g=f.passParameters.length>0?`, ${f.passParameters}`:"",m=t[f.name];m.onShaderMask&&(h+=`\n        shaderMask = fx_${f.target}_onShaderMask(shaderMask ${g});\n        `),m.onColorize&&(h+=`\n        maskColor = fx_${f.target}_onColorize(shaderMask, maskColor, shaderColor${g});\n        `),m.onEffectMask&&(c=`fx_${f.target}_onEffectMask(shaderMask, maskColor, shaderColor${g})`);var v=s[p+1];(void 0===v||t[v.name].onEffectMask)&&(h+=`\n          shaderColor = ${c};\n        `)}return{effects:s,uniforms:a,fragment:je.fragment(i,l,u,h),vertex:je.vertex()}}static resolveMethodDuplicate(e,t,n,r=0){var i=e+(r>0?r:"");return n[i]&&n[i]!==t?this.resolveMethodDuplicate(e,t,n,++r):i}static resolveDefaults(e,t){var n;return{effects:Be(null!==(n=e.effects)&&void 0!==n?n:[],t),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,t){var n,r="";return null===(n=e.effects)||void 0===n||n.forEach(e=>{var n=t[e.type].getEffectKey(e.props||{});r+=`,${n}`}),`DynamicShader${r}`}}s(je,"z$__type__Props",void 0),s(je,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_nodeCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n    varying vec2 v_nodeCoordinate;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n      v_nodeCoordinate = a_nodeCoordinate;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),s(je,"fragment",(e,t,n,r)=>`\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ${e}\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying vec2 v_nodeCoordinate;\n\n    ${t}\n\n    ${n}\n\n    void main() {\n      vec2 p = v_nodeCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ${r}\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  `);class Fe extends De{constructor(e){super({renderer:e})}static resolveDefaults(e){return{radius:e.radius||10,$dimensions:{width:0,height:0}}}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindProps(e){var t=Math.min(e.$dimensions.width,e.$dimensions.height)/(2*e.radius);this.glw.uniform1f(this.getUniformLocation("u_radius"),e.radius*Math.min(t,1))}canBatchShaderProps(e,t){return e.radius===t.radius&&e.$dimensions.width===t.$dimensions.width&&e.$dimensions.height===t.$dimensions.height}}s(Fe,"z$__type__Props",void 0),s(Fe,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute vec2 a_nodeCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});var Ve=new Float32Array([1,0,0,0,1,0,0,0,1]);class He extends De{constructor(e){super({renderer:e})}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindProps(e){var t=He.resolveDefaults(e);for(var n in t)if("transform"===n)this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"),t[n]);else if("scrollY"===n)this.glw.uniform1f(this.getUniformLocation("u_scrollY"),t[n]);else if("color"===n){var r=T(t.color);this.glw.uniform4fv(this.getUniformLocation("u_color"),r)}else"size"===n?this.glw.uniform1f(this.getUniformLocation("u_size"),t[n]):"distanceRange"===n?this.glw.uniform1f(this.getUniformLocation("u_distanceRange"),t[n]):"debug"===n&&this.glw.uniform1i(this.getUniformLocation("u_debug"),t[n]?1:0)}static resolveDefaults(e={}){var t,n,r,i,a,o;return{transform:null!==(t=e.transform)&&void 0!==t?t:Ve,scrollY:null!==(n=e.scrollY)&&void 0!==n?n:0,color:null!==(r=e.color)&&void 0!==r?r:4294967295,size:null!==(i=e.size)&&void 0!==i?i:16,distanceRange:null!==(a=e.distanceRange)&&void 0!==a?a:1,debug:null!==(o=e.debug)&&void 0!==o&&o}}}s(He,"z$__type__Props",void 0),s(He,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});var Ge=e=>{void 0===e.programValue&&(e.programValue=new Float32Array(4));var t=e.value,n=e.programValue;n[0]=(t>>>24)/255,n[1]=(t>>>16&255)/255,n[2]=(t>>>8&255)/255,n[3]=(255&t)/255},ze=e=>{var t=e.validatedValue||e.value;if(e.programValue instanceof Float32Array)for(var n=t.length,r=e.programValue,i=0;i<n;i++)r[i]=t[i];else e.programValue=new Float32Array(t)},Xe=e=>{var t=Array.isArray(e);return t?t&&4===e.length?e:t&&2===e.length?[e[0],e[1],e[0],e[1]]:t&&3===e.length?[e[0],e[1],e[2],e[0]]:[e[0],e[0],e[0],e[0]]:[e,e,e,e]},We=(e,t)=>{void 0===e.programValue&&(e.programValue=new Float32Array(4));var r=e.programValue,i=e.validatedValue||e.value;if(void 0===t&&void 0===e.$dimensions)return r[0]=i[0],r[1]=i[1],r[2]=i[2],void(r[3]=i[3]);var a=e.$dimensions;if(void 0!==t){var o=t.$dimensions;if(void 0!==a&&(a.width===o.width||a.height===o.height))return;void 0===a&&(a={width:null==o?void 0:o.width,height:null==o?void 0:o.height},e.$dimensions=a)}var s=a,u=s.width,l=s.height,d=n(i,4),c=d[0],h=d[1],p=d[2],f=d[3],g=Math.min(Math.min(Math.min(u/Math.max(u,c+h),u/Math.max(u,p+f)),Math.min(l/Math.max(l,c+p),l/Math.max(l,h+f))),1);r[0]=c*g,r[1]=h*g,r[2]=p*g,r[3]=f*g};class Ke extends Oe{constructor(...e){super(...e),s(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var t;return{radius:null!==(t=e.radius)&&void 0!==t?t:10}}}s(Ke,"z$__type__Props",void 0),s(Ke,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Xe,updateProgramValue:We}}),s(Ke,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),s(Ke,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_nodeCoordinate.x, 0.5) * step(v_nodeCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_nodeCoordinate.x) * step(v_nodeCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_nodeCoordinate.x) * step(0.5, v_nodeCoordinate.y);\n  r = r + radius[3] * step(v_nodeCoordinate.x, 0.5) * step(0.5, v_nodeCoordinate.y);\n  return $boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),s(Ke,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class qe extends Oe{constructor(...e){super(...e),s(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var t,n;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(n=e.color)&&void 0!==n?n:4294967295}}}s(qe,"z$__type__Props",void 0),s(qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ge,method:"uniform4fv",type:"vec4"}}),s(qe,"onEffectMask","\n  float intR = shaderMask + 1.0;\n  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  "),s(qe,"onColorize","\n    return color;\n  ");class Ye extends Oe{constructor(...e){super(...e),s(this,"name","linearGradient")}static getEffectKey(e){return e.colors.value?`linearGradient${e.colors.value.length}`:`linearGradient${e.colors.length}`}static resolveDefaults(e){var t,n,r=null!==(t=e.colors)&&void 0!==t?t:[4278190080,4294967295],i=e.stops||[];if(0===i.length||i.length!==r.length){for(var a=r.length,o=0,s=i;o<a;o++)i[o]?(s[o]=i[o],void 0===i[o-1]&&void 0!==s[o-2]&&(s[o-1]=s[o-2]+(i[o]-s[o-2])/2)):s[o]=o*(1/(r.length-1));i=s}return{colors:r,stops:i,angle:null!==(n=e.angle)&&void 0!==n?n:0}}}s(Ye,"z$__type__Props",void 0),s(Ye,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((e,t)=>e.concat(T(t)),[]),updateProgramValue:ze,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),s(Ye,"methods",{calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),s(Ye,"ColorLoop",e=>{for(var t="",n=2;n<e;n++)t+=`colorOut = mix(colorOut, colors[${n}], clamp((dist - stops[${n-1}]) / (stops[${n}] - stops[${n-1}]), 0.0, 1.0));`;return t}),s(Ye,"onColorize",e=>`\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_nodeCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ${e.colors.length||1};\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    `);class $e extends Oe{constructor(...e){super(...e),s(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){var t;return{amount:null!==(t=e.amount)&&void 0!==t?t:1}}}s($e,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),s($e,"onColorize","\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ");class Je extends Oe{constructor(...e){super(...e),s(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var t,n;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(n=e.color)&&void 0!==n?n:4294967295}}}s(Je,"z$__type__Props",void 0),s(Je,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ge,method:"uniform4fv",type:"vec4"}}),s(Je,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),s(Je,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),s(Je,"onColorize","\n    return color;\n  ");class Qe extends Oe{constructor(...e){super(...e),s(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var t,n;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(n=e.color)&&void 0!==n?n:4294967295}}}s(Qe,"z$__type__Props",void 0),s(Qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ge,method:"uniform4fv",type:"vec4"}}),s(Qe,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),s(Qe,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),s(Qe,"onColorize","\n    return color;\n  ");class Ze extends Oe{constructor(...e){super(...e),s(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var t,n;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(n=e.color)&&void 0!==n?n:4294967295}}}s(Ze,"z$__type__Props",void 0),s(Ze,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ge,method:"uniform4fv",type:"vec4"}}),s(Ze,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),s(Ze,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),s(Ze,"onColorize","\n    return color;\n  ");class et extends Oe{constructor(...e){super(...e),s(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var t,n;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(n=e.color)&&void 0!==n?n:4294967295}}}s(et,"z$__type__Props",void 0),s(et,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ge,method:"uniform4fv",type:"vec4"}}),s(et,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),s(et,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),s(et,"onColorize","\n    return color;\n  ");class tt extends Oe{constructor(...e){super(...e),s(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var t,n,r,i,a;return{amplitude:null!==(t=e.amplitude)&&void 0!==t?t:.2,narrowness:null!==(n=e.narrowness)&&void 0!==n?n:4,blockiness:null!==(r=e.blockiness)&&void 0!==r?r:2,minimizer:null!==(i=e.minimizer)&&void 0!==i?i:8,time:null!==(a=e.time)&&void 0!==a?a:Date.now()}}}s(tt,"z$__type__Props",void 0),s(tt,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{var t=e.value=(Date.now()-e.value)%1e3;e.programValue=t},type:"float"}}),s(tt,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),s(tt,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class nt extends Oe{constructor(...e){super(...e),s(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var t;return{fade:null!==(t=e.fade)&&void 0!==t?t:10}}}s(nt,"z$__type__Props",void 0),s(nt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:Xe,updateProgramValue:e=>{var t=e.validatedValue||e.value;if(e.programValue instanceof Float32Array){var n=e.programValue;n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3]}else e.programValue=new Float32Array(t)}}}),s(nt,"onColorize","\n  vec2 point = v_nodeCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_nodeCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_nodeCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class rt extends Oe{constructor(...e){super(...e),s(this,"name","radialGradient")}static getEffectKey(e){return e.colors.value?`radialGradient${e.colors.value.length}`:`radialGradient${e.colors.length}`}static resolveDefaults(e){var t,n,r,i,a,o=null!==(t=e.colors)&&void 0!==t?t:[4278190080,4294967295],s=e.stops||[];if(0===s.length||s.length!==o.length){for(var u=o.length,l=0,d=s;l<u;l++)s[l]?(d[l]=s[l],void 0===s[l-1]&&void 0!==d[l-2]&&(d[l-1]=d[l-2]+(s[l]-d[l-2])/2)):d[l]=l*(1/(o.length-1));s=d}return{colors:o,stops:s,width:null!==(n=e.width)&&void 0!==n?n:0,height:null!==(r=null!==(i=e.height)&&void 0!==i?i:e.width)&&void 0!==r?r:0,pivot:null!==(a=e.pivot)&&void 0!==a?a:[.5,.5]}}}s(rt,"z$__type__Props",void 0),s(rt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:e=>{var t=e.validatedValue||e.value;if(e.programValue instanceof Float32Array){var n=e.programValue;n[0]=t[0],n[1]=t[1]}else e.programValue=new Float32Array(t)},method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((e,t)=>e.concat(T(t)),[]),updateProgramValue:ze,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),s(rt,"methods",{getGradientColor:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    "}),s(rt,"ColorLoop",e=>{for(var t="",n=2;n<e;n++)t+=`colorOut = mix(colorOut, colors[${n}], clamp((dist - stops[${n-1}]) / (stops[${n}] - stops[${n-1}]), 0.0, 1.0));`;return t}),s(rt,"onColorize",e=>`\n      vec2 point = v_nodeCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      dist = clamp(dist, 0.0, 1.0);\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ${e.colors.length||1};\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    `);class it extends Oe{constructor(...e){super(...e),s(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var t,n,r,i,a,o,s;return{width:null!==(t=e.width)&&void 0!==t?t:10,progress:null!==(n=e.progress)&&void 0!==n?n:.5,offset:null!==(r=e.offset)&&void 0!==r?r:0,range:null!==(i=e.range)&&void 0!==i?i:2*Math.PI,rounded:null!==(a=e.rounded)&&void 0!==a&&a,radius:null!==(o=e.radius)&&void 0!==o?o:1,color:null!==(s=e.color)&&void 0!==s?s:4294967295}}}s(it,"z$__type__Props",void 0),s(it,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ge,method:"uniform4fv",type:"vec4"}}),s(it,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),s(it,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_nodeCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),s(it,"onColorize","\n    return color;\n  ");class at extends Oe{constructor(...e){super(...e),s(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){var t;return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:null!==(t=e.radius)&&void 0!==t?t:0}}}s(at,"z$__type__Props",void 0),s(at,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Xe,updateProgramValue:We}}),s(at,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),s(at,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_nodeCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  "),s(at,"onEffectMask","\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  ");class ot extends _e{constructor(e){super(),s(this,"shType",void 0),this.shType=e}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class st{constructor(e,t,n,r){var i=this;s(this,"type",void 0),s(this,"shader",void 0),s(this,"resolvedProps",void 0),s(this,"props",void 0),this.type=e,this.shader=t,this.resolvedProps=n;for(var a=Object.keys(n),o=a.length,u={},l=function(){var e=a[d];Object.defineProperty(u,e,{get:()=>i.resolvedProps[e],set:t=>{i.resolvedProps[e]=t,r.requestRender()}})},d=0;d<o;d++)l();this.props=u}getResolvedProps(){return this.resolvedProps}}class ut{constructor(e,t,n){var r=this;s(this,"shader",void 0),s(this,"resolvedProps",void 0),s(this,"props",void 0),s(this,"type",void 0),this.shader=e,this.type="DynamicShader",this.resolvedProps=t;for(var i=n.getRegisteredEffects(),a={},o=t.effects,u=o.length,l=function(e){var t=o[e],s=t.name,u=t.props,l=t.type;if(void 0===s)return 1;for(var d={},c=Object.keys(u),h=c.length,p=function(){var t=c[f];Object.defineProperty(d,t,{get:()=>r.resolvedProps.effects[e].props[t].value,set:a=>{var o,s,d=r.resolvedProps.effects[e].props[t];(d.value=a,d.hasValidator)&&(a=d.validatedValue=null===(o=i[l].uniforms[t])||void 0===o?void 0:o.validator(a,u));d.hasProgramValueUpdater?null===(s=i[l].uniforms[t])||void 0===s||s.updateProgramValue(d):d.programValue=a;n.renderer.stage.requestRender()}})},f=0;f<h;f++)p();Object.defineProperty(a,s,{get:()=>d})},d=0;d<u;d++)l(d);this.props=a}getResolvedProps(){return this.resolvedProps}}class lt{constructor(){s(this,"shCache",new Map),s(this,"shConstructors",{}),s(this,"attachedShader",null),s(this,"effectConstructors",{}),s(this,"renderer",void 0),this.registerShaderType("DefaultShader",Le),this.registerShaderType("DefaultShaderBatched",Ne),this.registerShaderType("RoundedRectangle",Fe),this.registerShaderType("DynamicShader",je),this.registerShaderType("SdfShader",He),this.registerEffectType("border",qe),this.registerEffectType("borderBottom",Ze),this.registerEffectType("borderLeft",et),this.registerEffectType("borderRight",Je),this.registerEffectType("borderTop",Qe),this.registerEffectType("fadeOut",nt),this.registerEffectType("linearGradient",Ye),this.registerEffectType("radialGradient",rt),this.registerEffectType("grayscale",$e),this.registerEffectType("glitch",tt),this.registerEffectType("radius",Ke),this.registerEffectType("radialProgress",it),this.registerEffectType("holePunch",at)}registerShaderType(e,t){this.shConstructors[e]=t}registerEffectType(e,t){this.effectConstructors[e]=t}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(e,t){if(!this.renderer)throw new Error("Renderer is not been defined");var n=this.shConstructors[e];if(!n)throw new Error(`Shader type "${e}" is not registered`);if("canvas"===this.renderer.mode&&n.prototype instanceof De)return this._createShaderCtr(e,new ot(e),t);if("DynamicShader"===e)return this.loadDynamicShader(t);var r=n.resolveDefaults(t),i=n.makeCacheKey(r)||n.name;if(i&&this.shCache.has(i))return this._createShaderCtr(e,this.shCache.get(i),r);var a=new n(this.renderer,t);return i&&this.shCache.set(i,a),this._createShaderCtr(e,a,r)}loadDynamicShader(e){if(!this.renderer)throw new Error("Renderer is not been defined");var t=je.resolveDefaults(e,this.effectConstructors),n=je.makeCacheKey(t,this.effectConstructors);if(n&&this.shCache.has(n))return this._createDynShaderCtr(this.shCache.get(n),t);var r=new je(this.renderer,e,this.effectConstructors);return n&&this.shCache.set(n,r),this._createDynShaderCtr(r,t)}_createShaderCtr(e,t,n){return new st(e,t,n,this.renderer.stage)}_createDynShaderCtr(e,t){return e.bindUniformMethods(t),new ut(e,t,this)}useShader(e){this.attachedShader!==e&&(this.attachedShader&&this.attachedShader.detach(),e.attach(),this.attachedShader=e)}}var dt={x:(e,t)=>{e.props.x=t},y:(e,t)=>{e.props.y=t},width:(e,t)=>{e.props.width=t},height:(e,t)=>{e.props.height=t},color:(e,t)=>{e.props.color=t},zIndex:(e,t)=>{e.props.zIndex=t},fontFamily:(e,t)=>{e.props.fontFamily=t},fontWeight:(e,t)=>{e.props.fontWeight=t},fontStyle:(e,t)=>{e.props.fontStyle=t},fontStretch:(e,t)=>{e.props.fontStretch=t},fontSize:(e,t)=>{e.props.fontSize=t},text:(e,t)=>{e.props.text=t},textAlign:(e,t)=>{e.props.textAlign=t},contain:(e,t)=>{e.props.contain=t},offsetY:(e,t)=>{e.props.offsetY=t},scrollable:(e,t)=>{e.props.scrollable=t},scrollY:(e,t)=>{e.props.scrollY=t},letterSpacing:(e,t)=>{e.props.letterSpacing=t},lineHeight:(e,t)=>{e.props.lineHeight=t},maxLines:(e,t)=>{e.props.maxLines=t},textBaseline:(e,t)=>{e.props.textBaseline=t},verticalAlign:(e,t)=>{e.props.verticalAlign=t},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t},debug:(e,t)=>{e.props.debug=t}};class ct{constructor(e){s(this,"stage",void 0),s(this,"set",void 0),this.stage=e;var n=t(t({},dt),this.getPropertySetters()),r={};Object.keys(n).forEach(e=>{Object.defineProperty(r,e,{value:(t,r)=>{t.props[e]!==r&&(n[e](t,r),this.stage.requestRender())},writable:!1,configurable:!1})}),this.set=r}setStatus(e,t,n){e.status!==t&&(e.status=t,e.emitter.emit(t,n))}setIsRenderable(e,t){e.isRenderable=t}destroyState(e){this.setStatus(e,"destroyed"),e.emitter.removeAllListeners()}scheduleUpdateState(e){e.updateScheduled||(e.updateScheduled=!0,queueMicrotask(()=>{"destroyed"!==e.status&&(e.updateScheduled=!1,this.updateState(e))}))}}class ht{constructor(){s(this,"data",{})}reset(){this.data={}}increment(e){this.data[e]||(this.data[e]=0),this.data[e]++}getData(){return t({},this.data)}}class pt{constructor(e,t){s(this,"stage",void 0),s(this,"memUsed",0),s(this,"loadedTextures",[]),s(this,"criticalThreshold",void 0),s(this,"targetThreshold",void 0),s(this,"cleanupInterval",void 0),s(this,"debugLogging",void 0),s(this,"lastCleanupTime",0),s(this,"baselineMemoryAllocation",void 0),s(this,"hasWarnedAboveCritical",!1),s(this,"criticalCleanupRequested",!1),s(this,"doNotExceedCriticalThreshold",void 0),s(this,"frameTime",0),this.stage=e;var n=t.criticalThreshold,r=t.doNotExceedCriticalThreshold;this.doNotExceedCriticalThreshold=r||!1,this.criticalThreshold=Math.round(n);var i=Math.max(0,Math.min(1,t.targetThresholdLevel));if(this.cleanupInterval=t.cleanupInterval,this.debugLogging=t.debugLogging,this.baselineMemoryAllocation=Math.round(t.baselineMemoryAllocation),this.targetThreshold=Math.max(Math.round(n*i),this.baselineMemoryAllocation),this.memUsed=Math.round(t.baselineMemoryAllocation),t.debugLogging){var a=0;setInterval(()=>{a!==this.memUsed&&(a=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${F(this.memUsed)} mb / ${F(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}0===n&&(this.setTextureMemUse=()=>{})}setTextureMemUse(e,t){if(this.memUsed-=e.memUsed,0===t){var n=this.loadedTextures.indexOf(e);return-1!==n&&(this.loadedTextures[n]=null),void(e.memUsed=0)}if(e.memUsed=t,this.memUsed+=t,-1===this.loadedTextures.indexOf(e)){var r=this.loadedTextures.indexOf(null);-1!==r?this.loadedTextures[r]=e:this.loadedTextures.push(e)}this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}checkCriticalCleanup(){return this.memUsed>this.criticalThreshold}destroyTexture(e){!0===this.debugLogging&&console.log(`[TextureMemoryManager] Destroying texture. State: ${e.state}`);var t=this.loadedTextures.indexOf(e);-1!==t&&(this.loadedTextures[t]=null),this.stage.txManager.removeTextureFromCache(e),e.destroy(),this.memUsed-=e.memUsed,e.memUsed=0}cleanup(){var e=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,!0===e&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),!0===this.debugLogging&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${e}.`);for(var t=e?this.criticalThreshold:this.targetThreshold,n=this.memUsed,r=0;r<this.loadedTextures.length&&!(n<t);r++){var i=this.loadedTextures[r];if(i&&(i.type===m.image||i.type===m.noise||i.type===m.renderToTexture)&&!0===i.canBeCleanedUp()){var a=i.memUsed;this.destroyTexture(i),n-=a}}this.memUsed>=this.criticalThreshold?(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.hasWarnedAboveCritical||!0!==this.debugLogging||(console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`),this.hasWarnedAboveCritical=!0)):(this.criticalCleanupRequested=!1,this.hasWarnedAboveCritical=!1)}getMemoryInfo(){var e,t=0,n=this.baselineMemoryAllocation,r=u(this.loadedTextures);try{for(r.s();!(e=r.n()).done;){var i=e.value;i&&i.renderable&&(t+=1,n+=i.memUsed)}}catch(o){r.e(o)}finally{r.f()}var a=this.loadedTextures.filter(e=>null!==e).length;return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:n,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:a,baselineMemoryAllocation:this.baselineMemoryAllocation}}}class ft{constructor(e,t){s(this,"textureSource",void 0),s(this,"memManager",void 0),s(this,"state","freed"),this.memManager=e,this.textureSource=t}setTextureMemUse(e){this.memManager.setTextureMemUse(this.textureSource,e)}get renderable(){return this.textureSource.renderable}}class gt{constructor(e){s(this,"options",void 0),s(this,"mode",void 0),s(this,"stage",void 0),s(this,"txManager",void 0),s(this,"txMemManager",void 0),s(this,"shManager",void 0),s(this,"rttNodes",[]),this.options=e,this.stage=e.stage,this.txManager=e.txManager,this.txMemManager=e.txMemManager,this.shManager=e.shManager}}class mt extends X{constructor(e,t,n){super(e,t),s(this,"textRenderer",void 0),s(this,"trState",void 0),s(this,"_textRendererOverride",null),s(this,"onTextLoaded",()=>{var e=this.contain,t=this.trState.props.width,n=this.trState.props.height,r=this.trState.textW||0,i=this.trState.textH||0;"both"===e?(this.props.width=t,this.props.height=n):"width"===e?(this.props.width=t,this.props.height=i):"none"===e&&(this.props.width=r,this.props.height=i),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})}),s(this,"onTextFailed",(e,t)=>{this.emit("failed",{type:"text",error:t})}),this._textRendererOverride=t.textRendererOverride,this.textRenderer=n;var r=this.createState({x:0,y:0,width:t.width,height:t.height,textAlign:t.textAlign,color:t.color,zIndex:t.zIndex,contain:t.contain,scrollable:t.scrollable,scrollY:t.scrollY,offsetY:t.offsetY,letterSpacing:t.letterSpacing,debug:t.debug,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStretch:t.fontStretch,fontStyle:t.fontStyle,fontWeight:t.fontWeight,text:t.text,lineHeight:t.lineHeight,maxLines:t.maxLines,textBaseline:t.textBaseline,verticalAlign:t.verticalAlign,overflowSuffix:t.overflowSuffix});this.trState=r}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),"none"===this.contain&&this.setUpdateType(G.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),"both"!==this.contain&&this.setUpdateType(G.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);var t=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);t?(this.textRenderer=t,this.trState=this.createState(this.trState.props)):console.warn("Text Renderer not found for font",this.trState.props.fontFamily)}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,t){super.update(e,t),this.globalTransform,this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkBasicRenderability(){return 0!==this.worldAlpha&&!0!==this.isOutOfBounds()&&!(!this.trState||""===this.trState.props.text)}setRenderable(e){super.setRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var t;if(this.globalTransform,this.textRenderer.renderQuads){if(this.parentHasRenderTexture){if(!e.renderToTextureActive)return;if(this.parentRenderTexture!==e.activeRttNode)return}this.parentHasRenderTexture&&null!==(t=this.props.parent)&&void 0!==t&&t.rtt&&(this.globalTransform=_.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),this.globalTransform,this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions)}else super.renderQuads(e)}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(e){var t=this.textRenderer.createState(e,this);return t.emitter.on("loaded",this.onTextLoaded),t.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(t),t}}class vt{constructor(e){s(this,"options",void 0),s(this,"animationManager",void 0),s(this,"txManager",void 0),s(this,"txMemManager",void 0),s(this,"fontManager",void 0),s(this,"textRenderers",void 0),s(this,"shManager",void 0),s(this,"renderer",void 0),s(this,"root",void 0),s(this,"interactiveNodes",new Set),s(this,"boundsMargin",void 0),s(this,"defShaderCtr",void 0),s(this,"strictBound",void 0),s(this,"preloadBound",void 0),s(this,"strictBounds",void 0),s(this,"defaultTexture",null),s(this,"targetFrameTime",0),s(this,"eventBus",void 0),s(this,"deltaTime",0),s(this,"lastFrameTime",0),s(this,"currentFrameTime",0),s(this,"fpsNumFrames",0),s(this,"fpsElapsedTime",0),s(this,"numQuadsRendered",0),s(this,"renderRequested",!1),s(this,"frameEventQueue",[]),s(this,"fontResolveMap",{}),s(this,"contextSpy",null),this.options=e;var t=e.canvas,n=e.clearColor,r=e.appWidth,i=e.appHeight,a=e.boundsMargin,o=e.enableContextSpy,u=e.forceWebGL2,l=e.numImageWorkers,d=e.textureMemory,c=e.renderEngine,h=e.fontEngines,f=e.createImageBitmapSupport,g=e.maxRetryCount;this.eventBus=e.eventBus,this.targetFrameTime=e.targetFPS>0?1e3/e.targetFPS:0,this.txManager=new Ie(this,{numImageWorkers:l,createImageBitmapSupport:f,maxRetryCount:g}),this.txManager.on("initialized",()=>{this.requestRender()}),this.txMemManager=new pt(this,d),this.shManager=new lt,this.animationManager=new K,this.contextSpy=o?new ht:null,this.strictBounds=e.strictBounds;var m=[0,0,0,0];a&&(m=Array.isArray(a)?a:[a,a,a,a]),this.boundsMargin=m,this.strictBound=w(0,0,r,i),this.preloadBound=C(this.strictBound,m);var v={stage:this,canvas:t,pixelRatio:e.devicePhysicalPixelRatio*e.deviceLogicalPixelRatio,clearColor:null!=n?n:4278190080,bufferMemory:2e6,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy,forceWebGL2:u};this.renderer=new c(v);var y=this.renderer.mode||"webgl";this.createDefaultTexture(),this.defShaderCtr=this.renderer.getDefShaderCtr(),p="webgl"===y,this.txManager.renderer=this.renderer,this.textRenderers={},h.forEach(e=>{var t=new e(this),n=t.type;"sdf"!==n||"canvas"!==y?t instanceof ct&&("canvas"===n?this.textRenderers.canvas=t:"sdf"===n&&(this.textRenderers.sdf=t)):console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...")}),0===Object.keys(this.textRenderers).length&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new Re(this.textRenderers);var b,x,T,S,A=new X(this,{x:0,y:0,width:r,height:i,alpha:1,autosize:!1,boundsMargin:null,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1,strictBounds:this.strictBounds});this.root=A,b=this,x=!1,T=0,S=(e=0)=>{var t=b.targetFrameTime;if(t>0&&e-T<t)setTimeout(()=>requestAnimationFrame(S),t-(e-T));else{if(T=e,b.updateFrameTime(),b.updateAnimations(),!b.hasSceneUpdates())return b.calculateFps(),t>0?setTimeout(()=>requestAnimationFrame(S),Math.max(t,16.666666666666668)):setTimeout(()=>requestAnimationFrame(S),16.666666666666668),x||(b.eventBus.emit("idle"),x=!0),!0===b.txMemManager.checkCleanup()&&b.txMemManager.cleanup(),void b.flushFrameEvents();if(x=!1,b.drawFrame(),b.flushFrameEvents(),t>0){var n=Math.max(0,t-(performance.now()-e));setTimeout(()=>requestAnimationFrame(S),n)}else requestAnimationFrame(S)}},requestAnimationFrame(S)}setClearColor(e){this.renderer.updateClearColor(e),this.renderRequested=!0}updateTargetFrameTime(){this.targetFrameTime=this.options.targetFPS>0?1e3/this.options.targetFPS:0}updateFrameTime(){var e=W();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=e,this.deltaTime=this.lastFrameTime?e-this.lastFrameTime:100/6,this.txManager.frameTime=e,this.txMemManager.frameTime=e,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}createDefaultTexture(){this.defaultTexture=this.txManager.createTexture("ColorTexture",{color:4294967295}),this.defaultTexture,this.txManager.loadTexture(this.defaultTexture,!0),this.defaultTexture.setRenderableOwner("stage",!0),this.defaultTexture.once("loaded",()=>{this.requestRender()})}updateAnimations(){var e=this.animationManager;this.root&&e.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested||this.txManager.hasUpdates()}drawFrame(){var e=this.renderer,t=this.renderRequested;0!==this.root.updateType&&this.root.update(this.deltaTime,this.root.clippingRect),this.txManager.processSome(this.options.textureProcessingTimeLimit).catch(e=>{console.error("Error processing textures:",e)}),e.reset(),e.rttNodes.length>0&&e.renderRTTNodes(),this.addQuads(this.root),null==e||e.render(),this.calculateFps(),this.calculateQuads(),t&&(this.renderRequested=!1),!0===this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup()}queueFrameEvent(e,t){this.frameEventQueue.push([e,t])}flushFrameEvents(){var e,t=u(this.frameEventQueue);try{for(t.s();!(e=t.n()).done;){var r=n(e.value,2),i=r[0],a=r[1];this.eventBus.emit(i,a)}}catch(o){t.e(o)}finally{t.f()}this.frameEventQueue=[]}calculateFps(){var e=this.options.fpsUpdateInterval;if(e&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=e)){var t,n,r,i=Math.round(1e3*this.fpsNumFrames/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:i,contextSpyData:null!==(t=null===(n=this.contextSpy)||void 0===n?void 0:n.getData())&&void 0!==t?t:null}),null===(r=this.contextSpy)||void 0===r||r.reset()}}calculateQuads(){var e=this.renderer.getQuadCount();e&&e!==this.numQuadsRendered&&(this.numQuadsRendered=e,this.queueFrameEvent("quadsUpdate",{quads:e}))}addQuads(e){this.renderer,!0===e.isRenderable&&e.renderQuads(this.renderer);for(var t=0;t<e.children.length;t++){var n=e.children[t];void 0!==n&&(0===n.worldAlpha||!0===n.strictBounds&&n.renderState===L.OutOfBounds||this.addQuads(n))}}requestRender(){this.renderRequested=!0}findNodesAtPoint(e){var t,n=e.x/this.options.deviceLogicalPixelRatio,r=e.y/this.options.deviceLogicalPixelRatio,i=[],a=u(this.interactiveNodes);try{for(a.s();!(t=a.n()).done;){var o=t.value;!1!==o.isRenderable&&(!0===I(n,r,o.renderBound)&&i.push(o))}}catch(s){a.e(s)}finally{a.f()}return i}getNodeFromPosition(e){var t=this.findNodesAtPoint(e);if(0===t.length)return null;for(var n=t[0],r=0;r<t.length;r++)t[r].zIndex>n.zIndex&&(n=t[r]);return n||null}resolveTextRenderer(e,t=null){var r=`${e.fontFamily}${e.fontStyle}${e.fontWeight}${e.fontStretch}${t||""}`;if(void 0!==this.fontResolveMap[r])return this.fontResolveMap[r];var i=t,a=!1;if(i){var o=this.textRenderers[i];o?o.canRenderFont(e)||(console.warn(`Cannot use override text renderer '${i}' for font`,e),i=null,a=!0):(console.warn(`Text renderer override '${i}' not found.`),i=null,a=!0)}if(!i){for(var s=0,u=Object.entries(this.textRenderers);s<u.length;s++){var l=n(u[s],2),d=l[0];if(l[1].canRenderFont(e)){i=d;break}}i||void 0===this.textRenderers.canvas||(i="canvas")}if(a&&console.warn(`Falling back to text renderer ${String(i)}`),!i)return null;var c=this.textRenderers[i];return this.fontResolveMap[r]=c,c}createShaderCtr(e,t){return this.shManager.loadShader(e,t)}createNode(e){var t=this.resolveNodeDefaults(e);return new X(this,t)}createTextNode(e){var n,r,i,a,o,s,u,l,d,c,h,p,f,g,m,v,y,b,x=null!==(n=e.fontSize)&&void 0!==n?n:16,T=t(t({},this.resolveNodeDefaults(e)),{},{text:null!==(r=e.text)&&void 0!==r?r:"",textRendererOverride:null!==(i=e.textRendererOverride)&&void 0!==i?i:null,fontSize:x,fontFamily:null!==(a=e.fontFamily)&&void 0!==a?a:"sans-serif",fontStyle:null!==(o=e.fontStyle)&&void 0!==o?o:"normal",fontWeight:null!==(s=e.fontWeight)&&void 0!==s?s:"normal",fontStretch:null!==(u=e.fontStretch)&&void 0!==u?u:"normal",textAlign:null!==(l=e.textAlign)&&void 0!==l?l:"left",contain:null!==(d=e.contain)&&void 0!==d?d:"none",scrollable:null!==(c=e.scrollable)&&void 0!==c&&c,scrollY:null!==(h=e.scrollY)&&void 0!==h?h:0,offsetY:null!==(p=e.offsetY)&&void 0!==p?p:0,letterSpacing:null!==(f=e.letterSpacing)&&void 0!==f?f:0,lineHeight:e.lineHeight,maxLines:null!==(g=e.maxLines)&&void 0!==g?g:0,textBaseline:null!==(m=e.textBaseline)&&void 0!==m?m:"alphabetic",verticalAlign:null!==(v=e.verticalAlign)&&void 0!==v?v:"middle",overflowSuffix:null!==(y=e.overflowSuffix)&&void 0!==y?y:"...",debug:null!==(b=e.debug)&&void 0!==b?b:{},shaderProps:null}),w=this.resolveTextRenderer(T,e.textRendererOverride);if(!w)throw new Error(`No compatible text renderer found for ${T.fontFamily}`);return new mt(this,T,w)}setBoundsMargin(e){this.boundsMargin=Array.isArray(e)?e:[e,e,e,e],this.root.setUpdateType(G.RenderBounds)}resolveNodeDefaults(e){var t,n,r,i,a,o,s,u,l,d,c,h,p,f,g,m,v,y,b,x,T,w,S,A,E,k,I,C,M,R,_,P,D,L,N,O,U,B,j,F,V,H,G,z,X,W,K,q,Y,$,J,Q,Z,ee=null!==(t=e.color)&&void 0!==t?t:4294967295,te=null!==(n=null!==(r=null!==(i=e.colorTl)&&void 0!==i?i:e.colorTop)&&void 0!==r?r:e.colorLeft)&&void 0!==n?n:ee,ne=null!==(a=null!==(o=null!==(s=e.colorTr)&&void 0!==s?s:e.colorTop)&&void 0!==o?o:e.colorRight)&&void 0!==a?a:ee,re=null!==(u=null!==(l=null!==(d=e.colorBl)&&void 0!==d?d:e.colorBottom)&&void 0!==l?l:e.colorLeft)&&void 0!==u?u:ee,ie=null!==(c=null!==(h=null!==(p=e.colorBr)&&void 0!==p?p:e.colorBottom)&&void 0!==h?h:e.colorRight)&&void 0!==c?c:ee,ae={};!0===this.options.inspector&&(ae=function(e){for(var t={boolean:!0,string:!0,number:!0,undefined:!0},n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];if(i){var a=e[i],o=typeof a;"string"===o&&a.length>2048&&(console.warn(`Custom Data value for ${i} is too long, it will be truncated to 2048 characters`),e[i]=a.substring(0,2048)),t[o]||(console.warn(`Custom Data value for ${i} is not a boolean, string, or number, it will be ignored`),delete e[i])}}return e}(null!==(Z=e.data)&&void 0!==Z?Z:{}));return{x:null!==(f=e.x)&&void 0!==f?f:0,y:null!==(g=e.y)&&void 0!==g?g:0,width:null!==(m=e.width)&&void 0!==m?m:0,height:null!==(v=e.height)&&void 0!==v?v:0,alpha:null!==(y=e.alpha)&&void 0!==y?y:1,autosize:null!==(b=e.autosize)&&void 0!==b&&b,boundsMargin:null!==(x=e.boundsMargin)&&void 0!==x?x:null,clipping:null!==(T=e.clipping)&&void 0!==T&&T,color:ee,colorTop:null!==(w=e.colorTop)&&void 0!==w?w:ee,colorBottom:null!==(S=e.colorBottom)&&void 0!==S?S:ee,colorLeft:null!==(A=e.colorLeft)&&void 0!==A?A:ee,colorRight:null!==(E=e.colorRight)&&void 0!==E?E:ee,colorBl:re,colorBr:ie,colorTl:te,colorTr:ne,zIndex:null!==(k=e.zIndex)&&void 0!==k?k:0,zIndexLocked:null!==(I=e.zIndexLocked)&&void 0!==I?I:0,parent:null!==(C=e.parent)&&void 0!==C?C:null,texture:null!==(M=e.texture)&&void 0!==M?M:null,textureOptions:null!==(R=e.textureOptions)&&void 0!==R?R:{},shader:null!==(_=e.shader)&&void 0!==_?_:this.defShaderCtr,src:null!==(P=e.src)&&void 0!==P?P:null,srcHeight:e.srcHeight,srcWidth:e.srcWidth,srcX:e.srcX,srcY:e.srcY,scale:null!==(D=e.scale)&&void 0!==D?D:null,scaleX:null!==(L=null!==(N=e.scaleX)&&void 0!==N?N:e.scale)&&void 0!==L?L:1,scaleY:null!==(O=null!==(U=e.scaleY)&&void 0!==U?U:e.scale)&&void 0!==O?O:1,mount:null!==(B=e.mount)&&void 0!==B?B:0,mountX:null!==(j=null!==(F=e.mountX)&&void 0!==F?F:e.mount)&&void 0!==j?j:0,mountY:null!==(V=null!==(H=e.mountY)&&void 0!==H?H:e.mount)&&void 0!==V?V:0,pivot:null!==(G=e.pivot)&&void 0!==G?G:.5,pivotX:null!==(z=null!==(X=e.pivotX)&&void 0!==X?X:e.pivot)&&void 0!==z?z:.5,pivotY:null!==(W=null!==(K=e.pivotY)&&void 0!==K?K:e.pivot)&&void 0!==W?W:.5,rotation:null!==(q=e.rotation)&&void 0!==q?q:0,rtt:null!==(Y=e.rtt)&&void 0!==Y&&Y,data:ae,preventCleanup:null!==($=e.preventCleanup)&&void 0!==$&&$,imageType:e.imageType,interactive:null!==(J=e.interactive)&&void 0!==J&&J,strictBounds:null!==(Q=e.strictBounds)&&void 0!==Q?Q:this.strictBounds}}cleanup(){this.txMemManager.cleanup()}}class yt extends y{constructor(e,t){var n,r,i,a,o,u,l,d,c,h,p,f,g;super(),s(this,"root",void 0),s(this,"canvas",void 0),s(this,"settings",void 0),s(this,"stage",void 0),s(this,"inspector",null);var m={criticalThreshold:(null===(n=e.textureMemory)||void 0===n?void 0:n.criticalThreshold)||124e6,targetThresholdLevel:(null===(r=e.textureMemory)||void 0===r?void 0:r.targetThresholdLevel)||.5,cleanupInterval:(null===(i=e.textureMemory)||void 0===i?void 0:i.cleanupInterval)||5e3,debugLogging:(null===(a=e.textureMemory)||void 0===a?void 0:a.debugLogging)||!1,baselineMemoryAllocation:(null===(o=e.textureMemory)||void 0===o?void 0:o.baselineMemoryAllocation)||26e6,doNotExceedCriticalThreshold:(null===(u=e.textureMemory)||void 0===u?void 0:u.doNotExceedCriticalThreshold)||!1},v={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:m,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:null!==(l=e.clearColor)&&void 0!==l?l:0,fpsUpdateInterval:e.fpsUpdateInterval||0,targetFPS:e.targetFPS||0,numImageWorkers:void 0!==e.numImageWorkers?e.numImageWorkers:2,enableContextSpy:null!==(d=e.enableContextSpy)&&void 0!==d&&d,forceWebGL2:null!==(c=e.forceWebGL2)&&void 0!==c&&c,inspector:null!==(h=e.inspector)&&void 0!==h&&h,renderEngine:e.renderEngine,quadBufferSize:null!==(p=e.quadBufferSize)&&void 0!==p?p:4194304,fontEngines:e.fontEngines,strictBounds:null===(f=e.strictBounds)||void 0===f||f,textureProcessingTimeLimit:e.textureProcessingTimeLimit||42,canvas:e.canvas||document.createElement("canvas"),createImageBitmapSupport:e.createImageBitmapSupport||"full",maxRetryCount:null!==(g=e.maxRetryCount)&&void 0!==g?g:5};this.settings=v;var y,b=v.deviceLogicalPixelRatio,x=v.devicePhysicalPixelRatio,T=v.canvas,w=v.appWidth*b,S=v.appHeight*b;if(this.canvas=T,T.width=w*x,T.height=S*x,T.style.width=`${w}px`,T.style.height=`${S}px`,this.stage=new vt({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,forceWebGL2:this.settings.forceWebGL2,fpsUpdateInterval:this.settings.fpsUpdateInterval,targetFPS:this.settings.targetFPS,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:m,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines,inspector:null!==this.settings.inspector,strictBounds:this.settings.strictBounds,textureProcessingTimeLimit:this.settings.textureProcessingTimeLimit,createImageBitmapSupport:this.settings.createImageBitmapSupport,maxRetryCount:this.settings.maxRetryCount}),this.root=this.stage.root,!(y="string"==typeof t?document.getElementById(t):t))throw new Error("Could not find target element");y.appendChild(T)}createNode(e){var t=this.stage.createNode(e);return this.inspector?this.inspector.createNode(t):t}createTextNode(e){var t=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(t):t}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,t){return this.stage.txManager.createTexture(e,t)}createShader(e,t){return this.stage.shManager.loadShader(e,t)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,t,n){return{name:n,type:e,props:t}}getNodeById(e){var t,n=null===(t=this.stage)||void 0===t?void 0:t.root;if(!n)return null;var r=t=>{if(t.id===e)return t;var n,i=u(t.children);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=r(a);if(o)return o}}catch(s){i.e(s)}finally{i.f()}return null};return r(n)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){this.stage.requestRender()}cleanup(){this.stage.cleanup()}setClearColor(e){this.stage.setClearColor(e)}get targetFPS(){return this.stage.options.targetFPS}set targetFPS(e){this.stage.options.targetFPS=e>0?e:0,this.stage.updateTargetFrameTime()}}class bt extends y{constructor(e){super(),s(this,"fontFamily",void 0),s(this,"descriptors",void 0),s(this,"loaded",!1),s(this,"metrics",null);var n=e.fontFamily,r=e.descriptors,i=e.metrics;i&&(this.metrics={ascender:i.ascender/i.unitsPerEm,descender:i.descender/i.unitsPerEm,lineGap:i.lineGap/i.unitsPerEm}),this.fontFamily=n,this.descriptors=t({style:"normal",weight:"normal",stretch:"normal"},r)}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:"number"==typeof e.weight?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}class xt extends bt{constructor(e){super(e),s(this,"fontFace",void 0),s(this,"fontUrl",void 0);var t=e.fontFamily,n=e.fontUrl,r=n.replace(/\(|\)/g,""),i=this.descriptors,a={style:i.style,weight:"number"==typeof i.weight?`${i.weight}`:i.weight,stretch:i.stretch,unicodeRange:i.unicodeRange,featureSettings:i.featureSettings,display:i.display};for(var o in a){var u=o;void 0===a[u]&&delete a[u]}var l=new FontFace(t,`url(${r})`,a);r.length>0?l.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=l,this.fontUrl=n}}class Tt{}class wt extends Tt{constructor(e,t,n,r,i,a,o,u,l,d,c,h,p){super(),s(this,"glw",void 0),s(this,"options",void 0),s(this,"buffers",void 0),s(this,"shader",void 0),s(this,"shaderProps",void 0),s(this,"alpha",void 0),s(this,"clippingRect",void 0),s(this,"dimensions",void 0),s(this,"bufferIdx",void 0),s(this,"zIndex",void 0),s(this,"renderToTexture",void 0),s(this,"parentHasRenderTexture",void 0),s(this,"framebufferDimensions",void 0),s(this,"length",0),s(this,"numQuads",0),s(this,"textures",[]),s(this,"maxTextures",void 0),this.glw=e,this.options=t,this.buffers=n,this.shader=r,this.shaderProps=i,this.alpha=a,this.clippingRect=o,this.dimensions=u,this.bufferIdx=l,this.zIndex=d,this.renderToTexture=c,this.parentHasRenderTexture=h,this.framebufferDimensions=p,this.maxTextures=r.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){for(var t=this.textures,n=this.maxTextures,r=-1,i=t.length,a=0;a<i;a++){if(t[a]===e){r=a;break}}return-1!==r?r:i>=n?4294967295:(this.textures.push(e),i)}draw(){var e=this.glw,t=this.shader,n=this.shaderProps,r=this.options;r.shManager.useShader(t),t.bindRenderOp(this,n);var i=this.bufferIdx/32*6*2;if(this.clippingRect.valid){var a=this.clippingRect,o=a.x,s=a.y,u=a.width,l=a.height,d=this.parentHasRenderTexture?1:r.pixelRatio,c=r.canvas.height,h=Math.round(o*d),p=Math.round(u*d),f=Math.round(l*d),g=Math.round(c-f-s*d);this.parentHasRenderTexture&&(g=this.framebufferDimensions?this.framebufferDimensions.height-this.dimensions.height:0),e.setScissorTest(!0),e.scissor(h,g,p,f)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,i)}}function St(e){var t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(n=>{t[n]=e.getParameter(e[n])}),t}function At(e){var t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(n=>{t[n]=e.getExtension(n)}),t}function Et(e){return null!==e&&("object"==typeof e&&e.constructor&&"HTMLImageElement"===e.constructor.name||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)}var kt=new Uint8Array([0,0,0,0]);class It extends ft{constructor(e,t,n){super(t,n),s(this,"glw",void 0),s(this,"_nativeCtxTexture",null),s(this,"_w",0),s(this,"_h",0),s(this,"txCoordX1",0),s(this,"txCoordY1",0),s(this,"txCoordX2",1),s(this,"txCoordY2",1),this.glw=e}checkGLError(){if("failed"===this.state)return!0;var e=this.glw.getError();return 0!==e&&(this.state="failed",this.textureSource.setState("failed",new Error(`WebGL Error: ${e}`)),!0)}get ctxTexture(){return"freed"===this.state?(this.load(),null):(this._nativeCtxTexture,this._nativeCtxTexture)}get w(){return this._w}get h(){return this._h}load(){var e=this;return o(r().m(function t(){var n,i,a;return r().w(function(t){for(;;)switch(t.p=t.n){case 0:if("loading"!==e.state&&"loaded"!==e.state){t.n=1;break}return t.a(2,Promise.resolve());case 1:if(e.state="loading",e.textureSource.setState("loading"),e._nativeCtxTexture=e.createNativeCtxTexture(),null!==e._nativeCtxTexture){t.n=2;break}return e.state="failed",e.textureSource.setState("failed",new Error("WebGL Texture creation failed")),t.a(2);case 2:return t.p=2,t.n=3,e.onLoadRequest();case 3:if(n=t.v,i=n.width,a=n.height,"freed"!==e.state){t.n=4;break}return t.a(2);case 4:e.state="loaded",e._w=i,e._h=a,e.textureSource.setState("loaded",{width:i,height:a}),e.textureSource.freeTextureData(),t.n=7;break;case 5:if(t.p=5,t.v,"freed"!==e.state){t.n=6;break}return t.a(2);case 6:e.state="failed",e.textureSource.setState("failed");case 7:return t.a(2)}},t,null,[[2,5]])}))()}onLoadRequest(){var e=this;return o(r().m(function t(){var n,i,a,o,s,u,l,d,c,h,p,f,g;return r().w(function(t){for(;;)switch(t.n){case 0:if(n=e.glw,i=e.textureSource.textureData,"failed"!==e.state){t.n=1;break}return t.a(2,{width:0,height:0});case 1:if(null!==i&&null!==e._nativeCtxTexture){t.n=2;break}return e.state="failed",e.textureSource.setState("failed",new Error("No texture data available")),t.a(2,{width:0,height:0});case 2:if(n.texImage2D(0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,null),e.setTextureMemUse(kt.byteLength),a=0,o=0,n.activeTexture(0),!0!==e.checkGLError()){t.n=3;break}return t.a(2,{width:0,height:0});case 3:if(s=i.data,u=n.RGBA,l=4,d=1.1,!("undefined"!=typeof ImageBitmap&&s instanceof ImageBitmap||s instanceof ImageData||Et(s))){t.n=5;break}if(a=s.width,o=s.height,n.bindTexture(e._nativeCtxTexture),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!i.premultiplyAlpha),n.texImage2D(0,u,u,n.UNSIGNED_BYTE,s),!0!==e.checkGLError()){t.n=4;break}return t.a(2,{width:0,height:0});case 4:e.setTextureMemUse(o*a*l*d),t.n=10;break;case 5:if(!(s&&"mipmaps"in s&&s.mipmaps)){t.n=7;break}if(p=s.mipmaps,f=s.type,g=s.blockInfo,ge[f](n,e._nativeCtxTexture,s),!0!==e.checkGLError()){t.n=6;break}return t.a(2,{width:0,height:0});case 6:a=s.width,o=s.height,e.txCoordX2=a/(Math.ceil(a/g.width)*g.width),e.txCoordY2=o/(Math.ceil(o/g.height)*g.height),e.setTextureMemUse(null!==(c=null===(h=p[0])||void 0===h?void 0:h.byteLength)&&void 0!==c?c:0),t.n=10;break;case 7:if(!(s&&s instanceof Uint8Array)){t.n=9;break}if(a=1,o=1,n.bindTexture(e._nativeCtxTexture),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!i.premultiplyAlpha),n.texImage2D(0,u,a,o,0,u,n.UNSIGNED_BYTE,s),!0!==e.checkGLError()){t.n=8;break}return t.a(2,{width:0,height:0});case 8:e.setTextureMemUse(a*o*l),t.n=10;break;case 9:return console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",i),e.state="failed",e.textureSource.setState("failed",new Error("Unexpected texture data")),t.a(2,{width:0,height:0});case 10:return t.a(2,{width:a,height:o})}},t)}))()}free(){"freed"!==this.state&&(this.state="freed",this.textureSource.setState("freed"),this.release())}release(){this._w=0,this._h=0,null!==this._nativeCtxTexture&&(this.glw.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null),this.textureSource.freeTextureData()}createNativeCtxTexture(){var e=this.glw,t=e.createTexture();return t?(e.activeTexture(0),e.bindTexture(t),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),0!==e.getError()?null:t):null}}class Ct extends It{constructor(e,t,n){super(e,t,n)}onLoadRequest(){var e=this;return o(r().m(function t(){var n,i,a;return r().w(function(t){for(;;)switch(t.n){case 0:if(!((a=e.textureSource.textureData).data instanceof Uint8Array)){t.n=1;break}return t.a(2,{width:1,height:1});case 1:return t.a(2,{width:(null===(n=a.data)||void 0===n?void 0:n.width)||0,height:(null===(i=a.data)||void 0===i?void 0:i.height)||0})}},t)}))()}}class Mt{constructor(e){s(this,"config",void 0),this.config=e}getBuffer(e){var t;return null===(t=this.config.find(t=>t.attributes[e]))||void 0===t?void 0:t.buffer}getAttributeInfo(e){var t;return null===(t=this.config.find(t=>t.attributes[e]))||void 0===t?void 0:t.attributes[e]}}class Rt{constructor(e){s(this,"gl",void 0),s(this,"activeTextureUnit",0),s(this,"texture2dUnits",void 0),s(this,"texture2dParams",new WeakMap),s(this,"scissorEnabled",void 0),s(this,"scissorX",void 0),s(this,"scissorY",void 0),s(this,"scissorWidth",void 0),s(this,"scissorHeight",void 0),s(this,"blendEnabled",void 0),s(this,"blendSrcRgb",void 0),s(this,"blendDstRgb",void 0),s(this,"blendSrcAlpha",void 0),s(this,"blendDstAlpha",void 0),s(this,"boundArrayBuffer",void 0),s(this,"boundElementArrayBuffer",void 0),s(this,"curProgram",void 0),s(this,"canvas",void 0),s(this,"MAX_RENDERBUFFER_SIZE",void 0),s(this,"MAX_TEXTURE_SIZE",void 0),s(this,"MAX_VIEWPORT_DIMS",void 0),s(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS",void 0),s(this,"MAX_TEXTURE_IMAGE_UNITS",void 0),s(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS",void 0),s(this,"MAX_VERTEX_ATTRIBS",void 0),s(this,"MAX_VARYING_VECTORS",void 0),s(this,"MAX_VERTEX_UNIFORM_VECTORS",void 0),s(this,"MAX_FRAGMENT_UNIFORM_VECTORS",void 0),s(this,"TEXTURE_MAG_FILTER",void 0),s(this,"TEXTURE_MIN_FILTER",void 0),s(this,"TEXTURE_WRAP_S",void 0),s(this,"TEXTURE_WRAP_T",void 0),s(this,"LINEAR",void 0),s(this,"LINEAR_MIPMAP_LINEAR",void 0),s(this,"CLAMP_TO_EDGE",void 0),s(this,"RGB",void 0),s(this,"RGBA",void 0),s(this,"UNSIGNED_BYTE",void 0),s(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL",void 0),s(this,"UNPACK_FLIP_Y_WEBGL",void 0),s(this,"FLOAT",void 0),s(this,"TRIANGLES",void 0),s(this,"UNSIGNED_SHORT",void 0),s(this,"ONE",void 0),s(this,"ONE_MINUS_SRC_ALPHA",void 0),s(this,"VERTEX_SHADER",void 0),s(this,"FRAGMENT_SHADER",void 0),s(this,"STATIC_DRAW",void 0),s(this,"COMPILE_STATUS",void 0),s(this,"LINK_STATUS",void 0),s(this,"DYNAMIC_DRAW",void 0),s(this,"COLOR_ATTACHMENT0",void 0),s(this,"INVALID_ENUM",void 0),s(this,"INVALID_OPERATION",void 0),this.gl=e,this.activeTextureUnit=e.getParameter(e.ACTIVE_TEXTURE)-e.TEXTURE0;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(t).fill(void 0).map((t,n)=>(this.activeTexture(n),e.getParameter(e.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=e.isEnabled(e.SCISSOR_TEST);var n=e.getParameter(e.SCISSOR_BOX);this.scissorX=n[0],this.scissorY=n[1],this.scissorWidth=n[2],this.scissorHeight=n[3],this.blendEnabled=e.isEnabled(e.BLEND),this.blendSrcRgb=e.getParameter(e.BLEND_SRC_RGB),this.blendDstRgb=e.getParameter(e.BLEND_DST_RGB),this.blendSrcAlpha=e.getParameter(e.BLEND_SRC_ALPHA),this.blendDstAlpha=e.getParameter(e.BLEND_DST_ALPHA),this.boundArrayBuffer=e.getParameter(e.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=e.getParameter(e.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=e.getParameter(e.CURRENT_PROGRAM),this.canvas=e.canvas,this.MAX_RENDERBUFFER_SIZE=e.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=e.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=e.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=e.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=e.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=e.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=e.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=e.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=e.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=e.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=e.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=e.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=e.TEXTURE_WRAP_T,this.LINEAR=e.LINEAR,this.LINEAR_MIPMAP_LINEAR=e.LINEAR_MIPMAP_LINEAR,this.CLAMP_TO_EDGE=e.CLAMP_TO_EDGE,this.RGB=e.RGB,this.RGBA=e.RGBA,this.UNSIGNED_BYTE=e.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=e.UNPACK_FLIP_Y_WEBGL,this.FLOAT=e.FLOAT,this.TRIANGLES=e.TRIANGLES,this.UNSIGNED_SHORT=e.UNSIGNED_SHORT,this.ONE=e.ONE,this.ONE_MINUS_SRC_ALPHA=e.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=e.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=e.TRIANGLES,this.UNSIGNED_SHORT=e.UNSIGNED_SHORT,this.VERTEX_SHADER=e.VERTEX_SHADER,this.FRAGMENT_SHADER=e.FRAGMENT_SHADER,this.STATIC_DRAW=e.STATIC_DRAW,this.COMPILE_STATUS=e.COMPILE_STATUS,this.LINK_STATUS=e.LINK_STATUS,this.DYNAMIC_DRAW=e.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=e.COLOR_ATTACHMENT0,this.INVALID_ENUM=e.INVALID_ENUM,this.INVALID_OPERATION=e.INVALID_OPERATION}isWebGl2(){return e=this.gl,self.WebGL2RenderingContext&&e instanceof self.WebGL2RenderingContext;var e}activeTexture(e){var t=this.gl;this.activeTextureUnit!==e&&(t.activeTexture(e+t.TEXTURE0),this.activeTextureUnit=e)}bindTexture(e){var t=this.gl,n=this.activeTextureUnit,r=this.texture2dUnits;r[n]!==e&&(r[n]=e,t.bindTexture(this.gl.TEXTURE_2D,e))}_getActiveTexture(){var e=this.activeTextureUnit;return this.texture2dUnits[e]}texParameteri(e,t){var n=this.gl,r=this.texture2dParams,i=this._getActiveTexture();if(!i)throw new Error("No active texture");var a=r.get(i);a||(a={},r.set(i,a)),a[e]!==t&&(a[e]=t,n.texParameteri(n.TEXTURE_2D,e,t))}texImage2D(e,t,n,r,i,a,o,s){var u=this.gl;a?u.texImage2D(u.TEXTURE_2D,e,t,n,r,i,a,o,s):u.texImage2D(u.TEXTURE_2D,e,t,n,r,i)}compressedTexImage2D(e,t,n,r,i,a){var o=this.gl;o.compressedTexImage2D(o.TEXTURE_2D,e,t,n,r,i,a)}pixelStorei(e,t){this.gl.pixelStorei(e,t)}generateMipmap(){var e=this.gl;e.generateMipmap(e.TEXTURE_2D)}createTexture(){return this.gl.createTexture()}deleteTexture(e){var t=this.gl;e&&this.texture2dParams.delete(e),t.deleteTexture(e)}deleteFramebuffer(e){this.gl.deleteFramebuffer(e)}viewport(e,t,n,r){this.gl.viewport(e,t,n,r)}clearColor(e,t,n,r){this.gl.clearColor(e,t,n,r)}setScissorTest(e){var t=this.gl;e!==this.scissorEnabled&&(e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST),this.scissorEnabled=e)}scissor(e,t,n,r){var i=this.gl,a=this.scissorX,o=this.scissorY,s=this.scissorWidth,u=this.scissorHeight;e===a&&t===o&&n===s&&r===u||(i.scissor(e,t,n,r),this.scissorX=e,this.scissorY=t,this.scissorWidth=n,this.scissorHeight=r)}setBlend(e){var t=this.gl;e!==this.blendEnabled&&(e?t.enable(t.BLEND):t.disable(t.BLEND),this.blendEnabled=e)}blendFunc(e,t){var n=this.gl,r=this.blendSrcRgb,i=this.blendDstRgb,a=this.blendSrcAlpha,o=this.blendDstAlpha;e===r&&t===i&&e===a&&t===o||(n.blendFunc(e,t),this.blendSrcRgb=e,this.blendDstRgb=t,this.blendSrcAlpha=e,this.blendDstAlpha=t)}createBuffer(){return this.gl.createBuffer()}createFramebuffer(){return this.gl.createFramebuffer()}bindFramebuffer(e){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e)}framebufferTexture2D(e,t,n){var r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,e,r.TEXTURE_2D,t,n)}clear(){var e=this.gl;e.clear(e.COLOR_BUFFER_BIT)}arrayBufferData(e,t,n){var r=this.gl;this.boundArrayBuffer!==e&&(r.bindBuffer(r.ARRAY_BUFFER,e),this.boundArrayBuffer=e),r.bufferData(r.ARRAY_BUFFER,t,n)}elementArrayBufferData(e,t,n){var r=this.gl;this.boundElementArrayBuffer!==e&&(r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.boundElementArrayBuffer=e),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,n)}vertexAttribPointer(e,t,n,r,i,a,o){var s=this.gl;this.boundArrayBuffer!==e&&(s.bindBuffer(s.ARRAY_BUFFER,e),this.boundArrayBuffer=e),s.vertexAttribPointer(t,n,r,i,a,o)}getUniformLocations(e){for(var t=this.gl,n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r={},i=0;i<n;i++){var a=t.getActiveUniform(e,i).name.replace(/\[.*?\]/g,"");r[a]=t.getUniformLocation(e,a)}return r}getAttributeLocations(e){for(var t=this.gl,n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=[],i=0;i<n;i++){var a=t.getActiveAttrib(e,i).name;r[t.getAttribLocation(e,a)]=a}return r}useProgram(e){var t=this.gl;this.curProgram!==e&&(t.useProgram(e),this.curProgram=e)}uniform1f(e,t){this.gl.uniform1f(e,t)}uniform1fv(e,t){this.gl.uniform1fv(e,t)}uniform1i(e,t){this.gl.uniform1i(e,t)}uniform1iv(e,t){this.gl.uniform1iv(e,t)}uniform2f(e,t,n){this.gl.uniform2f(e,t,n)}uniform2fv(e,t){this.gl.uniform2fv(e,t)}uniform2i(e,t,n){this.gl.uniform2i(e,t,n)}uniform2iv(e,t){this.gl.uniform2iv(e,t)}uniform3f(e,t,n,r){this.gl.uniform3f(e,t,n,r)}uniform3fv(e,t){this.gl.uniform3fv(e,t)}uniform3i(e,t,n,r){this.gl.uniform3i(e,t,n,r)}uniform3iv(e,t){this.gl.uniform3iv(e,t)}uniform4f(e,t,n,r,i){this.gl.uniform4f(e,t,n,r,i)}uniform4fv(e,t){this.gl.uniform4fv(e,t)}uniform4i(e,t,n,r,i){this.gl.uniform4i(e,t,n,r,i)}uniform4iv(e,t){this.gl.uniform4iv(e,t)}uniformMatrix2fv(e,t){this.gl.uniformMatrix2fv(e,!1,t)}uniformMatrix3fv(e,t){this.gl.uniformMatrix3fv(e,!1,t)}uniformMatrix4fv(e,t){this.gl.uniformMatrix4fv(e,!1,t)}getParameter(e){return this.gl.getParameter(e)}drawElements(e,t,n,r){this.gl.drawElements(e,t,n,r)}getExtension(e){return this.gl.getExtension(e)}getError(){return this.gl.getError()}createVertexArray(){return this.gl.createVertexArray()}bindVertexArray(e){this.gl.bindVertexArray(e)}getAttribLocation(e,t){return this.gl.getAttribLocation(e,t)}getUniformLocation(e,t){return this.gl.getUniformLocation(e,t)}enableVertexAttribArray(e){this.gl.enableVertexAttribArray(e)}disableVertexAttribArray(e){this.gl.disableVertexAttribArray(e)}createShader(e){return this.gl.createShader(e)}compileShader(e){this.gl.compileShader(e)}attachShader(e,t){this.gl.attachShader(e,t)}linkProgram(e){this.gl.linkProgram(e)}deleteProgram(e){this.gl.deleteProgram(e)}getShaderParameter(e,t){return this.gl.getShaderParameter(e,t)}getShaderInfoLog(e){return this.gl.getShaderInfoLog(e)}createProgram(){return this.gl.createProgram()}getProgramParameter(e,t){return this.gl.getProgramParameter(e,t)}getProgramInfoLog(e){return this.gl.getProgramInfoLog(e)}shaderSource(e,t){this.gl.shaderSource(e,t)}deleteShader(e){this.gl.deleteShader(e)}checkError(e){var t=this.getError();if(0!==t){var n="UNKNOWN_ERROR";switch(t){case this.INVALID_ENUM:n="INVALID_ENUM";break;case 1281:n="INVALID_VALUE";break;case this.INVALID_OPERATION:n="INVALID_OPERATION";break;case 1285:n="OUT_OF_MEMORY";break;case 37442:n="CONTEXT_LOST_WEBGL"}var r=`WebGL ${n} (0x${t.toString(16)}) during ${e}`;return{error:t,errorName:n,message:r}}return null}}class _t extends It{constructor(e,t,n){super(e,t,n),s(this,"framebuffer",null)}onLoadRequest(){var e=this;return o(r().m(function t(){var n,i,a,o,s;return r().w(function(t){for(;;)switch(t.n){case 0:if(n=e.glw,i=e._nativeCtxTexture=e.createNativeCtxTexture()){t.n=1;break}throw new Error("Failed to create native texture for RenderTexture");case 1:return a=e.textureSource,o=a.width,s=a.height,e.framebuffer=n.createFramebuffer(),n.texImage2D(0,n.RGBA,o,s,0,n.RGBA,n.UNSIGNED_BYTE,null),e.setTextureMemUse(o*s*4),n.bindFramebuffer(e.framebuffer),n.framebufferTexture2D(n.COLOR_ATTACHMENT0,i,0),n.bindFramebuffer(null),t.a(2,{width:o,height:s})}},t)}))()}free(){super.free(),this.glw.deleteFramebuffer(this.framebuffer),this.framebuffer=null}}var Pt=10;class Dt{}class Lt extends Dt{constructor(e,t){super(),s(this,"data",void 0),s(this,"glyphMap",void 0),s(this,"kernings",void 0),this.data=e,this.glyphMap=t;var n=this.kernings={};e.kernings.forEach(e=>{var t=e.second;(n[t]=n[t]||{})[e.first]=e.amount}),this.kernings=n}shapeText(e,t){var n=this;return r().m(function i(){var a,o,s,u,l,d;return r().w(function(r){for(;;)switch(r.n){case 0:o=void 0;case 1:if(!(a=t.peek())||a.done){r.n=5;break}if(s=a.value,u=n.glyphMap.get(s),t.next(),void 0===u){r.n=3;break}return d=void 0!==o?((null===(l=n.kernings[u.id])||void 0===l?void 0:l[o])||0)+e.letterSpacing:0,o=u.id,r.n=2,{mapped:!0,glyphId:u.id,codepoint:s,cluster:t.lastIndex,xAdvance:u.xadvance+d,yAdvance:0,xOffset:u.xoffset+d,yOffset:u.yoffset,xBearing:0,yBearing:0,width:u.width,height:u.height};case 2:r.n=4;break;case 3:return s===Pt&&(o=void 0),r.n=4,{mapped:!1,codepoint:s,cluster:t.lastIndex};case 4:r.n=1;break;case 5:return r.a(2)}},i)})()}}class Nt extends bt{constructor(e,t){super(t),s(this,"type",void 0),s(this,"texture",void 0),s(this,"maxCharHeight",0),s(this,"shaper",void 0),s(this,"glyphMap",new Map),s(this,"data",void 0);var n=t.atlasUrl,r=t.atlasDataUrl,i=t.stage;this.type=e,i.renderer,this.texture=i.txManager.createTexture("ImageTexture",{src:n,premultiplyAlpha:!1}),i.txManager.loadTexture(this.texture,!0),this.texture.preventCleanup=!0,this.texture.on("loaded",()=>{this.checkLoaded(),i.requestRender()}),ve(r).then(e=>{this.data=JSON.parse(e),this.data;var t=0;if(this.data.chars.forEach(e=>{this.glyphMap.set(e.id,e);var n=e.yoffset+e.height;n>t&&(t=n)}),this.maxCharHeight=t,this.shaper=new Lt(this.data,this.glyphMap),!this.metrics){var n;if(null===(n=this.data)||void 0===n||!n.lightningMetrics)throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);var r=this.data.lightningMetrics,i=r.ascender,a=r.descender,o=r.lineGap,s=r.unitsPerEm;this.metrics={ascender:i/s,descender:a/s,lineGap:o/s}}this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){var t=this.glyphMap.get(e);if(void 0===t)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:t.x,y:t.y,width:t.width,height:t.height}}checkLoaded(){this.loaded||"loaded"===this.texture.state&&this.data&&(this.loaded=!0,this.emit("loaded"))}}var Ot,Ut=!!{LEGACY:!0},Bt={debug:!1,focusDebug:!1,keyDebug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100},setActiveElement:()=>{},focusStateKey:"$focus",lockStyles:!0};var jt="element",Ft="textNode",Vt="text";var Ht=e=>e instanceof Function,Gt=e=>"function"==typeof e;function zt(e){return Array.isArray(e)}function Xt(e){return"string"==typeof e}function Wt(e){return"destroy"in e&&"function"==typeof e.destroy}function Kt(e){return e instanceof bn}function qt(e){return e._type===Ft}function Yt(e){return e._type===Vt}class $t extends Array{constructor(e,t={}){return zt(t)?(super(...t),s(this,"onChange",void 0)):Xt(t)?(super(t),s(this,"onChange",void 0)):(super(...Object.entries(t).filter(([e,t])=>t).map(([e])=>e)),s(this,"onChange",void 0)),this.onChange=e,this}has(e){return this.indexOf(e)>=0||this.indexOf(`$${e}`)>=0}is(e){return this.indexOf(e)>=0}add(e){this.has(e)||(this.push(e),this.onChange())}toggle(e,t){!0===t?this.add(e):!1===t||this.has(e)?this.remove(e):this.add(e)}merge(e){if(zt(e))this.length=0,this.push(...e);else if(Xt(e))this.length=0,this.push(e);else for(var t in e){if(e[t])this.has(t)||this.push(t);else{var n=this.indexOf(t);n>=0&&this.splice(n,1)}}return this}remove(e){var t=this.indexOf(e);t>=0&&(this.splice(t,1),this.onChange())}}function Jt(e){for(var t="row"===(e.flexDirection||"row"),n=t?"width":"height",r=t?"height":"width",i=t?"marginLeft":"marginTop",a=t?"marginTop":"marginLeft",o=t?"marginRight":"marginBottom",s=t?"marginBottom":"marginRight",l=[],d=!1,c=0,h=0;h<e.children.length;h++){var p=e.children[h];if(qt(p)&&p.text&&!p.width&&!p.height)return!1;if(!Yt(p)&&!1!==p.flexItem){var f=p.flexOrder;void 0!==f&&(d=!0);var g=p.flexGrow,m=void 0!==g&&g>=0;m&&(c+=g);var v=p[n]||0,y=p[i]||0,b=p[o]||0;l.push({node:p,mainSize:v,marginStart:y,marginEnd:b,totalMainSizeOnAxis:v+y+b,isGrowItem:m,flexGrowValue:m?g:0,flexOrder:f||0,crossSize:p[r]||0,crossMarginStart:p[a]||0,crossMarginEnd:p[s]||0})}}d?l.sort((e,t)=>e.flexOrder-t.flexOrder):"rtl"===e.direction&&l.reverse();var x=l.length;if(0===x)return!1;var T=t?"x":"y",w=t?"y":"x",S=e[n]||0,A=e[r]||0,E=e.gap||0,k=e.justifyContent||"flexStart",I=!1;if(c>0&&x>1){e.flexBoundary=e.flexBoundary||"fixed";var C,M=0,R=u(l);try{for(R.s();!(C=R.n()).done;){var _=C.value;M+=_.mainSize+_.marginStart+_.marginEnd}}catch(Se){R.e(Se)}finally{R.f()}var P=S-M-(x>0?E*(x-1):0);if(P>0){var D,L=u(l);try{for(L.s();!(D=L.n()).done;){var N=D.value;if(N.isGrowItem&&N.flexGrowValue>0){var O=N.flexGrowValue/c*P,U=N.mainSize+O;N.node[n]=U,N.mainSize=U,N.totalMainSizeOnAxis=U+N.marginStart+N.marginEnd}}}catch(Se){L.e(Se)}finally{L.f()}e._containsFlexGrow=!e._containsFlexGrow||null}else e._containsFlexGrow?e._containsFlexGrow=null:console.warn("No available space for flex-grow items to expand, or items overflow.")}var B=0;if("center"===k||"spaceBetween"===k||"spaceEvenly"===k||"spaceAround"===k){var j,F=u(l);try{for(F.s();!(j=F.n()).done;){B+=j.value.totalMainSizeOnAxis}}catch(Se){F.e(Se)}finally{F.f()}}var V=e.alignItems||(e.flexWrap?"flexStart":void 0),H=A?(e,t=0)=>{var n=e.node.alignSelf||V;n&&("flexStart"===n?e.node[w]=t+e.crossMarginStart:"center"===n?e.node[w]=t+(A-e.crossSize)/2+e.crossMarginStart:"flexEnd"===n&&(e.node[w]=t+A-e.crossSize-e.crossMarginEnd))}:(e,t=0)=>{};if(t&&e._calcHeight&&!e.flexCrossBoundary){var G=l.reduce((e,t)=>Math.max(e,t.crossSize),0),z=G||e.height;z!==e.height&&(I=!0,e.height=A=z)}var X=e.padding||0;if("flexStart"===k){if("wrap"===e.flexWrap){var W,K,q,Y,$=0,J=(null===(W=l[0])||void 0===W?void 0:W.crossSize)||A,Q=t?null!==(K=e.columnGap)&&void 0!==K?K:E:null!==(q=e.rowGap)&&void 0!==q?q:E,Z=u(l);try{for(Z.s();!(Y=Z.n()).done;){var ee=Y.value;X+ee.totalMainSizeOnAxis>S&&X>(e.padding||0)&&(X=e.padding||0,$+=J+Q),ee.node[T]=X+ee.marginStart,X+=ee.totalMainSizeOnAxis+E,H(ee,$)}}catch(Se){Z.e(Se)}finally{Z.f()}var te=$+J;e[r]!==te&&(e[`preFlex${r}`]=e[r],e[r]=te,I=!0)}else{var ne,re=u(l);try{for(re.s();!(ne=re.n()).done;){var ie=ne.value;ie.node[T]=X+ie.marginStart,X+=ie.totalMainSizeOnAxis+E,H(ie)}}catch(Se){re.e(Se)}finally{re.f()}}if("fixed"!==e.flexBoundary&&"wrap"!==e.flexWrap){var ae=X-E+(e.padding||0);if(ae!==S)return e[`preFlex${n}`]=S,e[n]=ae,!0}}else if("flexEnd"===k){X=S-(e.padding||0);for(var oe=x-1;oe>=0;oe--){var se=l[oe];se.node[T]=X-se.mainSize-se.marginEnd,X-=se.totalMainSizeOnAxis+E,H(se)}}else if("center"===k){X=(S-(B+E*(x-1)))/2+(e.padding||0);var ue,le=u(l);try{for(le.s();!(ue=le.n()).done;){var de=ue.value;de.node[T]=X+de.marginStart,X+=de.totalMainSizeOnAxis+E,H(de)}}catch(Se){le.e(Se)}finally{le.f()}}else if("spaceBetween"===k){var ce=x>1?(S-B-2*(e.padding||0))/(x-1):0;X=e.padding||0;var he,pe=u(l);try{for(pe.s();!(he=pe.n()).done;){var fe=he.value;fe.node[T]=X+fe.marginStart,X+=fe.totalMainSizeOnAxis+ce,H(fe)}}catch(Se){pe.e(Se)}finally{pe.f()}}else if("spaceAround"===k){var ge=x>0?(S-B-2*(e.padding||0))/x:0;X=(e.padding||0)+ge/2;var me,ve=u(l);try{for(ve.s();!(me=ve.n()).done;){var ye=me.value;ye.node[T]=X+ye.marginStart,X+=ye.totalMainSizeOnAxis+ge,H(ye)}}catch(Se){ve.e(Se)}finally{ve.f()}}else if("spaceEvenly"===k){var be=(S-B-2*(e.padding||0))/(x+1);X=be+(e.padding||0);var xe,Te=u(l);try{for(Te.s();!(xe=Te.n()).done;){var we=xe.value;we.node[T]=X+we.marginStart,X+=we.totalMainSizeOnAxis+be,H(we)}}catch(Se){Te.e(Se)}finally{Te.f()}}return I}var Qt,Zt,en={ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Enter",l:"Last"," ":"Space",Backspace:"Back",Escape:"Escape"},tn={},nn=(e,t)=>{for(var r=function(){var e=n(a[i],2),r=e[0],o=e[1];Array.isArray(o)?o.forEach(e=>{t[e]=r}):null===o?delete t[r]:t[o]=r},i=0,a=Object.entries(e);i<a.length;i++)r()},rn=!0,an=[],on=(e,n)=>{for(var r=e,i=[];r;){var a,o;if(!r.states.has(Bt.focusStateKey)||r===e)r.states.add(Bt.focusStateKey),null===(a=r.onFocus)||void 0===a||a.call(r,e,n),null===(o=r.onFocusChanged)||void 0===o||o.call(r,!0,e,n);i.push(r),r=r.parent}return an.forEach(t=>{var r,a;i.includes(t)||(t.states.remove(Bt.focusStateKey),null===(r=t.onBlur)||void 0===r||r.call(t,e,n),null===(a=t.onFocusChanged)||void 0===a||a.call(t,!1,e,n))}),Bt.focusDebug&&((e,n)=>{if(rn){var r=document.createElement("style");r.type="text/css",r.innerHTML='\n      [data-focus="3"] {\n        border: 2px solid rgba(255, 33, 33, 0.2);\n        border-radius: 5px;\n        transition: border-color 0.3s ease;\n      }\n\n      [data-focus="2"] {\n        border: 2px solid rgba(255, 33, 33, 0.4);\n        border-radius: 5px;\n        transition: border-color 0.3s ease;\n      }\n\n      [data-focus="1"] {\n        border: 4px solid rgba(255, 33, 33, 0.9);\n        border-radius: 5px;\n        transition: border-color 0.5s ease;\n      }\n    ',document.head.appendChild(r),rn=!1}e.forEach(e=>{e.data=t(t({},e.data),{},{focus:void 0})}),n.forEach((e,n)=>{e.data=t(t({},e.data),{},{focus:n+1})})})(an,i),an=i,i},sn=0,un=(e,t,n=!1,r=!1)=>{var i,a=performance.now(),o=e.key||e.keyCode,s=Zt===o;if(Zt=o,!r&&Bt.throttleInput){if(s&&a-sn<Bt.throttleInput)return!1;sn=a}for(var u,l,d,c=an.length,h=`onCapture${t||e.key}`+r?"Release":"",p=r?"onCaptureKeyRelease":"onCaptureKey",f=c-1;f>=0;f--){var g=an[f];if(g.throttleInput&&s&&void 0!==g._lastAnyKeyPressTime&&a-g._lastAnyKeyPressTime<g.throttleInput)return!0;var m=g[h]||g[p];if(Gt(m)&&!0===m.call(g,e,g,i,t))return g._lastAnyKeyPressTime=a,!0}t&&(u=`on${t}`,l=`on${t}Release`),r||(d=n?"onKeyHold":"onKeyPress");for(var v=0;v<c;v++){var y=an[v];if(i||(i=y),y.throttleInput&&s&&void 0!==y._lastAnyKeyPressTime&&a-y._lastAnyKeyPressTime<y.throttleInput)return!0;var b=!1;if(r&&l){var x=y[l];Gt(x)&&!0===x.call(y,e,y,i)&&(b=!0)}else if(!r&&u){var T=y[u];Gt(T)&&!0===T.call(y,e,y,i)&&(b=!0)}if(!b&&d){var w=y[d];Gt(w)&&!0===w.call(y,e,t,y,i)&&(b=!0)}if(b)return y._lastAnyKeyPressTime=a,!0}return!1},ln={},dn=(e,t,n)=>{if(t){var r=t.key||t.keyCode,i=tn[t.key]||tn[t.keyCode],a=en[t.key]||en[t.keyCode];if(i)return void(ln[r]||(ln[r]=window.setTimeout(()=>{ln[r]=!0,un(t,i,!0)},e)));un(t,a,!1)}else if(n){var o=n.key||n.keyCode,s=en[n.key]||en[n.keyCode];!0===ln[o]?delete ln[o]:ln[o]&&(clearTimeout(ln[o]),delete ln[o],un(n,s,!1)),un(n,s,!1,!0)}},cn=({userKeyMap:e,keyHoldOptions:t,ownerContext:r=e=>{e()}}={})=>{e&&nn(e,en),null!=t&&t.userKeyHoldMap&&nn(t.userKeyHoldMap,tn);var i=(null==t?void 0:t.holdThreshold)||500,a=dn.bind(null,i),o=e=>r(()=>{a(e,void 0)}),s=e=>r(()=>{a(void 0,e)});return document.addEventListener("keyup",s),document.addEventListener("keydown",o),{cleanup:()=>{document.removeEventListener("keydown",o),document.removeEventListener("keyup",s);for(var e=0,t=Object.entries(ln);e<t.length;e++){var r=n(t[e],2),i=(r[0],r[1]);i&&!0!==i&&clearTimeout(i)}},focusPath:()=>an}};var hn=new class{constructor(){s(this,"nodeConfigs",[]),s(this,"isRegistered",!1),s(this,"stage",void 0)}register(e){this.isRegistered||(this.isRegistered=!0,this.stage=e,e.animationManager.registerAnimation(this))}add(e,t,n,r){var i,a,o=this.nodeConfigs.find(n=>n.node===e&&n.propName===t),s=null!==(i=r.duration)&&void 0!==i?i:0,u=null!==(a=r.delay)&&void 0!==a?a:0,l=r.easing||"linear",d=j(l),c=n,h=e[t];o?(o.duration=s,o.delay=u,o.easing=l,o.timingFunction=d,o.targetValue=c,o.startValue=h,o.progress=0,o.delayFor=u):this.nodeConfigs.push({node:e,duration:s,delay:u,easing:l,progress:0,delayFor:u,timingFunction:d,propName:t,startValue:h,targetValue:c})}update(e){for(var t=this.nodeConfigs.length-1;t>=0;t--){var n=this.nodeConfigs[t],r=n.node,i=n.duration,a=n.timingFunction,o=n.propName,s=n.startValue,u=n.targetValue,l=e;if(n.delayFor>0){if(n.delayFor-=l,n.delayFor>=0)continue;l=-n.delayFor,n.delayFor=0}i>0?(n.progress+=l/i,n.progress=Math.max(0,Math.min(1,n.progress))):0===i&&n.delayFor<=0&&(n.progress=1);var d,h=a(n.progress)||n.progress,p=void 0;if(p=1===n.progress?u:o.includes("color")?c(s,u,h):s+(u-s)*h,r.lng[o]=p,1===n.progress&&this.nodeConfigs.splice(t,1),0===this.nodeConfigs.length)null===(d=this.stage)||void 0===d||d.animationManager.unregisterAnimation(this),this.isRegistered=!1}}},pn=!1,fn=new Set;function gn(){pn=!1;var e=[...fn];fn.clear();for(var t=e.length-1;t>=0;t--){e[t].updateLayout()}}function mn(e){fn.add(e),pn||(pn=!0,queueMicrotask(gn))}function vn(e,t){var n=[];for(var r in t){var i=t[r];"rounded"===r&&(r="radius"),"object"==typeof i&&n.push(Ot.createEffect(r,i,r))}return Ot.createShader("DynamicShader",{effects:n})}function yn(e=""){return{set(n){"number"==typeof n&&(n={width:n,color:255}),this.effects=this.effects?t(t({},this.effects||{}),{[`border${e}`]:n}):{[`border${e}`]:n}},get(){var t;return null===(t=this.effects)||void 0===t?void 0:t[`border${e}`]}}}class bn extends Object{constructor(e){super(),this._type="text"===e?Ft:jt,this.rendered=!1,this.lng={},this.children=[]}get effects(){return this._effects}set effects(e){this._effects=e,Ut&&this.rendered&&(this.lng.shader=vn(0,e))}set id(e){var n;this._id=e,null!==(n=Bt.rendererOptions)&&void 0!==n&&n.inspector&&(this.data=t(t({},this.data),{},{testId:e}))}get id(){return this._id}get parent(){return this._parent}set parent(e){var t;(this._parent=e,this.rendered&&null!=e&&e.rendered)&&(this.lng.parent=null!==(t=e.lng)&&void 0!==t?t:null)}insertChild(e,t){if(e.parent&&(e.parent.removeChild(e),this.rendered||(this._hasRenderedChildren=!0)),e.parent=this,t){this.removeChild(e);var n=this.children.indexOf(t);if(n>=0)return void this.children.splice(n,0,e)}this.children.push(e)}removeChild(e){var t,n=this.children.indexOf(e);n>=0&&(this.children.splice(n,1),null===(t=e.onRemove)||void 0===t||t.call(e,e))}get selectedNode(){for(var e=this.selected||0;e<this.children.length;e++){var t=this.children[e];if(Kt(t))return this.selected=e,t}}set shader(e){this.lng.shader=zt(e)?Ot.createShader(...e):e}_sendToLightningAnimatable(e,t){var n=this;if(this.transition&&this.rendered&&Bt.animationsEnabled&&(!0===this.transition||this.transition[e])){var r=!0===this.transition||!0===this.transition[e]?void 0:this.transition[e];if(Bt.simpleAnimationsEnabled)return hn.add(this,e,t,r||this.animationSettings),void hn.register(Ot.stage);var i=this.animate({[e]:t},r);if(this.onAnimation)for(var a=Object.keys(this.onAnimation),o=function(){var r=u[s],a=n.onAnimation[r];i.on(r,(r,i)=>{a.call(n,r,e,t,i)})},s=0,u=a;s<u.length;s++)o();return i.start()}this.lng[e]=t}animate(e,t){return this.lng.animate(e,t||this.animationSettings||{})}chain(e,t){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),t?this._animationQueueSettings=t:this._animationQueueSettings||(this._animationQueueSettings=t||this.animationSettings),t=t||this._animationQueueSettings,this._animationQueue=this._animationQueue||[],this._animationQueue.push({props:e,animationSettings:t}),this}start(){var e=this;return o(r().m(function t(){var n;return r().w(function(t){for(;;)switch(t.n){case 0:n=e._animationQueue.shift();case 1:if(!n){t.n=3;break}return e._animationRunning=!0,t.n=2,e.animate(n.props,n.animationSettings).start().waitUntilStopped();case 2:n=e._animationQueue.shift(),t.n=1;break;case 3:e._animationRunning=!1,e._animationQueueSettings=void 0;case 4:return t.a(2)}},t)}))()}emit(e,...t){for(var n=this,r=`on${e.charAt(0).toUpperCase()}${e.slice(1)}`;n;){var i=n[r];if(Gt(i)&&!0===i.call(n,this,...t))return!0;n=n.parent}return!1}setFocus(){if(this.rendered){if(void 0!==this.forwardFocus)if(Ht(this.forwardFocus)){if(!1!==this.forwardFocus.call(this,this))return}else{var e="number"==typeof this.forwardFocus?this.forwardFocus:null,t=this.children;if(null!==e&&e<t.length){var n=t[e];return void(Kt(n)&&n.setFocus())}}queueMicrotask(()=>{return on(e=this,Qt),Qt=e,void Bt.setActiveElement(e);var e})}else this._autofocus=!0}_layoutOnLoad(){this.lng.on("loaded",()=>{this.parent.updateLayout()})}getText(){for(var e="",t=0;t<this.children.length;t++)e+=this.children[t].text;return e}destroy(){if(this.onDestroy){var e=this.onDestroy(this);e instanceof Promise?e.then(()=>this._destroy()):this._destroy()}else this._destroy()}_destroy(){var e;Wt(this.lng)&&(this.lng.destroy(),null!==(e=this.parent)&&void 0!==e&&e.requiresLayout()&&this.parent.updateLayout())}set style(e){if((!Bt.lockStyles||!this._style)&&e)for(var t in this._style=e,this._style)void 0===this[t]&&(this[t]=this._style[t])}get style(){return this._style}get hasChildren(){return this.children.length>0}set src(e){"string"==typeof e?(this.lng.src=e,!this.color&&this.rendered&&(this.color=4294967295)):this.color=0}get src(){return this.lng.src}getChildById(e){return this.children.find(t=>t.id===e)}searchChildrenById(e){for(var t=0;t<this.children.length;t++){var n=this.children[t];if(Kt(n)){if(n.id===e)return n;var r=n.searchChildrenById(e);if(r)return r}}}set states(e){this._states=this._states?this._states.merge(e):new $t(this._stateChanged.bind(this),e),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new $t(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||Bt.animationSettings}set animationSettings(e){this._animationSettings=e}set hidden(e){this.alpha=e?0:1}get hidden(){return 0===this.alpha}get h(){return this.height}set h(e){this.height=e}get w(){return this.width}set w(e){this.width=e}set autofocus(e){this._autofocus=e,e&&queueMicrotask(()=>this.setFocus())}get autofocus(){return this._autofocus}requiresLayout(){return"flex"===this.display||this.onLayout}set updateLayoutOn(e){this.updateLayout()}get updateLayoutOn(){return null}updateLayout(){if(this.hasChildren){if("flex"===this.display&&this.flexGrow&&0===this.width)return;var e="flex"===this.display&&Jt(this);fn.delete(this);var t=Ht(this.onLayout)&&this.onLayout.call(this,this);(e||t)&&this.parent&&mn(this.parent),!0===this._containsFlexGrow&&this.children.forEach(e=>{"flex"===e.display&&Kt(e)&&(Jt(e),Ht(e.onLayout)&&e.onLayout.call(e,e),mn(this))})}}_stateChanged(){if(this.forwardStates){var e=this.states.slice();this.children.forEach(t=>{t.states=e})}var n=this.states;if(this._undoStyles||function(e,t){var n,r=u(t);try{for(r.s();!(n=r.n()).done;)if(n.value in e)return!0}catch(i){r.e(i)}finally{r.f()}return!1}(this,n)){var r;this._undoStyles&&this._undoStyles.length&&(r={},this._undoStyles.forEach(e=>{r[e]=this.style[e]}));var i,a=n.length;if(0===a)return Object.assign(this,r),void(this._undoStyles=[]);1===a?(i=this[n[0]],i=r?t(t({},r),i):i):i=n.reduce((e,n)=>{var r=this[n];return r?t(t({},e),r):e},r||{}),i?(this._undoStyles=Object.keys(i),void 0!==i.transition&&(this.transition=i.transition),Object.assign(this,i)):this._undoStyles=[]}}render(e){var t,r,i,a=this,o=this.parent;if(o)if(o.rendered)if(o.requiresLayout()&&fn.add(o),this.rendered){var s;null===(s=this.onRender)||void 0===s||s.call(this,this)}else{this._states&&this._stateChanged();var l=a.lng,d=o.width||0,c=o.height||0;if(l.x=l.x||0,l.y=l.y||0,l.parent=o.lng,(this.right||0===this.right)&&(l.x=d-this.right,l.mountX=1),(this.bottom||0===this.bottom)&&(l.y=c-this.bottom,l.mountY=1),this.center&&(this.centerX=this.centerY=!0),this.centerX&&(l.x+=d/2,l.mountX=.5),this.centerY&&(l.y+=c/2,l.mountY=.5),qt(a)){var h=l;if(Bt.fontSettings)for(var p in Bt.fontSettings)void 0===h[p]&&(h[p]=Bt.fontSettings[p]);h.text=h.text||a.getText(),h.textAlign&&!h.contain&&console.warn("Text align requires contain: ",a.getText()),h.contain&&(h.width||(h.width=d-h.x-(h.marginRight||0)),"both"!==h.contain||h.height||h.maxLines?1===h.maxLines&&(h.height=h.height||h.lineHeight||h.fontSize):h.height=c-h.y-(h.marginBottom||0)),Ut&&a._effects&&(l.shader=vn(0,a._effects)),a.lng=Ot.createTextNode(l),o.requiresLayout()&&(l.width&&l.height||a._layoutOnLoad())}else if(l.texture||(isNaN(l.width)&&(l.width=a.flexGrow?0:d-l.x,a._calcWidth=!0),isNaN(l.height)&&(l.height=c-l.y,a._calcHeight=!0),l.rtt&&!l.color&&(l.color=4294967295),l.color||l.src||(l.color=0)),Ut&&a._effects&&(l.shader=vn(0,a._effects)),a.lng=Ot.createNode(l),a._hasRenderedChildren){a._hasRenderedChildren=!1;var f,g=u(a.children);try{for(g.s();!(f=g.n()).done;){var m=f.value;Kt(m)&&Wt(m.lng)&&(m.lng.parent=a.lng)}}catch(S){g.e(S)}finally{g.f()}}if(a.rendered=!0,a.autosize&&o.requiresLayout()&&a._layoutOnLoad(),null===(t=this.onCreate)||void 0===t||t.call(this,this),null===(r=this.onRender)||void 0===r||r.call(this,this),a.onEvent)for(var v=function(){var e=n(b[y],2),t=e[0],r=e[1];a.lng.on(t,(e,t)=>r.call(a,a,t))},y=0,b=Object.entries(a.onEvent);y<b.length;y++)v();if(null!==(i=a.lng)&&void 0!==i&&i.div&&(a.lng.div.element=a),a._type===jt)for(var x=a.children.length,T=0;T<x;T++){var w=a.children[T];Kt(w)&&w.render()}e&&!pn&&(pn=!0,queueMicrotask(gn)),a._autofocus&&a.setFocus()}else console.warn("Parent not rendered yet: ",this);else console.warn("Parent not set - no node created for: ",this)}}for(var xn=function(){var e=wn[Tn];Object.defineProperty(bn.prototype,e,{get(){return this.lng[e]},set(t){this._sendToLightningAnimatable(e,t)}})},Tn=0,wn=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","scaleX","scaleY","width","worldX","worldY","x","y","zIndex","zIndexLocked"];Tn<wn.length;Tn++)xn();for(var Sn=function(){var e=En[An];Object.defineProperty(bn.prototype,e,{get(){return this.lng[e]},set(t){this.lng[e]=t}})},An=0,En=["absX","absY","autosize","clipping","contain","data","destroyed","fontFamily","fontStretch","fontStyle","fontWeight","imageType","letterSpacing","maxLines","offsetY","overflowSuffix","preventCleanup","rtt","scrollable","scrollY","srcHeight","srcWidth","srcX","srcY","strictBounds","text","textAlign","textBaseline","textOverflow","texture","textureOptions","verticalAlign","wordWrap"];An<En.length;An++)Sn();function kn(e){return{set(n){this.effects=this.effects?t(t({},this.effects),{},{[e]:n}):{[e]:n}},get(){var t;return null===(t=this.effects)||void 0===t?void 0:t[e]}}}Object.defineProperties(bn.prototype,{border:yn(),borderLeft:yn("Left"),borderRight:yn("Right"),borderTop:yn("Top"),borderBottom:yn("Bottom"),linearGradient:kn("linearGradient"),radialGradient:kn("radialGradient"),radialProgress:kn("radialProgressGradient"),rounded:{set(e){this.effects=this.effects?t(t({},this.effects),{},{radius:{radius:e}}):{radius:{radius:e}}},get(){var e;return null===(e=this.effects)||void 0===e||null===(e=e.radius)||void 0===e?void 0:e.radius}},borderRadius:{set(e){this.effects=this.effects?t(t({},this.effects),{},{radius:{radius:e}}):{radius:{radius:e}}},get(){var e;return null===(e=this.effects)||void 0===e||null===(e=e.radius)||void 0===e?void 0:e.radius}}});var In={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return Cn(this.context.count)},getNextContextId(){return Cn(this.context.count++)}};function Cn(e){var t=String(e),n=t.length-1;return In.context.id+(n?String.fromCharCode(96+n):"")+t}function Mn(e){In.context=e}var Rn=Symbol("solid-proxy"),_n="function"==typeof Proxy,Pn=Symbol("solid-track"),Dn={equals:(e,t)=>e===t},Ln=hr,Nn=1,On=2,Un={owned:null,cleanups:null,context:null,owner:null},Bn={},jn=null,Fn=null,Vn=null,Hn=null,Gn=null,zn=0;function Xn(e,t){var n=Vn,r=jn,i=0===e.length,a=r,o=i?Un:{owned:null,cleanups:null,context:a?a.context:null,owner:a},s=i?e:()=>e(()=>Jn(()=>mr(o)));jn=o,Vn=null;try{return cr(s,!0)}finally{Vn=n,jn=r}}function Wn(e,t){var n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},Dn,t):Dn).equals||void 0};return[or.bind(n),e=>("function"==typeof e&&(e=e(n.value)),sr(n,e))]}function Kn(e,t,n){ur(lr(e,t,!1,Nn))}function qn(e,t,n){Ln=pr;var r=lr(e,t,!1,Nn);r.user=!0,Gn?Gn.push(r):ur(r)}function Yn(e,t,n){n=n?Object.assign({},Dn,n):Dn;var r=lr(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,ur(r),or.bind(r)}function $n(e,t,r){var i,a,o;i=!0,a=e;var s=null,l=Bn,d=null,c=!1,h="initialValue"in(o={}),p=!1,f=new Set,g=n((o.storage||Wn)(o.initialValue),2),m=g[0],v=g[1],y=n(Wn(void 0),2),b=y[0],x=y[1],T=n(Wn(void 0,{equals:!1}),2),w=(T[0],T[1]),S=n(Wn(h?"ready":"unresolved"),2),A=S[0],E=S[1];function k(e,t,n,r){return s===e&&(s=null,void 0!==r&&(h=!0),e!==l&&t!==l||!o.onHydrated||queueMicrotask(()=>o.onHydrated(r,{value:t})),l=Bn,function(e,t){cr(()=>{void 0===t&&v(()=>e),E(void 0!==t?"errored":h?"ready":"unresolved"),x(t);var n,r=u(f.keys());try{for(r.s();!(n=r.n()).done;){n.value.decrement()}}catch(t){r.e(t)}finally{r.f()}f.clear()},!1)}(t,n)),t}function I(){var e=m(),t=b();if(void 0!==t&&!s)throw t;return Vn&&Vn.user,e}function C(e=!0){if(!1===e||!c){c=!1;var t=p?p():i;if(null!=t&&!1!==t){var n,r,o=l!==Bn?l:Jn(()=>{try{return a(t,{value:m(),refetching:e})}catch(r){n=r}});if(void 0===n)return(r=o)&&"object"==typeof r&&"then"in r?(s=o,"v"in o?(1===o.s?k(s,o.v,void 0,t):k(s,void 0,vr(o.v),t),o):(c=!0,queueMicrotask(()=>c=!1),cr(()=>{E(h?"refreshing":"pending"),w()},!1),o.then(e=>k(o,e,void 0,t),e=>k(o,void 0,vr(e),t)))):(k(s,o,void 0,t),o);k(s,void 0,vr(n),t)}else k(s,Jn(m))}}In.context&&(d=In.getNextContextId(),"initial"===o.ssrLoadFrom?l=o.initialValue:In.load&&In.has(d)&&(l=In.load(d))),Object.defineProperties(I,{state:{get:()=>A()},error:{get:()=>b()},loading:{get(){var e=A();return"pending"===e||"refreshing"===e}},latest:{get(){if(!h)return I();var e=b();if(e&&!s)throw e;return m()}}});var M=jn;return p?function(e,t){ur(lr(e,t,!0,Nn))}(()=>(M=jn,C(!1))):C(!1),[I,{refetch:e=>tr(M,()=>C(e)),mutate:v}]}function Jn(e){if(null===Vn)return e();var t=Vn;Vn=null;try{return e()}finally{Vn=t}}function Qn(e,t,n){var r,i=Array.isArray(e),a=n&&n.defer;return n=>{var o;if(i){o=Array(e.length);for(var s=0;s<e.length;s++)o[s]=e[s]()}else o=e();if(a)return a=!1,n;var u=Jn(()=>t(o,r,n));return r=o,u}}function Zn(e){return null===jn||(null===jn.cleanups?jn.cleanups=[e]:jn.cleanups.push(e)),e}function er(){return jn}function tr(e,t){var n=jn,r=Vn;jn=e,Vn=null;try{return cr(t,!0)}catch(i){yr(i)}finally{jn=n,Vn=r}}var nr=n(Wn(!1),2);nr[0],nr[1];function rr(e,t){var n=Symbol("context");return{id:n,Provider:xr(n),defaultValue:e}}function ir(e){var t;return jn&&jn.context&&void 0!==(t=jn.context[e.id])?t:e.defaultValue}function ar(e){var t=Yn(e),n=Yn(()=>br(t()));return n.toArray=()=>{var e=n();return Array.isArray(e)?e:null!=e?[e]:[]},n}function or(){if(this.sources&&this.state)if(this.state===Nn)ur(this);else{var e=Hn;Hn=null,cr(()=>fr(this),!1),Hn=e}if(Vn){var t=this.observers?this.observers.length:0;Vn.sources?(Vn.sources.push(this),Vn.sourceSlots.push(t)):(Vn.sources=[this],Vn.sourceSlots=[t]),this.observers?(this.observers.push(Vn),this.observerSlots.push(Vn.sources.length-1)):(this.observers=[Vn],this.observerSlots=[Vn.sources.length-1])}return this.value}function sr(e,t,n){var r=e.value;return e.comparator&&e.comparator(r,t)||(e.value=t,e.observers&&e.observers.length&&cr(()=>{for(var t=0;t<e.observers.length;t+=1){var n=e.observers[t],r=Fn&&Fn.running;r&&Fn.disposed.has(n),(r?n.tState:n.state)||(n.pure?Hn.push(n):Gn.push(n),n.observers&&gr(n)),r||(n.state=Nn)}if(Hn.length>1e6)throw Hn=[],new Error},!1)),t}function ur(e){if(e.fn){mr(e);var t=zn;!function(e,t,n){var r,i=jn,a=Vn;Vn=jn=e;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=Nn,e.owned&&e.owned.forEach(mr),e.owned=null),e.updatedAt=n+1,yr(o)}finally{Vn=a,jn=i}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?sr(e,r):e.value=r,e.updatedAt=n)}(e,e.value,t)}}function lr(e,t,n,r=Nn,i){var a={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:jn,context:jn?jn.context:null,pure:n};return null===jn||jn!==Un&&(jn.owned?jn.owned.push(a):jn.owned=[a]),a}function dr(e){if(0!==e.state){if(e.state===On)return fr(e);if(e.suspense&&Jn(e.suspense.inFallback))return e.suspense.effects.push(e);for(var t=[e];(e=e.owner)&&(!e.updatedAt||e.updatedAt<zn);)e.state&&t.push(e);for(var n=t.length-1;n>=0;n--)if((e=t[n]).state===Nn)ur(e);else if(e.state===On){var r=Hn;Hn=null,cr(()=>fr(e,t[0]),!1),Hn=r}}}function cr(e,t){if(Hn)return e();var n=!1;t||(Hn=[]),Gn?n=!0:Gn=[],zn++;try{var r=e();return function(e){Hn&&(hr(Hn),Hn=null);if(e)return;var t=Gn;Gn=null,t.length&&cr(()=>Ln(t),!1)}(n),r}catch(i){n||(Gn=null),Hn=null,yr(i)}}function hr(e){for(var t=0;t<e.length;t++)dr(e[t])}function pr(e){var t,n=0;for(t=0;t<e.length;t++){var r=e[t];r.user?e[n++]=r:dr(r)}if(In.context){if(In.count)return In.effects||(In.effects=[]),void In.effects.push(...e.slice(0,n));Mn()}for(!In.effects||!In.done&&In.count||(e=[...In.effects,...e],n+=In.effects.length,delete In.effects),t=0;t<n;t++)dr(e[t])}function fr(e,t){e.state=0;for(var n=0;n<e.sources.length;n+=1){var r=e.sources[n];if(r.sources){var i=r.state;i===Nn?r!==t&&(!r.updatedAt||r.updatedAt<zn)&&dr(r):i===On&&fr(r,t)}}}function gr(e){for(var t=0;t<e.observers.length;t+=1){var n=e.observers[t];n.state||(n.state=On,n.pure?Hn.push(n):Gn.push(n),n.observers&&gr(n))}}function mr(e){var t;if(e.sources)for(;e.sources.length;){var n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){var a=i.pop(),o=n.observerSlots.pop();r<i.length&&(a.sourceSlots[o]=r,i[r]=a,n.observerSlots[r]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)mr(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)mr(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function vr(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function yr(e,t=jn){throw vr(e)}function br(e){if("function"==typeof e&&!e.length)return br(e());if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var r=br(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function xr(e,n){return function(n){var r;return Kn(()=>r=Jn(()=>(jn.context=t(t({},jn.context),{},{[e]:n.value}),ar(()=>n.children))),void 0),r}}var Tr=Symbol("fallback");function wr(e){for(var t=0;t<e.length;t++)e[t]()}function Sr(e,t){return Jn(()=>e(t||{}))}function Ar(){return!0}var Er={get:(e,t,n)=>t===Rn?n:e.get(t),has:(e,t)=>t===Rn||e.has(t),set:Ar,deleteProperty:Ar,getOwnPropertyDescriptor:(e,t)=>({configurable:!0,enumerable:!0,get:()=>e.get(t),set:Ar,deleteProperty:Ar}),ownKeys:e=>e.keys()};function kr(e){return(e="function"==typeof e?e():e)?e:{}}function Ir(){for(var e=0,t=this.length;e<t;++e){var n=this[e]();if(void 0!==n)return n}}function Cr(...e){for(var t=!1,n=0;n<e.length;n++){var r=e[n];t=t||!!r&&Rn in r,e[n]="function"==typeof r?(t=!0,Yn(r)):r}if(_n&&t)return new Proxy({get(t){for(var n=e.length-1;n>=0;n--){var r=kr(e[n])[t];if(void 0!==r)return r}},has(t){for(var n=e.length-1;n>=0;n--)if(t in kr(e[n]))return!0;return!1},keys(){for(var t=[],n=0;n<e.length;n++)t.push(...Object.keys(kr(e[n])));return[...new Set(t)]}},Er);for(var i={},a=Object.create(null),o=e.length-1;o>=0;o--){var s=e[o];if(s)for(var u=Object.getOwnPropertyNames(s),l=function(){var e=u[d];if("__proto__"===e||"constructor"===e)return 1;var t=Object.getOwnPropertyDescriptor(s,e);if(a[e]){var n=i[e];n&&(t.get?n.push(t.get.bind(s)):void 0!==t.value&&n.push(()=>t.value))}else a[e]=t.get?{enumerable:!0,configurable:!0,get:Ir.bind(i[e]=[t.get.bind(s)])}:void 0!==t.value?t:void 0},d=u.length-1;d>=0;d--)l()}for(var c={},h=Object.keys(a),p=h.length-1;p>=0;p--){var f=h[p],g=a[f];g&&g.get?Object.defineProperty(c,f,g):c[f]=g?g.value:void 0}return c}function Mr(e){var t=e.keyed,n=Yn(()=>e.when,void 0,void 0),r=t?n:Yn(n,void 0,{equals:(e,t)=>!e==!t});return Yn(()=>{var i=r();if(i){var a=e.children;return"function"==typeof a&&a.length>0?Jn(()=>a(t?i:()=>{if(!Jn(r))throw`Stale read from <${"Show"}>.`;return n()})):a}return e.fallback},void 0,void 0)}var Rr=n(Wn(void 0),2),_r=Rr[0],Pr=Rr[1],Dr=e=>Yn(()=>e());function Lr({createElement:e,createTextNode:t,isTextNode:n,replaceText:r,insertNode:i,removeNode:a,setProperty:o,getParentNode:s,getFirstChild:u,getNextSibling:l}){function d(e,t,n,r){if(void 0===n||r||(r=[]),"function"!=typeof t)return c(e,t,r,n);Kn(r=>c(e,t(),r,n),r)}function c(e,a,o,s,l){for(;"function"==typeof o;)o=o();if(a===o)return o;var d=typeof a,v=void 0!==s;if("string"===d||"number"===d)if("number"===d&&(a=a.toString()),v){var y=o[0];y&&n(y)?r(y,a):y=t(a),o=f(e,o,s,y)}else""!==o&&"string"==typeof o?r(u(e),o=a):(f(e,o,s,t(a)),o=a);else if(null==a||"boolean"===d)o=f(e,o,s);else{if("function"===d)return Kn(()=>{for(var t=a();"function"==typeof t;)t=t();o=c(e,t,o,s)}),()=>o;if(Array.isArray(a)){var b=[];if(h(b,a,l))return Kn(()=>o=c(e,b,o,s,!0)),()=>o;if(0===b.length){var x=f(e,o,s);if(v)return o=x}else Array.isArray(o)?0===o.length?g(e,b,s):p(e,o,b):null==o||""===o?g(e,b):p(e,v&&o||[u(e)],b);o=b}else{if(Array.isArray(o)){if(v)return o=f(e,o,s,a);f(e,o,null,a)}else null!=o&&""!==o&&u(e)?m(e,a,u(e)):i(e,a);o=a}}return o}function h(e,n,r){for(var i=!1,a=0,o=n.length;a<o;a++){var s=n[a],u=void 0;if(null==s||!0===s||!1===s);else if(Array.isArray(s))i=h(e,s)||i;else if("string"==(u=typeof s)||"number"===u)e.push(t(s));else if("function"===u)if(r){for(;"function"==typeof s;)s=s();i=h(e,Array.isArray(s)?s:[s])||i}else e.push(s),i=!0;else e.push(s)}return i}function p(e,t,n){for(var r=n.length,o=t.length,s=r,u=0,d=0,c=l(t[o-1]),h=null;u<o||d<s;)if(t[u]!==n[d]){for(;t[o-1]===n[s-1];)o--,s--;if(o===u)for(var p=s<r?d?l(n[d-1]):n[s-d]:c;d<s;)i(e,n[d++],p);else if(s===d)for(;u<o;)h&&h.has(t[u])||a(e,t[u]),u++;else if(t[u]===n[s-1]&&n[d]===t[o-1]){var f=l(t[--o]);i(e,n[d++],l(t[u++])),i(e,n[--s],f),t[o]=n[s]}else{if(!h){h=new Map;for(var g=d;g<s;)h.set(n[g],g++)}var v=h.get(t[u]);if(null!=v)if(d<v&&v<s){for(var y=u,b=1,x=void 0;++y<o&&y<s&&null!=(x=h.get(t[y]))&&x===v+b;)b++;if(b>v-d)for(var T=t[u];d<v;)i(e,n[d++],T);else m(e,n[d++],t[u++])}else u++;else a(e,t[u++])}}else u++,d++}function f(e,n,r,o){if(void 0===r){for(var l;l=u(e);)a(e,l);return o&&i(e,o),""}var d=o||t("");if(n.length)for(var c=!1,h=n.length-1;h>=0;h--){var p=n[h];if(d!==p){var f=s(p)===e;c||h?f&&a(e,p):f?m(e,d,p):i(e,d,r)}else c=!0}else i(e,d,r);return[d]}function g(e,t,n){for(var r=0,a=t.length;r<a;r++)i(e,t[r],n)}function m(e,t,n){i(e,t,n),a(e,n)}function v(e,t,n={},r){return t||(t={}),r||Kn(()=>n.children=c(e,t.children,n.children)),Kn(()=>t.ref&&t.ref(e)),Kn(()=>{for(var r in t)if("children"!==r&&"ref"!==r){var i=t[r];i!==n[r]&&(o(e,r,i,n[r]),n[r]=i)}}),n}return{render(e,t){var n;return Xn(r=>{n=r,d(t,e())}),n},insert:d,spread(e,t,n){"function"==typeof t?Kn(r=>v(e,t(),r,n)):v(e,t,void 0,n)},createElement:e,createTextNode:t,insertNode:i,setProp:(e,t,n,r)=>(o(e,t,n,r),n),mergeProps:Cr,effect:Kn,memo:Dr,createComponent:Sr,use:(e,t,n)=>Jn(()=>e(t,n))}}Object.defineProperty(bn.prototype,"preserve",{get(){return 0===this._queueDelete},set(e){this._queueDelete=e?0:void 0}});var Nr=[];function Or(){var e,t=u(Nr);try{for(t.s();!(e=t.n()).done;){var n=e.value;Number(n._queueDelete)<0&&n.destroy(),n._queueDelete=void 0}}catch(r){t.e(r)}finally{t.f()}Nr.length=0}function Ur(e,t){void 0===e._queueDelete?(e._queueDelete=t,1===Nr.push(e)&&queueMicrotask(Or)):e._queueDelete+=t}var Br,jr={createElement:e=>new bn(e),createTextNode:e=>({_type:Vt,text:e}),replaceText(e,t){e.text=t;var n=e.parent;n.text=n.getText()},setProperty(e,t,n=!0){e[t]=n},insertNode(e,t,n){var r=t.parent;e.insertChild(t,n),t instanceof bn?(t.parent.rendered&&t.render(!0),void 0!==r&&Ur(t,1)):qt(e)&&(e.text=e.getText())},isTextNode:e=>qt(e),removeNode(e,t){e.removeChild(t),t instanceof bn?Ur(t,-1):qt(e)&&(e.text=e.getText())},getParentNode:e=>e.parent,getFirstChild:e=>e.children[0],getNextSibling(e){var t=e.parent.children||[],n=t.indexOf(e)+1;if(n<t.length)return t[n]}},Fr=function(e){var t=Lr(e);return t.mergeProps=Cr,t}(jr),Vr=jr.createElement("App"),Hr=function(e){return Fr.render(e,Vr)};var Gr=Fr.memo,zr=Fr.createComponent,Xr=Fr.createElement,Wr=Fr.spread,Kr=Fr.mergeProps;e({a:zr,c:Xr,s:Wr,m:Kr});var qr=[],Yr=!1;function $r(){Yr&&qr.length&&setTimeout(()=>{var e=qr.shift();e&&(e(),$r())},Bt.taskDelay||50)}Xn(()=>{Kn(()=>{_r(),Yr=!1})});var Jr,Qr=e("V",e=>{var t=Xr("node");return Wr(t,e,!1),t});e("T",e=>{var t=Xr("text");return Wr(t,e,!1),t});function Zr(){var e=new Set;var n=!1;return{subscribe:function(t){return e.add(t),()=>e.delete(t)},confirm:function(r,i){if(n)return!(n=!1);var a,o={to:r,options:i,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0},s=u(e);try{var l=function(){var e=a.value;e.listener(t(t({},o),{},{from:e.location,retry:a=>{a&&(n=!0),e.navigate(r,t(t({},i),{},{resolve:!1}))}}))};for(s.s();!(a=s.n()).done;)l()}catch(d){s.e(d)}finally{s.f()}return!o.defaultPrevented}}}function ei(){window.history.state&&null!=window.history.state._depth||window.history.replaceState(t(t({},window.history.state),{},{_depth:window.history.length-1}),""),Jr=window.history.state._depth}ei();var ti=/^(?:[a-z0-9]+:)?\/\//i,ni=/^\/+|(\/)\/+$/g;function ri(e,t=!1){var n=e.replace(ni,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function ii(e,t,n){if(!ti.test(t)){var r=ri(e),i=n&&ri(n),a="";return((a=!i||t.startsWith("/")?r:0!==i.toLowerCase().indexOf(r.toLowerCase())?r+i:i)||"/")+ri(t,!a)}}function ai(e,t){return ri(e).replace(/\/*(\*.*)?$/g,"")+ri(t)}function oi(e){var t={};return e.searchParams.forEach((e,n)=>{n in t?Array.isArray(t[n])?t[n].push(e):t[n]=[t[n],e]:t[n]=e}),t}function si(e,t,r){var i=n(e.split("/*",2),2),a=i[0],o=i[1],s=a.split("/").filter(Boolean),u=s.length;return e=>{var n=e.split("/").filter(Boolean),i=n.length-u;if(i<0||i>0&&void 0===o&&!t)return null;for(var a={path:u?"":"/",params:{}},l=e=>void 0===r?void 0:r[e],d=0;d<u;d++){var c=s[d],h=":"===c[0],p=h?n[d]:n[d].toLowerCase(),f=h?c.slice(1):c.toLowerCase();if(h&&ui(p,l(f)))a.params[f]=p;else if(h||!ui(p,f))return null;a.path+=`/${p}`}if(o){var g=i?n.slice(-i).join("/"):"";if(!ui(g,l(o)))return null;a.params[o]=g}return a}}function ui(e,t){var n=t=>t===e;return void 0===t||("string"==typeof t?n(t):"function"==typeof t?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp&&t.test(e))}function li(e){var t=new Map,n=er();return new Proxy({},{get:(r,i)=>(t.has(i)||tr(n,()=>t.set(i,Yn(()=>e()[i]))),t.get(i)()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),ownKeys:()=>Reflect.ownKeys(e()),has:(t,n)=>n in e()})}function di(e){var t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];for(var n=e.slice(0,t.index),r=e.slice(t.index+t[0].length),i=[n,n+=t[1]];t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return di(r).reduce((e,t)=>[...e,...i.map(e=>e+t)],[])}var ci,hi=rr(),pi=rr(),fi=()=>function(e,t){if(null==e)throw new Error(t);return e}(ir(hi),"<A> and 'use' router primitives can be only used inside a Route.");function gi(e,n=""){var r=e.component,i=e.preload,a=e.load,o=e.children,s=e.info,l=!o||Array.isArray(o)&&!o.length,d={key:e,component:r,preload:i||a,info:s};return vi(e.path).reduce((r,i)=>{var a,o=u(di(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,c=ai(n,s),h=l?c:c.split("/*",1)[0];h=h.split("/").map(e=>e.startsWith(":")||e.startsWith("*")?e:encodeURIComponent(e)).join("/"),r.push(t(t({},d),{},{originalPath:i,pattern:h,matcher:si(h,!l,e.matchFilters)}))}}catch(p){o.e(p)}finally{o.f()}return r},[])}function mi(e,r=0){return{routes:e,score:1e4*(i=e[e.length-1],a=n(i.pattern.split("/*",2),2),o=a[0],s=a[1],u=o.split("/").filter(Boolean),u.reduce((e,t)=>e+(t.startsWith(":")?2:3),u.length-(void 0===s?0:1)))-r,matcher(n){for(var r=[],i=e.length-1;i>=0;i--){var a=e[i],o=a.matcher(n);if(!o)return null;r.unshift(t(t({},o),{},{route:a}))}return r}};var i,a,o,s,u}function vi(e){return Array.isArray(e)?e:[e]}function yi(e,t="",n=[],r=[]){for(var i=vi(e),a=0,o=i.length;a<o;a++){var s=i[a];if(s&&"object"==typeof s){s.hasOwnProperty("path")||(s.path="");var l,d=u(gi(s,t));try{for(d.s();!(l=d.n()).done;){var c=l.value;n.push(c);var h=Array.isArray(s.children)&&0===s.children.length;if(s.children&&!h)yi(s.children,c.pattern,n,r);else{var p=mi([...n],r.length);r.push(p)}n.pop()}}catch(f){d.e(f)}finally{d.f()}}}return n.length?r:r.sort((e,t)=>t.score-e.score)}function bi(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n].matcher(t);if(i)return i}return[]}function xi(e,r,i,a={}){var o=n(e.signal,2),s=o[0],u=o[1],l=e.utils,d=void 0===l?{}:l,c=d.parsePath||(e=>e),h=d.renderPath||(e=>e),p=d.beforeLeave||Zr(),f=ii("",a.base||"");if(void 0===f)throw new Error(`${f} is not a valid base path`);f&&!s().value&&u({value:f,replace:!0,scroll:!1});var g,m=n(Wn(!1),2),v=m[0],y=m[1],b=(e,n)=>{var r,i,a;n.value===T()&&n.state===A()||(void 0===g&&y(!0),ci=e,g=n,(r=()=>{g===n&&(w(g.value),E(g.state),C[1](e=>e.filter(e=>e.pending)))},i=Vn,a=jn,Promise.resolve().then(()=>{Vn=i,jn=a,cr(r,!1),Vn=jn=null})).finally(()=>{g===n&&function(e){cr(e,!1)}(()=>{var n,r;ci=void 0,"navigate"===e&&(n=g,(r=I[0])&&(u(t(t({},n),{},{replace:r.replace,scroll:r.scroll})),I.length=0)),y(!1),g=void 0})}))},x=n(Wn(s().value),2),T=x[0],w=x[1],S=n(Wn(s().state),2),A=S[0],E=S[1],k=function(e,t,n){var r=new URL("http://sr"),i=Yn(t=>{var n=e();try{return new URL(n,r)}catch(i){return console.error(`Invalid path ${n}`),t}},r,{equals:(e,t)=>e.href===t.href}),a=Yn(()=>i().pathname),o=Yn(()=>i().search,!0),s=Yn(()=>i().hash),u=Qn(o,()=>oi(i()));return{get pathname(){return a()},get search(){return o()},get hash(){return s()},get state(){return t()},get key(){return""},query:n?n(u):li(u)}}(T,A,d.queryWrapper),I=[],C=Wn([]),M=Yn(()=>"function"==typeof a.transformUrl?bi(r(),a.transformUrl(k.pathname)):bi(r(),k.pathname)),R=()=>{for(var e=M(),t={},n=0;n<e.length;n++)Object.assign(t,e[n].params);return t},_=d.paramsWrapper?d.paramsWrapper(R,r):li(R),P={pattern:f,path:()=>f,outlet:()=>null,resolvePath:e=>ii(f,e)};return Kn(Qn(s,e=>b("native",e),{defer:!0})),{base:P,location:k,params:_,isRouting:v,renderPath:h,parsePath:c,navigatorFactory:function(e){return e=e||ir(pi)||P,(n,r)=>function(e,n,r){Jn(()=>{if("number"!=typeof n){var i=!n||"?"===n[0],a=t({replace:!1,resolve:!i,scroll:!0},r),o=a.replace,s=a.resolve,u=a.scroll,l=a.state,c=s?e.resolvePath(n):ii(i&&k.pathname||"",n);if(void 0===c)throw new Error(`Path '${n}' is not a routable path`);if(I.length>=100)throw new Error("Too many redirects");var h=T();c===h&&l===A()||p.confirm(c,r)&&(I.push({value:h,replace:o,scroll:u,state:A()}),b("navigate",{value:c,state:l}))}else n&&(d.go?d.go(n):console.warn("Router integration does not support relative routing"))})}(e,n,r)},matches:M,beforeLeave:p,preloadRoute:function(e,t){var n=bi(r(),e.pathname),a=ci;ci="preload";var o=function(){var r=n[s],a=r.route,o=r.params;a.component&&a.component.preload&&a.component.preload();var u=a.preload;t&&u&&tr(i(),()=>u({params:o,location:{pathname:e.pathname,search:e.search,hash:e.hash,query:oi(e),state:null,key:""},intent:"preload"}))};for(var s in n)o();ci=a},singleFlight:void 0===a.singleFlight||a.singleFlight,submissions:C}}var Ti=e=>t=>{var n,r=t.base,i=ar(()=>t.children),a=Yn(()=>yi(i(),t.base||"")),o=xi(e,a,()=>n,{base:r,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(o),zr(hi.Provider,{value:o,get children(){return zr(wi,{routerState:o,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[Gr(()=>(n=er())&&null),zr(Si,{routerState:o,get branches(){return a()}})]}})}})};function wi(e){var t=e.routerState.location,n=e.routerState.params,r=Yn(()=>e.preload&&Jn(()=>{e.preload({params:n,location:t,intent:ci||"initial"})}));return zr(Mr,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>zr(i,{params:n,location:t,get data(){return r()},get children(){return e.children}})})}function Si(e){var t,n=[],r=Yn(Qn(e.routerState.matches,(i,a,o)=>{for(var s=a&&i.length===a.length,u=[],l=function(t){var l=a&&a[t],d=i[t];o&&l&&d.route.key===l.route.key?u[t]=o[t]:(s=!1,n[t]&&n[t](),Xn(i=>{n[t]=i,u[t]=function(e,t,n,r){var i=e.base,a=e.location,o=e.params,s=r().route,u=s.pattern,l=s.component,d=s.preload,c=Yn(()=>r().path);l&&l.preload&&l.preload();var h=d?d({params:o,location:a,intent:ci||"initial"}):void 0;return{parent:t,pattern:u,path:c,outlet:()=>l?Sr(l,{params:o,location:a,data:h,get children(){return n()}}):n(),resolvePath:e=>ii(i.path(),e,c())}}(e.routerState,u[t-1]||e.routerState.base,Ai(()=>r()[t+1]),()=>{var n,r=e.routerState.matches();return null!==(n=r[t])&&void 0!==n?n:r[0]})}))},d=0,c=i.length;d<c;d++)l(d);return n.splice(i.length).forEach(e=>e()),o&&s?o:(t=u[0],u)}));return Ai(()=>r()&&t)()}var Ai=e=>()=>zr(Mr,{get when(){return e()},keyed:!0,children:e=>zr(pi.Provider,{value:e,get children(){return e.outlet()}})}),Ei=e=>{var t=ar(()=>e.children);return Cr(e,{get children(){return t()}})};var ki,Ii=n(Wn([]),2),Ci=Ii[0],Mi=Ii[1],Ri="aria-parent",_i=[];function Pi(e){return new Promise(t=>{setTimeout(t,e)})}function Di(e){var t;0!==(null==e||null===(t=e.text)||void 0===t?void 0:t.trim().length)&&_i.push(e)}function Li(){var e=Ui();if(e){for(var t=0,n=_i;t<n.length;t++){var r=n[t],i=document.createElement("span");i.setAttribute("lang",r.lang),i.setAttribute("aria-label",r.text),e.appendChild(i)}setTimeout(()=>{_i=[],Ni(),Oi()},100)}else console.error(`ARIA div not found: ${Ri}`)}function Ni(){var e=document.getElementById(Ri);if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function Oi(){var e,t=null===(e=document.getElementById("app"))||void 0===e?void 0:e.firstChild;null==t||t.focus()}function Ui(){var e=document.getElementById(Ri);if(!e){var t=document.createElement("div");return t.setAttribute("id",Ri),t.setAttribute("aria-live","assertive"),t.setAttribute("tabindex","0"),document.body.appendChild(t),t}return e}function Bi(e,t,n="en-US",r){var i=window.speechSynthesis;return new Promise((a,o)=>{var s;if(r){var u=i.getVoices();s=u.find(e=>e.name===r)||u[0]}var l=new SpeechSynthesisUtterance(e);l.lang=n,s&&(l.voice=s),l.onend=()=>{a()},l.onerror=e=>{o(e)},t.push(l),i.speak(l)})}function ji(e,t,n,i,a=!0){var s=window.speechSynthesis,u=function(e=[]){var t,n=[];for(t=0;t<e.length;t++){var r=e[t];if("string"!=typeof r||r.includes("PAUSE-"))break;n.push(e[t])}return[n.join(",\b ")].concat(e.slice(t))}(Array.isArray(e)?e:[e]),l=[],d=[],c=!0;return{series:o(r().m(function e(){var o,s,h,p,f,g,m,v,y,b,x,T,w;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0;case 1:if(!c||!u.length){e.n=37;break}return e.n=2,Promise.resolve(u.shift());case 2:if(o=e.v,c){e.n=3;break}return e.a(3,37);case 3:if("string"!=typeof o||!o.includes("PAUSE-")){e.n=5;break}if(s=1e3*Number(o.split("PAUSE-")[1]),isNaN(s)){e.n=4;break}return e.n=4,Pi(s);case 4:e.n=36;break;case 5:if("string"!=typeof o){e.n=19;break}if(o){e.n=6;break}return e.a(3,1);case 6:p=h=3;case 7:if(!(c&&p>0)){e.n=18;break}if(e.p=8,!t){e.n=9;break}Di({text:o,lang:n}),e.n=10;break;case 9:return e.n=10,Bi(o,d,n,i);case 10:p=0,e.n=17;break;case 11:if(e.p=11,!((T=e.v)instanceof SpeechSynthesisErrorEvent)){e.n=16;break}if("network"!==T.error){e.n=13;break}return p--,console.warn(`Speech synthesis network error. Retries left: ${p}`),e.n=12,Pi(500*(h-p));case 12:e.n=15;break;case 13:if("canceled"!==T.error&&"interrupted"!==T.error){e.n=14;break}p=0,e.n=15;break;case 14:throw new Error(`SpeechSynthesisErrorEvent: ${T.error}`);case 15:e.n=17;break;case 16:throw T;case 17:e.n=7;break;case 18:e.n=36;break;case 19:if(!(o instanceof SpeechSynthesisUtterance)){e.n=33;break}g=f=3,m=o.text,v=null==o?void 0:o.lang,y=null==o?void 0:o.voice;case 20:if(!(c&&g>0)){e.n=32;break}if(e.p=21,!m){e.n=24;break}if(!t){e.n=22;break}Di({text:m,lang:v}),e.n=23;break;case 22:return e.n=23,Bi(m,d,v,null==y?void 0:y.name);case 23:g=0;case 24:e.n=31;break;case 25:if(e.p=25,!((w=e.v)instanceof SpeechSynthesisErrorEvent)){e.n=30;break}if("network"!==w.error){e.n=27;break}return g--,console.warn(`Speech synthesis network error. Retries left: ${g}`),e.n=26,Pi(500*(f-g));case 26:e.n=29;break;case 27:if("canceled"!==w.error&&"interrupted"!==w.error){e.n=28;break}g=0,e.n=29;break;case 28:throw new Error(`SpeechSynthesisErrorEvent: ${w.error}`);case 29:e.n=31;break;case 30:throw w;case 31:e.n=20;break;case 32:e.n=36;break;case 33:if("function"!=typeof o){e.n=35;break}return b=ji(o(),t,n,i,!1),l.push(b),e.n=34,b.series;case 34:e.n=36;break;case 35:if(!Array.isArray(o)){e.n=36;break}return x=ji(o,t,n,i,!1),l.push(x),e.n=36,x.series;case 36:e.n=1;break;case 37:return e.p=37,c=!1,a&&t&&Li(),e.f(37);case 38:return e.a(2)}},e,null,[[21,25],[8,11],[0,,37,38]])}))(),get active(){return c},append:e=>{u.push(e)},cancel:()=>{if(c){if(a){if(t){var e=Ui();return void(e&&(_i=[],Ni(),e.focus(),Oi()))}s.cancel()}l.forEach(e=>{e.cancel()}),c=!1}}}}function Fi(e,t,n="en-US",r){return ki&&ki.cancel(),ki=ji(e,t,n,r)}var Vi,Hi,Gi=[],zi=!1;function Xi(e,t){var n,r=((e,t)=>{var n,r=()=>clearTimeout(n);return er()&&Zn(r),Object.assign((...i)=>{void 0!==n&&r(),n=setTimeout(()=>e(...i),t)},{clear:r})})(e,t),i=e=>{n=e,r(e)};return i.flush=()=>{r.clear(),e(n)},i.clear=r.clear,i}function Wi(e){return e.id||e.name}function Ki(e=[]){if(qi.onFocusChange&&qi.enabled){var t=e.every(e=>!e.loading),n=e.filter(e=>!Gi.includes(e));if(Vi(),t||!qi.onFocusChange){Gi=e.slice(0);var r=[],i=n.reverse().reduce((e,t)=>(t.announce?(e.push([Wi(t),"Announce",t.announce]),r.push(t.announce)):t.title?(e.push([Wi(t),"Title",t.title]),r.push(t.title)):e.push([Wi(t),"No Announce",""]),e),[]);return n.reverse().reduce((e,t)=>(t.announceContext?(e.push([Wi(t),"Context",t.announceContext]),r.push(t.announceContext)):e.push([Wi(t),"No Context",""]),e),i),qi.debug&&console.table(i),r.length?qi.speak(r.reduce((e,t)=>e.concat(t),[])):void 0}qi.onFocusChange([])}}var qi={debug:!1,enabled:!0,lang:"en-US",aria:!1,cancel:function(){Hi&&Hi.cancel()},clearPrevFocus:function(e=0){Gi=Gi.slice(0,e),Vi()},speak:function(e,{append:t=!1,notification:n=!1}={}){var r;qi.onFocusChange&&qi.enabled&&(t&&Hi&&Hi.active?Hi.append(e):(qi.cancel(),function(e,t,n,r){if(!zi)Hi=Fi(e,t,n,r)}(e,qi.aria,qi.lang,qi.voice)),n&&(zi=!0,null===(r=Hi)||void 0===r||r.series.finally(()=>{zi=!1,qi.refresh()}).catch(console.error)));return Hi},refresh:function(e=0){qi.clearPrevFocus(e),qi.onFocusChange&&qi.onFocusChange(Jn(()=>Ci()))},setupTimers:function({focusDebounce:e=400,focusChangeTimeout:t=3e5}={}){qi.onFocusChange=Xi(Ki,e),Vi=Xi(()=>{Gi=[]},t)}},Yi=!1;function $i(e){var t=e.replace(/^.*?#/,"");if(!t.startsWith("/")){var r=n(window.location.hash.split("#",2),2)[1];return`${void 0===r?"/":r}#${t}`}return t}function Ji(e){var n=()=>window.location.hash.slice(1),r=Zr();return function(e){var t=!1,n=e=>"string"==typeof e?{value:e}:e,r=function([e,t],n,r){return[e,r?e=>t(r(e)):t]}(Wn(n(e.get()),{equals:(e,t)=>e.value===t.value&&e.state===t.state}),0,n=>(!t&&e.set(n),In.registry&&!In.done&&(In.done=!0),n));return e.init&&Zn(e.init((i=e.get())=>{t=!0,r[1](n(i)),t=!1})),Ti({signal:r,create:e.create,utils:e.utils})}({get:n,set({value:e,replace:n,state:r}){n?window.history.replaceState(function(e){return t(t({},e),{},{_depth:window.history.state&&window.history.state._depth})}(r),"","#"+e):window.history.pushState(r,"","#"+e),ei()},init:e=>{return t=window,i="hashchange",a=function(e,t){var n=!1;return()=>{var r=Jr;ei();var i=null==r?null:Jr-r;n?n=!1:i&&t(i)?(n=!0,window.history.go(-i)):e()}}(e,e=>!r.confirm(e&&e<0?e:n())),t.addEventListener(i,a),()=>t.removeEventListener(i,a);var t,i,a},utils:{go:e=>window.history.go(e),renderPath:e=>`#${e}`,parsePath:$i,beforeLeave:r,queryWrapper:e.forceProxy||!Qi?t=>Zi(t,e.queryParams):void 0,paramsWrapper:e.forceProxy||!Qi?(e,t)=>Zi(e,ea(t())):void 0}})(e)}var Qi="function"==typeof Proxy;function Zi(e,t){var n=new Map,r=er(),i={};return(t||Object.keys(e())).forEach(t=>{Object.defineProperty(i,t,{get:()=>{return i=t,n.has(i)||tr(r,()=>n.set(i,Yn(()=>e()[i]))),n.get(i)();var i},enumerable:!0,configurable:!0})}),i}var ea=e=>{var t=[];return e.forEach(e=>{e.routes.forEach(e=>{if(e.pattern){var n=e.pattern.match(/:(\w+)/g);n&&n.forEach(e=>{var n=e.slice(1);t.includes(n)||t.push(n)})}})}),t},ta=e=>{fi().navigatorFactory();var t,n=(Yi||(Yi=!0,qi.setupTimers(t),qn(Qn(Ci,qi.onFocusChange,{defer:!0}))),qi);return n.debug=!1,n.enabled=!1,zr(Qr,{ref(e){var t=window.APP;"function"==typeof t?t(e):window.APP=e},onAnnouncer:()=>n.enabled=!n.enabled,get children(){return e.children}})},na=[{type:"msdf",fontFamily:"Inter",descriptors:{weight:400},atlasDataUrl:"fonts/Inter_18pt-Regular.msdf.json",atlasUrl:"fonts/Inter_18pt-Regular.msdf.png"},{type:"msdf",fontFamily:"Inter",descriptors:{weight:600},atlasDataUrl:"fonts/Inter_18pt-SemiBold.msdf.json",atlasUrl:"fonts/Inter_18pt-SemiBold.msdf.png"},{type:"msdf",fontFamily:"Inter",descriptors:{weight:700},atlasDataUrl:"fonts/Inter_18pt-Bold.msdf.json",atlasUrl:"fonts/Inter_18pt-Bold.msdf.png"},{type:"msdf",fontFamily:"Roboto",descriptors:{weight:700},atlasDataUrl:"fonts/Roboto-Bold.msdf.json",atlasUrl:"fonts/Roboto-Bold.msdf.png"},{type:"msdf",fontFamily:"Roboto",descriptors:{weight:400},atlasDataUrl:"fonts/Roboto-Regular.msdf.json",atlasUrl:"fonts/Roboto-Regular.msdf.png"},{type:"msdf",fontFamily:"Arial",descriptors:{weight:500},atlasDataUrl:"fonts/Roboto-Regular.msdf.json",atlasUrl:"fonts/Roboto-Regular.msdf.png"}],ra="object"==typeof global&&global&&global.Object===Object&&global,ia="object"==typeof self&&self&&self.Object===Object&&self,aa=ra||ia||Function("return this")(),oa=aa.Symbol,sa=Object.prototype,ua=sa.hasOwnProperty,la=sa.toString,da=oa?oa.toStringTag:void 0;var ca=Object.prototype.toString;var ha=oa?oa.toStringTag:void 0;function pa(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ha&&ha in Object(e)?function(e){var t=ua.call(e,da),n=e[da];try{e[da]=void 0;var r=!0}catch(a){}var i=la.call(e);return r&&(t?e[da]=n:delete e[da]),i}(e):function(e){return ca.call(e)}(e)}function fa(e){return null!=e&&"object"==typeof e}var ga=Array.isArray;function ma(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function va(e){return e}function ya(e){if(!ma(e))return!1;var t=pa(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var ba,xa=aa["__core-js_shared__"],Ta=(ba=/[^.]+$/.exec(xa&&xa.keys&&xa.keys.IE_PROTO||""))?"Symbol(src)_1."+ba:"";var wa=Function.prototype.toString;var Sa=/^\[object .+?Constructor\]$/,Aa=Function.prototype,Ea=Object.prototype,ka=Aa.toString,Ia=Ea.hasOwnProperty,Ca=RegExp("^"+ka.call(Ia).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ma(e){return!(!ma(e)||(t=e,Ta&&Ta in t))&&(ya(e)?Ca:Sa).test(function(e){if(null!=e){try{return wa.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e));var t}function Ra(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ma(n)?n:void 0}var _a=Object.create,Pa=function(){function e(){}return function(t){if(!ma(t))return{};if(_a)return _a(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Da=Date.now;var La,Na,Oa,Ua=function(){try{var e=Ra(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Ba=Ua?function(e,t){return Ua(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:va,ja=(La=Ba,Na=0,Oa=0,function(){var e=Da(),t=16-(e-Oa);if(Oa=e,t>0){if(++Na>=800)return arguments[0]}else Na=0;return La.apply(void 0,arguments)}),Fa=/^(?:0|[1-9]\d*)$/;function Va(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Fa.test(e))&&e>-1&&e%1==0&&e<t}function Ha(e,t,n){"__proto__"==t&&Ua?Ua(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Ga(e,t){return e===t||e!=e&&t!=t}var za=Object.prototype.hasOwnProperty;function Xa(e,t,n){var r=e[t];za.call(e,t)&&Ga(r,n)&&(void 0!==n||t in e)||Ha(e,t,n)}var Wa=Math.max;function Ka(e,t){return ja(function(e,t,n){return t=Wa(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Wa(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,t,va),e+"")}function qa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ya(e){return null!=e&&qa(e.length)&&!ya(e)}var $a=Object.prototype;function Ja(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||$a)}function Qa(e){return fa(e)&&"[object Arguments]"==pa(e)}var Za=Object.prototype,eo=Za.hasOwnProperty,to=Za.propertyIsEnumerable,no=Qa(function(){return arguments}())?Qa:function(e){return fa(e)&&eo.call(e,"callee")&&!to.call(e,"callee")};var ro="object"==typeof e&&e&&!e.nodeType&&e,io=ro&&"object"==typeof i&&i&&!i.nodeType&&i,ao=io&&io.exports===ro?aa.Buffer:void 0,oo=(ao?ao.isBuffer:void 0)||function(){return!1},so={};so["[object Float32Array]"]=so["[object Float64Array]"]=so["[object Int8Array]"]=so["[object Int16Array]"]=so["[object Int32Array]"]=so["[object Uint8Array]"]=so["[object Uint8ClampedArray]"]=so["[object Uint16Array]"]=so["[object Uint32Array]"]=!0,so["[object Arguments]"]=so["[object Array]"]=so["[object ArrayBuffer]"]=so["[object Boolean]"]=so["[object DataView]"]=so["[object Date]"]=so["[object Error]"]=so["[object Function]"]=so["[object Map]"]=so["[object Number]"]=so["[object Object]"]=so["[object RegExp]"]=so["[object Set]"]=so["[object String]"]=so["[object WeakMap]"]=!1;var uo="object"==typeof e&&e&&!e.nodeType&&e,lo=uo&&"object"==typeof i&&i&&!i.nodeType&&i,co=lo&&lo.exports===uo&&ra.process,ho=function(){try{var e=lo&&lo.require&&lo.require("util").types;return e||co&&co.binding&&co.binding("util")}catch(t){}}(),po=ho&&ho.isTypedArray,fo=po?function(e){return function(t){return e(t)}}(po):function(e){return fa(e)&&qa(e.length)&&!!so[pa(e)]};function go(e,t){var n=ga(e),r=!n&&no(e),i=!n&&!r&&oo(e),a=!n&&!r&&!i&&fo(e),o=n||r||i||a,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var l in e)o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Va(l,u))||s.push(l);return s}var mo=Object.prototype.hasOwnProperty;function vo(e){if(!ma(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ja(e),n=[];for(var r in e)("constructor"!=r||!t&&mo.call(e,r))&&n.push(r);return n}function yo(e){return Ya(e)?go(e):vo(e)}var bo=Ra(Object,"create");var xo=Object.prototype.hasOwnProperty;var To=Object.prototype.hasOwnProperty;function wo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function So(e,t){for(var n=e.length;n--;)if(Ga(e[n][0],t))return n;return-1}wo.prototype.clear=function(){this.__data__=bo?bo(null):{},this.size=0},wo.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},wo.prototype.get=function(e){var t=this.__data__;if(bo){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return xo.call(t,e)?t[e]:void 0},wo.prototype.has=function(e){var t=this.__data__;return bo?void 0!==t[e]:To.call(t,e)},wo.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=bo&&void 0===t?"__lodash_hash_undefined__":t,this};var Ao=Array.prototype.splice;function Eo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Eo.prototype.clear=function(){this.__data__=[],this.size=0},Eo.prototype.delete=function(e){var t=this.__data__,n=So(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ao.call(t,n,1),--this.size,!0)},Eo.prototype.get=function(e){var t=this.__data__,n=So(t,e);return n<0?void 0:t[n][1]},Eo.prototype.has=function(e){return So(this.__data__,e)>-1},Eo.prototype.set=function(e,t){var n=this.__data__,r=So(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var ko=Ra(aa,"Map");function Io(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Co(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Co.prototype.clear=function(){this.size=0,this.__data__={hash:new wo,map:new(ko||Eo),string:new wo}},Co.prototype.delete=function(e){var t=Io(this,e).delete(e);return this.size-=t?1:0,t},Co.prototype.get=function(e){return Io(this,e).get(e)},Co.prototype.has=function(e){return Io(this,e).has(e)},Co.prototype.set=function(e,t){var n=Io(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var Mo=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),Ro=Function.prototype,_o=Object.prototype,Po=Ro.toString,Do=_o.hasOwnProperty,Lo=Po.call(Object);function No(e){var t=this.__data__=new Eo(e);this.size=t.size}No.prototype.clear=function(){this.__data__=new Eo,this.size=0},No.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},No.prototype.get=function(e){return this.__data__.get(e)},No.prototype.has=function(e){return this.__data__.has(e)},No.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Eo){var r=n.__data__;if(!ko||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Co(r)}return n.set(e,t),this.size=n.size,this};var Oo="object"==typeof e&&e&&!e.nodeType&&e,Uo=Oo&&"object"==typeof i&&i&&!i.nodeType&&i,Bo=Uo&&Uo.exports===Oo?aa.Buffer:void 0;Bo&&Bo.allocUnsafe;var jo=aa.Uint8Array;function Fo(e,t){var n,r,i=(n=e.buffer,r=new n.constructor(n.byteLength),new jo(r).set(new jo(n)),r);return new e.constructor(i,e.byteOffset,e.length)}var Vo=function(e,t,n){for(var r=-1,i=Object(e),a=n(e),o=a.length;o--;){var s=a[++r];if(!1===t(i[s],s,i))break}return e};function Ho(e,t,n){(void 0!==n&&!Ga(e[t],n)||void 0===n&&!(t in e))&&Ha(e,t,n)}function Go(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function zo(e){return function(e,t,n){var r=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],s=void 0;void 0===s&&(s=e[o]),r?Ha(n,o,s):Xa(n,o,s)}return n}(e,yo(e))}function Xo(e,t,n,r,i,a,o){var s=Go(e,n),u=Go(t,n),l=o.get(u);if(l)Ho(e,n,l);else{var d,c=a?a(s,u,n+"",e,t,o):void 0,h=void 0===c;if(h){var p=ga(u),f=!p&&oo(u),g=!p&&!f&&fo(u);c=u,p||f||g?ga(s)?c=s:fa(d=s)&&Ya(d)?c=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(s):f?(h=!1,c=u.slice()):g?(h=!1,c=Fo(u)):c=[]:function(e){if(!fa(e)||"[object Object]"!=pa(e))return!1;var t=Mo(e);if(null===t)return!0;var n=Do.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Po.call(n)==Lo}(u)||no(u)?(c=s,no(s)?c=zo(s):ma(s)&&!ya(s)||(c=function(e){return"function"!=typeof e.constructor||Ja(e)?{}:Pa(Mo(e))}(u))):h=!1}h&&(o.set(u,c),i(c,u,r,a,o),o.delete(u)),Ho(e,n,c)}}function Wo(e,t,n,r,i){e!==t&&Vo(t,function(a,o){if(i||(i=new No),ma(a))Xo(e,t,o,n,Wo,r,i);else{var s=r?r(Go(e,o),a,o+"",e,t,i):void 0;void 0===s&&(s=a),Ho(e,o,s)}},yo)}var Ko,qo=(Ko=function(e,t,n){Wo(e,t,n)},Ka(function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,a=r>2?t[2]:void 0;for(i=Ko.length>3&&"function"==typeof i?(r--,i):void 0,a&&function(e,t,n){if(!ma(n))return!1;var r=typeof t;return!!("number"==r?Ya(n)&&Va(t,n.length):"string"==r&&t in n)&&Ga(n[t],e)}(t[0],t[1],a)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var o=t[n];o&&Ko(e,o,n,i)}return e}));class Yo{constructor(e,t=0){s(this,"iterator",void 0),s(this,"peekBuffer",[]),s(this,"_lastIndex",void 0),this.iterator=e,this.iterator=e,this._lastIndex=t-1,this.peekBuffer=[]}next(){var e=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return e.done?this._lastIndex=-1:this._lastIndex++,e}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];var e=this.iterator.next();return this.peekBuffer.push(e),e}get lastIndex(){return this._lastIndex}}function $o(e,t=0){var n,i;return r().w(function(r){for(;;)switch(r.n){case 0:n=t;case 1:if(!(n<e.length)){r.n=4;break}if(void 0!==(i=e.codePointAt(n))){r.n=2;break}throw new Error("Invalid Unicode code point");case 2:return r.n=3,i;case 3:n+=i<=65535?1:2,r.n=1;break;case 4:return r.a(2)}},a)}function Jo(e,t,n,r,i,a,o,s,l,d,c,h,p,f,g,m,v,y,b){g.loaded,g.data,g.shaper;var x=s/g.data.info.size,T=l/x,w=a/x,S=d/x,A=p[e],E=(null==A?void 0:A.codepointIndex)||0,k=(null==A?void 0:A.maxX)||0,I=(null==A?void 0:A.maxY)||0,C=t,M=n,R=0,_={codepointIndex:-1,bufferOffset:-1,xStart:-1},P=g.shaper,D={letterSpacing:S};r.endsWith(" ")&&(r+=" ");for(var L,N=P.shapeText(D,new Yo($o(r,E),E)),O=-1,U=[],B=o/x,j=function(e,t,n){var r,i=0,a=u(n.shapeText(t,new Yo($o(e,0),0)));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.mapped&&8203!==o.codepoint&&(i+=o.xAdvance)}}catch(s){a.e(s)}finally{a.f()}return i}(y,D,P),F=!0;F;){for(var V=(0===b||e+1<b)&&("both"!==h||v||M+T+g.maxCharHeight<=B),H=V?w:w-j,G=0,z=M+g.maxCharHeight>=f.y1,X=M<=f.y2,W=z&&X;(L=N.next())&&!L.done;){var K=L.value;if(e===p.length)p.push({codepointIndex:K.cluster,maxY:I,maxX:k});else if(e>p.length)throw new Error("Unexpected lineCache length");if(32===K.codepoint||10===K.codepoint||8203===K.codepoint?-1!==_.codepointIndex&&(_.codepointIndex=-1,G=C):-1===_.codepointIndex&&(_.codepointIndex=K.cluster,_.bufferOffset=R,_.xStart=G),K.mapped){var q=C+K.xOffset+K.width;if("none"!==h&&q>=H&&-1!==_.codepointIndex&&_.xStart>0){if(V){N=P.shapeText(D,new Yo($o(r,_.codepointIndex),_.codepointIndex)),R=_.bufferOffset;break}N=P.shapeText(D,new Yo($o(y,0),0)),C=_.xStart,R=_.bufferOffset,h="none"}else{var Y=C+K.xOffset,$=M+K.yOffset;if(W){-1===O&&(O=R);var J=g.getAtlasEntry(K.glyphId),Q=J.x/g.data.common.scaleW,Z=J.y/g.data.common.scaleH,ee=J.width/g.data.common.scaleW,te=J.height/g.data.common.scaleH;c[R++]=Y,c[R++]=$,c[R++]=Q,c[R++]=Z,c[R++]=Y+K.width,c[R++]=$,c[R++]=Q+ee,c[R++]=Z,c[R++]=Y,c[R++]=$+K.height,c[R++]=Q,c[R++]=Z+te,c[R++]=Y+K.width,c[R++]=$+K.height,c[R++]=Q+ee,c[R++]=Z+te}I=Math.max(I,$+K.height),k=Math.max(k,Y+K.width),C+=K.xAdvance}}else if(10===K.codepoint){if(V)break;N=P.shapeText(D,new Yo($o(y,0),0)),h="none"}}-1!==O&&(U.push({bufferStart:O,bufferEnd:R}),O=-1),C=0,M+=T,e++,_.codepointIndex=-1,G=0,!m&&"both"===h&&M>f.y2||L&&L.done?F=!1:V||(F=!1)}if("center"===i)for(var ne="none"===h?k:w,re=0;re<U.length;re++)for(var ie=U[re],ae=(ne-(c[ie.bufferEnd-4]-c[ie.bufferStart]))/2,oe=ie.bufferStart;oe<ie.bufferEnd;oe+=4)c[oe]+=ae;else if("right"===i)for(var se="none"===h?k:w,ue=0;ue<U.length;ue++)for(var le=U[ue],de=se-(le.bufferEnd===le.bufferStart?0:c[le.bufferEnd-4]-c[le.bufferStart]),ce=le.bufferStart;ce<le.bufferEnd;ce+=4)c[ce]+=de;return{bufferNumFloats:R,bufferNumQuads:R/16,layoutNumCharacters:L.done?r.length-E:L.value.cluster-E+1,fullyProcessed:!!L.done,maxX:k,maxY:I,numLines:p.length}}function Qo(e,t,n,r,i,a,o,s){var u,l,d,c=e.screen,h=e.sdf;if((d=o).x1<d.x2&&d.y1<d.y2){var p=o.x1-t,f=p+(o.x2-o.x1),g=o.y1-n+r,m=(u=g-a,l=i||1,Math.floor(u/l)*l),v=function(e,t){return Math.ceil(e/t)*t}(g+(o.y2-o.y1)+a,i||1);c.x1=p,c.y1=m,c.x2=f,c.y2=v,h.x1=p/s,h.y1=m/s,h.x2=f/s,h.y2=v/s,e.numLines=Math.ceil((v-m)/i),e.firstLineIdx=i?Math.floor(m/i):0}else c.x1=0,c.y1=0,c.x2=0,c.y2=0,h.x1=0,h.y1=0,h.x2=0,h.y2=0,e.numLines=0,e.firstLineIdx=0;e.valid=!0}var Zo={x:0,y:0,width:0,height:0};var es,ts,ns="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},rs={};es||(es=1,ts=rs,function(){var e="undefined"!=typeof window?window:ns,t={};for(var n in function(e,t,r){var i,a,o="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},s="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},u=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var r=0;r<n.length;++r){var i=n[r];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function l(e,t){if(t)e:{var n=u;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&s(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)a=Object.setPrototypeOf;else{var d;e:{var c={};try{c.__proto__={a:!0},d=c.a;break e}catch(fA){}d=!1}a=d?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var h=a;function p(e,t){if(e.prototype=o(t.prototype),e.prototype.constructor=e,h)h(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.Gm=t.prototype}function f(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function g(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:f(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function m(e){if(!(e instanceof Array)){e=g(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}function v(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.B=this.i=null}function y(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function b(e,t){e.i={$h:t,pi:!0},e.g=e.m||e.j}function x(e,t,n){return e.g=n,{value:t}}function T(e){e.g=0}function w(e,t,n){e.m=t,null!=n&&(e.j=n)}function S(e,t){e.m=0,e.j=t||0}function A(e,t,n){e.g=t,e.m=n||0}function E(e,t){return e.m=t||0,t=e.i.$h,e.i=null,t}function k(e){e.B=[e.i],e.m=0,e.j=0}function I(e,t){var n=e.B.splice(0)[0];(n=e.i=e.i||n)?n.pi?e.g=e.m||e.j:null!=n.A&&e.j<n.A?(e.g=n.A,e.i=null):e.g=e.j:e.g=t}function C(e){this.g=new v,this.h=e}function M(e,t,n,r){try{var i=t.call(e.g.l,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.o=!1,i;var a=i.value}catch(o){return e.g.l=null,b(e.g,o),R(e)}return e.g.l=null,r.call(e.g,a),R(e)}function R(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,b(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.pi)throw t.$h;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return y(e.g),e.g.l?t=M(e,e.g.l.next,t,e.g.u):(e.g.u(t),t=R(e)),t},this.throw=function(t){return y(e.g),e.g.l?t=M(e,e.g.l.throw,t,e.g.u):(b(e.g,t),t=R(e)),t},this.return=function(t){return function(e,t){y(e.g);var n=e.g.l;return n?M(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),R(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function P(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(r,i){!function e(a){a.done?r(a.value):Promise.resolve(a.value).then(t,n).then(e,i)}(e.next())})}(new _(new C(e)))}function D(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function L(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function O(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var a=e[i];if(t.call(n,a,i,e))return{li:i,v:a}}return{li:-1,v:void 0}}function U(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}function B(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}v.prototype.u=function(e){this.h=e},v.prototype.return=function(e){this.i={return:e},this.g=this.j},v.prototype.A=function(e){this.g=e},l("Symbol",function(e){function t(e,t){this.g=e,s(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}}),l("Symbol.iterator",function(e){return e||(e=Symbol("Symbol.iterator"),s(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return L(f(this))}}),e)}),l("Promise",function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function r(){this.g=null}function i(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;r.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i(function(){t.l()})}this.g.push(e)};var a=u.setTimeout;r.prototype.i=function(e){a(e,0)},r.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.j(r)}}}this.g=null},r.prototype.j=function(e){this.i(function(){throw e})},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.G),reject:e(this.l)}},t.prototype.G=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.I(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.F(e):this.m(e)}},t.prototype.F=function(e){var t=void 0;try{t=e.then}catch(n){return void this.l(n)}"function"==typeof t?this.J(t,e):this.m(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.m=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.H(),this.B()},t.prototype.H=function(){var e=this;a(function(){if(e.C()){var t=u.console;void 0!==t&&t.error(e.i)}},1)},t.prototype.C=function(){if(this.o)return!1;var e=u.CustomEvent,t=u.Event,n=u.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=u.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.B=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)o.h(this.g[e]);this.g=null}};var o=new r;return t.prototype.I=function(e){var t=this.j();e.Se(t.resolve,t.reject)},t.prototype.J=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(n){a(n)}}:t}var i,a,o=new t(function(e,t){i=e,a=t});return this.Se(r(e,i),r(n,a)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Se=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?o.h(n):this.g.push(n),this.o=!0},t.resolve=i,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var r=g(e),a=r.next();!a.done;a=r.next())i(a.value).Se(t,n)})},t.all=function(e){var n=g(e),r=n.next();return r.done?i([]):new t(function(e,t){function a(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,i(r.value).Se(a(o.length-1),t),r=n.next()}while(!r.done)})},t}),l("WeakMap",function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=g(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function i(e){if(!N(e,o)){var t=new n;s(e,o,{value:t})}}function a(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&i(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(i){return!1}}())return e;var o="$jscomp_hidden_"+Math.random();a("freeze"),a("preventExtensions"),a("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(i(e),!N(e,o))throw Error("WeakMap key fail: "+e);return e[o][this.g]=t,this},t.prototype.get=function(e){return r(e)&&N(e,o)?e[o][this.g]:void 0},t.prototype.has=function(e){return r(e)&&N(e,o)&&N(e[o],this.g)},t.prototype.delete=function(e){return!!(r(e)&&N(e,o)&&N(e[o],this.g))&&delete e[o][this.g]},t}),l("Map",function(e){function t(){var e={};return e.xc=e.next=e.head=e}function n(e,t){var n=e[1];return L(function(){if(n){for(;n.head!=e[1];)n=n.xc;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?a.has(t)?n=a.get(t):(n=""+ ++o,a.set(t,n)):n="p_"+t;var r=e[0][n];if(r&&N(e[0],n))for(e=0;e<r.length;e++){var i=r[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:r,index:e,entry:i}}return{id:n,list:r,index:-1,entry:void 0}}function i(e){if(this[0]={},this[1]=t(),this.size=0,e){e=g(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(g([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=r.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!r.next().done)}catch(a){return!1}}())return e;var a=new WeakMap;i.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this[0][n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this[1],xc:this[1].xc,head:this[1],key:e,value:t},n.list.push(n.entry),this[1].xc.next=n.entry,this[1].xc=n.entry,this.size++),this},i.prototype.delete=function(e){return!(!(e=r(this,e)).entry||!e.list||(e.list.splice(e.index,1),e.list.length||delete this[0][e.id],e.entry.xc.next=e.entry.next,e.entry.next.xc=e.entry.xc,e.entry.head=null,this.size--,0))},i.prototype.clear=function(){this[0]={},this[1]=this[1].xc=t(),this.size=0},i.prototype.has=function(e){return!!r(this,e).entry},i.prototype.get=function(e){return(e=r(this,e).entry)&&e.value},i.prototype.entries=function(){return n(this,function(e){return[e.key,e.value]})},i.prototype.keys=function(){return n(this,function(e){return e.key})},i.prototype.values=function(){return n(this,function(e){return e.value})},i.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var o=0;return i}),l("Set",function(e){function t(e){if(this.g=new Map,e){e=g(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(g([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&!(i=r.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&r.next().done}catch(a){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach(function(r){return e.call(t,r,r,n)})},t)}),l("Array.prototype.findIndex",function(e){return e||function(e,t){return O(this,e,t).li}}),l("Array.prototype.values",function(e){return e||function(){return U(this,function(e,t){return t})}}),l("Array.from",function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var a=0;!(i=e.next()).done;)r.push(t.call(n,i.value,a++))}else for(i=e.length,a=0;a<i;a++)r.push(t.call(n,e[a],a));return r}}),l("Array.prototype.keys",function(e){return e||function(){return U(this,function(e){return e})}}),l("String.prototype.startsWith",function(e){return e||function(e,t){var n=B(this,e,"startsWith"),r=n.length,i=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var a=0;a<i&&t<r;)if(n[t++]!=e[a++])return!1;return a>=i}}),l("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),l("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for((t=t||0)<0&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}}),l("String.prototype.includes",function(e){return e||function(e,t){return-1!==B(this,e,"includes").indexOf(e,t||0)}}),l("String.fromCodePoint",function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var r=Number(arguments[n]);if(r<0||r>1114111||r!==Math.floor(r))throw new RangeError("invalid_code_point "+r);r<=65535?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode(r>>>10&1023|55296),t+=String.fromCharCode(1023&r|56320))}return t}}),l("WeakSet",function(e){function t(e){if(this.g=new WeakMap,e){e=g(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([t]);return!(!r.has(t)||r.has(n))&&(r.delete(t),r.add(n),!r.has(t)&&r.has(n))}catch(i){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)}),l("Array.prototype.find",function(e){return e||function(e,t){return O(this,e,t).v}}),l("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)N(e,t)&&n.push([t,e[t]]);return n}});var j="function"==typeof Object.assign?Object.assign:function(e,t){if(null==e)throw new TypeError("No nullish arg");e=Object(e);for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)N(r,i)&&(e[i]=r[i])}return e};l("Object.assign",function(e){return e||j}),l("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}}),l("Array.prototype.entries",function(e){return e||function(){return U(this,function(e,t){return[e,t]})}}),l("Number.isNaN",function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}}),l("String.prototype.repeat",function(e){return e||function(e){var t=B(this,null,"repeat");if(e<0||e>1342177279)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}}),l("Number.EPSILON",function(){return 2220446049250313e-31}),l("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),l("Number.isFinite",function(e){return e||function(e){return"number"==typeof e&&!isNaN(e)&&e!==1/0&&e!==-1/0}}),l("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)N(e,t)&&n.push(e[t]);return n}}),l("Math.log2",function(e){return e||function(e){return Math.log(e)/Math.LN2}}),l("String.prototype.endsWith",function(e){return e||function(e,t){var n=B(this,e,"endsWith");void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var r=e.length;r>0&&t>0;)if(n[--t]!=e[--r])return!1;return r<=0}}),l("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||e===1/0||e===-1/0||0===e)return e;var t=Math.floor(Math.abs(e));return e<0?-t:t}});var F=this||self;function V(e,t){e=e.split(".");var n,r=F;e[0]in r||void 0===r.execScript||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function H(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function G(e){return e.h/(1-Math.pow(e.g,e.i))}function z(){this.h=new H(2),this.j=new H(5),this.g=0,this.i=128e3,this.l=16e3}function X(){}function W(){}function K(){}function q(e){var t=D.apply(1,arguments);$.has(e)||($.add(e),K.apply(X,m(t)))}function Y(){}H.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},z.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},z.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},z.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(G(this.h),G(this.j))};var $=new Set;function J(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Q(e,t){(t=e.indexOf(t))>-1&&e.splice(t,1)}function Z(e,t,n){if(n||(n=J),e.length!=t.length)return!1;t=t.slice();for(var r=(e=g(e)).next(),i={};!r.done;i={si:void 0},r=e.next()){if(i.si=r.value,-1==(r=t.findIndex(function(e){return function(t){return n(e.si,t)}}(i))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function ee(e,t,n){if(e===t)return!0;if(!e||!t)return e==t;if(n||(n=J),e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function te(){this.g=new Map}function ne(){this.g=new te}function re(e,t,n,r){this.target=e,this.type=t,this.listener=n,this.g=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),function(e){var t=ie;if(null==t){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r),r=function(){},e.addEventListener("test",r,n),e.removeEventListener("test",r,n)}catch(i){t=!1}ie=t}return t||!1}(e)?t:t.capture||!1}(e,r),this.target.addEventListener(t,n,this.g)}e.console&&((new Map).set(1,function(){return console.error.apply(console,m(D.apply(0,arguments)))}).set(2,function(){return console.warn.apply(console,m(D.apply(0,arguments)))}).set(3,function(){return console.info.apply(console,m(D.apply(0,arguments)))}).set(4,function(){return console.log.apply(console,m(D.apply(0,arguments)))}).set(5,function(){return console.debug.apply(console,m(D.apply(0,arguments)))}).set(6,function(){return console.debug.apply(console,m(D.apply(0,arguments)))}),K=function(){return console.warn.apply(console,m(D.apply(0,arguments)))},W=function(){console.error.apply(console,m(D.apply(0,arguments)))}),(i=te.prototype).push=function(e,t){this.g.has(e)?this.g.get(e).push(t):this.g.set(e,[t])},i.get=function(e){return this.g.has(e)?this.g.get(e).slice():null},i.remove=function(e,t){if(this.g.has(e)){var n=this.g.get(e).filter(function(e){return e!=t});this.g.set(e,n),n.length||this.g.delete(e)}},i.forEach=function(e){this.g.forEach(function(t,n){e(n,t)})},i.size=function(){return this.g.size},i.keys=function(){return Array.from(this.g.keys())},(i=ne.prototype).release=function(){this.Qa(),this.g=null},i.D=function(e,t,n,r){this.g&&(e=new re(e,t,n,r),this.g.push(t,e))},i.Aa=function(e,t,n,r){var i=this;this.D(e,t,function r(a){i.Ma(e,t,r),n(a)},r)},i.Ma=function(e,t,n){if(this.g)for(var r=this.g.get(t)||[],i=(r=g(r)).next();!i.done;i=r.next())(i=i.value).target!=e||n!=i.listener&&n||(i.Ma(),this.g.remove(t,i))},i.Qa=function(){if(this.g){for(var e=[],t=g(this.g.g.values()),n=t.next();!n.done;n=t.next())e.push.apply(e,m(n.value));for(t=(e=g(e)).next();!t.done;t=e.next())t.value.Ma();this.g.g.clear()}},V("shaka.util.EventManager",ne),ne.prototype.removeAll=ne.prototype.Qa,ne.prototype.unlisten=ne.prototype.Ma,ne.prototype.listenOnce=ne.prototype.Aa,ne.prototype.listen=ne.prototype.D,ne.prototype.release=ne.prototype.release,re.prototype.Ma=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var ie=void 0;function ae(e){this.h=e,this.g=void 0}
/*
      		 @license
      		 Shaka Player
      		 Copyright 2025 Google LLC
      		 SPDX-License-Identifier: Apache-2.0
      		*/
function oe(){return le.value()}V("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),ae.prototype.value=function(){return void 0===this.g&&(this.g=this.h()),this.g};var se=null,ue=null,le=new ae(function(){var e=void 0;return se&&(e=se()),!e&&ue&&(e=ue()),e});function de(e,t){this.g=e,this.h=t}function ce(e,t){var n=new de(5,0),r=fe,i=r.g,a=n.h-i.h;((n.g-i.g||a)>0?r.i:r.h)(r.g,n,e,t)}function he(e,t,n,r){K([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}function pe(e,t,n,r){W([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join(" "))}de.prototype.toString=function(){return"v"+this.g+"."+this.h};var fe=null,ge=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");
/*
      		 @license
      		 Copyright 2008 The Closure Library Authors
      		 SPDX-License-Identifier: Apache-2.0
      		*/
/*
      		 @license
      		 Copyright 2006 The Closure Library Authors
      		 SPDX-License-Identifier: Apache-2.0
      		*/
function me(e){var t;e instanceof me?(ve(this,e.fc),this.hd=e.hd,ye(this,e.Eb),be(this,e.Dd),this.Tb=e.Tb,xe(this,e.g.clone()),this.Rc=e.Rc):e&&(t=String(e).match(ge))?(ve(this,t[1]||"",!0),this.hd=Te(t[2]||""),ye(this,t[3]||"",!0),be(this,t[4]),this.Tb=Te(t[5]||"",!0),xe(this,t[6]||"",!0),this.Rc=Te(t[7]||"")):this.g=new Me(null)}function ve(e,t,n){e.fc=n?Te(t,!0):t,e.fc&&(e.fc=e.fc.replace(/:$/,""))}function ye(e,t,n){e.Eb=n?Te(t,!0):t}function be(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.Dd=t}else e.Dd=null}function xe(e,t,n){t instanceof Me?e.g=t:(n||(t=we(t,Ie)),e.g=new Me(t))}function Te(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function we(e,t,n){return null!=e?(e=encodeURI(e).replace(t,Se),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Se(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=me.prototype).fc="",i.hd="",i.Eb="",i.Dd=null,i.Tb="",i.Rc="",i.toString=function(){var e=[],t=this.fc;if(t&&e.push(we(t,Ae,!0),":"),t=this.Eb){e.push("//");var n=this.hd;n&&e.push(we(n,Ae,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Dd)&&e.push(":",String(t))}return(t=this.Tb)&&(this.Eb&&"/"!=t.charAt(0)&&e.push("/"),e.push(we(t,"/"==t.charAt(0)?ke:Ee,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.Rc)&&e.push("#",we(t,Ce)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.fc&&(t=new me);var n=!!e.fc;n?ve(t,e.fc):n=!!e.hd,n?t.hd=e.hd:n=!!e.Eb,n?ye(t,e.Eb):n=null!=e.Dd;var r=e.Tb;if(n)be(t,e.Dd);else if(n=!!e.Tb){if("/"!=r.charAt(0))if(this.Eb&&!this.Tb)r="/"+r;else{var i=t.Tb.lastIndexOf("/");-1!=i&&(r=t.Tb.substr(0,i+1)+r)}if(".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var a=[],o=0;o<r.length;){var s=r[o++];"."==s?i&&o==r.length&&a.push(""):".."==s?((a.length>1||1==a.length&&""!=a[0])&&a.pop(),i&&o==r.length&&a.push("")):(a.push(s),i=!0)}r=a.join("/")}}return n?t.Tb=r:n=""!==e.g.toString(),n?xe(t,e.g.clone()):n=!!e.Rc,n&&(t.Rc=e.Rc),t},i.clone=function(){return new me(this)};var Ae=/[#\/\?@]/g,Ee=/[#\?:]/g,ke=/[#\?]/g,Ie=/[#\?@]/g,Ce=/#/g;function Me(e){this.g=e||null}function Re(e){if(!e.fb&&(e.fb=new Map,e.Ud=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(r>=0){var a=t[n].substring(0,r);i=t[n].substring(r+1)}else a=t[n];a=decodeURIComponent(a),i=i||"",e.add(a,decodeURIComponent(i))}}function _e(e){return Re(e),e.Ud}function Pe(){}function De(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if((ArrayBuffer.isView(e)?e.buffer:e)==(ArrayBuffer.isView(t)?t.buffer:t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Ne(e);t=Ne(t);for(var r=0;r<e.byteLength;r++)if(n[r]!=t[r])return!1;return!0}function Le(e){return ArrayBuffer.isView(e)?0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e}function Ne(e,t,n){return Be(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint8Array)}function Oe(e,t,n){return Be(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint16Array)}function Ue(e,t,n){return Be(e,void 0===t?0:t,n=void 0===n?1/0:n,DataView)}function Be(e,t,n,r){var i=ArrayBuffer.isView(e)?e.buffer:e,a=1;"BYTES_PER_ELEMENT"in r&&(a=r.BYTES_PER_ELEMENT);var o=((e.byteOffset||0)+e.byteLength)/a;return new r(i,e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/a,o))),Math.floor(Math.min(e+Math.max(n,0),o))-e)}function je(e,t){if(e===t||!e.length||!t.length)return!0;for(var n=(e=g(e)).next();!n.done;n=e.next()){if(Ge(n=n.value))return!0;for(var r=g(t),i=r.next();!i.done;i=r.next())if(i=i.value,n.keySystem===i.keySystem||Ge(i))return!0}return!1}function Fe(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],r=(e=g(e)).next();!r.done;r=e.next()){r=r.value;for(var i=g(t),a=i.next();!a.done;a=i.next()){if(a=a.value,r.keySystem==a.keySystem){i=new Map;for(var o=g((r.initData||[]).concat(a.initData||[])),s=o.next();!s.done;s=o.next())s=s.value,i.set(s.keyId,s);i=Array.from(i.values()),o=r.keyIds&&a.keyIds?new Set([].concat(m(r.keyIds),m(a.keyIds))):r.keyIds||a.keyIds,n.push({keySystem:r.keySystem,licenseServerUri:r.licenseServerUri||a.licenseServerUri,distinctiveIdentifierRequired:r.distinctiveIdentifierRequired||a.distinctiveIdentifierRequired,persistentStateRequired:r.persistentStateRequired||a.persistentStateRequired,videoRobustness:r.videoRobustness||a.videoRobustness,audioRobustness:r.audioRobustness||a.audioRobustness,serverCertificate:r.serverCertificate||a.serverCertificate,serverCertificateUri:r.serverCertificateUri||a.serverCertificateUri,initData:i,keyIds:o});break}Ge(r)?n.push(r):Ge(a)&&n.push(a)}}return n}function Ve(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function He(e){return!!e&&!!e.match(/^com\.apple\.fps/)}function Ge(e){return!!(e=e.licenseServerUri)&&e.startsWith("data:application/json;base64,")}function ze(e,t,n,r){return e+"#"+t+"#"+n+"#"+(r=[].concat(m(new Set(r))).sort().join("#"))}(i=Me.prototype).fb=null,i.Ud=null,i.add=function(e,t){Re(this),this.g=null;var n=this.fb.has(e)?this.fb.get(e):null;return n||this.fb.set(e,n=[]),n.push(t),this.Ud++,this},i.set=function(e,t){return Re(this),this.g=null,this.fb.has(e)?this.fb.set(e,[t]):this.add(e,t),this},i.get=function(e){return Re(this),this.fb.get(e)||[]},i.toString=function(){if(this.g)return this.g;if(!this.fb||!this.fb.size)return"";for(var e=[],t=g(this.fb.keys()),n=t.next();!n.done;n=t.next()){var r=n.value;n=encodeURIComponent(r),r=this.fb.get(r);for(var i=0;i<r.length;i++){var a=n;""!==r[i]&&(a+="="+encodeURIComponent(r[i])),e.push(a)}}return this.g=e.join("&")},i.clone=function(){var e=new Me;if(e.g=this.g,this.fb){for(var t=new Map,n=g(this.fb),r=n.next();!r.done;r=n.next()){var i=g(r.value);r=i.next().value,i=i.next().value,t.set(r,i.concat())}e.fb=t,e.Ud=this.Ud}return e},V("shaka.util.BufferUtils",Pe),Pe.toDataView=Ue,Pe.toUint16=Oe,Pe.toUint8=Ne,Pe.toArrayBuffer=Le,Pe.equal=De;var Xe=new ae(function(){return Le(new Uint8Array([0]))}),We=new Map;function Ke(e,t,n){var r=D.apply(3,arguments);this.severity=e,this.category=t,this.code=n,this.data=r,this.handled=!1,this.message="Shaka Error "+this.code;try{throw Error(this.message||"Shaka Error")}catch(i){this.stack=i.stack}}function qe(){}function Ye(t){if(!t)return"";if(239==(t=Ne(t))[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!oe().wh())return(t=(new TextDecoder).decode(t)).includes("")&&W('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",r=0;r<t.length;++r){var i=65533;if(128&t[r]?t.length>=r+2&&192==(224&t[r])&&128==(192&t[r+1])?(i=(31&t[r])<<6|63&t[r+1],r+=1):t.length>=r+3&&224==(240&t[r])&&128==(192&t[r+1])&&128==(192&t[r+2])?(i=(15&t[r])<<12|(63&t[r+1])<<6|63&t[r+2],r+=2):t.length>=r+4&&240==(241&t[r])&&128==(192&t[r+1])&&128==(192&t[r+2])&&128==(192&t[r+3])&&(i=(7&t[r])<<18|(63&t[r+1])<<12|(63&t[r+2])<<6|63&t[r+3],r+=3):i=t[r],i<=65535)n+=String.fromCharCode(i);else{var a=1023&(i-=65536);n+=String.fromCharCode(55296+(i>>10)),n+=String.fromCharCode(56320+a)}}return n}function $e(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw new Ke(2,2,2004);n=Math.floor(e.byteLength/2);var r=new Uint16Array(n);e=Ue(e);for(var i=0;i<n;i++)r[i]=e.getUint16(2*i,t);return et(r)}function Je(e){function t(e){return n.byteLength<=e||n[e]>=9&&n[e]<=126}if(!e)return"";var n=Ne(e);if(239==n[0]&&187==n[1]&&191==n[2])return Ye(n);if(254==n[0]&&255==n[1])return $e(n.subarray(2),!1);if(255==n[0]&&254==n[1])return $e(n.subarray(2),!0);if(0==n[0]&&0==n[2])return $e(e,!1);if(0==n[1]&&0==n[3])return $e(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return Ye(e);throw new Ke(2,2,2003)}function Qe(t){if(e.TextEncoder&&!oe().wh()){var n=new TextEncoder;return Le(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var r=0;r<t.length;r++)n[r]=t[r].charCodeAt(0);return Le(n)}function Ze(e,t){for(var n=new ArrayBuffer(2*e.length),r=new DataView(n),i=0;i<e.length;++i)r.setUint16(2*i,e.charCodeAt(i),t);return n}function et(e){return nt.value()(e)}function tt(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,r=RegExp(n.source);return e&&r.test(e)?e.replace(n,function(e){return"#"==e[1]?(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10))>=0&&e<=1114111?String.fromCodePoint(e):"":t[e]||"'"}):e||""}Ke.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},V("shaka.util.Error",Ke),Ke.Severity={RECOVERABLE:1,CRITICAL:2},Ke.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},Ke.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,STREAMING_NOT_ALLOWED:3024,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,CANNOT_ADD_EXTERNAL_CHAPTERS_TO_LIVE_STREAM:4055,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,QUEUE_INDEX_OUT_OF_BOUNDS:7007,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007},V("shaka.util.StringUtils",qe),qe.resetFromCharCode=function(){nt.g=void 0},qe.toUTF16=Ze,qe.toUTF8=Qe,qe.fromBytesAutoDetect=Je,qe.fromUTF16=$e,qe.fromUTF8=Ye;var nt=new ae(function(){function e(e){try{var t=new Uint8Array(e);return String.fromCharCode.apply(null,t).length>0}catch(n){return!1}}for(var t={Pc:65536};t.Pc>0;(t={Pc:t.Pc}).Pc/=2)if(e(t.Pc))return function(e){return function(t){for(var n="",r=0;r<t.length;r+=e.Pc)n+=String.fromCharCode.apply(null,t.subarray(r,r+e.Pc));return n}}(t);return null});function rt(){}function it(e){return e=et(Ne(e)),btoa(e)}function at(e,t){return t=null==t||t,e=it(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function ot(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}function st(t){for(var n=t.length/2,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e.parseInt(t.substr(2*i,2),16);return r}function ut(e){var t=Ne(e);e="";for(var n=(t=g(t)).next();!n.done;n=t.next())1==(n=(n=n.value).toString(16)).length&&(n="0"+n),e+=n;return e}function lt(){for(var e=D.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var r=n=0;r<e.length;++r){var i=e[r];ArrayBuffer.isView(i)&&1===i.BYTES_PER_ELEMENT?t.set(i,n):t.set(Ne(i),n),n+=i.byteLength}return t}function dt(e,t,n){if(n=void 0===n?"":n,0==t.length)return e;if(1==e.length&&1==t.length){var r=new me(e[0]);return t=new me(t[0]),t=r.resolve(t),n&&xe(t,n),[t.toString()]}t=t.map(function(e){return new me(e)}),r=[];for(var i=(e=g(e)).next();!i.done;i=e.next()){i=new me(i.value);for(var a=g(t),o=a.next();!o.done;o=a.next())o=i.resolve(o.value),n&&xe(o,n),r.push(o.toString())}return r}function ct(e,t,n,r){return t={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},r&&(t.keySystemUris=new Set([r])),!n&&He(e)&&t.initData.push({initDataType:"sinf",initData:new Uint8Array(0),keyId:null}),t}function ht(t,n){n=void 0===n?"cenc":n;var r=[],i=[],a=[];t.forEach(function(e,t){var n=t;22!=n.length&&(n=at(st(t),!1));var o=e;22!=o.length&&(o=at(st(e),!1)),e={kty:"oct",kid:n,k:o},r.push(e),i.push(e.kid),a.push(t)}),t=JSON.stringify({keys:r});var o=JSON.stringify({kids:i});return o=[{initData:Ne(Qe(o)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:n,licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:o,keyIds:new Set(a)}}function pt(e,t){if(1==t.length)return t[0];if(null!=(e=ft(e,t)))return e;throw new Ke(2,4,4025,t)}function ft(e,t){for(var n=bt.get(e),r=(n=g(n)).next();!r.done;r=n.next()){r=r.value;for(var i=g(t),a=i.next();!a.done;a=i.next())if(a=a.value,r.test(a.trim()))return a.trim()}return e==mt?"":null}function gt(e,t){for(var n=[],r=(e=g(e=bt.get(e))).next();!r.done;r=e.next()){r=r.value;for(var i=g(t),a=i.next();!a.done;a=i.next())a=a.value,r.test(a.trim())&&n.push(a.trim())}return n}V("shaka.util.Uint8ArrayUtils",rt),rt.concat=lt,rt.toHex=ut,rt.fromHex=st,rt.fromBase64=ot,rt.toBase64=at,rt.toStandardBase64=it;var mt="text",vt={wa:"video",aa:"audio",Na:mt,Xf:"image",ql:"application"},yt=1/15,bt=(new Map).set("audio",[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/,/^ac3$/,/^eac3$/,/^apac$/]).set("video",[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/]).set("text",[/^vtt$/,/^wvtt/,/^stpp/]);function xt(e,t,n,r){this.g=null,this.l=e,this.i=t,this.m=n,this.o=r,this.j=!1;e:{if("undefined"==typeof libDPIModule&&K("Could not find LCEVC Library dependencies on this page"),"undefined"!=typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"==typeof LcevcDil){K("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,ce("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}void 0===this.h.SupportObject?(K("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||K(this.h.SupportObject.SupportError),e=void 0!==this.h&&"undefined"!=typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function Tt(e,t,n,r){"video"!==r.type||e.o&&!r.baseOriginalId||e.g&&e.g.appendBuffer(t,"video",r.id,-n,!e.o)}function wt(e){e.g&&e.i.classList.add("shaka-hidden")}function St(e){return!(!e||"undefined"==typeof LCEVCdec)&&"lvc1"==e.codecs}function At(){}function Et(e,t){It.set(e,t)}function kt(e,t){if(t){var n=It.get(t.toLowerCase());if(n)return n}throw new Ke(2,4,4e3,e,t)}xt.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},V("shaka.lcevc.Dec",xt),xt.prototype.release=xt.prototype.release,V("shaka.media.ManifestParser",At),At.unregisterParserByMime=function(e){It.delete(e)},At.registerParserByMime=Et,At.registerParserByExtension=function(){ce("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},At.AccessibilityPurpose={Am:"visually impaired",Ll:"hard of hearing",hm:"spoken subtitles"};var It=new Map;function Ct(){}function Mt(){}function Rt(){}function _t(e){this.h=new Map,this.i=0,this.j=new Mt,(e=Dt(e.toLowerCase()))&&(this.j=e()),this.g=new Ct,(e=Nt)&&(this.g=e(),this.h.set(this.i,this.g))}function Pt(e,t){Lt.set(e,t)}function Dt(e){return Lt.get(e)}Ct.prototype.extract=function(){},Ct.prototype.decode=function(){return[]},Ct.prototype.clear=function(){},Ct.prototype.getStreams=function(){return[]},Mt.prototype.init=function(){},Mt.prototype.parse=function(){return[]},(i=Rt.prototype).init=function(){},i.zf=function(){},i.Od=function(){},i.remove=function(){},i.Yf=function(){},V("shaka.media.IClosedCaptionParser",Rt),(i=_t.prototype).init=function(e,t,n){if(t=void 0!==t&&t,-1!=(n=void 0===n?-1:n)&&this.i!=n){t=n;var r=this.h.get(t);this.h.set(this.i,this.g),r?this.g=r:((r=Nt)&&(this.g=r()),this.h.set(t,this.g))}else t||this.Od();this.j.init(e),-1!=n&&(this.i=n)},i.zf=function(e){for(var t=(e=g(e=this.j.parse(e))).next();!t.done;t=e.next()){var n=Ne((t=t.value).packet);n.length>0&&this.g.extract(n,t.pts)}return this.g.decode()},i.Od=function(){this.g.clear()},i.remove=function(e){e=void 0===e?[]:e,e=new Set(e);for(var t=g(this.h.keys()),n=t.next();!n.done;n=t.next())if(n=n.value,!e.has(n)){var r=this.h.get(n);r&&r.clear(),this.h.delete(n)}},i.Yf=function(){return this.g.getStreams()},V("shaka.media.ClosedCaptionParser",_t),_t.findDecoder=function(){return Nt},_t.unregisterDecoder=function(){Nt=null},_t.registerDecoder=function(e){Nt=e},_t.findParser=Dt,_t.unregisterParser=function(e){Lt.delete(e)},_t.registerParser=Pt;var Lt=new Map,Nt=null;function Ot(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Ut,this.scroll=Bt}V("shaka.text.CueRegion",Ot);var Ut=1;Ot.units={PX:0,PERCENTAGE:Ut,LINES:2};var Bt="";function jt(e){this.h=e||"",this.g=0}function Ft(e){Vt(e,/[ \t]+/gm)}function Vt(e,t){return t.lastIndex=e.g,t=null==(t=t.exec(e.h))?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function Ht(e){return e.g==e.h.length?null:(e=Vt(e,/[^ \t\n]*/gm))?e[0]:null}function Gt(e){if(null==(e=Vt(e,Xt)))return null;var t=Number(e[2]),n=Number(e[3]);return t>59||n>59?null:(Number(e[6])||0)/1e3+n+60*t+3600*(Number(e[1])||0)}function zt(e){return e?Gt(new jt(e)):null}Ot.scrollMode={NONE:Bt,UP:"up"};var Xt=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function Wt(){}function Kt(e){var t=new WeakSet;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||ArrayBuffer.isView(n))return n;if(t.has(n))return null;var r=Array.isArray(n);if(n.constructor!=Object&&!r)return null;t.add(n);var i,a=r?[]:{};for(i in n)a[i]=e(n[i]);return r&&(a.length=n.length),a}}(e)}function qt(e){var t,n={};for(t in e)n[t]=e[t];return n}function Yt(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var r=n.toString(),i=e[n];void 0!==i&&(i=Yt(i))&&t.push(r+":"+i)}e="["+t.join(",")+"]"}else if("function"==typeof e)e="";else if(e instanceof Object){for((n=Object.keys(e)).sort(),t=[],r=(n=g(n)).next();!r.done;r=n.next())i=r.value,r=JSON.stringify(i),void 0!==(i=e[i])&&(i=Yt(i))&&t.push(r+":"+i);e="{"+t.join(",")+"}"}else e=JSON.stringify(e);return e}
/*
      		 @license
      		 tXml
      		 Copyright 2015 Tobias Nickel
      		 SPDX-License-Identifier: MIT
      		*/
function $t(e,t){var n=void 0!==n&&n;return Jt(e=Je(e),t,n)}function Jt(e,t,n){return e=function(e,t){function n(a,o){o=void 0!==o&&o;for(var s=[];e[i];)if(60==e.charCodeAt(i)){if(47===e.charCodeAt(i+1)){o=i+2,i=e.indexOf(">",i);var u=(o=e.substring(o,i)).indexOf(a);if(-1==u){var l=a.indexOf(".");l>0&&(u=o.indexOf(a.substring(0,l)))}if(-1==u)throw a=e.substring(0,i).split("\n"),Error("Unexpected close tag\nLine: "+(a.length-1)+"\nColumn: "+(a[a.length-1].length+1)+"\nChar: "+e[i]);i+1&&(i+=1);break}if(33===e.charCodeAt(i+1)){if(45==e.charCodeAt(i+2)){for(;-1!==i&&(62!==e.charCodeAt(i)||45!=e.charCodeAt(i-1)||45!=e.charCodeAt(i-2)||-1==i);)i=e.indexOf(">",i+1);-1===i&&(i=e.length)}else if(91===e.charCodeAt(i+2)&&91===e.charCodeAt(i+8)&&"cdata"===e.substr(i+3,5).toLowerCase()){-1==(u=e.indexOf("]]>",i))?(s.push(e.substr(i+9)),i=e.length):(s.push(e.substring(i+9,u)),i=u+3);continue}i++;continue}e:{l=o,i++;var d=r(),c={};for(u=[];62!==e.charCodeAt(i)&&e[i];){var h=e.charCodeAt(i);if(h>64&&h<91||h>96&&h<123){h=r();for(var p=e.charCodeAt(i);p&&39!==p&&34!==p&&!(p>64&&p<91||p>96&&p<123)&&62!==p;)i++,p=e.charCodeAt(i);var f=i+1;if(i=e.indexOf(e[i],f),f=(" "+e.slice(f,i)).slice(1),39===p||34===p){if(-1===i){if(l={tagName:d,attributes:c,children:u,parent:null},t)for(d=0;d<u.length;d++)"string"!=typeof u[d]&&(u[d].parent=l);u=l;break e}}else f=null,i--;if(h.startsWith("xmlns:")){p=f;var g=h.split(":")[1];In.set(p,g),Cn.set(g,p)}"tt"===d&&"xml:space"===h&&"preserve"===f&&(l=!0),c[h]=f}i++}for(47!==e.charCodeAt(i-1)?(i++,u=n(d,l)):i++,l={tagName:d,attributes:c,children:u,parent:null},d=u.length,c=0;c<d;c++)"string"!=typeof(h=u[c])?t&&(h.parent=l):c==d-1&&"\n"==h&&u.pop();u=l}if(s.push(u),"string"==typeof u)break;"?"===u.tagName[0]&&u.children&&(s.push.apply(s,m(u.children)),u.children=[])}else u=i,-2==(i=e.indexOf("<",i)-1)&&(i=e.length),u=(" "+e.slice(u,i+1)).slice(1),o?u.length>0&&s.push(u):(s.length&&1==u.length&&"\n"==u[0]||u.trim().length>0)&&s.push(u),i++;return s}function r(){for(var t=i;-1==="\r\n\t>/= ".indexOf(e[i])&&e[i];)i++;return(" "+e.slice(t,i)).slice(1)}var i=0;return n("")}(e,void 0!==n&&n),!t&&e.length?e[0]:(e=e.find(function(e){return t.split(",").includes(e.tagName)}))?e:null}function Qt(e){return In.has(e)?In.get(e):""}function Zt(e){return"string"==typeof e}function en(e){var t=[];if(!e.children)return[];for(var n=(e=g(e.children)).next();!n.done;n=e.next())"string"!=typeof(n=n.value)&&t.push(n);return t}function tn(e,t){var n=[];if(!e.children)return[];for(var r=(e=g(e.children)).next();!r.done;r=e.next())(r=r.value).tagName===t&&n.push(r);return n}function nn(e){return"string"==typeof e?tt(e):""===(e=e.children.reduce(function(e,t){return"string"==typeof t?e+t:e},""))?null:tt(e)}function rn(e){return Array.from(e.children).every(function(e){return"string"==typeof e})?((e=nn(e))&&(e=e.trim()),e):null}function an(e,t,n){if(n=void 0===n?[]:n,e.tagName===t&&n.push(e),e.children)for(var r=(e=g(e.children)).next();!r.done;r=e.next())an(r.value,t,n);return n}function on(e,t){return 1!=(e=tn(e,t)).length?null:e[0]}function sn(e,t,n){return 1!=(e=dn(e,t,n)).length?null:e[0]}function un(e,t,n,r){r=void 0===r?null:r;var i=null;return null!=(e=e.attributes[t])&&(i=n(e)),null==i?r:i}function ln(e,t,n){return t=Qt(t),e.attributes[t+":"+n]||null}function dn(e,t,n){var r=Qt(t);if(t=[],e.children)for(n=r?r+":"+n:n,r=(e=g(e.children)).next();!r.done;r=e.next())(r=r.value)&&r.tagName===n&&t.push(r);return t}function cn(e,t,n){for(var r=(t=g(t)).next();!r.done;r=t.next())if(r=ln(e,r.value,n))return r;return null}function hn(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function pn(e){return e&&(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null}function fn(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function gn(e){return(e=Number(e))%1==0?e:null}function mn(e){return(e=Number(e))%1==0&&e>0?e:null}function vn(e){return(e=Number(e))%1==0&&e>=0?e:null}function yn(e){return e=Number(e),isNaN(e)?null:e}function bn(e){return!!e&&"true"===e.toLowerCase()}function xn(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function Tn(e){for(var t=[],n=(e=g(e=tt(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/))).next();!n.done;n=e.next()){var r=(n=n.value).match(/^([\w]+)/);if(r){var i=n.match(/(@id='(.*?)')/),a=n.match(/(@t='(\d+)')/),o=n.match(/(@n='(\d+)')/),s=n.match(/\[(\d+)\]/);t.push({name:r[0],id:i?i[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:a?Number(a[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:o?Number(o[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:s?Number(s[1])-1:null,Dc:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Dc=n.slice(1))}return t}function wn(e,t){var n=Tn(t.attributes.sel||"");if(n.length){var r=n[n.length-1],i=t.attributes.pos||null;null==(n=r.position)&&(null!==r.t&&(n=Sn(e,"t",r.t)),null!==r.n&&(n=Sn(e,"n",r.n))),null===n?n="prepend"===i?0:e.length:"prepend"===i?--n:"after"===i&&++n,i=t.tagName,(r=r.Dc)&&e[n]?An(e[n],i,r,rn(t)||""):("remove"!==i&&"replace"!==i||e.splice(n,1),"add"!==i&&"replace"!==i||e.splice.apply(e,[n,0].concat(m(t.children))))}}function Sn(e,t,n){for(var r=0,i=(e=g(e)).next();!i.done;i=e.next()){if(Number(i.value.attributes[t])===n)return r;r++}return null}function An(e,t,n,r){"remove"===t?delete e.attributes[n]:"add"!==t&&"replace"!==t||(e.attributes[n]=r)}function En(e){var t="",n=e.tagName.split(":");for(var r in n.length>0&&(t=n[0],t=Cn.has(t)?Cn.get(t):""),t=document.createElementNS(t,e.tagName),e.attributes)t.setAttribute(r,e.attributes[r]);for(r=(e=g(e.children)).next();!r.done;r=e.next())n=void 0,n="string"==typeof(r=r.value)?new Text(r):En(r),t.appendChild(n);return t}function kn(e){if(!e)return null;for(var t={tagName:e.tagName,attributes:qt(e.attributes),children:[],parent:null},n=(e=g(e.children)).next();!n.done;n=e.next())"string"==typeof(n=n.value)||((n=kn(n)).parent=t),t.children.push(n);return t}V("shaka.util.ObjectUtils",Wt),Wt.alphabeticalKeyOrderStringify=Yt,Wt.shallowCloneObject=qt,Wt.cloneObject=Kt;var In=new Map,Cn=new Map;function Mn(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Ot,this.position=null,this.positionAlign=On,this.size=0,this.textAlign=Un,this.direction=Vn,this.writingMode=Hn,this.lineInterpretation=Gn,this.line=null,this.lineHeight="",this.lineAlign=zn,this.displayAlign=jn,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=qn,this.fontStyle=$n,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={columns:32,rows:15}}function Rn(e,t){return(e=new Mn(e,t,"")).lineBreak=!0,e}function _n(e,t){if(e.payload!=t.payload||!(Math.abs(e.startTime-t.startTime)<.001&&Math.abs(e.endTime-t.endTime)<.001))return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!ee(e.nestedCues,t.nestedCues,_n))return!1}else if("region"==n||"cellResolution"==n){for(var r in e[n])if(e[n][r]!=t[n][r])return!1}else if(Array.isArray(e[n])){if(!ee(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}function Pn(e,t){t=void 0===t?new Map:t;var n=e.payload;if(n.includes("<")){0===t.size&&Dn(t);var r=n;n=[];for(var i=-1,a=0;a<r.length;a++)"<"===r[a]?i=a+1:">"===r[a]&&i>0&&((i=r.substr(i,a-i)).match(er)&&n.push(i),i=-1);for(a=(n=g(n)).next();!a.done;a=n.next())a=a.value,r=r.replace("<"+a+">",'<div time="'+a+'">'),r+="</div>";e:{a=r,i=[];var o=-1;n="",r=!1;for(var s=0;s<a.length;s++)if("/"===a[s]){var u=a.indexOf(">",s);if(-1===u){n=a;break e}if((u=a.substring(s+1,u))&&"v"==u){r=!0;var l=null;if(i.length&&(l=i[i.length-1]),l){if(l===u)n+="/"+u+">";else{if(!l.startsWith("v")){n+=a[s];continue}n+="/"+l+">"}s+=u.length+1}else n+=a[s]}else n+=a[s]}else"<"===a[s]?"v"!=a[o=s+1]&&(o=-1):">"===a[s]&&o>0&&(i.push(a.substr(o,s-o)),o=-1),n+=a[s];for(i=(a=g(i)).next();!i.done;i=a.next())o=(i=i.value).replace(" ",".voice-"),n=(n=n.replace("<"+i+">","<"+o+">")).replace("</"+i+">","</"+o+">"),r||(n+="</"+o+">")}n=function(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,r=RegExp(n.source);return e&&r.test(e)?e.replace(n,function(e){return t[e]||""}):e||""}(n),e.payload="",r="<span>"+n.replace(/\n/g,"<br />")+"</span>";try{var d=Jt(r,"span")}catch(c){}if(d)if(1!=(d=d.children).length||d[0].tagName)for(n=(d=g(d)).next();!n.done;n=d.next())Ln(n.value,e,t);else e.payload=tt(n);else e.payload=tt(n)}else e.payload=tt(n)}function Dn(e){for(var t=g(Object.entries(Wn)),n=t.next();!n.done;n=t.next()){var r=g(n.value);n=r.next().value,r=r.next().value;var i=new Mn(0,0,"");i.color=r,e.set("."+n,i)}for(n=(t=g(Object.entries(Kn))).next();!n.done;n=t.next())n=(r=g(n.value)).next().value,r=r.next().value,(i=new Mn(0,0,"")).backgroundColor=r,e.set("."+n,i)}function Ln(e,t,n){var r=t.clone();if(r.nestedCues=[],r.payload="",r.rubyTag="",r.line=null,r.region=new Ot,r.position=null,r.size=0,r.textAlign=Un,e.tagName)for(var i=g(e.tagName.split(/(?=[ .])+/g)),a=i.next();!a.done;a=i.next()){var o=a=a.value;if(o.startsWith(".voice-")){var s=o.split("-").pop();o='v[voice="'+s+'"]',n.has(o)||(o="v[voice="+s+"]")}switch(n.has(o)&&(s=r,o=n.get(o))&&(s.backgroundColor=Nn(o.backgroundColor,s.backgroundColor),s.color=Nn(o.color,s.color),s.fontFamily=Nn(o.fontFamily,s.fontFamily),s.fontSize=Nn(o.fontSize,s.fontSize),s.textShadow=Nn(o.textShadow,s.textShadow),s.fontWeight=o.fontWeight,s.fontStyle=o.fontStyle,s.opacity=o.opacity,s.rubyTag=o.rubyTag,s.textCombineUpright=o.textCombineUpright,s.wrapLine=o.wrapLine),a){case"br":return r=Rn(r.startTime,r.endTime),void t.nestedCues.push(r);case"b":r.fontWeight=Yn;break;case"i":r.fontStyle=Jn;break;case"u":r.textDecoration.push(Zn);break;case"font":(a=e.attributes.color)&&(r.color=a);break;case"div":if(!(a=e.attributes.time))break;(a=zt(a))&&(r.startTime=a);break;case"ruby":case"rp":case"rt":r.rubyTag=a}}if(i=e.children,Zt(e)||1==i.length&&Zt(i[0]))for(n=nn(e).split("\n"),e=!0,i=(n=g(n)).next();!i.done;i=n.next())i=i.value,e||(e=Rn(r.startTime,r.endTime),t.nestedCues.push(e)),i.length>0&&((e=r.clone()).payload=tt(i),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(r),e=(t=g(i)).next();!e.done;e=t.next())Ln(e.value,r,n)}function Nn(e,t){return e&&e.length>0?e:t}Mn.prototype.clone=function(){var e,t=new Mn(0,0,"");for(e in this)t[e]=this[e],Array.isArray(t[e])&&(t[e]=t[e].slice());return t},V("shaka.text.Cue",Mn),Mn.parseCuePayload=Pn,Mn.equal=_n,Mn.prototype.clone=Mn.prototype.clone;var On="auto";Mn.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:On};var Un="center",Bn={LEFT:"left",RIGHT:"right",CENTER:Un,START:"start",END:"end"};Mn.textAlign=Bn;var jn="after",Fn={BEFORE:"before",CENTER:"center",AFTER:jn};Mn.displayAlign=Fn;var Vn="ltr";Mn.direction={HORIZONTAL_LEFT_TO_RIGHT:Vn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Hn="horizontal-tb";Mn.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Hn,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Gn=0;Mn.lineInterpretation={LINE_NUMBER:Gn,PERCENTAGE:1};var zn="start",Xn={CENTER:"center",START:zn,END:"end"};Mn.lineAlign=Xn;var Wn={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};Mn.defaultTextColor=Wn;var Kn={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};Mn.defaultTextBackgroundColor=Kn;var qn=400,Yn=700;Mn.fontWeight={NORMAL:qn,BOLD:Yn};var $n="normal",Jn="italic",Qn={NORMAL:$n,ITALIC:Jn,OBLIQUE:"oblique"};Mn.fontStyle=Qn;var Zn="underline";Mn.textDecoration={UNDERLINE:Zn,LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var er=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function tr(){}function nr(e,t,n){ir.set(e.toLowerCase().split(";")[0]+"-"+n,{priority:n,Af:t})}function rr(e,t){for(var n=e.toLowerCase().split(";")[0],r=g([ur,sr,or,ar]),i=r.next();!i.done;i=r.next())if(i=ir.get(n+"-"+i.value)){var a=i.Af(),o=a.isSupported(e,t);if(a.destroy(),o)return i.Af}return null}tr.prototype.destroy=function(){},V("shaka.transmuxer.TransmuxerEngine",tr),tr.findTransmuxer=rr,tr.unregisterTransmuxer=function(e,t){ir.delete(e.toLowerCase().split(";")[0]+"-"+t)},tr.registerTransmuxer=nr,tr.prototype.destroy=tr.prototype.destroy;var ir=new Map,ar=1,or=2,sr=3,ur=4;function lr(){}function dr(e,t){var n=e;return t&&!xr.includes(e)&&(n+='; codecs="'+t+'"'),n}function cr(e,t){return t&&(e+='; codecs="'+t+'"'),e}function hr(e,t,n){var r=dr(e,t);return rr(t=cr(e,t))?(e=rr(t))?(n=(e=e()).convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?r.replace("video","audio"):r,n}function pr(e){return e.split(";")[0].split("/")[1]}function fr(e){var t=br(e);switch(e=t[0].toLowerCase(),t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:case"ac3"===e:case"ac-3"===e:return"ac-3";case"mp4a"===e&&"a6"===t:case"eac3"===e:case"ec-3"===e:return"ec-3";case"ac-4"===e:return"ac-4";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"vp09"===e:case"vp9"===e:return"vp9";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"vvc1"===e:case"vvi1"===e:return"vvc";case"dvh1"===e:case"dvhe"===e:return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1";case"dvc1"===e:case"dvi1"===e:return"dovi-vvc";case"lvc1"===e:return"lcevc"}return e}function gr(e){for(var t=[],n=(e=g(e.split(","))).next();!n.done;n=e.next())n=br(n.value),t.push(n[0]);return t.sort().join(",")}function mr(e){return e.split(";")[0]}function vr(e){return(e=e.split(/ *; */)).shift(),(e=e.find(function(e){return e.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function yr(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e}function br(e){var t=(e=e.split("."))[0];return e.shift(),[t,e.join(".")]}tr.PluginPriority={FALLBACK:ar,PREFERRED_SECONDARY:or,PREFERRED:sr,APPLICATION:ur},V("shaka.util.MimeUtils",lr),lr.getFullTypeWithAllCodecs=cr,lr.getFullType=dr,(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var xr=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Tr(e){this.i=null,this.l=e,this.C=!1,this.m=this.u=0,this.o=1/0,this.h=this.g=null,this.F="",this.B=function(){},this.j=new Map}function wr(e,t){Cr.set(e,t)}function Sr(e){return Cr.get(e)}function Ar(e){return!!Cr.has(e)||("application/cea-608"==e||"application/cea-708"==e)&&!!Nt}function Er(e,t,n){e.F=t,(t=e.j.get(t))&&(t=t.filter(function(e){return e.endTime<=n})).length&&e.l.append(t)}function kr(e,t,n){t.startTime+=n,t.endTime+=n;for(var r=(t=g(t.nestedCues)).next();!r.done;r=t.next())kr(e,r.value,n)}function Ir(e){for(var t=1/0,n=-1/0,r=g(e.j.values()),i=r.next();!i.done;i=r.next())for(var a=(i=g(i.value)).next();!a.done;a=i.next())a=a.value,t=Math.min(t,a.startTime),n=Math.max(n,a.endTime);t!==1/0&&n!==-1/0&&(e.g=null==e.g?Math.max(t,e.m):Math.min(e.g,Math.max(t,e.m)),e.h=Math.max(e.h,Math.min(n,e.o)))}Tr.prototype.destroy=function(){return this.l=this.i=null,this.j.clear(),Promise.resolve()},Tr.prototype.remove=function(e,t,n){n=void 0!==n&&n;var r=this;return P(function(i){return 1==i.g?x(i,Promise.resolve(),2):e>=t?i.return():(n&&function(e,t,n){for(var r=g(e.j.keys()),i=r.next();!i.done;i=r.next()){i=i.value;var a=e.j.get(i);a=a.filter(function(e){return e.startTime<t||e.endTime>=n}),e.j.set(i,a)}}(r,e,t),r.l&&r.l.remove(e,t)&&null!=r.g&&(t<=r.g||e>=r.h||(e<=r.g&&t>=r.h?r.g=r.h=null:e<=r.g&&t<r.h?r.g=t:e>r.g&&t>=r.h&&(r.h=e)),Ir(r)),void T(i))})},V("shaka.text.TextEngine",Tr),Tr.prototype.destroy=Tr.prototype.destroy,Tr.findParser=Sr,Tr.unregisterParser=function(e){Cr.delete(e)},Tr.registerParser=wr;var Cr=new Map;function Mr(e){this.h=e,this.g=null}function Rr(e){this.h=e,this.g=null}function _r(e,t){return e.concat(t)}function Pr(){}function Dr(e){return null!=e}function Lr(e,t){return Promise.race([t,new Promise(function(t,n){new Rr(n).ka(e)})])}function Nr(){}function Or(e,t){return e=jr(e),t=jr(t),e.split("-")[0]==t.split("-")[0]}function Ur(e,t){return e=jr(e),t=jr(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function Br(e,t){return e=jr(e),t=jr(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function jr(e){var t=(e=g(e.split("-x-"))).next().value;t=void 0===t?"":t,e=void 0===(e=e.next().value)?"":e;var n=g(t.split("-"));return t=void 0===(t=n.next().value)?"":t,n=void 0===(n=n.next().value)?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=zr.get(t)||t,((n=n.toUpperCase())?t+"-"+n:t)+(e?"-"+e:"")}function Fr(e,t){return e=jr(e),(t=jr(t))==e?4:Ur(t,e)?3:Br(t,e)?2:Ur(e,t)?1:0}function Vr(e){var t=e.indexOf("-");return e=(e=t>=0?e.substring(0,t):e).toLowerCase(),zr.get(e)||e}function Hr(e){return e.language?jr(e.language):e.audio&&e.audio.language?jr(e.audio.language):e.video&&e.video.language?jr(e.video.language):"und"}function Gr(e,t){e=jr(e);for(var n=new Set,r=(t=g(t)).next();!r.done;r=t.next())n.add(jr(r.value));for(r=(t=g(n)).next();!r.done;r=t.next())if((r=r.value)==e)return r;for(r=(t=g(n)).next();!r.done;r=t.next())if(Ur(r=r.value,e))return r;for(r=(t=g(n)).next();!r.done;r=t.next())if(Br(r=r.value,e))return r;for(t=(n=g(n)).next();!t.done;t=n.next())if(Ur(e,t=t.value))return t;return null}Mr.prototype.ka=function(t){var n=this;this.stop();var r=!0,i=null;return this.g=function(){e.clearTimeout(i),r=!1},i=e.setTimeout(function(){r&&n.h()},1e3*t),this},Mr.prototype.stop=function(){this.g&&(this.g(),this.g=null)},Rr.prototype.Kb=function(){return this.stop(),this.h(),this},Rr.prototype.ka=function(e){var t=this;return this.stop(),this.g=new Mr(function(){t.h()}).ka(e),this},Rr.prototype.Ea=function(e){var t=this;return this.stop(),this.g=new Mr(function(){t.g.ka(e),t.h()}).ka(e),this},Rr.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},V("shaka.util.Timer",Rr),Rr.prototype.stop=Rr.prototype.stop,Rr.prototype.tickEvery=Rr.prototype.Ea,Rr.prototype.tickAfter=Rr.prototype.ka,Rr.prototype.tickNow=Rr.prototype.Kb,V("shaka.util.LanguageUtils",Nr),Nr.findClosestLocale=Gr,Nr.getLocaleForVariant=Hr,Nr.getLocaleForText=function(e){return jr(e.language||"und")},Nr.getBase=Vr,Nr.relatedness=Fr,Nr.areSiblings=function(e,t){var n=Vr(e),r=Vr(t);return e!=n&&t!=r&&n==r},Nr.normalize=jr,Nr.isSiblingOf=Br,Nr.isParentOf=Ur,Nr.areLanguageCompatible=Or,Nr.areLocaleCompatible=function(e,t){return(e=jr(e))==(t=jr(t))};var zr=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Xr(){}function Wr(e,t,n,r,i){function a(e){var t=String(e.width||"")+String(e.height||"")+String(Math.round(e.frameRate||0))+(e.hdr||"")+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),e.roles&&(t+=e.roles.sort().join("_")),t}function o(e){var t=e.language+(e.channelsCount||0)+(e.audioSamplingRate||0)+e.roles.join(",")+e.label+e.groupId+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t}if(i.length){for(var s=e.textStreams,u=(i=g(i)).next(),l={};!u.done;l={Eh:void 0},u=i.next())if(l.Eh=u.value,(u=s.filter(function(e){return function(t){return!(!t.codecs.startsWith(e.Eh)&&!t.mimeType.startsWith(e.Eh))}}(l))).length){s=u;break}e.textStreams=s}if(s=e.variants,(t.length||n.length)&&(s=function(e,t,n){for(var r=(t=g(t)).next(),i={};!r.done;i={jj:void 0},r=t.next())if(i.jj=r.value,r=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.jj)}}(i)),r.length){e=r;break}for(n=g(n),t=n.next(),r={};!t.done;r={Ph:void 0},t=n.next())if(r.Ph=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.Ph)}}(r)),t.length){e=t;break}return e}(s,t,n)),r.length){for(t=new te,s=(n=g(s)).next();!s.done;s=n.next())s=s.value,t.push(String(s.video.width||0),s);var d=[];t.forEach(function(e,t){e=0;for(var n=[],i=(t=g(t)).next(),a={};!i.done;a={Wf:void 0},i=t.next())a.Wf=i.value,(i=r.filter(function(e){return function(t){return e.Wf.decodingInfos[0][t]}}(a)).length)>e?(e=i,n=[a.Wf]):i==e&&n.push(a.Wf);d.push.apply(d,m(n))}),s=d}for(n=new Set,t=new Set,i=(s=g(s)).next();!i.done;i=s.next())(i=i.value).audio&&n.add(i.audio),i.video&&t.add(i.video);s=Array.from(n).sort(function(e,t){return e.bandwidth-t.bandwidth});var c=[];for(n=new Map,i=(s=g(s)).next();!i.done;i=s.next()){if(u=o(i=i.value),(l=n.get(u)||[]).length){var h=l[l.length-1],p=fr(h.codecs),f=fr(i.codecs);p!=f||i.bandwidth&&h.bandwidth&&!(i.bandwidth>h.bandwidth)||(l.push(i),c.push(i.id))}else l.push(i),c.push(i.id);n.set(u,l)}var v={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};s=Array.from(t).sort(function(e,t){if(!e.bandwidth||!t.bandwidth||e.bandwidth==t.bandwidth){if(e.codecs&&t.codecs&&e.codecs!=t.codecs&&e.width==t.width){var n=fr(e.codecs),r=fr(t.codecs);if(n!=r)return(v[n]||1)-(v[r]||1)}return e.width-t.width}return e.bandwidth-t.bandwidth}),t=oe().Bb();var y=[];for(n=new Map,i=(s=g(s)).next();!i.done;i=s.next()){if(u=a(i=i.value),(l=n.get(u)||[]).length){if(h=l[l.length-1],!t&&(p=fr(h.codecs))!==(f=fr(i.codecs)))continue;(p=fr(h.codecs))!=(f=fr(i.codecs))||i.bandwidth&&h.bandwidth&&!(i.bandwidth>h.bandwidth)||(l.push(i),y.push(i.id))}else l.push(i),y.push(i.id);n.set(u,l)}e.variants=e.variants.filter(function(e){var t=e.audio;return e=e.video,!(t&&!c.includes(t.id)||e&&!y.includes(e.id))})}function Kr(e,t,n){function r(e,t,n){return e>=t&&e<=n}var i=e.video;if(i&&i.width&&i.height){var a=i.width,o=i.height;if(o>a&&(a=(o=g([o,a])).next().value,o=o.next().value),!r(a,t.minWidth,Math.min(t.maxWidth,n.width))||!r(o,t.minHeight,Math.min(t.maxHeight,n.height))||!r(i.width*i.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!r(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!r(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!r(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function qr(e,t,n,r){return n=void 0===n?[]:n,r=void 0===r?{}:r,P(function(i){return 1==i.g?x(i,Yr(e,t,t.offlineSessionIds.length>0,n,r),2):(function(e){e.textStreams=e.textStreams.filter(function(e){return Ar(e=dr(e.mimeType,e.codecs))})}(t),x(i,function(e){var t,n,r,i,a,o,s;return P(function(u){switch(u.g){case 1:t=[],n=g(e.imageStreams),r=n.next();case 2:if(r.done){u.A(4);break}if(i=r.value,"application/mp4"==(a=i.mimeType)&&"mjpg"==i.codecs&&(a="image/jpg"),bi.has(a)){u.A(5);break}if(!(o=xi.get(a))){bi.set(a,!1),u.A(5);break}return x(u,function(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(2===n.height)}})}(o),7);case 7:s=u.h,bi.set(a,s);case 5:bi.get(a)&&t.push(i),r=n.next(),u.A(2);break;case 4:e.imageStreams=t,T(u)}})}(t),0))})}function Yr(e,t,n,r,i){var a,o;return P(function(s){if(1==s.g)return oe().Yi()&&function(e){for(var t=(new Map).set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),n=new Set,r=(e=g(e)).next();!r.done;r=e.next())(r=r.value).video&&n.add(r.video);for(n=g(n),e=n.next();!e.done;e=n.next()){e=e.value;for(var i=(r=g(t)).next();!i.done;i=r.next()){var a=g(i.value);if(i=a.next().value,a=a.next().value,e.codecs.includes(i)){e.codecs=e.codecs.replace(i,a);break}}}}(t.variants),x(s,Qr(t.variants,n,!1,r),2);a=null,e&&(o=e.g)&&(a=o.keySystem),t.variants=t.variants.filter(function(e){var t=function(e,t,n){if(!e.decodingInfos.some(function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&(n[e.keySystem]||e.keySystem)!=t)}))return!1;var r=oe(),i="Xbox"===r.Ob();r="MOBILE"===r.Oa()&&"GECKO"===r.Ha();var a=e.video,o=a&&a.width||0,s=a&&a.height||0;return!(i&&a&&(o>1920||s>1080)&&(a.codecs.includes("avc1.")||a.codecs.includes("avc3."))||(i=a&&a.dependencyStream)&&!St(i)||(e=e.audio,r&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")||e&&e.dependencyStream))}(e,a,i);if(!t){var n=[];e.audio&&n.push(fi(e.audio)),e.video&&n.push(fi(e.video))}return t}),T(s)})}function $r(e,t){var n,r,i,a,o,s,u;return P(function(l){if(1==l.g){for(n=function(e,t){if(e){var n=qt(e);return n.supported=e.supported&&t.supported,n.powerEfficient=e.powerEfficient&&t.powerEfficient,n.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!n.keySystemAccess&&(n.keySystemAccess=t.keySystemAccess),n}return t},r=null,i=[],a=g(t),o=a.next(),s={};!o.done;s={cache:void 0,Re:void 0},o=a.next())u=o.value,s.Re=Yt(u),s.cache=vi,s.cache.has(s.Re)?r=n(r,s.cache.get(s.Re)):i.push(Jr(u).then(function(e){return function(t){for(var i=null,a=(t=g(t||[])).next();!a.done;a=t.next())i=n(i,a.value);i&&(e.cache.set(e.Re,i),r=n(r,i))}}(s)));return x(l,Promise.all(i),2)}r&&e.decodingInfos.push(r),T(l)})}function Jr(e){var t=[""];e.video&&(t=vr(e.video.contentType).split(","));var n=[""];e.audio&&(n=vr(e.audio.contentType).split(","));for(var r=[],i=(t=g(t)).next();!i.done;i=t.next()){i=i.value;for(var a=g(n),o=a.next(),s={};!o.done;s={Qc:void 0},o=a.next())o=o.value,s.Qc=Kt(e),e.video&&(s.Qc.video.contentType=dr(mr(s.Qc.video.contentType),i)),e.audio&&(s.Qc.audio.contentType=dr(mr(s.Qc.audio.contentType),o)),r.push(new Promise(function(e){return function(t,n){("MOBILE"==oe().Oa()?Lr(5,navigator.mediaCapabilities.decodingInfo(e.Qc)):navigator.mediaCapabilities.decodingInfo(e.Qc)).then(function(e){t(e)}).catch(n)}}(s)))}return Promise.all(r).catch(function(){return JSON.stringify(e),null})}function Qr(e,t,n,r){var i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,T,w,S;return P(function(A){switch(A.g){case 1:if(e.some(function(e){return e.decodingInfos.length}))return A.return();i=g(r),a=i.next(),o={};case 2:if(a.done){A.A(4);break}o.Hi=a.value,s=!1,u=g(e),l=u.next();case 5:if(l.done){A.A(7);break}d=l.value,c=Zr(d,t,n).filter((E=o,function(e){return((e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)===E.Hi})),h=g(c),p=h.next();case 8:if(p.done){A.A(10);break}return f=p.value,x(A,$r(d,f),9);case 9:p=h.next(),A.A(8);break;case 10:d.decodingInfos.some(function(e){return e.supported})&&(s=!0),l=u.next(),A.A(5);break;case 7:if(s)return A.return();o={Hi:void 0},a=i.next(),A.A(2);break;case 4:m=g(e),v=m.next();case 12:if(v.done){A.A(0);break}y=v.value,b=Zr(y,t,n).filter(function(e){return!(e=(e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)||!r.includes(e)}),T=g(b),w=T.next();case 15:if(w.done){v=m.next(),A.A(12);break}return S=w.value,x(A,$r(y,S),16);case 16:w=T.next(),A.A(15)}var E})}function Zr(e,t,n){var r=e.audio,i=e.video,a=[],o=[];if(i)for(var s=g(i.fullMimeTypes),u=s.next();!u.done;u=s.next()){var l=vr(u=u.value);if(l.includes(",")&&!r){var d=l.split(","),c=mr(u);l=pt("video",d),c=hr(c,d=ei(d=pt("audio",d),c),"audio"),o.push({contentType:c,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(l=ti(l),u={contentType:hr(mr(u),l,"video"),width:i.width||64,height:i.height||64,bitrate:i.bandwidth||e.bandwidth||1,framerate:i.frameRate||30},i.hdr)switch(i.hdr){case"PQ":u.transferFunction="pq";break;case"HLG":u.transferFunction="hlg"}i.colorGamut&&(u.colorGamut=i.colorGamut),a.push(u)}if(r)for(u=(s=g(r.fullMimeTypes)).next();!u.done;u=s.next())u=hr(u=mr(l=u.value),l=ei(vr(l),u),"audio"),o.push({contentType:u,channels:r.channelsCount||2,bitrate:r.bandwidth||e.bandwidth||1,samplerate:r.audioSamplingRate||1,spatialRendering:r.spatialAudio});for(s=[],0==a.length&&a.push(null),0==o.length&&o.push(null),u=(a=g(a)).next();!u.done;u=a.next())for(u=u.value,c=(l=g(o)).next();!c.done;c=l.next())c=c.value,d={type:n?"file":"media-source"},u&&(d.video=u),c&&(d.audio=c),s.push(d);if(!(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[s];for(e=[],n=new Map,a=(o=g(o)).next();!a.done;a=o.next())a=a.value,n.get(a.keySystem)||n.set(a.keySystem,[]),n.get(a.keySystem).push(a);for(o=t?"required":"optional",t=t?["persistent-license"]:["temporary"],u=(a=g(n.keys())).next();!u.done;u=a.next()){for(u=u.value,c=n.get(u),l=new Map,d=(c=g(c)).next();!d.done;d=c.next()){var h=(d=d.value).videoRobustness+","+d.audioRobustness;l.get(h)||l.set(h,[]),l.get(h).push(d)}for(c=(l=g(l.values())).next();!c.done;c=l.next()){c=c.value,d=[];for(var p=(h=g(s)).next();!p.done;p=h.next()){p=Object.assign({},p.value);for(var f={keySystem:u,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t},m=g(c),v=m.next();!v.done;v=m.next()){if((v=v.value).initData&&v.initData.length){for(var y=new Set,b=g(v.initData),x=b.next();!x.done;x=b.next())y.add(x.value.initDataType);f.initDataType=v.initData[0].initDataType}v.distinctiveIdentifierRequired&&(f.distinctiveIdentifier="required"),v.persistentStateRequired&&(f.persistentState="required"),v.sessionType&&(f.sessionTypes=[v.sessionType]),r&&(f.audio?(v.encryptionScheme&&(f.audio.encryptionScheme=f.audio.encryptionScheme||v.encryptionScheme),f.audio.robustness=f.audio.robustness||v.audioRobustness):(f.audio={robustness:v.audioRobustness},v.encryptionScheme&&(f.audio.encryptionScheme=v.encryptionScheme)),""==f.audio.robustness&&delete f.audio.robustness),i&&(f.video?(v.encryptionScheme&&(f.video.encryptionScheme=f.video.encryptionScheme||v.encryptionScheme),f.video.robustness=f.video.robustness||v.videoRobustness):(f.video={robustness:v.videoRobustness},v.encryptionScheme&&(f.video.encryptionScheme=v.encryptionScheme)),""==f.video.robustness&&delete f.video.robustness)}p.keySystemConfiguration=f,d.push(p)}e.push(d)}}return e}function ei(e,t){var n=oe();return"flac"==e.toLowerCase()?"WEBKIT"!=n.Ha()?"flac":"fLaC":"opus"===e.toLowerCase()?"WEBKIT"!=n.Ha()?"opus":"mp4"==pr(t)?"Opus":"opus":"ac-3"==e.toLowerCase()&&n.re()?"ec-3":e}function ti(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function ni(e){var t=e.audio,n=e.video,r=t?t.mimeType:null,i=n?n.mimeType:null,a=t?t.codecs:null,o=n?n.codecs:null,s=t?t.groupId:null,u=[];n&&u.push(n.mimeType),t&&u.push(t.mimeType),u=u[0]||null;var l=[];t&&l.push(t.kind),n&&l.push(n.kind),l=l[0]||null;var d=new Set;if(t)for(var c=g(t.roles),h=c.next();!h.done;h=c.next())d.add(h.value);if(n)for(h=(c=g(n.roles)).next();!h.done;h=c.next())d.add(h.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,videoLabel:null,kind:l,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:u,audioMimeType:r,videoMimeType:i,codecs:"",audioCodec:a,videoCodec:o,primary:e.primary,roles:Array.from(d),audioRoles:null,videoRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:s,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,e.videoRoles=n.roles,e.videoLabel=n.label,(r=n.dependencyStream)&&(e.width=r.width||e.width,e.height=r.height||e.height,e.videoCodec=r.codecs||e.videoCodec,e.pixelAspectRatio=r.pixelAspectRatio||e.pixelAspectRatio,e.videoBandwidth&&r.bandwidth&&(e.videoBandwidth+=r.bandwidth)),o.includes(","))){e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage,e.audioMimeType=i,i=o.split(",");try{e.videoCodec=pt("video",i),e.audioCodec=pt("audio",i)}catch(p){}}return t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage,i=t.dependencyStream)&&(e.audioCodec=i.codecs||e.audioCodec,e.audioBandwidth&&i.bandwidth&&(e.audioBandwidth+=i.bandwidth)),n&&!e.videoBandwidth&&(t?e.audioBandwidth&&(e.videoBandwidth=e.bandwidth-e.audioBandwidth):e.videoBandwidth=e.bandwidth),t&&!e.audioBandwidth&&(n?e.videoBandwidth&&(e.audioBandwidth=e.bandwidth-e.videoBandwidth):e.audioBandwidth=e.bandwidth),t=[],e.videoCodec&&t.push(e.videoCodec),e.audioCodec&&t.push(e.audioCodec),e.codecs=t.join(", "),e}function ri(e){return{id:e.id,active:!1,type:mt,bandwidth:e.bandwidth||0,language:e.language,label:e.label,kind:e.kind||null,mimeType:e.mimeType,codecs:e.codecs||null,primary:e.primary,roles:e.roles,accessibilityPurpose:e.accessibilityPurpose,forced:e.forced,originalTextId:e.originalId,originalLanguage:e.originalLanguage}}function ii(e){var t=e.width||null,n=e.height||null,r=null;e.segmentIndex&&(r=Du(e.segmentIndex));var i=e.tilesLayout;return r&&(i=r.tilesLayout||i),i&&null!=t&&(t/=Number(i.split("x")[0])),i&&null!=n&&(n/=Number(i.split("x")[1])),{id:e.id,type:"image",bandwidth:e.bandwidth||0,width:t,height:n,mimeType:e.mimeType,codecs:e.codecs||null,tilesLayout:i||null,originalImageId:e.originalId}}function ai(e){return e.__shaka_id||(e.__shaka_id=yi++),e.__shaka_id}function oi(e){var t={id:ai(e),active:"disabled"!=e.mode,type:mt,bandwidth:0,language:jr(e.language||"und"),label:e.label,kind:e.kind,mimeType:null,codecs:null,primary:!1,roles:[],accessibilityPurpose:null,forced:"forced"==e.kind,originalTextId:e.id,originalLanguage:e.language};return"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),t}function si(e,t){var n=e?e.language:null;if(n={id:ai(e||t),active:e?e.enabled:t.selected,type:"variant",bandwidth:0,language:jr(n||"und"),label:e?e.label:null,videoLabel:null,kind:e?e.kind:null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!!e&&"main"==e.kind,roles:[],forced:!1,audioRoles:null,videoRoles:null,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:t?t.id:null,originalAudioId:e?e.id:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:n},e&&e.kind&&(n.roles=[e.kind],n.audioRoles=[e.kind]),e&&e.configuration&&(e.configuration.codec&&(n.audioCodec=e.configuration.codec,n.codecs=n.audioCodec),e.configuration.bitrate&&(n.audioBandwidth=e.configuration.bitrate,n.bandwidth+=n.audioBandwidth),e.configuration.sampleRate&&(n.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(n.channelsCount=e.configuration.numberOfChannels)),t&&t.configuration&&(t.configuration.codec&&(n.videoCodec=t.configuration.codec,n.codecs=n.codecs?n.codecs+","+n.videoCodec:n.videoCodec),t.configuration.bitrate&&(n.videoBandwidth=t.configuration.bitrate,n.bandwidth+=n.videoBandwidth),t.configuration.framerate&&(n.frameRate=t.configuration.framerate),t.configuration.width&&(n.width=t.configuration.width),t.configuration.height&&(n.height=t.configuration.height),t.configuration.colorSpace&&t.configuration.colorSpace.transfer))switch(t.configuration.colorSpace.transfer){case"pq":n.hdr="PQ";break;case"hlg":n.hdr="HLG";break;case"bt709":n.hdr="SDR"}return n}function ui(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function li(e){return e.filter(function(e){return ui(e)})}function di(e,t,n,r){var i=e,a=e.filter(function(e){return e.primary});a.length&&(i=a);var o=i.length?i[0].language:"";if(i=i.filter(function(e){return e.language==o}),t){var s=Gr(jr(t),e.map(function(e){return e.language}));s&&(i=e.filter(function(e){return jr(e.language)==s}))}if(i=i.filter(function(e){return e.forced==r}),n){if((e=ci(i,n)).length)return e}else if(e=i.filter(function(e){return 0==e.roles.length}),e.length)return e;return e=i.map(function(e){return e.roles}).reduce(_r,[]),e.length?ci(i,e[0]):i}function ci(e,t){return e.filter(function(e){return e.roles.includes(t)})}function hi(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t}function pi(e,t){t.length&&(t=t.filter(function(t){return fr(e.codecs)==fr(t.codecs)}).sort(function(e,t){return e.bandwidth&&t.bandwidth&&e.bandwidth!=t.bandwidth?e.bandwidth-t.bandwidth:(e.width||0)-(t.width||0)}),e.trickModeVideo=t[0],t.length>1&&(t=t.find(function(t){return e.width==t.width&&e.height==t.height})))&&(e.trickModeVideo=t)}function fi(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}function gi(e,t,n){if(0==n.autoShowText)return!1;if(1==n.autoShowText)return!0;var r=jr(n.preferredTextLanguage);return t=jr(t.language),2==n.autoShowText?Or(t,r):3==n.autoShowText?!!e&&(e=jr(e.language),Or(t,r)&&!Or(e,t)):(K("Invalid autoShowText setting!"),!1)}function mi(e){for(var t={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},n=(e=g(e)).next();!n.done;n=e.next()){var r={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:(n=n.value)?mr(n):"",codecs:n?vr(n):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"video",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};r.fullMimeTypes.add(dr(r.mimeType,r.codecs)),n.startsWith("audio/")?(r.type="audio",t.audio=r):t.video=r}return t}V("shaka.util.StreamUtils",Xr),Xr.meetsRestrictions=Kr;var vi=new Map,yi=0,bi=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),xi=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function Ti(){var t=this;this.H=null,this.G=!1,this.u=new z,this.j=new ne,navigator.connection&&navigator.connection.addEventListener&&this.j.D(navigator.connection,"change",function(){t.g.useNetworkInformation&&navigator.onLine&&(t.u=new z,t.g&&t.u.configure(t.g.advanced),t.trySuggestStreams())}),this.l=[],this.I=1,this.J=!1,this.h=this.o=this.g=this.B=null,this.m=new Rr(function(){if(t.G&&(t.g.restrictToElementSize||t.g.restrictToScreenSize)){var e=t.chooseVariant();e&&t.H(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}}),this.C=e,"documentPictureInPicture"in e&&this.j.D(e.documentPictureInPicture,"enter",function(){t.C=e.documentPictureInPicture.window,t.m&&t.m.Kb(),t.j.Aa(t.C,"pagehide",function(){t.C=e,t.m&&t.m.Kb()})}),this.F=this.i=null}function wi(e,t){if(void 0===t||!t){if(!e.J){if(!((t=e.u).g>=t.i))return;e.J=!0,e.B-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}if(Date.now()-e.B<1e3*e.g.switchInterval)return}t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.H(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}function Si(e,t,n,r,i){if(e.F){var a=e.F.gi();a&&(n=n.filter(function(e){return!e.bandwidth||!a||e.bandwidth<=a}))}return t&&(n=n.filter(function(e){return Kr(e,t,{width:i,height:r})})),n.sort(function(e,t){return e.bandwidth-t.bandwidth})}(i=Ti.prototype).stop=function(){this.H=null,this.G=!1,this.l=[],this.I=1,this.o=this.B=null,this.h&&(this.h.disconnect(),this.h=null),this.m&&this.m.stop(),this.F=this.i=null},i.release=function(){this.stop(),this.j.release(),this.m=null},i.init=function(e){this.H=e},i.chooseVariant=function(e){e=void 0!==e&&e;var t=1/0,n=1/0;if(this.g.restrictToScreenSize&&(n=this.g.ignoreDevicePixelRatio?1:this.C.devicePixelRatio,t=this.C.screen.height*n,n*=this.C.screen.width),this.h&&this.g.restrictToElementSize){var r=this.g.ignoreDevicePixelRatio?1:this.C.devicePixelRatio,i=this.o.clientHeight,a=this.o.clientWidth;this.i&&document.pictureInPictureElement&&document.pictureInPictureElement==this.o&&(i=this.i.height,a=this.i.width),t=Math.min(t,i*r),n=Math.min(n,a*r)}if((i=this.l.filter(function(e){return e&&!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)})).length||(i=this.l),r=i,e&&i.length!=this.l.length&&(r=this.l.filter(function(e){return e&&!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)})),e=Si(this,this.g.restrictions,r,1/0,1/0),t!=1/0||n!=1/0){for(e=function(e){for(var t=[],n=(e=g(e)).next();!n.done;n=e.next())(n=n.value)&&(n=n.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort(function(e,t){return e.width-t.width})}(e),i=(e=g(e)).next();!i.done;i=e.next())if((i=i.value).height>=t&&i.width>=n){t=i.height,n=i.width;break}e=Si(this,this.g.restrictions,r,t,n)}for(t=this.getBandwidthEstimate(),r.length&&!e.length&&(e=[(e=Si(this,null,r,1/0,1/0))[0]]),n=e[0]||null,r=0;r<e.length;r++){i=e[r];var o=isNaN(this.I)?1:Math.abs(this.I);a=o*i.bandwidth/this.g.bandwidthDowngradeTarget;for(var s={bandwidth:1/0},u=r+1;u<e.length;u++)if(i.bandwidth!=e[u].bandwidth){s=e[u];break}o=o*s.bandwidth/this.g.bandwidthUpgradeTarget,n&&i&&t>=a&&t<=o&&(n.bandwidth!=i.bandwidth||n.bandwidth==i.bandwidth&&n.video&&i.video&&(n.video.width<i.video.width||n.video.height<i.video.height))&&(n=i)}return this.B=Date.now(),n},i.enable=function(){this.G=!0,this.l.length&&this.trySuggestStreams()},i.disable=function(){this.G=!1},i.segmentDownloaded=function(e,t,n,r){var i=e;this.g.removeLatencyFromFirstPacketTime&&r&&1===r.packetNumber&&r.timeToFirstByte&&(i=e-r.timeToFirstByte),i>=this.g.cacheLoadThreshold&&this.u.sample(i,t),n&&null!=this.B&&this.G&&wi(this)},i.trySuggestStreams=function(){this.G&&(this.B=Date.now(),wi(this,!0))},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&this.g.preferNetworkInformationBandwidth?e:(e=this.u.getBandwidthEstimate(e),this.F?this.F.getBandwidthEstimate(e):e)},i.setVariants=function(e){return!Z(e,this.l)&&(this.l=e,!0)},i.playbackRateChanged=function(e){this.I=e},i.setMediaElement=function(t){function n(){r.m.ka(Ai)}var r=this;this.o=t,this.h&&(this.h.disconnect(),this.h=null),this.o&&"ResizeObserver"in e&&(this.h=new ResizeObserver(n),this.h.observe(this.o)),this.j.D(t,"enterpictureinpicture",function(e){e.pictureInPictureWindow&&(r.i=e.pictureInPictureWindow,r.j.D(r.i,"resize",n))}),this.j.D(t,"leavepictureinpicture",function(){r.i&&r.j.Ma(r.i,"resize",n),r.i=null})},i.setCmsdManager=function(e){this.F=e},i.configure=function(e){this.g=e,this.u&&this.g&&this.u.configure(this.g.advanced)},V("shaka.abr.SimpleAbrManager",Ti),Ti.prototype.configure=Ti.prototype.configure,Ti.prototype.setCmsdManager=Ti.prototype.setCmsdManager,Ti.prototype.setMediaElement=Ti.prototype.setMediaElement,Ti.prototype.playbackRateChanged=Ti.prototype.playbackRateChanged,Ti.prototype.setVariants=Ti.prototype.setVariants,Ti.prototype.getBandwidthEstimate=Ti.prototype.getBandwidthEstimate,Ti.prototype.trySuggestStreams=Ti.prototype.trySuggestStreams,Ti.prototype.segmentDownloaded=Ti.prototype.segmentDownloaded,Ti.prototype.disable=Ti.prototype.disable,Ti.prototype.enable=Ti.prototype.enable,Ti.prototype.chooseVariant=Ti.prototype.chooseVariant,Ti.prototype.init=Ti.prototype.init,Ti.prototype.release=Ti.prototype.release,Ti.prototype.stop=Ti.prototype.stop;var Ai=1;function Ei(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4};this.l=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.o=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.m=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function ki(e){var t,n;return P(function(r){if(1==r.g){if(e.g>=e.l){if(!e.i)throw new Ke(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?r.return():(n=e.h*(1+(2*Math.random()-1)*e.o),x(r,new Promise(function(e){new Rr(e).ka(n/1e3)}),2))}e.h*=e.m,T(r)})}function Ii(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function Ci(){var e,t,n=new Promise(function(n,r){e=n,t=r});return n.resolve=e,n.reject=t,n}function Mi(e,t){this.promise=e,this.i=t,this.g=null}function Ri(e){return new Mi(Promise.reject(e),function(){return Promise.resolve()})}function _i(){var e=Promise.reject(new Ke(2,7,7001));return e.catch(function(){}),new Mi(e,function(){return Promise.resolve()})}function Pi(e){return new Mi(Promise.resolve(e),function(){return Promise.resolve()})}function Di(e){return new Mi(e,function(){return e.catch(function(){})})}function Li(e){return new Mi(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function Ni(t,n){if(n)if(n instanceof Map)for(var r=g(n.keys()),i=r.next();!i.done;i=r.next())i=i.value,Object.defineProperty(this,i,{value:n.get(i),writable:!0,enumerable:!0});else for(r in n)Object.defineProperty(this,r,{value:n[r],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Oi(e){var t,n=new Ni(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}Ci.prototype.resolve=function(){},Ci.prototype.reject=function(){},Mi.prototype.abort=function(){return this.g||(this.g=this.i()),this.g},Mi.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},Mi.prototype.Xa=function(e,t){function n(n){return function(s){if(i.g&&n)a.reject(o);else{var u=n?e:t;u?r=function(e,t,n){try{var r=e(t);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then(function(){},function(){})})}catch(i){return n.reject(i),function(){return Promise.resolve()}}}(u,s,a):(n?a.resolve:a.reject)(s)}}}function r(){return a.reject(o),i.abort()}var i=this,a=new Ci;a.catch(function(){});var o=new Ke(2,7,7001);return this.promise.then(n(!0),n(!1)),new Mi(a,function(){return r()})},u.Object.defineProperties(Mi.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return null!==this.g}}}),V("shaka.util.AbortableOperation",Mi),Mi.prototype.chain=Mi.prototype.Xa,Mi.prototype.finally=Mi.prototype.finally,Mi.all=Li,Mi.prototype.abort=Mi.prototype.abort,Mi.notAbortable=Di,Mi.completed=Pi,Mi.aborted=_i,Mi.failed=Ri,Ni.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Ni.prototype.stopImmediatePropagation=function(){this.g=!0},Ni.prototype.stopPropagation=function(){},V("shaka.util.FakeEvent",Ni);var Ui={ul:"abrstatuschanged",vl:"adaptation",wl:"audiotrackchanged",xl:"audiotrackschanged",yl:"boundarycrossed",zl:"buffering",Al:"canupdatestarttime",Bl:"complete",Cl:"currentitemchanged",Dl:"downloadcompleted",El:"downloadfailed",Fl:"downloadheadersreceived",Gl:"drmsessionupdate",Hl:"emsg",Nl:"itemsinserted",Ol:"itemsremoved",dm:"prft",Error:"error",Il:"expirationupdated",Jl:"firstquartile",Kl:"gapjumped",Pl:"keystatuschanged",Sl:"loaded",Tl:"loading",Vl:"manifestparsed",Wl:"manifestupdated",Xl:"mediaqualitychanged",Yl:"mediasourcerecovered",Zl:"metadataadded",Metadata:"metadata",$l:"midpoint",am:"nospatialvideoinfo",bm:"onstatechange",fm:"ratechange",im:"segmentappended",jm:"sessiondata",lm:"spatialvideoinfo",nm:"stalldetected",om:"started",pm:"statechanged",qm:"streaming",rm:"textchanged",sm:"texttrackvisibility",tm:"thirdquartile",um:"timelineregionadded",vm:"timelineregionenter",wm:"timelineregionexit",xm:"trackschanged",zm:"unloading",Bm:"variantchanged"};function Bi(){this.ab=new te,this.Ie=this}function ji(){this.g=[]}function Fi(e,t){e.g.push(t.finally(function(){Q(e.g,t)}))}function Vi(e,t,n,r,i,a,o){Bi.call(this),this.i=null,this.j=!1,this.u=new ji,this.g=new Set,this.h=new Set,this.o=e||null,this.m=t||null,this.B=n||null,this.C=r||null,this.F=i||null,this.H=a||null,this.G=o||null,this.l=new Map}function Hi(e,t,n,r){r=void 0!==r&&r,n=n||$i;var i=Ji.get(e);(!i||n>=i.priority)&&Ji.set(e,{priority:n,Af:t,Gk:r})}function Gi(e,t){for(var n=g(e.g),r=n.next();!r.done;r=n.next())t.g.add(r.value);for(n=(e=g(e.h)).next();!n.done;n=e.next())t.h.add(n.value)}function zi(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function Xi(e,t,n,r,i,a,o,s){e.i.forceHTTP&&(n.uris[a]=n.uris[a].replace("https://","http://")),e.i.forceHTTPS&&(n.uris[a]=n.uris[a].replace("http://","https://")),a>0&&e.H&&e.H(t,r,n.uris[a],n.uris[a-1]);var u=new me(n.uris[a]),l=u.fc,d=!1;l||(ve(u,l=(l=location.protocol).slice(0,-1)),n.uris[a]=u.toString()),l=l.toLowerCase();var c=(l=Ji.get(l))?l.Af:null;if(!c)return Ri(new Ke(2,1,1e3,u));var h=l.Gk;(u=e.l.get(u.Eb))&&(n.headers["common-access-token"]=u);var p,f=null,g=null,m=!1,v=!1;return Di(ki(i)).Xa(function(){if(e.j)return _i();p=Date.now();var i=0;n.requestStartTime=Date.now();var o=c(n.uris[a],n,t,function(a,o,u){f&&f.stop(),g&&g.ka(l/1e3),e.o&&t==Yi&&(i++,n.packetNumber=i,e.o(a,o,Wi(r),n,r),d=!0,s.g=u)},function(r){v=!0,n.timeToFirstByte=Date.now()-n.requestStartTime,e.m&&e.m(r,n,t)},{minBytesForProgressEvents:e.i.minBytesForProgressEvents});if(!h)return o;var u=n.retryParameters.connectionTimeout;u&&(f=new Rr(function(){m=!0,o.abort()})).ka(u/1e3);var l=n.retryParameters.stallTimeout;return l&&(g=new Rr(function(){m=!0,o.abort()})),o}).Xa(function(r){f&&f.stop(),g&&g.stop(),null==r.timeMs&&(r.timeMs=Date.now()-p);var i=r.headers["common-access-token"];if(i){var a=new me(r.uri);e.l.set(a.Eb,i)}return i={response:r,hk:d},!v&&e.m&&e.m(r.headers,n,t),e.B&&e.B(n,r),i},function(u){if(f&&f.stop(),g&&g.stop(),e.C){var l=null,d=0;u instanceof Ke&&(l=u,1001==u.code&&(d=u.data[1])),e.C(n,l,d,m)}if(e.j)return _i();if(m&&(u=new Ke(1,1,1003,n.uris[a],t)),u instanceof Ke){if(7001==u.code)throw u;if(1010==u.code)throw o;if(1==u.severity){if((l=new Ni("retry",l=(new Map).set("error",u))).cancelable=!0,e.dispatchEvent(l),l.defaultPrevented)throw u;return a=(a+1)%n.uris.length,Xi(e,t,n,r,i,a,u,s)}}throw u})}function Wi(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.Xc)return!1}return!0}function Ki(){this.g=0}function qi(e,t,n){Mi.call(this,e,t),this.h=n}Bi.prototype.addEventListener=function(e,t){this.ab&&this.ab.push(e,t)},Bi.prototype.removeEventListener=function(e,t){this.ab&&this.ab.remove(e,t)},Bi.prototype.dispatchEvent=function(e){if(!this.ab)return!0;var t=this.ab.get(e.type)||[],n=this.ab.get("All");for(n&&(t=t.concat(n)),n=(t=g(t)).next();!n.done;n=t.next()){n=n.value,e.target=this.Ie,e.currentTarget=this.Ie;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(r){}if(e.g)break}return e.defaultPrevented},Bi.prototype.release=function(){this.ab=null},ji.prototype.destroy=function(){for(var e=[],t=g(this.g),n=t.next();!n.done;n=t.next())(n=n.value).promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)},p(Vi,Bi),(i=Vi.prototype).configure=function(e){this.i=e},i.Jk=function(e){this.g.add(e)},i.il=function(e){this.g.delete(e)},i.tj=function(){this.g.clear()},i.Kk=function(e){this.h.add(e)},i.jl=function(e){this.h.delete(e)},i.uj=function(){this.h.clear()},i.Uh=function(){this.l.clear()},i.destroy=function(){return this.j=!0,this.g.clear(),this.h.clear(),this.l.clear(),Bi.prototype.release.call(this),this.u.destroy()},i.request=function(e,t,n){var r=this,i=new Ki;if(this.j){var a=Promise.reject(new Ke(2,7,7001));return a.catch(function(){}),new qi(a,function(){return Promise.resolve()},i)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Kt(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},t.uris=Kt(t.uris),a=function(e,t,n,r){function i(e){a=a.Xa(function(){return n.body&&(n.body=Le(n.body)),e(t,n,r)})}var a=Pi(void 0);e.F&&i(e.F);for(var o=(e=g(e.g)).next();!o.done;o=e.next())i(o.value);return a.Xa(void 0,function(e){if(e instanceof Ke&&7001==e.code)throw e;throw new Ke(2,1,1006,e)})}(this,e,t,n);var o=a.Xa(function(){return Xi(r,e,t,n,new Ei(t.retryParameters,!1),0,null,i)}),s=o.Xa(function(t){return function(e,t,n,r){for(var i=Pi(void 0),a=(e=g(e.h)).next(),o={};!a.done;o={Ni:void 0},a=e.next())o.Ni=a.value,i=i.Xa(function(e){return function(){var i=n.response;return i.data&&(i.data=Le(i.data)),(0,e.Ni)(t,i,r)}}(o));return i.Xa(function(){return n},function(e){var t=2;if(e instanceof Ke){if(7001==e.code)throw e;t=e.severity}throw new Ke(t,1,1007,e)})}(r,e,t,n)}),u=Date.now(),l=0;a.promise.then(function(){l=Date.now()-u},function(){});var d=0;o.promise.then(function(){d=Date.now()},function(){});var c=s.Xa(function(i){var a=Date.now()-d,o=i.response;return o.timeMs+=l,o.timeMs+=a,i.hk||!r.o||o.fromCache||"HEAD"==t.method||e!=Yi||r.o(o.timeMs,o.data.byteLength,Wi(n),t,n),r.G&&r.G(e,o,n),o},function(e){throw e&&(e.severity=2),e});return a=new qi(c.promise,function(){return c.abort()},i),Fi(this.u,a),a},V("shaka.net.NetworkingEngine",Vi),Vi.prototype.request=Vi.prototype.request,Vi.prototype.destroy=Vi.prototype.destroy,Vi.makeRequest=zi,Vi.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},Vi.prototype.clearCommonAccessTokenMap=Vi.prototype.Uh,Vi.prototype.clearAllResponseFilters=Vi.prototype.uj,Vi.prototype.unregisterResponseFilter=Vi.prototype.jl,Vi.prototype.registerResponseFilter=Vi.prototype.Kk,Vi.prototype.clearAllRequestFilters=Vi.prototype.tj,Vi.prototype.unregisterRequestFilter=Vi.prototype.il,Vi.prototype.registerRequestFilter=Vi.prototype.Jk,Vi.unregisterScheme=function(e){Ji.delete(e)},Vi.registerScheme=Hi,Vi.prototype.configure=Vi.prototype.configure,Vi.NumBytesRemainingClass=Ki,p(qi,Mi),Vi.PendingRequest=qi;var Yi=1;Vi.RequestType={MANIFEST:0,SEGMENT:Yi,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8,CMCD:9},Vi.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12};var $i=3;Vi.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:$i};var Ji=new Map;function Qi(e){this.g=!1,this.h=new Ci,this.i=e}function Zi(e,t){if(e.g){if(t instanceof Ke&&7003==t.code)throw t;throw new Ke(2,7,7003,t)}}function ea(e,t){for(var n=[],r=(e=g(e)).next();!r.done;r=e.next())n.push(t(r.value));return n}function ta(e){for(var t=new Map,n=g(Object.keys(e)),r=n.next();!r.done;r=n.next())r=r.value,t.set(r,e[r]);return t}function na(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}function ra(e,t){this.h=Ue(e),this.i=t==aa,this.g=0}function ia(){return new Ke(2,3,3e3)}Qi.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))},(i=ra.prototype).Ia=function(){return this.g<this.h.byteLength},i.Pa=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.Y=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(t){throw ia()}},i.Ca=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(t){throw ia()}},i.U=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(t){throw ia()}},i.bh=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(t){throw ia()}},i.Ed=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(n){throw ia()}if(t>2097151)throw new Ke(2,3,3001);return this.g+=8,4294967296*t+e},i.Ub=function(e,t){if(this.g+e>this.h.byteLength)throw ia();var n=Ne(this.h,this.g,e);return this.g+=e,t?new Uint8Array(n):n},i.skip=function(e){if(this.g+e>this.h.byteLength)throw ia();this.g+=e},i.Oi=function(e){if(this.g<e)throw ia();this.g-=e},i.seek=function(e){if(e<0||e>this.h.byteLength)throw ia();this.g=e},i.Yc=function(){for(var e=this.g;this.Ia()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=Ne(this.h,e,this.g-e),this.g+=1,Ye(e)},V("shaka.util.DataViewReader",ra),ra.prototype.readTerminatedString=ra.prototype.Yc,ra.prototype.seek=ra.prototype.seek,ra.prototype.rewind=ra.prototype.Oi,ra.prototype.skip=ra.prototype.skip,ra.prototype.readBytes=ra.prototype.Ub,ra.prototype.readUint64=ra.prototype.Ed,ra.prototype.readInt32=ra.prototype.bh,ra.prototype.readUint32=ra.prototype.U,ra.prototype.readUint16=ra.prototype.Ca,ra.prototype.readUint8=ra.prototype.Y,ra.prototype.getLength=ra.prototype.getLength,ra.prototype.getPosition=ra.prototype.Pa,ra.prototype.hasMoreData=ra.prototype.Ia;var aa=1;function oa(){this.i=new Map,this.h=new Map,this.g=!1}function sa(e){for(var t=fa(e);e.reader.Ia()&&!e.parser.g;)e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function ua(e){for(var t=fa(e),n=e.reader.U(),r=0;r<n&&(e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial),!e.parser.g);r++);}function la(e){var t=fa(e);for(e.reader.skip(78);e.reader.Ia()&&!e.parser.g;)e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function da(e){var t=fa(e);e.reader.skip(8);var n=e.reader.Ca();for(e.reader.skip(6),2==n?e.reader.skip(48):e.reader.skip(12),1==n&&e.reader.skip(16);e.reader.Ia()&&!e.parser.g;)e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function ca(e,t){return function(n){e(n.reader.Ub(n.reader.getLength()-n.reader.Pa(),t))}}function ha(e){for(var t=0,n=(e=g(e)).next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function pa(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function fa(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}ra.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:aa},(i=oa.prototype).box=function(e,t){return e=ha(e),this.i.set(e,ga),this.h.set(e,t),this},i.S=function(e,t){return e=ha(e),this.i.set(e,ma),this.h.set(e,t),this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new ra(e,0),this.g=!1;e.Ia()&&!this.g;)this.Bd(0,e,t,n)},i.Bd=function(e,t,n,r){var i=t.Pa();if(r&&i+8>t.getLength())this.g=!0;else{var a=t.U(),o=t.U(),s=pa(o),u=!1;switch(a){case 0:a=t.getLength()-i;break;case 1:if(r&&t.Pa()+8>t.getLength())return void(this.g=!0);a=t.Ed(),u=!0}var l=this.h.get(o);if(l){var d=null,c=null;if(this.i.get(o)==ma){if(r&&t.Pa()+4>t.getLength())return void(this.g=!0);d=(c=t.U())>>>24,c&=16777215}o=i+a,n&&o>t.getLength()&&(o=t.getLength()),r&&o>t.getLength()?this.g=!0:(o-=t.Pa(),l({name:s,parser:this,partialOkay:n||!1,stopOnPartial:r||!1,version:d,flags:c,reader:t=new ra(t=o>0?t.Ub(o,!1):new Uint8Array(0),0),size:a,start:i+e,has64BitSize:u}))}else t.skip(Math.min(i+a-t.Pa(),t.getLength()-t.Pa()))}},V("shaka.util.Mp4Parser",oa),oa.headerSize=fa,oa.typeToString=pa,oa.allData=ca,oa.audioSampleEntry=da,oa.visualSampleEntry=la,oa.sampleDescription=ua,oa.children=sa,oa.prototype.parseNext=oa.prototype.Bd,oa.prototype.parse=oa.prototype.parse,oa.prototype.stop=oa.prototype.stop,oa.prototype.fullBox=oa.prototype.S,oa.prototype.box=oa.prototype.box;var ga=0,ma=1;function va(e){var t=this;this.g=[],this.h=[],this.data=[],(new oa).box("moov",sa).box("moof",sa).S("pssh",function(e){if(!(e.version>1)){var n=Ne(e.reader.h,-12,e.size);if(t.data.push(n),n=e.reader.Ub(16,!1),t.g.push(ut(n)),e.version>0){n=e.reader.U();for(var r=0;r<n;r++){var i=e.reader.Ub(16,!1);i=ut(i),t.h.push(i)}}}}).parse(e)}function ya(e,t,n,r){var i=e.length,a=12+t.length+4+i;r>0&&(a+=4+16*n.size);var o=new Uint8Array(a),s=Ue(o),u=0;if(s.setUint32(u,a),u+=4,s.setUint32(u,1886614376),u+=4,r<1?s.setUint32(u,0):s.setUint32(u,16777216),u+=4,o.set(t,u),u+=t.length,r>0)for(s.setUint32(u,n.size),u+=4,n=(t=g(n)).next();!n.done;n=t.next())n=st(n.value),o.set(n,u),u+=n.length;return s.setUint32(u,i),o.set(e,u+4),o}function ba(e){var t=this;this.F=e,this.l=this.B=null,this.$=this.T=!1,this.J=0,this.g=null,this.o=new ne,this.i=new Map,this.X=[],this.C=new Map,this.K=!1,this.m=new Ci,this.h=null,this.u=function(n){2==n.severity&&t.m.reject(n),e.onError(n)},this.ba=new Map,this.ma=new Map,this.M=new Rr(function(){return function(e){var t=e.ba,n=e.ma;n.clear(),t.forEach(function(e,t){return n.set(t,e)}),(t=Array.from(n.values())).length&&t.every(function(e){return"expired"==e})&&e.u(new Ke(2,6,6014)),e.F.yf(na(n))}(t)}),this.R=!1,this.N=[],this.oa=!1,this.G=new Rr(function(){!function(e){e.i.forEach(function(t,n){var r=t.Xg,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.F.onExpirationUpdated(n.sessionId,i),t.Xg=i)})}(t)}),this.m.catch(function(){}),this.j=new Qi(function(){return function(e){return P(function(t){switch(t.g){case 1:return e.o.release(),e.o=null,e.m.reject(),e.G.stop(),e.G=null,e.M.stop(),e.M=null,x(t,La(e),2);case 2:if(!e.l){t.A(3);break}return w(t,4),x(t,e.l.setMediaKeys(null),6);case 6:A(t,5);break;case 4:E(t);case 5:e.l=null;case 3:e.g=null,e.B=null,e.C=new Map,e.h=null,e.u=function(){},e.F=null,e.O=!1,e.I=null,T(t)}})}(t)}),this.O=!1,this.H=this.I=null,this.V=function(){return!1}}function xa(e,t,n,r){r=void 0===r||r,e.C=new Map;for(var i=(n=g(n)).next();!i.done;i=n.next())e.C.set(i.value,{initData:null,initDataType:null});for(i=(n=g(e.h.persistentSessionsMetadata)).next();!i.done;i=n.next())i=i.value,e.C.set(i.sessionId,{initData:i.initData,initDataType:i.initDataType});return e.R=e.C.size>0,Ta(e,t,r)}function Ta(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,T;return P(function(w){if(1==w.g){for(Ba(e.h.clearKeys,t),r=t.some(function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)}),i=ta(e.h.servers),a=ta(e.h.advanced||{}),!r&&n&&function(e,t){var n=[];for(t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=g(e),t=e.next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}(t,i),o=new WeakSet,s=g(t),u=s.next();!u.done;u=s.next())for(l=u.value,d=Na(l),c=g(d),h=c.next();!h.done;h=c.next())p=h.value,o.has(p)||(o.add(p),Ua(p,i,a,e.h.keySystemsMapping));for(f=function(t,n){for(var r=[],i=(t=g(t)).next();!i.done;i=t.next()){var o,s=(i=i.value)[n]||a.has(i.keySystem)&&a.get(i.keySystem)[n]||"";if((o=""==s)&&(o=!!(o=i.keySystem)&&!!o.match(/^com\.widevine\.alpha/)),o&&("audioRobustness"==n?s=[e.h.defaultAudioRobustnessForWidevine]:"videoRobustness"==n&&(s=[e.h.defaultVideoRobustnessForWidevine])),"string"==typeof s)r.push(i);else if(Array.isArray(s))for(0===s.length&&(s=[""]),o=(s=g(s)).next();!o.done;o=s.next()){var u={};r.push(Object.assign({},i,(u[n]=o.value,u)))}}return r},m=new WeakSet,v=g(t),y=v.next();!y.done;y=v.next())(b=y.value).video&&!m.has(b.video)&&(b.video.drmInfos=f(b.video.drmInfos,"videoRobustness"),b.video.drmInfos=f(b.video.drmInfos,"audioRobustness"),m.add(b.video)),b.audio&&!m.has(b.audio)&&(b.audio.drmInfos=f(b.audio.drmInfos,"videoRobustness"),b.audio.drmInfos=f(b.audio.drmInfos,"audioRobustness"),m.add(b.audio));return x(w,Qr(t,e.R,e.O,e.h.preferredKeySystems),2)}return Zi(e.j),r||i.size>0?(T=ka(e,t),w.return(r?T:T.catch(function(){}))):(e.T=!0,w.return(Promise.resolve()))})}function wa(e){var t;return P(function(n){switch(n.g){case 1:if(e.l.mediaKeys)return n.return();if(!e.I){n.A(2);break}return x(n,e.I,3);case 3:return Zi(e.j),n.return();case 2:return w(n,4),e.I=e.l.setMediaKeys(e.B),x(n,e.I,6);case 6:A(n,5);break;case 4:t=E(n),e.u(new Ke(2,6,6003,t.message));case 5:Zi(e.j),T(n)}})}function Sa(e){var t,n,r,i;return P(function(a){if(1==a.g)return e.C.size?(e.C.forEach(function(t,n){Ma(e,n,t)}),x(a,e.m,3)):a.A(2);if(2!=a.g){if((e.g&&e.g.keyIds||new Set([])).size>0&&function(e){for(var t=g(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.ba.get(n.value))return!1;return!0}(e))return a.return(e.m);e.K=!1,e.m=new Ci,e.m.catch(function(){})}for(t=(e.g?e.g.initData:[])||[],n=g(t),r=n.next();!r.done;r=n.next())i=r.value,Aa(e,i.initDataType,i.initData);return Oa(e)&&e.m.resolve(),a.return(e.m)})}function Aa(e,t,n){if(n.length){try{n=e.h.initDataTransform(n,t,e.g)}catch(o){return t=o,o instanceof Ke||(t=new Ke(2,6,6016,o)),void e.u(t)}if(e.h.ignoreDuplicateInitData){for(var r=e.i.values(),i=(r=g(r)).next();!i.done;i=r.next())if(De(n,i.value.initData))return;var a=!1;if(e.C.forEach(function(e){!a&&De(n,e.initData)&&(a=!0)}),a)return}e.K=!0,e.i.size>0&&Oa(e)&&(e.m.resolve(),e.K=!1,e.m=new Ci,e.m.catch(function(){})),function(e,t,n,r){try{var i=e.B.createSession(r)}catch(a){return void e.u(new Ke(2,6,6005,a.message))}e.o.D(i,"message",function(t){Ra(e)?e.N.push(t):_a(e,t)}),e.o.D(i,"keystatuseschange",function(t){return Pa(e,t)}),e.i.set(i,{initData:n,initDataType:t,loaded:!1,Xg:1/0,Lb:null,type:r}),e.h.logLicenseExchange&&at(n),i.generateRequest(t,n).catch(function(t){if(!e.j.g){e.i.delete(i);var n=t.errorCode;if(n&&n.systemCode){var r=n.systemCode;r<0&&(r+=4294967296),r="0x"+r.toString(16)}e.u(new Ke(2,6,6006,t.message,t,r))}})}(e,t,n,e.g.sessionType)}}function Ea(e){return e=ea(e=e.i.keys(),function(e){return e.sessionId}),Array.from(e)}function ka(t,n){var r,i,a,o,s,u;return P(function(l){switch(l.g){case 1:if(r=new Map,i=function(e,t,n){for(var r=g(t),i=r.next();!i.done;i=r.next())for(var a=(i=g(Na(i.value))).next();!a.done;a=i.next())a=a.value,n.has(a.keySystem)||n.set(a.keySystem,[]),n.get(a.keySystem).push(a);if(1==n.size&&n.has(""))throw new Ke(2,6,6e3);(r=e.h.preferredKeySystems).length||1==(i=ta(e.h.servers)).size&&(r=Array.from(i.keys()));var o=(i=g(r)).next();for(a={};!o.done;a={Ii:void 0},o=i.next()){a.Ii=o.value;for(var s=(o=g(t)).next();!s.done;s=o.next())if(s=s.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.Ii}}(a)))return s.keySystemAccess}for(i=g([!0,!1]),a=i.next();!a.done;a=i.next())for(a=a.value,o=g(t),s=o.next();!s.done;s=o.next())for(var u=(s=g(s.value.decodingInfos)).next();!u.done;u=s.next())if((u=u.value).supported&&u.keySystemAccess){var l=u.keySystemAccess.keySystem;if(!r.includes(l)){var d=n.get(l);for(!d&&e.h.keySystemsMapping[l]&&(d=n.get(e.h.keySystemsMapping[l])),d=(l=g(d)).next();!d.done;d=l.next())if(!!d.value.licenseServerUri==a)return u.keySystemAccess}}return null}(t,n,r),!i){if(!navigator.requestMediaKeySystemAccess)throw new Ke(2,6,6020);throw new Ke(2,6,6001)}Zi(t.j),w(l,2),i.getConfiguration();var d=a=t.h.keySystemsMapping[i.keySystem]||i.keySystem,c=r.get(a),h=[],p=[],f=[],v=[],y=[],b=new Set,T=new Set;!function(t,n,r,i,a,o,s,u){for(var l=[],d=(t=g(t)).next(),c={};!d.done;c={La:void 0},d=t.next()){if(c.La=d.value,n.includes(c.La.encryptionScheme)||n.push(c.La.encryptionScheme),"org.w3.clearkey"==c.La.keySystem&&c.La.licenseServerUri.startsWith("data:application/json;base64,")?l.includes(c.La.licenseServerUri)||l.push(c.La.licenseServerUri):r.includes(c.La.licenseServerUri)||r.push(c.La.licenseServerUri),a.includes(c.La.serverCertificateUri)||a.push(c.La.serverCertificateUri),c.La.serverCertificate&&(i.some(function(e){return function(t){return De(t,e.La.serverCertificate)}}(c))||i.push(c.La.serverCertificate)),c.La.initData)for(var h=(d=g(c.La.initData)).next(),p={};!h.done;p={Og:void 0},h=d.next())p.Og=h.value,o.some(function(e){return function(t){var n=e.Og;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&De(t.initData,n.initData)}}(p))||o.push(p.Og);if(c.La.keyIds)for(h=(d=g(c.La.keyIds)).next();!h.done;h=d.next())s.add(h.value);if(c.La.keySystemUris&&u)for(d=(c=g(c.La.keySystemUris)).next();!d.done;d=c.next())u.add(d.value)}if(1==l.length)r.push(l[0]);else if(l.length>0){for(n=[],i=(l=g(l)).next();!i.done;i=l.next())i=e.atob(i.value.split("data:application/json;base64,").pop()),i=JSON.parse(i),n.push.apply(n,m(i.keys));l=JSON.stringify({keys:n}),r.push("data:application/json;base64,"+e.btoa(l))}}(c,h,p,v,f,y,b,T);var S=t.R?"persistent-license":"temporary";for(d={keySystem:d,encryptionScheme:h[0],licenseServerUri:p[0],distinctiveIdentifierRequired:c[0].distinctiveIdentifierRequired,persistentStateRequired:c[0].persistentStateRequired,sessionType:c[0].sessionType||S,audioRobustness:c[0].audioRobustness||"",videoRobustness:c[0].videoRobustness||"",serverCertificate:v[0],serverCertificateUri:f[0],initData:y,keyIds:b},T.size>0&&(d.keySystemUris=T),T=(c=g(c)).next();!T.done;T=c.next())(T=T.value).distinctiveIdentifierRequired&&(d.distinctiveIdentifierRequired=T.distinctiveIdentifierRequired),T.persistentStateRequired&&(d.persistentStateRequired=T.persistentStateRequired);if(t.g=d,!t.g.licenseServerUri)throw new Ke(2,6,6012,t.g.keySystem);return x(l,i.createMediaKeys(),4);case 4:if(o=l.h,Zi(t.j),t.B=o,""==t.h.minHdcpVersion||!("getStatusForPolicy"in t.B)){l.A(5);break}return w(l,6),x(l,t.B.getStatusForPolicy({minHdcpVersion:t.h.minHdcpVersion}),8);case 8:if("usable"!=l.h)throw new Ke(2,6,6018);Zi(t.j),A(l,5,2);break;case 6:if((s=E(l,2))instanceof Ke)throw s;throw new Ke(2,6,6019,s.message);case 5:return t.T=!0,t.G.Ea(t.h.updateExpirationTime),x(l,function(e){var t,n;return P(function(r){switch(r.g){case 1:if(!e.B||!e.g)return r.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){r.A(2);break}return t=zi([e.g.serverCertificateUri],e.h.retryParameters),w(r,3),x(r,e.F.vc.request(5,t,{isPreload:e.V()}).promise,5);case 5:n=r.h,e.g.serverCertificate=Ne(n.data),A(r,4);break;case 3:throw new Ke(2,6,6017,E(r));case 4:if(e.j.g)return r.return();case 2:return e.g.serverCertificate&&e.g.serverCertificate.length?(w(r,6),x(r,e.B.setServerCertificate(e.g.serverCertificate),8)):r.return();case 8:A(r,0);break;case 6:throw new Ke(2,6,6004,E(r).message)}})}(t),9);case 9:Zi(t.j),A(l,0);break;case 2:if(u=E(l),Zi(t.j,u),t.g=null,u instanceof Ke)throw u;throw new Ke(2,6,6002,u.message)}})}function Ia(e){Oa(e)&&e.m.resolve()}function Ca(e,t){new Rr(function(){t.loaded=!0,Ia(e)}).ka(Fa)}function Ma(e,t,n){var r,i,a,o,s,u,l;return P(function(d){switch(d.g){case 1:try{r=e.B.createSession("persistent-license")}catch(c){return i=new Ke(2,6,6005,c.message),e.u(i),d.return(Promise.reject(i))}return e.o.D(r,"message",function(t){Ra(e)?e.N.push(t):_a(e,t)}),e.o.D(r,"keystatuseschange",function(t){return Pa(e,t)}),a={initData:n.initData,initDataType:n.initDataType,loaded:!1,Xg:1/0,Lb:null,type:"persistent-license"},e.i.set(r,a),w(d,2),x(d,r.load(t),4);case 4:return o=d.h,Zi(e.j),o||(e.i.delete(r),s=e.h.persistentSessionOnlinePlayback?1:2,e.u(new Ke(s,6,6013)),a.loaded=!0),Ca(e,a),Ia(e),d.return(r);case 2:u=E(d),Zi(e.j,u),e.i.delete(r),l=e.h.persistentSessionOnlinePlayback?1:2,e.u(new Ke(l,6,6005,u.message)),a.loaded=!0,Ia(e);case 3:return d.return(Promise.resolve())}})}function Ra(e){return e.l?e.h.delayLicenseRequestUntilPlayed&&e.l.paused&&!e.oa:!e.$&&e.h.delayLicenseRequestUntilPlayed}function _a(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y;P(function(b){switch(b.g){case 1:if(n=t.target,e.h.logLicenseExchange&&at(t.message),r=e.i.get(n),i=e.g.licenseServerUri,a=e.h.advanced[e.g.keySystem],"individualization-request"==t.messageType&&a&&a.individualizationServer&&(i=a.individualizationServer),(o=zi([i],e.h.retryParameters)).body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,o.drmInfo=e.g,r&&(o.initData=r.initData,o.initDataType=r.initDataType),a&&a.headers)for(s in a.headers)o.headers[s]=a.headers[s];if("org.w3.clearkey"===e.g.keySystem){var S=o,k=e.g;try{var I=Je(S.body);if(I){var C=JSON.parse(I);C.type||(C.type=k.sessionType,S.body=Qe(JSON.stringify(C)))}}catch(M){}}if(Ve(e.g.keySystem))if((S=$e(o.body,!0,!0)).includes("PlayReadyKeyMessage")){for(I=(k=g(k=an(S=Jt(S,"PlayReadyKeyMessage"),"HttpHeader"))).next();!I.done;I=k.next())I=an(C=I.value,"name")[0],C=an(C,"value")[0],o.headers[nn(I)]=nn(C);S=an(S,"Challenge")[0],o.body=ot(nn(S))}else o.headers["Content-Type"]="text/xml; charset=utf-8";return u=Date.now(),w(b,2),d=e.F.vc.request(2,o,{isPreload:e.V()}),e.X.push(d),x(b,d.promise,4);case 4:l=b.h,Q(e.X,d),A(b,3);break;case 2:return c=E(b),e.j.g||(h={sessionId:n.sessionId,sessionType:r.type,initData:r.initData,initDataType:r.initDataType},p=new Ke(2,6,6007,c,h),1==e.i.size?(e.u(p),r&&r.Lb&&r.Lb.reject(p)):(r&&r.Lb&&r.Lb.reject(p),e.i.delete(n),Oa(e)&&(e.m.resolve(),e.M.ka(.1)))),b.return();case 3:return e.j.g?b.return():(e.J+=(Date.now()-u)/1e3,e.h.logLicenseExchange&&at(l.data),w(b,5),x(b,n.update(l.data),7));case 7:A(b,6);break;case 5:return m=(f=E(b))&&f.message||String(f),v=new Ke(2,6,6008,m),e.u(v),r&&r.Lb&&r.Lb.reject(v),b.return();case 6:if(e.j.g)return b.return();y=new Ni("drmsessionupdate"),e.F.onEvent(y),r&&(r.Lb&&r.Lb.resolve(),Ca(e,r)),T(b)}})}function Pa(e,t){t=t.target;var n=e.i.get(t),r=!1;t.keyStatuses.forEach(function(t,i){if("string"==typeof i){var a=i;i=t,t=a}if(a=oe(),Ve(e.g.keySystem)&&16==i.byteLength&&a.Ef()){var o=(a=Ue(i)).getUint32(0,!0),s=a.getUint16(4,!0),u=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,s,!1),a.setUint16(6,u,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(r=!0),i=ut(i).slice(0,32),e.ba.set(i,t)});var i=t.expiration-Date.now();(i<0||r&&i<1e3)&&n&&!n.Lb&&(e.i.delete(t),Da(t)),Oa(e)&&(e.m.resolve(),e.M.ka(Va))}function Da(e){return P(function(t){return 1==t.g?(w(t,2),x(t,Lr(ja,Promise.all([e.close().catch(function(){}),e.closed])),4)):2!=t.g?A(t,0):(E(t),void T(t))})}function La(e){var t;return P(function(n){return t=Array.from(e.i.entries()),e.i.clear(),x(n,Promise.all(t.map(function(t){var n=(t=g(t)).next().value,r=t.next().value;return P(function(t){return 1==t.g?(w(t,2),e.$||e.C.has(n.sessionId)||"persistent-license"!==r.type||e.h.persistentSessionOnlinePlayback?x(t,Da(n),5):x(t,n.remove(),5)):2!=t.g?A(t,0):(E(t),void T(t))})})),0)})}function Na(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Oa(e){return function(e,t){for(var n=(e=g(e)).next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}(e=e.i.values(),function(e){return e.loaded})}function Ua(t,n,r,i){var a=t.keySystem;!a||"org.w3.clearkey"==a&&t.licenseServerUri||(n.size&&n.get(a)&&(n=n.get(a),t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(r=r.get(a))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=r.persistentStateRequired),t.serverCertificate||(t.serverCertificate=r.serverCertificate),r.sessionType&&(t.sessionType=r.sessionType),t.serverCertificateUri||(t.serverCertificateUri=r.serverCertificateUri)),i[a]&&(t.keySystem=i[a]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==a&&(t.keySystem="com.chromecast.playready"))}function Ba(e,t){if(0!=(e=ta(e)).size){e=ht(e);for(var n=(t=g(t)).next();!n.done;n=t.next())(n=n.value).video&&(n.video.drmInfos=[e]),n.audio&&(n.audio.drmInfos=[e])}}(i=ba.prototype).destroy=function(){return this.j.destroy()},i.configure=function(e,t){this.h=e,t&&(this.V=t),this.G&&this.T&&this.g&&this.G.Ea(this.h.updateExpirationTime)},i.Wb=function(e){var t,n,r=this;return P(function(i){if(1==i.g)return r.l===e?i.return():r.B?(r.l=e,r.h.delayLicenseRequestUntilPlayed&&r.o.Aa(r.l,"play",function(){for(var e=g(r.N),t=e.next();!t.done;t=e.next())_a(r,t.value);r.oa=!0,r.N=[]}),r.l.remote?(r.o.D(r.l.remote,"connect",function(){return La(r)}),r.o.D(r.l.remote,"connecting",function(){return La(r)}),r.o.D(r.l.remote,"disconnect",function(){return La(r)})):"webkitCurrentPlaybackTargetIsWireless"in r.l&&r.o.D(r.l,"webkitcurrentplaybacktargetiswirelesschanged",function(){return La(r)}),r.H=r.g&&r.g.initData.find(function(e){return e.initData.length>0})||null,t=r.g.keySystem,(n=oe().Ug(t))||!r.H&&"com.apple.fps"===r.g.keySystem&&!r.C.size?i.A(2):x(i,wa(r),2)):(r.o.Aa(e,"encrypted",function(){r.u(new Ke(2,6,6010))}),i.return());Sa(r).catch(function(){}),!n&&(r.H||r.C.size||r.h.parseInbandPsshEnabled)||r.o.D(r.l,"encrypted",function(e){return function(e,t){return P(function(n){if(1==n.g)return x(n,wa(e),2);Aa(e,t.initDataType,Ne(t.initData)),T(n)})}(r,e)}),T(i)})},i.Jg=function(){var e=this,t=this.i.keys();return t=ea(t,function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}}),Array.from(t)},i.Yd=function(){for(var e=1/0,t=this.i.keys(),n=(t=g(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.Ze=function(){return na(this.ma)};var ja=1,Fa=5,Va=.5;function Ha(){this.g=Xa,this.j=(new Map).set(Xa,2).set(za,1),this.i=0,this.h=-1}function Ga(e,t){var n=e.g!==t;return e.g=t,n&&t===Xa&&(e.i=Date.now()),n}var za=0,Xa=1;
/*
      		 @license
      		 Shaka Player
      		 Copyright 2023 Google LLC
      		 SPDX-License-Identifier: Apache-2.0
      		*/function Wa(e,t,n){this.g=e,this.i=t,this.h=n}function Ka(e,t){return P(function(n){if(1==n.g)return x(n,qr(e.h,t,e.g.drm.preferredKeySystems,e.g.drm.keySystemsMapping),2);if(e.g.streaming.dontChooseCodecs||Wr(t,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes,e.g.preferredTextFormats),!t.variants.some(ui))throw new Ke(2,4,4032);return n.return(Ya(e,t))})}function qa(e,t){var n=e.g.restrictions;e=e.i;for(var r=!1,i=(t=g(t.variants)).next();!i.done;i=t.next()){var a=(i=i.value).allowedByApplication;i.allowedByApplication=Kr(i,n,e),a!=i.allowedByApplication&&(r=!0)}return r}function Ya(e,t){var n=qa(e,t);if(t){var r=e.h?e.h.g:null;if(r&&e.h.B){for(var i=new Set,a=g(t.variants),o=a.next();!o.done;o=a.next())(o=o.value).audio&&i.add(o.audio),o.video&&i.add(o.video);for(a=(i=g(i)).next();!a.done;a=i.next())$a(e,r.keySystem,a.value)}Ja(e,t)}return n}function $a(e,t,n){for(var r=(n=g(n.drmInfos)).next();!r.done;r=n.next())if((r=r.value).keySystem==t)for(var i=(r=g(r.initData||[])).next();!i.done;i=r.next())i=i.value,Aa(e.h,i.initDataType,i.initData)}function Ja(e,t){function n(e){if(e&&!s.has(e)&&(s.add(e),e.keyIds.size))for(var t=(e=g(e.keyIds)).next();!t.done;t=e.next()){t=t.value;var n=r[i?"00":t];n?Qa.includes(n)&&o.add(n):a.add(t)}}var r=e.h?e.h.Ze():{},i=(e=Object.keys(r)).length&&"00"==e[0];e=!1;for(var a=new Set,o=new Set,s=new WeakSet,u=(t=g(t.variants)).next();!u.done;u=t.next()){if((u=u.value).allowedByApplication){if(u.allowedByKeySystem)return}else e=!0;n(u.audio),n(u.video)}throw new Ke(2,4,4012,e={hasAppRestrictions:e,missingKeys:Array.from(a),restrictedKeyStatuses:Array.from(o)})}var Qa=["output-restricted","internal-error"];function Za(t){if(to.has(t))return to.get(t);var n=e.ManagedMediaSource||e.MediaSource;return!!n&&(n=n.isTypeSupported(t),to.set(t,n),n)}function eo(){var t=e.ManagedMediaSource||e.MediaSource;return!!(t&&t.prototype&&t.prototype.setLiveSeekableRange&&t.prototype.clearLiveSeekableRange)}V("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"});var to=new Map;function no(e,t){var n=null,r=null,i=null,a=null,o=e.U();return 1&t&&(i=e.Ed()),2&t&&(a=e.U()),8&t&&(n=e.U()),16&t&&(r=e.U()),{trackId:o,Vd:n,Wd:r,pj:i,Pi:a}}function ro(e,t){return 1==t?{baseMediaDecodeTime:4294967296*(t=e.U())+(e=e.U())}:{baseMediaDecodeTime:e.U()}}function io(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.U(),e.skip(4),e=e.Ca(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function ao(e,t,n){var r=e.U(),i=[],a=null;1&n&&(a=e.bh()),4&n&&e.skip(4);for(var o=0;o<r;o++){var s={mh:null,sampleSize:null,Ff:null};256&n&&(s.mh=e.U()),512&n&&(s.sampleSize=e.U()),1024&n&&e.skip(4),2048&n&&(s.Ff=0==t?e.U():e.bh()),i.push(s)}return{Fm:r,kh:i,pg:a}}function oo(e){e.skip(6),e.skip(2),e.skip(8);var t=e.Ca();return e.skip(2),e.skip(2),e.skip(2),{channelCount:t,sampleRate:e=e.Ca()+e.Ca()/65536}}function so(e){return{codec:pa(e=e.U())}}function uo(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function lo(e){return(e<10?"0":"")+e}function co(e){this.g=e}function ho(e){for(var t=[],n=g(e.g),r=n.next();!r.done;r=n.next()){var i=t,a=i.push,o=r.value;r=wo;var s=o.id+1,u=o.stream.width||0,l=o.stream.height||0;"audio"==o.type&&(l=u=0);var d=o.duration*o.timescale,c=Math.floor(d/(So+1));switch(d=Math.floor(d%(So+1)),s=wo("tkhd",s=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(m(bo(s,4)),[0,0,0,0],m(bo(c,4)),m(bo(d,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],m(bo(u,2)),[0,0],m(bo(l,2)),[0,0]))),u=wo,c=o.duration*o.timescale,l=Math.floor(c/(So+1)),c=Math.floor(c%(So+1)),d=(d=o.stream.language).charCodeAt(0)-96<<10|d.charCodeAt(1)-96<<5|d.charCodeAt(2)-96,l=wo("mdhd",l=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(m(bo(o.timescale,4)),m(bo(l,4)),m(bo(c,4)),m(bo(d,2)),[0,0]))),c=o,d=new Uint8Array([]),c.type){case"video":d=Eo.value();break;case"audio":d=ko.value()}c=wo("hdlr",d);e:{switch(o.type){case"video":o=wo("minf",wo("vmhd",_o.value()),No.value(),po(o));break e;case"audio":o=wo("minf",wo("smhd",Po.value()),No.value(),po(o));break e}o=new Uint8Array([])}r=r("trak",s,o=u("mdia",l,c,o)),a.call(i,r)}for(t=lt.apply(rt,m(t)),n=wo,r=(a=e.g[0]).duration*a.timescale,i=Math.floor(r/(So+1)),r=Math.floor(r%(So+1)),i=wo("mvhd",i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(m(bo(a.timescale,4)),m(bo(i,4)),m(bo(r,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))),r=[],u=(e=g(e.g)).next();!u.done;u=e.next())s=(o=r).push,u=wo("trex",u=new Uint8Array([0,0,0,0].concat(m(bo(u.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),s.call(o,u);if(e=wo("mvex",e=lt.apply(rt,m(r))),r=[],a.encrypted){for(o=(a=g(a.stream.drmInfos)).next();!o.done;o=a.next())if((o=o.value).initData)for(s=(o=g(o.initData)).next();!s.done;s=o.next())r.push(s.value.initData);a=lt.apply(rt,m(r))}else a=new Uint8Array([]);return e=n("moov",i,t,e,a),t=Lo.value(),(n=new Uint8Array(t.byteLength+e.byteLength)).set(t),n.set(e,t.byteLength),n}function po(e){var t=wo,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=oe().re()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var r=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){if(n=e.stream.width||0,r=e.stream.height||0,e.Sa.byteLength>0)var i=wo("avcC",e.Sa);else{i=wo;for(var a=7,o=[],s=[],u=0,l=0,d=0,c=0;c<e.Cb.length;c++){var h=xo(e.Cb[c]);switch(31&h[0]){case 7:o.push(h),a+=h.length+2;break;case 8:s.push(h),a+=h.length+2}}for(o.length>0&&(u=o[0][1],d=o[0][2],l=o[0][3]),c=0,(a=new Uint8Array(a))[c++]=1,a[c++]=u,a[c++]=d,a[c++]=l,a[c++]=255,a[c++]=224|o.length,u=0;u<o.length;u++)a[c++]=(65280&o[u].length)>>8,a[c++]=255&o[u].length,a.set(o[u],c),c+=o[u].length;for(a[c++]=s.length,o=0;o<s.length;o++)a[c++]=(65280&s[o].length)>>8,a[c++]=255&s[o].length,a.set(s[o],c),c+=s[o].length;i=i("avcC",a)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(m(bo(n,2)),m(bo(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="avc1",s=fo(e),o=new Uint8Array([]),e.encrypted&&(o=mo(e.stream,e.codecs),r="encv"),r=wo(r,n,i,s,o)}else e.codecs.includes("hvc1")&&(r=e.stream.width||0,i=e.stream.height||0,n=new Uint8Array([]),e.Sa.byteLength>0&&(n=wo("hvcC",e.Sa)),r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(m(bo(r,2)),m(bo(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="hvc1",s=fo(e),o=new Uint8Array([]),e.encrypted&&(o=mo(e.stream,e.codecs),i="encv"),r=wo(i,r,n,s,o));break;case"audio":"mp3"==n?e=wo(".mp3",go(e)):"ac-3"==n?(n=wo("dac3",e.Ga),r="ac-3",i=new Uint8Array([]),e.encrypted&&(i=mo(e.stream,e.codecs),r="enca"),e=wo(r,go(e),n,i)):"ec-3"==n?(n=wo("dec3",e.Ga),r="ec-3",i=new Uint8Array([]),e.encrypted&&(i=mo(e.stream,e.codecs),r="enca"),e=wo(r,go(e),n,i)):"opus"==n?(n=wo("dOps",e.Ga),r="Opus",i=new Uint8Array([]),e.encrypted&&(i=mo(e.stream,e.codecs),r="enca"),e=wo(r,go(e),n,i)):(e.Ga.byteLength>0?n=wo("esds",e.Ga):(n=wo,r=e.id+1,i=e.stream.channelsCount||2,o=e.stream.audioSamplingRate||44100,u=pt("audio",e.codecs.split(",")),s=(l={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12})[o],"mp4a.40.5"!==u&&"mp4a.40.29"!==u||(s=l[2*o]),o=parseInt(u.split(".").pop(),10),n=n("esds",r=new Uint8Array([0,0,0,0,3,25].concat(m(bo(r,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,o<<3|s>>>1,s<<7|i<<3,6,1,2])))),r="mp4a",i=new Uint8Array([]),e.encrypted&&(i=mo(e.stream,e.codecs),r="enca"),e=wo(r,go(e),n,i)),r=e}return t("stbl",e=wo("stsd",Do.value(),r),wo("stts",Io.value()),wo("stsc",Co.value()),wo("stsz",Ro.value()),wo("stco",Mo.value()))}function fo(e){if(!e.Za&&!e.$a)return new Uint8Array([]);var t=e.$a;return wo("pasp",e=new Uint8Array([].concat(m(bo(e.Za,4)),m(bo(t,4)))))}function go(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(m(bo(e.stream.audioSamplingRate||44100,2)),[0,0]))}function mo(e,t){var n=wo;t=wo("frma",t=new Uint8Array([].concat(m(bo(To(t.split(".")[0]),4)))));var r="cenc",i=e.drmInfos[0];i&&i.encryptionScheme&&(r=i.encryptionScheme),r=wo("schm",r=new Uint8Array([0,0,0,0].concat(m(bo(To(r),4)),[0,1,0,0]))),i=wo;for(var a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=(e=g(e.drmInfos)).next();!o.done;o=e.next())if((o=o.value)&&o.keyIds&&o.keyIds.size)for(var s=(o=g(o.keyIds)).next();!s.done;s=o.next())a=xo(s.value);return n("sinf",t,r,i("schi",a=wo("tenc",e=new Uint8Array([0,0,0,0,0,0,1,8]),a)))}function vo(e){for(var t=[],n=(e=g(e.g)).next();!n.done;n=e.next()){n=n.value;var r,i=t.push,a=i.apply,o=wo,s=new Uint8Array([0,0,0,0].concat(m(bo(n.data?n.data.sequenceNumber:0,4))));s=wo("mfhd",s);var u=n.data?n.data.zb:[],l=new Uint8Array(4+u.length);for(r=0;r<u.length;r++){var d=u[r].flags;l[r+4]=d.ib<<4|d.mb<<2|d.jb}var c=(u=wo("sdtp",l)).length+32+20+8+16+8+8;l=wo,r=wo("tfhd",r=new Uint8Array([0,0,0,58].concat(m(bo(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),d=n.data?n.data.baseMediaDecodeTime:0;var h=Math.floor(d%(So+1));d=wo("tfdt",d=new Uint8Array([1,0,0,0].concat(m(bo(Math.floor(d/(So+1)),4)),m(bo(h,4)))));var p=c,f=12+16*(h=(c=n.data?n.data.zb:[]).length),v=new Uint8Array(f);for(p+=8+f,v.set(["video"===n.type?1:0,0,15,1].concat(m(bo(h,4)),m(bo(p,4))),0),p=0;p<h;p++){var y=c[p];f=bo(y.duration,4);var b=bo(y.size,4),x=y.flags;y=bo(y.sb,4),v.set([].concat(m(f),m(b),[x.xb<<2|x.ib,x.mb<<6|x.jb<<4|x.yb,61440&x.hb,15&x.hb],m(y)),12+16*p)}o=o("moof",s,u=l("traf",r,d,c=wo("trun",v),u)),a.call(i,t,[o,yo(n)])}return lt.apply(rt,m(t))}function yo(e){return e=(e.data?e.data.zb:[]).map(function(e){return e.data}),wo("mdat",e=lt.apply(rt,m(e)))}function bo(e,t){var n=[];for(--t;t>=0;t--)n.push(e>>8*t&255);return n}function xo(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function To(e){for(var t=0,n=0;n<e.length;n+=1)t|=e.charCodeAt(n)<<8*(e.length-n-1);return t}function wo(e){var t=D.apply(1,arguments),n=Ao.get(e);n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],Ao.set(e,n));for(var r=8,i=t.length-1;i>=0;i--)r+=t[i].byteLength;for((i=new Uint8Array(r))[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=255&r,i.set(n,4),n=0,r=8;n<t.length;n++)i.set(t[n],r),r+=t[n].byteLength;return i}var So=4294967295,Ao=new Map,Eo=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0])}),ko=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),Io=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),Co=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),Mo=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),Ro=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])}),_o=new ae(function(){return new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}),Po=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),Do=new ae(function(){return new Uint8Array([0,0,0,0,0,0,0,1])}),Lo=new ae(function(){var e=new Uint8Array([105,115,111,109]),t=new Uint8Array([97,118,99,49]);return wo("ftyp",e,new Uint8Array([0,0,0,1]),e,t)}),No=new ae(function(){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);return e=wo("dref",e),wo("dinf",e)});function Oo(e){function t(e){o.push(e),sa(e)}var n,r,i,a,o=[];if((new oa).box("moof",t).box("traf",t).S("tfhd",function(e){n=e,i=no(e.reader,e.flags)}).S("trun",function(e){r=e,a=ao(e.reader,e.version,e.flags)}).parse(e),i&&2!==i.Pi){var s=n.start+fa(n)+4+(null!==i.pj?8:0),u=Ue(e);if(null!==i.Pi)u.setUint32(s,2);else{Bo(e,n.start,n.size+4);var l=u.getUint32(n.start+8);u.setUint32(n.start+8,2|l),a&&null!==a.pg&&u.setInt32(r.start+fa(r)+4,a.pg+4),l=e.subarray(0,s),u=e.subarray(s),(e=new Uint8Array(e.byteLength+4)).set(l),l=[];for(var d=3;d>=0;d--)l.push(2>>8*d&255);for(e.set(new Uint8Array(l),s),e.set(u,s+4),u=(s=g(o)).next();!u.done;u=s.next())Bo(e,(u=u.value).start,u.size+4)}}return e}function Uo(e,t,n,r,i,a){var o=mo(e,r.name),s=t.subarray(r.start,r.start+r.size);for((e=new Uint8Array(r.size+o.byteLength)).set(s,0),Ue(e).setUint32(4,a),e.set(o,r.size),Bo(e,0,e.byteLength),a=new Uint8Array(t.byteLength+e.byteLength),r=oe().hf()?r.start:r.start+r.size,o=t.subarray(r),a.set(t.subarray(0,r)),a.set(e,r),a.set(o,r+e.byteLength),i=(t=g(i)).next();!i.done;i=t.next())Bo(a,(i=i.value).start,i.size+e.byteLength);return e=Ue(a,n.start),n=fa(n),t=e.getUint32(n),e.setUint32(n,t+1),a}function Bo(e,t,n){0!=(t=(e=Ue(e,t)).getUint32(0))&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}function jo(e,t,n,r,i,a,o,s){this.P=e,this.startByte=t,this.endByte=n,this.xd=void 0===r?null:r,this.timescale=void 0===i?null:i,this.h=void 0===a?null:a,this.aesKey=void 0===o?null:o,this.g=this.mimeType=this.codecs=null,this.encrypted=void 0!==s&&s}function Fo(e,t){return e===t||(e&&t?e.Jc()==t.Jc()&&e.Hc()==t.Hc()&&ee(e.P().sort(),t.P().sort())&&De(e.ac(),t.ac()):e==t)}function Vo(e,t,n,r,i,a,o,s,u,l,d,c,h,p,f,m){for(l=void 0===l?[]:l,p=void 0===p?zo:p,this.startTime=e,this.j=this.endTime=t,this.C=n,this.startByte=r,this.endByte=i,this.ea=a,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=u,this.g=l,this.tilesLayout=void 0===d?"":d,this.B=void 0===c?null:c,this.h=void 0===h?null:h,this.status=p,this.preload=!1,this.l=!0,this.o=!1,this.aesKey=void 0===f?null:f,this.thumbnailSprite=null,this.i=-1,this.m=void 0!==m&&m,this.ie=this.Xc=!1,t=(e=g(this.g)).next();!t.done;t=e.next())t.value.xi();this.m&&this.g.length&&this.g[this.g.length-1].wi(),this.u=this.bandwidth=this.mimeType=this.codecs=null,this.F=!1}function Ho(e){if(e.endByte)return e.endByte+1-e.startByte;if(e.bandwidth){var t=e.bandwidth*(e.endTime-e.startTime);if(!isNaN(t)&&t>0)return t}if(e.g.length>0&&e.m)for(e=(e=g(e.g)).next();!e.done;e=e.next()){Ho(e.value);break}return null}function Go(e,t){e.ea=t;for(var n=(e=g(e.g)).next();!n.done;n=e.next())Go(n.value,t)}jo.prototype.Jc=function(){return this.startByte},jo.prototype.Hc=function(){return this.endByte},jo.prototype.se=function(e){this.h=e},jo.prototype.ac=function(){return this.h},V("shaka.media.InitSegmentReference",jo),jo.prototype.getEndByte=jo.prototype.Hc,jo.prototype.getStartByte=jo.prototype.Jc,(i=Vo.prototype).P=function(){return this.C()},i.getStartTime=function(){return this.startTime},i.Ij=function(){return this.endTime},i.Jc=function(){return this.startByte},i.Hc=function(){return this.endByte},i.ck=function(){return this.tilesLayout},i.bk=function(){return this.B},i.Kc=function(){return this.status},i.yk=function(){this.status=Xo},i.Tg=function(){this.preload=!0},i.isPreload=function(){return this.preload},i.wd=function(){this.l=!1},i.nk=function(){return this.l},i.xi=function(){this.Xc=!0},i.qk=function(){return this.Xc},i.wi=function(){this.ie=!0},i.pk=function(){return this.ie},i.ui=function(){this.o=!0},i.ik=function(){return this.o},i.Lf=function(e){this.thumbnailSprite=e},i.Zj=function(){return this.thumbnailSprite},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=g(this.g),n=t.next();!n.done;n=t.next())(n=n.value).startTime+=e,n.endTime+=e,n.j+=e},i.Ch=function(e){null==this.h?W("Sync attempted without sync time!"):(e=this.h-e-this.startTime,Math.abs(e)>=.001&&this.offset(e))},i.se=function(e,t){this.u=e,this.F=void 0!==t&&t},i.ac=function(e){var t=this.u;return(void 0===e||e)&&this.F&&(this.u=null),t},V("shaka.media.SegmentReference",Vo),Vo.prototype.getSegmentData=Vo.prototype.ac,Vo.prototype.setSegmentData=Vo.prototype.se,Vo.prototype.syncAgainst=Vo.prototype.Ch,Vo.prototype.offset=Vo.prototype.offset,Vo.prototype.getThumbnailSprite=Vo.prototype.Zj,Vo.prototype.setThumbnailSprite=Vo.prototype.Lf,Vo.prototype.hasByterangeOptimization=Vo.prototype.ik,Vo.prototype.markAsByterangeOptimization=Vo.prototype.ui,Vo.prototype.isLastPartial=Vo.prototype.pk,Vo.prototype.markAsLastPartial=Vo.prototype.wi,Vo.prototype.isPartial=Vo.prototype.qk,Vo.prototype.markAsPartial=Vo.prototype.xi,Vo.prototype.isIndependent=Vo.prototype.nk,Vo.prototype.markAsNonIndependent=Vo.prototype.wd,Vo.prototype.isPreload=Vo.prototype.isPreload,Vo.prototype.markAsPreload=Vo.prototype.Tg,Vo.prototype.markAsUnavailable=Vo.prototype.yk,Vo.prototype.getStatus=Vo.prototype.Kc,Vo.prototype.getTileDuration=Vo.prototype.bk,Vo.prototype.getTilesLayout=Vo.prototype.ck,Vo.prototype.getEndByte=Vo.prototype.Hc,Vo.prototype.getStartByte=Vo.prototype.Jc,Vo.prototype.getEndTime=Vo.prototype.Ij,Vo.prototype.getStartTime=Vo.prototype.getStartTime,Vo.prototype.getUris=Vo.prototype.P;var zo=0,Xo=1;function Wo(e){return 1==e.length&&e.end(0)-e.start(0)<1e-4}function Ko(e){return!e||Wo(e)?null:1==e.length&&e.start(0)<0?0:e.length?e.start(0):null}function qo(e){return!e||Wo(e)?null:e.length?e.end(e.length-1):null}function Yo(e,t){return!(!e||!e.length||Wo(e)||t>e.end(e.length-1))&&t>=e.start(0)}function $o(e,t){if(!e||!e.length||Wo(e))return 0;for(var n=0,r=(e=g(Jo(e))).next();!r.done;r=e.next()){var i=r.value;r=i.start,(i=i.end)>t&&(n+=i-Math.max(r,t))}return n}function Jo(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Qo(){}function Zo(e,t){var n=document.createElement("source");return n.src=e,n.type=void 0===t?"":t,n}function es(e){for(var t=!1,n=e.getElementsByTagName("source"),r=n.length-1;r>=0;--r)e.removeChild(n[r]),t=!0;return e.src&&(e.removeAttribute("src"),t=!0),t}function ts(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function ns(){return is||(rs||(rs=new Rr(function(){is=null})),(is=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(is=document.createElement("video")),rs.ka(1),is)}Vo.Status={rl:zo,ym:Xo,Ul:2},V("shaka.util.Dom",Qo),Qo.removeAllChildren=ts,Qo.clearSourceFromVideo=es;var rs=null,is=null;
/*
      		 @license
      		 Shaka Player
      		 Copyright 2022 Google LLC
      		 SPDX-License-Identifier: Apache-2.0
      		*/function as(){}function os(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function ss(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function us(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]}function ls(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(e.size<2||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var r=Ye(Ne(e.data,1,n)),i=e.data[2+n],a=e.data.subarray(3+n).indexOf(0);if(-1===a)return null;var o,s=Ye(Ne(e.data,3+n,a));return o="--\x3e"===r?Ye(Ne(e.data,4+n+a)):Le(e.data.subarray(4+n+a)),t.mimeType=r,t.pictureType=i,t.description=s,t.data=o,t}return"TXXX"===e.type||"WXXX"===e.type?e.size<2||3!==e.data[0]||-1===(r=e.data.subarray(1).indexOf(0))?null:(n=Ye(Ne(e.data,1,r)),e=Ye(Ne(e.data,2+r)).replace(/\0*$/,""),t.description=n,t.data=e,t):"PRIV"===e.type?e.size<2||-1===(n=e.data.indexOf(0))?null:(n=Ye(Ne(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=Le(e.data.subarray(n.length+1)),t.data=e),t):"T"===e.type[0]?e.size<2||3!==e.data[0]?null:(e=Ye(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=Ye(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=Le(e.data),t):null}function ds(e){for(var t=0,n=[];os(e,t);){var r=us(e,t+6);for(e[t+5]>>6&1&&(t+=10),r=(t+=10)+r;t+10<r;){var i=e.subarray(t),a=us(i,4);(a=ls(i={type:String.fromCharCode(i[0],i[1],i[2],i[3]),size:a,data:i.subarray(10,10+a)}))&&n.push(a),t+=i.size+10}ss(e,t)&&(t+=10)}return n}function cs(e,t){for(var n=t=void 0===t?0:t,r=0;os(e,t);)e[t+5]>>6&1&&(r+=10),r+=10,r+=us(e,t+6),ss(e,t+10)&&(r+=10),t+=r;return r>0?e.subarray(n,n+r):new Uint8Array([])}function hs(e){return new Date(Date.UTC(1900,0,1,0,0,0,0)+e).getTime()}function ps(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,r=0;r<e.byteLength;r++)r>=2&&3==e[r]&&0==e[r-1]&&0==e[r-2]||(t[n]=e[r],n++);this.j=Ne(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function fs(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),r=Math.min(4,e.i);0!==r&&(n.set(e.j.subarray(t,t+r)),e.h=new ra(n,0).U(),e.g=8*r,e.i-=r)}function gs(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,fs(e)}e.h<<=t,e.g-=t}function ms(e,t){var n=Math.min(e.g,t),r=e.h>>>32-n;return e.g-=n,e.g>0?e.h<<=n:e.i>0&&fs(e),(n=t-n)>0?r<<n|ms(e,n):r}function vs(e){var t;for(t=0;t<e.g;++t)if(e.h&2147483648>>>t)return e.h<<=t,e.g-=t,t;return fs(e),t+vs(e)}function ys(e){gs(e,1+vs(e))}function bs(e){return ms(e,vs(e)+1)-1}function xs(e){return 1&(e=bs(e))?1+e>>>1:-1*(e>>>1)}function Ts(e){return 1===ms(e,1)}function ws(e){return ms(e,8)}function Ss(e,t){for(var n=8,r=8,i=0;i<t;i++)0!==r&&(r=(n+(r=xs(e))+256)%256),n=0===r?n:r}function As(e){return ws(e),bs(e),bs(e)}function Es(){this.I=null,this.J=!1,this.m=this.K=null,this.j=[],this.g=[],this.C=this.F=null,this.i=[],this.h=[],this.G=null,this.l=[],this.B=this.H=this.o=this.u=null}function ks(e,t){if(1!=(t[0]<<16|t[1]<<8|t[2]))return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var r=t[7];if(192&r){var i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2;null==e.u&&(e.u=i),n.pts=Cs(i,e.u),e.u=n.pts,n.dts=n.pts,64&r&&(r=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,null==e.o&&(e.o=r),n.dts=n.pts!=i?Cs(r,e.o):r),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}function Is(e){var t=e.ud();return t.length>1&&(e=t[0].pts,t=t[1].pts,!isNaN(t-e))?String(Math.abs(1/(t-e)*9e4)):null}function Cs(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e}function Ms(e){return!(Rs(e)<0)}function Rs(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}V("shaka.util.Id3Utils",as),as.getID3Data=cs,as.getID3Frames=ds,V("shaka.util.ExpGolomb",ps),(i=Es.prototype).clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.Jf=function(e){null!=this.B&&this.B!=e&&(this.o=this.u=null),this.B=e},i.parse=function(e){if(e.length<564)return this;for(var t=Math.max(0,Rs(e)),n=e.length-(e.length+t)%188,r=!1,i=t;i<n;i+=188)if(71==e[i]){var a=!!(64&e[i+1]),o=((31&e[i+1])<<8)+e[i+2];if((48&e[i+3])>>4>1){var s=i+5+e[i+4];if(s==i+188)continue}else s=i+4;switch(o){case 0:a&&(s+=e[s]+1),this.I=(31&e[s+10])<<8|e[s+11];break;case 17:case 8191:break;case this.I:a&&(s+=e[s]+1),o={audio:-1,video:-1,ef:-1,audioCodec:"",videoCodec:""};var u=s+3+((15&(a=e)[s+1])<<8|a[s+2])-4;for(s+=12+((15&a[s+10])<<8|a[s+11]);s<u;){var l=(31&a[s+1])<<8|a[s+2],d=(15&a[s+3])<<8|a[s+4];switch(a[s]){case 6:if(d>0)for(var c=s+5,h=d;h>2;){var p=a[c+1]+2;switch(a[c]){case 5:var f=et(a.subarray(c+2,c+p));-1==o.audio&&"Opus"===f?(o.audio=l,o.audioCodec="opus"):-1==o.video&&"AV01"===f&&(o.video=l,o.videoCodec="av1");break;case 106:-1==o.audio&&(o.audio=l,o.audioCodec="ac3");break;case 122:-1==o.audio&&(o.audio=l,o.audioCodec="ec3");break;case 124:-1==o.audio&&(o.audio=l,o.audioCodec="aac");break;case 127:"opus"==o.audioCodec&&(f=null,128===a[c+2]&&(f=a[c+3]),null!=f&&(this.H={channelCount:15&f?15&f:2,sj:f,sampleRate:48e3}))}c+=p,h-=p}break;case 15:-1==o.audio&&(o.audio=l,o.audioCodec="aac");break;case 17:-1==o.audio&&(o.audio=l,o.audioCodec="aac-loas");break;case 21:-1==o.ef&&(o.ef=l);break;case 27:-1==o.video&&(o.video=l,o.videoCodec="avc");break;case 3:case 4:-1==o.audio&&(o.audio=l,o.audioCodec="mp3");break;case 36:-1==o.video&&(o.video=l,o.videoCodec="hvc");break;case 129:-1==o.audio&&(o.audio=l,o.audioCodec="ac3");break;case 132:case 135:-1==o.audio&&(o.audio=l,o.audioCodec="ec3")}s+=d+5}-1!=(a=o).video&&(this.K=a.video,this.m=a.videoCodec),-1!=a.audio&&(this.F=a.audio,this.C=a.audioCodec),-1!=a.ef&&(this.G=a.ef),r&&!this.J&&(r=!1,i=t-188),this.J=!0;break;case this.K:s=e.subarray(s,i+188),a?this.j.push([s]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(s);break;case this.F:s=e.subarray(s,i+188),a?this.i.push([s]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(s);break;case this.G:s=e.subarray(s,i+188),a?this.l.push([s]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(s);break;default:r=!0}}return this},i.Fk=function(e){return ce("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Zg(e,{ke:null,state:null})},i.Zg=function(e,t){var n=e.pts?e.pts/9e4:null,r=(e=e.data).byteLength,i=1;"hvc"==this.m&&(i=2);var a=t.state||0,o=a,s=0,u=[],l=-1,d=0;for(-1==a&&(l=0,d="hvc"==this.m?e[0]>>1&63:31&e[0],a=0,s=1);s<r;){var c=e[s++];a?1===a?a=c?0:2:c?1==c?(c=s-a-1,l>=0?u.push({data:e.subarray(l+i,c),fullData:e.subarray(l,c),type:d,time:n,state:null}):(a=u.length?u[u.length-1]:t.ke)&&(o&&s<=4-o&&a.state&&(a.data=a.data.subarray(0,a.data.byteLength-o),a.fullData=a.fullData.subarray(0,a.fullData.byteLength-o)),c>0&&(c=e.subarray(0,c),a.data=lt(a.data,c),a.fullData=lt(a.fullData,c),a.state=0)),s<r?(d="hvc"==this.m?e[s]>>1&63:31&e[s],l=s,a=0):a=-1):a=0:a=3:a=c?0:1}return l>=0&&a>=0&&u.push({data:e.subarray(l+i,r),fullData:e.subarray(l,r),type:d,time:n,state:a}),!u.length&&t.ke&&(n=u.length?u[u.length-1]:t.ke)&&(n.data=lt(n.data,e),n.fullData=lt(n.fullData,e)),t.state=a,u},i.getMetadata=function(){for(var e=[],t=g(this.l),n=t.next();!n.done;n=t.next())(n=ks(this,n=lt.apply(rt,m(n.value))))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:ds(n.data),dts:n.dts,pts:n.pts});return e},i.ub=function(){if(this.i.length&&!this.h.length)for(var e=g(this.i),t=e.next();!t.done;t=e.next()){var n=lt.apply(rt,m(t.value)),r=ks(this,n);t=this.h.length?this.h[this.h.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!t||t.pts!=r.pts&&t.dts!=r.dts)?this.h.push(r):this.h.length&&(n=r?r.data:n)&&((t=this.h.pop()).data=lt(t.data,n),this.h.push(t))}return this.h},i.ud=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=g(this.j),n=t.next();!n.done;n=t.next()){var r=lt.apply(rt,m(n.value)),i=ks(this,r);n=this.g.length?this.g[this.g.length-1]:null,i&&null!=i.pts&&null!=i.dts&&(!n||n.pts!=i.pts&&n.dts!=i.dts)?this.g.push(i):this.g.length&&(r=i?i.data:r)&&((n=this.g.pop()).data=lt(n.data,r),this.g.push(n))}if(e){for(t={ke:null,state:null},n=[],i=(r=g(this.g)).next();!i.done;i=r.next())(i=i.value).nalus=this.Zg(i,t),i.nalus.length&&(n.push(i),t.ke=i.nalus[i.nalus.length-1]);this.g=n}}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.ub();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,(t=this.ud(!1)).length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.Xd=function(){return{audio:this.C,video:this.m}},i.df=function(){for(var e=[],t=g(this.ud()),n=t.next();!n.done;n=t.next())e.push.apply(e,m(n.value.nalus));return e},i.fk=function(){ce("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Mg();return{height:e.height,width:e.width}},i.Mg=function(){return"hvc"==this.m?function(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.df();if(!n.length)return t;if(!(n=n.find(function(e){return 33==e.type})))return t;var r=new ps(n.fullData,!0);ws(r),ws(r),ms(r,4);var i=ms(r,3);Ts(r);var a=ms(r,2),o=ms(r,1),s=ms(r,5),u=ms(r,32);n=ws(r);for(var l=ws(r),d=ws(r),c=ws(r),h=ws(r),p=ws(r),f=ws(r),g=[],m=[],v=0;v<i;v++)g.push(Ts(r)),m.push(Ts(r));if(i>0)for(v=i;v<8;v++)ms(r,2);for(v=0;v<i;v++)g[v]&&ms(r,88),m[v]&&ws(r);bs(r),3==(i=bs(r))&&ms(r,1),g=bs(r),m=bs(r);var y=v=0,b=0,x=0;return Ts(r)&&(v+=bs(r),y+=bs(r),b+=bs(r),x+=bs(r)),t.width=String(g-(v+y)*(1===i||2===i?2:1)),t.height=String(m-(b+x)*(1===i?2:1)),r=function(e){for(var t=0,n=0;n<32;n++)t|=(e>>n&1)<<31-n;return t>>>0}(u),o=1==o?"H":"L",a="hvc1."+["","A","B","C"][a]+s,a+="."+r.toString(16).toUpperCase(),a+="."+o+f,p&&(a+="."+p.toString(16).toUpperCase()),h&&(a+="."+h.toString(16).toUpperCase()),c&&(a+="."+c.toString(16).toUpperCase()),d&&(a+="."+d.toString(16).toUpperCase()),l&&(a+="."+l.toString(16).toUpperCase()),n&&(a+="."+n.toString(16).toUpperCase()),t.codec=a,t.frameRate=Is(e),t}(this):function(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.df();if(!n.length)return t;if(!(n=n.find(function(e){return 7==e.type})))return t;var r=ws(n=new ps(n.data)),i=ws(n),a=ws(n);if(ys(n),_s.includes(r)){var o=bs(n);if(3===o&&gs(n,1),ys(n),ys(n),gs(n,1),Ts(n)){o=3!==o?8:12;for(var s=0;s<o;s++)Ts(n)&&Ss(n,s<6?16:64)}}if(ys(n),0===(o=bs(n)))bs(n);else if(1===o)for(gs(n,1),ys(n),ys(n),o=bs(n),s=0;s<o;s++)ys(n);ys(n),gs(n,1),o=bs(n),s=bs(n);var u=ms(n,1);0===u&&gs(n,1),gs(n,1);var l=0,d=0,c=0,h=0;return Ts(n)&&(l=bs(n),d=bs(n),c=bs(n),h=bs(n)),t.height=String((2-u)*(s+1)*16-2*c-2*h),t.width=String(16*(o+1)-2*l-2*d),t.codec="avc1."+("0"+r.toString(16).toUpperCase()).slice(-2)+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+a.toString(16).toUpperCase()).slice(-2),t.frameRate=Is(e),t}(this)},V("shaka.util.TsParser",Es),Es.syncOffset=Rs,Es.probe=Ms,Es.prototype.getVideoInfo=Es.prototype.Mg,Es.prototype.getVideoResolution=Es.prototype.fk,Es.prototype.getVideoNalus=Es.prototype.df,Es.prototype.getCodecs=Es.prototype.Xd,Es.prototype.getStartTime=Es.prototype.getStartTime,Es.prototype.getVideoData=Es.prototype.ud,Es.prototype.getAudioData=Es.prototype.ub,Es.prototype.getMetadata=Es.prototype.getMetadata,Es.prototype.parseNalus=Es.prototype.Zg,Es.prototype.parseAvcNalus=Es.prototype.Fk,Es.prototype.parse=Es.prototype.parse,Es.prototype.setDiscontinuitySequence=Es.prototype.Jf,Es.prototype.clearData=Es.prototype.clearData,Es.Timescale=9e4;var _s=[100,110,122,244,44,83,86,118,128,138,139,134];function Ps(e,t,n,r,i){var a=this;this.g=e,this.O=n,this.B=r,this.ba=t,this.l=new Map,this.G=new Map,this.Ta=new Map,this.h=null,this.Fa=!1,this.C=i||null,this.o=new Map,this.u=new ne,this.j=new Map,this.K=null,this.M=new Ci,this.Da="",this.ob=!1,this.za=!0,this.N=!1,this.F=this.R=null,this.i=Ds(this,this.M),this.Ua=this.H=!1,this.I=new Qi(function(){return function(e){var t,n,r,i,a,o,s,u,l,d,c,h,p;return P(function(f){if(1==f.g){for(t=[],n=g(e.o),r=n.next();!r.done;r=n.next())for(i=r.value,a=g(i),o=a.next().value,s=a.next().value,u=s[0],l=o,e.o.set(l,s.slice(0,1)),u&&t.push(u.p.catch(Pr)),d=g(s.slice(1)),c=d.next();!c.done;c=d.next())c.value.p.reject(new Ke(2,7,7003,void 0));return e.h&&t.push(e.h.destroy()),x(f,Promise.all(t),2)}for(h=g(e.j.values()),p=h.next();!p.done;p=h.next())p.value.destroy();e.u&&(e.u.release(),e.u=null),e.g&&e.F&&e.g.removeChild(e.F),e.g&&e.R&&(e.g.removeChild(e.R),e.g.load(),e.g.disableRemotePlayback=!1),e.g=null,e.R=null,e.F=null,e.B=null,e.i=null,e.h=null,e.ba=null,e.l.clear(),e.Ta.clear(),e.j.clear(),e.K=null,e.o.clear(),e.C=null,e.$.clear(),e.O=null,T(f)})}(a)}),this.J=!1,this.X="UNKNOWN",this.eb=this.kb=!1,this.ab=new Ci,this.m=!1,this.ya=null,this.$=new Map,this.oa=this.T=this.va=this.V=null,this.ma=new Ci,this.g.remote&&(this.N="disconnected"!=this.g.remote.state,this.u.D(this.g.remote,"connect",function(){a.N="disconnected"!=a.g.remote.state}),this.u.D(this.g.remote,"connecting",function(){a.N="disconnected"!=a.g.remote.state}),this.u.D(this.g.remote,"disconnect",function(){a.N="disconnected"!=a.g.remote.state}))}function Ds(t,n){if(t.za=!0,e.ManagedMediaSource){t.F||(t.g.disableRemotePlayback=!0);var r=new ManagedMediaSource;t.u.D(r,"startstreaming",function(){t.za=!0}),t.u.D(r,"endstreaming",function(){t.za=!1})}else r=new MediaSource;return t.u.Aa(r,"sourceopen",function(){URL.revokeObjectURL(t.Da),n.resolve()}),t.u.Aa(t.g,"playing",function(){t.ob=!0}),t.Da=iu(r),t.B.useSourceElements?(t.g.removeAttribute("src"),t.R&&t.g.removeChild(t.R),t.F&&t.g.removeChild(t.F),t.R=Zo(t.Da),t.g.appendChild(t.R),t.F&&t.g.appendChild(t.F),t.g.load()):t.g.src=t.Da,r}function Ls(e,t,r,i){"audio"==t&&i&&(i=ei(i,r.mimeType));var a=dr(r.mimeType,i);if(t==mt)Os(e,a,e.J,r.external);else{var o=e.B.forceTransmux;(!Za(a)||!e.J&&xr.includes(a))&&(o=!0);var s=cr(r.mimeType,i);if(o){if(o=ft("audio",(i||"").split(",")),i=ft("video",(i||"").split(",")),o&&i)return e.m=!0,Ls(e,"audio",r,o),void Ls(e,"video",r,i);(i=rr(s))&&(a=i(),e.j.set(t,a),a=a.convertCodecs(t,s))}s=a+e.B.addExtraFeaturesToSourceBuffer(a),Zi(e.I);try{var u=e.i.addSourceBuffer(s)}catch(n){throw new Ke(2,3,3015,n,"The mediaSource_ status was "+e.i.readyState+" expected 'open'",null)}e.J&&(u.mode=au),e.u.D(u,"error",function(){var n=e.o.get(t)[0];n.p.reject(new Ke(2,3,3014,e.g.error?e.g.error.code:0,n.uri))}),e.u.D(u,"updateend",function(){return $s(e,t)}),e.l.set(t,u),e.G.set(t,a),e.Ta.set(t,!!r.drmInfos.length)}}function Ns(e){return e.za&&!e.N&&!e.H}function Os(e,t,n,r){e.h||(e.h=new Tr(e.ba),e.h&&(e.h.B=e.B.modifyCueCallback));var i=e.h;r=r||e.Fa,e=e.X,"application/cea-608"==t||"application/cea-708"==t?i.i=null:(i.i=Cr.get(t)(),i.i.setSequenceMode?i.i.setSequenceMode(n):ce("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),i.i.setManifestType?i.i.setManifestType(e):ce("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),i.C=r)}function Us(e){return!(e.H||e.i&&"ended"!=e.i.readyState)}function Bs(e){return!(e.H||e.i&&"closed"!=e.i.readyState)}function js(e,t){return e.l.size?t==mt?e.h.g:Ko(Vs(e,t)):null}function Fs(e,t){return e.l.size?t==mt?e.h.h:qo(Vs(e,t)):null}function Vs(e,t){if(e.H||e.N||Bs(e))return null;try{return e.l.get(t).buffered}catch(n){return e.l.has(t),null}}function Hs(e,t,n,r,i,a,o,s,u,l,d){var c,h,p,f,v,y,b,w,S,A,E,k,I,C,M,R,_,D,L;return o=void 0!==o&&o,s=void 0!==s&&s,u=void 0!==u&&u,l=void 0!==l&&l,P(function(N){switch(N.g){case 1:if(t!=(c=vt).Na){N.A(2);break}if("HLS"!=e.X){N.A(3);break}return x(N,e.ab,4);case 4:h=N.h,e.h.u=h;case 3:return x(N,function(e,t,n,r,i){var a,o,s,u,l,d,c;return P(function(h){if(1==h.g)return x(h,Promise.resolve(),2);if(!e.i||!e.l)return h.return();if(null==n||null==r)return e.i.parseInit(Ne(t)),h.return();for(a=e.C?n:e.u,o={periodStart:e.u,segmentStart:n,segmentEnd:r,vttOffset:a},s=e.i.parseMedia(Ne(t),o,i,[]),u=g(s),l=u.next();!l.done;l=u.next())d=l.value,e.B(d,i||null,o);c=s.filter(function(t){return t.startTime>=e.m&&t.startTime<e.o}),e.l.append(c),null==e.g&&(e.g=Math.max(n,e.m)),e.h=Math.min(r,e.o),T(h)})}(e.h,n,r?r.startTime:null,r?r.endTime:null,r?r.P()[0]:null),5);case 5:return N.return();case 2:if(l||!e.m){N.A(6);break}return x(N,Hs(e,c.aa,n,r,i,a,o,s,u,!0),7);case 7:return x(N,Hs(e,c.wa,n,r,i,a,o,s,u,!0),8);case 8:return N.return();case 6:if(!e.l.has(t))return N.return();if(p=e.l.get(t).timestampOffset,f=e.G.get(t),e.j.has(t)&&(f=e.j.get(t).getOriginalMimeType()),r&&(v=function(e,t,n,r,i,a,o){o=void 0!==o&&o;var s=null,u=[],l=Ne(n);if(xr.includes(a))(n=ds(l)).length&&r&&((o=n.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&"number"==typeof o.data&&(s=Math.round(o.data)/1e3),e.O.onMetadata([{cueTime:r.startTime,data:l,frames:n,dts:r.startTime,pts:r.startTime}],0,r.endTime));else if(a.includes("/mp4")&&r&&r.ea){l=new oa;var d=null!=i.emsgSchemeIdUris&&i.emsgSchemeIdUris.length>0||e.B.dispatchAllEmsgBoxes;d&&l.S("emsg",function(t){var n=i.emsgSchemeIdUris;if(0===t.version)var a=t.reader.Yc(),o=t.reader.Yc(),s=t.reader.U(),u=t.reader.U(),l=t.reader.U(),d=t.reader.U(),c=r.startTime+u/s;else s=t.reader.U(),u=(c=t.reader.Ed()/s+r.timestampOffset)-r.startTime,l=t.reader.U(),d=t.reader.U(),a=t.reader.Yc(),o=t.reader.Yc();t=t.reader.Ub(t.reader.getLength()-t.reader.Pa(),!0),(n&&n.includes(a)||e.B.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==a?e.O.Ek():(n=c+l/s,e.O.Ck({startTime:c,endTime:n,schemeIdUri:a,value:o,timescale:s,presentationTimeDelta:u,eventDuration:l,id:d,messageData:t}),("https://aomedia.org/emsg/ID3"==a||"https://developer.apple.com/streaming/emsg-id3"==a)&&(s=ds(t)).length&&e.O.onMetadata([{cueTime:c,data:t,frames:s,dts:c,pts:c}],0,n)))});var c=r.ea.timescale;t=c&&!isNaN(c);var h=0,p=!1;t&&l.S("prft",function(t){var n=t.reader,r=t.version;n.U(),t=1e3*(t=n.U())+n.U()/4294967296*1e3,0===r?n=n.U():(r=n.U(),n=4294967296*r+(n=n.U())),t=hs(t),n=new Ni("prft",n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/c*1e3)})),e.O.onEvent(n)}).box("moof",sa).box("traf",sa).S("tfdt",function(e){p||(h=ro(e.reader,e.version).baseMediaDecodeTime/c,p=!0,d||e.parser.stop())}),(d||t)&&l.parse(n,!1,o),p&&0==r.timestampOffset&&(s=h)}else a.includes("/mp4")||a.includes("/webm")||!Ms(l)||(e.$.has(t)||e.$.set(t,new Es),(u=e.$.get(t)).clearData(),u.Jf(r.i),u.parse(l),null!=(l=u.getStartTime(t))&&(s=l),u=u.getMetadata());return{timestamp:s,metadata:u}}(e,t,n,r,i,f,u),y=v.timestamp,b=v.metadata,null!=y&&(null==e.V&&t==c.wa&&(e.V=y,e.va=r.startTime,null!=e.T&&(w=0,e.va==e.oa&&(w=e.V-e.T),e.ma.resolve(w))),null==e.T&&t==c.aa&&(e.T=y,e.oa=r.startTime,null!=e.V&&(S=0,e.va==e.oa&&(S=e.V-e.T),e.ma.resolve(S))),A=y,E=xr,!e.J&&E.includes(e.G.get(t))&&(A=0),k=r.startTime-A,(Math.abs(p-k)>=.001||o||s)&&(!u||k>0||!p)&&(p=k,e.eb&&(Js(e,t,function(){return Ks(e,t)},null),Js(e,t,function(){return qs(e,t,p)},null))),(t==c.wa||!e.l.has(c.wa))&&e.ab.resolve(p)),b.length)&&e.O.onMetadata(b,p,r?r.endTime:null),a&&t==c.wa&&(e.h||Os(e,"application/cea-608",e.J,!1),e.K||(I=f.split(";",1)[0],e.K=new _t(I)),r?(C=e.K.zf(n)).length&&function(e,t,n){for(var r=new Map,i=(t=g(t)).next();!i.done;i=t.next()){var a=i.value;i=a.stream,a=a.cue,r.has(i)||r.set(i,[]),kr(e,a,n),a.startTime>=e.m&&a.startTime<e.o&&(r.get(i).push(a),i==e.F&&e.l.append([a]))}for(t=(n=g(r.keys())).next();!t.done;t=n.next())for(t=t.value,e.j.has(t)||e.j.set(t,[]),a=(i=g(r.get(t))).next();!a.done;a=i.next())a=a.value,e.j.get(t).push(a);Ir(e)}(e.h,C,p):e.K.init(n,s,d)),!e.j.has(t)){N.A(9);break}return x(N,e.j.get(t).transmux(n,i,r,e.i.duration,t),10);case 10:M=N.h,ArrayBuffer.isView(M)?n=M:(null!=(R=M).init&&(_=R.init,Js(e,t,function(){e.C&&Tt(e.C,_,p,i),e.l.get(t).appendBuffer(_)},r?r.P()[0]:null)),n=R.data);case 9:if(n=function(e,t,n,r,i){if("mp4"!=pr(e.G.get(i)))return n;var a=null===r,o=e.Ta.get(i),s=e.O.Nj(),u=!1;r&&r.ea&&(u=r.ea.encrypted),r=r?r.P()[0]:null;var l=oe();return e.B.correctEc3Enca&&a&&"audio"===i&&(n=function(e){e=Ne(e);var t=null;return(new oa).box("moov",sa).box("trak",sa).box("mdia",sa).box("minf",sa).box("stbl",sa).S("stsd",ua).box("enca",function(e){return t=e.reader.h,da(e)}).box("sinf",sa).box("frma",function(e){e.parser.stop(),"ec-3"===so(e.reader).codec&&t&&2!==t.getUint16(16)&&t.setUint16(16,2)}).parse(e),e}(n)),e.B.insertFakeEncryptionInInit&&o&&l.Fd(s,i)&&(a?n=function(e,t,n){function r(e){c.push({box:e,Ci:1701733217})}function i(e){c.push({box:e,Ci:1701733238})}function a(e){l=!0,e.parser.stop()}function o(e){d.push(e),sa(e)}var s,u=t=Ne(t),l=!1,d=[],c=[];if((new oa).box("moov",o).box("trak",o).box("mdia",o).box("minf",o).box("stbl",o).S("stsd",function(e){s=e,d.push(e),ua(e)}).S("encv",a).S("enca",a).S("dvav",i).S("dva1",i).S("dvh1",i).S("dvhe",i).S("dvc1",i).S("dvi1",i).S("hev1",i).S("hvc1",i).S("avc1",i).S("avc3",i).S("ac-3",r).S("ec-3",r).S("ac-4",r).S("Opus",r).S("fLaC",r).S("mp4a",r).parse(t),l)return t;if(0==c.length||!s)throw ut(t),new Ke(2,3,3019,n);c.reverse();for(var h=(n=g(c)).next();!h.done;h=n.next())h=h.value,u=Uo(e,u,s,h.box,d,h.Ci);return oe().hh()?((e=new Uint8Array(t.byteLength+u.byteLength)).set(u),e.set(t,u.byteLength),e):u}(t,n,r):!u&&l.Li(i)&&(n=function(e){e=Ne(e);var t=[];(new oa).box("mdat",function(e){t.push(e)}).parse(e);for(var n=[],r=0;r<t.length;r++){var i=t[r-1],a=t[r];n.push(Oo(e.subarray(i?i.start+i.size:0,a.start+a.size)))}return lt.apply(rt,m(n))}(n))),a&&l.re()&&(n=function(e){function t(e){r.push({start:e.start,size:e.size}),sa(e)}var n=Ne(e),r=[];return(new oa).box("moov",t).box("trak",t).box("mdia",t).box("minf",t).box("stbl",t).box("stsd",function(e){r.push({start:e.start,size:e.size});for(var t=Ue(n,e.start),i=0;i<e.size-3;i++){var a=t.getUint32(i);1633889587==a?t.setUint32(i,1700998451):1684103987==a&&t.setUint32(i,1684366131)}}).parse(n),n}(n)),n}(e,i,n,r,t),!r||!e.J||t==c.Na){N.A(11);break}if(!o&&!s){N.A(11);break}if(D=r.startTime,"HLS"!=e.X||e.m||t!=c.aa||!e.l.has(c.wa)){N.A(13);break}return x(N,e.ma,14);case 14:L=N.h,Math.abs(L)>.15&&(D-=L);case 13:Js(e,t,function(){return Ks(e,t)},null),Js(e,t,function(){return qs(e,t,D)},null);case 11:return x(N,Js(e,t,function(){var r=n;e.C&&Tt(e.C,r,p,i),e.l.get(t).appendBuffer(r)},r?r.P()[0]:null),15);case 15:T(N)}})}function Gs(e,t){var n;return P(function(r){return 1==r.g?t==(n=vt).Na?e.h?x(r,e.h.remove(0,1/0),0):r.return():t===n.wa&&e.K&&e.h?x(r,e.h.remove(0,1/0,!0),4):r.A(4):6!=r.g?x(r,Js(e,t,function(){return Ws(e,t,0,e.i.duration)},null),6):e.m?x(r,Js(e,n.aa,function(){return Ws(e,n.aa,0,e.i.duration)},null),0):r.A(0)})}function zs(e,t,n,r,i,a,o,s,u){var l,d;return P(function(c){return 1==c.g?t==(l=vt).Na?(a||(e.h.u=n),function(e,t,n){e.m=t,e.o=n}(e.h,r,i),c.return()):(d=[],x(c,function(e,t,n,r,i){var a,o,s,u,l,d;return P(function(c){return 1==c.g?(a=vt,o=ru(e,t,n,r,i),s=o.type,u=o.jc,l=o.vf,(d=i.get(a.aa))&&(e.m=d.isAudioMuxedInVideo),s==ou?(e.j.has(t)&&!u?(e.j.get(t).destroy(),e.j.delete(t)):!e.j.has(t)&&u?e.j.set(t,u):u&&(e.j.has(t)&&e.j.get(t).transmux!==u.transmux?(e.j.get(t).destroy(),e.j.set(t,u)):u.destroy()),c.return(!1)):s==uu?x(c,function(e,t,n,r){return Js(e,t,function(){if(t!==mt){if(e.G.get(t),oe().Bb()){e.j.has(t)&&(e.j.get(t).destroy(),e.j.delete(t)),r&&e.j.set(t,r);var i=n+e.B.addExtraFeaturesToSourceBuffer(n);e.l.get(t).changeType(i),e.G.set(t,n)}$s(e,t)}},null)}(e,t,l,u),3):s!=su?c.A(3):(u&&u.destroy(),x(c,tu(e,i),3))):c.return(!0)})}(e,t,o,s,u),2)):(c.h||(d.push(Js(e,t,function(){return Ks(e,t)},null)),e.m&&d.push(Js(e,l.aa,function(){return Ks(e,l.aa)},null))),a||(d.push(Js(e,t,function(){return qs(e,t,n)},null)),e.m&&d.push(Js(e,l.aa,function(){return qs(e,l.aa,n)},null))),0==r&&i==1/0||(d.push(Js(e,t,function(){return Ys(e,t,r,i)},null)),e.m&&d.push(Js(e,l.aa,function(){return Ys(e,l.aa,r,i)},null))),d.length?x(c,Promise.all(d),0):c.A(0))})}function Xs(e){P(function(t){return e.I.g||e.g.error||e.N||e.H||Us(e)||Bs(e)?t.return():x(t,Qs(e,function(){Us(e)||Bs(e)||e.i.clearLiveSeekableRange()}),0)})}function Ws(e,t,n,r){if(r<=n)$s(e,t);else{if(e.C){var i=e.C;"video"===t&&i.g&&i.g.flushBuffer(n,r)}e.l.get(t).remove(n,r)}}function Ks(e,t){var n=e.l.get(t),r=n.appendWindowStart,i=n.appendWindowEnd;n.abort(),n.appendWindowStart=r,n.appendWindowEnd=i,$s(e,t)}function qs(e,t,n){n<0&&(n+=.001),e.l.get(t).timestampOffset=n,$s(e,t)}function Ys(e,t,n,r){var i=e.l.get(t);i.appendWindowEnd===r&&i.appendWindowStart===n||(i.appendWindowStart=0,i.appendWindowEnd=r,i.appendWindowStart=n),$s(e,t)}function $s(e,t){if(e.H||e.I.g){var n=e.o.get(t);n&&n.length&&((n=n[0])&&n.p&&n.p.resolve(),e.o.set(t,[]))}else(n=e.o.get(t)[0])&&(n.p.resolve(),Zs(e,t))}function Js(e,t,n,r){return Zi(e.I),n={start:n,p:new Ci,uri:r},e.o.get(t).push(n),1==e.o.get(t).length&&eu(e,t),n.p}function Qs(e,t){var n,r,i,a,o,s,u,l,d,c,h;return P(function(p){switch(p.g){case 1:for(Zi(e.I),n=[],r=Array.from(e.l.keys()),i=g(r),a=i.next(),o={};!a.done;o={ready:void 0},a=i.next())s=a.value,o.ready=new Ci,u={start:function(e){return function(){return e.ready.resolve()}}(o),p:o.ready,uri:null},(l=e.o.get(s)).push(u),n.push(o.ready),1==l.length&&u.start();return w(p,2),x(p,Promise.all(n),4);case 4:A(p,3);break;case 2:throw E(p);case 3:return w(p,5,6),x(p,t(),6);case 6:for(k(p),d=g(r),c=d.next();!c.done;c=d.next())h=c.value,Zs(e,h);I(p,0);break;case 5:throw new Ke(2,3,3015,E(p),e.g.error||"No error in the media element",null)}})}function Zs(e,t){e.o.get(t).shift(),eu(e,t)}function eu(e,t){var n=e.o.get(t)[0];if(n)try{n.start()}catch(r){"QuotaExceededError"==r.name?n.p.reject(new Ke(2,3,3017,t)):Ns(e)?n.p.reject(new Ke(2,3,3015,r,e.g.error||"No error in the media element",n.uri)):n.p.reject(new Ke(2,3,3024,t)),Zs(e,t)}}function tu(e,t){return Qs(e,function(){return function(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,T,w;return P(function(A){if(1==A.g){if(e.H||e.N)return A.return();for(n=vt,e.H=!0,e.m=!1,r=e.g.currentTime,i=e.g.autoplay,e.g.paused||(e.Ua=!0),e.ob&&(e.g.autoplay=!1),S(A,2),e.u.Qa(),a=g(e.j.values()),o=a.next();!o.done;o=a.next())o.value.destroy();for(s=g(e.l.values()),u=s.next();!u.done;u=s.next()){l=u.value;try{e.i.removeSourceBuffer(l)}catch(E){}}return e.j.clear(),e.l.clear(),d=e.i.duration,e.M=new Ci,e.i=Ds(e,e.M),x(A,e.M,4)}if(2!=A.g){for(!isNaN(d)&&d?e.i.duration=d:!isNaN(e.ya)&&e.ya&&(e.i.duration=e.ya),c=new Ci,h=e.i.sourceBuffers,p=t.size,f=0,m=function(){++f===p&&(c.resolve(),e.u.Ma(h,"addsourcebuffer",m))},e.u.D(h,"addsourcebuffer",m),v=g(t.keys()),y=v.next();!y.done;y=v.next())b=y.value,T=t.get(b),Ls(e,b,T,T.codecs);return(w=t.get(n.aa))&&w.isAudioMuxedInVideo&&(e.m=!0),e.m&&!e.o.has(n.aa)&&e.o.set(n.aa,[]),x(A,c,2)}return k(A),e.H=!1,Zi(e.I),e.u.Aa(e.g,"loadedmetadata",function(){e.I.g||(e.g.currentTime=r)}),e.u.Aa(e.g,"canplaythrough",function(){e.I.g||(e.g.autoplay=i,e.Ua&&(e.Ua=!1,e.g.play()))}),I(A,0)})}(e,t)})}function nu(e,t,n,r){var i=!1,a=ft("audio",(r||"").split(",")),o=ft("video",(r||"").split(",")),s=o;"audio"==t&&(s=a),s||(s=r);var u=dr(n,s),l=mr(e.G.get(t)),d=e.B.forceTransmux;if(!Za(u)||!e.J&&xr.includes(u)?d=!0:d||n==l||(d=!oe().Mf()&&xr.includes(n)),d&&(s=rr(e=cr(n,s)))){var c=s();a&&o&&(i=!0),u=c.convertCodecs(t,e)}return!c&&"video"===t&&a&&(u=dr(n,r)),t=fr(vr(u)),{jc:c,hl:i,Rh:mr(u),codec:t,mimeType:u}}function ru(e,t,n,r,i){if(t==mt)return{type:ou,vf:n,jc:null};var a=fr(vr(e.G.get(t))),o=mr(e.G.get(t)),s=nu(e,t,n,r),u=s.jc,l=s.hl,d=s.Rh,c=s.codec;s=s.mimeType;var h=!0;return l&&e.G.has("audio")&&(n=nu(e,"audio",n,r),r=fr(vr(e.G.get("audio"))),h=mr(e.G.get("audio")),h=r==n.codec&&h==n.Rh,n.jc&&n.jc.destroy()),a===c&&o===d&&h?{type:ou,vf:s,jc:u}:(a=!0,(e.m&&!i.has("audio")||l&&u&&!e.j.has(t))&&(a=!1),t=oe(),a&&"smooth"===e.B.codecSwitchingStrategy&&t.Bb()?{type:uu,vf:s,jc:u}:(u&&u.destroy(),{type:su,vf:s,jc:null}))}(i=Ps.prototype).destroy=function(){return this.I.destroy()},i.init=function(e,t,n,r){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,r=void 0!==r&&r;var i,a,o,s,u,l,d=this;return P(function(c){if(1==c.g)return i=vt,x(c,d.M,2);if(3!=c.g)return Us(d)||Bs(d)?(W("Expected MediaSource to be open during init(); reopening the media source."),d.M=new Ci,d.i=Ds(d,d.M),x(c,d.M,3)):c.A(3);for(d.J=t,d.X=n,d.kb=r,d.eb=!d.J&&"HLS"==d.X&&!d.kb,d.$.clear(),d.V=null,d.va=null,d.T=null,d.oa=null,d.ma=new Ci,a=g(e.keys()),o=a.next();!o.done;o=a.next())s=o.value,u=e.get(s),Ls(d,s,u,u.codecs),d.m?(d.o.set(i.aa,[]),d.o.set(i.wa,[])):d.o.set(s,[]);(l=e.get(i.aa))&&l.isAudioMuxedInVideo&&(d.m=!0),T(c)})},i.configure=function(e){this.B=e,this.h&&(this.h.B=e.modifyCueCallback)},i.Gc=function(){var e={total:this.H?[]:Jo(this.g.buffered),audio:Jo(Vs(this,"audio")),video:Jo(Vs(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n,r){var i,a,o=this;return P(function(s){return 1==s.g?(e==(i=vt).wa&&o.K&&(o.K.remove(r),a=o.h.g||0,o.h.remove(a,n,!0)),e==i.Na?x(s,o.h.remove(t,n),0):n>t?x(s,Js(o,e,function(){return Ws(o,e,t,n)},null),5):s.A(0)):o.m?x(s,Js(o,i.aa,function(){return Ws(o,i.aa,t,n)},null),0):s.A(0)})},i.flush=function(e){var t,n=this;return P(function(r){return 1==r.g?e==(t=vt).Na?r.return():x(r,Js(n,e,function(){n.g.currentTime-=.001,$s(n,e)},null),2):n.m?x(r,Js(n,t.aa,function(){var e=t.aa;n.g.currentTime-=.001,$s(n,e)},null),0):r.A(0)})},i.endOfStream=function(e){var t=this;return P(function(n){return x(n,Qs(t,function(){Us(t)||Bs(t)||(e?t.i.endOfStream(e):t.i.endOfStream())}),0)})},i.Ab=function(e){var t=this;return P(function(n){return x(n,Qs(t,function(){if(t.B.durationReductionEmitsUpdateEnd&&e<t.i.duration)for(var n=g(t.l.keys()),r=n.next();!r.done;r=n.next()){r=r.value;var i={start:function(){},p:new Ci,uri:null};t.o.get(r).unshift(i)}t.i.duration=e,t.ya=e}),0)})},i.getDuration=function(){return this.i.duration};var iu=e.URL.createObjectURL,au="sequence",ou="none",su="reset",uu="changeType";function lu(e,t,n){this.i=e,this.F=t,this.u=this.l=1/0,this.h=1,this.g=this.j=null,this.B=0,this.C=!0,this.J=!1,this.I=0,this.G=void 0===n||n,this.H=0,this.o=!1,this.m=e}function du(e,t,n,r){var i=this;this.u=r,this.g=e,this.F=t,this.h=n,this.j=new ne,this.m=!1,this.l=0,this.C=!1,this.H=this.G=0,this.o=function(e){if(!e.h.stallEnabled)return null;var t=e.h.stallThreshold,n=e.h.stallSkip;return new hu(new pu(e.g),t,function(){return P(function(t){if(1==t.g)return Jo(e.g.buffered).length?n?(e.g.currentTime+=n,t.A(2)):x(t,e.g.play(),3):t.return();if(2!=t.g){if(!e.g)return t.return();e.g.pause(),e.g.play()}e.H++,e.u(new Ni("stalldetected")),T(t)})})}(this),this.B=!1,this.j.D(e,"waiting",function(){return cu(i)}),this.i=new Rr(function(){cu(i)}).Ea(this.h.gapJumpTimerTime)}function cu(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.m)return}else e.m=!1;if(!e.g.paused||e.g.currentTime==e.l&&(e.g.autoplay||e.g.currentTime!=e.l)){var t;if(!(t=!e.o)){var n=(t=e.o).h,r=fu(n),i=n.g.currentTime,a=Date.now()/1e3;t.g==i&&t.m==r||(t.l=a,t.g=i,t.m=r,t.i=!1),(r=(i=a-t.l)>=t.o&&r&&!t.i)&&(t.j&&t.j(t.g,i),t.i=!0,t.g=n.g.currentTime),t=!r}t&&(t=e.g.currentTime,r=function(e,t,n){return e&&e.length&&!Wo(e)&&(e=Jo(e).findIndex(function(e,r,i){return e.start>t&&(0==r||i[r-1].end-t<=n)}))>=0?e:null}(n=e.g.buffered,t,e.h.gapDetectionThreshold),null==r||0==r&&!e.B||(i=n.start(r),(a=e.h.gapPadding)&&(i=Math.ceil(100*(i+a))/100),i>=e.F.Hb()||i-t<.001||(0!=r&&n.end(r-1),function(e,t){e.C=!0,e.j.Aa(e.g,"seeked",function(){e.C=!1}),e.g.currentTime=t}(e,i),t==e.l&&(e.l=i),e.G++,e.u(new Ni("gapjumped")))))}}}function hu(e,t,n){this.h=e,this.m=fu(e),this.g=e.g.currentTime,this.l=Date.now()/1e3,this.i=!1,this.o=t,this.j=n}function pu(e){var t=this;this.g=e,this.h=new ne,this.i=!1,this.h.D(this.g,"audiofocuspaused",function(){t.i=!0}),this.h.D(this.g,"audiofocusgranted",function(){t.i=!1}),this.h.D(this.g,"audiofocuslost",function(){t.i=!0})}function fu(e){if(e.g.paused||0==e.g.playbackRate||e.i||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime;for(var n=(e=g(Jo(e.g.buffered))).next();!n.done;n=e.next())if(!(t<(n=n.value).start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function gu(e,t,n,r){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?r():(t=mu.value().get(t),n.Aa(e,t,r))}(i=lu.prototype).getDuration=function(){return this.l},i.Pj=function(){return this.h},i.Ui=function(e){this.i=e},i.Ab=function(e){this.l=e},i.Uj=function(){return this.i},i.Ti=function(e){this.B=e},i.cd=function(e){e&&!this.C&&(this.J=!0),this.C=e},i.Kf=function(e){this.u=e},i.cf=function(){return this.u},i.qh=function(e){this.F=e},i.Hj=function(){return this.F},i.Fi=function(e,t){if(0!=e.length){var n=(Date.now()+this.B)/1e3;if(0!=(e=e.filter(function(e){return e.start+t<n})).length){var r=e[e.length-1].end+t;this.wf(e[0].start+t),this.h=e.reduce(function(e,t){return Math.max(e,t.end-t.start)},this.h),this.g=Math.max(this.g,r),null!=this.i&&this.G&&!this.o&&(this.i=n-this.g-this.h)}}},i.le=function(e){if(0!=e.length){for(var t=e[0].startTime,n=e[0].endTime,r=(Date.now()+this.B)/1e3,i=(e=g(e)).next();!i.done;i=e.next())r<(i=i.value).startTime||(t=Math.min(t,i.startTime),n=Math.max(n,i.endTime),this.h=Math.max(this.h,i.endTime-i.startTime));this.wf(t),this.g=Math.max(this.g,n),null!=this.i&&this.G&&!this.o&&(this.i=r-this.g-this.h)}},i.Ei=function(e,t){this.wf(e),t==1/0||this.W()||(this.g=Math.max(this.g,t))},i.Qj=function(){return this.g},i.pf=function(){this.o=!0},i.rk=function(){return this.o},i.rh=function(e){this.m=e},i.Mj=function(){return this.m},i.wf=function(e){null==this.j?this.j=e:this.J||(this.j=Math.min(this.j,e))},i.Vg=function(e){this.h=Math.max(this.h,e)},i.offset=function(e){null!=this.j&&(this.j+=e),null!=this.g&&(this.g+=e)},i.W=function(){return this.l==1/0&&!this.C},i.Vc=function(){return this.l!=1/0&&!this.C},i.Ib=function(){return Math.max(this.I,this.Ic()-this.u)},i.Wi=function(e){this.I=e},i.Ic=function(){return this.W()||this.Vc()?Math.min(Math.max(0,(Date.now()+this.B)/1e3-this.h-this.i)+this.H,this.l):this.g?Math.min(this.g,this.l):this.l},i.$d=function(e){var t=Math.max(this.j,this.I);return this.u==1/0?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.Ic()-this.u+e,this.Hb()))},i.$b=function(){return this.$d(0)},i.Hb=function(){return Math.max(0,this.Ic()-(this.W()||this.Vc()?this.F:0))},i.ij=function(){return!(null==this.i||null!=this.g&&this.G)},i.Si=function(e){this.H=e},i.Cj=function(){return this.H},V("shaka.media.PresentationTimeline",lu),lu.prototype.getAvailabilityTimeOffset=lu.prototype.Cj,lu.prototype.setAvailabilityTimeOffset=lu.prototype.Si,lu.prototype.usingPresentationStartTime=lu.prototype.ij,lu.prototype.getSeekRangeEnd=lu.prototype.Hb,lu.prototype.getSeekRangeStart=lu.prototype.$b,lu.prototype.getSafeSeekRangeStart=lu.prototype.$d,lu.prototype.getSegmentAvailabilityEnd=lu.prototype.Ic,lu.prototype.setUserSeekStart=lu.prototype.Wi,lu.prototype.getSegmentAvailabilityStart=lu.prototype.Ib,lu.prototype.isInProgress=lu.prototype.Vc,lu.prototype.isLive=lu.prototype.W,lu.prototype.offset=lu.prototype.offset,lu.prototype.notifyMaxSegmentDuration=lu.prototype.Vg,lu.prototype.notifyMinSegmentStartTime=lu.prototype.wf,lu.prototype.getInitialProgramDateTime=lu.prototype.Mj,lu.prototype.setInitialProgramDateTime=lu.prototype.rh,lu.prototype.isStartTimeLocked=lu.prototype.rk,lu.prototype.lockStartTime=lu.prototype.pf,lu.prototype.getMaxSegmentEndTime=lu.prototype.Qj,lu.prototype.notifyPeriodDuration=lu.prototype.Ei,lu.prototype.notifySegments=lu.prototype.le,lu.prototype.notifyTimeRange=lu.prototype.Fi,lu.prototype.getDelay=lu.prototype.Hj,lu.prototype.setDelay=lu.prototype.qh,lu.prototype.getSegmentAvailabilityDuration=lu.prototype.cf,lu.prototype.setSegmentAvailabilityDuration=lu.prototype.Kf,lu.prototype.setStatic=lu.prototype.cd,lu.prototype.setClockOffset=lu.prototype.Ti,lu.prototype.getPresentationStartTime=lu.prototype.Uj,lu.prototype.setDuration=lu.prototype.Ab,lu.prototype.setPresentationStartTime=lu.prototype.Ui,lu.prototype.getMaxSegmentDuration=lu.prototype.Pj,lu.prototype.getDuration=lu.prototype.getDuration,du.prototype.release=function(){this.j&&(this.j.release(),this.j=null),null!=this.i&&(this.i.stop(),this.i=null),this.o&&(this.o.release(),this.o=null),this.g=this.F=this.u=null},du.prototype.zd=function(){this.B=!0,this.i&&this.i.Ea(this.h.gapJumpTimerTime),cu(this)},hu.prototype.release=function(){this.h&&this.h.release(),this.j=this.h=null},pu.prototype.release=function(){this.h&&this.h.release(),this.h=null};var mu=new ae(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function vu(e,t,n,r){var i=this;this.g=e,this.m=t,this.u=n,this.l=null,this.j=function(){return null==i.l&&(i.l=r()),i.l},this.o=!1,this.h=new ne,this.i=new wu(e),gu(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){xu(i,i.j())})}function yu(e){return e.o?e.g.currentTime:e.j()}function bu(e,t){e.g.readyState>0?Su(e.i,t):gu(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){xu(e,e.j())})}function xu(e,t){Math.abs(e.g.currentTime-t)<.001?Tu(e):(e.h.Aa(e.g,"seeking",function(){Tu(e)}),Su(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function Tu(e){e.o=!0,e.h.D(e.g,"seeking",function(){return e.m()}),e.u(e.g.currentTime)}function wu(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new Rr(function(){t.i<=0||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)})}function Su(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.Ea(.1)}function Au(e){this.g=e,this.i=!1,this.h=null,this.j=new ne}function Eu(e){return e.g.getStartDate&&(e=e.g.getStartDate().getTime(),!isNaN(e))?e/1e3:null}function ku(e,t){return(e=e.g.seekable).length>0&&(t=Math.max(e.start(0),t),t=Math.min(e.end(e.length-1),t)),t}function Iu(e,t,n,r,i,a){var o=this;this.h=e,this.g=t.presentationTimeline,this.l=n,this.u=i,this.o=null,this.i=new du(e,t.presentationTimeline,n,a),this.j=new vu(e,function(){e:{var e=o.i;e.m=!0,e.B=!1,e.i&&e.i.Ea(e.h.gapJumpTimerTime),cu(e);var t=yu(o.j);if(e=Ru(o,t),!eo()&&Math.abs(e-t)>.001){t=!1;var n=oe().Qi();if(n){var r=Date.now()/1e3;(!o.o||o.o<r-n)&&(o.o=r,t=!0)}else t=!0;if(t){bu(o.j,e),e=void 0;break e}}o.u(),e=void 0}return e},function(e){var t=o.i;t.g.seeking&&!t.m&&(t.m=!0,t.l=e),t.i&&t.i.Ea(t.h.gapJumpTimerTime),cu(t)},function(){return Cu(o,r)}),this.m=new Rr(function(){if(0!=o.h.readyState&&!o.h.paused){var e=yu(o.j),t=o.g.$b(),n=o.g.Hb();n-t<3&&(t=n-3),e<t&&(e=Ru(o,e),o.h.currentTime=e)}})}function Cu(e,t){return null==t?t=e.g.getDuration()<1/0?e.g.$b():e.g.Hb():t instanceof Date?t=t.getTime()/1e3-(e.g.m||e.g.i):t<0&&(t=e.g.Hb()+t),Mu(e,_u(e,t))}function Mu(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function Ru(e,t){var n=e.l.rebufferingGoal,r=e.l.safeSeekOffset,i=e.g.$b(),a=e.g.Hb(),o=e.g.getDuration();a-i<3&&(i=a-3);var s=e.g.$d(n),u=e.g.$d(r);return n=e.g.$d(n+r),t>=o?Mu(e,t):t>a?a-e.l.safeSeekEndOffset:t<i?e.g.W()&&e.l.returnToEndOfLiveWindowWhenOutside?a-e.l.safeSeekEndOffset:Yo(e.h.buffered,u)?u:n:t>=s||Yo(e.h.buffered,t)?t:n}function _u(e,t){var n=e.g.$b();return t<n?n:t>(e=e.g.Hb())?e:t}function Pu(e){this.g=e,this.m=null,this.i=0,this.o=!1}function Du(e){return e.g[0]||null}function Lu(e,t,n){return new Pu([e=new Vo(e,e+t,function(){return n},0,null,null,e,e,e+t)])}function Nu(e,t,n,r){this.i=e,this.h=t,this.g=n,this.reverse=r}function Ou(){Pu.call(this,[]),this.h=[]}function Uu(e){var t=this;this.g=e,this.j=!1,this.i=this.g.bf(),this.h=new Rr(function(){t.g.Bi(.25*t.i)})}function Bu(e){e.h.stop();var t=e.j?0:e.i;if(t>=0)try{return void(e.g.bf()!=t&&e.g.sh(t))}catch(n){}e.h.Ea(.25),0!=e.g.bf()&&e.g.sh(0)}function ju(e){var t=this;this.j=e,this.h=new ne,this.g=new Set,this.i=new Rr(function(){Fu(t,!1)}).Kb(),e.paused||this.i.Ea(.25),this.h.D(e,"playing",function(){t.i.Kb().Ea(.25)}),this.h.D(e,"pause",function(){t.i.stop()})}function Fu(e,t){for(var n=e.j.currentTime,r=(e=g(e.g)).next();!r.done;r=e.next())r.value.j(n,t)}function Vu(e){Bi.call(this),this.g=new Map,this.h=e}function Hu(e,t,n){return!!((e=e.h()[n])&&e.length>0&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function Gu(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return"video"==e.type&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),"audio"==e.type&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function zu(e){Bi.call(this),this.h=new Map,this.i=e,this.g=null}function Xu(e,t){var n=t.schemeIdUri+"_"+t.id+"_"+t.startTime.toFixed(1)+"_"+t.endTime.toFixed(1);e.h.has(n)||(e.h.set(n,t),t=new Ni("regionadd",new Map([["region",t]])),e.dispatchEvent(t),function(e){e.g||(e.g=new Rr(function(){for(var t=e.i(),n=g(e.h),r=n.next();!r.done;r=n.next()){var i=g(r.value);r=i.next().value,(i=i.next().value).endTime<t.start&&(e.h.delete(r),r=new Ni("regionremove",new Map([["region",i]])),e.dispatchEvent(r))}!e.h.size&&e.g&&(e.g.stop(),e.g=null)}).Ea(2))}(e))}function Wu(e,t,n,r,i){this.m=e,this.i=t,this.l=n,this.g=new Map,this.j=new Map,this.h=null,this.o=r,this.u=i||function(e,t){return!(t.fastSwitching&&e.Xc&&e.ie)}}function Ku(e,t){e.l=t;for(var n=(e=g(e.g.values())).next();!n.done;n=e.next())n.value.g=t}function qu(e,t,n){if(n=void 0!==n&&n,!e.i.segmentIndex)return Promise.resolve();if(e.h||(e.h=e.i.segmentIndex.Yb(t,!0,e.o)),!e.h)return Promise.resolve();for(n&&e.h.next(),t=[];e.g.size<e.m&&(n=e.h.next().value);){var r=!0;if(n.isPreload()&&null!=n.endByte&&(r=!1),2==n.Kc()&&(r=!1),n.ac(!1)&&(r=!1),r&&n.ea&&t.push(Yu(e,n.ea)),r&&!e.g.has(n)&&(r=new tl(e.l),t.push(nl(r,n,e.i)),e.g.set(n,r)),!e.u(n,e.i))break}return Qu(e),Promise.all(t)}function Yu(e,t){if(!e.i.segmentIndex||t.ac()||Array.from(e.j.keys()).some(function(e){return Fo(e,t)}))return Promise.resolve();var n=new tl(e.l),r=nl(n,t,e.i);return e.j.set(t,n),r}function $u(e,t){for(var n=(t=g(t.keys())).next();!n.done;n=t.next())(n=n.value)&&el(e,n)}function Ju(e){$u(e,e.g),$u(e,e.j),e.h=null}function Qu(e){if(e.g.size)for(var t=Array.from(e.g.keys()),n=g(e.j.keys()),r=n.next(),i={};!r.done;i={Pg:void 0},r=n.next())i.Pg=r.value,t.some(function(e){return function(t){return Fo(t.ea,e.Pg)}}(i))||el(e,i.Pg)}function Zu(e,t){e.m=t;for(var n=Array.from(e.g.keys());n.length>t;){var r=n.pop();r&&el(e,r)}Qu(e)}function el(e,t){var n=e.g;t instanceof jo&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function tl(e){this.g=e,this.me=this.Ah=null}function nl(e,t,n){var r=new Uint8Array(0);return e.me=e.g(t,n,function(t){return P(function(n){if(1==n.g)return r=r.byteLength>0?lt(r,t):t,e.Ah?x(n,e.Ah(r),3):n.A(0);r=new Uint8Array(0),T(n)})}),e.me.promise.catch(function(e){return e instanceof Ke&&7001==e.code?Promise.resolve():Promise.reject(e)})}function rl(e){var t=mr(e);return{type:t.split("/")[0],mimeType:t,codecs:e=vr(e),language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,ye:null,colorGamut:null,frameRate:null,timescale:null}}function il(e,t,n){function r(e){o=e.name;var t=e.reader;t.skip(24);var n=t.Ca(),r=t.Ca();t.skip(50),p=String(n),h=String(r),e.reader.Ia()&&sa(e)}function i(e){var t=oo(e.reader);f=t.channelCount,m=t.sampleRate,a(e.name)}function a(e){switch(e=e.toLowerCase()){case"avc1":case"avc3":u.push(e+".42E01E"),d=!0;break;case"hev1":case"hvc1":u.push(e+".1.6.L93.90"),d=!0;break;case"dvh1":case"dvhe":u.push(e+".05.04"),d=!0;break;case"vp09":u.push(e+".00.10.08"),d=!0;break;case"av01":u.push(e+".0.01M.08"),d=!0;break;case"mp4a":s.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":s.push(e),l=!0;break;case"apac":s.push("apac.31.00"),l=!0}}var o,s=[],u=[],l=!1,d=!1,c=null,h=null,p=null,f=null,m=null,v=null,y=null,b=null;if((new oa).box("moov",sa).box("trak",sa).box("mdia",sa).S("mdhd",function(e){e=io(e.reader,e.version),c=e.language,b=e.timescale}).box("minf",sa).box("stbl",sa).S("stsd",ua).box("mp4a",function(e){var t=oo(e.reader);f=t.channelCount,m=t.sampleRate,e.reader.Ia()?sa(e):a(e.name)}).box("esds",function(e){e=e.reader;for(var t,n,r="mp4a";e.Ia();){t=e.Y();for(var i=e.Y();128&i;)i=e.Y();if(3==t)e.Ca(),128&(i=e.Y())&&e.Ca(),64&i&&e.skip(e.Y()),32&i&&e.Ca();else if(4==t)n=e.Y(),e.skip(12);else if(5==t)break}n&&(r+="."+uo(n),5==t&&e.Ia()&&(31==(n=(248&(t=e.Y()))>>3)&&e.Ia()&&(n=32+((7&t)<<3)+((224&e.Y())>>5)),r+="."+n)),s.push(r),l=!0}).box("ac-3",i).box("ec-3",i).box("ac-4",i).box("Opus",i).box("fLaC",i).box("apac",i).box("avc1",r).box("avc3",r).box("hev1",r).box("hvc1",r).box("dva1",r).box("dvav",r).box("dvh1",r).box("dvhe",r).box("vp09",r).box("av01",r).box("avcC",function(e){var t=o||"";switch(o){case"dvav":t="avc3";break;case"dva1":t="avc1"}(e=e.reader).skip(1),e=t+"."+uo(e.Y())+uo(e.Y())+uo(e.Y()),u.push(e),d=!0}).box("hvcC",function(e){var t=o||"";switch(o){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}var n=e.reader;n.skip(1);var r=["","A","B","C"][(e=n.Y())>>6],i=31&e,a=n.U(),s=(32&e)>>5?"H":"L";e=[n.Y(),n.Y(),n.Y(),n.Y(),n.Y(),n.Y()],n=n.Y();for(var l=0,c=0;c<32&&(l|=1&a,31!=c);c++)l<<=1,a>>=1;for(t=t+"."+r+i+"."+uo(l,!0),t+="."+s+n,r="",i=e.length;i--;)((s=e[i])||r)&&(r="."+s.toString(16).toUpperCase()+r);t+=r,u.push(t),d=!0}).box("dvcC",function(e){var t=o||"";switch(o){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.Y(),n=n.Y(),u.push(t+"."+lo(e>>1&127)+"."+lo(e<<5&32|n>>3&31)),d=!0}).box("dvvC",function(e){var t=o||"";switch(o){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.Y(),n=n.Y(),u.push(t+"."+lo(e>>1&127)+"."+lo(e<<5&32|n>>3&31)),d=!0}).S("vpcC",function(e){var t=o||"",n=e.reader;e=n.Y();var r=n.Y();n=n.Y()>>4&15,u.push(t+"."+lo(e)+"."+lo(r)+"."+lo(n)),d=!0}).box("av1C",function(e){var t=o||"";"dav1"===o&&(t="av01");var n=e.reader;n.skip(1);var r=(e=n.Y())>>>5,i=(64&(n=n.Y()))>>6;u.push(t+"."+r+"."+lo(31&e)+(n>>>7?"H":"M")+"."+lo(2===r&&i?(32&n)>>5?12:10:i?10:8)+"."+((16&n)>>4)+"."+((8&n)>>3)+((4&n)>>2)+(3&n)+"."+lo(1)+"."+lo(1)+"."+lo(1)+".0"),d=!0}).box("enca",da).box("encv",la).box("sinf",sa).box("frma",function(e){a(e=so(e.reader).codec)}).box("colr",function(e){u=u.map(function(t){if(t.startsWith("av01.")){var n=e.reader,r=n.Pa(),i=n.Ub(4,!1),a=String.fromCharCode(i[0]);if(a+=String.fromCharCode(i[1]),a+=String.fromCharCode(i[2]),"nclx"===(a+=String.fromCharCode(i[3]))){i=n.Ca(),a=n.Ca();var o=n.Ca(),s=n.Y()>>7,u=t.split(".");10==u.length&&(u[6]=lo(i),u[7]=lo(a),u[8]=lo(o),u[9]=String(s),t=u.join("."))}n.seek(r)}return t});var t=function(e){var t=null,n=null,r=e.Ub(4,!1),i=String.fromCharCode(r[0]);if(i+=String.fromCharCode(r[1]),i+=String.fromCharCode(r[2]),"nclx"===(i+=String.fromCharCode(r[3]))){switch(e.Ca()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(r=e.Ca(),e.Ca(),r){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,ye:n}}(e.reader),n=t.colorGamut;v=t.ye,y=n}).parse(e||t,!0,!0),!s.length&&!u.length)return null;var x=l&&!d,T=new Map;if(d&&!n){n=new _t("video/mp4"),e&&n.init(e);try{n.zf(t);for(var w=g(n.Yf()),S=w.next();!S.done;S=w.next()){var A=S.value;T.set(A,A)}}catch(E){}n.Od()}return{type:x?"audio":"video",mimeType:x?"audio/mp4":"video/mp4",codecs:al(s.concat(u)).join(", "),language:c,height:h,width:p,channelCount:f,sampleRate:m,closedCaptions:T,ye:v,colorGamut:y,frameRate:null,timescale:b}}function al(e){for(var t=new Set,n=[],r=(e=g(e)).next();!r.done;r=e.next()){var i=gr(r=r.value);t.has(i)||(n.push(r),t.add(i))}return t=gt("audio",n),r=gt("video",n),e=gt(mt,n),r=function(e){if(e.length<=1)return e;var t=e.find(function(e){return e.startsWith("dvav.")||e.startsWith("dva1.")||e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")||e.startsWith("dvc1.")||e.startsWith("dvi1.")});return t?Za('video/mp4; codecs="'+t+'"')?[t]:e.filter(function(e){return e!=t}):e}(r),t=t.concat(r).concat(e),n.length&&!t.length?n:t}function ol(t,n,r){var i,a,o,s,u;return P(function(l){if(1==l.g)return(i=n).cryptoKey?l.A(2):x(l,i.fetchKey(),3);if(!(a=i.iv))for(a=Ne(new ArrayBuffer(16)),o=i.firstMediaSequenceNumber+r,s=a.byteLength-1;s>=0;s--)a[s]=255&o,o>>=8;return u="CBC"==n.blockCipherMode?{name:"AES-CBC",iv:a}:{name:"AES-CTR",counter:a,length:64},l.return(e.crypto.subtle.decrypt(u,i.cryptoKey,t))})}function sl(e,t,n){var r,i,a,o,s,u,l;return P(function(d){switch(d.g){case 1:return r=ul(e),(i=dl.get(r))?d.return(i):(a=0,o=zi([e],n),w(d,2),o.method="HEAD",x(d,t.request(a,o).promise,4));case 4:s=d.h,i=s.headers["content-type"],A(d,3);break;case 2:if(!(u=E(d))||1002!=u.code&&1001!=u.code){d.A(3);break}return o.method="GET",x(d,t.request(a,o).promise,6);case 6:l=d.h,i=l.headers["content-type"];case 3:return d.return(i?i.toLowerCase().split(";").shift():"")}})}function ul(e){return 1==(e=new me(e).Tb.split("/").pop().split(".")).length?"":e.pop().toLowerCase()}function ll(e,t,n,r,i){return e=zi(e,r,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}vu.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},wu.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},(i=Au.prototype).ready=function(){var e=this;gu(this.g,HTMLMediaElement.HAVE_FUTURE_DATA,this.j,function(){!function(){if(null==e.h||0==e.h&&e.g.duration!=1/0)e.i=!0;else{var t=e.g.currentTime,n=null;if("number"==typeof e.h)n=e.h;else if(e.h instanceof Date){var r=Eu(e);null!==r&&(n=e.h.getTime()/1e3-r,n=ku(e,n))}null==n?e.i=!0:(n<0&&(n=Math.max(0,t+n)),t!=n?(e.j.Aa(e.g,"seeking",function(){e.i=!0}),e.g.currentTime=n):e.i=!0)}}()})},i.release=function(){this.j&&(this.j.release(),this.j=null),this.g=null},i.Zf=function(e){this.h=this.i?this.h:e},i.Pd=function(){var e=this.i?this.g.currentTime:this.h;return e instanceof Date&&(e=ku(this,e=e.getTime()/1e3-(Eu(this)||0))),e||0},i.Lh=function(){return 0},i.Jh=function(){return 0},i.Kh=function(){return!1},i.Di=function(){},i.oi=function(){var e=qo(this.g.buffered);return null!=e&&e>=this.g.duration-1},(i=Iu.prototype).ready=function(){this.m.Ea(.25)},i.release=function(){this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.m&&(this.m.stop(),this.m=null),this.h=this.j=this.g=this.l=null,this.u=function(){}},i.Zf=function(e){bu(this.j,Cu(this,e))},i.Pd=function(){var e=yu(this.j);return this.h.readyState>0&&!this.h.paused?_u(this,e):e},i.Lh=function(){return this.i.H},i.Jh=function(){return this.i.G},i.Kh=function(){return this.i.C},i.Di=function(){this.i.zd()},i.oi=function(){if(this.g.W()){var e=this.g.Ic(),t=qo(this.h.buffered);if(null!=t&&t>=e)return!0}return!1},(i=Pu.prototype).getNumReferences=function(){return this.g.length},i.getNumEvicted=function(){return this.i},i.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},i.zk=function(){this.o=!0},i.Gb=function(e){for(var t=g(this.g),n=t.next();!n.done;n=t.next())e(n.value)},i.find=function(e){for(var t=this.g.length-1,n=t;n>=0;--n){var r=this.g[n],i=n<t?this.g[n+1].startTime:r.endTime;if(e>=r.startTime&&e<i)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},i.get=function(e){return 0==this.g.length||(e-=this.i)<0||e>=this.g.length?null:this.g[e]},i.offset=function(e){if(!this.o)for(var t=g(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.rf=function(e){if(!this.o&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter(function(e){return Math.round(1e3*e.startTime)/1e3<t}),this.g.push.apply(this.g,m(e))}},i.je=function(e,t){var n=this;e=e.filter(function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)}),this.rf(e),this.Ya(t)},i.Ya=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter(function(t){return t.endTime>e}),this.i+=t-this.g.length}},i.pd=function(e,t,n){if(n=void 0!==n&&n,!this.o){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.i++;0!=this.g.length&&((t=new Vo((e=this.g[this.g.length-1]).startTime,t,e.C,e.startByte,e.endByte,e.ea,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.B,e.h,e.status,e.aesKey)).mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.g[this.g.length-1]=t)}},i.Qf=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new Rr(function(){var e=t();e?n.g.push.apply(n.g,m(e)):(n.m.stop(),n.m=null)}),this.m.Ea(e))},Pu.prototype[Symbol.iterator]=function(){return this.Yb(0)},Pu.prototype.Yb=function(e,t,n){t=void 0!==t&&t,n=void 0!==n&&n;var r=this.find(e);if(null==r)return null;var i=this.get(r);n?r++:r--;var a=-1;if(i&&i.g.length>0)for(var o=i.g.length-1;o>=0;--o){var s=i.g[o];if(e>=s.startTime&&e<s.endTime){if(!t){for(;o&&!s.l;)o--,s=i.g[o];if(!s.l)return W("No independent partial segment found!"),null}n?r--:r++,a=o-1;break}}return new Nu(this,r,a,n)},Pu.prototype.Ve=function(){return-1},V("shaka.media.SegmentIndex",Pu),Pu.forSingleSegment=Lu,Pu.prototype.getIteratorForTime=Pu.prototype.Yb,Pu.prototype.updateEvery=Pu.prototype.Qf,Pu.prototype.fit=Pu.prototype.pd,Pu.prototype.evict=Pu.prototype.Ya,Pu.prototype.mergeAndEvict=Pu.prototype.je,Pu.prototype.offset=Pu.prototype.offset,Pu.prototype.get=Pu.prototype.get,Pu.prototype.find=Pu.prototype.find,Pu.prototype.markImmutable=Pu.prototype.zk,Pu.prototype.release=Pu.prototype.release,Pu.prototype.getNumEvicted=Pu.prototype.getNumEvicted,Pu.prototype.getNumReferences=Pu.prototype.getNumReferences,(i=Nu.prototype).Jd=function(e){this.reverse=e},i.xj=function(){return this.h},i.current=function(){var e=this.i.get(this.h);return e&&e.g.length>0&&e.m&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&e.g.length>0?e.g[this.g]:e},i.next=function(){var e=this.i.get(this.h);return this.reverse?e&&e.g.length>0?(this.g--,this.g<0&&(this.h--,this.g=(e=this.i.get(this.h))&&e.g.length>0?e.g.length-1:0)):(this.h--,this.g=0):e&&e.g.length>0?(this.g++,e.m&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),{value:e=this.current(),done:!e}},i.ih=function(){var e=this.current();if(e&&e.Xc&&!e.l&&(e=this.i.get(this.h))&&e.g.length>0)for(var t=e.g[this.g];t.l&&!(this.g<=0);)this.g--,t=e.g[this.g]},V("shaka.media.SegmentIterator",Nu),Nu.prototype.resetToLastIndependent=Nu.prototype.ih,Nu.prototype.next=Nu.prototype.next,Nu.prototype.current=Nu.prototype.current,Nu.prototype.currentPosition=Nu.prototype.xj,Nu.prototype.setReverse=Nu.prototype.Jd,p(Ou,Pu),(i=Ou.prototype).clone=function(){var e=new Ou;return e.h=this.h.slice(),e.i=this.i,e},i.release=function(){this.h=[]},i.Gb=function(e){for(var t=g(this.h),n=t.next();!n.done;n=t.next())n.value.Gb(e)},i.find=function(e){for(var t=this.i,n=g(this.h),r=n.next();!r.done;r=n.next()){var i=(r=r.value).find(e);if(null!=i)return i+t;t+=r.getNumEvicted()+r.getNumReferences()}return null},i.get=function(e){for(var t=this.i,n=g(this.h),r=n.next();!r.done;r=n.next()){var i=(r=r.value).get(e-t);if(i)return i;i=r.getNumReferences(),t+=r.getNumEvicted()+i}return null},i.offset=function(){},i.rf=function(){},i.Ya=function(e){if(this.h.length){var t=this.h[0];t.Ya(e),0==t.getNumReferences()&&(this.h.shift(),this.i+=t.getNumEvicted(),t.release(),this.Ya(e))}},i.je=function(){},i.pd=function(){},i.Qf=function(){},V("shaka.media.MetaSegmentIndex",Ou),Ou.prototype.updateEvery=Ou.prototype.Qf,Ou.prototype.fit=Ou.prototype.pd,Ou.prototype.mergeAndEvict=Ou.prototype.je,Ou.prototype.evict=Ou.prototype.Ya,Ou.prototype.merge=Ou.prototype.rf,Ou.prototype.offset=Ou.prototype.offset,Ou.prototype.get=Ou.prototype.get,Ou.prototype.find=Ou.prototype.find,Ou.prototype.forEachTopLevelReference=Ou.prototype.Gb,Ou.prototype.release=Ou.prototype.release,Uu.prototype.release=function(){this.set(this.Tc()),this.h&&(this.h.stop(),this.h=null),this.g=null},Uu.prototype.set=function(e){this.i=e,Bu(this)},Uu.prototype.Tc=function(){return this.g.Tc()},ju.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i.stop();for(var e=g(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},p(Vu,Bi),Vu.prototype.release=function(){this.g.clear(),Bi.prototype.release.call(this)},Vu.prototype.j=function(e){for(var t=g(this.g.values()),n=t.next();!n.done;n=t.next()){var r=(n=n.value).og;e:{for(var i=n.qe,a=i.length-1;a>=0;a--){var o=i[a];if(o.position<=e){i=o.xd;break e}}i=null}a=i&&!(r===i||r&&i&&r.bandwidth==i.bandwidth&&r.audioSamplingRate==i.audioSamplingRate&&r.codecs==i.codecs&&r.contentType==i.contentType&&r.frameRate==i.frameRate&&r.height==i.height&&r.mimeType==i.mimeType&&r.channelsCount==i.channelsCount&&r.pixelAspectRatio==i.pixelAspectRatio&&r.width==i.width),o=i&&r&&i.label&&r.label&&r.label!==i.label;var s=i&&r&&i.language&&r.language&&r.language!==i.language;r=i&&r&&i.roles&&r.roles&&!ee(r.roles,i.roles),(o||s||r)&&Hu(this,e,i.contentType)&&(n.og=i,r=new Ni("audiotrackchange",new Map([["quality",i],["position",e]])),this.dispatchEvent(r)),a&&Hu(this,e,i.contentType)&&(n.og=i,JSON.stringify(i),n=new Ni("qualitychange",new Map([["quality",i],["position",e]])),this.dispatchEvent(n))}},p(zu,Bi),zu.prototype.release=function(){this.h.clear(),this.g&&(this.g.stop(),this.g=null),Bi.prototype.release.call(this)},Wu.prototype.Ya=function(e,t){t=void 0!==t&&t;for(var n=g(this.g.keys()),r=n.next();!r.done;r=n.next())e>(r=r.value).endTime&&el(this,r);t&&Qu(this)},Wu.prototype.Jd=function(e){this.o=e,this.h&&this.h.Jd(e)},tl.prototype.abort=function(){this.me&&this.me.abort()},V("shaka.config.CrossBoundaryStrategy",{KEEP:"keep",RESET:"reset",RESET_TO_ENCRYPTED:"reset_to_encrypted",RESET_ON_ENCRYPTION_CHANGE:"RESET_ON_ENCRYPTION_CHANGE"});var dl=(new Map).set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html");function cl(e,t){var n=this;this.g=t,this.j=e,this.i=null,this.M=new Map,this.C=1,this.B=this.o=null,this.V=0,this.h=new Map,this.N=!1,this.X=null,this.F=!1,this.l=new Qi(function(){return function(e){var t,n,r,i,a,o;return P(function(s){if(1==s.g){for(e.u&&e.u.stop(),e.u=null,e.K&&e.K.stop(),e.K=null,e.G&&(e.G.release(),e.G=null),t=[],n=g(e.h.values()),r=n.next();!r.done;r=n.next())_l(i=r.value),t.push(Pl(i)),i.ia&&(Ju(i.ia),i.ia=null);for(a=g(e.m.values()),o=a.next();!o.done;o=a.next())Ju(o.value);return x(s,Promise.all(t),2)}e.h.clear(),e.m.clear(),e.g=null,e.j=null,e.i=null,e.I=null,T(s)})}(n)}),this.R=Date.now()/1e3,this.m=new Map,this.T={projection:null,hfov:null},this.ba=0,this.$=1/0,this.H=null,this.O=[],this.u=new Rr(function(){if(n.j&&n.g)if(n.j.presentationTimeline.W()){var e=n.j.presentationTimeline.$b(),t=n.j.presentationTimeline.Hb();t-e>1?function(e,t,n){P(function(r){return e.I.g||e.g.error||e.N||e.H||Us(e)||Bs(e)?r.return():x(r,Qs(e,function(){Us(e)||Bs(e)||e.i.setLiveSeekableRange(t,n)}),0)})}(n.g.Z,e,t):Xs(n.g.Z)}else Xs(n.g.Z),n.u&&n.u.stop();else n.u&&n.u.stop()}),this.I=null,this.J=!1,this.K=new Rr(function(){var e=n.g.video;!e.ended&&n.I&&(n.J=!0,e.currentTime=n.I,n.I=null)}),this.G=new ne}function hl(e,t){for(var n=e.g.Pb()<0,r=g(e.h.values()),i=r.next();!i.done;i=r.next())(i=i.value).ua&&i.ua.Jd(n),i.ia&&i.ia.Jd(n);for(i=(r=g(e.m.values())).next();!i.done;i=r.next())i.value.Jd(n);(n=e.h.get("video"))&&(r=n.stream)&&(t?(t=r.trickModeVideo)&&!n.Nc&&(gl(e,t,!1,0,!1),n.Nc=r):(t=n.Nc)&&(n.Nc=null,gl(e,t,!0,0,!1)))}function pl(e,t,n,r,i,a){n=void 0!==n&&n,r=void 0===r?0:r,i=void 0!==i&&i,a=void 0!==a&&a,e.o=t,e.N&&(t.video&&gl(e,t.video,n,r,i,a),t.audio&&gl(e,t.audio,n,r,i,a))}function fl(e,t){P(function(n){if(1==n.g)return e.H=null,e.B=t,e.N?t.segmentIndex?n.A(2):x(n,t.createSegmentIndex(),2):n.return();gl(e,t,!0,0,!1),T(n)})}function gl(e,t,n,r,i,a){var o=e.h.get(t.type);o||t.type!=mt?o&&(o.Nc&&(t.trickModeVideo?(o.Nc=t,t=t.trickModeVideo):o.Nc=null),o.stream!=t||i)&&(e.m.has(t)?o.ia=e.m.get(t):o.ia&&function(e,t){t&&t!==e.i&&(Ju(e),e.i=t)}(o.ia,t),t.type==mt&&o.stream!=t&&(i=dr(t.mimeType,t.codecs),Os(e.g.Z,i,e.j.sequenceMode,t.external)),!e.m.has(o.stream)&&o.stream.closeSegmentIndex&&(o.Ka?(i="("+o.type+":"+o.stream.id+")",e.M.has(i)||e.M.set(i,o.stream.closeSegmentIndex)):o.stream.closeSegmentIndex()),i=o.stream.isAudioMuxedInVideo!=t.isAudioMuxedInVideo,o.stream=t,o.ua=null,o.fg=!!a,t.dependencyStream?o.Fc=yl(e,t.dependencyStream):o.Fc=null,Ul(e),i&&(o.pb=null,o.tc=null,o.sc=null,t.isAudioMuxedInVideo&&(t=null,"video"===o.type?t=e.h.get("audio"):"audio"===o.type&&(t=e.h.get("video")),t&&(Pl(t).catch(function(){}),t.pb=null,t.tc=null,t.sc=null,vl(e,t),ml(e,t).catch(function(t){e.g&&e.g.onError(t)})))),n?o.Xb?o.Ld=!0:o.Ka?(o.Vb=!0,o.ld=r,o.Ld=!0):(_l(o),Ml(e,o,!0,r).catch(function(t){e.g&&e.g.onError(t)})):o.Ka||o.qb||Rl(e,o,0),ml(e,o).catch(function(t){e.g&&e.g.onError(t)})):function(e,t){var n,r,i,a,o;P(function(s){switch(s.g){case 1:return n=vt,e.V++,r=e.V,w(s,2),x(s,Gs(e.g.Z,n.Na),4);case 4:A(s,3);break;case 2:i=E(s),e.g&&e.g.onError(i);case 3:a=dr(t.mimeType,t.codecs),Os(e.g.Z,a,e.j.sequenceMode,t.external),(e.g.Z.ba.isTextVisible()||e.i.alwaysStreamText)&&e.V==r&&(o=yl(e,t),e.h.set(n.Na,o),Rl(e,o,0)),T(s)}})}(e,t)}function ml(e,t){var n,r,i;return P(function(a){if(1==a.g)return t.Va?(n=t.stream,r=t.Va,n.segmentIndex?a.A(2):x(a,n.createSegmentIndex(),2)):a.return();if(4!=a.g)return!(i=n.dependencyStream)||i.segmentIndex?a.A(4):x(a,i.createSegmentIndex(),4);if(t.Va!=r||t.stream!=n)return a.return();var o=e.g.nc(),s=Fs(e.g.Z,t.type),u=t.stream.segmentIndex.find(t.Ja?t.Ja.endTime:o),l=null==u?null:t.stream.segmentIndex.get(u);u=l?Ho(l):null,l&&!u&&(u=(l.endTime-l.getStartTime())*(t.stream.bandwidth||e.o.bandwidth)/8),u?((l=l.ea)&&(u+=(l.endByte?l.endByte+1-l.startByte:null)||0),o=8*u/(l=e.g.getBandwidthEstimate())<(s||0)-o-e.i.rebufferingGoal||t.Va.h.g>u):o=!0,o&&t.Va.abort(),T(a)})}function vl(e,t){t.Xb||t.Vb||(t.Ka?(t.Vb=!0,t.ld=0):null==js(e.g.Z,t.type)?null==t.qb&&Rl(e,t,0):(_l(t),Ml(e,t,!1,0).catch(function(t){e.g&&e.g.onError(t)})))}function yl(e,t){var n={stream:t,type:t.type,ua:null,ia:bl(e,t),Ja:null,pb:null,nf:null,tc:null,sc:null,lf:null,mf:null,Nc:null,endOfStream:!1,Ka:!1,qb:null,Vb:!1,ld:0,Ld:!1,Xb:!1,bd:!0,fg:!1,eh:!1,be:!1,Va:null,Fc:null};return t.dependencyStream&&(n.Fc=yl(e,t.dependencyStream)),n}function bl(e,t){if("video"===t.type&&e.i.disableVideoPrefetch||"audio"===t.type&&e.i.disableAudioPrefetch||t.type===mt&&("application/cea-608"==t.mimeType||"application/cea-708"==t.mimeType)||t.type===mt&&e.i.disableTextPrefetch)return null;if(e.m.has(t))return e.m.get(t);var n=e.h.get(t.type);return(n=n&&n.ia)&&t===n.i?n:e.i.segmentPrefetchLimit>0?new Wu(e.i.segmentPrefetchLimit,t,function(t,n,r){return Cl(t,n,r||null,e.i.retryParameters,e.g.vc)},e.g.Pb()<0,e.g.cl):null}function xl(t,n){var r,i,a,o,s,u,l,d,c;return P(function(h){switch(h.g){case 1:if(Zi(t.l),r=vt,n.Ka||null==n.qb||n.Xb)return h.return();if(n.qb=null,!n.Vb){h.A(2);break}return x(h,Ml(t,n,n.Ld,n.ld),3);case 3:return h.return();case 2:if(function(e,t){for(var n=g(e.M.entries()),r=n.next();!r.done;r=n.next()){var i=g(r.value);r=i.next().value,i=i.next().value,r.includes(t.type)&&(i(),e.M.delete(r))}}(t,n),n.stream.segmentIndex){h.A(4);break}return i=n.stream,w(h,5),x(h,n.stream.createSegmentIndex(),7);case 7:A(h,6);break;case 5:return a=E(h),x(h,Dl(t,n,a),8);case 8:return h.return();case 6:if(i!=n.stream)return i.closeSegmentIndex&&i.closeSegmentIndex(),n.Ka||n.qb||Rl(t,n,0),h.return();case 4:if(!n.Fc){h.A(9);break}if(n.Fc.stream.segmentIndex){h.A(9);break}return w(h,11),x(h,n.Fc.stream.createSegmentIndex(),13);case 13:A(h,9);break;case 11:E(h);case 9:w(h,14),o=function(t,n){if(kl(n))return function(e,t){var n=Fs(e,"video")||0;Er(e.h,t,n)}(t.g.Z,n.stream.originalId||""),null;if(n.type==mt&&function(e){e.h&&Er(e.h,"",0)}(t.g.Z),n.stream.isAudioMuxedInVideo&&"audio"==n.type)return null;if(n.type!=mt&&Bs(t.g.Z))return Nl(t,!0),null;var r=t.i.updateIntervalSeconds/Math.max(1,Math.abs(t.g.Pb()));if(!Ns(t.g.Z)&&n.type!=mt)return r/2;var i=t.g.nc();if("audio"===n.type)for(var a=g(t.m.keys()),o=a.next();!o.done;o=a.next())(o=t.m.get(o.value)).Ya(i,!0),qu(o,i);a=n.Ja?n.Ja.endTime:i;var s=function(e,t,n){return t==mt?null==(e=e.h).h||e.h<n?0:e.h-Math.max(n,e.g):$o(e=Vs(e,t),n)}(t.g.Z,n.type,i);o=Math.max(1,Math.max(t.i.rebufferingGoal,t.i.bufferingGoal)*t.C);var u=t.j.presentationTimeline.getDuration()-a,l=Fs(t.g.Z,n.type);if(u<1e-6&&l)return n.endOfStream=!0,"video"==n.type&&(r=t.h.get(mt))&&kl(r)&&(r.endOfStream=!0),null;if(n.endOfStream=!1,s>=o)return r/2;if(u=!n.ua,!(l=Tl(t,n,i,l)))return t=1/0,(n=n.Ja)&&(t=n.endTime-n.startTime),Math.min(t/2,r);s=n.pb;var d=l.ea;s&&d&&Fo(d,s)&&(s.g=d.g),s=!1,u&&n.fg&&(s=!0,n.fg=!1),u=1/0;for(var c=(d=g(d=Array.from(t.h.values()))).next();!c.done;c=d.next())kl(c=c.value)||c.ua&&!c.ua.current()||(u=Math.min(u,c.Ja?c.Ja.endTime:i));return a>=u+t.j.presentationTimeline.h?r:(n.ia&&n.ua&&!t.m.has(n.stream)&&(n.ia.Ya(l.startTime+.001),qu(n.ia,l.startTime).catch(function(){})),Ol(t)&&function(e,t,n){if(t.type===mt)return!1;var r=t.pb;if(!r)return!1;var i=n.ea;if(n=r.g!==i.g,"reset_to_encrypted"===e.i.crossBoundaryStrategy&&(r.encrypted||i.encrypted||(n=!1),r.encrypted&&(e.i.crossBoundaryStrategy="keep")),"RESET_ON_ENCRYPTION_CHANGE"===e.i.crossBoundaryStrategy&&r.encrypted==i.encrypted&&(n=!1),"keep"===e.i.crossBoundaryStrategy&&r.mimeType&&i.mimeType){var a=fr(vr(r.mimeType)),o=fr(vr(r.mimeType));r.mimeType==i.mimeType&&a==o&&(n=!1)}return n&&(e.J||t.bd)&&(e.J=!1,Nl(e,!0).then(function(){var t=(new Map).set("oldEncrypted",r.encrypted).set("newEncrypted",i.encrypted);e.g.onEvent(new Ni("boundarycrossed",t))})),n}(t,n,l)||(function(t,n,r,i,a){var o,s,u,l,d,c,h,p,f,m,v,y,b,S,k,I;return P(function(C){switch(C.g){case 1:if(o=vt,s=n.stream,u=n.ua,n.Ka=!0,w(C,2),2==i.Kc())throw new Ke(1,1,1011);return x(C,function(e,t,n,r){var i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,T;return P(function(S){switch(S.g){case 1:if(i=vt,a=null==t.Ja,o=[],s=Math.max(0,Math.max(n.appendWindowStart,e.ba)-.1),u=Math.min(n.appendWindowEnd,e.$)+.1,l=n.codecs||t.stream.codecs,d=gr(l),c=mr(n.mimeType||t.stream.mimeType),(h=n.timestampOffset)==t.nf&&s==t.tc&&u==t.sc&&d==t.lf&&c==t.mf){S.A(2);break}if(p=t.lf&&t.mf&&function(e,t,n,r,i){return(e=ru(e,t,n,r,i)).jc&&e.jc.destroy(),e.type==su}(e.g.Z,t.type,c,l,jl(e)),!p){S.A(3);break}if(f=null,t.type===i.wa?f=e.h.get(i.aa):t.type===i.aa&&(f=e.h.get(i.wa)),!f){S.A(3);break}return x(S,Pl(f).catch(function(){}),5);case 5:f.pb=null,f.tc=null,f.sc=null,vl(e,f);case 3:return x(S,Sl(e,t,h,s,u,n,d,c),2);case 2:return Fo(n.ea,t.pb)||(t.pb=n.ea,n.l&&n.ea&&(m=Il(e,t,n.ea),v=function(){var a,o,s,u,l,d,c,h,p,f,v;return P(function(y){switch(y.g){case 1:return w(y,2),x(y,m,4);case 4:return a=y.h,Zi(e.l),o=null,s=new Map,u={projection:null,hfov:null},t.stream&&(l=t.stream.videoLayout)&&((d=l.split("/")).includes("PROJ-RECT")?u.projection="rect":d.includes("PROJ-EQUI")?u.projection="equi":d.includes("PROJ-HEQU")?u.projection="hequ":d.includes("PROJ-PRIM")?u.projection="prim":d.includes("PROJ-AIV")&&(u.projection="hequ")),(c=new oa).box("moov",sa).box("trak",sa).box("mdia",sa).S("mdhd",function(e){o=io(e.reader,e.version).timescale}).box("hdlr",function(e){switch((e=e.reader).skip(8),e.Yc()){case"soun":s.set(i.aa,o);break;case"vide":s.set(i.wa,o)}o=null}),t.type!==i.wa||u.projection||c.box("minf",sa).box("stbl",sa).S("stsd",ua).box("encv",la).box("avc1",la).box("avc3",la).box("hev1",la).box("hvc1",la).box("dvav",la).box("dva1",la).box("dvh1",la).box("dvhe",la).box("dvc1",la).box("dvi1",la).box("vexu",sa).box("proj",sa).S("prji",function(e){e=e.reader.Yc(),u.projection=e}).box("hfov",function(e){e=e.reader.U()/1e3,u.hfov=e}),c.parse(a,!0,!0),t.type===i.wa&&function(e,t){if(e.T.projection!=t.projection||e.T.hfov!=t.hfov){if(null!=t.projection||null!=t.hfov){var n=(new Map).set("detail",t);n=new Ni("spatialvideoinfo",n)}else n=new Ni("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.T=t}}(e,u),s.has(t.type)?n.ea.timescale=s.get(t.type):null!=o&&(n.ea.timescale=o),(h=t.stream.segmentIndex)instanceof Ou&&(p=function(e,t){for(var n=(e=g(e.h)).next();!n.done;n=e.next())if(null!=(n=n.value).find(t))return n.Ve();return-1}(h,n.startTime)),f=t.stream.closedCaptions&&t.stream.closedCaptions.size>0,x(y,e.g.Sh(t.type,a),5);case 5:return x(y,Hs(e.g.Z,t.type,a,null,t.stream,f,t.bd,r,!1,!1,p),6);case 6:A(y,0);break;case 2:throw v=E(y),t.pb=null,v}})},y=n.startTime,a&&null!=(b=Fs(e.g.Z,t.type))&&(y=b),e.g.Dk(y,n.ea),o.push(v()))),T=t.Ja?t.Ja.i:-1,n.i!=T&&o.push(function(e,t,n){var r,i;return P(function(a){return 1==a.g?t==(r=vt).Na?a.return():(t==r.wa&&(e.ab=new Ci),!e.J||(i=Fs(e,t))&&Math.abs(i-n)<.15?a.return():(Js(e,t,function(){return Ks(e,t)},null),e.m&&Js(e,r.aa,function(){return Ks(e,r.aa)},null),x(a,Js(e,t,function(){return qs(e,t,n)},null),2))):e.m?x(a,Js(e,r.aa,function(){return qs(e,r.aa,n)},null),0):a.A(0)})}(e.g.Z,t.type,n.startTime)),x(S,Promise.all(o),0)}})}(t,n,i,a),4);case 4:return Zi(t.l),t.F?C.return():(l="video/mp4"==s.mimeType||"audio/mp4"==s.mimeType,d=e.ReadableStream,t.i.lowLatencyMode&&t.j.isLowLatency&&d&&l&&("HLS"!=t.j.type||i.o)?(h=new Uint8Array(0),f=p=!1,v=function(e){var o,u,l;return P(function(d){switch(d.g){case 1:if(p)return d.return();if(f=!0,Zi(t.l),t.F)return d.return();if(w(d,2),h=lt(h,e),o=!1,u=0,(new oa).box("mdat",function(e){u=e.size+e.start,o=!0}).parse(h,!1,!0),!o){d.A(4);break}return l=h.subarray(0,u),h=h.subarray(u),x(d,Al(t,n,r,s,i,l,!0,a),5);case 5:n.ia&&n.ua&&qu(n.ia,i.startTime,!0);case 4:A(d,0);break;case 2:m=E(d),T(d)}})},x(C,Il(t,n,i,v),9)):x(C,Il(t,n,i),7));case 7:return c=C.h,Zi(t.l),t.F?C.return():(Zi(t.l),n.Vb?(n.Ka=!1,Rl(t,n,0),C.return()):x(C,Al(t,n,r,s,i,c,!1,a),6));case 9:if(y=C.h,m)throw m;if(f){C.A(10);break}return p=!0,Zi(t.l),t.F?C.return():n.Vb?(n.Ka=!1,Rl(t,n,0),C.return()):x(C,Al(t,n,r,s,i,y,!1,a),10);case 10:n.ia&&n.ua&&qu(n.ia,i.startTime,!0);case 6:if(Zi(t.l),t.F)return C.return();n.Ja=i,u.next(),n.Ka=!1,n.eh=!1,b=t.g.Z.Gc(),S=b[n.type],JSON.stringify(S),n.Vb||(k=null,n.type===o.wa?k=t.h.get(o.aa):n.type===o.aa&&(k=t.h.get(o.wa)),k&&k.type==o.aa?t.g.zd(i,n.stream,k.stream.isAudioMuxedInVideo,!1):t.g.zd(i,n.stream,n.stream.codecs.includes(","),!1)),_l(n),Rl(t,n,0),A(C,0);break;case 2:if(I=E(C),Zi(t.l,I),t.F)return C.return();if(n.Ka=!1,7001==I.code)n.Ka=!1,_l(n),Rl(t,n,0),C.A(0);else{if(n.type!=o.Na||!t.i.ignoreTextStreamFailures)return 3017==I.code?x(C,function(e,t,n){var r,i,a,o,s;return P(function(u){switch(u.g){case 1:if(Array.from(e.h.values()).some(function(e){return e!=t&&e.eh})){u.A(2);break}if(e.i.avoidEvictionOnQuotaExceededError)return r=Ll(e,n),e.g.disableStream(t.stream,r)||Rl(e,t,4),u.return();if((i=Math.round(100*e.C))>20){e.C-=.2,u.A(3);break}if(i>4){e.C-=.04,u.A(3);break}if(a=Ll(e,n),!e.g.disableStream(t.stream,a)){t.be=!0,e.F=!0,e.g.onError(n),u.A(5);break}return e.C=1,o=e.g.nc(),x(u,El(e,t,o),5);case 5:return u.return();case 3:return t.eh=!0,s=e.g.nc(),x(u,El(e,t,s),2);case 2:Rl(e,t,4),T(u)}})}(t,n,I),0):(n.be=!0,1==I.category&&n.ia&&el(n.ia,i),I.severity=2,x(C,Dl(t,n,I),0));t.h.delete(o.Na),C.A(0)}}})}(t,n,i,l,s).catch(function(){}),n.Fc&&wl(t,n.Fc,i,o)),null)}(t,n),null!=o&&(Rl(t,n,o),n.be=!1),A(h,15);break;case 14:return s=E(h),x(h,Dl(t,n,s),16);case 16:return h.return();case 15:if(n.type===r.Na)return h.return();if(u=[],n.stream&&!n.stream.isAudioMuxedInVideo&&u.push(n),l=n.type===r.aa?r.wa:r.aa,(d=t.h.get(l))&&d.stream&&!d.stream.isAudioMuxedInVideo&&u.push(d),!t.N||!u.every(function(e){return e.endOfStream})){h.A(0);break}return x(h,t.g.Z.endOfStream(),18);case 18:Zi(t.l),0!=(c=t.g.Z.getDuration())&&c<t.j.presentationTimeline.getDuration()&&t.j.presentationTimeline.Ab(c),T(h)}})}function Tl(e,t,n,r){if(t.ua)return(n=t.ua.current())&&t.Ja&&Math.abs(t.Ja.startTime-n.startTime)<.001&&(n=t.ua.next().value),n;if(t.Ja||r)return n=t.Ja?t.Ja.endTime:r,e=e.g.Pb()<0,t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Yb(n,!1,e)),t.ua&&t.ua.next().value;r=e.j.sequenceMode||Ol(e)?0:e.i.inaccurateManifestTolerance;var i=Math.max(n-r,0);e=e.g.Pb()<0;var a=null;return r&&(t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Yb(i,!1,e)),a=t.ua&&t.ua.next().value),a||(t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Yb(n,!1,e)),a=t.ua&&t.ua.next().value),a}function wl(e,t,n,r){var i,a,o,s,u,l,d,c,h,p,f,g;return P(function(v){switch(v.g){case 1:for(i=vt,a=t.stream,u=(s=(o=a.segmentIndex)&&o.Yb(n))&&s.next().value;u&&e.O.includes(u.startTime);)u=s&&s.next().value;if(!u){v.A(0);break}if(!(l=u.ea)||Fo(l,t.pb)){v.A(3);break}return t.pb=l,w(v,4),x(v,Il(e,t,l),6);case 6:d=v.h;var y=e.g.Z;y.C&&Tt(y.C,d,0,a),e.O=[],A(v,3);break;case 4:throw c=E(v),t.pb=null,c;case 3:if(t.Ja&&t.Ja==u){v.A(0);break}return t.Ja=u,w(v,8),x(v,Il(e,t,u),10);case 10:h=v.h,(y=e.g.Z).C&&Tt(y.C,h,0,a),e.O.push(u.startTime),A(v,9);break;case 8:throw p=E(v),t.Ja=null,p;case 9:if(t.Vb||(f=null,t.type===i.wa?f=e.h.get(i.aa):t.type===i.aa&&(f=e.h.get(i.wa)),f&&f.type==i.aa?e.g.zd(u,t.stream,f.stream.isAudioMuxedInVideo,!0):e.g.zd(u,t.stream,t.stream.codecs.includes(","),!0)),g=Math.max.apply(Math,[0].concat(m(e.O))),e.g.nc()+r>g)return x(v,wl(e,t,u.startTime,r),0);v.A(0)}})}function Sl(e,t,n,r,i,a,o,s){var u,l,d,c,h;return P(function(p){switch(p.g){case 1:if(u=vt,l=jl(e),w(p,2),t.tc=r,t.sc=i,o&&(t.lf=o),s&&(t.mf=s),t.nf=n,d=e.j.sequenceMode||"HLS"==e.j.type,c=null,t.type===u.wa?c=e.h.get(u.aa):t.type===u.aa&&(c=e.h.get(u.wa)),!(c&&c.stream&&c.stream.isAudioMuxedInVideo)){p.A(4);break}return x(p,zs(e.g.Z,c.type,n,r,i,d,c.stream.mimeType,c.stream.codecs,l),4);case 4:return x(p,zs(e.g.Z,t.type,n,r,i,d,a.mimeType||t.stream.mimeType,a.codecs||t.stream.codecs,l),6);case 6:A(p,0);break;case 2:throw h=E(p),t.tc=null,t.sc=null,t.lf=null,t.mf=null,t.nf=null,h}})}function Al(e,t,n,r,i,a,o,s){var u,l,d,c;return o=void 0!==o&&o,s=void 0!==s&&s,P(function(h){switch(h.g){case 1:return u=r.closedCaptions&&r.closedCaptions.size>0,e.i.shouldFixTimestampOffset&&(l="video/mp4"==r.mimeType||"audio/mp4"==r.mimeType,d=null,i.ea&&(d=i.ea.timescale),l&&d&&"video"===r.type&&"DASH"==e.j.type&&(new oa).box("moof",sa).box("traf",sa).S("tfdt",function(n){var r,a,o,s,u;return P(function(l){return r=ro(n.reader,n.version),(a=r.baseMediaDecodeTime)?(o=-a/d,(Number(t.nf)||0)<o?(s=t.tc,u=t.sc,x(l,Sl(e,t,o,s,u,i),0)):l.A(0)):l.return()})}).parse(a,!1,o)),x(h,El(e,t,n),2);case 2:return Zi(e.l),c=t.bd,t.bd=!1,x(h,e.g.Sh(t.type,a),3);case 3:return x(h,Hs(e.g.Z,t.type,a,i,r,u,c,s,o),4);case 4:Zi(e.l),T(h)}})}function El(e,t,n){var r,i,a,o,s,u,l,d,c;return P(function(h){return 1==h.g?(e.H==t&&(e.H=null),(r=t.stream.segmentIndex)instanceof Ou&&(r.Ya(e.j.presentationTimeline.Ib()),i=[],function(e,t){for(var n=(e=g(e.h)).next();!n.done;n=e.next())t(n.value)}(r,function(e){i.push(e.Ve())})),a=Math.max(e.i.bufferBehind*e.C,e.j.presentationTimeline.h),null==(o=js(e.g.Z,t.type))?h.return():(s=n-o,u=e.i.evictionGoal,l=e.j.presentationTimeline.$b(),d=e.j.presentationTimeline.Hb(),c=s-a,d-l>u&&(c=Math.max(s-a,l-u-o)),c<=u?h.return():x(h,e.g.Z.remove(t.type,o,o+c,i),2))):4!=h.g?(Zi(e.l),e.H?x(h,El(e,e.H,n),4):h.A(0)):(Zi(e.l),void T(h))})}function kl(e){return e&&e.type==mt&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function Il(e,t,n,r){var i,a,o,s,u;return P(function(l){switch(l.g){case 1:if(i=n.ac())return l.return(i);if(a=null,t.ia){var d=t.ia,c=d.g;n instanceof jo&&(c=d.j),c.has(n)?(d=c.get(n),r&&(d.Ah=r),a=d.me):a=null}return a||(a=Cl(n,t.stream,r||null,e.i.retryParameters,e.g.vc)),o=0,t.ua&&(o=t.ua.h),t.Va=a,x(l,a.promise,2);case 2:if(s=l.h,t.Va=null,u=s.data,!n.aesKey){l.A(3);break}return x(l,ol(u,n.aesKey,o),4);case 4:u=l.h;case 3:return l.return(u)}})}function Cl(e,t,n,r,i,a){a=void 0!==a&&a;var o=e instanceof Vo?e:void 0,s=o?1:0;return(e=ll(e.P(),e.startByte,e.endByte,r,n)).contentType=t.type,i.request(Yi,e,{type:s,stream:t,segment:o,isPreload:a})}function Ml(e,t,n,r){var i,a;return P(function(o){return 1==o.g?(t.Vb=!1,t.Ld=!1,t.ld=0,t.Xb=!0,t.Ja=null,t.ua=null,t.ia&&!e.m.has(t.stream)&&Ju(t.ia),r?(i=e.g.nc(),a=e.g.Z.getDuration(),x(o,e.g.Z.remove(t.type,i+r,a),3)):x(o,Gs(e.g.Z,t.type),4)):3!=o.g?(Zi(e.l),n?x(o,e.g.Z.flush(t.type),3):o.A(3)):(Zi(e.l),t.Xb=!1,t.endOfStream=!1,t.Ka||t.qb||Rl(e,t,0),void T(o))})}function Rl(e,t,n){var r=t.type;(r!=mt||e.h.has(r))&&(t.qb=new Mr(function(){var n;return P(function(r){return 1==r.g?(w(r,2),x(r,xl(e,t),4)):2!=r.g?A(r,0):(n=E(r),e.g&&e.g.onError(n),void T(r))})}).ka(n))}function _l(e){null!=e.qb&&(e.qb.stop(),e.qb=null)}function Pl(e){return P(function(t){return e.Va?x(t,e.Va.abort(),0):t.A(0)})}function Dl(e,t,n){var r;return P(function(i){if(1==i.g)return 3024==n.code?(t.Ka=!1,_l(t),Rl(e,t,0),i.return()):x(i,ki(e.X),2);if(Zi(e.l),1===n.category&&1003!=n.code){if(t.Nc)return hl(e,!1),i.return();r=Ll(e,n),n.handled=e.g.disableStream(t.stream,r),n.handled&&(n.severity=1)}n.handled&&1011==n.code||e.g.onError(n),n.handled||e.i.failureCallback(n),T(i)})}function Ll(e,t){return 0===e.i.maxDisabledTime&&1011==t.code?1:e.i.maxDisabledTime}function Nl(e,t){var n,r,i,a,o,s;return t=void 0!==t&&t,P(function(u){if(1==u.g){if(n=Date.now()/1e3,r=e.i.minTimeBetweenRecoveries,!t){if(!e.i.allowMediaSourceRecoveries||n-e.R<r)return u.return(!1);e.R=n}return i=vt,(a=e.h.get(i.aa))&&(_l(a),a.Va&&(a.Va.abort(),a.Va=null),a.pb=null,a.tc=null,a.sc=null,a.Ka=!1,a.Vb=!1,a.ld=0,a.Ld=!1,a.Xb=!1,a.ua&&a.ua.ih()),(o=e.h.get(i.wa))&&(_l(o),o.Va&&(o.Va.abort(),o.Va=null),o.pb=null,o.tc=null,o.sc=null,o.Ka=!1,o.Vb=!1,o.ld=0,o.Ld=!1,o.Xb=!1,o.ua&&o.ua.ih()),s=e.g.video.paused,x(u,tu(e.g.Z,jl(e)),2)}return!o||o.Xb||o.Ka||o.qb||Rl(e,o,0),!a||a.Xb||a.Ka||a.qb||Rl(e,a,0),s||e.g.video.play(),u.return(!0)})}function Ol(e){if("keep"!==e.i.crossBoundaryStrategy)return!0;var t=oe();if(t.Bb()){if(!t.Mf())for(n=(t=g(e.h.keys())).next();!n.done;n=t.next())if((n=e.h.get(n.value)).type!==vt.Na&&(n=n.stream)&&n.fullMimeTypes&&n.fullMimeTypes.size>1){for(e=new Set,n=(t=g(n.fullMimeTypes)).next();!n.done;n=t.next())e.add(pr(n.value));return e.size>1}}else for(var n=(t=g(e.h.keys())).next();!n.done;n=t.next())if((n=e.h.get(n.value)).type!==vt.Na&&(n=n.stream)&&n.fullMimeTypes&&n.fullMimeTypes.size>1)return!0;return!1}function Ul(e){e.G.Qa(),Ol(e)&&(e.G.D(e.g.video,"waiting",function(){return Bl(e)}),e.G.D(e.g.video,"timeupdate",function(){return Bl(e)}))}function Bl(e){if(Ol(e)){e.K.stop();var t=e.g.nc(),n=e.h.get("video")||e.h.get("audio");n&&(n=n.pb)&&null!==n.g&&((t=n.g-t)<0||t>1||(e.I=n.g+.1,e.K.ka(t)))}}function jl(e,t){function n(t){if(t.fullMimeTypes&&t.fullMimeTypes.size>1&&e.h.has(t.type)){var n=e.h.get(t.type),r=Fs(e.g.Z,n.type),i=e.g.nc();(n=Tl(e,n,i,r))&&n.codecs&&n.mimeType&&(t.codecs=n.codecs,t.mimeType=n.mimeType)}}t=void 0!==t&&t;var r=new Map,i=e.o.audio;return i&&(n(i),r.set("audio",i)),(i=e.o.video)&&(n(i),r.set("video",i)),t&&e.B&&r.set(mt,e.B),r}function Fl(){}function Vl(e,t,n,r,i){var a,o=i in r,s=o?n.constructor==Object&&0==Object.keys(r).length:n.constructor==Object&&0==Object.keys(n).length,u=o||s,l=!0;for(a in t){var d=i+"."+a,c=o?r[i]:n[a];u||a in n?void 0===t[a]?void 0===c||u?delete e[a]:e[a]=Kt(c):s?e[a]=t[a]:c.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Kt(c)),d=Vl(e[a],t[a],c,r,d),l=l&&d):typeof t[a]!=typeof c||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=c.constructor?(W("Invalid config, wrong type for "+d),l=!1):"function"==typeof n[a]&&n[a].length!=t[a].length?(K("Unexpected number of arguments for "+d),e[a]=t[a]):e[a]=Array.isArray(e[a])?t[a].slice():t[a]:(W("Invalid config, unrecognized key "+d),l=!1)}return l}function Hl(e,t){for(var n={},r=n,i=0,a=0;!((i=e.indexOf(".",i))<0);)0!=i&&"\\"==e[i-1]||(r[a=e.substring(a,i).replace(/\\\./g,".")]={},r=r[a],a=i+1),i+=1;return r[e.substring(a).replace(/\\\./g,".")]=t,n}function Gl(e,t){return e&&t}function zl(e,t){function n(e){return e&&"object"==typeof e&&!Array.isArray(e)}return e=function e(t,r){return Object.keys(t).reduce(function(i,a){var o=t[a];return r.hasOwnProperty(a)?o instanceof HTMLElement&&r[a]instanceof HTMLElement?o.isEqualNode(r[a])||(i[a]=o):n(o)&&n(r[a])?(o=e(o,r[a]),(Object.keys(o).length>0||!n(o))&&(i[a]=o)):Array.isArray(o)&&Array.isArray(r[a])?Z(o,r[a])||(i[a]=o):Number.isNaN(o)&&Number.isNaN(r[a])||o!==r[a]&&(i[a]=o):i[a]=o,i},{})}(e,t),function e(t){for(var r=g(Object.keys(t)),i=r.next();!i.done;i=r.next())if(!(t[i=i.value]instanceof HTMLElement))if(n(t[i])&&0===Object.keys(t[i]).length)delete t[i];else{var a=t[i];Array.isArray(a)&&0===a.length||"function"==typeof t[i]?delete t[i]:n(t[i])&&(e(t[i]),0===Object.keys(t[i]).length&&delete t[i])}}(e),e}function Xl(){}function Wl(e){return new me(e=Je(e)).Eb}function Kl(e,t,n){function r(e){Ue(a).setUint32(o,e.byteLength,!0),o+=4,a.set(Ne(e),o),o+=e.byteLength}if(!n||!n.byteLength)throw new Ke(2,6,6015);var i;i="string"==typeof t?Ze(t,!0):t,e=Ze(e=Je(e),!0);var a=new Uint8Array(12+e.byteLength+i.byteLength+n.byteLength),o=0;return r(e),r(i),r(n),a}function ql(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Kl(e,n=Je(e).split("skd://").pop(),t))}function Yl(e,t){2===e&&(e=t.drmInfo)&&He(e.keySystem)&&(t.headers["Content-Type"]="application/octet-stream")}function $l(e,t,n){for(n=void 0===n||n,this.h=e,this.g=new Set([e]),t=(e=g(t=t||[])).next();!t.done;t=e.next())this.add(t.value,n)}function Jl(e,t){return e.mimeType==t.mimeType&&Z(e=e.codecs.split(",").map(function(e){return gr(e)}),t=t.codecs.split(",").map(function(e){return gr(e)}))}function Ql(){this.h=this.g=null}function Zl(e,t){return e.filter(function(e){return!(e.audio&&e.audio.channelsCount&&e.audio.channelsCount>t)}).sort(function(e,t){return e.audio||t.audio?e.audio?t.audio?(t.audio.channelsCount||0)-(e.audio.channelsCount||0):1:-1:0})}function ed(e,t){return e.filter(function(e){return!e.audio||e.audio.codecs==t})}function td(){}function nd(){var t=1/0,n=oe();navigator.connection&&navigator.connection.saveData&&(t=360);var r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(t,n,r){return"apple"===e.shakaMediaKeysPolyfill&&"skd"==n&&(n=r.serverCertificate,t=Kl(t,r=Wl(t),n)),t},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:!1,minHdcpVersion:"",ignoreDuplicateInitData:!0,defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"},i="reload";n.Bb()&&(i="smooth");var a={trackSelectionCallback:function(e){return P(function(t){return t.return(e)})},downloadSizeCallback:function(e){var t;return P(function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?x(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))})},progressCallback:function(e,t){return Gl([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5},o={drm:r,manifest:{retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,ignoreSupplementalCodecs:!1,updatePeriod:-1,ignoreDrmInfo:!1,enableAudioGroups:!0,dash:{clockSyncUri:"",disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:ad,manifestPreprocessorTXml:od,sequenceMode:!1,useStreamOnceInPeriodFlattening:!1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:n.fd(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0,allowRangeRequestsToGuessMimeType:!1},mss:{manifestPreprocessor:ad,manifestPreprocessorTXml:od,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}},streaming:{retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function(e){return Gl([e])},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!0,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:1,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:!1,dontChooseCodecs:!1,shouldFixTimestampOffset:!1,avoidEvictionOnQuotaExceededError:!1,crossBoundaryStrategy:"keep",returnToEndOfLiveWindowWhenOutside:!1},networking:{forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3},mediaSource:{codecSwitchingStrategy:i,addExtraFeaturesToSourceBuffer:function(e){return Gl([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,correctEc3Enca:!1,modifyCueCallback:function(e,t,n){return Gl([e,t,n])},dispatchAllEmsgBoxes:!1,useSourceElements:!0,durationReductionEmitsUpdateEnd:!0},offline:a,abrFactory:function(){return new Ti},adaptationSetCriteriaFactory:function(){return new(Function.prototype.bind.apply(Ql,[null].concat(m(D.apply(0,arguments)))))},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:5,minTimeToSwitch:0,preferNetworkInformationBandwidth:!1,removeLatencyFromFirstPacketTime:!0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredAudioRole:"",preferredVideoRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25,fontScaleFactor:1},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1,targets:[]},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1,poster:!0},ads:{customPlayheadTracker:!1,skipPlayDetection:!1,supportsMultipleMediaElements:!0,disableHLSInterstitial:!1,disableDASHInterstitial:!1,allowPreloadOnDomElements:!0,allowStartInMiddleOfInterstitial:!0},ignoreHardwareResolution:!1,queue:{preloadNextUrlWindow:1/0,preloadPrevItem:!0,repeatMode:0}};return a.trackSelectionCallback=function(e){return P(function(t){return t.return(function(e,t,n){var r=n;"AUTO"==r&&(n=e.some(function(e){return!(!e.hdr||"HLG"!=e.hdr)}),r=oe().sd(n));var i=e.filter(function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=r)});n=[];var a=Gr(t,i.map(function(e){return e.language}));a&&(n=i.filter(function(e){return jr(e.language)==a})),0==n.length&&(n=i.filter(function(e){return e.primary})),0==n.length&&(i.map(function(e){return e.language}),n=i);var o=n.filter(function(e){return e.height&&e.height<=480});for(o.length&&(o.sort(function(e,t){return t.height-e.height}),n=o.filter(function(e){return e.height==o[0].height})),t=[],n.length&&(i=Math.floor(n.length/2),n.sort(function(e,t){return e.bandwidth-t.bandwidth}),t.push(n[i])),e=g(e),n=e.next();!n.done;n=e.next())(n=n.value).type!=mt&&"image"!=n.type||t.push(n);return t}(e,o.preferredAudioLanguage,o.preferredVideoHdrLevel))})},n.Wa(o)}function rd(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}}function id(e,t,n){var r={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return Vl(e,t,n||nd(),r,"")}function ad(e){return Gl([e],e)}function od(e){return Gl([e],e)}function sd(){this.g=null,this.h=[]}function ud(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration);for(var r=(e=g(e.h)).next();!r.done;r=e.next())n+=(r=r.value).state==t?r.duration:0;return n}function ld(){this.i=this.h=null,this.g=[]}function dd(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function cd(){this.C=this.X=NaN,this.l="",this.j=this.ti=this.u=this.B=this.K=this.F=this.o=this.m=this.J=this.G=this.i=this.T=this.V=this.N=this.O=this.R=NaN,this.M=0,this.H=this.I=NaN,this.g=new sd,this.h=new ld}function hd(e,t,n){e.X=t,e.C=n}function pd(e,t){e.j=isNaN(e.j)?t:e.j+t}function fd(e){for(var t=e.X,n=e.C,r=e.l,i=e.B,a=e.O,o=e.R,s=e.N,u=e.V,l=e.T,d=e.u,c=e.i,h=e.G,p=e.J,f=e.m,m=ud(e.g,"playing"),v=ud(e.g,"paused"),y=ud(e.g,"buffering"),b=e.o,x=e.F,T=e.K,w=e.ti,S=e.j,A=e.M,E=e.I,k=e.H,I=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],r=g(e.h),i=r.next();!i.done;i=r.next())n.push(t(i.value));return e.g&&n.push(t(e.g)),n}(e.g),C=[],M=(e=g(e.h.g)).next();!M.done;M=e.next())M=M.value,C.push({timestamp:M.timestamp,id:M.id,type:M.type,fromAdaptation:M.fromAdaptation,bandwidth:M.bandwidth});return{width:t,height:n,currentCodecs:r,streamBandwidth:i,decodedFrames:a,droppedFrames:o,corruptedFrames:s,stallsDetected:u,gapsJumped:l,estimatedBandwidth:d,completionPercent:c,loadLatency:h,manifestTimeSeconds:p,drmTimeSeconds:f,playTime:m,pauseTime:v,bufferingTime:y,licenseTime:b,liveLatency:x,maxSegmentDuration:T,manifestSizeBytes:w,bytesDownloaded:S,nonFatalErrorCount:A,manifestPeriodCount:E,manifestGapCount:k,stateHistory:I,switchHistory:C}}function gd(e,t,n,r){Bi.call(this),this.N=e,this.V=t,this.Da=r.networkingEngine,this.o=n,this.C=null,this.za=0,this.Ta=r.md,this.G=r.wk,this.Ua=r.xk,this.g=r.config,this.m=this.H=this.h=null,this.oa=!1,this.I=r.Ik,this.va=!1,this.j=null,this.ba=!1,this.u=null,this.M=new Map,this.ya=!1,this.Fa=r.Hk,this.X=new cd,this.ma=new Ci,this.B=new Ci,this.O=null,this.l=!1,this.$=r.nj,this.T=this.i=null,this.R=!1,this.K=[],this.J=[],this.F=!0}function md(e,t,n){(e=t?e.J:e.K)?e.push(n):n()}function vd(e,t){if(e.O=t,e.R=!0,e.K)for(var n=(t=g(e.K)).next();!n.done;n=t.next())(n=n.value)();e.K=null}function yd(e){if(e.l)throw new Ke(2,7,7003)}function bd(e,t){e.dispatchEvent(new Ni("onstatechange",(new Map).set("state",t)))}function xd(e,t){var n,r,i;return P(function(a){switch(a.g){case 1:return!e.h||e.j?a.return():(bd(e,"drm-engine"),e.za=Date.now()/1e3,e.j=e.Ta(),e.G.h=e.j,e.j.configure(e.g.drm,function(){return e.F}),n=li(e.h.variants),r=!0,e.h&&e.h.presentationTimeline&&(r=e.h.presentationTimeline.W()),x(a,xa(e.j,n,e.h.offlineSessionIds,r),2));case 2:if(yd(e),!t){a.A(3);break}return x(a,e.j.Wb(t),4);case 4:yd(e);case 3:return x(a,Ka(e.G,e.h),5);case 5:if(!a.h){a.A(0);break}return i=new Ni("trackschanged",void 0),x(a,Promise.resolve(),7);case 7:e.dispatchEvent(i),T(a)}})}function Td(e){if(!e.u){var t=e.g.abrFactory;e.u=t(),e.u.configure(e.g.abr)}return t=li(e.h.variants),t=e.C.create(t),e.u.setVariants(Array.from(t.values())),e.u.chooseVariant(!0)}function wd(e,t,n){var r,i,a,o,s;return P(function(u){return 1==u.g?(r=e.g.streaming.segmentPrefetchLimit||2,i=new Wu(r,t,function(t,n,r){return Cl(t,n,r||null,e.g.streaming.retryParameters,e.Da,e.F)},!1),e.M.set(t.id,i),t.segmentIndex?u.A(2):x(u,t.createSegmentIndex(),2)):(a="number"==typeof e.o?e.o:0,o=t.segmentIndex.Yb(a),s=null,o&&((s=o.current())||(s=o.next().value)),s||(s=Du(t.segmentIndex)),s?n?s.ea?x(u,Yu(i,s.ea),0):u.A(0):x(u,qu(i,s.startTime),0):u.A(0))})}function Sd(e){var t,n,r,i;return P(function(a){for(t=[],n=g([e.video,e.audio]),r=n.next();!r.done;r=n.next())(i=r.value)&&!i.segmentIndex&&t.push(i.createSegmentIndex());return t.length>0?x(a,Promise.all(t),0):a.A(0)})}function Ad(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}function Ed(e,t){Bi.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{kd:null,jd:Cd,Uc:function(e,t){return kd(n,"enter",e,t)}},{kd:Id,jd:Cd,Uc:function(e,t){return kd(n,"enter",e,t)}},{kd:Md,jd:Cd,Uc:function(e,t){return kd(n,"enter",e,t)}},{kd:Cd,jd:Id,Uc:function(e,t){return kd(n,"exit",e,t)}},{kd:Cd,jd:Md,Uc:function(e,t){return kd(n,"exit",e,t)}},{kd:Id,jd:Md,Uc:function(e,t){t?kd(n,"skip",e,t):(kd(n,"enter",e,t),kd(n,"exit",e,t))}},{kd:Md,jd:Id,Uc:function(e,t){return kd(n,"skip",e,t)}}],this.h=new ne,this.h.D(this.i,"regionremove",function(e){n.g.delete(e.region)})}function kd(e,t,n,r){t=new Ni(t,new Map([["region",n],["seeking",r]])),e.dispatchEvent(t)}(i=cl.prototype).destroy=function(){return this.l.destroy()},i.configure=function(e){if(this.i=e,this.X=new Ei({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor},!0),e.disableAudioPrefetch){var t=this.h.get("audio");t&&t.ia&&(Ju(t.ia),t.ia=null);for(var n=(t=g(this.m.keys())).next();!n.done;n=t.next())n=n.value,Ju(this.m.get(n)),this.m.delete(n)}for(e.disableTextPrefetch&&(t=this.h.get(mt))&&t.ia&&(Ju(t.ia),t.ia=null),e.disableVideoPrefetch&&(t=this.h.get("video"))&&t.ia&&(Ju(t.ia),t.ia=null),n=(t=g(this.h.keys())).next();!n.done;n=t.next())(n=this.h.get(n.value)).ia?(Zu(n.ia,e.segmentPrefetchLimit),e.segmentPrefetchLimit>0||(Ju(n.ia),n.ia=null)):e.segmentPrefetchLimit>0&&(n.ia=bl(this,n.stream));e.disableAudioPrefetch||function(e){for(var t=e.i.segmentPrefetchLimit,n=e.i.prefetchAudioLanguages,r=g(e.j.variants),i=r.next(),a={};!i.done;a={Nb:void 0},i=r.next())if(a.Nb=i.value,a.Nb.audio)if(e.m.has(a.Nb.audio)){if(Zu(i=e.m.get(a.Nb.audio),t),!(t>0&&n.some(function(e){return function(t){return Or(e.Nb.audio.language,t)}}(a)))){var o=e.h.get(a.Nb.audio.type);i!==(o&&o.ia)&&Ju(i),e.m.delete(a.Nb.audio)}}else t<=0||!n.some(function(e){return function(t){return Or(e.Nb.audio.language,t)}}(a))||!(i=bl(e,a.Nb.audio))||(a.Nb.audio.segmentIndex||a.Nb.audio.createSegmentIndex(),e.m.set(a.Nb.audio,i))}(this)},i.start=function(e){var t=this;return P(function(n){if(1==n.g)return x(n,function(e,t){var n,r,i,a,o,s,u;return P(function(l){if(1==l.g){if(!e.o)throw new Ke(2,5,5006);return n=jl(e,!0),x(l,e.g.Z.init(n,e.j.sequenceMode,e.j.type,e.j.ignoreManifestTimestampsInSegmentsMode),2)}for(Zi(e.l),e.updateDuration(),r=g(n.keys()),i=r.next();!i.done;i=r.next())a=i.value,o=n.get(a),e.h.has(a)||(s=yl(e,o),t.has(o.id)&&(Ku(u=t.get(o.id),function(t,n,r){return Cl(t,n,r||null,e.i.retryParameters,e.g.vc)}),s.ia=u),e.h.set(a,s),Rl(e,s,0));Ul(e),T(l)})}(t,e||new Map),2);Zi(t.l),t.N=!0,T(n)})},i.bd=function(){if(this.g){for(var e=this.g.nc(),t=g(this.h.keys()),n=t.next();!n.done;n=t.next()){var r,i=n.value;if(n=this.h.get(i),(r=!this.J)&&(r=this.g.Z,r=!(r=i==mt?null!=(r=r.h).g&&null!=r.h&&e>=r.g&&e<r.h:Yo(r=Vs(r,i),e))),r){if(this.R=0,n.ia&&(n.ia.h=null),"audio"===n.type)for(var a=(r=g(this.m.values())).next();!a.done;a=r.next())a.value.h=null;n.ua=null,(null!=Fs(this.g.Z,i)||n.Ka)&&vl(this,n),n.Va&&(n.Va.abort(),n.Va=null),i===mt&&(i=this.g.Z).K&&i.K.Od(),n.bd=!0}!this.J||n.Xb||n.Ka||n.qb||Rl(this,n,0)}Ol(this)&&Bl(this)}},i.updateDuration=function(){var e=eo(),t=this.j.presentationTimeline.getDuration();t<1/0?(e&&(this.u&&this.u.stop(),Xs(this.g.Z)),this.g.Z.Ab(t)):e?(this.u&&this.u.Ea(.5),this.g.Z.Ab(1/0)):this.g.Z.Ab(4294967296)},V("shaka.util.ConfigUtils",Fl),Fl.getDifferenceFromConfigObjects=zl,Fl.convertToConfigObject=Hl,Fl.mergeConfigObjects=Vl,V("shaka.config.RepeatMode",{OFF:0,ALL:1,SINGLE:2}),V("shaka.drm.FairPlay",Xl),Xl.commonFairPlayResponse=function(e,t){if(2===e&&(e=t.originalRequest.drmInfo)&&He(e.keySystem)){try{var n=Ye(t.data)}catch(i){return}if(e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0),!e)try{var r=JSON.parse(n);r.ckc&&(n=r.ckc,e=!0),r.CkcMessage&&(n=r.CkcMessage,e=!0),r.License&&(n=r.License,e=!0)}catch(i){}e&&(t.data=Le(ot(n)))}},Xl.muxFairPlayRequest=function(e,t){Yl(e,t)},Xl.expressplayFairPlayRequest=function(e,t){if(2===e){var n=t.drmInfo;n&&He(n.keySystem)&&Yl(e,t)}},Xl.conaxFairPlayRequest=function(e,t){Yl(e,t)},Xl.ezdrmFairPlayRequest=function(e,t){Yl(e,t)},Xl.verimatrixFairPlayRequest=function(e,t){2===e&&(e=t.drmInfo)&&He(e.keySystem)&&(e=at(e=Ne(t.body)),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=Qe("spc="+e))},Xl.muxInitDataTransform=function(e,t,n){return ql(e,t,n)},Xl.expressplayInitDataTransform=function(e,t,n){return ql(e,t,n)},Xl.conaxInitDataTransform=function(t,n,r){if("skd"!==n)return t;n=r.serverCertificate,r=Je(t).split("skd://").pop().split("?").shift(),r=e.atob(r);var i=new ArrayBuffer(2*r.length);i=Oe(i);for(var a=0,o=r.length;a<o;a++)i[a]=r.charCodeAt(a);return Kl(t,i,n)},Xl.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Kl(e,n=Je(e).split(";").pop(),t))},Xl.verimatrixInitDataTransform=function(e,t,n){return ql(e,t,n)},Xl.initDataTransform=Kl,Xl.defaultGetContentId=Wl,Xl.isFairPlaySupported=function(){var e;return P(function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},w(t,2),x(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(E(t),t.return(!1))})},$l.prototype.add=function(e,t){var n,r=this.h;if(t=void 0===t||t,!(n=!!r.audio!=!!e.audio||!!r.video!=!!e.video||r.language!=e.language)&&(n=r.audio&&e.audio)){n=r.audio;var i=e.audio;n=!(!((!n.channelsCount||!i.channelsCount||n.channelsCount>2||i.channelsCount>2)&&n.channelsCount!=i.channelsCount||n.spatialAudio!==i.spatialAudio||t&&!Jl(n,i))&&Z(n.roles,i.roles)&&n.groupId===i.groupId)}return!n&&(n=r.video&&e.video)&&(r=r.video,n=e.video,n=!((!t||Jl(r,n))&&Z(r.roles,n.roles))),!n&&(this.g.add(e),!0)},$l.prototype.values=function(){return this.g.values()},V("shaka.media.AdaptationSet",$l),Ql.prototype.configure=function(e){this.g=e},Ql.prototype.getConfiguration=function(){return this.g},Ql.prototype.create=function(e){var t;if(this.g.language){var n=function(e,t){var n=Gr(t=jr(t),e.map(function(e){return Hr(e)}));return n?e.filter(function(e){return n==Hr(e)}):[]}(e,this.g.language);n.length&&(t=n)}t||(t=(t=e.filter(function(e){return e.primary})).length?t:e),e=function(e,t){return e.filter(function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)})}(t,this.g.role),e.length&&(t=e),e=function(e,t){return e.filter(function(e){return!!e.video&&(t?e.video.roles.includes(t):0==e.video.roles.length)})}(t,this.g.videoRole),e.length&&(t=e),this.g.videoLayout&&(e=function(e,t){return e.filter(function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t})}(t,this.g.videoLayout),e.length&&(t=e)),this.g.hdrLevel&&(e=function(e,t){if("AUTO"==t){var n=e.some(function(e){return!(!e.video||!e.video.hdr||"HLG"!=e.video.hdr)});t=oe().sd(n)}return e.filter(function(e){return!e.video||!e.video.hdr||e.video.hdr==t})}(t,this.g.hdrLevel),e.length&&(t=e));var r=[this.g.channelCount,this.g.preferredAudioChannelCount];if((e=r.filter(function(e,t){return e&&r.indexOf(e)===t})).length)for(n=(e=g(e)).next();!n.done;n=e.next())if((n=Zl(t,n.value)).length){t=n;break}this.g.audioLabel&&(e=function(e,t){return e.filter(function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()})}(t,this.g.audioLabel),e.length&&(t=e)),this.g.videoLabel&&(e=function(e,t){return e.filter(function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()})}(t,this.g.videoLabel),e.length&&(t=e)),e=function(e,t){return e.filter(function(e){return!e.audio||e.audio.spatialAudio==t})}(t,this.g.spatialAudio),e.length&&(t=e);var i=[this.g.audioCodec,this.g.activeAudioCodec].concat(m(this.g.preferredAudioCodecs));if((e=i.filter(function(e,t){return e&&i.indexOf(e)===t})).length)for(n=(e=g(e)).next();!n.done;n=e.next())if((n=ed(t,n.value)).length){t=n;break}return e=oe(),e="smooth"==this.g.codecSwitchingStrategy&&e.Bb(),this.h=new $l(t[0],t,!e)},Ql.prototype.getLastAdaptationSet=function(){return this.h},V("shaka.util.PlayerConfiguration",td),td.mergeConfigObjects=id,td.createDefaultForLL=rd,td.createDefault=nd,p(gd,Bi),(i=gd.prototype).getStartTime=function(){return this.o},i.rd=function(){return this.N},i.Kg=function(){return this.h},i.getStats=function(){return this.X},i.Tj=function(){return this.i?ni(this.i):null},i.Sj=function(){return this.T?ri(this.T):null},i.start=function(){var t,n=this;P(function(r){switch(r.g){case 1:return x(r,Promise.resolve(),2);case 2:return w(r,3),x(r,function(e){var t,n,r,i,a;return P(function(o){switch(o.g){case 1:if(bd(e,"manifest-parser"),e.m||(e.H=kt(e.N,e.V),e.m=e.H(),e.m.configure(e.g.manifest,function(){return e.F})),t=Date.now()/1e3,bd(e,"manifest"),e.h){o.A(2);break}return x(o,e.m.start(e.N,e.Ua),3);case 3:return e.h=o.h,Ad(e.h),x(o,function(e){return P(function(t){return e.C||(e.C=e.g.adaptationSetCriteriaFactory(),e.C.configure({language:e.g.preferredAudioLanguage,role:e.g.preferredAudioRole,videoRole:e.g.preferredVideoRole,channelCount:e.g.preferredAudioChannelCount,hdrLevel:e.g.preferredVideoHdrLevel,spatialAudio:e.g.preferSpatialAudio,videoLayout:e.g.preferredVideoLayout,audioLabel:e.g.preferredAudioLabel,videoLabel:e.g.preferredVideoLabel,codecSwitchingStrategy:e.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:e.g.preferredAudioCodecs,preferredAudioChannelCount:e.g.preferredAudioChannelCount})),e.i||!e.h.variants.length||1!=e.h.variants.length&&"HLS"!=e.h.type?t.A(0):(e.i=Td(e),e.i?x(t,Sd(e.i),0):t.A(0))})}(e),2);case 2:return e.ma.resolve(),n=new Ni("manifestparsed",void 0),x(o,Promise.resolve(),5);case 5:if(e.dispatchEvent(n),0==e.h.variants.length)throw new Ke(2,4,4036);if(Ad(e.h),!qa(e.G,e.h)){o.A(6);break}return r=new Ni("trackschanged",void 0),x(o,Promise.resolve(),7);case 7:yd(e),e.dispatchEvent(r);case 6:i=Date.now()/1e3,a=i-t,e.X.J=a,T(o)}})}(n),5);case 5:if(yd(n),"webkit"===e.shakaMediaKeysPolyfill){r.A(6);break}return x(r,xd(n),7);case 7:yd(n);case 6:return x(r,function(e){return P(function(t){return 1==t.g?!e.i||e.h.variants.includes(e.i)?t.A(0):x(t,function(e){var t,n,r,i;return P(function(a){for(t=[],n=g([e.video,e.audio]),r=n.next();!r.done;r=n.next())(i=r.value)&&i.segmentIndex&&i.closeSegmentIndex&&t.push(i.closeSegmentIndex());return t.length>0?x(a,Promise.all(t),0):a.A(0)})}(e.i),3):(e.i=Td(e),e.i?x(t,Sd(e.i),0):t.A(0))})}(n),8);case 8:if(yd(n),!n.$){r.A(9);break}return x(r,function(e){var t,n,r,i,a;return P(function(o){return!e.i&&(t=Td(e))&&(e.i=t),e.i?(n=e.h.presentationTimeline.W(),r=[],(i=e.i).video&&r.push(wd(e,i.video,n)),i.audio&&r.push(wd(e,i.audio,n)),(a=di(e.h.textStreams,e.g.preferredTextLanguage,e.g.preferredTextRole,e.g.preferForcedSubs)[0]||null)&&gi(i.audio,a,e.g)&&(r.push(wd(e,a,n)),e.T=a),x(o,Promise.all(r),0)):o.A(0)})}(n),10);case 10:yd(n);case 9:if(!n.$||!n.j){r.A(11);break}return x(r,function(e){return P(function(t){return 1==t.g?!e.K||Ra(e)?t.A(0):x(t,e.m,3):x(t,Promise.all(e.X.map(function(e){return e.promise})),0)})}(n.j),12);case 12:yd(n);case 11:n.B.resolve(),A(r,0);break;case 3:(t=E(r))instanceof Ke&&(7001==t.code||7003==t.code)||n.B.reject(t),T(r)}})},i.dispatchEvent=function(e){return this.O?this.O.dispatchEvent(e):Bi.prototype.dispatchEvent.call(this,e)},i.onError=function(e){2===e.severity&&(this.B.reject(e),this.destroy());var t=(new Map).set("detail",e);t=new Ni("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},i.configure=function(e,t){e=Hl(e,t),id(this.g,e)},i.getConfiguration=function(){return Kt(this.g)},i.ol=function(){return this.B},i.destroy=function(){var e,t,n=this;return P(function(r){if(1==r.g)return n.l=!0,!n.m||n.oa?r.A(2):x(r,n.m.stop(),2);if(4!=r.g)return n.u&&n.u.release(),n.I&&!n.va&&n.I.release(),!n.j||n.ba?r.A(4):x(r,n.j.destroy(),4);if(n.M.size>0&&!n.ya)for(e=g(n.M.values()),t=e.next();!t.done;t=e.next())Ju(t.value);T(r)})},V("shaka.media.PreloadManager",gd),gd.prototype.destroy=gd.prototype.destroy,gd.prototype.waitForFinish=gd.prototype.ol,gd.prototype.getPrefetchedTextTrack=gd.prototype.Sj,gd.prototype.getPrefetchedVariantTrack=gd.prototype.Tj,p(Ed,Bi),Ed.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Bi.prototype.release.call(this)},Ed.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=g(this.i.h.values()),r=n.next();!r.done;r=n.next()){r=r.value;var i=this.g.get(r),a=e<r.startTime?Id:e>r.endTime?Md:Cd;this.g.set(r,a);for(var o=g(this.m),s=o.next();!s.done;s=o.next())(s=s.value).kd==i&&s.jd==a&&s.Uc(r,t)}}};
/*
      		 @license
      		 Copyright 2013 Ali Al Dallal

      		 Licensed under the MIT license.

      		 Permission is hereby granted, free of charge, to any person obtaining a copy
      		 of this software and associated documentation files (the "Software"), to deal
      		 in the Software without restriction, including without limitation the rights
      		 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      		 copies of the Software, and to permit persons to whom the Software is
      		 furnished to do so, subject to the following conditions:

      		 The above copyright notice and this permission notice shall be included in
      		 all copies or substantial portions of the Software.

      		 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      		 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      		 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      		 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      		 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      		 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      		 SOFTWARE.
      		*/
for(var Id=1,Cd=2,Md=3,Rd={ach:"Lwo",ady:"",af:"Afrikaans","af-NA":"Afrikaans (Namibia)","af-ZA":"Afrikaans (South Africa)",ak:"Ti",ar:"","ar-AR":"","ar-MA":"","ar-SA":" ()","ay-BO":"Aymar aru",az:"Azrbaycan dili","az-AZ":"Azrbaycan dili","be-BY":"",bg:"","bg-BG":"",bn:"","bn-IN":" ()","bn-BD":"()","bs-BA":"Bosanski",ca:"Catal","ca-ES":"Catal",cak:"Maya Kaqchikel","ck-US":" (tsalagi)",cs:"etina","cs-CZ":"etina",cy:"Cymraeg","cy-GB":"Cymraeg",da:"Dansk","da-DK":"Dansk",de:"Deutsch","de-AT":"Deutsch (sterreich)","de-DE":"Deutsch (Deutschland)","de-CH":"Deutsch (Schweiz)",dsb:"Dolnoserbina",el:"","el-GR":"",en:"English","en-GB":"English (UK)","en-AU":"English (Australia)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-IN":"English (India)","en-PI":"English (Pirate)","en-UD":"English (Upside Down)","en-US":"English (US)","en-ZA":"English (South Africa)","en@pirate":"English (Pirate)",eo:"Esperanto","eo-EO":"Esperanto",es:"Espaol","es-AR":"Espaol (Argentine)","es-419":"Espaol (Latinoamrica)","es-CL":"Espaol (Chile)","es-CO":"Espaol (Colombia)","es-EC":"Espaol (Ecuador)","es-ES":"Espaol (Espaa)","es-LA":"Espaol (Latinoamrica)","es-NI":"Espaol (Nicaragua)","es-MX":"Espaol (Mxico)","es-US":"Espaol (Estados Unidos)","es-VE":"Espaol (Venezuela)",et:"eesti keel","et-EE":"Eesti (Estonia)",eu:"Euskara","eu-ES":"Euskara",fa:"","fa-IR":"","fb-LT":"Leet Speak",ff:"Fulah",fi:"Suomi","fi-FI":"Suomi","fo-FO":"Froyskt",fr:"Franais","fr-CA":"Franais (Canada)","fr-FR":"Franais (France)","fr-BE":"Franais (Belgique)","fr-CH":"Franais (Suisse)","fy-NL":"Frysk",ga:"Gaeilge","ga-IE":"Gaeilge (Gaelic)",gl:"Galego","gl-ES":"Galego","gn-PY":"Avae'","gu-IN":"","gx-GR":" ",he:"","he-IL":"",hi:"","hi-IN":"",hr:"Hrvatski","hr-HR":"Hrvatski",hsb:"Hornjoserbina",ht:"Kreyl",hu:"Magyar","hu-HU":"Magyar","hy-AM":"",id:"Bahasa Indonesia","id-ID":"Bahasa Indonesia",is:"slenska","is-IS":"slenska (Iceland)",it:"Italiano","it-IT":"Italiano",ja:"","ja-JP":"","jv-ID":"Basa Jawa","ka-GE":"","kk-KZ":"",km:"","km-KH":"",kab:"Taqbaylit",kn:"","kn-IN":" (India)",ko:"","ko-KR":" ()",ku:"Kurd","ku-TR":"Kurd",la:"Latin","la-VA":"Latin",lb:"Ltzebuergesch","li-NL":"Lmbrgs",lt:"Lietuvi","lt-LT":"Lietuvi",lv:"Latvieu","lv-LV":"Latvieu",mai:", ","mg-MG":"Malagasy",mk:"","mk-MK":" ()",ml:"","ml-IN":"","mn-MN":"",mr:"","mr-IN":"",ms:"Bahasa Melayu","ms-MY":"Bahasa Melayu",mt:"Malti","mt-MT":"Malti",my:"",nb:"Norsk (bokml)","nb-NO":"Norsk (bokml)",ne:"","ne-NP":"",nl:"Nederlands","nl-BE":"Nederlands (Belgi)","nl-NL":"Nederlands (Nederland)","nn-NO":"Norsk (nynorsk)",no:"Norsk",oc:"Occitan","or-IN":"",pa:"","pa-IN":" ( )",pl:"Polski","pl-PL":"Polski","ps-AF":"",pt:"Portugus","pt-BR":"Portugus (Brasil)","pt-PT":"Portugus (Portugal)","qu-PE":"Qhichwa","rm-CH":"Rumantsch",ro:"Romn","ro-RO":"Romn",ru:"","ru-RU":"","sa-IN":"","se-NO":"Davvismegiella","si-LK":"",sk:"Slovenina","sk-SK":"Slovenina (Slovakia)",sl:"Slovenina","sl-SI":"Slovenina","so-SO":"Soomaaliga",sq:"Shqip","sq-AL":"Shqip",sr:"","sr-RS":" (Serbia)",su:"Basa Sunda",sv:"Svenska","sv-SE":"Svenska",sw:"Kiswahili","sw-KE":"Kiswahili",ta:"","ta-IN":"",te:"","te-IN":"",tg:" ","tg-TJ":"",th:"","th-TH":" ()",tl:"Filipino","tl-PH":"Filipino",tlh:"tlhIngan-Hol",tr:"Trke","tr-TR":"Trke","tt-RU":"",uk:"","uk-UA":"",ur:"","ur-PK":"",uz:"O'zbek","uz-UZ":"O'zbek",vi:"Ting Vit","vi-VN":"Ting Vit","xh-ZA":"isiXhosa",yi:"","yi-DE":" (German)",zh:"","zh-HANS":"","zh-HANT":"","zh-CN":"","zh-HK":"","zh-SG":"","zh-TW":"","zu-ZA":"isiZulu"},_d=g(Object.keys(Rd)),Pd=_d.next();!Pd.done;Pd=_d.next()){var Dd=Pd.value;Rd[Dd.toLowerCase()]=Rd[Dd]}function Ld(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map(function(t){return Ld(t,e)}).join("");if(!e.payload)return e.payload;var n=[],r=e.fontWeight>=Yn,i=e.fontStyle==Jn,a=e.textDecoration.includes(Zn);return r&&n.push(["b"]),i&&n.push(["i"]),a&&n.push(["u"]),""==(i=e.color)&&t&&(i=t.color),r="",(i=Nd(i))&&(r+="."+i),""==(i=e.backgroundColor)&&t&&(i=t.backgroundColor),(t=Nd(i))&&(r+=".bg_"+t),r&&n.push(["c",r]),n.reduceRight(function(e,t){var n=g(t);return"<"+(t=n.next().value)+(void 0===(n=n.next().value)?"":n)+">"+e+"</"+t+">"},e.payload)}function Nd(e){var t=(e=e.toLowerCase()).replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&e.length>7&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Od(e,t){for(var n=[],r=(e=g(Ud(e))).next();!r.done;r=e.next())if((r=r.value).isContainer)n.push.apply(n,m(Od(r.nestedCues,r)));else{var i=r.clone();i.nestedCues=[],i.payload=Ld(r,t),n.push(i)}return n}function Ud(e){for(var t=[],n=(e=g(e)).next(),r={};!n.done;r={lg:void 0},n=e.next())r.lg=n.value,t.some(function(e){return function(t){return _n(e.lg,t)}}(r))||t.push(r.lg);return t}function Bd(e){function t(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(r){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),"vertical-lr"==e.writingMode?n.vertical="lr":"vertical-rl"==e.writingMode&&(n.vertical="rl"),1==e.lineInterpretation&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}function jd(e,t){var n=Od(t),r=[];t=e.cues?Array.from(e.cues):[];for(var i=(n=g(n)).next(),a={};!i.done;a={vd:void 0},i=n.next())a.vd=i.value,!t.some(function(e){return function(t){return t.startTime==e.vd.startTime&&t.endTime==e.vd.endTime&&t.text==e.vd.payload}}(a))&&a.vd.payload&&(i=Bd(a.vd))&&r.push(i);for(n=(t=g(t=r.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?r.indexOf(t)-r.indexOf(e):r.indexOf(e)-r.indexOf(t)}))).next();!n.done;n=t.next())e.addCue(n.value)}function Fd(e,t){var n=!1;"disabled"===e.mode&&(n=!0,e.mode="hidden");for(var r=0;r<e.cues.length;){var i=e.cues[r];t(i)?e.removeCue(i):r++}n&&(e.mode="disabled")}function Vd(e){var t=this;this.i=e,this.l=new ne,this.j=null,this.h=new Map,this.g=-1,this.u=!1,this.o=null,this.C=function(){t.l.Ma(t.i,"textchanged",t.m),t.l.Ma(t.j.textTracks,"change",t.B);for(var e=g(t.h.values()),n=e.next();!n.done;n=e.next())n.value.remove();t.h.clear(),t.g=-1,t.j=null},this.m=function(){for(var e=new Map,n=t.i.Lc(),r=(n=g(n)).next();!r.done;r=n.next()){if(r=r.value,t.h.has(r.id)){var i=t.h.get(r.id);r.active||"disabled"===i.track.mode||(i.track.mode="disabled"),t.h.delete(r.id)}else{(i=t.j.ownerDocument.createElement("track")).kind=Hd(r);var a=i,o=void 0;if(r.label)o=r.label;else if(r.language)if(r.language in Rd)o=Rd[r.language];else{var s=Vr(r.language);s in Rd&&(o=Rd[s]+" ("+r.language+")")}o||(o=r.originalTextId,r.language&&r.language!==r.originalTextId&&(o+=" ("+r.language+")")),a.label=o,r.language in Rd&&(i.srclang=r.language),i.src="data:,WEBVTT",i.track.mode="disabled",t.j.appendChild(i)}e.set(r.id,i),r.active&&(t.g=r.id)}for(r=(n=g(t.h.values())).next();!r.done;r=n.next())r.value.remove();t.g>-1&&(e.has(t.g)?"disabled"===(n=e.get(t.g).track).mode&&(n.mode=t.u?"showing":"hidden"):t.g=-1),t.h=e},this.B=function(){if(!t.o){var e=t.j;t.o=new Rr(function(){if(t.o=null,t.j===e){var n=-1,r=!1;if(t.h.has(t.g)){var i=t.h.get(t.g);"showing"===i.track.mode?(n=t.g,r=!0):"hidden"===i.track.mode&&(n=t.g)}if(!r)for(i=(r=g(t.h)).next();!i.done;i=r.next()){var a=g(i.value);if(i=a.next().value,"showing"===(a=a.next().value).track.mode){n=i;break}n<0&&"hidden"===a.track.mode&&(n=i)}for(i=(r=g(t.h)).next();!i.done;i=r.next())i=(a=g(i.value)).next().value,a=a.next().value,i!==n&&"disabled"!==a.track.mode&&(a.track.mode="disabled");t.g!==n&&(t.g=n,n>-1&&t.i.oh({id:n})),t.i.uh(n>-1&&"showing"===t.h.get(n).track.mode)}}).ka(0)}},this.l.D(e,"loaded",function(){return t.enableTextDisplayer()}),this.enableTextDisplayer()}function Hd(e){var t=oe();return e.forced&&"WEBKIT"===t.Ha()?"forced":"caption"===e.kind||e.roles&&e.roles.some(function(e){return e.includes("transcribes-spoken-dialog")})&&e.roles.some(function(e){return e.includes("describes-music-and-sound")})?"captions":"subtitles"}function Gd(e,t){for(ce("SimpleTextDisplayer","Please migrate to NativeTextDisplayer"),this.h=e,this.i=t,this.g=null,t=(e=g(Array.from(this.h.textTracks))).next();!t.done;t=e.next())"metadata"!==(t=t.value).kind&&"chapters"!==t.kind&&(t.mode="disabled",t.label==this.i&&(this.g=t));this.g&&(this.g.mode="hidden")}function zd(e){e.h&&!e.g&&(e.g=e.h.addTextTrack("subtitles",e.i),e.g.mode="hidden")}function Xd(){}function Wd(t,n){var r=this;this.m=!1,this.h=[],this.j=t,this.o=n,this.C=this.u=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.B=new Rr(function(){r.j.paused||$d(r)}),Kd(this),this.l=new Map,this.i=new ne,this.i.D(document,"fullscreenchange",function(){$d(r,!0)}),this.i.D(this.j,"seeking",function(){$d(r,!0)}),this.i.D(this.j,"ratechange",function(){Kd(r)}),this.i.D(this.j,"resize",function(){var e=r.j,t=e.videoWidth;e=e.videoHeight,r.u=t&&e?t/e:null}),this.F=null,"ResizeObserver"in e&&(this.F=new ResizeObserver(function(){$d(r,!0)}),this.F.observe(this.g)),this.G=new Map}function Kd(e){e.B&&(e.h.length?e.B.Ea((e.C?e.C.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(e.j.playbackRate))):e.B.stop())}function qd(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function Yd(e,t,n,r,i){for(var a=!1,o=[],s=[],u=(t=g(t)).next();!u.done;u=t.next()){u=u.value,i.push(u);var l=e.l.get(u),d=u.startTime<=r&&u.endTime>r,c=l?l.lj:null;l&&(o.push(l.ng),l.$c&&o.push(l.$c),d||(a=!0,e.l.delete(u),l=null)),d&&(s.push(u),l?qd(e,c)||(a=!0):(Jd(e,u,i),c=(l=e.l.get(u)).lj,a=!0)),u.nestedCues.length>0&&c&&Yd(e,u.nestedCues,c,r,i),i.pop()}if(a){for(i=(r=g(o)).next();!i.done;i=r.next())(i=i.value).parentElement&&i.parentElement.removeChild(i);for(s.sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}),r=(s=g(s)).next();!r.done;r=s.next())(r=e.l.get(r.value)).$c?(r.$c.contains(n)&&r.$c.removeChild(n),n.appendChild(r.$c),r.$c.appendChild(r.ng)):n.appendChild(r.ng)}}function $d(e,t){if(e.g){var n=e.j.currentTime;if(!e.m||void 0!==t&&t){for(var r=(t=g(e.G.values())).next();!r.done;r=t.next())ts(r.value);ts(e.g),e.l.clear(),e.G.clear()}e.m&&Yd(e,e.h,e.g,n,[])}}function Jd(e,t,n){var r=n.length>1,i=r?"span":"div";t.lineBreak&&(i="br"),t.rubyTag&&(i=t.rubyTag),r=!r&&t.nestedCues.length>0;var a=document.createElement(i);if("br"!=i&&function(e,t,n,r,i){var a=t.style,o=0==n.nestedCues.length,s=r.length>1;a.whiteSpace="pre-wrap";var u=n.payload.replace(/\s+$/g,function(e){return"".repeat(e.length)});if(a.webkitTextStrokeColor=n.textStrokeColor,a.webkitTextStrokeWidth=n.textStrokeWidth,a.color=n.color,a.direction=n.direction,a.opacity=n.opacity,a.paddingLeft=Qd(n.linePadding,n,e.o),a.paddingRight=Qd(n.linePadding,n,e.o),a.textCombineUpright=n.textCombineUpright,a.textShadow=n.textShadow,n.backgroundImage)a.backgroundImage="url('"+n.backgroundImage+"')",a.backgroundRepeat="no-repeat",a.backgroundSize="contain",a.backgroundPosition="center",n.backgroundColor&&(a.backgroundColor=n.backgroundColor),a.width="100%",a.height="100%";else{if(n.nestedCues.length)var l=t;else l=document.createElement("span"),t.appendChild(l);n.border&&(l.style.border=n.border),i||((t=function(e,t){for(var n=e.length-1;n>=0;n--){var r=t(e[n]);if(r||0===r)return r}return null}(r,function(e){return e.backgroundColor}))?l.style.backgroundColor=t:u&&(l.style.backgroundColor="rgba(0, 0, 0, 0.8)")),u&&(l.setAttribute("translate","no"),l.textContent=u)}s&&!r[r.length-1].isContainer?a.display="inline":(a.display="flex",a.flexDirection="column",a.alignItems="center","left"==n.textAlign||"start"==n.textAlign?(a.width="100%",a.alignItems="start"):"right"!=n.textAlign&&"end"!=n.textAlign||(a.width="100%",a.alignItems="end"),a.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end"),o||(a.margin="0"),a.fontFamily=n.fontFamily,a.fontWeight=n.fontWeight.toString(),a.fontStyle=n.fontStyle,a.letterSpacing=n.letterSpacing,(1!==(r=e.C?e.C.fontScaleFactor:1)||n.fontSize)&&(a.fontSize=Qd(n.fontSize||"1em",n,e.o,r)),null!=(r=n.line)&&((o=n.lineInterpretation)==Gn&&(o=1,s=16,e.u&&e.u<1&&(s=32),r=r<0?100+r/s*100:r/s*100),1==o&&(a.position="absolute",n.writingMode==Hn?(a.width="100%",n.lineAlign==zn?a.top=r+"%":"end"==n.lineAlign&&(a.bottom=100-r+"%")):"vertical-lr"==n.writingMode?(a.height="100%",n.lineAlign==zn?a.left=r+"%":"end"==n.lineAlign&&(a.right=100-r+"%")):(a.height="100%",n.lineAlign==zn?a.right=r+"%":"end"==n.lineAlign&&(a.left=100-r+"%")))),a.lineHeight=n.lineHeight,e=function(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==On?n:"left"===e||"start"===e&&t===Vn||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===Vn?"line-right":"center"}(n),"line-left"==e?(a.cssFloat="left",null!==n.position&&(a.position="absolute",n.writingMode==Hn?(a.left=n.position+"%",a.width="auto"):a.top=n.position+"%")):"line-right"==e?(a.cssFloat="right",null!==n.position&&(a.position="absolute",n.writingMode==Hn?(a.right=100-n.position+"%",a.width="auto"):a.bottom=n.position+"%")):null!==n.position&&50!=n.position&&(a.position="absolute",n.writingMode==Hn?(a.left=n.position+"%",a.width="auto"):a.top=n.position+"%",n.size&&(a.transform="translateX(-50%)")),a.textAlign=n.textAlign,a.textDecoration=n.textDecoration.join(" "),a.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&a.writingMode==n.writingMode||(a.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Hn?a.width=n.size+"%":a.height=n.size+"%")}(e,a,t,n,r),n=null,t.region&&t.region.id){var o=t.region,s=e.u===4/3?2.5:1.9;if(n=o.id+"_"+o.width+"x"+o.height+(o.heightUnits==Ut?"%":"px")+"-"+o.viewportAnchorX+"x"+o.viewportAnchorY+(o.viewportAnchorUnits==Ut?"%":"px"),e.G.has(n))n=e.G.get(n);else{i=document.createElement("span");var u=o.heightUnits==Ut?"%":"px",l=o.widthUnits==Ut?"%":"px",d=o.viewportAnchorUnits==Ut?"%":"px";i.id="shaka-text-region---"+n,i.classList.add("shaka-text-region"),i.style.position="absolute";var c=o.height,h=o.width;2===o.heightUnits&&(c=5.33*o.height,u="%"),2===o.widthUnits&&(h=o.width*s,l="%"),i.style.height=c+u,i.style.width=h+l,2===o.viewportAnchorUnits?(s=o.viewportAnchorY/75*100,u=o.viewportAnchorX/(e.u===4/3?160:210)*100,s-=o.regionAnchorY*c/100,u-=o.regionAnchorX*h/100,i.style.top=s+"%",i.style.left=u+"%"):(i.style.top=o.viewportAnchorY-o.regionAnchorY*c/100+d,i.style.left=o.viewportAnchorX-o.regionAnchorX*h/100+d),0!==o.heightUnits&&0!==o.widthUnits&&0!==o.viewportAnchorUnits&&(o=Math.max(0,Math.min(100-(parseInt(i.style.width.slice(0,-1),10)||0),parseInt(i.style.left.slice(0,-1),10)||0)),i.style.top=Math.max(0,Math.min(100-(parseInt(i.style.height.slice(0,-1),10)||0),parseInt(i.style.top.slice(0,-1),10)||0))+"%",i.style.left=o+"%"),i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="center",i.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.G.set(n,i),n=i}}i=a,r&&((i=document.createElement("span")).classList.add("shaka-text-wrapper"),i.style.backgroundColor=t.backgroundColor,i.style.lineHeight="normal",a.appendChild(i)),e.l.set(t,{ng:a,lj:i,$c:n})}function Qd(e,t,n,r){r=void 0===r?1:r;var i=(i=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(i[1]),unit:i[2]}:null;if(!i)return e;switch(e=i.unit,r*=i.value,e){case"%":return r/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*r/t.cellResolution.rows+"px";default:return r+e}}function Zd(e,t){this.g=t,this.j=e,this.m=new Map,this.l=void 0,this.F=!1,this.J=!0,this.u=this.I=!1,this.C=this.B=void 0,this.H=0,this.K={request:!1,response:!1,event:!1},this.o={},this.i=new ne,this.G=[],this.h=null}function ec(e){if(e.G)for(var t=g(e.G),n=t.next();!n.done;n=t.next())n.value.stop();e.G=[]}function tc(e){return(e=e.g.targets)?e.filter(function(e){return e.mode===Hc&&e.enabled}):[]}function nc(e){return(e=e.g.targets)?e.filter(function(e){return e.mode===Vc&&!0===e.enabled}):[]}function rc(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:t.g.version,sf:t.l,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.j.getBandwidthEstimate()/1e3}}function ic(e,t,n){if(n=void 0===n?{}:n,t=hc(e,t=Object.assign({e:t,ts:Date.now()},n),Hc),n=e.g.targets,!(e.g.version<Sc)&&n){var r=tc(e);n=Array.from(new Set([].concat(m(_c),m(Lc))));for(var i=(r=g(r)).next();!i.done;i=r.next()){var a=sc((i=i.value).includeKeys||[],n);a.includes(Bc)||a.push(Bc),a=uc(t,a);var o=i.events||[],s=a.e,u=a.sta;s&&(!Nc.includes(s)||!("ps"!==s||u&&Oc.includes(u))||o&&o.length>0&&!o.includes(s))||oc(e,a,i)}}}function ac(e,t,n){if(e.g.enabled){n=hc(e,n,Fc);var r=lc({mode:Fc,useHeaders:e.g.useHeaders,includeKeys:e.g.includeKeys||[]});e.o[r]||(e.o[r]={request:1,response:1}),n.sn=e.o[r].request++,function(e,t,n,r){if(r){if(t=fc(t),!Object.keys(t).length)return;Object.assign(n.headers,t)}else{var i=pc(t);if(!i)return;n.uris=n.uris.map(function(e){return gc(e,i)})}nc(e).length>0||!e.m.has(n)||e.m.delete(n)}(e,n=uc(n,r=sc(r=e.g.includeKeys||[],e.g.version==Sc?Array.from(new Set([].concat(m(_c),m(Pc)))):Rc)),t,e.g.useHeaders)}}function oc(e,t,n,r){var i={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},a=n.url;if(n.useHeaders){if(t=fc(t),!Object.keys(t).length)return;r&&Object.assign(r.headers,t),r=zi([a],i),Object.assign(r.headers,t)}else{if(!(t=pc(t)))return;a=gc(a,t),r&&(r.uri=a),r=zi([a],i)}e.j.Zb().request(9,r)}function sc(e,t){if(!e||0===e.length)return t;for(var n=g(e),r=n.next();!r.done;r=n.next())t.includes(r.value);return e.filter(function(e){return t.includes(e)})}function uc(e,t){return Object.keys(e).reduce(function(n,r){return t.includes(r)&&(n[r]=e[r]),n},{})}function lc(e){var t=Object.keys(e).sort().reduce(function(t,n){return"enabled"!==n&&(t[n]=e[n]),t},{});return JSON.stringify(t)}function dc(e,t){if(!(t=e.j.Gc()[t]).length)return 0;var n=e.h?e.h.currentTime:0;return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):0}function cc(e,t,n){var r=t.segment,i=0;r&&(i=r.endTime-r.startTime),(i={d:1e3*i,st:e.j.W()?Ec:Ac}).ot=function(e){if(0===e.type)return xc;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?bc:yc;if("audio"==t)return vc;if("text"==t)return"application/mp4"===e.mimeType?wc:Tc}}(t);var a=i.ot===yc||i.ot===vc||i.ot===bc||i.ot===wc;if(t=t.stream){var o=e.j.Pb();if(a&&(i.bl=function(e,t){if(!(t=e.j.Gc()[t]).length)return NaN;var n=e.h?e.h.currentTime:0;return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):NaN}(e,t.type),i.ot!==wc)){var s=dc(e,t.type);i.dl=o?s/Math.abs(o):s}if(t.bandwidth&&(i.br=t.bandwidth/1e3),t.segmentIndex&&r){if((o=t.segmentIndex.Yb(r.endTime,!0,o<0))&&(o=o.next().value)&&o!=r){if(n&&!ee(r.P(),o.P())){var u=o.P()[0];s=new URL(u);var l=new URL(n);if(s.origin!==l.origin)n=u;else{n=s.pathname.split("/").slice(1),u=l.pathname.split("/").slice(1,-1),l=Math.min(n.length,u.length);for(var d=0;d<l&&n[d]===u[d];d++)n.shift(),u.shift();for(;u.length;)u.shift(),n.unshift("..");n=n.join("/")+s.search+s.hash}i.nor=n}!o.startByte&&!o.endByte||r.startByte==o.startByte&&r.endByte==o.endByte||(n=o.startByte+"-",o.endByte&&(n+=o.endByte),i.nrr=n)}o=e.j.Pb()||1,n=dc(e,t.type)||500,r=(t=t.bandwidth)?t*(r.endTime-r.startTime)/1e3/(n/o/1e3)*e.g.rtpSafetyFactor:NaN,isNaN(r)||(i.rtp=r)}}return a&&i.ot!==wc&&(i.tb=function(e,t){var n=e.j.qc();if(!n.length)return NaN;e=n[0];for(var r=(n=g(n)).next();!r.done;r=n.next())"variant"===(r=r.value).type&&r.bandwidth>e.bandwidth&&(e=r);switch(t){case yc:return e.videoBandwidth||NaN;case vc:return e.audioBandwidth||NaN;default:return e.bandwidth}}(e,i.ot)/1e3),i}function hc(e,t,n){Object.assign(t,rc(e)),t.pr=e.j.Pb();var r=t.ot===yc||t.ot===bc;return e.I&&r&&(t.bs=!0,t.su=!0,e.I=!1),null==t.su&&(t.su=e.J),e.j.W()&&(r=Sh(e.j),t.ltc=r||void 0),document.hidden&&(t.bg=!0),null==(r=e.C&&e.B?e.C-(e.H||e.B):void 0)||e.K[n]||(t.msd=r,e.K[n]=!0),t}function pc(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}function r(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e}for(var i=[],a={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n,ttfb:n,ttlb:n},o=Object.keys(e||{}).sort(),s=(o=g(o)).next();!s.done;s=o.next()){var u=e[s=s.value];if(r(u)&&("v"!==s||1!==u)&&("pr"!=s||1!==u)){var l,d=a[s];d&&(u=d(u)),l="string"==(d=typeof u)&&"ot"!==s&&"sf"!==s&&"st"!==s?s+"="+JSON.stringify(u):"boolean"===d?s:"symbol"===d?s+"="+u.description:s+"="+u,i.push(l)}}return i.join(",")}function fc(e){for(var t=Object.keys(e),n={},r=["Object","Request","Session","Status"],i=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,url:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,ttfb:1,ttlb:1,ts:1,rc:1,cmsdd:1,cmsds:1,sn:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3,bg:3},o=(t=g(t)).next();!o.done;o=t.next())i[null!=a[o=o.value]?a[o]:1][o]=e[o];for(e=0;e<i.length;e++)(a=pc(i[e]))&&(n["CMCD-"+r[e]]=a);return n}function gc(e,t){return!t||e.includes("offline:")?e:((e=new me(e)).g.set("CMCD",t),e.toString())}(i=Vd.prototype).configure=function(){},i.remove=function(e,t){return!!this.i&&(this.h.has(this.g)&&Fd(this.h.get(this.g).track,function(n){return n.startTime<t&&n.endTime>e}),!0)},i.append=function(e){this.h.has(this.g)&&jd(this.h.get(this.g).track,e)},i.destroy=function(){return this.i&&(this.j&&this.C(),this.i=null),this.l&&(this.l.release(),this.l=null),Promise.resolve()},i.isTextVisible=function(){return this.u},i.setTextVisibility=function(e){if(this.u=e,this.h.has(this.g)){var t=this.h.get(this.g).track;"disabled"!==t.mode&&(e=e?"showing":"hidden",t.mode!==e&&(t.mode=e))}else if(this.i&&3===this.i.Zd())if(t=Array.from(this.i.$e().textTracks).filter(function(e){return["captions","subtitles","forced"].includes(e.kind)}),e){e=null;for(var n=(t=g(t)).next();!n.done;n=t.next()){if("showing"===(n=n.value).mode){e=null;break}e||"hidden"!==n.mode||(e=n)}e&&(e.mode="showing")}else for(t=(e=g(t)).next();!t.done;t=e.next())"showing"===(t=t.value).mode&&(t.mode="hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){!this.j&&this.i&&2===this.i.Zd()&&(this.j=this.i.$e(),this.l.Aa(this.i,"unloading",this.C),this.l.D(this.i,"textchanged",this.m),this.l.D(this.j.textTracks,"change",this.B),this.m())},V("shaka.text.NativeTextDisplayer",Vd),Vd.prototype.enableTextDisplayer=Vd.prototype.enableTextDisplayer,Vd.prototype.setTextLanguage=Vd.prototype.setTextLanguage,Vd.prototype.setTextVisibility=Vd.prototype.setTextVisibility,Vd.prototype.isTextVisible=Vd.prototype.isTextVisible,Vd.prototype.destroy=Vd.prototype.destroy,Vd.prototype.append=Vd.prototype.append,Vd.prototype.remove=Vd.prototype.remove,Vd.prototype.configure=Vd.prototype.configure,(i=Gd.prototype).configure=function(){},i.remove=function(e,t){return!!this.g&&(Fd(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0)},i.append=function(e){this.g&&jd(this.g,e)},i.destroy=function(){return this.g&&(Fd(this.g,function(){return!0}),this.g.mode="disabled"),this.g=this.h=null,Promise.resolve()},i.isTextVisible=function(){return!!this.g&&"showing"==this.g.mode},i.setTextVisibility=function(e){e&&!this.g&&zd(this),this.g&&(this.g.mode=e?"showing":"hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){zd(this)},V("shaka.text.SimpleTextDisplayer",Gd),Gd.prototype.enableTextDisplayer=Gd.prototype.enableTextDisplayer,Gd.prototype.setTextLanguage=Gd.prototype.setTextLanguage,Gd.prototype.setTextVisibility=Gd.prototype.setTextVisibility,Gd.prototype.isTextVisible=Gd.prototype.isTextVisible,Gd.prototype.destroy=Gd.prototype.destroy,Gd.prototype.append=Gd.prototype.append,Gd.prototype.remove=Gd.prototype.remove,Gd.prototype.configure=Gd.prototype.configure,(i=Xd.prototype).configure=function(){},i.remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){},V("shaka.text.StubTextDisplayer",Xd),Xd.prototype.enableTextDisplayer=Xd.prototype.enableTextDisplayer,Xd.prototype.setTextLanguage=Xd.prototype.setTextLanguage,Xd.prototype.setTextVisibility=Xd.prototype.setTextVisibility,Xd.prototype.isTextVisible=Xd.prototype.isTextVisible,Xd.prototype.destroy=Xd.prototype.destroy,Xd.prototype.append=Xd.prototype.append,Xd.prototype.remove=Xd.prototype.remove,Xd.prototype.configure=Xd.prototype.configure,(i=Wd.prototype).configure=function(e){this.C=e,Kd(this),$d(this,!0)},i.append=function(e){for(var t=[].concat(m(this.h)),n=(e=g(Ud(e))).next(),r={};!n.done;r={mg:void 0},n=e.next())r.mg=n.value,t.some(function(e){return function(t){return _n(t,e.mg)}}(r))||this.h.push(r.mg);this.h.length&&Kd(this),$d(this)},i.destroy=function(){return this.g?(this.g.parentElement&&this.o.removeChild(this.g),this.g=null,this.m=!1,this.h=[],this.B&&(this.B.stop(),this.B=null),this.l.clear(),this.i&&(this.i.release(),this.i=null),this.F&&(this.F.disconnect(),this.F=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter(function(n){return n.startTime<e||n.endTime>=t}),$d(this,n>this.h.length),this.h.length||Kd(this),!0},i.isTextVisible=function(){return this.m},i.setTextVisibility=function(e){(this.m=e)?(this.g.parentElement||this.o.appendChild(this.g),$d(this,!0)):this.g.parentElement&&this.o.removeChild(this.g)},i.setTextLanguage=function(e){e&&"und"!=e?this.g.setAttribute("lang",e):this.g.setAttribute("lang","")},i.enableTextDisplayer=function(){},V("shaka.text.UITextDisplayer",Wd),Wd.prototype.enableTextDisplayer=Wd.prototype.enableTextDisplayer,Wd.prototype.setTextLanguage=Wd.prototype.setTextLanguage,Wd.prototype.setTextVisibility=Wd.prototype.setTextVisibility,Wd.prototype.isTextVisible=Wd.prototype.isTextVisible,Wd.prototype.remove=Wd.prototype.remove,Wd.prototype.destroy=Wd.prototype.destroy,Wd.prototype.append=Wd.prototype.append,Wd.prototype.configure=Wd.prototype.configure,V("shaka.text.WebVttGenerator",function(){}),Zd.prototype.setMediaElement=function(t){this.h=t,function(t){t.i.D(t.h,"playing",function(){t.C||(t.C=Date.now()),ic(t,"ps",{dd:"p"})}),t.i.D(t.h,"volumechange",function(){ic(t,t.h.muted?"m":"um")}),t.i.D(t.h,"play",function(){t.B||(t.B=Date.now(),ic(t,"ps",{dd:"s"}))}),t.i.D(t.h,"pause",function(){ic(t,"ps",{dd:"a"})}),t.i.D(t.j,"buffering",function(){ic(t,"ps",{dd:"w"})}),t.i.D(t.h,"seeking",function(){return ic(t,"ps",{dd:"k"})}),t.i.D(document,"fullscreenchange",function(){ic(t,document.fullscreenElement?"pe":"pc")});var n=t.h;(n.webkitPresentationMode||n.webkitSupportsFullscreen)&&t.i.D(n,"webkitpresentationmodechanged",function(){n.webkitPresentationMode?ic(t,"inline"!==n.webkitPresentationMode?"pe":"pc"):n.webkitSupportsFullscreen&&ic(t,n.webkitDisplayingFullscreen?"pe":"pc")}),t.i.D(t.h,"enterpictureinpicture",function(){ic(t,"pe")}),t.i.D(t.h,"leavepictureinpicture",function(){ic(t,"pc")}),"documentPictureInPicture"in e&&t.i.D(e.documentPictureInPicture,"enter",function(e){ic(t,"pe"),t.i.Aa(e.window,"pagehide",function(){ic(t,"pc")})}),t.i.D(document,"visibilitychange",function(){document.hidden?ic(t,"b",{bg:!0}):ic(t,"b")}),t.i.D(t.j,"complete",function(){ic(t,"ps",{dd:"e"})})}(this)},Zd.prototype.configure=function(e){this.g=e,function(e){ec(e);for(var t=tc(e),n=(t=g(t)).next();!n.done;n=t.next())if(void 0===(n=n.value.timeInterval)&&(n=Uc),n>=1){var r=new Rr(function(){return ic(e,jc)});r.Ea(n),e.G.push(r)}}(this)};var mc="m",vc="a",yc="v",bc="av",xc="i",Tc="c",wc="tt",Sc=2,Ac="v",Ec="l",kc="d",Ic="ld",Cc="h",Mc="lh";V("shaka.util.CmcdManager.StreamingFormat",{DASH:kc,Ql:Ic,HLS:Cc,Rl:Mc,gm:"s",OTHER:"o"});var Rc="br bl bs cid d dl mtp nor nrr ot pr rtp sf sid st su tb v".split(" "),_c="br ab bl tbl bs cdn cid ltc mtp pr sf sid bg sta st ts tpb tb lb tab lab pt ec msd v sn".split(" "),Pc="ab bl tbl bs cdn cid d dl ltc mtp nor ot pr rtp sf sid bg sta st su ts tpb tb lb tab lab pt ec msd v".split(" "),Dc="d dl nor ot rtp rc su ttfb ttfbb ttlb url cmsdd cmsds".split(" "),Lc=["e","sta"],Nc="ps e t c b m um pe pc".split(" "),Oc="spawkrfeqd".split(""),Uc=10,Bc="ts",jc="t",Fc="request",Vc="response",Hc="event";function Gc(e){this.h=e,this.g=null}function zc(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}(i=Gc.prototype).configure=function(e){this.h=e},i.gi=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Wc)?1e3*this.g.get(Wc):null},i.di=function(){return this.h.enabled&&this.g&&this.g.has(Xc)?1e3*this.g.get(Xc):null},i.Vj=function(){return this.h.enabled&&this.g&&this.g.has(Kc)?this.g.get(Kc):null},i.Wj=function(){return this.h.enabled&&this.g&&this.g.has(qc)?this.g.get(qc):null},i.getBandwidthEstimate=function(e){var t=this.di();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return n>0&&n<=1?e*(1-n)+t*n:e},V("shaka.util.CmsdManager",Gc),Gc.prototype.getBandwidthEstimate=Gc.prototype.getBandwidthEstimate,Gc.prototype.getRoundTripTime=Gc.prototype.Wj,Gc.prototype.getResponseDelay=Gc.prototype.Vj,Gc.prototype.getEstimatedThroughput=Gc.prototype.di,Gc.prototype.getMaxBitrate=Gc.prototype.gi;var Xc="etp",Wc="mb",Kc="rd",qc="rtt";function Yc(){this.g=null,this.h=[]}function $c(e,t){return P(function(n){if(1==n.g)return e.g?x(n,new Promise(function(t){return e.h.push(t)}),2):n.A(2);e.g=t,T(n)})}function Jc(e,t,n){return n=void 0===n?Number.EPSILON:n,e===t||(e=Math.abs(e-t))<=n||n!==Number.EPSILON&&Math.abs(e-n)<=Number.EPSILON}function Qc(t,n,r){n=void 0===n?null:n,Bi.call(this);var i=this;this.m=rp,this.h=null,this.Ae=n,this.$=!1,this.Ke=new ne,this.Be=new ne,this.j=new ne,this.ec=new ne,this.Gd=new ne,this.G=this.H=this.F=this.N=null,this.Le=0,this.ba=new Yc,this.O=this.Fa=this.X=this.i=this.zc=this.I=this.l=this.xe=this.T=this.Nh=this.va=this.K=this.kb=this.za=this.ze=this.R=this.Ta=this.M=this.bc=null,this.Ua=!1,this.Fe=this.o=null,this.Ee=1e9,this.Je=[],this.yc=new Map,this.ob=[],this.$f=-1,this.g=Ih(this),this.cg={streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}},this.V=null,this.Me=-1,this.dc=null,this.ya={width:1/0,height:1/0},this.De=new Wa(this.g,this.ya,null),this.He=[],this.B=null,this.J=this.g.adaptationSetCriteriaFactory(),this.J.configure({language:this.g.preferredAudioLanguage,role:this.g.preferredAudioRole,videoRole:this.g.preferredVideoRole,channelCount:0,hdrLevel:this.g.preferredVideoHdrLevel,spatialAudio:this.g.preferSpatialAudio,videoLayout:this.g.preferredVideoLayout,audioLabel:this.g.preferredAudioLabel,videoLabel:this.g.preferredVideoLabel,codecSwitchingStrategy:this.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:this.g.preferredAudioCodecs,preferredAudioChannelCount:this.g.preferredAudioChannelCount}),this.Kd=this.g.preferredTextLanguage,this.Nd=this.g.preferredTextRole,this.Md=this.g.preferForcedSubs,this.Ce=[],r&&r(this),this.K=new Zd(this,this.g.cmcd),this.va=new Gc(this.g.cmsd),this.N=ph(this),this.ma=this.oa=this.Da=this.C=null,this.eg=!1,this.ag=[],this.dg=new Rr(function(){return P(function(e){return 1==e.g?i.oa?x(e,i.Wb(i.ma,!0),3):e.A(0):4!=e.g?x(e,i.load(i.oa),4):(i.eg?i.ma.pause():i.ma.play(),i.oa=null,i.eg=!1,void T(e))})}),up&&(this.C=up(),this.C.configure(this.g.ads),this.Gd.D(this.C,"ad-content-pause-requested",function(e){var t,n;return P(function(r){if(1==r.g)return i.dg.stop(),i.oa?r.A(0):(i.ma=i.h,i.eg=i.fe(),t=e.saveLivePosition||!1,n=!0,i.W()&&(n=t),x(r,i.Yh(!0,n),3));i.oa=r.h,T(r)})}),this.Gd.D(this.C,"ad-content-resume-requested",function(e){if(e=e.offset||0,i.oa){var t=i.oa;t.o&&e&&("number"==typeof t.o?t.o+=e:t.o.setTime(t.o.getTime()+1e3*e))}i.dg.ka(.1)}),this.Gd.D(this.C,"ad-content-attach-requested",function(){return P(function(e){if(1==e.g)return i.h||!i.ma?e.A(0):x(e,i.Wb(i.ma,!0),3);i.ma=null,T(e)})})),lp&&(this.Da=lp(this),this.Da.configure(this.g.queue)),this.Ke.D(e,"online",function(){Kh(i),i.jh()}),this.Ge=new Rr(function(){for(var e=Date.now()/1e3,t=!1,n=!0,r=g(i.i.variants),a=r.next();!a.done;a=r.next())(a=a.value).disabledUntilTime>0&&a.disabledUntilTime<=e&&(a.disabledUntilTime=0,t=!0),a.disabledUntilTime>0&&(n=!1);n&&i.Ge.stop(),t&&Nh(i,!1,void 0,!1,!1)}),this.eb=null,t&&(ce("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Wb(t,!0)),this.u=null}function Zc(e){null!=e.T&&(wt(e.T),e.T.release(),e.T=null)}function eh(e,t){return new Ni(e,t)}function th(e,t){sp.set(e,t)}function nh(e,t){e.dispatchEvent(eh("onstatechange",(new Map).set("state",t)))}function rh(e,t){var n;return P(function(r){return 1==r.g?(n=++e.Le,x(r,$c(e.ba,t),2)):n!=e.Le?(e.ba.release(),r.return(!0)):r.return(!1)})}function ih(e,t){var n,r,i;return t=void 0!==t&&t,P(function(a){if(1==a.g)return n=null,e.i&&e.I&&e.zc&&e.X&&e.g?(r=e.h.currentTime,t||(r=null),x(a,oh(e,e.X,r,e.Fa,e.g,!0,!1),3)):a.A(2);if(2!=a.g){n=a.h,e.He.push(n),e.I&&e.I.setMediaElement&&e.I.setMediaElement(null),(i=e.l?e.l.o:null)&&(n.i=i);var o=n,s=e.I,u=e.zc;o.h=e.i,o.m=s,o.H=u,n.C=e.J,n.start(),e.i=null,e.I=null,e.zc=null,e.o=null,e.Fe=null}return a.return(n)})}function ah(e,t,n,r,i,a){var o,s,u;return i=void 0!==i&&i,P(function(l){return 1==l.g?r?l.A(2):x(l,sh(e,t),3):(2!=l.g&&(r=l.h),function(e,t){if(!Jv(oe()))return!0;if(t){if(""==(e.h||ns()).canPlayType(t))return!1;if(!Jv(oe())||!It.has(t.toLowerCase()))return!0;if(yr(t))return"WEBKIT"===oe().Ha()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls;if("application/dash+xml"===t||"video/vnd.mpeg.dash.mpd"===t)return e.g.streaming.preferNativeDash}return!1}(e,r)?l.return(null):(o=a||e.g,s=!1,i&&e.h&&"AUDIO"===e.h.nodeName&&(s=!0),u=oh(e,t,n,r||null,o,!i,s),u=i?u.then(function(e){return e.F=!1,e}):u.then(function(t){return e.He.push(t),t}),l.return(u)))})}function oh(e,t,n,r,i,a,o){var s,u,l,d,c,h,p,f,m,v,y,b;return a=void 0===a||a,o=void 0!==o&&o,P(function(w){return 1==w.g?(s=null,u=Kt(i),o&&(u.manifest.disableVideo=!0),l=function(){return s.R&&s.l?null:s},d=function(){return l()?l().getConfiguration():e.g},e.ya.width!=1/0||e.ya.height!=1/0||e.g.ignoreHardwareResolution?w.A(2):x(w,oe().lc(),3)):(2!=w.g&&(c=w.h,e.ya.width=c.width,e.ya.height=c.height),h=new Wa(u,e.ya,null),p={networkingEngine:e.N,filter:function(e){var t;return P(function(n){return 1==n.g?x(n,Ka(h,e),2):4!=n.g?n.h?(t=eh("trackschanged"),x(n,Promise.resolve(),4)):n.A(0):(s.dispatchEvent(t),void T(n))})},makeTextStreamsForClosedCaptions:function(t){return function(e,t){for(var n=new Set,r=g(t.textStreams),i=r.next();!i.done;i=r.next())"application/cea-608"!=(i=i.value).mimeType&&"application/cea-708"!=i.mimeType||n.add(i.originalId);for(r=g(t.variants),i=r.next();!i.done;i=r.next())if((i=i.value.video)&&i.closedCaptions)for(var a=g(i.closedCaptions.keys()),o=a.next();!o.done;o=a.next())if(o=o.value,!n.has(o)){var s=o.startsWith("CC")?"application/cea-608":"application/cea-708",u=new Ou,l=i.closedCaptions.get(o);s={id:e.Ee++,originalId:o,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:u,mimeType:s,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:l,originalLanguage:l,label:null,type:mt,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:i.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([dr(s,"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},t.textStreams.push(s),n.add(o)}}(e,t)},onTimelineRegionAdded:function(e){Xu(s.I,e)},onEvent:function(e){return s.dispatchEvent(e)},onError:function(e){return s.onError(e)},isLowLatencyMode:function(){return d().streaming.lowLatencyMode},updateDuration:function(){e.l&&s.R&&e.l.updateDuration()},newDrmInfo:function(e){var t=s.j,n=t?t.g:null;n&&t.B&&$a(h,n.keySystem,e)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.W());s.dispatchEvent(eh("manifestupdated",t)),md(s,!1,function(){e.C&&e.C.onManifestUpdated(e.W())})},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(t,n,r,i){var a=t;"com.apple.hls.interstitial"!=t&&"com.apple.hls.overlay"!=t||(a="com.apple.quicktime.HLS",t={startTime:n,endTime:r,values:i},e.C&&e.C.onHLSInterstitialMetadata(e,e.h,t)),t=(i=g(i)).next();for(var o={};!t.done;o={ah:void 0},t=i.next())o.ah=t.value,"ID"!=o.ah.name&&md(s,!1,function(t){return function(){hh(e,n,r,a,t.ah)}}(o))},disableStream:function(t){return e.disableStream(t,e.g.streaming.maxDisabledTime)},addFont:function(t,n){return e.addFont(t,n)}},(f=new zu(function(){return e.Ra()})).addEventListener("regionadd",function(t){var n=t.region;Yh(e,"timelineregionadded",n,s),md(s,!1,function(){e.C&&(e.C.onDashTimedMetadata(n),e.C.onDASHInterstitialMetadata(e,e.h,n))})}),m=null,u.streaming.observeQualityChanges&&((m=new Vu(function(){return e.Gc()})).addEventListener("qualitychange",function(t){$h(e,t.quality,t.position)}),m.addEventListener("audiotrackchange",function(t){$h(e,t.quality,t.position,!0)})),v=!0,y={vc:e.N,onError:function(e){return s.onError(e)},yf:function(t){md(s,!0,function(){e.F&&function(e,t){var n=eh("keystatuschanged");e.dispatchEvent(n);var r=Object.keys(t);1==r.length&&""==r[0]&&(r=["00"],t={"00":t[""]});var i=1==r.length&&"00"==r[0];if(n=!1,r.length){r=e.keySystem();for(var a=ta(e.g.drm.clearKeys),o=function(n,r){n.allowedByKeySystem=!0;for(var a=(r=g(r)).next();!a.done;a=r.next())a=a.value,((a=t[i?"00":a])||e.F.H)&&(n.allowedByKeySystem=n.allowedByKeySystem&&!!a&&!Qa.includes(a))},s=g(e.i.variants),u=s.next();!u.done;u=s.next())for(var l=hi(u=u.value),d=(l=g(l)).next();!d.done;d=l.next()){d=d.value;var c=u.allowedByKeySystem;if(d.keyIds.size)if(d.drmInfos.length&&!a.size&&"HLS"==e.i.type)for(var h=g(d.drmInfos),p=h.next();!p.done;p=h.next())(p=p.value).keySystem==r&&(p.keyIds.size?o(u,p.keyIds):o(u,d.keyIds));else o(u,d.keyIds);c!=u.allowedByKeySystem&&(n=!0)}}n&&(jh(e),(n=e.l.o)&&!n.allowedByKeySystem?Nh(e):Dh(e))}(e,t)})},onExpirationUpdated:function(e,t){var n=eh("expirationupdated");s.dispatchEvent(n),(n=s.m)&&n.onExpirationUpdated&&n.onExpirationUpdated(e,t)},onEvent:function(t){s.dispatchEvent(t),"drmsessionupdate"==t.type&&v&&(v=!1,t=Date.now()/1e3-s.za,(e.B||s.getStats()).m=t,e.T&&wt(e.T))}},b=ph(e,l),Gi(e.N,b),s=new gd(t,r,n,{config:u,xk:p,Ik:f,Hk:m,md:function(){return e.md(y)},wk:h,networkingEngine:b,nj:a}),w.return(s))})}function sh(e,t){var n,r;return P(function(i){return 1==i.g?(n=e.g.manifest.retryParameters,x(i,sl(t,e.N,n),2)):("application/x-mpegurl"==(r=i.h)&&"WEBKIT"===oe().Ha()&&(r="application/vnd.apple.mpegurl"),"video/quicktime"==r&&"CHROMIUM"===oe().Ha()&&(r="video/mp4"),i.return(r))})}function uh(e,t){var n=e.g.textDisplayFactory;e.Mh!==n||void 0!==t&&t?(t=e.u,e.u=n(),e.u.configure?e.u.configure(e.g.textDisplayer):ce("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.u.setTextLanguage||ce("Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),t?(e.u.setTextVisibility(t.isTextVisible()),t.destroy().catch(function(){})):e.u.setTextVisibility(e.$),e.H&&function(e,t){e.ba=t,e.h&&(e.h.l=t)}(e.H,e.u),e.Mh=n,e.l&&function(e){var t=e.h.get(mt);t&&gl(e,t.stream,!0,0,!0)}(e.l)):e.u&&e.u.configure&&e.u.configure(e.g.textDisplayer)}function lh(e){var t,n,r;return P(function(i){if(1==i.g)return oe(),nh(e,"media-source"),e.g.mediaSource.useSourceElements&&es(e.h),uh(e),t=function(e,t,n,r,i){return new Ps(e,t,n,i,r)}(e.h,e.u,{Nj:function(){return e.keySystem()},onMetadata:function(t,n,r){for(var i=(t=g(t)).next();!i.done;i=t.next())if((i=i.value).data&&"number"==typeof i.cueTime&&i.frames){var a=i.cueTime+n,o=r;o&&a>o&&(o=a);for(var s=g(i.frames),u=s.next();!u.done;u=s.next())hh(e,a,o,"org.id3",u.value);e.C&&e.C.onHlsTimedMetadata(i,a)}},Ck:function(t){e.kb&&Xu(e.kb,{schemeIdUri:t.schemeIdUri,startTime:t.startTime,endTime:t.endTime,id:String(t.id),emsg:t})},onEvent:function(t){return e.dispatchEvent(t)},Ek:function(){e.I&&e.I.update&&e.I.update()}},e.T,e.g.mediaSource),n=e.g.manifest,r=n.segmentRelativeVttTiming,t.Fa=r,x(i,t.M,2);e.H=t,T(i)})}function dh(e,t,n){function r(){return Rh(e)}if(e.j.D(t,"playing",r),e.j.D(t,"pause",r),e.j.D(t,"ended",r),e.j.D(t,"ratechange",function(){var t=e.h.playbackRate;0!=t&&(e.M&&(e.M.set(t),e.m==ip&&e.o.playbackRateChanged(t),Mh(e,t)),t=eh("ratechange"),e.dispatchEvent(t))}),t.remote&&(e.j.D(t.remote,"connect",function(){e.l&&"connected"==t.remote.state&&Gh(e),jh(e)}),e.j.D(t.remote,"connecting",function(){return jh(e)}),e.j.D(t.remote,"disconnect",function(){return P(function(n){if(1==n.g)return e.l&&"disconnected"==t.remote.state?x(n,Nl(e.l),3):n.A(2);2!=n.g&&Gh(e),jh(e),T(n)})})),t.audioTracks&&(e.j.D(t.audioTracks,"addtrack",function(){return jh(e)}),e.j.D(t.audioTracks,"removetrack",function(){return jh(e)}),e.j.D(t.audioTracks,"change",function(){return jh(e)})),t.videoTracks&&(e.j.D(t.videoTracks,"addtrack",function(){return jh(e)}),e.j.D(t.videoTracks,"removetrack",function(){return jh(e)}),e.j.D(t.videoTracks,"change",function(){return jh(e)})),(t.webkitPresentationMode||t.webkitSupportsFullscreen)&&e.j.D(t,"webkitpresentationmodechanged",function(){e.Ae&&uh(e,!0)}),t.textTracks){var i=function(){e.m===ap&&e.u instanceof Vd&&Gh(e),jh(e)};e.j.D(t.textTracks,"addtrack",function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":!function(e,t){if("metadata"==t.kind){t.mode="hidden",e.j.D(t,"cuechange",function(){if(t.activeCues)for(var n=g(t.activeCues),r=n.next();!r.done;r=n.next())r=r.value,hh(e,r.startTime,r.endTime,r.type,r.value),e.C&&e.C.onCueMetadataChange(r.value);if(t.cues){n=[];for(var i=(r=g(t.cues)).next(),a={};!i.done;a={Ec:void 0},i=r.next())a.Ec=i.value,"com.apple.quicktime.HLS"==a.Ec.type&&null!=a.Ec.startTime&&(i=n.find(function(e){return function(t){return t.startTime==e.Ec.startTime&&t.endTime==e.Ec.endTime}}(a)),i||(i={startTime:a.Ec.startTime,endTime:a.Ec.endTime,values:[]},n.push(i)),i.values.push(a.Ec.value));for(r=(n=g(n)).next();!r.done;r=n.next())(r=r.value).values.some(function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key})&&e.C&&(r.values.push({key:"CUE",description:"",data:0!=r.startTime||e.W()?"ONCE":"ONCE,PRE",mimeType:null,pictureType:null}),e.C.onHLSInterstitialMetadata(e,e.h,r))}});var n=new Rr(function(){for(var t=function(e){return Array.from(e.h.textTracks).filter(function(e){return"metadata"==e.kind})}(e),n=(t=g(t)).next();!n.done;n=t.next())n.value.mode="hidden"}).Kb().ka(.5);e.Ce.push(function(){n.stop()})}}(e,t);break;case"chapters":!function(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new Rr(function(){t.mode="hidden"}).Kb().ka(.5);e.Ce.push(function(){n.stop()})}}(e,t);break;default:i()}}),e.j.D(t.textTracks,"removetrack",i),e.j.D(t.textTracks,"change",i)}"none"!=t.preload&&e.j.Aa(t,"loadedmetadata",function(){e.B.G=Date.now()/1e3-n})}function ch(e,t,n){t=(new Map).set("startTime",t.startTime).set("endTime",t.endTime).set("metadataType",t.schemeIdUri).set("payload",t.payload),e.dispatchEvent(eh(n,t))}function hh(e,t,n,r,i){e.za&&((t={schemeIdUri:r,startTime:t,endTime:n||1/0,id:"",payload:i}).id=JSON.stringify(t),Xu(e.za,t))}function ph(e,t){function n(n){t()?t().dispatchEvent(n):e.dispatchEvent(n)}function r(e){t()?md(t(),!0,e):e()}t||(t=function(){return null});var i=new Vi(function(t,n,i,a,o){r(function(){e.o&&e.o.segmentDownloaded(t,n,i,a,o)})},function(t,i,a){n(eh("downloadheadersreceived",i=(new Map).set("headers",t).set("request",i).set("requestType",a))),r(function(){if(e.va){var n=e.va;if(n.h.enabled){var r=t["cmsd-static"];if(r)try{var i=new Map,a=r.split(",");for(r=0;r<a.length;r++){var o=a[r].split("=");i.set(o[0],zc(o[1]))}}catch(c){}if(i=t["cmsd-dynamic"]){e:{try{var s=new Map,u=i.split(";");for(i=1;i<u.length;i++){var l=u[i].split("=");s.set(l[0],zc(l[1]))}var d=s;break e}catch(c){d=null;break e}d=void 0}d&&(n.g=d)}}}})},function(e,t){n(eh("downloadcompleted",e=(new Map).set("request",e).set("response",t)))},function(e,t,r,i){n(eh("downloadfailed",e=(new Map).set("request",e).set("error",t).set("httpResponseCode",r).set("aborted",i)))},function(t,n,i){r(function(){if(e.K){var r=e.K,a=i;if(a=void 0===a?{}:a,r.g.enabled)if("HEAD"===n.method)ac(r,n,{});else switch(t){case 0:try{if(r.g.enabled){if(a.type){e:{switch(a.type){case 4:var o=r.u?Ic:kc;break e;case 3:case 2:o=r.u?Mc:Cc;break e;case 5:o="s";break e}o=void 0}r.l=o}ac(r,n,{ot:mc,su:!r.F})}}catch(u){q("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",u)}break;case Yi:try{if(r.g.enabled){var s=cc(r,a,n.uris[0]);s.ts=Date.now(),r.m.has(n)&&r.m.delete(n),r.m.set(n,s.ts),ac(r,n,s)}}catch(u){q("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",u)}break;case 2:case 5:case 6:ac(r,n,{ot:"k"});break;case 4:ac(r,n,{ot:"o"})}}})},function(n,r,i,a){(n=t()?t().m:e.I)&&n.banLocation&&n.banLocation(a)},function(n,r,i){if(r.data){var a=r.data.byteLength,o=t()?t().getStats():e.B;if(o&&(pd(o,a),0===n&&(o.ti=a)),i=void 0===i?{}:i,0!==nc(a=e.K).length&&n===Yi)try{var s=cc(a,i,r.uri);r.originalRequest&&null!=r.originalRequest.timeToFirstByte&&(s.ttfb=r.originalRequest.timeToFirstByte),null!=r.timeMs&&(s.ttlb=r.timeMs);var u=r.originalUri||r.uri;if(u.includes("CMCD="))try{var l=new URL(u);l.searchParams.delete("CMCD");var d=l.toString()}catch(T){d=u}else d=u;s.url=d,a.m.has(r.originalRequest)?(s.ts=a.m.get(r.originalRequest),a.m.delete(r.originalRequest)):s.ts||(s.ts=Date.now());var c=nc(a);if(0!==c.length){var h=a.g.version==Sc?Array.from(new Set([].concat(m(_c),m(Dc)))):Rc;s.rc=r.status||0;var p=hc(a,s,Vc);r.headers&&r.headers["CMSD-Static"]&&(p.cmsds=btoa(r.headers["CMSD-Static"])),r.headers&&r.headers["CMSD-Dynamic"]&&(p.cmsdd=btoa(r.headers["CMSD-Dynamic"]));for(var f=g(c),v=f.next();!v.done;v=f.next()){var y=v.value,b=sc(y.includeKeys||[],h),x=lc(y);a.o[x]||(a.o[x]={request:1,response:1}),p.sn=a.o[x].response++,oc(a,uc(p,b),y,r)}}}catch(T){q("CMCD_SEGMENT_ERROR","Could not generate response segment CMCD data.",T)}}});return i.configure(e.g.networking),i}function fh(e,t,n){e.R=new Ha,Ga(e.R,za),gh(e),Ch(e),e.Ta=new Rr(function(){mh(e)}),e.g.streaming.rebufferingGoal&&e.Ta.Ea(.25),e.j.D(t,"waiting",function(){return mh(e,"waiting")}),e.j.D(t,"canplaythrough",function(){return mh(e,"canplaythrough")}),e.j.D(t,"playing",function(){return mh(e,"playing")}),e.j.D(t,"seeked",function(){return mh(e,"seeked")}),e.j.D(t,"timeupdate",function(){return mh(e,"timeupdate")}),n&&(e.j.D(t,"progress",function(){return mh(e,"progress")}),e.j.D(t,"stalled",function(){return mh(e,"stalled")}))}function gh(e){var t=e.g.streaming.rebufferingGoal;e.R.j.set(Xa,Math.min(.5,t/2)).set(za,t)}function mh(e,t){if(e.g.streaming.rebufferingGoal){t=!!e.H&&Us(e.H),t=e.fe()||t||e.G.oi();var n=$o(e.h.buffered,e.h.currentTime),r=e.R,i=r.j.get(r.g);Ga(r,t||n>=i&&n>0?Xa:za)&&Ch(e)}else if(t){n=e.R,r=e.h.currentTime,i=n.h,n.h=r;var a=void 0;switch(t){case"seeking":case"waiting":n.h=-1,a=za;break;case"canplaythrough":case"playing":case"seeked":a=Xa;break;case"timeupdate":i>=0&&r-i>.01&&(a=Xa)}void 0!==a&&Ga(n,a)&&Ch(e)}}function vh(e,t){if(e.De=new Wa(e.g,e.ya,e.F),e.I){var n=Kt(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(n.disableVideo=!0),e.I.configure(n)}if(e.F&&e.F.configure(e.g.drm),e.l){e.l.configure(e.g.streaming);try{e.m!=np&&Ya(e.De,e.i)&&jh(e)}catch(i){qh(e,i)}e.o&&Dh(e),!(n=e.l.o)||n.allowedByApplication&&n.allowedByKeySystem||Nh(e)}if(e.N&&e.N.configure(e.g.networking),e.H&&(e.H.configure(e.g.mediaSource),e.H.Fa=e.g.manifest.segmentRelativeVttTiming),e.u&&uh(e),e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),Xh(e)),e.R&&gh(e),e.Ta&&(e.g.streaming.rebufferingGoal?e.Ta.Ea(.25):e.Ta.stop()),e.i&&Qh(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.C&&e.C.configure(e.g.ads),e.K&&e.K.configure(e.g.cmcd),e.va&&e.va.configure(e.g.cmsd),e.Da&&e.Da.configure(e.g.queue),e.m==ip&&e.J.getConfiguration){n=e.J.getConfiguration();var r=!1;t.preferredVideoHdrLevel!=e.g.preferredVideoHdrLevel&&n.hdrLevel!=e.g.preferredVideoHdrLevel&&(n.hdrLevel=e.g.preferredVideoHdrLevel,r=!0),t.preferredVideoLayout!=e.g.preferredVideoLayout&&n.videoLayout!=e.g.preferredVideoLayout&&(n.videoLayout=e.g.preferredVideoLayout,r=!0),t.preferSpatialAudio!=e.g.preferSpatialAudio&&n.spatialAudio!=e.g.preferSpatialAudio&&(n.spatialAudio=e.g.preferSpatialAudio,r=!0),t.preferredVideoRole!=e.g.preferredVideoRole&&n.videoRole!=e.g.preferredVideoRole&&(n.videoRole=e.g.preferredVideoRole,r=!0),r&&(e.J.configure(n),Nh(e))}}function yh(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{columns:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function bh(e,t){var n,r;return P(function(i){return 1==i.g?e.m!=ip&&e.m!=ap?i.return(null):(n=e.Je,e.i&&(n=e.i.imageStreams),(r=n[0])?(null!=t&&(r=n.find(function(e){return e.id==t})),r?r.segmentIndex?i.A(2):x(i,r.createSegmentIndex(),2):i.return(null)):i.return(null)):i.return(r)})}function xh(e,t,n,r){var i=t.width||0,a=t.height||0,o=i/r.columns,s=a/r.rows,u=r.columns*r.rows,l=e.j-e.startTime;l=e.B||l/u;var d=e.startTime,c=0,h=0;return u>1&&(h=Math.floor((n-e.startTime)/l),d=e.startTime+h*l,c=h%r.columns*o,h=Math.floor(h/r.columns)*s),r=!1,(n=e.thumbnailSprite)&&(r=!0,s=n.height,c=n.positionX,h=n.positionY,o=n.width),{segment:e,imageHeight:a,imageWidth:i,height:s,positionX:c,positionY:h,startTime:d,duration:l,uris:e.P(),startByte:e.Jc(),endByte:e.Hc(),width:o,sprite:r,mimeType:e.mimeType||t.mimeType,codecs:e.codecs||t.codecs}}function Th(e,t){e.j.D(t,"cuechange",function(){e.u.remove(0,Math.max(0,e.h.currentTime-e.g.streaming.bufferBehind));for(var n={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},r=[],i=Array.from(t.activeCues||[]),a=(i=g(i)).next();!a.done;a=i.next()){if((a=a.value).endTime===1/0||a.endTime<a.startTime)a=null;else{var o=new Mn(a.startTime,a.endTime,a.text);o.line="number"==typeof a.line?a.line:null,a.lineAlign&&(o.lineAlign=a.lineAlign),o.lineInterpretation=a.snapToLines?Gn:1,o.position="number"==typeof a.position?a.position:null,a.positionAlign&&(o.positionAlign=a.positionAlign),o.size=a.size,o.textAlign=a.align,"lr"===a.vertical?o.writingMode="vertical-lr":"rl"===a.vertical&&(o.writingMode="vertical-rl"),a.region&&(o.region.id=a.region.id,o.region.height=a.region.lines,o.region.heightUnits=2,o.region.regionAnchorX=a.region.regionAnchorX,o.region.regionAnchorY=a.region.regionAnchorY,o.region.scroll=a.region.scroll,o.region.viewportAnchorX=a.region.viewportAnchorX,o.region.viewportAnchorY=a.region.viewportAnchorY,o.region.viewportAnchorUnits=Ut,o.region.width=a.region.width,o.region.widthUnits=Ut),Pn(o),a=o}a&&((o=e.g.mediaSource.modifyCueCallback)&&o(a,null,n),r.push(a))}e.u.append(r)}),t.mode=document.pictureInPictureElement?"showing":"hidden"}function wh(e){return Array.from(e.h.textTracks).filter(function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label})}function Sh(e){if(!e.h||!e.h.currentTime)return null;var t=e.ji();return t?Math.floor(Date.now()-(t.getTime()+1e3*e.h.currentTime)):null}function Ah(e,t){var n;return P(function(r){switch(r.g){case 1:return w(r,2),x(r,sl(t,e.N,e.g.streaming.retryParameters),4);case 4:n=r.h,A(r,3);break;case 2:E(r);case 3:if(n)return r.return(n);throw new Ke(1,2,2011,t)}})}function Eh(e,t){var r,i,a,o;return P(function(s){if(1==s.g){r=Yi,i=e.g.streaming.retryParameters,(a=zi([t],i)).method="GET";var u=e.K;try{u.g.enabled&&ac(u,a,{ot:Tc,su:!0})}catch(n){q("CMCD_TEXT_ERROR","Could not generate text CMCD data.",n)}return x(s,e.N.request(r,a).promise,2)}return o=s.h,s.return(o.data)})}function kh(e,t,n,r){var i=Sr(n);if(i)return n=i(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Ne(t),function(e,t){function n(e){for(var n=e,r=g(t),i=r.next();!i.done;i=r.next())(i=i.value).end&&i.start<e&&(n+=i.end-i.start);return((e=Math.floor(n/3600))<10?"0":"")+e+":"+((r=Math.floor(n/60%60))<10?"0":"")+r+":"+((i=Math.floor(n%60))<10?"0":"")+i+"."+((n=Math.floor(1e3*n%1e3))<100?n<10?"00":"0":"")+n}var r=Od(e);e="WEBVTT\n\n";for(var i=(r=g(r)).next();!i.done;i=r.next())e+=n((i=i.value).startTime)+" --\x3e "+n(i.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case Un:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(i)+"\n",e+=i.payload+"\n\n";return e}(t=n.parseMedia(t,e,null,[]),r);throw new Ke(2,2,2014,n)}function Ih(e){var t=nd();return t.streaming.failureCallback=function(t){if(e.W()){var n=null;1001==t.code||1002==t.code?(n=1,e.g.streaming.lowLatencyMode&&(n=.1)):1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.jh(n))}},t.textDisplayFactory=function(){if(e.Ae){var t=e.h;t=!(t.webkitDisplayingFullscreen||t.webkitPresentationMode&&"inline"!=t.webkitPresentationMode)}else t=!1;return t?new Wd(e.h,e.Ae):"track"in document.createElement("track")?new Vd(e):new Xd},t}function Ch(e){var t=e.Qg();if(e.B&&e.R&&e.G){if(0==e.g.streaming.rebufferingGoal){var n=e.M;n.j=!1,Bu(n)}else(n=e.M).j=t,Bu(n);if(e.K&&(n=e.K,t||n.F||(n.F=!0),n.F&&t&&(n.I=!0,ic(n,"ps",{dd:"r"})),n.J=t),Rh(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Me<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var r=e.g.streaming.liveSync.targetLatencyTolerance,i=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.V&&(e.V=Math.min(e.V+ ++e.Me*i,n-r))}}t=(new Map).set("buffering",t),e.dispatchEvent(eh("buffering",t))}function Mh(e,t){e.ec.Qa(),e.ec.D(e.h,"timeupdate",function(){var n=e.h.currentTime,r=e.Ra(),i=e.W(),a=i?e.g.streaming.safeSeekOffset:0;t>0?i&&t>1&&Math.floor(n)>=Math.floor(r.end)&&e.Rd():Math.floor(n)<=Math.floor(r.start+a)&&e.Rd()})}function Rh(e){if(e.B&&e.R){var t=e.B.g,n="playing";e.R.g==za?n="buffering":e.fe()?n="ended":e.h.paused&&(n="paused");var r=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:r,duration:0},t=!0;else{var i=Date.now()/1e3;t.g.duration=i-t.g.timestamp,t.g.state==r?t=!1:(t.h.push(t.g),t.g={timestamp:i,state:r,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(eh("statechanged",n)))}}function _h(e){var t=e.h.playbackRate,n=e.W();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var r=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,i=e.ci();i<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=r&&e.we(r,!1):1==i&&t!==e.M.Tc()&&e.Rd()}if(n&&(n=e.Ra(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start||e.h.paused))){r=e.g.streaming.liveSync.targetLatencyTolerance,i=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var a=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var o=e.g.streaming.liveSync.targetLatency,s=o+r,u=Math.max(0,o-r),l=e.g.streaming.liveSync.maxPlaybackRate,d=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(o=e.i.serviceDescription.targetLatency,null!=e.i.serviceDescription.targetLatency?s=e.i.serviceDescription.targetLatency+r:null!=e.i.serviceDescription.maxLatency&&(s=e.i.serviceDescription.maxLatency),null!=e.i.serviceDescription.targetLatency?u=Math.max(0,e.i.serviceDescription.targetLatency-r):null!=e.i.serviceDescription.minLatency&&(u=e.i.serviceDescription.minLatency),l=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,d=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.V||"number"!=typeof o||(e.V=o);var c=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;i&&e.dc&&null!==e.V&&"number"==typeof o&&e.Me<c&&Date.now()-e.dc>1e3*a&&(a=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.V=Math.max(e.V-(o-a)/2,a+r),e.dc=Date.now()),i&&null!==e.V&&(s=e.V+r,u=e.V-r),o=n.end-e.h.currentTime,r=0,e.m==ap&&(i=e.h.buffered).length>0&&(r=i.end(i.length-1),r=Math.max(l,r-n.end)),n=e.g.streaming.liveSync.panicMode,i=1e3*e.g.streaming.liveSync.panicThreshold,a=Date.now()-e.R.i,n&&!d&&(d=e.g.streaming.liveSync.minPlaybackRate),n&&d&&a<=i?t!=d&&e.we(d,!1):null!=s&&l&&o-r>s?(t!=l&&e.we(l,!1),e.dc=null):null!=u&&d&&o-r<u?(t!=d&&e.we(d,!1),e.dc=null):t!==e.M.Tc()&&(e.Rd(),e.dc=Date.now())}}function Ph(e){if(e.h){var t=function(t,n){return!!((Jc(t,n,.01)||n>t)&&e.$f<t)&&(e.$f=t,!0)},n=e.Ra();if(n=(n=n.end-n.start)>0?e.h.currentTime/n:0,!isNaN(n)){if(t(0,n*=100))var r=eh("started");else t(25,n)?r=eh("firstquartile"):t(50,n)?r=eh("midpoint"):t(75,n)?r=eh("thirdquartile"):((t(100,n)||n>100)&&(r=eh("complete")),e.g&&e.g.playRangeEnd!=1/0&&e.fe()&&e.h.pause());r&&e.dispatchEvent(r)}}}function Dh(e){try{Ja(e.De,e.i)}catch(n){return qh(e,n),!1}var t=li(e.i.variants);return t=e.J.create(t),"boolean"!=typeof(e=e.o.setVariants(Array.from(t.values())))||e}function Lh(e,t){if(t=void 0!==t&&t,Dh(e)){if(!e.g.abr.enabled){var n=e.J;if("function"!=typeof n.getLastAdaptationSet&&(ce("AdaptationSetCriteria w/o getLastAdaptationSet","Please use an AdaptationSetCriteria with getLastAdaptationSet."),n.getLastAdaptationSet=function(){return null}),(n=n.getLastAdaptationSet())&&(n=Array.from(n.values())).length){var r=e.l.o;if(r&&r.video&&(n=n.find(function(e){return e.video==r.video})))return n}}return e.o.chooseVariant(t)}return null}function Nh(e,t,n,r,i){t=void 0===t||t,n=void 0===n?0:n,r=void 0!==r&&r,i=void 0===i||i;var a=Lh(e);a&&Oh(e,a,i,t,n,r)}function Oh(e,t,n,r,i,a){a=void 0!==a&&a;var o=e.l.o;if(t==o)r&&pl(e.l,t,r,i,!0);else{var s=e.B.h;if(s.h!=t&&(s.h=t,s.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),pl(e.l,t,r,i,a,n),r=null,o&&(r=ni(o)),(o=ni(t)).active=!0,e.T&&(i=e.T,t=t.video)){switch(t.dependencyStream&&(t=t.dependencyStream),a=0,s=-1,t.mimeType){case"video/webm":a=1;break;case"video/mp4":a=2}switch(e.ei()){case"DASH":s=1;break;case"HLS":s=0}i.g&&(i.g.setLevelSwitching(t.id,!0),i.g.setContainerFormat(a),i.j||i.g.setStreamingFormat(s))}n?Zh(e,n=eh("adaptation",n=(new Map).set("oldTrack",r).set("newTrack",o))):Fh(e,r,o),Vh(e,r,o)}}function Uh(e,t){var n=Array.from(e.h.audioTracks).find(function(e){return e.enabled});if(t.enabled=!0,n){t.id!==n.id&&(n.enabled=!1);var r=Bh(e);Fh(e,n=si(n,r),t=si(t,r)),Vh(e,n,t)}}function Bh(e){return e.h&&e.h.videoTracks?Array.from(e.h.videoTracks).find(function(e){return e.selected}):null}function jh(e){Zh(e,eh("trackschanged")),Hh(e)}function Fh(e,t,n){Zh(e,t=eh("variantchanged",t=(new Map).set("oldTrack",t).set("newTrack",n)))}function Vh(e,t,n){var r=!1;t&&t.audioId==n.audioId&&t.audioGroupId==n.audioGroupId||(r=!0),r&&Hh(e)}function Hh(e){Zh(e,eh("audiotrackschanged"))}function Gh(e){Zh(e,eh("textchanged"))}function zh(e){Zh(e,eh("texttrackvisibility"))}function Xh(e){e.g.abr.enabled||Kh(e),Zh(e,eh("abrstatuschanged",(new Map).set("newStatus",e.g.abr.enabled)))}function Wh(e){var t=e.Lc().find(function(e){return e.active});t&&e.u&&e.u.setTextLanguage&&e.u.setTextLanguage(t.language)}function Kh(e,t){if(t=void 0===t||t,e.m==ip){e.Ge.stop();for(var n=g(e.i.variants),r=n.next();!r.done;r=n.next())r.value.disabledUntilTime=0;t&&Dh(e)}}function qh(e,t){var n,r,i,a;return P(function(o){switch(o.g){case 1:if(e.m==np)return o.return();if(1===t.severity&&e.B.M++,n=!0,!(e.Ua&&e.i&&e.l)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3024!=t.code&&3018!=t.code){o.A(2);break}return"WEBKIT"===oe().Ha()&&3016==t.code?o.return():(w(o,3),x(o,Nl(e.l),5));case 5:r=o.h,n=!r,r&&(i=eh("mediasourcerecovered"),e.dispatchEvent(i)),A(o,2);break;case 3:E(o),n=!0;case 2:if(!n)return o.return();2===t.severity&&Kh(e,!1),a=eh("error",(new Map).set("detail",t)),e.dispatchEvent(a),a.defaultPrevented&&(t.handled=!0),T(o)}})}function Yh(e,t,n,r){r=void 0===r?e:r,e=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,timescale:n.timescale,eventElement:n.eventElement,eventNode:n.eventNode}),r.dispatchEvent(eh(t,e))}function $h(e,t,n,r){r=void 0!==r&&r,t=(new Map).set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(eh(r?"audiotrackchanged":"mediaqualitychanged",t))}function Jh(e,t){if(t=void 0===t||t,!e.h.error)return t?new Ke(2,3,3016):null;var n=e.h.error.code;return t||1!=n?((t=e.h.error.msExtendedCode)&&(t<0&&(t+=4294967296),t=t.toString(16)),new Ke(2,3,3016,n,t,e.h.error.message)):null}function Qh(e,t,n){t>0&&(e.W()||e.Wi(t)),n<(t=e.getDuration())&&(e.W()||e.Ab(n))}function Zh(e,t){P(function(n){if(1==n.g)return x(n,Promise.resolve(),2);e.m!=np&&e.dispatchEvent(t),T(n)})}function ep(e){for(var t=new Set,n=(e=g(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(jr(n.language)):t.add("und");return t}function tp(e){for(var t=new Map,n=new Map,r=0;r<e.length;r++){var i=e[r],a="und",o=[];i.language&&(a=jr(i.language)),(o="variant"==i.type?i.audioRoles:i.roles)&&o.length||(o=[""]),t.has(a)||t.set(a,new Set);for(var s=(o=g(o)).next();!s.done;s=o.next())s=s.value,t.get(a).add(s),i.label&&(n.has(a)||n.set(a,new Map),n.get(a).set(s,i.label))}var u=[];return t.forEach(function(e,t){for(var r=(e=g(e)).next();!r.done;r=e.next()){r=r.value;var i=null;n.has(t)&&n.get(t).has(r)&&(i=n.get(t).get(r)),u.push({language:t,role:r,label:i})}}),u}Yc.prototype.release=function(){this.h.length>0?this.h.shift()():this.g=null},p(Qc,Bi),(i=Qc.prototype).destroy=function(){var e,t=this;return P(function(n){switch(n.g){case 1:return t.m==np?n.return():(Zc(t),e=t.detach(),t.m=np,x(n,e,2));case 2:return x(n,t.qg(),3);case 3:if(t.Ke&&(t.Ke.release(),t.Ke=null),t.Be&&(t.Be.release(),t.Be=null),t.j&&(t.j.release(),t.j=null),t.ec&&(t.ec.release(),t.ec=null),t.Gd&&(t.Gd.release(),t.Gd=null),t.Fe=null,t.g=null,t.B=null,t.Ae=null,t.K=null,t.va=null,!t.N){n.A(4);break}return x(n,t.N.destroy(),5);case 5:t.N=null;case 4:t.o&&(t.o.release(),t.o=null),t.Da&&(t.Da.destroy(),t.Da=null),Bi.prototype.release.call(t),T(n)}})},i.Wb=function(e,t){t=void 0===t||t;var n,r,i,a=this;return P(function(o){switch(o.g){case 1:if(a.m==np)throw new Ke(2,7,7e3);if(n=a.h&&a.h==e,!a.h||a.h==e){o.A(2);break}return x(o,a.detach(),2);case 2:return x(o,rh(a,"attach"),4);case 4:if(o.h)return o.return();if(w(o,5,6),n||(nh(a,"attach"),r=function(){var e=Jh(a,!1);e&&qh(a,e)},a.Be.D(e,"error",r),a.h=e,a.K&&a.K.setMediaElement(e)),oe(),!t||!Jv()||a.H){o.A(6);break}return x(o,lh(a),6);case 6:k(o),a.ba.release(),I(o,0);break;case 5:return i=E(o),x(o,a.detach(),10);case 10:throw i}})},i.oj=function(e){this.Nh=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return P(function(n){if(1==n.g){if(t.m==np)throw new Ke(2,7,7e3);return x(n,t.Cc(!1,e),2)}if(3!=n.g)return x(n,rh(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.Be.Qa(),t.h=null),nh(t,"detach"),t.C&&!e&&t.C.release()}finally{t.ba.release()}T(n)})},i.Cc=function(t,n){t=void 0===t||t,n=void 0!==n&&n;var r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b=this;return P(function(T){switch(T.g){case 1:return b.m!=np&&(b.m=rp),x(T,rh(b,"unload"),2);case 2:return T.h?T.return():(S(T,3),b.Ua=!1,nh(b,"unload"),Zc(b),r=b.Ce.map(function(e){return e()}),b.Ce=[],x(T,Promise.all(r),5));case 5:if(b.dispatchEvent(eh("unloading")),b.ze&&(b.ze.release(),b.ze=null),b.za&&(b.za.release(),b.za=null),b.kb&&(b.kb.release(),b.kb=null),b.h&&(b.j.Qa(),b.ec.Qa()),b.Ge.stop(),b.bc&&(b.bc.release(),b.bc=null),b.Ta&&(b.Ta.stop(),b.Ta=null),!b.I){T.A(6);break}return x(T,b.I.stop(),7);case 7:b.I=null,b.zc=null;case 6:if(b.o&&b.o.stop(),!b.l){T.A(8);break}return x(T,b.l.destroy(),9);case 9:b.l=null;case 8:if(b.M&&(b.M.release(),b.M=null),b.G&&(b.G.release(),b.G=null),"webkit"!==e.shakaMediaKeysPolyfill||!b.F){T.A(10);break}return x(T,b.F.destroy(),11);case 11:b.F=null;case 10:if(!b.H){T.A(12);break}return x(T,b.H.destroy(),13);case 13:b.H=null;case 12:if(b.C&&!n&&b.C.onAssetUnload(),b.oa&&!n&&(b.oa.destroy(),b.oa=null),n||b.dg.stop(),b.K&&function(e){e.m.clear(),e.F=!1,e.J=!0,e.I=!1,e.u=!1,e.B=0,e.C=0,e.H=0,e.K={request:!1,response:!1,event:!1},ec(e),e.o={},e.h=null,e.i.Qa()}(b.K),b.va&&(b.va.g=null),!b.u){T.A(14);break}return x(T,b.u.destroy(),15);case 15:b.u=null;case 14:if(b.$=!1,b.h){for(i=g(b.ag),a=i.next();!a.done;a=i.next())(o=a.value).src.startsWith("blob:")&&URL.revokeObjectURL(o.src),o.remove();b.ag=[],es(b.h)&&b.h.load()}if(!b.F){T.A(16);break}return x(T,b.F.destroy(),17);case 17:b.F=null;case 16:if(b.eb&&b.X!=b.eb.rd()&&(b.eb.l||b.eb.destroy(),b.eb=null),b.X=null,b.Fa=null,b.R=null,b.i){for(s=g(b.i.variants),u=s.next();!u.done;u=s.next())for(l=u.value,d=g([l.audio,l.video]),c=d.next();!c.done;c=d.next())(h=c.value)&&h.segmentIndex&&h.segmentIndex.release();for(p=g(b.i.textStreams),f=p.next();!f.done;f=p.next())(m=f.value).segmentIndex&&m.segmentIndex.release()}for(b.g&&b.g.streaming.clearDecodingCache&&(vi.clear(),We.clear()),b.i=null,b.B=new cd,b.Mh=null,b.dc=null,b.V=null,b.Me=-1,b.Je=[],v=g(b.yc.values()),y=v.next();!y.done;y=v.next())y.value.stop();b.yc.clear(),b.ob=[],b.$f=-1,b.N&&b.N.Uh(),Ch(b);case 3:k(T),b.ba.release(),I(T,4);break;case 4:if(oe(),t&&Jv()&&!b.H&&b.h)return x(T,lh(b),0);T.A(0)}})},i.ll=function(e){this.O=e},i.load=function(t,n,r){n=void 0===n?null:n;var i,a,o,s,u,l,d,c,h,p,f,m,v,y,b=this;return P(function(A){switch(A.g){case 1:if(b.m==np)throw new Ke(2,7,7e3);if(b.h||!b.ma){A.A(2);break}return x(A,b.Wb(b.ma,!0),3);case 3:b.ma=null;case 2:if(i=null,a="",t instanceof gd){if(t.l)throw new Ke(2,7,7006);a=(i=t).rd()||""}else a=t||"";return x(A,$c(b.ba,"load"),4);case 4:if(b.ba.release(),!b.h)throw new Ke(2,7,7002);if(!b.X){A.A(5);break}return b.X=a,x(A,b.Cc(!1),5);case 5:if(o=++b.Le,s=function(){return P(function(e){if(1==e.g)return b.Le==o?e.A(0):i?x(e,i.destroy(),3):e.A(3);throw new Ke(2,7,7e3)})},u=function(e,t){return P(function(n){switch(n.g){case 1:return S(n,2),x(n,$c(b.ba,t),4);case 4:return x(n,s(),5);case 5:return x(n,e(),6);case 6:return x(n,s(),7);case 7:i&&b.g&&(i.g=b.g);case 2:k(n),b.ba.release(),I(n,0)}})},w(A,7,8),null==n&&i&&(n=i.getStartTime()),b.O=n,b.Ua=!1,b.dispatchEvent(eh("loading")),i){r=i.V,A.A(10);break}if(r){A.A(10);break}return x(A,u(function(){return P(function(e){if(1==e.g)return x(e,sh(b,a),2);r=e.h,T(e)})},"guessMimeType_"),10);case 10:if(l=!!i,i){vd(i,b),b.B=i.getStats(),A.A(13);break}return x(A,ah(b,a,n,r,!0,b.g),14);case 14:(i=A.h)?(i.F=!1,vd(i,b),b.B=i.getStats(),i.start(),i.B.catch(function(){})):b.B=new cd;case 13:return d=!i,c=Date.now()/1e3,b.B=i?i.getStats():new cd,b.X=a,b.Fa=r||null,Ch(b),h=function(){var e=b.h?b.h.buffered:null;return{start:Ko(e)||0,end:qo(e)||0}},b.za=new zu(h),b.za.addEventListener("regionadd",function(e){ch(b,e.region,"metadataadded")}),d?x(A,u(function(){return P(function(e){return x(e,function(e,t){var n,r,i;return P(function(a){return 1==a.g?(n=Date.now()/1e3,r=!0,e.F=e.md({vc:e.N,onError:function(t){qh(e,t)},yf:function(){},onExpirationUpdated:function(){var t=eh("expirationupdated");e.dispatchEvent(t)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.B.m=Date.now()/1e3-n)}}),e.F.configure(e.g.drm),i=mi([t]),e.F.O=!0,x(a,xa(e.F,[i],[]),2)):x(a,e.F.Wb(e.h),0)})}(b,r),0)})},"initializeSrcEqualsDrmInner_"),25):(b.kb=new zu(h),x(A,u(function(){return P(function(e){if(1==e.g)return x(e,Promise.race([i.ma,i.B]),2);b.zc=i.H;var t=i;t.oa=!0,b.I=t.m,b.i=i.Kg(),T(e)})},"waitForFinish"),17));case 17:if(b.H){A.A(18);break}return x(A,u(function(){return P(function(e){return x(e,lh(b),0)})},"initializeMediaSourceEngineInner_"),18);case 18:return b.i&&b.i.textStreams.length&&(b.u.enableTextDisplayer?b.u.enableTextDisplayer():ce("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),x(A,u(function(){return P(function(e){return x(e,i.B,0)})},"waitForFinish"),20);case 20:if(b.g=i.getConfiguration(),b.De=i.G,b.I&&b.I.setMediaElement&&b.h&&b.I.setMediaElement(b.h),b.ze=function(e){return e.va=!0,e.I}(i),b.xe=i.Fa,(p=i.C)&&(b.J=p),l&&b.h&&"AUDIO"===b.h.nodeName&&(function(e){for(var t=g(e.i.variants),n=t.next();!n.done;n=t.next())(n=n.value).video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter(function(e){return e.audio})}(b),b.configure("manifest.disableVideo",!0)),i.j){A.A(21);break}return x(A,u(function(){return P(function(e){return x(e,xd(i,b.h),0)})},"drmEngine_.init"),21);case 21:return b.F=function(e){return e.ba=!0,e.j}(i),x(A,u(function(){return P(function(e){return x(e,b.F.Wb(b.h),0)})},"drmEngine_.attach"),23);case 23:return f=b.g.abrFactory,b.o&&b.Fe==f||(b.Fe=f,b.o&&b.o.release(),b.o=f(),"function"!=typeof b.o.setMediaElement&&(ce("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),b.o.setMediaElement=function(){}),"function"!=typeof b.o.setCmsdManager&&(ce("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),b.o.setCmsdManager=function(){}),"function"!=typeof b.o.trySuggestStreams&&(ce("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),b.o.trySuggestStreams=function(){}),b.o.configure(b.g.abr)),m=function(e){return e.ya=!0,e.M}(i),v=i.i,x(A,u(function(){return P(function(t){return x(t,function(t,n,r,i){var a,o,s,u,l,d,c,h,p,f,m,v,y,b,w,S,A,E,k,I,C,M,R,_,D,L,N;return P(function(O){switch(O.g){case 1:nh(t,"load"),a=t.h,t.M=new Uu({bf:function(){return a.playbackRate},Tc:function(){return a.defaultPlaybackRate},sh:function(e){a.playbackRate=e},Bi:function(e){a.currentTime+=e}}),dh(t,a,n),"onchange"in e.screen&&t.j.D(e.screen,"change",function(){if(t.J.getConfiguration){var e=t.J.getConfiguration();"AUTO"==e.hdrLevel?Dh(t):"AUTO"==t.g.preferredVideoHdrLevel&&t.g.abr.enabled&&(e.hdrLevel="AUTO",t.J.configure(e),Dh(t))}}),o=!1,s=g(t.i.variants);for(u=s.next();!u.done;u=s.next())l=u.value,(d=l.video&&l.video.dependencyStream)&&(o=St(d));!function(e,t,n){n||t.lcevc.enabled?(Zc(e),null==e.T&&(e.T=new xt(e.h,e.Nh,t.lcevc,n),e.H&&(e.H.C=e.T))):Zc(e)}(t,t.g,o),t.Kd=t.g.preferredTextLanguage,t.Nd=t.g.preferredTextRole,t.Md=t.g.preferForcedSubs,Qh(t.i.presentationTimeline,t.g.playRangeStart,t.g.playRangeEnd),t.o.init(function(e,n,r){t.i&&t.l&&e!=t.l.o&&Oh(t,e,!0,void 0!==n&&n,void 0===r?0:r)}),t.o.setMediaElement(a),t.o.setCmsdManager(t.va),t.l=function(e){return new cl(e.i,{nc:function(){return e.G?e.G.Pd():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},Pb:function(){return e.Pb()},video:e.h,Z:e.H,vc:e.N,onError:function(t){return qh(e,t)},onEvent:function(t){return e.dispatchEvent(t)},zd:function(t,n,r,i){var a=t.startTime,o=t.endTime,s=n.type;if(s!=mt){if(e.G){e.G.Di();var u=js(e.H,s);!e.W()&&e.h.paused&&!e.h.seeking&&null!=u&&u>0&&e.G.Pd()<u&&!Jc(e.G.Pd(),u,.001)&&e.G.Zf(u)}mh(e)}r=(new Map).set("start",a).set("end",o).set("contentType",s).set("isMuxed",r).set("isDependency",i),e.dispatchEvent(eh("segmentappended",r)),e.o&&n.fastSwitching&&t.Xc&&t.ie&&e.o.trySuggestStreams()},Dk:function(t,n){(n=n.xd)&&e.xe&&function(e,t,n){var r=function(e,t){var n=e.g.get(t);return n||(n={qe:[],og:null,contentType:t},e.g.set(t,n)),n}(e,t.contentType);!function(e,t){if((e=e.h()[t.contentType])&&e.length>0){var n=e[0].start,r=e[e.length-1].end,i=t.qe;t.qe=i.filter(function(e,t){return!(e.position<=n&&t+1<i.length&&i[t+1].position<=n||e.position>=r)})}else t.qe=[]}(e,r),e={xd:t,position:n},(t=(r=r.qe).findIndex(function(e){return e.position>=n}))>=0?r.splice(t,r[t].position==n?1:0,e):r.push(e)}(e.xe,n,t)},Sh:function(t,n){var r=e.F;if(r.h.parseInbandPsshEnabled&&!r.H&&["audio","video"].includes(t)){t=new va(Ne(n)),n=0;for(var i=g(t.data),a=i.next();!a.done;a=i.next())n+=a.value.length;if(0==n)r=Promise.resolve();else{for(n=new Uint8Array(n),i=0,a=(t=g(t.data)).next();!a.done;a=t.next())a=a.value,n.set(a,i),i+=a.length;Aa(r,"cenc",n),r=r.m}}else r=Promise.resolve();return r},disableStream:function(t,n){return e.disableStream(t,n)},cl:function(t,n){return!(e.g.abr.enabled&&n.fastSwitching&&t.Xc&&t.ie)}})}(t),t.l.configure(t.g.streaming),t.m=ip,t.dispatchEvent(eh("streaming")),c=r;case 2:for((p=t.l.o)||c||(c=Lh(t,!0)),f=[],m=g([(h=p||c).video,h.audio]),v=m.next();!v.done;v=m.next())(y=v.value)&&!y.segmentIndex&&(f.push(y.createSegmentIndex()),y.dependencyStream&&f.push(y.dependencyStream.createSegmentIndex()));if(!(f.length>0)){O.A(4);break}return x(O,Promise.all(f),4);case 4:if(!h||0!=h.disabledUntilTime){O.A(2);break}if(Dh(t),t.I&&t.I.onInitialVariantChosen&&t.I.onInitialVariantChosen(h),t.i.isLowLatency&&(t.g.streaming.lowLatencyMode?t.configure(t.cg):K("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),t.K&&(function(e,t){e.u=t,e.u?e.l==kc?e.l=Ic:e.l==Cc&&(e.l=Mc):e.l==Ic?e.l=kc:e.l==Mc&&(e.l=Cc)}(t.K,t.i.isLowLatency&&t.g.streaming.lowLatencyMode),function(e,t){if(e.g&&e.g.enabled&&(ic(e,"ps",{dd:"d"}),e.h&&e.h.autoplay)){var n=e.h.play();n&&n.then(function(){e.H=t}).catch(function(){e.H=0})}}(t.K,1e3*n)),Qh(t.i.presentationTimeline,t.g.playRangeStart,t.g.playRangeEnd),function(e,t,n){e.j.presentationTimeline.W()||(e.ba=t,e.$=n)}(t.l,t.g.playRangeStart,t.g.playRangeEnd),t.Ua=!0,t.dispatchEvent(eh("canupdatestarttime")),b=function(e){t.G=function(e,t){return new Iu(e.h,e.i,e.g.streaming,t,function(){e.bc&&Fu(e.bc,!e.G.Kh()),e.l&&e.l.bd(),e.R&&mh(e,"seeking")},function(t){return e.dispatchEvent(t)})}(t,e),t.bc=function(e,t){var n=e.W()||"number"==typeof t&&t>0;(t=new Ed(e.ze,n)).addEventListener("enter",function(t){Yh(e,"timelineregionenter",t.region)}),t.addEventListener("exit",function(t){Yh(e,"timelineregionexit",t.region)}),t.addEventListener("skip",function(t){var n=t.region;t.seeking||(Yh(e,"timelineregionenter",n),Yh(e,"timelineregionexit",n))});var r=new Ed(e.za,n);r.addEventListener("enter",function(t){ch(e,t.region,"metadata")}),(n=new Ed(e.kb,n)).addEventListener("enter",function(t){t=(new Map).set("detail",t.region.emsg),e.dispatchEvent(eh("emsg",t))});var i=new ju(e.h);return i.g.add(t),i.g.add(r),i.g.add(n),e.xe&&i.g.add(e.xe),i}(t,e),fh(t,a,!1)},t.g.streaming.startAtSegmentBoundary||(null==(w=t.O)&&t.i.startTime&&(w=t.i.startTime),b(w)),p){O.A(7);break}if(!t.g.streaming.startAtSegmentBoundary){O.A(8);break}return S=t.i.presentationTimeline,t.O instanceof Date&&(E=S.m||S.i,null!=(k=t.O.getTime()/1e3-E)&&(A=k)),null==A&&(A="number"==typeof t.O?t.O:t.h.currentTime),null==t.O&&t.i.startTime&&(A=t.i.startTime),I=S.$b(),C=S.Hb(),A<I?A=I:A>C&&(A=C),x(O,function(e,t){var n,r,i,a,o;return P(function(s){return 1==s.g?(n=e.audio,r=e.video,i=function(e,t){var n,r,i;return P(function(a){return 1==a.g?e?e.segmentIndex?a.A(2):x(a,e.createSegmentIndex(),2):a.return(null):(r=(n=e.segmentIndex.Yb(t))?n.next().value:null)?(i=r.startTime,a.return(i)):a.return(null)})},x(s,i(n,t),2)):3!=s.g?(a=s.h,x(s,i(r,t),3)):null!=(o=s.h)&&null!=a?s.return(Math.max(o,a)):null!=o?s.return(o):null!=a?s.return(a):s.return(t)})}(c,A),9);case 9:M=O.h,b(M);case 8:Oh(t,c,!0,!1,0);case 7:return t.G.ready(),t.Lc().find(function(e){return e.active})||((R=di(t.i.textStreams,t.Kd,t.Nd,t.Md)[0]||null)&&dd(t.B.h,R,!0),c&&(R?(gi(c.audio,R,t.g)&&(t.$=!0),t.$&&t.u.setTextVisibility(!0)):(t.$=!1,t.u.setTextVisibility(!1)),zh(t)),R&&(t.g.streaming.alwaysStreamText||t.Rg())&&(fl(t.l,R),Wh(t))),x(O,t.l.start(i),10);case 10:t.g.abr.enabled&&(t.o.enable(),Xh(t)),jh(t),t.i.variants.some(function(e){return e.primary}),((_=t.W())&&(t.g.streaming.liveSync&&t.g.streaming.liveSync.enabled||t.i.serviceDescription||t.g.streaming.liveSync.panicMode)||t.g.streaming.vodDynamicPlaybackRate)&&(D=function(){return _h(t)},t.j.D(a,"timeupdate",D)),_||(L=function(){return Ph(t)},t.j.D(a,"timeupdate",L),Ph(t),t.i.nextUrl&&(t.g.streaming.preloadNextUrlWindow>0&&(N=function(){var e;return P(function(n){if(1==n.g)return e=t.Ra().end-t.h.currentTime,!isNaN(e)&&e<=t.g.streaming.preloadNextUrlWindow?(t.j.Ma(a,"timeupdate",N),x(n,t.preload(t.i.nextUrl),4)):n.A(0);t.eb=n.h,T(n)})},t.j.D(a,"timeupdate",N)),t.j.D(a,"ended",function(){t.load(t.eb||t.i.nextUrl)}))),t.C&&t.C.onManifestUpdated(_),T(O)}})}(b,c,v,m),0)})},"loadInner_"),24);case 24:!function(e){if(e.J)for(var t=g(e.J),n=t.next();!n.done;n=t.next())(n=n.value)();e.J=null}(i),b.Fa&&oe().ej()&&yr(b.Fa)&&function(t,n,r){t.g&&e.ManagedMediaSource&&t.i&&t.B.useSourceElements&&(t.F&&t.g.removeChild(t.F),t.F=Zo(n,r),t.g.appendChild(t.F),t.g.disableRemotePlayback=!1)}(b.H,b.X,b.Fa),A.A(16);break;case 25:return x(A,u(function(){return P(function(e){return x(e,function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f;return P(function(m){switch(m.g){case 1:if(nh(e,"src-equals"),r=e.h,e.G=new Au(r),i=!1,e.Ce.push(function(){i=!0}),e.dispatchEvent(eh("canupdatestarttime")),null!=e.O&&e.G.Zf(e.O),e.bc=function(e,t){(t=new Ed(e.za,t instanceof Date||t>0)).addEventListener("enter",function(t){ch(e,t.region,"metadata")});var n=new ju(e.h);return n.g.add(t),n}(e,e.O||0),e.M=new Uu({bf:function(){return r.playbackRate},Tc:function(){return r.defaultPlaybackRate},sh:function(e){r.playbackRate=e},Bi:function(e){r.currentTime+=e}}),fh(e,r,!0),r.textTracks&&(uh(e),a=function(t){if(!(e.u instanceof Vd)){var n=wh(e).find(function(e){return"disabled"!==e.mode});n&&(n.mode=t?"showing":"hidden"),e.u instanceof Gd&&(n=function(e){return Array.from(e.h.textTracks).find(function(e){return"Shaka Player TextTrack"==e.label})}(e))&&(n.mode=!t&&e.u.isTextVisible()?"showing":"hidden")}},e.j.D(r,"enterpictureinpicture",function(){return a(!0)}),e.j.D(r,"leavepictureinpicture",function(){return a(!1)}),r.remote?(e.j.D(r.remote,"connect",function(){return a(!1)}),e.j.D(r.remote,"connecting",function(){return a(!1)}),e.j.D(r.remote,"disconnect",function(){return a(!1)})):"webkitCurrentPlaybackTargetIsWireless"in r&&e.j.D(r,"webkitcurrentplaybacktargetiswirelesschanged",function(){return a(!1)}),((o=r).webkitPresentationMode||o.webkitSupportsFullscreen)&&e.j.D(o,"webkitpresentationmodechanged",function(){o.webkitPresentationMode?a("inline"!==o.webkitPresentationMode):o.webkitSupportsFullscreen&&a(o.webkitDisplayingFullscreen)})),dh(e,r,t),s=function(e,t,n){try{if(!e.g.enabled)return t;var r=rc(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var i=vc;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":i=bc;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":i=mc;break e}i=void 0}return r.ot=i,r.su=!0,gc(t,pc(r))}catch(o){return q("CMCD_SRC_ERROR","Could not generate src CMCD data.",o),t}}(e.K,e.X,n),!s.includes("#t=")&&(e.g.playRangeStart>0||isFinite(e.g.playRangeEnd))&&(s+="#t=",e.g.playRangeStart>0&&(s+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(s+=","+e.g.playRangeEnd)),!e.H){m.A(2);break}return x(m,e.H.destroy(),3);case 3:e.H=null;case 2:return es(r),r.src=s,"TV"==(u=oe()).Oa()&&r.load(),"none"!=r.preload&&!r.autoplay&&yr(n)&&"WEBKIT"===u.Ha()&&r.load(),e.m=ap,e.dispatchEvent(eh("streaming")),l=function(){return new Promise(function(t){var n=new Rr(t);e.j.D(r.textTracks,"change",function(){return n.ka(.5)}),n.ka(.5)})},d=new Ci,gu(r,HTMLMediaElement.HAVE_METADATA,e.j,function(){return P(function(t){if(1==t.g)return e.G.ready(),e.Fa&&yr(e.Fa)?x(t,l(),3):(d.resolve(),t.A(0));d.resolve(),T(t)})}),gu(r,HTMLMediaElement.HAVE_CURRENT_DATA,e.j,function(){var t,n,r,a,o;return P(function(s){if(1==s.g)return x(s,l(),2);if(i)return s.return();if(function(e){var t=e.g.preferredAudioLanguage;""!=t&&e.Ri(t,e.g.preferredAudioRole)}(e),(t=wh(e)).some(function(e){return"showing"===e.mode})&&(e.$=!0,e.u.setTextVisibility(!0)),!(e.u instanceof Vd))for(t.length&&(e.u.enableTextDisplayer?e.u.enableTextDisplayer():ce("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method')),n=!1,r=g(t),a=r.next();!a.done;a=r.next())"disabled"!==(o=a.value).mode&&(n?(o.mode="disabled",K("Found more than one enabled text track, disabling it",o)):(Th(e,o),n=!0));!function(e){var t=e.g.preferredTextLanguage;""!=t&&e.nh(t,e.g.preferredTextRole,e.g.preferForcedSubs)}(e),T(s)})}),r.error?d.reject(Jh(e)):"none"==r.preload&&(K('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),d.resolve()),e.j.Aa(r,"error",function(){d.reject(Jh(e))}),x(m,Lr(e.g.streaming.loadTimeout,d),4);case 4:((c=e.W())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(h=function(){return _h(e)},e.j.D(r,"timeupdate",h)),c||(p=function(){return Ph(e)},e.j.D(r,"timeupdate",p),Ph(e)),e.C&&(e.C.onManifestUpdated(c),c&&(f=e.Ra().end,e.j.D(r,"progress",function(){var t=e.Ra().end;f!=t&&(e.C.onManifestUpdated(e.W()),f=t)}))),e.Ua=!0,T(m)}})}(b,c,r),0)})},"srcEqualsInner_"),16);case 16:b.dispatchEvent(eh("loaded"));case 8:if(k(A),!i){A.A(27);break}return x(A,i.destroy(),27);case 27:b.eb=null,I(A,0);break;case 7:if(!(y=E(A))||7e3==y.code){A.A(29);break}return x(A,b.Cc(!1),29);case 29:throw y}})},i.hj=function(e,t,n){e=void 0===e||e,t=void 0!==t&&t,n=void 0!==n&&n;var r,i=this;return P(function(a){return 1==a.g?x(a,ih(i,n),2):3!=a.g?(r=a.h,x(a,i.Cc(e,t),3)):a.return(r)})},i.Yh=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var n,r=this;return P(function(i){return 1==i.g?x(i,ih(r,t),2):3!=i.g?(n=i.h,x(i,r.detach(e),3)):i.return(n)})},i.preload=function(e,t,n,r){t=void 0===t?null:t;var i,a,o=this;return P(function(s){return 1==s.g?(id(i=Ih(o),r||o.g,Ih(o)),x(s,ah(o,e,t,n,!1,i),2)):((a=s.h)?a.start():qh(o,new Ke(2,7,7005)),s.return(a))})},i.qg=function(){var e,t,n,r,i=this;return P(function(a){for(e=[],t=g(i.He),n=t.next();!n.done;n=t.next())(r=n.value).l||e.push(r.destroy());return i.He=[],x(a,Promise.all(e),0)})},i.Mk=function(){for(var e=this.ba;e.g;)e.release()},i.md=function(e){return new ba(e)},i.configure=function(e,t){var n=this.getConfiguration();if(2==arguments.length&&"string"==typeof e&&(e=Hl(e,t)),"preferredVariantRole"in e&&(ce("preferredVariantRole configuration","Please Use preferredAudioRole instead."),e.preferredAudioRole=e.preferredVariantRole,delete e.preferredVariantRole),e.streaming&&"forceTransmuxTS"in e.streaming&&(ce("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(ce("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming){ce("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead.");var r=oe();e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&"WEBKIT"===r.Ha(),delete e.streaming.useNativeHlsOnSafari}if(e.streaming&&"boolean"==typeof e.streaming.liveSync&&(ce("streaming.liveSync","Please Use streaming.liveSync.enabled instead."),r=e.streaming.liveSync,e.streaming.liveSync={},e.streaming.liveSync.enabled=r),e.streaming&&(!e.streaming.liveSync||!("targetLatency"in e.streaming.liveSync))&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){r=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-r)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=r+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(ce("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(ce("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(ce("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(ce("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(ce("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(ce("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(ce("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(ce("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){ce("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var a=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return a},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(ce("manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(ce("streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(ce("manifest.dash.enableAudioGroups configuration","Please Use manifest.enableAudioGroups instead."),e.manifest.enableAudioGroups=e.manifest.dash.enableAudioGroups,delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(ce("streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(ce("streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.manifest&&e.manifest.dash&&"ignoreSupplementalCodecs"in e.manifest.dash&&(ce("manifest.dash.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.dash.ignoreSupplementalCodecs,delete e.manifest.dash.ignoreSupplementalCodecs),e.manifest&&e.manifest.hls&&"ignoreSupplementalCodecs"in e.manifest.hls&&(ce("manifest.hls.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.hls.ignoreSupplementalCodecs,delete e.manifest.hls.ignoreSupplementalCodecs),e.manifest&&e.manifest.dash&&"updatePeriod"in e.manifest.dash&&(ce("manifest.dash.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.dash.updatePeriod,delete e.manifest.dash.updatePeriod),e.manifest&&e.manifest.hls&&"updatePeriod"in e.manifest.hls&&(ce("manifest.hls.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.hls.updatePeriod,delete e.manifest.hls.updatePeriod),e.manifest&&e.manifest.dash&&"ignoreDrmInfo"in e.manifest.dash&&(ce("manifest.dash.ignoreDrmInfo configuration","Please Use manifest.ignoreDrmInfo instead."),e.manifest.ignoreDrmInfo=e.manifest.dash.ignoreDrmInfo,delete e.manifest.dash.ignoreDrmInfo),e.drm&&e.drm.advanced){for(var o in r=!1,e.drm.advanced){var s=e.drm.advanced[o];i=s.videoRobustness,s=s.audioRobustness,"videoRobustness"in e.drm.advanced[o]&&!Array.isArray(e.drm.advanced[o].videoRobustness)&&(e.drm.advanced[o].videoRobustness=[i],r=!0),"audioRobustness"in e.drm.advanced[o]&&!Array.isArray(e.drm.advanced[o].audioRobustness)&&(e.drm.advanced[o].audioRobustness=[s],r=!0)}r&&ce("AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return e.streaming&&"forceHTTP"in e.streaming&&(ce("streaming.forceHTTP configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTP=e.streaming.forceHTTP,delete e.streaming.forceHTTP),e.streaming&&"forceHTTPS"in e.streaming&&(ce("streaming.forceHTTPS configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTPS=e.streaming.forceHTTPS,delete e.streaming.forceHTTPS),e.streaming&&"minBytesForProgressEvents"in e.streaming&&(ce("streaming.minBytesForProgressEvents configuration","Please Use networking.minBytesForProgressEvents instead."),e.networking=e.networking||{},e.networking.minBytesForProgressEvents=e.streaming.minBytesForProgressEvents,delete e.streaming.minBytesForProgressEvents),o=id(this.g,e,Ih(this)),vh(this,n),o},i.wj=function(e){this.cg=e},i.getConfiguration=function(){var e=Ih(this);return id(e,this.g,Ih(this)),e},i.Gj=function(){return this.cg},i.ii=function(){return id(Ih(this),this.g,Ih(this)),zl(this.g,Ih(this))},i.ci=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.h.currentTime+t,this.Ra().end)))return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.Mi=function(){var e,t=this.getConfiguration();for(e in this.g)delete this.g[e];id(this.g,Ih(this),Ih(this)),vh(this,t)},i.Zd=function(){return this.m},i.ei=function(){return this.i?this.i.type:null},i.$e=function(){return this.h},i.Zb=function(){return this.N},i.rd=function(){return this.X},i.bi=function(){return this.C?this.C:null},i.ki=function(){return this.Da?this.Da:null},i.W=function(){return this.i&&!this.xa()?this.i.presentationTimeline.W():!(!this.h||!this.h.src&&!this.xa())&&this.h.duration==1/0},i.Vc=function(){return!!this.i&&this.i.presentationTimeline.Vc()},i.jk=function(){if(this.i&&!this.xa()){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src&&!this.xa())&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.ri=function(){if(this.i&&!this.xa()){var e=this.i.variants;return!(!e.length||(e=e[0]).audio||!e.video||e.video.codecs.includes(","))}return!(!this.h||!this.h.src&&!this.xa()||!this.h.audioTracks)&&0==this.h.audioTracks.length},i.Ra=function(){if(this.i&&!this.xa()){if(!this.Ua&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.$b(),end:e.Hb()}}if(this.h&&(this.h.src||this.xa())&&(e=this.h.seekable)&&e.length){var t=this.g?this.g.playRangeStart:0;t=Math.max(e.start(0),t);var n=this.g?this.g.playRangeEnd:1/0;return{start:t,end:e=Math.min(e.end(e.length-1),n)}}return{start:0,end:0}},i.gk=function(){this.W()&&(this.h.currentTime=this.Ra().end)},i.kk=function(){return this.Ua},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.F?this.F.g:null},i.Yd=function(){return this.F?this.F.Yd():1/0},i.Jg=function(){return this.F?this.F.Jg():[]},i.Ze=function(){return this.F?this.F.Ze():{}},i.Qg=function(){return this.R?this.R.g==za:!!this.X},i.Pb=function(){return this.h?this.M?this.M.i:1:0},i.Ih=function(e){this.m==ip&&this.l&&hl(this.l,e)},i.we=function(e,t){t=void 0===t||t,0==e?K("A trick play rate of 0 is unsupported!"):(this.M.set(e),this.m==ip&&(this.o.playbackRateChanged(e),this.Ih(t&&1!=e)),Mh(this,e))},i.Rd=function(){var e=this.M.Tc();this.m==ap&&this.M.set(e),this.m==ip&&(this.M.set(e),this.o.playbackRateChanged(e),this.Ih(!1)),this.ec.Qa()},i.qc=function(){if(this.i&&!this.xa()){for(var e=this.l?this.l.o:null,t=[],n=0,r=g(this.i.variants),i=r.next();!i.done;i=r.next())if(ui(i=i.value)){var a=ni(i);a.active=i==e,a.active||1==n||null==e||i.video!=e.video||i.audio!=e.audio||(a.active=!0),a.active&&n++,t.push(a)}return t}if(this.h&&this.h.audioTracks){var o=Bh(this);return(e=Array.from(this.h.audioTracks)).length?e.map(function(e){return si(e,o)}):o?[si(null,o)]:[]}return[]},i.Lc=function(){if(this.i){if(this.xa())return[];for(var e=this.l?this.l.B:null,t=[],n=g(this.i.textStreams),r=n.next();!r.done;r=n.next()){var i=ri(r=r.value);i.active=r==e,t.push(i)}return t}return this.h&&this.h.src&&this.h.textTracks?wh(this).map(function(e){return oi(e)}):[]},i.Lj=function(){var e=this.Je;return this.i&&(e=this.i.imageStreams),e.map(function(e){return ii(e)})},i.zj=function(e){var t,n,r=this;return P(function(i){return 1==i.g?x(i,bh(r,e),2):(t=i.h)?(n=[],t.segmentIndex.Gb(function(e){var r=yh(e.tilesLayout||t.tilesLayout);if(r)for(var i=r.rows*r.columns,a=e.j-e.startTime,o=0;o<i;o++){var s=xh(e,t,e.startTime+a*o/i,r);n.push(s)}}),t.closeSegmentIndex&&t.closeSegmentIndex(),i.return(n)):i.return(null)})},i.$j=function(e,t){var n,r,i,a,o,s=this;return P(function(u){return 1==u.g?x(u,bh(s,e),2):(n=u.h)?(n.closeSegmentIndex&&(s.yc.has(n)||(r=new Rr(function(){n.closeSegmentIndex(),s.yc.delete(n)}),s.yc.set(n,r)),s.yc.get(n).ka(5)),null==(i=n.segmentIndex.find(t))?u.return(null):(a=n.segmentIndex.get(i),(o=yh(a.tilesLayout||n.tilesLayout))?u.return(xh(a,n,t,o)):u.return(null))):u.return(null)})},i.oh=function(e){var t,n=this;this.i&&this.G&&((t=n.i.textStreams.find(function(t){return t.id==e.id}))&&t!=n.l.B&&(dd(n.B.h,t,!1),fl(n.l,t),Gh(n),Wh(n),n.Kd=t.language),!this.xa())||function(){if(n.h&&n.h.textTracks){var t=wh(n),r=t.find(function(t){return ai(t)===e.id});if(r){if(n.u instanceof Vd)for(var i=(t=g(t)).next();!i.done;i=t.next()){var a=(i=i.value)===r?n.$?"showing":"hidden":"disabled";i.mode!==a&&(i.mode=a)}else(t=t.find(function(e){return"disabled"!==e.mode}))!==r&&(t&&(t.mode="disabled",n.j.Ma(t,"cuechange"),n.u.remove(0,1/0)),r&&Th(n,r));Gh(n),Wh(n)}}}()},i.If=function(e,t,n){var r=this;t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.G&&(function(){var i=r.i.variants.find(function(t){return t.id==e.id});if(i&&ui(i)){var a=r.l.o;r.g.abr.enabled&&(a.video!=i.video||a.audio&&i.audio&&a.audio.language==i.audio.language&&a.audio.channelsCount==i.audio.channelsCount&&a.audio.label==i.audio.label)&&K("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),r.xa()?Oh(r,i,!1,!1,0):Oh(r,i,!1,t||!1,n||0),r.J.configure({language:i.language,role:i.audio&&i.audio.roles&&i.audio.roles[0]||"",videoRole:i.video&&i.video.roles&&i.video.roles[0]||"",channelCount:i.audio&&i.audio.channelsCount?i.audio.channelsCount:0,hdrLevel:i.video&&i.video.hdr?i.video.hdr:"",spatialAudio:!(!i.audio||!i.audio.spatialAudio)&&i.audio.spatialAudio,videoLayout:i.video&&i.video.videoLayout?i.video.videoLayout:"",audioLabel:i.audio&&i.audio.label?i.audio.label:"",videoLabel:i.video&&i.video.label?i.video.label:"",codecSwitchingStrategy:r.g.mediaSource.codecSwitchingStrategy,audioCodec:i.audio&&i.audio.codecs?i.audio.codecs:"",activeAudioCodec:a.audio&&a.audio.codecs?a.audio.codecs:"",activeAudioChannelCount:a.audio&&a.audio.channelsCount?a.audio.channelsCount:0,preferredAudioCodecs:r.g.preferredAudioCodecs,preferredAudioChannelCount:r.g.preferredAudioChannelCount}),Dh(r)}}(),!this.xa())||function(){if(e.originalAudioId&&r.h&&r.h.audioTracks)for(var t=Array.from(r.h.audioTracks),n=(t=g(t)).next();!n.done;n=t.next())if(ai(n=n.value)==e.id){Uh(r,n);break}}()},i.Uk=function(e,t){var n,r=this;t=void 0===t?0:t,this.i&&this.G&&((n=r.J.getConfiguration()).audioCodec=e.codecs||"",n.audioLabel=e.label||"",n.channelCount=e.channelsCount||0,n.language=e.language,n.role=e.roles[0]||"",n.spatialAudio=e.spatialAudio,r.J.configure(n),Nh(r,!0,t,!1,!1),!this.xa())||function(){if(r.h&&r.h.audioTracks){for(var t=jr(e.language),n=Array.from(r.h.audioTracks),i=null,a=(n=g(n)).next();!a.done;a=n.next()){var o=(a=a.value).language||"und";if(a.label==e.label&&jr(o)==t&&a.kind==e.roles[0]){i=a;break}}i&&Uh(r,i)}}()},i.getAudioTracks=function(){if(this.i&&!this.xa()){var e=this.qc();if(!e.length)return[];var t=e.find(function(e){return e.active});if(!t)return[];var n=e;if(this.m!=ip||this.xa()||(n=e.filter(function(e){return e.originalVideoId===t.originalVideoId&&(e.audioCodec||xr.includes(e.audioMimeType||""))})),!n.length)return[];e=new Map;for(var r=(n=g(n)).next();!r.done;r=n.next()){var i=(r=r.value).originalAudioId;i||null==r.audioId||(i=String(r.audioId)),!i&&r.codecs.includes(",")&&r.audioCodec&&(i="muxed-in-video"),i&&(i+=[r.language,r.label,r.channelsCount,r.spatialAudio,r.audioCodec||""].join("_"),e.set(i,{active:r.active,language:r.language,label:r.label,mimeType:r.audioMimeType,codecs:r.audioCodec,primary:r.primary,roles:r.audioRoles||[],accessibilityPurpose:r.accessibilityPurpose,channelsCount:r.channelsCount,audioSamplingRate:r.audioSamplingRate,spatialAudio:r.spatialAudio,originalLanguage:r.originalLanguage}))}return Array.from(e.values())}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map(function(e){var t=e.language;return t={active:e.enabled,language:jr(t||"und"),label:e.label,mimeType:null,codecs:null,primary:"main"==e.kind,roles:[],accessibilityPurpose:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,originalLanguage:t},e.kind&&("description"==e.kind&&(t.accessibilityPurpose="visually impaired"),t.roles.push(e.kind)),e.configuration&&(e.configuration.codec&&(t.codecs=e.configuration.codec),e.configuration.sampleRate&&(t.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(t.channelsCount=e.configuration.numberOfChannels)),t}):[]},i.Wk=function(e,t,n){t=void 0!==t&&t,n=void 0===n?0:n;var r=this.qc();if(r.length){var i,a=r.find(function(e){return e.active});a&&((i=1==(r=r.filter(function(t){return(t.videoBandwidth||t.bandwidth)==e.bandwidth&&t.width==e.width&&t.height==e.height&&t.frameRate==e.frameRate&&t.pixelAspectRatio==e.pixelAspectRatio&&t.hdr==e.hdr&&t.colorGamut==e.colorGamut&&t.videoLayout==e.videoLayout&&t.videoMimeType==e.mimeType&&t.videoCodec==e.codecs&&ee(t.videoRoles,e.roles)&&t.videoLabel==e.label})).length?r[0]:r.find(function(e){return e.audioId===a.audioId}))||(i=r.find(function(e){return e.language==a.language&&e.label===a.label&&e.channelsCount===a.channelsCount&&e.spatialAudio===a.spatialAudio&&e.audioMimeType===a.audioMimeType&&fr(e.audioCodec||"")===fr(a.audioCodec||"")&&ee(e.audioRoles,a.audioRoles)})),i&&!i.active&&this.If(i,t,n))}},i.getVideoTracks=function(){if(this.m==ap||this.xa())return[];var e=this.qc();if(!e.length)return[];var t=e.find(function(e){return e.active});if(!t)return[];var n=e;if(this.ri()||(n=e.filter(function(e){return!(!e.videoCodec||e.audioGroupId!==t.audioGroupId||e.originalAudioId!==t.originalAudioId)&&(e.audioId===t.audioId||e.language===t.language&&e.label===t.label&&e.channelsCount===t.channelsCount&&e.spatialAudio===t.spatialAudio&&e.audioMimeType===t.audioMimeType&&fr(e.audioCodec||"")===fr(t.audioCodec||"")&&ee(e.audioRoles,t.audioRoles))})),!n.length)return[];e=new Map;for(var r=(n=g(n)).next();!r.done;r=n.next()){var i=(r=r.value).originalVideoId;i||null==r.videoId||(i=String(r.videoId)),i&&e.set(i,{active:r.active,bandwidth:r.videoBandwidth||r.bandwidth,width:r.width,height:r.height,frameRate:r.frameRate,pixelAspectRatio:r.pixelAspectRatio,hdr:r.hdr,colorGamut:r.colorGamut,videoLayout:r.videoLayout,mimeType:r.videoMimeType,codecs:r.videoCodec,roles:r.videoRoles||[],label:r.videoLabel})}return Array.from(e.values())},i.Bj=function(){return tp(this.qc())},i.Yj=function(){return tp(this.Lc())},i.Aj=function(){return Array.from(ep(this.qc()))},i.Xj=function(){return Array.from(ep(this.Lc()))},i.Ri=function(e,t,n,r,i,a,o){var s=this;n=void 0===n?0:n,r=void 0===r?0:r,i=void 0===i?"":i,a=void 0!==a&&a,o=void 0===o?"":o,this.i&&this.G&&(function(){function u(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0}var l=s.l.o;s.J=s.g.adaptationSetCriteriaFactory(),s.J.configure({language:e,role:t||"",videoRole:l.video&&l.video.roles&&l.video.roles[0]||"",channelCount:n||0,hdrLevel:"",spatialAudio:a||!1,videoLayout:"",audioLabel:o||"",videoLabel:"",codecSwitchingStrategy:s.g.mediaSource.codecSwitchingStrategy,audioCodec:i||"",activeAudioCodec:l.audio&&l.audio.codecs?l.audio.codecs:"",activeAudioChannelCount:l.audio&&l.audio.channelsCount?l.audio.channelsCount:0,preferredAudioCodecs:s.g.preferredAudioCodecs,preferredAudioChannelCount:s.g.preferredAudioChannelCount});for(var d=s.J.create(s.i.variants),c=null,h=(d=g(d.values())).next();!h.done;h=d.next())ui(h=h.value)&&(!c||u(c,l)>u(h,l))&&(c=h);c!=l&&(c?(l=ni(c),s.If(l,!0,r||0)):Nh(s))}(),!this.xa())||function(){if(s.h&&s.h.audioTracks){var n=di(s.qc(),e,t||"",!1)[0];n&&s.If(n)}}()},i.nh=function(e,t,n){var r,i=this;n=void 0!==n&&n,this.i&&this.G&&(function(){i.Kd=e,i.Nd=t||"",i.Md=n||!1;var r=di(i.i.textStreams,i.Kd,i.Nd,i.Md)[0]||null;r&&r!=i.l.B&&(dd(i.B.h,r,!1),i.g.streaming.alwaysStreamText||i.Rg())&&(fl(i.l,r),Gh(i),Wh(i))}(),!this.xa())||(r=di(i.Lc(),e,t||"",n||!1)[0])&&i.oh(r)},i.Vk=function(e,t,n){var r=this;t=void 0===t||t,n=void 0===n?0:n,this.i&&this.G&&(function(){for(var i=null,a=g(r.i.variants),o=a.next();!o.done;o=a.next())if((o=o.value).audio.label==e){i=o;break}null!=i&&(r.J=r.g.adaptationSetCriteriaFactory(),r.J.configure({language:i.language,role:"",videoRole:"",channelCount:0,hdrLevel:"",spatialAudio:!1,videoLayout:"",videoLabel:"",audioLabel:e,codecSwitchingStrategy:r.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:r.g.preferredAudioCodecs,preferredAudioChannelCount:r.g.preferredAudioChannelCount}),Nh(r,t,n))}(),!this.xa())||function(){if(r.h&&r.h.audioTracks){for(var t=Array.from(r.h.audioTracks),n=null,i=(t=g(t)).next();!i.done;i=t.next())(i=i.value).label==e&&(n=i);n&&Uh(r,n)}}()},i.Rg=function(){var e=this.$;return this.u?this.u.isTextVisible():e},i.Fj=function(){return this.ob.map(function(e){return ri(e)})},i.Dj=function(e){if(ce("getChapters","Please use an getChaptersAsync."),!this.ob.length)return[];var t=jr(e);if(!(e=this.ob.filter(function(e){return jr(e.language)==t})).length)return[];for(var n=[],r=new Set,i=(e=g(e)).next();!i.done;i=e.next())(i=i.value).segmentIndex&&i.segmentIndex.Gb(function(e){var t=e.P()[0],i=e.startTime+"-"+e.endTime+"-"+t;e={id:i,title:t,startTime:e.startTime,endTime:e.endTime},r.has(i)||(n.push(e),r.add(i))});return n},i.Ej=function(e){var t,n,r,i,a,o,s,u=this;return P(function(l){switch(l.g){case 1:if(!u.ob.length)return l.return([]);if(t=jr(e),!(n=u.ob.filter(function(e){return jr(e.language)==t})).length)return l.return([]);r=[],i=new Set,a=g(n),o=a.next();case 2:if(o.done){l.A(4);break}if((s=o.value).segmentIndex){l.A(5);break}return x(l,s.createSegmentIndex(),5);case 5:s.segmentIndex.Gb(function(e){var t=e.P()[0],n=e.startTime+"-"+e.endTime+"-"+t;e={id:n,title:t,startTime:e.startTime,endTime:e.endTime},i.has(n)||(r.push(e),i.add(n))}),o=a.next(),l.A(2);break;case 4:return l.return(r)}})},i.uh=function(e){e=!!e,this.$!=e&&(this.$=e,this.m==ip?(this.u.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.l.B||(e=di(this.i.textStreams,this.Kd,this.Nd,this.Md)).length>0&&(fl(this.l,e[0]),Gh(this),Wh(this)):function(e){var t=e.h.get(mt);t&&(_l(t),Pl(t).catch(function(){}),e.H=e.h.get(mt),e.h.delete(mt),t.stream&&t.stream.closeSegmentIndex&&t.stream.closeSegmentIndex()),e.B=null}(this.l))):this.h&&this.h.src&&this.h.textTracks&&this.u.setTextVisibility(e),zh(this))},i.Rj=function(){if(this.G)var e=this.G.Pd();else{if(null==this.O)return new Date;if(this.O instanceof Date)return this.O;e=this.O}if(this.i&&!this.xa()){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},i.ji=function(){if(this.i&&!this.xa()){var e=this.i.presentationTimeline;return null===(e=e.m||e.i)?null:new Date(1e3*e)}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},i.cf=function(){return this.W()&&this.i?this.i.presentationTimeline.cf():null},i.Gc=function(){if(this.m==ip)return this.H.Gc();var e={total:[],audio:[],video:[],text:[]};return this.m==ap&&(e.total=Jo(this.h.buffered)),e},i.getBandwidthEstimate=function(){return this.o?this.o.getBandwidthEstimate():NaN},i.getStats=function(){if(this.m!=ip&&this.m!=ap)return{width:NaN,height:NaN,currentCodecs:"",streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};Rh(this);var e=this.h,t=e.currentTime/e.duration;if(isNaN(t)||this.W()||function(e,t){e.i=isNaN(e.i)?t:Math.max(e.i,t)}(this.B,Math.round(100*t)),this.G&&(this.B.T=this.G.Jh(),this.B.V=this.G.Lh()),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),function(e,t,n){e.R=t,e.O=n}(this.B,Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.B.N=Number(t.corruptedVideoFrames)),this.B.o=this.F?function(e){return e.J?e.J:NaN}(this.F):NaN,hd(this.B,e.videoWidth||NaN,e.videoHeight||NaN),this.B.l="",this.W()&&null!=(e=Sh(this))&&(this.B.F=e/1e3),t=this.qc().find(function(e){return e.active}),e=this.Lc().find(function(e){return e.active}),t){if(t.bandwidth){var n=this.M?this.M.i:1,r=n*t.bandwidth;e&&e.bandwidth&&(r+=n*e.bandwidth),this.B.B=r}t.width&&t.height&&hd(this.B,t.width||NaN,t.height||NaN),t=t.codecs,e&&(t+=","+(e.codecs||e.mimeType)),t&&(this.B.l=t)}return this.m!=ip||this.xa()||(this.i&&(this.B.I=this.i.periodCount,this.B.H=this.i.gapCount,this.i.presentationTimeline&&(this.B.K=this.i.presentationTimeline.h)),e=this.o.getBandwidthEstimate(),this.B.u=e),this.m==ap&&pd(this.B,NaN),fd(this.B)},i.Qd=function(e,t,n,r,i,a,o){o=void 0!==o&&o;var s,u,l,d,c,h,p,f,g,m,v=this;return P(function(y){switch(y.g){case 1:if(v.m!=ip&&v.m!=ap)throw new Ke(1,7,7004);if("subtitles"!=n&&"captions"!=n&&K("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),r){y.A(2);break}return x(y,Ah(v,e),3);case 3:r=y.h;case 2:if(s=[],v.C&&(s=v.C.getCuePoints()),v.m!=ap){y.A(4);break}return u=oe(),o&&"WEBKIT"===u.Ha()&&(n="forced"),x(y,function(e,t,n,r,i,a,o){var s,u,l,d;return P(function(c){if(1==c.g)return"text/vtt"!=i||o.length?x(c,Eh(e,t),3):c.A(2);2!=c.g&&(s=c.h,u=kh(e,s,i,o),l=new Blob([u],{type:"text/vtt"}),t=iu(l),i="text/vtt"),d=document.createElement("track");e:{var h=e.K,p=t;try{if(!h.g.enabled){var f=p;break e}var g=rc(h);g.ot=Tc,g.su=!0,f=gc(p,pc(g));break e}catch(m){q("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",m),f=p;break e}f=void 0}return d.src=f,d.label=a,d.kind=r,d.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(d),e.ag.push(d),c.return(d)})}(v,e,t,n,r,a||"",s),5);case 5:if((l=y.h).track)return jh(v),Gh(v),y.return(oi(l.track));throw new Ke(1,2,2012);case 4:if(d=vt,c=v.Ra(),h=c.end-c.start,v.i&&(h=v.i.presentationTimeline.getDuration()),h==1/0)throw new Ke(1,4,4033);if(!s.length){y.A(6);break}return x(y,Eh(v,e),7);case 7:p=y.h,f=kh(v,p,r,s),g=new Blob([f],{type:"text/vtt"}),e=iu(g),r="text/vtt";case 6:if(m={id:v.Ee++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Lu(0,h,[e]),mimeType:r||"",codecs:i||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:a||null,type:d.Na,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([dr(r||"",i||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},!Ar(dr(m.mimeType,m.codecs)))throw new Ke(2,2,2014,r);return v.i.textStreams.push(m),jh(v),Gh(v),y.return(ri(m))}})},i.Oe=function(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,T,w=this;return P(function(S){switch(S.g){case 1:if(w.m!=ip&&w.m!=ap)throw new Ke(1,7,7004);if(t){S.A(2);break}return x(S,Ah(w,e),3);case 3:t=S.h;case 2:if("text/vtt"!=t)throw new Ke(1,2,2017,e);if(n=vt,r=w.Ra(),i=r.end-r.start,w.i&&(i=w.i.presentationTimeline.getDuration()),i==1/0)throw new Ke(1,4,4045);return x(S,Eh(w,e),4);case 4:if(a=S.h,!(o=Sr(t)))throw new Ke(2,2,2014,t);for(s=o(),u={periodStart:0,segmentStart:0,segmentEnd:i,vttOffset:0},l=Ne(a),d=s.parseMedia(l,u,e,[]),c=[],h=g(d),p=h.next(),f={};!p.done;f={Vf:void 0,nd:void 0},p=h.next())f.nd=p.value,f.Vf=null,m=function(t){return function(){return null==t.Vf&&(t.Vf=dt([e],[t.nd.payload])),t.Vf||[]}}(f),v=new Vo(f.nd.startTime,f.nd.endTime,m,0,null,null,0,0,1/0),f.nd.payload.includes("#xywh")&&4===(y=f.nd.payload.split("#xywh=")[1].split(",")).length&&v.Lf({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)}),c.push(v);if(b=t,!c.length){S.A(5);break}return x(S,Ah(w,c[0].P()[0]),6);case 6:b=S.h;case 5:return T={id:w.Ee++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Pu(c),mimeType:b||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.Xf,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([dr(b||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},w.m==ap?w.Je.push(T):w.i.imageStreams.push(T),jh(w),S.return(ii(T))}})},i.Ne=function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b=this;return P(function(T){switch(T.g){case 1:if(b.m!=ip&&b.m!=ap)throw new Ke(1,7,7004);if(n){T.A(2);break}return x(T,Ah(b,e),3);case 3:n=T.h;case 2:if(r=vt,i=b.Ra(),a=i.end-i.start,b.i&&(a=b.i.presentationTimeline.getDuration()),a==1/0)throw new Ke(1,4,4055);if(!(o=Sr(n)))throw new Ke(2,2,2014,n);return x(T,Eh(b,e),4);case 4:for(s=T.h,u=o(),l={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},d=Ne(s),c=u.parseMedia(d,l,e,[]),h=[],p=g(c),f=p.next(),m={};!f.done;m={We:void 0},f=p.next())m.We=f.value,v=new Vo(m.We.startTime,m.We.endTime,function(e){return function(){return[e.We.payload]}}(m),0,null,null,0,0,1/0),h.push(v);return y={id:b.Ee++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Pu(h),mimeType:"text/plain",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:null,type:r.Na,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([dr("text/plain","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},b.ob.push(y),jh(b),T.return(ri(y))}})},i.al=function(e,t){this.ya.width=e,this.ya.height=t},i.jh=function(e){if(this.m==ip){var t=this.l;if(e=void 0===e?.1:e,t.l.g)t=!1;else if(t.F)t=!1;else{for(var n=g(t.h.values()),r=n.next();!r.done;r=n.next())!(r=r.value).be||r.Ka||r.qb||(r.be=!1,Rl(t,r,e));t=!0}}else t=!1;return t},i.Kg=function(){return K("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.Oj=function(){return this.zc},i.Jj=function(){var e={video:null,audio:null,text:null};if(this.m!=ip)return e;for(var t=this.l.o,n=this.h.currentTime,r=(t=g([t.video,t.audio,this.l.B])).next();!r.done;r=t.next())if((r=r.value)&&r.segmentIndex){var i=r.segmentIndex.find(n);i={codecs:(i=r.segmentIndex.get(i)).codecs||r.codecs,mimeType:i.mimeType||r.mimeType,bandwidth:i.bandwidth||r.bandwidth},"video"==r.type?(i.width=r.width,i.height=r.height,e.video=i):"audio"==r.type?e.audio=i:r.type==mt&&(e.text=i)}return e},i.Xi=function(e){this.Ae=e},i.disableStream=function(e,t){if(!this.g.abr.enabled||this.m===np||!navigator.onLine||0==t||!this.i)return!1;if(this.i.variants.some(function(t){var n=t[e.type];return!(!n||n.id===e.id||t.disabledUntilTime||"audio"==e.type&&e.language!==n.language)})){for(var n=!1,r=!1,i=g(this.i.variants),a=i.next();!a.done;a=i.next()){var o=(a=a.value)[e.type];o&&(o.id===e.id?(a.disabledUntilTime=Date.now()/1e3+t,n=!0):o.trickModeVideo&&o.trickModeVideo.id==e.id&&(r=!0))}return!(!n&&r||(this.Ge.Ea(1),t=this.Gc().video.reduce(function(e,t){return e+t.end-t.start},0),Nh(this,!1,t,!0,!1),0))}return!1},i.addFont=function(t,n){return function(t,n){var r,i,a,o,s;return P(function(u){if(1==u.g)return"fonts"in document&&"FontFace"in e?x(u,document.fonts.ready,2):u.return();if(!("entries"in document.fonts))return u.return();for(r=function(e){for(var t=[],n=(e=e.entries()).next();!1===n.done;)t.push(n.value),n=e.next();return t},i=g(r(document.fonts)),a=i.next();!a.done;a=i.next())if((o=a.value).family===t&&"swap"===o.display)return u.return();s=new FontFace(t,"url("+n+")",{display:"swap"}),document.fonts.add(s),T(u)})}(t,n)},i.xa=function(){return!(!this.h||!this.h.remote)&&"disconnected"!=this.h.remote.state},i.fe=function(){return!(this.h&&!this.h.ended)||this.Ua&&!this.W()&&this.h.currentTime>=this.Ra().end},V("shaka.Player",Qc),Qc.prototype.isEnded=Qc.prototype.fe,Qc.prototype.isRemotePlayback=Qc.prototype.xa,Qc.prototype.addFont=Qc.prototype.addFont,Qc.prototype.setVideoContainer=Qc.prototype.Xi,Qc.prototype.getFetchedPlaybackInfo=Qc.prototype.Jj,Qc.prototype.getManifestParserFactory=Qc.prototype.Oj,Qc.prototype.getManifest=Qc.prototype.Kg,Qc.prototype.retryStreaming=Qc.prototype.jh,Qc.prototype.setMaxHardwareResolution=Qc.prototype.al,Qc.prototype.addChaptersTrack=Qc.prototype.Ne,Qc.prototype.addThumbnailsTrack=Qc.prototype.Oe,Qc.prototype.addTextTrackAsync=Qc.prototype.Qd,Qc.prototype.getStats=Qc.prototype.getStats,Qc.prototype.getBufferedInfo=Qc.prototype.Gc,Qc.prototype.getSegmentAvailabilityDuration=Qc.prototype.cf,Qc.prototype.getPresentationStartTimeAsDate=Qc.prototype.ji,Qc.prototype.getPlayheadTimeAsDate=Qc.prototype.Rj,Qc.prototype.setTextTrackVisibility=Qc.prototype.uh,Qc.prototype.getChaptersAsync=Qc.prototype.Ej,Qc.prototype.getChapters=Qc.prototype.Dj,Qc.prototype.getChaptersTracks=Qc.prototype.Fj,Qc.prototype.isTextTrackVisible=Qc.prototype.Rg,Qc.prototype.selectVariantsByLabel=Qc.prototype.Vk,Qc.prototype.selectTextLanguage=Qc.prototype.nh,Qc.prototype.selectAudioLanguage=Qc.prototype.Ri,Qc.prototype.getTextLanguages=Qc.prototype.Xj,Qc.prototype.getAudioLanguages=Qc.prototype.Aj,Qc.prototype.getTextLanguagesAndRoles=Qc.prototype.Yj,Qc.prototype.getAudioLanguagesAndRoles=Qc.prototype.Bj,Qc.prototype.getVideoTracks=Qc.prototype.getVideoTracks,Qc.prototype.selectVideoTrack=Qc.prototype.Wk,Qc.prototype.getAudioTracks=Qc.prototype.getAudioTracks,Qc.prototype.selectAudioTrack=Qc.prototype.Uk,Qc.prototype.selectVariantTrack=Qc.prototype.If,Qc.prototype.selectTextTrack=Qc.prototype.oh,Qc.prototype.getThumbnails=Qc.prototype.$j,Qc.prototype.getAllThumbnails=Qc.prototype.zj,Qc.prototype.getImageTracks=Qc.prototype.Lj,Qc.prototype.getTextTracks=Qc.prototype.Lc,Qc.prototype.getVariantTracks=Qc.prototype.qc,Qc.prototype.cancelTrickPlay=Qc.prototype.Rd,Qc.prototype.trickPlay=Qc.prototype.we,Qc.prototype.useTrickPlayTrackIfAvailable=Qc.prototype.Ih,Qc.prototype.getPlaybackRate=Qc.prototype.Pb,Qc.prototype.isBuffering=Qc.prototype.Qg,Qc.prototype.getKeyStatuses=Qc.prototype.Ze,Qc.prototype.getActiveSessionsMetadata=Qc.prototype.Jg,Qc.prototype.getExpiration=Qc.prototype.Yd,Qc.prototype.drmInfo=Qc.prototype.drmInfo,Qc.prototype.keySystem=Qc.prototype.keySystem,Qc.prototype.isFullyLoaded=Qc.prototype.kk,Qc.prototype.goToLive=Qc.prototype.gk,Qc.prototype.seekRange=Qc.prototype.Ra,Qc.prototype.isVideoOnly=Qc.prototype.ri,Qc.prototype.isAudioOnly=Qc.prototype.jk,Qc.prototype.isInProgress=Qc.prototype.Vc,Qc.prototype.isLive=Qc.prototype.W,Qc.prototype.getQueueManager=Qc.prototype.ki,Qc.prototype.getAdManager=Qc.prototype.bi,Qc.prototype.getAssetUri=Qc.prototype.rd,Qc.prototype.getNetworkingEngine=Qc.prototype.Zb,Qc.prototype.getMediaElement=Qc.prototype.$e,Qc.prototype.getManifestType=Qc.prototype.ei,Qc.prototype.getLoadMode=Qc.prototype.Zd,Qc.prototype.resetConfiguration=Qc.prototype.Mi,Qc.prototype.getBufferFullness=Qc.prototype.ci,Qc.prototype.getNonDefaultConfiguration=Qc.prototype.ii,Qc.prototype.getConfigurationForLowLatency=Qc.prototype.Gj,Qc.prototype.getConfiguration=Qc.prototype.getConfiguration,Qc.prototype.configurationForLowLatency=Qc.prototype.wj,Qc.prototype.configure=Qc.prototype.configure,Qc.prototype.releaseAllMutexes=Qc.prototype.Mk,Qc.prototype.destroyAllPreloads=Qc.prototype.qg,Qc.prototype.preload=Qc.prototype.preload,Qc.prototype.detachAndSavePreload=Qc.prototype.Yh,Qc.prototype.unloadAndSavePreload=Qc.prototype.hj,Qc.prototype.load=Qc.prototype.load,Qc.prototype.updateStartTime=Qc.prototype.ll,Qc.prototype.unload=Qc.prototype.Cc,Qc.prototype.detach=Qc.prototype.detach,Qc.prototype.attachCanvas=Qc.prototype.oj,Qc.prototype.attach=Qc.prototype.Wb,Qc.probeSupport=function(t){var n,r,i,a,o;return t=void 0===t||t,P(function(s){switch(s.g){case 1:if(n={},!t){s.A(2);break}return x(s,function(){var t,n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,S,k,I,C,M,R,_,D;return P(function(L){if(1==L.g){if(t="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.microsoft.playready.recommendation.3000 com.microsoft.playready.recommendation.3000.clearlead com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)){for(n={},r=g(t),i=r.next();!i.done;i=r.next())a=i.value,n[a]=null;return L.return(n)}for(o="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),u={"com.widevine.alpha":s=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],"com.widevine.alpha.experiment":s,"com.microsoft.playready.recommendation":["150","2000","3000"]},l={videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],initDataTypes:["cenc","sinf","skd","keyids"]},d=[null,"cenc","cbcs"],c=new Map,h=oe(),p=function(e,t,n){var r,i,a,s,u,l,d,p,f,m,v,y;return P(function(b){switch(b.g){case 1:return w(b,2),x(b,t.createMediaKeys(),5);case 5:r=b.h;case 4:A(b,3);break;case 2:return E(b),b.return();case 3:if(a=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),h.Ai()&&(a=!1),s=t.getConfiguration().videoCapabilities,u=t.getConfiguration().audioCapabilities,l={persistentState:a,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},c.get(e)?l=c.get(e):c.set(e,l),(d=s[0].encryptionScheme)&&!l.encryptionSchemes.includes(d)&&l.encryptionSchemes.push(d),(p=s[0].robustness)&&!l.videoRobustnessLevels.includes(p)&&l.videoRobustnessLevels.push(p),(f=u[0].robustness)&&!l.audioRobustnessLevels.includes(f)&&l.audioRobustnessLevels.push(f),!n||!("getStatusForPolicy"in r)){b.A(0);break}m=g(o),v=m.next();case 7:if(v.done){b.A(0);break}if(y=v.value,l.minHdcpVersions.includes(y)){b.A(8);break}return x(b,r.getStatusForPolicy({minHdcpVersion:y}),10);case 10:if("usable"!=b.h){b.A(0);break}l.minHdcpVersions.includes(y)||l.minHdcpVersions.push(y);case 8:v=m.next(),b.A(7)}})},f=function(e,t,n,r,i){var a,o,s,u,d,c,h,f,m,v;return i=void 0!==i&&i,P(function(y){switch(y.g){case 1:for(w(y,2),a=Kt(l),o=g(a.videoCapabilities),s=o.next();!s.done;s=o.next())(u=s.value).encryptionScheme=t,u.robustness=n;for(d=g(a.audioCapabilities),c=d.next();!c.done;c=d.next())(h=c.value).encryptionScheme=t,h.robustness=r;return(f=Kt(a)).persistentState="required",f.sessionTypes=["persistent-license"],m=[f,a],"MOBILE"==oe().Oa()?x(y,Lr(5,navigator.requestMediaKeySystemAccess(e,m)),7):x(y,navigator.requestMediaKeySystemAccess(e,m),6);case 6:v=y.h,y.A(5);break;case 7:v=y.h;case 5:return x(y,p(e,v,i),8);case 8:A(y,0);break;case 2:E(y),T(y)}})},m=function(e){return"WEBKIT"!==oe().Ha()||"org.w3.clearkey"!==e},v=[],y=g(t),b=y.next();!b.done;b=y.next())if(S=b.value,c.set(S,null),m(S)){for(k=!0,I=g(d),C=I.next();!C.done;C=I.next())M=C.value,v.push(f(S,M,"","",k)),k=!1;for(R=g(u[S]||[]),_=R.next();!_.done;_=R.next())D=_.value,v.push(f(S,null,D,"")),v.push(f(S,null,"",D))}return x(L,Promise.all(v),2)}return L.return(na(c))})}(),3);case 3:n=s.h;case 2:return r=function(){var e={};if(oe(),Jv())for(var t=g(It.keys()),n=t.next();!n.done;n=t.next())e[n.value]=!0;for(n=(t=g(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=t.next())e[n=n.value]=Jv()?It.has(n):""!=ns().canPlayType(n);return e}(),i=function(){var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.20000000.L153.B0",video/mp4; codecs="hvc1.2.4.L120.b0",video/mp4; codecs="hvc1.2.4.L123.b0",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.08.01",video/mp4; codecs="dav1.10.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",audio/mp4; codecs="apac.31.00",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(m(xr)),t={};oe();for(var n=(e=g(e)).next();!n.done;n=e.next()){if(Ar(n=n.value))t[n]=!0;else if(Jv()){var r=mr(n);r=dr(r,ei(vr(n),r)),t[n]=Za(r)||!!rr(r)}else t[n]=""!=ns().canPlayType(n);t[r=n.split(";")[0]]=t[r]||t[n]}return t}(),x(s,oe().lc(),4);case 4:return a=s.h,o={manifest:r,media:i,drm:n,hardwareResolution:a},sp.forEach(function(e,t){o[t]=e()}),s.return(o)}})},Qc.isBrowserSupported=function(){return e.Promise||K("A Promise implementation or polyfill is required"),!(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||(navigator.userAgent||"").includes("Trident/")||(oe(),!Jv()&&""==ns().canPlayType("application/x-mpegurl")))},Qc.setQueueManagerFactory=function(e){lp=e},Qc.setAdManagerFactory=function(e){up=e},Qc.registerSupportPlugin=th,Qc.prototype.destroy=Qc.prototype.destroy;var np=0,rp=1,ip=2,ap=3;Qc.LoadMode={DESTROYED:np,NOT_LOADED:rp,MEDIA_SOURCE:ip,SRC_EQUALS:ap},Qc.version="v4.16.11";var op=["4","16"];fe=new function(e){this.g=e,this.i=he,this.h=pe}(new de(Number(op[0]),Number(op[1])));var sp=new Map,up=null,lp=null;function dp(){this.g=[],this.i=this.m=this.l=this.j=this.h=0}function cp(e){return e.g.length?e.g.reduce(function(e,t){return e+t},0)/e.g.length:0}function hp(e,t,n){var r=this;this.g=e,this.h=t,this.m=n,this.i=!1,this.j=this.h.getVolume(),this.l=new ne,this.l.D(this.h,google.ima.AdEvent.Type.PAUSED,function(){r.i=!0}),this.l.D(this.h,google.ima.AdEvent.Type.RESUMED,function(){r.i=!1})}function pp(){}function fp(e,t){for(var n=[],r=(e=g(tn(e,"Ad"))).next();!r.done;r=e.next())if((r=on(r.value,"InLine"))&&(r=on(r,"Creatives")))for(var i=(r=g(tn(r,"Creative"))).next();!i.done;i=r.next()){var a=on(i=i.value,"Linear");if(a&&gp(n,t,a),i=on(i,"NonLinearAds"))for(var o=(i=g(i=tn(i,"NonLinear"))).next();!o.done;o=i.next())e:{a=n;var s=t,u=o.value,l=on(u,"StaticResource");if(l)o=l.attributes.creativeType;else{if(!(l=on(u,"HTMLResource")))break e;o="text/html"}if(l=rn(l)){"text/html"===o&&(l="data:text/html;charset=UTF-8,"+encodeURIComponent(l));var d=un(u,"width",gn)||un(u,"expandedWidth",gn),c=un(u,"height",gn)||un(u,"expandedHeight",gn);if(d||c){var h=null,p=on(u,"NonLinearClickThrough");p&&(p=rn(p))&&(h=p),p=null,(u=u.attributes.minSuggestedDuration)&&(p=zt(u)),u=0,null!=s&&(u=s),a.push({id:null,groupId:null,startTime:u,endTime:null,uri:l,mimeType:o,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:p,once:!0,pre:null==s,post:s==1/0,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:d||0,y:c||0}},displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:h})}}}}return n}function gp(e,t,n){var r=0;null!=t&&(r=t);var i=null;n.attributes.skipoffset&&(i=zt(n.attributes.skipoffset),isNaN(i)&&(i=null));var a=on(n,"MediaFiles");if(a){var o=null;for((n=on(n,"VideoClicks"))&&(n=on(n,"ClickThrough"))&&(n=rn(n))&&(o=n),a=n=tn(a,"MediaFile"),n=n.filter(function(e){return"streaming"==e.attributes.delivery}),n.length&&(a=n),a=a.sort(function(e,t){return(parseInt(t.attributes.height,10)||0)-(parseInt(e.attributes.height,10)||0)}),n=(a=g(a)).next();!n.done;n=a.next())if(!(n=n.value).attributes.apiFramework){var s=rn(n);if(s){e.push({id:null,groupId:null,startTime:r,endTime:null,uri:s,mimeType:n.attributes.type||null,isSkippable:null!=i,skipOffset:i,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:null==t,post:t==1/0,timelineRange:!1,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:o});break}}}}function mp(t,n,r,i,a){var o=this;this.u=t,this.i=n,this.G=!1,this.B=this.o=null,this.H=NaN,this.l=a,this.j=null,this.h=new ne,google.ima.settings.setLocale(r),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.F=new google.ima.AdDisplayContainer(this.u,this.i),this.F.initialize(),this.m=new google.ima.AdsLoader(this.F),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.16.11"),this.g=null,this.C=i||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){!function(t,n){if(t.l(new Ni("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.H))),t.o.customPlayheadTracker){var r={currentTime:t.i.currentTime};t.g=n.getAdsManager(r,t.C),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.D(t.i,"timeupdate",function(){t.i.duration&&(r.currentTime=t.i.currentTime)}),t.h.D(t.i,"volumechange",function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))})}else t.g=n.getAdsManager(t.i,t.C);t.l(new Ni("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var i=t.g.getCuePoints();if(i.length){n=[];for(var a=(i=g(i)).next();!a.done;a=i.next())n.push({start:a.value,end:null});t.l(new Ni("ad-cue-points-changed",(new Map).set("cuepoints",n)))}!function(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new Ni(n,t))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(t){vp(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(t){yp(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,function(t){yp(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(e){t(e,"ad-first-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,function(e){t(e,"ad-midpoint")}),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(e){t(e,"ad-third-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,function(e){t(e,"ad-complete")}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(t){bp(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(n){t(n,"all-ads-completed"),bp(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,function(e){t(e,"ad-skipped")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(e){t(e,"ad-volume-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(e){t(e,"ad-muted")}),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,function(e){t(e,"ad-clicked")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(e){t(e,"ad-progress")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(e){t(e,"ad-buffering")}),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,function(e){t(e,"ad-impression")}),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(e){t(e,"ad-duration-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(e){t(e,"ad-closed")}),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,function(e){t(e,"ad-loaded")}),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(e){t(e,"ad-linear-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,function(e){t(e,"ad-metadata")}),e.h.D(e.g,google.ima.AdEvent.Type.LOG,function(e){t(e,"ad-recoverable-error")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(e){t(e,"ad-break-ready")}),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,function(e){t(e,"ad-interaction")})}(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight),t.h.D(t.i,"loadeddata",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)}),"ResizeObserver"in e?(t.B=new ResizeObserver(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)}),t.B.observe(t.i)):t.h.D(document,"fullscreenchange",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)}),t.G||t.o.skipPlayDetection?t.g.start():t.h.Aa(t.i,"play",function(){t.G=!0,t.g.start()})}catch(o){bp(t,null)}}(o,t)}),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(e){vp(o,e)}),this.h.D(this.i,"ended",function(){o.m.contentComplete()}),this.h.Aa(this.i,"play",function(){o.G=!0})}function vp(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.l(new Ni("ad-error",t)),bp(e,null),e.l(new Ni("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function yp(e,t){var n=t.getAd();n?(e.j=new hp(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Ni("ad-content-pause-requested")),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Ni("ad-started",t)),e.j.isLinear()&&(e.u.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?((t=e.j).j=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):K("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function bp(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Ni("ad-content-resume-requested")),e.l(new Ni("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.u.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function xp(e,t,n,r,i,a){this.g=e,this.h=t,this.j=(this.i=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.l=t.skipFor,this.B=n,this.o=r,this.m=i,this.u=a,this.C=t.overlay}function Tp(e,t,n){this.g=e,this.j=t,this.h=n,this.i=null==e.overlay}function wp(e,t,n,r){function i(e){return!!e&&(!!e.overlay||(a.g.ended?e.post:!a.g.paused))}var a=this;this.M=null,this.m=e,this.C=t,this.g=n,this.G=null,this.u=!0,this.h=this.g,this.va=r,this.ma=new Set,this.T=new Set,this.H=new Set,this.F=new Map,this.K=new Map,this.i=new Qc,Pp(this),this.I=new ne,this.j=new ne,this.J=!1,this.$=this.o=this.B=this.l=null,this.ba=!1,this.O=-1,this.X=function(){if(!a.J&&a.l&&!a.C.xa()){a.l=a.g.currentTime;var e=Ip(a);e&&i(e)&&Cp(a,e,1,1,Date.now())}},this.V=function(){if(!(a.J||a.l||a.C.xa())){a.g.paused||(a.l=a.g.currentTime);var e=Ip(a,!0);e||(e=Ip(a)),e&&i(e)&&Cp(a,e,1,1,Date.now())}},this.oa=function(){if(!a.J&&a.l&&!a.C.xa()){var e=a.g.currentTime;a.B&&!a.B.pre&&!a.B.post&&e<(a.B.endTime||a.B.startTime)&&(a.B=null)}},this.R=new Rr(this.X),this.N=new Rr(function(){var e,t,n,r,i,o,s,u,l,d,c;return P(function(h){switch(h.g){case 1:if(!a.H.size||null==a.l){h.A(0);break}if((e=a.C.Zd())==np||e==rp)return h.return();t=!1,n=Array.from(a.H),r=a.C.Ra(),i=g(n),o=i.next();case 3:if(o.done){h.A(5);break}if((s=o.value)==a.B){h.A(4);break}if(u=s.endTime||s.startTime,!(r.start-u>=1)){(l=s.startTime-a.l)>0&&l<=10&&(!a.F.has(s)&&Lp(s)&&a.F.set(s,a.i.preload(s.uri,null,s.mimeType||void 0)),Op(a,s)),h.A(4);break}if(!a.F.has(s)){h.A(7);break}return x(h,a.F.get(s),8);case 8:(d=h.h)&&d.destroy(),a.F.delete(s);case 7:Up(a,s),c=s.id||JSON.stringify(s),a.T.has(c)&&a.T.delete(c),a.H.delete(s),Sp(a),s.overlay||(t=!0);case 4:o=i.next(),h.A(3);break;case 5:t&&_p(a),T(h)}})}),this.configure(this.C.getConfiguration().ads)}function Sp(e){e.ba&&!e.H.size&&(e.I.Ma(e.g,"playing",e.V),e.I.Ma(e.g,"timeupdate",e.V),e.I.Ma(e.g,"seeked",e.oa),e.I.Ma(e.g,"ended",e.X),-1!=e.O&&(e.g.cancelVideoFrameCallback(e.O),e.O=-1),e.R&&e.R.stop(),e.N&&e.N.stop(),e.ba=!1)}function Ap(e){if(e.m&&e.M){var t=e.M.supportsMultipleMediaElements,n=e.g;(n.controls||n.webkitPresentationMode&&"inline"!==n.webkitPresentationMode||n.webkitDisplayingFullscreen)&&(t=!1),e.u==t&&(e.u=!t,e.u?(e.h=e.g,e.G&&(e.G.parentElement&&e.m.removeChild(e.G),e.G=null)):(e.G||((t=document.createElement(e.g.tagName)).autoplay=!0,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="none",t.setAttribute("playsinline",""),e.G=t),e.h=e.G))}else e.u=!0}function Ep(e,t){var n,r,i;P(function(a){if(1==a.g){if(n=null,(r=t.values.find(function(e){return"ID"==e.key}))&&(n=r.data),n){if(e.ma.has(n))return a.return();e.ma.add(n)}return Pp(e),i=[],t&&t.values.find(function(e){return"X-OVERLAY-ID"==e.key})?(i=function(e){var t=[];if(!e)return t;var n=e.values.find(function(e){return"X-ASSET-URI"==e.key});if(!n)return t;if(!(n=n.data))return t;var r=null,i=e.values.find(function(e){return"X-OVERLAY-ID"==e.key});i&&(r=i.data),i=null==r?Math.floor(10*e.startTime)/10:e.startTime;var a=e.endTime;e.endTime&&e.endTime!=1/0&&"number"==typeof e.endTime&&(a=null==r?Math.floor(10*e.endTime)/10:e.endTime);var o=!1,s=!1,u=!1,l=e.values.find(function(e){return"CUE"==e.key});l&&(u=l.data,o=u.includes("ONCE"),s=u.includes("PRE"),u=u.includes("POST")),l=null;var d=e.values.find(function(e){return"X-ASSET-MIMETYPE"==e.key});d&&(l=d.data),d=!1;var c=e.values.find(function(e){return"X-LOOP"==e.key});c&&(d="YES"==c.data),c=1;var h=e.values.find(function(e){return"X-DEPTH"==e.key});h&&(c=parseFloat(h.data),isNaN(c)&&(c=1)),h=null;var p=e.values.find(function(e){return"X-BACKGROUND"==e.key});p&&(h=p.data),p=1920;var f=1080,g=e.values.find(function(e){return"X-VIEWPORT"==e.key});if(g){if(2!=(f=g.data.split("x")).length)return t;p=parseFloat(f[0]),f=parseFloat(f[1])}if(p={viewport:{x:p,y:f},topLeft:{x:0,y:0},size:{x:p,y:f}},f=e.values.find(function(e){return"X-OVERLAY-POSITION"==e.key})){if(2!=(f=f.data.split("x")).length)return t;p.topLeft.x=parseFloat(f[0]),p.topLeft.y=parseFloat(f[1])}if(f=e.values.find(function(e){return"X-OVERLAY-SIZE"==e.key})){if(2!=(f=f.data.split("x")).length)return t;p.size.x=parseFloat(f[0]),p.size.y=parseFloat(f[1])}if(f=null,(g=e.values.find(function(e){return"X-SQUEEZECURRENT"==e.key}))&&(f=parseFloat(g.data),isNaN(f)&&(f=1),f={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920*f,y:1080*f}},e=e.values.find(function(e){return"X-SQUEEZECURRENT-POSITION"==e.key}))){if(2!=(e=e.data.split("x")).length)return t;f.topLeft.x=parseFloat(e[0]),f.topLeft.y=parseFloat(e[1])}return t.push({id:r,groupId:null,startTime:i,endTime:a,uri:n,mimeType:l,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:o,pre:s,post:u,timelineRange:!0,loop:d,overlay:p,displayOnBackground:-1==c,currentVideo:f,background:h,clickThroughUrl:null}),t}(t),a.A(2)):x(a,function(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,g,m,v,y,b,T,S,k,I,C,M,R,_,D,L,N,O,U,B,j,F,V,H,G,z,X,W,K;return P(function(P){switch(P.g){case 1:if(n=[],!t)return P.return(n);if(r=t.values.find(function(e){return"X-ASSET-URI"==e.key}),i=t.values.find(function(e){return"X-ASSET-LIST"==e.key}),!r&&!i)return P.return(n);if(a=null,(o=t.values.find(function(e){return"ID"==e.key}))&&(a=o.data),s=null==a?Math.floor(10*t.startTime)/10:t.startTime,(u=t.endTime)&&t.endTime!=1/0&&"number"==typeof t.endTime&&(u=null==a?Math.floor(10*t.endTime)/10:t.endTime),l=t.values.find(function(e){return"X-RESTRICT"==e.key}),c=d=!0,l&&l.data&&(h=l.data,d=!h.includes("SKIP"),c=!h.includes("JUMP")),p=d?0:null,(f=t.values.find(function(e){return"X-ENABLE-SKIP-AFTER"==e.key}))&&(g=f.data,p=parseFloat(g),isNaN(p)&&(p=d?0:null)),m=null,(v=t.values.find(function(e){return"X-ENABLE-SKIP-FOR"==e.key}))&&(y=v.data,m=parseFloat(y),isNaN(p)&&(m=null)),b=null,(T=t.values.find(function(e){return"X-RESUME-OFFSET"==e.key}))&&(S=T.data,b=parseFloat(S),isNaN(b)&&(b=null)),k=null,(I=t.values.find(function(e){return"X-PLAYOUT-LIMIT"==e.key}))&&(C=I.data,k=parseFloat(C),isNaN(k)&&(k=null)),_=R=M=!1,(D=t.values.find(function(e){return"CUE"==e.key}))&&(L=D.data,M=L.includes("ONCE"),R=L.includes("PRE"),_=L.includes("POST")),N=!1,(O=t.values.find(function(e){return"X-TIMELINE-OCCUPIES"==e.key}))?(U=O.data,N=U.includes("RANGE")):!T&&e.C.W()&&(N=!R&&!_),r){if(!(B=r.data))return P.return(n);n.push({id:a,groupId:null,startTime:s,endTime:u,uri:B,mimeType:null,isSkippable:d,skipOffset:p,skipFor:m,canJump:c,resumeOffset:b,playoutLimit:k,once:M,pre:R,post:_,timelineRange:N,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null}),P.A(2);break}if(!i){P.A(2);break}return(j=i.data)?(w(P,4),x(P,Dp(e,j,{type:11}),6)):P.return(n);case 6:for(F=P.h,V=Ye(F),H=JSON.parse(V),(G=H["SKIP-CONTROL"])&&("number"==typeof(z=G["ENABLE-SKIP-AFTER"])&&(p=parseFloat(z),isNaN(z)&&(p=d?0:null)),"number"==typeof(X=G["ENABLE-SKIP-FOR"])&&(m=parseFloat(X),isNaN(X)&&(m=null))),W=0;W<H.ASSETS.length;W++)(K=H.ASSETS[W]).URI&&n.push({id:a+"_shaka_asset_"+W,groupId:a,startTime:s,endTime:u,uri:K.URI,mimeType:null,isSkippable:d,skipOffset:p,skipFor:m,canJump:c,resumeOffset:b,playoutLimit:k,once:M,pre:R,post:_,timelineRange:N,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null});A(P,2);break;case 4:E(P);case 2:return P.return(n)}})}(e,t),3)}2!=a.g&&(i=a.h),i.length?kp(e,i):K("Unsupported HLS interstitial",t),T(a)})}function kp(e,t){var n,r,i,a,o,s,u,l;P(function(d){switch(d.g){case 1:n=!1,r=g(t),i=r.next();case 2:if(i.done){d.A(4);break}if(!(a=i.value).uri){K("Missing URL in interstitial",a),d.A(3);break}if(a.mimeType){d.A(5);break}return w(d,6),o=e.i.Zb(),x(d,sl(a.uri,o,e.C.getConfiguration().streaming.retryParameters),8);case 8:a.mimeType=d.h,A(d,5);break;case 6:E(d);case 5:if(s=a.id||JSON.stringify(a),e.T.has(s)){d.A(3);break}a.loop&&!a.overlay&&K("Loop is only supported in overlay interstitials",a),a.overlay||(n=!0),e.T.add(s),e.H.add(a),u=!1,a.pre&&null==e.l?u=!0:0!=a.startTime||a.canJump?null!=e.l&&(l=a.startTime-e.l)>0&&l<=10&&(u=!0):u=!0,u&&(!e.F.has(a)&&Lp(a)&&e.F.set(a,e.i.preload(a.uri,null,a.mimeType||void 0)),Op(e,a));case 3:i=r.next(),d.A(2);break;case 4:n&&_p(e),function(e){if(!e.ba&&e.H.size){if(e.I.D(e.g,"playing",e.V),e.I.D(e.g,"timeupdate",e.V),e.I.D(e.g,"seeked",e.oa),e.I.D(e.g,"ended",e.X),"requestVideoFrameCallback"in e.g&&!Np()){var t=e.g,n=function(){-1!=e.O&&(e.X(),-1!=e.O&&(e.O=t.requestVideoFrameCallback(n)))};e.O=t.requestVideoFrameCallback(n)}else e.R.Ea(.025);e.N&&e.N.Ea(1),e.ba=!0}}(e),T(d)}})}function Ip(e,t,n){t=void 0!==t&&t,n=void 0===n?null:n;var r=0,i=null;if(e.H.size&&null!=e.l){var a=e.g.ended,o=Array.from(e.H).sort(function(e,t){return t.startTime-e.startTime}),s=o;for(s=t?o.filter(function(e){return e.pre}):a?o.filter(function(e){return e.post}):o.filter(function(e){return!e.pre&&!e.post}),s=(o=g(s)).next();!s.done;s=o.next()){s=s.value;var u=!1;if(t)u=s.pre;else if(a)u=s.post;else if(!s.pre&&!s.post){var l=e.l-Math.round(1e3*s.startTime)/1e3,d=1;e.M.allowStartInMiddleOfInterstitial&&s.endTime&&s.endTime!=1/0&&(d=s.endTime-s.startTime),(l>0||0==l&&0==e.l)&&(l<=d||!s.canJump)&&(u=!(null==n&&e.B&&!e.B.pre&&!e.B.post&&e.B.startTime>=s.startTime))}u&&(!e.B||s.startTime>=e.B.startTime)&&(r==(n||0)?i=s:i&&!s.canJump&&Math.round(1e3*s.startTime)/1e3-Math.round(1e3*i.startTime)/1e3>.001&&(i=s,r=0),r++)}}return i}function Cp(t,n,r,i,a,o){o=void 0===o?0:o,t.B=n,Ap(t),t.u||!t.m||t.h.parentElement||t.m.appendChild(t.h),1==i&&1==r&&(r=Array.from(t.H).filter(function(e){return n.pre?e.pre==n.pre:n.post?e.post==n.post:Math.abs(e.startTime-n.startTime)<.001}).length),n.once&&(o++,t.H.delete(n),Sp(t),n.overlay||_p(t)),n.mimeType&&(n.mimeType.startsWith("image/")||"text/html"===n.mimeType)?n.overlay?function(t,n,r,i,a){function o(){t.o&&(t.o.stop(),t.o=null),t.m.removeChild(l),Rp(t,n),Bp(t,"ad-stopped"),t.j.Qa();var e=Ip(t,n.pre,i-a);e?Cp(t,e,r,++i,Date.now(),a):t.J=!1}t.J=!0;var s=n.overlay,u="text/html"==n.mimeType?"iframe":"img",l=document.createElement(u);l.style.objectFit="contain",l.style.position="absolute",l.style.border="none",Mp(t,n);var d=new Tp(n,r,i);Bp(t,"ad-impression"),Bp(t,"ad-started",(new Map).set("ad",d)),"iframe"==u?l.src=n.uri:(l.src=n.uri,l.onerror=function(e){Bp(t,"ad-error",(new Map).set("originalEvent",e)),o()}),d=s.viewport;var c=s.topLeft;s=s.size,0==d.x&&0==d.y?(l.width=n.overlay.size.x,l.height=n.overlay.size.y,l.style.bottom="10%",l.style.left="0",l.style.right="0",l.style.width="100%",n.overlay.size.y||"iframe"!=u||(l.style.height="auto")):(l.style.height=s.y/d.y*100+"%",l.style.left=c.x/d.x*100+"%",l.style.top=c.y/d.y*100+"%",l.style.width=s.x/d.x*100+"%"),t.m.appendChild(l);var h=Date.now();t.o&&t.o.stop(),t.o=new Rr(function(){n.playoutLimit&&(Date.now()-h)/1e3>n.playoutLimit||n.endTime&&t.g.currentTime>n.endTime?(Bp(t,"ad-complete"),o()):t.g.currentTime<n.startTime&&(Bp(t,"ad-skipped"),o())}),n.playoutLimit&&!n.endTime?t.o.ka(n.playoutLimit):n.endTime&&t.o.Ea(.025),t.j.D(t.g,"seeked",function(){var e=t.g.currentTime;(e<n.startTime||n.endTime&&e>n.endTime)&&(t.o&&t.o.stop(),Bp(t,"ad-skipped"),o())}),n.clickThroughUrl&&t.j.D(l,"click",function(){n.clickThroughUrl&&e.open(n.clickThroughUrl,"_blank")})}(t,n,r,i,o):K("Unsupported interstitial",n):t.u&&n.overlay?K("Unsupported interstitial",n):function(t,n,r,i,a,o){var s,u,l,d,c,h,p,f,g,m,v,y,b,S,k,I,C,M,R,_,D;P(function(L){switch(L.g){case 1:if(s=Date.now(),t.J=!0,u=!1,l=function(){if(!t.u&&!n.overlay&&null==n.resumeOffset)if(n.timelineRange&&n.endTime&&n.endTime!=1/0)t.g.currentTime!=n.endTime&&(t.g.currentTime=n.endTime);else{var e=Date.now();t.g.currentTime+=(e-a)/1e3,a=e}},d=function(e){var s,u;return P(function(d){if(1==d.g){if(l(),s=Ip(t,n.pre,i-o),e&&n.groupId)for(;s&&s.groupId==n.groupId;)i++,s=Ip(t,n.pre,i-o);return t.o&&(!n.groupId||s&&s.groupId!=n.groupId)&&(t.o.stop(),t.o=null),Rp(t,n),s&&!s.overlay?d.A(2):(n.post&&(t.l=null,t.B=null),t.u?x(d,t.i.detach(),4):x(d,t.i.Cc(),4))}2!=d.g&&(t.u&&(null==(u=n.resumeOffset)&&(u=n.timelineRange&&n.endTime&&n.endTime!=1/0?n.endTime-(t.l||0):(Date.now()-a)/1e3),Bp(t,"ad-content-resume-requested",(new Map).set("offset",u))),Bp(t,"ad-stopped"),t.j.Qa(),t.J=!1,t.u?_p(t):(t.h.style.display="none",l(),t.g.ended||t.g.play())),Ap(t),s&&(Bp(t,"ad-stopped"),t.j.Qa(),Cp(t,s,r,++i,a,o)),T(d)})},c=function(e){return P(function(n){return u?n.return():(u=!0,Bp(t,"ad-error",(new Map).set("originalEvent",e)),x(n,d(!1),0))})},h=function(){return P(function(e){if(1==e.g)return u?e.return():(u=!0,x(e,d(!1),2));Bp(t,"ad-complete"),T(e)})},t.$=function(){return P(function(e){return u?e.return():(u=!0,Bp(t,"ad-skipped"),x(e,d(!0),0))})},p=new xp(t.h,n,t.$,r,i,!t.u),t.u||(p.setMuted(t.g.muted),p.setVolume(t.g.volume)),Bp(t,"ad-started",(new Map).set("ad",p)),(f=p.canSkipNow())&&Bp(t,"ad-skip-state-changed"),t.j.Aa(t.i,"error",c),t.j.D(t.h,"timeupdate",function(){if(t.h.duration){var e=p.canSkipNow();f!=e&&p.getRemainingTime()>0&&p.getDuration()>0&&Bp(t,"ad-skip-state-changed"),f=e,!t.u&&!n.overlay&&null==n.resumeOffset&&n.timelineRange&&n.endTime&&n.endTime!=1/0&&t.g.currentTime!=n.endTime&&t.C.Ra().end>=n.endTime&&(t.g.currentTime=n.endTime)}}),t.j.Aa(t.i,"firstquartile",function(){l(),Bp(t,"ad-first-quartile")}),t.j.Aa(t.i,"midpoint",function(){l(),Bp(t,"ad-midpoint")}),t.j.Aa(t.i,"thirdquartile",function(){l(),Bp(t,"ad-third-quartile")}),t.j.Aa(t.i,"complete",h),t.j.D(t.h,"play",function(){Bp(t,"ad-resumed")}),t.j.D(t.h,"pause",function(){var e=t.i.getConfiguration();t.h.currentTime>=e.playRangeEnd?h():Bp(t,"ad-paused")}),t.j.D(t.h,"volumechange",function(){t.h.muted?Bp(t,"ad-muted"):Bp(t,"ad-volume-changed")}),n.clickThroughUrl&&(g=t.m||t.h,t.j.D(g,"click",function(){n.clickThroughUrl&&(p.isPaused()||p.pause(),e.open(n.clickThroughUrl,"_blank"))})),!t.u||1!=i){L.A(2);break}return Bp(t,"ad-content-pause-requested",(new Map).set("saveLivePosition",!0)),m=new Ci,v=function(e){return P(function(n){if(1==n.g)return"detach"!=e.state?n.A(0):Np()?x(n,new Promise(function(e){return new Rr(e).ka(.1)}),3):n.A(3);m.resolve(),t.j.Ma(t.C,"onstatechange",v),T(n)})},t.j.D(t.C,"onstatechange",v),x(L,m,2);case 2:return Mp(t,n),t.u||(t.h.style.display="",n.overlay?(t.h.loop=n.loop,y=n.overlay.viewport,b=n.overlay.topLeft,S=n.overlay.size,t.h.style.height=S.y/y.y*100+"%",t.h.style.left=b.x/y.x*100+"%",t.h.style.top=b.y/y.y*100+"%",t.h.style.width=S.x/y.x*100+"%"):(t.g.pause(),null!=n.resumeOffset&&0!=n.resumeOffset&&(t.g.currentTime+=n.resumeOffset),t.h.loop=!1,t.h.style.height="100%",t.h.style.left="0",t.h.style.top="0",t.h.style.width="100%")),w(L,4),Pp(t),n.startTime&&n.endTime&&n.endTime!=1/0&&n.startTime!=n.endTime&&(k=n.endTime-n.startTime)>0&&t.i.configure("playRangeEnd",k),n.playoutLimit&&!t.o&&(t.o=new Rr(function(){t.$()}).ka(n.playoutLimit),t.i.configure("playRangeEnd",n.playoutLimit)),x(L,t.i.Wb(t.h),6);case 6:return I=null,t.M.allowStartInMiddleOfInterstitial&&null!=t.l&&(C=t.l-n.startTime,Math.abs(C)>.25&&(I=C)),t.F.has(n)?x(L,t.F.get(n),10):x(L,t.i.load(n.uri,I,n.mimeType||void 0),8);case 10:return M=L.h,t.F.delete(n),x(L,M?t.i.load(M):t.i.load(n.uri,I,n.mimeType||void 0),8);case 8:n.overlay&&t.g.paused?t.h.pause():t.h.play(),R=(Date.now()-s)/1e3,Bp(t,"ads-loaded",(new Map).set("loadTime",R)),t.u&&t.g.play(),n.overlay&&(n.pre||n.post||t.C.W()&&!(n.startTime>0)||(_=function(){var e=t.g.currentTime-n.startTime;Math.abs(e-t.h.currentTime)>.1&&(t.h.currentTime=e)},t.j.Aa(t.h,"playing",_),t.j.D(t.g,"seeking",_)),t.j.D(t.g,"seeked",function(){var e=t.g.currentTime;(e<n.startTime||n.endTime&&e>n.endTime)&&t.$()})),A(L,0);break;case 4:if(D=E(L),!t.J)return L.return();c(D),T(L)}})}(t,n,r,i,a,o)}function Mp(e,t){if(t.displayOnBackground&&(e.g.style.zIndex="1"),null!=t.currentVideo){var n=t.currentVideo;e.g.style.transformOrigin="top left";var r=!0,i=[],a=n.topLeft.x/n.viewport.x*100;a>0&&a<=100&&(i.push("translateX("+a+"%)"),r=!1),(a=n.topLeft.y/n.viewport.y*100)>0&&a<=100&&(i.push("translateY("+a+"%)"),r=!1),(a=n.size.x/n.viewport.x)<1&&i.push("scaleX("+a+")"),n=n.size.y/n.viewport.y,a<1&&i.push("scaleY("+n+")"),i.length&&(e.g.style.transform=i.join(" ")),r&&(e.g.style.transition="transform 250ms")}e.m&&(t.clickThroughUrl?(e.m.setAttribute("ad-active","true"),e.m.style.pointerEvents=""):e.m.style.pointerEvents="none",t.background&&(e.m.style.background=t.background)),e.G&&(e.G.style.background=t.overlay?"":"rgb(0, 0, 0)")}function Rp(e,t){t&&!t.displayOnBackground||(e.g.style.zIndex=""),t&&null==t.currentVideo||(e.g.style.transformOrigin="",e.g.style.transition="",e.g.style.transform=""),e.m&&(e.m.removeAttribute("ad-active"),e.m.style.pointerEvents="",!t||t.background)&&(e.m.style.background=""),e.G&&(e.G.style.background="")}function _p(e){for(var t=[],n=g(e.H),r=n.next(),i={};!r.done;i={Bc:void 0},r=n.next())(r=r.value).overlay||(i.Bc={start:r.startTime,end:null},r.pre?(i.Bc.start=0,i.Bc.end=null):r.post?(i.Bc.start=-1,i.Bc.end=null):r.timelineRange&&(i.Bc.end=r.endTime),t.find(function(e){return function(t){return e.Bc.start==t.start&&e.Bc.end==t.end}}(i))||t.push(i.Bc));Bp(e,"ad-cue-points-changed",(new Map).set("cuepoints",t))}function Pp(e){e.i.configure(e.C.ii()),e.i.configure("ads.disableHLSInterstitial",!0),e.i.configure("ads.disableDASHInterstitial",!0),e.i.configure("playRangeEnd",1/0),Gi(e.C.Zb(),e.i.Zb())}function Dp(e,t,n){var r,i;return P(function(a){return 1==a.g?(r=zi([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),x(a,e.C.Zb().request(7,r,n).promise,2)):(i=a.h,a.return(i.data))})}function Lp(e){return!(e=e.mimeType)||!e.startsWith("image/")&&"text/html"!==e}function Np(){var e=oe().Oa();return"TV"==e||"CONSOLE"==e||"CAST"==e}function Op(e,t){if(!(e.K.has(t)||e.M&&!e.M.allowPreloadOnDomElements)){var n=function(e){var t=document.createElement("link");return t.rel="preload",t.href=e,t.as="image",document.head.appendChild(t),t},r=[];if(t.background){var i=t.background.match(/url\(('|")?([^'"()]+)('|")\)?/);i&&r.push(n(i[2]))}t.mimeType&&t.mimeType.startsWith("image/")&&r.push(n(t.uri)),e.K.set(t,r)}}function Up(e,t){if(e.K.has(t)){for(var n=e.K.get(t),r=(n=g(n)).next();!r.done;r=n.next())(r=r.value).parentNode.removeChild(r);e.K.delete(t)}}function Bp(e,t,n){e.va(new Ni(t,n))}function jp(e,t,n,r,i){this.h=e,this.j=zt(this.h.skipOffset),this.g=i,this.i=t,this.l=n,this.o=r,this.m=!1}function Fp(e,t,n,r){this.C=e,this.K=t,this.h=n,this.l=null,this.R=NaN,this.i=r,this.J=!1,this.B=null,this.j=[],this.N=[],this.M=this.F=this.g=null,this.G=new Map,this.m=[],this.u=[],this.H="",this.O=!0,this.I="",this.o=new ne}function Vp(e,t){var n,r,i,a,o,s,u,l;P(function(d){return 1==d.g?t.staticResource?(n=Hp(t),e.G.get(n)?d.return():(r={type:9},i=zi([t.staticResource],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),a=e.K.request(7,i,r),w(d,2),e.G.set(n,[]),x(d,a.promise,4))):d.return():2!=d.g?(o=d.h,s=Ye(o.data),u=JSON.parse(s),l=u.apps,e.G.set(n,l),A(d,0)):(E(d),e.G.delete(n),void T(d))})}function Hp(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function Gp(e){var t=e.h.currentTime;if(0!=t&&null==e.B){for(var n,r,i=g(e.j),a=i.next();!a.done;a=i.next())for(var o=g((a=a.value).ads),s=o.next();!s.done;s=o.next())if(s=s.value,r){if(s.startTimeInSeconds<t&&s.startTimeInSeconds>r.startTimeInSeconds+r.durationInSeconds){r=s,n=a;break}}else s.startTimeInSeconds<t&&(r=s,n=a);n&&r&&!e.N.includes(r.adId)&&(e.B=t,e.h.currentTime=n.startTimeInSeconds)}}function zp(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var r=e.F,i=r.startTimeInSeconds+.5*r.durationInSeconds,a=r.startTimeInSeconds+.75*r.durationInSeconds;t>=r.startTimeInSeconds+.25*r.durationInSeconds&&!e.u.includes("firstQuartile")?(e.u.push("firstQuartile"),Kp(e,"firstQuartile")):t>=i&&!e.u.includes("midpoint")?(e.u.push("midpoint"),Kp(e,"midpoint")):t>=a&&!e.u.includes("thirdQuartile")&&(e.u.push("thirdQuartile"),Kp(e,"thirdQuartile")),r=e.g.getRemainingTime(),i=e.g.getDuration(),e.g.canSkipNow()&&r>0&&i>0&&Kp(e,"skipStateChanged"),i>0&&(r<=0||r>i)&&Xp(e)}if(!e.g||!e.g.isLinear()){e:for(r=g(e.j),i=r.next();!i.done&&(i=i.value,!e.g||!e.g.isLinear());i=r.next())for(a=0;a<i.ads.length;a++){var o=i.ads[a],s=o.startTimeInSeconds+o.durationInSeconds;if(o.startTimeInSeconds<=t&&s>t){if(e.N.includes(o.adId)){if(e.h.ended)continue;e.h.currentTime=s;break e}Xp(e),e.M=i,e.g=new jp(o,a+1,i.ads.length,!0,e.h),e.F=o,0===a&&Kp(e,"breakStart"),Wp(e);break}}if(!e.g)for(i=(r=g(e.j)).next();!i.done&&(i=i.value,!e.g);i=r.next())for(a=0;a<i.nonLinearAdsList.length;a++)if((o=i.nonLinearAdsList[a]).nonLinearAdList.length){s=i.startTimeInSeconds;var u=e.G.get(Hp(o.nonLinearAdList[0]));if(s<=t&&u&&u.length){Xp(e),s=e;for(var l=(u=g(u)).next();!l.done;l=u.next())if((l=l.value).data.source.length){var d=document.createElement("img");d.src=l.data.source[0].url,d.style.top=(l.placeholder.top||0)+"%",d.style.height=100-(l.placeholder.top||0)+"%",d.style.left=(l.placeholder.left||0)+"%",d.style.maxWidth=100-(l.placeholder.left||0)+"%",d.style.objectFit="contain",d.style.position="absolute",s.C.appendChild(d)}e.M=i,e.g=new jp(o,a+1,i.ads.length,!1,e.h),e.F=o,0===a&&Kp(e,"breakStart"),Wp(e);break}}n&&!e.g&&(t=e.h.currentTime,e.B&&e.B>t&&(e.h.currentTime=e.B),e.B=null)}}}function Xp(e){if(e.g){for(;e.C.lastChild;)e.C.removeChild(e.C.firstChild);e.J||e.N.push(e.F.adId);var t=e.g.m;Kp(e,void 0!==t&&t?"skip":"complete");for(var n=(t=g(e.m)).next();!n.done;n=t.next())n=n.value,e.o.Ma(n.target,n.type,n.listener);e.m=[],e.u=[],(t=e.g.getPositionInSequence())===(n=e.g.getSequenceLength())&&Kp(e,"breakEnd"),e.g=null,e.F=null,e.M=null}}function Wp(e){var t=!1;e.h.paused?t=!0:(Kp(e,"impression"),Kp(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&Kp(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||Kp(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(Kp(e,"impression"),Kp(e,"start"),t=!1):Kp(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){Kp(e,"pause")}});for(var n=g(e.m),r=n.next();!r.done;r=n.next())r=r.value,e.o.D(r.target,r.type,r.listener)}function Kp(e,t){var n=e.F.trackingEvents.find(function(e){return e.eventType==t});if(n||(n=e.M.adBreakTrackingEvents.find(function(e){return e.eventType==t})),n)for(var r={type:10},i=(n=g(n.beaconUrls)).next();!i.done;i=n.next())(i=i.value)&&""!=i&&((i=zi([i],Ii())).method="POST",e.K.request(7,i,r));switch(t){case"impression":e.i(new Ni("ad-impression"));break;case"start":e.i(new Ni("ad-started",(new Map).set("ad",e.g)));break;case"mute":e.i(new Ni("ad-muted"));break;case"unmute":e.i(new Ni("ad-volume-changed"));break;case"resume":e.i(new Ni("ad-resumed"));break;case"pause":e.i(new Ni("ad-paused"));break;case"firstQuartile":e.i(new Ni("ad-first-quartile"));break;case"midpoint":e.i(new Ni("ad-midpoint"));break;case"thirdQuartile":e.i(new Ni("ad-third-quartile"));break;case"complete":e.i(new Ni("ad-complete")),e.i(new Ni("ad-stopped"));break;case"skip":e.i(new Ni("ad-skipped")),e.i(new Ni("ad-stopped"));break;case"breakStart":e.C.setAttribute("ad-active","true");break;case"breakEnd":e.C.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Ni("ad-skip-state-changed"))}}function qp(e,t){this.g=e,this.i=null,this.h=t}function Yp(e,t,n,r){var i=this;this.u=e,this.l=t,this.j=null,this.G=NaN,this.i=r,this.H=!1,this.B=this.m=this.o=null,this.C="",this.F=[],this.h=new ne,(e=new google.ima.dai.api.UiSettings).setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.u,e),this.i(new Ni("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(e){!function(e,t){e.i(new Ni("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.G))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.H||e.h.D(e.l,"seeked",function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}})}(i,e)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){i.C.length?i.j.resolve(i.C):i.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),i.j=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(e){e=e.getAd(),i.m=new qp(e,i.l),i.B&&(i.m.i=i.B),i.i(new Ni("ad-started",(new Map).set("ad",i.m))),i.u.setAttribute("ad-active","true")}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){i.u.removeAttribute("ad-active");var e=i.l.currentTime;i.o&&i.o>e&&(i.l.currentTime=i.o,i.o=null)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(e){i.B=e.getStreamData().adProgressData,i.m&&(i.m.i=i.B)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){i.i(new Ni("ad-first-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){i.i(new Ni("ad-midpoint"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){i.i(new Ni("ad-third-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){i.i(new Ni("ad-complete")),i.i(new Ni("ad-stopped")),i.u.removeAttribute("ad-active"),i.m=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){i.i(new Ni("ad-skipped")),i.i(new Ni("ad-stopped"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(e){var t=e.getStreamData();e=[];for(var n=(t=g(t.cuepoints)).next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});i.F=e,i.i(new Ni("ad-cue-points-changed",(new Map).set("cuepoints",e)))})}function $p(){Bi.call(this),this.h=this.i=this.j=this.g=null,this.m=new dp,this.o=navigator.language,this.l=null}function Jp(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;var n=t.ad;n&&!n.isLinear()&&e.m.j++;break;case"ad-complete":e.m.l++;break;case"ad-skipped":e.m.m++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}function Qp(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(e=t instanceof Ni,t instanceof Event||e){var n={};for(i in t){var r=t[i];r&&"object"==typeof r?"detail"==i?n[i]=r:r instanceof Event||r instanceof Ni?n[i]={__type__:"Event",event:Qp(r)}:e&&Array.isArray(r)&&(n[i]=r):i in Event||(n[i]=r)}return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(n=(e=g(Object.getOwnPropertyNames(t))).next();!n.done;n=e.next())i.add(n.value);for(e={},n=(i=g(i)).next();!n.done;n=i.next())e[n=n.value]=t[n];t={__type__:"Error",contents:e}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},e=(t=g(Jo(t))).next();!e.done;e=t.next())n=(e=e.value).end,i.start.push(e.start),i.end.push(n);t=i}else t=ArrayBuffer.isView(t)&&1===t.BYTES_PER_ELEMENT?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:t<0?"-Infinity":"Infinity":t;return t}})}function Zp(e){return JSON.parse(e,function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t&&"object"==typeof t&&"Event"==t.__type__?Zp(t.event):t;return n})}(i=hp.prototype).needsSkipUI=function(){return!1},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!0},i.getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return this.g.getSkipTimeOffset()>=0},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.m.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){this.h.resize(e,t)},i.setMuted=function(e){(this.m.muted=e)?(this.j=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.j)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},V("shaka.ads.ClientSideAd",hp),hp.prototype.release=hp.prototype.release,hp.prototype.getPodIndex=hp.prototype.getPodIndex,hp.prototype.getTimeOffset=hp.prototype.getTimeOffset,hp.prototype.getMediaUrl=hp.prototype.getMediaUrl,hp.prototype.getAdvertiserName=hp.prototype.getAdvertiserName,hp.prototype.getCreativeAdId=hp.prototype.getCreativeAdId,hp.prototype.getAdId=hp.prototype.getAdId,hp.prototype.getVastAdId=hp.prototype.getVastAdId,hp.prototype.getVastMediaWidth=hp.prototype.getVastMediaWidth,hp.prototype.getVastMediaHeight=hp.prototype.getVastMediaHeight,hp.prototype.getVastMediaBitrate=hp.prototype.getVastMediaBitrate,hp.prototype.getDescription=hp.prototype.getDescription,hp.prototype.getTitle=hp.prototype.getTitle,hp.prototype.getPositionInSequence=hp.prototype.getPositionInSequence,hp.prototype.getSequenceLength=hp.prototype.getSequenceLength,hp.prototype.setMuted=hp.prototype.setMuted,hp.prototype.resize=hp.prototype.resize,hp.prototype.isLinear=hp.prototype.isLinear,hp.prototype.isMuted=hp.prototype.isMuted,hp.prototype.setVolume=hp.prototype.setVolume,hp.prototype.getVolume=hp.prototype.getVolume,hp.prototype.play=hp.prototype.play,hp.prototype.pause=hp.prototype.pause,hp.prototype.skip=hp.prototype.skip,hp.prototype.canSkipNow=hp.prototype.canSkipNow,hp.prototype.getTimeUntilSkippable=hp.prototype.getTimeUntilSkippable,hp.prototype.isSkippable=hp.prototype.isSkippable,hp.prototype.isPaused=hp.prototype.isPaused,hp.prototype.getRemainingTime=hp.prototype.getRemainingTime,hp.prototype.getMinSuggestedDuration=hp.prototype.getMinSuggestedDuration,hp.prototype.getDuration=hp.prototype.getDuration,hp.prototype.isUsingAnotherMediaElement=hp.prototype.isUsingAnotherMediaElement,hp.prototype.hasCustomClick=hp.prototype.hasCustomClick,hp.prototype.isClientRendering=hp.prototype.isClientRendering,hp.prototype.needsSkipUI=hp.prototype.needsSkipUI,V("shaka.ads.Utils",pp),pp.ADS_LOADED="ads-loaded",pp.AD_STARTED="ad-started",pp.AD_FIRST_QUARTILE="ad-first-quartile",pp.AD_MIDPOINT="ad-midpoint",pp.AD_THIRD_QUARTILE="ad-third-quartile",pp.AD_COMPLETE="ad-complete",pp.AD_STOPPED="ad-stopped",pp.AD_SKIPPED="ad-skipped",pp.AD_VOLUME_CHANGED="ad-volume-changed",pp.AD_MUTED="ad-muted",pp.AD_PAUSED="ad-paused",pp.AD_RESUMED="ad-resumed",pp.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",pp.CUEPOINTS_CHANGED="ad-cue-points-changed",pp.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",pp.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",pp.AD_CLICKED="ad-clicked",pp.AD_PROGRESS="ad-progress",pp.AD_BUFFERING="ad-buffering",pp.AD_IMPRESSION="ad-impression",pp.AD_DURATION_CHANGED="ad-duration-changed",pp.AD_CLOSED="ad-closed",pp.AD_LOADED="ad-loaded",pp.ALL_ADS_COMPLETED="all-ads-completed",pp.AD_LINEAR_CHANGED="ad-linear-changed",pp.AD_METADATA="ad-metadata",pp.AD_RECOVERABLE_ERROR="ad-recoverable-error",pp.AD_ERROR="ad-error",pp.AD_BREAK_READY="ad-break-ready",pp.AD_INTERACTION="ad-interaction",pp.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",pp.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",pp.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",mp.prototype.configure=function(e){this.o=e},mp.prototype.stop=function(){this.g&&this.g.stop(),this.u&&ts(this.u)},mp.prototype.release=function(){this.stop(),this.B&&this.B.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.F.destroy()},(i=xp.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return null!=this.h.clickThroughUrl},i.isUsingAnotherMediaElement=function(){return this.u},i.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return this.i&&null!=this.l?this.getDuration()-this.getRemainingTime()<this.j+this.l:this.i},i.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},i.canSkipNow=function(){return this.i&&0==this.getTimeUntilSkippable()},i.skip=function(){this.canSkipNow()&&this.B()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return null==this.C},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.o},i.getPositionInSequence=function(){return this.m},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return""},i.getAdId=function(){return this.h.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.h.uri},i.getTimeOffset=function(){return this.h.pre?0:this.h.post?-1:this.h.startTime},i.getPodIndex=function(){return 0},i.release=function(){this.g=null},V("shaka.ads.InterstitialAd",xp),xp.prototype.release=xp.prototype.release,xp.prototype.getPodIndex=xp.prototype.getPodIndex,xp.prototype.getTimeOffset=xp.prototype.getTimeOffset,xp.prototype.getMediaUrl=xp.prototype.getMediaUrl,xp.prototype.getAdvertiserName=xp.prototype.getAdvertiserName,xp.prototype.getCreativeAdId=xp.prototype.getCreativeAdId,xp.prototype.getAdId=xp.prototype.getAdId,xp.prototype.getVastAdId=xp.prototype.getVastAdId,xp.prototype.getVastMediaWidth=xp.prototype.getVastMediaWidth,xp.prototype.getVastMediaHeight=xp.prototype.getVastMediaHeight,xp.prototype.getVastMediaBitrate=xp.prototype.getVastMediaBitrate,xp.prototype.getDescription=xp.prototype.getDescription,xp.prototype.getTitle=xp.prototype.getTitle,xp.prototype.getPositionInSequence=xp.prototype.getPositionInSequence,xp.prototype.getSequenceLength=xp.prototype.getSequenceLength,xp.prototype.setMuted=xp.prototype.setMuted,xp.prototype.resize=xp.prototype.resize,xp.prototype.isLinear=xp.prototype.isLinear,xp.prototype.isMuted=xp.prototype.isMuted,xp.prototype.setVolume=xp.prototype.setVolume,xp.prototype.getVolume=xp.prototype.getVolume,xp.prototype.play=xp.prototype.play,xp.prototype.pause=xp.prototype.pause,xp.prototype.skip=xp.prototype.skip,xp.prototype.canSkipNow=xp.prototype.canSkipNow,xp.prototype.getTimeUntilSkippable=xp.prototype.getTimeUntilSkippable,xp.prototype.isSkippable=xp.prototype.isSkippable,xp.prototype.isPaused=xp.prototype.isPaused,xp.prototype.getRemainingTime=xp.prototype.getRemainingTime,xp.prototype.getMinSuggestedDuration=xp.prototype.getMinSuggestedDuration,xp.prototype.getDuration=xp.prototype.getDuration,xp.prototype.isUsingAnotherMediaElement=xp.prototype.isUsingAnotherMediaElement,xp.prototype.hasCustomClick=xp.prototype.hasCustomClick,xp.prototype.isClientRendering=xp.prototype.isClientRendering,xp.prototype.needsSkipUI=xp.prototype.needsSkipUI,(i=Tp.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return null!=this.g.clickThroughUrl},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return-1},i.isPaused=function(){return!1},i.isSkippable=function(){return!1},i.getTimeUntilSkippable=function(){return 0},i.canSkipNow=function(){return!1},i.skip=function(){},i.pause=function(){},i.play=function(){},i.getVolume=function(){return 1},i.setVolume=function(){},i.isMuted=function(){return!1},i.isLinear=function(){return this.i},i.resize=function(){},i.setMuted=function(){},i.getSequenceLength=function(){return this.j},i.getPositionInSequence=function(){return this.h},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.g.uri},i.getTimeOffset=function(){return this.g.pre?0:this.g.post?-1:this.g.startTime},i.getPodIndex=function(){return 0},i.release=function(){},V("shaka.ads.InterstitialStaticAd",Tp),Tp.prototype.release=Tp.prototype.release,Tp.prototype.getPodIndex=Tp.prototype.getPodIndex,Tp.prototype.getTimeOffset=Tp.prototype.getTimeOffset,Tp.prototype.getMediaUrl=Tp.prototype.getMediaUrl,Tp.prototype.getAdvertiserName=Tp.prototype.getAdvertiserName,Tp.prototype.getCreativeAdId=Tp.prototype.getCreativeAdId,Tp.prototype.getAdId=Tp.prototype.getAdId,Tp.prototype.getVastAdId=Tp.prototype.getVastAdId,Tp.prototype.getVastMediaWidth=Tp.prototype.getVastMediaWidth,Tp.prototype.getVastMediaHeight=Tp.prototype.getVastMediaHeight,Tp.prototype.getVastMediaBitrate=Tp.prototype.getVastMediaBitrate,Tp.prototype.getDescription=Tp.prototype.getDescription,Tp.prototype.getTitle=Tp.prototype.getTitle,Tp.prototype.getPositionInSequence=Tp.prototype.getPositionInSequence,Tp.prototype.getSequenceLength=Tp.prototype.getSequenceLength,Tp.prototype.setMuted=Tp.prototype.setMuted,Tp.prototype.resize=Tp.prototype.resize,Tp.prototype.isLinear=Tp.prototype.isLinear,Tp.prototype.isMuted=Tp.prototype.isMuted,Tp.prototype.setVolume=Tp.prototype.setVolume,Tp.prototype.getVolume=Tp.prototype.getVolume,Tp.prototype.play=Tp.prototype.play,Tp.prototype.pause=Tp.prototype.pause,Tp.prototype.skip=Tp.prototype.skip,Tp.prototype.canSkipNow=Tp.prototype.canSkipNow,Tp.prototype.getTimeUntilSkippable=Tp.prototype.getTimeUntilSkippable,Tp.prototype.isSkippable=Tp.prototype.isSkippable,Tp.prototype.isPaused=Tp.prototype.isPaused,Tp.prototype.getRemainingTime=Tp.prototype.getRemainingTime,Tp.prototype.getMinSuggestedDuration=Tp.prototype.getMinSuggestedDuration,Tp.prototype.getDuration=Tp.prototype.getDuration,Tp.prototype.isUsingAnotherMediaElement=Tp.prototype.isUsingAnotherMediaElement,Tp.prototype.hasCustomClick=Tp.prototype.hasCustomClick,Tp.prototype.isClientRendering=Tp.prototype.isClientRendering,Tp.prototype.needsSkipUI=Tp.prototype.needsSkipUI,(i=wp.prototype).configure=function(e){this.M=e,Ap(this)},i.stop=function(){if(this.j&&this.j.Qa(),this.ma.clear(),this.T.clear(),this.H.clear(),this.i.qg(),this.F.size)for(var e=Array.from(this.F.values()),t=(e=g(e)).next();!t.done;t=e.next())(t=t.value)&&t.then(function(e){e&&e.destroy()});if(this.F.clear(),this.K.size)for(t=(e=g(e=Array.from(this.K.keys()))).next();!t.done;t=e.next())Up(this,t.value);this.K.clear(),this.i.detach(),this.J=!1,this.B=this.l=null,this.u=!0,this.h=this.g,this.G=null,Rp(this),Sp(this),this.m&&ts(this.m),this.o&&(this.o.stop(),this.o=null)},i.release=function(){this.stop(),this.I&&this.I.release(),this.j&&this.j.release(),this.R&&(this.R.stop(),this.R=null),this.N&&(this.N.stop(),this.N=null),this.i.destroy()},i.td=function(){return this.i},i.addAdUrlInterstitial=function(e){var t,n,r,i,a,o,s,u,l,d=this;return P(function(c){if(1==c.g)return x(c,Dp(d,e,t={type:12}),2);if(3!=c.g){if(n=c.h,!(r=$t(n,"VAST,vmap:VMAP")))throw new Ke(2,10,10007);if(i=[],"VAST"==r.tagName)return i=fp(r,d.l),c.A(3);if("vmap:VMAP"!=r.tagName)return c.A(3);for(a=function(e){var n,r;return P(function(a){if(1==a.g)return x(a,Dp(d,e.uri,t),2);if(n=a.h,!(r=$t(n,"VAST")))throw new Ke(2,10,10007);i.push.apply(i,m(fp(r,e.time))),T(a)})},o=[],s=g(function(e){for(var t=[],n=(e=g(tn(e,"vmap:AdBreak"))).next();!n.done;n=e.next()){var r=n.value,i=r.attributes.timeOffset;i&&(n=null,n="start"==i?null:"end"==i?1/0:zt(i),(r=on(r,"vmap:AdSource"))&&(r=on(r,"vmap:AdTagURI"))&&(r=nn(r))&&t.push({time:n,uri:r}))}return t}(r)),u=s.next();!u.done;u=s.next())l=u.value,o.push(a(l));return o.length?x(c,Promise.all(o),3):c.A(3)}kp(d,i),T(c)})},(i=jp.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return"number"==typeof this.j},i.getTimeUntilSkippable=function(){if("number"!=typeof this.j)return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.o},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l?this.l:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return this.h.vastAdId||""},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.l=this.i=this.g=this.h=null},V("shaka.ads.MediaTailorAd",jp),jp.prototype.release=jp.prototype.release,jp.prototype.getPodIndex=jp.prototype.getPodIndex,jp.prototype.getTimeOffset=jp.prototype.getTimeOffset,jp.prototype.getMediaUrl=jp.prototype.getMediaUrl,jp.prototype.getAdvertiserName=jp.prototype.getAdvertiserName,jp.prototype.getCreativeAdId=jp.prototype.getCreativeAdId,jp.prototype.getAdId=jp.prototype.getAdId,jp.prototype.getVastAdId=jp.prototype.getVastAdId,jp.prototype.getVastMediaWidth=jp.prototype.getVastMediaWidth,jp.prototype.getVastMediaHeight=jp.prototype.getVastMediaHeight,jp.prototype.getVastMediaBitrate=jp.prototype.getVastMediaBitrate,jp.prototype.getDescription=jp.prototype.getDescription,jp.prototype.getTitle=jp.prototype.getTitle,jp.prototype.getPositionInSequence=jp.prototype.getPositionInSequence,jp.prototype.getSequenceLength=jp.prototype.getSequenceLength,jp.prototype.setMuted=jp.prototype.setMuted,jp.prototype.resize=jp.prototype.resize,jp.prototype.isLinear=jp.prototype.isLinear,jp.prototype.isMuted=jp.prototype.isMuted,jp.prototype.setVolume=jp.prototype.setVolume,jp.prototype.getVolume=jp.prototype.getVolume,jp.prototype.play=jp.prototype.play,jp.prototype.pause=jp.prototype.pause,jp.prototype.skip=jp.prototype.skip,jp.prototype.canSkipNow=jp.prototype.canSkipNow,jp.prototype.getTimeUntilSkippable=jp.prototype.getTimeUntilSkippable,jp.prototype.isSkippable=jp.prototype.isSkippable,jp.prototype.isPaused=jp.prototype.isPaused,jp.prototype.getRemainingTime=jp.prototype.getRemainingTime,jp.prototype.getMinSuggestedDuration=jp.prototype.getMinSuggestedDuration,jp.prototype.getDuration=jp.prototype.getDuration,jp.prototype.isUsingAnotherMediaElement=jp.prototype.isUsingAnotherMediaElement,jp.prototype.hasCustomClick=jp.prototype.hasCustomClick,jp.prototype.isClientRendering=jp.prototype.isClientRendering,jp.prototype.needsSkipUI=jp.prototype.needsSkipUI,Fp.prototype.stop=function(){for(var e=g(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.Ma(t.target,t.type,t.listener);Xp(this),this.m=[],this.u=[],this.H="",this.O=!0,this.I="",this.B=null,this.j=[],this.N=[],this.G.clear()},Fp.prototype.release=function(){this.stop(),this.o&&this.o.release()},Fp.prototype.onManifestUpdated=function(e){this.J=e,""!=this.H&&(function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b;P(function(S){if(1==S.g)return r={type:8},i=zi([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),a=e.K.request(7,i,r),w(S,2),x(S,a.promise,4);if(2!=S.g){if(o=S.h,s=[],u=Ye(o.data),(l=JSON.parse(u)).avails.length>0){if(JSON.stringify(e.j)!=JSON.stringify(l.avails)){for(e.j=l.avails,d=g(e.j),c=d.next();!c.done;c=d.next())for(h=c.value,p=g(h.nonLinearAdsList),f=p.next();!f.done;f=p.next())for(m=f.value,v=g(m.nonLinearAdList),y=v.next();!y.done;y=v.next())b=y.value,Vp(e,b);s=e.getCuePoints(),e.i(new Ni("ad-cue-points-changed",(new Map).set("cuepoints",s)))}}else e.j.length&&e.i(new Ni("ad-cue-points-changed",(new Map).set("cuepoints",s))),Xp(e),e.j=[];return n&&(e.J||s.length>0)&&function(e){zp(e),e.J||(Gp(e),e.o.D(e.h,"seeked",function(){Gp(e)}),e.o.D(e.h,"ended",function(){Xp(e)})),e.o.D(e.h,"timeupdate",function(){zp(e)})}(e),A(S,0)}E(S),T(S)})}(this,this.H,this.O),this.O=!1)},Fp.prototype.getCuePoints=function(){for(var e=[],t=g(this.j),n=t.next();!n.done;n=t.next())for(var r=(n=g(n.value.ads)).next();!r.done;r=n.next())r=r.value,e.push({start:r.startTimeInSeconds,end:r.startTimeInSeconds+r.durationInSeconds});return e},(i=qp.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},V("shaka.ads.ServerSideAd",qp),qp.prototype.release=qp.prototype.release,qp.prototype.getPodIndex=qp.prototype.getPodIndex,qp.prototype.getTimeOffset=qp.prototype.getTimeOffset,qp.prototype.getMediaUrl=qp.prototype.getMediaUrl,qp.prototype.getAdvertiserName=qp.prototype.getAdvertiserName,qp.prototype.getCreativeAdId=qp.prototype.getCreativeAdId,qp.prototype.getAdId=qp.prototype.getAdId,qp.prototype.getVastAdId=qp.prototype.getVastAdId,qp.prototype.getVastMediaWidth=qp.prototype.getVastMediaWidth,qp.prototype.getVastMediaHeight=qp.prototype.getVastMediaHeight,qp.prototype.getVastMediaBitrate=qp.prototype.getVastMediaBitrate,qp.prototype.getDescription=qp.prototype.getDescription,qp.prototype.getTitle=qp.prototype.getTitle,qp.prototype.getPositionInSequence=qp.prototype.getPositionInSequence,qp.prototype.getSequenceLength=qp.prototype.getSequenceLength,qp.prototype.setMuted=qp.prototype.setMuted,qp.prototype.resize=qp.prototype.resize,qp.prototype.isLinear=qp.prototype.isLinear,qp.prototype.isMuted=qp.prototype.isMuted,qp.prototype.setVolume=qp.prototype.setVolume,qp.prototype.getVolume=qp.prototype.getVolume,qp.prototype.play=qp.prototype.play,qp.prototype.pause=qp.prototype.pause,qp.prototype.skip=qp.prototype.skip,qp.prototype.canSkipNow=qp.prototype.canSkipNow,qp.prototype.getTimeUntilSkippable=qp.prototype.getTimeUntilSkippable,qp.prototype.isSkippable=qp.prototype.isSkippable,qp.prototype.isPaused=qp.prototype.isPaused,qp.prototype.getRemainingTime=qp.prototype.getRemainingTime,qp.prototype.getMinSuggestedDuration=qp.prototype.getMinSuggestedDuration,qp.prototype.getDuration=qp.prototype.getDuration,qp.prototype.isUsingAnotherMediaElement=qp.prototype.isUsingAnotherMediaElement,qp.prototype.hasCustomClick=qp.prototype.hasCustomClick,qp.prototype.isClientRendering=qp.prototype.isClientRendering,qp.prototype.needsSkipUI=qp.prototype.needsSkipUI,(i=Yp.prototype).configure=function(){},i.stop=function(){this.C="",this.o=null,this.F=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.F},p($p,Bi),(i=$p.prototype).setLocale=function(e){this.o=e},i.configure=function(e){this.l=e,this.g&&this.g.configure(this.l),this.j&&this.j.configure(this.l),this.h&&this.h.configure(this.l)},i.initInterstitial=function(e,t,n){var r=this;this.g&&this.g.release(),this.g=new wp(e,t,n,function(e){return Jp(r,e)}),this.g.configure(this.l)},i.initClientSide=function(t,n,r){var i=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new Ke(2,10,1e4);this.j&&this.j.release(),this.j=new mp(t,n,this.o,r,function(e){return Jp(i,e)}),this.j.configure(this.l)},i.release=function(){this.g&&(this.g.release(),this.g=null),this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),Bi.prototype.release.call(this)},i.onAssetUnload=function(){this.g&&this.g.stop(),this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.dispatchEvent(new Ni("ad-stopped")),this.dispatchEvent(new Ni("ad-content-attach-requested")),this.m=new dp},i.requestClientSideAds=function(e){if(!this.j)throw new Ke(1,10,10001);var t=this.j;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.H=Date.now()/1e3,t.m.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.j)throw new Ke(1,10,10001);var t=this.j;t.C=e,t.g&&t.g.updateAdsRenderingSettings(t.C)},i.initMediaTailor=function(e,t,n){var r=this;this.i&&this.i.release(),this.i=new Fp(e,t,n,function(e){return Jp(r,e)})},i.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new Ke(1,10,10005);var r=this.i;return n=void 0===n?"":n,r.l?e=Promise.reject(new Ke(1,10,10004)):(r.l=new Ci,function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f;P(function(g){if(1==g.g)return r={type:7},(i=zi([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",n&&(a=JSON.stringify(n),i.body=Qe(a)),o=e.K.request(7,i,r),w(g,2),x(g,o.promise,4);if(2!=g.g){if(s=g.h,u=Ye(s.data),!(l=JSON.parse(u)).manifestUrl||!l.trackingUrl)throw Error("Insufficient data from MediaTailor.");return d=new me(t),c=new me(l.trackingUrl),e.H=d.resolve(c).toString(),h=Date.now()/1e3,p=h-e.R,e.i(new Ni("ads-loaded",(new Map).set("loadTime",p))),f=new me(l.manifestUrl),e.l.resolve(d.resolve(f).toString()),e.l=null,A(g,0)}if(E(g),!e.I.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,g.return();e.l.resolve(e.I),e.l=null,T(g)})}(r,e,t),r.I=n||"",r.R=Date.now()/1e3,e=r.l),e},i.addMediaTailorTrackingUrl=function(e){if(!this.i)throw new Ke(1,10,10005);var t=this.i;t.H=e,t.i(new Ni("ads-loaded",(new Map).set("loadTime",0)))},i.initServerSide=function(t,n){var r=this;if(!e.google||!google.ima||!google.ima.dai)throw new Ke(2,10,10002);this.h&&this.h.release(),this.h=new Yp(t,n,this.o,function(e){return Jp(r,e)}),this.h.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.h)throw new Ke(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&K('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.16.11",(n=this.h).j?e=Promise.reject(new Ke(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.H=!0),n.j=new Ci,n.g.requestStream(e),n.C=t||"",n.G=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.h)throw new Ke(1,10,10003);(e.mpt||e.mpv)&&K('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv="v4.16.11",this.h.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return ce("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.h&&(e=e.concat(this.h.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},i.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:cp(e),started:e.h,overlayAds:e.j,playedCompletely:e.l,skipped:e.m,errors:e.i}},i.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){this.h&&"urn:google:dai:2018"==e.schemeIdUri&&this.h.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},i.onHlsTimedMetadata=function(e,t){this.h&&this.h.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.h&&this.h.onCueMetadataChange(e)},i.onHLSInterstitialMetadata=function(e,t,n){this.l&&this.l.disableHLSInterstitial||(this.g||this.initInterstitial(null,e,t),this.g&&Ep(this.g,n))},i.onDASHInterstitialMetadata=function(e,t,n){if(!this.l||!this.l.disableDASHInterstitial){var r=n.schemeIdUri;if("urn:mpeg:dash:event:alternativeMPD:insert:2025"==r||"urn:mpeg:dash:event:alternativeMPD:replace:2025"==r){if(this.g||this.initInterstitial(null,e,t),this.g&&(e=this.g,t="urn:mpeg:dash:event:alternativeMPD:replace:2025"==n.schemeIdUri,r="urn:mpeg:dash:event:alternativeMPD:insert:2025"==n.schemeIdUri,t||r)){for(var i,a=n.startTime,o=n.endTime,s=null,u=0,l=g(n.eventNode.children),d=l.next();!d.done;d=l.next())if("AlternativeMPD"==(d=d.value).tagName){if(d=d.attributes.uri){i=d;break}}else if("InsertPresentation"==d.tagName||"ReplacePresentation"==d.tagName){var c=d.attributes.url;if(c){i=tt(c),(l=un(d,"maxDuration",gn))&&(s=l/n.timescale),(l=un(d,"returnOffset",gn))&&(u=l/n.timescale),t&&u&&(o=a+u);break}}i&&kp(e,[{id:n.id,groupId:null,startTime:a,endTime:o,uri:i,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:r?u:null,playoutLimit:s,once:!1,pre:!1,post:!1,timelineRange:t&&!r,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null}])}}else("urn:mpeg:dash:event:2012"==r||"urn:scte:dash:scte214-events"==r)&&n.eventNode&&on(n.eventNode,"OverlayEvent")&&(this.g||this.initInterstitial(null,e,t),this.g&&function(e,t){var n=on(t.eventNode,"OverlayEvent"),r=n.attributes.uri,i=n.attributes.mimeType,a="true"==n.attributes.loop,o=un(n,"z",gn);if(r&&0!=o){var s=null,u=on(n,"Background");if(u){var l=u.attributes.uri;s=l?"center / contain no-repeat url('"+l+"')":rn(u)}u=1920,l=1080;var d=on(n,"Viewport");if(d){if(null==(u=un(d,"x",gn)))return;if(null==(l=un(d,"y",gn)))return}var c={viewport:{x:u,y:l},topLeft:{x:0,y:0},size:{x:u,y:l}},h=on(n,"Overlay");if(d&&h){var p=on(h,"TopLeft"),f=on(h,"Size");if(p&&f){if(null==(h=un(p,"x",gn)))return;if(null==(p=un(p,"y",gn)))return;var g=un(f,"x",gn);if(null==g)return;if(null==(f=un(f,"y",gn)))return;c.topLeft.x=h,c.topLeft.y=p,c.size.x=g,c.size.y=f}}if(h=null,n=on(n,"Squeeze"),d&&n&&(f=on(n,"TopLeft"),n=on(n,"Size"),f&&n)){if(null==(d=un(f,"x",gn)))return;if(null==(h=un(f,"y",gn)))return;if(null==(f=un(n,"x",gn)))return;if(null==(n=un(n,"y",gn)))return;h={viewport:{x:u,y:l},topLeft:{x:d,y:h},size:{x:f,y:n}}}kp(e,[{id:t.id,groupId:null,startTime:t.startTime,endTime:t.endTime,uri:r,mimeType:i,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:a,overlay:c,displayOnBackground:-1==o,currentVideo:h,background:s,clickThroughUrl:null}])}}(this.g,n))}},i.addCustomInterstitial=function(e){if(!this.g)throw new Ke(1,10,10006);kp(this.g,[e])},i.addAdUrlInterstitial=function(e){if(!this.g)throw new Ke(1,10,10006);return this.g.addAdUrlInterstitial(e)},i.getInterstitialPlayer=function(){if(!this.g)throw new Ke(1,10,10006);return this.g.td()},V("shaka.ads.AdManager",$p),$p.prototype.getInterstitialPlayer=$p.prototype.getInterstitialPlayer,$p.prototype.addAdUrlInterstitial=$p.prototype.addAdUrlInterstitial,$p.prototype.addCustomInterstitial=$p.prototype.addCustomInterstitial,$p.prototype.onDASHInterstitialMetadata=$p.prototype.onDASHInterstitialMetadata,$p.prototype.onHLSInterstitialMetadata=$p.prototype.onHLSInterstitialMetadata,$p.prototype.onCueMetadataChange=$p.prototype.onCueMetadataChange,$p.prototype.onHlsTimedMetadata=$p.prototype.onHlsTimedMetadata,$p.prototype.onDashTimedMetadata=$p.prototype.onDashTimedMetadata,$p.prototype.onManifestUpdated=$p.prototype.onManifestUpdated,$p.prototype.getStats=$p.prototype.getStats,$p.prototype.getCuePoints=$p.prototype.getCuePoints,$p.prototype.getServerSideCuePoints=$p.prototype.getServerSideCuePoints,$p.prototype.replaceServerSideAdTagParameters=$p.prototype.replaceServerSideAdTagParameters,$p.prototype.requestServerSideStream=$p.prototype.requestServerSideStream,$p.prototype.initServerSide=$p.prototype.initServerSide,$p.prototype.addMediaTailorTrackingUrl=$p.prototype.addMediaTailorTrackingUrl,$p.prototype.requestMediaTailorStream=$p.prototype.requestMediaTailorStream,$p.prototype.initMediaTailor=$p.prototype.initMediaTailor,$p.prototype.updateClientSideAdsRenderingSettings=$p.prototype.updateClientSideAdsRenderingSettings,$p.prototype.requestClientSideAds=$p.prototype.requestClientSideAds,$p.prototype.onAssetUnload=$p.prototype.onAssetUnload,$p.prototype.release=$p.prototype.release,$p.prototype.initClientSide=$p.prototype.initClientSide,$p.prototype.initInterstitial=$p.prototype.initInterstitial,$p.prototype.configure=$p.prototype.configure,$p.prototype.setLocale=$p.prototype.setLocale,$p.ADS_LOADED="ads-loaded",$p.AD_STARTED="ad-started",$p.AD_FIRST_QUARTILE="ad-first-quartile",$p.AD_MIDPOINT="ad-midpoint",$p.AD_THIRD_QUARTILE="ad-third-quartile",$p.AD_COMPLETE="ad-complete",$p.AD_STOPPED="ad-stopped",$p.AD_SKIPPED="ad-skipped",$p.AD_VOLUME_CHANGED="ad-volume-changed",$p.AD_MUTED="ad-muted",$p.AD_PAUSED="ad-paused",$p.AD_RESUMED="ad-resumed",$p.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",$p.CUEPOINTS_CHANGED="ad-cue-points-changed",$p.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",$p.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",$p.AD_CLICKED="ad-clicked",$p.AD_PROGRESS="ad-progress",$p.AD_BUFFERING="ad-buffering",$p.AD_IMPRESSION="ad-impression",$p.AD_DURATION_CHANGED="ad-duration-changed",$p.AD_CLOSED="ad-closed",$p.AD_LOADED="ad-loaded",$p.ALL_ADS_COMPLETED="all-ads-completed",$p.AD_LINEAR_CHANGED="ad-linear-changed",$p.AD_METADATA="ad-metadata",$p.AD_RECOVERABLE_ERROR="ad-recoverable-error",$p.AD_ERROR="ad-error",$p.AD_BREAK_READY="ad-break-ready",$p.AD_INTERACTION="ad-interaction",$p.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",$p.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",$p.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",up=function(){return new $p};var ef="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),tf="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),nf=["loop","playbackRate"],rf=["pause","play"],af=(new Map).set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("isVideoOnly",10).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1).set("getBandwidthEstimate",1).set("isRemotePlayback",1),of=(new Map).set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getAudioTracks",2).set("getChaptersTracks",2).set("getImageTracks",2).set("getVideoTracks",2).set("getTextTracks",2).set("getVariantTracks",2),sf=(new Map).set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),uf=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],lf=[["isTextTrackVisible","setTextTrackVisibility"]],df="cancelTrickPlay configure configurationForLowLatency getChapters resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel selectVideoTrack setTextTrackVisibility trickPlay updateStartTime goToLive useTrickPlayTrackIfAvailable".split(" "),cf="addChaptersTrack addTextTrackAsync addThumbnailsTrack getAllThumbnails getChaptersAsync getThumbnails attach attachCanvas detach load unload".split(" ");function hf(e,t,n,r,i,a,o){var s=this;this.H=e,this.K=o,this.l=new Rr(t),this.M=n,this.u=!1,this.B=r,this.G=i,this.N=a,this.i=this.m=!1,this.J="",this.o=null,this.C=function(){return mf(s)},this.F=function(e,t){switch((e=Zp(t)).type){case"event":var n=e.targetName,r=Oi(e.event);s.B(n,r);break;case"update":for(r in n=e.update)for(var i in e=s.g[r]||{},n[r])e[i]=n[r][i];s.u&&(s.M(),s.u=!1);break;case"asyncComplete":if(i=e.id,r=e.error,t=e.res,e=s.h.get(i),s.h.delete(i),e)if(r){for(n in i=new Ke(r.severity,r.category,r.code),r)i[n]=r[n];e.reject(i)}else e.resolve(t)}},this.g={video:{},player:{}},this.I=0,this.h=new Map,this.j=null,Sf.add(this)}function pf(e,t){var n=e.N();Tf=t,t.addUpdateListener(e.C),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.F),mf(e),yf(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function ff(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new Ke(2,8,n,t))}function gf(e){var t=Tf;t.removeUpdateListener(e.C),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.F)}function mf(e){var t=!!Tf&&"connected"==Tf.status;if(e.i&&!t){for(var n in e.G(),e.g)e.g[n]={};vf(e)}e.i=t,e.J=t?Tf.receiver.friendlyName:"",e.l.Kb()}function vf(e){if(e.h)for(var t=g(e.h.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var r=e.h.get(n);e.h.delete(n),r.reject(new Ke(1,7,7e3))}}function yf(e,t){t=Qp(t);var n=Tf;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},Y)}catch(r){throw t=new Ke(2,8,8005,r),n=new Ni("error",(new Map).set("detail",t)),e.B("player",n),e.qd(),t}}(i=hf.prototype).destroy=function(){return Sf.delete(this),vf(this),Tf&&gf(this),this.l&&(this.l.stop(),this.l=null),this.G=this.B=null,this.i=this.m=!1,this.F=this.C=this.j=this.h=this.g=this.o=null,Promise.resolve()},i.wb=function(){return this.i},i.dh=function(){return this.J},i.init=function(){if(this.H.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.Kb();var t=new chrome.cast.SessionRequest(this.H,[],null,this.K,null);t=new chrome.cast.ApiConfig(t,function(e){for(var t=g(Sf),n=t.next();!n.done;n=t.next()){var r=e;(n=n.value).j=new Ci,n.u=!0,pf(n,r)}},function(e){for(var t=g(Sf),n=t.next();!n.done;n=t.next())n=n.value,xf="available"==e,n.l.Kb()},"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),xf&&this.l.ka(bf),(t=Tf)&&t.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new Ci,this.u=!0,pf(this,t)):Tf=null}else e.__onGCastApiAvailable!==Af&&(wf=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Af)},i.ph=function(e){this.o=e,this.i&&yf(this,{type:"appData",appData:this.o})},i.cast=function(){var e=this;return P(function(t){if(!e.m)throw new Ke(1,8,8e3);if(!xf)throw new Ke(1,8,8001);if(e.i)throw new Ke(1,8,8002);return e.j=new Ci,chrome.cast.requestSession(function(t){return pf(e,t)},function(t){return ff(e,t)}),x(t,e.j,0)})},i.qd=function(){if(this.i){if(vf(this),Tf){gf(this);try{Tf.stop(function(){},function(){})}catch(fA){}Tf=null}mf(this)}},i.get=function(e,t){var n=this;if("video"==e){if(rf.includes(t))return function(){return n.Ki.apply(n,[e,t].concat(m(D.apply(0,arguments))))}}else if("player"==e){if(sf.has(t)&&!this.get("player","isLive")())return function(){};if(df.includes(t))return function(){return n.Ki.apply(n,[e,t].concat(m(D.apply(0,arguments))))};if(cf.includes(t))return function(){return n.Nk.apply(n,[e,t].concat(m(D.apply(0,arguments))))};if(af.has(t)||of.has(t))return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,yf(this,{type:"set",targetName:e,property:t,value:n})},i.Ki=function(e,t){yf(this,{type:"call",targetName:e,methodName:t,args:D.apply(2,arguments)})},i.Nk=function(e,t){var n=D.apply(2,arguments),r=new Ci,i=this.I.toString();this.I++,this.h.set(i,r);try{yf(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:i})}catch(a){r.reject(a)}return r};var bf=.02,xf=!1,Tf=null,wf=null,Sf=new Set;function Af(t){if(wf?e.__onGCastApiAvailable=wf:delete e.__onGCastApiAvailable,wf=null,t)for(var n=g(Sf),r=n.next();!r.done;r=n.next())r.value.init();"function"==typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function Ef(t,n,r,i){i=void 0!==i&&i,Bi.call(this);var a=this;this.i=t,this.h=n,this.l=this.o=this.m=this.u=this.j=null,this.I=r,this.H=i,this.F=[],this.C=[],this.B=[],this.G=new Map,this.g=null,e.chrome&&"CAST"!=oe().Oa()?(this.g=new hf(r,function(){return Cf(a)},function(){return Mf(a)},function(e,t){return Df(a,e,t)},function(){return Rf(a)},function(){return If(a)},i),function(e){e.g.init(),e.l=new ne;for(var t=g(ef),n=t.next();!n.done;n=t.next())e.l.D(e.i,n.value,function(t){e.g.wb()||(t=Oi(t),e.m.dispatchEvent(t))});for(var r in Ui)e.l.D(e.h,Ui[r],function(t){e.g.wb()||e.o.dispatchEvent(t)});for(var i in e.j={},t={},e.i)(t={ge:t.ge}).ge=i,Object.defineProperty(e.j,t.ge,{configurable:!1,enumerable:!0,get:function(t){return function(){return _f(e,t.ge)}}(t),set:function(t){return function(n){var r=t.ge;e.g.wb()?e.g.set("video",r,n):e.i[r]=n}}(t)});e.u={},kf(e,function(t){Object.defineProperty(e.u,t,{configurable:!1,enumerable:!0,get:function(){return Pf(e,t)}})}),function(e){var t=new Map;kf(e,function(n,r){t.has(r)?(r=t.get(r),n.length<r.length?e.G.set(n,r):e.G.set(r,n)):t.set(r,n)})}(e),e.m=new Bi,e.m.Ie=e.j,e.o=new Bi,e.o.Ie=e.u,e.l.D(e.h,"unloading",function(){e.g&&e.g.wb()||Lf(e)})}(this)):(this.j=this.i,this.u=this.h)}function kf(e,t){function n(e){return"constructor"!=e&&"function"==typeof i[e]&&!a.has(e)}var r,i=e.h,a=new Set;for(r in i)n(r)&&(a.add(r),t(r,i[r]));for(e=Object.getPrototypeOf(i),r=Object.getPrototypeOf({});e&&e!=r;){for(var o=g(Object.getOwnPropertyNames(e)),s=o.next();!s.done;s=o.next())n(s=s.value)&&(a.add(s),t(s,i[s]));e=Object.getPrototypeOf(e)}}function If(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.rd(),startTime:null,addThumbnailsTrackCalls:e.F,addTextTrackAsyncCalls:e.C,addChaptersTrackCalls:e.B};e.i.pause();for(var n=g(nf),r=n.next();!r.done;r=n.next())r=r.value,t.video[r]=e.i[r];for(e.i.ended||(t.startTime=e.i.currentTime),r=(n=g(uf)).next();!r.done;r=n.next()){var i=r.value;r=i[1],i=e.h[i[0]](),t.player[r]=i}for(r=(n=g(lf)).next();!r.done;r=n.next())r=(i=r.value)[1],i=e.h[i[0]](),t.playerAfterLoad[r]=i;return t}function Cf(e){var t=new Ni("caststatuschanged");e.dispatchEvent(t)}function Mf(e){var t=new Ni(e.j.paused?"pause":"play");e.m.dispatchEvent(t)}function Rf(e){for(var t=g(uf),n=t.next();!n.done;n=t.next()){var r=n.value;n=r[1],r=e.g.get("player",r[0])(),e.h[n](r)}var i=e.F,a=e.C,o=e.B;Lf(e);var s=e.g.get("player","getAssetUri")();r=e.g.get("video","ended"),t=Promise.resolve();var u,l=e.i.autoplay;n=null,r||(n=e.g.get("video","currentTime")),(r=e.g.get("player","getTextTracks")())&&r.length&&(u=r.find(function(e){return e.active}));var d=e.g.get("player","isTextTrackVisible")();s&&(e.i.autoplay=!1,t=e.h.load(s,n));var c={};for(r=(n=g(nf)).next();!r.done;r=n.next())r=r.value,c[r]=e.g.get("video",r);t.then(function(){if(e.i){for(var t=g(i),n=t.next();!n.done;n=t.next()){var r;n=n.value,(r=e.td()).Oe.apply(r,m(n))}for(r=(t=g(a)).next();!r.done;r=t.next()){var h;r=r.value,(h=e.td()).Qd.apply(h,m(r))}for(t=(h=g(o)).next();!t.done;t=h.next()){var p;t=t.value,(p=e.td()).Ne.apply(p,m(t))}for(h=(p=g(nf)).next();!h.done;h=p.next())h=h.value,e.i[h]=c[h];for(h=(p=g(lf)).next();!h.done;h=p.next())h=(t=h.value)[1],t=e.g.get("player",t[0])(),e.h[h](t);e.h.uh(d),u&&e.h.nh(u.language,u.roles,u.forced),e.i.autoplay=l,s&&e.i.play()}},function(t){t=new Ni("error",t=(new Map).set("detail",t)),e.h.dispatchEvent(t)})}function _f(e,t){if("addEventListener"==t)return function(t,n,r){return e.m.addEventListener(t,n,r)};if("removeEventListener"==t)return function(t,n,r){return e.m.removeEventListener(t,n,r)};if(e.g.wb()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.wb()?e.g.get("video",t):("function"==typeof(t=e.i[t])&&(t=t.bind(e.i)),t)}function Pf(e,t,n){if(n=void 0!==n&&n,e.G.has(t)&&(t=e.G.get(t)),"addEventListener"==t)return function(t,n,r){return e.o.addEventListener(t,n,r)};if("removeEventListener"==t)return function(t,n,r){return e.o.removeEventListener(t,n,r)};if("getMediaElement"==t)return function(){return e.j};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.Zb()};if("getDrmEngine"==t)return function(){return e.h.F};if("getAdManager"==t)return function(){return e.h.bi()};if("getQueueManager"==t)return function(){return e.h.ki()};if("setVideoContainer"==t)return function(t){return e.h.Xi(t)};if(!n){if("addThumbnailsTrack"==t)return function(){var n=D.apply(0,arguments);return e.F.push(n),Pf(e,t,!0).apply(null,m(n))};if("addTextTrackAsync"==t)return function(){var n=D.apply(0,arguments);return e.C.push(n),Pf(e,t,!0).apply(null,m(n))};if("addChaptersTrack"==t)return function(){var n=D.apply(0,arguments);return e.B.push(n),Pf(e,t,!0).apply(null,m(n))}}if(e.g.wb()){if("getManifest"==t||"drmInfo"==t)return function(){return K(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return K(t+"() does not work while casting!"),Promise.resolve()};if("getChapters"==t)return function(){return K(t+"() does not work while casting!"),[]}}return e.g.wb()&&0==Object.keys(e.g.g.video).length&&(af.has(t)||of.has(t))||!e.g.wb()?e.h[t].bind(e.h):e.g.get("player",t)}function Df(e,t,n){e.g.wb()&&("video"==t?e.m.dispatchEvent(n):"player"==t&&("unloading"==n.type&&Lf(e),e.o.dispatchEvent(n)))}function Lf(e){e.F=[],e.C=[],e.B=[]}function Nf(e,t,n,r){Bi.call(this);var i=this;this.h=e,this.g=t,this.j=new ne,this.I={video:e,player:t},this.G=n||function(){},this.J=r||function(e){return e},this.i=null,this.H=!1,this.o=!0,this.m=0,this.C=!1,this.B=!0,this.u=this.l=null,this.F=new Rr(function(){jf(i)}),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Of(e)},t.onSenderDisconnected=function(){return Of(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&Gf(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),Gf(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.u=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.u.onMessage=function(t){return function(e,t){var n=Zp(t.data);switch(n.type){case"PLAY":e.h.play(),zf(e);break;case"PAUSE":e.h.pause(),zf(e);break;case"SEEK":t=n.currentTime;var r=n.resumeState;null!=t&&(e.h.currentTime=Number(t)),r&&"PLAYBACK_START"==r?(e.h.play(),zf(e)):r&&"PLAYBACK_PAUSE"==r&&(e.h.pause(),zf(e));break;case"STOP":e.g.Cc().then(function(){e.g&&zf(e)});break;case"GET_STATUS":Vf(e,Number(n.requestId));break;case"VOLUME":t=(r=n.volume).level,r=r.muted;var i=e.h.volume,a=e.h.muted;null!=t&&(e.h.volume=Number(t)),null!=r&&(e.h.muted=r),i==e.h.volume&&a==e.h.muted||zf(e);break;case"LOAD":e.m=0,e.C=!1,e.B=!1,t=n.media,r=n.currentTime,i=e.J(t.contentId),a=n.autoplay||!0,e.G(t.customData),a&&(e.h.autoplay=!0),e.g.load(i,r).then(function(){e.g&&Vf(e)}).catch(function(t){var r="LOAD_FAILED";7==t.category&&7e3==t.code&&(r="LOAD_CANCELLED"),Gf(e,{requestId:Number(n.requestId),type:r},e.u)});break;default:Gf(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.u)}}(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return function(e,t){var n=Zp(t.data);switch(n.type){case"init":e.m=0,e.C=!1,e.B=!0,function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f,v,y,b,S,k,I,C;P(function(M){switch(M.g){case 1:for(r in t.player)i=t.player[r],e.g[r](i);return e.G(n),a=e.h.autoplay,t.manifest?(e.h.autoplay=!1,w(M,5),x(M,e.g.load(t.manifest,t.startTime),7)):x(M,Promise.resolve(),3);case 7:if(t.addThumbnailsTrackCalls)for(o=g(t.addThumbnailsTrackCalls),s=o.next();!s.done;s=o.next())u=s.value,e.g.Oe.apply(e.g,m(u));if(t.addTextTrackAsyncCalls)for(l=g(t.addTextTrackAsyncCalls),d=l.next();!d.done;d=l.next())c=d.value,e.g.Qd.apply(e.g,m(c));if(t.addChaptersTrackCalls)for(h=g(t.addChaptersTrackCalls),p=h.next();!p.done;p=h.next())f=p.value,e.g.Ne.apply(e.g,m(f));A(M,3);break;case 5:return v=E(M),y=(new Map).set("detail",v),b=new Ni("error",y),e.g&&e.g.dispatchEvent(b),M.return();case 3:if(!e.g)return M.return();for(S in t.video)k=t.video[S],e.h[S]=k;for(I in t.playerAfterLoad)C=t.playerAfterLoad[I],e.g[I](C);e.h.autoplay=a,t.manifest&&(e.h.play(),zf(e)),T(M)}})}(e,n.initState,n.appData),jf(e);break;case"appData":e.G(n.appData);break;case"set":var r=n.targetName,i=n.property;if(n=n.value,"video"==r){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==i){t.setSystemVolumeLevel(n);break}if("muted"==i){t.setSystemVolumeMuted(n);break}}e.I[r][i]=n;break;case"call":(r=e.I[n.targetName])[n.methodName].apply(r,n.args);break;case"asyncCall":r=n.targetName,i=n.methodName,"player"==r&&"load"==i&&(e.m=0,e.C=!1);var a=n.id,o=t.senderId;n=(t=e.I[r])[i].apply(t,n.args),"player"==r&&"load"==i&&(n=n.then(function(){e.B=!0})),n.then(function(t){return Hf(e,o,a,null,t)},function(t){return Hf(e,o,a,t,null)})}}(e,t)},t.start();for(var n=(t=g(ef)).next();!n.done;n=t.next())e.j.D(e.h,n.value,function(t){return Bf(e,"video",t)});for(var r in Ui)e.j.D(e.g,Ui[r],function(t){return Bf(e,"player",t)});e.j.D(e.h,"loadeddata",function(){e.C=!0}),e.j.D(e.g,"loading",function(){e.o=!1,Uf(e)}),e.j.D(e.h,"playing",function(){e.o=!1,Uf(e)}),e.j.D(e.h,"pause",function(){Uf(e)}),e.j.D(e.g,"unloading",function(){e.o=!0,Uf(e)}),e.j.D(e.h,"ended",function(){new Rr(function(){e.h&&e.h.ended&&(e.o=!0,Uf(e))}).ka(Wf)})}(this)}function Of(e){e.m=0,e.B=!0,e.H=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Uf(e)}function Uf(e){var t;P(function(n){return 1==n.g?x(n,Promise.resolve(),2):e.g?(t=new Ni("caststatuschanged"),e.dispatchEvent(t),Ff(e)||zf(e),void T(n)):n.return()})}function Bf(e,t,n){e.g&&(jf(e),Gf(e,{type:"event",targetName:t,event:n},e.l))}function jf(e){e.F.ka(Xf);for(var t={video:{},player:{}},n=g(tf),r=n.next();!r.done;r=n.next())r=r.value,t.video[r]=e.h[r];e.g.W()&&sf.forEach(function(n,r){e.m%n==0&&(t.player[r]=e.g[r]())}),af.forEach(function(n,r){e.m%n==0&&(t.player[r]=e.g[r]())}),(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Gf(e,{type:"update",update:t},e.l),of.forEach(function(t,n){e.m%t==0&&((t={player:{}}).player[n]=e.g[n](),Gf(e,{type:"update",update:t},e.l))}),e.C&&(e.m+=1),Ff(e)}function Ff(e){return!(!e.B||!e.h.duration&&!e.g.W()||(Vf(e),e.B=!1,0))}function Vf(e,t){var n={contentId:e.g.rd(),streamType:e.g.W()?"LIVE":"BUFFERED",contentType:""};e.g.W()||(n.duration=e.h.duration),e.i&&(n.metadata=e.i),zf(e,void 0===t?0:t,n)}function Hf(e,t,n,r,i){e.g&&Gf(e,{type:"asyncComplete",id:n,error:r,res:i},e.l,t)}function Gf(e,t,n,r){e.H&&(e=Qp(t),r?n.getCastChannel(r).send(e):n.broadcast(e))}function zf(e,t,n){n=void 0===n?null:n;var r={mediaSessionId:0,playbackRate:e.h.playbackRate,playerState:e.o?Kf:e.g.Qg()?Yf:e.h.paused?$f:qf,currentTime:e.h.currentTime,supportedMediaCommands:63,volume:{level:e.h.volume,muted:e.h.muted}};n&&(r.media=n),Gf(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[r]},e.u)}p(Ef,Bi),(i=Ef.prototype).destroy=function(e){return this.g&&void 0!==e&&e&&this.g.qd(),this.l&&(this.l.release(),this.l=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.j=this.i=null,Bi.prototype.release.call(this),Promise.all(e)},i.ek=function(){return this.j},i.td=function(){return this.u},i.qj=function(){return!!this.g&&this.g.m&&xf},i.wb=function(){return!!this.g&&this.g.wb()},i.dh=function(){return this.g?this.g.dh():""},i.cast=function(){var e=this;return P(function(t){return 1==t.g?e.g?x(t,e.g.cast(),2):t.return():e.h?x(t,e.h.Cc(),0):t.return()})},i.ph=function(e){this.g&&this.g.ph(e)},i.fl=function(){var e;this.g&&(e=this.g).i&&chrome.cast.requestSession(function(t){return pf(e,t)},function(t){return ff(e,t)})},i.qd=function(){this.g&&this.g.qd()},i.rj=function(e,t){t=void 0!==t&&t;var n=this;return P(function(r){if(1==r.g)return e==n.I&&t==n.H?r.return():(n.I=e,n.H=t,n.g?(n.g.qd(),x(r,n.g.destroy(),2)):r.return());n.g=null,n.g=new hf(e,function(){return Cf(n)},function(){return Mf(n)},function(e,t){return Df(n,e,t)},function(){return Rf(n)},function(){return If(n)},t),n.g.init(),T(r)})},V("shaka.cast.CastProxy",Ef),Ef.prototype.changeReceiverId=Ef.prototype.rj,Ef.prototype.forceDisconnect=Ef.prototype.qd,Ef.prototype.suggestDisconnect=Ef.prototype.fl,Ef.prototype.setAppData=Ef.prototype.ph,Ef.prototype.cast=Ef.prototype.cast,Ef.prototype.receiverName=Ef.prototype.dh,Ef.prototype.isCasting=Ef.prototype.wb,Ef.prototype.canCast=Ef.prototype.qj,Ef.prototype.getPlayer=Ef.prototype.td,Ef.prototype.getVideo=Ef.prototype.ek,Ef.prototype.destroy=Ef.prototype.destroy,p(Nf,Bi),(i=Nf.prototype).isConnected=function(){return this.H},i.lk=function(){return this.o},i.Zk=function(e){this.i=e},i.vj=function(){this.i=null},i.$k=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.Yk=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.Xk=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t=this;return P(function(n){if(1==n.g)return t.j&&(t.j.release(),t.j=null),e=[],t.g&&(e.push(t.g.destroy()),t.g=null),t.F&&(t.F.stop(),t.F=null),t.h=null,t.I=null,t.G=null,t.H=!1,t.o=!0,t.l=null,t.u=null,Bi.prototype.release.call(t),x(n,Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),T(n)})},V("shaka.cast.CastReceiver",Nf),Nf.prototype.destroy=Nf.prototype.destroy,Nf.prototype.setContentArtist=Nf.prototype.Xk,Nf.prototype.setContentImage=Nf.prototype.Yk,Nf.prototype.setContentTitle=Nf.prototype.$k,Nf.prototype.clearContentMetadata=Nf.prototype.vj,Nf.prototype.setContentMetadata=Nf.prototype.Zk,Nf.prototype.isIdle=Nf.prototype.lk,Nf.prototype.isConnected=Nf.prototype.isConnected;var Xf=.5,Wf=5,Kf="IDLE",qf="PLAYING",Yf="BUFFERING",$f="PAUSED";function Jf(e,t,n,r,i){if(r>=i)return null;for(var a=-1,o=-1,s=0;s<n.length;s++)if(n[s].some(function(e){return null!=e&&""!=e.g.trim()})){a=s;break}for(s=n.length-1;s>=0;s--)if(n[s].some(function(e){return null!=e&&""!=e.g.trim()})){o=s;break}if(-1===a||-1===o)return null;for(var u=s=!1,l="white",d="black",c=Qf(r,i,s,u,l,d);a<=o;a++){for(var h=n[a],p=-1,f=-1,g=0;g<h.length;g++)if(null!=h[g]&&""!==h[g].g.trim()){p=g;break}for(g=h.length-1;g>=0;g--)if(null!=h[g]&&""!==h[g].g.trim()){f=g;break}if(-1===p||-1===f)h=Zf(r,i),e.nestedCues.push(h);else{for(;p<=f;p++)if(g=h[p]){var m=g.l,v=g.i,y=g.j,b=g.h;m==s&&v==u&&y==l&&b==d||(c.payload&&e.nestedCues.push(c),c=Qf(r,i,m,v,y,b),s=m,u=v,l=y,d=b),c.payload+=g.g}else c.payload+=" ";c.payload&&e.nestedCues.push(c),a!==o&&(c=Zf(r,i),e.nestedCues.push(c)),c=Qf(r,i,s,u,l,d)}}return e.nestedCues.length?{cue:e,stream:t}:null}function Qf(e,t,n,r,i,a){return e=new Mn(e,t,""),n&&e.textDecoration.push(Zn),r&&(e.fontStyle=Jn),e.color=i,e.backgroundColor=a,e}function Zf(e,t){return(e=new Mn(e,t,"")).lineBreak=!0,e}function eg(e,t,n,r,i){this.g=e,this.l=t,this.i=n,this.h=r,this.j=i}function tg(e,t){this.i=[],this.g=1,this.h=0,this.F=e,this.C=t,this.j=this.m=!1,this.l="white",this.o="black",this.u=this.B=null,rg(this)}function ng(e,t,n){var r="CC"+(1+(e.F<<1|e.C)),i=new Mn(t,n,"");i.lineInterpretation=1;var a=cg.get(e.g);return a&&(i.line=a),null!=e.u&&null!=e.B&&(i.position=10+Math.min(70,10*e.u)+2.5*e.B),(t=Jf(i,r,e.i,t,n))&&e.g+t.cue.nestedCues.length-3>15&&(a=cg.get(e.g+3-t.cue.nestedCues.length))&&(i.line=a),t}function rg(e){og(e,0,15),e.g=1}function ig(e,t,n){if(!(n<32||n>127)){var r="";switch(t){case 0:r=sg.has(n)?sg.get(n):String.fromCharCode(n);break;case 1:r=ug.get(n);break;case 2:e.i[e.g].pop(),r=lg.get(n);break;case 3:e.i[e.g].pop(),r=dg.get(n)}r&&e.i[e.g].push(new eg(r,e.m,e.j,e.o,e.l))}}function ag(e,t,n,r){if(!(n<0||t<0))if(t>=n)for(--r;r>=0;r--)e.i[t+r]=e.i[n+r].map(function(e){return e});else for(var i=0;i<r;i++)e.i[t+i]=e.i[n+i].map(function(e){return e})}function og(e,t,n){for(var r=0;r<=n;r++)e.i[t+r]=[]}var sg=new Map([[39,""],[42,""],[92,""],[92,""],[94,""],[95,""],[96,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),ug=new Map([[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57," "],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),lg=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,"*"],[41,"'"],[42,""],[43,""],[44,""],[45,""],[46,""],[47,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),dg=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,""],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),cg=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function hg(e,t){this.h=0,this.o=new tg(e,t),this.i=new tg(e,t),this.g=this.j=new tg(e,t),this.l=0,this.m=null}function pg(e,t,n){e.g=e.i;var r=e.g,i=null;return 3!==e.h&&4!==e.h&&(i=ng(r,e.l,n),(n=e.i).g=n.h>0?n.h:0,og(n,0,15),(n=e.j).g=n.h>0?n.h:0,og(n,0,15),r.g=15),e.h=3,r.h=t,i}function fg(e){e.h=1,e.g=e.j,e.g.h=0}function gg(e){q("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var mg="black green blue cyan red yellow magenta black".split(" "),vg="white green blue cyan red yellow magenta white_italics".split(" ");function yg(e,t){this.J=t,this.N=e,this.K=this.l=!1,this.m=this.o=this.H=this.M=this.I=0,this.G=2,this.i=[],this.g=this.h=this.j=0,this.F=this.B=!1,this.C="white",this.u="black",bg(this)}function bg(e){e.i=[];for(var t=0;t<16;t++)e.i.push(xg())}function xg(){for(var e=[],t=0;t<42;t++)e.push(null);return e}function Tg(e,t){wg(e)&&(e.i[e.h][e.g]=new eg(t,e.F,e.B,e.u,e.C),e.g++)}function wg(e){var t=e.g<e.m&&e.g>=0;return e.h<e.o&&e.h>=0&&t}function Sg(e,t,n){var r=new Mn(e.j,t,"");r.textAlign=0===e.G?"left":1===e.G?"right":Un;var i=r.region;switch(e.J&&(i.id+="svc"+e.J),i.id+="win"+e.N,i.height=e.o,i.width=e.m,i.heightUnits=2,i.widthUnits=2,i.viewportAnchorX=e.I,i.viewportAnchorY=e.M,i.viewportAnchorUnits=e.K?Ut:2,e.H){case 0:i.regionAnchorX=0,i.regionAnchorY=0;break;case 1:i.regionAnchorX=50,i.regionAnchorY=0;break;case 2:i.regionAnchorX=100,i.regionAnchorY=0;break;case 3:i.regionAnchorX=0,i.regionAnchorY=50;break;case 4:i.regionAnchorX=50,i.regionAnchorY=50;break;case 5:i.regionAnchorX=100,i.regionAnchorY=50;break;case 6:i.regionAnchorX=0,i.regionAnchorY=100;break;case 7:i.regionAnchorX=50,i.regionAnchorY=100;break;case 8:i.regionAnchorX=100,i.regionAnchorY=100}return(n=Jf(r,"svc"+n,e.i,e.j,t))&&(e.j=t),n}function Ag(){this.i=[],this.h=null,this.g=0}function Eg(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(e.g>0&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new kg(e.h)),e.h=null,e.g=0))}function kg(e){this.g=0,this.h=e}function Ig(e){if(!e.Ia())throw new Ke(2,2,3e3);return e.h[e.g++]}function Cg(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function Mg(e,t,n,r){if(!e.g)return[];if(24==n)return n=Ig(t).value,r=Ig(t).value,n=[n,r].map(function(e){return("0"+(255&e).toString(16)).slice(-2)}).join(""),Tg(e.g,String.fromCharCode(parseInt(n,16))),[];t=e.g;var i=null;switch(n){case 8:!wg(t)||t.g<=0&&t.h<=0||(t.g<=0?(t.g=t.m-1,t.h--):t.g--,t.i[t.h][t.g]=null);break;case 13:t.isVisible()&&(i=Sg(t,r,e.i)),t.h+1>=t.o?function(e){for(var t=0,n=1;n<16;n++,t++)e.i[t]=e.i[n];for(n=0;n<1;n++,t++)e.i[t]=xg()}(t):t.h++,t.g=0;break;case 14:t.isVisible()&&(i=Sg(t,r,e.i)),t.i[t.h]=xg(),t.g=0;break;case 12:t.isVisible()&&(i=Sg(t,r,e.i)),bg(t),t.h=0,t.g=0}return i?[i]:[]}function Rg(e,t,n,r){if(n>=128&&n<=135)r=7&n,e.h[r]&&(e.g=e.h[r]);else{if(136===n){n=Ig(t).value,t=[];for(var i=(n=g(_g(e,n))).next();!i.done;i=n.next()){if((i=e.h[i.value]).isVisible()){var a=Sg(i,r,e.i);a&&t.push(a)}bg(i)}return t}if(137===n)for(n=(t=g(_g(e,t=Ig(t).value))).next();!n.done;n=t.next())(n=e.h[n.value]).isVisible()||(n.j=r),n.display();else{if(138===n){for(n=Ig(t).value,t=null,i=(n=g(_g(e,n))).next();!i.done;i=n.next())(i=e.h[i.value]).isVisible()&&(t=Sg(i,r,e.i)),i.l=!1;return t?[t]:[]}if(139===n){for(n=Ig(t).value,t=null,i=(n=g(_g(e,n))).next();!i.done;i=n.next())(i=e.h[i.value]).isVisible()?t=Sg(i,r,e.i):i.j=r,i.l=!i.l;return t?[t]:[]}if(140===n)return Pg(e,t=Ig(t).value,r);if(143===n)return r=Pg(e,255,r),Dg(e),r;if(144===n)t.skip(1),r=Ig(t).value,e.g&&(e.g.B=(128&r)>0,e.g.F=(64&r)>0);else if(145===n)r=Ig(t).value,n=Ig(t).value,t.skip(1),e.g&&(t=Lg((48&n)>>4,(12&n)>>2,3&n),e.g.C=Lg((48&r)>>4,(12&r)>>2,3&r),e.g.u=t);else if(146===n)r=Ig(t).value,t=Ig(t).value,e.g&&((e=e.g).h=15&r,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),r=Ig(t).value,t.skip(1),e.g&&(e.g.G=3&r);else if(n>=152&&n<=159){n=(15&n)-8,(i=null!==e.h[n])||((a=new yg(n,e.i)).j=r,e.h[n]=a),r=Ig(t).value,a=Ig(t).value;var o=Ig(t).value,s=Ig(t).value,u=Ig(t).value;t=Ig(t).value,i&&!(7&t)||((t=e.h[n]).h=0,t.g=0,t.F=!1,t.B=!1,t.C="white",t.u="black"),(t=e.h[n]).l=(32&r)>0,t.M=127&a,t.I=o,t.H=(240&s)>>4,t.K=(128&a)>0,t.o=1+(15&s),t.m=1+(63&u),e.g=e.h[n]}}}return[]}function _g(e,t){for(var n=[],r=0;r<8;r++)!(1&~t)&&e.h[r]&&n.push(r),t>>=1;return n}function Pg(e,t,n){for(var r=[],i=(t=g(_g(e,t))).next();!i.done;i=t.next()){i=i.value;var a=e.h[i];a.isVisible()&&(a=Sg(a,n,e.i))&&r.push(a),e.h[i]=null}return r}function Dg(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function Lg(e,t,n){var r={0:0,1:0,2:1,3:1};return Og[(e=r[e])<<2|(t=r[t])<<1|(n=r[n])]}yg.prototype.isVisible=function(){return this.l},yg.prototype.display=function(){this.l=!0},kg.prototype.Ia=function(){return this.g<this.h.length},kg.prototype.Pa=function(){return this.g},kg.prototype.skip=function(e){if(this.g+e>this.h.length)throw new Ke(2,2,3e3);this.g+=e},kg.prototype.Oi=function(e){if(this.g-e<0)throw new Ke(2,2,3e3);this.g-=e};var Ng=new Map([[32," "],[33,""],[37,""],[42,""],[44,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[57,""],[58,""],[60,""],[61,""],[63,""],[118,""],[119,""],[120,""],[121,""],[122,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),Og="black blue green cyan red magenta yellow white".split(" ");function Ug(){this.h=[],this.g=[],this.i=new Ag,this.l=0,this.m=new Map([["CC1",new hg(0,0)],["CC2",new hg(0,1)],["CC3",new hg(1,0)],["CC4",new hg(1,1)]]),this.u=this.o=0,this.j=new Map,this.C=!0,this.B=new Set,Bg(this)}function Bg(e){e.o=0,e.u=0;for(var t=g(e.m.values()),n=t.next();!n.done;n=t.next())(n=n.value).h=0,n.g=n.j,n.m=null,rg(n.i),rg(n.j),rg(n.o);e.C=!0}function jg(e,t){var n=t.type;if(16==(112&t.Db)){var r=t.Db>>3&1;0===n?e.o=r:e.u=r}if(r="CC"+(1+(n<<1|(n?e.u:e.o))),n=e.m.get(r),255===t.Db&&255===t.kc||!t.Db&&!t.kc||!Vg(t.Db)||!Vg(t.kc))return++e.l>=45&&Bg(e),null;e.l=0,t.Db&=127,t.kc&=127;var i=t.Db;if(i>=1&&i<=15||!t.Db&&!t.kc)return null;if(i=null,16==(112&t.Db))e:{if(e.B.add(r),r=t.Db,e=t.kc,n.m===(r<<8|e))n.m=null;else if(n.m=r<<8|e,16==(240&r)&&64==(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&r)<<1|e>>5&1],r="white",i=!1;var a=null,o=e>95?e-96:e-64;o<=13?r=vg[Math.floor(o/2)]:o<=15?i=!0:a=Math.floor((o-16)/2),e=!(1&~e),4!==n.h&&(o=n.g,3===n.h&&t!==o.g&&(ag(o,n=1+t-o.h,1+o.g-o.h,o.h),og(o,0,n-1),og(o,t+1,15-t)),o.g=t,o.m=e,o.j=i,o.l=r,o.u=a,o.o="black")}else if(17==(247&r)&&32==(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",ig(n.g,0,32),r=!1,"white_italics"===(t=vg[(14&e)>>1])&&(t="white",r=!0),n.g.m=!(1&~e),n.g.j=r,n.g.l=t;else if(16==(247&r)&&32==(240&e)||23==(247&r)&&45==(255&e))t="black",!(7&r)&&(t=mg[(14&e)>>1]),n.g.o=t;else if(17==(247&r)&&48==(240&e))ig(n.g,1,e);else if(18==(246&r)&&32==(224&e))ig(n.g,1&r?3:2,e);else{if(20==(246&r)&&32==(240&e)){switch(e=t.pts,r=null,t.kc){case 32:fg(n);break;case 33:(n=n.g).i[n.g].pop();break;case 37:r=pg(n,2,e);break;case 38:r=pg(n,3,e);break;case 39:r=pg(n,4,e);break;case 40:ig(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:rg(n.o),gg(n);break;case 43:gg(n);break;case 44:t=n.i,r=null,4!==n.h&&(r=ng(t,n.l,e)),og(t,0,15);break;case 45:t=n.g,3!==n.h?r=null:(r=ng(t,n.l,e),ag(t,(i=t.g-t.h+1)-1,i,t.h),og(t,0,i-1),og(t,t.g,15-t.g),n.l=e);break;case 46:og(n.j,0,15);break;case 47:t=null,4!==n.h&&(t=ng(n.i,n.l,e)),r=n.j,n.j=n.i,n.i=r,fg(n),n.l=e,r=t}i=r;break e}(23==r||31==r)&&e>=33&&e<=35&&(n.g.B=e-32)}i=null}else e=t.kc,ig(n.g,0,t.Db),ig(n.g,0,e);return i}function Fg(e,t){var n=[];try{for(;t.Ia();){var r=Ig(t).value,i=(224&r)>>5,a=31&r;if(7===i&&0!=a&&(i=63&Ig(t).value),0!=i){e.B.add("svc"+i),e.j.has(i)||e.j.set(i,new Cg(i));for(var o=e.j.get(i),s=t.Pa();t.Pa()-s<a;){i=o;var u=t,l=Ig(u),d=l.value,c=l.pts;if(16===d&&(d=d<<16|Ig(u).value),d>=0&&d<=31)var h=Mg(i,u,d,c);else if(d>=128&&d<=159)h=Rg(i,u,d,c);else{if(d>=4096&&d<=4127)i=u,(u=255&d)>=8&&u<=15?i.skip(1):u>=16&&u<=23?i.skip(2):u>=24&&u<=31&&i.skip(3);else if(d>=4224&&d<=4255)i=u,(u=255&d)>=128&&u<=135?i.skip(4):u>=136&&u<=143&&i.skip(5);else if(d>=32&&d<=127)u=d,i.g&&Tg(i.g,127===u?"":String.fromCharCode(u));else if(d>=160&&d<=255)i.g&&Tg(i.g,String.fromCharCode(d));else if(d>=4128&&d<=4223){if(u=255&d,i.g)if(Ng.has(u)){var p=Ng.get(u);Tg(i.g,p)}else Tg(i.g,"_")}else d>=4256&&d<=4351&&i.g&&Tg(i.g,160!=(255&d)?"_":"[CC]");h=[]}n.push.apply(n,m(h))}}}}catch(f){if(!(f instanceof Ke&&3e3===f.code))throw f;q("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function Vg(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function Hg(e){for(var t=[],n=e,r=e=0;r<n.length;)2==e&&3==n[r]?(e=0,(n=[].concat(m(n))).splice(r,1),n=new Uint8Array(n)):0==n[r]?e++:e=0,r++;for(e=n,r=0;r<e.length;){for(n=0;255==e[r];)n+=255,r++;n+=e[r++];for(var i=0;255==e[r];)i+=255,r++;i+=e[r++],4==n&&t.push(e.subarray(r,r+i)),r+=i}return t}function Gg(){this.j=new Map,this.i=this.h=0,this.g=Xg}function zg(e,t,n,r,i,a,o,s,u){var l=0,d=a,c=s.map(function(e){return e.kh});for((c=[].concat.apply([],m(c))).length&&(d=c[0].sampleSize||a),t.skip(o+s[0].pg);t.Ia();){o=t.U();var h=t.Y(),p=null;switch(p=!1,s=1,e.g){case Wg:p=6==(p=31&h);break;case Kg:s=2,t.skip(1),p=39==(p=h>>1&63)||40==p;break;case qg:s=2,t.skip(1),p=23==(p=h>>1&63)||24==p;break;default:return}if(p)for(h=0,l<c.length&&(h=c[l].Ff||0),h=(n+h)/r,p=(s=g(Hg(s=t.Ub(o-s,!1)))).next();!p.done;p=s.next())u.push({packet:p.value,pts:h});else try{t.skip(o-s)}catch(f){break}0==(d-=o+4)&&(n=l<c.length?n+(c[l].mh||i):n+i,d=++l<c.length&&c[l].sampleSize||a)}}Ug.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,Bg(this);for(var t=(e=g(this.j.values())).next();!t.done;t=e.next())Dg(t.value)},Ug.prototype.extract=function(e,t){if(this.C){for(var n=g(this.m.values()),r=n.next();!r.done;r=n.next())r.value.l=t;this.C=!1}if(!((e=new ra(e,0)).getLength()<8)&&181===e.Y()&&49===e.Ca()&&1195456820===e.U()&&3===e.Y()&&64&(n=e.Y()))for(n&=31,e.skip(1),r=0;r<n;r++){var i=e.Y(),a=(4&i)>>2,o=e.Y(),s=e.Y();a&&(0==(i&=3)||1===i?this.h.push({pts:t,type:i,Db:o,kc:s,order:this.h.length}):(this.g.push({pts:t,type:i,value:o,order:this.g.length}),this.g.push({pts:t,type:2,value:s,order:this.g.length})))}},Ug.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=g(this.h),r=n.next();!r.done;r=n.next())(r=jg(this,r.value))&&t.push(r);for(r=(n=g(this.g)).next();!r.done;r=n.next())Eg(this.i,r.value);for(r=(n=g(this.i.i)).next();!r.done;r=n.next())r=Fg(this,r.value),t.push.apply(t,m(r));return this.i.i=[],this.h=[],this.g=[],t},Ug.prototype.getStreams=function(){return Array.from(this.B)},V("shaka.cea.CeaDecoder",Ug),Nt=function(){return new Ug},Gg.prototype.init=function(e){function t(e){e=e.name,Yg.has(e)&&(n.g=Yg.get(e))}var n=this,r=[],i=[];if((new oa).box("moov",sa).box("mvex",sa).S("trex",function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.U(),t=t.U(),n.h=e,n.i=t}).box("trak",sa).S("tkhd",function(e){var t=e.reader;1==(e=e.version)?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4));var n=t.U();1==e?t.skip(8):t.skip(4),t.skip(4),t.skip(8),t.skip(2),t.skip(2),t.skip(2),t.skip(2),t.skip(36),t.Ca(),t.Ca(),t.Ca(),t.Ca(),r.push(n)}).box("mdia",sa).S("mdhd",function(e){e=io(e.reader,e.version),i.push(e.timescale)}).box("minf",sa).box("stbl",sa).S("stsd",ua).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",la).box("sinf",sa).box("frma",function(e){e=so(e.reader).codec,Yg.has(e)&&(n.g=Yg.get(e))}).parse(e,!0,!0),!r.length||!i.length||r.length!=i.length)throw new Ke(2,2,2010);this.g==Xg&&K("Unable to determine bitstream format for CEA parsing!"),r.forEach(function(e,t){n.j.set(e,i[t])})},Gg.prototype.parse=function(e){var t=this;if(this.g==Xg)return[];var n=[],r=0,i=[];return(new oa).box("moof",function(e){r=e.start,i=[],sa(e)}).box("traf",function(e){i.push({baseMediaDecodeTime:null,Vd:t.h,Wd:t.i,Gi:[],timescale:9e4}),sa(e)}).S("trun",function(e){var t=i[i.length-1];e=ao(e.reader,e.version,e.flags),t.Gi.push(e)}).S("tfhd",function(e){var n=i[i.length-1];e=no(e.reader,e.flags),n.Vd=e.Vd||t.h,n.Wd=e.Wd||t.i,e=e.trackId,t.j.has(e)&&(n.timescale=t.j.get(e))}).S("tfdt",function(e){var t=i[i.length-1];e=ro(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime}).box("mdat",function(e){for(var a=r-e.start-8,o=e.reader.Pa(),s=g(i),u=s.next();!u.done;u=s.next())null===(u=u.value).baseMediaDecodeTime?K("Unable to find base media decode time for CEA captions!"):(e.reader.seek(o),zg(t,e.reader,u.baseMediaDecodeTime,u.timescale,u.Vd,u.Wd,a,u.Gi,n))}).parse(e,!1,!0),n},V("shaka.cea.Mp4CeaParser",Gg);var Xg=0,Wg=1,Kg=2,qg=3,Yg=(new Map).set("avc1",Wg).set("avc3",Wg).set("dvav",Wg).set("dva1",Wg).set("hev1",Kg).set("hvc1",Kg).set("dvh1",Kg).set("dvhe",Kg).set("vvc1",qg).set("vvi1",qg).set("dvc1",qg).set("dvi1",qg);function $g(){this.g=null}function Jg(e){return(e=function(e){var t=0,n=Ue(e),r=n.getUint32(t,!0);if(r!=e.byteLength)return[];e:{for(e=t+4+2,t=[];e<n.byteLength-1;){r=n.getUint16(e,!0),e+=2;var i=n.getUint16(e,!0);if(e+=2,1&i||i+e>n.byteLength){n=[];break e}var a=Ne(n,e,i);t.push({type:r,value:a}),e+=i}n=t}return n}(e=ot(nn(e))).filter(function(e){return e.type===Zg})[0])&&(e=Jt(e=$e(e.value,!0),"WRMHEADER"))?e:null}function Qg(e){try{var t=Jg(e);if(t)e:{for(var n=g(an(t,"DATA")),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.children)for(var a=g(i.children),o=a.next();!o.done;o=a.next()){var s=o.value;if("LA_URL"==s.tagName){var u=nn(s);break e}}}u=""}else u="";return u}catch(l){return""}}Pt("video/mp4",function(){return new Gg}),$g.prototype.init=function(){},$g.prototype.parse=function(e){this.g?this.g.clearData():this.g=new Es;var t=[];if(!Ms(e=Ne(e)))return t;var n=(e=this.g.parse(e)).Xd(),r=e.df();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(r=(n=g(r)).next();!r.done;r=n.next())if(r=r.value,e.includes(r.type)&&null!=r.time)for(var i=g(Hg(r.data)),a=i.next();!a.done;a=i.next())t.push({packet:a.value,pts:r.time});return t},V("shaka.cea.TsCeaParser",$g),Pt("video/mp2t",function(){return new $g});var Zg=1;function em(){this.g=new Map}function tm(t,n,r,i){var a=function(e,t){for(var n=[],r=(t=g(t)).next();!r.done;r=t.next())(r=rm(e,r.value))&&n.push(r);return n}(t,n),o=null;t=[];var s=[];n=null;var u=new Set(a.map(function(e){return e.keyId}));u.delete(null);var l="cenc";if(u.size>1)throw new Ke(2,4,4010);if(!r){if((s=a.filter(function(e){return"urn:mpeg:dash:sea:2012"==e.Hd})).length>1)throw new Ke(2,4,4050);s.length&&(n=function(t){if(!e.crypto||!e.crypto.subtle)throw K("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new Ke(2,4,4042);var n=sn(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new Ke(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.attributes.schemeIdUri)throw new Ke(2,4,4051);if(!(n=sn(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod")))throw new Ke(2,4,4051);if(t=n.attributes.IV,n=tt(n.attributes.keyUriTemplate),!t||!n)throw new Ke(2,4,4051);if(16!=(t=st(t.substr(2))).byteLength)throw new Ke(2,4,4048);return{tk:n,iv:t}}(s[0])),(s=a.find(function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Hd}))&&s.encryptionScheme&&(l=s.encryptionScheme),(s=a.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Hd?(o=e.init||o,!1):"urn:mpeg:dash:sea:2012"!=e.Hd})).length&&(t=function(e,t,n,r,i){for(var a=[],o=(n=g(n)).next();!o.done;o=n.next()){var s=r[(o=o.value).Hd];if(s){var u;if((u=sn(o.node,"urn:microsoft:playready","pro"))&&nn(u)){u=ot(u=nn(u));var l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);u=[{initData:ya(u,l,new Set,0),initDataType:"cenc",keyId:o.keyId}]}else u=null;if(l=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===o.Hd){l=o;var d=i;if(0==d.size)l=null;else{var c=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]);l=[{initData:ya(new Uint8Array([]),c,d,1),initDataType:"cenc",keyId:l.keyId}]}}u=ct(s,t,o.init||e||u||l),(s=im.get(s))&&(u.licenseServerUri=s(o)),(o=sn(o.node,"https://dashif.org/CPS","Certurl"))&&(o=nn(o))||(o=""),u.serverCertificateUri=o,a.push(u)}}return a}(o,l,s,i,u),0==t.length&&(t=[ct("",l,o)]))}if(a.length&&!n&&(r||!s.length))for(t=[],i=(r=g(Object.values(i))).next();!i.done;i=r.next())"org.w3.clearkey"!=(i=i.value)&&(i=ct(i,l,o),t.push(i));if(u=Array.from(u)[0]||null)for(r=(l=g(t)).next();!r.done;r=l.next())for(i=(r=g(r.value.initData)).next();!i.done;i=r.next())i.value.keyId=u;return{Wh:u,Cm:o,drmInfos:t,gg:n,ai:!0}}function nm(e){var t=sn(e.node,"https://dashif.org/CPS","Laurl");if(t&&(t=nn(t)))return t;if((t=sn(e.node,"urn:microsoft:playready","pro"))&&nn(t))return Qg(t);if((e=sn(e.node,"urn:mpeg:cenc:2013","pssh"))&&(e=nn(e))){t=ot(e),e=8;var n=(t=Ue(t)).getUint8(e);return e+=20,n>0&&(e+=4+16*t.getUint32(e)),Qg(e=Jt("<pro>"+(e=it(e=Ne(t,e+4)))+"</pro>"))}return""}function rm(e,t){var n=t.attributes.schemeIdUri,r=ln(t,"urn:mpeg:cenc:2013","default_KID"),i=dn(t,"urn:mpeg:cenc:2013","pssh").map(rn),a=t.attributes.value;if(!n)return null;if(n=n.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase()).includes(" "))throw new Ke(2,4,4009);var o=[];try{o=i.map(function(t){if(!e.g.has(t)){var n=ot(t);e.g.set(t,n)}return{initDataType:"cenc",initData:e.g.get(t),keyId:null}})}catch(s){throw new Ke(2,4,4007)}return{node:t,Hd:n,keyId:r,init:o.length>0?o:null,encryptionScheme:a}}em.prototype.release=function(){this.g.clear()};var im=(new Map).set("com.apple.fps",function(t){if("apple"===e.shakaMediaKeysPolyfill)throw new Ke(2,4,4054);return(t=sn(t.node,"https://dashif.org/CPS","Laurl"))&&(t=nn(t))?t:""}).set("com.widevine.alpha",function(e){var t=sn(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=nn(t))?t:(e=sn(e.node,"urn:microsoft","laurl"))&&tt(e.attributes.licenseUrl)||""}).set("com.microsoft.playready",nm).set("com.microsoft.playready.recommendation",nm).set("com.microsoft.playready.software",nm).set("com.microsoft.playready.hardware",nm).set("org.w3.clearkey",function(e){var t=sn(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=nn(t))?t:(e=sn(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=nn(e))?e:""});function am(t,n,r,i,a,o){var s=(new Map).set("RepresentationID",n).set("Number",r).set("SubNumber",i).set("Bandwidth",a).set("Time",o);return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,r,i){if("$$"==t)return"$";var a=s.get(n);if(null==a)return t;switch("RepresentationID"==n&&r&&(r=void 0),"Time"==n&&"bigint"!=typeof a&&(Math.abs(a-Math.round(a))>=.2&&K("Calculated $Time$ values must be close to integers"),a=Math.round(a)),i){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return r=e.parseInt(r,10)||1,Array(Math.max(0,r-t.length)+1).join("0")+t})}function om(e,t){var n=um(e,t,"timescale"),r=1;n&&(r=mn(n)||1);var i=(n=mn((n=um(e,t,"duration"))||""))?n/r:null,a=um(e,t,"startNumber"),o=Number(um(e,t,"presentationTimeOffset"))||0,s=vn(a||"");if(null!=a&&null!=s||(s=1),a=null,t=lm(e,t,"SegmentTimeline")){t=tn(t,"S"),a=r,e=e.na.duration||1/0;for(var u=s,l=[],d=-o,c=0;c<t.length;++c){var h=t[c],p=t[c+1],f=un(h,"t",vn),g=un(h,"d",vn),m=un(h,"r",gn);if(h=un(h,"k",gn)||0,null!=f&&(f-=o),g){if(f=null!=f?f:d,(m=m||0)<0)if(p){if(null==(p=un(p,"t",vn)))break;if(f>=p)break;m=Math.ceil((p-f)/g)-1}else{if(e==1/0)break;if(f/a>=e)break;m=Math.ceil((e*a-f)/g)-1}for(l.length>0&&f!=d&&(l[l.length-1].end=f/a),p=0;p<=m;++p)d=f+g,l.push({start:f/a,end:d/a,Hh:f,wc:h,Tk:l.length+u}),f=d}}a=l}return{timescale:r,Pf:n,gb:i,ue:s,Jb:o/r||0,gd:o,timeline:a}}function sm(e,t){return[t(e.L),t(e.qa),t(e.sa)].filter(Dr)}function um(e,t,n){t=sm(e,t),e=null;for(var r=(t=g(t)).next();!r.done&&!(e=r.value.attributes[n]);r=t.next());return e}function lm(e,t,n){t=sm(e,t),e=null;for(var r=(t=g(t)).next();!r.done&&!(e=on(r.value,n));r=t.next());return e}function dm(e,t,n,r,i,a){if(a=void 0===a?0:a,ln(e,"http://www.w3.org/1999/xlink","href")){var o=function(e,t,n,r,i,a){for(var o=ln(e,"http://www.w3.org/1999/xlink","href"),s=ln(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=g(Object.keys(e.attributes)),l=u.next();!l.done;l=u.next()){var d=(l=l.value).split(":"),c=Qt("http://www.w3.org/1999/xlink");d[0]==c&&delete e.attributes[l]}if(a>=5)return Ri(new Ke(2,4,4028));if("onLoad"!=s)return Ri(new Ke(2,4,4027));var h=dt([r],[o]);return i.request(0,zi(h,t)).Xa(function(r){if(!(r=$t(r.data,e.tagName)))return Ri(new Ke(2,4,4001,o));for(e.children=[];r.children.length;){var s=r.children.shift();e.children.push(s)}for(var u=(s=g(Object.keys(r.attributes))).next();!u.done;u=s.next())u=u.value,e.attributes[u]=r.attributes[u];return dm(e,t,n,h[0],i,a+1)})}(e,t,n,r,i,a);return n&&(o=o.Xa(void 0,function(){return dm(e,t,n,r,i,a)})),o}o=[];for(var s=g(en(e)),u=s.next(),l={};!u.done;l={Sd:void 0},u=s.next())l.Sd=u.value,"urn:mpeg:dash:resolve-to-zero:2013"==ln(l.Sd,"http://www.w3.org/1999/xlink","href")?e.children=e.children.filter(function(e){return function(t){return t!==e.Sd}}(l)):"SegmentTimeline"!=l.Sd.tagName&&o.push(dm(l.Sd,t,n,r,i,a));return Li(o).Xa(function(){return e})}function cm(e,t,n,r,i,a,o){var s,u=(new oa).S("sidx",function(e){s=function(e,t,n,r,i,a,o){var s=[];o.reader.skip(4);var u=o.reader.U();if(0==u)throw new Ke(2,3,3005);if(0==o.version)var l=o.reader.U(),d=o.reader.U();else l=o.reader.Ed(),d=o.reader.Ed();o.reader.skip(2);var c=o.reader.Ca();for(e=e+o.size+d,d=0;d<c;d++){var h=o.reader.U(),p=(2147483648&h)>>>31;h&=2147483647;var f=o.reader.U();if(o.reader.skip(4),1==p)throw new Ke(2,3,3006);s.push(new Vo(l/u+n,(l+f)/u+n,function(){return a},e,e+h-1,t,n,r,i)),l+=f,e+=h}return o.parser.stop(),s}(t,r,i,a,o,n,e)});if(e&&u.parse(e),s)return s;throw new Ke(2,3,3004)}function hm(e){this.h=Ue(e),this.g=new ra(this.h,0)}function pm(e){var t=fm(e);if(t.length>7)throw new Ke(2,3,3002);for(var n=0,r=(t=g(t)).next();!r.done;r=t.next())n=256*n+r.value;t=fm(e);e:{for(var i=(r=g(gm)).next();!i.done;i=r.next())if(De(t,new Uint8Array(i.value))){r=!0;break e}r=!1}if(r)t=e.h.byteLength-e.g.Pa();else{if(8==t.length&&224&t[1])throw new Ke(2,3,3001);for(i=r=0;i<t.length;i++){var a=t[i];r=0==i?a&(1<<8-t.length)-1:256*r+a}t=r}return t=e.g.Pa()+t<=e.h.byteLength?t:e.h.byteLength-e.g.Pa(),r=Ue(e.h,e.g.Pa(),t),e.g.skip(t),new mm(n,r)}function fm(e){var t=e.g.Pa(),n=e.g.Y();if(0==n)throw new Ke(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Ne(e.h,t,n)}hm.prototype.Ia=function(){return this.g.Ia()};var gm=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function mm(e,t){this.id=e,this.g=t}function vm(e){if(e.g.byteLength>8)throw new Ke(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new Ke(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++)t=256*t+e.g.getUint8(n);return t}function ym(e){var t=new hm(e.g);if(179!=(e=pm(t)).id)throw new Ke(2,3,3013);if(e=vm(e),183!=(t=pm(t)).id)throw new Ke(2,3,3012);t=new hm(t.g);for(var n=0;t.Ia();){var r=pm(t);if(241==r.id){n=vm(r);break}}return{kl:e,Lk:n}}function bm(e,t,n){if(!(t=lm(e,t,"Initialization")))return null;var r=e.L.cb(),i=t.attributes.sourceURL;i&&(r=dt(r,[tt(i)],e.Mb())),i=0;var a=null;return(t=un(t,"range",fn))&&(i=t.start,a=t.end),(n=new jo(function(){return r},i,a,Em(e),null,null,n,e.qa.encrypted)).codecs=e.L.codecs,n.mimeType=e.L.mimeType,e.na&&!e.na.jf&&(n.g=e.na.start+e.na.duration),n}function xm(e,t,n){var r=Number(um(e,wm,"presentationTimeOffset"))||0,i=um(e,wm,"timescale"),a=1;i&&(a=mn(i)||1);var o=r/a||0,s=bm(e,wm,n);!function(e,t){if(Am(e,t),!Sm(e))throw new Ke(2,4,4002)}(e,s);var u=qt(e);return{endTime:-1,timeline:-1,Sc:function(){var e=lm(u,wm,"RepresentationIndex"),n=u.L.cb();return e&&(e=tt(e.attributes.sourceURL))&&(n=dt(n,[e],u.Mb())),e=Sm(u),Tm(u,t,s,n,e.start,e.end,o)},timescale:a}}function Tm(e,t,n,r,i,a,o){var s,u,l,d,c,h,p,f,m,v,y,b,T,w,S,A,E,k;return P(function(I){if(1==I.g)return s=e.presentationTimeline,u=!e.Fb||!e.na.jf,l=e.na.start,d=e.na.duration,c=e.L.mimeType.split("/")[1],p=null,f=[(h=t)(r,i,a,!1),"webm"==c?h(n.P(),n.startByte,n.endByte,!0):null],h=null,x(I,Promise.all(f),2);if(m=I.h,v=m[0],y=m[1]||null,T=l-o,w=l,S=d?l+d:1/0,"mp4"==c)var C=cm(v,i,r,n,T,w,S);else{C=v;var M=new hm(y);if(440786851!=pm(M).id)throw new Ke(2,3,3008);var R=pm(M);if(408125543!=R.id)throw new Ke(2,3,3009);M=R.g.byteOffset,R=new hm(R.g);for(var _=null;R.Ia();){var P=pm(R);if(357149030==P.id){_=P;break}}if(!_)throw new Ke(2,3,3010);for(_=new hm(_.g),P=1e6,R=null;_.Ia();){var D=pm(_);if(2807729==D.id)P=vm(D);else if(17545==D.id)if(4==D.g.byteLength)R=D.g.getFloat32(0);else{if(8!=D.g.byteLength)throw new Ke(2,3,3003);R=D.g.getFloat64(0)}}if(null==R)throw new Ke(2,3,3011);if(R*=_=P/1e9,475249515!=(C=pm(new hm(C))).id)throw new Ke(2,3,3007);C=function(e,t,n,r,i,a,o,s,u){function l(){return i}var d=[];e=new hm(e.g);for(var c=null,h=null;e.Ia();){var p=pm(e);if(187==p.id){var f=ym(p);f&&(p=n*f.kl,f=t+f.Lk,null!=c&&d.push(new Vo(c+o,p+o,l,h,f-1,a,o,s,u)),c=p,h=f)}}return null!=c&&d.push(new Vo(c+o,r+o,l,h,null,a,o,s,u)),d}(C,M,_,R,r,n,T,w,S)}for(A=g(b=C),E=A.next();!E.done;E=A.next())(k=E.value).codecs=e.L.codecs,k.mimeType=e.L.mimeType,k.bandwidth=e.bandwidth;return s.le(b),p=new Pu(b),u&&p.pd(w,S,!0),I.return(p)})}function wm(e){return e.Id}function Sm(e){var t=lm(e,wm,"RepresentationIndex");return e=fn((e=um(e,wm,"indexRange"))||""),t&&(e=un(t,"range",fn,e)),e}function Am(e,t){var n=e.L.mimeType.split("/")[1];if(e.L.contentType!=mt&&"mp4"!=n&&"webm"!=n)throw new Ke(2,4,4006);if("webm"==n&&!t)throw new Ke(2,4,4005)}function Em(e){var t=e.L;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.xf,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.qa.label||null,roles:e.roles||null,language:e.qa.language||null}}function km(e,t,n){var r=bm(e,Im,n),i=function(e){var t=function(e){return[e.L.Ac,e.qa.Ac,e.sa.Ac].filter(Dr).map(function(e){return tn(e,"SegmentURL")}).reduce(function(e,t){return e.length>0?e:t}).map(function(t){return t.attributes.indexRange&&!e.Ng&&(e.Ng=!0),{Ak:tt(t.attributes.media),start:(t=un(t,"mediaRange",fn,{start:0,end:null})).start,end:t.end}})}(e),n=(e=om(e,Im)).ue;0==n&&(n=1);var r=0;return e.gb?r=e.gb*(n-1):e.timeline&&e.timeline.length>0&&(r=e.timeline[0].start),{gb:e.gb,startTime:r,ue:n,Jb:e.Jb,timescale:e.timescale,timeline:e.timeline,yd:t}}(e);if(!i.gb&&!i.timeline&&i.yd.length>1)throw new Ke(2,4,4002);if(!i.gb&&!e.na.duration&&!i.timeline&&1==i.yd.length)throw new Ke(2,4,4002);if(i.timeline&&0==i.timeline.length)throw new Ke(2,4,4002);var a=null,o=null;e.sa.id&&e.L.id&&(o=t.get(e.sa.id+","+e.L.id))&&(a=o.segmentIndex);var s=function(e,t,n,r,i,a,o,s,u,l){var d=r.yd.length;r.timeline&&r.timeline.length!=r.yd.length&&(d=Math.min(r.timeline.length,r.yd.length));for(var c=e-r.Jb,h=t?e+t:1/0,p=[],f=r.startTime,g={},m=0;m<d;g={Rf:void 0,Gf:void 0},m++){g.Gf=r.yd[m];var v=f;f=void 0,f=null!=r.gb?v+r.gb:r.timeline?r.timeline[m].end:v+t,g.Rf=null,(g=new Vo(e+v,e+f,function(e){return function(){return null==e.Rf&&(e.Rf=dt(n(),[e.Gf.Ak],l())),e.Rf}}(g),g.Gf.start,g.Gf.end,i,c,e,h,[],"",null,null,zo,a)).codecs=s,g.mimeType=o,g.bandwidth=u,p.push(g)}return p}(e.na.start,e.na.duration,e.L.cb,i,r,n,e.L.mimeType,e.L.codecs,e.bandwidth,e.Mb);return t=!a,a?a.je(s,e.presentationTimeline.Ib()):a=new Pu(s),e.presentationTimeline.le(s),e.Fb&&e.na.jf||a.pd(e.na.start,e.na.duration?e.na.start+e.na.duration:1/0,t),o&&(o.segmentIndex=a),{endTime:-1,timeline:-1,Sc:function(){return a&&0!=a.getNumReferences()||a.rf(s),Promise.resolve(a)},timescale:i.timescale}}function Im(e){return e.Ac}function Cm(t,n,r,i,a,o,s,u,l,d){l||t.L.gf||(t.L.gf=um(t,Mm,"initialization"));var c=t.L.gf?function(e,t){var n=e.L.gf;if(n||(n=um(e,Mm,"initialization")),!n)return null;n=tt(n);var r=e.L.originalId,i=e.bandwidth||null,a=e.L.cb,o=e.Mb;return t=new jo(function(){var e=am(n,r,null,null,i,null);return dt(a(),[e],o())},0,null,Em(e),null,null,t,e.qa.encrypted),t.codecs=e.L.codecs,t.mimeType=e.L.mimeType,e.na&&!e.na.jf&&(t.g=e.na.start+e.na.duration),t}(t,s):null,h=function(e){var t=om(e,Mm),n=um(e,Mm,"media"),r=um(e,Mm,"index"),i=um(e,Mm,"k"),a=0;return i&&(a=parseInt(i,10)),{Pf:t.Pf,gb:t.gb,timescale:t.timescale,ue:t.ue,Jb:t.Jb,gd:t.gd,timeline:t.timeline,cc:n&&tt(n),ee:r,mimeType:e.L.mimeType,codecs:e.L.codecs,bandwidth:e.bandwidth,Bk:a}}(t);!function(e){var t=e.ee?1:0;if(t+=e.timeline?1:0,0==(t+=e.gb?1:0))throw new Ke(2,4,4002);if(1!=t&&(e.ee&&(e.timeline=null),e.Pf=null,e.gb=null),!e.ee&&!e.cc)throw new Ke(2,4,4002)}(h);var p=qt(t);if(h.ee)return Am(t,c),{endTime:-1,timeline:-1,Sc:function(){var e=am(h.ee,p.L.originalId,null,null,p.bandwidth||null,null);return e=dt(p.L.cb(),[e]),Tm(p,n,c,e,0,null,h.Jb)},timescale:h.timescale};if(h.gb)return i||"image"===t.qa.contentType||"text"===t.qa.contentType||(i=t.na.start,d=t.sa.id,r=t.na.duration,d=(d=null!=d&&o.get(d)||r)?i+d:1/0,t.presentationTimeline.Vg(h.gb),t.presentationTimeline.Ei(i,d)),{endTime:-1,timeline:-1,Sc:function(){return function(t,n,r,i,a,o,s,u){function l(r){var a=r-y,s=a*v,l=n.Pf,d=a*l;"BigInt"in e&&d>Number.MAX_SAFE_INTEGER&&(d=BigInt(a)*BigInt(l)),a=(s+=p)+v,l=Math.min(a,c());var h=[],f=n.Bk;if(f)for(var g=(l-s)/f,m={},E=0;E<f;m={$i:void 0},E++){var k=s+g*E,I=k+g;m.$i=E,(m=new Vo(k,I,function(e){return function(){var t=am(b,T,r,e.$i,x,d);return dt(w(),[t],S())}}(m),0,null,i,A,p,c(),[],"",null,null,zo,o)).codecs=t.L.codecs,m.mimeType=t.L.mimeType,0==u?E>0&&m.wd():E%u!=0&&m.wd(),h.push(m)}return(s=new Vo(s,l,function(){if(f)return[];var e=am(b,T,r,null,x,d);return dt(w(),[e],S())},0,null,i,A,p,c(),h,"",null,null,zo,o,h.length>0)).codecs=t.L.codecs,s.mimeType=t.L.mimeType,s.bandwidth=t.bandwidth,s.j=a,s}function d(){var e=[Math.max(h.Ib(),p),Math.min(h.Ic(),c())].map(function(e){return e-p});return e=[Math.ceil(e[0]/v),Math.ceil(e[1]/v)-1],t.L.rb&&e[1]++,e.map(function(e){return e+y})}function c(){var e=null!=f&&a.get(f)||m;return e?p+e:1/0}var h=t.presentationTimeline,p=t.na.start,f=t.sa.id,m=t.na.duration,v=n.gb,y=n.ue,b=n.cc,x=t.bandwidth||null,T=t.L.originalId,w=t.L.cb,S=t.Mb,A=p-n.Jb,E=d();r=t.Fb?Math.max(E[0],E[1]-r+1):E[0],s=s||E[1],E=[];for(var k=r;k<=s;++k){var I=l(k);E.push(I)}var C=new Pu(E);if(E=h.Ic()<c(),k=h.W(),E||k){var M=Math.max(r,s+1);r=v,t.L.rb&&(r=.1),C.Qf(r,function(){var e=h.Ib();C.Ya(e);var t=g(d());t.next(),t=t.next().value;for(var n=[];M<=t;){var r=l(M);n.push(r),M++}return e>c()&&!n.length?null:n})}return Promise.resolve(C)}(p,h,a,c,o,s,u,t.L.Hf)},timescale:h.timescale};var f=null;i=i=null,t.sa.id&&t.L.id&&(i=t.sa.id+","+t.L.id,i=r.get(i))&&(f=i.segmentIndex);var m=t.na.start,v=t.na.duration?m+t.na.duration:1/0;if(f)_m(d=f,h,m,v,c,t.Fb),d.Ya(t.presentationTimeline.Ib());else{if(r=0,l=-1,null!=t.sa.id&&null!=t.L.id){var y=d.get(t.sa.id);if(y)l=y.timeline;else for(y=(d=g(d.values())).next();!y.done;y=d.next()){if(y=y.value,Math.abs(h.Jb-y.endTime)<=yt&&y.fh.includes(t.L.id)){l=y.timeline;break}y.timeline>=r&&(r=y.timeline+1)}}-1==l&&(l=r),f=new Rm(t.Fb,h,t.L.originalId,t.bandwidth,t.L.cb,t.Mb,m,v,c,s,t.L.Hf,l)}return h.timeline&&"image"!==t.qa.contentType&&"text"!==t.qa.contentType&&t.presentationTimeline.Fi(f.h?f.h.timeline:[],m),i&&t.Fb&&(i.segmentIndex=f),i=(i=(i=h.timeline)&&i[i.length-1])?i.end+h.Jb:-1,d=-1,f instanceof Rm&&(d=f.Ve()),{endTime:i,timeline:d,Sc:function(){return f instanceof Rm&&0==f.getNumReferences()&&_m(f,h,m,v,c,t.Fb),Promise.resolve(f)},timescale:h.timescale}}function Mm(e){return e.Oc}function Rm(e,t,n,r,i,a,o,s,u,l,d,c){Pu.call(this,[]),this.F=e,this.h=t,this.H=n,this.C=r,this.G=i,this.J=a,this.j=o,this.l=s,this.u=u,this.B=l,this.I=d,this.K=c,Pm(this)}function _m(e,t,n,r,i,a){if(function(e,t){if(e.u!==t){e.u=t;for(var n=(e=g(e.g)).next();!n.done;n=e.next())(n=n.value)&&Go(n,t)}}(e,i),e.F=a,e.h){if(e.h.gd!==t.gd&&(e.h.timeline=t.timeline,e.h.gd=t.gd,e.h.Jb=t.Jb),e.h.cc!==t.cc&&(e.h.cc=t.cc),(n=e.h.timeline).length){var o=n[n.length-1];t=t.timeline.filter(function(e){return e.end>o.end})}else t=t.timeline.slice();t.length>0&&e.h.timeline.push.apply(e.h.timeline,m(t)),e.l!==r&&(e.l=r)}else e.h=t,e.j=n,e.l=r;Pm(e)}function Pm(e){if(e.h&&!e.o){for(var t=[],n=g(e.h.timeline),r=n.next();!r.done;r=n.next())(r=r.value).start>=e.l||r.end<=0||t.push(r);e.h.timeline=t,e.Ya(e.j)}}function Dm(e,t,n,r,i,a,o,s){return e=am(e,t,n,a,r||null,i),dt(o(),[e],s()).map(function(e){return e.toString()})}function Lm(e){this.o=null,this.B=e,this.H=new ji,this.i=[],this.h=null,this.m=[],this.C=null,this.G=[],this.F=300,this.l=new Map,this.j=new Map,this.g=null,this.u="UNKNOWN"}function Nm(e,t){var n,r,i,a,o,s,u;return P(function(l){return 1==l.g?(n=dt(e.i,[Om(e,t)]),r=zi(n,e.o.retryParameters),i=e.B.networkingEngine.request(8,r),Fi(e.H,i),w(l,2),x(l,i.promise,4)):2!=l.g?(a=l.h,o=Ye(a.data),1==(s=JSON.parse(o)).VERSION&&function(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var r=t["RELOAD-URI"]||n;e.g=new Rr(function(){Nm(e,r)}),(n=t.TTL)&&(e.F=n),e.g.ka(e.F),e.m=t["PATHWAY-PRIORITY"]||[],e.G=t["PATHWAY-CLONES"]||[]}(e,s,a.uri),A(l,0)):(u=E(l))&&7001==u.code?l.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new Rr(function(){Nm(e,t)}),e.g.ka(e.F),void T(l))})}function Om(e,t){if(!e.m.length)return t;t=new me(t);var n=e.C||e.m[0],r=Math.round(e.B.getBandwidthEstimate()),i=t.g;return"DASH"==e.u?(i.add("_DASH_pathway",n),i.add("_DASH_throughput",String(r))):"HLS"==e.u&&(i.add("_HLS_pathway",n),i.add("_HLS_throughput",String(r))),_e(i)&&xe(t,i),t.toString()}function Um(e,t,n,r){var i=e.l.get(t);i||(i=new Map),i.set(n,r),e.l.set(t,i)}function Bm(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var r=[],i=g(e.m),a=i.next(),o={};!a.done;o={Cd:void 0},a=i.next())if(o.Cd=a.value,a=t.get(o.Cd))r.push({$g:o.Cd,location:a});else if(a=e.G.find(function(e){return function(t){return t.Ml==e.Cd}}(o))){var s=t.get(a["BASE-ID"]);s&&(a["URI-REPLACEMENT"].mj?(ye(s=new me(s),a["URI-REPLACEMENT"].mj),r.push({$g:o.Cd,location:s.toString()})):r.push({$g:o.Cd,location:s}))}for(i=Date.now(),a=(o=g(e.j.keys())).next();!a.done;a=o.next())a=a.value,i>(s=e.j.get(a))&&e.j.delete(a);if(r=r.filter(function(t){for(var n=g(e.j.keys()),r=n.next();!r.done;r=n.next())if(r.value.includes(new me(t.location).Eb))return!1;return!0}),r.length&&(e.C=r[0].$g),r=r.map(function(e){return e.location}),!r.length&&e.h)for(o=(i=g(e.h.split(","))).next();!o.done;o=i.next())(o=t.get(o.value))&&(e.C=e.h,r.push(o));if(!r.length)for(i=(t=g(t.values())).next();!i.done;i=t.next())r.push(i.value);return n?r:dt(e.i,r)}function jm(){this.l=[],this.h=[],this.g=[],this.j=[],this.i=[],this.o=!1,this.m=new Set}function Fm(e,t){for(var n=[],r=[],i=[],a=[],o=(e=g(e)).next();!o.done;o=e.next()){var s=o.value;o=new Map(s.audioStreams.map(function(e){return[pv(e),e]}));var u=new Map(s.videoStreams.map(function(e){return[hv(e),e]})),l=new Map(s.textStreams.map(function(e){return[fv(e),e]}));if(s=new Map(s.imageStreams.map(function(e){return[gv(e),e]})),t){var d=sv(mt);l.set(fv(d),d),d=sv("image"),s.set(gv(d),d)}n.push(o),r.push(u),i.push(l),a.push(s)}return{Qh:n,kj:r,fj:i,ni:a}}function Vm(e){var t,n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,T,w,S,A,E,k,I,C,M,R,_;return P(function(P){switch(P.g){case 1:if(t=vt,1==e.length)return P.return(e[0]);for(n=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.aa}).map(function(e){return[pv(e),e]}))}),r=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.wa}).map(function(e){return[hv(e),e]}))}),i=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.Na}).map(function(e){return[fv(e),e]}))}),a=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.Xf}).map(function(e){return[gv(e),e]}))}),o=g(i),s=o.next();!s.done;s=o.next())u=s.value,l=ov(t.Na),u.set(fv(l),l);for(d=g(a),c=d.next();!c.done;c=d.next())h=c.value,p=ov(t.Xf),h.set(gv(p),p);return x(P,Hm(f=new jm,[],n,0,Km,Ym,0),2);case 2:return m=P.h,x(P,Hm(f,[],r,0,Km,Ym,0),3);case 3:return v=P.h,x(P,Hm(f,[],i,0,Km,Ym,0),4);case 4:return y=P.h,x(P,Hm(f,[],a,0,Km,Ym,0),5);case 5:if(b=P.h,T=0,v.length&&m.length)for(E=g(m),k=E.next();!k.done;k=E.next())for(I=k.value,C=g(v),M=C.next();!M.done;M=C.next())R=M.value,_=T++,R.variantIds.push(_),I.variantIds.push(_);else for(w=v.concat(m),S=g(w),A=S.next();!A.done;A=S.next())A.value.variantIds=[T++];return P.return(v.concat(m).concat(y).concat(b))}})}function Hm(e,t,n,r,i,a,o){var s,u,l,d,c,h,p,f,m,v,y,b,T,w,S,A,E,k;return P(function(I){switch(I.g){case 1:for(s=[],u=0;u<n.length;u++)u>=r?s.push(new Set(n[u].values())):s.push(new Set);l=g(t),d=l.next();case 2:if(d.done){I.A(4);break}return c=d.value,x(I,function(e,t,n,r,i,a,o){return P(function(s){return 1==s.g?($m(e,n,t,o>0),t.matchedStreams?t.segmentIndex?x(s,Gm(t,r+o),2):s.A(2):s.return(!1)):(Xm(t,r,i,a,o),s.return(!0))})}(e,c,n,r,a,s,o),5);case 5:if(!I.h)throw new Ke(2,4,4037);d=l.next(),I.A(2);break;case 4:for(h=g(s),p=h.next();!p.done;p=h.next())for(f=p.value,m=g(f),v=m.next();!v.done;v=m.next())y=v.value,(b=zm(e,t,y,n,i,a,s))&&t.push(b);for(T=g(s),w=T.next();!w.done;w=T.next())for(S=w.value,A=g(S),E=A.next(),k={};!E.done;k={xh:void 0},E=A.next())if(k.xh=E.value,!cv(k.xh)&&t.some(function(e){return function(t){return Zm(e.xh,t)}}(k)))throw new Ke(2,4,4037);return I.return(t)}})}function Gm(e,t){var n,r,i,a,o,s;return P(function(u){if(1==u.g){for(n=[],r=e.matchedStreams,i=t;i<r.length;i++)a=r[i],n.push(a.createSegmentIndex()),a.trickModeVideo&&!a.trickModeVideo.segmentIndex&&n.push(a.trickModeVideo.createSegmentIndex()),a.dependencyStream&&!a.dependencyStream.segmentIndex&&n.push(a.dependencyStream.createSegmentIndex());return x(u,Promise.all(n),2)}if(e.segmentIndex instanceof Ou)for(o=t;o<r.length;o++)(s=r[o]).segmentIndex&&e.segmentIndex.h.push(s.segmentIndex);T(u)})}function zm(e,t,n,r,i,a,o){if(cv(n))return null;var s=i(n);return $m(e,r,s),s.createSegmentIndex&&(s.createSegmentIndex=function(){return P(function(e){return s.segmentIndex?e.A(0):(s.segmentIndex=new Ou,x(e,Gm(s,0),0))})},s.closeSegmentIndex=function(){if(s.segmentIndex&&(s.segmentIndex.release(),s.segmentIndex=null),s.matchedStreams)for(var e=g(s.matchedStreams),n=e.next();!n.done;n=e.next()){var r;if(r=(n=n.value).segmentIndex){e:{for(var i=(r=g(t)).next();!i.done;i=r.next())if((i=i.value)!==s&&i.segmentIndex&&i.matchedStreams&&i.matchedStreams.includes(n)){r=!0;break e}r=!1}r=!r}r&&(n.segmentIndex.release(),n.segmentIndex=null)}}),s.matchedStreams&&s.matchedStreams.length?(Xm(s,0,a,o,0),s):null}function Xm(e,t,n,r,i){var a=e.matchedStreams;for(t+=i;t<a.length;t++){var o=a[t];n(e,o);var s=!0;if("audio"==e.type&&0==Fr(e.language,o.language)&&(s=!1),s&&((s=r[t-i])&&s.delete(o),o.fullMimeTypes))for(s=(o=g(o.fullMimeTypes.values())).next();!s.done;s=o.next())e.fullMimeTypes.add(s.value)}}function Wm(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t.dependencyStream=null,t}function Km(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t}function qm(e,t){function n(e,t){e||(e=[]);for(var n=(t=g(t)).next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var r=g(t.keyIds),i=r.next();!i.done;i=r.next())e.keyIds.add(i.value);if(null==e.originalId?e.originalId=t.originalId:(r=t.originalId||"")&&!e.originalId.endsWith(r)&&(e.originalId+=","+r),r=Fe(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!r.length)throw new Ke(2,4,4038);if(e.drmInfos=r,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),i=(r=g(t.closedCaptions)).next();!i.done;i=r.next()){var a=g(i.value);i=a.next().value,a=a.next().value,e.closedCaptions.set(i,a)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=Wm(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();for(var t=new Ou,n=g(e.trickModeVideo.matchedStreams),r=n.next();!r.done;r=n.next())t.h.push(r.value.segmentIndex);return e.trickModeVideo.segmentIndex=t,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),qm(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),qm(e.trickModeVideo,t)),t.dependencyStream?(e.dependencyStream||(e.dependencyStream=Wm(t.dependencyStream),e.dependencyStream.matchedStreams=[],e.dependencyStream.createSegmentIndex=function(){if(e.dependencyStream.segmentIndex)return Promise.resolve();for(var t=new Ou,n=g(e.dependencyStream.matchedStreams),r=n.next();!r.done;r=n.next())t.h.push(r.value.segmentIndex);return e.dependencyStream.segmentIndex=t,Promise.resolve()}),e.dependencyStream.matchedStreams.push(t.dependencyStream),qm(e.dependencyStream,t.dependencyStream)):e.dependencyStream&&(e.dependencyStream.matchedStreams.push(t),qm(e.dependencyStream,t))}function Ym(e,t){var n=e.roles;n||(n=[]);for(var r=g(t.roles),i=r.next();!i.done;i=r.next())i=i.value,n.includes(i)||n.push(i);for(e.roles=n,r=(n=g(t.keyIds)).next();!r.done;r=n.next())e.keyIds.add(r.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,m(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(t=g(t.closedCaptions)).next();!n.done;n=t.next())n=(r=g(n.value)).next().value,r=r.next().value,e.closedCaptions.set(n,r)}function $m(e,t,n,r){r=void 0!==r&&r?n.matchedStreams:[];for(var i=(t=g(t)).next();!i.done;i=t.next()){if(!(i=Jm(e,i.value,n)))return;r.push(i)}n.matchedStreams=r}function Jm(e,t,n){var r={audio:pv,video:hv,text:fv,image:gv}[n.type],i=null,a=r(n);if(t.has(a))i=t.get(a);else{a={audio:function(e,t){return Zm(e,t)},video:function(e,t){return Zm(e,t)},text:ev,image:tv}[n.type];for(var o={audio:nv,video:rv,text:iv,image:av}[n.type],s=g(t.values()),u=s.next();!u.done;u=s.next())!a(n,u=u.value)||n.fastSwitching!=u.fastSwitching||i&&!o(n,i,u)||(i=u)}return e.o&&!cv(i)&&t.delete(r(i)),i}function Qm(e,t){return e.mimeType==t.mimeType&&vv(e.codecs)===vv(t.codecs)}function Zm(e,t){return!(e.drmInfos&&!je(e.drmInfos,t.drmInfos))}function ev(e,t){return!t.language||e.forced===t.forced&&0!=Fr(e.language,t.language)&&t.kind==e.kind}function tv(){return!0}function nv(e,t,n){var r=lv(e,t,n);if(r===yv)return!0;if(r===xv)return!1;r=Fr(e.language,t.language);var i=Fr(e.language,n.language);if(i>r)return!0;if(i<r)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(r=t.roles.filter(function(t){return e.roles.includes(t)}),(i=n.roles.filter(function(t){return e.roles.includes(t)})).length>r.length)return!0;if(i.length<r.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&((r=uv(e.channelsCount,t.channelsCount,n.channelsCount))==yv||r!=xv&&((r=uv(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate))==yv||r!=xv&&!(!e.bandwidth||dv(e.bandwidth,t.bandwidth,n.bandwidth)!=yv)))}function rv(e,t,n){var r=lv(e,t,n);if(r===yv)return!0;if(r===xv)return!1;if((r=uv(e.width*e.height,t.width*t.height,n.width*n.height))==yv)return!0;if(r==xv)return!1;if(e.frameRate){if((r=uv(e.frameRate,t.frameRate,n.frameRate))==yv)return!0;if(r==xv)return!1}return!(!e.bandwidth||dv(e.bandwidth,t.bandwidth,n.bandwidth)!=yv)}function iv(e,t,n){var r=Fr(e.language,t.language),i=Fr(e.language,n.language);if(i>r)return!0;if(i<r)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(r=t.roles.filter(function(t){return e.roles.includes(t)}),(i=n.roles.filter(function(t){return e.roles.includes(t)})).length>r.length)return!0;if(i.length<r.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function av(e,t,n){return uv(e.width*e.height,t.width*t.height,n.width*n.height)==yv}function ov(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1,baseOriginalId:null}}function sv(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Pu([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}}function uv(e,t,n){if(t==e&&e!=n)return xv;if(n==e&&e!=t)return yv;if(t>e){if(n<=e||n-e<t-e)return yv;if(n-e>t-e)return xv}else{if(n>e)return xv;if(e-n<e-t)return yv;if(e-n>e-t)return xv}return bv}function lv(e,t,n){var r=e.mimeType===t.mimeType&&e.codecs===t.codecs,i=e.mimeType===n.mimeType&&e.codecs===n.codecs;return r&&!i?xv:!r&&i?yv:(t=Qm(e,t),e=Qm(e,n),t&&!e?xv:!t&&e?yv:bv)}function dv(e,t,n){return t=Math.abs(e-t),(e=Math.abs(e-n))<t?yv:t<e?xv:bv}function cv(e){switch(e.type){case mt:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function hv(e){return mv([e.fastSwitching,e.width,e.frameRate,e.codecs,e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function pv(e){return mv([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,e.codecs,e.mimeType,e.roles,e.audioSamplingRate,e.primary,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function fv(e){return mv([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function gv(e){return mv([e.width,e.codecs,e.mimeType])}function mv(e){return JSON.stringify(e)}function vv(e){if(!Tv.has(e)){var t=fr(e);Tv.set(e,t)}return Tv.get(e)}p(Rm,Pu),(i=Rm.prototype).getNumReferences=function(){return this.h?this.h.timeline.length:0},i.release=function(){Pu.prototype.release.call(this),this.h=null},i.Ya=function(e){if(this.h){for(var t=0,n=this.h.timeline,r=0;r<n.length&&n[r].end+this.j<=e;r+=1)t+=1;t>0&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.i+=t,0===this.getNumReferences()&&this.release())}},i.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var t=this.h.timeline;if(e<this.j||e>=this.l)return null;for(var n=t.length-1,r=0;r<t.length;r++){var i=t[r],a=i.start+this.j;if(i=r<n?t[r+1].start+this.j:this.l===1/0?i.end+this.j:this.l,e>=a&&e<i)return r+this.i}return null},i.get=function(e){var t=this;if((e-=this.i)<0||e>=this.getNumReferences()||!this.h)return null;var n=this.g[e];if(!n){var r=(n=this.h.timeline[e]).Tk,i=n.Hh+this.h.gd,a=this.j-this.h.Jb,o=this.j+n.end,s=o;e===this.getNumReferences()-1&&this.l!==1/0&&(s=this.F&&Math.abs(s-this.l)>.1?Math.min(s,this.l):this.l);var u=this.h.codecs,l=this.h.mimeType,d=this.h.bandwidth,c=[],h=!1;if(n.wc&&this.h&&this.h.cc&&(h=this.h.cc.includes("$SubNumber$")),h){h=(n.end-n.start)/n.wc;for(var p={},f=0;f<n.wc;p={Sf:void 0,aj:void 0},f++){var g=n.start+h*f,m=g+h;p.aj=f,p.Sf=null,(p=new Vo(this.j+g,this.j+m,function(e){return function(){return t.h?(null==e.Sf&&(e.Sf=Dm(t.h.cc,t.H,r,t.C,i,e.aj,t.G,t.J)),e.Sf):[]}}(p),0,null,this.u,a,this.j,this.l,[],"",null,null,zo,this.B)).codecs=u,p.mimeType=l,p.bandwidth=d,0==this.I?f>0&&p.wd():f%this.I!=0&&p.wd(),c.push(p)}}(n=new Vo(this.j+n.start,s,function(){return c.length>0||!t.h?[]:Dm(t.h.cc,t.H,r,t.C,i,null,t.G,t.J)},0,null,this.u,a,this.j,this.l,c,"",null,null,zo,this.B,c.length>0)).codecs=u,n.mimeType=l,n.j=o,n.bandwidth=d,this.g[e]=n}return n},i.Gb=function(e){Pm(this);for(var t=0;t<this.getNumReferences();t++){var n=this.get(t+this.i);n&&e(n)}},i.Ve=function(){return this.K},Lm.prototype.configure=function(e){this.o=e},Lm.prototype.destroy=function(){return this.B=this.o=null,this.i=[],this.h=null,this.m=[],this.G=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.H.destroy()},Lm.prototype.setManifestType=function(e){this.u=e},Lm.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)},(i=jm.prototype).release=function(){for(var e=g(this.h.concat(this.g,this.j,this.i)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.j=[],this.i=[],this.l=[],this.o=!1,this.m.clear()},i.dk=function(){return this.l},i.Lg=function(){return this.j.slice()},i.Kj=function(){return this.i},i.Xh=function(e,t){if(e){if("audio"==e.type)for(var n=g(this.h),r=n.next();!r.done;r=n.next())(r=r.value).matchedStreams=r.matchedStreams.filter(function(t){return t!==e});else if("video"==e.type)for(r=(n=g(this.g)).next();!r.done;r=n.next())(r=r.value).matchedStreams=r.matchedStreams.filter(function(t){return t!==e}),r.trickModeVideo&&(r.trickModeVideo.matchedStreams=r.trickModeVideo.matchedStreams.filter(function(t){return t!==e})),r.dependencyStream&&(r.dependencyStream.matchedStreams=r.dependencyStream.matchedStreams.filter(function(t){return t!==e}));else if(e.type==mt)for(r=(n=g(this.j)).next();!r.done;r=n.next())(r=r.value).matchedStreams=r.matchedStreams.filter(function(t){return t!==e});else if("image"==e.type)for(r=(n=g(this.i)).next();!r.done;r=n.next())(r=r.value).matchedStreams=r.matchedStreams.filter(function(t){return t!==e});e.segmentIndex&&e.closeSegmentIndex(),this.m.delete(t)}},i.kg=function(e,t,n){n=void 0!==n&&n;var r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,w,S,A,E,k,I,C,M,R,_,D,L,N,O,U,B,j=this;return P(function(P){if(1==P.g){if(r=vt,!t&&1==e.length)return i=Fm(e,!1),a=i.Qh,o=i.kj,s=i.fj,u=i.ni,j.h=Array.from(a[0].values()),j.g=Array.from(o[0].values()),j.j=Array.from(s[0].values()),j.i=Array.from(u[0].values()),P.A(2);for(l=n?j.m.size:0,d=-1,c=0;c<e.length;c++)h=e[c],j.m.has(h.id)||(j.m.add(h.id),-1==d&&(d=c));return-1==d?P.return():(p=Fm(e,!0),f=p.Qh,m=p.kj,v=p.fj,y=p.ni,x(P,Promise.all([Hm(j,j.h,f,d,Wm,qm,l),Hm(j,j.g,m,d,Wm,qm,l),Hm(j,j.j,v,d,Wm,qm,l),Hm(j,j.i,y,d,Wm,qm,l)]),2))}if(b=0,w=[],j.g.length&&j.h.length)for(M=g(j.h),R=M.next();!R.done;R=M.next())for(_=R.value,D=g(j.g),L=D.next();!L.done;L=D.next())N=L.value,O=Fe(_.drmInfos,N.drmInfos),_.drmInfos.length&&N.drmInfos.length&&!O.length||(U=(_.bandwidth||0)+(N.bandwidth||0),_.dependencyStream&&(U+=_.dependencyStream.bandwidth||0),N.dependencyStream&&(U+=N.dependencyStream.bandwidth||0),B=b++,w.push({id:B,language:_.language,disabledUntilTime:0,primary:_.primary,audio:_,video:N,bandwidth:U,drmInfos:O,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(S=j.g.length?j.g:j.h,A=g(S),E=A.next();!E.done;E=A.next())k=E.value,I=b++,C=k.bandwidth||0,k.dependencyStream&&(C+=k.dependencyStream.bandwidth||0),w.push({id:I,language:k.language,disabledUntilTime:0,primary:k.primary,audio:k.type==r.aa?k:null,video:k.type==r.wa?k:null,bandwidth:C,drmInfos:k.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});j.l=w,T(P)})},i.Vi=function(e){this.o=e},V("shaka.util.PeriodCombiner",jm),jm.prototype.setUseStreamOnce=jm.prototype.Vi,jm.prototype.combinePeriods=jm.prototype.kg,jm.prototype.deleteStream=jm.prototype.Xh,jm.prototype.getImageStreams=jm.prototype.Kj,jm.prototype.getTextStreams=jm.prototype.Lg,jm.prototype.getVariants=jm.prototype.dk;var yv=1,bv=0,xv=-1,Tv=new Map;function wv(e,t){try{return function(e,t){var n=new DOMParser,r=Sv.value()(e);e=null;try{e=n.parseFromString(r,"text/xml")}catch(i){return null}if(!(n=e.documentElement)||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}(Je(e),t)}catch(n){return null}}var Sv=new ae(function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}});function Av(){var e=this;this.j=this.g=null,this.B=[],this.h=null,this.Fa=1,this.H=[],this.l={uf:"",type:"",profiles:[],uc:null,rb:0,cb:null,pe:0},this.u=new Map,this.C=new Map,this.o=new Map,this.F=new Map,this.za=new Map,this.m=new jm,this.K=0,this.Da=new H(5),this.M=new Rr(function(){e.J&&!e.g.continueLoadingWhenPaused&&(e.I.Ma(e.J,"timeupdate"),e.J.paused)?e.I.Aa(e.J,"timeupdate",function(){return Ov(e)}):Ov(e)}),this.R=new ji,this.O=null,this.G=[],this.ba=1/0,this.va=!1,this.i=null,this.N=0,this.T=!1,this.I=new ne,this.J=null,this.V=!1,this.$="",this.oa=function(){return!1},this.X=[],this.ma=new Set,this.ya=new em}function Ev(e){var t,n,r,i,a,o,s,u,l,d,c;return P(function(h){return 1==h.g?(t=4,n="MPD",r=function(e){var t=e.l.pe;if(!e.l.uf||!t||!e.H.length)return[];var n=Date.now()/1e3,r=e.H.filter(function(e){return!(e=vn(e.attributes.ttl))||t+e>n}).map(rn).filter(Dr);return r.length?dt(e.B,r):[]}(e),i=e.B,r.length?(i=r,n="Patch",t=6):e.B.length>1&&e.i&&(a=Bm(e.i,"Location",!0)).length&&(i=a),o=zi(i,e.g.retryParameters),s=Date.now(),x(h,Gv(e,o,0,{type:t}),2)):3!=h.g?(u=h.h,e.j?(u.uri&&u.uri!=u.originalUri&&!e.B.includes(u.uri)&&e.B.unshift(u.uri),l=new me(u.uri),e.$=l.g.toString(),x(h,function(e,t,n,r){var i,a,o,s,u,l,d,c;return P(function(h){if(1==h.g){if(i=t,(a=e.g.dash.manifestPreprocessor)!=ad){if(ce("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),!(o=wv(i,r)))throw new Ke(2,4,4001,n);a(o),i=Qe(o.outerHTML)}if(!(s=$t(i,r)))throw new Ke(2,4,4001,n);return(u=e.g.dash.manifestPreprocessorTXml)!=od&&u(s),"Patch"===r?h.return(function(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,v,y,b,w,S,A,E,k,I,C,M;return P(function(R){if(1==R.g){if(n=t.attributes.mpdId,r=un(t,"originalPublishTime",hn),!n||n!==e.l.uf||r!==e.l.pe)throw e.H=[],new Ke(1,4,4052);for(i=[],a=[],o=new Set,s=g(en(t)),u=s.next();!u.done;u=s.next())if(l=u.value,d=Tn(l.attributes.sel||""),c=d[d.length-1],h=rn(l)||"","MPD"===c.name)if("mediaPresentationDuration"===c.Dc){var _=pn(rn(l)||"");if(null!=_){e.l.uc=_;for(var P=g(e.u.values()),D=P.next();!D.done;D=P.next())D.value.uc=_}}else if("type"===c.Dc){for(e.h.presentationTimeline.cd("static"==h),e.l.type=h,P=(_=g(e.u.values())).next();!P.done;P=_.next())P.value.Fb="dynamic"==h;"static"==h&&(e.K=-1)}else"publishTime"===c.Dc?e.l.pe=hn(h)||0:null===c.Dc&&"add"===l.tagName&&a.push(l);else if("PatchLocation"===c.name)wn(e.H,l);else if("Period"===c.name)"add"===l.tagName?a.push(l):"remove"===l.tagName&&c.id&&Cv(e,c.id);else if("SegmentTemplate"===c.name){if((_=(P=Tn(l.attributes.sel||""))[P.length-1]).Dc){P=Mv(e,P),D=rn(l)||"";for(var L=g(P),N=L.next();!N.done;N=L.next())An((N=e.u.get(N.value)).L.Oc,l.tagName,_.Dc,D);_=P}else _=[];for(p=g(_),f=p.next();!f.done;f=p.next())v=f.value,o.add(v)}else if("SegmentTimeline"===c.name||"S"===c.name){for(_=Tn(l.attributes.sel||""),D=(P=g(_=Mv(e,_))).next();!D.done;D=P.next())wn(L=tn(D=lm(D=e.u.get(D.value),Mm,"SegmentTimeline"),"S"),l),D.children=L;for(y=g(_),b=y.next();!b.done;b=y.next())w=b.value,o.add(w)}for(S=g(o),A=S.next();!A.done;A=S.next())E=A.value,Rv(e,E);for(k=g(a),I=k.next();!I.done;I=k.next())C=I.value,i.push.apply(i,m(_v(e,{Fb:"dynamic"==e.l.type,presentationTimeline:e.h.presentationTimeline,sa:null,na:null,qa:null,L:null,bandwidth:0,Ng:!1,rb:e.l.rb,profiles:e.l.profiles,uc:e.l.uc,roles:null,Mb:zv},e.l.cb,C,!0).periods));return i.length?(e.h.periodCount+=i.length,e.h.gapCount=e.N,x(R,Iv(e,i,!0),2)):R.A(2)}"static"==e.l.type&&(M=e.l.uc,e.h.presentationTimeline.Ab(M||1/0)),T(R)})}(e,s)):e.g.dash.disableXlinkProcessing?h.return(kv(e,s,n)):(l=e.g.dash.xlinkFailGracefully,d=dm(s,e.g.retryParameters,l,n,e.j.networkingEngine),Fi(e.R,d),x(h,d.promise,2))}return c=h.h,h.return(kv(e,c,n))})}(e,u.data,u.uri,n),3)):h.return(0)):(d=Date.now(),c=(d-s)/1e3,e.Da.sample(1,c),e.ma.clear(),h.return(c))})}function kv(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f,v,y,b,S,k,I,C,M,R,_,D,L,N,O,U,B,j,F,V,H,G,z,X,W,q,Y,$,J,Q,Z,ee,te,ne,re,ie,ae,oe,se,ue,le,de,ce;return P(function(he){switch(he.g){case 1:for(e.i&&e.i.l.clear(),r=[n],i=[],a=new Map,o=tn(t,"Location"),s=g(o),u=s.next();!u.done;u=s.next())l=u.value,d=l.attributes.serviceLocation,(c=rn(l))&&(h=dt(r,[c])[0],d&&(e.i?Um(e.i,"Location",d,h):a.set(d,h)),i.push(h));if(e.i?(p=Bm(e.i,"Location",!0)).length>0&&(r=e.B=p):i.length&&(r=e.B=i),e.l.uf=t.attributes.id||"",e.l.pe=un(t,"publishTime",hn)||0,e.H=tn(t,"PatchLocation"),f=Promise.resolve(),(v=on(t,"ContentSteering"))&&e.j)for(y=v.attributes.defaultServiceLocation,e.i?(e.i.i=r,e.i.h=y):(e.i=new Lm(e.j),e.i.configure(e.g),e.i.setManifestType("DASH"),e.i.i=r,e.i.h=y,(b=rn(v))&&(un(v,"queryBeforeStart",bn,!1)?f=Nm(e.i,b):Nm(e.i,b))),S=g(a.keys()),k=S.next();!k.done;k=S.next())I=k.value,C=a.get(I),Um(e.i,"Location",I,C);if(M=tn(t,"BaseURL"),R=!1,e.i)for(_=g(M),D=_.next();!D.done;D=_.next())L=D.value,N=L.attributes.serviceLocation,O=rn(L),N&&O&&(Um(e.i,"BaseURL",N,O),R=!0);if(e.X.splice(0),R&&e.i||(U=M.map(rn),e.X.push.apply(e.X,m(dt(r,U)))),B=e.i,j=e.X,F=Xv.call(Av,B,R,j),e.l.cb=F,V=0,M&&M.length&&(V=un(M[0],"availabilityTimeOffset",yn)||0),e.l.rb=V,e.K=un(t,"minimumUpdatePeriod",pn,-1),H=un(t,"availabilityStartTime",hn),G=un(t,"timeShiftBufferDepth",pn),z=e.g.dash.ignoreSuggestedPresentationDelay,X=null,z||(X=un(t,"suggestedPresentationDelay",pn)),W=e.g.dash.ignoreMaxSegmentDuration,q=null,W||(q=un(t,"maxSegmentDuration",pn)),Y=t.attributes.type||"static",e.h&&e.h.presentationTimeline&&(e.V=e.h.presentationTimeline.W()&&"static"==Y),e.l.type=Y,e.h)for($=e.h.presentationTimeline,J=$.Ib(),Q=g(e.o.values()),Z=Q.next();!Z.done;Z=Q.next())(ee=Z.value).segmentIndex&&ee.segmentIndex.Ya(J);else te=e.g.dash.ignoreMinBufferTime,ne=0,te||(ne=un(t,"minBufferTime",pn)||0),re=null!=X?Math.min(X,G||1/0):e.g.defaultPresentationDelay>0?e.g.defaultPresentationDelay:Math.min(1.5*ne,G||1/0),$=new lu(H,re,e.g.dash.autoCorrectDrift);return $.cd("static"==Y),$.W()&&!isNaN(e.g.availabilityWindowOverride)&&(G=e.g.availabilityWindowOverride),null==G&&(G=1/0),$.Kf(G),ie=t.attributes.profiles||"",e.l.profiles=ie.split(","),ae={Fb:"static"!=Y,presentationTimeline:$,sa:null,na:null,qa:null,L:null,bandwidth:0,Ng:!1,rb:V,uc:null,profiles:ie.split(","),roles:null,Mb:zv},x(he,f,2);case 2:return e.N=0,oe=_v(e,ae,F,t,!1),se=oe.duration,ue=oe.periods,("static"!=Y||e.V)&&oe.Zh||$.Ab(se||1/0),e.T&&e.va&&$.Si(e.ba),$.Vg(q||1),e.T&&e.va&&(le=null!=X?X:e.g.defaultPresentationDelay,$.qh(le)),e.h?(e.h.periodCount=ue.length,e.h.gapCount=e.N,x(he,Iv(e,ue,!1),4)):x(he,e.m.kg(ue,ae.Fb),6);case 6:var pe=$,fe=e.m.l,ge=e.m.Lg(),me=e.m.i,ve=e.g.dash.sequenceMode,ye=on(t,"ServiceDescription");if(ye){var be=on(ye,"Latency");if(ye=on(ye,"PlaybackRate"),be||ye){var xe={};be&&("target"in be.attributes&&(xe.targetLatency=parseInt(be.attributes.target,10)/1e3),"max"in be.attributes&&(xe.maxLatency=parseInt(be.attributes.max,10)/1e3),"min"in be.attributes&&(xe.minLatency=parseInt(be.attributes.min,10)/1e3)),ye&&("max"in ye.attributes&&(xe.maxPlaybackRate=parseFloat(ye.attributes.max)),"min"in ye.attributes&&(xe.minPlaybackRate=parseFloat(ye.attributes.min))),be=xe}else be=null}else be=null;e:{if((ye=tn(t,"SupplementalProperty")).length)for(xe=(ye=g(ye)).next();!xe.done;xe=ye.next())if("urn:mpeg:dash:chaining:2016"==(xe=xe.value).attributes.schemeIdUri){ye=xe.attributes.value;break e}ye=null}if(e.h={presentationTimeline:pe,variants:fe,textStreams:ge,imageStreams:me,offlineSessionIds:[],sequenceMode:ve,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:be,nextUrl:ye,periodCount:ue.length,gapCount:e.N,isLowLatency:e.T,startTime:null},!$.ij()){he.A(7);break}return de=tn(t,"UTCTiming"),x(he,function(e,t,n){var r,i,a,o,s,u,l,d;return P(function(c){switch(c.g){case 1:r=n.map(function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}}),i=e.g.dash.clockSyncUri,!r.length&&i&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),a=g(r),o=a.next();case 2:if(o.done){c.A(4);break}switch(s=o.value,w(c,5),u=s.scheme,l=s.value,u){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return c.A(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return c.A(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return d=Date.parse(l),c.return(isNaN(d)?0:d-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":K("NTP UTCTiming scheme is not supported");break;default:K("Unrecognized scheme in UTCTiming element",u)}c.A(9);break;case 7:return x(c,jv(e,t,l,"HEAD"),10);case 10:return c.return(c.h);case 8:return x(c,jv(e,t,l,"GET"),11);case 11:return c.return(c.h);case 9:A(c,3);break;case 5:E(c);case 3:o=a.next(),c.A(2);break;case 4:return K("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),c.return(0)}})}(e,F,de),8);case 8:if(ce=he.h,!e.j)return he.return();$.Ti(ce);case 7:$.pf(),e.m&&!e.h.presentationTimeline.W()&&e.m.release();case 4:e.j.makeTextStreamsForClosedCaptions(e.h),function(e){for(var t=Array.from(e.F.keys()).filter(function(t){return!e.G.includes(t)}),n=(t=g(t)).next();!n.done;n=t.next()){n=n.value;for(var r=!0,i=g(e.F.get(n)),a=i.next();!a.done;a=i.next()){a=a.value;var o=e.o.get(a);o&&(o.segmentIndex&&0!=o.segmentIndex.getNumReferences()?r=!1:(e.m&&e.m.Xh(o,n),e.o.delete(a)))}r&&e.F.delete(n)}}(e),function(e,t){t=new Set(t.map(function(e){return e.id}));for(var n=g(e.C.keys()),r=n.next();!r.done;r=n.next())r=r.value,t.has(r)||e.C.delete(r)}(e,ue),T(he)}})}function Iv(e,t,n){var r;return P(function(i){if(1==i.g)return x(i,e.m.kg(t,!0,n),2);e.h.variants=e.m.l,(r=e.m.Lg()).length>0&&(e.h.textStreams=r),e.h.imageStreams=e.m.i,e.j.filter(e.h),T(i)})}function Cv(e,t){e.h.periodCount--;for(var n=g(e.u.keys()),r=n.next();!r.done;r=n.next())(r=r.value).startsWith(t)&&(lm(e.u.get(r),Mm,"SegmentTimeline").children=[],Rv(e,r),e.u.delete(r));e.G=e.G.filter(function(e){return e!==t})}function Mv(e,t){for(var n="",r="",i=-1,a="",o=(t=g(t)).next();!o.done;o=t.next())"Period"===(o=o.value).name?n=o.id:"AdaptationSet"===o.name?(r=o.id,null!==o.position&&(i=o.position)):"Representation"===o.name&&(a=o.id);if(t=[],a)t.push(n+","+a);else if(r)for(i=g(e.u.values()),e=i.next();!e.done;e=i.next())(e=e.value).sa.id===n&&e.qa.id===r&&e.L.id&&t.push(n+","+e.L.id);else if(i>-1)for(r=g(e.u.values()),e=r.next();!e.done;e=r.next())(e=e.value).sa.id===n&&e.qa.position===i&&e.L.id&&t.push(n+","+e.L.id);return t}function Rv(e,t){var n=e.u.get(t),r=e.o.get(t);r.segmentIndex&&r.segmentIndex.Ya(e.h.presentationTimeline.Ib());try{var i=Cm(n,function(t,n,r,i){return Vv(e,t,n,r,i)},e.o,!0,e.g.dash.initialSegmentLimit,e.za,n.L.aesKey,null,!0,e.C);r.createSegmentIndex=function(){return P(function(e){if(1==e.g)return r.segmentIndex?e.A(0):x(e,i.Sc(),3);r.segmentIndex=e.h,T(e)})}}catch(a){if((t=n.L.contentType)!=mt&&"application"!=t&&"image"!=t||4002!=a.code)throw a}}function _v(e,t,n,r,i){var a=t.uc;a||(a=un(r,"mediaPresentationDuration",pn),e.l.uc=a);var o=0;e.h&&e.h.presentationTimeline&&e.V&&(o=e.h.presentationTimeline.$b());var s=[],u=o;r=tn(r,"Period");for(var l=0;l<r.length;l++){var d=r[l],c=r[l+1],h=un(d,"start",pn,u),p=d.attributes.id,f=un(d,"duration",pn);h=0==l&&0==h&&e.V?o:h;var m=null;if(c){var v=un(c,"start",pn);null!=v&&(m=v-h+o)}else null!=a&&(m=a-h+o);if(v=yt,m&&f&&Math.abs(m-f)>v&&m>f&&e.N++,null==m&&(m=f),!(null!==e.O&&null!==p&&null!==h&&h<e.O)||e.G.includes(p)||l+1==r.length){if(null!==h&&(null===e.O||h>e.O)&&(e.O=h),u=Pv(e,t,n,{start:h,duration:m,node:d,jf:null==m||!c}),s.push(u),t.sa.id&&m&&e.za.set(t.sa.id,m),null==m){u=null;break}u=h+m}}if(i)for(n=(t=g(s)).next();!n.done;n=t.next())n=n.value.id,e.G.includes(n)||e.G.push(n);else e.G=s.map(function(e){return e.id});return null!=a?{periods:s,duration:a+o,Zh:!1}:{periods:s,duration:u,Zh:!0}}function Pv(e,t,n,r){t.sa=Bv(e,r.node,null,n),t.na=r,t.sa.rb=t.rb,t.sa.id||(t.sa.id="__shaka_period_"+r.start);var i=tn(r.node,"EventStream");n=t.presentationTimeline.Ib();for(var a=(i=g(i)).next();!a.done;a=i.next())Fv(e,r.start,r.duration,a.value,n);for(i=(n=g(n=tn(r.node,"SupplementalProperty"))).next();!i.done;i=n.next())"urn:mpeg:dash:urlparam:2014"==(i=i.value).attributes.schemeIdUri&&(i=Nv(e,i))&&(t.Mb=i);if(n=tn(r.node,"AdaptationSet").map(function(n,r){return Lv(e,t,r,n)}).filter(Dr),t.Fb){i=[];for(var o=(a=g(n)).next();!o.done;o=a.next())for(var s=(o=g(o.value.Pk)).next();!s.done;s=o.next())i.push(s.value);if(i.length!=new Set(i).size)throw new Ke(2,4,4018)}for(i=new Map,o=(a=g(n)).next();!o.done;o=a.next())for(s=(o=g(o.value.yj)).next();!s.done;s=o.next()){var u=g(s.value);s=u.next().value,u=u.next().value,i.set(s,u)}if(i.size)for(a=null,s=(o=g(n)).next();!s.done;s=o.next()){u=[];for(var l=g((s=s.value).streams),d=l.next(),c={};!d.done;c={yh:void 0},d=l.next())if(c.yh=d.value,i.has(c.yh.originalId)){a||(a=tn(r.node,"AdaptationSet").map(function(n,r){return Lv(e,t,r,n)}).filter(Dr));for(var h=(d=g(a)).next();!h.done;h=d.next())(h=h.value.streams.find(function(e){return function(t){return t.originalId==e.yh.originalId}}(c)))&&(h.dependencyStream=i.get(h.originalId),h.originalId+=h.dependencyStream.originalId,u.push(h))}u.length&&s.streams.push.apply(s.streams,m(u))}if(r=n.filter(function(e){return!e.Gh}),n=n.filter(function(e){return e.Gh}),!e.g.disableIFrames)for(i=(n=g(n)).next();!i.done;i=n.next())for(a=(i=i.value).Gh.split(" "),s=(o=g(r)).next();!s.done;s=o.next())if(s=s.value,a.includes(s.id))for(u=(s=g(s.streams)).next();!u.done;u=s.next())pi(u.value,i.streams);if(n=Dv(e.g.disableAudio,r,"audio"),i=Dv(e.g.disableVideo,r,"video"),a=Dv(e.g.disableText,r,mt),r=Dv(e.g.disableThumbnails,r,"image"),0===i.length&&0===n.length)throw new Ke(2,4,4004);return{id:t.sa.id,audioStreams:n,videoStreams:i,textStreams:a,imageStreams:r}}function Dv(e,t,n){return e||!t.length?[]:t.reduce(function(e,t){return t.contentType!=n||e.push.apply(e,m(t.streams)),e},[])}function Lv(t,n,r,i){function a(e){var r=e.attributes["dvb:fontFamily"];e=e.attributes["dvb:url"],r&&e&&(e=dt(n.qa.cb(),[e],n.Mb()),t.j.addFont(r,e[0]))}function o(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function s(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}n.qa=Bv(t,i,n.sa,null),n.qa.position=r;var u=!1,l=(r=tn(i,"Role")).map(function(e){return e.attributes.value}).filter(Dr),d=void 0,c=n.qa.contentType==mt;c&&(d="subtitle");for(var h=(r=g(r)).next();!h.done;h=r.next()){var p=(h=h.value).attributes.schemeIdUri;if(null==p||"urn:mpeg:dash:role:2011"==p)switch(h=h.attributes.value,h){case"main":u=!0;break;case"caption":case"subtitle":d=h}}var f=tn(i,"EssentialProperty");r=null;var v=!1;h=null,p=!1;for(var y=(f=g(f)).next();!y.done;y=f.next()){var b=(y=y.value).attributes.schemeIdUri;if("http://dashif.org/guidelines/trickmode"==b)r=y.attributes.value;else if("urn:mpeg:mpegB:cicp:TransferCharacteristics"==b)var w=s(parseInt(y.attributes.value,10));else if("urn:mpeg:mpegB:cicp:ColourPrimaries"==b)var S=o(parseInt(y.attributes.value,10));else"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=b&&("urn:mpeg:dash:ssr:2023"==b&&t.g.dash.enableFastSwitching?v=!0:"urn:dvb:dash:fontdownload:2014"==b?a(y):"urn:mpeg:dash:urlparam:2014"==b&&(h=Nv(t,y))||(p=!0))}if(p)return null;var A=null;for(f=(p=g(p=tn(i,"SupplementalProperty"))).next();!f.done;f=p.next())"http://dashif.org/guidelines/last-segment-number"==(y=(f=f.value).attributes.schemeIdUri)?A=parseInt(f.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==y?w=s(parseInt(f.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==y?S=o(parseInt(f.attributes.value,10)):"urn:dvb:dash:fontdownload:2014"==y?a(f):"urn:mpeg:dash:urlparam:2014"==y&&(h=Nv(t,f));h&&(n.Mb=h),h=tn(i,"Accessibility");var E,k=new Map;for(p=(h=g(h)).next();!p.done;p=h.next())if(p=(f=p.value).attributes.schemeIdUri,f=f.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=p||t.g.disableText)if("urn:scte:dash:cc:cea-708:2015"!=p||t.g.disableText)"urn:mpeg:dash:role:2011"==p?null!=f&&(l.push(f),"captions"==f&&(d="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==p&&("1"==f?E="visually impaired":"2"==f?E="hard of hearing":"9"==f&&(E="spoken subtitles"));else if(p=1,null!=f)for(y=(f=g(f.split(";"))).next();!y.done;y=f.next()){b=y.value;var I=y=void 0;b.includes("=")?(y="svc"+(b=b.split("="))[0],I=b[1].split(",")[0].split(":").pop()):(y="svc"+p,p++,I=b),k.set(y,jr(I))}else k.set("svc1","und");else if(p=1,null!=f)for(b=(y=g(f=f.split(";"))).next();!b.done;b=y.next()){I=b.value;var C=b=void 0;I.includes("=")?(b=(I=I.split("="))[0].startsWith("CC")?I[0]:"CC"+I[0],C=I[1]||"und"):(b="CC"+p,2==f.length?p+=2:p++,C=I),k.set(b,jr(C))}else k.set("CC1","und");h=tn(i,"ContentProtection");var M=tm(t.ya,h,t.g.ignoreDrmInfo,t.g.dash.keySystemsByURI);n.qa.encrypted=h.length>0;var R=jr(n.qa.language||"und"),_=n.qa.label,D=new Map;if(i=tn(i,"Representation"),!t.g.ignoreSupplementalCodecs){for(h=[],f=(p=g(i)).next();!f.done;f=p.next())(f=ln(y=f.value,"urn:scte:dash:scte214-extensions","supplementalCodecs"))&&((y=Kt(y)).attributes.codecs=f.split(" ").join(","),y.attributes.id&&(y.attributes.supplementalId=y.attributes.id+"_supplementalCodecs"),h.push(y));i.push.apply(i,m(h))}if(h=i.map(function(r){var i=function(t,n,r,i,a,o,s,u,l,d,c,h){n.L=Bv(t,d,n.qa,null);var p=n.L.id;if(t.ba=Math.min(t.ba,n.L.rb),t.T=t.ba>0,!function(e){var t=e.Id?1:0;return t+=e.Ac?1:0,0==(t+=e.Oc?1:0)?e.contentType==mt||"application"==e.contentType:(1!=t&&(e.Id&&(e.Ac=null),e.Oc=null),!0)}(n.L))return null;var f=n.na.start;n.bandwidth=un(d,"bandwidth",mn)||0,n.roles=u;var g=tn(d,"SupplementalProperty"),m=tn(d,"EssentialProperty"),v=tn(d,"ContentProtection");d=null;var y,b,w=m.find(function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri});(w||(w=g.find(function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri})))&&(d=Nv(t,w)),d&&(n.Mb=d),w=n.L.contentType,d=w==mt||"application"==w,w="image"==w,v.length&&(n.qa.encrypted=!0);try{var S=void 0;if(r.gg){var A=n.L.cb,E=n.Mb,k=zi(dt(A(),[r.gg.tk],E()),t.g.retryParameters);S={bitsKey:128,blockCipherMode:"CBC",iv:r.gg.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,r,i;return P(function(a){if(1==a.g)return x(a,Gv(t,k,6),2);if(3!=a.g){if(!(n=a.h).data||16!=n.data.byteLength)throw new Ke(2,4,4049);return r={name:"AES-CBC"},i=S,x(a,e.crypto.subtle.importKey("raw",n.data,r,!0,["decrypt"]),3)}i.cryptoKey=a.h,S.fetchKey=void 0,T(a)})}}}if(n.L.aesKey=S,A=function(e,n,r,i){return Vv(t,e,n,r,i)},n.L.Id)var I=xm(n,A,S);else if(n.L.Ac)I=km(n,t.o,S);else if(n.L.Oc)I=Cm(n,A,t.o,!!t.h,t.g.dash.initialSegmentLimit,t.za,S,h,!1,t.C);else{var C=n.na.duration||0,M=n.L.cb,R=n.L.mimeType,_=n.L.codecs;I={endTime:-1,timeline:-1,Sc:function(){var e=Lu(f,C,M());return e.Gb(function(e){e.mimeType=R,e.codecs=_}),Promise.resolve(e)},timescale:1}}}catch(L){if((d||w)&&4002==L.code)return null;throw L}if(h=function(e,t,n,r,i){var a=tm(e,t,r,i);if(n.ai)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==a.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=a.drmInfos),n.ai=!1;else if(a.drmInfos.length>0&&(n.drmInfos=n.drmInfos.filter(function(e){return a.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==n.drmInfos.length))throw new Ke(2,4,4008);return a.Wh||n.Wh}(t.ya,v,r,t.g.ignoreDrmInfo,t.g.dash.keySystemsByURI),h=new Set(h?[h]:[]),v=!1,g.some(function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value})&&(v=!0),g=!1,d&&(g=u.includes("forced_subtitle")||u.includes("forced-subtitle")),w&&((m=m.find(function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)}))&&(y=m.attributes.value),!y))return null;d=n.L.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(d.includes("hvc1.2.4.L153.B0")||d.includes("hev1.2.4.L153.B0"))&&(b="PQ"),m=n.L.id?n.sa.id+","+n.L.id:"",t.H.length&&p&&t.u.set(n.sa.id+","+p,function(e){function t(e){return e?((e=qt(e)).Id=null,e.Ac=null,e.Oc=kn(e.Oc),e.Bf=null,e):null}return(e=qt(e)).sa=t(e.sa),e.qa=t(e.qa),e.L=t(e.L),e.na&&(e.na=qt(e.na),e.na.node=null),e}(n)),n.L.Bf&&function(e,t,n,r){if(!e.ma.has(t)){e.ma.add(t);var i,a=un(t,"presentationTime",vn)||0,o=on(t,"UTCTiming");(i=o&&o.attributes.schemeIdUri)&&(i=!("urn:mpeg:dash:utc:http-ntp:2014"===(o=o.attributes.schemeIdUri)||"urn:mpeg:dash:utc:ntp:2014"===o||"urn:mpeg:dash:utc:sntp:2014"===o)),t=i?1e3*(un(t,"wallClockTime",hn)||0):hs(t=un(t,"wallClockTime",vn)||0),a=(n=new Date(t-a/n.timescale*1e3)).getTime()/1e3,isNaN(a)||(r.o||r.rh(a),r=new Ni("prft",r=(new Map).set("detail",{wallClockTime:t,programStartDate:n})),e.j.onEvent(r))}}(t,n.L.Bf,I,n.presentationTimeline),-1!=I.endTime&&null!=n.sa.id&&null!=n.L.id&&((p=t.C.get(n.sa.id))?(p.endTime=I.endTime,p.fh.includes(n.L.id)||p.fh.push(n.L.id),t.C.set(n.sa.id,p)):t.C.set(n.sa.id,{endTime:I.endTime,timeline:I.timeline,fh:[n.L.id]}));var D=m&&t.o.has(m)?t.o.get(m):{id:t.Fa++,originalId:n.L.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){D.segmentIndex&&(D.segmentIndex.release(),D.segmentIndex=null)},segmentIndex:null,mimeType:n.L.mimeType,codecs:d,frameRate:n.L.frameRate,pixelAspectRatio:n.L.pixelAspectRatio,bandwidth:n.bandwidth,width:n.L.width,height:n.L.height,kind:i,encrypted:r.drmInfos.length>0,drmInfos:r.drmInfos,keyIds:h,language:a,originalLanguage:n.qa.language,label:o,type:n.qa.contentType,primary:s,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:n.L.emsgSchemeIdUris,roles:u,forced:g,channelsCount:n.L.xf,audioSamplingRate:n.L.audioSamplingRate,spatialAudio:v,closedCaptions:l,hdr:b,colorGamut:void 0,videoLayout:void 0,tilesLayout:y,accessibilityPurpose:c,external:!1,fastSwitching:!1,fullMimeTypes:new Set([dr(n.L.mimeType,n.L.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null};return D.createSegmentIndex=function(){var e;return P(function(t){if(1==t.g)return D.segmentIndex?t.A(0):(e=D,x(t,I.Sc(),3));e.segmentIndex=t.h,T(t)})},m&&n.Fb&&!t.o.has(m)&&(n=n.sa.id||"",t.F.has(n)||t.F.set(n,[]),t.o.set(m,D),t.F.get(n).push(m)),D}(t,n,M,d,R,_,u,l,k,r,E,A);return i&&(i.hdr=i.hdr||w,i.colorGamut=i.colorGamut||S,i.fastSwitching=v,r=r.attributes.dependencyId)?(i.baseOriginalId=r,D.set(r,i),null):i}).filter(function(e){return!!e}),0==h.length&&0==D.size){if(r="image"==n.qa.contentType,t.g.dash.ignoreEmptyAdaptationSet||c||r)return null;throw new Ke(2,4,4003)}if(!n.qa.contentType||"application"==n.qa.contentType)for(n.qa.contentType=Hv(h[0].mimeType,h[0].codecs),p=(c=g(h)).next();!p.done;p=c.next())p.value.type=n.qa.contentType;for(c=n.qa.id||"__fake__"+t.Fa++,f=(p=g(h)).next();!f.done;f=p.next()){for(f=f.value,b=(y=g(M.drmInfos)).next();!b.done;b=y.next())(b=b.value).keyIds=b.keyIds&&f.keyIds?new Set([].concat(m(b.keyIds),m(f.keyIds))):b.keyIds||f.keyIds;t.g.enableAudioGroups&&(f.groupId=c)}return i=i.map(function(e){return e.attributes.supplementalId||e.attributes.id}).filter(Dr),{id:c,contentType:n.qa.contentType,language:R,Dm:u,streams:h,drmInfos:M.drmInfos,Gh:r,Pk:i,yj:D}}function Nv(e,t){if((t=sn(t,"urn:mpeg:dash:schema:urlparam:2014","UrlQueryInfo"))&&un(t,"useMPDUrlQuery",bn,!1)){var n=t.attributes.queryTemplate;if(n)return function(){return"$querypart$"==n?e.$:n.split("&").map(function(t){if("$querypart$"==t)return e.$;var n=/\$query:(.*?)\$/g.exec(t);if(n&&2==n.length){n=n[1];var r=new Me(e.$).get(n);if(r.length)return n+"="+r[0]}return t}).join("&")}}return null}function Ov(e){var t,n;return P(function(r){switch(r.g){case 1:return t=0,w(r,2),x(r,Ev(e),4);case 4:t=r.h,A(r,3);break;case 2:if(n=E(r),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),r.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return r.return();e.j.onManifestUpdated(),Uv(e,t),T(r)}})}function Uv(e,t){if(!(e.K<0)){var n=e.K;e.g.updatePeriod>=0&&(n=e.g.updatePeriod),e.M.ka(Math.max(n-t,G(e.Da)))}}function Bv(e,t,n,r){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,xf:null,audioSamplingRate:null,rb:0,Hf:1,encrypted:!1},r=r||n.cb;var i,a=t.attributes.id,o=t.attributes.supplementalId,s=tn(t,"BaseURL"),u=!1;if(e.i)for(var l=g(s),d=l.next();!d.done;d=l.next()){var c=d.value;d=c.attributes.serviceLocation,c=rn(c),d&&c&&(Um(e.i,a,d,c),u=!0)}u&&e.i||(i=s.map(rn));var h=e.i;e=t.attributes.contentType||n.contentType,l=t.attributes.mimeType||n.mimeType,d=al([t.attributes.codecs||n.codecs]).join(","),c=un(t,"frameRate",xn)||n.frameRate;var p=t.attributes.sar||n.pixelAspectRatio,f=function(e,t){t=t.slice();for(var n=(e=g(e)).next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}(tn(t,"InbandEventStream"),n.emsgSchemeIdUris),m=tn(t,"AudioChannelConfiguration");m=function(e){for(var t=(e=g(e)).next();!t.done;t=e.next()){var n=(t=t.value).attributes.schemeIdUri;if(n&&(t=t.attributes.value))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(t=parseInt(t,10)))continue;return t;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":if(n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2],!(t=parseInt(t,16)))continue;for(var r=0,i=0;i<n.length;i++)t&1<<i&&(r+=n[i]);if(r)return r;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),!(t=parseInt(t,16)))continue;for(i=r=0;i<n.length;i++)t&1<<i&&(r+=n[i]);if(r)return r;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(t=parseInt(t,10))&&t>0&&t<n.length)return n[t]}}return null}(m)||n.xf;var v=un(t,"audioSamplingRate",vn)||n.audioSamplingRate;e||(e=Hv(l,d));var y=on(t,"SegmentBase"),b=on(t,"SegmentTemplate"),x=y&&un(y,"availabilityTimeOffset",yn)||0,T=b&&un(b,"availabilityTimeOffset",yn)||0,w=s&&s.length&&un(s[0],"availabilityTimeOffset",yn)||0;x=n.rb+w+x+T,T=null,(w=on(t,"SegmentSequenceProperties"))&&(w=un(w,"cadence",mn))&&(T=w),w=t.attributes.label;var S=tn(t,"Label");return S&&S.length&&nn(S=S[0])&&(w=nn(S)),{cb:function(){return dt(r(),s.length?h&&u?Bm(h,a):i||[]:[])},Id:y||n.Id,Ac:on(t,"SegmentList")||n.Ac,Oc:b||n.Oc,Bf:on(t,"ProducerReferenceTime")||n.Bf,width:un(t,"width",vn)||n.width,height:un(t,"height",vn)||n.height,contentType:e,mimeType:l,codecs:d,frameRate:c,pixelAspectRatio:p,emsgSchemeIdUris:f,id:o||a,originalId:a,language:t.attributes.lang,xf:m,audioSamplingRate:v,rb:x,gf:null,Hf:T||n.Hf,label:w||null,encrypted:!1}}function jv(e,t,n,r){var i,a,o,s,u,l,d;return P(function(c){if(1==c.g)return i=[tt(n)],a=dt(t(),i),(o=zi(a,e.g.retryParameters)).method=r,s=e.j.networkingEngine.request(4,o,{isPreload:e.oa()}),Fi(e.R,s),x(c,s.promise,2);if(u=c.h,"HEAD"==r){if(!u.headers||!u.headers.date)return c.return(0);l=u.headers.date}else l=Ye(u.data);return d=Date.parse(l),isNaN(d)?c.return(0):c.return(d-Date.now())})}function Fv(e,t,n,r,i){for(var a=r.attributes.schemeIdUri||"",o=r.attributes.value||"",s=un(r,"timescale",vn)||1,u=un(r,"presentationTimeOffset",vn)||0,l=(r=g(tn(r,"Event"))).next();!l.done;l=r.next()){var d=un(l=l.value,"presentationTime",vn)||0,c=un(l,"duration",vn)||0;c=(d=Math.max((d-u)/s+t,t))+c/s,null!=n&&(d=Math.min(d,t+n),c=Math.min(c,t+n)),c<i||(l={schemeIdUri:a,value:o,startTime:d,endTime:c,id:l.attributes.id||"",timescale:s,eventElement:En(l),eventNode:kn(l)},e.j.onTimelineRegionAdded(l))}}function Vv(e,t,n,r,i){var a,o,s,u;return P(function(l){return 1==l.g?(a=Yi,o=i?0:1,s=ll(t,n,r,e.g.retryParameters),x(l,Gv(e,s,a,{type:o}),2)):(u=l.h,l.return(u.data))})}function Hv(e,t){return Ar(t=dr(e,t))?mt:e.split("/")[0]}function Gv(e,t,n,r){return r||(r={}),r.isPreload=e.oa(),t=e.j.networkingEngine.request(n,t,r),Fi(e.R,t),t.promise}function zv(){return""}function Xv(e,t,n){return function(){return e&&t?Bm(e,"BaseURL"):n.slice()}}function Wv(){}(i=Av.prototype).configure=function(e,t){var n=this.j&&e.updatePeriod!=this.g.updatePeriod&&e.updatePeriod>=0;this.g=e,t&&(this.oa=t),n&&this.h&&this.h.presentationTimeline.W()&&this.M.Kb(),this.i&&this.i.configure(this.g),this.m&&this.m.Vi(this.g.dash.useStreamOnceInPeriodFlattening)},i.start=function(e,t){var n,r=this;return P(function(i){if(1==i.g)return r.va=t.isLowLatencyMode(),r.B=[e],r.j=t,x(i,Ev(r),2);if(n=i.h,r.j&&Uv(r,n),!r.j)throw new Ke(2,7,7001);return i.return(r.h)})},i.stop=function(){for(var e=g(this.o.values()),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.B=[],this.h=null,this.o.clear(),this.F.clear(),this.u.clear(),this.C.clear(),this.l={uf:"",type:"",profiles:[],uc:null,rb:0,cb:null,pe:0},this.m=null,null!=this.M&&(this.M.stop(),this.M=null),this.i&&this.i.destroy(),this.I&&(this.I.release(),this.I=null),this.ma.clear(),this.ya.release(),this.R.destroy()},i.update=function(){var e,t=this;return P(function(n){return 1==n.g?(w(n,2),x(n,Ev(t),4)):2!=n.g?A(n,0):(e=E(n),t.j&&e?(t.j.onError(e),void T(n)):n.return())})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.h&&this.h.presentationTimeline.W()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.h.presentationTimeline.Ic();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.K=t.endTime-e,Uv(this,0))}}},i.banLocation=function(e){this.i&&this.i.banLocation(e)},i.setMediaElement=function(e){this.J=e},V("shaka.dash.DashParser",Av),Et("application/dash+xml",function(){return new Av}),Et("video/vnd.mpeg.dash.mpd",function(){return new Av}),V("shaka.dependencies",Wv),Wv.has=function(e){return Yv.has(e)},Wv.add=function(e,t){if(!qv[e])throw Error(e+" is not supported");e==Kv?ce("mux.js","mux.js is no longer used in Shaka Player."):Yv.set(e,function(){return t})};var Kv="muxjs",qv={Em:Kv,ISOBoxer:"ISOBoxer"};Wv.Allowed=qv;var Yv=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function $v(){this.j=new ae(function(){return["Oculus","Quest"].some(function(e){return navigator.userAgent.includes(e.toLowerCase())})?"VR":navigator.userAgent.match(/Smart( ?|_)TV/i)||navigator.userAgent.match(/Android ?TV/i)?"TV":navigator.userAgentData?navigator.userAgentData.mobile?"MOBILE":"DESKTOP":/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)?"MOBILE":navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase()?"MOBILE":"DESKTOP":navigator.userAgent.includes("Android")?"MOBILE":"DESKTOP"}),this.l=new ae(function(){return navigator.vendor.includes("Apple")&&(navigator.userAgent.includes("Version/")||navigator.userAgent.includes("OS/"))?"WEBKIT":navigator.userAgent.includes("Edge/")?"EDGE":navigator.userAgent.includes("Chrome/")?"CHROMIUM":navigator.userAgent.includes("Firefox/")?"GECKO":"UNKNOWN"})}function Jv(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function Qv(){$v.call(this),this.g=new ae(function(){var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}),this.h=new ae(function(){return/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1?"xr"in navigator?"APPLE_VR":"MOBILE":"xr"in navigator?"APPLE_VR":"DESKTOP"})}function Zv(){if(!ey())throw Error("Not a Chromecast device!");$v.call(this),this.h=new ae(function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}),this.g=new ae(function(){var e=navigator.userAgentData&&navigator.userAgentData.platform||navigator.userAgent;return(e=e.toLowerCase()).includes("android")?ty:e.includes("fuchsia")?ny:ry})}function ey(){return navigator.userAgent.includes("CrKey")&&!navigator.userAgent.includes("VIZIO SmartCast")}(i=$v.prototype).hc=function(){return!!navigator.mediaCapabilities},i.Oa=function(){return this.j.value()},i.Ha=function(){return this.l.value()},i.Fd=function(){return!1},i.hh=function(){return!1},i.hf=function(){return!1},i.Li=function(){return!1},i.re=function(){return!1},i.fd=function(){return!0},i.Bb=function(){var t=e.ManagedSourceBuffer||e.SourceBuffer;return!!t&&!!t.prototype&&!!t.prototype.changeType},i.ve=function(){return!0},i.Qi=function(){return 0},i.lc=function(){return Promise.resolve({width:1/0,height:1/0})},i.Yi=function(){return!1},i.wh=function(){return!1},i.Wa=function(e){var t=this.Oa();return"TV"!==t&&"CONSOLE"!==t&&"CAST"!==t||(e.ads.customPlayheadTracker=!0,e.ads.skipPlayDetection=!0,e.ads.supportsMultipleMediaElements=!1),e},i.Bh=function(){return!!e.indexedDB},i.Ji=function(){return[]},i.sd=function(t){return void 0!==e.matchMedia&&e.matchMedia("(color-gamut: p3)").matches?t?"HLG":"PQ":"SDR"},i.ej=function(){return!1},i.zi=function(){return!1},i.Ef=function(){return!1},i.Nf=function(){return!0},i.Ai=function(){return!1},i.dj=function(){return!0},i.ed=function(){return!1},i.Ug=function(e){return"com.apple.fps"===e},i.Mf=function(){return!0},i.toString=function(){return"Device: "+this.Ob()+" v"+this.Ba()+"; Type: "+this.Oa()},p(Qv,$v),(i=Qv.prototype).Ba=function(){return this.g.value()},i.Ob=function(){return"Apple Browser"},i.Oa=function(){return this.h.value()},i.Ha=function(){return"WEBKIT"},i.hc=function(){return!1},i.Fd=function(e,t){return"audio"===t},i.hf=function(){return!0},i.Li=function(e){return"audio"===e},i.Wa=function(e){return $v.prototype.Wa.call(this,e),e.abr.minTimeToSwitch=.5,e},i.ej=function(){return!0},i.Mf=function(){return!1},(navigator.vendor||"").includes("Apple")&&(/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1||navigator.userAgentData&&navigator.userAgentData.platform&&"macos"==navigator.userAgentData.platform.toLowerCase()||navigator.platform&&navigator.platform.toLowerCase().includes("mac"))&&(se=function(){return new Qv}),p(Zv,$v),(i=Zv.prototype).Ba=function(){return this.h.value()},i.Ob=function(){return"Chromecast with "+this.g.value()},i.Oa=function(){return"CAST"},i.Ha=function(){return"CHROMIUM"},i.hc=function(){return $v.prototype.hc.call(this)&&this.g.value()!==ry},i.Bb=function(){return $v.prototype.Bb.call(this)&&this.g.value()!==ry},i.Qi=function(){switch(this.g.value()){case ty:return 0;case ny:return 3;default:return 1}},i.lc=function(){var t,n,r,i;return P(function(a){switch(a.g){case 1:if(t=e.cast&&cast.__platform__&&cast.__platform__.canDisplayType,n={width:1280,height:720},w(a,2),!(r=t)){a.A(4);break}return x(a,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),5);case 5:r=a.h;case 4:if(r){n.width=3840,n.height=2160,a.A(6);break}if(!(i=t)){a.A(7);break}return x(a,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),8);case 8:i=a.h;case 7:i&&(n.width=1920,n.height=1080);case 6:A(a,3);break;case 2:W("Failed to check canDisplayType:",E(a));case 3:return a.return(n)}})},i.Wa=function(e){return $v.prototype.Wa.call(this,e),e.streaming.stallSkip=0,e},i.Bh=function(){return!1},i.ed=function(){return!0};var ty="Android",ny="Fuchsia",ry="Linux";function iy(){$v.call(this);var e=this;this.i=new ae(function(){var e=navigator.userAgent.match(/(Chrome|Firefox)\/(\d+)/);return e?parseInt(e[2],10):null}),this.g=new ae(function(){return navigator.userAgent.match(/Edge?\//)?"Edge":navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Firefox")?"Firefox":"Unknown"}),this.h=new ae(function(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("win32")}),this.u=new ae(function(){return!(!$v.prototype.Bb.call(e)||navigator.userAgent.match(/Edge?\//)&&e.h.value())}),this.o=new ae(function(){return navigator.userAgent.includes("sony.hbbtv.tv")}),this.m=new ae(function(){return navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase():!!navigator.userAgent.includes("Android")})}function ay(){$v.apply(this,arguments)}function oy(){$v.call(this),this.g=new ae(function(){var e=navigator.userAgent.match(/PlayStation (\d+)/);return e?parseInt(e[1],10):null})}function sy(){$v.call(this);var e=navigator.userAgent.match(/Tizen (\d+).(\d+)/);this.g=e?parseInt(e[1],10):null,this.h=e?parseInt(e[2],10):null}function uy(){$v.apply(this,arguments)}function ly(){$v.call(this),this.i=new ae(function(){return navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("Sky_STB")}),this.h=new ae(function(){return navigator.userAgent.includes("SOPOpenBrowser")}),this.g=new ae(function(){if(navigator.userAgent.includes("DT_STB_BCM"))return 11;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null})}function dy(){$v.call(this);var e=this;this.h=function(){var e=null,t=navigator.userAgent.match(/Chrome\/(\d+)/);switch(t&&(e=parseInt(t[1],10)),e){case 38:return 3;case 53:return 4;case 68:return 5;case 79:return 6;case 87:return 22;case 94:return 23;case 108:return 24;case 120:return 25;default:return null}}(),this.g=null;try{var t=new PalmServiceBridge;t.onservicecallback=function(t){t=JSON.parse(t),e.g=t.configs["tv.model.supportHDR"]||t.configs["tv.config.supportDolbyHDRContents"]||!1},t.call("luna://com.webos.service.config/getConfigs",JSON.stringify({configNames:["tv.model.supportHDR","tv.config.supportDolbyHDRContents"]}))}catch(n){K("WebOS: getConfigs call failed",n)}}if(ey()&&(se=function(){return new Zv}),p(iy,$v),(i=iy.prototype).Ba=function(){return this.i.value()},i.Ob=function(){return this.g.value()},i.Fd=function(e){return!!Ve(e)&&"Edge"===this.g.value()&&this.h.value()},i.hh=function(){return"Edge"===this.g.value()&&this.h.value()},i.hf=function(){return"Edge"===this.g.value()&&this.h.value()},i.Bb=function(){return this.u.value()},i.Wa=function(e){if($v.prototype.Wa.call(this,e),this.h.value())switch(this.g.value()){case"Firefox":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation"};break;case"Chrome":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation.3000","com.microsoft.playready.recommendation":"com.microsoft.playready.recommendation.3000"}}return this.m.value()&&(e.drm.defaultAudioRobustnessForWidevine="",e.drm.defaultVideoRobustnessForWidevine=""),e},i.Ef=function(){return"Edge"===this.g.value()||this.o.value()},i.ed=function(){if("GECKO"===this.Ha()){var e=this.Ba();return null!==e?e>=100:$v.prototype.ed.call(this)}return $v.prototype.ed.call(this)},i.Ug=function(e){return"GECKO"===this.Ha()?e.startsWith("com.microsoft.playready.recommendation"):$v.prototype.Ug.call(this,e)},ue=function(){return new iy},p(ay,$v),(i=ay.prototype).Ba=function(){return null},i.Ob=function(){return"Hisense"},i.Oa=function(){return"TV"},i.hc=function(){return!1},i.lc=function(){var t={width:1920,height:1080},n=null;if(e.Hisense_Get4KSupportState)try{n=e.Hisense_Get4KSupportState()}catch(r){}return null==n&&(n=navigator.userAgent.includes("UHD")),n&&(t.width=3840,t.height=2160),Promise.resolve(t)},i.Wa=function(e){return $v.prototype.Wa.call(this,e),e.streaming.stallSkip=0,e},(navigator.userAgent.includes("Hisense")||navigator.userAgent.includes("VIDAA"))&&(se=function(){return new ay}),p(oy,$v),(i=oy.prototype).Ob=function(){return"PlayStation"},i.Oa=function(){return"CONSOLE"},i.Ha=function(){return"WEBKIT"},i.Ba=function(){return this.g.value()},i.hc=function(){return!1},i.fd=function(){return!1},i.Bb=function(){return!1},i.wh=function(){return 4===this.Ba()},i.lc=function(){var t,n,r,i;return P(function(a){switch(a.g){case 1:return t={width:1920,height:1080},n=!1,w(a,2),x(a,e.msdk.device.getDisplayInfo(),4);case 4:r=a.h,n="4K"===r.resolution,A(a,3);break;case 2:return E(a),w(a,5),x(a,e.msdk.device.getDisplayInfoImmediate(),7);case 7:i=a.h,n="4K"===i.resolution,A(a,3);break;case 5:K("PlayStation: Failed to get the display info:",E(a));case 3:return n&&(t.width=3840,t.height=2160),a.return(t)}})},i.Wa=function(e){return $v.prototype.Wa.call(this,e),4===this.Ba()&&e.drm.preferredKeySystems.push("com.microsoft.playready"),e.streaming.clearDecodingCache=!0,e},i.Ef=function(){return 4===this.Ba()},i.Nf=function(){return 4!==this.Ba()},navigator.userAgent.includes("PlayStation")&&(se=function(){return new oy}),p(sy,$v),(i=sy.prototype).Ba=function(){return this.g},i.Ob=function(){return"Tizen"},i.Ha=function(){return"CHROMIUM"},i.Oa=function(){return"TV"},i.Fd=function(){return!0},i.re=function(){return 3===this.Ba()},i.hc=function(){return!1},i.fd=function(){var e=this.Ba();return null!==e?e>=4:$v.prototype.fd.call(this)},i.Bb=function(){return!1},i.ve=function(){return this.g&&this.h?5===this.g?this.h>=5:this.g>5:$v.prototype.ve.call(this)},i.lc=function(){var t=e.devicePixelRatio;t={width:e.screen.width*t>1920?3840:1920,height:e.screen.height*t>1080?2160:1080};try{if(webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution){var n=webapis.systeminfo.getMaxVideoResolution();t.width=n.width,t.height=n.height}else webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(r){K("Tizen: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(t)},i.Wa=function(e){return $v.prototype.Wa.call(this,e),e.drm.ignoreDuplicateInitData=2!==this.Ba(),3===this.Ba()&&(e.streaming.crossBoundaryStrategy="reset_to_encrypted"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e.streaming.gapPadding=2,e},i.Ji=function(){var e=[];return null!==this.g&&this.g<5&&e.push("opus"),e},i.sd=function(e){try{if(webapis.avinfo.isHdrTvSupport())return e?"HLG":"PQ"}catch(t){return $v.prototype.sd.call(this,e)}return"SDR"},i.zi=function(){return!0},i.Ai=function(){return 3===this.Ba()},navigator.userAgent.includes("Tizen")&&(se=function(){return new sy}),p(uy,$v),uy.prototype.Ba=function(){return null},uy.prototype.Ob=function(){return"Vizio"},uy.prototype.Oa=function(){return"TV"},uy.prototype.hc=function(){return!1},navigator.userAgent.includes("VIZIO SmartCast")&&(se=function(){return new uy}),p(ly,$v),(i=ly.prototype).Ba=function(){return this.g.value()},i.Ob=function(){return"WebKit STB"},i.Oa=function(){return"TV"},i.Ha=function(){return"WEBKIT"},i.hc=function(){return!1},i.fd=function(){var e=this.g.value();return null===e||e>=15},i.Fd=function(){return this.h.value()},i.lc=function(){return Promise.resolve({width:e.screen.width*e.devicePixelRatio,height:e.screen.height*e.devicePixelRatio})},i.Nf=function(){return!this.i.value()},i.Mf=function(){return!1},(navigator.userAgent.includes("SOPOpenBrowser")||navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("Sky_STB")||!(!(navigator.vendor||"").includes("Apple")||/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1||navigator.userAgentData&&navigator.userAgentData.platform&&"macos"==navigator.userAgentData.platform.toLowerCase()||navigator.platform&&navigator.platform.toLowerCase().includes("mac")))&&(se=function(){return new ly}),p(dy,$v),(i=dy.prototype).Ba=function(){return this.h},i.Ob=function(){return"WebOS"},i.Oa=function(){return"TV"},i.Ha=function(){return"CHROMIUM"},i.hc=function(){return!1},i.fd=function(){var e=this.Ba();return null!==e?e>3:$v.prototype.fd.call(this)},i.Bb=function(){return!1},i.ve=function(){var e=this.Ba();return null!==e?e>3:$v.prototype.ve.call(this)},i.lc=function(){var t={width:1920,height:1080};try{var n=JSON.parse(e.PalmSystem.deviceInfo);t.width=Math.max(1920,n.screenWidth),t.height=Math.max(1080,n.screenHeight)}catch(r){K("WebOS: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(t)},i.Wa=function(e){return $v.prototype.Wa.call(this,e),3===this.Ba()&&(e.streaming.crossBoundaryStrategy="reset"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e},i.sd=function(e){return null==this.g?(K("WebOS: getConfigs call haven't finished"),$v.prototype.sd.call(this,e)):this.g?e?"HLG":"PQ":"SDR"},i.dj=function(){return!1},i.ed=function(){var e=this.Ba();return null!==e?e>=6:$v.prototype.ed.call(this)},navigator.userAgent.includes("Web0S")){var cy=new dy;se=function(){return cy}}function hy(){$v.call(this),this.g=navigator.userAgent.includes("Edge/");var e=navigator.userAgent.match(/Edge?\/(\d+)/);this.h=e?parseInt(e[1],10):null}function py(){var e=null;try{e="undefined"!=typeof Windows?Windows:chrome.webview.hostObjects.sync.Windows}catch(t){}return e}function fy(e,t,n){this.type=e,this.ha=t,this.segments=n||null}function gy(e,t,n,r){this.id=e,this.name=t,this.attributes=n,this.value=void 0===r?null:r}function my(e,t){return t?e.toString():(t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function vy(e,t){return e.attributes.find(function(e){return e.name===t})||null}function yy(e,t,n){return(e=vy(e,t))?e.value:n||null}function by(e,t){if(!(e=vy(e,t)))throw new Ke(2,4,4023,t);return e.value}function xy(e,t,n){n=void 0===n?[]:n,this.ha=t,this.g=e,this.wc=n}function Ty(e,t){this.name=e,this.value=t}function wy(e,t){return e.filter(function(e){return e.name==t})}function Sy(e,t){return e.filter(function(e){return by(e,"TYPE")==t})}function Ay(e,t){for(var n=(e=g(e)).next();!n.done;n=e.next())if((n=n.value).name===t)return n;return null}function Ey(e,t,n){return n=void 0===n?0:n,(e=Ay(e,t))?Number(e.value):n}function ky(e,t,n){return t?Iy(e,[t],n):[]}function Iy(e,t,n){if(!t.length)return[];var r=t;return n&&n.size&&(r=t.map(function(e){return Cy(e,n)})),dt(e,r)}function Cy(e,t){if(!t||!t.size)return e;var n=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(n)for(var r=(n=g(n)).next();!r.done;r=n.next()){var i=(r=r.value).slice(2,r.length-1),a=t.get(i);if(!a)throw new Ke(2,4,4039,i);e=e.replace(r,a)}return e}function My(){this.g=0}function Ry(e,t){var n=(t=(t=Ye(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!Dy.test(n[0]))throw new Ke(2,4,4015);t=0;for(var r=!1,i=[],a=!0,o=0;o<n.length;o++){var s=n[o],u=n[o+1];if(s.startsWith("#")&&!s.startsWith("#EXT")||a)a=!1;else{if(s=_y(e,s),r||(Oy.has(s.name)?(t=1,r=!0):"EXT-X-STREAM-INF"==s.name||"EXT-X-MEDIA"==s.name?r=!0:Uy.has(s.name)&&(t=1,r=!0)),Uy.has(s.name)){if(1!=t)throw new Ke(2,4,4017);a=e,e=Array(Math.max(100,Math.floor((n.length-o)/2))),r=0,s=[];var l=[];for(u=null;o<n.length;o++){var d=n[o];d.startsWith("#EXT")?(d=_y(a,d),Oy.has(d.name)?i.push(d):"EXT-X-MAP"==d.name?u=d:"EXT-X-PART"==d.name?l.push(d):"EXT-X-PRELOAD-HINT"==d.name?"PART"==yy(d,"TYPE")?l.push(d):"MAP"==yy(d,"TYPE")&&(d.name="EXT-X-MAP",u=d):s.push(d)):d.startsWith("#")&&!d.startsWith("#EXT")||(d=d.trim(),u&&s.push(u),s=new xy(d,s,l),r<e.length?e[r++]=s:(e.push(s),r++),s=[],l=[])}return l.length&&(u&&s.push(u),n=new xy("",s,l),r<e.length?e[r++]=n:(e.push(n),r++)),new fy(t,i,r<e.length?e.slice(0,r):e)}i.push(s),"EXT-X-STREAM-INF"==s.name&&(s.attributes.push(new Ty("URI",u)),a=!0)}}return new fy(t,i)}function _y(e,t){e=e.g++;var n=t.match(Py);if(!n)throw new Ke(2,4,4016,t);t=n[1];var r,i,a=n[2];if(n=[],a)for(a=new jt(a),Ly.lastIndex=0,(i=Vt(a,Ly))&&(r=i[1]),Ny.lastIndex=0,i=Vt(a,Ny);i;)n.push(new Ty(i[1],i[2]||i[3])),Ft(a),i=Vt(a,Ny);return new gy(e,t,n,r)}p(hy,$v),(i=hy.prototype).Ba=function(){return this.h},i.Ob=function(){return"Xbox"},i.Oa=function(){return"CONSOLE"},i.Ha=function(){return this.g?"EDGE":"CHROMIUM"},i.Fd=function(){return!0},i.hh=function(){return!0},i.hf=function(){return!0},i.Yi=function(){return this.g},i.lc=function(){var e={width:1920,height:1080},t=py();if(t)try{var n=new t.Media.Protection.ProtectionCapabilities,r=t.Media.Protection.ProtectionCapabilityResult;t=null;do{t=n.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(t===r.maybe);t===r.probably&&(e.width=3840,e.height=2160)}catch(i){K("Xbox: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},i.Wa=function(e){return $v.prototype.Wa.call(this,e),e.drm.parseInbandPsshEnabled=this.g,e.drm.preferredKeySystems.push("com.microsoft.playready"),this.g&&(e.streaming.gapPadding=.01),e},i.Ef=function(){return!0},i.Bh=function(){return!1},(navigator.userAgent.includes("Xbox One")||null!==py())&&(se=function(){return new hy}),gy.prototype.toString=function(e){var t="#"+this.name,n=this.attributes?this.attributes.filter(function(t){return!e||!e.has(t.name)}).map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&n.unshift(this.value),n.length>0&&(t+=":"+n.join(",")),t};var Py=/^#(EXT[^:]*)(?::(.*))?$/,Dy=/^#EXTM3U($|[ \t\n])/m,Ly=/^([^,=]+)(?:,|$)/g,Ny=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,Oy=new Set("EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" ")),Uy=new Set("EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" "));function By(){}function jy(e,t){try{var n=Fy(e);return Pi({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType},originalRequest:t})}catch(r){return Ri(r)}}function Fy(t){var n=t.split(":");if(n.length<2||"data"!=n[0])throw new Ke(2,1,1004,t);if((n=n.slice(1).join(":").split(",")).length<2)throw new Ke(2,1,1004,t);var r=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=r.split(";"),r=n[0];var i=!1;return n.length>1&&"base64"==n[n.length-1]&&(i=!0,n.pop()),{data:i?ot(t):Qe(t),contentType:r}}function Vy(){var t=this;this.g=this.h=null,this.G=1,this.B=new Map,this.M=new Map,this.C=new Map,this.C.set("video",new Map),this.C.set("audio",new Map),this.C.set(mt,new Map),this.C.set("image",new Map),this.ec=(new Map).set("com.apple.streamingkeydelivery",function(n,r,i){return function(t,n,r,i){var a,o,s,u,l;return P(function(d){if(1==d.g){if("video/mp2t"==r)throw new Ke(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Ke(2,4,4041);if(a=by(n,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(a))return d.return(null);o="cenc","SAMPLE-AES"==a&&(o="cbcs"),s=by(n,"URI"),u=ct("com.apple.fps",o,null,s);var c=new me(s).Eb.replace(/-/g,"").toLowerCase();return(l=32===c.length&&/^[0-9a-f]+$/.test(c)?c:null)||!i?d.A(2):x(d,Rb(t,i),3)}return 2!=d.g&&(l=d.h),l&&u.keyIds.add(l),d.return(u)})}(t,n,r,i)}).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",function(e){var n=by(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var r="cenc";"SAMPLE-AES"==n&&(r="cbcs");var i=by(e,"URI");n=Fy(i.split("?")[0]),i=i.split("?")[0],t.I.has(i)||(n=Ne(n.data),t.I.set(i,n)),r=ct("com.widevine.alpha",r,[{initDataType:"cenc",initData:t.I.get(i)}]),(e=yy(e,"KEYID"))&&r.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(r)}else e=Promise.resolve(null);return e}).set("com.microsoft.playready",function(e){var t=by(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),n=ct("com.microsoft.playready",n,[{initDataType:"cenc",initData:t=ya(e=Ne((e=Fy((e=by(e,"URI")).split("?")[0])).data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),new Set,0)}]),(e=Jt(["<PLAYREADY>",at(e),"</PLAYREADY>"].join("\n")))&&(n.licenseServerUri=Qg(e)),n=Promise.resolve(n)}else n=Promise.resolve(null);return n}).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",function(e){var n=by(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var r="cenc";"SAMPLE-AES"==n&&(r="cbcs");var i=by(e,"URI");n=Fy(i.split("?")[0]),i=i.split("?")[0],t.I.has(i)||(n=Ne(n.data),t.I.set(i,n)),r=ct("com.huawei.wiseplay",r,[{initDataType:"cenc",initData:t.I.get(i)}]),(e=yy(e,"KEYID"))&&r.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(r)}else e=Promise.resolve(null);return e}),this.ob=new Set,this.i=new Map,this.l=null,this.H="",this.ab=new My,this.N=-1,this.ma=1/0,this.ba=this.zc=this.kb=!1,this.F=new Rr(function(){t.X&&!t.g.continueLoadingWhenPaused&&(t.V.Ma(t.X,"timeupdate"),t.X.paused)?t.V.Aa(t.X,"timeupdate",function(){return Ab(t)}):Ab(t)}),this.Fa=Bb,this.m=null,this.eb=0,this.o=1/0,this.Ua=this.Ta=this.T=0,this.$=new ji,this.J=new Map,this.K=new Map,this.Da=new Map,this.va=new Map,this.O=new Map,this.ya=new Map,this.za=new Map,this.yc=this.oa=!1,this.bc=new H(5),this.j=null,this.R=!0,this.V=new ne,this.u=this.X=null,this.dc=function(){return!1},this.I=new Map}function Hy(e,t){return Eb(e)?e.C.get(t.type):t.qf}function Gy(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,v,y,b,S,k,I,C,M,R,_,D,L,N,O,U,B,j,F,V,H,G,z;return P(function(P){switch(P.g){case 1:if(t.stream.isAudioMuxedInVideo)return P.return();for(n=[],r=g(t.P()),i=r.next();!i.done;i=r.next())a=i.value,o=new me(a),s=o.g,t.Te&&(t.Rb>=0&&s.add("_HLS_msn",String(t.Rb)),t.Sb>=0&&s.add("_HLS_part",String(t.Sb))),t.Ue&&s.add("_HLS_skip","YES"),_e(s)&&xe(o,Te(s.toString())),n.push(o.toString());return w(P,2),x(P,Sb(e,n,!0).promise,4);case 4:u=P.h,A(P,3);break;case 2:throw l=E(P),e.h&&e.h.disableStream(t.stream),l;case 3:if(!t.stream.segmentIndex)return P.return();if(1!=(d=Ry(e.ab,u.data)).type)throw new Ke(2,4,4017);return(c=u.uri)==u.originalUri||t.P().includes(c)||t.Cf.push(c),h=wy(d.ha,"EXT-X-DEFINE"),p=qy(e,h,c),f=t.stream,v=Hy(e,t),x(P,lb(e,d,f.mimeType,t.P,p),5);case 5:for(y=P.h,b=y.keyIds,S=y.drmInfos,k=y.encrypted,I=y.Oh,f.encrypted||!k||I||(f.encrypted=!0),function(e,t){return e.size===t.size&&[].concat(m(e)).every(function(e){return t.has(e)})}(f.keyIds,b)||(f.keyIds=b,f.drmInfos=S,e.h.newDrmInfo(f)),C=yb(e,d,v,p,t.P,t.type),M=C.segments,(R=C.bandwidth)&&(f.bandwidth=R),_=Gu(f),D=g(M),L=D.next();!L.done;L=D.next())(N=L.value).ea&&(N.ea.xd=_);f.segmentIndex.je(M,e.l.Ib()),M.length&&(O=Ey(d.ha,"EXT-X-MEDIA-SEQUENCE",0),B=(U=Ay(d.ha,"EXT-X-SKIP"))?Number(yy(U,"SKIPPED-SEGMENTS")):0,j=sb(O,M),F=j.Rb,V=j.Sb,t.Rb=F+B,t.Sb=V,H=v.get(O),f.segmentIndex.Ya(H)),(G=Du(f.segmentIndex))&&(t.Wc=G.startTime,z=M[M.length-1],t.Mc=z.endTime),Ay(d.ha,"EXT-X-ENDLIST")&&(t.ae=!0),hb(e,d),vb(e,d.ha,f.type,p,t.P),T(P)}})}function zy(e,t,n){n=void 0!==n&&n;for(var r=-1==e.N,i=g(t),a=i.next();!a.done;a=i.next()){var o=(a=a.value).stream.segmentIndex,s=Hy(e,a);if(o=Du(o))for(var u=(s=g(s)).next();!u.done;u=s.next()){var l=(u=g(u.value)).next().value;if(u.next().value==o.startTime){r&&(e.N=Math.max(e.N,l)),a.rg=l;break}}}if(!(e.N<0))for(r=(t=g(t)).next();!r.done;r=t.next())(ab(e,(r=r.value).type)||n)&&(i=r.stream.segmentIndex)&&(a=e.N-r.rg)>0&&(i.g.splice(0,a),i=Du(i))&&(i=-i.startTime,r.stream.segmentIndex.offset(i),Xy(e,r,i))}function Xy(e,t,n){if(!(Math.abs(n)<.001)){t.Wc+=n,t.Mc+=n;for(var r=g(e=Hy(e,t)),i=r.next();!i.done;i=r.next()){var a=g(i.value);i=a.next().value,a=a.next().value,e.set(i,a+n)}t.P()}}function Wy(e,t,n){var r,i,a,o,s;return P(function(u){switch(u.g){case 1:return t?(r=Yi,i=ll(t.P(),t.Jc(),t.Hc(),e.g.retryParameters),x(u,Ib(e,i,r,{type:t instanceof Vo?1:0}).promise,2)):u.return({mimeType:null,data:null});case 2:if(a=u.h,o=a.data,!t.aesKey){u.A(3);break}return x(u,ol(o,t.aesKey,n),4);case 4:o=u.h;case 3:return t instanceof Vo?t.se(o,!0):t.se(o),(s=a.headers["content-type"])&&(s=s.split(";")[0].toLowerCase()),u.return({mimeType:s,data:o})}})}function Ky(e){if(Eb(e)){if(e.Fa==Fb){for(var t=1/0,n=1/0,r=g(e.i.values()),i=r.next();!i.done;i=r.next())(i=i.value).stream.segmentIndex&&"text"!=i.stream.type&&!i.stream.isAudioMuxedInVideo&&(t=Math.min(t,i.Mc),n=Math.min(n,i.Wc));t=t-n||0,isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.Kf(t)}}else e.l.Ab(nb(e));if(!e.l.o)for(n=(t=g(e.i.values())).next();!n.done;n=t.next())!(n=n.value).stream.segmentIndex||"audio"!=n.type&&"video"!=n.type||(n=Du(n.stream.segmentIndex))&&n.h&&e.l.rh(n.h);e.l.pf()}function qy(e,t,n){n=new me(n).g;for(var r=new Map,i=(t=g(t)).next();!i.done;i=t.next()){var a=i.value,o=yy(a,"NAME"),s=yy(a,"VALUE");i=yy(a,"QUERYPARAM"),a=yy(a,"IMPORT"),o&&s&&(r.has(o)||r.set(o,s)),i&&(o=n.get(i)[0])&&!r.has(o)&&r.set(i,o),a&&(i=e.B.get(a))&&r.set(a,i)}return r}function Yy(e){var t=new Set([dr(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Gb(function(n){n.mimeType&&t.add(dr(n.mimeType,e.codecs))}),e.fullMimeTypes=t}function $y(e,t,n){for(var r={audio:[],video:[]},i=new Map,a=[],o=!1,s=!1,u=g(t),l=u.next();!l.done;l=u.next()){var d=l.value;l=yy(d,"AUDIO");var c=yy(d,"VIDEO"),h=l||c;h&&(a.includes(h)||a.push(h),(d=yy(d,"PATHWAY-ID"))&&i.set(h,d),l?o=!0:c&&(s=!0))}a.length&&n.length&&function(e,t,n){t=t.filter(function(e){var t=yy(e,"URI")||"";return"SUBTITLES"!=(e=yy(e,"TYPE"))&&(""!=t||"AUDIO"==e)});for(var r={},i=(t=g(t)).next();!i.done;i=t.next()){var a=my(i=i.value,!e.j);r[a]?r[a].push(i):r[a]=[i]}for(var o in r)Zy(e,r[o],n,!1)}(e,n=n.filter(function(e){return a.includes(by(e,"GROUP-ID"))}),i),n=(i=a.sort().join(","))&&e.M.has(i)?e.M.get(i):[],o?r.audio.push.apply(r.audio,m(n)):s&&r.video.push.apply(r.video,m(n)),s=!1;var p=t.map(function(e){return by(e,"URI")});return o=r.audio.find(function(e){return e&&e.P().find(function(e){return p.includes(e)})}),u=ft("video",n=Jy(e,t[0])),(l=ft("audio",n))&&!u?(o="audio",s=r.audio.length>0&&!r.audio.some(function(e){return e.stream.isAudioMuxedInVideo})):!r.audio.length&&!r.video.length&&l&&u?(o="video",n=[[u,l].join()]):r.audio.length&&o?(o="audio",s=!0):o=r.video.length&&!r.audio.length?"audio":"video",s||(t=function(e,t,n,r){for(var i=e.G++,a=[],o=g(t),s=o.next();!s.done;s=o.next()){var u=s.value;s=by(u,"URI"),u=yy(u,"PATHWAY-ID"),e.j&&u&&Um(e.j,i,u,s),a.push(s)}if(o=a.sort().join(",")+n.sort().join(","),e.i.has(o))return e.i.get(o);s=a.join(",");e:{if(t=yy(t[0],"CLOSED-CAPTIONS"),"video"==r){if(e.g.disableText){e.R=!1,t=null;break e}if(t){if("NONE"!=t){t=e.J.get(t);break e}e.R=!1}else if(!t&&e.J.size)for(t=(t=g(e.J.keys())).next();!t.done;t=t.next()){t=e.J.get(t.value);break e}}t=null}return n=pt(r,n),r=tb(e,i,a,n,r,null,!1,s,null,t,null,!1,null,!1),e.i.set(o,r),r}(e,t,n,o),i&&e.g.enableAudioGroups&&(t.stream.groupId=i),"audio"==t.stream.type&&"audio"===o&&r.audio.some(function(e){return e.stream.isAudioMuxedInVideo})&&(e=r.audio[0].stream,t.stream.language=e.language,t.stream.channelsCount=e.channelsCount,t.stream.label=e.label,t.stream.audioSamplingRate=e.audioSamplingRate,t.stream.originalId=e.originalId,t.stream.originalLanguage=e.originalLanguage),r[t.stream.type]=[t]),r}function Jy(e,t){return t=yy(t,"CODECS")||"",e.ba=t.length>0,e.ba||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),t=t.join(",")),al(t.split(/\s*,\s*/))}function Qy(e,t,n,r,i,a,o,s,u,l,d,c){for(var h=g(n),p=h.next();!p.done;p=h.next())wb(p.value.stream,i,a,o,s,u,null);for(i=e.g.disableVideo,n.length&&!i||(n=[null]),i&&(t=t.filter(function(e){return!e.stream.isAudioMuxedInVideo})),i=e.g.disableAudio,t.length&&!i||(t=[null]),i=[],a=(t=g(t)).next();!a.done;a=t.next())for(a=a.value,s=(o=g(n)).next();!s.done;s=o.next()){var f=s.value;(s=a?a.stream:null)&&(s.drmInfos=l,s.keyIds=d),(u=f?f.stream:null)&&(u.drmInfos=l,u.keyIds=d,e.g.disableIFrames||pi(u,c)),u&&!s&&(u.bandwidth=r),!u&&s&&(s.bandwidth=r),h=a?a.stream.drmInfos:null,p=f?f.stream.drmInfos:null,f=f?f.P().sort().join(","):"";var m=a?a.P().sort().join(","):"",v=[];s&&s.codecs&&v.push(s.codecs),u&&u.codecs&&v.push(u.codecs),f=[f,m,v.sort()].join("-"),s&&u&&!je(h,p)||e.ob.has(f)||(s={id:e.G++,language:s?s.language:"und",disabledUntilTime:0,primary:!!s&&s.primary||!!u&&u.primary,audio:s,video:u,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},i.push(s),e.ob.add(f))}return i}function Zy(e,t,n,r){r=void 0===r||r;for(var i=[],a=[],o=new Map,s=g(t),u=s.next(),l={};!u.done;l={mi:void 0},u=s.next()){u=u.value,l.mi=++e.G,l=function(e){return function(){return"shaka://hls-muxed"+e.mi}}(l);var d=r?by(u,"URI"):yy(u,"URI")||l();l=by(u,"GROUP-ID"),i.push(d),a.push(l),o.set(l,d),(u=yy(u,"PATHWAY-ID"))&&n.set(l,u)}if(r=a.sort().join(","),u=t[0],t="",s=function(e){return"subtitles"==(e=by(e,"TYPE").toLowerCase())&&(e=mt),e}(u),s==mt)t=yy(u,"CODECS")||"";else for(l=(a=g(a)).next();!l.done;l=a.next())if(l=l.value,e.K.has(l)){t=e.K.get(l);break}if(a=i.sort().join(","),"audio"==s&&r&&(a+=r),e.i.has(a))return e.i.get(a);if(l=e.G++,e.j)for(d=(o=g(o)).next();!d.done;d=o.next()){var c=g(d.value);d=c.next().value,c=c.next().value,(d=n.get(d))&&Um(e.j,l,d,c)}n=yy(u,"LANGUAGE"),o=yy(u,"NAME"),d="YES"==yy(u,"DEFAULT"),c="audio"==s?function(e){return(e=yy(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}(u):null;var h="audio"==s&&function(e){return!!(e=yy(e,"CHANNELS"))&&2==(e=e.split("/")).length&&("JOC"===e[1]||e[1].includes("ATMOS"))}(u),p=yy(u,"CHARACTERISTICS"),f="YES"==yy(u,"FORCED");return u="audio"==s?function(e){return(e=yy(e,"SAMPLE-RATE"))?parseInt(e,10):null}(u):null,(i=tb(e,l,i,t,s,n,d,o,c,null,p,f,u,h)).stream&&e.g.enableAudioGroups&&(i.stream.groupId=r),e.M.has(r)?e.M.get(r).push(i):e.M.set(r,[i]),e.i.set(a,i),i}function eb(e,t){var n="video",r=by(t,"URI"),i=yy(t,"CODECS")||"";if("mjpg"==i&&(n="image"),e.i.has(r))return e.i.get(r);var a=yy(t,"LANGUAGE"),o=yy(t,"NAME"),s=yy(t,"CHARACTERISTICS");return n=tb(e,e.G++,[r],i,n,a,!1,o,null,null,s,!1,null,!1),a=g((i=yy(t,"RESOLUTION"))?i.split("x"):[null,null]),i=a.next().value,a=a.next().value,n.stream.width=Number(i)||void 0,n.stream.height=Number(a)||void 0,(t=yy(t,"BANDWIDTH"))&&(n.stream.bandwidth=Number(t)),e.i.set(r,n),n}function tb(e,t,n,r,i,a,o,s,u,l,d,c,h,p){function f(t){var n,f,y,S,k,I,C,M,R,_,D,L,N,O,U,B,j,F;return P(function(P){switch(P.g){case 1:return n=vt,w(P,2),x(P,t.promise,4);case 4:if(f=P.h,t.aborted)return P.return();if((y=f.uri)!=f.originalUri&&(b.P().includes(y)||b.Cf.push(y)),1!=(S=Ry(e.ab,f.data)).type)throw new Ke(2,4,4017);return k=wy(S.ha,"EXT-X-DEFINE"),I=qy(e,k,y),C=!1,(!e.ba&&e.g.hls.disableCodecGuessing||e.R&&i==n.wa&&!e.g.hls.disableClosedCaptionsDetection)&&S.segments.length>0&&(e.R=!1,C=!0),M=!e.ba&&e.g.hls.disableCodecGuessing,R=Eb(e),x(P,ob(e,0,I,S,m,r,i,a,o,s,u,l,d,c,h,p,void 0,C,M),5);case 5:if(_=P.h,t.aborted)return P.return();D=_.stream,cb(e,S),Eb(e)&&!R&&pb(e,S),b.Wc=_.Wc,b.Mc=_.Mc,b.Ue=_.Ue,b.Te=_.Te,b.ae=_.ae,b.qf=_.qf,b.Rb=_.Rb,b.Sb=_.Sb,v.segmentIndex=D.segmentIndex,v.encrypted=D.encrypted,v.drmInfos=D.drmInfos,v.keyIds=D.keyIds,v.mimeType=D.mimeType,v.bandwidth=v.bandwidth||D.bandwidth,v.codecs=v.codecs||D.codecs,v.closedCaptions=v.closedCaptions||D.closedCaptions,v.width=v.width||D.width,v.height=v.height||D.height,v.hdr=v.hdr||D.hdr,v.colorGamut=v.colorGamut||D.colorGamut,v.frameRate=v.frameRate||D.frameRate,"und"==v.language&&"und"!=D.language&&(v.language=D.language),v.language=v.language||D.language,v.channelsCount=v.channelsCount||D.channelsCount,v.audioSamplingRate=v.audioSamplingRate||D.audioSamplingRate,Yy(v),v.drmInfos.length&&e.h.newDrmInfo(v),L=!1,(!l&&v.closedCaptions||l&&v.closedCaptions&&l.size!=v.closedCaptions.size)&&(L=!0),e.m&&L&&e.h.makeTextStreamsForClosedCaptions(e.m),i==n.Na&&(N=Du(D.segmentIndex))&&N.ea&&(v.mimeType="application/mp4",Yy(v)),O=Gu(v),v.segmentIndex.Gb(function(e){e.ea&&(e.ea.xd=O)}),function(e){if(!e.m)return!1;for(var t=[],n=[],r=(e=g(e.m.variants)).next();!r.done;r=e.next())(r=r.value).video&&t.push(r.video),r.audio&&n.push(r.audio);return!(t.length>0&&!t.some(function(e){return e.segmentIndex})||n.length>0&&!n.some(function(e){return e.segmentIndex}))}(e)&&(e.zc?ib(e,[b]):(e.zc=!0,U=Array.from(e.i.values()),B=U.filter(function(e){return e.stream.segmentIndex}),ib(e,B),Ky(e),(j=e.o)>0&&e.F.ka(j))),vb(e,S.ha,v.type,I,m),e.m&&(e.m.startTime=e.u),A(P,0);break;case 2:if(F=E(P),v.closeSegmentIndex(),7001===F.code)return P.return();if(!e.h.disableStream(v))throw F;T(P)}})}function m(){return e.j&&n.length>1?Bm(e.j,t):b.Cf.concat(Iy([e.H],n,e.B))}var v=ub(e,r,i,a,o,s,u,l,d,c,h,p);n.some(function(e){return e.startsWith("shaka://hls-muxed")})&&(v.isAudioMuxedInVideo=!0,v.mimeType="video/mp2t",Yy(v));var y,b={stream:v,type:i,Cf:[],Wc:0,Mc:0,qf:new Map,Ue:!1,Te:!1,ae:!1,rg:-1,Rb:-1,Sb:-1,P:m},S=null;return v.createSegmentIndex=function(){return S||(v.isAudioMuxedInVideo?(v.segmentIndex=new Pu([]),Promise.resolve()):(y=Sb(e,b.P(),!0),S=new Promise(function(e){e(f(y))})))},v.closeSegmentIndex=function(){S&&!v.segmentIndex&&y.abort(),v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null),S=null},b}function nb(e){for(var t=1/0,n=(e=g(e.i.values())).next();!n.done;n=e.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&!n.stream.isAudioMuxedInVideo&&(t=Math.min(t,n.Mc));return t}function rb(e,t){for(var n=[],r=(t=g(t)).next();!r.done;r=t.next())(r=r.value).segmentIndex&&r.segmentIndex.Gb(function(e){n.push(e)});e.l.le(n)}function ib(e,t){if(!Eb(e))for(var n=nb(e),r=g(t),i=r.next();!i.done;i=r.next())i.value.stream.segmentIndex.pd(0,n);rb(e,t.map(function(e){return e.stream})),n=(r=Array.from(e.i.values()).filter(function(e){return e.stream.segmentIndex})).some(function(e){return"audio"==e.stream.type}),i=r.some(function(e){return"video"==e.stream.type}),r=Eb(e)&&!e.kb,n=!Eb(e)&&e.kb&&!(n&&i),e.g.hls.ignoreManifestProgramDateTime||r||n?zy(e,t,r):(function(e,t){if(e.ma==1/0)for(var n=(t=g(t)).next();!n.done;n=t.next())null!=(n=Du(n.value.stream.segmentIndex))&&null!=n.h&&(e.ma=Math.min(e.ma,n.h));if((t=e.ma)!=1/0)for(var r=(n=g(e.i.values())).next();!r.done;r=n.next())if(!ab(e,(r=r.value).type)){var i=r.stream.segmentIndex;if(null!=i){var a=Du(i);if(a)if(null==a.h)W("Missing EXT-X-PROGRAM-DATE-TIME for stream",r.P(),"Expect AV sync issues!");else for(Xy(e,r,a.h-t-a.startTime),i=(r=g(i)).next();!i.done;i=r.next())i.value.Ch(t)}}}(e,t),e.g.hls.ignoreManifestProgramDateTimeForTypes.length>0&&zy(e,t))}function ab(e,t){return!!e.g.hls.ignoreManifestProgramDateTime||e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function ob(e,t,n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b){var T,S,k,I,C,M,R,_,D,L,N,O,U,B,j,F,V,H,G,z,X,W,K,q,Y,$,J,Q,Z;return y=void 0===y||y,b=void 0===b||b,P(function(t){switch(t.g){case 1:if(T=r.segments||[],S=T.every(function(e){return!!Ay(e.ha,"EXT-X-GAP")}),!T.length||S)throw new Ke(2,4,4053);if(function(e,t){var n=Ay(t.ha,"EXT-X-PLAYLIST-TYPE");t=Ay(t.ha,"EXT-X-ENDLIST"),t=n&&"VOD"==n.value||t,n=n&&"EVENT"==n.value&&!t,n=!t&&!n,kb(e,t?Bb:n?Fb:jb)}(e,r),Eb(e)&&hb(e,r),k=Eb(e)?e.C.get(o):new Map,I=yb(e,r,k,n,i,o),C=I.segments,M=I.bandwidth,N=L=D=_=R=null,!(C.length>0&&y)){t.A(2);break}return x(t,function(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y;return P(function(b){if(1==b.g)return n=rl(e.g.hls.mediaPlaylistFullMimeType),t.length?(r=Tb(e,t),i=r.segment,a=r.segmentIndex,o=i.P(),(s=ul(o[0]))&&(u=_b.get(s))?b.return(rl(u)):x(b,Promise.all([Wy(e,i.ea,0),Wy(e,i,a)]),2)):b.return(n);if(l=b.h,d=l[1].mimeType,c=l[0].data,h=l[1].data,p="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),f=["audio/mp4","video/mp4","video/iso.segment"],!(m=i.ea||f.includes(d))&&Ms(Ne(h))){var T=h,w=e.g.disableAudio,S=e.g.disableVideo,A=e.g.disableText,E=Ne(T),k=(new Es).parse(E),I=k.Xd();E=k.Mg();var C=[],M=!1,R=!1;if(!w)switch(I.audio){case"aac":case"aac-loas":k.ub().length&&(C.push("mp4a.40.2"),M=!0);break;case"mp3":k.ub().length&&(C.push("mp4a.40.34"),M=!0);break;case"ac3":k.ub().length&&(C.push("ac-3"),M=!0);break;case"ec3":k.ub().length&&(C.push("ec-3"),M=!0);break;case"opus":k.ub().length&&(C.push("opus"),M=!0)}if(!S)switch(I.video){case"avc":E.codec?C.push(E.codec):C.push("avc1.42E01E"),R=!0;break;case"hvc":E.codec?C.push(E.codec):C.push("hvc1.1.6.L93.90"),R=!0;break;case"av1":C.push("av01.0.01M.08"),R=!0}if(C.length){if(w=M&&!R,S=new Map,R&&!A){for((A=new _t("video/mp2t")).zf(T),R=(T=g(A.Yf())).next();!R.done;R=T.next())R=R.value,S.set(R,R);A.Od()}E={type:w?"audio":"video",mimeType:"video/mp2t",codecs:C.join(", "),language:null,height:E.height,width:E.width,channelCount:null,sampleRate:null,closedCaptions:S,ye:null,colorGamut:null,frameRate:E.frameRate,timescale:null}}else E=null;if(v=E)return b.return(v)}else if((m||p.includes(s))&&(y=il(c,h,e.g.disableText)))return b.return(y);return d?b.return(rl(d)):b.return(n)})}(e,C),3);case 3:O=t.h,o!=O.type&&Eb(e)&&(e.C.set(O.type,e.C.get(o)),e.C.set(o,new Map)),o=O.type,s=O.language,d=O.channelCount,f=O.sampleRate,e.g.disableText||(c=O.closedCaptions),_=O.height,R=O.width,D=O.ye,L=O.colorGamut,N=O.frameRate,b&&(v=O.mimeType,a=O.codecs);case 2:if(v){t.A(4);break}return x(t,function(e,t,n,r){var i,a,o,s,u,l,d,c,h,p,f,g,m;return P(function(v){switch(v.g){case 1:return i=Yi,a=Tb(e,r),2==(o=a.segment).status?v.return(xb(t)):(u=o.P(),(l=ul(u[0]))&&(d=Ob.get(t),(c=d.get(l))||(c=_b.get(l)))?v.return(c):(s=bb(t,n))?v.return(s):(p=1,f=zi(u,e.g.retryParameters),w(v,2),f.method="HEAD",x(v,Ib(e,f,i,{type:p}).promise,4)));case 4:g=v.h,h=g.headers["content-type"],A(v,3);break;case 2:if(!(m=E(v))||1002!=m.code&&1001!=m.code){v.A(3);break}return f.method="GET",e.g.hls.allowRangeRequestsToGuessMimeType&&(f.headers.Range="bytes=0-0"),x(v,Ib(e,f,i,{type:p}).promise,6);case 6:g=v.h,h=g.headers["content-type"];case 3:if(!h){v.A(7);break}if("application/octet-stream"!=(s=h.toLowerCase().split(";")[0])){v.A(8);break}if(g.data.byteLength){v.A(9);break}return f.method="GET",x(v,Ib(e,f,i,{type:p}).promise,10);case 10:g=v.h;case 9:Ms(Ne(g.data))&&(s="video/mp2t");case 8:if("application/octet-stream"!=s)return v.return(s);case 7:return v.return(xb(t))}})}(e,o,a,C),5);case 5:v=t.h,o!=mt||a||"application/mp4"!=v||!C[0]||C[0].ea||(v="text/vtt");case 4:return x(t,lb(e,r,v,i,n),6);case 6:if(U=t.h,B=U.drmInfos,j=U.keyIds,F=U.encrypted,V=U.Oh,F&&!B.length&&!V)throw new Ke(2,4,4026);return(H=ub(e,a,o,s,u,l,d,c,h,p,f,m)).encrypted=F&&!V,H.drmInfos=B,H.keyIds=j,H.mimeType=v,M&&(H.bandwidth=M),Yy(H),"video"==o&&(R||_||D||L)&&wb(H,R,_,N,D,null,L),Eb(e)&&hb(e,r),G=C[0].startTime,z=C[C.length-1],X=z.endTime,W=new Pu(C),H.segmentIndex=W,q=!!(K=Ay(r.ha,"EXT-X-SERVER-CONTROL"))&&null!=vy(K,"CAN-SKIP-UNTIL"),Y=!!K&&null!=vy(K,"CAN-BLOCK-RELOAD"),$=Ey(r.ha,"EXT-X-MEDIA-SEQUENCE",0),J=sb($,C),Q=J.Rb,Z=J.Sb,t.return({stream:H,type:o,Cf:[],P:i,Wc:G,Mc:X,Ue:q,Te:Y,ae:!1,rg:-1,Rb:Q,Sb:Z,qf:k})}})}function sb(e,t){e=e+t.length-1;var n=-1;if(!t.length)return{Rb:++e,Sb:n};var r=(t=t[t.length-1]).g;return t.g.length?(n=r.length-1,r[r.length-1].isPreload()||(e++,n=0),{Rb:e,Sb:n}):(e++,t.o&&(n=0),{Rb:e,Sb:n})}function ub(e,t,n,r,i,a,o,s,u,l,d,c){var h=bb(n,t)||xb(n),p=[];if(u)for(var f=(u=g(u.split(","))).next();!f.done;f=u.next())p.push(f.value);return f=void 0,u=null,n==mt?f=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":p.includes("public.accessibility.describes-video")&&(u="visually impaired"),p.length||"subtitle"!==f||p.push("subtitle"),f=null,"video"!=n&&(f=a),Yy(e={id:e.G++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:h,codecs:t,kind:n==mt?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:jr(r||"und"),originalLanguage:r,label:f,type:n,primary:i,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:l,channelsCount:o,audioSamplingRate:d,spatialAudio:c,closedCaptions:s,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:u,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}),e}function lb(e,t,n,r,i){var a,o,s,u,l,d,c,h,p,f,m,v,y,b,T,w,S,A,E,k,I,C,M,R,_,D,L,N,O;return P(function(P){switch(P.g){case 1:if(a=new Map,!e.g.ignoreDrmInfo&&t.segments)for(o=g(t.segments),s=o.next();!s.done;s=o.next())if(u=s.value,l=wy(u.ha,"EXT-X-KEY"),d=null,l.length)for(d=fb(e,t,u.ha,r,i),c=g(l),h=c.next();!h.done;h=c.next())p=h.value,a.set(p,d);m=f=!1,v=[],y=new Set,b=g(a),T=b.next();case 2:if(T.done){P.A(4);break}if(w=T.value,S=g(w),A=S.next().value,E=S.next().value,I=E,"NONE"==(C=by(k=A,"METHOD"))){P.A(3);break}if(f=!0,M=yy(k,"KEYFORMAT")||"identity",R=null,Cb(C)){m=!0,P.A(3);break}if("identity"==M)return x(P,Mb(e,k,n,r,I,i),11);if(!(_=e.ec.get(M))){D=null,P.A(9);break}return x(P,_(k,n,I),10);case 10:D=P.h;case 9:R=D,P.A(6);break;case 11:R=P.h;case 6:if(R){if(R.keyIds)for(L=g(R.keyIds),N=L.next();!N.done;N=L.next())O=N.value,y.add(O);v.push(R)}case 3:T=b.next(),P.A(2);break;case 4:return P.return({drmInfos:v,keyIds:y,encrypted:f,Oh:m})}})}function db(t,n,r,i,a){if(!e.crypto||!e.crypto.subtle)throw K("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new Ke(2,4,4042);var o=0,s=yy(n,"IV","");if(s){var u=st(s.substr(2));if(16!=u.byteLength)throw new Ke(2,4,4048)}else o=Ey(r.ha,"EXT-X-MEDIA-SEQUENCE",0);var l=ky(i(),by(n,"URI"),a),d=l.sort().join("");if(r=n.toString()+"-"+o+"-"+d,!t.va.has(r)){var c={bitsKey:128,blockCipherMode:"CBC",iv:u,firstMediaSequenceNumber:o};switch(by(n,"METHOD")){case"AES-256":c.bitsKey=256;break;case"AES-256-CTR":c.bitsKey=256,c.blockCipherMode="CTR"}c.fetchKey=function(){var n,r,i,a;return P(function(o){if(1==o.g)return t.O.has(d)||(n=zi(l,t.g.retryParameters),r=Ib(t,n,6).promise,t.O.set(d,r)),x(o,t.O.get(d),2);if(3!=o.g){if(!(i=o.h).data||i.data.byteLength!=c.bitsKey/8)throw new Ke(2,4,4049);return a={name:"CTR"==c.blockCipherMode?"AES-CTR":"AES-CBC",length:c.bitsKey},x(o,e.crypto.subtle.importKey("raw",i.data,a,!0,["decrypt"]),3)}c.cryptoKey=o.h,c.fetchKey=void 0,T(o)})},t.va.set(r,c)}return t.va.get(r)}function cb(e,t){null==e.u&&(t=Ay(t.ha,"EXT-X-START"))&&(e.u=Number(by(t,"TIME-OFFSET")))}function hb(e,t){var n=1/0,r=t.segments;if(r.length)for(var i=r.length-1;i>=0;){var a=Ay(r[i].ha,"EXTINF");if(a){n=Number(a.value.split(",")[0]);break}i--}if(!(r=Ay(t.ha,"EXT-X-TARGETDURATION")))throw new Ke(2,4,4024,"EXT-X-TARGETDURATION");r=Number(r.value),(i=Ay(t.ha,"EXT-X-PART-INF"))&&(e.T=Number(by(i,"PART-TARGET"))),t=Ay(t.ha,"EXT-X-SERVER-CONTROL"),e.oa&&e.T?(e.o=e.yc?5*e.T<=n?Math.min(e.T,e.o):Math.min(n,e.o):Math.min(e.T,e.o),e.Ua=t?Number(by(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?vy(t,"HOLD-BACK"):null,e.Ta=n?Number(n.value):0),e.eb=Math.max(r,e.eb)}function pb(e,t){var n=0;if(e.g.defaultPresentationDelay)n=e.g.defaultPresentationDelay;else if(e.Ua)n=e.Ua;else if(e.Ta)n=e.Ta;else for(var r=t.segments.length,i=r-Math.min(r,e.g.hls.liveSegmentsDelay);i<r;i++){var a=Ay(t.segments[i].ha,"EXTINF");n=a?n+Number(a.value.split(",")[0]):n+e.eb}e.u&&e.u<0&&(n=Math.min(-e.u,n),e.u+=n),e.l.Ui(0),e.l.qh(n),e.l.cd(!1)}function fb(e,t,n,r,i){var a=Ay(n,"EXT-X-MAP");if(!a)return null;var o=by(a,"URI"),s=ky(r(),o,i);if(o=[s.toString(),yy(a,"BYTERANGE","")].join("-"),!e.Da.has(o)){for(var u=void 0,l=null,d=!1,c=(n=g(n)).next();!c.done;c=n.next())"EXT-X-KEY"==(c=c.value).name?Cb(d=by(c,"METHOD"))&&c.id<a.id?(d=!1,u=db(e,c,t,r,i)):d="NONE"!=d:"EXT-X-BYTERANGE"==c.name&&c.id<a.id&&(l=c);t=function(e,t,n,r,i){var a=0,o=null;return!(t=yy(t,"BYTERANGE"))&&n&&(t=n.value),t&&(a=t.split("@"),o=Number(a[0]),a=Number(a[1]),o=a+o-1,r&&(n=o+1-a)%16&&(o+=16-n%16)),new jo(function(){return e},a,o,null,null,null,r,i)}(s,a,l,u,d),e.Da.set(o,t)}return e.Da.get(o)}function gb(t,n,r,i,a,o,s,u,l,d){var c=i.ha,h=Ay(c,"EXTINF"),p=0,f=0,m=null;i.wc.length&&(t.m.isLowLatency=!0);var v=null;if(!t.g.hls.ignoreManifestProgramDateTime){var y=Ay(c,"EXT-X-PROGRAM-DATE-TIME");y&&y.value&&(v=hn(y.value),t.kb=!0)}var b=zo;if(Ay(c,"EXT-X-GAP")&&(t.m.gapCount++,b=2),!h){if(0==i.wc.length)throw new Ke(2,4,4024,"EXTINF");if(!t.oa)return null}var x=[];y=!1;var T=null,w=!1,S=!1;if(t.oa&&i.wc.length){p=n&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var A=v,E={},k=0;k<i.wc.length;E={Tf:void 0,oe:void 0},k++){var I=i.wc[k],C=0==k?r:x[x.length-1],M=0==k?a:C.endTime,R=Number(yy(I,"DURATION"))||t.T;if(R){var _=M+R,P=0,D=null;if("EXT-X-PRELOAD-HINT"==I.name?(P=(P=yy(I,"BYTERANGE-START"))?Number(P):0,(C=yy(I,"BYTERANGE-LENGTH"))?D=P+Number(C)-1:P&&(D=Number.MAX_SAFE_INTEGER)):(P=(D=g(mb(C,P=yy(I,"BYTERANGE")))).next().value,D=D.next().value),E.oe=yy(I,"URI"),E.oe){C=zo,"YES"==yy(I,"GAP")&&(t.m.gapCount++,C=2,w=!0),E.Tf=null;var L=function(e){return function(){return null==e.Tf&&(e.Tf=ky(u(),e.oe,o)),e.Tf}}(E);p&&P>=0&&null!=D&&(T=L,y=!0),M=new Vo(M,_,L,P,D,n,0,0,1/0,[],"",null,A,C,d),"EXT-X-PRELOAD-HINT"==I.name&&(M.Tg(),S=!0),"YES"!=yy(I,"INDEPENDENT")&&k>0&&M.wd(),(I=l)||(x.length&&x[0].mimeType?I=x[0].mimeType:E.oe&&(E=ul(E.oe),I=Ob.get(s).get(E)||null)),I&&(M.mimeType=I,Ub.has(I)&&(M.ea=null)),x.push(M),A&&(A+=R)}}}}if(h){if(0==(h=Number(h.value.split(",")[0])))return null;p=a+h}else{if(!x.length)return null;p=x[x.length-1].endTime}y&&(w||0!=x[0].startByte?(y=!1,T=null):x=[]),(h=Ay(c,"EXT-X-BYTERANGE"))?(f=(m=g(mb(r,h.value))).next().value,m=m.next().value):x.length&&(f=x[0].startByte,m=x[x.length-1].endByte),r="",h=null,"image"==s&&(r="1x1",s=Ay(c,"EXT-X-TILES"))&&(r=by(s,"LAYOUT"),(s=yy(s,"DURATION"))&&(h=Number(s)));var N=null;return n=new Vo(a,p,function(){return T?T():(null==N&&(N=ky(u(),i.g,o)),N||[])},f,m,n,0,0,1/0,x,r,h,v,b,d,x.length>0&&!!i.g),l&&(n.mimeType=l,Ub.has(l)&&(n.ea=null)),y&&(t.yc=!0,n.ui(),S&&n.Tg()),n}function mb(e,t){var n=0,r=null;return t&&(n=t.split("@"),t=Number(n[0]),r=(n=n[1]?Number(n[1]):e.endByte+1)+t-1),[n,r]}function vb(e,t,n,r,i){if("video"==n||"audio"==n){var a=e.l.m;if(a&&!ab(e,n))for(t=(t=wy(t,"EXT-X-DATERANGE")).filter(function(e){return null!=vy(e,"START-DATE")}).sort(function(e,t){return(e=by(e,"START-DATE"))<(t=by(t,"START-DATE"))?-1:e>t?1:0}),n=0;n<t.length;n++){var o=t[n];try{var s=hn(by(o,"START-DATE"));if(!isNaN(s)){var u=Math.max(0,s-a),l=null,d=yy(o,"END-DATE");if(d){var c=hn(d);if(!isNaN(c)&&(l=c-a)<0)continue}if(null==l){var h=yy(o,"DURATION")||yy(o,"PLANNED-DURATION");if(h){var p=parseFloat(h);if(isNaN(p)||(l=u+p),s-a+p<0)continue}}var f=yy(o,"CLASS")||"com.apple.quicktime.HLS",m="YES"==yy(o,"END-ON-NEXT");if(null==l&&m){for(var v=n+1;v<t.length;v++)if(f==(yy(t[v],"CLASS")||"com.apple.quicktime.HLS")){var y=hn(by(t[v],"START-DATE"));if(!isNaN(y)&&y&&y>s){l=Math.max(0,y-a);break}}if(null==l)continue}v=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var b=[],x=g(o.attributes),T=x.next();!T.done;T=x.next()){var w=T.value;if(!v.includes(w.name)){var S=Cy(w.value,r);"X-ASSET-URI"!=w.name&&"X-ASSET-LIST"!=w.name||(S=ky(i(),w.value,r)[0]),b.push({key:w.name,description:"",data:S,mimeType:null,pictureType:null})}}b.length>1&&e.h.onMetadata(f,u,l,b)}}catch(A){}}}}function yb(e,t,n,r,i,a){function o(e){if(!(e=ul(e)))return null;var t=Ob.get(a).get(e);return t||(t=_b.get(e)),t}var s=t.segments,u=null,l=null,d=null,c=null,h=void 0,p=Ey(t.ha,"EXT-X-DISCONTINUITY-SEQUENCE",-1),f=Ey(t.ha,"EXT-X-MEDIA-SEQUENCE",0),m=Ay(t.ha,"EXT-X-SKIP"),v=m?Number(yy(m,"SKIPPED-SEGMENTS")):0,y=f+v,b=0;Eb(e)&&n.has(y)&&(b=n.get(y)),0===b&&e.Fa==Fb&&n.size>0&&!n.has(y)&&null!=e.l.i&&(b=e.l.Ib());var x=[],T=null;m=[];for(var w=0;w<s.length;w++){var S=s[w];(y=Ay(S.ha,"EXT-X-MAP"))&&y.id!==l&&(u=fb(e,t,S.ha,i,r),l=y.id);var A="";(y=S.g)&&(A=ul(y)),A!==c&&(d=o(y),c=A),A=0==w?b:T.endTime,y=f+v+w,Ay(S.ha,"EXT-X-DISCONTINUITY")&&(p++,T&&T.ea&&(T.ea.g=A));for(var E=g(S.ha),k=E.next();!k.done;k=E.next())"EXT-X-KEY"==(k=k.value).name&&(h=Cb(by(k,"METHOD"))?db(e,k,t,i,r):void 0);if(n.set(y,A),A=gb(e,u,T,S,A,r,a,i,d,h)){if((T=Ey(S.ha,"EXT-X-BITRATE"))?(m.push({bitrate:T,duration:A.endTime-A.startTime}),A.bandwidth=T):A.endByte?(S=Ho(A))&&(S=8*S/(T=A.endTime-A.startTime)/1e3,m.push({bitrate:S,duration:T}),A.bandwidth=S):m.length&&((T=m.pop()).duration+=A.endTime-A.startTime,m.push(T),A.bandwidth=T.bitrate),A.bandwidth)for(S=(T=g(A.g)).next();!S.done;S=T.next())S.value.bandwidth=A.bandwidth;T=A,A.i=p,ab(e,a)&&null!=e.N&&y<e.N||x.push(A)}}if(t=void 0,m.length&&(t=m.reduce(function(e,t){return e+t.duration},0),t=Math.round(m.reduce(function(e,t){return e+t.bitrate*t.duration},0)/t*1e3)),m=x.some(function(e){return null!=e.h}))for(n={},r=0;r<x.length;n={Ye:void 0,Xe:void 0,Qe:void 0,Zc:void 0,Pe:void 0},r++)if(n.Zc=x[r],null==n.Zc.h)for(n.Xe=0,n.Ye=r,i=function(e){return function(){var t=x[e.Ye];if(t){if(null!=t.h)return t.h+e.Xe;e.Xe-=t.endTime-t.startTime,e.Ye+=1}return null}}(n),n.Pe=0,n.Qe=r,s=function(e){return function(){var t=x[e.Qe];if(t){if(t!=e.Zc&&(e.Pe+=t.endTime-t.startTime),null!=t.h)return t.h+e.Pe;--e.Qe}return null}}(n);null==n.Zc.h;)n.Zc.h=s(),null==n.Zc.h&&(n.Zc.h=i());if(m)for(r=(n=g(x)).next();!r.done;r=n.next())for(r=(i=r.value).h,s=(i=g(i.g)).next();!s.done;s=i.next())(s=s.value).h=r,r+=s.endTime-s.startTime;if(n=e.ma,m&&n!=1/0&&!ab(e,a))for(m=(e=g(x)).next();!m.done;m=e.next())m.value.Ch(n);return{segments:x,bandwidth:t}}function bb(e,t){if(e==mt){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function xb(e){return e==mt?"text/vtt":Ob.get(e).get("mp4")}function Tb(e,t){for(var n=t[e=Eb(e)?Math.trunc((t.length-1)/2):0];2==n.Kc()&&e+1<t.length;)n=t[++e];return{segment:n,segmentIndex:e}}function wb(e,t,n,r,i,a,o){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(r)||void 0,e.hdr=i||void 0,e.videoLayout=a||void 0,e.colorGamut=o||void 0)}function Sb(e,t,n){return Ib(e,zi(t,e.g.retryParameters),0,{type:n?2:3})}function Ab(e){var t,n,r,i,a,o;return P(function(s){switch(s.g){case 1:return e.h?(w(s,2),t=Date.now(),x(s,e.update(),4)):s.return();case 4:n=Date.now(),Eb(e)&&(r=(n-t)/1e3,e.bc.sample(1,r),i=e.g.updatePeriod>0?e.g.updatePeriod:e.o,a=Math.max(0,i-G(e.bc)),e.F.ka(a)),A(s,3);break;case 2:if(o=E(s),!e.h)return s.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(o),s.return();o.severity=1,e.h.onError(o),e.F.ka(.1);case 3:if(!e.h)return s.return();e.h.onManifestUpdated(),T(s)}})}function Eb(e){return e.Fa!=Bb}function kb(e,t){e.Fa=t,e.l&&e.l.cd(!Eb(e)),Eb(e)||e.F.stop()}function Ib(e,t,n,r){if(!e.$)throw new Ke(2,7,7001);return r||(r={}),r.isPreload=e.dc(),t=e.h.networkingEngine.request(n,t,r),Fi(e.$,t),t}function Cb(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e}function Mb(t,n,r,i,a,o){var s,u,l,d,c,h,p,f,g,m,v;return P(function(y){switch(y.g){case 1:if("video/mp2t"==r)throw new Ke(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Ke(2,4,4041);if(s=by(n,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(s))return y.return(null);if((u=ky(i(),by(n,"URI"),o))[0].startsWith("data:text/plain;base64,")){l=ut(ot(u[0].split("data:text/plain;base64,").pop())),y.A(2);break}return d=u.sort().join(""),t.ya.has(d)||(c=zi(u,t.g.retryParameters),h=Ib(t,c,6).promise,t.ya.set(d,h)),x(y,t.ya.get(d),3);case 3:p=y.h,l=ut(p.data);case 2:if(f="00000000000000000000000000000000",!a){y.A(4);break}return x(y,Rb(t,a),5);case 5:(g=y.h)&&(f=g);case 4:return(m=new Map).set(f,l),v="cenc","SAMPLE-AES"==s&&(v="cbcs"),y.return(ht(m,v))}})}function Rb(e,t){var n,r,i;return P(function(a){return 1==a.g?(n=null,e.za.has(t)?(n=e.za.get(t),a.A(2)):(r=ll(t.P(),t.Jc(),t.Hc(),e.g.retryParameters),x(a,Ib(e,r,Yi,{type:0}).promise,3))):(2!=a.g&&(i=a.h,t.se(i.data),n=function(e){var t=null;return(new oa).box("moov",sa).box("trak",sa).box("mdia",sa).box("minf",sa).box("stbl",sa).S("stsd",ua).box("encv",la).box("enca",da).box("sinf",sa).box("schi",sa).S("tenc",function(e){(e=e.reader).Y(),e.Y(),e.Y(),e.Y(),e=e.Ub(16,!1),t=ut(e)}).parse(e,!0),t}(i.data),e.za.set(t,n)),a.return(n))})}V("shaka.net.DataUriPlugin",By),By.parse=jy,Hi("data",jy),(i=Vy.prototype).configure=function(e,t){var n=this.h&&e.updatePeriod!=this.g.updatePeriod&&e.updatePeriod>=0;this.g=e,t&&(this.dc=t),this.j&&this.j.configure(this.g),n&&this.m&&this.m.presentationTimeline.W()&&this.F.Kb()},i.start=function(e,t){var n,r=this;return P(function(i){return 1==i.g?(r.h=t,r.oa=t.isLowLatencyMode(),x(i,Sb(r,[e]).promise,2)):3!=i.g?(n=i.h,r.H=n.uri,x(i,function(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f,v,y,b,S,A,k,I,C,M,R,_,D,L,N,O,U,B,j,F,V,H,G,z,X,W,K,q,Y,$,J;return P(function(Z){switch(Z.g){case 1:return n=vt,r=Ry(e.ab,t),i=wy(r.ha,"EXT-X-DEFINE"),a=[],o=[],s=[],e.l=new lu(null,0),e.l.cd(!0),u=function(){return[e.H]},l=null,d=new Map,1==r.type?(e.R=!1,F=wy(r.ha,"EXT-X-DEFINE"),d=qy(e,F,e.H),l=n.wa,V="",H=new Map,x(Z,ob(e,e.G++,d,r,u,"",l,V,!0,"Media Playlist",null,H,null,!1,null,!1),7)):(function(e,t){for(var n=new me(e.H).g,r=(t=g(t)).next();!r.done;r=t.next()){var i=r.value;r=yy(i,"NAME");var a=yy(i,"VALUE");i=yy(i,"QUERYPARAM"),r&&a&&(e.B.has(r)||e.B.set(r,a)),i&&(r=n.get(i)[0])&&!e.B.has(r)&&e.B.set(i,r)}}(e,i),c=wy(r.ha,"EXT-X-MEDIA"),h=wy(r.ha,"EXT-X-STREAM-INF"),p=wy(r.ha,"EXT-X-IMAGE-STREAM-INF"),f=wy(r.ha,"EXT-X-I-FRAME-STREAM-INF"),v=wy(r.ha,"EXT-X-SESSION-KEY"),y=wy(r.ha,"EXT-X-SESSION-DATA"),b=wy(r.ha,"EXT-X-CONTENT-STEERING"),function(e,t){for(var n=(t=g(t)).next();!n.done;n=t.next()){var r=n.value,i=yy(r,"DATA-ID");n=yy(r,"URI");var a=yy(r,"LANGUAGE");r=yy(r,"VALUE"),i=(new Map).set("id",i),n&&i.set("uri",ky([e.H],n,e.B)[0]),a&&i.set("language",a),r&&i.set("value",r),n=new Ni("sessiondata",i),e.h&&e.h.onEvent(n)}}(e,y),x(Z,function(e,t){var n,r,i,a,o,s;return P(function(u){if(!e.h||!e.g)return u.return();for(r=g(t),i=r.next();!i.done;i=r.next())if(a=i.value,o=yy(a,"PATHWAY-ID"),s=yy(a,"SERVER-URI"),o&&s){e.j=new Lm(e.h),e.j.configure(e.g),e.j.i=[e.H],e.j.setManifestType("HLS"),e.j.h=o,n=Nm(e.j,s);break}return x(u,n,0)})}(e,b),4));case 4:if(!e.g.ignoreSupplementalCodecs){for(S=[],A=g(h),k=A.next(),I={};!k.done;I={bj:void 0},k=A.next())C=k.value,(M=yy(C,"SUPPLEMENTAL-CODECS"))&&(I.bj=M.split(/\s*,\s*/).map(function(e){return e.split("/")[0]}),R=C.attributes.map(function(e){return function(t){var n=t.name,r=t.value;return"CODECS"==n&&(r=e.bj.join(","),(t=t.value.split(",")).length>1&&(t=ft("audio",t))&&(r+=","+t)),new Ty(n,r)}}(I)),S.push(new gy(C.id,C.name,R,null)));for(h.push.apply(h,m(S)),_=[],D=g(f),L=D.next(),N={};!L.done;N={cj:void 0},L=D.next())O=L.value,(U=yy(O,"SUPPLEMENTAL-CODECS"))&&(N.cj=U.split(/\s*,\s*/).map(function(e){return e.split("/")[0]}),B=O.attributes.map(function(e){return function(t){var n=t.name;return t=t.value,"CODECS"==n&&(t=e.cj.join(",")),new Ty(n,t)}}(N)),_.push(new gy(O.id,O.name,B,null)));f.push.apply(f,m(_))}return function(e,t){for(var n=(t=g(t)).next();!n.done;n=t.next()){var r=n.value,i=yy(r,"AUDIO");n=yy(r,"VIDEO");var a=yy(r,"SUBTITLES");if(r=Jy(e,r),a){var o=ft(mt,r);e.K.set(a,o),Q(r,o)}i&&((a=ft("audio",r))||(a=e.g.hls.defaultAudioCodec),e.K.set(i,a)),n&&((i=ft("video",r))||(i=e.g.hls.defaultVideoCodec),e.K.set(n,i))}}(e,h),function(e,t){t=Sy(t,"CLOSED-CAPTIONS"),e.R=0==t.length;for(var n=(t=g(t)).next();!n.done;n=t.next()){var r=n.value,i=yy(r,"LANGUAGE");n=jr(i||"und"),i||(i=yy(r,"NAME"))&&(n=i),i=by(r,"GROUP-ID"),r=by(r,"INSTREAM-ID").replace("SERVICE","svc"),e.J.get(i)||e.J.set(i,new Map),e.J.get(i).set(r,n)}}(e,c),j=function(e,t){return t.map(function(t){return"video"!==(t=eb(e,t)).stream.type?null:t.stream}).filter(function(e){return e})}(e,f),x(Z,function(e,t,n,r,i,a,o){var s,u,l,d,c,h,p,f,v,y,b,T,w,S,A,E,k,I,C,M,R,_,D,L,N,O,U,B,j,F,V,H,G,z,X,W;return P(function(P){switch(P.g){case 1:if(s=[],u=new Set,e.g.ignoreDrmInfo||!(n.length>0)){P.A(2);break}l=g(n),d=l.next();case 3:if(d.done){P.A(2);break}if(c=d.value,h=by(c,"METHOD"),p=yy(c,"KEYFORMAT")||"identity",f=null,"NONE"==h){P.A(4);break}if(Cb(h)){v=ky(i(),by(c,"URI"),a),y=v.sort().join(""),e.O.has(y)||(b=zi(v,e.g.retryParameters),T=Ib(e,b,6).promise,e.O.set(y,T)),P.A(4);break}if("identity"==p)return x(P,Mb(e,c,"",i,null,a),12);if(!(w=e.ec.get(p))){S=null,P.A(10);break}return x(P,w(c,"",null),11);case 11:S=P.h;case 10:f=S,P.A(6);break;case 12:f=P.h;case 6:if(f){if(f.keyIds)for(A=g(f.keyIds),E=A.next();!E.done;E=A.next())k=E.value,u.add(k);s.push(f)}case 4:d=l.next(),P.A(3);break;case 2:for(I={},C=g(t),M=C.next();!M.done;M=C.next())R=M.value,_=my(R,!e.j),I[_]?I[_].push(R):I[_]=[R];for(L in D=[],I)N=I[L],O=N[0],U=yy(O,"FRAME-RATE"),B=Number(by(O,"BANDWIDTH"))||Number(yy(O,"AVERAGE-BANDWIDTH")),j=yy(O,"RESOLUTION"),F=g(j?j.split("x"):[null,null]),V=F.next().value,H=F.next().value,G=yy(O,"VIDEO-RANGE"),(z=yy(O,"REQ-VIDEO-LAYOUT"))&&z.includes(",")&&(X=z.split(",").filter(function(e){return"CH-STEREO"==e||"CH-MONO"==e}),z=X[0]),z=z||"CH-MONO",W=$y(e,N,r),D.push.apply(D,m(Qy(e,W.audio,W.video,B,V,H,U,G,z,s,u,o)));return P.return(D.filter(function(e){return null!=e}))}})}(e,h,v,c,u,e.B,j),5);case 5:return a=Z.h,o=function(e,t){for(var n=Sy(t,"SUBTITLES"),r={},i=(t=g(n)).next();!i.done;i=t.next()){var a=my(i=i.value,!e.j);r[a]?r[a].push(i):r[a]=[i]}if(t=[],!e.g.disableText)for(var o in r)try{t.push(Zy(e,r[o],new Map).stream)}catch(s){if(!e.g.hls.ignoreTextStreamFailures)throw s}for(o=g(n),n=o.next();!n.done;n=o.next())if(r=by(n.value,"GROUP-ID"),(n=e.K.get(r))&&(r=e.M.get(r)))for(r=g(r),i=r.next();!i.done;i=r.next())(i=i.value).stream.codecs=n,i.stream.mimeType=bb(mt,n)||xb(mt),Yy(i.stream);return t.filter(function(e){return e})}(e,c),x(Z,function(e,t,n){var r,i;return P(function(a){return 1==a.g?(r=t.map(function(t){var n,r;return P(function(i){if(1==i.g)return e.g.disableThumbnails?i.return(null):(w(i,2),x(i,function(e,t){var n,r,i,a,o,s,u,l,d,c;return P(function(h){return 1==h.g?(n=by(t,"URI"),r=yy(t,"CODECS","jpeg")||"",e.i.has(n)?h.return(e.i.get(n)):(i=yy(t,"LANGUAGE"),a=yy(t,"NAME"),o=yy(t,"CHARACTERISTICS"),s=tb(e,e.G++,[n],r,"image",i,!1,a,null,null,o,!1,null,!1),(u=yy(t,"RESOLUTION"))?x(h,s.stream.createSegmentIndex(),3):h.A(2))):(2!=h.g&&(l=Du(s.stream.segmentIndex),(d=l.tilesLayout)&&(s.stream.width=Number(u.split("x")[0])*Number(d.split("x")[0]),s.stream.height=Number(u.split("x")[1])*Number(d.split("x")[1])),s.stream.closeSegmentIndex()),(c=yy(t,"BANDWIDTH"))&&(s.stream.bandwidth=Number(c)),e.i.set(n,s),h.return(s))})}(e,t),4));if(2!=i.g)return n=i.h,i.return(n.stream);if(r=E(i),e.g.hls.ignoreImageStreamFailures)return i.return(null);throw r})}).concat(n.map(function(t){if(e.g.disableThumbnails)return null;try{var n=eb(e,t);return"image"!==n.stream.type?null:n.stream}catch(u){if(e.g.hls.ignoreImageStreamFailures)return null;throw u}})),x(a,Promise.all(r),2)):(i=a.h,a.return(i.filter(function(e){return e})))})}(e,p,f),6);case 6:s=Z.h,Z.A(3);break;case 7:G=Z.h,e.i.set(e.H,G),G.stream&&(z=Gu(G.stream),G.stream.segmentIndex.Gb(function(e){e.ea&&(e.ea.xd=z)})),l=G.stream.type,X=!0,(e.g.disableAudio&&"audio"==G.type||e.g.disableVideo&&"video"==G.type&&!G.stream.codecs.includes(","))&&(X=!1),X&&a.push({id:0,language:jr(V||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==G.type?G.stream:null,video:"video"==G.type?G.stream:null,bandwidth:G.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new Ke(2,7,7001);if(cb(e,r),1==r.type&&(Eb(e)&&(pb(e,r),W=e.o,e.F.ka(W)),K=Array.from(e.i.values()),ib(e,K),Ky(e),vb(e,r.ha,l,d,u)),e.m={presentationTimeline:e.l,variants:a,textStreams:o,imageStreams:s,offlineSessionIds:[],sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:e.u},e.ba||!e.g.hls.disableCodecGuessing){Z.A(8);break}for(q=[],Y=g(e.m.variants),$=Y.next();!$.done;$=Y.next())(J=$.value).audio&&""===J.audio.codecs&&q.push(J.audio.createSegmentIndex()),J.video&&""===J.video.codecs&&q.push(J.video.createSegmentIndex());return x(Z,Promise.all(q),8);case 8:e.h.makeTextStreamsForClosedCaptions(e.m),T(Z)}})}(r,n.data),3)):i.return(r.m)})},i.stop=function(){this.F&&(this.F.stop(),this.F=null);var e=[];return this.$&&(e.push(this.$.destroy()),this.$=null),this.g=this.h=null,this.ob.clear(),this.m=null,this.i.clear(),this.M.clear(),this.K.clear(),this.B.clear(),this.Da.clear(),this.va.clear(),this.O.clear(),this.ya.clear(),this.za.clear(),this.I.clear(),this.j&&this.j.destroy(),this.V&&(this.V.release(),this.V=null),Promise.all(e)},i.update=function(){var e,t,n,r,i,a,o,s,u,l,d=this;return P(function(c){if(1==c.g){if(!Eb(d))return c.return();for(e=[],t=Array.from(d.i.values()),d.o=1/0,d.m.gapCount=0,n=t.filter(function(e){return!e.stream.isAudioMuxedInVideo&&e.stream.segmentIndex}),r=g(n),i=r.next();!i.done;i=r.next())a=i.value,e.push(Gy(d,a));return x(c,Promise.all(e),2)}for(rb(d,n.map(function(e){return e.stream})),o=n.some(function(e){return 0==e.ae}),n.length&&!o&&(kb(d,Bb),Ky(d)),o&&Ky(d),s=g(n),u=s.next();!u.done;u=s.next())(l=u.value).stream.isAudioMuxedInVideo||!l.stream.segmentIndex||Du(l.stream.segmentIndex)||d.h.disableStream(l.stream);T(c)})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.j&&this.j.banLocation(e)},i.setMediaElement=function(e){this.X=e},V("shaka.hls.HlsParser",Vy);var _b=(new Map).set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),Pb=(new Map).set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),Db=(new Map).set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),Lb=(new Map).set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),Nb=(new Map).set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),Ob=(new Map).set("audio",Pb).set("video",Db).set("text",Lb).set("image",Nb),Ub=new Set(["video/mp2t"].concat(m(xr))),Bb="VOD",jb="EVENT",Fb="LIVE";function Vb(e){return Qg(e)}Et("application/x-mpegurl",function(){return new Vy}),Et("application/vnd.apple.mpegurl",function(){return new Vy});var Hb=(new Map).set("com.microsoft.playready",Vb).set("com.microsoft.playready.recommendation",Vb).set("com.microsoft.playready.software",Vb).set("com.microsoft.playready.hardware",Vb);function Gb(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.u=1,this.i=null,this.F=new H(5),this.o=new Rr(function(){!function(e){var t;P(function(n){switch(n.g){case 1:return w(n,2),x(n,zb(e),4);case 4:A(n,3);break;case 2:t=E(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();T(n)}})}(e)}),this.C=new ji,this.m=new Map,this.B=function(){return!1}}function zb(e){var t,n,r,i,a,o,s;return P(function(u){if(1==u.g)return t=zi(e.l,e.g.retryParameters),n=e.h.networkingEngine,r=Date.now(),i=n.request(0,t,{type:5,isPreload:e.B()}),Fi(e.C,i),x(u,i.promise,2);if(a=u.h,!e.h)return u.return();a.uri&&!e.l.includes(a.uri)&&e.l.unshift(a.uri);var l=a.uri,d=a.data,c=e.g.mss.manifestPreprocessor;if(c!=ad){if(ce("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),!(d=wv(d,"SmoothStreamingMedia")))throw new Ke(2,4,4046,l);c(d),d=Qe(d.outerHTML)}var h=$t(d,"SmoothStreamingMedia");if(!h)throw new Ke(2,4,4046,l);if((l=e.g.mss.manifestPreprocessorTXml)!=od&&l(h),e.i||(e.i=new lu(null,0)),l=un(h,"IsLive",bn,!1))throw new Ke(2,4,4047);e.i.cd(!l),c=un(h,"TimeScale",vn,1e7),d=un(h,"DVRWindowLength",vn),l&&(0===d||isNaN(d))&&(d=1/0);var p,f=un(h,"CanSeek",bn,!1);for(0===d&&f&&(d=1/0),f=null,d&&d>0&&(f=d/c),l&&!isNaN(e.g.availabilityWindowOverride)&&(f=e.g.availabilityWindowOverride),null==f&&(f=1/0),e.i.Kf(f),d=un(h,"Duration",vn,1/0),l||e.i.Ab(d/c),l={variants:[],textStreams:[],timescale:c,duration:d/c},f=tn(h,"Protection"),c=e.g.mss.keySystemsBySystemId,d=[],p=(f=g(f)).next();!p.done;p=f.next())d=d.concat(tn(p.value,"ProtectionHeader"));if(d.length){for(f=[],p=0;p<d.length;p++){var v=d[p],y=v.attributes.SystemID.toLowerCase(),b=c[y];if(b){var w;e:{if(w=Jg(v))for(var S=(w=g(an(w,"DATA"))).next();!S.done;S=w.next())if(S=on(S.value,"KID")){w=ot(nn(S)),w=ut(w=new Uint8Array([w[3],w[2],w[1],w[0],w[5],w[4],w[7],w[6]].concat(m(w.slice(8)))));break e}w=null}y=ct(b,"cenc",y=[{initData:ya(S=ot(nn(v)),y=st(y.replace(/-/g,"")),new Set,0),initDataType:"cenc",keyId:w}]),w&&y.keyIds.add(w),(b=Hb.get(b))&&(y.licenseServerUri=b(v)),f.push(y)}}c=f}else c=[];for(p=c,f=[],c=[],d=[],v=(h=g(h=tn(h,"StreamIndex"))).next();!v.done;v=h.next()){b=tn(v=v.value,"QualityLevel"),y=l.timescale,w=l.duration,S=tn(v,"c");for(var A=[],E=0,k=0;k<S.length;++k){var I=S[k],C=S[k+1],M=un(I,"t",vn),R=un(I,"d",vn);if(I=un(I,"r",gn),!R)break;if(M=null!=M?M:E,(I=I||0)&&I--,I<0)if(C){if(null==(C=un(C,"t",vn)))break;if(M>=C)break;I=Math.ceil((C-M)/R)-1}else{if(w==1/0)break;if(M/y>=w)break;I=Math.ceil((w*y-M)/R)-1}for(C=0;C<=I;++C)E=M+R,A.push({start:M/y,end:E/y,Hh:M}),M=E}for(y=A,w=(b=g(b)).next();!w.done;w=b.next())(w=Xb(e,v,w.value,y,p,l))&&("audio"!=w.type||e.g.disableAudio?"video"!=w.type||e.g.disableVideo?w.type!=mt||e.g.disableText||d.push(w):c.push(w):f.push(w))}for(h=[],p=(f=g(f.length>0?f:[null])).next();!p.done;p=f.next())for(p=p.value,A=(v=g(c.length>0?c:[null])).next();!A.done;A=v.next())y=(b=h).push,w=e,S=p,A=A.value,k=0,S&&S.bandwidth&&S.bandwidth>0&&(k+=S.bandwidth),A&&A.bandwidth&&A.bandwidth>0&&(k+=A.bandwidth),w={id:w.u++,language:S?S.language:"und",disabledUntilTime:0,primary:!!S&&S.primary||!!A&&A.primary,audio:S,video:A,bandwidth:k,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},y.call(b,w);l.variants=h,l.textStreams=d,e.j?(e.j.variants=l.variants,e.j.textStreams=l.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:l.variants,textStreams:l.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},e.i.pf()),Promise.resolve(),o=Date.now(),s=(o-r)/1e3,e.F.sample(1,s),T(u)})}function Xb(e,t,n,r,i,a){var o=t.attributes.Type;if("audio"!==o&&"video"!==o&&"text"!==o)return K("Ignoring unrecognized type:",o),null;var s=t.attributes.Language,u=e.u++,l=un(n,"Bitrate",mn),d=un(n,"MaxWidth",mn),c=un(n,"MaxHeight",mn),h=un(n,"Channels",mn),p=un(n,"SamplingRate",mn),f=a.duration;r.length&&(f=r[r.length-1].end-r[0].start);var m=e.i.getDuration();e.i.Ab(Math.min(f,m)),(m=t.attributes.Name)&&(m+=n.attributes.Index),m||(m=String(u));var v={id:u,originalId:m,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:l||0,width:d||void 0,height:c||void 0,kind:"",encrypted:i.length>0,drmInfos:i,keyIds:new Set,language:jr(s||"und"),originalLanguage:s,label:"",type:"",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:h,audioSamplingRate:p,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:f,timescale:a.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};if((i=t.attributes.Subtype)&&((i=Kb.get(i))&&v.roles.push(i),"main"===i&&(v.primary=!0)),null!==(i=n.attributes.FourCC)&&""!==i||(i=t.attributes.FourCC),!i)if("audio"===o)i="AAC";else if("video"===o)return K('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!Wb.includes(i.toUpperCase()))return K("Codec not supported:",i),null;switch(n=function(e,t,n,r){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=r.channelsCount||2,e=r.audioSamplingRate||44100;var i={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return r=i[e],"AACH"===n?(n=new Uint8Array(4),e=i[2*e],n[0]=40|r>>1,n[1]=r<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,(t=new Uint16Array(2))[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):((n=new Uint8Array(2))[0]=16|r>>1,n[1]=r<<7|t<<3,(t=new Uint16Array(1))[0]=(n[0]<<8)+n[1],t[0].toString(16))}(n,o,i,v),v.mssPrivateData.codecPrivateData=n,o){case"audio":if(!n)return K("Quality unsupported without CodecPrivateData",o),null;v.type="audio",v.mimeType="mss/audio/mp4",v.codecs=function(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}(i,n);break;case"video":if(!n)return K("Quality unsupported without CodecPrivateData",o),null;v.type="video",v.mimeType="mss/video/mp4",v.codecs=function(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}(n);break;case"text":v.type=mt,v.mimeType="application/mp4",("TTML"===i||"DFXP"===i)&&(v.codecs="stpp")}return v.fullMimeTypes.add(dr(v.mimeType,v.codecs)),v.createSegmentIndex=function(){if(v.segmentIndex)return Promise.resolve();if(e.m.has(v.id))var n=e.m.get(v.id);else n=[],"video"==v.type&&(n=v.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n=ho(new co([n={id:v.id,type:v.type,codecs:v.codecs,encrypted:v.encrypted,timescale:v.mssPrivateData.timescale,duration:v.mssPrivateData.duration,Cb:n,Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:null,stream:v}])),e.m.set(v.id,n);return n=function(e,t,n,r,i){var a=r.attributes.Url.replace("{bitrate}",String(n.bandwidth));r=[];for(var o=(i=g(i)).next(),s={};!o.done;s={Of:void 0},o=i.next())s.Of=o.value,r.push(new Vo(s.Of.start,s.Of.end,function(t){return function(){return dt(e.l,[a.replace("{start time}",String(t.Of.Hh))])}}(s),0,null,t,0,0,n.mssPrivateData.duration));return r}(e,new jo(function(){return[]},0,null,Gu(v),v.mssPrivateData.timescale,n,null,v.encrypted),v,t,r),v.segmentIndex=new Pu(n),Promise.resolve()},v.closeSegmentIndex=function(){v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null)},v}(i=Gb.prototype).configure=function(e,t){this.g=e,t&&(this.B=t)},i.start=function(e,t){var n=this;return P(function(r){if(1==r.g)return n.l=[e],n.h=t,x(r,zb(n),2);if(!n.h)throw new Ke(2,7,7001);return r.return(n.j)})},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.C.destroy()},i.update=function(){var e,t=this;return P(function(n){return 1==n.g?(w(n,2),x(n,zb(t),4)):2!=n.g?A(n,0):(e=E(n),t.h&&e?(t.h.onError(e),void T(n)):n.return())})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},V("shaka.mss.MssParser",Gb);var Wb="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),Kb=(new Map).set("CAPT","main").set("SUBT","alternate").set("DESC","main");function qb(e,t,n,r,i,a,o){if(n>=200&&n<=299&&202!=n||304==n)return{uri:i||r,originalUri:r,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:a};a=null;try{a=Je(t)}catch(s){}throw new Ke(401==n||403==n?2:1,1,1001,r,n,a,e,o,i||r)}function Yb(){}function $b(e,t,n,r,i,a){var o=new tx;try{ta(t.headers).forEach(function(e,t){o.append(t,e)})}catch(d){return Ri(new Ke(1,1,1002,e,d,n))}var s=new Zb,u={Th:!1,gj:!1};if(e=function(e,t,n,r,i,a,o,s,u){var l,d,c,h,p,f,g,m,v,y,b,S,k,I;return P(function(C){switch(C.g){case 1:return l=Qb,d=ex,h=new ArrayBuffer(0),f=p=0,g={},m=Date.now(),w(C,2),x(C,l(e,r),4);case 4:if(c=C.h,g=function(e){var t={};return e.forEach(function(e,n){t[n.trim()]=e}),t}(c.headers),o(g),"HEAD"==r.method){C.A(5);break}return y=(v=c.headers.get("Content-Length"))?parseInt(v,10):0,c.body?(b=c.clone().body.getReader(),new d({start:function(e){function t(){var n,r,i,o;return P(function(l){switch(l.g){case 1:return w(l,2),x(l,b.read(),4);case 4:n=l.h,A(l,3);break;case 2:return E(l),l.return();case 3:if(n.done){l.A(5);break}if(p+=n.value.byteLength,!s){l.A(5);break}return x(l,s(n.value),5);case 5:r=Date.now(),i=p-f,(r-m>100&&i>=u||n.done)&&(o=n.done?0:y-p,a(r-m,i,o),f=p,m=r),n.done?e.close():(e.enqueue(n.value),t()),T(l)}})}t()}}),x(C,c.arrayBuffer(),8)):x(C,c.arrayBuffer(),9);case 8:h=C.h,C.A(5);break;case 9:h=C.h,S=Date.now(),a(S-m,h.byteLength,0);case 5:t.headers.Range&&2==(k=t.headers.Range.replace("bytes=","").split("-").filter(function(e){return e}).map(function(e){return parseInt(e,10)})).length&&h.byteLength!=k[1]-k[0]+1&&K("Payload length does not match range requested bytes",t,c),A(C,3);break;case 2:if(I=E(C),i.Th)throw new Ke(1,1,7001,e,n);if(i.gj)throw new Ke(1,1,1003,e,n);throw new Ke(1,1,1002,e,I,n);case 3:return C.return(qb(g,h,c.status,e,c.url,t,n))}})}(e,t,n,{body:t.body||void 0,headers:o,method:t.method,signal:s.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},u,r,i,t.streamDataCallback,a.minBytesForProgressEvents||0),e=new Mi(e,function(){return u.Th=!0,s.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var l=new Rr(function(){u.gj=!0,s.abort()});l.ka(t/1e3),e.finally(function(){l.stop()})}return e}function Jb(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(fA){return!1}return!!e.Response&&!!new Response("").body&&!(!e.fetch||"polyfill"in e.fetch||!e.AbortController)}Et("application/vnd.ms-sstr+xml",function(){return new Gb}),V("shaka.net.HttpFetchPlugin",Yb),Yb.isSupported=Jb,Yb.parse=$b;var Qb=e.fetch,Zb=e.AbortController,ex=e.ReadableStream,tx=e.Headers;function nx(){}function rx(e,t,n,r,i,a){var o=new ix,s=Date.now(),u=0;return new Mi(new Promise(function(l,d){o.open(t.method,e,!0),o.responseType="arraybuffer",o.timeout=t.retryParameters.timeout,o.withCredentials=t.allowCrossSiteCredentials;var c={};for(var h in o.onabort=function(){d(new Ke(1,1,7001,e,n))},o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.HEADERS_RECEIVED){for(var e=o.getAllResponseHeaders().trim().split("\r\n"),t={},n=(e=g(e)).next();!n.done;n=e.next())t[(n=n.value.split(": "))[0].toLowerCase()]=n.slice(1).join(": ");i(c=t)}},o.onload=function(i){var a=o.response;try{r(Date.now()-s,i.loaded-u,0);var h=qb(c,a,o.status,e,o.responseURL,t,n);l(h)}catch(p){d(p)}},o.onerror=function(t){d(new Ke(1,1,1002,e,t,n))},o.ontimeout=function(){d(new Ke(1,1,1003,e,n))},o.onprogress=function(e){var t=Date.now(),n=a.minBytesForProgressEvents||0,i=e.loaded-u;(t-s>100&&i>=n||e.lengthComputable&&e.loaded==e.total)&&(r(t-s,i,4==o.readyState?0:e.total-e.loaded),u=e.loaded,s=t)},t.headers)try{o.setRequestHeader(h.toLowerCase(),t.headers[h])}catch(p){throw new Ke(1,1,1002,e,p,n)}o.send(t.body)}),function(){return o.abort(),Promise.resolve()})}Jb()&&(Hi("http",$b,2,!0),Hi("https",$b,2,!0),Hi("blob",$b,2,!0)),V("shaka.net.HttpXHRPlugin",nx),nx.parse=rx;var ix=e.XMLHttpRequest;function ax(e,t,n,r,i){this.g=e,this.i=t,this.groupId=n,this.h=r,this.j=i}function ox(e){var t=e.ac(!1);return t?at(t):e.P().map(function(e){return"{"+encodeURI(e.split("#xywh=")[0])+"}"}).join("")+":"+e.startByte+":"+e.endByte}function sx(e,t){return ll(e.g.P(),e.g.startByte,e.g.endByte,t.streaming.retryParameters)}function ux(){this.g=this.j=this.i=0,this.h=new Map,this.l=0}function lx(e,t){e.i+=t;var n=e.l;return e.l++,e.h.set(n,t),n}function dx(e){return 0==e.i?0:e.j/e.i}function cx(e){var t=this;this.u=e,this.i=new Map,this.h=new Qi(function(){return hx(t).catch(function(){})}),this.j=[],this.o=function(){},this.m=function(){},this.g=new ux,this.l=!1}function hx(e){e.l=!0;var t=e.j.map(function(e){return e()});return e.j=[],Promise.all(t)}function px(e,t,n,r,i,a){Zi(e.h);var o=(e.i.get(t)||Promise.resolve()).then(function(){if(e.h.g)throw new Ke(2,9,7001);if(i){var t=Ne(n);for(var o in(t=new va(t)).data){var s=Number(o);e.m(t.data[s],t.g[s])}}return e.g.close(r,n.byteLength),e.o(dx(e.g),e.g.g),a(n)});e.i.set(t,o)}function fx(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new Ci,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function gx(e,t){return new Promise(function(n,r){var i=e.h.openCursor();i.onerror=r,i.onsuccess=function(){var e;return P(function(r){if(1==r.g)return null==i.result?(n(),r.return()):(e=i.result,x(r,t(e.key,e.value,e),2));e.continue(),T(r)})}})}function mx(e){this.h=e,this.g=[]}function vx(e,t){return yx(e,t,"readwrite")}function yx(e,t,n){var r=new fx(n=e.h.transaction([t],n),t);return e.g.push(r),r.promise().then(function(){Q(e.g,r)},function(){Q(e.g,r)}),r}function bx(e,t,n){this.h=new mx(e),this.i=t,this.g=n}function xx(e){return Promise.reject(new Ke(2,9,9011,"Cannot add new value to "+e))}function Tx(e,t,n,r){t=(e=vx(e.h,t)).store();for(var i=(n=g(n)).next(),a={};!i.done;a={Sg:void 0},i=n.next())a.Sg=i.value,t.delete(a.Sg).onsuccess=function(e){return function(){return r(e.Sg)}}(a);return e.promise()}function wx(e,t,n){var r,i,a,o,s,u,l;return P(function(d){if(1==d.g){for(r=yx(e.h,t,"readonly"),i=r.store(),a={},o=[],s=g(n),u=s.next(),l={};!u.done;l={Df:void 0,kf:void 0},u=s.next())l.kf=u.value,l.Df=i.get(l.kf),l.Df.onsuccess=function(e){return function(){null==e.Df.result&&o.push(e.kf),a[e.kf]=e.Df.result}}(l);return x(d,r.promise(),2)}if(o.length)throw new Ke(2,9,9012,"Could not find values for "+o);return d.return(n.map(function(e){return a[e]}))})}function Sx(e){this.g=new mx(e)}function Ax(){this.g=new Map}function Ex(e){var t=null;if(e.g.forEach(function(e,n){e.getCells().forEach(function(e,r){e.hasFixedKeySpace()||t||(t={path:{Qb:n,bb:r},bb:e})})}),t)return t;throw new Ke(2,9,9013,"Could not find a cell that supports add-operations")}function kx(e,t,n){if(!(e=e.g.get(t)))throw new Ke(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new Ke(2,9,9013,"Could not find cell with name "+n);return t}function Ix(e,t){Cx.set(e,t)}Hi("http",rx,1,!0),Hi("https",rx,1,!0),Hi("blob",rx,1,!0),ux.prototype.close=function(e,t){if(this.h.has(e)){var n=this.h.get(e);this.h.delete(e),this.j+=n,this.g+=t}},cx.prototype.destroy=function(){return this.h.destroy()},cx.prototype.queue=function(e,t,n,r,i){var a=this;Zi(this.h);var o=(this.i.get(e)||Promise.resolve()).then(function(){var e,o,s,u,l,d,c;return P(function(h){if(1==h.g)return x(h,function(e,t){var n,r,i,a;return P(function(o){return 1==o.g?(n=Yi,r=e.u.request(n,t),i=function(){return r.abort()},e.j.push(i),x(o,r.promise,2)):(a=o.h,Q(e.j,i),o.return(a.data))})}(a,t),2);if(e=h.h,a.h.g)throw new Ke(2,9,7001);if(r)for(u in o=Ne(e),(s=new va(o)).data)l=Number(u),d=s.data[l],c=s.g[l],a.m(d,c);return a.g.close(n,e.byteLength),a.o(dx(a.g),a.g.g),h.return(i(e))})});return this.i.set(e,o),o},fx.prototype.abort=function(){var e=this;return P(function(t){if(1==t.g){try{e.i.abort()}catch(n){}return w(t,2),x(t,e.g,4)}if(2!=t.g)return A(t,0);E(t),T(t)})},fx.prototype.store=function(){return this.h},fx.prototype.promise=function(){return this.g},mx.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))},(i=bx.prototype).destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return xx(this.i)},i.removeSegments=function(e,t){return Tx(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return P(function(r){return 1==r.g?x(r,wx(n,n.i,e),2):(t=r.h,r.return(t.map(function(e){return n.Vh(e)})))})},i.addManifests=function(){return xx(this.g)},i.updateManifest=function(){return Promise.reject(new Ke(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=vx(this.h,this.g),r=n.store();return r.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,r.put(n,e))},n.promise()},i.removeManifests=function(e,t){return Tx(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return P(function(r){return 1==r.g?x(r,wx(n,n.g,e),2):(t=r.h,r.return(Promise.all(t.map(function(e){return n.Td(e)}))))})},i.getAllManifests=function(){var e,t,n=this;return P(function(r){return 1==r.g?(e=yx(n.h,n.g,"readonly"),t=new Map,x(r,gx(e,function(e,r){var i;return P(function(a){if(1==a.g)return x(a,n.Td(r),2);i=a.h,t.set(e,i),T(a)})}),2)):3!=r.g?x(r,e.promise(),3):r.return(t)})},i.Vh=function(e){return e},i.Td=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,r,i,a,o,s,u,l=this;return P(function(d){if(1==d.g){for(n=vx(l.h,e),r=n.store(),i=[],a=g(t),o=a.next(),s={};!o.done;s={gh:void 0},o=a.next())u=o.value,s.gh=r.add(u),s.gh.onsuccess=function(e){return function(){i.push(e.gh.result)}}(s);return x(d,n.promise(),2)}return d.return(i)})},Sx.prototype.destroy=function(){return this.g.destroy()},Sx.prototype.getAll=function(){var e,t,n=this;return P(function(r){return 1==r.g?(e=yx(n.g,"session-ids","readonly"),t=[],x(r,gx(e,function(e,n){t.push(n)}),2)):3!=r.g?x(r,e.promise(),3):r.return(t)})},Sx.prototype.add=function(e){for(var t=vx(this.g,"session-ids"),n=t.store(),r=(e=g(e)).next();!r.done;r=e.next())n.add(r.value);return t.promise()},Sx.prototype.remove=function(e){var t,n=this;return P(function(r){return 1==r.g?x(r,gx(t=vx(n.g,"session-ids"),function(t,n,r){e.includes(n.sessionId)&&r.delete()}),2):x(r,t.promise(),0)})},Ax.prototype.destroy=function(){for(var e=[],t=g(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Ax.prototype.init=function(){var e=this;Cx.forEach(function(t,n){(t=t())&&e.g.set(n,t)});for(var t=[],n=g(this.g.values()),r=n.next();!r.done;r=n.next())t.push(r.value.init());return Promise.all(t)},V("shaka.offline.StorageMuxer",Ax),Ax.unregister=function(e){Cx.delete(e)},Ax.register=Ix,Ax.prototype.destroy=Ax.prototype.destroy;var Cx=new Map;function Mx(){bx.apply(this,arguments)}function Rx(e,t){!function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType});if(e=e.streams.filter(function(e){return"video"==e.contentType}),!t.every(function(e){return e.variantIds})||!e.every(function(e){return e.variantIds})){for(var n=g(t),r=n.next();!r.done;r=n.next())r.value.variantIds=[];for(r=(n=g(e)).next();!r.done;r=n.next())r.value.variantIds=[];if(n=0,e.length&&!t.length){r=n++;for(var i=g(e),a=i.next();!a.done;a=i.next())a.value.variantIds.push(r)}if(!e.length&&t.length)for(r=n++,a=(i=g(t)).next();!a.done;a=i.next())a.value.variantIds.push(r);if(e.length&&t.length)for(r=(t=g(t)).next();!r.done;r=t.next())for(r=r.value,a=(i=g(e)).next();!a.done;a=i.next()){a=a.value;var o=n++;r.variantIds.push(o),a.variantIds.push(o)}}}(e);for(var n=g(e.streams),r=n.next();!r.done;r=n.next());return e.streams.map(function(n){return function(e,t,n){var r=e.initSegmentUri?_x(e.initSegmentUri):null,i=t+e.presentationTimeOffset,a=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:r,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(e){var n=_x(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:r,appendWindowStart:t,appendWindowEnd:a,timestampOffset:i,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}(n,e.startTime,t)})}function _x(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Ke(2,9,9004,"Could not parse uri "+e)}function Px(){bx.apply(this,arguments)}function Dx(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(r){return{startTime:t+r.startTime,endTime:t+r.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:r.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function Lx(){bx.apply(this,arguments)}function Nx(){this.m=this.j=this.i=this.h=this.g=this.l=null}p(Mx,bx),Mx.prototype.updateManifestExpiration=function(e,t){var n,r,i,a=this;return P(function(o){return n=vx(a.h,a.g),r=n.store(),i=new Ci,r.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,r.put(n),i.resolve()):i.reject(new Ke(2,9,9012,"Could not find values for "+e))},x(o,Promise.all([n.promise(),i]),0)})},Mx.prototype.Td=function(e){var t,n,r,i,a,o;return P(function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n)r=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=r-e.periods[n].startTime,a=Rx(e.periods[n],i),t.push(a);return x(s,Vm(t),2)}return o=s.h,s.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})},Mx.prototype.Vh=function(e){return{data:e.data}},p(Px,bx),Px.prototype.Td=function(e){var t,n,r,i,a,o;return P(function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n){r=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=r-e.periods[n].startTime;for(var u=e.periods[n],l=[],d=g(u.streams),c=d.next();!c.done;c=d.next())0!=(c=c.value).variantIds.length&&l.push(Dx(c,u.startTime,u.startTime+i));a=l,t.push(a)}return x(s,Vm(t),2)}return o=s.h,s.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})})},p(Lx,bx),(i=Lx.prototype).hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return function(e,t,n){var r=(e=vx(e.h,e.g)).store();return r.get(t).onsuccess=function(){r.put(n,t)},e.promise()}(this,e,t)},i.Td=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},(i=Nx.prototype).init=function(){var t=this,n=new Ci,r=!1,i=new Rr(function(){r=!0,n.reject(new Ke(2,9,9017))});"number"==typeof Ox&&Ox>0&&i.ka(Ox);var a=e.indexedDB.open("shaka_offline_db",5);return a.onsuccess=function(){if(!r){i.stop();var e=a.result;t.l=e;var o=e.objectStoreNames;o=o.contains("manifest")&&o.contains("segment")?new Mx(e,"segment","manifest"):null,t.g=o,o=(o=e.objectStoreNames).contains("manifest-v2")&&o.contains("segment-v2")?new Px(e,"segment-v2","manifest-v2"):null,t.h=o,o=(o=e.objectStoreNames).contains("manifest-v3")&&o.contains("segment-v3")?new Px(e,"segment-v3","manifest-v3"):null,t.i=o,o=(o=e.objectStoreNames).contains("manifest-v5")&&o.contains("segment-v5")?new Lx(e,"segment-v5","manifest-v5"):null,t.j=o,e=e.objectStoreNames.contains("session-ids")?new Sx(e):null,t.m=e,n.resolve()}},a.onupgradeneeded=function(){for(var e=a.result,t=g(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},a.onerror=function(e){r||(i.stop(),n.reject(new Ke(2,9,9001,a.error)),e.preventDefault())},n},i.destroy=function(){var e=this;return P(function(t){switch(t.g){case 1:if(!e.g){t.A(2);break}return x(t,e.g.destroy(),2);case 2:if(!e.h){t.A(4);break}return x(t,e.h.destroy(),4);case 4:if(!e.i){t.A(6);break}return x(t,e.i.destroy(),6);case 6:if(!e.j){t.A(8);break}return x(t,e.j.destroy(),8);case 8:if(!e.m){t.A(10);break}return x(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),T(t)}})},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var t=this;return P(function(n){switch(n.g){case 1:if(!t.g){n.A(2);break}return x(n,t.g.destroy(),2);case 2:if(!t.h){n.A(4);break}return x(n,t.h.destroy(),4);case 4:if(!t.i){n.A(6);break}return x(n,t.i.destroy(),6);case 6:if(!t.j){n.A(8);break}return x(n,t.j.destroy(),8);case 8:return t.l&&t.l.close(),x(n,function(){var t=new Ci,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new Ke(2,9,9001,n.error)),e.preventDefault()},t}(),10);case 10:return t.l=null,t.g=null,t.h=null,t.i=null,t.j=null,x(n,t.init(),0)}})};var Ox=5;function Ux(e,t,n,r){this.g=e,this.i=t,this.h=n,this.l=r,this.j=["offline:",e,"/",t,"/",n,"/",r].join("")}function Bx(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var r=e[3];return r&&null!=t?new Ux(t,n,r,Number(e[4])):null}function jx(e,t){this.h=e,this.g=t}function Fx(e,t){var n=new lu(null,0);n.Ab(t.duration);var r=t.streams.filter(function(e){return"audio"==e.type}),i=t.streams.filter(function(e){return"video"==e.type});r=function(e,t,n,r){for(var i=new Set,a=g(t),o=a.next();!o.done;o=a.next())for(var s=(o=g(o.value.variantIds)).next();!s.done;s=o.next())i.add(s.value);for(a=g(n),o=a.next();!o.done;o=a.next())for(o=g(o.value.variantIds),s=o.next();!s.done;s=o.next())i.add(s.value);for(a=new Map,i=g(i),o=i.next();!o.done;o=i.next())o=o.value,a.set(o,{id:o,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=g(t),i=t.next();!i.done;i=t.next())for(o=i.value,i=Vx(e,o,r),o=g(o.variantIds),s=o.next();!s.done;s=o.next())(s=a.get(s.value)).language=i.language,s.primary=s.primary||i.primary,s.audio=i;for(n=g(n),t=n.next();!t.done;t=n.next())for(i=t.value,t=Vx(e,i,r),i=g(i.variantIds),o=i.next();!o.done;o=i.next())(o=a.get(o.value)).primary=o.primary||t.primary,o.video=t;return a}(e,r,i,n),i=t.streams.filter(function(e){return e.type==mt}).map(function(t){return Vx(e,t,n)});var a=t.streams.filter(function(e){return"image"==e.type}).map(function(t){return Vx(e,t,n)}),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var s=g(r.values()),u=s.next();!u.done;u=s.next())(u=u.value).audio&&u.audio.encrypted&&(u.audio.drmInfos=o),u.video&&u.video.encrypted&&(u.video.drmInfos=o);return{presentationTimeline:n,offlineSessionIds:t.sessionIds,variants:Array.from(r.values()),textStreams:i,imageStreams:a,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}}function Vx(e,t,n){var r=t.segments.map(function(n){return function(e,t,n){var r=new Ux("segment",e.h,e.g,t.dataKey);return e=new Vo(t.startTime,t.endTime,function(){return[r.toString()]},0,null,null!=t.initSegmentKey?function(e,t){var n=new Ux("segment",e.h,e.g,t);return new jo(function(){return[n.toString()]},0,null)}(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",t.thumbnailSprite&&e.Lf(t.thumbnailSprite),e}(e,n,t)});return n.le(r),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Pu(r),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,mssPrivateData:t.mssPrivateData,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([dr(t.mimeType,t.codecs)]),isAudioMuxedInVideo:t.isAudioMuxedInVideo||!1,baseOriginalId:null}}function Hx(){this.g=null}function Gx(){}function zx(e,t){var n=Bx(e);return e=n&&"manifest"==n.g?Pi(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t}):n&&"segment"==n.g?function(e,t,n){var r=new Ax;return Pi(void 0).Xa(function(){return r.init()}).Xa(function(){return kx(r,t.Qb(),t.bb())}).Xa(function(e){return e.getSegments([t.key()])}).Xa(function(e){return{uri:t,data:e[0].data,headers:{},originalRequest:n}}).finally(function(){return r.destroy()})}(n.key(),n,t):Ri(new Ke(2,1,9004,e)),e}function Xx(e,t,n){var r,i,a,o,s,u;return P(function(l){switch(l.g){case 1:r=[];for(var d=[],c=g(n),h=c.next();!h.done;h=c.next()){h=h.value;for(var p=!1,f=g(d),m=f.next();!m.done;m=f.next())if(Wx((m=m.value).info,h)){m.sessionIds.push(h.sessionId),p=!0;break}p||d.push({info:h,sessionIds:[h.sessionId]})}i=g(d),a=i.next();case 2:if(a.done){l.A(4);break}return o=a.value,s=function(e,t,n){var r,i;return P(function(a){switch(a.g){case 1:return r=new ba({vc:t,onError:function(){},yf:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),w(a,2),r.configure(e),x(a,function(e,t,n,r,i,a){var o,s,u,l,d;return P(function(c){return 1==c.g?(o=[],a.length&&o.push(a[0].contentType),i.length&&o.push(i[0].contentType),s=function(e){return(e=ct(t,e,null)).licenseServerUri=n,e.serverCertificate=r,e.persistentStateRequired=!0,e.sessionType="persistent-license",e},(u=mi(o)).video&&(l=s(a[0].encryptionScheme||""),u.video.drmInfos.push(l)),u.audio&&(d=s(i[0].encryptionScheme||""),u.audio.drmInfos.push(d)),x(c,Qr([u],!0,e.O,[]),2)):(Zi(e.j),c.return(ka(e,[u])))})}(r,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:A(a,3);break;case 2:return E(a),x(a,r.destroy(),5);case 5:return a.return([]);case 3:return i=[],x(a,Promise.all(n.sessionIds.map(function(e){return P(function(t){return 1==t.g?(w(t,2),x(t,function(e,t){var n,r,i;return P(function(a){return 1==a.g?x(a,Ma(e,t,{initData:null,initDataType:null}),2):3!=a.g?(n=a.h)?(r=[],(i=e.i.get(n))&&(i.Lb=new Ci,r.push(i.Lb)),r.push(n.remove()),x(a,Promise.all(r),3)):a.return():(e.i.delete(n),void T(a))})}(r,e),4)):2!=t.g?(i.push(e),A(t,0)):(E(t),void T(t))})})),6);case 6:return x(a,r.destroy(),7);case 7:return a.return(i)}})}(e,t,o),x(l,s,5);case 5:u=l.h,r=r.concat(u),a=i.next(),l.A(2);break;case 4:return l.return(r)}})}function Wx(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Z(e.audioCapabilities,t.audioCapabilities,n)&&Z(e.videoCapabilities,t.videoCapabilities,n)}function Kx(e,t){var n=Fx(new jx(e.Qb(),e.bb()),t),r=t.appMetadata||{};return n=qx(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:r,isIncomplete:t.isIncomplete||!1}}function qx(e){for(var t=[],n=li(e.variants),r=(n=g(n)).next();!r.done;r=n.next())t.push(ni(r.value));for(n=(e=g(e.textStreams)).next();!n.done;n=e.next())t.push(ri(n.value));return t}function Yx(){this.g=new Map}function $x(e,t){var n=t.audio,r=t.video;if(n&&!r&&e.g.set(n.id,n.bandwidth||t.bandwidth),!n&&r&&e.g.set(r.id,r.bandwidth||t.bandwidth),n&&r){var i=n.bandwidth||393216,a=r.bandwidth||t.bandwidth-i;a<=0&&(a=t.bandwidth),e.g.set(n.id,i),e.g.set(r.id,a)}}function Jx(e,t){e.g.set(t.id,t.bandwidth||2048)}function Qx(e,t){return null==(e=e.g.get(t))&&(e=0),e}function Zx(e){var t=this;if(e&&e.constructor!=Qc)throw new Ke(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.Zb()):(this.h=nd(),this.g=new Vi,this.g.configure(this.h.networking)),this.i=[],this.l=[];var n=!e;this.j=new Qi(function(){var e,r,i,a,o;return P(function(s){switch(s.g){case 1:return x(s,Promise.all(t.l.map(function(e){return hx(e)})),2);case 2:for(e=function(){},r=[],i=g(t.i),a=i.next();!a.done;a=i.next())o=a.value,r.push(o.then(e,e));return x(s,Promise.all(r),3);case 3:if(!n){s.A(4);break}return x(s,t.g.destroy(),4);case 4:t.h=null,t.g=null,T(s)}})}),this.m=1e9}function eT(){if(Jv(oe()))e:{for(var e=g(Cx.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function tT(e){var t,n,r;return P(function(i){switch(i.g){case 1:return x(i,(t=new Ax).init(),2);case 2:return x(i,Ex(t),3);case 3:return n=i.h,r=new Ux("manifest",n.path.Qb,n.path.bb,e),x(i,t.destroy(),4);case 4:return x(i,(new Zx).remove(r.toString()),0)}})}function nT(e,t,n,r,i,a){var o,s,u,l,d,c,h,p,f,m,v;return P(function(y){switch(y.g){case 1:for(o=!1,w(y,2),s=!0,u=g(n.streams),l=u.next();!l.done;l=u.next())for(d=l.value,c=g(d.segments),h=c.next();!h.done;h=c.next())p=h.value,null!=(f=p.pendingSegmentRefId?r[p.pendingSegmentRefId]:null)&&(p.dataKey=f,p.pendingSegmentRefId=void 0),null!=(f=p.pendingInitSegmentRefId?r[p.pendingInitSegmentRefId]:null)&&(p.initSegmentKey=f,p.pendingInitSegmentRefId=void 0),p.pendingSegmentRefId&&(s=!1),p.pendingInitSegmentRefId&&(s=!1);return n.size+=i,s&&(n.isIncomplete=!1),x(y,e.updateManifest(t,n),4);case 4:o=!0,a(),A(y,0);break;case 2:return m=E(y),x(y,tT(t),5);case 5:if(o){y.A(6);break}return v=Object.values(r),x(y,e.removeSegments(v,function(){}),6);case 6:throw m}})}function rT(e){return e.variants.some(function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t})}function iT(e){return e.variants.some(function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some(function(e){return e.initData&&e.initData.length})})}function aT(e,t,n,r){if(t.expiration=n.Yd(),n=Ea(n),t.sessionIds=r?n:[],rT(e)&&r&&!n.length)throw new Ke(2,9,9007)}function oT(e,t){for(var n=[],r=g(e.streams),i=r.next();!i.done;i=r.next())i=i.value,t&&"video"==i.type?n.push({contentType:dr(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=i.type||n.push({contentType:dr(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return n}function sT(e,t,n){return P(function(r){return x(r,function(e,t,n,r){var i,a,o;return P(function(s){return 1==s.g?r.drmInfo?(i=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new Ke(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(n),a=r.sessionIds.map(function(e){return{sessionId:e,keySystem:r.drmInfo.keySystem,licenseUri:r.drmInfo.licenseServerUri,serverCertificate:r.drmInfo.serverCertificate,audioCapabilities:oT(r,!1),videoCapabilities:oT(r,!0)}}),x(s,Xx(t,e,a),2)):s.return():3!=s.g?(o=s.h,x(s,i.remove(o),3)):x(s,i.add(a.filter(function(e){return!o.includes(e.sessionId)})),0)})}(e.g,e.h.drm,n,t),0)})}function uT(e,t,n){function r(){}var i=function(e){for(var t=new Set,n=(e=g(e.streams)).next();!n.done;n=e.next())for(var r=(n=g(n.value.segments)).next();!r.done;r=n.next())null!=(r=r.value).initSegmentKey&&t.add(r.initSegmentKey),t.add(r.dataKey);return Array.from(t)}(n);return Kx(t,n),Promise.all([e.removeSegments(i,r),e.removeManifests([t.key()],r)])}function lT(e,t){var n;return P(function(r){switch(r.g){case 1:return w(r,2),x(r,sl(t,e.g,e.h.streaming.retryParameters),4);case 4:n=r.h,A(r,3);break;case 2:E(r);case 3:if(n)return r.return(n);throw new Ke(1,2,2011,t)}})}function dT(e,t,n,r,i,a){var o={id:r.id,originalId:r.originalId,groupId:r.groupId,primary:r.primary,type:r.type,mimeType:r.mimeType,codecs:r.codecs,frameRate:r.frameRate,pixelAspectRatio:r.pixelAspectRatio,hdr:r.hdr,colorGamut:r.colorGamut,videoLayout:r.videoLayout,kind:r.kind,language:r.language,originalLanguage:r.originalLanguage,label:r.label,width:r.width||null,height:r.height||null,encrypted:r.encrypted,keyIds:r.keyIds,segments:[],variantIds:[],roles:r.roles,forced:r.forced,channelsCount:r.channelsCount,audioSamplingRate:r.audioSamplingRate,spatialAudio:r.spatialAudio,closedCaptions:r.closedCaptions,tilesLayout:r.tilesLayout,mssPrivateData:r.mssPrivateData,external:r.external,fastSwitching:r.fastSwitching,isAudioMuxedInVideo:r.isAudioMuxedInVideo},s=i.offline.numberOfParallelDownloads,u=0===s?r.id:0;return function(e,t,n){if(null!=(t=e.segmentIndex.find(t)))for(var r=e.segmentIndex.get(t);r;)n(r,t),r=e.segmentIndex.get(++t)}(r,n.presentationTimeline.Ib(),function(n,i){var l=ox(n),d=void 0;if(!a.has(l)){var c=n.endTime-n.startTime;c=Qx(t,r.id)*c,c=lx(e.g,c),a.set(l,new ax(n,c,u,!1,i))}n.ea&&(d=ox(n.ea),a.has(d)||(c=.5*Qx(t,r.id),c=lx(e.g,c),a.set(d,new ax(n.ea,c,u,!0,i)))),o.segments.push({pendingInitSegmentRefId:d,initSegmentKey:d?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:l,dataKey:0,mimeType:n.mimeType,codecs:n.codecs,thumbnailSprite:n.thumbnailSprite}),0!==s&&(u=(u+1)%s)}),o}function cT(e){if(e.j.g)throw new Ke(2,9,7001)}function hT(){if(!eT())throw new Ke(2,9,9e3)}function pT(e,t){return P(function(n){return 1==n.g?(e.i.push(t),S(n,2),x(n,t,4)):2!=n.g?n.return(n.h):(k(n),Q(e.i,t),I(n,0))})}function fT(e){for(var t=new Set,n=g(e.variants),r=n.next();!r.done;r=n.next())(r=r.value).audio&&t.add(r.audio),r.video&&t.add(r.video);for(r=(n=g(e.textStreams)).next();!r.done;r=n.next())t.add(r.value);for(n=(e=g(e.imageStreams)).next();!n.done;n=e.next())t.add(n.value);return t}V("shaka.offline.indexeddb.StorageMechanismOpenTimeout",Ox),Ix("idb",function(){return oe().Bh()?new Nx:null}),Ux.prototype.Qb=function(){return this.i},Ux.prototype.bb=function(){return this.h},Ux.prototype.key=function(){return this.l},Ux.prototype.toString=function(){return this.j},(i=Hx.prototype).configure=function(){},i.start=function(e,t){var n,r,i,a,o,s,u=this;return P(function(l){switch(l.g){case 1:if(n=Bx(e),u.g=n,null==n||"manifest"!=n.g)throw new Ke(2,1,9004,e);return r=new Ax,S(l,2),x(l,r.init(),4);case 4:return x(l,kx(r,n.Qb(),n.bb()),5);case 5:return x(l,l.h.getManifests([n.key()]),6);case 6:return i=l.h,a=i[0],o=new jx(n.Qb(),n.bb()),s=Fx(o,a),t.makeTextStreamsForClosedCaptions(s),l.return(s);case 2:return k(l),x(l,r.destroy(),7);case 7:I(l,0)}})},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,r,i,a,o,s,u,l=this;return P(function(d){switch(d.g){case 1:return n=l.g,r=new Ax,w(d,2,3),x(d,r.init(),5);case 5:return x(d,kx(r,n.Qb(),n.bb()),6);case 6:return x(d,(i=d.h).getManifests([n.key()]),7);case 7:if(a=d.h,o=a[0],s=o.sessionIds.includes(e),u=null==o.expiration||o.expiration>t,!s||!u){d.A(3);break}return x(d,i.updateManifestExpiration(n.key(),t),3);case 3:return k(d),x(d,r.destroy(),10);case 10:I(d,0);break;case 2:E(d),d.A(3)}})},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},Et("application/x-offline-manifest",function(){return new Hx}),V("shaka.offline.OfflineScheme",Gx),Gx.plugin=zx,Hi("offline",zx),(i=Zx.prototype).destroy=function(){return this.j.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=Hl(e,t)),id(this.h,e)},i.getConfiguration=function(){var e=nd();return id(e,this.h,nd()),e},i.Zb=function(){return this.g},i.store=function(e,t,n,r,i){var a=this,o=this.getConfiguration(),s=new cx(this.g);return this.l.push(s),t=function(e,t,n,r,i,a,o,s){var u,l,d,c,h,p,f,m,v,y,b,S,C,M,R,_,D,L,N,O,U,B,j;return P(function(F){switch(F.g){case 1:return hT(),l=u=null,d=new Ax,p=h=c=null,w(F,2,3),x(F,a(),5);case 5:return u=F.h,x(F,function(e,t,n,r){var i,a,o,s,u;return P(function(l){if(1==l.g)return i=null,a=e.g,o={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return r.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){},addFont:function(){}},n.configure(r.manifest),cT(e),x(l,n.start(t,o),2);if(3!=l.g)return s=l.h,cT(e),u=fT(s),x(l,Promise.all(ea(u,function(e){return e.createSegmentIndex()})),3);if(cT(e),i)throw i;return l.return(s)})}(e,t,u,o),6);case 6:if(f=F.h,cT(e),f.presentationTimeline.W()||f.presentationTimeline.Vc())throw new Ke(2,9,9005,t);m=g(r),v=m.next();case 7:if(v.done){F.A(9);break}return y=v.value,x(F,function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f,m,v,y;return P(function(b){switch(b.g){case 1:return x(b,lT(e,t),2);case 2:if("text/vtt"!=(r=b.h))throw new Ke(1,2,2017,t);return x(b,function(e,t,n){var r,i,a;return P(function(o){return 1==o.g?(r=Yi,(i=zi([e],n)).method="GET",x(o,t.request(r,i).promise,2)):(a=o.h,o.return(a.data))})}(t,e.g,e.h.streaming.retryParameters),3);case 3:if(i=b.h,!(a=Sr(r)))throw new Ke(2,2,2014,r);for(o=a(),s={periodStart:0,segmentStart:0,segmentEnd:n.presentationTimeline.getDuration(),vttOffset:0},u=Ne(i),l=o.parseMedia(u,s,t,[]),d=[],c=g(l),h=c.next(),p={};!h.done;p={Uf:void 0,od:void 0},h=c.next())p.od=h.value,p.Uf=null,f=function(e){return function(){return null==e.Uf&&(e.Uf=dt([t],[e.od.payload])),e.Uf||[]}}(p),m=new Vo(p.od.startTime,p.od.endTime,f,0,null,null,0,0,1/0),p.od.payload.includes("#xywh")&&4===(v=p.od.payload.split("#xywh=")[1].split(",")).length&&m.Lf({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)}),d.push(m);if(y=r,!d.length){b.A(4);break}return x(b,sl(d[0].P()[0],e.g,e.h.manifest.retryParameters),5);case 5:y=b.h;case 4:return b.return({id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Pu(d),mimeType:y||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"image",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([dr(y||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null})}})}(e,y,f),10);case 10:b=F.h,f.imageStreams.push(b),cT(e),v=m.next(),F.A(7);break;case 9:S=g(i),C=S.next();case 11:return C.done?(Ba(o.drm.clearKeys,f.variants),_=f.variants.some(function(e){if(e.audio)for(var t=g(e.audio.drmInfos),n=t.next();!n.done;n=t.next())if(n.value.licenseServerUri.startsWith("data:"))return!0;if(e.video)for(t=(e=g(e.video.drmInfos)).next();!t.done;t=e.next())if(t.value.licenseServerUri.startsWith("data:"))return!0;return!1}),D=o.offline.usePersistentLicense,_&&(D=!1),x(F,e.md(f,function(e){p=p||e},o,D),15)):(M=C.value,x(F,function(e,t,n,r,i,a,o){var s;return P(function(u){if(1==u.g)return a?u.A(2):x(u,lT(e,n),3);if(2!=u.g&&(a=u.h),s={id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Lu(0,t.presentationTimeline.getDuration(),[n]),mimeType:a||"",codecs:o||"",kind:i,encrypted:!1,drmInfos:[],keyIds:new Set,language:r,originalLanguage:r,label:null,type:mt,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([dr(a||"",o||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},!Ar(dr(s.mimeType,s.codecs)))throw new Ke(2,2,2014,a);return u.return(s)})}(e,f,M.uri,M.language,M.kind,M.mime,M.codecs),14));case 14:R=F.h,f.textStreams.push(R),cT(e),C=S.next(),F.A(11);break;case 15:if(l=F.h,cT(e),p)throw p;return x(F,function(e,t,n,r){var i,a,o,s,u,l,d,c,h,p,f,m,v,y,b,S,k,I,C,M,R,_,D,L,N,O,U,B,j;return P(function(P){switch(P.g){case 1:return i={width:1/0,height:1/0},function(e,t,n){e.variants=e.variants.filter(function(e){return Kr(e,t,n)})}(e,n.restrictions,i),x(P,Yr(t,e,r,n.drm.preferredKeySystems,n.drm.keySystemsMapping),2);case 2:for(a=[],o=n.preferredDecodingAttributes,s=n.preferredVideoCodecs,u=n.preferredAudioCodecs,l=n.preferredTextFormats,Wr(e,s,u,o,l),d=g(e.variants),c=d.next();!c.done;c=d.next())h=c.value,a.push(ni(h));for(p=g(e.textStreams),f=p.next();!f.done;f=p.next())m=f.value,a.push(ri(m));for(v=g(e.imageStreams),y=v.next();!y.done;y=v.next())b=y.value,a.push(ii(b));return x(P,n.offline.trackSelectionCallback(a),3);case 3:for(S=P.h,k=e.presentationTimeline.getDuration(),I=0,C=g(S),M=C.next();!M.done;M=C.next())R=M.value,_=R.bandwidth*k/8,I+=_;return w(P,4),x(P,n.offline.downloadSizeCallback(I),6);case 6:if(!P.h)throw new Ke(2,9,9014);A(P,5);break;case 4:if((D=E(P))instanceof Ke)throw D;throw new Ke(2,9,9015);case 5:for(L=new Set,N=new Set,O=new Set,U=g(S),B=U.next();!B.done;B=U.next())"variant"==(j=B.value).type&&L.add(j.id),"text"==j.type&&N.add(j.id),"image"==j.type&&O.add(j.id);e.variants=e.variants.filter(function(e){return L.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return N.has(e.id)}),e.imageStreams=e.imageStreams.filter(function(e){return O.has(e.id)}),function(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var n=g(t),r=n.next();!r.done;r=n.next())for(var i=(r=g(t)).next();!i.done;i=r.next());for(t=g(e),n=t.next();!n.done;n=t.next())for(n=g(e),r=n.next();!r.done;r=n.next());}(e),T(P)}})}(f,l,o,D),16);case 16:return x(F,d.init(),17);case 17:return cT(e),x(F,Ex(d),18);case 18:return c=F.h,cT(e),L=function(e,t,n,r,i,a,o){var s=function(e,t,n){return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:t=qx(t),appMetadata:n,isIncomplete:!1}}(n,t,r),u=i.offline.progressCallback;!function(e,t,n){e.o=t,e.m=n}(a,function(e,t){s.size=t,u(s,e)},function(t,n){l&&o&&d==n&&Aa(e,"cenc",t)});var l=rT(t)&&!iT(t),d=null;l&&(d=gT.get(e.g.keySystem));for(var c=new Yx,h=g(t.textStreams),p=h.next();!p.done;p=h.next())c.g.set(p.value.id,52);for(h=g(t.imageStreams),p=h.next();!p.done;p=h.next())Jx(c,p.value);for(h=g(t.variants),p=h.next();!p.done;p=h.next())$x(c,p.value);return a=function(e,t,n,r){for(var i=new Map,a=fT(n),o=new Map,s=(a=g(a)).next();!s.done;s=a.next()){var u=dT(e,t,n,s=s.value,r,i);o.set(s.id,u)}for(e=g(n.variants),t=e.next();!t.done;t=e.next())(t=t.value).audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),Fh:Array.from(i.values())}}(a,c,t,i),i=a.streams,a=a.Fh,(c=e.g)&&o&&(c.initData=[]),{vk:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.Yd(),streams:i,sessionIds:o?Ea(e):[],drmInfo:c,appMetadata:r,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},Fh:a}}(l,f,t,n,o,s,D),N=L.vk,O=L.Fh,x(F,c.bb.addManifests([N]),19);case 19:if(U=F.h,cT(e),h=U[0],cT(e),p)throw p;return x(F,function(e,t,n,r,i,a,o,s,u,l){var d,c,h,p,f,m,v,y,b,S,k;return P(function(I){switch(I.g){case 1:if(d={},c=0,h=function(){if(e.j.g||i.l)throw new Ke(2,9,7001)},p=function(e,t){var p,f,m,v,y,b,w,S,A;return P(function(E){if(1==E.g){for(p=g(e),f=p.next(),m={};!f.done;m={mc:void 0},f=p.next())m.mc=f.value,h(),v=sx(m.mc,a),y=m.mc.i,b=m.mc.h,w=function(e){return function(t){var n,r,i,a;return P(function(s){switch(s.g){case 1:if(n=e.mc.g,r=n.ac(!1),!n.aesKey||r){s.A(2);break}return x(s,ol(t,n.aesKey,e.mc.j),3);case 3:t=s.h;case 2:return i=ox(n),x(s,o.addSegments([{data:t}]),4);case 4:a=s.h,h(),d[i]=a[0],c+=t.byteLength,T(s)}})}}(m),S=m.mc.g,(A=S.ac(!1))?px(i,m.mc.groupId,A,y,b,w):i.queue(m.mc.groupId,v,y,b,w);return x(E,function(e){return P(function(t){return 1==t.g?x(t,Promise.all(e.i.values()),2):t.return(e.g.g)})}(i),2)}return h(),!t||i.l?E.A(0):(aT(s,r,u,l),x(E,o.updateManifest(n,r),0))})},f=!1,w(I,2),!rT(s)||!f||iT(s)){I.A(4);break}return x(I,p(t.filter(function(e){return e.h}),!0),5);case 5:return h(),t=t.filter(function(e){return!e.h}),m=d,v=c,d={},c=0,x(I,nT(o,n,r,m,v,function(){return cT(e)}),6);case 6:h();case 4:if(f){I.A(7);break}return x(I,p(t,!1),8);case 8:return h(),y=d,b=c,d={},c=0,x(I,nT(o,n,r,y,b,function(){return h()}),9);case 9:h();case 7:A(I,0);break;case 2:return S=E(I),k=Object.values(d),x(I,o.removeSegments(k,function(){}),10);case 10:throw S}})}(e,O,h,N,s,o,c.bb,f,l,D),20);case 20:return cT(e),aT(f,N,l,D),x(F,c.bb.updateManifest(h,N),21);case 21:return cT(e),B=new Ux("manifest",c.path.Qb,c.path.bb,h),F.return(Kx(B,N));case 3:return k(F),x(F,d.destroy(),22);case 22:if(!u){F.A(23);break}return x(F,u.stop(),23);case 23:if(!l){F.A(25);break}return x(F,l.destroy(),25);case 25:I(F,0);break;case 2:if(j=E(F),null==h){F.A(27);break}return x(F,tT(h),27);case 27:throw p||j}})}(this,e,t||{},r||[],i||[],function(){var t;return P(function(r){return 1==r.g?n?r.A(2):x(r,sl(e,a.g,o.manifest.retryParameters),3):(2!=r.g&&(n=r.h),t=kt(e,n||null),r.return(t()))})},o,s),(t=new Mi(t,function(){return hx(s)})).finally(function(){Q(a.l,s)}),function(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){Q(e.i,n)})}(this,t)},i.remove=function(e){return pT(this,function(e,t){var n,r,i,a,o,s;return P(function(u){switch(u.g){case 1:if(hT(),null==(n=Bx(t))||"manifest"!=n.g)throw new Ke(2,9,9004,t);return r=n,i=new Ax,S(u,2),x(u,i.init(),4);case 4:return x(u,kx(i,r.Qb(),r.bb()),5);case 5:return x(u,(a=u.h).getManifests([r.key()]),6);case 6:return o=u.h,s=o[0],x(u,Promise.all([sT(e,s,i),uT(a,r,s)]),2);case 2:return k(u),x(u,i.destroy(),8);case 8:I(u,0)}})}(this,e))},i.Ok=function(){return pT(this,function(e){var t,n,r,i,a,o,s,u,l,d;return P(function(c){switch(c.g){case 1:return hT(),t=e.g,n=e.h.drm,r=new Ax,i=!1,S(c,2),x(c,r.init(),4);case 4:a=[],function(e,t){e.g.forEach(function(e){t(e.getEmeSessionCell())})}(r,function(e){return a.push(e)}),o=g(a),s=o.next();case 5:if(s.done){c.A(2);break}return x(c,(u=s.value).getAll(),8);case 8:return l=c.h,x(c,Xx(n,t,l),9);case 9:return d=c.h,x(c,u.remove(d),10);case 10:d.length!=l.length&&(i=!0),s=o.next(),c.A(5);break;case 2:return k(c),x(c,r.destroy(),11);case 11:I(c,3);break;case 3:return c.return(!i)}})}(this))},i.list=function(){return pT(this,P(function(r){switch(r.g){case 1:return hT(),e=[],t=new Ax,S(r,2),x(r,t.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.g.forEach(function(e,n){e.getCells().forEach(function(e,r){t({Qb:n,bb:r},e)})})}(t,function(t,r){n=n.then(function(){return P(function(n){if(1==n.g)return x(n,r.getAllManifests(),2);n.h.forEach(function(n,r){n=Kx(new Ux("manifest",t.Qb,t.bb,r),n),e.push(n)}),T(n)})})}),x(r,n,2);case 2:return k(r),x(r,t.destroy(),6);case 6:I(r,3);break;case 3:return r.return(e)}}));var e,t,n},i.md=function(e,t,n,r){var i,a=this;return P(function(o){return 1==o.g?((i=new ba({vc:a.g,onError:t,yf:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(n.drm),x(o,function(e,t,n){return e.$=!0,e.C=new Map,e.R=n,Ta(e,t,!1)}(i,e.variants,r),2)):3!=o.g?x(o,Sa(i),3):o.return(i)})},V("shaka.offline.Storage",Zx),Zx.deleteAll=function(){var e;return P(function(t){return 1==t.g?(e=new Ax,S(t,2),x(t,function(e){var t,n;return P(function(r){return 1==r.g?(t=Array.from(e.g.values()),(n=t.length>0)||Cx.forEach(function(e){(e=e())&&t.push(e)}),x(r,Promise.all(t.map(function(e){return e.erase()})),2)):n?r.A(0):x(r,Promise.all(t.map(function(e){return e.destroy()})),0)})}(e),2)):5!=t.g?(k(t),x(t,e.destroy(),5)):I(t,0)})},Zx.prototype.list=Zx.prototype.list,Zx.prototype.removeEmeSessions=Zx.prototype.Ok,Zx.prototype.remove=Zx.prototype.remove,Zx.prototype.store=Zx.prototype.store,Zx.prototype.getNetworkingEngine=Zx.prototype.Zb,Zx.prototype.getConfiguration=Zx.prototype.getConfiguration,Zx.prototype.configure=Zx.prototype.configure,Zx.prototype.destroy=Zx.prototype.destroy,Zx.support=eT;var gT=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c");function mT(){}function vT(e,t){for(e={priority:t||0,callback:e},t=0;t<xT.length;t++)if(xT[t].priority<e.priority)return void xT.splice(t,0,e);xT.push(e)}th("offline",eT),V("shaka.polyfill",mT),mT.register=vT,mT.installAll=function(){for(var e=g(xT),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){K("Error installing polyfill!",n)}}};var yT,bT,xT=[];function TT(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}function wT(e){return e.startsWith("com.apple")?"cbcs":e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("org.w3")||e.startsWith("com.huawei")?"cenc":(K("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function ST(e){if(!e)return!1;var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function AT(e,t){return!(e&&e!=t&&("cbcs"!=e&&"cbcs-1-9"!=e||!oe().ed()))}function ET(){}function kT(){oe().Nf()&&!yT&&!navigator.emeEncryptionSchemePolyfilled&&navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration&&(yT=navigator.requestMediaKeySystemAccess,navigator.requestMediaKeySystemAccess=IT,navigator.emeEncryptionSchemePolyfilled=!0)}function IT(e,t){var n,r=this;return P(function(i){return 1==i.g?x(i,yT.call(r,e,t),2):ST(n=i.h)?(navigator.requestMediaKeySystemAccess=yT,i.return(n)):(navigator.requestMediaKeySystemAccess=CT,i.return(CT.call(r,e,t)))})}function CT(e,t){var n,r,i,a,o,s,u,l,d,c,h,p,f=this;return P(function(m){if(1==m.g){for(n=wT(e),r=[],i=g(t),a=i.next();!a.done;a=i.next())o=a.value,s=MT(o.videoCapabilities,n),u=MT(o.audioCapabilities,n),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!u.length||((l=Object.assign({},o)).videoCapabilities=s,l.audioCapabilities=u,r.push(l));if(!r.length)throw(d=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",d.code=DOMException.NOT_SUPPORTED_ERR,d;return x(m,yT.call(f,e,r),2)}return c=m.h,p=h=null,r[0]&&(r[0].videoCapabilities&&(h=r[0].videoCapabilities[0].encryptionScheme),r[0].audioCapabilities&&(p=r[0].audioCapabilities[0].encryptionScheme)),m.return(new TT(c,h,p))})}function MT(e,t){return e?e.filter(function(e){return AT(e.encryptionScheme,t)}):e}function RT(){}function _T(){oe().Nf()&&!bT&&!navigator.mediaCapabilitiesEncryptionSchemePolyfilled&&navigator.mediaCapabilities&&(bT=navigator.mediaCapabilities.decodingInfo,navigator.mediaCapabilities.decodingInfo=PT,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0)}function PT(e){var t,n,r=this;return P(function(i){switch(i.g){case 1:return x(i,bT.call(r,e),2);case 2:if(!(t=i.h).supported||!e.keySystemConfiguration)return i.return(t);if(ST(n=t.keySystemAccess))return navigator.mediaCapabilities.decodingInfo=bT,i.return(t);if(navigator.mediaCapabilities.decodingInfo=DT,n){i.A(3);break}return x(i,LT(e),4);case 4:return t.keySystemAccess=i.h,i.return(t);case 3:return i.return(DT.call(r,e))}})}function DT(e){var t,n,r,i,a,o,s,u=this;return P(function(l){switch(l.g){case 1:return n=t=null,!e.keySystemConfiguration||(r=e.keySystemConfiguration,i=r.keySystem,n=r.audio&&r.audio.encryptionScheme,t=r.video&&r.video.encryptionScheme,a=wT(i),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},AT(n,a)&&AT(t,a))?x(l,bT.call(u,e),2):l.return(o);case 2:if((s=l.h).keySystemAccess){s.keySystemAccess=new TT(s.keySystemAccess,t,n),l.A(3);break}if(!e.keySystemConfiguration){l.A(3);break}return x(l,LT(e),5);case 5:s.keySystemAccess=l.h;case 3:return l.return(s)}})}function LT(e){var t,n;return P(function(r){if(1==r.g){var i=e.keySystemConfiguration,a=[],o=[];return i.audio&&a.push({robustness:i.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:i.audio.encryptionScheme}),i.video&&o.push({robustness:i.video.robustness||"",contentType:e.video.contentType,encryptionScheme:i.video.encryptionScheme}),i={initDataTypes:i.initDataType?[i.initDataType]:[],distinctiveIdentifier:i.distinctiveIdentifier,persistentState:i.persistentState,sessionTypes:i.sessionTypes},a.length&&(i.audioCapabilities=a),o.length&&(i.videoCapabilities=o),t=i,x(r,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=r.h,r.return(n)})}function NT(){}function OT(){oe().hc()||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),NT.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=UT)}function UT(t){var n,r,i,a,o,s,u;return P(function(l){switch(l.g){case 1:if(n={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:t},oe(),r=t.video,i=t.audio,"media-source"!=t.type){if("file"!=t.type)return l.return(n);if(r&&(a=r.contentType,""==ns().canPlayType(a))||i&&(o=i.contentType,""==ns().canPlayType(o)))return l.return(n);l.A(2);break}if(!Jv())return l.return(n);if(!r){l.A(3);break}return x(l,function(t){var n;return P(function(r){return 1==r.g?"CAST"!==oe().Oa()?r.A(2):x(r,function(t){var n,r,i,a;return P(function(o){if(1==o.g){if(!(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return o.return(Za(t.contentType));switch(n=t.contentType,t.width&&t.height&&t.width>1280&&t.height>720&&(n+="; width="+t.width+"; height="+t.height),t.framerate&&((r=Math.round(t.framerate))<24||r>30)&&(n+="; framerate="+t.framerate),t.transferFunction||""){case"":case"srgb":break;case"pq":n+="; eotf=smpte2084";break;case"hlg":n+="; eotf=arib-std-b67";break;default:return o.return(!1)}return i=!1,(a=zT).has(n)?(i=a.get(n),o.A(2)):x(o,cast.__platform__.canDisplayType(n),3)}return 2!=o.g&&(i=o.h,a.set(n,i)),o.return(i)})}(t),3):2!=r.g?(n=r.h,r.return(n)):r.return(Za(t.contentType))})}(r),4);case 4:if(!l.h)return l.return(n);case 3:if(i){var d=oe().Oa(),c=i.contentType;if("CAST"===d&&i.spatialRendering&&(c+="; spatialRendering=true"),!Za(c))return l.return(n)}case 2:return t.keySystemConfiguration?(s=t.keySystemConfiguration,x(l,function(e,t,n){var r,i,a,o,s,u,l,d,c,h,p,f;return P(function(g){switch(g.g){case 1:r=[],i=[],a=[],n.audio&&(o={robustness:n.audio.robustness||"",contentType:t.contentType},oe().zi()&&t.contentType.includes('codecs="ac-3"')&&(o.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(o.encryptionScheme=n.audio.encryptionScheme,a.push(n.audio.encryptionScheme)),r.push(o)),n.video&&(s={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(s.encryptionScheme=n.video.encryptionScheme,a.push(n.video.encryptionScheme)),i.push(s)),u={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},r.length&&(u.audioCapabilities=r),i.length&&(u.videoCapabilities=i),l=e?e.contentType:"",d=t?t.contentType:"",c=mr(l)+";"+gr(l),h=mr(d)+";"+gr(d),p=n.keySystem,f=null,w(g,2);var m=ze(c,h,p,a);if(We.has(m)){m=ze(c,h,p,a),f=We.get(m)||null,g.A(4);break}return x(g,navigator.requestMediaKeySystemAccess(n.keySystem,[u]),5);case 5:m=f=g.h;var v=ze(c,h,p,a);We.set(v,m);case 4:A(g,3);break;case 2:E(g);case 3:return g.return(f)}})}(r,i,s),6)):(n.supported=!0,l.return(n));case 6:(u=l.h)&&(n.supported=!0,n.keySystemAccess=u);case 5:return l.return(n)}})}TT.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=g(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(n=(t=g(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},TT.prototype.createMediaKeys=function(){return this.g.createMediaKeys()},mT.EmeEncryptionScheme=ET,ET.install=kT,vT(kT),mT.MCapEncryptionScheme=RT,RT.install=_T,vT(_T,-2),mT.MediaCapabilities=NT,NT.install=OT,NT.originalMcap=null;var BT,jT,FT,VT,HT,GT,zT=new Map;function XT(){}function WT(){var t=oe(),n="WEBKIT"===t.Ha()?t.Ba():null;for((e.MediaSource||e.ManagedMediaSource)&&n&&e.MediaSource&&(n<=12?(KT(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):n<=15&&KT()),n=(t=g(t.Ji())).next();!n.done;n=t.next())qT(n.value);(e.MediaSource||e.ManagedMediaSource)&&function(){if(e.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(e){return"mp2t"!=pr(e)&&t(e)}}if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"mp2t"!=pr(e)&&n(e)}}}(),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function(){var e=MediaSource.isTypeSupported;oe().dj()&&(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),r=n.findIndex(function(e){return e.startsWith("codecs=")});if(r<0)return e(t);var i=n[r].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),a=i.findIndex(function(e){return e.startsWith("vp09")});return a>=0&&(i[a]="vp9",n[r]='codecs="'+i.join(",")+'"',t=n.join("; ")),e(t)})}()}function KT(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,D.apply(0,arguments));return t.abort=function(){},t}}function qT(t){var n=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(e){return gr(e)!=t&&n(e)},e.ManagedMediaSource){var r=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return gr(e)!=t&&r(e)}}}function YT(){}function $T(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&e.shakaMediaKeysPolyfill!=ow&&(void 0!==t&&t&&(BT=!0,jT=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),FT=HTMLMediaElement.prototype.setMediaKeys,VT=e.MediaKeys,HT=e.MediaKeySystemAccess,GT=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=QT,e.MediaKeys=tw,e.MediaKeySystemAccess=ew,navigator.requestMediaKeySystemAccess=JT,e.shakaMediaKeysPolyfill=ow,vi.clear(),We.clear())}function JT(e,t){try{var n=new ew(e,t);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function QT(e){var t=this.mediaKeys;return t&&t!=e&&nw(t,null),delete this.mediaKeys,(this.mediaKeys=e)?nw(e,this):Promise.resolve()}function ZT(e){if(Ue(e=Ne(e.initData)).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Qe(e=$e(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=Le(e),this.dispatchEvent(t)}function ew(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=g(t)).next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var r=!1,i=!1;if(n.audioCapabilities)for(var a=g(n.audioCapabilities),o=a.next();!o.done;o=a.next())(o=o.value).contentType&&(r=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,o.contentType.split(";")[0])&&(t.audioCapabilities.push(o),i=!0));if(n.videoCapabilities)for(a=(n=g(n.videoCapabilities)).next();!a.done;a=n.next())(a=a.value).contentType&&(r=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.videoCapabilities.push(a),i=!0));r||(i=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=i?t:null}if(t)return void(this.g=t)}throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function tw(e){this.h=new WebKitMediaKeys(e),this.g=new ne}function nw(e,t){if(e.g.Qa(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",ZT);try{return gu(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(n){return Promise.reject(n)}}function rw(e){Bi.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new ne,this.sessionId="",this.expiration=NaN,this.closed=new Ci,this.keyStatuses=new aw,this.onkeystatuseschange=null}function iw(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new Ni("keystatuseschange"),e.dispatchEvent(t),e.onkeystatuseschange&&e.onkeystatuseschange(t)}function aw(){this.size=0,this.g=void 0}vT(OT,-1),mT.MediaSource=XT,XT.install=WT,vT(WT),mT.PatchedMediaKeysApple=YT,YT.uninstall=function(){e.shakaMediaKeysPolyfill==ow&&BT&&(BT=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",jT),HTMLMediaElement.prototype.setMediaKeys=FT,e.MediaKeys=VT,e.MediaKeySystemAccess=HT,navigator.requestMediaKeySystemAccess=GT,jT=GT=FT=HT=VT=null,e.shakaMediaKeysPolyfill="",vi.clear(),We.clear())},YT.install=$T,ew.prototype.createMediaKeys=function(){var e=new tw(this.keySystem);return Promise.resolve(e)},ew.prototype.getConfiguration=function(){return this.g},tw.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new rw(this.h)},tw.prototype.setServerCertificate=function(){return Promise.resolve(!1)},tw.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},p(rw,Bi),(i=rw.prototype).generateRequest=function(e,t){var n=this;this.h=new Ci;try{var r=this.l.createSession("video/mp4",Ne(t));this.i=r,this.sessionId=r.sessionId||"",this.j.D(this.i,"webkitkeymessage",function(e){n.h&&(n.h.resolve(),n.h=null),e=new Ni("message",e=(new Map).set("messageType",null==n.keyStatuses.Kc()?"license-request":"license-renewal").set("message",Le(e.message))),n.dispatchEvent(e)}),this.j.D(r,"webkitkeyadded",function(){n.g&&(iw(n,"usable"),n.g.resolve(),n.g=null)}),this.j.D(r,"webkitkeyerror",function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:iw(n,"output-not-allowed");break;default:iw(n,"internal-error")}}),iw(this,"status-pending")}catch(i){this.h.reject(i)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new Ci;try{this.i.update(Ne(e))}catch(t){this.g.reject(t)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Qa()}catch(fA){this.closed.reject(fA)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(i=aw.prototype).Kc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Xe.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Xe.value();return!(!this.g||!De(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var ow="apple";function sw(){}function uw(){if(e.MediaKeys){var t=oe();MediaKeys.prototype.setServerCertificate&&t.ve()||(MediaKeys.prototype.setServerCertificate=lw)}}function lw(){return Promise.resolve(!1)}function dw(){}function cw(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Aw="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=pw,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=fw,e.MediaKeys=mw,e.MediaKeySystemAccess=gw,e.shakaMediaKeysPolyfill=Ew}}function hw(e){return Aw?Aw+e.charAt(0).toUpperCase()+e.slice(1):e}function pw(e,t){try{var n=new gw(e,t);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function fw(e){var t=this.mediaKeys;return t&&t!=e&&vw(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&vw(e,this),Promise.resolve()}function gw(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var r=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var a=(t=g(t)).next();!a.done;a=t.next()){var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(a=a.value).initDataTypes,sessionTypes:["temporary"],label:a.label},s=!1;if(a.audioCapabilities)for(var u=g(a.audioCapabilities),l=u.next();!l.done;l=u.next())(l=l.value).contentType&&(s=!0,i.canPlayType(l.contentType.split(";")[0],this.g)&&(o.audioCapabilities.push(l),r=!0));if(a.videoCapabilities)for(l=(u=g(a.videoCapabilities)).next();!l.done;l=u.next())(l=l.value).contentType&&(s=!0,i.canPlayType(l.contentType,this.g)&&(o.videoCapabilities.push(l),r=!0));if(s||(r=i.canPlayType("video/mp4",this.g)||i.canPlayType("video/webm",this.g)),"required"==a.persistentState&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):r=!1),r)return void(this.h=o)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(e=Error(n)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function mw(e){this.l=e,this.h=null,this.g=new ne,this.i=[],this.j=new Map}function vw(e,t){e.h=t,e.g.Qa();var n=Aw;t&&(e.g.D(t,n+"needkey",function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=Le(t.initData),e.h.dispatchEvent(n)}),e.g.D(t,n+"keymessage",function(t){var n=yw(e,t.sessionId);n&&(t=new Ni("message",t=(new Map).set("messageType",null==n.keyStatuses.Kc()?"licenserequest":"licenserenewal").set("message",t.message)),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))}),e.g.D(t,n+"keyadded",function(t){(t=yw(e,t.sessionId))&&t.ready()}),e.g.D(t,n+"keyerror",function(t){var n=yw(e,t.sessionId);if(n){var r=Error("EME v0.1b key error"),i=t.errorCode;i.systemCode=t.systemCode,r.errorCode=i,!t.sessionId&&n.h?(45==t.systemCode&&(r.message="Unsupported session type."),n.h.reject(r),n.h=null):t.sessionId&&n.g?(n.g.reject(r),n.g=null):(r=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ww(n,"output-restricted"):ww(n,1==r?"expired":"internal-error"))}}))}function yw(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function bw(e,t,n){Bi.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new Ci,this.keyStatuses=new Sw,this.onkeystatuseschange=null}function xw(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var r=Ne(Qe("LOAD_SESSION|"+n));else{var i=Qe("PERSISTENT|");r=lt(i,t)}else r=Ne(t)}catch(o){return Promise.reject(o)}e.h=new Ci;var a=hw("generateKeyRequest");try{e.j[a](e.i,r)}catch(o){if("InvalidStateError"!=o.name)return e.h=null,Promise.reject(o);new Rr(function(){try{e.j[a](e.i,r)}catch(t){e.h.reject(t),e.h=null}}).ka(.01)}return e.h}function Tw(e,t,n){if(e.g)e.g.then(function(){return Tw(e,t,n)}).catch(function(){return Tw(e,t,n)});else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var r=Ye(n),i=JSON.parse(r);"oct"!=i.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),r=ot(i.keys[0].k),i=ot(i.keys[0].kid)}else r=Ne(n),i=null;var a=hw("addKey");try{e.j[a](e.i,r,i,e.sessionId)}catch(o){e.g.reject(o),e.g=null}}}function ww(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new Ni("keystatuseschange"),e.dispatchEvent(t),e.onkeystatuseschange&&e.onkeystatuseschange(t)}function Sw(){this.size=0,this.g=void 0}vT(function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||$T())}),mT.PatchedMediaKeysCert=sw,sw.install=uw,vT(uw),mT.PatchedMediaKeysWebkit=dw,dw.install=cw,gw.prototype.createMediaKeys=function(){var e=new mw(this.g);return Promise.resolve(e)},gw.prototype.getConfiguration=function(){return this.h},mw.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new bw(t,this.l,e),this.i.push(e),e},mw.prototype.setServerCertificate=function(){return Promise.resolve(!1)},mw.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},p(bw,Bi),(i=bw.prototype).ready=function(){ww(this,"usable"),this.g&&this.g.resolve(),this.g=null},i.generateRequest=function(e,t){return xw(this,t,null)},i.load=function(e){return"persistent-license"==this.l?xw(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new Ci;return Tw(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=hw("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(i=Sw.prototype).Kc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Xe.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Xe.value();return!(!this.g||!De(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var Aw="",Ew="webkit";function kw(){}function Iw(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=Cw))}function Cw(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function Mw(){}function Rw(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:_w})}function _w(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function Pw(){}function Dw(){for(var e=g([Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array]),t=e.next();!t.done;t=e.next())(t=t.value).prototype.indexOf||(t.prototype.indexOf=Lw),t.prototype.lastIndexOf||(t.prototype.lastIndexOf=Nw),t.prototype.includes||(t.prototype.includes=Ow)}function Lw(e,t){return Array.prototype.indexOf.call(this,e,t)}function Nw(e,t){return Array.prototype.lastIndexOf.call(this,e,t)}function Ow(e,t){return-1!==this.indexOf(e,t)}function Uw(){}function Bw(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}function jw(){}function Fw(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||"number"==typeof ns().webkitDroppedFrameCount)&&(t.getVideoPlaybackQuality=Vw)}}function Vw(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Hw(){}function Gw(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=zw;else if(6==n)t=Xw;else{try{var r=!!zw(1,2,"")}catch(i){r=!1}r&&(t=zw)}t&&(e.VTTCue=function(e,n,r){return t(e,n,r)})}}function zw(t,n,r){return new e.TextTrackCue(t,n,r)}function Xw(t,n,r){return new e.TextTrackCue(t+"-"+n+"-"+r,t,n,r)}function Ww(e){Bi.call(this),this.g=e,this.m=null,this.h=[],this.j=-1,this.i=this.l=null,this.o=new ne}function Kw(){}vT(cw),mT.RandomUUID=kw,kw.install=Iw,vT(Iw),mT.Symbol=Mw,Mw.install=Rw,vT(Rw),mT.TypedArray=Pw,Pw.install=Dw,vT(Dw),mT.VideoPlayPromise=Uw,Uw.install=Bw,vT(Bw),mT.VideoPlaybackQuality=jw,jw.install=Fw,vT(Fw),mT.VTTCue=Hw,Hw.install=Gw,vT(Gw),p(Ww,Bi),(i=Ww.prototype).destroy=function(){var e=this;return P(function(t){if(1==t.g)return x(t,e.removeAllItems(),2);e.g=null,e.o&&(e.o.release(),e.o=null),Bi.prototype.release.call(e),T(t)})},i.configure=function(e){this.m=e},i.getConfiguration=function(){return this.m},i.getCurrentItem=function(){return this.h.length&&this.j>=0&&this.j<this.h.length?this.h[this.j]:null},i.getCurrentItemIndex=function(){return this.j},i.getItems=function(){return this.h.slice()},i.insertItems=function(e){this.h.push.apply(this.h,m(e)),this.dispatchEvent(new Ni("itemsinserted"))},i.removeAllItems=function(){var e,t,n,r,i=this;return P(function(a){if(1==a.g)return i.o.Qa(),i.h.length&&i.j>=0?x(a,i.g.Cc(),2):a.A(2);if(4!=a.g){for(e=[],i.i&&(i.i.preloadManager.l||e.push(i.i.preloadManager.destroy()),i.i=null),i.l&&(i.l.preloadManager.l||e.push(i.l.preloadManager.destroy()),i.l=null),t=g(i.h),n=t.next();!n.done;n=t.next())(r=n.value).preloadManager&&!r.preloadManager.l&&e.push(r.preloadManager.destroy());return e.length?x(a,Promise.all(e),4):a.A(4)}i.h=[],i.j=-1,i.dispatchEvent(new Ni("itemsremoved")),T(a)})},i.playItem=function(e){var t,n,r,i,a,o,s,u,l,d,c,h,p,f,m,v,y,b=this;return P(function(S){switch(S.g){case 1:if(b.o.Qa(),!b.h.length||e>=b.h.length)throw new Ke(2,7,7007);if(t=b.getCurrentItem(),n=b.h[e],b.j!=e&&(b.j=e,b.dispatchEvent(new Ni("currentitemchanged"))),r=b.g.$e(),(i=b.m?b.m.preloadNextUrlWindow:0)>0&&(a=!1,b.o.D(r,"timeupdate",function(){var e,t,n,o;return P(function(s){switch(s.g){case 1:if(b.l||b.h.length<=1||a||b.g.W()||!r.duration)return s.return();if(e=b.g.Ra().end-r.currentTime,isNaN(e)){s.A(0);break}if(!(e<=i)){s.A(0);break}if(t=b.m&&b.m.repeatMode,n=null,b.j+1<b.h.length?n=b.h[b.j+1]:1==t&&(n=b.h[0]),!n||n.preloadManager&&!n.preloadManager.l){s.A(0);break}return a=!0,o=null,w(s,5),x(s,b.g.preload(n.manifestUri,n.startTime,n.mimeType,n.config),7);case 7:o=s.h,A(s,6);break;case 5:E(s),o=null;case 6:b.l={item:n,preloadManager:o},a=!1,T(s)}})})),b.o.D(b.g,"complete",function(){var e=b.m&&b.m.repeatMode,t=!1;if(2==e)t=!0;else{var n=b.j+1;n<b.h.length?b.playItem(n):1==e&&(1==b.h.length?t=!0:b.playItem(0))}t&&(r.paused?(r.currentTime=b.g.Ra().start,r.play()):b.o.D(r,"paused",function(){r.currentTime=b.g.Ra().start,r.play()}))}),o=n.manifestUri,n.preloadManager&&!n.preloadManager.l&&(o=n.preloadManager),s=!1,b.l&&b.l.item==n&&b.l.preloadManager?o=b.l.preloadManager:b.i&&b.i.item==n&&b.i.preloadManager&&(o=b.i.preloadManager,s=!0),!b.i){S.A(2);break}if(s||b.i.preloadManager.l){S.A(3);break}return x(S,b.i.preloadManager.destroy(),3);case 3:b.i=null;case 2:if(!(b.m&&b.m.preloadPrevItem&&t&&b.g.Zd()===ip)){S.A(5);break}return u=null,w(S,6),x(S,b.g.hj(),8);case 8:u=S.h,A(S,7);break;case 6:E(S),u=null;case 7:b.i={item:t,preloadManager:u};case 5:return n.config&&(b.g.Mi(),b.g.configure(n.config)),x(S,b.g.load(o,n.startTime,n.mimeType),9);case 9:if(b.l=null,n.extraText)for(l=g(n.extraText),d=l.next();!d.done;d=l.next())(c=d.value).mime?b.g.Qd(c.uri,c.language,c.kind,c.mime,c.codecs):b.g.Qd(c.uri,c.language,c.kind);if(n.extraThumbnail)for(h=g(n.extraThumbnail),p=h.next();!p.done;p=h.next())f=p.value,b.g.Oe(f);if(n.extraChapter)for(m=g(n.extraChapter),v=m.next();!v.done;v=m.next())y=v.value,b.g.Ne(y.uri,y.language,y.mime);T(S)}})},V("shaka.queue.QueueManager",Ww),Ww.prototype.playItem=Ww.prototype.playItem,Ww.prototype.removeAllItems=Ww.prototype.removeAllItems,Ww.prototype.insertItems=Ww.prototype.insertItems,Ww.prototype.getItems=Ww.prototype.getItems,Ww.prototype.getCurrentItemIndex=Ww.prototype.getCurrentItemIndex,Ww.prototype.getCurrentItem=Ww.prototype.getCurrentItem,Ww.prototype.getConfiguration=Ww.prototype.getConfiguration,Ww.prototype.configure=Ww.prototype.configure,Ww.prototype.destroy=Ww.prototype.destroy,lp=function(e){return new Ww(e)},Kw.prototype.parseInit=function(){},Kw.prototype.setSequenceMode=function(){},Kw.prototype.setManifestType=function(){},Kw.prototype.parseMedia=function(e,t){for(var n=null,r=[],i=(e=g(e=Ye(e).split(/\r?\n/))).next();!i.done;i=e.next())if((i=i.value)&&!/^\s+$/.test(i)&&(i=qw.exec(i))){var a=Yw.exec(i[1]);i=new Mn(a=60*parseInt(a[1],10)+parseFloat(a[2].replace(",",".")),t.segmentEnd?t.segmentEnd:a+2,i[2]),n&&(n.endTime=a,r.push(n)),n=i}return n&&r.push(n),r},V("shaka.text.LrcTextParser",Kw),Kw.prototype.parseMedia=Kw.prototype.parseMedia,Kw.prototype.setManifestType=Kw.prototype.setManifestType,Kw.prototype.setSequenceMode=Kw.prototype.setSequenceMode,Kw.prototype.parseInit=Kw.prototype.parseInit;var qw=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,Yw=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function $w(){this.g="UNKNOWN"}function Jw(e,t,n,r,i,a,o,s,u,l,d,c,h,p){var f=d;if(Zt(t)){if(!c)return null;var m={tagName:"span",children:[nn(t)],attributes:{},parent:null}}else m=t;for(var v=null,y=g(ES),b=y.next();!b.done&&!(v=aS(m,"backgroundImage",i,"#",b.value)[0]);b=y.next());y=null;var x=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if((b=cn(m,ES,"backgroundImage"))&&x.test(b)){if((y=parseInt(b.split(":").pop(),10)-1)>=p.length)return null;y=p[y]}else h&&b&&!b.startsWith("#")&&(x=new me(h),b=new me(b),(b=x.resolve(b).toString())&&(y=b));if(("p"==t.tagName||v||y)&&(c=!0),t=c,b="default"==(m.attributes["xml:space"]||(u?"default":"preserve")),u=[],!(x=m.children.every(Zt)))for(var T=g(m.children),w=T.next();!w.done;w=T.next())(w=Jw(e,w.value,n,r,i,a,o,s,b,l,m,c,h,p))&&u.push(w);if(i=null!=d,h=nn(m),h=m.children.length&&h&&/\S/.test(h),!((T=m.attributes.begin||m.attributes.end||m.attributes.dur)||h||"br"==m.tagName||0!=u.length||i&&!b))return null;for(h=(p=sS(m,r)).start,p=p.end;f&&f.tagName&&"tt"!=f.tagName;)h=(p=oS(f,r,h,p)).start,p=p.end,f=f.parent;if(null==h&&(h=0),h+=n.periodStart,p=null==p?1/0:p+n.periodStart,"HLS"!==e.g&&(h=Math.max(h,n.segmentStart),p=Math.min(p,n.segmentEnd)),!T&&u.length>0)for(h=1/0,p=0,r=(n=g(u)).next();!r.done;r=n.next())r=r.value,h=Math.min(h,r.startTime),p=Math.max(p,r.endTime);if("br"==m.tagName)return(e=new Mn(h,p,"")).lineBreak=!0,e;if(n="",x&&(n=tt(nn(m)||""),b&&(n=n.replace(/\s+/g," "))),(n=new Mn(h,p,n)).nestedCues=u,c||(n.isContainer=!0),l&&(n.cellResolution=l),l=aS(m,"region",o,"")[0],m.attributes.region&&l&&l.attributes["xml:id"]){var S=l.attributes["xml:id"];n.region=s.filter(function(e){return e.id==S})[0]}return s=l,d&&i&&!m.attributes.region&&!m.attributes.style&&(s=aS(d,"region",o,"")[0]),function(e,t,n,r,i,a,o,s,u){if("rtl"==tS(e,n,r,o,"direction",s=s||u)&&(t.direction="rtl"),"tb"==(u=tS(e,n,r,o,"writingMode",s))||"tblr"==u?t.writingMode="vertical-lr":"tbrl"==u?t.writingMode="vertical-rl":"rltb"==u||"rl"==u?t.direction="rtl":u&&(t.direction=Vn),(u=tS(e,n,r,o,"textAlign",!0))?(t.positionAlign=wS.get(u),t.lineAlign=TS.get(u),t.textAlign=Bn[u.toUpperCase()]):t.textAlign=Un,(u=tS(e,n,r,o,"displayAlign",!0))&&(t.displayAlign=Fn[u.toUpperCase()]),(u=tS(e,n,r,o,"color",s))&&(t.color=Zw(u)),(u=tS(e,n,r,o,"backgroundColor",s))&&(t.backgroundColor=Zw(u)),(u=tS(e,n,r,o,"border",s))&&(t.border=u),u=tS(e,n,r,o,"fontFamily",s))switch(u){case"monospaceSerif":t.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":t.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":t.fontFamily="sans-serif";break;case"monospaceSansSerif":t.fontFamily="Consolas,monospace";break;case"proportionalSerif":t.fontFamily="serif";break;default:t.fontFamily=u.split(",").filter(function(e){return"default"!=e}).join(",")}switch((u=tS(e,n,r,o,"fontWeight",s))&&"bold"==u&&(t.fontWeight=Yn),u=tS(e,n,r,o,"wrapOption",s),t.wrapLine=!u||"noWrap"!=u,(u=tS(e,n,r,o,"lineHeight",s))&&u.match(pS)&&(t.lineHeight=u),(u=tS(e,n,r,o,"fontSize",s))&&(u.match(pS)||u.match(hS))&&(t.fontSize=u),(u=tS(e,n,r,o,"fontStyle",s))&&(t.fontStyle=Qn[u.toUpperCase()]),i?(a=i.attributes.imageType||i.attributes.imagetype,u=i.attributes.encoding,i=nn(i).trim(),"PNG"==a&&"Base64"==u&&i&&(t.backgroundImage="data:image/png;base64,"+i)):a&&(t.backgroundImage=a),(i=tS(e,n,r,o,"textOutline",s))&&((i=i.split(" "))[0].match(pS)?t.textStrokeColor=t.color:(t.textStrokeColor=Zw(i[0]),i.shift()),i[0]&&i[0].match(pS)?t.textStrokeWidth=i[0]:t.textStrokeColor=""),(i=tS(e,n,r,o,"letterSpacing",s))&&i.match(pS)&&(t.letterSpacing=i),(i=tS(e,n,r,o,"linePadding",s))&&i.match(pS)&&(t.linePadding=i),(i=tS(e,n,r,o,"opacity",s))&&(t.opacity=parseFloat(i)),(i=nS(e,r,o,"textDecoration"))&&eS(t,i),(i=rS(e,n,o,"textDecoration"))&&eS(t,i),(i=tS(e,n,r,o,"textCombine",s))&&(t.textCombineUpright=i),tS(e,n,r,o,"ruby",s)){case"container":t.rubyTag="ruby";break;case"text":t.rubyTag="rt"}}(e,n,m,s,v,y,a,t,0==u.length),n}function Qw(e,t,n,r){var i=new Ot,a=t.attributes["xml:id"];if(!a)return null;i.id=a,a=null,r&&(a=cS.exec(r)||fS.exec(r)),r=a?Number(a[1]):null,a=a?Number(a[2]):null;var o,s=nS(e,t,n,"extent");if(s){var u=(o=cS.exec(s))||fS.exec(s);null!=u&&(i.width=Number(u[1]),i.height=Number(u[2]),o||(null!=r&&(i.width=100*i.width/r),null!=a&&(i.height=100*i.height/a)),i.widthUnits=o||null!=r?Ut:0,i.heightUnits=o||null!=a?Ut:0)}return(e=nS(e,t,n,"origin"))&&null!=(u=(o=cS.exec(e))||fS.exec(e))&&(i.viewportAnchorX=Number(u[1]),i.viewportAnchorY=Number(u[2]),o?s||(i.width=100-i.viewportAnchorX,i.widthUnits=Ut,i.height=100-i.viewportAnchorY,i.heightUnits=Ut):(null!=a&&(i.viewportAnchorY=100*i.viewportAnchorY/a),null!=r&&(i.viewportAnchorX=100*i.viewportAnchorX/r)),i.viewportAnchorUnits=o||null!=r?Ut:0),i}function Zw(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&4==(t=t[1].split(",")).length?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e}function eS(e,t){for(var n=(t=g(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(Zn)||e.textDecoration.push(Zn);break;case"noUnderline":e.textDecoration.includes(Zn)&&Q(e.textDecoration,Zn);break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Q(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Q(e.textDecoration,"overline")}}function tS(e,t,n,r,i,a){return a=void 0===a||a,(t=rS(e,t,r,i))?t:a?nS(e,n,r,i):null}function nS(e,t,n,r){if(!t)return null;var i=cn(t,AS,r);return i||iS(e,t,n,r)}function rS(e,t,n,r){var i=cn(t,AS,r);return i||iS(e,t,n,r)}function iS(e,t,n,r){t=aS(t,"style",n,"");for(var i=null,a=0;a<t.length;a++){var o=ln(t[a],"urn:ebu:tt:style",r);o||(o=cn(t[a],AS,r)),o||(o=rS(e,t[a],n,r)),o&&(i=o)}return i}function aS(e,t,n,r,i){var a=[];if(!e||n.length<1)return a;var o=e;for(e=null;!e&&!(e=i?ln(o,i,t):o.attributes[t])&&(o=o.parent););if(t=e)for(i=(t=g(t.split(" "))).next();!i.done;i=t.next())for(i=i.value,o=(e=g(n)).next();!o.done;o=e.next())if(r+(o=o.value).attributes["xml:id"]==i){a.push(o);break}return a}function oS(e,t,n,r){return e=sS(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==r?r=e.end:null!=e.start&&(r+=e.start),{start:n,end:r}}function sS(e,t){var n=uS(e.attributes.begin,t),r=uS(e.attributes.end,t);return e=uS(e.attributes.dur,t),null==r&&null!=e&&(r=n+e),{start:n,end:r}}function uS(e,t){var n=null;if(gS.test(e)){e=gS.exec(e),n=Number(e[1]);var r=Number(e[2]),i=Number(e[3]),a=Number(e[4]);n=(i+=(a+=(Number(e[5])||0)/t.h)/t.frameRate)+60*r+3600*n}else if(mS.test(e))n=lS(mS,e);else if(vS.test(e))n=lS(vS,e);else if(yS.test(e))e=yS.exec(e),n=Number(e[1])/t.frameRate;else if(bS.test(e))e=bS.exec(e),n=Number(e[1])/t.g;else if(xS.test(e))n=lS(xS,e);else if(e)throw new Ke(2,2,2001,"Could not parse cue time range in TTML");return n}function lS(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function dS(e,t,n,r){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(r),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}wr("application/x-subtitle-lrc",function(){return new Kw}),$w.prototype.parseInit=function(){},$w.prototype.setSequenceMode=function(){},$w.prototype.setManifestType=function(e){this.g=e},$w.prototype.parseMedia=function(e,t,n,r){var i=Ye(e);if(e=[],""==i)return e;var a=Jt(i,"tt",!0);if(!a)throw new Ke(2,2,2005,"Failed to parse TTML.");if(!(i=an(a,"body")[0]))return[];var o=cn(a,SS,"frameRate"),s=cn(a,SS,"subFrameRate"),u=cn(a,SS,"frameRateMultiplier"),l=cn(a,SS,"tickRate"),d=cn(a,SS,"cellResolution"),c=a.attributes["xml:space"]||"default",h=cn(a,AS,"extent");if("default"!=c&&"preserve"!=c)throw new Ke(2,2,2005,"Invalid xml:space value: "+c);c="default"==c,o=new dS(o,s,u,l),d=function(e){return e&&(e=/^(\d+) (\d+)$/.exec(e))?{columns:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}(d),s=((s=an(a,"metadata")[0])?s.children:[]).filter(function(e){return"\n"!=e}),u=an(a,"style"),l=[];for(var p=g(a=an(a,"region")),f=p.next();!f.done;f=p.next())(f=Qw(this,f.value,u,h))&&l.push(f);if(tn(i,"p").length)throw new Ke(2,2,2001,"<p> can only be inside <div> in TTML");for(p=(h=g(tn(i,"div"))).next();!p.done;p=h.next())if(tn(p.value,"span").length)throw new Ke(2,2,2001,"<span> can only be inside <p> in TTML");return(t=Jw(this,i,t,o,s,u,a,l,c,d,null,!1,n,r))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},V("shaka.text.TtmlTextParser",$w),$w.prototype.parseMedia=$w.prototype.parseMedia,$w.prototype.setManifestType=$w.prototype.setManifestType,$w.prototype.setSequenceMode=$w.prototype.setSequenceMode,$w.prototype.parseInit=$w.prototype.parseInit;var cS=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,hS=/^(\d{1,4}(?:\.\d+)?|100)%$/,pS=/^(\d+px|\d+em|\d*\.?\d+c)$/,fS=/^(\d+)px (\d+)px$/,gS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,mS=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,vS=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,yS=/^(\d*(?:\.\d*)?)f$/,bS=/^(\d*(?:\.\d*)?)t$/,xS=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),TS=(new Map).set("left",zn).set("center","center").set("right","end").set("start",zn).set("end","end"),wS=(new Map).set("left","line-left").set("center","center").set("right","line-right"),SS=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],AS=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],ES=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function kS(){this.g=new $w}function IS(){this.g="UNKNOWN"}function CS(e,t,n){var r;(r=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=r[1],e.textAlign="middle"==t?Un:Bn[t.toUpperCase()]):(r=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==r[1]?"vertical-lr":"vertical-rl":(r=/^size:([\d.]+)%$/.exec(t))?e.size=Number(r[1]):(r=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(r[1]),r[2]&&(t=r[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":On)):(r=/^region:(.*)$/.exec(t))?(t=function(e,t){return e=e.filter(function(e){return e.id==t}),e.length?e[0]:null}(n,r[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=Xn[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Gn,e.line=Number(n[1]),n[2]&&(e.lineAlign=Xn[n[2].toUpperCase()]))}function MS(){this.g=null}function RS(e,t,n){var r,i,a;return(new oa).box("payl",ca(function(e){r=Ye(e)},!1)).box("iden",ca(function(e){i=Ye(e)},!1)).box("sttg",ca(function(e){a=Ye(e)},!1)).parse(e),r?function(e,t,n,r,i){if(Pn(e=new Mn(r,i,e)),t&&(e.id=t),n)for(t=new jt(n),n=Ht(t);n;)CS(e,n,[]),Ft(t),n=Ht(t);return e}(r,i,a,t,n):null}function _S(){}function PS(){this.g=new IS}function DS(){}function LS(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=NS(n))&&(e.color=n),(n=t.BackColour)&&(n=NS(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=Yn),t.Italic&&(e.fontStyle=Jn),t.Underline&&e.textDecoration.push(Zn),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=jn,e.textAlign="start";break;case 2:e.displayAlign=jn,e.textAlign=Un;break;case 3:e.displayAlign=jn,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=Un;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=Un;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function NS(e){return(e=parseInt(e.replace("&H",""),16))>=0?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function OS(e){return 3600*((e=FS.exec(e))[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}wr("application/ttml+xml",function(){return new $w}),kS.prototype.parseInit=function(e){var t=!1;if((new oa).box("moov",sa).box("trak",sa).box("mdia",sa).box("minf",sa).box("stbl",sa).S("stsd",ua).box("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new Ke(2,2,2007)},kS.prototype.setSequenceMode=function(e){this.g.setSequenceMode(e)},kS.prototype.setManifestType=function(e){this.g.setManifestType(e)},kS.prototype.parseMedia=function(e,t,n){var r=[],i=null,a=[],o=new Map,s=[];if((new oa).box("moof",sa).box("traf",sa).S("tfhd",function(e){i=no(e.reader,e.flags).Wd}).S("trun",function(e){for(var t=(e=g((e=ao(e.reader,e.version,e.flags)).kh)).next();!t.done;t=e.next())s.push(t.value.sampleSize||i||0)}).S("subs",function(e){for(var t=e.reader,n=t.U(),r=-1,i=0;i<n;i++){var a=t.U();r+=a,a=t.Ca();for(var s=[],u=0;u<a;u++)1==e.version?s.push(t.U()):s.push(t.Ca()),t.Y(),t.Y(),t.U();o.set(r,s)}}).box("mdat",ca(function(e){a.push(e)},!1)).parse(e,!1),0==a.length)throw new Ke(2,2,2007);for(var u=lt.apply(rt,m(a)),l=0,d=0;d<s.length;d++){var c=Ne(u,l,s[d]);l+=s[d];var h=o.get(d);if(h&&h.length){c=Ne(c,0,h[0]);for(var p=[],f=h[0],v=1;v<h.length;v++){var y=Ne(e,f,h[v]);y=it(y),p.push("data:image/png;base64,"+y),f+=h[v]}r=r.concat(this.g.parseMedia(c,t,n,p))}else r=r.concat(this.g.parseMedia(c,t,n,[]))}return r},V("shaka.text.Mp4TtmlParser",kS),kS.prototype.parseMedia=kS.prototype.parseMedia,kS.prototype.setManifestType=kS.prototype.setManifestType,kS.prototype.setSequenceMode=kS.prototype.setSequenceMode,kS.prototype.parseInit=kS.prototype.parseInit,wr('application/mp4; codecs="stpp"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.im1i"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.im1t"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.im2i"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.im2t"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.etd1"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.etd1|im1t"',function(){return new kS}),wr('application/mp4; codecs="stpp.ttml.im1t|etd1"',function(){return new kS}),wr('application/mp4; codecs="stpp.TTML.im1t"',function(){return new kS}),IS.prototype.parseInit=function(){},IS.prototype.setSequenceMode=function(){},IS.prototype.setManifestType=function(e){this.g=e},IS.prototype.parseMedia=function(e,t){var n=(e=(e=Ye(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new Ke(2,2,2e3);if(e=t.vttOffset,"HLS"==this.g&&n[0].includes("X-TIMESTAMP-MAP")){var r=n[0];if(e=r.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),r=r.match(/MPEGTS:(\d+)/m),!e||!r)throw new Ke(2,2,2e3);if(null==(e=zt(e[1])))throw new Ke(2,2,2e3);r=Number(r[1]);for(var i=t.segmentStart-t.periodStart;i>=95443.7176888889;)i-=95443.7176888889,r+=8589934592;e=t.periodStart+r/9e4-e}for(t=[],i=(r=g(n[0].split("\n"))).next();!i.done;i=r.next())if(i=i.value,/^Region:/.test(i)){i=new jt(i);var a=new Ot;Ht(i),Ft(i);for(var o=Ht(i);o;){var s=a,u=o;(o=/^id=(.*)$/.exec(u))?s.id=o[1]:(o=/^width=(\d{1,2}|100)%$/.exec(u))?s.width=Number(o[1]):(o=/^lines=(\d+)$/.exec(u))?(s.height=Number(o[1]),s.heightUnits=2):(o=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(s.regionAnchorX=Number(o[1]),s.regionAnchorY=Number(o[2])):(o=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(s.viewportAnchorX=Number(o[1]),s.viewportAnchorY=Number(o[2])):/^scroll=up$/.exec(u)&&(s.scroll="up"),Ft(i),o=Ht(i)}t.push(a)}for(Dn(r=new Map),i=[],a=(n=g(n.slice(1))).next();!a.done;a=n.next()){if((1!=(a=a.value.split("\n")).length||a[0])&&!/^NOTE($|[ \t])/.test(a[0])&&"STYLE"==a[0]){for(s=[],o=-1,u=1;u<a.length;u++)a[u].includes("::cue")&&(s.push([]),o=s.length-1),-1!=o&&(s[o].push(a[u]),a[u].includes("}")&&(o=-1));for(o=(s=g(s)).next();!o.done;o=s.next()){var l=o.value;o="global",(u=l[0].match(/\((.*)\)/))&&(o=u.pop()),u=l.slice(1,-1),l[0].includes("}")&&(l=/\{(.*?)\}/.exec(l[0]))&&(u=l[1].split(";")),(l=r.get(o))||(l=new Mn(0,0,""));for(var d=!1,c=0;c<u.length;c++){var h=/^\s*([^:]+):\s*(.*)/.exec(u[c]);if(h){var p=h[2].trim().replace(";","");switch(h[1].trim()){case"background-color":case"background":d=!0,l.backgroundColor=p;break;case"color":d=!0,l.color=p;break;case"font-family":d=!0,l.fontFamily=p;break;case"font-size":d=!0,l.fontSize=p;break;case"font-weight":(parseInt(p,10)>=700||"bold"==p)&&(d=!0,l.fontWeight=Yn);break;case"font-style":switch(p){case"normal":d=!0,l.fontStyle=$n;break;case"italic":d=!0,l.fontStyle=Jn;break;case"oblique":d=!0,l.fontStyle="oblique"}break;case"opacity":d=!0,l.opacity=parseFloat(p);break;case"text-combine-upright":d=!0,l.textCombineUpright=p;break;case"text-shadow":d=!0,l.textShadow=p;break;case"white-space":d=!0,l.wrapLine="noWrap"!=p}}}d&&r.set(o,l)}}if(d=e,1==(l=a).length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0]||"REGION"==l[0])a=null;else if(a=null,l[0].includes("--\x3e")||(a=l[0],l.splice(0,1)),o=Gt(s=new jt(l[0])),c=Vt(s,/[ \t]+--\x3e[ \t]+/g),u=Gt(s),null==o||null==c||null==u)K("Failed to parse VTT time code. Cue skipped:",a,l),a=null;else{for(u+=d,(o+=d)<0&&(o=0),d=l.slice(1).join("\n").trim(),r.has("global")?((l=r.get("global").clone()).startTime=o,l.endTime=u,l.payload=d):l=new Mn(o,u,d),Ft(s),o=Ht(s);o;)CS(l,o,t),Ft(s),o=Ht(s);Pn(l,r),null!=a&&(l.id=a),a=l}a&&i.push(a)}return i},V("shaka.text.VttTextParser",IS),IS.prototype.parseMedia=IS.prototype.parseMedia,IS.prototype.setManifestType=IS.prototype.setManifestType,IS.prototype.setSequenceMode=IS.prototype.setSequenceMode,IS.prototype.parseInit=IS.prototype.parseInit,wr("text/vtt",function(){return new IS}),wr('text/vtt; codecs="vtt"',function(){return new IS}),wr('text/vtt; codecs="wvtt"',function(){return new IS}),MS.prototype.parseInit=function(e){var t=this,n=!1;if((new oa).box("moov",sa).box("trak",sa).box("mdia",sa).S("mdhd",function(e){e=io(e.reader,e.version),t.g=e.timescale}).box("minf",sa).box("stbl",sa).S("stsd",ua).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new Ke(2,2,2008);if(!n)throw new Ke(2,2,2008)},MS.prototype.setSequenceMode=function(){},MS.prototype.setManifestType=function(){},MS.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new Ke(2,2,2008);var n,r=0,i=[],a=[],o=!1,s=!1,u=!1,l=null;if((new oa).box("moof",sa).box("traf",sa).S("tfdt",function(e){o=!0,r=ro(e.reader,e.version).baseMediaDecodeTime}).S("tfhd",function(e){l=no(e.reader,e.flags).Vd}).S("trun",function(e){s=!0,i=ao(e.reader,e.version,e.flags).kh}).box("mdat",ca(function(e){u=!0,n=e},!1)).parse(e,!1),!u&&!o&&!s)throw new Ke(2,2,2008);e=r;for(var d=new ra(n,0),c=g(i),h=c.next();!h.done;h=c.next()){var p=(h=h.value).mh||l,f=h.Ff?r+h.Ff:e;e=f+(p||0);var m=0;do{var v=d.U();m+=v;var y=null;"vttc"==pa(d.U())?v>8&&(y=d.Ub(v-8,!1)):d.skip(v-8),p&&y&&(v=RS(y,t.periodStart+f/this.g,t.periodStart+e/this.g),a.push(v))}while(h.sampleSize&&m<h.sampleSize)}return a.filter(Dr)},V("shaka.text.Mp4VttParser",MS),MS.prototype.parseMedia=MS.prototype.parseMedia,MS.prototype.setManifestType=MS.prototype.setManifestType,MS.prototype.setSequenceMode=MS.prototype.setSequenceMode,MS.prototype.parseInit=MS.prototype.parseInit,wr('application/mp4; codecs="wvtt"',function(){return new MS}),_S.prototype.parseInit=function(){},_S.prototype.setSequenceMode=function(){},_S.prototype.setManifestType=function(){},_S.prototype.parseMedia=function(e){var t=Ye(e).replace(/\r+/g,"");if(e=[],""==(t=t.trim()))return e;for(var n=(t=g(t.split("\n\n"))).next();!n.done;n=t.next()){var r=new jt((n=n.value.split("\n"))[0]),i=Gt(r),a=Vt(r,/,/g);if(r=Gt(r),null==i||null==a||null==r)throw new Ke(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new Mn(i,r,n.slice(1).join("\n").trim()))}return e},V("shaka.text.SbvTextParser",_S),_S.prototype.parseMedia=_S.prototype.parseMedia,_S.prototype.setManifestType=_S.prototype.setManifestType,_S.prototype.setSequenceMode=_S.prototype.setSequenceMode,_S.prototype.parseInit=_S.prototype.parseInit,wr("text/x-subviewer",function(){return new _S}),PS.prototype.parseInit=function(){},PS.prototype.setSequenceMode=function(){},PS.prototype.setManifestType=function(){},PS.prototype.parseMedia=function(e,t,n){var r=Ye(e);if(e="WEBVTT\n\n",""!=r)for(var i=(r=g((r=(r=r.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!i.done;i=r.next())(i=i.value.split(/\n/))[0].match(/\d+/)&&i.shift(),i[0]=i[0].replace(/,/g,"."),e+=i.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return e=Ne(Qe(e)),this.g.parseMedia(e,t,n,[])},V("shaka.text.SrtTextParser",PS),PS.prototype.parseMedia=PS.prototype.parseMedia,PS.prototype.setManifestType=PS.prototype.setManifestType,PS.prototype.setSequenceMode=PS.prototype.setSequenceMode,PS.prototype.parseInit=PS.prototype.parseInit,wr("text/srt",function(){return new PS}),DS.prototype.parseInit=function(){},DS.prototype.setSequenceMode=function(){},DS.prototype.setManifestType=function(){},DS.prototype.parseMedia=function(e){var t="",n="",r=null,i=null;for(i=(e=g(i=Ye(e).split(/\r?\n\s*\r?\n/))).next();!i.done;i=e.next()){var a=i.value;i=a,(a=US.exec(a))&&(r=a[1],i=a[2]),"V4 Styles"==r||"V4+ Styles"==r?(t=i,t=n?t+"\n"+i:i):"Events"==r&&(n=n?n+"\n"+i:i)}for(r=[],i=null,e=(t=g(t.split(/\r?\n/))).next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(a=BS.exec(e)))if(e=a[1].trim(),a=a[2].trim(),"Format"==e)i=a.split(jS);else if("Style"==e){e=a.split(jS),a={};for(var o=0;o<i.length&&o<e.length;o++)a[i[o]]=e[o];r.push(a)}for(i=[],t=null,a=(n=g(n.split(/\r?\n/))).next(),e={};!a.done;e={Zi:void 0},a=n.next())if(a=a.value,!/^\s*;/.test(a)&&(o=BS.exec(a)))if(a=o[1].trim(),o=o[2].trim(),"Format"==a)t=o.split(jS);else if("Dialogue"==a){o=o.split(jS),a={};for(var s=0;s<t.length&&s<o.length;s++)a[t[s]]=o[s];o=new Mn(s=OS(a.Start),OS(a.End),o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.Zi=a.Style,(e=r.find(function(e){return function(t){return t.Name==e.Zi}}(e)))&&LS(o,e),i.push(o)}return i},V("shaka.text.SsaTextParser",DS),DS.prototype.parseMedia=DS.prototype.parseMedia,DS.prototype.setManifestType=DS.prototype.setManifestType,DS.prototype.setSequenceMode=DS.prototype.setSequenceMode,DS.prototype.parseInit=DS.prototype.parseInit;var US=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,BS=/^\s*([^:]+):\s*(.*)/,jS=/\s*,\s*/,FS=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function VS(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n)>0?{ce:n,ra:e}:null}function HS(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=(60&e[t+2])>>>2;if(r>n.length-1)return null;var i=((192&e[t+2])>>>6)+1,a=(1&e[t+2])<<2;return a|=(192&e[t+3])>>>6,{sampleRate:n[r],channelCount:a,codec:"mp4a.40."+i}}function GS(e,t){if(t+1<e.length&&255===e[t]&&240==(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var r=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(r<=n)&&((t+=r)===e.length||t+1<e.length&&255===e[t]&&240==(246&e[t+1]))}return!1}function zS(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function XS(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(n>=3)return null;var r=63&e[t+4],i=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*r+n];if(t+i>e.length)return null;var a=e[t+6]>>5,o=0;2===a?o+=2:(1&a&&1!==a&&(o+=2),4&a&&(o+=2)),o=(e[t+6]<<8|e[t+7])>>12-o&1;var s=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|s>>2,(3&s)<<6|a<<3|o<<2|r>>4,r<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][a]+o,Ga:e,ra:i}}function WS(e,t){if(11===e[t]&&119===e[t+1]){var n,r,i=0,a=5;for(t+=a;a>0;){r=e[t];var o=Math.min(a,8),s=8-o;n=(r&(n=4278190080>>>24+s<<s))>>s,i=i?i<<o|n:n,t+=1,a-=o}if(i<16)return!0}return!1}function KS(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function qS(e,t){if(t+8>e.length||2935!=(e[t]<<8|e[t+1]))return null;var n=new ps(e.subarray(t+2));gs(n,2),gs(n,3);var r=ms(n,11)+1<<1,i=ms(n,2);if(3==i){i=[24e3,22060,16e3][i=ms(n,2)];var a=3}else i=[48e3,44100,32e3][i],a=ms(n,2);var o=ms(n,3),s=ms(n,1);return n=ms(n,5),t+r>e.byteLength?null:(e=Math.floor(r*i/(16*[1,2,3,6][a])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,i<<6|n<<1,o<<1|s,0]),{sampleRate:i,channelCount:[2,1,2,3,3,4,4,5][o]+s,Ga:e,ra:r})}function YS(e){this.j=e,this.h=0,this.g=new Map,this.i=null}wr("text/x-ssa",function(){return new DS}),(i=zS.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&Za(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(vr(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,r){for(var i=Ne(e),a=cs(i),o=a.length;o<i.length&&!GS(i,o);o++);if(e=1e3*n.endTime,(a=ds(a)).length&&n&&(a=a.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(e=a.data),!(a=HS(i,o)))return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=a.sampleRate,t.channelsCount=a.channelCount;for(var s=[];o<i.length;){var u=VS(i,o);if(!u)return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));var l=u.ce+u.ra;o+l<=i.length&&s.push({data:i.subarray(o+u.ce,o+l),size:u.ra,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),o+=l}return i=a.sampleRate,e=Math.floor(e*i/1e3),r=new co([r={id:t.id,type:"audio",codecs:a.codec,encrypted:t.encrypted&&t.drmInfos.length>0,timescale:i,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:s},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ho(r),this.g.set(n,t)),n=this.i!==t,r=vo(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})},V("shaka.transmuxer.AacTransmuxer",zS),zS.prototype.transmux=zS.prototype.transmux,zS.prototype.getOriginalMimeType=zS.prototype.getOriginalMimeType,zS.prototype.convertCodecs=zS.prototype.convertCodecs,zS.prototype.isSupported=zS.prototype.isSupported,zS.prototype.destroy=zS.prototype.destroy,nr("audio/aac",function(){return new zS("audio/aac")},ar),(i=KS.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&Za(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?oe().re()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,r){for(var i=cs(e=Ne(e)),a=i.length;a<e.length&&!WS(e,a);a++);var o=1e3*n.endTime;(i=ds(i)).length&&n&&(i=i.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(o=i.data),i=0;for(var s=new Uint8Array([]),u=[];a<e.length;){var l=XS(e,a);if(!l)return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,i=l.sampleRate,s=l.Ga,u.push({data:e.subarray(a,a+l.ra),size:l.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),a+=l.ra}return e=Math.floor(o*i/1e3),r=new co([r={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:i,duration:r,Cb:[],Ga:s,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:u},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ho(r),this.g.set(n,t)),n=this.i!==t,r=vo(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})},V("shaka.transmuxer.Ac3Transmuxer",KS),KS.prototype.transmux=KS.prototype.transmux,KS.prototype.getOriginalMimeType=KS.prototype.getOriginalMimeType,KS.prototype.convertCodecs=KS.prototype.convertCodecs,KS.prototype.isSupported=KS.prototype.isSupported,KS.prototype.destroy=KS.prototype.destroy,nr("audio/ac3",function(){return new KS("audio/ac3")},ar),(i=YS.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&Za(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,r){for(var i=cs(e=Ne(e)),a=i.length;a<e.length&&2935!=(e[a]<<8|e[a+1]);a++);var o=1e3*n.endTime;(i=ds(i)).length&&n&&(i=i.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(o=i.data),i=0;for(var s=new Uint8Array([]),u=[];a<e.length;){var l=qS(e,a);if(!l)return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,i=l.sampleRate,s=l.Ga,u.push({data:e.subarray(a,a+l.ra),size:l.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),a+=l.ra}return e=Math.floor(o*i/1e3),r=new co([r={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:i,duration:r,Cb:[],Ga:s,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:u},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ho(r),this.g.set(n,t)),n=this.i!==t,r=vo(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})},V("shaka.transmuxer.Ec3Transmuxer",YS),YS.prototype.transmux=YS.prototype.transmux,YS.prototype.getOriginalMimeType=YS.prototype.getOriginalMimeType,YS.prototype.convertCodecs=YS.prototype.convertCodecs,YS.prototype.isSupported=YS.prototype.isSupported,YS.prototype.destroy=YS.prototype.destroy,nr("audio/ec3",function(){return new YS("audio/ec3")},ar);var $S=[100,110,122,244,44,83,86,118,128,138,139,134];function JS(e){if(!e.length)return null;var t=e.find(function(e){return 32==e.type}),n=e.find(function(e){return 33==e.type}),r=e.find(function(e){return 34==e.type});if(!t||!n||!r)return null;var i=function(e){var t=new ps(e,!0);return ws(t),ws(t),ms(t,4),ms(t,2),ms(t,6),e=ms(t,3),t=Ts(t),{Wg:e+1,Dh:t}}(t.fullData);e=function(e){ws(e=new ps(e,!0)),ws(e);var t=0,n=0,r=0,i=0;ms(e,4);var a=ms(e,3);Ts(e);for(var o=ms(e,2),s=ms(e,1),u=ms(e,5),l=ws(e),d=ws(e),c=ws(e),h=ws(e),p=ws(e),f=ws(e),g=ws(e),m=ws(e),v=ws(e),y=ws(e),b=ws(e),x=[],T=[],w=0;w<a;w++)x.push(Ts(e)),T.push(Ts(e));if(a>0)for(w=a;w<8;w++)ms(e,2);for(w=0;w<a;w++)x[w]&&ms(e,88),T[w]&&ws(e);bs(e),3==(x=bs(e))&&ms(e,1),T=bs(e),w=bs(e),Ts(e)&&(t+=bs(e),n+=bs(e),r+=bs(e),i+=bs(e));var S=bs(e),A=bs(e),E=bs(e);if(Ts(e))for(var k=0;k<=a;k++)bs(e),bs(e),bs(e);else bs(e),bs(e),bs(e);if(bs(e),bs(e),bs(e),bs(e),bs(e),bs(e),Ts(e)&&Ts(e))for(k=0;k<4;k++)for(var I=0;I<(3===k?2:6);I++)if(Ts(e)){var C=Math.min(64,1<<4+(k<<1));k>1&&xs(e);for(var M=0;M<C;M++)xs(e)}else bs(e);for(Ts(e),Ts(e),Ts(e)&&(ws(e),bs(e),bs(e),Ts(e)),k=bs(e),C=I=0;C<k;C++)if(M=!1,0!==C&&(M=Ts(e)),M){C===k&&bs(e),Ts(e),bs(e);for(var R=M=0;R<=I;R++){var _=Ts(e),P=!1;_||(P=Ts(e)),(_||P)&&M++}I=M}else{for(I=(R=bs(e))+(M=bs(e)),_=0;_<R;_++)bs(e),Ts(e);for(R=0;R<M;R++)bs(e),Ts(e)}if(Ts(e))for(k=bs(e),I=0;I<k;I++){for(C=0;C<E+4;C++)ms(e,1);ms(e,1)}if(k=E=1,I=!0,C=1,R=M=0,Ts(e),Ts(e),Ts(e)){if(Ts(e)){P=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2];var D=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];(_=ws(e))>0&&_<=16?(E=P[_-1],k=D[_-1]):255===_&&(E=ms(e,16),k=ms(e,16))}if(Ts(e)&&Ts(e),Ts(e)&&(ms(e,3),Ts(e),Ts(e)&&(ws(e),ws(e),ws(e))),Ts(e)&&(bs(e),bs(e)),Ts(e),Ts(e),Ts(e),(_=Ts(e))&&(ys(e),ys(e),ys(e),ys(e)),Ts(e)&&(C=ms(e,32),M=ms(e,32),Ts(e)&&bs(e),Ts(e))){D=!1,_=Ts(e),P=Ts(e),(_||P)&&((D=Ts(e))&&(ws(e),ms(e,5),Ts(e),ms(e,5)),ms(e,4),ms(e,4),D&&ms(e,4),ms(e,5),ms(e,5),ms(e,5));for(var L=0;L<=a;L++){var N=!0,O=1;(I=Ts(e))||(N=Ts(e));var U=!1;if(N?bs(e):U=Ts(e),U||(O=bs(e)+1),_){for(N=0;N<O;N++)bs(e),bs(e),D&&(bs(e),bs(e));Ts(e)}if(P){for(N=0;N<O;N++)bs(e),bs(e),D&&(bs(e),bs(e));Ts(e)}}}Ts(e)&&(Ts(e),Ts(e),Ts(e),R=bs(e),bs(e),bs(e),bs(e),bs(e))}return{Bg:b,Hg:o,Ig:s,Gg:u,Cg:l,Dg:d,Eg:c,Fg:h,vg:p,wg:f,xg:g,yg:m,zg:v,Ag:y,tf:R,jg:x,ig:S,hg:A,width:T-(t+n)*(1===x||2===x?2:1),height:w-(r+i)*(1===x?2:1),Sk:E,Rk:k,ug:M/C,sg:I}}(n.fullData);var a=function(e){var t=new ps(e,!0);ws(t),ws(t),bs(t),bs(t),Ts(t),Ts(t),ms(t,3),Ts(t),Ts(t),bs(t),bs(t),xs(t),Ts(t),Ts(t),Ts(t)&&bs(t),xs(t),xs(t),Ts(t),Ts(t),Ts(t),Ts(t),e=Ts(t),t=Ts(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Yg:n}}(r.fullData);return t=function(e,t,n,r){var i=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));for(i[0]=1,i[1]=(3&r.Hg)<<6|(r.Ig?1:0)<<5|31&r.Gg,i[2]=r.Cg,i[3]=r.Dg,i[4]=r.Eg,i[5]=r.Fg,i[6]=r.vg,i[7]=r.wg,i[8]=r.xg,i[9]=r.yg,i[10]=r.zg,i[11]=r.Ag,i[12]=r.Bg,i[13]=240|(3840&r.tf)>>8,i[14]=255&r.tf,i[15]=252|3&r.Yg,i[16]=252|3&r.jg,i[17]=248|7&r.ig,i[18]=248|7&r.hg,i[19]=0,i[20]=parseInt(r.ug,10),i[21]=(3&(r.sg?1:0))<<6|(7&r.Wg)<<3|(r.Dh?1:0)<<2|3,i[22]=3,e=[e,t,n],t=23,n=e.length-1,r=0;r<e.length;r+=1)i.set(new Uint8Array([32+r|(r===n?128:0),0,1]),t),t+=3,i.set(new Uint8Array([e[r].byteLength>>8,255&e[r].byteLength]),t),t+=2,i.set(e[r],t),t+=e[r].byteLength;return i}(t.fullData,n.fullData,r.fullData,{Wg:i.Wg,Dh:i.Dh,Hg:e.Hg,Ig:e.Ig,Bg:e.Bg,Gg:e.Gg,Cg:e.Cg,Dg:e.Dg,Eg:e.Eg,Fg:e.Fg,vg:e.vg,wg:e.wg,xg:e.xg,yg:e.yg,zg:e.zg,Ag:e.Ag,tf:e.tf,jg:e.jg,ig:e.ig,hg:e.hg,Yg:a.Yg,ug:e.ug,sg:e.sg}),{height:e.height,width:e.width,Sa:t,Za:e.Sk,$a:e.Rk}}function QS(e,t){var n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==n&&0!==i&&15!==i&&3!==a){var o=e[t+3]>>6;i=1e3*tA[14*(3===n?3-r:3===r?3:4)+i-1],a=nA[3*(3===n?0:2===n?1:2)+a],n=rA[n][r];var s=iA[r],u=Math.floor(n*i/a+(e[t+2]>>1&1))*s,l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(l=l?parseInt(l[1],10):0)&&l<=87&&2===r&&i>=224e3&&0===o&&(e[t+3]|=128),{sampleRate:a,channelCount:3===o?1:2,ra:u,Qk:8*n*s}}return null}function ZS(e,t){return!(255!==e[t]||224&~e[t+1]||!(6&e[t+1]))}function eA(e,t){if(t+1<e.length&&ZS(e,t)){var n=QS(e,t),r=4;return n&&n.ra&&(r=n.ra),(t+=r)===e.length||t+1<e.length&&ZS(e,t)}return!1}var tA=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],nA=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],rA=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],iA=[0,1,1,4];function aA(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function oA(e){this.h=e,this.g=null}
/*
      		 @license
      		 MSS Transmuxer
      		 Copyright 2015 Dash Industry Forum
      		 SPDX-License-Identifier: BSD-3-Clause
      		*/
function sA(e){this.h=e,(this.g=Yv.get("ISOBoxer")())&&function(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)}))})}e.g.addBoxProcessor("saio",function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)}),e.g.addBoxProcessor("saiz",function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",function(){for(var e=!0,n=0;n<16;n++)this.usertype[n]!==lA[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))})}(this)}function uA(e,t){for(var n=8,r=0;r<e.boxes.length&&e.boxes[r].type!==t;r++)n+=e.boxes[r].size;return n}(i=aA.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&Za(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,r){for(var i=Ne(e),a=cs(i).length;a<i.length&&!eA(i,a);a++);var o;for(e=[];a<i.length;){var s=QS(i,a);if(!s)return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));o||(o=s),a+s.ra<=i.length&&e.push({data:i.subarray(a,a+s.ra),size:s.ra,duration:1152,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),a+=s.ra}return o?(i=9e4*o.Qk/o.sampleRate*this.h,r=new co([r={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:o.sampleRate,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:i,zb:e},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ho(r),this.g.set(n,t)),n=this.i!==t,r=vo(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})):Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null))},V("shaka.transmuxer.Mp3Transmuxer",aA),aA.prototype.transmux=aA.prototype.transmux,aA.prototype.getOriginalMimeType=aA.prototype.getOriginalMimeType,aA.prototype.convertCodecs=aA.prototype.convertCodecs,aA.prototype.isSupported=aA.prototype.isSupported,aA.prototype.destroy=aA.prototype.destroy,nr("audio/mpeg",function(){return new aA("audio/mpeg")},ar),(i=oA.prototype).destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=vr(e).split(","),n=ft("audio",t);return t=ft("video",t),!(!n||t||"mp3"!=fr(n))&&Za(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,r,i){if(this.g?this.g.clearData():this.g=new Es,this.g.Jf(n.i),e=Ne(e),"mp3"!=(e=this.g.parse(e)).Xd().audio||"audio"!=i)return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));for(n=new Uint8Array([]),i=g(e.ub()),e=i.next();!e.done;e=i.next())if(e=e.value.data)for(t=0;t<e.length;)(r=QS(e,t))?(t+r.ra<=e.length&&(n=lt(n,e.subarray(t,t+r.ra))),t+=r.ra):t++;return Promise.resolve(n)},V("shaka.transmuxer.MpegTsTransmuxer",oA),oA.prototype.transmux=oA.prototype.transmux,oA.prototype.getOriginalMimeType=oA.prototype.getOriginalMimeType,oA.prototype.convertCodecs=oA.prototype.convertCodecs,oA.prototype.isSupported=oA.prototype.isSupported,oA.prototype.destroy=oA.prototype.destroy,nr("video/mp2t",function(){return new oA("video/mp2t")},or),(i=sA.prototype).destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?Za(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),Za(t)||Za(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(Ne(e));if(!t.mssPrivateData)return Promise.reject(new Ke(2,3,3020,n?n.P()[0]:null));try{var r,i=this.g.parseBuffer(e),a=i.fetch("tfhd");a.track_ID=t.id+1;var o=i.fetch("tfdt"),s=i.fetch("traf");null===o&&((o=this.g.createFullBox("tfdt",s,a)).version=1,o.flags=0,o.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var u=i.fetch("trun"),l=i.fetch("tfxd");l&&l._parent.boxes.splice(l._parent.boxes.indexOf(l),1);var d=i.fetch("tfrf");d&&d._parent.boxes.splice(d._parent.boxes.indexOf(d),1);var c=i.fetch("sepiff");if(null!==c){c.type="senc",c.usertype=void 0;var h=i.fetch("saio");if(null===h){(h=this.g.createFullBox("saio",s)).version=0,h.flags=0,h.entry_count=1,h.offset=[0];var p=this.g.createFullBox("saiz",s);if(p.version=0,p.flags=0,p.sample_count=c.sample_count,p.default_sample_info_size=0,p.sample_info_size=[],2&c.flags)for(r=0;r<c.sample_count;r+=1)p.sample_info_size[r]=10+6*c.entry[r].NumberOfEntries;else p.default_sample_info_size=8}}a.flags&=16777214,a.flags|=131072,u.flags|=1;var f=i.fetch("moof");u.data_offset=f.getLength()+8;var g=i.fetch("saio");null!==g&&(g.offset[0]=uA(f,"traf")+uA(s,"senc")+16);var m=Ne(i.write());return Promise.resolve(m)}catch(v){return v instanceof Ke?Promise.reject(v):Promise.reject(new Ke(2,3,3022,n?n.P()[0]:null))}},V("shaka.transmuxer.MssTransmuxer",sA),sA.prototype.transmux=sA.prototype.transmux,sA.prototype.getOriginalMimeType=sA.prototype.getOriginalMimeType,sA.prototype.convertCodecs=sA.prototype.convertCodecs,sA.prototype.isSupported=sA.prototype.isSupported,sA.prototype.destroy=sA.prototype.destroy;var lA=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function dA(e){this.m=e,this.g=0,this.j=new Map,this.l=this.i=this.h=null}nr("mss/audio/mp4",function(){return new sA("mss/audio/mp4")},ar),nr("mss/video/mp4",function(){return new sA("mss/video/mp4")},ar),(i=dA.prototype).destroy=function(){this.j.clear(),this.i&&this.i.destroy()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var r=vr(n).split(",");return n=ft("audio",r),r=ft("video",r),!(n&&(n=fr(n),!cA.includes(n))||r&&(n=fr(r),!hA.includes(n)))&&(t?Za(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),Za(t)||Za(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=vr(t).replace("mp4a.40.34","mp3").split(",").map(function(e){return ei(e,"audio/mp4")}).map(ti).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.getOriginalMimeType=function(){return this.m},i.transmux=function(e,t,n,r,i){var a=Ne(e);if("audio"==i&&!Ms(a)){for(var o=cs(a),s=o.length;s<a.length;s++)if(eA(a,s))return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));for(s=o.length;s<a.length;s++)if(GS(a,s))return this.i||(this.i=new zS("audio/aac")),this.i.transmux(e,t,n,r,i);return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null))}this.h?this.h.clearData():this.h=new Es,this.h.Jf(n.i);var u=this.h.parse(a),l=[],d=u.Xd();try{var c=null;if("video"==i){switch(d.video){case"avc":var h=[],p=null,f=u.ud(),v=function(e){function t(e){i={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:e.pts,dts:e.dts,nalus:[]}}function n(){if(i&&i.nalus.length&&i.frame){for(var e=[],t=g(i.nalus),n=t.next();!n.done;n=t.next()){var a=(n=n.value).fullData.byteLength,o=new Uint8Array(4);o[0]=a>>24&255,o[1]=a>>16&255,o[2]=a>>8&255,o[3]=255&a,e.push(o),e.push(n.fullData)}i.data=lt.apply(rt,m(e)),r.push(i)}}for(var r=[],i=null,a=!1,o=0;o<e.length;o++){var s=e[o],u=s.nalus,l=!1;i&&u.length&&!a&&(n(),t(s));for(var d=(u=g(s.nalus)).next();!d.done;d=u.next()){var c=!1;switch((d=d.value).type){case 1:var h=!1;c=!0;var p=d.data;l&&p.length>4&&(2===(p=As(new ps(p)))||4===p||7===p||9===p)&&(h=!0),h&&i&&i.frame&&!i.isKeyframe&&(n(),i=null),i||t(s),i.frame=!0,i.isKeyframe=h;break;case 5:c=!0,i&&i.frame&&!i.isKeyframe&&(n(),i=null),i||t(s),i.frame=!0,i.isKeyframe=!0;break;case 6:case 8:case 12:c=!0;break;case 7:l=c=!0;break;case 9:a=c=!0,i&&i.frame&&(n(),i=null),i||t(s);break;default:c=!1}i&&c&&i.nalus.push(d)}}return n(),r}(f);if(!v.length)throw new Ke(2,3,3023,n?n.P()[0]:null);for(var y=0;y<v.length;y++){var b,x=v[y];null==p&&(p=x.dts),b=y+1<v.length?(v[y+1].dts||0)-(x.dts||0):v.length>1?(x.dts||0)-(v[y-1].dts||0):9e4*(n.endTime-n.startTime),h.push({data:x.data,size:x.data.byteLength,duration:b,sb:Math.round((x.pts||0)-(x.dts||0)),flags:{xb:0,mb:0,jb:0,hb:0,ib:x.isKeyframe?2:1,yb:x.isKeyframe?0:1}})}for(var T=[],w=g(f),S=w.next();!S.done;S=w.next())T.push.apply(T,m(S.value.nalus));var A=function(e){if(!e.length)return null;var t=e.find(function(e){return 7==e.type});if(e=e.find(function(e){return 8==e.type}),!t||!e)return null;var n=new ps(t.data),r=ws(n);if(ws(n),ws(n),ys(n),$S.includes(r)&&(3===(r=bs(n))&&gs(n,1),ys(n),ys(n),gs(n,1),Ts(n))){r=3!==r?8:12;for(var i=0;i<r;i++)Ts(n)&&Ss(n,i<6?16:64)}if(ys(n),0===(r=bs(n)))bs(n);else if(1===r)for(gs(n,1),ys(n),ys(n),r=bs(n),i=0;i<r;i++)ys(n);ys(n),gs(n,1);var a=bs(n),o=bs(n),s=ms(n,1);0===s&&gs(n,1),gs(n,1);var u=0,l=0,d=0,c=0;if(Ts(n)&&(u=bs(n),l=bs(n),d=bs(n),c=bs(n)),i=r=1,Ts(n)&&Ts(n)){var h=ws(n);h>0&&h<=16?(r=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][h-1],i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][h-1]):255===h&&(r=ms(n,16),i=ms(n,16))}return n=(2-s)*(o+1)*16-2*d-2*c,a=16*(a+1)-2*u-2*l,u=[],t=t.fullData,u.push(t.byteLength>>>8&255),u.push(255&t.byteLength),u=u.concat.apply(u,m(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,m(e)),{height:n,width:a,Sa:e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u,[1],t)),Za:r,$a:i}}(T);if(!A||null==p)throw new Ke(2,3,3018,n?n.P()[0]:null);t.height=A.height,t.width=A.width,c={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:9e4,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:A.Sa,Za:A.Za,$a:A.$a,data:{sequenceNumber:this.g,baseMediaDecodeTime:p,zb:h},stream:t};break;case"hvc":var E=[],k=null,I=[],C=u.ud();if(!C.length)throw new Ke(2,3,3023,n?n.P()[0]:null);for(var M=0;M<C.length;M++){var R=C[M],_=R.nalus;I.push.apply(I,m(_));for(var P=!1,D=[],L=!1,N=g(_),O=N.next();!O.done;O=N.next()){var U=O.value;switch(U.type){case 1:case 0:var B=L=!0;break;case 19:case 20:case 21:P=B=L=!0;break;case 32:case 33:case 34:case 39:case 40:B=!0;break;case 35:L=B=!0;break;default:B=!1}if(L&&B){var j=U.fullData.byteLength,F=new Uint8Array(4);F[0]=j>>24&255,F[1]=j>>16&255,F[2]=j>>8&255,F[3]=255&j,D.push(F),D.push(U.fullData)}}var V,H=D.length?{data:lt.apply(rt,m(D)),isKeyframe:P}:null;H&&(null==k&&null!=R.dts&&(k=R.dts),V=M+1<C.length?(C[M+1].dts||0)-(R.dts||0):C.length>1?(R.dts||0)-(C[M-1].dts||0):9e4*(n.endTime-n.startTime),E.push({data:H.data,size:H.data.byteLength,duration:V,sb:Math.round((R.pts||0)-(R.dts||0)),flags:{xb:0,mb:0,jb:0,hb:0,ib:H.isKeyframe?2:1,yb:H.isKeyframe?0:1}}))}var G=JS(I);if(!G||null==k)throw new Ke(2,3,3018,n?n.P()[0]:null);t.height=G.height,t.width=G.width,c={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:9e4,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:G.Sa,Za:G.Za,$a:G.$a,data:{sequenceNumber:this.g,baseMediaDecodeTime:k,zb:E},stream:t}}c&&(l.push(c),c=null)}if("audio"==i){switch(d.audio){case"aac":for(var z,X=[],W=null,K=null,q=null,Y=g(u.ub()),$=Y.next();!$.done;$=Y.next()){var J=$.value,Q=J.data;if(Q){var Z=0;if(-1==K&&q)Q=lt(q,J.data),K=null;else if(null!=K&&q){Z=Math.max(0,K);var ee=lt(q,Q.subarray(0,Z));X.push({data:ee,size:ee.byteLength,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),K=q=null}if(!(z=HS(Q,Z)))throw new Ke(2,3,3018,n?n.P()[0]:null);for(t.audioSamplingRate=z.sampleRate,t.channelsCount=z.channelCount,null==W&&null!==J.pts&&(W=J.pts);Z<Q.length;){var te=VS(Q,Z);if(!te){q=Q.subarray(Z,Q.length),K=-1;break}var ne=te.ce+te.ra;0!=(K=Math.max(0,Z+ne-Q.length))?q=Q.subarray(Z+te.ce,Z+ne):Z+ne<=Q.length&&X.push({data:Q.subarray(Z+te.ce,Z+ne),size:te.ra,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),Z+=ne}}}if(!z||null==W){W=9e4*n.startTime;var re=ft("audio",t.codecs.split(","));if(!re||!t.channelsCount||!t.audioSamplingRate)throw new Ke(2,3,3018,n?n.P()[0]:null);z={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:re};var ie=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}(re,t.channelsCount);if(!ie)throw new Ke(2,3,3018,n?n.P()[0]:null);for(var ae=W+9e4*(n.endTime-n.startTime),oe=W;oe<ae;)X.push({data:ie,size:ie.byteLength,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),oe+=1024/z.sampleRate*9e4}var se=z.sampleRate,ue=W/9e4*se;c={id:t.id,type:"audio",codecs:z.codec,encrypted:t.encrypted&&t.drmInfos.length>0,timescale:se,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:ue,zb:X},stream:t};break;case"ac3":for(var le=[],de=0,ce=new Uint8Array([]),he=null,pe=g(u.ub()),fe=pe.next();!fe.done;fe=pe.next()){var ge=fe.value,me=ge.data;null==he&&null!==ge.pts&&(he=ge.pts);for(var ve=0;ve<me.length;){var ye=XS(me,ve);ye?(t.audioSamplingRate=ye.sampleRate,t.channelsCount=ye.channelCount,de=ye.sampleRate,ce=ye.Ga,le.push({data:me.subarray(ve,ve+ye.ra),size:ye.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),ve+=ye.ra):ve++}}if(0==de||0==ce.byteLength||null==he)throw new Ke(2,3,3018,n?n.P()[0]:null);var be=he/9e4*de;c={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:de,duration:r,Cb:[],Ga:ce,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:be,zb:le},stream:t};break;case"ec3":for(var xe=[],Te=0,we=new Uint8Array([]),Se=null,Ae=g(u.ub()),Ee=Ae.next();!Ee.done;Ee=Ae.next()){var ke=Ee.value,Ie=ke.data;null==Se&&null!==ke.pts&&(Se=ke.pts);for(var Ce=0;Ce<Ie.length;){var Me=qS(Ie,Ce);Me?(t.audioSamplingRate=Me.sampleRate,t.channelsCount=Me.channelCount,Te=Me.sampleRate,we=Me.Ga,xe.push({data:Ie.subarray(Ce,Ce+Me.ra),size:Me.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),Ce+=Me.ra):Ce++}}if(0==Te||0==we.byteLength||null==Se)throw new Ke(2,3,3018,n?n.P()[0]:null);var Re=Se/9e4*Te;c={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:Te,duration:r,Cb:[],Ga:we,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:Re,zb:xe},stream:t};break;case"mp3":for(var _e,Pe=[],De=null,Le=g(u.ub()),Oe=Le.next();!Oe.done;Oe=Le.next()){var Ue=Oe.value,Be=Ue.data;if(Be){null==De&&null!==Ue.pts&&(De=Ue.pts);for(var je=0;je<Be.length;){var Fe=QS(Be,je);Fe?(_e||(_e=Fe),je+Fe.ra<=Be.length&&Pe.push({data:Be.subarray(je,je+Fe.ra),size:Fe.ra,duration:1152,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),je+=Fe.ra):je++}}}if(!_e||null==De)throw new Ke(2,3,3018,n?n.P()[0]:null);var Ve=_e.sampleRate,He=De/9e4*Ve;c={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:Ve,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:He,zb:Pe},stream:t};break;case"opus":var Ge=[],ze=null,Xe=u.H;if(!Xe)throw new Ke(2,3,3018,n?n.P()[0]:null);var We=[];switch(Xe.sj){case 1:case 2:We=[0];break;case 0:We=[255,1,1,0,1];break;case 128:We=[255,2,0,0,1];break;case 3:We=[1,2,1,0,2,1];break;case 4:We=[1,2,2,0,1,2,3];break;case 5:We=[1,3,2,0,4,1,2,3];break;case 6:We=[1,4,2,0,4,1,2,3,5];break;case 7:We=[1,4,2,0,4,1,2,3,5,6];break;case 8:We=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:We=[1,1,2,0,1];break;case 131:We=[1,1,3,0,1,2];break;case 132:We=[1,1,4,0,1,2,3];break;case 133:We=[1,1,5,0,1,2,3,4];break;case 134:We=[1,1,6,0,1,2,3,4,5];break;case 135:We=[1,1,7,0,1,2,3,4,5,6];break;case 136:We=[1,1,8,0,1,2,3,4,5,6,7]}for(var qe=new Uint8Array([0,Xe.channelCount,0,0,Xe.sampleRate>>>24&255,Xe.sampleRate>>>17&255,Xe.sampleRate>>>8&255,Xe.sampleRate>>>0&255,0,0].concat(m(We))),Ye=Xe.sampleRate,$e=g(u.ub()),Je=$e.next();!Je.done;Je=$e.next()){var Qe=Je.value,Ze=Qe.data;null==ze&&null!==Qe.pts&&(ze=Qe.pts);for(var et=0;et<Ze.length;){for(var tt=!!(16&Ze[et+1]),nt=!!(8&Ze[et+1]),it=et+2,at=0;255===Ze[it];)at+=255,it+=1;at+=Ze[it],it+=1,it+=tt?2:0,it+=nt?2:0;var ot=Ze.slice(it,it+at);Ge.push({data:ot,size:ot.byteLength,duration:960,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),et=it+at}}if(0==qe.byteLength||null==ze)throw new Ke(2,3,3018,n?n.P()[0]:null);t.audioSamplingRate=Xe.sampleRate,t.channelsCount=Xe.channelCount;var st=ze/9e4*Ye;c={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:Ye,duration:r,Cb:[],Ga:qe,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:st,zb:Ge},stream:t}}c&&(l.push(c),c=null)}}catch(gt){return gt&&3023==gt.code?Promise.resolve(new Uint8Array([])):Promise.reject(gt)}if(!l.length)return Promise.reject(new Ke(2,3,3018,n?n.P()[0]:null));var ut=new co(l),dt=t.id+"_"+n.i;if(this.j.has(dt))var ct=this.j.get(dt);else ct=ho(ut),this.j.set(dt,ct);var ht=this.l!==ct,pt=vo(ut);return this.l=ct,this.g++,Promise.resolve({data:pt,init:ht?ct:null})},V("shaka.transmuxer.TsTransmuxer",dA),dA.prototype.transmux=dA.prototype.transmux,dA.prototype.getOriginalMimeType=dA.prototype.getOriginalMimeType,dA.prototype.convertCodecs=dA.prototype.convertCodecs,dA.prototype.isSupported=dA.prototype.isSupported,dA.prototype.destroy=dA.prototype.destroy;var cA=["aac","ac-3","ec-3","mp3","opus"],hA=["avc","hevc"];function pA(){}nr("video/mp2t",function(){return new dA("video/mp2t")},sr),p(pA,Xl),V("shaka.util.FairPlayUtils",pA)}.call(t,e,e,void 0),t.shaka)ts[n]=t.shaka[n]}());var is,as,os={lightning:{debug:!1,focusDebug:!1,fontSettings:{fontFamily:"Roboto",color:4294967295,fontSize:40},animationSettings:{easing:"ease-in-out",duration:250},rendererOptions:{appHeight:1080,appWidth:1920,numImageWorkers:2,fontEngines:[class extends ct{constructor(e){super(e),s(this,"ssdfFontFamilies",{}),s(this,"msdfFontFamilies",{}),s(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]),s(this,"sdfShader",void 0),s(this,"rendererBounds",void 0),s(this,"type","sdf"),this.sdfShader=this.stage.shManager.loadShader("SdfShader",{transform:new Float32Array,color:0,size:0,scrollY:0,distanceRange:0,debug:!1}).shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t},x:(e,t)=>{e.props.x=t,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&S(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,t)=>{e.props.y=t,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&S(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,"none"!==e.props.contain&&this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,"both"===e.props.contain&&this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollable:(e,t)=>{e.props.scrollable=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t,this.scheduleUpdateState(e)},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)},lineHeight:(e,t)=>{e.props.lineHeight=t,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,t)=>{e.props.maxLines=t,this.invalidateLayoutCache(e)},textBaseline:(e,t)=>{e.props.textBaseline=t,this.invalidateLayoutCache(e)},verticalAlign:(e,t)=>{e.props.verticalAlign=t,this.invalidateLayoutCache(e)},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t,this.invalidateLayoutCache(e)},debug:(e,t)=>{e.props.debug=t}}}canRenderFont(e){var t=e.fontFamily;return t in this.ssdfFontFamilies||t in this.msdfFontFamilies||"$$SDF_FAILURE_TEST$$"===t}isFontFaceSupported(e){return e instanceof Nt}addFontFace(e){var t=e.fontFamily,n="ssdf"===e.type?this.ssdfFontFamilies:"msdf"===e.type?this.msdfFontFamilies:void 0;if(n){var r=n[t];r||(r=new Set,n[t]=r),r.add(e)}else console.warn(`Invalid font face type: ${e.type}`)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new y,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){var t=e.trFontFace,n=e.textH,r=e.lineCache,i=e.debugData,a=e.forceFullLayoutCalc;if(i.updateCount++,"initialState"===e.status&&this.setStatus(e,"loading"),void 0===t){if(t=this.resolveFontFace(e.props),e.trFontFace=t,void 0===t){var o=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;return console.error(o),void this.setStatus(e,"failed",new Error(o))}t.texture.setRenderableOwner(e.props.fontFamily,!0)}if(!1!==t.loaded){t.data,t.metrics;var s=e.props,u=s.text,l=s.fontSize,d=s.x,c=s.y,h=s.contain,p=s.width,f=s.height,g=s.verticalAlign,m=s.scrollable,v=s.overflowSuffix,y=s.maxLines,b="both"===h&&m?e.props.scrollY:0,x=e.renderWindow,T=t.data.info.size,w=l/T,A=e.resLineHeight;if(void 0===A){var E=e.props.lineHeight;A=void 0===E?function(e,t){return t*(e.ascender-e.descender+e.lineGap)}(t.metrics,l):E,e.resLineHeight=A}var k=A/w;e.distanceRange=w*t.data.distanceField.distanceRange;var I=24*u.length,C=e.vertexBuffer;(!C||C.length<I)&&(C=new Float32Array(2*I));var M=e.elementBounds;if(M.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),M.valid=!0),!a&&x.valid){var R=x.screen;if(d+R.x1<=M.x1&&d+R.x2>=M.x2&&c-b+R.y1<=M.y1&&c-b+R.y2>=M.y2)return void this.setStatus(e,"loaded");x.valid=!1,this.setStatus(e,"loading")}var _=e.props,P=_.offsetY,D=_.textAlign;if(!x.valid){if(!S(M,this.rendererBounds))return;Qo(x,d,c,b,A,"both"===h?M.y2-M.y1:0,M,w)}var L=function(e,t,n,r,i,a,o,s,u){var l=Math.min(Math.max(o.firstLineIdx,0),s.length),d=n.metrics;n.data;var c=(d.ascender-d.descender)*e,h=0;"middle"===r?h=(t-c)/2:"bottom"===r&&(h=t-c);var p=i/a,f=n.data.common.base,g=p+(d.ascender*e-f)+l*t+h;if(!(u&&g>=u/a))return{sdfX:0,sdfY:g,lineIndex:l}}(T,k,t,g,P,w,x,r,n);if(L){var N=e.props.letterSpacing,O=Jo(L.lineIndex,L.sdfX,L.sdfY,u,D,p,f,l,A,N,C,h,r,x.sdf,t,a,m,v,y);e.bufferUploaded=!1,e.bufferNumFloats=O.bufferNumFloats,e.bufferNumQuads=O.bufferNumQuads,e.vertexBuffer=C,e.renderWindow=x,i.lastLayoutNumCharacters=O.layoutNumCharacters,i.bufferSize=C.byteLength,O.fullyProcessed&&(e.textW=O.maxX*w,e.textH=O.numLines*k*w),this.setStatus(e,"loaded")}else this.setStatus(e,"loaded")}else t.once("loaded",()=>{this.scheduleUpdateState(e)})}renderQuads(e,t,n,r,i,a){var o,s;if(e.vertexBuffer){var u,l,d=this.stage.renderer,c=e.props,p=c.fontSize,f=c.color,g=c.contain,m=c.scrollable,v=c.zIndex,y=c.debug,b="both"===g&&m?e.props.scrollY:0,x=e.textW,T=void 0===x?0:x,w=e.textH,S=void 0===w?0:w,k=e.distanceRange,I=e.vertexBuffer,C=e.bufferUploaded,M=e.trFontFace,R=e.elementBounds,_=e.webGlBuffers;if(!_){var P=d.glw,D=4*Float32Array.BYTES_PER_ELEMENT,L=P.createBuffer();e.webGlBuffers=new Mt([{buffer:L,attributes:{a_position:{name:"a_position",size:2,type:P.FLOAT,normalized:!1,stride:D,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:P.FLOAT,normalized:!1,stride:D,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,e.webGlBuffers,_=e.webGlBuffers}if(!C){var N,O,U=d.glw,B=null!==(N=null===(O=_)||void 0===O?void 0:O.getBuffer("a_textureCoordinate"))&&void 0!==N?N:null;U.arrayBufferData(B,I,U.STATIC_DRAW),e.bufferUploaded=!0}if(m&&"both"===g){R.valid;var j=(u=R,(l=Zo)?(l.x=u.x1,l.y=u.y1,l.width=u.x2-u.x1,l.height=u.y2-u.y1,l):{x:u.x1,y:u.y1,width:u.x2-u.x1,height:u.y2-u.y1});n.valid?(e.clippingRect.valid=!0,n=A(n,j,e.clippingRect)):(e.clippingRect.valid=!0,n=E(j,e.clippingRect))}var F=new wt(d.glw,d.options,_,this.sdfShader,{transform:t.getFloatArr(),color:h(f,r),size:p/((null===(o=M.data)||void 0===o?void 0:o.info.size)||0),scrollY:b,distanceRange:k,debug:y.sdfShaderDebug},r,n,{height:S,width:T},0,v,!1,i,a),V=(null===(s=e.trFontFace)||void 0===s?void 0:s.texture).ctxTexture;F.addTexture(V),F.length=e.bufferNumFloats,F.numQuads=e.bufferNumQuads,d.addRenderOp(F)}}setIsRenderable(e,t){var n;super.setIsRenderable(e,t),null===(n=e.trFontFace)||void 0===n||n.texture.setRenderableOwner(e.props.fontFamily,t)}destroyState(e){var t;super.destroyState(e),null===(t=e.trFontFace)||void 0===t||t.texture.setRenderableOwner(e.props.fontFamily,!1)}resolveFontFace(e){return this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e,"sdf")}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e.props.fontFamily,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){var t=e.props,n=t.x,r=t.contain,i=t.width,a=e.elementBounds;a.x1=n,a.x2="none"!==r?n+i:1/0}setElementBoundsY(e){var t=e.props,n=t.y,r=t.contain,i=t.height,a=e.elementBounds;a.y1=n,a.y2="both"===r?n+i:1/0}}],renderEngine:class extends gt{constructor(e){super(e),s(this,"glw",void 0),s(this,"system",void 0),s(this,"quadBuffer",void 0),s(this,"fQuadBuffer",void 0),s(this,"uiQuadBuffer",void 0),s(this,"renderOps",[]),s(this,"curBufferIdx",0),s(this,"curRenderOp",null),s(this,"rttNodes",[]),s(this,"activeRttNode",null),s(this,"defShaderCtrl",void 0),s(this,"defaultShader",void 0),s(this,"quadBufferCollection",void 0),s(this,"clearColor",{raw:0,normalized:[0,0,0,0]}),s(this,"quadBufferUsage",0),s(this,"numQuadsRendered",0),s(this,"renderToTextureActive",!1),this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";var t=e.canvas,n=e.clearColor,r=e.bufferMemory,i=function(e,t=!1,n){var r={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},i=e.getContext(t?"webgl2":"webgl",r)||e.getContext("experimental-webgl",r);if(!i)throw new Error("Unable to create WebGL context");return n?new Proxy(i,{get(e,t){var r=e[t];return"function"==typeof r?(n.increment(String(t)),r.bind(e)):r}}):i}(t,e.forceWebGL2,e.contextSpy),a=this.glw=new Rt(i);a.viewport(0,0,t.width,t.height),this.updateClearColor(n),a.setBlend(!0),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),function(e,t){for(var n=~~(t/80),r=new Uint16Array(6*n),i=0,a=0;i<n;i+=6,a+=4)r[i]=a,r[i+1]=a+1,r[i+2]=a+2,r[i+3]=a+2,r[i+4]=a+1,r[i+5]=a+3;var o=e.createBuffer();e.elementArrayBufferData(o,r,e.STATIC_DRAW)}(a,r),this.system={parameters:St(this.glw),extensions:At(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;var o=a.createBuffer(),u=8*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new Mt([{buffer:o,attributes:{a_position:{name:"a_position",size:2,type:a.FLOAT,normalized:!1,stride:u,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:u,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:a.UNSIGNED_BYTE,normalized:!0,stride:u,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:a.FLOAT,normalized:!1,stride:u,offset:5*Float32Array.BYTES_PER_ELEMENT},a_nodeCoordinate:{name:"a_nodeCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:u,offset:6*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){var e=this.glw;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof we?new Ct(this.glw,this.txMemManager,e):e instanceof Se?new _t(this.glw,this.txMemManager,e):new It(this.glw,this.txMemManager,e)}addQuad(e){var t=this.fQuadBuffer,n=this.uiQuadBuffer,r=e.texture;if(e.shader!==this.defaultShader){if(1==g(e.shaderProps,"$dimensions")){var i=e.shaderProps.$dimensions;i.width=e.width,i.height=e.height}!0===g(e.shaderProps,"$alpha")&&(e.shaderProps.$alpha=e.alpha)}var a=this.curBufferIdx,o=(this.curRenderOp,{width:e.width,height:e.height});!1===this.reuseRenderOp(e)&&(this.newRenderOp(e.shader,e.shaderProps,e.alpha,o,e.clippingRect,a,e.rtt,e.parentHasRenderTexture,e.framebufferDimensions),this.curRenderOp);var s=void 0,u=0,l=0,d=1,c=1;if(r.type===m.subTexture){var h=r.props,p=h.x,f=h.y,v=h.width,y=h.height,b=r.parentTexture.dimensions||{width:0,height:0},x=b.width,T=void 0===x?0:x,w=b.height,S=void 0===w?0:w;d=(u=p/T)+v/T,c=(l=f/S)+y/S,s=(r=r.parentTexture).ctxTexture}else u=(s=r.ctxTexture).txCoordX1,l=s.txCoordY1,d=s.txCoordX2,c=s.txCoordY2;if(r.type===m.image&&null!==e.textureOptions&&void 0!==e.textureOptions.resizeMode&&null!==r.dimensions){var A=e.textureOptions.resizeMode,E=r.dimensions,k=E.width,I=E.height;if("cover"===A.type){var C=e.width/k,M=e.height/I,R=Math.max(C,M),_=1/R;if(R&&C&&C<R){var P,D=_*e.width;d=(u=(1-D/k)*(null!==(P=A.clipX)&&void 0!==P?P:.5))+D/k}if(R&&M&&M<R){var L,N=_*e.height;c=(l=(1-N/I)*(null!==(L=A.clipY)&&void 0!==L?L:.5))+N/I}}}var O=0;if(null!==e.textureOptions){if(!0===e.textureOptions.flipX){var U=[d,u];u=U[0],d=U[1]}O=+(e.textureOptions.flipY||!1)}if(O^+(r.type===m.renderToTexture)){var B=[c,l];l=B[0],c=B[1]}var j=this.addTexture(s,a);if(this.curRenderOp,e.renderCoords)t[a++]=e.renderCoords.x1,t[a++]=e.renderCoords.y1,t[a++]=u,t[a++]=l,n[a++]=e.colorTl,t[a++]=j,t[a++]=0,t[a++]=0,t[a++]=e.renderCoords.x2,t[a++]=e.renderCoords.y2,t[a++]=d,t[a++]=l,n[a++]=e.colorTr,t[a++]=j,t[a++]=1,t[a++]=0,t[a++]=e.renderCoords.x4,t[a++]=e.renderCoords.y4,t[a++]=u,t[a++]=c,n[a++]=e.colorBl,t[a++]=j,t[a++]=0,t[a++]=1,t[a++]=e.renderCoords.x3,t[a++]=e.renderCoords.y3,t[a++]=d,t[a++]=c,n[a++]=e.colorBr,t[a++]=j,t[a++]=1,t[a++]=1;else if(0!==e.tb||0!==e.tc)t[a++]=e.tx,t[a++]=e.ty,t[a++]=u,t[a++]=l,n[a++]=e.colorTl,t[a++]=j,t[a++]=0,t[a++]=0,t[a++]=e.tx+e.width*e.ta,t[a++]=e.ty+e.width*e.tc,t[a++]=d,t[a++]=l,n[a++]=e.colorTr,t[a++]=j,t[a++]=1,t[a++]=0,t[a++]=e.tx+e.height*e.tb,t[a++]=e.ty+e.height*e.td,t[a++]=u,t[a++]=c,n[a++]=e.colorBl,t[a++]=j,t[a++]=0,t[a++]=1,t[a++]=e.tx+e.width*e.ta+e.height*e.tb,t[a++]=e.ty+e.width*e.tc+e.height*e.td,t[a++]=d,t[a++]=c,n[a++]=e.colorBr,t[a++]=j,t[a++]=1,t[a++]=1;else{var F=e.tx+e.width*e.ta,V=e.ty+e.height*e.td;t[a++]=e.tx,t[a++]=e.ty,t[a++]=u,t[a++]=l,n[a++]=e.colorTl,t[a++]=j,t[a++]=0,t[a++]=0,t[a++]=F,t[a++]=e.ty,t[a++]=d,t[a++]=l,n[a++]=e.colorTr,t[a++]=j,t[a++]=1,t[a++]=0,t[a++]=e.tx,t[a++]=V,t[a++]=u,t[a++]=c,n[a++]=e.colorBl,t[a++]=j,t[a++]=0,t[a++]=1,t[a++]=F,t[a++]=V,t[a++]=d,t[a++]=c,n[a++]=e.colorBr,t[a++]=j,t[a++]=1,t[a++]=1}this.curRenderOp.numQuads++,this.curBufferIdx=a}newRenderOp(e,t,n,r,i,a,o,s,u){var l=new wt(this.glw,this.options,this.quadBufferCollection,e,t,n,i,r,a,0,o,s,u);this.curRenderOp=l,this.renderOps.push(l)}addTexture(e,t,n){var r=this.curRenderOp,i=r.addTexture(e);if(4294967295===i){if(n)throw new Error("Unable to add texture to render op");return this.newRenderOp(r.shader,r.shaderProps,r.alpha,r.dimensions,r.clippingRect,t),this.addTexture(e,t,!0)}return i}reuseRenderOp(e){var t,n,r,i=e.shader,a=e.shaderProps,o=e.parentHasRenderTexture,s=e.rtt,u=e.clippingRect;return(null===(t=this.curRenderOp)||void 0===t?void 0:t.shader)===i&&(!1!=((n=this.curRenderOp.clippingRect)===(r=u)||null!==n&&null!==r&&n.x===r.x&&n.y===r.y&&n.width===r.width&&n.height===r.height)&&(!0!==o&&!0!==s&&(this.curRenderOp.shader===this.defaultShader||!1!==this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,a))))}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){var t=this.glw,n=this.quadBuffer,r=new Float32Array(n,0,this.curBufferIdx),i=this.quadBufferCollection.getBuffer("a_position")||null;t.arrayBufferData(i,r,t.STATIC_DRAW);for(var a=0,o=this.renderOps.length;a<o;a++)this.renderOps[a].draw();this.quadBufferUsage=this.curBufferIdx*r.BYTES_PER_ELEMENT;var s=8*r.BYTES_PER_ELEMENT*4;this.numQuadsRendered=this.quadBufferUsage/s}getQuadCount(){return this.numQuadsRendered}renderToTexture(e){for(var t=0;t<this.rttNodes.length;t++)if(this.rttNodes[t]===e)return;this.insertRTTNodeInOrder(e)}insertRTTNodeInOrder(e){for(var t=this.rttNodes.length,n=e;n&&n.parent;){var r=this.rttNodes.indexOf(n.parent);if(-1!==r){t=r;break}n=n.parent}var i=this.findMaxChildRTTIndex(e);-1!==i&&(t=Math.max(t,i+1)),this.rttNodes.splice(t,0,e)}findMaxChildRTTIndex(e){var t=-1,n=e=>{var r=this.rttNodes.indexOf(e);-1!==r&&(t=Math.max(t,r));var i,a=u(e.children);try{for(a.s();!(i=a.n()).done;){var o=i.value;n(o)}}catch(s){a.e(s)}finally{a.f()}};return n(e),t}renderRTTNodes(){for(var e=this.glw,t=(this.stage.txManager,0);t<this.rttNodes.length;t++){var n=this.rttNodes[t];if(void 0!==n&&!1!==n.hasRTTupdates&&(0!==n.worldAlpha&&(!0!==n.strictBounds||n.renderState!==L.OutOfBounds)&&null!==n.texture&&"loaded"===n.texture.state)){this.activeRttNode=n,d(n.texture);var r=n.texture.ctxTexture;this.renderToTextureActive=!0,e.bindFramebuffer(r.framebuffer),e.viewport(0,0,r.w,r.h),e.clearColor(0,0,0,0),e.clear();for(var i=0;i<n.children.length;i++){var a=n.children[i];void 0!==a&&(this.stage.addQuads(a),a.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,n.hasRTTupdates=!1}}var o=this.clearColor.normalized;e.clearColor(o[0],o[1],o[2],o[3]),e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){var t=this.rttNodes.indexOf(e);-1!==t&&this.rttNodes.splice(t,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}updateClearColor(e){if(this.clearColor.raw!==e){var t=this.glw,n=T(e);t.clearColor(n[0],n[1],n[2],n[3]),this.clearColor={raw:e,normalized:n},t.clear()}}},inspector:void 0,deviceLogicalPixelRatio:1,devicePhysicalPixelRatio:1,boundsMargin:20,createImageBitmapSupport:"auto"}},keys:{Back:["b",66],Left:["ArrowLeft",37],Right:["ArrowRight",39],Up:["ArrowUp",38],Down:["ArrowDown",40],Enter:["Enter",13],Play:["p",80],Pause:["a",65],Menu:["m"],PlayPause:["t",84],FastForward:["f",70],FastForward10:["d",68],Rewind:["r",82],Rewind10:["e",69],Stop:["s",83],Key0:["0",96,48],Key1:["1",97,49],Key2:["2",98,50],Key3:["3",99,51],Key4:["4",100,52],Key5:["5",101,53],Key6:["6",102,54],Key7:["7",103,55],Key8:["8",104,56],Key9:["9",105,57]},keyHoldOptions:{userKeyHoldMap:{EnterHold:["Enter",13],BackHold:["b",66]},holdThreshold:1e3}},ss=new URLSearchParams(window.location.search).get("posterSize")||"w185",us={headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxODU4MjY0ZTM2ZWQ1NzZkYzM3ZDU5MjJmNzM3MWRmNiIsIm5iZiI6MTY2NzIzOTgzMS45MDIwMDAyLCJzdWIiOiI2MzYwMGY5NzFkYmM4ODAwOTBmNTIxMDAiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.LXx9-LdX9JsiY0DhpmjYcYitlqPJqntNHVv-HGZXpww"}};function ls(e,n={}){return fetch("https://api.themoviedb.org/3"+e,t(t({},us),n)).then(e=>e.json())}function ds(){return ls("/configuration").then(e=>{var t;return is=e,as=null===(t=e.images)||void 0===t?void 0:t.secure_base_url,e})}var cs={get:function(e,t={}){return is?ls(e,t):ds().then(()=>ls(e,t))},loadConfig:ds};function hs(){return(hs=o(r().m(function e(t){var n,i,a;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,cs.get("/discover/movie");case 1:return n=e.v,i=t?n.results.slice(0,5):n.results,e.a(2,i.map(e=>({title:e.title,poster_path:e.poster_path,overview:e.overview,backdrop_path:e.backdrop_path,id:e.id})));case 2:throw e.p=2,a=e.v,console.error(a),a;case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function ps(){return(ps=o(r().m(function e(t){var n,i,a;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,cs.get("/discover/tv");case 1:return n=e.v,i=t?n.results.slice(0,5):n.results,e.a(2,i.map(e=>({title:e.name,poster_path:e.poster_path,overview:e.overview,backdrop_path:e.backdrop_path,id:e.id})));case 2:throw e.p=2,a=e.v,console.error(a),a;case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function fs(){var e=[];return e.push({title:"MOVIES",items:$n(()=>function(e){return hs.apply(this,arguments)}(!0))[0]}),e.push({title:"SERIES",items:$n(()=>function(e){return ps.apply(this,arguments)}(!0))[0]}),{rows:e}}qo(Bt,os.lightning);var gs,ms=(gs=Bt.rendererOptions,Br=function(e,t="app"){return Ot=new yt(e,t)}(gs,"app"),Bt.setActiveElement=Pr,Vr.lng=Br.root,Vr.rendered=!0,Br.on("idle",()=>{Yr=!0,$r()}),{renderer:Br,rootNode:Vr,render:Hr}).render;!function(e){var n,r=u(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;"webgl"!==Ot.stage.renderer.mode||!("type"in i)||"msdf"!==i.type&&"ssdf"!==i.type?"fontUrl"in i&&Ot.stage.fontManager.addFontFace(new xt(i)):Ot.stage.fontManager.addFontFace(new Nt(i.type,t(t({},i),{},{stage:Ot.stage})))}}catch(a){r.e(a)}finally{r.f()}}(na),ms(()=>(((e,t)=>{var n=er(),r=tr.bind(void 0,n);Bt.setActiveElement=e=>r(()=>Pr(e));var i=cn({userKeyMap:e,keyHoldOptions:t,ownerContext:r}),a=i.cleanup,o=i.focusPath;qn(Qn(_r,()=>{Mi([...o()])},{defer:!0})),Zn(a)})(os.keys,os.keyHoldOptions),zr(Ji,{root:ta,get children(){return zr(Ei,{path:"/",get component(){return e=()=>l(()=>i.import("./index-legacy-WqNKeNDE.js"),0,i.meta.url),(a=i=>{var a,o=In.context;if(o){var s=n(Wn(),2),u=s[0],l=s[1];In.count||(In.count=0),In.count++,(r||(r=e())).then(e=>{!In.done&&Mn(o),In.count--,l(()=>e.default),Mn()}),t=u}else if(!t){var d=n($n(()=>(r||(r=e())).then(e=>e.default)),1)[0];t=d}return Yn(()=>(a=t())?Jn(()=>{if(!o||In.done)return a(i);var e=In.context;Mn(o);var t=a(i);return Mn(e),t}):"")}).preload=()=>r||((r=e()).then(e=>t=()=>e.default),r),a;var e,t,r,a},preload:fs})}})))}}})}();
