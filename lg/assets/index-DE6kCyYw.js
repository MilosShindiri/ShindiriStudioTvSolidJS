var xL=Object.defineProperty;var TL=(h,c,a)=>c in h?xL(h,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):h[c]=a;var _=(h,c,a)=>TL(h,typeof c!="symbol"?c+"":c,a);function xj(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))d(m);new MutationObserver(m=>{for(const T of m)if(T.type==="childList")for(const S of T.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&d(S)}).observe(document,{childList:!0,subtree:!0});function a(m){const T={};return m.integrity&&(T.integrity=m.integrity),m.referrerPolicy&&(T.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?T.credentials="include":m.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function d(m){if(m.ep)return;m.ep=!0;const T=a(m);fetch(m.href,T)}})();const wL="modulepreload",SL=function(h,c){return new URL(h,c).href},hE={},AL=function(c,a,d){let m=Promise.resolve();if(a&&a.length>0){let S=function(j){return Promise.all(j.map(P=>Promise.resolve(P).then(V=>({status:"fulfilled",value:V}),V=>({status:"rejected",reason:V}))))};const p=document.getElementsByTagName("link"),k=document.querySelector("meta[property=csp-nonce]"),L=(k==null?void 0:k.nonce)||(k==null?void 0:k.getAttribute("nonce"));m=S(a.map(j=>{if(j=SL(j,d),j in hE)return;hE[j]=!0;const P=j.endsWith(".css"),V=P?'[rel="stylesheet"]':"";if(!!d)for(let ee=p.length-1;ee>=0;ee--){const ue=p[ee];if(ue.href===j&&(!P||ue.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(j,'"]').concat(V)))return;const q=document.createElement("link");if(q.rel=P?"stylesheet":wL,P||(q.as="script"),q.crossOrigin="",q.href=j,L&&q.setAttribute("nonce",L),document.head.appendChild(q),P)return new Promise((ee,ue)=>{q.addEventListener("load",ee),q.addEventListener("error",()=>ue(new Error("Unable to preload CSS for ".concat(j))))})}))}function T(S){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=S,window.dispatchEvent(p),!p.defaultPrevented)throw S}return m.then(S=>{for(const p of S||[])p.status==="rejected"&&T(p.reason);return c().catch(T)})};function EL(h,c=!1,a){const d={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},m=h.getContext(c?"webgl2":"webgl",d)||h.getContext("experimental-webgl",d);if(!m)throw new Error("Unable to create WebGL context");return a?new Proxy(m,{get(T,S){const p=T[S];return typeof p=="function"?(a.increment(String(S)),p.bind(T)):p}}):m}function ky(h,c,a){const d=Math.trunc(h>>>24),m=Math.trunc(h>>>16&255),T=Math.trunc(h>>>8&255),S=Math.trunc(h&255),p=Math.trunc(c>>>24),k=Math.trunc(c>>>16&255),L=Math.trunc(c>>>8&255),j=Math.trunc(c&255),P=Math.round(p*a+d*(1-a)),V=Math.round(k*a+m*(1-a)),K=Math.round(L*a+T*(1-a)),q=Math.round(j*a+S*(1-a));return(P<<24|V<<16|K<<8|q)>>>0}function IL(h,c){const a=h>>>24,d=h>>>16&255,m=h>>>8&255,T=Math.trunc((h&255)*c);return(a<<24|d<<16|m<<8|T)>>>0}let uI=!0;function CL(h){uI=h==="webgl"}function Af(h,c,a=!1){const d=(h&255)/255*c,m=uI?d:1,T=Math.trunc((h>>>24)*m),S=Math.trunc((h>>>16&255)*m),p=Math.trunc((h>>>8&255)*m),k=Math.trunc(d*255);return a?(k<<24|p<<16|S<<8|T)>>>0:(T<<24|S<<16|p<<8|k)>>>0}function Gf(h,c){return Object.prototype.hasOwnProperty.call(h,c)}const ML=!0;let RL=1;function kL(){return RL++}class xs{constructor(){_(this,"eventListeners",{})}on(c,a){let d=this.eventListeners[c];d||(d=[]),d.push(a),this.eventListeners[c]=d}off(c,a){const d=this.eventListeners[c];if(!d)return;if(!a){delete this.eventListeners[c];return}const m=d.indexOf(a);m>=0&&d.splice(m,1)}once(c,a){const d=(m,T)=>{this.off(c,d),a(m,T)};this.on(c,d)}emit(c,a){const d=this.eventListeners[c];d&&[...d].forEach(m=>{m(this,a)})}removeAllListeners(){this.eventListeners={}}}var Hn;(function(h){h[h.generic=0]="generic",h[h.color=1]="color",h[h.image=2]="image",h[h.noise=3]="noise",h[h.renderToTexture=4]="renderToTexture",h[h.subTexture=5]="subTexture"})(Hn||(Hn={}));const th=class th extends xs{constructor(a){super();_(this,"txManager");_(this,"_dimensions",null);_(this,"_error",null);_(this,"state","initial");_(this,"renderableOwners",[]);_(this,"renderable",!1);_(this,"type",Hn.generic);_(this,"preventCleanup",!1);_(this,"ctxTexture");_(this,"textureData",null);_(this,"memUsed",0);_(this,"retryCount",0);_(this,"maxRetryCount");_(this,"createdAt",Date.now());_(this,"gracePeriodExpired",!1);this.txManager=a,this.maxRetryCount=a.maxRetryCount}get dimensions(){return this._dimensions}get error(){return this._error}isWithinStartupGracePeriod(){return this.gracePeriodExpired?!1:Date.now()-this.createdAt>=th.STARTUP_GRACE_PERIOD?(this.gracePeriodExpired=!0,!1):!0}canBeCleanedUp(){return!(this.preventCleanup||this.isWithinStartupGracePeriod()||this.renderable===!0||this.renderableOwners.length>0)}setRenderableOwner(a,d){var S,p;const m=this.renderableOwners.length,T=this.renderableOwners.indexOf(a);if(d===!0){T===-1&&this.renderableOwners.push(a);const k=this.renderableOwners.length;m!==k&&k===1&&(this.renderable=!0,(S=this.onChangeIsRenderable)==null||S.call(this,!0),this.load())}else{T!==-1&&this.renderableOwners.splice(T,1);const k=this.renderableOwners.length;m!==k&&k===0&&(this.renderable=!1,(p=this.onChangeIsRenderable)==null||p.call(this,!1))}}load(){this.retryCount>this.maxRetryCount||this.txManager.loadTexture(this)}loadCtxTexture(){return this.ctxTexture===void 0&&(this.ctxTexture=this.txManager.renderer.createCtxTexture(this)),this.ctxTexture}free(){var a;(a=this.ctxTexture)==null||a.free()}release(){var a;(a=this.ctxTexture)==null||a.release(),this.ctxTexture=void 0,this.freeTextureData()}destroy(){this.state==="loaded"&&this.free(),this.freeTextureData()}freeTextureData(){queueMicrotask(()=>{this.textureData=null})}setState(a,d){if(this.state===a)return;let m=null;a==="loaded"?(this._error=null,d!==void 0&&"width"in d&&"height"in d&&d.width!==void 0&&d.height!==void 0&&(this._dimensions=d),m=this._dimensions):a==="failed"?(this._error=d,m=this._error,this.retryCount+=1,queueMicrotask(()=>{this.release()})):a==="loading"?(this._error=null,this._dimensions=null):this._error=null,this.state=a,this.emit(a,m)}async getTextureData(){return this.textureData===null&&(this.textureData=await this.getTextureSource()),this.textureData}static makeCacheKey(a){return!1}static resolveDefaults(a){return{}}retry(){this.release(),this.retryCount=0,this.load()}};_(th,"STARTUP_GRACE_PERIOD",2e3);let Zs=th;const _L=/^(data|ftps?|https?):/,ih=h=>{const c=h>>>24,a=h>>>16&255,d=h>>>8&255,m=h&255;return[c/255,a/255,d/255,m/255]};function wa(h,c,a,d,m){return m?(m.x1=h,m.y1=c,m.x2=a,m.y2=d,m):{x1:h,y1:c,x2:a,y2:d}}function cy(h,c){return h.x1<c.x2&&h.x2>c.x1&&h.y1<c.y2&&h.y2>c.y1}function PL(h,c){return c?(c.x=h.x1,c.y=h.y1,c.width=h.x2-h.x1,c.height=h.y2-h.y1,c):{x:h.x1,y:h.y1,width:h.x2-h.x1,height:h.y2-h.y1}}function lI(h,c,a){const d=Math.max(h.x,c.x),m=Math.max(h.y,c.y),T=Math.min(h.x+h.width,c.x+c.width)-d,S=Math.min(h.y+h.height,c.y+c.height)-m;return T>0&&S>0?a?(a.x=d,a.y=m,a.width=T,a.height=S,a):{x:d,y:m,width:T,height:S}:a?(a.x=0,a.y=0,a.width=0,a.height=0,a):{x:0,y:0,width:0,height:0}}function cI(h,c){return c?(c.x=h.x,c.y=h.y,c.width=h.width,c.height=h.height,c):{x:h.x,y:h.y,width:h.width,height:h.height}}function DL(h,c){return h===c?!0:h===null||c===null?!1:h.x===c.x&&h.y===c.y&&h.width===c.width&&h.height===c.height}function dy(h,c){return h.x1<=c.x2&&h.y1<=c.y2&&h.x2>=c.x1&&h.y2>=c.y1}function LL(h,c){return h.x1<c.x1&&h.x2>c.x2&&h.y1<c.y1&&h.y2>c.y2}function bL(h,c,a){return!(h<a.x1||h>a.x2||c<a.y1||c>a.y2)}function NL(h){return h.x1<h.x2&&h.y1<h.y2}function _y(h,c){return wa(h.x1-c[3],h.y1-c[0],h.x2+c[1],h.y2+c[2])}function OL(h){if(self.location.protocol==="file:"&&!_L.test(h)){const a=self.location.pathname.split("/");a.pop();const d=a.join("/"),m=self.location.protocol+"//"+d;return h.charAt(0)==="."&&(h=h.slice(1)),h.charAt(0)==="/"&&(h=h.slice(1)),m+"/"+h}return new URL(h,self.location.href).href}function fy(h){return h.startsWith("data:")===!0}function UL(h){var k,L;h=h.replace(/^data:/,"");const c=((k=h.match(/image\/[^;]+/))==null?void 0:k[0])||"",a=h.replace(/^[^,]+,/,""),d=1024,m=atob(a),T=m.length,S=Math.ceil(T/d),p=new Array(S);for(let j=0;j<S;++j){const P=j*d,V=Math.min(P+d,T),K=new Array(V-P);for(let q=P,ee=0;q<V;++ee,++q)K[ee]=(L=m[q])==null?void 0:L.charCodeAt(0);p[j]=new Uint8Array(K)}return new Blob(p,{type:c})}class gn{constructor(){_(this,"ta");_(this,"tb");_(this,"tx");_(this,"tc");_(this,"td");_(this,"ty");_(this,"_floatArr",null);_(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return jL}static multiply(c,a,d){const m=c.ta*a.ta+c.tb*a.tc,T=c.ta*a.tb+c.tb*a.td,S=c.ta*a.tx+c.tb*a.ty+c.tx,p=c.tc*a.ta+c.td*a.tc,k=c.tc*a.tb+c.td*a.td,L=c.tc*a.tx+c.td*a.ty+c.ty;return d||(d=new gn),d.ta=m,d.tb=T,d.tx=S,d.tc=p,d.td=k,d.ty=L,d.mutation=!0,d}static identity(c){return c||(c=new gn),c.ta=1,c.tb=0,c.tx=0,c.tc=0,c.td=1,c.ty=0,c.mutation=!0,c}static translate(c,a,d){return d||(d=new gn),d.ta=1,d.tb=0,d.tx=c,d.tc=0,d.td=1,d.ty=a,d.mutation=!0,d}static scale(c,a,d){return d||(d=new gn),d.ta=c,d.tb=0,d.tx=0,d.tc=0,d.td=a,d.ty=0,d.mutation=!0,d}static rotate(c,a){const d=Math.cos(c),m=Math.sin(c);return a||(a=new gn),a.ta=d,a.tb=-m,a.tx=0,a.tc=m,a.td=d,a.ty=0,a.mutation=!0,a}static copy(c,a){return a||(a=new gn),a.ta=c.ta,a.tc=c.tc,a.tb=c.tb,a.td=c.td,a.tx=c.tx,a.ty=c.ty,a.mutation=!0,a}translate(c,a){return this.tx=this.ta*c+this.tb*a+this.tx,this.ty=this.tc*c+this.td*a+this.ty,this.mutation=!0,this}scale(c,a){return this.ta=this.ta*c,this.tb=this.tb*a,this.tc=this.tc*c,this.td=this.td*a,this.mutation=!0,this}rotate(c){if(c===0||!(c%Math.PI*2))return this;const a=Math.cos(c),d=Math.sin(c),m=this.ta*a+this.tb*d,T=this.tb*a-this.ta*d,S=this.tc*a+this.td*d,p=this.td*a-this.tc*d;return this.ta=m,this.tb=T,this.tc=S,this.td=p,this.mutation=!0,this}multiply(c){return gn.multiply(this,c,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const jL=new gn,Ef=0,If=2,Cf=4,Mf=6,Rf=1,kf=3,_f=5,Pf=7;class Sa{constructor(c){_(this,"data");this.data=new Float32Array(8),c&&(this.data[Ef]=c[Ef],this.data[If]=c[If],this.data[Cf]=c[Cf],this.data[Mf]=c[Mf],this.data[Rf]=c[Rf],this.data[kf]=c[kf],this.data[_f]=c[_f],this.data[Pf]=c[Pf])}static translate(c,a,d,m,T,S,p,k,L){return L||(L=new Sa),L.data[Ef]=c,L.data[If]=d,L.data[Cf]=T,L.data[Mf]=p,L.data[Rf]=a,L.data[kf]=m,L.data[_f]=S,L.data[Pf]=k,L}get x1(){return this.data[Ef]}get x2(){return this.data[If]}get x3(){return this.data[Cf]}get x4(){return this.data[Mf]}get y1(){return this.data[Rf]}get y2(){return this.data[kf]}get y3(){return this.data[_f]}get y4(){return this.data[Pf]}}const dI=(h,c,a,d)=>{const m=3*h,T=3*(a-h)-m,S=1-m-T,p=3*c,k=3*(d-c)-p,L=1-p-k;return function(j){if(j>=1)return 1;if(j<=0)return 0;let P=.5,V,K,q;for(let fe=0;fe<20;fe++){if(V=P*(P*(P*S+T)+m),q=j-V,q>-1e-8&&q<1e-8)return P*(P*(P*L+k)+p);if(K=P*(P*(3*S)+2*T)+m,K>1e-10&&K<1e-10)break;P+=q/K}let ee=0,ue=1;for(let fe=0;fe<20;fe++){if(P=.5*(ee+ue),V=P*(P*(P*S+T)+m),q=j-V,q>-1e-8&&q<1e-8)return P*(P*(P*L+k)+p);q<0?ue=P:ee=P}}},Of={},BL={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},Uf=h=>h,FL=h=>{const c=/-?\d*\.?\d+/g,a=h.match(c);if(a){const[d,m,T,S]=a,p=parseFloat(d||"0.42"),k=parseFloat(m||"0"),L=parseFloat(T||"1"),j=parseFloat(S||"1"),P=dI(p,k,L,j);return Of[h]=P,P}return console.warn("Unknown cubic-bezier timing: "+h),Uf},fI=h=>{if(h==="linear")return Uf;if(Of[h]!==void 0)return Of[h]||Uf;if(h==="step-start")return()=>1;if(h==="step-end")return a=>a===1?1:0;const c=BL[h];if(c!==void 0){const[a,d,m,T]=c,S=dI(a,d,m,T);return Of[h]=S,S}return h.startsWith("cubic-bezier")?FL(h):(console.warn("Unknown timing function: "+h),Uf)};function pE(h){return(h/1024/1024).toFixed(2)}class VL extends xs{constructor(a,d,m){var p,k,L,j,P,V;super();_(this,"node");_(this,"props");_(this,"settings");_(this,"progress",0);_(this,"delayFor",0);_(this,"delay",0);_(this,"timingFunction");_(this,"propValuesMap",{});_(this,"dynPropValuesMap");this.node=a,this.props=d;for(const K in d)if(K!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[K]={start:a[K]||0,target:d[K]};else if(a.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const q in d.shaderProps)this.propValuesMap.shaderProps[q]={start:a.shader.props[q],target:d.shaderProps[q]}}else{const q=Object.keys(d.shaderProps),ee=q.length;this.dynPropValuesMap={};for(let ue=0;ue<ee;ue++){const fe=q[ue],J=d.shaderProps[fe];this.dynPropValuesMap[fe]={};const oe=Object.entries(J),x=oe.length;for(let Y=0;Y<x;Y++){const[me,pe]=oe[Y];this.dynPropValuesMap[fe][me]={start:a.shader.props[fe][me],target:pe}}}}const T=m.easing||"linear",S=(p=m.delay)!=null?p:0;this.settings={duration:(k=m.duration)!=null?k:0,delay:S,easing:T,loop:(L=m.loop)!=null?L:!1,repeat:(j=m.repeat)!=null?j:0,repeatDelay:(P=m.repeatDelay)!=null?P:0,stopMethod:(V=m.stopMethod)!=null?V:!1},this.timingFunction=fI(T),this.delayFor=S,this.delay=S}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(a,d){const m=Object.entries(d),T=m.length;for(let S=0;S<T;S++){const[p,k]=m[S];a[p]=k.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const a=Object.keys(this.dynPropValuesMap),d=a.length;if(d>0)for(let m=0;m<d;m++){const T=a[m];this.restoreValues(this.node.shader.props[T],this.dynPropValuesMap[T])}}}reverseValues(a){const d=Object.entries(a),m=d.length;for(let T=0;T<m;T++){const[S,p]=d[T];a[S]={start:p.target,target:p.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const a=Object.keys(this.dynPropValuesMap),d=a.length;if(d>0)for(let m=0;m<d;m++){const T=a[m];this.reverseValues(this.dynPropValuesMap[T])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(a,d,m){return(this.timingFunction(a)||a)*(m-d)+d}updateValue(a,d,m,T){if(this.progress===1)return d;if(this.progress===0)return m;const S=d;if(a.indexOf("color")!==-1){if(m===S)return m;if(T){const p=this.timingFunction(this.progress)||this.progress;return ky(m,S,p)}return ky(m,S,this.progress)}return T?this.applyEasing(this.progress,m,S):m+(S-m)*this.progress}updateValues(a,d,m){const T=Object.entries(d),S=T.length;for(let p=0;p<S;p++){const[k,L]=T[p];a[k]=this.updateValue(k,L.target,L.start,m)}}update(a){const{duration:d,loop:m,easing:T,stopMethod:S}=this.settings,{delayFor:p}=this;if(this.node.destroyed){this.emit("destroyed",{});return}if(d===0&&p===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=a,this.delayFor>=0)return;a=-this.delayFor,this.delayFor=0}if(d===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=a/d,this.progress>1&&(this.progress=m?0:1,this.delayFor=this.delay,S)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,T),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,T),this.dynPropValuesMap!==void 0){const k=Object.keys(this.dynPropValuesMap),L=k.length;if(L>0)for(let j=0;j<L;j++){const P=k[j];this.updateValues(this.node.shader.props[P],this.dynPropValuesMap[P],T)}}this.progress<1&&this.emit("tick",{progress:this.progress}),this.progress===1&&this.emit("finished",{})}}class HL extends xs{constructor(a,d){super();_(this,"manager");_(this,"animation");_(this,"stoppedPromise");_(this,"stoppedResolve",null);_(this,"state");this.manager=a,this.animation=d,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this),this.onTick=this.onTick.bind(this),this.onDestroy=this.onDestroy.bind(this)}start(){return this.state!=="running"&&this.state!=="scheduled"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="scheduled"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.animation.on("tick",this.onTick),this.animation.on("destroyed",this.onDestroy),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating),this.animation.off("tick",this.onTick),this.animation.off("destroy",this.onDestroy)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(a=>{this.stoppedResolve=a}))}onDestroy(){this.unregisterAnimation(),this.state="stopped"}onFinished(){const{loop:a,stopMethod:d}=this.animation.settings;if(d==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}a||(this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.emit("stopped",this),this.state="stopped")}onAnimating(){this.state="running",this.emit("animating",this)}onTick(a,d){this.emit("tick",d)}}var wn;(function(h){h[h.Init=0]="Init",h[h.OutOfBounds=2]="OutOfBounds",h[h.InBounds=4]="InBounds",h[h.InViewport=8]="InViewport"})(wn||(wn={}));const _l=new Map;_l.set(wn.Init,"init");_l.set(wn.OutOfBounds,"outOfBounds");_l.set(wn.InBounds,"inBounds");_l.set(wn.InViewport,"inViewport");var he;(function(h){h[h.Children=1]="Children",h[h.ScaleRotate=2]="ScaleRotate",h[h.Local=4]="Local",h[h.Global=8]="Global",h[h.Clipping=16]="Clipping",h[h.CalculatedZIndex=32]="CalculatedZIndex",h[h.ZIndexSortedChildren=64]="ZIndexSortedChildren",h[h.PremultipliedColors=128]="PremultipliedColors",h[h.WorldAlpha=256]="WorldAlpha",h[h.RenderState=512]="RenderState",h[h.IsRenderable=1024]="IsRenderable",h[h.RenderTexture=2048]="RenderTexture",h[h.ParentRenderTexture=4096]="ParentRenderTexture",h[h.RenderBounds=8192]="RenderBounds",h[h.None=0]="None",h[h.All=14335]="All"})(he||(he={}));class Py extends xs{constructor(a,d){super();_(this,"stage");_(this,"children",[]);_(this,"_id",kL());_(this,"props");_(this,"updateType",he.All);_(this,"childUpdateType",he.None);_(this,"globalTransform");_(this,"scaleRotateTransform");_(this,"localTransform");_(this,"sceneGlobalTransform");_(this,"renderCoords");_(this,"sceneRenderCoords");_(this,"renderBound");_(this,"strictBound");_(this,"preloadBound");_(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});_(this,"isRenderable",!1);_(this,"renderState",wn.Init);_(this,"worldAlpha",1);_(this,"premultipliedColorTl",0);_(this,"premultipliedColorTr",0);_(this,"premultipliedColorBl",0);_(this,"premultipliedColorBr",0);_(this,"calcZIndex",0);_(this,"hasRTTupdates",!1);_(this,"parentHasRenderTexture",!1);_(this,"rttParent",null);_(this,"destroyed",!1);_(this,"onTextureLoaded",(a,d)=>{var m,T;this.autosizeNode(d),this.setUpdateType(he.IsRenderable),this.stage.requestRender(),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),d.width>1&&d.height>1&&this.emit("loaded",{type:"texture",dimensions:d}),((T=(m=this.props.textureOptions)==null?void 0:m.resizeMode)==null?void 0:T.type)==="contain"&&this.setUpdateType(he.Local)});_(this,"onTextureFailed",(a,d)=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(he.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.texture!==null&&this.texture.retryCount>this.texture.maxRetryCount&&this.emit("failed",{type:"texture",error:d})});_(this,"onTextureFreed",()=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(he.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.emit("freed",{type:"texture"})});this.stage=a,this.props={...d,parent:null,texture:null,src:null,rtt:!1},this.parent=d.parent,this.texture=d.texture,this.src=d.src,this.rtt=d.rtt,this.interactive=d.interactive,d.boundsMargin&&(this.boundsMargin=Array.isArray(d.boundsMargin)?d.boundsMargin:[d.boundsMargin,d.boundsMargin,d.boundsMargin,d.boundsMargin]),this.setUpdateType(he.ScaleRotate|he.Local|he.RenderBounds|he.RenderState),this.stage.defaultTexture&&this.stage.defaultTexture.state!=="loaded"&&this.stage.defaultTexture.once("loaded",()=>{this.setUpdateType(he.IsRenderable)})}loadTexture(){const{texture:a}=this.props;queueMicrotask(()=>{var d,m;if(this.textureOptions.preload===!0&&this.stage.txManager.loadTexture(a),a.preventCleanup=(m=(d=this.props.textureOptions)==null?void 0:d.preventCleanup)!=null?m:!1,a.on("loaded",this.onTextureLoaded),a.on("failed",this.onTextureFailed),a.on("freed",this.onTextureFreed),a.state==="loaded"?(a.dimensions,this.onTextureLoaded(a,a.dimensions)):a.state==="failed"?(a.error,this.onTextureFailed(a,a.error)):a.state==="freed"&&this.onTextureFreed(a),this.parentHasRenderTexture){this.notifyParentRTTOfUpdate();return}})}unloadTexture(){this.texture!==null&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this._id,!1))}autosizeNode(a){this.autosize&&(this.width=a.width,this.height=a.height)}setUpdateType(a){this.updateType|=a;const d=this.props.parent;d&&(d.updateType&he.Children)===0&&d.setUpdateType(he.Children)}sortChildren(){this.children.sort((a,d)=>a.calcZIndex-d.calcZIndex)}updateScaleRotateTransform(){const{rotation:a,scaleX:d,scaleY:m}=this.props;if(a===0&&d===1&&m===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=gn.rotate(a,this.scaleRotateTransform).scale(d,m)}updateLocalTransform(){var L,j;const{x:a,y:d,width:m,height:T}=this.props,S=this.props.mountX*m,p=this.props.mountY*T;if(this.scaleRotateTransform){const P=this.props.pivotX*m,V=this.props.pivotY*T;this.localTransform=gn.translate(a-S+P,d-p+V,this.localTransform).multiply(this.scaleRotateTransform).translate(-P,-V)}else this.localTransform=gn.translate(a-S,d-p,this.localTransform);const k=this.props.texture;if(k&&k.dimensions&&((j=(L=this.props.textureOptions)==null?void 0:L.resizeMode)==null?void 0:j.type)==="contain"){let P=1,V=1,K=0,q=0;const{width:ee,height:ue}=k.dimensions,fe=ee/ue,J=m/T;if(fe>J){const oe=m/ee,x=ue*oe;q=(T-x)/2,V=x/T}else{const oe=T/ue,x=ee*oe;K=(m-x)/2,P=x/m}this.localTransform.translate(K,q).scale(P,V)}this.setUpdateType(he.Global)}update(a,d){this.updateType&he.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(he.Local)),this.updateType&he.Local&&(this.updateLocalTransform(),this.setUpdateType(he.Global));const m=this.props.parent;let T=null;if(this.updateType&he.RenderTexture&&this.rtt&&(this.hasRTTupdates=!0),this.updateType&he.Global&&(this.localTransform,this.parentHasRenderTexture===!0&&(m==null?void 0:m.rtt)===!0?(this.globalTransform=gn.identity(),this.sceneGlobalTransform=gn.copy((m==null?void 0:m.globalTransform)||gn.identity()).multiply(this.localTransform)):this.parentHasRenderTexture===!0&&(m==null?void 0:m.rtt)===!1?(this.sceneGlobalTransform=gn.copy((m==null?void 0:m.sceneGlobalTransform)||this.localTransform).multiply(this.localTransform),this.globalTransform=gn.copy((m==null?void 0:m.globalTransform)||this.localTransform,this.globalTransform)):this.globalTransform=gn.copy((m==null?void 0:m.globalTransform)||this.localTransform,this.globalTransform),m!==null&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(he.RenderState|he.Children),this.childUpdateType|=he.Global,this.clipping===!0&&(this.setUpdateType(he.Clipping|he.RenderBounds),this.childUpdateType|=he.RenderBounds)),this.updateType&he.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(he.RenderState),this.setUpdateType(he.Children),this.childUpdateType|=he.RenderBounds),this.updateType&he.RenderState&&(T=this.checkRenderBounds(),this.setUpdateType(he.IsRenderable),T!==wn.OutOfBounds&&this.updateRenderState(T)),this.updateType&he.WorldAlpha&&(m?this.worldAlpha=m.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(he.Children|he.PremultipliedColors|he.IsRenderable),this.childUpdateType|=he.WorldAlpha),this.updateType&he.IsRenderable&&this.updateIsRenderable(),this.updateType&he.Clipping&&(this.calculateClippingRect(d),this.setUpdateType(he.Children),this.childUpdateType|=he.Clipping,this.childUpdateType|=he.RenderBounds),this.updateType&he.PremultipliedColors&&(this.premultipliedColorTl=Af(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Af(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Af(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Af(this.props.colorBr,this.worldAlpha,!0))),m!==null&&this.updateType&he.CalculatedZIndex&&(this.calculateZIndex(),m.setUpdateType(he.ZIndexSortedChildren)),this.props.strictBounds===!0&&this.renderState===wn.OutOfBounds){this.updateType&=~he.RenderBounds;return}if(this.updateType&he.Children&&this.children.length>0)for(let S=0,p=this.children.length;S<p;S++){const k=this.children[S];if(k.setUpdateType(this.childUpdateType),k.updateType===0)continue;let L=this.clippingRect;this.rtt===!0&&(L={x:0,y:0,width:0,height:0,valid:!1}),k.update(a,L)}this.parentHasRenderTexture&&this.updateType>0&&this.notifyParentRTTOfUpdate(),this.updateType&he.ZIndexSortedChildren&&this.sortChildren(),T===wn.OutOfBounds&&(this.updateRenderState(T),this.updateIsRenderable(),this.rtt===!0&&T===wn.OutOfBounds&&this.notifyChildrenRTTOfUpdate(T)),this.updateType=0,this.childUpdateType=0}findParentRTTNode(){let a=this.parent;for(;a&&!a.rtt;)a=a.parent;return a}getRTTParentRenderState(){const a=this.rttParent||this.findParentRTTNode();return a?a.renderState:null}notifyChildrenRTTOfUpdate(a){for(const d of this.children)d.updateRenderState(a),d.updateIsRenderable(),d.notifyChildrenRTTOfUpdate(a)}notifyParentRTTOfUpdate(){if(this.parent===null)return;const a=this.rttParent||this.findParentRTTNode();a&&(a.hasRTTupdates=!0,a.setUpdateType(he.RenderTexture),a.parentHasRenderTexture===!0&&a.notifyParentRTTOfUpdate())}checkRenderBounds(){return this.renderBound,this.strictBound,this.preloadBound,dy(this.renderBound,this.strictBound)?wn.InViewport:dy(this.renderBound,this.preloadBound)?wn.InBounds:LL(this.renderBound,this.strictBound)?wn.InViewport:this.parent!==null&&(this.props.width===0||this.props.height===0)?this.parent.renderState:wn.OutOfBounds}updateBoundingRect(){const a=this.sceneGlobalTransform||this.globalTransform,d=this.sceneRenderCoords||this.renderCoords,{tb:m,tc:T}=a,{x1:S,y1:p,x3:k,y3:L}=d;if(m===0||T===0)this.renderBound=wa(S,p,k,L,this.renderBound);else{const{x2:j,x4:P,y2:V,y4:K}=d;this.renderBound=wa(Math.min(S,j,k,P),Math.min(p,V,L,K),Math.max(S,j,k,P),Math.max(p,V,L,K),this.renderBound)}}createRenderBounds(){if(this.stage,this.parent!==null&&this.parent.strictBound!==void 0){const j=this.parent.strictBound;this.strictBound=wa(j.x1,j.y1,j.x2,j.y2),this.preloadBound=_y(this.strictBound,this.boundsMargin)}else this.strictBound=this.stage.strictBound,this.preloadBound=this.stage.preloadBound;if(this.props.clipping===!1||this.renderBound===void 0||dy(this.renderBound,this.strictBound)===!1)return;const{x:a,y:d,width:m,height:T}=this.props,{tx:S,ty:p}=this.sceneGlobalTransform||this.globalTransform||{},k=S!=null?S:a,L=p!=null?p:d;this.strictBound=wa(k,L,k+m,L+T,this.strictBound),this.preloadBound=_y(this.strictBound,this.boundsMargin)}updateRenderState(a){if(a===this.renderState)return;const d=this.renderState;this.renderState=a;const m=_l.get(a);this.emit(m,{previous:d,current:a})}updateIsRenderable(){let a=!1,d=!1;if(this.checkBasicRenderability()===!1){this.updateTextureOwnership(!1),this.setRenderable(!1);return}if(this.texture!==null){if(this.texture.retryCount>this.texture.maxRetryCount){this.updateTextureOwnership(!1),this.setRenderable(!1);return}d=!0,a=this.texture.state==="loaded"}else(this.hasShader()||this.hasColorProperties()===!0)&&this.hasDimensions()===!0&&this.stage.defaultTexture&&this.stage.defaultTexture.state==="loaded"&&(a=!0);this.updateTextureOwnership(d),this.setRenderable(a)}checkBasicRenderability(){return!(this.worldAlpha===0||this.isOutOfBounds()===!0)}setRenderable(a){this.isRenderable=a}updateTextureOwnership(a){var d;(d=this.texture)==null||d.setRenderableOwner(this._id,a)}isOutOfBounds(){return this.renderState<=wn.OutOfBounds}hasDimensions(){return this.props.width!==0&&this.props.height!==0}hasColorProperties(){return this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0}hasShader(){return this.props.shader!==null}calculateRenderCoords(){const{width:a,height:d}=this,{tx:m,ty:T,ta:S,tb:p,tc:k,td:L}=this.globalTransform;if(p===0&&k===0){const ue=m,fe=m+a*S,J=T,oe=T+d*L;this.renderCoords=Sa.translate(ue,J,fe,J,fe,oe,ue,oe,this.renderCoords)}else this.renderCoords=Sa.translate(m,T,m+a*S,T+a*k,m+a*S+d*p,T+a*k+d*L,m+d*p,T+d*L,this.renderCoords);if(this.sceneGlobalTransform===void 0)return;const{tx:j,ty:P,ta:V,tb:K,tc:q,td:ee}=this.sceneGlobalTransform;if(K===0&&q===0){const ue=j,fe=j+a*V,J=P,oe=P+d*ee;this.sceneRenderCoords=Sa.translate(ue,J,fe,J,fe,oe,ue,oe,this.sceneRenderCoords)}else this.sceneRenderCoords=Sa.translate(j,P,j+a*V,P+a*q,j+a*V+d*K,P+a*q+d*ee,j+d*K,P+d*ee,this.sceneRenderCoords)}calculateClippingRect(a){this.globalTransform;const{clippingRect:d,props:m,globalTransform:T}=this,{clipping:S}=m,p=T.tb!==0||T.tc!==0;S===!0&&p===!1?(d.x=T.tx,d.y=T.ty,d.width=this.width*T.ta,d.height=this.height*T.td,d.valid=!0):d.valid=!1,a.valid===!0&&d.valid===!0?lI(a,d,d):a.valid===!0&&(cI(a,d),d.valid=!0)}calculateZIndex(){var S,p;const a=this.props,d=a.zIndex||0,m=((S=a.parent)==null?void 0:S.zIndex)||0;let T=d;(p=a.parent)!=null&&p.zIndexLocked&&(T=d<m?d:m),this.calcZIndex=T}destroy(){var a;if(this.destroyed!==!0){for(this.destroyed=!0,this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,this.renderCoords=void 0,this.renderBound=void 0,this.strictBound=void 0,this.preloadBound=void 0,this.globalTransform=void 0,this.scaleRotateTransform=void 0,this.localTransform=void 0,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;this.children.length>0;)(a=this.children[0])==null||a.destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}}renderQuads(a){this.parentHasRenderTexture&&(!a.renderToTextureActive||this.parentRenderTexture!==a.activeRttNode)||(this.globalTransform,this.renderCoords,a.addQuad({width:this.props.width,height:this.props.height,colorTl:this.premultipliedColorTl,colorTr:this.premultipliedColorTr,colorBl:this.premultipliedColorBl,colorBr:this.premultipliedColorBr,texture:this.texture||this.stage.defaultTexture,textureOptions:this.textureOptions,zIndex:this.zIndex,shader:this.shader.shader,shaderProps:this.shader.getResolvedProps(),alpha:this.worldAlpha,clippingRect:this.clippingRect,tx:this.globalTransform.tx,ty:this.globalTransform.ty,ta:this.globalTransform.ta,tb:this.globalTransform.tb,tc:this.globalTransform.tc,td:this.globalTransform.td,renderCoords:this.renderCoords,rtt:this.rtt,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions}))}get id(){return this._id}get data(){return this.props.data}set data(a){this.props.data=a}get x(){return this.props.x}set x(a){this.props.x!==a&&(this.props.x=a,this.setUpdateType(he.Local))}get absX(){var a,d,m;return this.props.x+-this.props.width*this.props.mountX+(((a=this.props.parent)==null?void 0:a.absX)||((m=(d=this.props.parent)==null?void 0:d.globalTransform)==null?void 0:m.tx)||0)}get absY(){var a,d;return this.props.y+-this.props.height*this.props.mountY+((d=(a=this.props.parent)==null?void 0:a.absY)!=null?d:0)}get y(){return this.props.y}set y(a){this.props.y!==a&&(this.props.y=a,this.setUpdateType(he.Local))}get width(){return this.props.width}set width(a){this.props.width!==a&&(this.props.width=a,this.setUpdateType(he.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(he.RenderTexture)))}get height(){return this.props.height}set height(a){this.props.height!==a&&(this.props.height=a,this.setUpdateType(he.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(he.RenderTexture)))}get scale(){return this.scaleX}set scale(a){this.scaleX=a,this.scaleY=a}get scaleX(){return this.props.scaleX}set scaleX(a){this.props.scaleX!==a&&(this.props.scaleX=a,this.setUpdateType(he.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(a){this.props.scaleY!==a&&(this.props.scaleY=a,this.setUpdateType(he.ScaleRotate))}get mount(){return this.props.mount}set mount(a){(this.props.mountX!==a||this.props.mountY!==a)&&(this.props.mountX=a,this.props.mountY=a,this.props.mount=a,this.setUpdateType(he.Local))}get mountX(){return this.props.mountX}set mountX(a){this.props.mountX!==a&&(this.props.mountX=a,this.setUpdateType(he.Local))}get mountY(){return this.props.mountY}set mountY(a){this.props.mountY!==a&&(this.props.mountY=a,this.setUpdateType(he.Local))}get pivot(){return this.props.pivot}set pivot(a){(this.props.pivotX!==a||this.props.pivotY!==a)&&(this.props.pivotX=a,this.props.pivotY=a,this.props.pivot=a,this.setUpdateType(he.Local))}get pivotX(){return this.props.pivotX}set pivotX(a){this.props.pivotX!==a&&(this.props.pivotX=a,this.setUpdateType(he.Local))}get pivotY(){return this.props.pivotY}set pivotY(a){this.props.pivotY!==a&&(this.props.pivotY=a,this.setUpdateType(he.Local))}get rotation(){return this.props.rotation}set rotation(a){this.props.rotation!==a&&(this.props.rotation=a,this.setUpdateType(he.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(a){this.props.alpha=a,this.setUpdateType(he.PremultipliedColors|he.WorldAlpha|he.Children|he.IsRenderable),this.childUpdateType|=he.WorldAlpha}get autosize(){return this.props.autosize}set autosize(a){this.props.autosize=a}get boundsMargin(){var a,d,m;return(m=(d=this.props.boundsMargin)!=null?d:(a=this.parent)==null?void 0:a.boundsMargin)!=null?m:this.stage.boundsMargin}set boundsMargin(a){if(a!==this.props.boundsMargin){if(a===null)this.props.boundsMargin=a;else{const d=Array.isArray(a)?a:[a,a,a,a];this.props.boundsMargin=d}this.setUpdateType(he.RenderBounds)}}get clipping(){return this.props.clipping}set clipping(a){this.props.clipping=a,this.setUpdateType(he.Clipping|he.RenderBounds|he.Children),this.childUpdateType|=he.Global|he.Clipping}get color(){return this.props.color}set color(a){this.colorTop=a,this.colorBottom=a,this.colorLeft=a,this.colorRight=a,this.props.color=a,this.setUpdateType(he.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(a){(this.props.colorTl!==a||this.props.colorTr!==a)&&(this.colorTl=a,this.colorTr=a),this.props.colorTop=a,this.setUpdateType(he.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(a){(this.props.colorBl!==a||this.props.colorBr!==a)&&(this.colorBl=a,this.colorBr=a),this.props.colorBottom=a,this.setUpdateType(he.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(a){(this.props.colorTl!==a||this.props.colorBl!==a)&&(this.colorTl=a,this.colorBl=a),this.props.colorLeft=a,this.setUpdateType(he.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(a){(this.props.colorTr!==a||this.props.colorBr!==a)&&(this.colorTr=a,this.colorBr=a),this.props.colorRight=a,this.setUpdateType(he.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(a){this.props.colorTl=a,this.setUpdateType(he.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(a){this.props.colorTr=a,this.setUpdateType(he.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(a){this.props.colorBl=a,this.setUpdateType(he.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(a){this.props.colorBr=a,this.setUpdateType(he.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(a){this.props.zIndexLocked=a,this.setUpdateType(he.CalculatedZIndex|he.Children);for(let d=0,m=this.children.length;d<m;d++)this.children[d].setUpdateType(he.CalculatedZIndex)}get zIndex(){return this.props.zIndex}set zIndex(a){this.props.zIndex=a,this.setUpdateType(he.CalculatedZIndex|he.Children);for(let d=0,m=this.children.length;d<m;d++)this.children[d].setUpdateType(he.CalculatedZIndex)}get parent(){return this.props.parent}set parent(a){const d=this.props.parent;if(d!==a){if(this.props.parent=a,d){const m=d.children.indexOf(this);d.children.splice(m,1),d.setUpdateType(he.Children|he.ZIndexSortedChildren)}a&&(a.children.push(this),this.setUpdateType(he.All),a.setUpdateType(he.Children|he.ZIndexSortedChildren),(a.rtt||a.parentHasRenderTexture)&&this.applyRTTInheritance(a)),this.updateScaleRotateTransform(),this.setUpdateType(he.RenderBounds|he.Children)}}get preventCleanup(){return this.props.textureOptions.preventCleanup||!1}set preventCleanup(a){this.props.textureOptions.preventCleanup=a}get rtt(){return this.props.rtt}set rtt(a){this.props.rtt!==a&&(this.props.rtt=a,a===!0?(this.initRenderTexture(),this.markChildrenWithRTT()):this.cleanupRenderTexture(),this.setUpdateType(he.RenderTexture),this.parentHasRenderTexture===!0&&this.notifyParentRTTOfUpdate())}initRenderTexture(){this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.stage.renderer.renderToTexture(this)}cleanupRenderTexture(){this.unloadTexture(),this.clearRTTInheritance(),this.hasRTTupdates=!1,this.texture=null}markChildrenWithRTT(a=null){const d=a||this;for(const m of d.children)m.setUpdateType(he.All),m.parentHasRenderTexture=!0,m.markChildrenWithRTT()}applyRTTInheritance(a){a.rtt&&a.setUpdateType(he.RenderTexture),this.markChildrenWithRTT(a)}clearRTTInheritance(){if(!this.rtt)for(const a of this.children)a.parentHasRenderTexture=!1,a.rttParent=null,a.setUpdateType(he.All),a.clearRTTInheritance()}get shader(){return this.props.shader}set shader(a){this.props.shader!==a&&(this.props.shader=a,this.setUpdateType(he.IsRenderable))}get src(){return this.props.src}set src(a){if(this.props.src!==a){if(this.props.src=a,!a){this.texture=null;return}this.texture=this.stage.txManager.createTexture("ImageTexture",{src:a,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight,maxRetryCount:this.props.textureOptions.maxRetryCount})}}set imageType(a){this.props.imageType!==a&&(this.props.imageType=a)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(a){this.props.srcHeight=a}get srcWidth(){return this.props.srcWidth}set srcWidth(a){this.props.srcWidth=a}get srcX(){return this.props.srcX}set srcX(a){this.props.srcX=a}get srcY(){return this.props.srcY}set srcY(a){this.props.srcY=a}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let a=this.parent;for(;a;){if(a.rtt)return a;a=a.parent}return null}get texture(){return this.props.texture}set texture(a){if(this.props.texture===a)return;this.props.texture&&this.unloadTexture(),this.props.texture=a,a!==null&&(a.setRenderableOwner(this._id,this.isRenderable),this.loadTexture()),this.setUpdateType(he.IsRenderable)}set textureOptions(a){this.props.textureOptions=a}get textureOptions(){return this.props.textureOptions}get strictBounds(){return this.props.strictBounds}set strictBounds(a){a!==this.props.strictBounds&&(this.props.strictBounds=a,this.setUpdateType(he.RenderBounds|he.Children),this.childUpdateType|=he.RenderBounds|he.Children)}set interactive(a){this.props.interactive=a,a===!0&&this.stage.interactiveNodes.add(this)}get interactive(){return this.props.interactive}animate(a,d){const m=new VL(this,a,d);return new HL(this.stage.animationManager,m)}flush(){}}const GL=h=>{let c=!1,a=0;const d=(m=0)=>{const T=h.targetFrameTime;if(T>0&&m-a<T){const S=T-(m-a);setTimeout(()=>requestAnimationFrame(d),S);return}if(a=m,h.updateFrameTime(),h.updateAnimations(),!h.hasSceneUpdates()){h.calculateFps(),T>0?setTimeout(()=>requestAnimationFrame(d),Math.max(T,16.666666666666668)):setTimeout(()=>requestAnimationFrame(d),16.666666666666668),c||(h.eventBus.emit("idle"),c=!0),h.txMemManager.checkCleanup()===!0&&h.txMemManager.cleanup(),h.flushFrameEvents();return}if(c=!1,h.drawFrame(),h.flushFrameEvents(),T>0){const S=Math.max(0,T-(performance.now()-m));setTimeout(()=>requestAnimationFrame(d),S)}else requestAnimationFrame(d)};requestAnimationFrame(d)},jf=()=>performance?performance.now():Date.now();class XL{constructor(){_(this,"activeAnimations",new Set)}registerAnimation(c){this.activeAnimations.add(c)}unregisterAnimation(c){this.activeAnimations.delete(c)}update(c){this.activeAnimations.forEach(a=>{a.update(c)})}}function zL(){function h(a){return a.indexOf("image/png")!==-1}function c(a,d,m,T,S,p,k){return new Promise(function(L,j){var P=new XMLHttpRequest;P.open("GET",a,!0),P.responseType="blob",P.onload=function(){if(P.status!==200&&P.status!==0)return j(new Error("Failed to load image: "+P.statusText));var V=P.response;d!==void 0||h(V.type),createImageBitmap(V).then(function(K){L({data:K,premultiplyAlpha:d})}).catch(function(K){j(K)})},P.onerror=function(){j(new Error("Network error occurred while trying to fetch the image."))},P.send()})}self.onmessage=a=>{var d=a.data.src,m=a.data.id,T=a.data.premultiplyAlpha;a.data.sx,a.data.sy,a.data.sw,a.data.sh,c(d,T).then(function(S){self.postMessage({id:m,src:d,data:S},[S.data])}).catch(function(S){self.postMessage({id:m,src:d,error:S.message})})}}class WL{constructor(c,a){_(this,"imageWorkersEnabled",!0);_(this,"messageManager",{});_(this,"workers",[]);_(this,"workerIndex",0);_(this,"nextId",0);this.workers=this.createWorkers(c,a),this.workers.forEach(d=>{d.onmessage=this.handleMessage.bind(this)})}handleMessage(c){const{id:a,data:d,error:m}=c.data,T=this.messageManager[a];if(T){const[S,p]=T;delete this.messageManager[a],m?p(new Error(m)):S(d)}}createWorkers(c=1,a){let d="(".concat(zL.toString(),")()");a.options===!0&&(d=d.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;")),a.full===!0&&(d=d.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;"),d=d.replace("var supportsFullCreateImageBitmap = false;","var supportsFullCreateImageBitmap = true;")),d=d.replace('"use strict";',"");const m=new Blob([d],{type:"application/javascript"}),T=(self.URL?URL:webkitURL).createObjectURL(m),S=[];for(let p=0;p<c;p++)S.push(new Worker(T));return S}getNextWorker(){const c=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,c}getImage(c,a,d,m,T,S){return new Promise((p,k)=>{try{if(this.workers){const L=this.nextId++;this.messageManager[L]=[p,k];const j=this.getNextWorker();j&&j.postMessage({id:L,src:c,premultiplyAlpha:a,sx:d,sy:m,sw:T,sh:S})}}catch(L){k(L)}})}}const Tl=class Tl extends Zs{constructor(a,d){super(a);_(this,"type",Hn.color);_(this,"props");this.props=Tl.resolveDefaults(d)}get color(){return this.props.color}set color(a){this.props.color=a}async getTextureSource(){const a=new Uint8Array(4);return this.color===4294967295?(a[0]=255,a[1]=255,a[2]=255,a[3]=255):(a[0]=this.color>>16&255,a[1]=this.color>>8&255,a[2]=this.color&255,a[3]=this.color>>>24&255),{data:a,premultiplyAlpha:!0}}static makeCacheKey(a){const d=Tl.resolveDefaults(a);return"ColorTexture,".concat(d.color)}static resolveDefaults(a){return{color:a.color||4294967295}}};_(Tl,"z$__type__Props");let Xf=Tl;function KL(h){return/\.(ktx|pvr)$/.test(h)}const $L=55727696,YL={0:35841,1:35843,2:35840,3:35842,6:36196,7:33776,8:33778,9:33778,10:33779,11:33779},qL=1554098963,QL={"4x4":37808,"5x5":37809,"6x6":37810,"8x8":37811,"10x10":37812,"12x12":37813},gE=[171,75,84,88,32,49,49,187,13,10,26,10],mE=async h=>{try{const c=await fetch(h);if(!c.ok)throw new Error("Failed to fetch compressed texture: ".concat(c.status," ").concat(c.statusText));const a=await c.arrayBuffer();if(a.byteLength<16)throw new Error("File too small to be a valid compressed texture (".concat(a.byteLength," bytes). Expected at least 16 bytes for header inspection."));const d=new DataView(a),m=d.getUint32(0,!0);if(m===$L)return rb(d);if(m===qL)return JL(d);let T=!0;for(let S=0;S<gE.length;S++)if(d.getUint8(S)!==gE[S]){T=!1;break}if(T===!0)return eb(d);throw new Error("Unrecognized compressed texture format")}catch(c){throw new Error("Failed to load compressed texture from ".concat(h,": ").concat(c))}};function yE(h,c){return h.getUint8(c)+(h.getUint8(c+1)<<8)+(h.getUint8(c+2)<<16)}const JL=async function(h){const c=h.getUint8(4),a=h.getUint8(5),d=yE(h,7),m=yE(h,10);if(d===0||m===0)throw new Error("Invalid ASTC texture dimensions: ".concat(d,"x").concat(m));const T=Math.ceil(d/c)*Math.ceil(m/a)*16,S=h.byteLength-16;if(T!==S)throw new Error("Invalid ASTC texture data size: expected ".concat(T,", got ").concat(S));const p=QL["".concat(c,"x").concat(a)];if(p===void 0)throw new Error("Unsupported ASTC block size: ".concat(c,"x").concat(a));const k=h.buffer,L=[];return L.push(k.slice(16)),{data:{blockInfo:El[p],glInternalFormat:p,mipmaps:L,width:d,height:m,type:"astc"},premultiplyAlpha:!1}},ZL=function(h,c,a){if(h.getExtension("WEBGL_compressed_texture_astc")===null)throw new Error("ASTC compressed textures not supported by this device");h.bindTexture(c);const{glInternalFormat:d,mipmaps:m,width:T,height:S}=a,p=new Uint8Array(m[0]);h.compressedTexImage2D(0,d,T,S,0,p),h.texParameteri(h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_MIN_FILTER,h.LINEAR)},eb=async function(h){const c=h.getUint32(12,!0),a=c===67305985;if(a===!1&&c!==16909060)throw new Error("Invalid KTX endianness value");const d=h.getUint32(16,a),m=h.getUint32(24,a);if(d!==0||m!==0)throw new Error("KTX texture is not compressed (glType: ".concat(d,", glFormat: ").concat(m,")"));const T=h.getUint32(28,a);if(El[T]===void 0)throw new Error("Unsupported KTX compressed texture format: 0x".concat(T.toString(16)));const S=h.getUint32(36,a),p=h.getUint32(40,a);if(S===0||p===0)throw new Error("Invalid KTX texture dimensions: ".concat(S,"x").concat(p));const k=h.getUint32(56,a);if(k===0)throw new Error("KTX texture has no mipmap levels");const L=h.getUint32(60,a),j=[],P=h.buffer;let V=64+L;if(V>h.byteLength)throw new Error("Invalid KTX file: key/value data exceeds file size");for(let K=0;K<k;K++){const q=h.getUint32(V,a);V+=4;const ee=V+q;j.push(P.slice(V,ee)),V=ee,V%4!==0&&(V+=4-V%4)}return{data:{blockInfo:El[T],glInternalFormat:T,mipmaps:j,width:S,height:p,type:"ktx"},premultiplyAlpha:!1}},tb=function(h,c,a){const{glInternalFormat:d,mipmaps:m,width:T,height:S,blockInfo:p}=a;h.bindTexture(c);const k=p.width,L=p.height;let j=T,P=S;for(let V=0;V<m.length;V++){let K=new Uint8Array(m[V]);const q=Math.ceil(j/k)*k,ee=Math.ceil(P/L)*L,ue=Math.ceil(j/k)*Math.ceil(P/L)*p.bytes;if(K.byteLength<ue){const fe=new Uint8Array(ue);fe.set(K),K=fe}h.compressedTexImage2D(V,d,q,ee,0,K),j=Math.max(1,j>>1),P=Math.max(1,P>>1)}h.texParameteri(h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_MIN_FILTER,m.length>1?h.LINEAR_MIPMAP_LINEAR:h.LINEAR)};function nb(h,c,a){const d=a===2?16:8,m=8,T=Math.max(h,d),S=Math.max(c,m);return T*S*a/8}const rb=async function(h){const c=h.getUint32(8,!0),a=YL[c];if(a===void 0)throw new Error("Unsupported PVR pixel format: 0x".concat(c.toString(16)));const d=h.getInt32(24,!0),m=h.getInt32(28,!0);if(m===0||d===0)throw new Error("Invalid PVR texture dimensions: ".concat(m,"x").concat(d));const T=h.getInt32(44,!0),S=h.getUint32(48,!0),p=h.buffer;let k=52+S;if(k>p.byteLength)throw new Error("Invalid PVR file: metadata exceeds file size");const L=[],j=El[a];for(let P=0;P<T;P++){const V=h.getUint32(k,!0),K=p.byteLength-(k+4);if(V>0&&V<=K){k+=4;const q=k,ee=k+V;L.push(p.slice(q,ee)),k=ee,k=k+3&-4;continue}if(c===0||c===1||c===2||c===3){const q=c===0||c===1?2:4,ee=nb(m>>P,d>>P,q);L.push(p.slice(k,k+ee)),k+=ee,k=k+3&-4;continue}if(j!==void 0){const q=Math.ceil((m>>P)/j.width),ee=Math.ceil((d>>P)/j.height),ue=q*ee*j.bytes;L.push(p.slice(k,k+ue)),k+=ue,k=k+3&-4}}return{data:{blockInfo:El[a],glInternalFormat:a,mipmaps:L,width:m,height:d,type:"pvr"},premultiplyAlpha:!1}},ib=function(h,c,a){const{glInternalFormat:d,mipmaps:m,width:T,height:S}=a;h.bindTexture(c);let p=T,k=S;for(let L=0;L<m.length;L++)h.compressedTexImage2D(L,d,p,k,0,new Uint8Array(m[L])),p=Math.max(1,p>>1),k=Math.max(1,k>>1);h.texParameteri(h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_MIN_FILTER,m.length>1?h.LINEAR_MIPMAP_LINEAR:h.LINEAR)},qs={width:4,height:4,bytes:8},ca={width:4,height:4,bytes:16},vE={width:5,height:5,bytes:16},xE={width:6,height:6,bytes:16},TE={width:8,height:4,bytes:8},wE={width:8,height:8,bytes:16},SE={width:10,height:10,bytes:16},AE={width:12,height:12,bytes:16},El={33776:qs,33777:qs,33778:ca,33779:ca,36196:qs,37492:qs,37493:qs,37496:ca,37497:ca,35840:qs,35842:qs,35841:TE,35843:TE,37808:ca,37840:ca,37809:vE,37841:vE,37810:xE,37842:xE,37811:wE,37843:wE,37812:SE,37844:SE,37813:AE,37845:AE},sb={ktx:tb,pvr:ib,astc:ZL};function ob(h){return/\.(svg)(\?.*)?$/.test(h)}const EE=(h,c,a,d,m,T,S)=>new Promise((p,k)=>{const L=document.createElement("canvas"),j=L.getContext("2d");j.imageSmoothingEnabled=!0;const P=new Image;P.onload=()=>{const V=d!=null?d:0,K=m!=null?m:0,q=c||P.width,ee=a||P.height;L.width=q,L.height=ee,j.drawImage(P,0,0,q,ee),p({data:j.getImageData(V,K,T!=null?T:q,S!=null?S:ee),premultiplyAlpha:!1})},P.onerror=V=>{k(V)},P.src=h});function hI(h,c=""){return new Promise((a,d)=>{const m=new XMLHttpRequest;m.responseType=c,m.onreadystatechange=function(){m.readyState==XMLHttpRequest.DONE&&(m.status===0||m.status===200?a(m.response):d(m.statusText))},m.open("GET",h,!0),m.send(null)})}const wl=class wl extends Zs{constructor(a,d){var T;const m=wl.resolveDefaults(d);super(a);_(this,"type",Hn.image);_(this,"props");this.props=m,this.maxRetryCount=(T=m.maxRetryCount)!=null?T:this.txManager.maxRetryCount}hasAlphaChannel(a){return a.indexOf("image/png")!==-1}async loadImageFallback(a,d){const m=new Image;return typeof a=="string"&&fy(a)===!1&&(m.crossOrigin="anonymous"),new Promise((T,S)=>{m.onload=()=>{T({data:m,premultiplyAlpha:d})},m.onerror=p=>{const k=p instanceof Error?p.message:p instanceof Event?"Image loading failed for ".concat(m.src):"Unknown image loading error";S(new Error("Image loading failed: ".concat(k)))},a instanceof Blob?m.src=URL.createObjectURL(a):m.src=a})}async createImageBitmap(a,d,m,T,S,p){const k=d!=null?d:a.type.includes("image/png"),L=this.txManager.imageBitmapSupported;if(L.full===!0&&S!==null&&p!==null)try{return{data:await createImageBitmap(a,m||0,T||0,S,p,{premultiplyAlpha:k?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:k}}catch(j){throw new Error("Failed to create image bitmap with crop: ".concat(j))}else if(L.basic===!0)try{return{data:await createImageBitmap(a),premultiplyAlpha:k}}catch(j){throw new Error("Failed to create basic image bitmap: ".concat(j))}try{return{data:await createImageBitmap(a,{premultiplyAlpha:k?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:k}}catch(j){throw new Error("Failed to create image bitmap with options: ".concat(j))}}async loadImage(a){const{premultiplyAlpha:d,sx:m,sy:T,sw:S,sh:p}=this.props;if(this.txManager.hasCreateImageBitmap===!0){if(fy(a)===!1&&this.txManager.hasWorker===!0&&this.txManager.imageWorkerManager!==null)try{return this.txManager.imageWorkerManager.getImage(a,d,m,T,S,p)}catch(L){throw new Error("Failed to load image via worker: ".concat(L))}let k;if(fy(a)===!0)k=UL(a);else try{k=await hI(a,"blob")}catch(L){throw new Error("Failed to fetch image blob from ".concat(a,": ").concat(L))}return this.createImageBitmap(k,d,m,T,S,p)}return this.loadImageFallback(a,d!=null?d:!0)}async getTextureSource(){var d;let a;try{a=await this.determineImageTypeAndLoadImage()}catch(m){return this.setState("failed",m),{data:null}}return a.data===null?(this.setState("failed",Error("ImageTexture: No image data")),{data:null}):{data:a.data,premultiplyAlpha:(d=this.props.premultiplyAlpha)!=null?d:!0}}determineImageTypeAndLoadImage(){const{src:a,premultiplyAlpha:d,type:m}=this.props;if(a===null)return{data:null};if(typeof a!="string"){if(a instanceof Blob)if(this.txManager.hasCreateImageBitmap===!0){const{sx:S,sy:p,sw:k,sh:L}=this.props;return this.createImageBitmap(a,d,S,p,k,L)}else return this.loadImageFallback(a,d!=null?d:!0);return a instanceof ImageData?{data:a,premultiplyAlpha:d}:{data:a(),premultiplyAlpha:d}}const T=OL(a);return m==="regular"?this.loadImage(T):m==="svg"?EE(T,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):ob(a)===!0?EE(T,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):m==="compressed"||KL(a)===!0?mE(T):this.loadImage(T)}static makeCacheKey(a){var S,p,k;const d=wl.resolveDefaults(a),m=d.key||d.src;if(typeof m!="string")return!1;let T="";return d.sh!==null&&d.sw!==null&&(T+=",",T+=(S=d.sx)!=null?S:"",T+=(p=d.sy)!=null?p:"",T+=d.sw||"",T+=d.sh||""),"ImageTexture,".concat(m,",").concat((k=d.premultiplyAlpha)!=null?k:"true").concat(T)}static resolveDefaults(a){var d,m,T,S,p,k,L,j,P,V,K;return{src:(d=a.src)!=null?d:"",premultiplyAlpha:(m=a.premultiplyAlpha)!=null?m:!0,key:(T=a.key)!=null?T:null,type:(S=a.type)!=null?S:null,width:(p=a.width)!=null?p:null,height:(k=a.height)!=null?k:null,sx:(L=a.sx)!=null?L:null,sy:(j=a.sy)!=null?j:null,sw:(P=a.sw)!=null?P:null,sh:(V=a.sh)!=null?V:null,maxRetryCount:(K=a.maxRetryCount)!=null?K:null}}};_(wl,"z$__type__Props");let Il=wl;const Sl=class Sl extends Zs{constructor(a,d){super(a);_(this,"props");_(this,"type",Hn.noise);this.props=Sl.resolveDefaults(d)}async getTextureSource(){const{width:a,height:d}=this.props,m=a*d*4,T=new Uint8ClampedArray(m);for(let S=0;S<m;S+=4){const p=Math.floor(Math.random()*256);T[S]=p,T[S+1]=p,T[S+2]=p,T[S+3]=255}return{data:new ImageData(T,a,d)}}static makeCacheKey(a){if(a.cacheId===void 0)return!1;const d=Sl.resolveDefaults(a);return"NoiseTexture,".concat(d.width,",").concat(d.height,",").concat(d.cacheId)}static resolveDefaults(a){var d,m,T;return{width:(d=a.width)!=null?d:128,height:(m=a.height)!=null?m:128,cacheId:(T=a.cacheId)!=null?T:0}}};_(Sl,"z$__type__Props");let Dy=Sl,ab=0;const nh=class nh extends Zs{constructor(a,d){super(a);_(this,"props");_(this,"parentTexture");_(this,"type",Hn.subTexture);_(this,"subtextureId","subtexture-".concat(ab++));_(this,"onParentTxLoaded",()=>{this.forwardParentTxState("loaded",{width:this.props.width,height:this.props.height})});_(this,"onParentTxFailed",(a,d)=>{this.retryCount=this.parentTexture.retryCount-1,this.forwardParentTxState("failed",d)});_(this,"onParentTxLoading",()=>{this.forwardParentTxState("loading")});_(this,"onParentTxFreed",()=>{this.forwardParentTxState("freed")});this.props=nh.resolveDefaults(d||{}),this.props.texture,this.props.texture instanceof Il,this.parentTexture=a.resolveParentTexture(this.props.texture),this.renderableOwners.length>0&&this.parentTexture.setRenderableOwner(this.subtextureId,!0),queueMicrotask(()=>{const m=this.parentTexture;m.state==="loaded"&&m.dimensions?this.onParentTxLoaded(m,m.dimensions):m.state==="loading"?this.onParentTxLoading():m.state==="failed"&&m.error?this.onParentTxFailed(m,m.error):m.state==="freed"&&this.onParentTxFreed(),m.on("loading",this.onParentTxLoading),m.on("loaded",this.onParentTxLoaded),m.on("failed",this.onParentTxFailed),m.on("freed",this.onParentTxFreed)})}forwardParentTxState(a,d){this.setState(a,d)}onChangeIsRenderable(a){this.parentTexture.setRenderableOwner(this.subtextureId,a)}async getTextureSource(){return{data:this.props}}static makeCacheKey(a){return!1}static resolveDefaults(a){return{texture:a.texture,x:a.x||0,y:a.y||0,width:a.width||0,height:a.height||0}}};_(nh,"z$__type__Props");let zf=nh;const rh=class rh extends Zs{constructor(a,d){super(a);_(this,"props");_(this,"type",Hn.renderToTexture);this.props=rh.resolveDefaults(d||{})}get width(){return this.props.width}set width(a){this.props.width=a}get height(){return this.props.height}set height(a){this.props.height=a}async getTextureSource(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(a){return{width:a.width||256,height:a.height||256}}};_(rh,"z$__type__Props");let Wf=rh;async function ub(){var m,T,S;const h=new Uint8Array([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1,0,0,0,1,1,3,0,0,0,37,219,86,202,0,0,0,3,80,76,84,69,0,0,0,167,122,61,218,0,0,0,1,116,82,78,83,0,64,230,216,102,0,0,0,10,73,68,65,84,8,215,99,96,0,0,0,2,0,1,226,33,188,51,0,0,0,0,73,69,78,68,174,66,96,130]),c={basic:!1,options:!1,full:!1},a=new Blob([h],{type:"image/png"}),d=await createImageBitmap(a);(m=d.close)==null||m.call(d),c.basic=!0;try{const p={premultiplyAlpha:"none"},k=await createImageBitmap(a,p);(T=k.close)==null||T.call(k),c.options=!0}catch(p){}try{const p=await createImageBitmap(a,0,0,1,1,{premultiplyAlpha:"none"});(S=p.close)==null||S.call(p),c.full=!0}catch(p){}return c}var Hi;(function(h){h.MEMORY_THRESHOLD_EXCEEDED="MEMORY_THRESHOLD_EXCEEDED",h.TEXTURE_DATA_NULL="TEXTURE_DATA_NULL",h.TEXTURE_TYPE_NOT_REGISTERED="TEXTURE_TYPE_NOT_REGISTERED"})(Hi||(Hi={}));const lb={[Hi.MEMORY_THRESHOLD_EXCEEDED]:"Memory threshold exceeded",[Hi.TEXTURE_DATA_NULL]:"Texture data is null",[Hi.TEXTURE_TYPE_NOT_REGISTERED]:"Texture type is not registered"};class hy extends Error{constructor(a,d){const m=Object.values(Hi).includes(a),T=m?a:void 0;let S;m&&T?S=d!=null?d:lb[T]:S=String(a);super(S);_(this,"code");this.name=new.target.name,T&&(this.code=T)}}class cb extends xs{constructor(a,d){super();_(this,"keyCache",new Map);_(this,"inverseKeyCache",new WeakMap);_(this,"txConstructors",{});_(this,"maxRetryCount");_(this,"priorityQueue",[]);_(this,"uploadTextureQueue",[]);_(this,"initialized",!1);_(this,"stage");_(this,"numImageWorkers");_(this,"imageWorkerManager",null);_(this,"hasCreateImageBitmap",!!self.createImageBitmap);_(this,"imageBitmapSupported",{basic:!1,options:!1,full:!1});_(this,"hasWorker",!!self.Worker);_(this,"renderer");_(this,"frameTime",0);const{numImageWorkers:m,createImageBitmapSupport:T,maxRetryCount:S}=d;this.stage=a,this.numImageWorkers=m,this.maxRetryCount=S,T==="auto"?ub().then(p=>{this.initialize(p)}).catch(()=>{console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.initialized=!0,this.emit("initialized")}):this.initialize({basic:T==="basic",options:T==="options",full:T==="full"}),this.registerTextureType("ImageTexture",Il),this.registerTextureType("ColorTexture",Xf),this.registerTextureType("NoiseTexture",Dy),this.registerTextureType("SubTexture",zf),this.registerTextureType("RenderTexture",Wf)}registerTextureType(a,d){this.txConstructors[a]=d}initialize(a){this.hasCreateImageBitmap=a.basic||a.options||a.full,this.imageBitmapSupported=a,this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.hasCreateImageBitmap&&this.hasWorker&&this.numImageWorkers>0?this.imageWorkerManager=new WL(this.numImageWorkers,a):console.warn("[Lightning] Imageworker is 0 or not supported on this browser. Image loading will be slower."),this.initialized=!0,this.emit("initialized")}enqueueUploadTexture(a){this.uploadTextureQueue.includes(a)===!1&&this.uploadTextureQueue.push(a)}createTexture(a,d){let m;const T=this.txConstructors[a];if(!T)throw new hy(Hi.TEXTURE_TYPE_NOT_REGISTERED,'Texture type "'.concat(a,'" is not registered'));const S=T.makeCacheKey(d);return S&&this.keyCache.has(S)?m=this.keyCache.get(S):(m=new T(this,d),S&&this.initTextureToCache(m,S)),m}async loadTexture(a,d){if(a.type===Hn.subTexture||a.state==="loaded"||a.state==="loading")return;if(this.initialized===!1){this.priorityQueue.push(a);return}if(a.setState("loading"),await a.getTextureData().catch(S=>(console.error(S),a.setState("failed"),null))===null||a.state==="failed")return;if((a.type!==Hn.image||d===!0)===!0){await this.uploadTexture(a).catch(S=>{console.error("Failed to upload texture:",S),a.setState("failed")});return}this.enqueueUploadTexture(a)}async uploadTexture(a){if(this.stage.txMemManager.doNotExceedCriticalThreshold===!0&&this.stage.txMemManager.criticalCleanupRequested===!0){a.setState("failed",new hy(Hi.MEMORY_THRESHOLD_EXCEEDED));return}if(a.state==="failed"||a.state==="freed"||a.state==="loaded")return;if(a.textureData===null){a.setState("failed",new hy(Hi.TEXTURE_DATA_NULL,"Texture data is null, cannot upload texture"));return}const d=a.loadCtxTexture();if(d!==null&&d.state==="loaded"){a.setState("loaded");return}await d.load()}isProcessingTexture(a){return this.uploadTextureQueue.includes(a)===!0}async processSome(a){if(this.initialized===!1)return;const d=jf();for(;this.priorityQueue.length>0&&jf()-d<a;){const m=this.priorityQueue.pop();try{await m.getTextureData(),await this.uploadTexture(m)}catch(T){console.error("Failed to process priority texture:",T)}}for(;this.uploadTextureQueue.length>0&&jf()-d<a;){const m=this.uploadTextureQueue.shift();try{await this.uploadTexture(m)}catch(T){console.error("Failed to upload texture:",T)}}}hasUpdates(){return this.uploadTextureQueue.length>0}initTextureToCache(a,d){const{keyCache:m,inverseKeyCache:T}=this;m.set(d,a),T.set(a,d)}getTextureFromCache(a){return this.keyCache.get(a)}removeTextureFromCache(a){const{inverseKeyCache:d,keyCache:m}=this,T=d.get(a);T&&m.delete(T)}resolveParentTexture(a){if(!(a!=null&&a.props))return a;const d=Il.makeCacheKey(a.props),m=d?this.getTextureFromCache(d):void 0;return m!=null?m:a}}const db={normal:400,bold:700,bolder:900,lighter:100},IE=h=>typeof h=="number"?h:db[h]||400;function fb(h,c,a,d,m){let T=IE(a);for(const S of h){const p=S[c];if(!p)continue;if(p.size===1)return console.warn("TrFontManager: Only one font face found for family: '".concat(c,"' - will be used for all weights and styles")),p.values().next().value;const k=new Map;for(const j of p){const P=IE(j.descriptors.weight);if(P===T&&j.descriptors.style===d&&j.descriptors.stretch===m)return j;k.set(P,j)}const L="TrFontManager: No exact match: '".concat(c," Weight: ").concat(T," Style: ").concat(d," Stretch: ").concat(m,"'");if(console.error(L),T===400&&k.has(500))return k.get(500);if(T===500&&k.has(400))return k.get(400);if(T<400){for(;T>0;){if(k.has(T))return k.get(T);T-=100}T=600}for(;T<1e3;){if(k.has(T))return k.get(T);T+=100}for(T=500;T>0;){if(k.has(T))return k.get(T);T-=100}}}class hb{constructor(c){_(this,"textRenderers");_(this,"fontCache",new Map);this.textRenderers=c}addFontFace(c){for(const a in this.textRenderers){const d=this.textRenderers[a];d&&d.isFontFaceSupported(c)&&d.addFontFace(c)}}resolveFontFace(c,a,d){const{fontFamily:m,fontWeight:T,fontStyle:S,fontStretch:p}=a,k="".concat(d,"_").concat(m,"_").concat(S,"_").concat(T,"_").concat(p);if(this.fontCache.has(k)===!0)return this.fontCache.get(k);const L=fb(c,m,T,S,p);return L!==void 0&&this.fontCache.set(k,L),L}}class pI{static makeCacheKey(c){return!1}static resolveDefaults(c){return{}}}function CE(h,c,a){const d=h.createShader(c);if(!d){const T=h.getError();throw new Error("Unable to create the shader: ".concat(c===h.VERTEX_SHADER?"VERTEX_SHADER":"FRAGMENT_SHADER",".").concat(T?" WebGlContext Error: ".concat(T):""))}if(h.shaderSource(d,a),h.compileShader(d),!!h.getShaderParameter(d,h.COMPILE_STATUS))return d;console.error(h.getShaderInfoLog(d)),h.deleteShader(d)}function pb(h,c,a){const d=h.createProgram();if(!d)throw new Error("Unable to create program");if(h.attachShader(d,c),h.attachShader(d,a),h.linkProgram(d),!!h.getProgramParameter(d,h.LINK_STATUS))return d;console.warn(h.getProgramInfoLog(d)),h.deleteProgram(d)}class to extends pI{constructor(a){super();_(this,"buffersBound",!1);_(this,"program");_(this,"vao");_(this,"renderer");_(this,"glw");_(this,"attributeLocations");_(this,"uniformLocations");_(this,"supportsIndexedTextures");const d=this.renderer=a.renderer,m=this.glw=this.renderer.glw;this.supportsIndexedTextures=a.supportsIndexedTextures||!1;const T=m.isWebGl2(),S=T&&a.webgl2Extensions||!T&&a.webgl1Extensions||[],p=T?"2.0":"1.0";S.forEach(ee=>{if(!m.getExtension(ee))throw new Error('Shader "'.concat(this.constructor.name,'" requires extension "').concat(ee,'" for WebGL ').concat(p," but wasn't found"))});const k=a.shaderSources||this.constructor.shaderSources;if(k)T&&(k!=null&&k.webGl2)&&(k.fragment=k.webGl2.fragment,k.vertex=k.webGl2.vertex,delete k.webGl2);else throw new Error('Shader "'.concat(this.constructor.name,'" is missing shaderSources.'));const L=d.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,j=k.vertex instanceof Function?k.vertex(L):k.vertex,P=k.fragment instanceof Function?k.fragment(L):k.fragment,V=CE(m,m.VERTEX_SHADER,j),K=CE(m,m.FRAGMENT_SHADER,P);if(!V||!K)throw new Error("Unable to create the following shader(s): ".concat([!V&&"VERTEX_SHADER",!K&&"FRAGMENT_SHADER"].filter(Boolean).join(" and ")));const q=pb(m,V,K);if(!q)throw new Error("Unable to create program");this.program=q,this.attributeLocations=m.getAttributeLocations(this.program),this.uniformLocations=m.getUniformLocations(this.program)}disableAttribute(a){this.glw.disableVertexAttribArray(a)}disableAttributes(){const a=this.glw,d=this.attributeLocations.length;for(let m=0;m<d;m++)a.disableVertexAttribArray(m)}canBatchShaderProps(a,d){return!1}bindRenderOp(a,d){var p;this.bindBufferCollection(a.buffers),a.textures.length>0&&((p=a.textures[0])!=null&&p.ctxTexture)&&this.bindTextures(a.textures);const{glw:m,parentHasRenderTexture:T,renderToTexture:S}=a;if(!(S&&T)){if(T){const{width:k,height:L}=a.framebufferDimensions||{};m.uniform1f(this.getUniformLocation("u_pixelRatio"),1),m.uniform2f(this.getUniformLocation("u_resolution"),k!=null?k:0,L!=null?L:0)}else m.uniform1f(this.getUniformLocation("u_pixelRatio"),a.options.pixelRatio),m.uniform2f(this.getUniformLocation("u_resolution"),m.canvas.width,m.canvas.height);if(d){if(Gf(d,"$dimensions")){let k=d.$dimensions;k||(k=a.dimensions),m.uniform2f(this.getUniformLocation("u_dimensions"),k.width,k.height)}if(Gf(d,"$alpha")){let k=d.$alpha;k||(k=a.alpha),m.uniform1f(this.getUniformLocation("u_alpha"),k)}this.bindProps(d)}}}getUniformLocation(a){return this.uniformLocations[a]||null}bindBufferCollection(a){const{glw:d}=this,m=this.attributeLocations,T=m.length;for(let S=0;S<T;S++){const p=m[S],k=a.getBuffer(p),L=a.getAttributeInfo(p);k===void 0||L===void 0||(d.enableVertexAttribArray(S),d.vertexAttribPointer(k,S,L.size,L.type,L.normalized,L.stride,L.offset))}}bindProps(a){}bindTextures(a){}attach(){this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}_(to,"shaderSources");class gI extends to{constructor(c){super({renderer:c})}bindTextures(c){const{glw:a}=this;a.activeTexture(0),a.bindTexture(c[0].ctxTexture)}}_(gI,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_nodeCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class mI extends to{constructor(a){super({renderer:a});_(this,"supportsIndexedTextures",!0)}bindTextures(a){const{renderer:d,glw:m}=this;if(a.length>d.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(d.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));a.forEach((S,p)=>{m.activeTexture(p),m.bindTexture(S.ctxTexture)});const T=Array.from(Array(a.length).keys());this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"),T)}}_(mI,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:a=>"\n      #define txUnits ".concat(a,"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(a,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(a).keys()).map(d=>"\n          ".concat(d!==0?"else ":"","if (idx == ").concat(d,") {\n            return texture2D(textures[").concat(d,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class Sn{constructor(c){_(this,"priority",1);_(this,"name","");_(this,"ref");_(this,"target");_(this,"passParameters","");_(this,"declaredUniforms","");_(this,"uniformInfo",{});const{ref:a,target:d,props:m={}}=c;this.ref=a,this.target=d;const T={},S=[];let p="";const k=this.constructor.uniforms||{};for(const L in k){const j=k[L],P=j.type,V="".concat(a,"_").concat(L);let K="";j.size&&(K="[".concat(j.size(m),"]")),S.push(V),p+="uniform ".concat(P," ").concat(V).concat(K,";"),T[L]={name:V,uniform:k[L].method}}this.passParameters=S.join(","),this.declaredUniforms=p,this.uniformInfo=T}static getEffectKey(c){return""}static getMethodParameters(c,a){const d=[];for(const m in c){const T=c[m];let S="";T.size&&(S="[".concat(T.size(a),"]")),d.push("".concat(T.type," ").concat(m).concat(S))}return d.join(",")}static resolveDefaults(c){return{}}static makeEffectKey(c){return!1}}_(Sn,"uniforms",{}),_(Sn,"methods"),_(Sn,"onShaderMask"),_(Sn,"onColorize"),_(Sn,"onEffectMask");const py=new Map,gb=(h,c)=>{const a=JSON.stringify(h);if(py.has(a))return py.get(a);h=h!=null?h:[];const d=[],m=h.length;let T=0;for(;T<m;T++){const{name:S,type:p,props:k}=h[T],L={name:S,type:p,props:{}},j=c[p],P=j.resolveDefaults(k),V=j.uniforms,K=Object.keys(V),q=K.length;let ee=0;for(;ee<q;ee++){const ue=K[ee],fe=V[ue],J={value:P[ue],programValue:void 0,method:fe.method,updateOnBind:fe.updateOnBind||!1,hasValidator:fe.validator!==void 0,hasProgramValueUpdater:fe.updateProgramValue!==void 0},oe=J.hasValidator&&fe.validator(P[ue],P)||P[ue];P[ue]!==oe&&(J.validatedValue=oe),J.hasProgramValueUpdater&&fe.updateProgramValue(J),J.programValue===void 0&&(J.programValue=J.value),L.props[ue]=J}d.push(L)}return py.set(a,d),d},Vi=class Vi extends to{constructor(a,d,m){const T=Vi.createShader(d,m);super({renderer:a,shaderSources:{vertex:T.vertex,fragment:T.fragment}});_(this,"effects",[]);this.effects=T.effects}bindTextures(a){const{glw:d}=this;d.activeTexture(0),d.bindTexture(a[0].ctxTexture)}bindUniformMethods(a){const d=this.glw,m=a.effects,T=m.length;for(let S=0;S<T;S++){const p=this.effects[S].uniformInfo,k=m[S],L=Object.keys(k.props),j=L.length;for(let P=0;P<j;P++){const V=L[P],K=k.props[V].method,q=this.getUniformLocation(p[V].name);if(K==="uniform2fv"||K==="uniform2iv"||K==="uniform3iv"||K==="uniform4fv"||K==="uniform4iv"||K==="uniformMatrix2fv"||K==="uniformMatrix3fv"||K==="uniformMatrix4fv"||K==="uniform1f"||K==="uniform1fv"||K==="uniform1i"||K==="uniform1iv"){k.props[V].setUniformValue=function(){d[K](q,this.programValue)};continue}if(K==="uniform2f"||K==="uniform2i"){k.props[V].setUniformValue=function(){d[K](q,this.programValue[0],this.programValue[1])};continue}if(K==="uniform3f"||K==="uniform3i"){k.props[V].setUniformValue=function(){d[K](q,this.programValue[0],this.programValue[1],this.programValue[2])};continue}if(K==="uniform4f"||K==="uniform4i"){k.props[V].setUniformValue=function(){d[K](q,this.programValue[0],this.programValue[1],this.programValue[2],this.programValue[3])};continue}}}}bindProps(a){var S;const d=a.effects,m=d.length;let T=0;for(;T<m;T++){const p=d[T],k=Object.keys(p.props),L=k.length;let j=0;for(;j<L;j++){const P=k[j],V=p.props[P];if(V.updateOnBind===!0){const K=(S=this.renderer.shManager.getRegisteredEffects()[p.type])==null?void 0:S.uniforms[P];K==null||K.updateProgramValue(p.props[P],a)}V.setUniformValue()}}}canBatchShaderProps(a,d){if(a.$alpha!==d.$alpha||a.$dimensions.width!==d.$dimensions.width||a.$dimensions.height!==d.$dimensions.height||a.effects.length!==d.effects.length)return!1;const m=a.effects.length;let T=0;for(;T<m;T++){const S=a.effects[T],p=d.effects[T];if(S.type!==p.type)return!1;for(const k in S.props)if(p.props&&!p.props[k]||S.props[k].value!==p.props[k].value)return!1}return!0}static createShader(a,d){const m={},T={};let S="";const p=[],k=[],L=a.effects.map(q=>{const ee=d[q.type],ue=ee.getEffectKey(q.props||{});m[ue]=m[ue]?++m[ue]:1;const fe=m[ue];fe===1&&k.push({key:ue,type:q.type,props:q.props});const J=new ee({ref:"".concat(ue).concat(fe===1?"":fe),target:ue,props:q.props});return S+=J.declaredUniforms,p.push(...Object.values(J.uniformInfo)),J});let j="";k==null||k.forEach(q=>{var pe;const ee=d[q.type],ue=ee.resolveDefaults((pe=q.props)!=null?pe:{}),fe=[];for(const we in ee.methods){let C=we;const ie=ee.methods[we];T[we]&&T[we]!==ie&&(C=Vi.resolveMethodDuplicate(we,ie,T)),T[C]=ie.replace("function",C),fe.push({m:we,cm:C})}let J=ee.onShaderMask instanceof Function?ee.onShaderMask(ue):ee.onShaderMask,oe=ee.onColorize instanceof Function?ee.onColorize(ue):ee.onColorize,x=ee.onEffectMask instanceof Function?ee.onEffectMask(ue):ee.onEffectMask;fe.forEach(we=>{const{m:C,cm:ie}=we,Z=new RegExp("\\$".concat(C),"g");J&&(J=J.replace(Z,ie)),oe&&(oe=oe.replace(Z,ie)),x&&(x=x.replace(Z,ie))});const Y=ee.getMethodParameters(ee.uniforms,ue),me=Y.length>0?", ".concat(Y):"";J&&(j+="\n        float fx_".concat(q.key,"_onShaderMask(float shaderMask ").concat(me,") {\n          ").concat(J,"\n        }\n        ")),oe&&(j+="\n          vec4 fx_".concat(q.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(me,") {\n            ").concat(oe,"\n          }\n        ")),x&&(j+="\n          vec4 fx_".concat(q.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(me,") {\n            ").concat(x,"\n          }\n        "))});let P="";for(const q in T)P+=T[q];let V="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",K="\n\n    ";for(let q=0;q<L.length;q++){const ee=L[q],ue=ee.passParameters.length>0?", ".concat(ee.passParameters):"",fe=d[ee.name];fe.onShaderMask&&(K+="\n        shaderMask = fx_".concat(ee.target,"_onShaderMask(shaderMask ").concat(ue,");\n        ")),fe.onColorize&&(K+="\n        maskColor = fx_".concat(ee.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(ue,");\n        ")),fe.onEffectMask&&(V="fx_".concat(ee.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(ue,")"));const J=L[q+1];(J===void 0||d[J.name].onEffectMask)&&(K+="\n          shaderColor = ".concat(V,";\n        "))}return{effects:L,uniforms:p,fragment:Vi.fragment(S,P,j,K),vertex:Vi.vertex()}}static resolveMethodDuplicate(a,d,m,T=0){const S=a+(T>0?T:"");return m[S]&&m[S]!==d?this.resolveMethodDuplicate(a,d,m,++T):S}static resolveDefaults(a,d){var m;return{effects:gb((m=a.effects)!=null?m:[],d),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(a,d){var T;let m="";return(T=a.effects)==null||T.forEach(S=>{const k=d[S.type].getEffectKey(S.props||{});m+=",".concat(k)}),"DynamicShader".concat(m)}};_(Vi,"z$__type__Props"),_(Vi,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_nodeCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n    varying vec2 v_nodeCoordinate;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n      v_nodeCoordinate = a_nodeCoordinate;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),_(Vi,"fragment",(a,d,m,T)=>"\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(a,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying vec2 v_nodeCoordinate;\n\n    ").concat(d,"\n\n    ").concat(m,"\n\n    void main() {\n      vec2 p = v_nodeCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(T,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let Aa=Vi;class Ly extends to{constructor(c){super({renderer:c})}static resolveDefaults(c){return{radius:c.radius||10,$dimensions:{width:0,height:0}}}bindTextures(c){const{glw:a}=this;a.activeTexture(0),a.bindTexture(c[0].ctxTexture)}bindProps(c){const a=Math.min(c.$dimensions.width,c.$dimensions.height)/(2*c.radius);this.glw.uniform1f(this.getUniformLocation("u_radius"),c.radius*Math.min(a,1))}canBatchShaderProps(c,a){return c.radius===a.radius&&c.$dimensions.width===a.$dimensions.width&&c.$dimensions.height===a.$dimensions.height}}_(Ly,"z$__type__Props"),_(Ly,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute vec2 a_nodeCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const mb=new Float32Array([1,0,0,0,1,0,0,0,1]),Al=class Al extends to{constructor(c){super({renderer:c})}bindTextures(c){const{glw:a}=this;a.activeTexture(0),a.bindTexture(c[0].ctxTexture)}bindProps(c){const a=Al.resolveDefaults(c);for(const d in a)if(d==="transform")this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"),a[d]);else if(d==="scrollY")this.glw.uniform1f(this.getUniformLocation("u_scrollY"),a[d]);else if(d==="color"){const m=ih(a.color);this.glw.uniform4fv(this.getUniformLocation("u_color"),m)}else d==="size"?this.glw.uniform1f(this.getUniformLocation("u_size"),a[d]):d==="distanceRange"?this.glw.uniform1f(this.getUniformLocation("u_distanceRange"),a[d]):d==="debug"&&this.glw.uniform1i(this.getUniformLocation("u_debug"),a[d]?1:0)}static resolveDefaults(c={}){var a,d,m,T,S,p;return{transform:(a=c.transform)!=null?a:mb,scrollY:(d=c.scrollY)!=null?d:0,color:(m=c.color)!=null?m:4294967295,size:(T=c.size)!=null?T:16,distanceRange:(S=c.distanceRange)!=null?S:1,debug:(p=c.debug)!=null?p:!1}}};_(Al,"z$__type__Props"),_(Al,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let by=Al;const Ca=h=>{h.programValue===void 0&&(h.programValue=new Float32Array(4));const c=h.value,a=h.programValue;a[0]=(c>>>24)/255,a[1]=(c>>>16&255)/255,a[2]=(c>>>8&255)/255,a[3]=(c&255)/255},yb=h=>{const c=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const a=h.programValue;a[0]=c[0],a[1]=c[1]}else h.programValue=new Float32Array(c)},vb=h=>{const c=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const a=h.programValue;a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3]}else h.programValue=new Float32Array(c)},yI=h=>{const c=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const a=c.length,d=h.programValue;for(let m=0;m<a;m++)d[m]=c[m]}else h.programValue=new Float32Array(c)},Jy=h=>{const c=Array.isArray(h);if(c){if(c&&h.length===4)return h;if(c&&h.length===2)return[h[0],h[1],h[0],h[1]];if(c&&h.length===3)return[h[0],h[1],h[2],h[0]]}else return[h,h,h,h];return[h[0],h[0],h[0],h[0]]},vI=(h,c)=>{h.programValue===void 0&&(h.programValue=new Float32Array(4));const a=h.programValue,d=h.validatedValue||h.value;if(c===void 0&&h.$dimensions===void 0){a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3];return}let m=h.$dimensions;if(c!==void 0){const{$dimensions:V}=c;if(m!==void 0&&(m.width===V.width||m.height===V.height))return;m===void 0&&(m={width:V==null?void 0:V.width,height:V==null?void 0:V.height},h.$dimensions=m)}const{width:T,height:S}=m,[p,k,L,j]=d,P=Math.min(Math.min(Math.min(T/Math.max(T,p+k),T/Math.max(T,L+j)),Math.min(S/Math.max(S,p+L),S/Math.max(S,k+j))),1);a[0]=p*P,a[1]=k*P,a[2]=L*P,a[3]=j*P};class fa extends Sn{constructor(){super(...arguments);_(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(a){var d;return{radius:(d=a.radius)!=null?d:10}}}_(fa,"z$__type__Props"),_(fa,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Jy,updateProgramValue:vI}}),_(fa,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),_(fa,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_nodeCoordinate.x, 0.5) * step(v_nodeCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_nodeCoordinate.x) * step(v_nodeCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_nodeCoordinate.x) * step(0.5, v_nodeCoordinate.y);\n  r = r + radius[3] * step(v_nodeCoordinate.x, 0.5) * step(0.5, v_nodeCoordinate.y);\n  return $boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),_(fa,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class ll extends Sn{constructor(){super(...arguments);_(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(a){var d,m;return{width:(d=a.width)!=null?d:10,color:(m=a.color)!=null?m:4294967295}}}_(ll,"z$__type__Props"),_(ll,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ca,method:"uniform4fv",type:"vec4"}}),_(ll,"onEffectMask","\n  float intR = shaderMask + 1.0;\n  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  "),_(ll,"onColorize","\n    return color;\n  ");class ha extends Sn{constructor(){super(...arguments);_(this,"name","linearGradient")}static getEffectKey(a){return a.colors.value?"linearGradient".concat(a.colors.value.length):"linearGradient".concat(a.colors.length)}static resolveDefaults(a){var T,S;const d=(T=a.colors)!=null?T:[4278190080,4294967295];let m=a.stops||[];if(m.length===0||m.length!==d.length){const p=d.length;let k=0;const L=m;for(;k<p;k++)m[k]?(L[k]=m[k],m[k-1]===void 0&&L[k-2]!==void 0&&(L[k-1]=L[k-2]+(m[k]-L[k-2])/2)):L[k]=k*(1/(d.length-1));m=L}return{colors:d,stops:m,angle:(S=a.angle)!=null?S:0}}}_(ha,"z$__type__Props"),_(ha,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:a=>a.reduce((d,m)=>d.concat(ih(m)),[]),updateProgramValue:yI,size:a=>a.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:a=>a.colors.length,method:"uniform1fv",type:"float"}}),_(ha,"methods",{calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),_(ha,"ColorLoop",a=>{let d="";for(let m=2;m<a;m++)d+="colorOut = mix(colorOut, colors[".concat(m,"], clamp((dist - stops[").concat(m-1,"]) / (stops[").concat(m,"] - stops[").concat(m-1,"]), 0.0, 1.0));");return d}),_(ha,"onColorize",a=>{const d=a.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_nodeCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ".concat(d,";\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    ")});class Ny extends Sn{constructor(){super(...arguments);_(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(a){var d;return{amount:(d=a.amount)!=null?d:1}}}_(Ny,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),_(Ny,"onColorize","\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ");class pa extends Sn{constructor(){super(...arguments);_(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(a){var d,m;return{width:(d=a.width)!=null?d:10,color:(m=a.color)!=null?m:4294967295}}}_(pa,"z$__type__Props"),_(pa,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ca,method:"uniform4fv",type:"vec4"}}),_(pa,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),_(pa,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),_(pa,"onColorize","\n    return color;\n  ");class ga extends Sn{constructor(){super(...arguments);_(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(a){var d,m;return{width:(d=a.width)!=null?d:10,color:(m=a.color)!=null?m:4294967295}}}_(ga,"z$__type__Props"),_(ga,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ca,method:"uniform4fv",type:"vec4"}}),_(ga,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),_(ga,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),_(ga,"onColorize","\n    return color;\n  ");class ma extends Sn{constructor(){super(...arguments);_(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(a){var d,m;return{width:(d=a.width)!=null?d:10,color:(m=a.color)!=null?m:4294967295}}}_(ma,"z$__type__Props"),_(ma,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ca,method:"uniform4fv",type:"vec4"}}),_(ma,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),_(ma,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),_(ma,"onColorize","\n    return color;\n  ");class ya extends Sn{constructor(){super(...arguments);_(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(a){var d,m;return{width:(d=a.width)!=null?d:10,color:(m=a.color)!=null?m:4294967295}}}_(ya,"z$__type__Props"),_(ya,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ca,method:"uniform4fv",type:"vec4"}}),_(ya,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),_(ya,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),_(ya,"onColorize","\n    return color;\n  ");class cl extends Sn{constructor(){super(...arguments);_(this,"name","glitch")}static getEffectKey(a){return"glitch"}static resolveDefaults(a){var d,m,T,S,p;return{amplitude:(d=a.amplitude)!=null?d:.2,narrowness:(m=a.narrowness)!=null?m:4,blockiness:(T=a.blockiness)!=null?T:2,minimizer:(S=a.minimizer)!=null?S:8,time:(p=a.time)!=null?p:Date.now()}}}_(cl,"z$__type__Props"),_(cl,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:a=>{const d=a.value=(Date.now()-a.value)%1e3;a.programValue=d},type:"float"}}),_(cl,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),_(cl,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class Bf extends Sn{constructor(){super(...arguments);_(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(a){var d;return{fade:(d=a.fade)!=null?d:10}}}_(Bf,"z$__type__Props"),_(Bf,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:Jy,updateProgramValue:vb}}),_(Bf,"onColorize","\n  vec2 point = v_nodeCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_nodeCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_nodeCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class va extends Sn{constructor(){super(...arguments);_(this,"name","radialGradient")}static getEffectKey(a){return a.colors.value?"radialGradient".concat(a.colors.value.length):"radialGradient".concat(a.colors.length)}static resolveDefaults(a){var T,S,p,k,L;const d=(T=a.colors)!=null?T:[4278190080,4294967295];let m=a.stops||[];if(m.length===0||m.length!==d.length){const j=d.length;let P=0;const V=m;for(;P<j;P++)m[P]?(V[P]=m[P],m[P-1]===void 0&&V[P-2]!==void 0&&(V[P-1]=V[P-2]+(m[P]-V[P-2])/2)):V[P]=P*(1/(d.length-1));m=V}return{colors:d,stops:m,width:(S=a.width)!=null?S:0,height:(k=(p=a.height)!=null?p:a.width)!=null?k:0,pivot:(L=a.pivot)!=null?L:[.5,.5]}}}_(va,"z$__type__Props"),_(va,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:yb,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:a=>a.reduce((d,m)=>d.concat(ih(m)),[]),updateProgramValue:yI,size:a=>a.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:a=>a.colors.length,method:"uniform1fv",type:"float"}}),_(va,"methods",{getGradientColor:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    "}),_(va,"ColorLoop",a=>{let d="";for(let m=2;m<a;m++)d+="colorOut = mix(colorOut, colors[".concat(m,"], clamp((dist - stops[").concat(m-1,"]) / (stops[").concat(m,"] - stops[").concat(m-1,"]), 0.0, 1.0));");return d}),_(va,"onColorize",a=>{const d=a.colors.length||1;return"\n      vec2 point = v_nodeCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      dist = clamp(dist, 0.0, 1.0);\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ".concat(d,";\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    ")});class xa extends Sn{constructor(){super(...arguments);_(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(a){var d,m,T,S,p,k,L;return{width:(d=a.width)!=null?d:10,progress:(m=a.progress)!=null?m:.5,offset:(T=a.offset)!=null?T:0,range:(S=a.range)!=null?S:Math.PI*2,rounded:(p=a.rounded)!=null?p:!1,radius:(k=a.radius)!=null?k:1,color:(L=a.color)!=null?L:4294967295}}}_(xa,"z$__type__Props"),_(xa,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:a=>a?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ca,method:"uniform4fv",type:"vec4"}}),_(xa,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),_(xa,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_nodeCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),_(xa,"onColorize","\n    return color;\n  ");class Ta extends Sn{constructor(){super(...arguments);_(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(a){var d;return{x:a.x||0,y:a.y||0,width:a.width||50,height:a.height||50,radius:(d=a.radius)!=null?d:0}}}_(Ta,"z$__type__Props"),_(Ta,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Jy,updateProgramValue:vI}}),_(Ta,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),_(Ta,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_nodeCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  "),_(Ta,"onEffectMask","\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  ");class xb extends pI{constructor(a){super();_(this,"shType");this.shType=a}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class Tb{constructor(c,a,d,m){_(this,"type");_(this,"shader");_(this,"resolvedProps");_(this,"props");this.type=c,this.shader=a,this.resolvedProps=d;const T=Object.keys(d),S=T.length,p={};for(let k=0;k<S;k++){const L=T[k];Object.defineProperty(p,L,{get:()=>this.resolvedProps[L],set:j=>{this.resolvedProps[L]=j,m.requestRender()}})}this.props=p}getResolvedProps(){return this.resolvedProps}}class wb{constructor(c,a,d){_(this,"shader");_(this,"resolvedProps");_(this,"props");_(this,"type");this.shader=c,this.type="DynamicShader",this.resolvedProps=a;const m=d.getRegisteredEffects(),T={},S=a.effects,p=S.length;for(let k=0;k<p;k++){const{name:L,props:j,type:P}=S[k];if(L===void 0)continue;const V={},K=Object.keys(j),q=K.length;for(let ee=0;ee<q;ee++){const ue=K[ee];Object.defineProperty(V,ue,{get:()=>this.resolvedProps.effects[k].props[ue].value,set:fe=>{var oe,x;const J=this.resolvedProps.effects[k].props[ue];J.value=fe,J.hasValidator&&(fe=J.validatedValue=(oe=m[P].uniforms[ue])==null?void 0:oe.validator(fe,j)),J.hasProgramValueUpdater?(x=m[P].uniforms[ue])==null||x.updateProgramValue(J):J.programValue=fe,d.renderer.stage.requestRender()}})}Object.defineProperty(T,L,{get:()=>V})}this.props=T}getResolvedProps(){return this.resolvedProps}}class Sb{constructor(){_(this,"shCache",new Map);_(this,"shConstructors",{});_(this,"attachedShader",null);_(this,"effectConstructors",{});_(this,"renderer");this.registerShaderType("DefaultShader",gI),this.registerShaderType("DefaultShaderBatched",mI),this.registerShaderType("RoundedRectangle",Ly),this.registerShaderType("DynamicShader",Aa),this.registerShaderType("SdfShader",by),this.registerEffectType("border",ll),this.registerEffectType("borderBottom",ma),this.registerEffectType("borderLeft",ya),this.registerEffectType("borderRight",pa),this.registerEffectType("borderTop",ga),this.registerEffectType("fadeOut",Bf),this.registerEffectType("linearGradient",ha),this.registerEffectType("radialGradient",va),this.registerEffectType("grayscale",Ny),this.registerEffectType("glitch",cl),this.registerEffectType("radius",fa),this.registerEffectType("radialProgress",xa),this.registerEffectType("holePunch",Ta)}registerShaderType(c,a){this.shConstructors[c]=a}registerEffectType(c,a){this.effectConstructors[c]=a}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(c,a){if(!this.renderer)throw new Error("Renderer is not been defined");const d=this.shConstructors[c];if(!d)throw new Error('Shader type "'.concat(c,'" is not registered'));if(this.renderer.mode==="canvas"&&d.prototype instanceof to)return this._createShaderCtr(c,new xb(c),a);if(c==="DynamicShader")return this.loadDynamicShader(a);const m=d.resolveDefaults(a),T=d.makeCacheKey(m)||d.name;if(T&&this.shCache.has(T))return this._createShaderCtr(c,this.shCache.get(T),m);const S=new d(this.renderer,a);return T&&this.shCache.set(T,S),this._createShaderCtr(c,S,m)}loadDynamicShader(c){if(!this.renderer)throw new Error("Renderer is not been defined");const a=Aa.resolveDefaults(c,this.effectConstructors),d=Aa.makeCacheKey(a,this.effectConstructors);if(d&&this.shCache.has(d))return this._createDynShaderCtr(this.shCache.get(d),a);const m=new Aa(this.renderer,c,this.effectConstructors);return d&&this.shCache.set(d,m),this._createDynShaderCtr(m,a)}_createShaderCtr(c,a,d){return new Tb(c,a,d,this.renderer.stage)}_createDynShaderCtr(c,a){return c.bindUniformMethods(a),new wb(c,a,this)}useShader(c){this.attachedShader!==c&&(this.attachedShader&&this.attachedShader.detach(),c.attach(),this.attachedShader=c)}}const Ab={x:(h,c)=>{h.props.x=c},y:(h,c)=>{h.props.y=c},width:(h,c)=>{h.props.width=c},height:(h,c)=>{h.props.height=c},color:(h,c)=>{h.props.color=c},zIndex:(h,c)=>{h.props.zIndex=c},fontFamily:(h,c)=>{h.props.fontFamily=c},fontWeight:(h,c)=>{h.props.fontWeight=c},fontStyle:(h,c)=>{h.props.fontStyle=c},fontStretch:(h,c)=>{h.props.fontStretch=c},fontSize:(h,c)=>{h.props.fontSize=c},text:(h,c)=>{h.props.text=c},textAlign:(h,c)=>{h.props.textAlign=c},contain:(h,c)=>{h.props.contain=c},offsetY:(h,c)=>{h.props.offsetY=c},scrollable:(h,c)=>{h.props.scrollable=c},scrollY:(h,c)=>{h.props.scrollY=c},letterSpacing:(h,c)=>{h.props.letterSpacing=c},lineHeight:(h,c)=>{h.props.lineHeight=c},maxLines:(h,c)=>{h.props.maxLines=c},textBaseline:(h,c)=>{h.props.textBaseline=c},verticalAlign:(h,c)=>{h.props.verticalAlign=c},overflowSuffix:(h,c)=>{h.props.overflowSuffix=c},debug:(h,c)=>{h.props.debug=c}};class xI{constructor(c){_(this,"stage");_(this,"set");this.stage=c;const a={...Ab,...this.getPropertySetters()},d={};Object.keys(a).forEach(m=>{Object.defineProperty(d,m,{value:(T,S)=>{T.props[m]!==S&&(a[m](T,S),this.stage.requestRender())},writable:!1,configurable:!1})}),this.set=d}setStatus(c,a,d){c.status!==a&&(c.status=a,c.emitter.emit(a,d))}setIsRenderable(c,a){c.isRenderable=a}destroyState(c){this.setStatus(c,"destroyed"),c.emitter.removeAllListeners()}scheduleUpdateState(c){c.updateScheduled||(c.updateScheduled=!0,queueMicrotask(()=>{c.status!=="destroyed"&&(c.updateScheduled=!1,this.updateState(c))}))}}class Eb{constructor(){_(this,"data",{})}reset(){this.data={}}increment(c){this.data[c]||(this.data[c]=0),this.data[c]++}getData(){return{...this.data}}}class Ib{constructor(c,a){_(this,"stage");_(this,"memUsed",0);_(this,"loadedTextures",[]);_(this,"criticalThreshold");_(this,"targetThreshold");_(this,"cleanupInterval");_(this,"debugLogging");_(this,"lastCleanupTime",0);_(this,"baselineMemoryAllocation");_(this,"hasWarnedAboveCritical",!1);_(this,"criticalCleanupRequested",!1);_(this,"doNotExceedCriticalThreshold");_(this,"frameTime",0);this.stage=c;const{criticalThreshold:d,doNotExceedCriticalThreshold:m}=a;this.doNotExceedCriticalThreshold=m||!1,this.criticalThreshold=Math.round(d);const T=Math.max(0,Math.min(1,a.targetThresholdLevel));if(this.cleanupInterval=a.cleanupInterval,this.debugLogging=a.debugLogging,this.baselineMemoryAllocation=Math.round(a.baselineMemoryAllocation),this.targetThreshold=Math.max(Math.round(d*T),this.baselineMemoryAllocation),this.memUsed=Math.round(a.baselineMemoryAllocation),a.debugLogging){let S=0;setInterval(()=>{S!==this.memUsed&&(S=this.memUsed,console.log("[TextureMemoryManager] Memory used: ".concat(pE(this.memUsed)," mb / ").concat(pE(this.criticalThreshold)," mb (").concat((this.memUsed/this.criticalThreshold*100).toFixed(1),"%)")))},1e3)}d===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(c,a){if(this.memUsed-=c.memUsed,a===0){const d=this.loadedTextures.indexOf(c);d!==-1&&(this.loadedTextures[d]=null),c.memUsed=0;return}else if(c.memUsed=a,this.memUsed+=a,this.loadedTextures.indexOf(c)===-1){const d=this.loadedTextures.indexOf(null);d!==-1?this.loadedTextures[d]=c:this.loadedTextures.push(c)}this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}checkCriticalCleanup(){return this.memUsed>this.criticalThreshold}destroyTexture(c){this.debugLogging===!0&&console.log("[TextureMemoryManager] Destroying texture. State: ".concat(c.state));const a=this.loadedTextures.indexOf(c);a!==-1&&(this.loadedTextures[a]=null),this.stage.txManager.removeTextureFromCache(c),c.destroy(),this.memUsed-=c.memUsed,c.memUsed=0}cleanup(){const c=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,c===!0&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging===!0&&console.log("[TextureMemoryManager] Cleaning up textures. Critical: ".concat(c,"."));const a=c?this.criticalThreshold:this.targetThreshold;let d=this.memUsed;for(let m=0;m<this.loadedTextures.length&&!(d<a);m++){const T=this.loadedTextures[m];if(!T)continue;if((T.type===Hn.image||T.type===Hn.noise||T.type===Hn.renderToTexture)&&T.canBeCleanedUp()===!0){const p=T.memUsed;this.destroyTexture(T),d-=p}}this.memUsed>=this.criticalThreshold?(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),!this.hasWarnedAboveCritical&&(this.debugLogging===!0||ML===!1)&&(console.warn("[TextureMemoryManager] Memory usage above critical threshold after cleanup: ".concat(this.memUsed)),this.hasWarnedAboveCritical=!0)):(this.criticalCleanupRequested=!1,this.hasWarnedAboveCritical=!1)}getMemoryInfo(){let c=0,a=this.baselineMemoryAllocation;for(const m of this.loadedTextures)m&&m.renderable&&(c+=1,a+=m.memUsed);const d=this.loadedTextures.filter(m=>m!==null).length;return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:a,memUsed:this.memUsed,renderableTexturesLoaded:c,loadedTextures:d,baselineMemoryAllocation:this.baselineMemoryAllocation}}}class Cb{constructor(c,a){_(this,"textureSource");_(this,"memManager");_(this,"state","freed");this.memManager=c,this.textureSource=a}setTextureMemUse(c){this.memManager.setTextureMemUse(this.textureSource,c)}get renderable(){return this.textureSource.renderable}}class Mb{constructor(c){_(this,"options");_(this,"mode");_(this,"stage");_(this,"txManager");_(this,"txMemManager");_(this,"shManager");_(this,"rttNodes",[]);this.options=c,this.stage=c.stage,this.txManager=c.txManager,this.txMemManager=c.txMemManager,this.shManager=c.shManager}}class Rb extends Py{constructor(a,d,m){super(a,d);_(this,"textRenderer");_(this,"trState");_(this,"_textRendererOverride",null);_(this,"onTextLoaded",()=>{const{contain:a}=this,d=this.trState.props.width,m=this.trState.props.height,T=this.trState.textW||0,S=this.trState.textH||0;a==="both"?(this.props.width=d,this.props.height=m):a==="width"?(this.props.width=d,this.props.height=S):a==="none"&&(this.props.width=T,this.props.height=S),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});_(this,"onTextFailed",(a,d)=>{this.emit("failed",{type:"text",error:d})});this._textRendererOverride=d.textRendererOverride,this.textRenderer=m;const T=this.createState({x:0,y:0,width:d.width,height:d.height,textAlign:d.textAlign,color:d.color,zIndex:d.zIndex,contain:d.contain,scrollable:d.scrollable,scrollY:d.scrollY,offsetY:d.offsetY,letterSpacing:d.letterSpacing,debug:d.debug,fontFamily:d.fontFamily,fontSize:d.fontSize,fontStretch:d.fontStretch,fontStyle:d.fontStyle,fontWeight:d.fontWeight,text:d.text,lineHeight:d.lineHeight,maxLines:d.maxLines,textBaseline:d.textBaseline,verticalAlign:d.verticalAlign,overflowSuffix:d.overflowSuffix});this.trState=T}get width(){return this.props.width}set width(a){this.props.width=a,this.textRenderer.set.width(this.trState,a),this.contain==="none"&&this.setUpdateType(he.Local)}get height(){return this.props.height}set height(a){this.props.height=a,this.textRenderer.set.height(this.trState,a),this.contain!=="both"&&this.setUpdateType(he.Local)}get color(){return this.trState.props.color}set color(a){this.textRenderer.set.color(this.trState,a)}get text(){return this.trState.props.text}set text(a){this.textRenderer.set.text(this.trState,a)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(a){this._textRendererOverride=a,this.textRenderer.destroyState(this.trState);const d=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);if(!d){console.warn("Text Renderer not found for font",this.trState.props.fontFamily);return}this.textRenderer=d,this.trState=this.createState(this.trState.props)}get fontSize(){return this.trState.props.fontSize}set fontSize(a){this.textRenderer.set.fontSize(this.trState,a)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(a){this.textRenderer.set.fontFamily(this.trState,a)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(a){this.textRenderer.set.fontStretch(this.trState,a)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(a){this.textRenderer.set.fontStyle(this.trState,a)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(a){this.textRenderer.set.fontWeight(this.trState,a)}get textAlign(){return this.trState.props.textAlign}set textAlign(a){this.textRenderer.set.textAlign(this.trState,a)}get contain(){return this.trState.props.contain}set contain(a){this.textRenderer.set.contain(this.trState,a)}get scrollable(){return this.trState.props.scrollable}set scrollable(a){this.textRenderer.set.scrollable(this.trState,a)}get scrollY(){return this.trState.props.scrollY}set scrollY(a){this.textRenderer.set.scrollY(this.trState,a)}get offsetY(){return this.trState.props.offsetY}set offsetY(a){this.textRenderer.set.offsetY(this.trState,a)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(a){this.textRenderer.set.letterSpacing(this.trState,a)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(a){this.textRenderer.set.lineHeight(this.trState,a)}get maxLines(){return this.trState.props.maxLines}set maxLines(a){this.textRenderer.set.maxLines(this.trState,a)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(a){this.textRenderer.set.textBaseline(this.trState,a)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(a){this.textRenderer.set.verticalAlign(this.trState,a)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(a){this.textRenderer.set.overflowSuffix(this.trState,a)}get debug(){return this.trState.props.debug}set debug(a){this.textRenderer.set.debug(this.trState,a)}update(a,d){super.update(a,d),this.globalTransform,this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkBasicRenderability(){return this.worldAlpha===0||this.isOutOfBounds()===!0?!1:!!(this.trState&&this.trState.props.text!=="")}setRenderable(a){super.setRenderable(a),this.textRenderer.setIsRenderable(this.trState,a)}renderQuads(a){var d;if(this.globalTransform,!this.textRenderer.renderQuads){super.renderQuads(a);return}this.parentHasRenderTexture&&(!a.renderToTextureActive||this.parentRenderTexture!==a.activeRttNode)||(this.parentHasRenderTexture&&((d=this.props.parent)!=null&&d.rtt)&&(this.globalTransform=gn.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),this.globalTransform,this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(a){const d=this.textRenderer.createState(a,this);return d.emitter.on("loaded",this.onTextLoaded),d.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(d),d}}function kb(h){const c={boolean:!0,string:!0,number:!0,undefined:!0},a=Object.keys(h);for(let d=0;d<a.length;d++){const m=a[d];if(!m)continue;const T=h[m],S=typeof T;S==="string"&&T.length>2048&&(console.warn("Custom Data value for ".concat(m," is too long, it will be truncated to 2048 characters")),h[m]=T.substring(0,2048)),c[S]||(console.warn("Custom Data value for ".concat(m," is not a boolean, string, or number, it will be ignored")),delete h[m])}return h}const _b=2e6;class Pb{constructor(c){_(this,"options");_(this,"animationManager");_(this,"txManager");_(this,"txMemManager");_(this,"fontManager");_(this,"textRenderers");_(this,"shManager");_(this,"renderer");_(this,"root");_(this,"interactiveNodes",new Set);_(this,"boundsMargin");_(this,"defShaderCtr");_(this,"strictBound");_(this,"preloadBound");_(this,"strictBounds");_(this,"defaultTexture",null);_(this,"targetFrameTime",0);_(this,"eventBus");_(this,"deltaTime",0);_(this,"lastFrameTime",0);_(this,"currentFrameTime",0);_(this,"fpsNumFrames",0);_(this,"fpsElapsedTime",0);_(this,"numQuadsRendered",0);_(this,"renderRequested",!1);_(this,"frameEventQueue",[]);_(this,"fontResolveMap",{});_(this,"contextSpy",null);this.options=c;const{canvas:a,clearColor:d,appWidth:m,appHeight:T,boundsMargin:S,enableContextSpy:p,forceWebGL2:k,numImageWorkers:L,textureMemory:j,renderEngine:P,fontEngines:V,createImageBitmapSupport:K,maxRetryCount:q}=c;this.eventBus=c.eventBus,this.targetFrameTime=c.targetFPS>0?1e3/c.targetFPS:0,this.txManager=new cb(this,{numImageWorkers:L,createImageBitmapSupport:K,maxRetryCount:q}),this.txManager.on("initialized",()=>{this.requestRender()}),this.txMemManager=new Ib(this,j),this.shManager=new Sb,this.animationManager=new XL,this.contextSpy=p?new Eb:null,this.strictBounds=c.strictBounds;let ee=[0,0,0,0];S&&(ee=Array.isArray(S)?S:[S,S,S,S]),this.boundsMargin=ee,this.strictBound=wa(0,0,m,T),this.preloadBound=_y(this.strictBound,ee);const ue={stage:this,canvas:a,pixelRatio:c.devicePhysicalPixelRatio*c.deviceLogicalPixelRatio,clearColor:d!=null?d:4278190080,bufferMemory:_b,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy,forceWebGL2:k};this.renderer=new P(ue);const fe=this.renderer.mode||"webgl";this.createDefaultTexture(),this.defShaderCtr=this.renderer.getDefShaderCtr(),CL(fe),this.txManager.renderer=this.renderer,this.textRenderers={},V.forEach(oe=>{const x=new oe(this),Y=x.type;if(Y==="sdf"&&fe==="canvas"){console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...");return}x instanceof xI&&(Y==="canvas"?this.textRenderers.canvas=x:Y==="sdf"&&(this.textRenderers.sdf=x))}),Object.keys(this.textRenderers).length===0&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new hb(this.textRenderers);const J=new Py(this,{x:0,y:0,width:m,height:T,alpha:1,autosize:!1,boundsMargin:null,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1,strictBounds:this.strictBounds});this.root=J,GL(this)}setClearColor(c){this.renderer.updateClearColor(c),this.renderRequested=!0}updateTargetFrameTime(){this.targetFrameTime=this.options.targetFPS>0?1e3/this.options.targetFPS:0}updateFrameTime(){const c=jf();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=c,this.deltaTime=this.lastFrameTime?c-this.lastFrameTime:100/6,this.txManager.frameTime=c,this.txMemManager.frameTime=c,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}createDefaultTexture(){this.defaultTexture=this.txManager.createTexture("ColorTexture",{color:4294967295}),this.defaultTexture instanceof Xf,this.txManager.loadTexture(this.defaultTexture,!0),this.defaultTexture.setRenderableOwner("stage",!0),this.defaultTexture.once("loaded",()=>{this.requestRender()})}updateAnimations(){const{animationManager:c}=this;this.root&&c.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested||this.txManager.hasUpdates()}drawFrame(){const{renderer:c,renderRequested:a}=this;this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),this.txManager.processSome(this.options.textureProcessingTimeLimit).catch(d=>{console.error("Error processing textures:",d)}),c.reset(),c.rttNodes.length>0&&c.renderRTTNodes(),this.addQuads(this.root),c==null||c.render(),this.calculateFps(),this.calculateQuads(),a&&(this.renderRequested=!1),this.txMemManager.criticalCleanupRequested===!0&&this.txMemManager.cleanup()}queueFrameEvent(c,a){this.frameEventQueue.push([c,a])}flushFrameEvents(){for(const[c,a]of this.frameEventQueue)this.eventBus.emit(c,a);this.frameEventQueue=[]}calculateFps(){var a,d,m;const{fpsUpdateInterval:c}=this.options;if(c&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=c)){const T=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:T,contextSpyData:(d=(a=this.contextSpy)==null?void 0:a.getData())!=null?d:null}),(m=this.contextSpy)==null||m.reset()}}calculateQuads(){const c=this.renderer.getQuadCount();c&&c!==this.numQuadsRendered&&(this.numQuadsRendered=c,this.queueFrameEvent("quadsUpdate",{quads:c}))}addQuads(c){this.renderer,c.isRenderable===!0&&c.renderQuads(this.renderer);for(let a=0;a<c.children.length;a++){const d=c.children[a];d!==void 0&&(d.worldAlpha===0||d.strictBounds===!0&&d.renderState===wn.OutOfBounds||this.addQuads(d))}}requestRender(){this.renderRequested=!0}findNodesAtPoint(c){const a=c.x/this.options.deviceLogicalPixelRatio,d=c.y/this.options.deviceLogicalPixelRatio,m=[];for(const T of this.interactiveNodes)T.isRenderable!==!1&&bL(a,d,T.renderBound)===!0&&m.push(T);return m}getNodeFromPosition(c){const a=this.findNodesAtPoint(c);if(a.length===0)return null;let d=a[0];for(let m=0;m<a.length;m++)a[m].zIndex>d.zIndex&&(d=a[m]);return d||null}resolveTextRenderer(c,a=null){const d="".concat(c.fontFamily).concat(c.fontStyle).concat(c.fontWeight).concat(c.fontStretch).concat(a||"");if(this.fontResolveMap[d]!==void 0)return this.fontResolveMap[d];let m=a,T=!1;if(m){const p=this.textRenderers[m];p?p.canRenderFont(c)||(console.warn("Cannot use override text renderer '".concat(m,"' for font"),c),m=null,T=!0):(console.warn("Text renderer override '".concat(m,"' not found.")),m=null,T=!0)}if(!m){for(const[p,k]of Object.entries(this.textRenderers))if(k.canRenderFont(c)){m=p;break}!m&&this.textRenderers.canvas!==void 0&&(m="canvas")}if(T&&console.warn("Falling back to text renderer ".concat(String(m))),!m)return null;const S=this.textRenderers[m];return this.fontResolveMap[d]=S,S}createShaderCtr(c,a){return this.shManager.loadShader(c,a)}createNode(c){const a=this.resolveNodeDefaults(c);return new Py(this,a)}createTextNode(c){var T,S,p,k,L,j,P,V,K,q,ee,ue,fe,J,oe,x,Y,me;const a=(T=c.fontSize)!=null?T:16,d={...this.resolveNodeDefaults(c),text:(S=c.text)!=null?S:"",textRendererOverride:(p=c.textRendererOverride)!=null?p:null,fontSize:a,fontFamily:(k=c.fontFamily)!=null?k:"sans-serif",fontStyle:(L=c.fontStyle)!=null?L:"normal",fontWeight:(j=c.fontWeight)!=null?j:"normal",fontStretch:(P=c.fontStretch)!=null?P:"normal",textAlign:(V=c.textAlign)!=null?V:"left",contain:(K=c.contain)!=null?K:"none",scrollable:(q=c.scrollable)!=null?q:!1,scrollY:(ee=c.scrollY)!=null?ee:0,offsetY:(ue=c.offsetY)!=null?ue:0,letterSpacing:(fe=c.letterSpacing)!=null?fe:0,lineHeight:c.lineHeight,maxLines:(J=c.maxLines)!=null?J:0,textBaseline:(oe=c.textBaseline)!=null?oe:"alphabetic",verticalAlign:(x=c.verticalAlign)!=null?x:"middle",overflowSuffix:(Y=c.overflowSuffix)!=null?Y:"...",debug:(me=c.debug)!=null?me:{},shaderProps:null},m=this.resolveTextRenderer(d,c.textRendererOverride);if(!m)throw new Error("No compatible text renderer found for ".concat(d.fontFamily));return new Rb(this,d,m)}setBoundsMargin(c){this.boundsMargin=Array.isArray(c)?c:[c,c,c,c],this.root.setUpdateType(he.RenderBounds)}resolveNodeDefaults(c){var k,L,j,P,V,K,q,ee,ue,fe,J,oe,x,Y,me,pe,we,C,ie,Z,ge,ce,se,ye,Oe,Tt,An,mn,Qt,Dn,Xn,F,Rt,Jr,Ft,zn,Kt,mr,Zr,nr,de,Xr,yr,rr,fi,yn,Be,ir,Ts,fh,hh,Pa,Da;const a=(k=c.color)!=null?k:4294967295,d=(P=(j=(L=c.colorTl)!=null?L:c.colorTop)!=null?j:c.colorLeft)!=null?P:a,m=(q=(K=(V=c.colorTr)!=null?V:c.colorTop)!=null?K:c.colorRight)!=null?q:a,T=(fe=(ue=(ee=c.colorBl)!=null?ee:c.colorBottom)!=null?ue:c.colorLeft)!=null?fe:a,S=(x=(oe=(J=c.colorBr)!=null?J:c.colorBottom)!=null?oe:c.colorRight)!=null?x:a;let p={};return this.options.inspector===!0&&(p=kb((Y=c.data)!=null?Y:{})),{x:(me=c.x)!=null?me:0,y:(pe=c.y)!=null?pe:0,width:(we=c.width)!=null?we:0,height:(C=c.height)!=null?C:0,alpha:(ie=c.alpha)!=null?ie:1,autosize:(Z=c.autosize)!=null?Z:!1,boundsMargin:(ge=c.boundsMargin)!=null?ge:null,clipping:(ce=c.clipping)!=null?ce:!1,color:a,colorTop:(se=c.colorTop)!=null?se:a,colorBottom:(ye=c.colorBottom)!=null?ye:a,colorLeft:(Oe=c.colorLeft)!=null?Oe:a,colorRight:(Tt=c.colorRight)!=null?Tt:a,colorBl:T,colorBr:S,colorTl:d,colorTr:m,zIndex:(An=c.zIndex)!=null?An:0,zIndexLocked:(mn=c.zIndexLocked)!=null?mn:0,parent:(Qt=c.parent)!=null?Qt:null,texture:(Dn=c.texture)!=null?Dn:null,textureOptions:(Xn=c.textureOptions)!=null?Xn:{},shader:(F=c.shader)!=null?F:this.defShaderCtr,src:(Rt=c.src)!=null?Rt:null,srcHeight:c.srcHeight,srcWidth:c.srcWidth,srcX:c.srcX,srcY:c.srcY,scale:(Jr=c.scale)!=null?Jr:null,scaleX:(zn=(Ft=c.scaleX)!=null?Ft:c.scale)!=null?zn:1,scaleY:(mr=(Kt=c.scaleY)!=null?Kt:c.scale)!=null?mr:1,mount:(Zr=c.mount)!=null?Zr:0,mountX:(de=(nr=c.mountX)!=null?nr:c.mount)!=null?de:0,mountY:(yr=(Xr=c.mountY)!=null?Xr:c.mount)!=null?yr:0,pivot:(rr=c.pivot)!=null?rr:.5,pivotX:(yn=(fi=c.pivotX)!=null?fi:c.pivot)!=null?yn:.5,pivotY:(ir=(Be=c.pivotY)!=null?Be:c.pivot)!=null?ir:.5,rotation:(Ts=c.rotation)!=null?Ts:0,rtt:(fh=c.rtt)!=null?fh:!1,data:p,preventCleanup:(hh=c.preventCleanup)!=null?hh:!1,imageType:c.imageType,interactive:(Pa=c.interactive)!=null?Pa:!1,strictBounds:(Da=c.strictBounds)!=null?Da:this.strictBounds}}cleanup(){this.txMemManager.cleanup()}}class Db extends xs{constructor(a,d){var ee,ue,fe,J,oe,x,Y,me,pe,we,C,ie,Z;super();_(this,"root");_(this,"canvas");_(this,"settings");_(this,"stage");_(this,"inspector",null);const m={criticalThreshold:((ee=a.textureMemory)==null?void 0:ee.criticalThreshold)||124e6,targetThresholdLevel:((ue=a.textureMemory)==null?void 0:ue.targetThresholdLevel)||.5,cleanupInterval:((fe=a.textureMemory)==null?void 0:fe.cleanupInterval)||5e3,debugLogging:((J=a.textureMemory)==null?void 0:J.debugLogging)||!1,baselineMemoryAllocation:((oe=a.textureMemory)==null?void 0:oe.baselineMemoryAllocation)||26e6,doNotExceedCriticalThreshold:((x=a.textureMemory)==null?void 0:x.doNotExceedCriticalThreshold)||!1},T={appWidth:a.appWidth||1920,appHeight:a.appHeight||1080,textureMemory:m,boundsMargin:a.boundsMargin||0,deviceLogicalPixelRatio:a.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:a.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:(Y=a.clearColor)!=null?Y:0,fpsUpdateInterval:a.fpsUpdateInterval||0,targetFPS:a.targetFPS||0,numImageWorkers:a.numImageWorkers!==void 0?a.numImageWorkers:2,enableContextSpy:(me=a.enableContextSpy)!=null?me:!1,forceWebGL2:(pe=a.forceWebGL2)!=null?pe:!1,inspector:(we=a.inspector)!=null?we:!1,renderEngine:a.renderEngine,quadBufferSize:(C=a.quadBufferSize)!=null?C:4*1024*1024,fontEngines:a.fontEngines,strictBounds:(ie=a.strictBounds)!=null?ie:!0,textureProcessingTimeLimit:a.textureProcessingTimeLimit||42,canvas:a.canvas||document.createElement("canvas"),createImageBitmapSupport:a.createImageBitmapSupport||"full",maxRetryCount:(Z=a.maxRetryCount)!=null?Z:5};this.settings=T;const{appWidth:S,appHeight:p,deviceLogicalPixelRatio:k,devicePhysicalPixelRatio:L,inspector:j,canvas:P}=T,V=S*k,K=p*k;this.canvas=P,P.width=V*L,P.height=K*L,P.style.width="".concat(V,"px"),P.style.height="".concat(K,"px"),this.stage=new Pb({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,forceWebGL2:this.settings.forceWebGL2,fpsUpdateInterval:this.settings.fpsUpdateInterval,targetFPS:this.settings.targetFPS,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:m,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines,inspector:this.settings.inspector!==null,strictBounds:this.settings.strictBounds,textureProcessingTimeLimit:this.settings.textureProcessingTimeLimit,createImageBitmapSupport:this.settings.createImageBitmapSupport,maxRetryCount:this.settings.maxRetryCount}),this.root=this.stage.root;let q;if(typeof d=="string"?q=document.getElementById(d):q=d,!q)throw new Error("Could not find target element");q.appendChild(P)}createNode(a){const d=this.stage.createNode(a);return this.inspector?this.inspector.createNode(d):d}createTextNode(a){const d=this.stage.createTextNode(a);return this.inspector?this.inspector.createTextNode(d):d}destroyNode(a){return this.inspector&&this.inspector.destroyNode(a.id),a.destroy()}createTexture(a,d){return this.stage.txManager.createTexture(a,d)}createShader(a,d){return this.stage.shManager.loadShader(a,d)}createDynamicShader(a){return this.stage.shManager.loadDynamicShader({effects:a})}createEffect(a,d,m){return{name:m,type:a,props:d}}getNodeById(a){var T;const d=(T=this.stage)==null?void 0:T.root;if(!d)return null;const m=S=>{if(S.id===a)return S;for(const p of S.children){const k=m(p);if(k)return k}return null};return m(d)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){this.stage.requestRender()}cleanup(){this.stage.cleanup()}setClearColor(a){this.stage.setClearColor(a)}get targetFPS(){return this.stage.options.targetFPS}set targetFPS(a){this.stage.options.targetFPS=a>0?a:0,this.stage.updateTargetFrameTime()}}class TI extends xs{constructor(a){super();_(this,"fontFamily");_(this,"descriptors");_(this,"loaded",!1);_(this,"metrics",null);const{fontFamily:d,descriptors:m,metrics:T}=a;T&&(this.metrics={ascender:T.ascender/T.unitsPerEm,descender:T.descender/T.unitsPerEm,lineGap:T.lineGap/T.unitsPerEm}),this.fontFamily=d,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...m}}static convertToCssFontFaceDescriptors(a){return{style:a.style,weight:typeof a.weight=="number"?"".concat(a.weight):a.weight,stretch:a.stretch,unicodeRange:a.unicodeRange,featureSettings:a.featureSettings,display:a.display}}}class Lb extends TI{constructor(a){super(a);_(this,"fontFace");_(this,"fontUrl");const{fontFamily:d,fontUrl:m}=a,T=m.replace(/\(|\)/g,""),S=this.descriptors;let p={style:S.style,weight:typeof S.weight=="number"?"".concat(S.weight):S.weight,stretch:S.stretch,unicodeRange:S.unicodeRange,featureSettings:S.featureSettings,display:S.display};for(const L in p){const j=L;p[j]===void 0&&delete p[j]}const k=new FontFace(d,"url(".concat(T,")"),p);T.length>0?k.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=k,this.fontUrl=m}}class bb{}class wI extends bb{constructor(a,d,m,T,S,p,k,L,j,P,V,K,q){super();_(this,"glw");_(this,"options");_(this,"buffers");_(this,"shader");_(this,"shaderProps");_(this,"alpha");_(this,"clippingRect");_(this,"dimensions");_(this,"bufferIdx");_(this,"zIndex");_(this,"renderToTexture");_(this,"parentHasRenderTexture");_(this,"framebufferDimensions");_(this,"length",0);_(this,"numQuads",0);_(this,"textures",[]);_(this,"maxTextures");this.glw=a,this.options=d,this.buffers=m,this.shader=T,this.shaderProps=S,this.alpha=p,this.clippingRect=k,this.dimensions=L,this.bufferIdx=j,this.zIndex=P,this.renderToTexture=V,this.parentHasRenderTexture=K,this.framebufferDimensions=q,this.maxTextures=T.supportsIndexedTextures?a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(a){const{textures:d,maxTextures:m}=this;let T=-1;const S=d.length;for(let p=0;p<S;p++)if(d[p]===a){T=p;break}return T!==-1?T:S>=m?4294967295:(this.textures.push(a),S)}draw(){const{glw:a,shader:d,shaderProps:m,options:T}=this,{shManager:S}=T;S.useShader(d),d.bindRenderOp(this,m);const p=this.bufferIdx/32*6*2;if(this.clippingRect.valid){const{x:k,y:L,width:j,height:P}=this.clippingRect,V=this.parentHasRenderTexture?1:T.pixelRatio,K=T.canvas.height,q=Math.round(k*V),ee=Math.round(j*V),ue=Math.round(P*V);let fe=Math.round(K-ue-L*V);this.parentHasRenderTexture&&(fe=this.framebufferDimensions?this.framebufferDimensions.height-this.dimensions.height:0),a.setScissorTest(!0),a.scissor(q,fe,ee,ue)}else a.setScissorTest(!1);a.drawElements(a.TRIANGLES,6*this.numQuads,a.UNSIGNED_SHORT,p)}}function Nb(h){const c={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(c).forEach(d=>{c[d]=h.getParameter(h[d])}),c}function Ob(h){const c={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(c).forEach(d=>{c[d]=h.getExtension(d)}),c}function Ub(h,c){const a=~~(c/80),d=new Uint16Array(a*6);for(let T=0,S=0;T<a;T+=6,S+=4)d[T]=S,d[T+1]=S+1,d[T+2]=S+2,d[T+3]=S+2,d[T+4]=S+1,d[T+5]=S+3;const m=h.createBuffer();h.elementArrayBufferData(m,d,h.STATIC_DRAW)}function jb(h){return h!==null&&(typeof h=="object"&&h.constructor&&h.constructor.name==="HTMLImageElement"||typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement)}const Bb=new Uint8Array([0,0,0,0]);class Zy extends Cb{constructor(a,d,m){super(d,m);_(this,"glw");_(this,"_nativeCtxTexture",null);_(this,"_w",0);_(this,"_h",0);_(this,"txCoordX1",0);_(this,"txCoordY1",0);_(this,"txCoordX2",1);_(this,"txCoordY2",1);this.glw=a}checkGLError(){if(this.state==="failed")return!0;const a=this.glw.getError();return a!==0?(this.state="failed",this.textureSource.setState("failed",new Error("WebGL Error: ".concat(a))),!0):!1}get ctxTexture(){return this.state==="freed"?(this.load(),null):(this._nativeCtxTexture,this._nativeCtxTexture)}get w(){return this._w}get h(){return this._h}async load(){if(this.state==="loading"||this.state==="loaded")return Promise.resolve();if(this.state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this._nativeCtxTexture===null){this.state="failed",this.textureSource.setState("failed",new Error("WebGL Texture creation failed"));return}try{const{width:a,height:d}=await this.onLoadRequest();if(this.state==="freed")return;this.state="loaded",this._w=a,this._h=d,this.textureSource.setState("loaded",{width:a,height:d}),this.textureSource.freeTextureData()}catch(a){if(this.state==="freed")return;this.state="failed",this.textureSource.setState("failed")}}async onLoadRequest(){var j,P;const{glw:a}=this,d=this.textureSource.textureData;if(this.state==="failed")return{width:0,height:0};if(d===null||this._nativeCtxTexture===null)return this.state="failed",this.textureSource.setState("failed",new Error("No texture data available")),{width:0,height:0};a.texImage2D(0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,null),this.setTextureMemUse(Bb.byteLength);let m=0,T=0;if(a.activeTexture(0),this.checkGLError()===!0)return{width:0,height:0};const S=d.data,p=a.RGBA,k=4,L=1.1;if(typeof ImageBitmap<"u"&&S instanceof ImageBitmap||S instanceof ImageData||jb(S)){if(m=S.width,T=S.height,a.bindTexture(this._nativeCtxTexture),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!d.premultiplyAlpha),a.texImage2D(0,p,p,a.UNSIGNED_BYTE,S),this.checkGLError()===!0)return{width:0,height:0};this.setTextureMemUse(T*m*k*L)}else if(S&&"mipmaps"in S&&S.mipmaps){const{mipmaps:V,type:K,blockInfo:q}=S;if(sb[K](a,this._nativeCtxTexture,S),this.checkGLError()===!0)return{width:0,height:0};m=S.width,T=S.height,this.txCoordX2=m/(Math.ceil(m/q.width)*q.width),this.txCoordY2=T/(Math.ceil(T/q.height)*q.height),this.setTextureMemUse((P=(j=V[0])==null?void 0:j.byteLength)!=null?P:0)}else if(S&&S instanceof Uint8Array){if(m=1,T=1,a.bindTexture(this._nativeCtxTexture),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!d.premultiplyAlpha),a.texImage2D(0,p,m,T,0,p,a.UNSIGNED_BYTE,S),this.checkGLError()===!0)return{width:0,height:0};this.setTextureMemUse(m*T*k)}else return console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",d),this.state="failed",this.textureSource.setState("failed",new Error("Unexpected texture data")),{width:0,height:0};return{width:m,height:T}}free(){this.state!=="freed"&&(this.state="freed",this.textureSource.setState("freed"),this.release())}release(){this._w=0,this._h=0,this._nativeCtxTexture!==null&&(this.glw.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null),this.textureSource.freeTextureData()}createNativeCtxTexture(){const{glw:a}=this,d=a.createTexture();return!d||(a.activeTexture(0),a.bindTexture(d),a.texParameteri(a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.getError()!==0)?null:d}}class Fb extends Zy{constructor(c,a,d){super(c,a,d)}async onLoadRequest(){var a,d;const c=this.textureSource.textureData;return c.data instanceof Uint8Array?{width:1,height:1}:{width:((a=c.data)==null?void 0:a.width)||0,height:((d=c.data)==null?void 0:d.height)||0}}}class SI{constructor(c){_(this,"config");this.config=c}getBuffer(c){var a;return(a=this.config.find(d=>d.attributes[c]))==null?void 0:a.buffer}getAttributeInfo(c){var a;return(a=this.config.find(d=>d.attributes[c]))==null?void 0:a.attributes[c]}}function Vb(h){return self.WebGL2RenderingContext&&h instanceof self.WebGL2RenderingContext}class Hb{constructor(c){_(this,"gl");_(this,"activeTextureUnit",0);_(this,"texture2dUnits");_(this,"texture2dParams",new WeakMap);_(this,"scissorEnabled");_(this,"scissorX");_(this,"scissorY");_(this,"scissorWidth");_(this,"scissorHeight");_(this,"blendEnabled");_(this,"blendSrcRgb");_(this,"blendDstRgb");_(this,"blendSrcAlpha");_(this,"blendDstAlpha");_(this,"boundArrayBuffer");_(this,"boundElementArrayBuffer");_(this,"curProgram");_(this,"canvas");_(this,"MAX_RENDERBUFFER_SIZE");_(this,"MAX_TEXTURE_SIZE");_(this,"MAX_VIEWPORT_DIMS");_(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");_(this,"MAX_TEXTURE_IMAGE_UNITS");_(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");_(this,"MAX_VERTEX_ATTRIBS");_(this,"MAX_VARYING_VECTORS");_(this,"MAX_VERTEX_UNIFORM_VECTORS");_(this,"MAX_FRAGMENT_UNIFORM_VECTORS");_(this,"TEXTURE_MAG_FILTER");_(this,"TEXTURE_MIN_FILTER");_(this,"TEXTURE_WRAP_S");_(this,"TEXTURE_WRAP_T");_(this,"LINEAR");_(this,"LINEAR_MIPMAP_LINEAR");_(this,"CLAMP_TO_EDGE");_(this,"RGB");_(this,"RGBA");_(this,"UNSIGNED_BYTE");_(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");_(this,"UNPACK_FLIP_Y_WEBGL");_(this,"FLOAT");_(this,"TRIANGLES");_(this,"UNSIGNED_SHORT");_(this,"ONE");_(this,"ONE_MINUS_SRC_ALPHA");_(this,"VERTEX_SHADER");_(this,"FRAGMENT_SHADER");_(this,"STATIC_DRAW");_(this,"COMPILE_STATUS");_(this,"LINK_STATUS");_(this,"DYNAMIC_DRAW");_(this,"COLOR_ATTACHMENT0");_(this,"INVALID_ENUM");_(this,"INVALID_OPERATION");this.gl=c,this.activeTextureUnit=c.getParameter(c.ACTIVE_TEXTURE)-c.TEXTURE0;const a=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(a).fill(void 0).map((m,T)=>(this.activeTexture(T),c.getParameter(c.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=c.isEnabled(c.SCISSOR_TEST);const d=c.getParameter(c.SCISSOR_BOX);this.scissorX=d[0],this.scissorY=d[1],this.scissorWidth=d[2],this.scissorHeight=d[3],this.blendEnabled=c.isEnabled(c.BLEND),this.blendSrcRgb=c.getParameter(c.BLEND_SRC_RGB),this.blendDstRgb=c.getParameter(c.BLEND_DST_RGB),this.blendSrcAlpha=c.getParameter(c.BLEND_SRC_ALPHA),this.blendDstAlpha=c.getParameter(c.BLEND_DST_ALPHA),this.boundArrayBuffer=c.getParameter(c.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=c.getParameter(c.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=c.getParameter(c.CURRENT_PROGRAM),this.canvas=c.canvas,this.MAX_RENDERBUFFER_SIZE=c.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=c.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=c.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=c.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=c.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=c.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=c.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=c.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=c.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=c.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=c.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=c.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=c.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=c.TEXTURE_WRAP_T,this.LINEAR=c.LINEAR,this.LINEAR_MIPMAP_LINEAR=c.LINEAR_MIPMAP_LINEAR,this.CLAMP_TO_EDGE=c.CLAMP_TO_EDGE,this.RGB=c.RGB,this.RGBA=c.RGBA,this.UNSIGNED_BYTE=c.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=c.UNPACK_FLIP_Y_WEBGL,this.FLOAT=c.FLOAT,this.TRIANGLES=c.TRIANGLES,this.UNSIGNED_SHORT=c.UNSIGNED_SHORT,this.ONE=c.ONE,this.ONE_MINUS_SRC_ALPHA=c.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=c.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=c.TRIANGLES,this.UNSIGNED_SHORT=c.UNSIGNED_SHORT,this.VERTEX_SHADER=c.VERTEX_SHADER,this.FRAGMENT_SHADER=c.FRAGMENT_SHADER,this.STATIC_DRAW=c.STATIC_DRAW,this.COMPILE_STATUS=c.COMPILE_STATUS,this.LINK_STATUS=c.LINK_STATUS,this.DYNAMIC_DRAW=c.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=c.COLOR_ATTACHMENT0,this.INVALID_ENUM=c.INVALID_ENUM,this.INVALID_OPERATION=c.INVALID_OPERATION}isWebGl2(){return Vb(this.gl)}activeTexture(c){const{gl:a}=this;this.activeTextureUnit!==c&&(a.activeTexture(c+a.TEXTURE0),this.activeTextureUnit=c)}bindTexture(c){const{gl:a,activeTextureUnit:d,texture2dUnits:m}=this;m[d]!==c&&(m[d]=c,a.bindTexture(this.gl.TEXTURE_2D,c))}_getActiveTexture(){const{activeTextureUnit:c,texture2dUnits:a}=this;return a[c]}texParameteri(c,a){const{gl:d,texture2dParams:m}=this,T=this._getActiveTexture();if(!T)throw new Error("No active texture");let S=m.get(T);S||(S={},m.set(T,S)),S[c]!==a&&(S[c]=a,d.texParameteri(d.TEXTURE_2D,c,a))}texImage2D(c,a,d,m,T,S,p,k){const{gl:L}=this;S?L.texImage2D(L.TEXTURE_2D,c,a,d,m,T,S,p,k):L.texImage2D(L.TEXTURE_2D,c,a,d,m,T)}compressedTexImage2D(c,a,d,m,T,S){const{gl:p}=this;p.compressedTexImage2D(p.TEXTURE_2D,c,a,d,m,T,S)}pixelStorei(c,a){const{gl:d}=this;d.pixelStorei(c,a)}generateMipmap(){const{gl:c}=this;c.generateMipmap(c.TEXTURE_2D)}createTexture(){const{gl:c}=this;return c.createTexture()}deleteTexture(c){const{gl:a}=this;c&&this.texture2dParams.delete(c),a.deleteTexture(c)}deleteFramebuffer(c){this.gl.deleteFramebuffer(c)}viewport(c,a,d,m){const{gl:T}=this;T.viewport(c,a,d,m)}clearColor(c,a,d,m){const{gl:T}=this;T.clearColor(c,a,d,m)}setScissorTest(c){const{gl:a,scissorEnabled:d}=this;c!==d&&(c?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST),this.scissorEnabled=c)}scissor(c,a,d,m){const{gl:T,scissorX:S,scissorY:p,scissorWidth:k,scissorHeight:L}=this;(c!==S||a!==p||d!==k||m!==L)&&(T.scissor(c,a,d,m),this.scissorX=c,this.scissorY=a,this.scissorWidth=d,this.scissorHeight=m)}setBlend(c){const{gl:a,blendEnabled:d}=this;c!==d&&(c?a.enable(a.BLEND):a.disable(a.BLEND),this.blendEnabled=c)}blendFunc(c,a){const{gl:d,blendSrcRgb:m,blendDstRgb:T,blendSrcAlpha:S,blendDstAlpha:p}=this;(c!==m||a!==T||c!==S||a!==p)&&(d.blendFunc(c,a),this.blendSrcRgb=c,this.blendDstRgb=a,this.blendSrcAlpha=c,this.blendDstAlpha=a)}createBuffer(){const{gl:c}=this;return c.createBuffer()}createFramebuffer(){const{gl:c}=this;return c.createFramebuffer()}bindFramebuffer(c){const{gl:a}=this;a.bindFramebuffer(a.FRAMEBUFFER,c)}framebufferTexture2D(c,a,d){const{gl:m}=this;m.framebufferTexture2D(m.FRAMEBUFFER,c,m.TEXTURE_2D,a,d)}clear(){const{gl:c}=this;c.clear(c.COLOR_BUFFER_BIT)}arrayBufferData(c,a,d){const{gl:m,boundArrayBuffer:T}=this;T!==c&&(m.bindBuffer(m.ARRAY_BUFFER,c),this.boundArrayBuffer=c),m.bufferData(m.ARRAY_BUFFER,a,d)}elementArrayBufferData(c,a,d){const{gl:m,boundElementArrayBuffer:T}=this;T!==c&&(m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c),this.boundElementArrayBuffer=c),m.bufferData(m.ELEMENT_ARRAY_BUFFER,a,d)}vertexAttribPointer(c,a,d,m,T,S,p){const{gl:k,boundArrayBuffer:L}=this;L!==c&&(k.bindBuffer(k.ARRAY_BUFFER,c),this.boundArrayBuffer=c),k.vertexAttribPointer(a,d,m,T,S,p)}getUniformLocations(c){const a=this.gl,d=a.getProgramParameter(c,a.ACTIVE_UNIFORMS),m={};for(let T=0;T<d;T++){let p=a.getActiveUniform(c,T).name.replace(/\[.*?\]/g,"");m[p]=a.getUniformLocation(c,p)}return m}getAttributeLocations(c){const a=this.gl,d=a.getProgramParameter(c,a.ACTIVE_ATTRIBUTES),m=[];for(let T=0;T<d;T++){const{name:S}=a.getActiveAttrib(c,T);m[a.getAttribLocation(c,S)]=S}return m}useProgram(c){const{gl:a,curProgram:d}=this;d!==c&&(a.useProgram(c),this.curProgram=c)}uniform1f(c,a){const{gl:d}=this;d.uniform1f(c,a)}uniform1fv(c,a){const{gl:d}=this;d.uniform1fv(c,a)}uniform1i(c,a){const{gl:d}=this;d.uniform1i(c,a)}uniform1iv(c,a){const{gl:d}=this;d.uniform1iv(c,a)}uniform2f(c,a,d){const{gl:m}=this;m.uniform2f(c,a,d)}uniform2fv(c,a){const{gl:d}=this;d.uniform2fv(c,a)}uniform2i(c,a,d){const{gl:m}=this;m.uniform2i(c,a,d)}uniform2iv(c,a){const{gl:d}=this;d.uniform2iv(c,a)}uniform3f(c,a,d,m){const{gl:T}=this;T.uniform3f(c,a,d,m)}uniform3fv(c,a){const{gl:d}=this;d.uniform3fv(c,a)}uniform3i(c,a,d,m){const{gl:T}=this;T.uniform3i(c,a,d,m)}uniform3iv(c,a){const{gl:d}=this;d.uniform3iv(c,a)}uniform4f(c,a,d,m,T){const{gl:S}=this;S.uniform4f(c,a,d,m,T)}uniform4fv(c,a){const{gl:d}=this;d.uniform4fv(c,a)}uniform4i(c,a,d,m,T){const{gl:S}=this;S.uniform4i(c,a,d,m,T)}uniform4iv(c,a){const{gl:d}=this;d.uniform4iv(c,a)}uniformMatrix2fv(c,a){const{gl:d}=this;d.uniformMatrix2fv(c,!1,a)}uniformMatrix3fv(c,a){const{gl:d}=this;d.uniformMatrix3fv(c,!1,a)}uniformMatrix4fv(c,a){const{gl:d}=this;d.uniformMatrix4fv(c,!1,a)}getParameter(c){const{gl:a}=this;return a.getParameter(c)}drawElements(c,a,d,m){const{gl:T}=this;T.drawElements(c,a,d,m)}getExtension(c){const{gl:a}=this;return a.getExtension(c)}getError(){const{gl:c}=this;return c.getError()}createVertexArray(){const{gl:c}=this;return c.createVertexArray()}bindVertexArray(c){const{gl:a}=this;a.bindVertexArray(c)}getAttribLocation(c,a){const{gl:d}=this;return d.getAttribLocation(c,a)}getUniformLocation(c,a){const{gl:d}=this;return d.getUniformLocation(c,a)}enableVertexAttribArray(c){const{gl:a}=this;a.enableVertexAttribArray(c)}disableVertexAttribArray(c){const{gl:a}=this;a.disableVertexAttribArray(c)}createShader(c){const{gl:a}=this;return a.createShader(c)}compileShader(c){const{gl:a}=this;a.compileShader(c)}attachShader(c,a){const{gl:d}=this;d.attachShader(c,a)}linkProgram(c){const{gl:a}=this;a.linkProgram(c)}deleteProgram(c){const{gl:a}=this;a.deleteProgram(c)}getShaderParameter(c,a){const{gl:d}=this;return d.getShaderParameter(c,a)}getShaderInfoLog(c){const{gl:a}=this;return a.getShaderInfoLog(c)}createProgram(){const{gl:c}=this;return c.createProgram()}getProgramParameter(c,a){const{gl:d}=this;return d.getProgramParameter(c,a)}getProgramInfoLog(c){const{gl:a}=this;return a.getProgramInfoLog(c)}shaderSource(c,a){const{gl:d}=this;d.shaderSource(c,a)}deleteShader(c){const{gl:a}=this;a.deleteShader(c)}checkError(c){const a=this.getError();if(a!==0){let d="UNKNOWN_ERROR";switch(a){case this.INVALID_ENUM:d="INVALID_ENUM";break;case 1281:d="INVALID_VALUE";break;case this.INVALID_OPERATION:d="INVALID_OPERATION";break;case 1285:d="OUT_OF_MEMORY";break;case 37442:d="CONTEXT_LOST_WEBGL";break}const m="WebGL ".concat(d," (0x").concat(a.toString(16),") during ").concat(c);return{error:a,errorName:d,message:m}}return null}}class Gb extends Zy{constructor(a,d,m){super(a,d,m);_(this,"framebuffer",null)}async onLoadRequest(){const{glw:a}=this,d=this._nativeCtxTexture=this.createNativeCtxTexture();if(!d)throw new Error("Failed to create native texture for RenderTexture");const{width:m,height:T}=this.textureSource;return this.framebuffer=a.createFramebuffer(),a.texImage2D(0,a.RGBA,m,T,0,a.RGBA,a.UNSIGNED_BYTE,null),this.setTextureMemUse(m*T*4),a.bindFramebuffer(this.framebuffer),a.framebufferTexture2D(a.COLOR_ATTACHMENT0,d,0),a.bindFramebuffer(null),{width:m,height:T}}free(){super.free(),this.glw.deleteFramebuffer(this.framebuffer),this.framebuffer=null}}class Xb extends Mb{constructor(a){super(a);_(this,"glw");_(this,"system");_(this,"quadBuffer");_(this,"fQuadBuffer");_(this,"uiQuadBuffer");_(this,"renderOps",[]);_(this,"curBufferIdx",0);_(this,"curRenderOp",null);_(this,"rttNodes",[]);_(this,"activeRttNode",null);_(this,"defShaderCtrl");_(this,"defaultShader");_(this,"quadBufferCollection");_(this,"clearColor",{raw:0,normalized:[0,0,0,0]});_(this,"quadBufferUsage",0);_(this,"numQuadsRendered",0);_(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:d,clearColor:m,bufferMemory:T}=a,S=EL(d,a.forceWebGL2,a.contextSpy),p=this.glw=new Hb(S);p.viewport(0,0,d.width,d.height),this.updateClearColor(m),p.setBlend(!0),p.blendFunc(p.ONE,p.ONE_MINUS_SRC_ALPHA),Ub(p,T),this.system={parameters:Nb(this.glw),extensions:Ob(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const k=p.createBuffer(),L=8*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new SI([{buffer:k,attributes:{a_position:{name:"a_position",size:2,type:p.FLOAT,normalized:!1,stride:L,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:p.FLOAT,normalized:!1,stride:L,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:p.UNSIGNED_BYTE,normalized:!0,stride:L,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:p.FLOAT,normalized:!1,stride:L,offset:5*Float32Array.BYTES_PER_ELEMENT},a_nodeCoordinate:{name:"a_nodeCoordinate",size:2,type:p.FLOAT,normalized:!1,stride:L,offset:6*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:a}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,a.setScissorTest(!1),a.clear()}getShaderManager(){return this.shManager}createCtxTexture(a){return a instanceof zf?new Fb(this.glw,this.txMemManager,a):a instanceof Wf?new Gb(this.glw,this.txMemManager,a):new Zy(this.glw,this.txMemManager,a)}addQuad(a){var ue,fe;const{fQuadBuffer:d,uiQuadBuffer:m}=this;let T=a.texture;if(a.shader!==this.defaultShader){if(Gf(a.shaderProps,"$dimensions")==!0){const J=a.shaderProps.$dimensions;J.width=a.width,J.height=a.height}Gf(a.shaderProps,"$alpha")===!0&&(a.shaderProps.$alpha=a.alpha)}let{curBufferIdx:S,curRenderOp:p}=this;const k={width:a.width,height:a.height};this.reuseRenderOp(a)===!1&&(this.newRenderOp(a.shader,a.shaderProps,a.alpha,k,a.clippingRect,S,a.rtt,a.parentHasRenderTexture,a.framebufferDimensions),p=this.curRenderOp);let L,j=0,P=0,V=1,K=1;if(T.type===Hn.subTexture){const{x:J,y:oe,width:x,height:Y}=T.props,{width:me=0,height:pe=0}=T.parentTexture.dimensions||{width:0,height:0};j=J/me,V=j+x/me,P=oe/pe,K=P+Y/pe,T=T.parentTexture,L=T.ctxTexture}else L=T.ctxTexture,j=L.txCoordX1,P=L.txCoordY1,V=L.txCoordX2,K=L.txCoordY2;if(T.type===Hn.image&&a.textureOptions!==null&&a.textureOptions.resizeMode!==void 0&&T.dimensions!==null){const J=a.textureOptions.resizeMode,{width:oe,height:x}=T.dimensions;if(J.type==="cover"){const Y=a.width/oe,me=a.height/x,pe=Math.max(Y,me),we=1/pe;if(pe&&Y&&Y<pe){const C=we*a.width;j=(1-C/oe)*((ue=J.clipX)!=null?ue:.5),V=j+C/oe}if(pe&&me&&me<pe){const C=we*a.height;P=(1-C/x)*((fe=J.clipY)!=null?fe:.5),K=P+C/x}}}let q=0;a.textureOptions!==null&&(a.textureOptions.flipX===!0&&([j,V]=[V,j]),q=+(a.textureOptions.flipY||!1)),q^+(T.type===Hn.renderToTexture)&&([P,K]=[K,P]);const ee=this.addTexture(L,S);if(this.curRenderOp,a.renderCoords)d[S++]=a.renderCoords.x1,d[S++]=a.renderCoords.y1,d[S++]=j,d[S++]=P,m[S++]=a.colorTl,d[S++]=ee,d[S++]=0,d[S++]=0,d[S++]=a.renderCoords.x2,d[S++]=a.renderCoords.y2,d[S++]=V,d[S++]=P,m[S++]=a.colorTr,d[S++]=ee,d[S++]=1,d[S++]=0,d[S++]=a.renderCoords.x4,d[S++]=a.renderCoords.y4,d[S++]=j,d[S++]=K,m[S++]=a.colorBl,d[S++]=ee,d[S++]=0,d[S++]=1,d[S++]=a.renderCoords.x3,d[S++]=a.renderCoords.y3,d[S++]=V,d[S++]=K,m[S++]=a.colorBr,d[S++]=ee,d[S++]=1,d[S++]=1;else if(a.tb!==0||a.tc!==0)d[S++]=a.tx,d[S++]=a.ty,d[S++]=j,d[S++]=P,m[S++]=a.colorTl,d[S++]=ee,d[S++]=0,d[S++]=0,d[S++]=a.tx+a.width*a.ta,d[S++]=a.ty+a.width*a.tc,d[S++]=V,d[S++]=P,m[S++]=a.colorTr,d[S++]=ee,d[S++]=1,d[S++]=0,d[S++]=a.tx+a.height*a.tb,d[S++]=a.ty+a.height*a.td,d[S++]=j,d[S++]=K,m[S++]=a.colorBl,d[S++]=ee,d[S++]=0,d[S++]=1,d[S++]=a.tx+a.width*a.ta+a.height*a.tb,d[S++]=a.ty+a.width*a.tc+a.height*a.td,d[S++]=V,d[S++]=K,m[S++]=a.colorBr,d[S++]=ee,d[S++]=1,d[S++]=1;else{const J=a.tx+a.width*a.ta,oe=a.ty+a.height*a.td;d[S++]=a.tx,d[S++]=a.ty,d[S++]=j,d[S++]=P,m[S++]=a.colorTl,d[S++]=ee,d[S++]=0,d[S++]=0,d[S++]=J,d[S++]=a.ty,d[S++]=V,d[S++]=P,m[S++]=a.colorTr,d[S++]=ee,d[S++]=1,d[S++]=0,d[S++]=a.tx,d[S++]=oe,d[S++]=j,d[S++]=K,m[S++]=a.colorBl,d[S++]=ee,d[S++]=0,d[S++]=1,d[S++]=J,d[S++]=oe,d[S++]=V,d[S++]=K,m[S++]=a.colorBr,d[S++]=ee,d[S++]=1,d[S++]=1}this.curRenderOp.numQuads++,this.curBufferIdx=S}newRenderOp(a,d,m,T,S,p,k,L,j){const P=new wI(this.glw,this.options,this.quadBufferCollection,a,d,m,S,T,p,0,k,L,j);this.curRenderOp=P,this.renderOps.push(P)}addTexture(a,d,m){const{curRenderOp:T}=this,S=T.addTexture(a);if(S===4294967295){if(m)throw new Error("Unable to add texture to render op");return this.newRenderOp(T.shader,T.shaderProps,T.alpha,T.dimensions,T.clippingRect,d),this.addTexture(a,d,!0)}return S}reuseRenderOp(a){var k;const{shader:d,shaderProps:m,parentHasRenderTexture:T,rtt:S,clippingRect:p}=a;return!(((k=this.curRenderOp)==null?void 0:k.shader)!==d||DL(this.curRenderOp.clippingRect,p)===!1||T===!0||S===!0||this.curRenderOp.shader!==this.defaultShader&&this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,m)===!1)}addRenderOp(a){this.renderOps.push(a),this.curRenderOp=null}render(a="screen"){const{glw:d,quadBuffer:m}=this,T=new Float32Array(m,0,this.curBufferIdx),S=this.quadBufferCollection.getBuffer("a_position")||null;d.arrayBufferData(S,T,d.STATIC_DRAW);for(let k=0,L=this.renderOps.length;k<L;k++)this.renderOps[k].draw();this.quadBufferUsage=this.curBufferIdx*T.BYTES_PER_ELEMENT;const p=4*(8*T.BYTES_PER_ELEMENT);this.numQuadsRendered=this.quadBufferUsage/p}getQuadCount(){return this.numQuadsRendered}renderToTexture(a){for(let d=0;d<this.rttNodes.length;d++)if(this.rttNodes[d]===a)return;this.insertRTTNodeInOrder(a)}insertRTTNodeInOrder(a){let d=this.rttNodes.length,m=a;for(;m&&m.parent;){const S=this.rttNodes.indexOf(m.parent);if(S!==-1){d=S;break}m=m.parent}const T=this.findMaxChildRTTIndex(a);T!==-1&&(d=Math.max(d,T+1)),this.rttNodes.splice(d,0,a)}findMaxChildRTTIndex(a){let d=-1;const m=T=>{const S=this.rttNodes.indexOf(T);S!==-1&&(d=Math.max(d,S));for(const p of T.children)m(p)};return m(a),d}renderRTTNodes(){const{glw:a}=this,{txManager:d}=this.stage;for(let T=0;T<this.rttNodes.length;T++){const S=this.rttNodes[T];if(S===void 0||S.hasRTTupdates===!1||S.worldAlpha===0||S.strictBounds===!0&&S.renderState===wn.OutOfBounds||S.texture===null||S.texture.state!=="loaded")continue;this.activeRttNode=S,S.texture;const p=S.texture.ctxTexture;this.renderToTextureActive=!0,a.bindFramebuffer(p.framebuffer),a.viewport(0,0,p.w,p.h),a.clearColor(0,0,0,0),a.clear();for(let k=0;k<S.children.length;k++){const L=S.children[k];L!==void 0&&(this.stage.addQuads(L),L.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,S.hasRTTupdates=!1}const m=this.clearColor.normalized;a.clearColor(m[0],m[1],m[2],m[3]),a.bindFramebuffer(null),a.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(a){const d=this.rttNodes.indexOf(a);d!==-1&&this.rttNodes.splice(d,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}updateClearColor(a){if(this.clearColor.raw===a)return;const d=this.glw,m=ih(a);d.clearColor(m[0],m[1],m[2],m[3]),this.clearColor={raw:a,normalized:m},d.clear()}}const zb={LINE_FEED:10};class Wb{}class Kb extends Wb{constructor(a,d){super();_(this,"data");_(this,"glyphMap");_(this,"kernings");this.data=a,this.glyphMap=d;const m=this.kernings={};a.kernings.forEach(T=>{const S=T.second,p=m[S]=m[S]||{};p[T.first]=T.amount}),this.kernings=m}*shapeText(a,d){var S;let m,T;for(;(m=d.peek())&&!m.done;){const p=m.value,k=this.glyphMap.get(p);if(d.next(),k!==void 0){const L=T!==void 0?(((S=this.kernings[k.id])==null?void 0:S[T])||0)+a.letterSpacing:0;T=k.id,yield{mapped:!0,glyphId:k.id,codepoint:p,cluster:d.lastIndex,xAdvance:k.xadvance+L,yAdvance:0,xOffset:k.xoffset+L,yOffset:k.yoffset,xBearing:0,yBearing:0,width:k.width,height:k.height}}else p===zb.LINE_FEED&&(T=void 0),yield{mapped:!1,codepoint:p,cluster:d.lastIndex}}}}class AI extends TI{constructor(a,d){super(d);_(this,"type");_(this,"texture");_(this,"maxCharHeight",0);_(this,"shaper");_(this,"glyphMap",new Map);_(this,"data");const{atlasUrl:m,atlasDataUrl:T,stage:S}=d;this.type=a,S.renderer,this.texture=S.txManager.createTexture("ImageTexture",{src:m,premultiplyAlpha:!1}),S.txManager.loadTexture(this.texture,!0),this.texture.preventCleanup=!0,this.texture.on("loaded",()=>{this.checkLoaded(),S.requestRender()}),hI(T).then(p=>{var L;this.data=JSON.parse(p),this.data;let k=0;if(this.data.chars.forEach(j=>{this.glyphMap.set(j.id,j);const P=j.yoffset+j.height;P>k&&(k=P)}),this.maxCharHeight=k,this.shaper=new Kb(this.data,this.glyphMap),!this.metrics)if((L=this.data)!=null&&L.lightningMetrics){const{ascender:j,descender:P,lineGap:V,unitsPerEm:K}=this.data.lightningMetrics;this.metrics={ascender:j/K,descender:P/K,lineGap:V/K}}else throw new Error("Font metrics not found in ".concat(this.type," font ").concat(this.fontFamily,". ")+"Make sure you are using the latest version of the Lightning 3 `msdf-generator` tool to generate your SDF fonts.");this.checkLoaded()}).catch(console.error)}getAtlasEntry(a){const d=this.glyphMap.get(a);if(d===void 0)throw new Error("Glyph ".concat(a," not found in font ").concat(this.fontFamily));return{x:d.x,y:d.y,width:d.width,height:d.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const $b={LEGACY:!1},gy=!!$b,en={debug:!1,focusDebug:!1,keyDebug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100},setActiveElement:()=>{},focusStateKey:"$focus",lockStyles:!0};let Gr;function Yb(h,c="app"){return Gr=new Db(h,c),Gr}function qb(h){for(const c of h)Gr.stage.renderer.mode==="webgl"&&"type"in c&&(c.type==="msdf"||c.type==="ssdf")?Gr.stage.fontManager.addFontFace(new AI(c.type,{...c,stage:Gr.stage})):"fontUrl"in c&&Gr.stage.fontManager.addFontFace(new Lb(c))}const Ea={Element:"element",TextNode:"textNode",Text:"text"};function my(h,c,...a){}const yy=h=>h instanceof Function,dl=h=>typeof h=="function";function Oy(h){return Array.isArray(h)}function ME(h){return typeof h=="string"}function Qb(h){return typeof h=="number"}function RE(h){return"destroy"in h&&typeof h.destroy=="function"}function da(h){return h instanceof vs}function ml(h){return h._type===Ea.TextNode}function Jb(h){return h._type===Ea.Text}function Zb(h,c){for(const a of c)if(a in h)return!0;return!1}function Tj(h){var c;return(c=h==null?void 0:h.states)==null?void 0:c.has(en.focusStateKey)}class kE extends Array{constructor(a,d={}){var c=(...Rj)=>(super(...Rj),_(this,"onChange"),this);return Oy(d)?c(...d):ME(d)?c(d):c(...Object.entries(d).filter(([m,T])=>T).map(([m])=>m)),this.onChange=a,this}has(a){return this.indexOf(a)>=0||this.indexOf("$".concat(a))>=0}is(a){return this.indexOf(a)>=0}add(a){this.has(a)||(this.push(a),this.onChange())}toggle(a,d){d===!0?this.add(a):d===!1?this.remove(a):this.has(a)?this.remove(a):this.add(a)}merge(a){if(Oy(a))this.length=0,this.push(...a);else if(ME(a))this.length=0,this.push(a);else for(const d in a)if(a[d])this.has(d)||this.push(d);else{const T=this.indexOf(d);T>=0&&this.splice(T,1)}return this}remove(a){const d=this.indexOf(a);d>=0&&(this.splice(d,1),this.onChange())}}function _E(h){var we,C,ie;const a=(h.flexDirection||"row")==="row",d=a?"width":"height",m=a?"height":"width",T=a?"marginLeft":"marginTop",S=a?"marginTop":"marginLeft",p=a?"marginRight":"marginBottom",k=a?"marginBottom":"marginRight",L=[];let j=!1,P=0;for(let Z=0;Z<h.children.length;Z++){const ge=h.children[Z];if(ml(ge)&&ge.text&&!(ge.width||ge.height))return!1;if(Jb(ge)||ge.flexItem===!1)continue;const ce=ge.flexOrder;ce!==void 0&&(j=!0);const se=ge.flexGrow,ye=se!==void 0&&se>=0;ye&&(P+=se);const Oe=ge[d]||0,Tt=ge[T]||0,An=ge[p]||0;L.push({node:ge,mainSize:Oe,marginStart:Tt,marginEnd:An,totalMainSizeOnAxis:Oe+Tt+An,isGrowItem:ye,flexGrowValue:ye?se:0,flexOrder:ce||0,crossSize:ge[m]||0,crossMarginStart:ge[S]||0,crossMarginEnd:ge[k]||0})}j?L.sort((Z,ge)=>Z.flexOrder-ge.flexOrder):h.direction==="rtl"&&L.reverse();const V=L.length;if(V===0)return!1;const K=a?"x":"y",q=a?"y":"x",ee=h[d]||0;let ue=h[m]||0;const fe=h.gap||0,J=h.justifyContent||"flexStart";let oe=!1;if(P>0&&V>1){h.flexBoundary=h.flexBoundary||"fixed";let Z=0;for(const se of L)Z+=se.mainSize+se.marginStart+se.marginEnd;const ge=V>0?fe*(V-1):0,ce=ee-Z-ge;if(ce>0){for(const se of L)if(se.isGrowItem&&se.flexGrowValue>0){const ye=se.flexGrowValue/P*ce,Oe=se.mainSize+ye;se.node[d]=Oe,se.mainSize=Oe,se.totalMainSizeOnAxis=Oe+se.marginStart+se.marginEnd}h._containsFlexGrow=h._containsFlexGrow?null:!0}else h._containsFlexGrow?h._containsFlexGrow=null:console.warn("No available space for flex-grow items to expand, or items overflow.")}let x=0;if(J==="center"||J==="spaceBetween"||J==="spaceEvenly"||J==="spaceAround")for(const Z of L)x+=Z.totalMainSizeOnAxis;const Y=h.alignItems||(h.flexWrap?"flexStart":void 0),me=ue?(Z,ge=0)=>{const ce=Z.node.alignSelf||Y;ce&&(ce==="flexStart"?Z.node[q]=ge+Z.crossMarginStart:ce==="center"?Z.node[q]=ge+(ue-Z.crossSize)/2+Z.crossMarginStart:ce==="flexEnd"&&(Z.node[q]=ge+ue-Z.crossSize-Z.crossMarginEnd))}:(Z,ge=0)=>{};if(a&&h._calcHeight&&!h.flexCrossBoundary){const ge=L.reduce((ce,se)=>Math.max(ce,se.crossSize),0)||h.height;ge!==h.height&&(oe=!0,h.height=ue=ge)}let pe=h.padding||0;if(J==="flexStart"){if(h.flexWrap==="wrap"){let Z=0;const ge=((we=L[0])==null?void 0:we.crossSize)||ue,ce=a?(C=h.columnGap)!=null?C:fe:(ie=h.rowGap)!=null?ie:fe;for(const ye of L)pe+ye.totalMainSizeOnAxis>ee&&pe>(h.padding||0)&&(pe=h.padding||0,Z+=ge+ce),ye.node[K]=pe+ye.marginStart,pe+=ye.totalMainSizeOnAxis+fe,me(ye,Z);const se=Z+ge;h[m]!==se&&(h["preFlex".concat(m)]=h[m],h[m]=se,oe=!0)}else for(const Z of L)Z.node[K]=pe+Z.marginStart,pe+=Z.totalMainSizeOnAxis+fe,me(Z);if(h.flexBoundary!=="fixed"&&h.flexWrap!=="wrap"){const Z=pe-fe+(h.padding||0);if(Z!==ee)return h["preFlex".concat(d)]=ee,h[d]=Z,!0}}else if(J==="flexEnd"){pe=ee-(h.padding||0);for(let Z=V-1;Z>=0;Z--){const ge=L[Z];ge.node[K]=pe-ge.mainSize-ge.marginEnd,pe-=ge.totalMainSizeOnAxis+fe,me(ge)}}else if(J==="center"){pe=(ee-(x+fe*(V-1)))/2+(h.padding||0);for(const Z of L)Z.node[K]=pe+Z.marginStart,pe+=Z.totalMainSizeOnAxis+fe,me(Z)}else if(J==="spaceBetween"){const Z=V>1?(ee-x-(h.padding||0)*2)/(V-1):0;pe=h.padding||0;for(const ge of L)ge.node[K]=pe+ge.marginStart,pe+=ge.totalMainSizeOnAxis+Z,me(ge)}else if(J==="spaceAround"){const Z=V>0?(ee-x-(h.padding||0)*2)/V:0;pe=(h.padding||0)+Z/2;for(const ge of L)ge.node[K]=pe+ge.marginStart,pe+=ge.totalMainSizeOnAxis+Z,me(ge)}else if(J==="spaceEvenly"){const Z=(ee-x-(h.padding||0)*2)/(V+1);pe=Z+(h.padding||0);for(const ge of L)ge.node[K]=pe+ge.marginStart,pe+=ge.totalMainSizeOnAxis+Z,me(ge)}return oe}const fl={ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Enter",l:"Last"," ":"Space",Backspace:"Back",Escape:"Escape"},Uy={},PE=(h,c)=>{for(const[a,d]of Object.entries(h))Array.isArray(d)?d.forEach(m=>{c[m]=a}):d===null?delete c[a]:c[d]=a};let DE=!0;const e3=(h,c)=>{if(DE){const a=document.createElement("style");a.type="text/css",a.innerHTML='\n      [data-focus="3"] {\n        border: 2px solid rgba(255, 33, 33, 0.2);\n        border-radius: 5px;\n        transition: border-color 0.3s ease;\n      }\n\n      [data-focus="2"] {\n        border: 2px solid rgba(255, 33, 33, 0.4);\n        border-radius: 5px;\n        transition: border-color 0.3s ease;\n      }\n\n      [data-focus="1"] {\n        border: 4px solid rgba(255, 33, 33, 0.9);\n        border-radius: 5px;\n        transition: border-color 0.5s ease;\n      }\n    ',document.head.appendChild(a),DE=!1}h.forEach(a=>{a.data={...a.data,focus:void 0}}),c.forEach((a,d)=>{a.data={...a.data,focus:d+1}})};let LE;const t3=h=>{n3(h,LE),LE=h,en.setActiveElement(h)};let Js=[];const n3=(h,c)=>{var m,T;let a=h;const d=[];for(;a;)(!a.states.has(en.focusStateKey)||a===h)&&(a.states.add(en.focusStateKey),(m=a.onFocus)==null||m.call(a,h,c),(T=a.onFocusChanged)==null||T.call(a,!0,h,c)),d.push(a),a=a.parent;return Js.forEach(S=>{var p,k;d.includes(S)||(S.states.remove(en.focusStateKey),(p=S.onBlur)==null||p.call(S,h,c),(k=S.onFocusChanged)==null||k.call(S,!1,h,c))}),en.focusDebug&&e3(Js,d),Js=d,d};let bE=0,NE;const Df=(h,c,a=!1,d=!1)=>{const m=performance.now(),T=h.key||h.keyCode,S=NE===T;if(NE=T,!d&&en.throttleInput){if(S&&m-bE<en.throttleInput)return!1;bE=m}let p;const k=Js.length,L="onCapture".concat(c||h.key)+d?"Release":"",j=d?"onCaptureKeyRelease":"onCaptureKey";for(let q=k-1;q>=0;q--){const ee=Js[q];if(ee.throttleInput&&S&&ee._lastAnyKeyPressTime!==void 0&&m-ee._lastAnyKeyPressTime<ee.throttleInput)return!0;const ue=ee[L]||ee[j];if(dl(ue)&&ue.call(ee,h,ee,p,c)===!0)return ee._lastAnyKeyPressTime=m,!0}let P,V,K;c&&(P="on".concat(c),V="on".concat(c,"Release")),d||(K=a?"onKeyHold":"onKeyPress");for(let q=0;q<k;q++){const ee=Js[q];if(p||(p=ee),ee.throttleInput&&S&&ee._lastAnyKeyPressTime!==void 0&&m-ee._lastAnyKeyPressTime<ee.throttleInput)return!0;let ue=!1;if(d&&V){const fe=ee[V];dl(fe)&&fe.call(ee,h,ee,p)===!0&&(ue=!0)}else if(!d&&P){const fe=ee[P];dl(fe)&&fe.call(ee,h,ee,p)===!0&&(ue=!0)}if(!ue&&K){const fe=ee[K];dl(fe)&&fe.call(ee,h,c,ee,p)===!0&&(ue=!0)}if(ue)return ee._lastAnyKeyPressTime=m,!0}return!1},r3=500,Fi={},i3=(h,c,a)=>{if(c){const d=c.key||c.keyCode,m=Uy[c.key]||Uy[c.keyCode],T=fl[c.key]||fl[c.keyCode];if(m){Fi[d]||(Fi[d]=window.setTimeout(()=>{Fi[d]=!0,Df(c,m,!0)},h));return}Df(c,T,!1)}else if(a){const d=a.key||a.keyCode,m=fl[a.key]||fl[a.keyCode];Fi[d]===!0?delete Fi[d]:Fi[d]&&(clearTimeout(Fi[d]),delete Fi[d],Df(a,m,!1)),Df(a,m,!1,!0)}},s3=({userKeyMap:h,keyHoldOptions:c,ownerContext:a=d=>{d()}}={})=>{h&&PE(h,fl),c!=null&&c.userKeyHoldMap&&PE(c.userKeyHoldMap,Uy);const d=(c==null?void 0:c.holdThreshold)||r3,m=i3.bind(null,d),T=p=>a(()=>{m(p,void 0)}),S=p=>a(()=>{m(void 0,p)});return document.addEventListener("keyup",S),document.addEventListener("keydown",T),{cleanup:()=>{document.removeEventListener("keydown",T),document.removeEventListener("keyup",S);for(const[p,k]of Object.entries(Fi))k&&k!==!0&&clearTimeout(k)},focusPath:()=>Js}};class o3{constructor(){_(this,"nodeConfigs",[]);_(this,"isRegistered",!1);_(this,"stage")}register(c){this.isRegistered||(this.isRegistered=!0,this.stage=c,c.animationManager.registerAnimation(this))}add(c,a,d,m){var V,K;const T=this.nodeConfigs.find(q=>q.node===c&&q.propName===a),S=(V=m.duration)!=null?V:0,p=(K=m.delay)!=null?K:0,k=m.easing||"linear",L=fI(k),j=d,P=c[a];T?(T.duration=S,T.delay=p,T.easing=k,T.timingFunction=L,T.targetValue=j,T.startValue=P,T.progress=0,T.delayFor=p):this.nodeConfigs.push({node:c,duration:S,delay:p,easing:k,progress:0,delayFor:p,timingFunction:L,propName:a,startValue:P,targetValue:j})}update(c){var a;for(let d=this.nodeConfigs.length-1;d>=0;d--){const m=this.nodeConfigs[d],{node:T,duration:S,timingFunction:p,propName:k,startValue:L,targetValue:j}=m;let P=c;if(m.delayFor>0){if(m.delayFor-=P,m.delayFor>=0)continue;P=-m.delayFor,m.delayFor=0}S>0?(m.progress+=P/S,m.progress=Math.max(0,Math.min(1,m.progress))):S===0&&m.delayFor<=0&&(m.progress=1);const V=p(m.progress)||m.progress;let K;m.progress===1?K=j:k.includes("color")?K=ky(L,j,V):K=L+(j-L)*V,T.lng[k]=K,m.progress===1&&this.nodeConfigs.splice(d,1),this.nodeConfigs.length===0&&((a=this.stage)==null||a.animationManager.unregisterAnimation(this),this.isRegistered=!1)}}}const OE=new o3;let Cl=!1;const Ml=new Set;function EI(){Cl=!1;const h=[...Ml];Ml.clear();for(let c=h.length-1;c>=0;c--)h[c].updateLayout()}function UE(h){Ml.add(h),Cl||(Cl=!0,queueMicrotask(EI))}function vy(h,c){const a=[];for(let d in c){const m=c[d];d==="rounded"&&(d="radius"),typeof m=="object"&&a.push(Gr.createEffect(d,m,d))}return Gr.createShader("DynamicShader",{effects:a})}function ol(h=""){return{set(c){Qb(c)&&(c={width:c,color:255}),this.effects=this.effects?{...this.effects||{},["border".concat(h)]:c}:{["border".concat(h)]:c}},get(){var c;return(c=this.effects)==null?void 0:c["border".concat(h)]}}}const a3=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","scaleX","scaleY","width","worldX","worldY","x","y","zIndex","zIndexLocked"],u3=["absX","absY","autosize","clipping","contain","data","destroyed","fontFamily","fontStretch","fontStyle","fontWeight","imageType","letterSpacing","maxLines","offsetY","overflowSuffix","preventCleanup","rtt","scrollable","scrollY","srcHeight","srcWidth","srcX","srcY","strictBounds","text","textAlign","textBaseline","textOverflow","texture","textureOptions","verticalAlign","wordWrap"];class vs extends Object{constructor(c){super(),this._type=c==="text"?Ea.TextNode:Ea.Element,this.rendered=!1,this.lng={},this.children=[]}get effects(){return this._effects}set effects(c){this._effects=c,gy&&this.rendered&&(this.lng.shader=vy(this,c))}set id(c){var a;this._id=c,(a=en.rendererOptions)!=null&&a.inspector&&(this.data={...this.data,testId:c})}get id(){return this._id}get parent(){return this._parent}set parent(c){var a;this._parent=c,this.rendered&&(c!=null&&c.rendered)&&(this.lng.parent=(a=c.lng)!=null?a:null)}insertChild(c,a){if(c.parent&&(c.parent.removeChild(c),this.rendered||(this._hasRenderedChildren=!0)),c.parent=this,a){this.removeChild(c);const d=this.children.indexOf(a);if(d>=0){this.children.splice(d,0,c);return}}this.children.push(c)}removeChild(c){var d;const a=this.children.indexOf(c);a>=0&&(this.children.splice(a,1),(d=c.onRemove)==null||d.call(c,c))}get selectedNode(){const c=this.selected||0;for(let a=c;a<this.children.length;a++){const d=this.children[a];if(da(d))return this.selected=a,d}}set shader(c){this.lng.shader=Oy(c)?Gr.createShader(...c):c}_sendToLightningAnimatable(c,a){if(this.transition&&this.rendered&&en.animationsEnabled&&(this.transition===!0||this.transition[c])){const d=this.transition===!0||this.transition[c]===!0?void 0:this.transition[c];if(en.simpleAnimationsEnabled){OE.add(this,c,a,d||this.animationSettings),OE.register(Gr.stage);return}else{const m=this.animate({[c]:a},d);if(this.onAnimation){const T=Object.keys(this.onAnimation);for(const S of T){const p=this.onAnimation[S];m.on(S,(k,L)=>{p.call(this,k,c,a,L)})}}return m.start()}}this.lng[c]=a}animate(c,a){return this.lng.animate(c,a||this.animationSettings||{})}chain(c,a){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),a?this._animationQueueSettings=a:this._animationQueueSettings||(this._animationQueueSettings=a||this.animationSettings),a=a||this._animationQueueSettings,this._animationQueue=this._animationQueue||[],this._animationQueue.push({props:c,animationSettings:a}),this}async start(){let c=this._animationQueue.shift();for(;c;)this._animationRunning=!0,await this.animate(c.props,c.animationSettings).start().waitUntilStopped(),c=this._animationQueue.shift();this._animationRunning=!1,this._animationQueueSettings=void 0}emit(c,...a){let d=this;const m="on".concat(c.charAt(0).toUpperCase()).concat(c.slice(1));for(;d;){const T=d[m];if(dl(T)&&T.call(d,this,...a)===!0)return!0;d=d.parent}return!1}setFocus(){if(this.rendered){if(this.forwardFocus!==void 0)if(yy(this.forwardFocus)){if(this.forwardFocus.call(this,this)!==!1)return}else{const c=typeof this.forwardFocus=="number"?this.forwardFocus:null,a=this.children;if(c!==null&&c<a.length){const d=a[c];da(d)&&d.setFocus();return}}queueMicrotask(()=>t3(this))}else this._autofocus=!0}_layoutOnLoad(){this.lng.on("loaded",()=>{this.parent.updateLayout()})}getText(){let c="";for(let a=0;a<this.children.length;a++)c+=this.children[a].text;return c}destroy(){if(this.onDestroy){const c=this.onDestroy(this);c instanceof Promise?c.then(()=>this._destroy()):this._destroy()}else this._destroy()}_destroy(){var c;RE(this.lng)&&(this.lng.destroy(),(c=this.parent)!=null&&c.requiresLayout()&&this.parent.updateLayout())}set style(c){if(!(en.lockStyles&&this._style)&&c){this._style=c;for(const a in this._style)this[a]===void 0&&(this[a]=this._style[a])}}get style(){return this._style}get hasChildren(){return this.children.length>0}set src(c){typeof c=="string"?(this.lng.src=c,!this.color&&this.rendered&&(this.color=4294967295)):this.color=0}get src(){return this.lng.src}getChildById(c){return this.children.find(a=>a.id===c)}searchChildrenById(c){for(let a=0;a<this.children.length;a++){const d=this.children[a];if(da(d)){if(d.id===c)return d;const m=d.searchChildrenById(c);if(m)return m}}}set states(c){this._states=this._states?this._states.merge(c):new kE(this._stateChanged.bind(this),c),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new kE(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||en.animationSettings}set animationSettings(c){this._animationSettings=c}set hidden(c){this.alpha=c?0:1}get hidden(){return this.alpha===0}get h(){return this.height}set h(c){this.height=c}get w(){return this.width}set w(c){this.width=c}set autofocus(c){this._autofocus=c,c&&queueMicrotask(()=>this.setFocus())}get autofocus(){return this._autofocus}requiresLayout(){return this.display==="flex"||this.onLayout}set updateLayoutOn(c){this.updateLayout()}get updateLayoutOn(){return null}updateLayout(){if(this.hasChildren){if(this.display==="flex"&&this.flexGrow&&this.width===0)return;const c=this.display==="flex"&&_E(this);Ml.delete(this);const a=yy(this.onLayout)&&this.onLayout.call(this,this);(c||a)&&this.parent&&UE(this.parent),this._containsFlexGrow===!0&&this.children.forEach(d=>{d.display==="flex"&&da(d)&&(_E(d),yy(d.onLayout)&&d.onLayout.call(d,d),UE(this))})}}_stateChanged(){if(this.forwardStates){const a=this.states.slice();this.children.forEach(d=>{d.states=a})}const c=this.states;if(this._undoStyles||Zb(this,c)){let a;this._undoStyles&&this._undoStyles.length&&(a={},this._undoStyles.forEach(T=>{a[T]=this.style[T]}));const d=c.length;if(d===0){Object.assign(this,a),this._undoStyles=[];return}let m;d===1?(m=this[c[0]],m=a?{...a,...m}:m):m=c.reduce((T,S)=>{const p=this[S];return p?{...T,...p}:T},a||{}),m?(this._undoStyles=Object.keys(m),m.transition!==void 0&&(this.transition=m.transition),Object.assign(this,m)):this._undoStyles=[]}}render(c){var p,k,L,j;const a=this,d=this.parent;if(!d){console.warn("Parent not set - no node created for: ",this);return}if(!d.rendered){console.warn("Parent not rendered yet: ",this);return}if(d.requiresLayout()&&Ml.add(d),this.rendered){(p=this.onRender)==null||p.call(this,this);return}this._states&&this._stateChanged();const m=a.lng,T=d.width||0,S=d.height||0;if(m.x=m.x||0,m.y=m.y||0,m.parent=d.lng,(this.right||this.right===0)&&(m.x=T-this.right,m.mountX=1),(this.bottom||this.bottom===0)&&(m.y=S-this.bottom,m.mountY=1),this.center&&(this.centerX=this.centerY=!0),this.centerX&&(m.x+=T/2,m.mountX=.5),this.centerY&&(m.y+=S/2,m.mountY=.5),ml(a)){const P=m;if(en.fontSettings)for(const V in en.fontSettings)P[V]===void 0&&(P[V]=en.fontSettings[V]);P.text=P.text||a.getText(),P.textAlign&&!P.contain&&console.warn("Text align requires contain: ",a.getText()),P.contain&&(P.width||(P.width=T-P.x-(P.marginRight||0)),P.contain==="both"&&!P.height&&!P.maxLines?P.height=S-P.y-(P.marginBottom||0):P.maxLines===1&&(P.height=P.height||P.lineHeight||P.fontSize)),gy&&a._effects&&(m.shader=vy(a,a._effects)),a.lng=Gr.createTextNode(m),d.requiresLayout()&&(!m.width||!m.height)&&a._layoutOnLoad()}else if(m.texture||(isNaN(m.width)&&(m.width=a.flexGrow?0:T-m.x,a._calcWidth=!0),isNaN(m.height)&&(m.height=S-m.y,a._calcHeight=!0),m.rtt&&!m.color&&(m.color=4294967295),!m.color&&!m.src&&(m.color=0)),gy&&a._effects&&(m.shader=vy(a,a._effects)),a.lng=Gr.createNode(m),a._hasRenderedChildren){a._hasRenderedChildren=!1;for(const P of a.children)da(P)&&RE(P.lng)&&(P.lng.parent=a.lng)}if(a.rendered=!0,a.autosize&&d.requiresLayout()&&a._layoutOnLoad(),(k=this.onCreate)==null||k.call(this,this),(L=this.onRender)==null||L.call(this,this),a.onEvent)for(const[P,V]of Object.entries(a.onEvent))a.lng.on(P,(K,q)=>V.call(a,a,q));if((j=a.lng)!=null&&j.div&&(a.lng.div.element=a),a._type===Ea.Element){const P=a.children.length;for(let V=0;V<P;V++){const K=a.children[V];da(K)&&K.render()}}c&&!Cl&&(Cl=!0,queueMicrotask(EI)),a._autofocus&&a.setFocus()}}for(const h of a3)Object.defineProperty(vs.prototype,h,{get(){return this.lng[h]},set(c){this._sendToLightningAnimatable(h,c)}});for(const h of u3)Object.defineProperty(vs.prototype,h,{get(){return this.lng[h]},set(c){this.lng[h]=c}});function xy(h){return{set(c){this.effects=this.effects?{...this.effects,[h]:c}:{[h]:c}},get(){var c;return(c=this.effects)==null?void 0:c[h]}}}Object.defineProperties(vs.prototype,{border:ol(),borderLeft:ol("Left"),borderRight:ol("Right"),borderTop:ol("Top"),borderBottom:ol("Bottom"),linearGradient:xy("linearGradient"),radialGradient:xy("radialGradient"),radialProgress:xy("radialProgressGradient"),rounded:{set(h){this.effects=this.effects?{...this.effects,radius:{radius:h}}:{radius:{radius:h}}},get(){var h,c;return(c=(h=this.effects)==null?void 0:h.radius)==null?void 0:c.radius}},borderRadius:{set(h){this.effects=this.effects?{...this.effects,radius:{radius:h}}:{radius:{radius:h}}},get(){var h,c;return(c=(h=this.effects)==null?void 0:h.radius)==null?void 0:c.radius}}});const It={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return jE(this.context.count)},getNextContextId(){return jE(this.context.count++)}};function jE(h){const c=String(h),a=c.length-1;return It.context.id+(a?String.fromCharCode(96+a):"")+c}function hl(h){It.context=h}const II=!1,l3=(h,c)=>h===c,jy=Symbol("solid-proxy"),c3=typeof Proxy=="function",d3=Symbol("solid-track"),Kf={equals:l3};let CI=LI;const Xi=1,$f=2,MI={owned:null,cleanups:null,context:null,owner:null},Ty={};var xt=null;let wy=null,f3=null,Mt=null,Gn=null,Gi=null,sh=0;function Ia(h,c){const a=Mt,d=xt,m=h.length===0,T=d,S=m?MI:{owned:null,cleanups:null,context:T?T.context:null,owner:T},p=m?h:()=>h(()=>tr(()=>Rl(S)));xt=S,Mt=null;try{return di(p,!0)}finally{Mt=a,xt=d}}function gr(h,c){c=c?Object.assign({},Kf,c):Kf;const a={value:h,observers:null,observerSlots:null,comparator:c.equals||void 0},d=m=>(typeof m=="function"&&(m=m(a.value)),DI(a,m));return[PI.bind(a),d]}function h3(h,c,a){const d=ah(h,c,!0,Xi);Ma(d)}function Qr(h,c,a){const d=ah(h,c,!1,Xi);Ma(d)}function RI(h,c,a){CI=T3;const d=ah(h,c,!1,Xi);d.user=!0,Gi?Gi.push(d):Ma(d)}function tn(h,c,a){a=a?Object.assign({},Kf,a):Kf;const d=ah(h,c,!0,0);return d.observers=null,d.observerSlots=null,d.comparator=a.equals||void 0,Ma(d),PI.bind(d)}function p3(h){return h&&typeof h=="object"&&"then"in h}function By(h,c,a){let d,m,T;d=!0,m=h,T={};let S=null,p=Ty,k=null,L=!1,j="initialValue"in T,P=typeof d=="function"&&tn(d);const V=new Set,[K,q]=(T.storage||gr)(T.initialValue),[ee,ue]=gr(void 0),[fe,J]=gr(void 0,{equals:!1}),[oe,x]=gr(j?"ready":"unresolved");It.context&&(k=It.getNextContextId(),T.ssrLoadFrom==="initial"?p=T.initialValue:It.load&&It.has(k)&&(p=It.load(k)));function Y(ie,Z,ge,ce){return S===ie&&(S=null,ce!==void 0&&(j=!0),(ie===p||Z===p)&&T.onHydrated&&queueMicrotask(()=>T.onHydrated(ce,{value:Z})),p=Ty,me(Z,ge)),Z}function me(ie,Z){di(()=>{Z===void 0&&q(()=>ie),x(Z!==void 0?"errored":j?"ready":"unresolved"),ue(Z);for(const ge of V.keys())ge.decrement();V.clear()},!1)}function pe(){const ie=y3,Z=K(),ge=ee();if(ge!==void 0&&!S)throw ge;return Mt&&Mt.user,Z}function we(ie=!0){if(ie!==!1&&L)return;L=!1;const Z=P?P():d;if(Z==null||Z===!1){Y(S,tr(K));return}let ge;const ce=p!==Ty?p:tr(()=>{try{return m(Z,{value:K(),refetching:ie})}catch(se){ge=se}});if(ge!==void 0){Y(S,void 0,Ff(ge),Z);return}else if(!p3(ce))return Y(S,ce,void 0,Z),ce;return S=ce,"v"in ce?(ce.s===1?Y(S,ce.v,void 0,Z):Y(S,void 0,Ff(ce.v),Z),ce):(L=!0,queueMicrotask(()=>L=!1),di(()=>{x(j?"refreshing":"pending"),J()},!1),ce.then(se=>Y(ce,se,void 0,Z),se=>Y(ce,void 0,Ff(se),Z)))}Object.defineProperties(pe,{state:{get:()=>oe()},error:{get:()=>ee()},loading:{get(){const ie=oe();return ie==="pending"||ie==="refreshing"}},latest:{get(){if(!j)return pe();const ie=ee();if(ie&&!S)throw ie;return K()}}});let C=xt;return P?h3(()=>(C=xt,we(!1))):we(!1),[pe,{refetch:ie=>Ll(C,()=>we(ie)),mutate:q}]}function g3(h){return di(h,!1)}function tr(h){if(Mt===null)return h();const c=Mt;Mt=null;try{return h()}finally{Mt=c}}function Pl(h,c,a){const d=Array.isArray(h);let m,T=a&&a.defer;return S=>{let p;if(d){p=Array(h.length);for(let L=0;L<h.length;L++)p[L]=h[L]()}else p=h();if(T)return T=!1,S;const k=tr(()=>c(p,m,S));return m=p,k}}function oh(h){return xt===null||(xt.cleanups===null?xt.cleanups=[h]:xt.cleanups.push(h)),h}function Dl(){return xt}function Ll(h,c){const a=xt,d=Mt;xt=h,Mt=null;try{return di(c,!0)}catch(m){tv(m)}finally{xt=a,Mt=d}}function m3(h){const c=Mt,a=xt;return Promise.resolve().then(()=>{Mt=c,xt=a,di(h,!1),Mt=xt=null})}const[wj,Sj]=gr(!1);function kI(h,c){const a=Symbol("context");return{id:a,Provider:w3(a),defaultValue:h}}function _I(h){let c;return xt&&xt.context&&(c=xt.context[h.id])!==void 0?c:h.defaultValue}function ev(h){const c=tn(h),a=tn(()=>Fy(c()));return a.toArray=()=>{const d=a();return Array.isArray(d)?d:d!=null?[d]:[]},a}let y3;function PI(){if(this.sources&&this.state)if(this.state===Xi)Ma(this);else{const h=Gn;Gn=null,di(()=>qf(this),!1),Gn=h}if(Mt){const h=this.observers?this.observers.length:0;Mt.sources?(Mt.sources.push(this),Mt.sourceSlots.push(h)):(Mt.sources=[this],Mt.sourceSlots=[h]),this.observers?(this.observers.push(Mt),this.observerSlots.push(Mt.sources.length-1)):(this.observers=[Mt],this.observerSlots=[Mt.sources.length-1])}return this.value}function DI(h,c,a){let d=h.value;return(!h.comparator||!h.comparator(d,c))&&(h.value=c,h.observers&&h.observers.length&&di(()=>{for(let m=0;m<h.observers.length;m+=1){const T=h.observers[m],S=wy&&wy.running;S&&wy.disposed.has(T),(S?!T.tState:!T.state)&&(T.pure?Gn.push(T):Gi.push(T),T.observers&&bI(T)),S||(T.state=Xi)}if(Gn.length>1e6)throw Gn=[],new Error},!1)),c}function Ma(h){if(!h.fn)return;Rl(h);const c=sh;v3(h,h.value,c)}function v3(h,c,a){let d;const m=xt,T=Mt;Mt=xt=h;try{d=h.fn(c)}catch(S){return h.pure&&(h.state=Xi,h.owned&&h.owned.forEach(Rl),h.owned=null),h.updatedAt=a+1,tv(S)}finally{Mt=T,xt=m}(!h.updatedAt||h.updatedAt<=a)&&(h.updatedAt!=null&&"observers"in h?DI(h,d):h.value=d,h.updatedAt=a)}function ah(h,c,a,d=Xi,m){const T={fn:h,state:d,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:c,owner:xt,context:xt?xt.context:null,pure:a};return xt===null||xt!==MI&&(xt.owned?xt.owned.push(T):xt.owned=[T]),T}function Yf(h){if(h.state===0)return;if(h.state===$f)return qf(h);if(h.suspense&&tr(h.suspense.inFallback))return h.suspense.effects.push(h);const c=[h];for(;(h=h.owner)&&(!h.updatedAt||h.updatedAt<sh);)h.state&&c.push(h);for(let a=c.length-1;a>=0;a--)if(h=c[a],h.state===Xi)Ma(h);else if(h.state===$f){const d=Gn;Gn=null,di(()=>qf(h,c[0]),!1),Gn=d}}function di(h,c){if(Gn)return h();let a=!1;c||(Gn=[]),Gi?a=!0:Gi=[],sh++;try{const d=h();return x3(a),d}catch(d){a||(Gi=null),Gn=null,tv(d)}}function x3(h){if(Gn&&(LI(Gn),Gn=null),h)return;const c=Gi;Gi=null,c.length&&di(()=>CI(c),!1)}function LI(h){for(let c=0;c<h.length;c++)Yf(h[c])}function T3(h){let c,a=0;for(c=0;c<h.length;c++){const d=h[c];d.user?h[a++]=d:Yf(d)}if(It.context){if(It.count){It.effects||(It.effects=[]),It.effects.push(...h.slice(0,a));return}hl()}for(It.effects&&(It.done||!It.count)&&(h=[...It.effects,...h],a+=It.effects.length,delete It.effects),c=0;c<a;c++)Yf(h[c])}function qf(h,c){h.state=0;for(let a=0;a<h.sources.length;a+=1){const d=h.sources[a];if(d.sources){const m=d.state;m===Xi?d!==c&&(!d.updatedAt||d.updatedAt<sh)&&Yf(d):m===$f&&qf(d,c)}}}function bI(h){for(let c=0;c<h.observers.length;c+=1){const a=h.observers[c];a.state||(a.state=$f,a.pure?Gn.push(a):Gi.push(a),a.observers&&bI(a))}}function Rl(h){let c;if(h.sources)for(;h.sources.length;){const a=h.sources.pop(),d=h.sourceSlots.pop(),m=a.observers;if(m&&m.length){const T=m.pop(),S=a.observerSlots.pop();d<m.length&&(T.sourceSlots[S]=d,m[d]=T,a.observerSlots[d]=S)}}if(h.tOwned){for(c=h.tOwned.length-1;c>=0;c--)Rl(h.tOwned[c]);delete h.tOwned}if(h.owned){for(c=h.owned.length-1;c>=0;c--)Rl(h.owned[c]);h.owned=null}if(h.cleanups){for(c=h.cleanups.length-1;c>=0;c--)h.cleanups[c]();h.cleanups=null}h.state=0}function Ff(h){return h instanceof Error?h:new Error(typeof h=="string"?h:"Unknown error",{cause:h})}function tv(h,c=xt){throw Ff(h)}function Fy(h){if(typeof h=="function"&&!h.length)return Fy(h());if(Array.isArray(h)){const c=[];for(let a=0;a<h.length;a++){const d=Fy(h[a]);Array.isArray(d)?c.push.apply(c,d):c.push(d)}return c}return h}function w3(h,c){return function(d){let m;return Qr(()=>m=tr(()=>(xt.context={...xt.context,[h]:d.value},ev(()=>d.children))),void 0),m}}const S3=Symbol("fallback");function BE(h){for(let c=0;c<h.length;c++)h[c]()}function A3(h,c,a={}){let d=[],m=[],T=[],S=0,p=c.length>1?[]:null;return oh(()=>BE(T)),()=>{let k=h()||[],L=k.length,j,P;return k[d3],tr(()=>{let K,q,ee,ue,fe,J,oe,x,Y;if(L===0)S!==0&&(BE(T),T=[],d=[],m=[],S=0,p&&(p=[])),a.fallback&&(d=[S3],m[0]=Ia(me=>(T[0]=me,a.fallback())),S=1);else if(S===0){for(m=new Array(L),P=0;P<L;P++)d[P]=k[P],m[P]=Ia(V);S=L}else{for(ee=new Array(L),ue=new Array(L),p&&(fe=new Array(L)),J=0,oe=Math.min(S,L);J<oe&&d[J]===k[J];J++);for(oe=S-1,x=L-1;oe>=J&&x>=J&&d[oe]===k[x];oe--,x--)ee[x]=m[oe],ue[x]=T[oe],p&&(fe[x]=p[oe]);for(K=new Map,q=new Array(x+1),P=x;P>=J;P--)Y=k[P],j=K.get(Y),q[P]=j===void 0?-1:j,K.set(Y,P);for(j=J;j<=oe;j++)Y=d[j],P=K.get(Y),P!==void 0&&P!==-1?(ee[P]=m[j],ue[P]=T[j],p&&(fe[P]=p[j]),P=q[P],K.set(Y,P)):T[j]();for(P=J;P<L;P++)P in ee?(m[P]=ee[P],T[P]=ue[P],p&&(p[P]=fe[P],p[P](P))):m[P]=Ia(V);m=m.slice(0,S=L),d=k.slice(0)}return m});function V(K){if(T[P]=K,p){const[q,ee]=gr(P);return p[P]=ee,c(k[P],q)}return c(k[P])}}}function NI(h,c){return tr(()=>h(c||{}))}function Lf(){return!0}const E3={get(h,c,a){return c===jy?a:h.get(c)},has(h,c){return c===jy?!0:h.has(c)},set:Lf,deleteProperty:Lf,getOwnPropertyDescriptor(h,c){return{configurable:!0,enumerable:!0,get(){return h.get(c)},set:Lf,deleteProperty:Lf}},ownKeys(h){return h.keys()}};function Sy(h){return(h=typeof h=="function"?h():h)?h:{}}function I3(){for(let h=0,c=this.length;h<c;++h){const a=this[h]();if(a!==void 0)return a}}function nv(...h){let c=!1;for(let S=0;S<h.length;S++){const p=h[S];c=c||!!p&&jy in p,h[S]=typeof p=="function"?(c=!0,tn(p)):p}if(c3&&c)return new Proxy({get(S){for(let p=h.length-1;p>=0;p--){const k=Sy(h[p])[S];if(k!==void 0)return k}},has(S){for(let p=h.length-1;p>=0;p--)if(S in Sy(h[p]))return!0;return!1},keys(){const S=[];for(let p=0;p<h.length;p++)S.push(...Object.keys(Sy(h[p])));return[...new Set(S)]}},E3);const a={},d=Object.create(null);for(let S=h.length-1;S>=0;S--){const p=h[S];if(!p)continue;const k=Object.getOwnPropertyNames(p);for(let L=k.length-1;L>=0;L--){const j=k[L];if(j==="__proto__"||j==="constructor")continue;const P=Object.getOwnPropertyDescriptor(p,j);if(!d[j])d[j]=P.get?{enumerable:!0,configurable:!0,get:I3.bind(a[j]=[P.get.bind(p)])}:P.value!==void 0?P:void 0;else{const V=a[j];V&&(P.get?V.push(P.get.bind(p)):P.value!==void 0&&V.push(()=>P.value))}}}const m={},T=Object.keys(d);for(let S=T.length-1;S>=0;S--){const p=T[S],k=d[p];k&&k.get?Object.defineProperty(m,p,k):m[p]=k?k.value:void 0}return m}function C3(h){let c,a;const d=m=>{const T=It.context;if(T){const[p,k]=gr();It.count||(It.count=0),It.count++,(a||(a=h())).then(L=>{!It.done&&hl(T),It.count--,k(()=>L.default),hl()}),c=p}else if(!c){const[p]=By(()=>(a||(a=h())).then(k=>k.default));c=p}let S;return tn(()=>(S=c())?tr(()=>{if(!T||It.done)return S(m);const p=It.context;hl(T);const k=S(m);return hl(p),k}):"")};return d.preload=()=>a||((a=h()).then(m=>c=()=>m.default),a),d}const M3=h=>"Stale read from <".concat(h,">.");function Aj(h){const c="fallback"in h&&{fallback:()=>h.fallback};return tn(A3(()=>h.each,h.children,c||void 0))}function OI(h){const c=h.keyed,a=tn(()=>h.when,void 0,void 0),d=c?a:tn(a,void 0,{equals:(m,T)=>!m==!T});return tn(()=>{const m=d();if(m){const T=h.children;return typeof T=="function"&&T.length>0?tr(()=>T(c?m:()=>{if(!tr(d))throw M3("Show");return a()})):T}return h.fallback},void 0,void 0)}const[UI,jI]=gr(void 0),R3=h=>tn(()=>h());function k3({createElement:h,createTextNode:c,isTextNode:a,replaceText:d,insertNode:m,removeNode:T,setProperty:S,getParentNode:p,getFirstChild:k,getNextSibling:L}){function j(J,oe,x,Y){if(x!==void 0&&!Y&&(Y=[]),typeof oe!="function")return P(J,oe,Y,x);Qr(me=>P(J,oe(),me,x),Y)}function P(J,oe,x,Y,me){for(;typeof x=="function";)x=x();if(oe===x)return x;const pe=typeof oe,we=Y!==void 0;if(pe==="string"||pe==="number")if(pe==="number"&&(oe=oe.toString()),we){let C=x[0];C&&a(C)?d(C,oe):C=c(oe),x=q(J,x,Y,C)}else x!==""&&typeof x=="string"?d(k(J),x=oe):(q(J,x,Y,c(oe)),x=oe);else if(oe==null||pe==="boolean")x=q(J,x,Y);else{if(pe==="function")return Qr(()=>{let C=oe();for(;typeof C=="function";)C=C();x=P(J,C,x,Y)}),()=>x;if(Array.isArray(oe)){const C=[];if(V(C,oe,me))return Qr(()=>x=P(J,C,x,Y,!0)),()=>x;if(C.length===0){const ie=q(J,x,Y);if(we)return x=ie}else Array.isArray(x)?x.length===0?ee(J,C,Y):K(J,x,C):x==null||x===""?ee(J,C):K(J,we&&x||[k(J)],C);x=C}else{if(Array.isArray(x)){if(we)return x=q(J,x,Y,oe);q(J,x,null,oe)}else x==null||x===""||!k(J)?m(J,oe):ue(J,oe,k(J));x=oe}}return x}function V(J,oe,x){let Y=!1;for(let me=0,pe=oe.length;me<pe;me++){let we=oe[me],C;if(!(we==null||we===!0||we===!1))if(Array.isArray(we))Y=V(J,we)||Y;else if((C=typeof we)=="string"||C==="number")J.push(c(we));else if(C==="function")if(x){for(;typeof we=="function";)we=we();Y=V(J,Array.isArray(we)?we:[we])||Y}else J.push(we),Y=!0;else J.push(we)}return Y}function K(J,oe,x){let Y=x.length,me=oe.length,pe=Y,we=0,C=0,ie=L(oe[me-1]),Z=null;for(;we<me||C<pe;){if(oe[we]===x[C]){we++,C++;continue}for(;oe[me-1]===x[pe-1];)me--,pe--;if(me===we){const ge=pe<Y?C?L(x[C-1]):x[pe-C]:ie;for(;C<pe;)m(J,x[C++],ge)}else if(pe===C)for(;we<me;)(!Z||!Z.has(oe[we]))&&T(J,oe[we]),we++;else if(oe[we]===x[pe-1]&&x[C]===oe[me-1]){const ge=L(oe[--me]);m(J,x[C++],L(oe[we++])),m(J,x[--pe],ge),oe[me]=x[pe]}else{if(!Z){Z=new Map;let ce=C;for(;ce<pe;)Z.set(x[ce],ce++)}const ge=Z.get(oe[we]);if(ge!=null)if(C<ge&&ge<pe){let ce=we,se=1,ye;for(;++ce<me&&ce<pe&&!((ye=Z.get(oe[ce]))==null||ye!==ge+se);)se++;if(se>ge-C){const Oe=oe[we];for(;C<ge;)m(J,x[C++],Oe)}else ue(J,x[C++],oe[we++])}else we++;else T(J,oe[we++])}}}function q(J,oe,x,Y){if(x===void 0){let pe;for(;pe=k(J);)T(J,pe);return Y&&m(J,Y),""}const me=Y||c("");if(oe.length){let pe=!1;for(let we=oe.length-1;we>=0;we--){const C=oe[we];if(me!==C){const ie=p(C)===J;!pe&&!we?ie?ue(J,me,C):m(J,me,x):ie&&T(J,C)}else pe=!0}}else m(J,me,x);return[me]}function ee(J,oe,x){for(let Y=0,me=oe.length;Y<me;Y++)m(J,oe[Y],x)}function ue(J,oe,x){m(J,oe,x),T(J,x)}function fe(J,oe,x={},Y){return oe||(oe={}),Y||Qr(()=>x.children=P(J,oe.children,x.children)),Qr(()=>oe.ref&&oe.ref(J)),Qr(()=>{for(const me in oe){if(me==="children"||me==="ref")continue;const pe=oe[me];pe!==x[me]&&(S(J,me,pe,x[me]),x[me]=pe)}}),x}return{render(J,oe){let x;return Ia(Y=>{x=Y,j(oe,J())}),x},insert:j,spread(J,oe,x){typeof oe=="function"?Qr(Y=>fe(J,oe(),Y,x)):fe(J,oe,void 0,x)},createElement:h,createTextNode:c,insertNode:m,setProp(J,oe,x,Y){return S(J,oe,x,Y),x},mergeProps:nv,effect:Qr,memo:R3,createComponent:NI,use(J,oe,x){return tr(()=>J(oe,x))}}}function _3(h){const c=k3(h);return c.mergeProps=nv,c}Object.defineProperty(vs.prototype,"preserve",{get(){return this._queueDelete===0},set(h){this._queueDelete=h?0:void 0}});let Vy=[];function P3(){for(let h of Vy)Number(h._queueDelete)<0&&h.destroy(),h._queueDelete=void 0;Vy.length=0}function FE(h,c){h._queueDelete===void 0?(h._queueDelete=c,Vy.push(h)===1&&queueMicrotask(P3)):h._queueDelete+=c}const BI={createElement(h){return new vs(h)},createTextNode(h){return{_type:Ea.Text,text:h}},replaceText(h,c){my("Replace Text: ",h,c),h.text=c;const a=h.parent;a.text=a.getText()},setProperty(h,c,a=!0){h[c]=a},insertNode(h,c,a){my("INSERT: ",h,c,a);let d=c.parent;h.insertChild(c,a),c instanceof vs?(c.parent.rendered&&c.render(!0),d!==void 0&&FE(c,1)):ml(h)&&(h.text=h.getText())},isTextNode(h){return ml(h)},removeNode(h,c){my("REMOVE: ",h,c),h.removeChild(c),c instanceof vs?FE(c,-1):ml(h)&&(h.text=h.getText())},getParentNode(h){return h.parent},getFirstChild(h){return h.children[0]},getNextSibling(h){const c=h.parent.children||[],a=c.indexOf(h)+1;if(a<c.length)return c[a]}},FI=_3(BI);let bf;const Vf=BI.createElement("App"),D3=function(h){return FI.render(h,Vf)};function L3(h,c){const a=en.rendererOptions;return bf=Yb(a,"app"),en.setActiveElement=jI,Vf.lng=bf.root,Vf.rendered=!0,bf.on("idle",()=>{rv=!0,GI()}),{renderer:bf,rootNode:Vf,render:D3}}const{memo:b3,createComponent:ci,createElement:VI,spread:HI,mergeProps:Ej}=FI,VE=[];let rv=!1;Ia(()=>{Qr(()=>{UI(),rv=!1})});function GI(){rv&&VE.length&&setTimeout(()=>{const h=VE.shift();h&&(h(),GI())},en.taskDelay||50)}const N3=h=>{const c=VI("node");return HI(c,h,!1),c},Ij=h=>{const c=VI("text");return HI(c,h,!1),c};const O3=!1;function XI(){let h=new Set;function c(m){return h.add(m),()=>h.delete(m)}let a=!1;function d(m,T){if(a)return!(a=!1);const S={to:m,options:T,defaultPrevented:!1,preventDefault:()=>S.defaultPrevented=!0};for(const p of h)p.listener({...S,from:p.location,retry:k=>{k&&(a=!0),p.navigate(m,{...T,resolve:!1})}});return!S.defaultPrevented}return{subscribe:c,confirm:d}}let Hy;function iv(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Hy=window.history.state._depth}iv();function U3(h){return{...h,_depth:window.history.state&&window.history.state._depth}}function j3(h,c){let a=!1;return()=>{const d=Hy;iv();const m=d==null?null:Hy-d;if(a){a=!1;return}m&&c(m)?(a=!0,window.history.go(-m)):h()}}const B3=/^(?:[a-z0-9]+:)?\/\//i,F3=/^\/+|(\/)\/+$/g,V3="http://sr";function yl(h,c=!1){const a=h.replace(F3,"$1");return a?c||/^[?#]/.test(a)?a:"/"+a:""}function Hf(h,c,a){if(B3.test(c))return;const d=yl(h),m=a&&yl(a);let T="";return!m||c.startsWith("/")?T=d:m.toLowerCase().indexOf(d.toLowerCase())!==0?T=d+m:T=m,(T||"/")+yl(c,!T)}function H3(h,c){if(h==null)throw new Error(c);return h}function G3(h,c){return yl(h).replace(/\/*(\*.*)?$/g,"")+yl(c)}function zI(h){const c={};return h.searchParams.forEach((a,d)=>{d in c?Array.isArray(c[d])?c[d].push(a):c[d]=[c[d],a]:c[d]=a}),c}function X3(h,c,a){const[d,m]=h.split("/*",2),T=d.split("/").filter(Boolean),S=T.length;return p=>{const k=p.split("/").filter(Boolean),L=k.length-S;if(L<0||L>0&&m===void 0&&!c)return null;const j={path:S?"":"/",params:{}},P=V=>a===void 0?void 0:a[V];for(let V=0;V<S;V++){const K=T[V],q=K[0]===":",ee=q?k[V]:k[V].toLowerCase(),ue=q?K.slice(1):K.toLowerCase();if(q&&Ay(ee,P(ue)))j.params[ue]=ee;else if(q||!Ay(ee,ue))return null;j.path+="/".concat(ee)}if(m){const V=L?k.slice(-L).join("/"):"";if(Ay(V,P(m)))j.params[m]=V;else return null}return j}}function Ay(h,c){const a=d=>d===h;return c===void 0?!0:typeof c=="string"?a(c):typeof c=="function"?c(h):Array.isArray(c)?c.some(a):c instanceof RegExp?c.test(h):!1}function z3(h){const[c,a]=h.pattern.split("/*",2),d=c.split("/").filter(Boolean);return d.reduce((m,T)=>m+(T.startsWith(":")?2:3),d.length-(a===void 0?0:1))}function WI(h){const c=new Map,a=Dl();return new Proxy({},{get(d,m){return c.has(m)||Ll(a,()=>c.set(m,tn(()=>h()[m]))),c.get(m)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(h())},has(d,m){return m in h()}})}function KI(h){let c=/(\/?\:[^\/]+)\?/.exec(h);if(!c)return[h];let a=h.slice(0,c.index),d=h.slice(c.index+c[0].length);const m=[a,a+=c[1]];for(;c=/^(\/\:[^\/]+)\?/.exec(d);)m.push(a+=c[1]),d=d.slice(c[0].length);return KI(d).reduce((T,S)=>[...T,...m.map(p=>p+S)],[])}const W3=100,$I=kI(),YI=kI(),K3=()=>H3(_I($I),"<A> and 'use' router primitives can be only used inside a Route."),$3=()=>K3().navigatorFactory();function Y3(h,c=""){const{component:a,preload:d,load:m,children:T,info:S}=h,p=!T||Array.isArray(T)&&!T.length,k={key:h,component:a,preload:d||m,info:S};return qI(h.path).reduce((L,j)=>{for(const P of KI(j)){const V=G3(c,P);let K=p?V:V.split("/*",1)[0];K=K.split("/").map(q=>q.startsWith(":")||q.startsWith("*")?q:encodeURIComponent(q)).join("/"),L.push({...k,originalPath:j,pattern:K,matcher:X3(K,!p,h.matchFilters)})}return L},[])}function q3(h,c=0){return{routes:h,score:z3(h[h.length-1])*1e4-c,matcher(a){const d=[];for(let m=h.length-1;m>=0;m--){const T=h[m],S=T.matcher(a);if(!S)return null;d.unshift({...S,route:T})}return d}}}function qI(h){return Array.isArray(h)?h:[h]}function QI(h,c="",a=[],d=[]){const m=qI(h);for(let T=0,S=m.length;T<S;T++){const p=m[T];if(p&&typeof p=="object"){p.hasOwnProperty("path")||(p.path="");const k=Y3(p,c);for(const L of k){a.push(L);const j=Array.isArray(p.children)&&p.children.length===0;if(p.children&&!j)QI(p.children,L.pattern,a,d);else{const P=q3([...a],d.length);d.push(P)}a.pop()}}}return a.length?d:d.sort((T,S)=>S.score-T.score)}function Ey(h,c){for(let a=0,d=h.length;a<d;a++){const m=h[a].matcher(c);if(m)return m}return[]}function Q3(h,c,a){const d=new URL(V3),m=tn(j=>{const P=h();try{return new URL(P,d)}catch(V){return console.error("Invalid path ".concat(P)),j}},d,{equals:(j,P)=>j.href===P.href}),T=tn(()=>m().pathname),S=tn(()=>m().search,!0),p=tn(()=>m().hash),k=()=>"",L=Pl(S,()=>zI(m()));return{get pathname(){return T()},get search(){return S()},get hash(){return p()},get state(){return c()},get key(){return k()},query:a?a(L):WI(L)}}let Qs;function J3(){return Qs}function Z3(h,c,a,d={}){const{signal:[m,T],utils:S={}}=h,p=S.parsePath||(se=>se),k=S.renderPath||(se=>se),L=S.beforeLeave||XI(),j=Hf("",d.base||"");if(j===void 0)throw new Error("".concat(j," is not a valid base path"));j&&!m().value&&T({value:j,replace:!0,scroll:!1});const[P,V]=gr(!1);let K;const q=(se,ye)=>{ye.value===ee()&&ye.state===fe()||(K===void 0&&V(!0),Qs=se,K=ye,m3(()=>{K===ye&&(ue(K.value),J(K.state),Y[1](Oe=>Oe.filter(Tt=>Tt.pending)))}).finally(()=>{K===ye&&g3(()=>{Qs=void 0,se==="navigate"&&ge(K),V(!1),K=void 0})}))},[ee,ue]=gr(m().value),[fe,J]=gr(m().state),oe=Q3(ee,fe,S.queryWrapper),x=[],Y=gr([]),me=tn(()=>typeof d.transformUrl=="function"?Ey(c(),d.transformUrl(oe.pathname)):Ey(c(),oe.pathname)),pe=()=>{const se=me(),ye={};for(let Oe=0;Oe<se.length;Oe++)Object.assign(ye,se[Oe].params);return ye},we=S.paramsWrapper?S.paramsWrapper(pe,c):WI(pe),C={pattern:j,path:()=>j,outlet:()=>null,resolvePath(se){return Hf(j,se)}};return Qr(Pl(m,se=>q("native",se),{defer:!0})),{base:C,location:oe,params:we,isRouting:P,renderPath:k,parsePath:p,navigatorFactory:Z,matches:me,beforeLeave:L,preloadRoute:ce,singleFlight:d.singleFlight===void 0?!0:d.singleFlight,submissions:Y};function ie(se,ye,Oe){tr(()=>{if(typeof ye=="number"){ye&&(S.go?S.go(ye):console.warn("Router integration does not support relative routing"));return}const Tt=!ye||ye[0]==="?",{replace:An,resolve:mn,scroll:Qt,state:Dn}={replace:!1,resolve:!Tt,scroll:!0,...Oe},Xn=mn?se.resolvePath(ye):Hf(Tt&&oe.pathname||"",ye);if(Xn===void 0)throw new Error("Path '".concat(ye,"' is not a routable path"));if(x.length>=W3)throw new Error("Too many redirects");const F=ee();(Xn!==F||Dn!==fe())&&(O3||L.confirm(Xn,Oe)&&(x.push({value:F,replace:An,scroll:Qt,state:fe()}),q("navigate",{value:Xn,state:Dn})))})}function Z(se){return se=se||_I(YI)||C,(ye,Oe)=>ie(se,ye,Oe)}function ge(se){const ye=x[0];ye&&(T({...se,replace:ye.replace,scroll:ye.scroll}),x.length=0)}function ce(se,ye){const Oe=Ey(c(),se.pathname),Tt=Qs;Qs="preload";for(let An in Oe){const{route:mn,params:Qt}=Oe[An];mn.component&&mn.component.preload&&mn.component.preload();const{preload:Dn}=mn;ye&&Dn&&Ll(a(),()=>Dn({params:Qt,location:{pathname:se.pathname,search:se.search,hash:se.hash,query:zI(se),state:null,key:""},intent:"preload"}))}Qs=Tt}}function eN(h,c,a,d){const{base:m,location:T,params:S}=h,{pattern:p,component:k,preload:L}=d().route,j=tn(()=>d().path);k&&k.preload&&k.preload();const P=L?L({params:S,location:T,intent:Qs||"initial"}):void 0;return{parent:c,pattern:p,path:j,outlet:()=>k?NI(k,{params:S,location:T,data:P,get children(){return a()}}):a(),resolvePath(K){return Hf(m.path(),K,j())}}}const tN=h=>c=>{const{base:a}=c,d=ev(()=>c.children),m=tn(()=>QI(d(),c.base||""));let T;const S=Z3(h,m,()=>T,{base:a,singleFlight:c.singleFlight,transformUrl:c.transformUrl});return h.create&&h.create(S),ci($I.Provider,{value:S,get children(){return ci(nN,{routerState:S,get root(){return c.root},get preload(){return c.rootPreload||c.rootLoad},get children(){return[b3(()=>(T=Dl())&&null),ci(rN,{routerState:S,get branches(){return m()}})]}})}})};function nN(h){const c=h.routerState.location,a=h.routerState.params,d=tn(()=>h.preload&&tr(()=>{h.preload({params:a,location:c,intent:J3()||"initial"})}));return ci(OI,{get when(){return h.root},keyed:!0,get fallback(){return h.children},children:m=>ci(m,{params:a,location:c,get data(){return d()},get children(){return h.children}})})}function rN(h){const c=[];let a;const d=tn(Pl(h.routerState.matches,(m,T,S)=>{let p=T&&m.length===T.length;const k=[];for(let L=0,j=m.length;L<j;L++){const P=T&&T[L],V=m[L];S&&P&&V.route.key===P.route.key?k[L]=S[L]:(p=!1,c[L]&&c[L](),Ia(K=>{c[L]=K,k[L]=eN(h.routerState,k[L-1]||h.routerState.base,HE(()=>d()[L+1]),()=>{var ee;const q=h.routerState.matches();return(ee=q[L])!=null?ee:q[0]})}))}return c.splice(m.length).forEach(L=>L()),S&&p?S:(a=k[0],k)}));return HE(()=>d()&&a)()}const HE=h=>()=>ci(OI,{get when(){return h()},keyed:!0,children:c=>ci(YI.Provider,{value:c,get children(){return c.outlet()}})}),iN=h=>{const c=ev(()=>h.children);return nv(h,{get children(){return c()}})};function sN([h,c],a,d){return[h,d?m=>c(d(m)):c]}function oN(h){let c=!1;const a=m=>typeof m=="string"?{value:m}:m,d=sN(gr(a(h.get()),{equals:(m,T)=>m.value===T.value&&m.state===T.state}),void 0,m=>(!c&&h.set(m),It.registry&&!It.done&&(It.done=!0),m));return h.init&&oh(h.init((m=h.get())=>{c=!0,d[1](a(m)),c=!1})),tN({signal:d,create:h.create,utils:h.utils})}const[JI,aN]=gr([]),uN=(h,c)=>{const a=Dl(),d=Ll.bind(void 0,a);en.setActiveElement=S=>d(()=>jI(S));const{cleanup:m,focusPath:T}=s3({userKeyMap:h,keyHoldOptions:c,ownerContext:d});RI(Pl(UI,()=>{aN([...T()])},{defer:!0})),oh(m)},Qf="aria-parent";let Jf=[];function lN(h=[]){const c=[];let a;for(a=0;a<h.length;a++){const d=h[a];if(typeof d=="string"&&!d.includes("PAUSE-"))c.push(h[a]);else break}return[c.join(",\b ")].concat(h.slice(a))}function Iy(h){return new Promise(c=>{setTimeout(c,h)})}function GE(h){var c;((c=h==null?void 0:h.text)==null?void 0:c.trim().length)!==0&&Jf.push(h)}function cN(){const h=t2();if(!h){console.error("ARIA div not found: ".concat(Qf));return}for(const c of Jf){const a=document.createElement("span");a.setAttribute("lang",c.lang),a.setAttribute("aria-label",c.text),h.appendChild(a)}setTimeout(()=>{Jf=[],ZI(),e2()},100)}function ZI(){const h=document.getElementById(Qf);if(h)for(;h.firstChild;)h.removeChild(h.firstChild)}function e2(){var c;const h=(c=document.getElementById("app"))==null?void 0:c.firstChild;h==null||h.focus()}function t2(){const h=document.getElementById(Qf);if(!h){const c=document.createElement("div");return c.setAttribute("id",Qf),c.setAttribute("aria-live","assertive"),c.setAttribute("tabindex","0"),document.body.appendChild(c),c}return h}function XE(h,c,a="en-US",d){const m=window.speechSynthesis;return new Promise((T,S)=>{let p;if(d){const L=m.getVoices();p=L.find(j=>j.name===d)||L[0]}const k=new SpeechSynthesisUtterance(h);k.lang=a,p&&(k.voice=p),k.onend=()=>{T()},k.onerror=L=>{S(L)},c.push(k),m.speak(k)})}function Gy(h,c,a,d,m=!0){const T=window.speechSynthesis,S=lN(Array.isArray(h)?h:[h]),p=[],k=[];let L=!0;return{series:(async()=>{try{for(;L&&S.length;){const P=await Promise.resolve(S.shift());if(!L)break;if(typeof P=="string"&&P.includes("PAUSE-")){const V=Number(P.split("PAUSE-")[1])*1e3;isNaN(V)||await Iy(V)}else if(typeof P=="string"){if(!P)continue;const V=3;let K=V;for(;L&&K>0;)try{c?GE({text:P,lang:a}):await XE(P,k,a,d),K=0}catch(q){if(q instanceof SpeechSynthesisErrorEvent)if(q.error==="network")K--,console.warn("Speech synthesis network error. Retries left: ".concat(K)),await Iy(500*(V-K));else if(q.error==="canceled"||q.error==="interrupted")K=0;else throw new Error("SpeechSynthesisErrorEvent: ".concat(q.error));else throw q}}else if(P instanceof SpeechSynthesisUtterance){let K=3;const q=P.text,ee=P==null?void 0:P.lang,ue=P==null?void 0:P.voice;for(;L&&K>0;)try{q&&(c?GE({text:q,lang:ee}):await XE(q,k,ee,ue==null?void 0:ue.name),K=0)}catch(fe){if(fe instanceof SpeechSynthesisErrorEvent)if(fe.error==="network")K--,console.warn("Speech synthesis network error. Retries left: ".concat(K)),await Iy(500*(3-K));else if(fe.error==="canceled"||fe.error==="interrupted")K=0;else throw new Error("SpeechSynthesisErrorEvent: ".concat(fe.error));else throw fe}}else if(typeof P=="function"){const V=Gy(P(),c,a,d,!1);p.push(V),await V.series}else if(Array.isArray(P)){const V=Gy(P,c,a,d,!1);p.push(V),await V.series}}}finally{L=!1,m&&c&&cN()}})(),get active(){return L},append:P=>{S.push(P)},cancel:()=>{if(L){if(m){if(c){const P=t2();P&&(Jf=[],ZI(),P.focus(),e2());return}T.cancel()}p.forEach(P=>{P.cancel()}),L=!1}}}}let Nf;function dN(h,c,a="en-US",d){return Nf&&Nf.cancel(),Nf=Gy(h,c,a,d),Nf}const fN=(h,c)=>{let a;const d=()=>clearTimeout(a);return Dl()&&oh(d),Object.assign((...T)=>{a!==void 0&&d(),a=setTimeout(()=>h(...T),c)},{clear:d})};let Xy,vl=[],li,zy=!1;const hN=3e5;function zE(h,c){const a=fN(h,c);let d;const m=T=>{d=T,a(T)};return m.flush=()=>{a.clear(),h(d)},m.clear=a.clear,m}function al(h){return h.id||h.name}function pN(h=[]){if(!Zt.onFocusChange||!Zt.enabled)return;const c=h.every(T=>!T.loading),a=h.filter(T=>!vl.includes(T));if(Xy(),!c&&Zt.onFocusChange){Zt.onFocusChange([]);return}vl=h.slice(0);const d=[],m=a.reverse().reduce((T,S)=>(S.announce?(T.push([al(S),"Announce",S.announce]),d.push(S.announce)):S.title?(T.push([al(S),"Title",S.title]),d.push(S.title)):T.push([al(S),"No Announce",""]),T),[]);if(a.reverse().reduce((T,S)=>(S.announceContext?(T.push([al(S),"Context",S.announceContext]),d.push(S.announceContext)):T.push([al(S),"No Context",""]),T),m),Zt.debug&&console.table(m),d.length)return Zt.speak(d.reduce((T,S)=>T.concat(S),[]))}function gN(h,c,a,d){if(!zy)return li=dN(h,c,a,d)}const Zt={debug:!1,enabled:!0,lang:"en-US",aria:!1,cancel:function(){li&&li.cancel()},clearPrevFocus:function(h=0){vl=vl.slice(0,h),Xy()},speak:function(h,{append:c=!1,notification:a=!1}={}){return Zt.onFocusChange&&Zt.enabled&&(c&&li&&li.active?li.append(h):(Zt.cancel(),gN(h,Zt.aria,Zt.lang,Zt.voice)),a&&(zy=!0,li==null||li.series.finally(()=>{zy=!1,Zt.refresh()}).catch(console.error))),li},refresh:function(h=0){Zt.clearPrevFocus(h),Zt.onFocusChange&&Zt.onFocusChange(tr(()=>JI()))},setupTimers:function({focusDebounce:h=400,focusChangeTimeout:c=hN}={}){Zt.onFocusChange=zE(pN,h),Xy=zE(()=>{vl=[]},c)}};let WE=!1;const mN=h=>(WE||(WE=!0,Zt.setupTimers(h),RI(Pl(JI,Zt.onFocusChange,{defer:!0}))),Zt);function yN(h){const c=h.replace(/^.*?#/,"");if(!c.startsWith("/")){const[,a="/"]=window.location.hash.split("#",2);return"".concat(a,"#").concat(c)}return c}function vN(h,c,a){return h.addEventListener(c,a),()=>h.removeEventListener(c,a)}function xN(h){const c=()=>window.location.hash.slice(1),a=XI();return oN({get:c,set({value:d,replace:m,state:T}){m?window.history.replaceState(U3(T),"","#"+d):window.history.pushState(T,"","#"+d),iv()},init:d=>vN(window,"hashchange",j3(d,m=>!a.confirm(m&&m<0?m:c()))),utils:{go:d=>window.history.go(d),renderPath:d=>"#".concat(d),parsePath:yN,beforeLeave:a,queryWrapper:h.forceProxy||!KE?d=>$E(d,h.queryParams):void 0,paramsWrapper:h.forceProxy||!KE?(d,m)=>$E(d,TN(m())):void 0}})(h)}const KE=typeof Proxy=="function";function $E(h,c){const a=new Map,d=Dl(),m={},T=p=>(a.has(p)||Ll(d,()=>a.set(p,tn(()=>h()[p]))),a.get(p)());return(c||Object.keys(h())).forEach(p=>{Object.defineProperty(m,p,{get:()=>T(p),enumerable:!0,configurable:!0})}),m}const TN=h=>{const c=[];return h.forEach(a=>{a.routes.forEach(d=>{if(d.pattern){const m=d.pattern.match(/:(\w+)/g);m&&m.forEach(T=>{const S=T.slice(1);c.includes(S)||c.push(S)})}})}),c},wN=h=>{$3();const c=mN();return c.debug=!1,c.enabled=!1,ci(N3,{ref(a){var d=window.APP;typeof d=="function"?d(a):window.APP=a},onAnnouncer:()=>c.enabled=!c.enabled,get children(){return h.children}})},Hr="",SN=[{type:"msdf",fontFamily:"Inter",descriptors:{weight:400},atlasDataUrl:Hr+"fonts/Inter_18pt-Regular.msdf.json",atlasUrl:Hr+"fonts/Inter_18pt-Regular.msdf.png"},{type:"msdf",fontFamily:"Inter",descriptors:{weight:600},atlasDataUrl:Hr+"fonts/Inter_18pt-SemiBold.msdf.json",atlasUrl:Hr+"fonts/Inter_18pt-SemiBold.msdf.png"},{type:"msdf",fontFamily:"Inter",descriptors:{weight:700},atlasDataUrl:Hr+"fonts/Inter_18pt-Bold.msdf.json",atlasUrl:Hr+"fonts/Inter_18pt-Bold.msdf.png"},{type:"msdf",fontFamily:"Roboto",descriptors:{weight:700},atlasDataUrl:Hr+"fonts/Roboto-Bold.msdf.json",atlasUrl:Hr+"fonts/Roboto-Bold.msdf.png"},{type:"msdf",fontFamily:"Roboto",descriptors:{weight:400},atlasDataUrl:Hr+"fonts/Roboto-Regular.msdf.json",atlasUrl:Hr+"fonts/Roboto-Regular.msdf.png"},{type:"msdf",fontFamily:"Arial",descriptors:{weight:500},atlasDataUrl:Hr+"fonts/Roboto-Regular.msdf.json",atlasUrl:Hr+"fonts/Roboto-Regular.msdf.png"}];var n2=typeof global=="object"&&global&&global.Object===Object&&global,AN=typeof self=="object"&&self&&self.Object===Object&&self,Ra=n2||AN||Function("return this")(),Zf=Ra.Symbol,r2=Object.prototype,EN=r2.hasOwnProperty,IN=r2.toString,ul=Zf?Zf.toStringTag:void 0;function CN(h){var c=EN.call(h,ul),a=h[ul];try{h[ul]=void 0;var d=!0}catch(T){}var m=IN.call(h);return d&&(c?h[ul]=a:delete h[ul]),m}var MN=Object.prototype,RN=MN.toString;function kN(h){return RN.call(h)}var _N="[object Null]",PN="[object Undefined]",YE=Zf?Zf.toStringTag:void 0;function uh(h){return h==null?h===void 0?PN:_N:YE&&YE in Object(h)?CN(h):kN(h)}function bl(h){return h!=null&&typeof h=="object"}var Wy=Array.isArray;function no(h){var c=typeof h;return h!=null&&(c=="object"||c=="function")}function i2(h){return h}var DN="[object AsyncFunction]",LN="[object Function]",bN="[object GeneratorFunction]",NN="[object Proxy]";function sv(h){if(!no(h))return!1;var c=uh(h);return c==LN||c==bN||c==DN||c==NN}var Cy=Ra["__core-js_shared__"],qE=(function(){var h=/[^.]+$/.exec(Cy&&Cy.keys&&Cy.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""})();function ON(h){return!!qE&&qE in h}var UN=Function.prototype,jN=UN.toString;function BN(h){if(h!=null){try{return jN.call(h)}catch(c){}try{return h+""}catch(c){}}return""}var FN=/[\\^$.*+?()[\]{}|]/g,VN=/^\[object .+?Constructor\]$/,HN=Function.prototype,GN=Object.prototype,XN=HN.toString,zN=GN.hasOwnProperty,WN=RegExp("^"+XN.call(zN).replace(FN,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function KN(h){if(!no(h)||ON(h))return!1;var c=sv(h)?WN:VN;return c.test(BN(h))}function $N(h,c){return h==null?void 0:h[c]}function ov(h,c){var a=$N(h,c);return KN(a)?a:void 0}var QE=Object.create,YN=(function(){function h(){}return function(c){if(!no(c))return{};if(QE)return QE(c);h.prototype=c;var a=new h;return h.prototype=void 0,a}})();function qN(h,c,a){switch(a.length){case 0:return h.call(c);case 1:return h.call(c,a[0]);case 2:return h.call(c,a[0],a[1]);case 3:return h.call(c,a[0],a[1],a[2])}return h.apply(c,a)}function QN(h,c){var a=-1,d=h.length;for(c||(c=Array(d));++a<d;)c[a]=h[a];return c}var JN=800,ZN=16,eO=Date.now;function tO(h){var c=0,a=0;return function(){var d=eO(),m=ZN-(d-a);if(a=d,m>0){if(++c>=JN)return arguments[0]}else c=0;return h.apply(void 0,arguments)}}function nO(h){return function(){return h}}var eh=(function(){try{var h=ov(Object,"defineProperty");return h({},"",{}),h}catch(c){}})(),rO=eh?function(h,c){return eh(h,"toString",{configurable:!0,enumerable:!1,value:nO(c),writable:!0})}:i2,iO=tO(rO),sO=9007199254740991,oO=/^(?:0|[1-9]\d*)$/;function s2(h,c){var a=typeof h;return c=c==null?sO:c,!!c&&(a=="number"||a!="symbol"&&oO.test(h))&&h>-1&&h%1==0&&h<c}function av(h,c,a){c=="__proto__"&&eh?eh(h,c,{configurable:!0,enumerable:!0,value:a,writable:!0}):h[c]=a}function lh(h,c){return h===c||h!==h&&c!==c}var aO=Object.prototype,uO=aO.hasOwnProperty;function lO(h,c,a){var d=h[c];(!(uO.call(h,c)&&lh(d,a))||a===void 0&&!(c in h))&&av(h,c,a)}function cO(h,c,a,d){var m=!a;a||(a={});for(var T=-1,S=c.length;++T<S;){var p=c[T],k=void 0;k===void 0&&(k=h[p]),m?av(a,p,k):lO(a,p,k)}return a}var JE=Math.max;function dO(h,c,a){return c=JE(c===void 0?h.length-1:c,0),function(){for(var d=arguments,m=-1,T=JE(d.length-c,0),S=Array(T);++m<T;)S[m]=d[c+m];m=-1;for(var p=Array(c+1);++m<c;)p[m]=d[m];return p[c]=a(S),qN(h,this,p)}}function fO(h,c){return iO(dO(h,c,i2),h+"")}var hO=9007199254740991;function o2(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=hO}function uv(h){return h!=null&&o2(h.length)&&!sv(h)}function pO(h,c,a){if(!no(a))return!1;var d=typeof c;return(d=="number"?uv(a)&&s2(c,a.length):d=="string"&&c in a)?lh(a[c],h):!1}function gO(h){return fO(function(c,a){var d=-1,m=a.length,T=m>1?a[m-1]:void 0,S=m>2?a[2]:void 0;for(T=h.length>3&&typeof T=="function"?(m--,T):void 0,S&&pO(a[0],a[1],S)&&(T=m<3?void 0:T,m=1),c=Object(c);++d<m;){var p=a[d];p&&h(c,p,d,T)}return c})}var mO=Object.prototype;function a2(h){var c=h&&h.constructor,a=typeof c=="function"&&c.prototype||mO;return h===a}function yO(h,c){for(var a=-1,d=Array(h);++a<h;)d[a]=c(a);return d}var vO="[object Arguments]";function ZE(h){return bl(h)&&uh(h)==vO}var u2=Object.prototype,xO=u2.hasOwnProperty,TO=u2.propertyIsEnumerable,Ky=ZE((function(){return arguments})())?ZE:function(h){return bl(h)&&xO.call(h,"callee")&&!TO.call(h,"callee")};function wO(){return!1}var l2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eI=l2&&typeof module=="object"&&module&&!module.nodeType&&module,SO=eI&&eI.exports===l2,tI=SO?Ra.Buffer:void 0,AO=tI?tI.isBuffer:void 0,c2=AO||wO,EO="[object Arguments]",IO="[object Array]",CO="[object Boolean]",MO="[object Date]",RO="[object Error]",kO="[object Function]",_O="[object Map]",PO="[object Number]",DO="[object Object]",LO="[object RegExp]",bO="[object Set]",NO="[object String]",OO="[object WeakMap]",UO="[object ArrayBuffer]",jO="[object DataView]",BO="[object Float32Array]",FO="[object Float64Array]",VO="[object Int8Array]",HO="[object Int16Array]",GO="[object Int32Array]",XO="[object Uint8Array]",zO="[object Uint8ClampedArray]",WO="[object Uint16Array]",KO="[object Uint32Array]",Ut={};Ut[BO]=Ut[FO]=Ut[VO]=Ut[HO]=Ut[GO]=Ut[XO]=Ut[zO]=Ut[WO]=Ut[KO]=!0;Ut[EO]=Ut[IO]=Ut[UO]=Ut[CO]=Ut[jO]=Ut[MO]=Ut[RO]=Ut[kO]=Ut[_O]=Ut[PO]=Ut[DO]=Ut[LO]=Ut[bO]=Ut[NO]=Ut[OO]=!1;function $O(h){return bl(h)&&o2(h.length)&&!!Ut[uh(h)]}function YO(h){return function(c){return h(c)}}var d2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xl=d2&&typeof module=="object"&&module&&!module.nodeType&&module,qO=xl&&xl.exports===d2,My=qO&&n2.process,nI=(function(){try{var h=xl&&xl.require&&xl.require("util").types;return h||My&&My.binding&&My.binding("util")}catch(c){}})(),rI=nI&&nI.isTypedArray,f2=rI?YO(rI):$O;function QO(h,c){var a=Wy(h),d=!a&&Ky(h),m=!a&&!d&&c2(h),T=!a&&!d&&!m&&f2(h),S=a||d||m||T,p=S?yO(h.length,String):[],k=p.length;for(var L in h)S&&(L=="length"||m&&(L=="offset"||L=="parent")||T&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||s2(L,k))||p.push(L);return p}function JO(h,c){return function(a){return h(c(a))}}function ZO(h){var c=[];if(h!=null)for(var a in Object(h))c.push(a);return c}var eU=Object.prototype,tU=eU.hasOwnProperty;function nU(h){if(!no(h))return ZO(h);var c=a2(h),a=[];for(var d in h)d=="constructor"&&(c||!tU.call(h,d))||a.push(d);return a}function h2(h){return uv(h)?QO(h):nU(h)}var kl=ov(Object,"create");function rU(){this.__data__=kl?kl(null):{},this.size=0}function iU(h){var c=this.has(h)&&delete this.__data__[h];return this.size-=c?1:0,c}var sU="__lodash_hash_undefined__",oU=Object.prototype,aU=oU.hasOwnProperty;function uU(h){var c=this.__data__;if(kl){var a=c[h];return a===sU?void 0:a}return aU.call(c,h)?c[h]:void 0}var lU=Object.prototype,cU=lU.hasOwnProperty;function dU(h){var c=this.__data__;return kl?c[h]!==void 0:cU.call(c,h)}var fU="__lodash_hash_undefined__";function hU(h,c){var a=this.__data__;return this.size+=this.has(h)?0:1,a[h]=kl&&c===void 0?fU:c,this}function eo(h){var c=-1,a=h==null?0:h.length;for(this.clear();++c<a;){var d=h[c];this.set(d[0],d[1])}}eo.prototype.clear=rU;eo.prototype.delete=iU;eo.prototype.get=uU;eo.prototype.has=dU;eo.prototype.set=hU;function pU(){this.__data__=[],this.size=0}function ch(h,c){for(var a=h.length;a--;)if(lh(h[a][0],c))return a;return-1}var gU=Array.prototype,mU=gU.splice;function yU(h){var c=this.__data__,a=ch(c,h);if(a<0)return!1;var d=c.length-1;return a==d?c.pop():mU.call(c,a,1),--this.size,!0}function vU(h){var c=this.__data__,a=ch(c,h);return a<0?void 0:c[a][1]}function xU(h){return ch(this.__data__,h)>-1}function TU(h,c){var a=this.__data__,d=ch(a,h);return d<0?(++this.size,a.push([h,c])):a[d][1]=c,this}function zi(h){var c=-1,a=h==null?0:h.length;for(this.clear();++c<a;){var d=h[c];this.set(d[0],d[1])}}zi.prototype.clear=pU;zi.prototype.delete=yU;zi.prototype.get=vU;zi.prototype.has=xU;zi.prototype.set=TU;var p2=ov(Ra,"Map");function wU(){this.size=0,this.__data__={hash:new eo,map:new(p2||zi),string:new eo}}function SU(h){var c=typeof h;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?h!=="__proto__":h===null}function dh(h,c){var a=h.__data__;return SU(c)?a[typeof c=="string"?"string":"hash"]:a.map}function AU(h){var c=dh(this,h).delete(h);return this.size-=c?1:0,c}function EU(h){return dh(this,h).get(h)}function IU(h){return dh(this,h).has(h)}function CU(h,c){var a=dh(this,h),d=a.size;return a.set(h,c),this.size+=a.size==d?0:1,this}function ka(h){var c=-1,a=h==null?0:h.length;for(this.clear();++c<a;){var d=h[c];this.set(d[0],d[1])}}ka.prototype.clear=wU;ka.prototype.delete=AU;ka.prototype.get=EU;ka.prototype.has=IU;ka.prototype.set=CU;var g2=JO(Object.getPrototypeOf,Object),MU="[object Object]",RU=Function.prototype,kU=Object.prototype,m2=RU.toString,_U=kU.hasOwnProperty,PU=m2.call(Object);function DU(h){if(!bl(h)||uh(h)!=MU)return!1;var c=g2(h);if(c===null)return!0;var a=_U.call(c,"constructor")&&c.constructor;return typeof a=="function"&&a instanceof a&&m2.call(a)==PU}function LU(){this.__data__=new zi,this.size=0}function bU(h){var c=this.__data__,a=c.delete(h);return this.size=c.size,a}function NU(h){return this.__data__.get(h)}function OU(h){return this.__data__.has(h)}var UU=200;function jU(h,c){var a=this.__data__;if(a instanceof zi){var d=a.__data__;if(!p2||d.length<UU-1)return d.push([h,c]),this.size=++a.size,this;a=this.__data__=new ka(d)}return a.set(h,c),this.size=a.size,this}function _a(h){var c=this.__data__=new zi(h);this.size=c.size}_a.prototype.clear=LU;_a.prototype.delete=bU;_a.prototype.get=NU;_a.prototype.has=OU;_a.prototype.set=jU;var y2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,iI=y2&&typeof module=="object"&&module&&!module.nodeType&&module,BU=iI&&iI.exports===y2,sI=BU?Ra.Buffer:void 0;sI&&sI.allocUnsafe;function FU(h,c){return h.slice()}var oI=Ra.Uint8Array;function VU(h){var c=new h.constructor(h.byteLength);return new oI(c).set(new oI(h)),c}function HU(h,c){var a=VU(h.buffer);return new h.constructor(a,h.byteOffset,h.length)}function GU(h){return typeof h.constructor=="function"&&!a2(h)?YN(g2(h)):{}}function XU(h){return function(c,a,d){for(var m=-1,T=Object(c),S=d(c),p=S.length;p--;){var k=S[++m];if(a(T[k],k,T)===!1)break}return c}}var zU=XU();function $y(h,c,a){(a!==void 0&&!lh(h[c],a)||a===void 0&&!(c in h))&&av(h,c,a)}function WU(h){return bl(h)&&uv(h)}function Yy(h,c){if(!(c==="constructor"&&typeof h[c]=="function")&&c!="__proto__")return h[c]}function KU(h){return cO(h,h2(h))}function $U(h,c,a,d,m,T,S){var p=Yy(h,a),k=Yy(c,a),L=S.get(k);if(L){$y(h,a,L);return}var j=T?T(p,k,a+"",h,c,S):void 0,P=j===void 0;if(P){var V=Wy(k),K=!V&&c2(k),q=!V&&!K&&f2(k);j=k,V||K||q?Wy(p)?j=p:WU(p)?j=QN(p):K?(P=!1,j=FU(k)):q?(P=!1,j=HU(k)):j=[]:DU(k)||Ky(k)?(j=p,Ky(p)?j=KU(p):(!no(p)||sv(p))&&(j=GU(k))):P=!1}P&&(S.set(k,j),m(j,k,d,T,S),S.delete(k)),$y(h,a,j)}function v2(h,c,a,d,m){h!==c&&zU(c,function(T,S){if(m||(m=new _a),no(T))$U(h,c,S,a,v2,d,m);else{var p=d?d(Yy(h,S),T,S+"",h,c,m):void 0;p===void 0&&(p=T),$y(h,S,p)}},h2)}var YU=gO(function(h,c,a){v2(h,c,a)});const qU=24;function QU(h,c,a,d,m,T,S,p,k){const L=Math.min(Math.max(S.firstLineIdx,0),p.length),j=0,{metrics:P}=a;a.data;const V=(P.ascender-P.descender)*h;let K=0;d==="middle"?K=(c-V)/2:d==="bottom"&&(K=c-V);const q=m/T,ee=a.data.common.base,fe=P.ascender*h-ee,J=q+fe+L*c+K;if(!(k&&J>=k/T))return{sdfX:j,sdfY:J,lineIndex:L}}class pl{constructor(c,a=0){_(this,"iterator");_(this,"peekBuffer",[]);_(this,"_lastIndex");this.iterator=c,this.iterator=c,this._lastIndex=a-1,this.peekBuffer=[]}next(){const c=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return c.done?this._lastIndex=-1:this._lastIndex++,c}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const c=this.iterator.next();return this.peekBuffer.push(c),c}get lastIndex(){return this._lastIndex}}function*gl(h,c=0){let a=c;for(;a<h.length;){const d=h.codePointAt(a);if(d===void 0)throw new Error("Invalid Unicode code point");yield d,a+=d<=65535?1:2}}function JU(h,c,a){const d=a.shapeText(c,new pl(gl(h,0),0));let m=0;for(const T of d)T.mapped&&T.codepoint!==8203&&(m+=T.xAdvance);return m}function ZU(h,c,a,d,m,T,S,p,k,L,j,P,V,K,q,ee,ue,fe,J){q.loaded,q.data,q.shaper;const oe=p/q.data.info.size,x=k/oe,Y=T/oe,me=L/oe,pe=V[h],we=(pe==null?void 0:pe.codepointIndex)||0,C=(pe==null?void 0:pe.maxX)||0,ie=(pe==null?void 0:pe.maxY)||0;let Z=C,ge=ie,ce=c,se=a,ye=0;const Oe={codepointIndex:-1,bufferOffset:-1,xStart:-1},Tt=q.shaper,An={letterSpacing:me};d.endsWith(" ")&&(d+=" ");let mn=Tt.shapeText(An,new pl(gl(d,we),we)),Qt,Dn=-1;const Xn=[],F=S/oe,Rt=JU(fe,An,Tt);let Jr=!0;for(;Jr;){const Ft=(J===0||h+1<J)&&(P!=="both"||ue||se+x+q.maxCharHeight<=F),zn=Ft?Y:Y-Rt;let Kt=0;const mr=se+q.maxCharHeight>=K.y1,Zr=se<=K.y2,nr=mr&&Zr;for(;(Qt=mn.next())&&!Qt.done;){const de=Qt.value;if(h===V.length)V.push({codepointIndex:de.cluster,maxY:ge,maxX:Z});else if(h>V.length)throw new Error("Unexpected lineCache length");if(de.codepoint===32||de.codepoint===10||de.codepoint===8203?Oe.codepointIndex!==-1&&(Oe.codepointIndex=-1,Kt=ce):Oe.codepointIndex===-1&&(Oe.codepointIndex=de.cluster,Oe.bufferOffset=ye,Oe.xStart=Kt),de.mapped){const Xr=ce+de.xOffset+de.width;if(P!=="none"&&Xr>=zn&&Oe.codepointIndex!==-1&&Oe.xStart>0)if(Ft){mn=Tt.shapeText(An,new pl(gl(d,Oe.codepointIndex),Oe.codepointIndex)),ye=Oe.bufferOffset;break}else mn=Tt.shapeText(An,new pl(gl(fe,0),0)),ce=Oe.xStart,ye=Oe.bufferOffset,P="none";else{const yr=ce+de.xOffset,rr=se+de.yOffset;if(nr){Dn===-1&&(Dn=ye);const fi=q.getAtlasEntry(de.glyphId),yn=fi.x/q.data.common.scaleW,Be=fi.y/q.data.common.scaleH,ir=fi.width/q.data.common.scaleW,Ts=fi.height/q.data.common.scaleH;j[ye++]=yr,j[ye++]=rr,j[ye++]=yn,j[ye++]=Be,j[ye++]=yr+de.width,j[ye++]=rr,j[ye++]=yn+ir,j[ye++]=Be,j[ye++]=yr,j[ye++]=rr+de.height,j[ye++]=yn,j[ye++]=Be+Ts,j[ye++]=yr+de.width,j[ye++]=rr+de.height,j[ye++]=yn+ir,j[ye++]=Be+Ts}ge=Math.max(ge,rr+de.height),Z=Math.max(Z,yr+de.width),ce+=de.xAdvance}}else if(de.codepoint===10){if(Ft)break;mn=Tt.shapeText(An,new pl(gl(fe,0),0)),P="none"}}Dn!==-1&&(Xn.push({bufferStart:Dn,bufferEnd:ye}),Dn=-1),ce=0,se+=x,h++,Oe.codepointIndex=-1,Kt=0,!ee&&P==="both"&&se>K.y2||Qt&&Qt.done?Jr=!1:Ft||(Jr=!1)}if(m==="center"){const Ft=P==="none"?Z:Y;for(let zn=0;zn<Xn.length;zn++){const Kt=Xn[zn],mr=j[Kt.bufferEnd-4]-j[Kt.bufferStart],Zr=(Ft-mr)/2;for(let nr=Kt.bufferStart;nr<Kt.bufferEnd;nr+=4)j[nr]+=Zr}}else if(m==="right"){const Ft=P==="none"?Z:Y;for(let zn=0;zn<Xn.length;zn++){const Kt=Xn[zn],mr=Kt.bufferEnd===Kt.bufferStart?0:j[Kt.bufferEnd-4]-j[Kt.bufferStart],Zr=Ft-mr;for(let nr=Kt.bufferStart;nr<Kt.bufferEnd;nr+=4)j[nr]+=Zr}}return{bufferNumFloats:ye,bufferNumQuads:ye/16,layoutNumCharacters:Qt.done?d.length-we:Qt.value.cluster-we+1,fullyProcessed:!!Qt.done,maxX:Z,maxY:ge,numLines:V.length}}function ej(h,c){return Math.ceil(h/c)*c}function tj(h,c){return Math.floor(h/c)*c}function nj(h,c,a,d,m,T,S,p){const{screen:k,sdf:L}=h;if(!NL(S))k.x1=0,k.y1=0,k.x2=0,k.y2=0,L.x1=0,L.y1=0,L.x2=0,L.y2=0,h.numLines=0,h.firstLineIdx=0;else{const j=S.x1-c,P=j+(S.x2-S.x1),V=S.y1-a+d,K=tj(V-T,m||1),q=ej(V+(S.y2-S.y1)+T,m||1);k.x1=j,k.y1=K,k.x2=P,k.y2=q,L.x1=j/p,L.y1=K/p,L.x2=P/p,L.y2=q/p,h.numLines=Math.ceil((q-K)/m),h.firstLineIdx=m?Math.floor(K/m):0}h.valid=!0}function rj(h,c){return c*(h.ascender-h.descender+h.lineGap)}const ij={x:0,y:0,width:0,height:0};class sj extends xI{constructor(a){super(a);_(this,"ssdfFontFamilies",{});_(this,"msdfFontFamilies",{});_(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);_(this,"sdfShader");_(this,"rendererBounds");_(this,"type","sdf");this.sdfShader=this.stage.shManager.loadShader("SdfShader",{transform:new Float32Array,color:0,size:0,scrollY:0,distanceRange:0,debug:!1}).shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(a,d)=>{a.props.fontFamily=d,this.releaseFontFace(a),this.invalidateLayoutCache(a)},fontWeight:(a,d)=>{a.props.fontWeight=d,this.releaseFontFace(a),this.invalidateLayoutCache(a)},fontStyle:(a,d)=>{a.props.fontStyle=d,this.releaseFontFace(a),this.invalidateLayoutCache(a)},fontStretch:(a,d)=>{a.props.fontStretch=d,this.releaseFontFace(a),this.invalidateLayoutCache(a)},fontSize:(a,d)=>{a.props.fontSize=d,this.invalidateLayoutCache(a)},text:(a,d)=>{a.props.text=d,this.invalidateLayoutCache(a)},textAlign:(a,d)=>{a.props.textAlign=d,this.invalidateLayoutCache(a)},color:(a,d)=>{a.props.color=d},x:(a,d)=>{a.props.x=d,a.elementBounds.valid&&(this.setElementBoundsX(a),!a.renderWindow.valid&&cy(a.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(a))},y:(a,d)=>{a.props.y=d,a.elementBounds.valid&&(this.setElementBoundsY(a),!a.renderWindow.valid&&cy(a.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(a))},contain:(a,d)=>{a.props.contain=d,this.invalidateLayoutCache(a)},width:(a,d)=>{a.props.width=d,a.props.contain!=="none"&&this.invalidateLayoutCache(a)},height:(a,d)=>{a.props.height=d,a.props.contain==="both"&&this.invalidateLayoutCache(a)},offsetY:(a,d)=>{a.props.offsetY=d,this.invalidateLayoutCache(a)},scrollable:(a,d)=>{a.props.scrollable=d,this.invalidateLayoutCache(a)},scrollY:(a,d)=>{a.props.scrollY=d,this.scheduleUpdateState(a)},letterSpacing:(a,d)=>{a.props.letterSpacing=d,this.invalidateLayoutCache(a)},lineHeight:(a,d)=>{a.props.lineHeight=d,a.resLineHeight=void 0,this.invalidateLayoutCache(a)},maxLines:(a,d)=>{a.props.maxLines=d,this.invalidateLayoutCache(a)},textBaseline:(a,d)=>{a.props.textBaseline=d,this.invalidateLayoutCache(a)},verticalAlign:(a,d)=>{a.props.verticalAlign=d,this.invalidateLayoutCache(a)},overflowSuffix:(a,d)=>{a.props.overflowSuffix=d,this.invalidateLayoutCache(a)},debug:(a,d)=>{a.props.debug=d}}}canRenderFont(a){const{fontFamily:d}=a;return d in this.ssdfFontFamilies||d in this.msdfFontFamilies||d==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(a){return a instanceof AI}addFontFace(a){const d=a.fontFamily,m=a.type==="ssdf"?this.ssdfFontFamilies:a.type==="msdf"?this.msdfFontFamilies:void 0;if(!m){console.warn("Invalid font face type: ".concat(a.type));return}let T=m[d];T||(T=new Set,m[d]=T),T.add(a)}createState(a){return{props:a,status:"initialState",updateScheduled:!1,emitter:new xs,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(a){let{trFontFace:d}=a;const{textH:m,lineCache:T,debugData:S,forceFullLayoutCalc:p}=a;if(S.updateCount++,a.status==="initialState"&&this.setStatus(a,"loading"),d===void 0){if(d=this.resolveFontFace(a.props),a.trFontFace=d,d===void 0){const Tt="SdfTextRenderer: Could not resolve font face for family: '".concat(a.props.fontFamily,"'");console.error(Tt),this.setStatus(a,"failed",new Error(Tt));return}d.texture.setRenderableOwner(a.props.fontFamily,!0)}if(d.loaded===!1){d.once("loaded",()=>{this.scheduleUpdateState(a)});return}d.data,d.metrics;const{text:k,fontSize:L,x:j,y:P,contain:V,width:K,height:q,verticalAlign:ee,scrollable:ue,overflowSuffix:fe,maxLines:J}=a.props,oe=V==="both"&&ue?a.props.scrollY:0,{renderWindow:x}=a,Y=d.data.info.size,me=L/Y;let pe=a.resLineHeight;if(pe===void 0){const Tt=a.props.lineHeight;Tt===void 0?pe=rj(d.metrics,L):pe=Tt,a.resLineHeight=pe}const we=pe/me;a.distanceRange=me*d.data.distanceField.distanceRange;const C=k.length*qU;let ie=a.vertexBuffer;(!ie||ie.length<C)&&(ie=new Float32Array(C*2));const Z=a.elementBounds;if(Z.valid||(this.setElementBoundsX(a),this.setElementBoundsY(a),Z.valid=!0),!p&&x.valid){const Tt=x.screen;if(j+Tt.x1<=Z.x1&&j+Tt.x2>=Z.x2&&P-oe+Tt.y1<=Z.y1&&P-oe+Tt.y2>=Z.y2){this.setStatus(a,"loaded");return}x.valid=!1,this.setStatus(a,"loading")}const{offsetY:ge,textAlign:ce}=a.props;if(!x.valid){if(!cy(Z,this.rendererBounds))return;nj(x,j,P,oe,pe,V==="both"?Z.y2-Z.y1:0,Z,me)}const se=QU(Y,we,d,ee,ge,me,x,T,m);if(!se){this.setStatus(a,"loaded");return}const{letterSpacing:ye}=a.props,Oe=ZU(se.lineIndex,se.sdfX,se.sdfY,k,ce,K,q,L,pe,ye,ie,V,T,x.sdf,d,p,ue,fe,J);a.bufferUploaded=!1,a.bufferNumFloats=Oe.bufferNumFloats,a.bufferNumQuads=Oe.bufferNumQuads,a.vertexBuffer=ie,a.renderWindow=x,S.lastLayoutNumCharacters=Oe.layoutNumCharacters,S.bufferSize=ie.byteLength,Oe.fullyProcessed&&(a.textW=Oe.maxX*me,a.textH=Oe.numLines*we*me),this.setStatus(a,"loaded")}renderQuads(a,d,m,T,S,p){var Z,ge,ce;if(!a.vertexBuffer)return;const k=this.stage.renderer,{fontSize:L,color:j,contain:P,scrollable:V,zIndex:K,debug:q}=a.props,ee=P==="both"&&V?a.props.scrollY:0,{textW:ue=0,textH:fe=0,distanceRange:J,vertexBuffer:oe,bufferUploaded:x,trFontFace:Y,elementBounds:me}=a;let{webGlBuffers:pe}=a;if(!pe){const se=k.glw,ye=4*Float32Array.BYTES_PER_ELEMENT,Oe=se.createBuffer();a.webGlBuffers=new SI([{buffer:Oe,attributes:{a_position:{name:"a_position",size:2,type:se.FLOAT,normalized:!1,stride:ye,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:se.FLOAT,normalized:!1,stride:ye,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),a.bufferUploaded=!1,a.webGlBuffers,pe=a.webGlBuffers}if(!x){const se=k.glw,ye=(Z=pe==null?void 0:pe.getBuffer("a_textureCoordinate"))!=null?Z:null;se.arrayBufferData(ye,oe,se.STATIC_DRAW),a.bufferUploaded=!0}if(V&&P==="both"){me.valid;const se=PL(me,ij);m.valid?(a.clippingRect.valid=!0,m=lI(m,se,a.clippingRect)):(a.clippingRect.valid=!0,m=cI(se,a.clippingRect))}const we=new wI(k.glw,k.options,pe,this.sdfShader,{transform:d.getFloatArr(),color:IL(j,T),size:L/(((ge=Y.data)==null?void 0:ge.info.size)||0),scrollY:ee,distanceRange:J,debug:q.sdfShaderDebug},T,m,{height:fe,width:ue},0,K,!1,S,p),ie=((ce=a.trFontFace)==null?void 0:ce.texture).ctxTexture;we.addTexture(ie),we.length=a.bufferNumFloats,we.numQuads=a.bufferNumQuads,k.addRenderOp(we)}setIsRenderable(a,d){var m;super.setIsRenderable(a,d),(m=a.trFontFace)==null||m.texture.setRenderableOwner(a.props.fontFamily,d)}destroyState(a){var d;super.destroyState(a),(d=a.trFontFace)==null||d.texture.setRenderableOwner(a.props.fontFamily,!1)}resolveFontFace(a){return this.stage.fontManager.resolveFontFace(this.fontFamilyArray,a,"sdf")}releaseFontFace(a){a.resLineHeight=void 0,a.trFontFace&&(a.trFontFace.texture.setRenderableOwner(a.props.fontFamily,!1),a.trFontFace=void 0)}invalidateLayoutCache(a){a.renderWindow.valid=!1,a.elementBounds.valid=!1,a.textH=void 0,a.textW=void 0,a.lineCache=[],this.setStatus(a,"loading"),this.scheduleUpdateState(a)}setElementBoundsX(a){const{x:d,contain:m,width:T}=a.props,{elementBounds:S}=a;S.x1=d,S.x2=m!=="none"?d+T:1/0}setElementBoundsY(a){const{y:d,contain:m,height:T}=a.props,{elementBounds:S}=a;S.y1=d,S.y2=m==="both"?d+T:1/0}}var oj=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ry={};/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/var aI;function aj(){return aI||(aI=1,(function(h){(function(){var c=typeof window<"u"?window:oj,a={};(function(m,T,S){var p,k=typeof Object.create=="function"?Object.create:function(e){function t(){}return t.prototype=e,new t},L=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};function j(e){e=[typeof globalThis=="object"&&globalThis,e,typeof m=="object"&&m,typeof self=="object"&&self,typeof T=="object"&&T];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}var P=j(this);function V(e,t){if(t)e:{var n=P;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}e=e[e.length-1],r=n[e],t=t(r),t!=r&&t!=null&&L(n,e,{configurable:!0,writable:!0,value:t})}}var K;if(typeof Object.setPrototypeOf=="function")K=Object.setPrototypeOf;else{var q;e:{var ee={a:!0},ue={};try{ue.__proto__=ee,q=ue.a;break e}catch(e){}q=!1}K=q?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var fe=K;function J(e,t){if(e.prototype=k(t.prototype),e.prototype.constructor=e,fe)fe(e,t);else for(var n in t)if(n!="prototype")if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.Gm=t.prototype}function oe(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function x(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return{next:oe(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function Y(e){if(!(e instanceof Array)){e=x(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}function me(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.B=this.i=null}function pe(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}me.prototype.u=function(e){this.h=e};function we(e,t){e.i={$h:t,pi:!0},e.g=e.m||e.j}me.prototype.return=function(e){this.i={return:e},this.g=this.j};function C(e,t,n){return e.g=n,{value:t}}me.prototype.A=function(e){this.g=e};function ie(e){e.g=0}function Z(e,t,n){e.m=t,n!=null&&(e.j=n)}function ge(e,t){e.m=0,e.j=t||0}function ce(e,t,n){e.g=t,e.m=n||0}function se(e,t){return e.m=t||0,t=e.i.$h,e.i=null,t}function ye(e){e.B=[e.i],e.m=0,e.j=0}function Oe(e,t){var n=e.B.splice(0)[0];(n=e.i=e.i||n)?n.pi?e.g=e.m||e.j:n.A!=null&&e.j<n.A?(e.g=n.A,e.i=null):e.g=e.j:e.g=t}function Tt(e){this.g=new me,this.h=e}function An(e,t){pe(e.g);var n=e.g.l;return n?mn(e,"return"in n?n.return:function(r){return{value:r,done:!0}},t,e.g.return):(e.g.return(t),Qt(e))}function mn(e,t,n,r){try{var i=t.call(e.g.l,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.o=!1,i;var s=i.value}catch(o){return e.g.l=null,we(e.g,o),Qt(e)}return e.g.l=null,r.call(e.g,s),Qt(e)}function Qt(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,we(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.pi)throw t.$h;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function Dn(e){this.next=function(t){return pe(e.g),e.g.l?t=mn(e,e.g.l.next,t,e.g.u):(e.g.u(t),t=Qt(e)),t},this.throw=function(t){return pe(e.g),e.g.l?t=mn(e,e.g.l.throw,t,e.g.u):(we(e.g,t),t=Qt(e)),t},this.return=function(t){return An(e,t)},this[Symbol.iterator]=function(){return this}}function Xn(e){function t(r){return e.next(r)}function n(r){return e.throw(r)}return new Promise(function(r,i){function s(o){o.done?r(o.value):Promise.resolve(o.value).then(t,n).then(s,i)}s(e.next())})}function F(e){return Xn(new Dn(new Tt(e)))}function Rt(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}V("Symbol",function(e){function t(s){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(r+(s||"")+"_"+i++,s)}function n(s,o){this.g=s,L(this,"description",{configurable:!0,writable:!0,value:o})}if(e)return e;n.prototype.toString=function(){return this.g};var r="jscomp_symbol_"+(Math.random()*1e9>>>0)+"_",i=0;return t}),V("Symbol.iterator",function(e){return e||(e=Symbol("Symbol.iterator"),L(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return Jr(oe(this))}}),e)});function Jr(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}V("Promise",function(e){function t(o){this.h=0,this.i=void 0,this.g=[],this.o=!1;var u=this.j();try{o(u.resolve,u.reject)}catch(l){u.reject(l)}}function n(){this.g=null}function r(o){return o instanceof t?o:new t(function(u){u(o)})}if(e)return e;n.prototype.h=function(o){if(this.g==null){this.g=[];var u=this;this.i(function(){u.l()})}this.g.push(o)};var i=P.setTimeout;n.prototype.i=function(o){i(o,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var o=this.g;this.g=[];for(var u=0;u<o.length;++u){var l=o[u];o[u]=null;try{l()}catch(f){this.j(f)}}}this.g=null},n.prototype.j=function(o){this.i(function(){throw o})},t.prototype.j=function(){function o(f){return function(g){l||(l=!0,f.call(u,g))}}var u=this,l=!1;return{resolve:o(this.G),reject:o(this.l)}},t.prototype.G=function(o){if(o===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(o instanceof t)this.I(o);else{e:switch(typeof o){case"object":var u=o!=null;break e;case"function":u=!0;break e;default:u=!1}u?this.F(o):this.m(o)}},t.prototype.F=function(o){var u=void 0;try{u=o.then}catch(l){this.l(l);return}typeof u=="function"?this.J(u,o):this.m(o)},t.prototype.l=function(o){this.u(2,o)},t.prototype.m=function(o){this.u(1,o)},t.prototype.u=function(o,u){if(this.h!=0)throw Error("Cannot settle("+o+", "+u+"): Promise already settled in state"+this.h);this.h=o,this.i=u,this.h===2&&this.H(),this.B()},t.prototype.H=function(){var o=this;i(function(){if(o.C()){var u=P.console;typeof u<"u"&&u.error(o.i)}},1)},t.prototype.C=function(){if(this.o)return!1;var o=P.CustomEvent,u=P.Event,l=P.dispatchEvent;return typeof l>"u"?!0:(typeof o=="function"?o=new o("unhandledrejection",{cancelable:!0}):typeof u=="function"?o=new u("unhandledrejection",{cancelable:!0}):(o=P.document.createEvent("CustomEvent"),o.initCustomEvent("unhandledrejection",!1,!0,o)),o.promise=this,o.reason=this.i,l(o))},t.prototype.B=function(){if(this.g!=null){for(var o=0;o<this.g.length;++o)s.h(this.g[o]);this.g=null}};var s=new n;return t.prototype.I=function(o){var u=this.j();o.Se(u.resolve,u.reject)},t.prototype.J=function(o,u){var l=this.j();try{o.call(u,l.resolve,l.reject)}catch(f){l.reject(f)}},t.prototype.then=function(o,u){function l(v,w){return typeof v=="function"?function(A){try{f(v(A))}catch(I){g(I)}}:w}var f,g,y=new t(function(v,w){f=v,g=w});return this.Se(l(o,f),l(u,g)),y},t.prototype.catch=function(o){return this.then(void 0,o)},t.prototype.Se=function(o,u){function l(){switch(f.h){case 1:o(f.i);break;case 2:u(f.i);break;default:throw Error("Unexpected state: "+f.h)}}var f=this;this.g==null?s.h(l):this.g.push(l),this.o=!0},t.resolve=r,t.reject=function(o){return new t(function(u,l){l(o)})},t.race=function(o){return new t(function(u,l){for(var f=x(o),g=f.next();!g.done;g=f.next())r(g.value).Se(u,l)})},t.all=function(o){var u=x(o),l=u.next();return l.done?r([]):new t(function(f,g){function y(A){return function(I){v[A]=I,w--,w==0&&f(v)}}var v=[],w=0;do v.push(void 0),w++,r(l.value).Se(y(v.length-1),g),l=u.next();while(!l.done)})},t});function Ft(e,t){return Object.prototype.hasOwnProperty.call(e,t)}V("WeakMap",function(e){function t(l){if(this.g=(u+=Math.random()+1).toString(),l){l=x(l);for(var f;!(f=l.next()).done;)f=f.value,this.set(f[0],f[1])}}function n(){}function r(l){var f=typeof l;return f==="object"&&l!==null||f==="function"}function i(l){if(!Ft(l,o)){var f=new n;L(l,o,{value:f})}}function s(l){var f=Object[l];f&&(Object[l]=function(g){return g instanceof n?g:(Object.isExtensible(g)&&i(g),f(g))})}if((function(){if(!e||!Object.seal)return!1;try{var l=Object.seal({}),f=Object.seal({}),g=new e([[l,2],[f,3]]);return g.get(l)!=2||g.get(f)!=3?!1:(g.delete(l),g.set(f,4),!g.has(l)&&g.get(f)==4)}catch(y){return!1}})())return e;var o="$jscomp_hidden_"+Math.random();s("freeze"),s("preventExtensions"),s("seal");var u=0;return t.prototype.set=function(l,f){if(!r(l))throw Error("Invalid WeakMap key");if(i(l),!Ft(l,o))throw Error("WeakMap key fail: "+l);return l[o][this.g]=f,this},t.prototype.get=function(l){return r(l)&&Ft(l,o)?l[o][this.g]:void 0},t.prototype.has=function(l){return r(l)&&Ft(l,o)&&Ft(l[o],this.g)},t.prototype.delete=function(l){return r(l)&&Ft(l,o)&&Ft(l[o],this.g)?delete l[o][this.g]:!1},t}),V("Map",function(e){function t(){var u={};return u.xc=u.next=u.head=u}function n(u,l){var f=u[1];return Jr(function(){if(f){for(;f.head!=u[1];)f=f.xc;for(;f.next!=f.head;)return f=f.next,{done:!1,value:l(f)};f=null}return{done:!0,value:void 0}})}function r(u,l){var f=l&&typeof l;f=="object"||f=="function"?s.has(l)?f=s.get(l):(f=""+ ++o,s.set(l,f)):f="p_"+l;var g=u[0][f];if(g&&Ft(u[0],f))for(u=0;u<g.length;u++){var y=g[u];if(l!==l&&y.key!==y.key||l===y.key)return{id:f,list:g,index:u,entry:y}}return{id:f,list:g,index:-1,entry:void 0}}function i(u){if(this[0]={},this[1]=t(),this.size=0,u){u=x(u);for(var l;!(l=u.next()).done;)l=l.value,this.set(l[0],l[1])}}if((function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var u=Object.seal({x:4}),l=new e(x([[u,"s"]]));if(l.get(u)!="s"||l.size!=1||l.get({x:4})||l.set({x:4},"t")!=l||l.size!=2)return!1;var f=l.entries(),g=f.next();return g.done||g.value[0]!=u||g.value[1]!="s"?!1:(g=f.next(),!(g.done||g.value[0].x!=4||g.value[1]!="t"||!f.next().done))}catch(y){return!1}})())return e;var s=new WeakMap;i.prototype.set=function(u,l){u=u===0?0:u;var f=r(this,u);return f.list||(f.list=this[0][f.id]=[]),f.entry?f.entry.value=l:(f.entry={next:this[1],xc:this[1].xc,head:this[1],key:u,value:l},f.list.push(f.entry),this[1].xc.next=f.entry,this[1].xc=f.entry,this.size++),this},i.prototype.delete=function(u){return u=r(this,u),u.entry&&u.list?(u.list.splice(u.index,1),u.list.length||delete this[0][u.id],u.entry.xc.next=u.entry.next,u.entry.next.xc=u.entry.xc,u.entry.head=null,this.size--,!0):!1},i.prototype.clear=function(){this[0]={},this[1]=this[1].xc=t(),this.size=0},i.prototype.has=function(u){return!!r(this,u).entry},i.prototype.get=function(u){return(u=r(this,u).entry)&&u.value},i.prototype.entries=function(){return n(this,function(u){return[u.key,u.value]})},i.prototype.keys=function(){return n(this,function(u){return u.key})},i.prototype.values=function(){return n(this,function(u){return u.value})},i.prototype.forEach=function(u,l){for(var f=this.entries(),g;!(g=f.next()).done;)g=g.value,u.call(l,g[1],g[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var o=0;return i}),V("Set",function(e){function t(n){if(this.g=new Map,n){n=x(n);for(var r;!(r=n.next()).done;)this.add(r.value)}this.size=this.g.size}return(function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var n=Object.seal({x:4}),r=new e(x([n]));if(!r.has(n)||r.size!=1||r.add(n)!=r||r.size!=1||r.add({x:4})!=r||r.size!=2)return!1;var i=r.entries(),s=i.next();return s.done||s.value[0]!=n||s.value[1]!=n?!1:(s=i.next(),s.done||s.value[0]==n||s.value[0].x!=4||s.value[1]!=s.value[0]?!1:i.next().done)}catch(o){return!1}})()?e:(t.prototype.add=function(n){return n=n===0?0:n,this.g.set(n,n),this.size=this.g.size,this},t.prototype.delete=function(n){return n=this.g.delete(n),this.size=this.g.size,n},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(n){return this.g.has(n)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(n,r){var i=this;this.g.forEach(function(s){return n.call(r,s,s,i)})},t)});function zn(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var s=e[i];if(t.call(n,s,i,e))return{li:i,v:s}}return{li:-1,v:void 0}}V("Array.prototype.findIndex",function(e){return e||function(t,n){return zn(this,t,n).li}});function Kt(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}V("Array.prototype.values",function(e){return e||function(){return Kt(this,function(t,n){return n})}}),V("Array.from",function(e){return e||function(t,n,r){n=n!=null?n:function(u){return u};var i=[],s=typeof Symbol<"u"&&Symbol.iterator&&t[Symbol.iterator];if(typeof s=="function"){t=s.call(t);for(var o=0;!(s=t.next()).done;)i.push(n.call(r,s.value,o++))}else for(s=t.length,o=0;o<s;o++)i.push(n.call(r,t[o],o));return i}}),V("Array.prototype.keys",function(e){return e||function(){return Kt(this,function(t){return t})}});function mr(e,t,n){if(e==null)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}V("String.prototype.startsWith",function(e){return e||function(t,n){var r=mr(this,t,"startsWith"),i=r.length,s=t.length;n=Math.max(0,Math.min(n|0,r.length));for(var o=0;o<s&&n<i;)if(r[n++]!=t[o++])return!1;return o>=s}}),V("Object.is",function(e){return e||function(t,n){return t===n?t!==0||1/t===1/n:t!==t&&n!==n}}),V("Array.prototype.includes",function(e){return e||function(t,n){var r=this;r instanceof String&&(r=String(r));var i=r.length;for(n=n||0,n<0&&(n=Math.max(n+i,0));n<i;n++){var s=r[n];if(s===t||Object.is(s,t))return!0}return!1}}),V("String.prototype.includes",function(e){return e||function(t,n){return mr(this,t,"includes").indexOf(t,n||0)!==-1}}),V("String.fromCodePoint",function(e){return e||function(t){for(var n="",r=0;r<arguments.length;r++){var i=Number(arguments[r]);if(i<0||i>1114111||i!==Math.floor(i))throw new RangeError("invalid_code_point "+i);i<=65535?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(i>>>10&1023|55296),n+=String.fromCharCode(i&1023|56320))}return n}}),V("WeakSet",function(e){function t(n){if(this.g=new WeakMap,n){n=x(n);for(var r;!(r=n.next()).done;)this.add(r.value)}}return(function(){if(!e||!Object.seal)return!1;try{var n=Object.seal({}),r=Object.seal({}),i=new e([n]);return!i.has(n)||i.has(r)?!1:(i.delete(n),i.add(r),!i.has(n)&&i.has(r))}catch(s){return!1}})()?e:(t.prototype.add=function(n){return this.g.set(n,!0),this},t.prototype.has=function(n){return this.g.has(n)},t.prototype.delete=function(n){return this.g.delete(n)},t)}),V("Array.prototype.find",function(e){return e||function(t,n){return zn(this,t,n).v}}),V("Object.entries",function(e){return e||function(t){var n=[],r;for(r in t)Ft(t,r)&&n.push([r,t[r]]);return n}});var Zr=typeof Object.assign=="function"?Object.assign:function(e,t){if(e==null)throw new TypeError("No nullish arg");e=Object(e);for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Ft(r,i)&&(e[i]=r[i])}return e};V("Object.assign",function(e){return e||Zr}),V("Promise.prototype.finally",function(e){return e||function(t){return this.then(function(n){return Promise.resolve(t()).then(function(){return n})},function(n){return Promise.resolve(t()).then(function(){throw n})})}}),V("Array.prototype.entries",function(e){return e||function(){return Kt(this,function(t,n){return[t,n]})}}),V("Number.isNaN",function(e){return e||function(t){return typeof t=="number"&&isNaN(t)}}),V("String.prototype.repeat",function(e){return e||function(t){var n=mr(this,null,"repeat");if(t<0||t>1342177279)throw new RangeError("Invalid count value");t|=0;for(var r="";t;)t&1&&(r+=n),(t>>>=1)&&(n+=n);return r}}),V("Number.EPSILON",function(){return 2220446049250313e-31}),V("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),V("Number.isFinite",function(e){return e||function(t){return typeof t!="number"?!1:!isNaN(t)&&t!==1/0&&t!==-1/0}}),V("Object.values",function(e){return e||function(t){var n=[],r;for(r in t)Ft(t,r)&&n.push(t[r]);return n}}),V("Math.log2",function(e){return e||function(t){return Math.log(t)/Math.LN2}}),V("String.prototype.endsWith",function(e){return e||function(t,n){var r=mr(this,t,"endsWith");n===void 0&&(n=r.length),n=Math.max(0,Math.min(n|0,r.length));for(var i=t.length;i>0&&n>0;)if(r[--n]!=t[--i])return!1;return i<=0}}),V("Math.trunc",function(e){return e||function(t){if(t=Number(t),isNaN(t)||t===1/0||t===-1/0||t===0)return t;var n=Math.floor(Math.abs(t));return t<0?-n:n}});var nr=this||self;function de(e,t){e=e.split(".");var n=nr;e[0]in n||typeof n.execScript>"u"||n.execScript("var "+e[0]);for(var r;e.length&&(r=e.shift());)e.length||t===void 0?n[r]&&n[r]!==Object.prototype[r]?n=n[r]:n=n[r]={}:n[r]=t}function Xr(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}Xr.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)};function yr(e){return e.h/(1-Math.pow(e.g,e.i))}function rr(){this.h=new Xr(2),this.j=new Xr(5),this.g=0,this.i=128e3,this.l=16e3}rr.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},rr.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},rr.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(yr(this.h),yr(this.j))};function fi(){}function yn(){}function Be(){}function ir(e){var t=Rt.apply(1,arguments);Pa.has(e)||(Pa.add(e),Be.apply(fi,Y(t)))}function Ts(){}function fh(){}function hh(){}var Pa=new Set;m.console&&(new Map().set(1,function(){return console.error.apply(console,Y(Rt.apply(0,arguments)))}).set(2,function(){return console.warn.apply(console,Y(Rt.apply(0,arguments)))}).set(3,function(){return console.info.apply(console,Y(Rt.apply(0,arguments)))}).set(4,function(){return console.log.apply(console,Y(Rt.apply(0,arguments)))}).set(5,function(){return console.debug.apply(console,Y(Rt.apply(0,arguments)))}).set(6,function(){return console.debug.apply(console,Y(Rt.apply(0,arguments)))}),Be=function(){return console.warn.apply(console,Y(Rt.apply(0,arguments)))},yn=function(){console.error.apply(console,Y(Rt.apply(0,arguments)))});function Da(e,t){return typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)?!0:e===t}function Dr(e,t){t=e.indexOf(t),t>-1&&e.splice(t,1)}function ws(e,t,n){if(n||(n=Da),e.length!=t.length)return!1;t=t.slice(),e=x(e);for(var r=e.next(),i={};!r.done;i={si:void 0},r=e.next()){if(i.si=r.value,r=t.findIndex((function(s){return function(o){return n(s.si,o)}})(i)),r==-1)return!1;t[r]=t[t.length-1],t.pop()}return t.length==0}function Wi(e,t,n){if(e===t)return!0;if(!e||!t)return e==t;if(n||(n=Da),e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function Nl(){this.g=new Map}p=Nl.prototype,p.push=function(e,t){this.g.has(e)?this.g.get(e).push(t):this.g.set(e,[t])},p.get=function(e){return this.g.has(e)?this.g.get(e).slice():null},p.remove=function(e,t){if(this.g.has(e)){var n=this.g.get(e).filter(function(r){return r!=t});this.g.set(e,n),n.length||this.g.delete(e)}},p.forEach=function(e){this.g.forEach(function(t,n){e(n,t)})},p.size=function(){return this.g.size},p.keys=function(){return Array.from(this.g.keys())};function et(){this.g=new Nl}p=et.prototype,p.release=function(){this.Qa(),this.g=null},p.D=function(e,t,n,r){this.g&&(e=new lv(e,t,n,r),this.g.push(t,e))},p.Aa=function(e,t,n,r){function i(o){s.Ma(e,t,i),n(o)}var s=this;this.D(e,t,i,r)},p.Ma=function(e,t,n){if(this.g){var r=this.g.get(t)||[];r=x(r);for(var i=r.next();!i.done;i=r.next())i=i.value,i.target!=e||n!=i.listener&&n||(i.Ma(),this.g.remove(t,i))}},p.Qa=function(){if(this.g){for(var e=[],t=x(this.g.g.values()),n=t.next();!n.done;n=t.next())e.push.apply(e,Y(n.value));for(e=x(e),t=e.next();!t.done;t=e.next())t.value.Ma();this.g.g.clear()}},de("shaka.util.EventManager",et),et.prototype.removeAll=et.prototype.Qa,et.prototype.unlisten=et.prototype.Ma,et.prototype.listenOnce=et.prototype.Aa,et.prototype.listen=et.prototype.D,et.prototype.release=et.prototype.release;function lv(e,t,n,r){this.target=e,this.type=t,this.listener=n,this.g=A2(e,r),this.target.addEventListener(t,n,this.g)}lv.prototype.Ma=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};function A2(e,t){if(t==null)return!1;if(typeof t=="boolean")return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(r){return!n.has(r)}),E2(e)?t:t.capture||!1}function E2(e){var t=cv;if(t==null){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r),r=function(){},e.addEventListener("test",r,n),e.removeEventListener("test",r,n)}catch(i){t=!1}cv=t}return t||!1}var cv=void 0;de("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3});function vt(e){this.h=e,this.g=void 0}vt.prototype.value=function(){return this.g===void 0&&(this.g=this.h()),this.g};/*
 @license
 Shaka Player
 Copyright 2025 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function je(){return I2.value()}var zr=null,ph=null,I2=new vt(function(){var e=void 0;return zr&&(e=zr()),!e&&ph&&(e=ph()),e});function gh(e,t){this.g=e,this.h=t}gh.prototype.toString=function(){return"v"+this.g+"."+this.h};function qe(e,t){var n=new gh(5,0),r=dv,i=r.g,s=n.h-i.h;((n.g-i.g||s)>0?r.i:r.h)(r.g,n,e,t)}function C2(e,t,n,r){Be([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}function M2(e,t,n,r){yn([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join(" "))}var dv=null;/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/var R2=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function Pt(e){var t;e instanceof Pt?(Ol(this,e.fc),this.hd=e.hd,Ul(this,e.Eb),mh(this,e.Dd),this.Tb=e.Tb,Ss(this,e.g.clone()),this.Rc=e.Rc):e&&(t=String(e).match(R2))?(Ol(this,t[1]||"",!0),this.hd=ro(t[2]||""),Ul(this,t[3]||"",!0),mh(this,t[4]),this.Tb=ro(t[5]||"",!0),Ss(this,t[6]||"",!0),this.Rc=ro(t[7]||"")):this.g=new io(null)}p=Pt.prototype,p.fc="",p.hd="",p.Eb="",p.Dd=null,p.Tb="",p.Rc="",p.toString=function(){var e=[],t=this.fc;if(t&&e.push(La(t,fv,!0),":"),t=this.Eb){e.push("//");var n=this.hd;n&&e.push(La(n,fv,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.Dd,t!=null&&e.push(":",String(t))}return(t=this.Tb)&&(this.Eb&&t.charAt(0)!="/"&&e.push("/"),e.push(La(t,t.charAt(0)=="/"?P2:_2,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.Rc)&&e.push("#",La(t,L2)),e.join("")},p.resolve=function(e){var t=this.clone();t.fc==="data"&&(t=new Pt);var n=!!e.fc;n?Ol(t,e.fc):n=!!e.hd,n?t.hd=e.hd:n=!!e.Eb,n?Ul(t,e.Eb):n=e.Dd!=null;var r=e.Tb;if(n)mh(t,e.Dd);else if(n=!!e.Tb){if(r.charAt(0)!="/")if(this.Eb&&!this.Tb)r="/"+r;else{var i=t.Tb.lastIndexOf("/");i!=-1&&(r=t.Tb.substr(0,i+1)+r)}if(r==".."||r==".")r="";else if(r.indexOf("./")!=-1||r.indexOf("/.")!=-1){i=r.lastIndexOf("/",0)==0,r=r.split("/");for(var s=[],o=0;o<r.length;){var u=r[o++];u=="."?i&&o==r.length&&s.push(""):u==".."?((s.length>1||s.length==1&&s[0]!="")&&s.pop(),i&&o==r.length&&s.push("")):(s.push(u),i=!0)}r=s.join("/")}}return n?t.Tb=r:n=e.g.toString()!=="",n?Ss(t,e.g.clone()):n=!!e.Rc,n&&(t.Rc=e.Rc),t},p.clone=function(){return new Pt(this)};function Ol(e,t,n){e.fc=n?ro(t,!0):t,e.fc&&(e.fc=e.fc.replace(/:$/,""))}function Ul(e,t,n){e.Eb=n?ro(t,!0):t}function mh(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.Dd=t}else e.Dd=null}function Ss(e,t,n){t instanceof io?e.g=t:(n||(t=La(t,D2)),e.g=new io(t))}function ro(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function La(e,t,n){return e!=null?(e=encodeURI(e).replace(t,k2),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function k2(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var fv=/[#\/\?@]/g,_2=/[#\?:]/g,P2=/[#\?]/g,D2=/[#\?@]/g,L2=/#/g;function io(e){this.g=e||null}function jl(e){if(!e.fb&&(e.fb=new Map,e.Ud=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(r>=0){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];s=decodeURIComponent(s),i=i||"",e.add(s,decodeURIComponent(i))}}p=io.prototype,p.fb=null,p.Ud=null;function hv(e){return jl(e),e.Ud}p.add=function(e,t){jl(this),this.g=null;var n=this.fb.has(e)?this.fb.get(e):null;return n||this.fb.set(e,n=[]),n.push(t),this.Ud++,this},p.set=function(e,t){return jl(this),this.g=null,this.fb.has(e)?this.fb.set(e,[t]):this.add(e,t),this},p.get=function(e){return jl(this),this.fb.get(e)||[]},p.toString=function(){if(this.g)return this.g;if(!this.fb||!this.fb.size)return"";for(var e=[],t=x(this.fb.keys()),n=t.next();!n.done;n=t.next()){var r=n.value;n=encodeURIComponent(r),r=this.fb.get(r);for(var i=0;i<r.length;i++){var s=n;r[i]!==""&&(s+="="+encodeURIComponent(r[i])),e.push(s)}}return this.g=e.join("&")},p.clone=function(){var e=new io;if(e.g=this.g,this.fb){for(var t=new Map,n=x(this.fb),r=n.next();!r.done;r=n.next()){var i=x(r.value);r=i.next().value,i=i.next().value,t.set(r,i.concat())}e.fb=t,e.Ud=this.Ud}return e};function so(){}function hi(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if((ArrayBuffer.isView(e)?e.buffer:e)==(ArrayBuffer.isView(t)?t.buffer:t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Le(e);t=Le(t);for(var r=0;r<e.byteLength;r++)if(n[r]!=t[r])return!1;return!0}function vr(e){return ArrayBuffer.isView(e)?e.byteOffset==0&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e}function Le(e,t,n){return n=n===void 0?1/0:n,yh(e,t===void 0?0:t,n,Uint8Array)}function pv(e,t,n){return n=n===void 0?1/0:n,yh(e,t===void 0?0:t,n,Uint16Array)}function Ln(e,t,n){return n=n===void 0?1/0:n,yh(e,t===void 0?0:t,n,DataView)}function yh(e,t,n,r){var i=ArrayBuffer.isView(e)?e.buffer:e,s=1;"BYTES_PER_ELEMENT"in r&&(s=r.BYTES_PER_ELEMENT);var o=((e.byteOffset||0)+e.byteLength)/s;return e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/s,o))),new r(i,e,Math.floor(Math.min(e+Math.max(n,0),o))-e)}de("shaka.util.BufferUtils",so),so.toDataView=Ln,so.toUint16=pv,so.toUint8=Le,so.toArrayBuffer=vr,so.equal=hi;function gv(e,t){if(e===t||!e.length||!t.length)return!0;e=x(e);for(var n=e.next();!n.done;n=e.next()){if(n=n.value,Bl(n))return!0;for(var r=x(t),i=r.next();!i.done;i=r.next())if(i=i.value,n.keySystem===i.keySystem||Bl(i))return!0}return!1}function mv(e,t){if(!e.length)return t;if(!t.length)return e;var n=[];e=x(e);for(var r=e.next();!r.done;r=e.next()){r=r.value;for(var i=x(t),s=i.next();!s.done;s=i.next())if(s=s.value,r.keySystem==s.keySystem){i=new Map;for(var o=x((r.initData||[]).concat(s.initData||[])),u=o.next();!u.done;u=o.next())u=u.value,i.set(u.keyId,u);i=Array.from(i.values()),o=r.keyIds&&s.keyIds?new Set([].concat(Y(r.keyIds),Y(s.keyIds))):r.keyIds||s.keyIds,n.push({keySystem:r.keySystem,licenseServerUri:r.licenseServerUri||s.licenseServerUri,distinctiveIdentifierRequired:r.distinctiveIdentifierRequired||s.distinctiveIdentifierRequired,persistentStateRequired:r.persistentStateRequired||s.persistentStateRequired,videoRobustness:r.videoRobustness||s.videoRobustness,audioRobustness:r.audioRobustness||s.audioRobustness,serverCertificate:r.serverCertificate||s.serverCertificate,serverCertificateUri:r.serverCertificateUri||s.serverCertificateUri,initData:i,keyIds:o});break}else Bl(r)?n.push(r):Bl(s)&&n.push(s)}return n}function vh(e){return e?!!e.match(/^com\.(microsoft|chromecast)\.playready/):!1}function ba(e){return e?!!e.match(/^com\.apple\.fps/):!1}function Bl(e){return(e=e.licenseServerUri)?e.startsWith("data:application/json;base64,"):!1}function xh(e,t,n,r){return r=[].concat(Y(new Set(r))).sort().join("#"),e+"#"+t+"#"+n+"#"+r}var Fl=new vt(function(){return vr(new Uint8Array([0]))}),oo=new Map;function H(e,t,n){var r=Rt.apply(3,arguments);this.severity=e,this.category=t,this.code=n,this.data=r,this.handled=!1,this.message="Shaka Error "+this.code;try{throw Error(this.message||"Shaka Error")}catch(i){this.stack=i.stack}}H.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},de("shaka.util.Error",H),H.Severity={RECOVERABLE:1,CRITICAL:2},H.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},H.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,STREAMING_NOT_ALLOWED:3024,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,CANNOT_ADD_EXTERNAL_CHAPTERS_TO_LIVE_STREAM:4055,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,QUEUE_INDEX_OUT_OF_BOUNDS:7007,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007};function As(){}function wt(e){if(!e)return"";if(e=Le(e),e[0]==239&&e[1]==187&&e[2]==191&&(e=e.subarray(3)),m.TextDecoder&&!je().wh())return e=new TextDecoder().decode(e),e.includes("")&&yn('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var t="",n=0;n<e.length;++n){var r=65533;if((e[n]&128)==0?r=e[n]:e.length>=n+2&&(e[n]&224)==192&&(e[n+1]&192)==128?(r=(e[n]&31)<<6|e[n+1]&63,n+=1):e.length>=n+3&&(e[n]&240)==224&&(e[n+1]&192)==128&&(e[n+2]&192)==128?(r=(e[n]&15)<<12|(e[n+1]&63)<<6|e[n+2]&63,n+=2):e.length>=n+4&&(e[n]&241)==240&&(e[n+1]&192)==128&&(e[n+2]&192)==128&&(e[n+3]&192)==128&&(r=(e[n]&7)<<18|(e[n+1]&63)<<12|(e[n+2]&63)<<6|e[n+3]&63,n+=3),r<=65535)t+=String.fromCharCode(r);else{r-=65536;var i=r&1023;t+=String.fromCharCode(55296+(r>>10)),t+=String.fromCharCode(56320+i)}}return t}function Ki(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw new H(2,2,2004);n=Math.floor(e.byteLength/2);var r=new Uint16Array(n);e=Ln(e);for(var i=0;i<n;i++)r[i]=e.getUint16(i*2,t);return wh(r)}function ei(e){function t(r){return n.byteLength<=r||n[r]>=9&&n[r]<=126}if(!e)return"";var n=Le(e);if(n[0]==239&&n[1]==187&&n[2]==191)return wt(n);if(n[0]==254&&n[1]==255)return Ki(n.subarray(2),!1);if(n[0]==255&&n[1]==254)return Ki(n.subarray(2),!0);if(n[0]==0&&n[2]==0)return Ki(e,!1);if(n[1]==0&&n[3]==0)return Ki(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return wt(e);throw new H(2,2,2003)}function Lr(e){if(m.TextEncoder&&!je().wh()){var t=new TextEncoder;return vr(t.encode(e))}e=encodeURIComponent(e),e=unescape(e),t=new Uint8Array(e.length);for(var n=0;n<e.length;n++)t[n]=e[n].charCodeAt(0);return vr(t)}function Th(e,t){for(var n=new ArrayBuffer(e.length*2),r=new DataView(n),i=0;i<e.length;++i)r.setUint16(i*2,e.charCodeAt(i),t);return n}function wh(e){return yv.value()(e)}function En(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,r=RegExp(n.source);return e&&r.test(e)?e.replace(n,function(i){return i[1]=="#"?(i=i[2]=="x"||i[2]=="X"?parseInt(i.substring(3),16):parseInt(i.substring(2),10),i>=0&&i<=1114111?String.fromCodePoint(i):""):t[i]||"'"}):e||""}de("shaka.util.StringUtils",As),As.resetFromCharCode=function(){yv.g=void 0},As.toUTF16=Th,As.toUTF8=Lr,As.fromBytesAutoDetect=ei,As.fromUTF16=Ki,As.fromUTF8=wt;var yv=new vt(function(){function e(n){try{var r=new Uint8Array(n);return String.fromCharCode.apply(null,r).length>0}catch(i){return!1}}for(var t={Pc:65536};t.Pc>0;t={Pc:t.Pc},t.Pc/=2)if(e(t.Pc))return(function(n){return function(r){for(var i="",s=0;s<r.length;s+=n.Pc)i+=String.fromCharCode.apply(null,r.subarray(s,s+n.Pc));return i}})(t);return null});function un(){}function Vl(e){return e=wh(Le(e)),btoa(e)}function pi(e,t){return t=t==null?!0:t,e=Vl(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function xr(e){e=m.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}function Es(e){for(var t=e.length/2,n=new Uint8Array(t),r=0;r<t;r++)n[r]=m.parseInt(e.substr(r*2,2),16);return n}function gi(e){var t=Le(e);e="",t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n=n.toString(16),n.length==1&&(n="0"+n),e+=n;return e}function Lt(){for(var e=Rt.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var r=n=0;r<e.length;++r){var i=e[r];ArrayBuffer.isView(i)&&i.BYTES_PER_ELEMENT===1?t.set(i,n):t.set(Le(i),n),n+=i.byteLength}return t}de("shaka.util.Uint8ArrayUtils",un),un.concat=Lt,un.toHex=gi,un.fromHex=Es,un.fromBase64=xr,un.toBase64=pi,un.toStandardBase64=Vl;function $t(e,t,n){if(n=n===void 0?"":n,t.length==0)return e;if(e.length==1&&t.length==1){var r=new Pt(e[0]);return t=new Pt(t[0]),t=r.resolve(t),n&&Ss(t,n),[t.toString()]}t=t.map(function(u){return new Pt(u)}),r=[],e=x(e);for(var i=e.next();!i.done;i=e.next()){i=new Pt(i.value);for(var s=x(t),o=s.next();!o.done;o=s.next())o=i.resolve(o.value),n&&Ss(o,n),r.push(o.toString())}return r}function mi(e,t,n,r){return t={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},r&&(t.keySystemUris=new Set([r])),!n&&ba(e)&&t.initData.push({initDataType:"sinf",initData:new Uint8Array(0),keyId:null}),t}function vv(e,t){t=t===void 0?"cenc":t;var n=[],r=[],i=[];e.forEach(function(o,u){var l=u;l.length!=22&&(l=pi(Es(u),!1));var f=o;f.length!=22&&(f=pi(Es(o),!1)),o={kty:"oct",kid:l,k:f},n.push(o),r.push(o.kid),i.push(u)}),e=JSON.stringify({keys:n});var s=JSON.stringify({kids:r});return s=[{initData:Le(Lr(s)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:t,licenseServerUri:"data:application/json;base64,"+m.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:s,keyIds:new Set(i)}}function ao(e,t){if(t.length==1)return t[0];if(e=bn(e,t),e!=null)return e;throw new H(2,4,4025,t)}function bn(e,t){var n=Tv.get(e);n=x(n);for(var r=n.next();!r.done;r=n.next()){r=r.value;for(var i=x(t),s=i.next();!s.done;s=i.next())if(s=s.value,r.test(s.trim()))return s.trim()}return e==Fe?"":null}function Sh(e,t){var n=[];e=Tv.get(e),e=x(e);for(var r=e.next();!r.done;r=e.next()){r=r.value;for(var i=x(t),s=i.next();!s.done;s=i.next())s=s.value,r.test(s.trim())&&n.push(s.trim())}return n}var Fe="text",bt={wa:"video",aa:"audio",Na:Fe,Xf:"image",ql:"application"},xv=1/15,Tv=new Map().set("audio",[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/,/^ac3$/,/^eac3$/,/^apac$/]).set("video",[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/]).set("text",[/^vtt$/,/^wvtt/,/^stpp/]);function Na(e,t,n,r){this.g=null,this.l=e,this.i=t,this.m=n,this.o=r,this.j=!1;e:{if(typeof libDPIModule>"u"&&Be("Could not find LCEVC Library dependencies on this page"),typeof LCEVCdec<"u")this.h=LCEVCdec;else if(typeof LcevcDil<"u")this.h=LcevcDil,this.j=!0,qe("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead");else{Be("Could not find LCEVC Library on this page"),e=!1;break e}typeof this.h.SupportObject>"u"?(Be("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||Be(this.h.SupportObject.SupportError),e=typeof this.h<"u"&&typeof libDPIModule<"u"&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function Hl(e,t,n,r){r.type!=="video"||e.o&&!r.baseOriginalId||e.g&&e.g.appendBuffer(t,"video",r.id,-n,!e.o)}function wv(e){e.g&&e.i.classList.add("shaka-hidden")}Na.prototype.release=function(){this.g&&(this.g.close(),this.g=null)};function Sv(e){return e&&typeof LCEVCdec<"u"?e.codecs=="lvc1":!1}de("shaka.lcevc.Dec",Na),Na.prototype.release=Na.prototype.release;function Oa(){}function Is(e,t){uo.set(e,t)}function b2(){var e={};if(je(),oi())for(var t=x(uo.keys()),n=t.next();!n.done;n=t.next())e[n.value]=!0;for(t=x(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]),n=t.next();!n.done;n=t.next())n=n.value,e[n]=oi()?uo.has(n):Bs().canPlayType(n)!="";return e}function Av(e,t){if(t){var n=uo.get(t.toLowerCase());if(n)return n}throw new H(2,4,4e3,e,t)}de("shaka.media.ManifestParser",Oa),Oa.unregisterParserByMime=function(e){uo.delete(e)},Oa.registerParserByMime=Is,Oa.registerParserByExtension=function(){qe("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},Oa.AccessibilityPurpose={Am:"visually impaired",Ll:"hard of hearing",hm:"spoken subtitles"};var uo=new Map;function Ua(){}Ua.prototype.extract=function(){},Ua.prototype.decode=function(){return[]},Ua.prototype.clear=function(){},Ua.prototype.getStreams=function(){return[]};function Ah(){}Ah.prototype.init=function(){},Ah.prototype.parse=function(){return[]};function Ev(){}p=Ev.prototype,p.init=function(){},p.zf=function(){},p.Od=function(){},p.remove=function(){},p.Yf=function(){},de("shaka.media.IClosedCaptionParser",Ev);function Wr(e){this.h=new Map,this.i=0,this.j=new Ah,(e=Iv(e.toLowerCase()))&&(this.j=e()),this.g=new Ua,(e=Cs)&&(this.g=e(),this.h.set(this.i,this.g))}p=Wr.prototype,p.init=function(e,t,n){if(t=t===void 0?!1:t,n=n===void 0?-1:n,n!=-1&&this.i!=n){t=n;var r=this.h.get(t);this.h.set(this.i,this.g),r?this.g=r:((r=Cs)&&(this.g=r()),this.h.set(t,this.g))}else t||this.Od();this.j.init(e),n!=-1&&(this.i=n)},p.zf=function(e){e=this.j.parse(e),e=x(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=Le(t.packet);n.length>0&&this.g.extract(n,t.pts)}return this.g.decode()},p.Od=function(){this.g.clear()},p.remove=function(e){e=e===void 0?[]:e,e=new Set(e);for(var t=x(this.h.keys()),n=t.next();!n.done;n=t.next())if(n=n.value,!e.has(n)){var r=this.h.get(n);r&&r.clear(),this.h.delete(n)}},p.Yf=function(){return this.g.getStreams()};function Eh(e,t){Ih.set(e,t)}function Iv(e){return Ih.get(e)}de("shaka.media.ClosedCaptionParser",Wr),Wr.findDecoder=function(){return Cs},Wr.unregisterDecoder=function(){Cs=null},Wr.registerDecoder=function(e){Cs=e},Wr.findParser=Iv,Wr.unregisterParser=function(e){Ih.delete(e)},Wr.registerParser=Eh;var Ih=new Map,Cs=null;function Ms(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Wn,this.scroll=Cv}de("shaka.text.CueRegion",Ms);var Wn=1;Ms.units={PX:0,PERCENTAGE:Wn,LINES:2};var Cv="";Ms.scrollMode={NONE:Cv,UP:"up"};function lo(e){this.h=e||"",this.g=0}function co(e){$i(e,/[ \t]+/gm)}function $i(e,t){return t.lastIndex=e.g,t=t.exec(e.h),t=t==null?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||t==null||t.position!=e.g?null:(e.g+=t.length,t.results)}function Rs(e){return e.g==e.h.length?null:(e=$i(e,/[^ \t\n]*/gm))?e[0]:null}function ja(e){if(e=$i(e,N2),e==null)return null;var t=Number(e[2]),n=Number(e[3]);return t>59||n>59?null:(Number(e[6])||0)/1e3+n+t*60+(Number(e[1])||0)*3600}function fo(e){return e?ja(new lo(e)):null}var N2=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function Gl(){}function br(e){function t(r){switch(typeof r){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return r;default:if(!r||ArrayBuffer.isView(r))return r;if(n.has(r))return null;var i=Array.isArray(r);if(r.constructor!=Object&&!i)return null;n.add(r);var s=i?[]:{},o;for(o in r)s[o]=t(r[o]);return i&&(s.length=r.length),s}}var n=new WeakSet;return t(e)}function Yi(e){var t={},n;for(n in e)t[n]=e[n];return t}function Xl(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var r=n.toString(),i=e[n];i!==void 0&&(i=Xl(i))&&t.push(r+":"+i)}e="["+t.join(",")+"]"}else if(typeof e=="function")e="";else if(e instanceof Object){for(n=Object.keys(e),n.sort(),t=[],n=x(n),r=n.next();!r.done;r=n.next())i=r.value,r=JSON.stringify(i),i=e[i],i!==void 0&&(i=Xl(i))&&t.push(r+":"+i);e="{"+t.join(",")+"}"}else e=JSON.stringify(e);return e}de("shaka.util.ObjectUtils",Gl),Gl.alphabeticalKeyOrderStringify=Xl,Gl.shallowCloneObject=Yi,Gl.cloneObject=br;/*
 @license
 tXml
 Copyright 2015 Tobias Nickel
 SPDX-License-Identifier: MIT
*/function Ba(e,t){var n=n===void 0?!1:n;return e=ei(e),ks(e,t,n)}function ks(e,t,n){return e=O2(e,n===void 0?!1:n),!t&&e.length?e[0]:(e=e.find(function(r){return t.split(",").includes(r.tagName)}))?e:null}function Ch(e){return Rh.has(e)?Rh.get(e):""}function O2(e,t){function n(s,o){o=o===void 0?!1:o;for(var u=[];e[i];)if(e.charCodeAt(i)==60){if(e.charCodeAt(i+1)===47){o=i+2,i=e.indexOf(">",i),o=e.substring(o,i);var l=o.indexOf(s);if(l==-1){var f=s.indexOf(".");f>0&&(l=o.indexOf(s.substring(0,f)))}if(l==-1)throw s=e.substring(0,i).split("\n"),Error("Unexpected close tag\nLine: "+(s.length-1)+"\nColumn: "+(s[s.length-1].length+1)+"\nChar: "+e[i]);i+1&&(i+=1);break}else if(e.charCodeAt(i+1)===33){if(e.charCodeAt(i+2)==45){for(;i!==-1&&(e.charCodeAt(i)!==62||e.charCodeAt(i-1)!=45||e.charCodeAt(i-2)!=45||i==-1);)i=e.indexOf(">",i+1);i===-1&&(i=e.length)}else if(e.charCodeAt(i+2)===91&&e.charCodeAt(i+8)===91&&e.substr(i+3,5).toLowerCase()==="cdata"){l=e.indexOf("]]>",i),l==-1?(u.push(e.substr(i+9)),i=e.length):(u.push(e.substring(i+9,l)),i=l+3);continue}i++;continue}e:{f=o,i++;var g=r(),y={};for(l=[];e.charCodeAt(i)!==62&&e[i];){var v=e.charCodeAt(i);if(v>64&&v<91||v>96&&v<123){v=r();for(var w=e.charCodeAt(i);w&&w!==39&&w!==34&&!(w>64&&w<91||w>96&&w<123)&&w!==62;)i++,w=e.charCodeAt(i);var A=i+1;if(i=e.indexOf(e[i],A),A=(" "+e.slice(A,i)).slice(1),w===39||w===34){if(i===-1){if(f={tagName:g,attributes:y,children:l,parent:null},t)for(g=0;g<l.length;g++)typeof l[g]!="string"&&(l[g].parent=f);l=f;break e}}else A=null,i--;if(v.startsWith("xmlns:")){w=A;var I=v.split(":")[1];Rh.set(w,I),kh.set(I,w)}g==="tt"&&v==="xml:space"&&A==="preserve"&&(f=!0),y[v]=A}i++}for(e.charCodeAt(i-1)!==47?(i++,l=n(g,f)):i++,f={tagName:g,attributes:y,children:l,parent:null},g=l.length,y=0;y<g;y++)v=l[y],typeof v!="string"?t&&(v.parent=f):y==g-1&&v=="\n"&&l.pop();l=f}if(u.push(l),typeof l=="string")break;l.tagName[0]==="?"&&l.children&&(u.push.apply(u,Y(l.children)),l.children=[])}else l=i,i=e.indexOf("<",i)-1,i===-2&&(i=e.length),l=(" "+e.slice(l,i+1)).slice(1),o?l.length>0&&u.push(l):(u.length&&l.length==1&&l[0]=="\n"||l.trim().length>0)&&u.push(l),i++;return u}function r(){for(var s=i;"\r\n	>/= ".indexOf(e[i])===-1&&e[i];)i++;return(" "+e.slice(s,i)).slice(1)}var i=0;return n("")}function zl(e){return typeof e=="string"}function Mv(e){var t=[];if(!e.children)return[];e=x(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,typeof n!="string"&&t.push(n);return t}function it(e,t){var n=[];if(!e.children)return[];e=x(e.children);for(var r=e.next();!r.done;r=e.next())r=r.value,r.tagName===t&&n.push(r);return n}function Dt(e){return typeof e=="string"?En(e):(e=e.children.reduce(function(t,n){return typeof n=="string"?t+n:t},""),e===""?null:En(e))}function In(e){return Array.from(e.children).every(function(t){return typeof t=="string"})?((e=Dt(e))&&(e=e.trim()),e):null}function Kr(e,t,n){if(n=n===void 0?[]:n,e.tagName===t&&n.push(e),e.children){e=x(e.children);for(var r=e.next();!r.done;r=e.next())Kr(r.value,t,n)}return n}function gt(e,t){return e=it(e,t),e.length!=1?null:e[0]}function Tr(e,t,n){return e=Rv(e,t,n),e.length!=1?null:e[0]}function De(e,t,n,r){r=r===void 0?null:r;var i=null;return e=e.attributes[t],e!=null&&(i=n(e)),i==null?r:i}function yi(e,t,n){return t=Ch(t),e.attributes[t+":"+n]||null}function Rv(e,t,n){var r=Ch(t);if(t=[],e.children)for(n=r?r+":"+n:n,e=x(e.children),r=e.next();!r.done;r=e.next())(r=r.value)&&r.tagName===n&&t.push(r);return t}function ti(e,t,n){t=x(t);for(var r=t.next();!r.done;r=t.next())if(r=yi(e,r.value,n))return r;return null}function vi(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function ni(e){return!e||(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e),!e)?null:(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null)}function Wl(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return!t||(e=Number(t[1]),!isFinite(e))?null:(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null)}function nn(e){return e=Number(e),e%1===0?e:null}function ri(e){return e=Number(e),e%1===0&&e>0?e:null}function rn(e){return e=Number(e),e%1===0&&e>=0?e:null}function Kl(e){return e=Number(e),isNaN(e)?null:e}function $l(e){return e?e.toLowerCase()==="true":!1}function U2(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function Yl(e){var t=[];e=En(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/),e=x(e);for(var n=e.next();!n.done;n=e.next()){n=n.value;var r=n.match(/^([\w]+)/);if(r){var i=n.match(/(@id='(.*?)')/),s=n.match(/(@t='(\d+)')/),o=n.match(/(@n='(\d+)')/),u=n.match(/\[(\d+)\]/);t.push({name:r[0],id:i?i[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:s?Number(s[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:o?Number(o[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:u?Number(u[1])-1:null,Dc:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Dc=n.slice(1))}return t}function kv(e,t){var n=Yl(t.attributes.sel||"");if(n.length){var r=n[n.length-1],i=t.attributes.pos||null;n=r.position,n==null&&(r.t!==null&&(n=_v(e,"t",r.t)),r.n!==null&&(n=_v(e,"n",r.n))),n===null?n=i==="prepend"?0:e.length:i==="prepend"?--n:i==="after"&&++n,i=t.tagName,(r=r.Dc)&&e[n]?Pv(e[n],i,r,In(t)||""):(i!=="remove"&&i!=="replace"||e.splice(n,1),i!=="add"&&i!=="replace"||e.splice.apply(e,[n,0].concat(Y(t.children))))}}function _v(e,t,n){var r=0;e=x(e);for(var i=e.next();!i.done;i=e.next()){if(Number(i.value.attributes[t])===n)return r;r++}return null}function Pv(e,t,n,r){t==="remove"?delete e.attributes[n]:(t==="add"||t==="replace")&&(e.attributes[n]=r)}function Dv(e){var t="",n=e.tagName.split(":");n.length>0&&(t=n[0],t=kh.has(t)?kh.get(t):""),t=document.createElementNS(t,e.tagName);for(var r in e.attributes)t.setAttribute(r,e.attributes[r]);for(e=x(e.children),r=e.next();!r.done;r=e.next())r=r.value,n=void 0,typeof r=="string"?n=new Text(r):n=Dv(r),t.appendChild(n);return t}function Mh(e){if(!e)return null;var t={tagName:e.tagName,attributes:Yi(e.attributes),children:[],parent:null};e=x(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,typeof n=="string"||(n=Mh(n),n.parent=t),t.children.push(n);return t}var Rh=new Map,kh=new Map;function ht(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Ms,this.position=null,this.positionAlign=Jl,this.size=0,this.textAlign=ii,this.direction=Ha,this.writingMode=_s,this.lineInterpretation=Ga,this.line=null,this.lineHeight="",this.lineAlign=Ps,this.displayAlign=Va,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Bv,this.fontStyle=Dh,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={columns:32,rows:15}}function Lv(e,t){return e=new ht(e,t,""),e.lineBreak=!0,e}ht.prototype.clone=function(){var e=new ht(0,0,""),t;for(t in this)e[t]=this[t],Array.isArray(e[t])&&(e[t]=e[t].slice());return e};function ql(e,t){if(e.payload!=t.payload||!(Math.abs(e.startTime-t.startTime)<.001&&Math.abs(e.endTime-t.endTime)<.001))return!1;for(var n in e)if(n!="startTime"&&n!="endTime"&&n!="payload"){if(n=="nestedCues"){if(!Wi(e.nestedCues,t.nestedCues,ql))return!1}else if(n=="region"||n=="cellResolution"){for(var r in e[n])if(e[n][r]!=t[n][r])return!1}else if(Array.isArray(e[n])){if(!Wi(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1}return!0}function Ql(e,t){t=t===void 0?new Map:t;var n=e.payload;if(n.includes("<")){t.size===0&&bv(t);var r=n;n=[];for(var i=-1,s=0;s<r.length;s++)r[s]==="<"?i=s+1:r[s]===">"&&i>0&&(i=r.substr(i,s-i),i.match(B2)&&n.push(i),i=-1);for(n=x(n),s=n.next();!s.done;s=n.next())s=s.value,r=r.replace("<"+s+">",'<div time="'+s+'">'),r+="</div>";e:{s=r,i=[];var o=-1;n="",r=!1;for(var u=0;u<s.length;u++)if(s[u]==="/"){var l=s.indexOf(">",u);if(l===-1){n=s;break e}if((l=s.substring(u+1,l))&&l=="v"){r=!0;var f=null;if(i.length&&(f=i[i.length-1]),f){if(f===l)n+="/"+l+">";else{if(!f.startsWith("v")){n+=s[u];continue}n+="/"+f+">"}u+=l.length+1}else n+=s[u]}else n+=s[u]}else s[u]==="<"?(o=u+1,s[o]!="v"&&(o=-1)):s[u]===">"&&o>0&&(i.push(s.substr(o,u-o)),o=-1),n+=s[u];for(s=x(i),i=s.next();!i.done;i=s.next())i=i.value,o=i.replace(" ",".voice-"),n=n.replace("<"+i+">","<"+o+">"),n=n.replace("</"+i+">","</"+o+">"),r||(n+="</"+o+">")}n=j2(n),e.payload="",r="<span>"+n.replace(/\n/g,"<br />")+"</span>";try{var g=ks(r,"span")}catch(y){}if(g)if(g=g.children,g.length!=1||g[0].tagName)for(g=x(g),n=g.next();!n.done;n=g.next())Nv(n.value,e,t);else e.payload=En(n);else e.payload=En(n)}else e.payload=En(n)}function bv(e){for(var t=x(Object.entries(Uv)),n=t.next();!n.done;n=t.next()){var r=x(n.value);n=r.next().value,r=r.next().value;var i=new ht(0,0,"");i.color=r,e.set("."+n,i)}for(t=x(Object.entries(jv)),n=t.next();!n.done;n=t.next())r=x(n.value),n=r.next().value,r=r.next().value,i=new ht(0,0,""),i.backgroundColor=r,e.set("."+n,i)}function j2(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,r=RegExp(n.source);return e&&r.test(e)?e.replace(n,function(i){return t[i]||""}):e||""}function Nv(e,t,n){var r=t.clone();if(r.nestedCues=[],r.payload="",r.rubyTag="",r.line=null,r.region=new Ms,r.position=null,r.size=0,r.textAlign=ii,e.tagName)for(var i=x(e.tagName.split(/(?=[ .])+/g)),s=i.next();!s.done;s=i.next()){var o=s=s.value;if(o.startsWith(".voice-")){var u=o.split("-").pop();o='v[voice="'+u+'"]',n.has(o)||(o="v[voice="+u+"]")}switch(n.has(o)&&(u=r,o=n.get(o))&&(u.backgroundColor=Fa(o.backgroundColor,u.backgroundColor),u.color=Fa(o.color,u.color),u.fontFamily=Fa(o.fontFamily,u.fontFamily),u.fontSize=Fa(o.fontSize,u.fontSize),u.textShadow=Fa(o.textShadow,u.textShadow),u.fontWeight=o.fontWeight,u.fontStyle=o.fontStyle,u.opacity=o.opacity,u.rubyTag=o.rubyTag,u.textCombineUpright=o.textCombineUpright,u.wrapLine=o.wrapLine),s){case"br":r=Lv(r.startTime,r.endTime),t.nestedCues.push(r);return;case"b":r.fontWeight=ho;break;case"i":r.fontStyle=po;break;case"u":r.textDecoration.push(xi);break;case"font":(s=e.attributes.color)&&(r.color=s);break;case"div":if(s=e.attributes.time,!s)break;(s=fo(s))&&(r.startTime=s);break;case"ruby":case"rp":case"rt":r.rubyTag=s}}if(i=e.children,zl(e)||i.length==1&&zl(i[0]))for(n=Dt(e).split("\n"),e=!0,n=x(n),i=n.next();!i.done;i=n.next())i=i.value,e||(e=Lv(r.startTime,r.endTime),t.nestedCues.push(e)),i.length>0&&(e=r.clone(),e.payload=En(i),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(r),t=x(i),e=t.next();!e.done;e=t.next())Nv(e.value,r,n)}function Fa(e,t){return e&&e.length>0?e:t}de("shaka.text.Cue",ht),ht.parseCuePayload=Ql,ht.equal=ql,ht.prototype.clone=ht.prototype.clone;var Jl="auto";ht.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Jl};var ii="center",_h={LEFT:"left",RIGHT:"right",CENTER:ii,START:"start",END:"end"};ht.textAlign=_h;var Va="after",Ov={BEFORE:"before",CENTER:"center",AFTER:Va};ht.displayAlign=Ov;var Ha="ltr";ht.direction={HORIZONTAL_LEFT_TO_RIGHT:Ha,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var _s="horizontal-tb";ht.writingMode={HORIZONTAL_TOP_TO_BOTTOM:_s,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Ga=0;ht.lineInterpretation={LINE_NUMBER:Ga,PERCENTAGE:1};var Ps="start",Ph={CENTER:"center",START:Ps,END:"end"};ht.lineAlign=Ph;var Uv={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};ht.defaultTextColor=Uv;var jv={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};ht.defaultTextBackgroundColor=jv;var Bv=400,ho=700;ht.fontWeight={NORMAL:Bv,BOLD:ho};var Dh="normal",po="italic",Fv={NORMAL:Dh,ITALIC:po,OBLIQUE:"oblique"};ht.fontStyle=Fv;var xi="underline";ht.textDecoration={UNDERLINE:xi,LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var B2=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function qi(){}qi.prototype.destroy=function(){};function Ti(e,t,n){Lh.set(e.toLowerCase().split(";")[0]+"-"+n,{priority:n,Af:t})}function go(e,t){for(var n=e.toLowerCase().split(";")[0],r=x([Vv,Nh,bh,Qi]),i=r.next();!i.done;i=r.next())if(i=Lh.get(n+"-"+i.value)){var s=i.Af(),o=s.isSupported(e,t);if(s.destroy(),o)return i.Af}return null}de("shaka.transmuxer.TransmuxerEngine",qi),qi.findTransmuxer=go,qi.unregisterTransmuxer=function(e,t){Lh.delete(e.toLowerCase().split(";")[0]+"-"+t)},qi.registerTransmuxer=Ti,qi.prototype.destroy=qi.prototype.destroy;var Lh=new Map,Qi=1,bh=2,Nh=3,Vv=4;qi.PluginPriority={FALLBACK:Qi,PREFERRED_SECONDARY:bh,PREFERRED:Nh,APPLICATION:Vv};function Oh(){}function Ct(e,t){var n=e;return t&&!wi.includes(e)&&(n+='; codecs="'+t+'"'),n}function Zl(e,t){return t&&(e+='; codecs="'+t+'"'),e}function Uh(e,t,n){var r=Ct(e,t);return t=Zl(e,t),go(t)?(e=go(t))?(e=e(),n=e.convertCodecs(n,t),e.destroy()):n=t:n=e!="video/mp2t"&&n=="audio"?r.replace("video","audio"):r,n}function Xa(e){return e.split(";")[0].split("/")[1]}function Vt(e){var t=Hv(e);switch(e=t[0].toLowerCase(),t=t[1].toLowerCase(),!0){case(e==="mp4a"&&t==="69"):case(e==="mp4a"&&t==="6b"):case(e==="mp4a"&&t==="40.34"):return"mp3";case(e==="mp4a"&&t==="66"):case(e==="mp4a"&&t==="67"):case(e==="mp4a"&&t==="68"):case(e==="mp4a"&&t==="40.2"):case(e==="mp4a"&&t==="40.02"):case(e==="mp4a"&&t==="40.5"):case(e==="mp4a"&&t==="40.05"):case(e==="mp4a"&&t==="40.29"):case(e==="mp4a"&&t==="40.42"):return"aac";case(e==="mp4a"&&t==="a5"):case e==="ac3":case e==="ac-3":return"ac-3";case(e==="mp4a"&&t==="a6"):case e==="eac3":case e==="ec-3":return"ec-3";case e==="ac-4":return"ac-4";case(e==="mp4a"&&t==="b2"):return"dtsx";case(e==="mp4a"&&t==="a9"):return"dtsc";case e==="vp09":case e==="vp9":return"vp9";case e==="avc1":case e==="avc3":return"avc";case e==="hvc1":case e==="hev1":return"hevc";case e==="vvc1":case e==="vvi1":return"vvc";case e==="dvh1":case e==="dvhe":return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case e==="dvav":case e==="dva1":return"dovi-avc";case e==="dav1":return"dovi-av1";case e==="dvc1":case e==="dvi1":return"dovi-vvc";case e==="lvc1":return"lcevc"}return e}function Ji(e){var t=[];e=x(e.split(","));for(var n=e.next();!n.done;n=e.next())n=Hv(n.value),t.push(n[0]);return t.sort().join(",")}function Kn(e){return e.split(";")[0]}function Nn(e){return e=e.split(/ *; */),e.shift(),(e=e.find(function(t){return t.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function ec(e){return e==="application/x-mpegurl"||e==="application/vnd.apple.mpegurl"}function Hv(e){e=e.split(".");var t=e[0];return e.shift(),[t,e.join(".")]}de("shaka.util.MimeUtils",Oh),Oh.getFullTypeWithAllCodecs=Zl,Oh.getFullType=Ct,new Map().set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var wi=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Si(e){this.i=null,this.l=e,this.C=!1,this.m=this.u=0,this.o=1/0,this.h=this.g=null,this.F="",this.B=function(){},this.j=new Map}function sn(e,t){Ka.set(e,t)}function za(e){return Ka.get(e)}function Wa(e){return Ka.has(e)?!0:e=="application/cea-608"||e=="application/cea-708"?!!Cs:!1}Si.prototype.destroy=function(){return this.l=this.i=null,this.j.clear(),Promise.resolve()};function F2(e,t,n,r,i){var s,o,u,l,f,g,y;return F(function(v){if(v.g==1)return C(v,Promise.resolve(),2);if(!e.i||!e.l)return v.return();if(n==null||r==null)return e.i.parseInit(Le(t)),v.return();for(s=e.C?n:e.u,o={periodStart:e.u,segmentStart:n,segmentEnd:r,vttOffset:s},u=e.i.parseMedia(Le(t),o,i,[]),l=x(u),f=l.next();!f.done;f=l.next())g=f.value,e.B(g,i||null,o);y=u.filter(function(w){return w.startTime>=e.m&&w.startTime<e.o}),e.l.append(y),e.g==null&&(e.g=Math.max(n,e.m)),e.h=Math.min(r,e.o),ie(v)})}Si.prototype.remove=function(e,t,n){n=n===void 0?!1:n;var r=this;return F(function(i){if(i.g==1)return C(i,Promise.resolve(),2);if(e>=t)return i.return();n&&G2(r,e,t),r.l&&r.l.remove(e,t)&&r.g!=null&&(t<=r.g||e>=r.h||(e<=r.g&&t>=r.h?r.g=r.h=null:e<=r.g&&t<r.h?r.g=t:e>r.g&&t>=r.h&&(r.h=e)),zv(r)),ie(i)})};function V2(e,t,n){e.m=t,e.o=n}function Gv(e,t,n){e.F=t,(t=e.j.get(t))&&(t=t.filter(function(r){return r.endTime<=n}),t.length&&e.l.append(t))}function Xv(e,t,n){t.startTime+=n,t.endTime+=n,t=x(t.nestedCues);for(var r=t.next();!r.done;r=t.next())Xv(e,r.value,n)}function H2(e,t,n){var r=new Map;t=x(t);for(var i=t.next();!i.done;i=t.next()){var s=i.value;i=s.stream,s=s.cue,r.has(i)||r.set(i,[]),Xv(e,s,n),s.startTime>=e.m&&s.startTime<e.o&&(r.get(i).push(s),i==e.F&&e.l.append([s]))}for(n=x(r.keys()),t=n.next();!t.done;t=n.next())for(t=t.value,e.j.has(t)||e.j.set(t,[]),i=x(r.get(t)),s=i.next();!s.done;s=i.next())s=s.value,e.j.get(t).push(s);zv(e)}function G2(e,t,n){for(var r=x(e.j.keys()),i=r.next();!i.done;i=r.next()){i=i.value;var s=e.j.get(i);s=s.filter(function(o){return o.startTime<t||o.endTime>=n}),e.j.set(i,s)}}function zv(e){for(var t=1/0,n=-1/0,r=x(e.j.values()),i=r.next();!i.done;i=r.next()){i=x(i.value);for(var s=i.next();!s.done;s=i.next())s=s.value,t=Math.min(t,s.startTime),n=Math.max(n,s.endTime)}t!==1/0&&n!==-1/0&&(e.g=e.g==null?Math.max(t,e.m):Math.min(e.g,Math.max(t,e.m)),e.h=Math.max(e.h,Math.min(n,e.o)))}de("shaka.text.TextEngine",Si),Si.prototype.destroy=Si.prototype.destroy,Si.findParser=za,Si.unregisterParser=function(e){Ka.delete(e)},Si.registerParser=sn;var Ka=new Map;function $a(e){this.h=e,this.g=null}$a.prototype.ka=function(e){var t=this;this.stop();var n=!0,r=null;return this.g=function(){m.clearTimeout(r),n=!1},r=m.setTimeout(function(){n&&t.h()},e*1e3),this},$a.prototype.stop=function(){this.g&&(this.g(),this.g=null)};function Ve(e){this.h=e,this.g=null}Ve.prototype.Kb=function(){return this.stop(),this.h(),this},Ve.prototype.ka=function(e){var t=this;return this.stop(),this.g=new $a(function(){t.h()}).ka(e),this},Ve.prototype.Ea=function(e){var t=this;return this.stop(),this.g=new $a(function(){t.g.ka(e),t.h()}).ka(e),this},Ve.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},de("shaka.util.Timer",Ve),Ve.prototype.stop=Ve.prototype.stop,Ve.prototype.tickEvery=Ve.prototype.Ea,Ve.prototype.tickAfter=Ve.prototype.ka,Ve.prototype.tickNow=Ve.prototype.Kb;function X2(e,t){return e.concat(t)}function z2(){}function Zi(e){return e!=null}function tc(e,t){return Promise.race([t,new Promise(function(n,r){new Ve(r).ka(e)})])}function Nr(){}function mo(e,t){return e=tt(e),t=tt(t),e.split("-")[0]==t.split("-")[0]}function Ya(e,t){return e=tt(e),t=tt(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&e.length==1&&t.length==2}function jh(e,t){return e=tt(e),t=tt(t),e=e.split("-"),t=t.split("-"),e.length==2&&t.length==2&&e[0]==t[0]}function tt(e){e=x(e.split("-x-"));var t=e.next().value;t=t===void 0?"":t,e=e.next().value,e=e===void 0?"":e;var n=x(t.split("-"));return t=n.next().value,t=t===void 0?"":t,n=n.next().value,n=n===void 0?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Wv.get(t)||t,n=n.toUpperCase(),(n?t+"-"+n:t)+(e?"-"+e:"")}function Ds(e,t){return e=tt(e),t=tt(t),t==e?4:Ya(t,e)?3:jh(t,e)?2:Ya(e,t)?1:0}function nc(e){var t=e.indexOf("-");return e=t>=0?e.substring(0,t):e,e=e.toLowerCase(),e=Wv.get(e)||e}function Bh(e){return e.language?tt(e.language):e.audio&&e.audio.language?tt(e.audio.language):e.video&&e.video.language?tt(e.video.language):"und"}function rc(e,t){e=tt(e);var n=new Set;t=x(t);for(var r=t.next();!r.done;r=t.next())n.add(tt(r.value));for(t=x(n),r=t.next();!r.done;r=t.next())if(r=r.value,r==e)return r;for(t=x(n),r=t.next();!r.done;r=t.next())if(r=r.value,Ya(r,e))return r;for(t=x(n),r=t.next();!r.done;r=t.next())if(r=r.value,jh(r,e))return r;for(n=x(n),t=n.next();!t.done;t=n.next())if(t=t.value,Ya(e,t))return t;return null}de("shaka.util.LanguageUtils",Nr),Nr.findClosestLocale=rc,Nr.getLocaleForVariant=Bh,Nr.getLocaleForText=function(e){return tt(e.language||"und")},Nr.getBase=nc,Nr.relatedness=Ds,Nr.areSiblings=function(e,t){var n=nc(e),r=nc(t);return e!=n&&t!=r&&n==r},Nr.normalize=tt,Nr.isSiblingOf=jh,Nr.isParentOf=Ya,Nr.areLanguageCompatible=mo,Nr.areLocaleCompatible=function(e,t){return e=tt(e),t=tt(t),e==t};var Wv=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Kv(){}function $v(e,t,n,r,i){function s(R){var M=String(R.width||"")+String(R.height||"")+String(Math.round(R.frameRate||0))+(R.hdr||"")+R.fastSwitching;return R.dependencyStream&&(M+=R.dependencyStream.baseOriginalId||""),R.roles&&(M+=R.roles.sort().join("_")),M}function o(R){var M=R.language+(R.channelsCount||0)+(R.audioSamplingRate||0)+R.roles.join(",")+R.label+R.groupId+R.fastSwitching;return R.dependencyStream&&(M+=R.dependencyStream.baseOriginalId||""),M}if(i.length){var u=e.textStreams;i=x(i);for(var l=i.next(),f={};!l.done;f={Eh:void 0},l=i.next())if(f.Eh=l.value,l=u.filter((function(R){return function(M){return!!(M.codecs.startsWith(R.Eh)||M.mimeType.startsWith(R.Eh))}})(f)),l.length){u=l;break}e.textStreams=u}if(u=e.variants,(t.length||n.length)&&(u=W2(u,t,n)),r.length){for(t=new Nl,n=x(u),u=n.next();!u.done;u=n.next())u=u.value,t.push(String(u.video.width||0),u);var g=[];t.forEach(function(R,M){R=0;var D=[];M=x(M);for(var O=M.next(),X={};!O.done;X={Wf:void 0},O=M.next())X.Wf=O.value,O=r.filter((function(b){return function(U){return b.Wf.decodingInfos[0][U]}})(X)).length,O>R?(R=O,D=[X.Wf]):O==R&&D.push(X.Wf);g.push.apply(g,Y(D))}),u=g}for(n=new Set,t=new Set,u=x(u),i=u.next();!i.done;i=u.next())i=i.value,i.audio&&n.add(i.audio),i.video&&t.add(i.video);u=Array.from(n).sort(function(R,M){return R.bandwidth-M.bandwidth});var y=[];for(n=new Map,u=x(u),i=u.next();!i.done;i=u.next()){if(i=i.value,l=o(i),f=n.get(l)||[],f.length){var v=f[f.length-1],w=Vt(v.codecs),A=Vt(i.codecs);w!=A||i.bandwidth&&v.bandwidth&&!(i.bandwidth>v.bandwidth)||(f.push(i),y.push(i.id))}else f.push(i),y.push(i.id);n.set(l,f)}var I={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};u=Array.from(t).sort(function(R,M){if(!R.bandwidth||!M.bandwidth||R.bandwidth==M.bandwidth){if(R.codecs&&M.codecs&&R.codecs!=M.codecs&&R.width==M.width){var D=Vt(R.codecs),O=Vt(M.codecs);if(D!=O)return(I[D]||1)-(I[O]||1)}return R.width-M.width}return R.bandwidth-M.bandwidth}),t=je().Bb();var E=[];for(n=new Map,u=x(u),i=u.next();!i.done;i=u.next()){if(i=i.value,l=s(i),f=n.get(l)||[],f.length){if(v=f[f.length-1],!t&&(w=Vt(v.codecs),A=Vt(i.codecs),w!==A))continue;w=Vt(v.codecs),A=Vt(i.codecs),w!=A||i.bandwidth&&v.bandwidth&&!(i.bandwidth>v.bandwidth)||(f.push(i),E.push(i.id))}else f.push(i),E.push(i.id);n.set(l,f)}e.variants=e.variants.filter(function(R){var M=R.audio;return R=R.video,!(M&&!y.includes(M.id)||R&&!E.includes(R.id))})}function W2(e,t,n){t=x(t);for(var r=t.next(),i={};!r.done;i={jj:void 0},r=t.next())if(i.jj=r.value,r=e.filter((function(s){return function(o){return o.video&&o.video.codecs.startsWith(s.jj)}})(i)),r.length){e=r;break}for(n=x(n),t=n.next(),r={};!t.done;r={Ph:void 0},t=n.next())if(r.Ph=t.value,t=e.filter((function(s){return function(o){return o.audio&&o.audio.codecs.startsWith(s.Ph)}})(r)),t.length){e=t;break}return e}function K2(e,t,n){e.variants=e.variants.filter(function(r){return ic(r,t,n)})}function ic(e,t,n){function r(u,l,f){return u>=l&&u<=f}var i=e.video;if(i&&i.width&&i.height){var s=i.width,o=i.height;if(o>s&&(o=x([o,s]),s=o.next().value,o=o.next().value),!r(s,t.minWidth,Math.min(t.maxWidth,n.width))||!r(o,t.minHeight,Math.min(t.maxHeight,n.height))||!r(i.width*i.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!r(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!r(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!r(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function $2(e,t,n,r){return n=n===void 0?[]:n,r=r===void 0?{}:r,F(function(i){return i.g==1?C(i,Yv(e,t,t.offlineSessionIds.length>0,n,r),2):(J2(t),C(i,Z2(t),0))})}function Yv(e,t,n,r,i){var s,o;return F(function(u){if(u.g==1)return je().Yi()&&Y2(t.variants),C(u,Fh(t.variants,n,!1,r),2);s=null,e&&(o=e.g)&&(s=o.keySystem),t.variants=t.variants.filter(function(l){var f=q2(l,s,i);if(!f){var g=[];l.audio&&g.push(n0(l.audio)),l.video&&g.push(n0(l.video))}return f}),ie(u)})}function Y2(e){var t=new Map().set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),n=new Set;e=x(e);for(var r=e.next();!r.done;r=e.next())r=r.value,r.video&&n.add(r.video);for(n=x(n),e=n.next();!e.done;e=n.next()){e=e.value,r=x(t);for(var i=r.next();!i.done;i=r.next()){var s=x(i.value);if(i=s.next().value,s=s.next().value,e.codecs.includes(i)){e.codecs=e.codecs.replace(i,s);break}}}}function q2(e,t,n){if(!e.decodingInfos.some(function(l){return!(!l.supported||t&&(l=l.keySystemAccess)&&(n[l.keySystem]||l.keySystem)!=t)}))return!1;var r=je(),i=r.Ob()==="Xbox";r=r.Oa()==="MOBILE"&&r.Ha()==="GECKO";var s=e.video,o=s&&s.width||0,u=s&&s.height||0;return i&&s&&(o>1920||u>1080)&&(s.codecs.includes("avc1.")||s.codecs.includes("avc3."))||(i=s&&s.dependencyStream)&&!Sv(i)?!1:(e=e.audio,!(r&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")||e&&e.dependencyStream))}function qv(e,t){var n,r,i,s,o,u,l;return F(function(f){if(f.g==1){for(n=function(g,y){if(g){var v=Yi(g);return v.supported=g.supported&&y.supported,v.powerEfficient=g.powerEfficient&&y.powerEfficient,v.smooth=g.smooth&&y.smooth,y.keySystemAccess&&!v.keySystemAccess&&(v.keySystemAccess=y.keySystemAccess),v}return y},r=null,i=[],s=x(t),o=s.next(),u={};!o.done;u={cache:void 0,Re:void 0},o=s.next())l=o.value,u.Re=Xl(l),u.cache=uc,u.cache.has(u.Re)?r=n(r,u.cache.get(u.Re)):i.push(Q2(l).then((function(g){return function(y){var v=null;y=x(y||[]);for(var w=y.next();!w.done;w=y.next())v=n(v,w.value);v&&(g.cache.set(g.Re,v),r=n(r,v))}})(u)));return C(f,Promise.all(i),2)}r&&e.decodingInfos.push(r),ie(f)})}function Q2(e){var t=[""];e.video&&(t=Nn(e.video.contentType).split(","));var n=[""];e.audio&&(n=Nn(e.audio.contentType).split(","));var r=[];t=x(t);for(var i=t.next();!i.done;i=t.next()){i=i.value;for(var s=x(n),o=s.next(),u={};!o.done;u={Qc:void 0},o=s.next())o=o.value,u.Qc=br(e),e.video&&(u.Qc.video.contentType=Ct(Kn(u.Qc.video.contentType),i)),e.audio&&(u.Qc.audio.contentType=Ct(Kn(u.Qc.audio.contentType),o)),r.push(new Promise((function(l){return function(f,g){(je().Oa()=="MOBILE"?tc(5,navigator.mediaCapabilities.decodingInfo(l.Qc)):navigator.mediaCapabilities.decodingInfo(l.Qc)).then(function(y){f(y)}).catch(g)}})(u)))}return Promise.all(r).catch(function(){return JSON.stringify(e),null})}function Fh(e,t,n,r){var i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X;return F(function(b){switch(b.g){case 1:if(e.some(function(U){return U.decodingInfos.length}))return b.return();i=x(r),s=i.next(),o={};case 2:if(s.done){b.A(4);break}o.Hi=s.value,u=!1,l=x(e),f=l.next();case 5:if(f.done){b.A(7);break}g=f.value,y=Qv(g,t,n).filter((function(U){return function(N){return N=N[0],(N.keySystemConfiguration&&N.keySystemConfiguration.keySystem)===U.Hi}})(o)),v=x(y),w=v.next();case 8:if(w.done){b.A(10);break}return A=w.value,C(b,qv(g,A),9);case 9:w=v.next(),b.A(8);break;case 10:g.decodingInfos.some(function(U){return U.supported})&&(u=!0),f=l.next(),b.A(5);break;case 7:if(u)return b.return();o={Hi:void 0},s=i.next(),b.A(2);break;case 4:I=x(e),E=I.next();case 12:if(E.done){b.A(0);break}R=E.value,M=Qv(R,t,n).filter(function(U){return U=U[0],U=U.keySystemConfiguration&&U.keySystemConfiguration.keySystem,!U||!r.includes(U)}),D=x(M),O=D.next();case 15:if(O.done){E=I.next(),b.A(12);break}return X=O.value,C(b,qv(R,X),16);case 16:O=D.next(),b.A(15)}})}function Qv(e,t,n){var r=e.audio,i=e.video,s=[],o=[];if(i)for(var u=x(i.fullMimeTypes),l=u.next();!l.done;l=u.next()){l=l.value;var f=Nn(l);if(f.includes(",")&&!r){var g=f.split(","),y=Kn(l);f=ao("video",g),g=ao("audio",g),g=qa(g,y),y=Uh(y,g,"audio"),o.push({contentType:y,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(f=Jv(f),l={contentType:Uh(Kn(l),f,"video"),width:i.width||64,height:i.height||64,bitrate:i.bandwidth||e.bandwidth||1,framerate:i.frameRate||30},i.hdr)switch(i.hdr){case"PQ":l.transferFunction="pq";break;case"HLG":l.transferFunction="hlg"}i.colorGamut&&(l.colorGamut=i.colorGamut),s.push(l)}if(r)for(u=x(r.fullMimeTypes),l=u.next();!l.done;l=u.next())f=l.value,l=Kn(f),f=qa(Nn(f),l),l=Uh(l,f,"audio"),o.push({contentType:l,channels:r.channelsCount||2,bitrate:r.bandwidth||e.bandwidth||1,samplerate:r.audioSamplingRate||1,spatialRendering:r.spatialAudio});for(u=[],s.length==0&&s.push(null),o.length==0&&o.push(null),s=x(s),l=s.next();!l.done;l=s.next())for(l=l.value,f=x(o),y=f.next();!y.done;y=f.next())y=y.value,g={type:n?"file":"media-source"},l&&(g.video=l),y&&(g.audio=y),u.push(g);if(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!o.length)return[u];for(e=[],n=new Map,o=x(o),s=o.next();!s.done;s=o.next())s=s.value,n.get(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s);for(o=t?"required":"optional",t=t?["persistent-license"]:["temporary"],s=x(n.keys()),l=s.next();!l.done;l=s.next()){for(l=l.value,y=n.get(l),f=new Map,y=x(y),g=y.next();!g.done;g=y.next()){g=g.value;var v=g.videoRobustness+","+g.audioRobustness;f.get(v)||f.set(v,[]),f.get(v).push(g)}for(f=x(f.values()),y=f.next();!y.done;y=f.next()){y=y.value,g=[],v=x(u);for(var w=v.next();!w.done;w=v.next()){w=Object.assign({},w.value);for(var A={keySystem:l,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t},I=x(y),E=I.next();!E.done;E=I.next()){if(E=E.value,E.initData&&E.initData.length){for(var R=new Set,M=x(E.initData),D=M.next();!D.done;D=M.next())R.add(D.value.initDataType);A.initDataType=E.initData[0].initDataType}E.distinctiveIdentifierRequired&&(A.distinctiveIdentifier="required"),E.persistentStateRequired&&(A.persistentState="required"),E.sessionType&&(A.sessionTypes=[E.sessionType]),r&&(A.audio?(E.encryptionScheme&&(A.audio.encryptionScheme=A.audio.encryptionScheme||E.encryptionScheme),A.audio.robustness=A.audio.robustness||E.audioRobustness):(A.audio={robustness:E.audioRobustness},E.encryptionScheme&&(A.audio.encryptionScheme=E.encryptionScheme)),A.audio.robustness==""&&delete A.audio.robustness),i&&(A.video?(E.encryptionScheme&&(A.video.encryptionScheme=A.video.encryptionScheme||E.encryptionScheme),A.video.robustness=A.video.robustness||E.videoRobustness):(A.video={robustness:E.videoRobustness},E.encryptionScheme&&(A.video.encryptionScheme=E.encryptionScheme)),A.video.robustness==""&&delete A.video.robustness)}w.keySystemConfiguration=A,g.push(w)}e.push(g)}}return e}function qa(e,t){var n=je();return e.toLowerCase()=="flac"?n.Ha()!="WEBKIT"?"flac":"fLaC":e.toLowerCase()==="opus"?n.Ha()!="WEBKIT"?"opus":Xa(t)=="mp4"?"Opus":"opus":e.toLowerCase()=="ac-3"&&n.re()?"ec-3":e}function Jv(e){if(e.includes("avc1")){var t=e.split(".");if(t.length==3)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+=("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if(e=="vp9")return"vp09.00.41.08";return e}function J2(e){e.textStreams=e.textStreams.filter(function(t){return t=Ct(t.mimeType,t.codecs),Wa(t)})}function Z2(e){var t,n,r,i,s,o,u;return F(function(l){switch(l.g){case 1:t=[],n=x(e.imageStreams),r=n.next();case 2:if(r.done){l.A(4);break}if(i=r.value,s=i.mimeType,s=="application/mp4"&&i.codecs=="mjpg"&&(s="image/jpg"),lc.has(s)){l.A(5);break}if(o=rC.get(s),!o){lc.set(s,!1),l.A(5);break}return C(l,eC(o),7);case 7:u=l.h,lc.set(s,u);case 5:lc.get(s)&&t.push(i),r=n.next(),l.A(2);break;case 4:e.imageStreams=t,ie(l)}})}function eC(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(n.height===2)}})}function Ls(e){var t=e.audio,n=e.video,r=t?t.mimeType:null,i=n?n.mimeType:null,s=t?t.codecs:null,o=n?n.codecs:null,u=t?t.groupId:null,l=[];n&&l.push(n.mimeType),t&&l.push(t.mimeType),l=l[0]||null;var f=[];t&&f.push(t.kind),n&&f.push(n.kind),f=f[0]||null;var g=new Set;if(t)for(var y=x(t.roles),v=y.next();!v.done;v=y.next())g.add(v.value);if(n)for(y=x(n.roles),v=y.next();!v.done;v=y.next())g.add(v.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,videoLabel:null,kind:f,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:l,audioMimeType:r,videoMimeType:i,codecs:"",audioCodec:s,videoCodec:o,primary:e.primary,roles:Array.from(g),audioRoles:null,videoRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:u,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,e.videoRoles=n.roles,e.videoLabel=n.label,(r=n.dependencyStream)&&(e.width=r.width||e.width,e.height=r.height||e.height,e.videoCodec=r.codecs||e.videoCodec,e.pixelAspectRatio=r.pixelAspectRatio||e.pixelAspectRatio,e.videoBandwidth&&r.bandwidth&&(e.videoBandwidth+=r.bandwidth)),o.includes(","))){e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage,e.audioMimeType=i,i=o.split(",");try{e.videoCodec=ao("video",i),e.audioCodec=ao("audio",i)}catch(w){}}return t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage,i=t.dependencyStream)&&(e.audioCodec=i.codecs||e.audioCodec,e.audioBandwidth&&i.bandwidth&&(e.audioBandwidth+=i.bandwidth)),n&&!e.videoBandwidth&&(t?e.audioBandwidth&&(e.videoBandwidth=e.bandwidth-e.audioBandwidth):e.videoBandwidth=e.bandwidth),t&&!e.audioBandwidth&&(n?e.videoBandwidth&&(e.audioBandwidth=e.bandwidth-e.videoBandwidth):e.audioBandwidth=e.bandwidth),t=[],e.videoCodec&&t.push(e.videoCodec),e.audioCodec&&t.push(e.audioCodec),e.codecs=t.join(", "),e}function bs(e){return{id:e.id,active:!1,type:Fe,bandwidth:e.bandwidth||0,language:e.language,label:e.label,kind:e.kind||null,mimeType:e.mimeType,codecs:e.codecs||null,primary:e.primary,roles:e.roles,accessibilityPurpose:e.accessibilityPurpose,forced:e.forced,originalTextId:e.originalId,originalLanguage:e.originalLanguage}}function Vh(e){var t=e.width||null,n=e.height||null,r=null;e.segmentIndex&&(r=$r(e.segmentIndex));var i=e.tilesLayout;return r&&(i=r.tilesLayout||i),i&&t!=null&&(t/=Number(i.split("x")[0])),i&&n!=null&&(n/=Number(i.split("x")[1])),{id:e.id,type:"image",bandwidth:e.bandwidth||0,width:t,height:n,mimeType:e.mimeType,codecs:e.codecs||null,tilesLayout:i||null,originalImageId:e.originalId}}function sc(e){return e.__shaka_id||(e.__shaka_id=nC++),e.__shaka_id}function Zv(e){var t={id:sc(e),active:e.mode!="disabled",type:Fe,bandwidth:0,language:tt(e.language||"und"),label:e.label,kind:e.kind,mimeType:null,codecs:null,primary:!1,roles:[],accessibilityPurpose:null,forced:e.kind=="forced",originalTextId:e.id,originalLanguage:e.language};return e.kind=="captions"&&(t.mimeType="unknown"),e.kind=="subtitles"&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),t}function oc(e,t){var n=e?e.language:null;if(n={id:sc(e||t),active:e?e.enabled:t.selected,type:"variant",bandwidth:0,language:tt(n||"und"),label:e?e.label:null,videoLabel:null,kind:e?e.kind:null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:e?e.kind=="main":!1,roles:[],forced:!1,audioRoles:null,videoRoles:null,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:t?t.id:null,originalAudioId:e?e.id:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:n},e&&e.kind&&(n.roles=[e.kind],n.audioRoles=[e.kind]),e&&e.configuration&&(e.configuration.codec&&(n.audioCodec=e.configuration.codec,n.codecs=n.audioCodec),e.configuration.bitrate&&(n.audioBandwidth=e.configuration.bitrate,n.bandwidth+=n.audioBandwidth),e.configuration.sampleRate&&(n.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(n.channelsCount=e.configuration.numberOfChannels)),t&&t.configuration&&(t.configuration.codec&&(n.videoCodec=t.configuration.codec,n.codecs=n.codecs?n.codecs+(","+n.videoCodec):n.videoCodec),t.configuration.bitrate&&(n.videoBandwidth=t.configuration.bitrate,n.bandwidth+=n.videoBandwidth),t.configuration.framerate&&(n.frameRate=t.configuration.framerate),t.configuration.width&&(n.width=t.configuration.width),t.configuration.height&&(n.height=t.configuration.height),t.configuration.colorSpace&&t.configuration.colorSpace.transfer))switch(t.configuration.colorSpace.transfer){case"pq":n.hdr="PQ";break;case"hlg":n.hdr="HLG";break;case"bt709":n.hdr="SDR"}return n}function Qa(e){return e.allowedByApplication&&e.allowedByKeySystem&&e.disabledUntilTime==0}function ac(e){return e.filter(function(t){return Qa(t)})}function yo(e,t,n,r){var i=e,s=e.filter(function(l){return l.primary});s.length&&(i=s);var o=i.length?i[0].language:"";if(i=i.filter(function(l){return l.language==o}),t){var u=rc(tt(t),e.map(function(l){return l.language}));u&&(i=e.filter(function(l){return tt(l.language)==u}))}if(i=i.filter(function(l){return l.forced==r}),n){if(e=e0(i,n),e.length)return e}else if(e=i.filter(function(l){return l.roles.length==0}),e.length)return e;return e=i.map(function(l){return l.roles}).reduce(X2,[]),e.length?e0(i,e[0]):i}function e0(e,t){return e.filter(function(n){return n.roles.includes(t)})}function tC(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t}function t0(e,t){t.length&&(t=t.filter(function(n){return Vt(e.codecs)==Vt(n.codecs)}).sort(function(n,r){return n.bandwidth&&r.bandwidth&&n.bandwidth!=r.bandwidth?n.bandwidth-r.bandwidth:(n.width||0)-(r.width||0)}),e.trickModeVideo=t[0],t.length>1&&(t=t.find(function(n){return e.width==n.width&&e.height==n.height})))&&(e.trickModeVideo=t)}function n0(e){return e.type=="audio"?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:e.type=="video"?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}function r0(e,t,n){if(n.autoShowText==0)return!1;if(n.autoShowText==1)return!0;var r=tt(n.preferredTextLanguage);return t=tt(t.language),n.autoShowText==2?mo(t,r):n.autoShowText==3?e?(e=tt(e.language),mo(t,r)&&!mo(e,t)):!1:(Be("Invalid autoShowText setting!"),!1)}function i0(e){var t={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]};e=x(e);for(var n=e.next();!n.done;n=e.next()){n=n.value;var r={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:n?Kn(n):"",codecs:n?Nn(n):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"video",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};r.fullMimeTypes.add(Ct(r.mimeType,r.codecs)),n.startsWith("audio/")?(r.type="audio",t.audio=r):t.video=r}return t}de("shaka.util.StreamUtils",Kv),Kv.meetsRestrictions=ic;var uc=new Map,nC=0,lc=new Map().set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),rC=new Map().set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function At(){var e=this;this.H=null,this.G=!1,this.u=new rr,this.j=new et,navigator.connection&&navigator.connection.addEventListener&&this.j.D(navigator.connection,"change",function(){e.g.useNetworkInformation&&navigator.onLine&&(e.u=new rr,e.g&&e.u.configure(e.g.advanced),e.trySuggestStreams())}),this.l=[],this.I=1,this.J=!1,this.h=this.o=this.g=this.B=null,this.m=new Ve(function(){if(e.G&&(e.g.restrictToElementSize||e.g.restrictToScreenSize)){var t=e.chooseVariant();t&&e.H(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}}),this.C=m,"documentPictureInPicture"in m&&this.j.D(m.documentPictureInPicture,"enter",function(){e.C=m.documentPictureInPicture.window,e.m&&e.m.Kb(),e.j.Aa(e.C,"pagehide",function(){e.C=m,e.m&&e.m.Kb()})}),this.F=this.i=null}p=At.prototype,p.stop=function(){this.H=null,this.G=!1,this.l=[],this.I=1,this.o=this.B=null,this.h&&(this.h.disconnect(),this.h=null),this.m&&this.m.stop(),this.F=this.i=null},p.release=function(){this.stop(),this.j.release(),this.m=null},p.init=function(e){this.H=e},p.chooseVariant=function(e){e=e===void 0?!1:e;var t=1/0,n=1/0;if(this.g.restrictToScreenSize&&(n=this.g.ignoreDevicePixelRatio?1:this.C.devicePixelRatio,t=this.C.screen.height*n,n*=this.C.screen.width),this.h&&this.g.restrictToElementSize){var r=this.g.ignoreDevicePixelRatio?1:this.C.devicePixelRatio,i=this.o.clientHeight,s=this.o.clientWidth;this.i&&document.pictureInPictureElement&&document.pictureInPictureElement==this.o&&(i=this.i.height,s=this.i.width),t=Math.min(t,i*r),n=Math.min(n,s*r)}if(i=this.l.filter(function(f){return f&&!(f.audio&&f.audio.fastSwitching||f.video&&f.video.fastSwitching)}),i.length||(i=this.l),r=i,e&&i.length!=this.l.length&&(r=this.l.filter(function(f){return f&&!!(f.audio&&f.audio.fastSwitching||f.video&&f.video.fastSwitching)})),e=Hh(this,this.g.restrictions,r,1/0,1/0),t!=1/0||n!=1/0){for(e=iC(e),e=x(e),i=e.next();!i.done;i=e.next())if(i=i.value,i.height>=t&&i.width>=n){t=i.height,n=i.width;break}e=Hh(this,this.g.restrictions,r,t,n)}for(t=this.getBandwidthEstimate(),r.length&&!e.length&&(e=Hh(this,null,r,1/0,1/0),e=[e[0]]),n=e[0]||null,r=0;r<e.length;r++){i=e[r];var o=isNaN(this.I)?1:Math.abs(this.I);s=o*i.bandwidth/this.g.bandwidthDowngradeTarget;for(var u={bandwidth:1/0},l=r+1;l<e.length;l++)if(i.bandwidth!=e[l].bandwidth){u=e[l];break}o=o*u.bandwidth/this.g.bandwidthUpgradeTarget,n&&i&&t>=s&&t<=o&&(n.bandwidth!=i.bandwidth||n.bandwidth==i.bandwidth&&n.video&&i.video&&(n.video.width<i.video.width||n.video.height<i.video.height))&&(n=i)}return this.B=Date.now(),n},p.enable=function(){this.G=!0,this.l.length&&this.trySuggestStreams()},p.disable=function(){this.G=!1},p.segmentDownloaded=function(e,t,n,r){var i=e;this.g.removeLatencyFromFirstPacketTime&&r&&r.packetNumber===1&&r.timeToFirstByte&&(i=e-r.timeToFirstByte),i>=this.g.cacheLoadThreshold&&this.u.sample(i,t),n&&this.B!=null&&this.G&&s0(this)},p.trySuggestStreams=function(){this.G&&(this.B=Date.now(),s0(this,!0))},p.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=navigator.connection.downlink*1e6),navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&this.g.preferNetworkInformationBandwidth?e:(e=this.u.getBandwidthEstimate(e),this.F?this.F.getBandwidthEstimate(e):e)},p.setVariants=function(e){return ws(e,this.l)?!1:(this.l=e,!0)},p.playbackRateChanged=function(e){this.I=e},p.setMediaElement=function(e){function t(){n.m.ka(sC)}var n=this;this.o=e,this.h&&(this.h.disconnect(),this.h=null),this.o&&"ResizeObserver"in m&&(this.h=new ResizeObserver(t),this.h.observe(this.o)),this.j.D(e,"enterpictureinpicture",function(r){r.pictureInPictureWindow&&(n.i=r.pictureInPictureWindow,n.j.D(n.i,"resize",t))}),this.j.D(e,"leavepictureinpicture",function(){n.i&&n.j.Ma(n.i,"resize",t),n.i=null})},p.setCmsdManager=function(e){this.F=e},p.configure=function(e){this.g=e,this.u&&this.g&&this.u.configure(this.g.advanced)};function s0(e,t){if(t===void 0||!t){if(!e.J){if(t=e.u,!(t.g>=t.i))return;e.J=!0,e.B-=(e.g.switchInterval-e.g.minTimeToSwitch)*1e3}if(Date.now()-e.B<e.g.switchInterval*1e3)return}t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.H(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}function Hh(e,t,n,r,i){if(e.F){var s=e.F.gi();s&&(n=n.filter(function(o){return o.bandwidth&&s?o.bandwidth<=s:!0}))}return t&&(n=n.filter(function(o){return ic(o,t,{width:i,height:r})})),n.sort(function(o,u){return o.bandwidth-u.bandwidth})}function iC(e){var t=[];e=x(e);for(var n=e.next();!n.done;n=e.next())(n=n.value)&&(n=n.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort(function(r,i){return r.width-i.width})}de("shaka.abr.SimpleAbrManager",At),At.prototype.configure=At.prototype.configure,At.prototype.setCmsdManager=At.prototype.setCmsdManager,At.prototype.setMediaElement=At.prototype.setMediaElement,At.prototype.playbackRateChanged=At.prototype.playbackRateChanged,At.prototype.setVariants=At.prototype.setVariants,At.prototype.getBandwidthEstimate=At.prototype.getBandwidthEstimate,At.prototype.trySuggestStreams=At.prototype.trySuggestStreams,At.prototype.segmentDownloaded=At.prototype.segmentDownloaded,At.prototype.disable=At.prototype.disable,At.prototype.enable=At.prototype.enable,At.prototype.chooseVariant=At.prototype.chooseVariant,At.prototype.init=At.prototype.init,At.prototype.release=At.prototype.release,At.prototype.stop=At.prototype.stop;var sC=1;function o0(e,t){var n=Or();this.l=e.maxAttempts==null?n.maxAttempts:e.maxAttempts,this.j=e.baseDelay==null?n.baseDelay:e.baseDelay,this.o=e.fuzzFactor==null?n.fuzzFactor:e.fuzzFactor,this.m=e.backoffFactor==null?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=t===void 0?!1:t)&&(this.g=1)}function a0(e){var t,n;return F(function(r){if(r.g==1){if(e.g>=e.l)if(e.i)e.g=1,e.h=e.j;else throw new H(2,7,1010);return t=e.g,e.g++,t==0?r.return():(n=e.h*(1+(Math.random()*2-1)*e.o),C(r,new Promise(function(i){new Ve(i).ka(n/1e3)}),2))}e.h*=e.m,ie(r)})}function Or(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function at(){var e,t,n=new Promise(function(r,i){e=r,t=i});return n.resolve=e,n.reject=t,n}at.prototype.resolve=function(){},at.prototype.reject=function(){};function kt(e,t){this.promise=e,this.i=t,this.g=null}function es(e){return new kt(Promise.reject(e),function(){return Promise.resolve()})}function Gh(){var e=Promise.reject(new H(2,7,7001));return e.catch(function(){}),new kt(e,function(){return Promise.resolve()})}function vo(e){return new kt(Promise.resolve(e),function(){return Promise.resolve()})}function u0(e){return new kt(e,function(){return e.catch(function(){})})}kt.prototype.abort=function(){return this.g||(this.g=this.i()),this.g};function l0(e){return new kt(Promise.all(e.map(function(t){return t.promise})),function(){return Promise.all(e.map(function(t){return t.abort()}))})}kt.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},kt.prototype.Xa=function(e,t){function n(u){return function(l){if(i.g&&u)s.reject(o);else{var f=u?e:t;f?r=oC(f,l,s):(u?s.resolve:s.reject)(l)}}}function r(){return s.reject(o),i.abort()}var i=this,s=new at;s.catch(function(){});var o=new H(2,7,7001);return this.promise.then(n(!0),n(!1)),new kt(s,function(){return r()})};function oC(e,t,n){try{var r=e(t);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then(function(){},function(){})})}catch(i){return n.reject(i),function(){return Promise.resolve()}}}P.Object.defineProperties(kt.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.g!==null}}}),de("shaka.util.AbortableOperation",kt),kt.prototype.chain=kt.prototype.Xa,kt.prototype.finally=kt.prototype.finally,kt.all=l0,kt.prototype.abort=kt.prototype.abort,kt.notAbortable=u0,kt.completed=vo,kt.aborted=Gh,kt.failed=es;function Se(e,t){if(t)if(t instanceof Map)for(var n=x(t.keys()),r=n.next();!r.done;r=n.next())r=r.value,Object.defineProperty(this,r,{value:t.get(r),writable:!0,enumerable:!0});else for(n in t)Object.defineProperty(this,n,{value:t[n],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=m.performance&&m.performance.now?m.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function c0(e){var t=new Se(e.type),n;for(n in e)Object.defineProperty(t,n,{value:e[n],writable:!0,enumerable:!0});return t}Se.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Se.prototype.stopImmediatePropagation=function(){this.g=!0},Se.prototype.stopPropagation=function(){},de("shaka.util.FakeEvent",Se);var cc={ul:"abrstatuschanged",vl:"adaptation",wl:"audiotrackchanged",xl:"audiotrackschanged",yl:"boundarycrossed",zl:"buffering",Al:"canupdatestarttime",Bl:"complete",Cl:"currentitemchanged",Dl:"downloadcompleted",El:"downloadfailed",Fl:"downloadheadersreceived",Gl:"drmsessionupdate",Hl:"emsg",Nl:"itemsinserted",Ol:"itemsremoved",dm:"prft",Error:"error",Il:"expirationupdated",Jl:"firstquartile",Kl:"gapjumped",Pl:"keystatuschanged",Sl:"loaded",Tl:"loading",Vl:"manifestparsed",Wl:"manifestupdated",Xl:"mediaqualitychanged",Yl:"mediasourcerecovered",Zl:"metadataadded",Metadata:"metadata",$l:"midpoint",am:"nospatialvideoinfo",bm:"onstatechange",fm:"ratechange",im:"segmentappended",jm:"sessiondata",lm:"spatialvideoinfo",nm:"stalldetected",om:"started",pm:"statechanged",qm:"streaming",rm:"textchanged",sm:"texttrackvisibility",tm:"thirdquartile",um:"timelineregionadded",vm:"timelineregionenter",wm:"timelineregionexit",xm:"trackschanged",zm:"unloading",Bm:"variantchanged"};function ot(){this.ab=new Nl,this.Ie=this}ot.prototype.addEventListener=function(e,t){this.ab&&this.ab.push(e,t)},ot.prototype.removeEventListener=function(e,t){this.ab&&this.ab.remove(e,t)},ot.prototype.dispatchEvent=function(e){if(!this.ab)return!0;var t=this.ab.get(e.type)||[],n=this.ab.get("All");for(n&&(t=t.concat(n)),t=x(t),n=t.next();!n.done;n=t.next()){n=n.value,e.target=this.Ie,e.currentTarget=this.Ie;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(r){}if(e.g)break}return e.defaultPrevented},ot.prototype.release=function(){this.ab=null};function xo(){this.g=[]}function Ns(e,t){e.g.push(t.finally(function(){Dr(e.g,t)}))}xo.prototype.destroy=function(){for(var e=[],t=x(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)};function mt(e,t,n,r,i,s,o){ot.call(this),this.i=null,this.j=!1,this.u=new xo,this.g=new Set,this.h=new Set,this.o=e||null,this.m=t||null,this.B=n||null,this.C=r||null,this.F=i||null,this.H=s||null,this.G=o||null,this.l=new Map}J(mt,ot),p=mt.prototype,p.configure=function(e){this.i=e};function Ai(e,t,n,r){r=r===void 0?!1:r,n=n||g0;var i=fc.get(e);(!i||n>=i.priority)&&fc.set(e,{priority:n,Af:t,Gk:r})}function d0(e,t){for(var n=x(e.g),r=n.next();!r.done;r=n.next())t.g.add(r.value);for(e=x(e.h),n=e.next();!n.done;n=e.next())t.h.add(n.value)}p.Jk=function(e){this.g.add(e)},p.il=function(e){this.g.delete(e)},p.tj=function(){this.g.clear()},p.Kk=function(e){this.h.add(e)},p.jl=function(e){this.h.delete(e)},p.uj=function(){this.h.clear()},p.Uh=function(){this.l.clear()};function Nt(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:n===void 0?null:n}}p.destroy=function(){return this.j=!0,this.g.clear(),this.h.clear(),this.l.clear(),ot.prototype.release.call(this),this.u.destroy()},p.request=function(e,t,n){var r=this,i=new p0;if(this.j){var s=Promise.reject(new H(2,7,7001));return s.catch(function(){}),new dc(s,function(){return Promise.resolve()},i)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?br(t.retryParameters):Or(),t.uris=br(t.uris),s=aC(this,e,t,n);var o=s.Xa(function(){return f0(r,e,t,n,new o0(t.retryParameters,!1),0,null,i)}),u=o.Xa(function(v){return uC(r,e,v,n)}),l=Date.now(),f=0;s.promise.then(function(){f=Date.now()-l},function(){});var g=0;o.promise.then(function(){g=Date.now()},function(){});var y=u.Xa(function(v){var w=Date.now()-g,A=v.response;return A.timeMs+=f,A.timeMs+=w,v.hk||!r.o||A.fromCache||t.method=="HEAD"||e!=wr||r.o(A.timeMs,A.data.byteLength,h0(n),t,n),r.G&&r.G(e,A,n),A},function(v){throw v&&(v.severity=2),v});return s=new dc(y.promise,function(){return y.abort()},i),Ns(this.u,s),s};function aC(e,t,n,r){function i(u){s=s.Xa(function(){return n.body&&(n.body=vr(n.body)),u(t,n,r)})}var s=vo(void 0);e.F&&i(e.F),e=x(e.g);for(var o=e.next();!o.done;o=e.next())i(o.value);return s.Xa(void 0,function(u){throw u instanceof H&&u.code==7001?u:new H(2,1,1006,u)})}function f0(e,t,n,r,i,s,o,u){e.i.forceHTTP&&(n.uris[s]=n.uris[s].replace("https://","http://")),e.i.forceHTTPS&&(n.uris[s]=n.uris[s].replace("http://","https://")),s>0&&e.H&&e.H(t,r,n.uris[s],n.uris[s-1]);var l=new Pt(n.uris[s]),f=l.fc,g=!1;f||(f=location.protocol,f=f.slice(0,-1),Ol(l,f),n.uris[s]=l.toString()),f=f.toLowerCase();var y=(f=fc.get(f))?f.Af:null;if(!y)return es(new H(2,1,1e3,l));var v=f.Gk;(l=e.l.get(l.Eb))&&(n.headers["common-access-token"]=l);var w=null,A=null,I=!1,E=!1,R;return u0(a0(i)).Xa(function(){if(e.j)return Gh();R=Date.now();var M=0;n.requestStartTime=Date.now();var D=y(n.uris[s],n,t,function(b,U,N){w&&w.stop(),A&&A.ka(X/1e3),e.o&&t==wr&&(M++,n.packetNumber=M,e.o(b,U,h0(r),n,r),g=!0,u.g=N)},function(b){E=!0,n.timeToFirstByte=Date.now()-n.requestStartTime,e.m&&e.m(b,n,t)},{minBytesForProgressEvents:e.i.minBytesForProgressEvents});if(!v)return D;var O=n.retryParameters.connectionTimeout;O&&(w=new Ve(function(){I=!0,D.abort()}),w.ka(O/1e3));var X=n.retryParameters.stallTimeout;return X&&(A=new Ve(function(){I=!0,D.abort()})),D}).Xa(function(M){w&&w.stop(),A&&A.stop(),M.timeMs==null&&(M.timeMs=Date.now()-R);var D=M.headers["common-access-token"];if(D){var O=new Pt(M.uri);e.l.set(O.Eb,D)}return D={response:M,hk:g},!E&&e.m&&e.m(M.headers,n,t),e.B&&e.B(n,M),D},function(M){if(w&&w.stop(),A&&A.stop(),e.C){var D=null,O=0;M instanceof H&&(D=M,M.code==1001&&(O=M.data[1])),e.C(n,D,O,I)}if(e.j)return Gh();if(I&&(M=new H(1,1,1003,n.uris[s],t)),M instanceof H){if(M.code==7001)throw M;if(M.code==1010)throw o;if(M.severity==1){if(D=new Map().set("error",M),D=new Se("retry",D),D.cancelable=!0,e.dispatchEvent(D),D.defaultPrevented)throw M;return s=(s+1)%n.uris.length,f0(e,t,n,r,i,s,M,u)}}throw M})}function uC(e,t,n,r){var i=vo(void 0);e=x(e.h);for(var s=e.next(),o={};!s.done;o={Ni:void 0},s=e.next())o.Ni=s.value,i=i.Xa((function(u){return function(){var l=n.response;return l.data&&(l.data=vr(l.data)),(0,u.Ni)(t,l,r)}})(o));return i.Xa(function(){return n},function(u){var l=2;if(u instanceof H){if(u.code==7001)throw u;l=u.severity}throw new H(l,1,1007,u)})}function h0(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.Xc)return!1}return!0}de("shaka.net.NetworkingEngine",mt),mt.prototype.request=mt.prototype.request,mt.prototype.destroy=mt.prototype.destroy,mt.makeRequest=Nt,mt.defaultRetryParameters=function(){return Or()},mt.prototype.clearCommonAccessTokenMap=mt.prototype.Uh,mt.prototype.clearAllResponseFilters=mt.prototype.uj,mt.prototype.unregisterResponseFilter=mt.prototype.jl,mt.prototype.registerResponseFilter=mt.prototype.Kk,mt.prototype.clearAllRequestFilters=mt.prototype.tj,mt.prototype.unregisterRequestFilter=mt.prototype.il,mt.prototype.registerRequestFilter=mt.prototype.Jk,mt.unregisterScheme=function(e){fc.delete(e)},mt.registerScheme=Ai,mt.prototype.configure=mt.prototype.configure;function p0(){this.g=0}mt.NumBytesRemainingClass=p0;function dc(e,t,n){kt.call(this,e,t),this.h=n}J(dc,kt),mt.PendingRequest=dc;var wr=1;mt.RequestType={MANIFEST:0,SEGMENT:wr,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8,CMCD:9},mt.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12};var g0=3;mt.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:g0};var fc=new Map;function To(e){this.g=!1,this.h=new at,this.i=e}To.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))};function dt(e,t){if(e.g)throw t instanceof H&&t.code==7003?t:new H(2,7,7003,t)}function Xh(e,t){var n=[];e=x(e);for(var r=e.next();!r.done;r=e.next())n.push(t(r.value));return n}function lC(e,t){e=x(e);for(var n=e.next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}function wo(e){for(var t=new Map,n=x(Object.keys(e)),r=n.next();!r.done;r=n.next())r=r.value,t.set(r,e[r]);return t}function zh(e){var t={};return e.forEach(function(n,r){t[r]=n}),t}function pt(e,t){this.h=Ln(e),this.i=t==m0,this.g=0}p=pt.prototype,p.Ia=function(){return this.g<this.h.byteLength},p.Pa=function(){return this.g},p.getLength=function(){return this.h.byteLength},p.Y=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(t){throw Ei()}},p.Ca=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(t){throw Ei()}},p.U=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(t){throw Ei()}},p.bh=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(t){throw Ei()}},p.Ed=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(n){throw Ei()}if(t>2097151)throw new H(2,3,3001);return this.g+=8,t*4294967296+e},p.Ub=function(e,t){if(this.g+e>this.h.byteLength)throw Ei();var n=Le(this.h,this.g,e);return this.g+=e,t?new Uint8Array(n):n},p.skip=function(e){if(this.g+e>this.h.byteLength)throw Ei();this.g+=e},p.Oi=function(e){if(this.g<e)throw Ei();this.g-=e},p.seek=function(e){if(e<0||e>this.h.byteLength)throw Ei();this.g=e},p.Yc=function(){for(var e=this.g;this.Ia()&&this.h.getUint8(this.g)!=0;)this.g+=1;return e=Le(this.h,e,this.g-e),this.g+=1,wt(e)};function Ei(){return new H(2,3,3e3)}de("shaka.util.DataViewReader",pt),pt.prototype.readTerminatedString=pt.prototype.Yc,pt.prototype.seek=pt.prototype.seek,pt.prototype.rewind=pt.prototype.Oi,pt.prototype.skip=pt.prototype.skip,pt.prototype.readBytes=pt.prototype.Ub,pt.prototype.readUint64=pt.prototype.Ed,pt.prototype.readInt32=pt.prototype.bh,pt.prototype.readUint32=pt.prototype.U,pt.prototype.readUint16=pt.prototype.Ca,pt.prototype.readUint8=pt.prototype.Y,pt.prototype.getLength=pt.prototype.getLength,pt.prototype.getPosition=pt.prototype.Pa,pt.prototype.hasMoreData=pt.prototype.Ia;var m0=1;pt.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:m0};function ut(){this.i=new Map,this.h=new Map,this.g=!1}p=ut.prototype,p.box=function(e,t){return e=y0(e),this.i.set(e,cC),this.h.set(e,t),this},p.S=function(e,t){return e=y0(e),this.i.set(e,v0),this.h.set(e,t),this},p.stop=function(){this.g=!0},p.parse=function(e,t,n){for(e=new pt(e,0),this.g=!1;e.Ia()&&!this.g;)this.Bd(0,e,t,n)},p.Bd=function(e,t,n,r){var i=t.Pa();if(r&&i+8>t.getLength())this.g=!0;else{var s=t.U(),o=t.U(),u=pc(o),l=!1;switch(s){case 0:s=t.getLength()-i;break;case 1:if(r&&t.Pa()+8>t.getLength()){this.g=!0;return}s=t.Ed(),l=!0}var f=this.h.get(o);if(f){var g=null,y=null;if(this.i.get(o)==v0){if(r&&t.Pa()+4>t.getLength()){this.g=!0;return}y=t.U(),g=y>>>24,y&=16777215}o=i+s,n&&o>t.getLength()&&(o=t.getLength()),r&&o>t.getLength()?this.g=!0:(o-=t.Pa(),t=o>0?t.Ub(o,!1):new Uint8Array(0),t=new pt(t,0),f({name:u,parser:this,partialOkay:n||!1,stopOnPartial:r||!1,version:g,flags:y,reader:t,size:s,start:i+e,has64BitSize:l}))}else t.skip(Math.min(i+s-t.Pa(),t.getLength()-t.Pa()))}};function Ue(e){for(var t=ts(e);e.reader.Ia()&&!e.parser.g;)e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function Ii(e){for(var t=ts(e),n=e.reader.U(),r=0;r<n&&(e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial),!e.parser.g);r++);}function $n(e){var t=ts(e);for(e.reader.skip(78);e.reader.Ia()&&!e.parser.g;)e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function hc(e){var t=ts(e);e.reader.skip(8);var n=e.reader.Ca();for(e.reader.skip(6),n==2?e.reader.skip(48):e.reader.skip(12),n==1&&e.reader.skip(16);e.reader.Ia()&&!e.parser.g;)e.parser.Bd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function So(e,t){return function(n){e(n.reader.Ub(n.reader.getLength()-n.reader.Pa(),t))}}function y0(e){var t=0;e=x(e);for(var n=e.next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function pc(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function ts(e){return 8+(e.has64BitSize?8:0)+(e.flags!=null?4:0)}de("shaka.util.Mp4Parser",ut),ut.headerSize=ts,ut.typeToString=pc,ut.allData=So,ut.audioSampleEntry=hc,ut.visualSampleEntry=$n,ut.sampleDescription=Ii,ut.children=Ue,ut.prototype.parseNext=ut.prototype.Bd,ut.prototype.parse=ut.prototype.parse,ut.prototype.stop=ut.prototype.stop,ut.prototype.fullBox=ut.prototype.S,ut.prototype.box=ut.prototype.box;var cC=0,v0=1;function Wh(e){var t=this;this.g=[],this.h=[],this.data=[],new ut().box("moov",Ue).box("moof",Ue).S("pssh",function(n){if(!(n.version>1)){var r=Le(n.reader.h,-12,n.size);if(t.data.push(r),r=n.reader.Ub(16,!1),t.g.push(gi(r)),n.version>0){r=n.reader.U();for(var i=0;i<r;i++){var s=n.reader.Ub(16,!1);s=gi(s),t.h.push(s)}}}}).parse(e)}function gc(e,t,n,r){var i=e.length,s=12+t.length+4+i;r>0&&(s+=4+16*n.size);var o=new Uint8Array(s),u=Ln(o),l=0;if(u.setUint32(l,s),l+=4,u.setUint32(l,1886614376),l+=4,r<1?u.setUint32(l,0):u.setUint32(l,16777216),l+=4,o.set(t,l),l+=t.length,r>0)for(u.setUint32(l,n.size),l+=4,t=x(n),n=t.next();!n.done;n=t.next())n=Es(n.value),o.set(n,l),l+=n.length;return u.setUint32(l,i),o.set(e,l+4),o}function mc(e){var t=this;this.F=e,this.l=this.B=null,this.$=this.T=!1,this.J=0,this.g=null,this.o=new et,this.i=new Map,this.X=[],this.C=new Map,this.K=!1,this.m=new at,this.h=null,this.u=function(n){n.severity==2&&t.m.reject(n),e.onError(n)},this.ba=new Map,this.ma=new Map,this.M=new Ve(function(){return wC(t)}),this.R=!1,this.N=[],this.oa=!1,this.G=new Ve(function(){AC(t)}),this.m.catch(function(){}),this.j=new To(function(){return dC(t)}),this.O=!1,this.H=this.I=null,this.V=function(){return!1}}p=mc.prototype,p.destroy=function(){return this.j.destroy()};function dC(e){return F(function(t){switch(t.g){case 1:return e.o.release(),e.o=null,e.m.reject(),e.G.stop(),e.G=null,e.M.stop(),e.M=null,C(t,Za(e),2);case 2:if(!e.l){t.A(3);break}return Z(t,4),C(t,e.l.setMediaKeys(null),6);case 6:ce(t,5);break;case 4:se(t);case 5:e.l=null;case 3:e.g=null,e.B=null,e.C=new Map,e.h=null,e.u=function(){},e.F=null,e.O=!1,e.I=null,ie(t)}})}p.configure=function(e,t){this.h=e,t&&(this.V=t),this.G&&this.T&&this.g&&this.G.Ea(this.h.updateExpirationTime)};function fC(e,t,n){return e.$=!0,e.C=new Map,e.R=n,T0(e,t,!1)}function x0(e,t,n,r){r=r===void 0?!0:r,e.C=new Map,n=x(n);for(var i=n.next();!i.done;i=n.next())e.C.set(i.value,{initData:null,initDataType:null});for(n=x(e.h.persistentSessionsMetadata),i=n.next();!i.done;i=n.next())i=i.value,e.C.set(i.sessionId,{initData:i.initData,initDataType:i.initDataType});return e.R=e.C.size>0,T0(e,t,r)}function hC(e,t,n,r,i,s){var o,u,l,f,g;return F(function(y){return y.g==1?(o=[],s.length&&o.push(s[0].contentType),i.length&&o.push(i[0].contentType),u=function(v){return v=mi(t,v,null),v.licenseServerUri=n,v.serverCertificate=r,v.persistentStateRequired=!0,v.sessionType="persistent-license",v},l=i0(o),l.video&&(f=u(s[0].encryptionScheme||""),l.video.drmInfos.push(f)),l.audio&&(g=u(i[0].encryptionScheme||""),l.audio.drmInfos.push(g)),C(y,Fh([l],!0,e.O,[]),2)):(dt(e.j),y.return(E0(e,[l])))})}function T0(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O;return F(function(X){if(X.g==1){for(_0(e.h.clearKeys,t),r=t.some(function(b){return!!(b.video&&b.video.drmInfos.length||b.audio&&b.audio.drmInfos.length)}),i=wo(e.h.servers),s=wo(e.h.advanced||{}),!r&&n&&IC(t,i),o=new WeakSet,u=x(t),l=u.next();!l.done;l=u.next())for(f=l.value,g=k0(f),y=x(g),v=y.next();!v.done;v=y.next())w=v.value,o.has(w)||(o.add(w),MC(w,i,s,e.h.keySystemsMapping));for(A=function(b,U){var N=[];b=x(b);for(var z=b.next();!z.done;z=b.next()){z=z.value;var B=z[U]||s.has(z.keySystem)&&s.get(z.keySystem)[U]||"",W;if((W=B=="")&&(W=(W=z.keySystem)?!!W.match(/^com\.widevine\.alpha/):!1),W&&(U=="audioRobustness"?B=[e.h.defaultAudioRobustnessForWidevine]:U=="videoRobustness"&&(B=[e.h.defaultVideoRobustnessForWidevine])),typeof B=="string")N.push(z);else if(Array.isArray(B))for(B.length===0&&(B=[""]),B=x(B),W=B.next();!W.done;W=B.next()){var G={};N.push(Object.assign({},z,(G[U]=W.value,G)))}}return N},I=new WeakSet,E=x(t),R=E.next();!R.done;R=E.next())M=R.value,M.video&&!I.has(M.video)&&(M.video.drmInfos=A(M.video.drmInfos,"videoRobustness"),M.video.drmInfos=A(M.video.drmInfos,"audioRobustness"),I.add(M.video)),M.audio&&!I.has(M.audio)&&(M.audio.drmInfos=A(M.audio.drmInfos,"videoRobustness"),M.audio.drmInfos=A(M.audio.drmInfos,"audioRobustness"),I.add(M.audio));return C(X,Fh(t,e.R,e.O,e.h.preferredKeySystems),2)}return dt(e.j),D=r||i.size>0,D?(O=E0(e,t),X.return(r?O:O.catch(function(){}))):(e.T=!0,X.return(Promise.resolve()))})}function w0(e){var t;return F(function(n){switch(n.g){case 1:if(e.l.mediaKeys)return n.return();if(!e.I){n.A(2);break}return C(n,e.I,3);case 3:return dt(e.j),n.return();case 2:return Z(n,4),e.I=e.l.setMediaKeys(e.B),C(n,e.I,6);case 6:ce(n,5);break;case 4:t=se(n),e.u(new H(2,6,6003,t.message));case 5:dt(e.j),ie(n)}})}function pC(e,t){return F(function(n){if(n.g==1)return C(n,w0(e),2);Ja(e,t.initDataType,Le(t.initData)),ie(n)})}p.Wb=function(e){var t=this,n,r;return F(function(i){if(i.g==1)return t.l===e?i.return():t.B?(t.l=e,t.h.delayLicenseRequestUntilPlayed&&t.o.Aa(t.l,"play",function(){for(var s=x(t.N),o=s.next();!o.done;o=s.next())Yh(t,o.value);t.oa=!0,t.N=[]}),t.l.remote?(t.o.D(t.l.remote,"connect",function(){return Za(t)}),t.o.D(t.l.remote,"connecting",function(){return Za(t)}),t.o.D(t.l.remote,"disconnect",function(){return Za(t)})):"webkitCurrentPlaybackTargetIsWireless"in t.l&&t.o.D(t.l,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Za(t)}),t.H=t.g&&t.g.initData.find(function(s){return s.initData.length>0})||null,n=t.g.keySystem,(r=je().Ug(n))||!t.H&&t.g.keySystem==="com.apple.fps"&&!t.C.size?i.A(2):C(i,w0(t),2)):(t.o.Aa(e,"encrypted",function(){t.u(new H(2,6,6010))}),i.return());S0(t).catch(function(){}),!r&&(t.H||t.C.size||t.h.parseInbandPsshEnabled)||t.o.D(t.l,"encrypted",function(s){return pC(t,s)}),ie(i)})};function gC(e){var t,n,r,i,s;return F(function(o){switch(o.g){case 1:if(!e.B||!e.g)return o.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){o.A(2);break}return t=Nt([e.g.serverCertificateUri],e.h.retryParameters),Z(o,3),n=e.F.vc.request(5,t,{isPreload:e.V()}),C(o,n.promise,5);case 5:r=o.h,e.g.serverCertificate=Le(r.data),ce(o,4);break;case 3:throw i=se(o),new H(2,6,6017,i);case 4:if(e.j.g)return o.return();case 2:return!e.g.serverCertificate||!e.g.serverCertificate.length?o.return():(Z(o,6),C(o,e.B.setServerCertificate(e.g.serverCertificate),8));case 8:ce(o,0);break;case 6:throw s=se(o),new H(2,6,6004,s.message)}})}function mC(e,t){var n,r,i;return F(function(s){if(s.g==1)return C(s,C0(e,t,{initData:null,initDataType:null}),2);if(s.g!=3)return n=s.h,n?(r=[],(i=e.i.get(n))&&(i.Lb=new at,r.push(i.Lb)),r.push(n.remove()),C(s,Promise.all(r),3)):s.return();e.i.delete(n),ie(s)})}function S0(e){var t,n,r,i,s;return F(function(o){if(o.g==1)return e.C.size?(e.C.forEach(function(u,l){C0(e,l,u)}),C(o,e.m,3)):o.A(2);if(o.g!=2){if(t=e.g&&e.g.keyIds||new Set([]),t.size>0&&EC(e))return o.return(e.m);e.K=!1,e.m=new at,e.m.catch(function(){})}for(n=(e.g?e.g.initData:[])||[],r=x(n),i=r.next();!i.done;i=r.next())s=i.value,Ja(e,s.initDataType,s.initData);return eu(e)&&e.m.resolve(),o.return(e.m)})}function Ja(e,t,n){if(n.length){try{n=e.h.initDataTransform(n,t,e.g)}catch(o){t=o,o instanceof H||(t=new H(2,6,6016,o)),e.u(t);return}if(e.h.ignoreDuplicateInitData){var r=e.i.values();r=x(r);for(var i=r.next();!i.done;i=r.next())if(hi(n,i.value.initData))return;var s=!1;if(e.C.forEach(function(o){!s&&hi(n,o.initData)&&(s=!0)}),s)return}e.K=!0,e.i.size>0&&eu(e)&&(e.m.resolve(),e.K=!1,e.m=new at,e.m.catch(function(){})),xC(e,t,n,e.g.sessionType)}}function A0(e){return e=e.i.keys(),e=Xh(e,function(t){return t.sessionId}),Array.from(e)}p.Jg=function(){var e=this,t=this.i.keys();return t=Xh(t,function(n){var r=e.i.get(n);return{sessionId:n.sessionId,sessionType:r.type,initData:r.initData,initDataType:r.initDataType}}),Array.from(t)},p.Yd=function(){var e=1/0,t=this.i.keys();t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e};function yC(e){return e.J?e.J:NaN}p.Ze=function(){return zh(this.ma)};function E0(e,t){var n,r,i,s,o,u,l;return F(function(f){switch(f.g){case 1:if(n=new Map,r=vC(e,t,n),!r)throw navigator.requestMediaKeySystemAccess?new H(2,6,6001):new H(2,6,6020);dt(e.j),Z(f,2),r.getConfiguration();var g=i=e.h.keySystemsMapping[r.keySystem]||r.keySystem,y=n.get(i),v=[],w=[],A=[],I=[],E=[],R=new Set,M=new Set;CC(y,v,w,I,A,E,R,M);var D=e.R?"persistent-license":"temporary";for(g={keySystem:g,encryptionScheme:v[0],licenseServerUri:w[0],distinctiveIdentifierRequired:y[0].distinctiveIdentifierRequired,persistentStateRequired:y[0].persistentStateRequired,sessionType:y[0].sessionType||D,audioRobustness:y[0].audioRobustness||"",videoRobustness:y[0].videoRobustness||"",serverCertificate:I[0],serverCertificateUri:A[0],initData:E,keyIds:R},M.size>0&&(g.keySystemUris=M),y=x(y),M=y.next();!M.done;M=y.next())M=M.value,M.distinctiveIdentifierRequired&&(g.distinctiveIdentifierRequired=M.distinctiveIdentifierRequired),M.persistentStateRequired&&(g.persistentStateRequired=M.persistentStateRequired);if(e.g=g,!e.g.licenseServerUri)throw new H(2,6,6012,e.g.keySystem);return C(f,r.createMediaKeys(),4);case 4:if(s=f.h,dt(e.j),e.B=s,!(e.h.minHdcpVersion!=""&&"getStatusForPolicy"in e.B)){f.A(5);break}return Z(f,6),C(f,e.B.getStatusForPolicy({minHdcpVersion:e.h.minHdcpVersion}),8);case 8:if(o=f.h,o!="usable")throw new H(2,6,6018);dt(e.j),ce(f,5,2);break;case 6:throw u=se(f,2),u instanceof H?u:new H(2,6,6019,u.message);case 5:return e.T=!0,e.G.Ea(e.h.updateExpirationTime),C(f,gC(e),9);case 9:dt(e.j),ce(f,0);break;case 2:throw l=se(f),dt(e.j,l),e.g=null,l instanceof H?l:new H(2,6,6002,l.message)}})}function vC(e,t,n){for(var r=x(t),i=r.next();!i.done;i=r.next()){i=x(k0(i.value));for(var s=i.next();!s.done;s=i.next())s=s.value,n.has(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s)}if(n.size==1&&n.has(""))throw new H(2,6,6e3);r=e.h.preferredKeySystems,r.length||(i=wo(e.h.servers),i.size==1&&(r=Array.from(i.keys()))),i=x(r);var o=i.next();for(s={};!o.done;s={Ii:void 0},o=i.next()){s.Ii=o.value,o=x(t);for(var u=o.next();!u.done;u=o.next())if(u=u.value.decodingInfos.find((function(y){return function(v){return v.supported&&v.keySystemAccess!=null&&v.keySystemAccess.keySystem==y.Ii}})(s)))return u.keySystemAccess}for(i=x([!0,!1]),s=i.next();!s.done;s=i.next())for(s=s.value,o=x(t),u=o.next();!u.done;u=o.next()){u=x(u.value.decodingInfos);for(var l=u.next();!l.done;l=u.next())if(l=l.value,l.supported&&l.keySystemAccess){var f=l.keySystemAccess.keySystem;if(!r.includes(f)){var g=n.get(f);for(!g&&e.h.keySystemsMapping[f]&&(g=n.get(e.h.keySystemsMapping[f])),f=x(g),g=f.next();!g.done;g=f.next())if(!!g.value.licenseServerUri==s)return l.keySystemAccess}}}return null}function Kh(e){eu(e)&&e.m.resolve()}function I0(e,t){new Ve(function(){t.loaded=!0,Kh(e)}).ka(kC)}function C0(e,t,n){var r,i,s,o,u,l,f;return F(function(g){switch(g.g){case 1:try{r=e.B.createSession("persistent-license")}catch(y){return i=new H(2,6,6005,y.message),e.u(i),g.return(Promise.reject(i))}return e.o.D(r,"message",function(y){$h(e)?e.N.push(y):Yh(e,y)}),e.o.D(r,"keystatuseschange",function(y){return M0(e,y)}),s={initData:n.initData,initDataType:n.initDataType,loaded:!1,Xg:1/0,Lb:null,type:"persistent-license"},e.i.set(r,s),Z(g,2),C(g,r.load(t),4);case 4:return o=g.h,dt(e.j),o||(e.i.delete(r),u=e.h.persistentSessionOnlinePlayback?1:2,e.u(new H(u,6,6013)),s.loaded=!0),I0(e,s),Kh(e),g.return(r);case 2:l=se(g),dt(e.j,l),e.i.delete(r),f=e.h.persistentSessionOnlinePlayback?1:2,e.u(new H(f,6,6005,l.message)),s.loaded=!0,Kh(e);case 3:return g.return(Promise.resolve())}})}function xC(e,t,n,r){try{var i=e.B.createSession(r)}catch(s){e.u(new H(2,6,6005,s.message));return}e.o.D(i,"message",function(s){$h(e)?e.N.push(s):Yh(e,s)}),e.o.D(i,"keystatuseschange",function(s){return M0(e,s)}),e.i.set(i,{initData:n,initDataType:t,loaded:!1,Xg:1/0,Lb:null,type:r}),e.h.logLicenseExchange&&pi(n),i.generateRequest(t,n).catch(function(s){if(!e.j.g){e.i.delete(i);var o=s.errorCode;if(o&&o.systemCode){var u=o.systemCode;u<0&&(u+=4294967296),u="0x"+u.toString(16)}e.u(new H(2,6,6006,s.message,s,u))}})}function $h(e){return e.l?e.h.delayLicenseRequestUntilPlayed&&e.l.paused&&!e.oa:!e.$&&e.h.delayLicenseRequestUntilPlayed}function TC(e){return F(function(t){return t.g==1?!e.K||$h(e)?t.A(0):C(t,e.m,3):C(t,Promise.all(e.X.map(function(n){return n.promise})),0)})}function Yh(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R;F(function(M){switch(M.g){case 1:if(n=t.target,e.h.logLicenseExchange&&pi(t.message),r=e.i.get(n),i=e.g.licenseServerUri,s=e.h.advanced[e.g.keySystem],t.messageType=="individualization-request"&&s&&s.individualizationServer&&(i=s.individualizationServer),o=Nt([i],e.h.retryParameters),o.body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,o.drmInfo=e.g,r&&(o.initData=r.initData,o.initDataType=r.initDataType),s&&s.headers)for(u in s.headers)o.headers[u]=s.headers[u];if(e.g.keySystem==="org.w3.clearkey"){var D=o,O=e.g;try{var X=ei(D.body);if(X){var b=JSON.parse(X);b.type||(b.type=O.sessionType,D.body=Lr(JSON.stringify(b)))}}catch(U){}}if(vh(e.g.keySystem))if(D=Ki(o.body,!0,!0),D.includes("PlayReadyKeyMessage")){for(D=ks(D,"PlayReadyKeyMessage"),O=Kr(D,"HttpHeader"),O=x(O),X=O.next();!X.done;X=O.next())b=X.value,X=Kr(b,"name")[0],b=Kr(b,"value")[0],o.headers[Dt(X)]=Dt(b);D=Kr(D,"Challenge")[0],o.body=xr(Dt(D))}else o.headers["Content-Type"]="text/xml; charset=utf-8";return l=Date.now(),Z(M,2),g=e.F.vc.request(2,o,{isPreload:e.V()}),e.X.push(g),C(M,g.promise,4);case 4:f=M.h,Dr(e.X,g),ce(M,3);break;case 2:return y=se(M),e.j.g||(v={sessionId:n.sessionId,sessionType:r.type,initData:r.initData,initDataType:r.initDataType},w=new H(2,6,6007,y,v),e.i.size==1?(e.u(w),r&&r.Lb&&r.Lb.reject(w)):(r&&r.Lb&&r.Lb.reject(w),e.i.delete(n),eu(e)&&(e.m.resolve(),e.M.ka(.1)))),M.return();case 3:return e.j.g?M.return():(e.J+=(Date.now()-l)/1e3,e.h.logLicenseExchange&&pi(f.data),Z(M,5),C(M,n.update(f.data),7));case 7:ce(M,6);break;case 5:return I=(A=se(M))&&A.message||String(A),E=new H(2,6,6008,I),e.u(E),r&&r.Lb&&r.Lb.reject(E),M.return();case 6:if(e.j.g)return M.return();R=new Se("drmsessionupdate"),e.F.onEvent(R),r&&(r.Lb&&r.Lb.resolve(),I0(e,r)),ie(M)}})}function M0(e,t){t=t.target;var n=e.i.get(t),r=!1;t.keyStatuses.forEach(function(s,o){if(typeof o=="string"){var u=o;o=s,s=u}if(u=je(),vh(e.g.keySystem)&&o.byteLength==16&&u.Ef()){u=Ln(o);var l=u.getUint32(0,!0),f=u.getUint16(4,!0),g=u.getUint16(6,!0);u.setUint32(0,l,!1),u.setUint16(4,f,!1),u.setUint16(6,g,!1)}s!="status-pending"&&(n.loaded=!0),s=="expired"&&(r=!0),o=gi(o).slice(0,32),e.ba.set(o,s)});var i=t.expiration-Date.now();(i<0||r&&i<1e3)&&n&&!n.Lb&&(e.i.delete(t),R0(t)),eu(e)&&(e.m.resolve(),e.M.ka(_C))}function wC(e){var t=e.ba,n=e.ma;n.clear(),t.forEach(function(r,i){return n.set(i,r)}),t=Array.from(n.values()),t.length&&t.every(function(r){return r=="expired"})&&e.u(new H(2,6,6014)),e.F.yf(zh(n))}function SC(){var e,t,n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G;return F(function(re){if(re.g==1){if(e="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.microsoft.playready.recommendation.3000 com.microsoft.playready.recommendation.3000.clearlead com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!(m.MediaKeys&&m.navigator&&m.navigator.requestMediaKeySystemAccess&&m.MediaKeySystemAccess&&m.MediaKeySystemAccess.prototype.getConfiguration)){for(t={},n=x(e),r=n.next();!r.done;r=n.next())i=r.value,t[i]=null;return re.return(t)}for(s="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),o=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],u=["150","2000","3000"],l={"com.widevine.alpha":o,"com.widevine.alpha.experiment":o,"com.microsoft.playready.recommendation":u},f=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],g=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],y={videoCapabilities:f,audioCapabilities:g,initDataTypes:["cenc","sinf","skd","keyids"]},v=[null,"cenc","cbcs"],w=new Map,A=je(),I=function(ne,$,Q){var ae,le,be,xe,Ze,Ne,st,ze,He,$e,Je,Ye,Ge;return F(function(We){switch(We.g){case 1:return Z(We,2),C(We,$.createMediaKeys(),5);case 5:ae=We.h;case 4:ce(We,3);break;case 2:return se(We),We.return();case 3:if(be=(le=$.getConfiguration().sessionTypes)?le.includes("persistent-license"):!1,A.Ai()&&(be=!1),xe=$.getConfiguration().videoCapabilities,Ze=$.getConfiguration().audioCapabilities,Ne={persistentState:be,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},w.get(ne)?Ne=w.get(ne):w.set(ne,Ne),(st=xe[0].encryptionScheme)&&!Ne.encryptionSchemes.includes(st)&&Ne.encryptionSchemes.push(st),(ze=xe[0].robustness)&&!Ne.videoRobustnessLevels.includes(ze)&&Ne.videoRobustnessLevels.push(ze),(He=Ze[0].robustness)&&!Ne.audioRobustnessLevels.includes(He)&&Ne.audioRobustnessLevels.push(He),!(Q&&"getStatusForPolicy"in ae)){We.A(0);break}$e=x(s),Je=$e.next();case 7:if(Je.done){We.A(0);break}if(Ye=Je.value,Ne.minHdcpVersions.includes(Ye)){We.A(8);break}return C(We,ae.getStatusForPolicy({minHdcpVersion:Ye}),10);case 10:if(Ge=We.h,Ge=="usable")Ne.minHdcpVersions.includes(Ye)||Ne.minHdcpVersions.push(Ye);else{We.A(0);break}case 8:Je=$e.next(),We.A(7)}})},E=function(ne,$,Q,ae,le){le=le===void 0?!1:le;var be,xe,Ze,Ne,st,ze,He,$e,Je,Ye,Ge;return F(function(We){switch(We.g){case 1:for(Z(We,2),be=br(y),xe=x(be.videoCapabilities),Ze=xe.next();!Ze.done;Ze=xe.next())Ne=Ze.value,Ne.encryptionScheme=$,Ne.robustness=Q;for(st=x(be.audioCapabilities),ze=st.next();!ze.done;ze=st.next())He=ze.value,He.encryptionScheme=$,He.robustness=ae;return $e=br(be),$e.persistentState="required",$e.sessionTypes=["persistent-license"],Je=[$e,be],Ge=je(),Ge.Oa()=="MOBILE"?C(We,tc(5,navigator.requestMediaKeySystemAccess(ne,Je)),7):C(We,navigator.requestMediaKeySystemAccess(ne,Je),6);case 6:Ye=We.h,We.A(5);break;case 7:Ye=We.h;case 5:return C(We,I(ne,Ye,le),8);case 8:ce(We,0);break;case 2:se(We),ie(We)}})},R=function(ne){return!(je().Ha()==="WEBKIT"&&ne==="org.w3.clearkey")},M=[],D=x(e),O=D.next();!O.done;O=D.next())if(X=O.value,w.set(X,null),R(X)){for(b=!0,U=x(v),N=U.next();!N.done;N=U.next())z=N.value,M.push(E(X,z,"","",b)),b=!1;for(B=x(l[X]||[]),W=B.next();!W.done;W=B.next())G=W.value,M.push(E(X,null,G,"")),M.push(E(X,null,"",G))}return C(re,Promise.all(M),2)}return re.return(zh(w))})}function R0(e){return F(function(t){if(t.g==1)return Z(t,2),C(t,tc(RC,Promise.all([e.close().catch(function(){}),e.closed])),4);if(t.g!=2)return ce(t,0);se(t),ie(t)})}function Za(e){var t;return F(function(n){return t=Array.from(e.i.entries()),e.i.clear(),C(n,Promise.all(t.map(function(r){r=x(r);var i=r.next().value,s=r.next().value;return F(function(o){if(o.g==1)return Z(o,2),e.$||e.C.has(i.sessionId)||s.type!=="persistent-license"||e.h.persistentSessionOnlinePlayback?C(o,R0(i),5):C(o,i.remove(),5);if(o.g!=2)return ce(o,0);se(o),ie(o)})})),0)})}function k0(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function AC(e){e.i.forEach(function(t,n){var r=t.Xg,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.F.onExpirationUpdated(n.sessionId,i),t.Xg=i)})}function eu(e){return e=e.i.values(),lC(e,function(t){return t.loaded})}function EC(e){for(var t=x(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if(e.ba.get(n.value)!=="usable")return!1;return!0}function IC(e,t){var n=[];for(t.forEach(function(r,i){n.push({keySystem:i,licenseServerUri:r,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=x(e),t=e.next();!t.done;t=e.next())t=t.value,t.video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}function CC(e,t,n,r,i,s,o,u){var l=[];e=x(e);for(var f=e.next(),g={};!f.done;g={La:void 0},f=e.next()){if(g.La=f.value,t.includes(g.La.encryptionScheme)||t.push(g.La.encryptionScheme),g.La.keySystem=="org.w3.clearkey"&&g.La.licenseServerUri.startsWith("data:application/json;base64,")?l.includes(g.La.licenseServerUri)||l.push(g.La.licenseServerUri):n.includes(g.La.licenseServerUri)||n.push(g.La.licenseServerUri),i.includes(g.La.serverCertificateUri)||i.push(g.La.serverCertificateUri),g.La.serverCertificate&&(r.some((function(w){return function(A){return hi(A,w.La.serverCertificate)}})(g))||r.push(g.La.serverCertificate)),g.La.initData){f=x(g.La.initData);for(var y=f.next(),v={};!y.done;v={Og:void 0},y=f.next())v.Og=y.value,s.some((function(w){return function(A){var I=w.Og;return A.keyId&&A.keyId==I.keyId?!0:A.initDataType==I.initDataType&&hi(A.initData,I.initData)}})(v))||s.push(v.Og)}if(g.La.keyIds)for(f=x(g.La.keyIds),y=f.next();!y.done;y=f.next())o.add(y.value);if(g.La.keySystemUris&&u)for(g=x(g.La.keySystemUris),f=g.next();!f.done;f=g.next())u.add(f.value)}if(l.length==1)n.push(l[0]);else if(l.length>0){for(t=[],l=x(l),r=l.next();!r.done;r=l.next())r=m.atob(r.value.split("data:application/json;base64,").pop()),r=JSON.parse(r),t.push.apply(t,Y(r.keys));l=JSON.stringify({keys:t}),n.push("data:application/json;base64,"+m.btoa(l))}}function MC(e,t,n,r){var i=e.keySystem;i&&(i!="org.w3.clearkey"||!e.licenseServerUri)&&(t.size&&t.get(i)&&(t=t.get(i),e.licenseServerUri=t),e.keyIds||(e.keyIds=new Set),(n=n.get(i))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=n.persistentStateRequired),e.serverCertificate||(e.serverCertificate=n.serverCertificate),n.sessionType&&(e.sessionType=n.sessionType),e.serverCertificateUri||(e.serverCertificateUri=n.serverCertificateUri)),r[i]&&(e.keySystem=r[i]),m.cast&&m.cast.__platform__&&i=="com.microsoft.playready"&&(e.keySystem="com.chromecast.playready"))}function _0(e,t){if(e=wo(e),e.size!=0){e=vv(e),t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.drmInfos=[e]),n.audio&&(n.audio.drmInfos=[e])}}var RC=1,kC=5,_C=.5;function PC(){this.g=Us,this.j=new Map().set(Us,2).set(Os,1),this.i=0,this.h=-1}function qh(e,t){var n=e.g!==t;return e.g=t,n&&t===Us&&(e.i=Date.now()),n}var Os=0,Us=1;/*
 @license
 Shaka Player
 Copyright 2023 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function Qh(e,t,n){this.g=e,this.i=t,this.h=n}function P0(e,t){return F(function(n){if(n.g==1)return C(n,$2(e.h,t,e.g.drm.preferredKeySystems,e.g.drm.keySystemsMapping),2);if(e.g.streaming.dontChooseCodecs||$v(t,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes,e.g.preferredTextFormats),!t.variants.some(Qa))throw new H(2,4,4032);return n.return(L0(e,t))})}function D0(e,t){var n=e.g.restrictions;e=e.i;var r=!1;t=x(t.variants);for(var i=t.next();!i.done;i=t.next()){i=i.value;var s=i.allowedByApplication;i.allowedByApplication=ic(i,n,e),s!=i.allowedByApplication&&(r=!0)}return r}function L0(e,t){var n=D0(e,t);if(t){var r=e.h?e.h.g:null;if(r&&e.h.B){for(var i=new Set,s=x(t.variants),o=s.next();!o.done;o=s.next())o=o.value,o.audio&&i.add(o.audio),o.video&&i.add(o.video);for(i=x(i),s=i.next();!s.done;s=i.next())b0(e,r.keySystem,s.value)}N0(e,t)}return n}function b0(e,t,n){n=x(n.drmInfos);for(var r=n.next();!r.done;r=n.next())if(r=r.value,r.keySystem==t){r=x(r.initData||[]);for(var i=r.next();!i.done;i=r.next())i=i.value,Ja(e.h,i.initDataType,i.initData)}}function N0(e,t){function n(f){if(f&&!u.has(f)&&(u.add(f),f.keyIds.size)){f=x(f.keyIds);for(var g=f.next();!g.done;g=f.next()){g=g.value;var y=r[i?"00":g];y?O0.includes(y)&&o.add(y):s.add(g)}}}var r=e.h?e.h.Ze():{};e=Object.keys(r);var i=e.length&&e[0]=="00";e=!1;var s=new Set,o=new Set,u=new WeakSet;t=x(t.variants);for(var l=t.next();!l.done;l=t.next()){if(l=l.value,!l.allowedByApplication)e=!0;else if(l.allowedByKeySystem)return;n(l.audio),n(l.video)}throw e={hasAppRestrictions:e,missingKeys:Array.from(s),restrictedKeyStatuses:Array.from(o)},new H(2,4,4012,e)}var O0=["output-restricted","internal-error"];de("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"});function vn(e){if(Jh.has(e))return Jh.get(e);var t=m.ManagedMediaSource||m.MediaSource;return t?(t=t.isTypeSupported(e),Jh.set(e,t),t):!1}function U0(){var e=m.ManagedMediaSource||m.MediaSource;return e&&e.prototype?!!e.prototype.setLiveSeekableRange&&!!e.prototype.clearLiveSeekableRange:!1}var Jh=new Map;function yc(e,t){var n=null,r=null,i=null,s=null,o=e.U();return t&1&&(i=e.Ed()),t&2&&(s=e.U()),t&8&&(n=e.U()),t&16&&(r=e.U()),{trackId:o,Vd:n,Wd:r,pj:i,Pi:s}}function vc(e,t){return t==1?(t=e.U(),e=e.U(),{baseMediaDecodeTime:t*4294967296+e}):{baseMediaDecodeTime:e.U()}}function xc(e,t){return t==1?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.U(),e.skip(4),e=e.Ca(),{timescale:t,language:String.fromCharCode((e>>10)+96)+String.fromCharCode(((e&960)>>5)+96)+String.fromCharCode((e&31)+96)}}function Tc(e,t,n){var r=e.U(),i=[],s=null;n&1&&(s=e.bh()),n&4&&e.skip(4);for(var o=0;o<r;o++){var u={mh:null,sampleSize:null,Ff:null};n&256&&(u.mh=e.U()),n&512&&(u.sampleSize=e.U()),n&1024&&e.skip(4),n&2048&&(u.Ff=t==0?e.U():e.bh()),i.push(u)}return{Fm:r,kh:i,pg:s}}function j0(e){e.skip(6),e.skip(2),e.skip(8);var t=e.Ca();return e.skip(2),e.skip(2),e.skip(2),e=e.Ca()+e.Ca()/65536,{channelCount:t,sampleRate:e}}function Zh(e){return e=e.U(),{codec:pc(e)}}function DC(e){var t=null,n=null,r=e.Ub(4,!1),i=String.fromCharCode(r[0]);if(i+=String.fromCharCode(r[1]),i+=String.fromCharCode(r[2]),i+=String.fromCharCode(r[3]),i==="nclx"){switch(e.Ca()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(r=e.Ca(),e.Ca(),r){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,ye:n}}function tu(e,t){return t=t===void 0?!1:t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function Yn(e){return(e<10?"0":"")+e}function Ao(e){this.g=e}function Eo(e){for(var t=[],n=x(e.g),r=n.next();!r.done;r=n.next()){var i=t,s=i.push,o=r.value;r=Ke;var u=o.id+1,l=o.stream.width||0,f=o.stream.height||0;o.type=="audio"&&(f=l=0);var g=o.duration*o.timescale,y=Math.floor(g/(ns+1));switch(g=Math.floor(g%(ns+1)),u=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(Y(St(u,4)),[0,0,0,0],Y(St(y,4)),Y(St(g,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],Y(St(l,2)),[0,0],Y(St(f,2)),[0,0])),u=Ke("tkhd",u),l=Ke,y=o.duration*o.timescale,f=Math.floor(y/(ns+1)),y=Math.floor(y%(ns+1)),g=o.stream.language,g=g.charCodeAt(0)-96<<10|g.charCodeAt(1)-96<<5|g.charCodeAt(2)-96,f=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(Y(St(o.timescale,4)),Y(St(f,4)),Y(St(y,4)),Y(St(g,2)),[0,0])),f=Ke("mdhd",f),y=o,g=new Uint8Array([]),y.type){case"video":g=bC.value();break;case"audio":g=NC.value()}y=Ke("hdlr",g);e:{switch(o.type){case"video":o=Ke("minf",Ke("vmhd",FC.value()),X0.value(),B0(o));break e;case"audio":o=Ke("minf",Ke("smhd",VC.value()),X0.value(),B0(o));break e}o=new Uint8Array([])}o=l("mdia",f,y,o),r=r("trak",u,o),s.call(i,r)}for(t=Lt.apply(un,Y(t)),s=e.g[0],n=Ke,r=s.duration*s.timescale,i=Math.floor(r/(ns+1)),r=Math.floor(r%(ns+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(Y(St(s.timescale,4)),Y(St(i,4)),Y(St(r,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),i=Ke("mvhd",i),r=[],e=x(e.g),l=e.next();!l.done;l=e.next())o=r,u=o.push,l=new Uint8Array([0,0,0,0].concat(Y(St(l.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),l=Ke("trex",l),u.call(o,l);if(e=Lt.apply(un,Y(r)),e=Ke("mvex",e),r=[],s.encrypted){for(s=x(s.stream.drmInfos),o=s.next();!o.done;o=s.next())if(o=o.value,o.initData)for(o=x(o.initData),u=o.next();!u.done;u=o.next())r.push(u.value.initData);s=Lt.apply(un,Y(r))}else s=new Uint8Array([]);return e=n("moov",i,t,e,s),t=GC.value(),n=new Uint8Array(t.byteLength+e.byteLength),n.set(t),n.set(e,t.byteLength),n}function B0(e){var t=Ke,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=je().re()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var r=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){if(n=e.stream.width||0,r=e.stream.height||0,e.Sa.byteLength>0)var i=Ke("avcC",e.Sa);else{i=Ke;for(var s=7,o=[],u=[],l=0,f=0,g=0,y=0;y<e.Cb.length;y++){var v=V0(e.Cb[y]);switch(v[0]&31){case 7:o.push(v),s+=v.length+2;break;case 8:u.push(v),s+=v.length+2}}for(o.length>0&&(l=o[0][1],g=o[0][2],f=o[0][3]),s=new Uint8Array(s),y=0,s[y++]=1,s[y++]=l,s[y++]=g,s[y++]=f,s[y++]=255,s[y++]=224|o.length,l=0;l<o.length;l++)s[y++]=(o[l].length&65280)>>8,s[y++]=o[l].length&255,s.set(o[l],y),y+=o[l].length;for(s[y++]=u.length,o=0;o<u.length;o++)s[y++]=(u[o].length&65280)>>8,s[y++]=u[o].length&255,s.set(u[o],y),y+=u[o].length;i=i("avcC",s)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(Y(St(n,2)),Y(St(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="avc1",u=F0(e),o=new Uint8Array([]),e.encrypted&&(o=js(e.stream,e.codecs),r="encv"),r=Ke(r,n,i,u,o)}else e.codecs.includes("hvc1")&&(r=e.stream.width||0,i=e.stream.height||0,n=new Uint8Array([]),e.Sa.byteLength>0&&(n=Ke("hvcC",e.Sa)),r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(Y(St(r,2)),Y(St(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="hvc1",u=F0(e),o=new Uint8Array([]),e.encrypted&&(o=js(e.stream,e.codecs),i="encv"),r=Ke(i,r,n,u,o));break;case"audio":n=="mp3"?e=Ke(".mp3",nu(e)):n=="ac-3"?(n=Ke("dac3",e.Ga),r="ac-3",i=new Uint8Array([]),e.encrypted&&(i=js(e.stream,e.codecs),r="enca"),e=Ke(r,nu(e),n,i)):n=="ec-3"?(n=Ke("dec3",e.Ga),r="ec-3",i=new Uint8Array([]),e.encrypted&&(i=js(e.stream,e.codecs),r="enca"),e=Ke(r,nu(e),n,i)):n=="opus"?(n=Ke("dOps",e.Ga),r="Opus",i=new Uint8Array([]),e.encrypted&&(i=js(e.stream,e.codecs),r="enca"),e=Ke(r,nu(e),n,i)):(e.Ga.byteLength>0?n=Ke("esds",e.Ga):(n=Ke,r=e.id+1,i=e.stream.channelsCount||2,o=e.stream.audioSamplingRate||44100,l=ao("audio",e.codecs.split(",")),f={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},u=f[o],(l==="mp4a.40.5"||l==="mp4a.40.29")&&(u=f[o*2]),o=parseInt(l.split(".").pop(),10),r=new Uint8Array([0,0,0,0,3,25].concat(Y(St(r,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,o<<3|u>>>1,u<<7|i<<3,6,1,2])),n=n("esds",r)),r="mp4a",i=new Uint8Array([]),e.encrypted&&(i=js(e.stream,e.codecs),r="enca"),e=Ke(r,nu(e),n,i)),r=e}return e=Ke("stsd",HC.value(),r),t("stbl",e,Ke("stts",OC.value()),Ke("stsc",UC.value()),Ke("stsz",BC.value()),Ke("stco",jC.value()))}function F0(e){if(!e.Za&&!e.$a)return new Uint8Array([]);var t=e.$a;return e=new Uint8Array([].concat(Y(St(e.Za,4)),Y(St(t,4)))),Ke("pasp",e)}function nu(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(Y(St(e.stream.audioSamplingRate||44100,2)),[0,0]))}function js(e,t){var n=Ke;t=new Uint8Array([].concat(Y(St(H0(t.split(".")[0]),4)))),t=Ke("frma",t);var r="cenc",i=e.drmInfos[0];i&&i.encryptionScheme&&(r=i.encryptionScheme),r=new Uint8Array([0,0,0,0].concat(Y(St(H0(r),4)),[0,1,0,0])),r=Ke("schm",r),i=Ke;var s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);e=x(e.drmInfos);for(var o=e.next();!o.done;o=e.next())if((o=o.value)&&o.keyIds&&o.keyIds.size){o=x(o.keyIds);for(var u=o.next();!u.done;u=o.next())s=V0(u.value)}return e=new Uint8Array([0,0,0,0,0,0,1,8]),s=Ke("tenc",e,s),n("sinf",t,r,i("schi",s))}function ru(e){var t=[];e=x(e.g);for(var n=e.next();!n.done;n=e.next()){n=n.value;var r=t.push,i=r.apply,s=Ke,o=new Uint8Array([0,0,0,0].concat(Y(St(n.data?n.data.sequenceNumber:0,4))));o=Ke("mfhd",o);var u,l=n.data?n.data.zb:[],f=new Uint8Array(4+l.length);for(u=0;u<l.length;u++){var g=l[u].flags;f[u+4]=g.ib<<4|g.mb<<2|g.jb}l=Ke("sdtp",f);var y=l.length+32+20+8+16+8+8;f=Ke,u=new Uint8Array([0,0,0,58].concat(Y(St(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),u=Ke("tfhd",u),g=n.data?n.data.baseMediaDecodeTime:0;var v=Math.floor(g%(ns+1));g=new Uint8Array([1,0,0,0].concat(Y(St(Math.floor(g/(ns+1)),4)),Y(St(v,4)))),g=Ke("tfdt",g);var w=y;y=n.data?n.data.zb:[],v=y.length;var A=12+16*v,I=new Uint8Array(A);for(w+=8+A,I.set([n.type==="video"?1:0,0,15,1].concat(Y(St(v,4)),Y(St(w,4))),0),w=0;w<v;w++){var E=y[w];A=St(E.duration,4);var R=St(E.size,4),M=E.flags;E=St(E.sb,4),I.set([].concat(Y(A),Y(R),[M.xb<<2|M.ib,M.mb<<6|M.jb<<4|M.yb,M.hb&61440,M.hb&15],Y(E)),12+16*w)}y=Ke("trun",I),l=f("traf",u,g,y,l),s=s("moof",o,l),i.call(r,t,[s,LC(n)])}return Lt.apply(un,Y(t))}function LC(e){return e=(e.data?e.data.zb:[]).map(function(t){return t.data}),e=Lt.apply(un,Y(e)),Ke("mdat",e)}function St(e,t){var n=[];for(--t;t>=0;t--)n.push(e>>8*t&255);return n}function V0(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[n*2]+e[n*2+1]),16);return t}function H0(e){for(var t=0,n=0;n<e.length;n+=1)t|=e.charCodeAt(n)<<(e.length-n-1)*8;return t}function Ke(e){var t=Rt.apply(1,arguments),n=G0.get(e);n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],G0.set(e,n));for(var r=8,i=t.length-1;i>=0;i--)r+=t[i].byteLength;for(i=new Uint8Array(r),i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(n,4),n=0,r=8;n<t.length;n++)i.set(t[n],r),r+=t[n].byteLength;return i}var ns=4294967295,G0=new Map,bC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0])}),NC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),OC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),UC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),jC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),BC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])}),FC=new vt(function(){return new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}),VC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,0])}),HC=new vt(function(){return new Uint8Array([0,0,0,0,0,0,0,1])}),GC=new vt(function(){var e=new Uint8Array([105,115,111,109]),t=new Uint8Array([97,118,99,49]),n=new Uint8Array([0,0,0,1]);return Ke("ftyp",e,n,e,t)}),X0=new vt(function(){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);return e=Ke("dref",e),Ke("dinf",e)});function XC(e){e=Le(e);var t=null;return new ut().box("moov",Ue).box("trak",Ue).box("mdia",Ue).box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("enca",function(n){return t=n.reader.h,hc(n)}).box("sinf",Ue).box("frma",function(n){n.parser.stop(),Zh(n.reader).codec==="ec-3"&&t&&t.getUint16(16)!==2&&t.setUint16(16,2)}).parse(e),e}function zC(e,t,n){function r(w){y.push({box:w,Ci:1701733217})}function i(w){y.push({box:w,Ci:1701733238})}function s(w){l=!0,w.parser.stop()}function o(w){g.push(w),Ue(w)}var u=t=Le(t),l=!1,f,g=[],y=[];if(new ut().box("moov",o).box("trak",o).box("mdia",o).box("minf",o).box("stbl",o).S("stsd",function(w){f=w,g.push(w),Ii(w)}).S("encv",s).S("enca",s).S("dvav",i).S("dva1",i).S("dvh1",i).S("dvhe",i).S("dvc1",i).S("dvi1",i).S("hev1",i).S("hvc1",i).S("avc1",i).S("avc3",i).S("ac-3",r).S("ec-3",r).S("ac-4",r).S("Opus",r).S("fLaC",r).S("mp4a",r).parse(t),l)return t;if(y.length==0||!f)throw gi(t),new H(2,3,3019,n);y.reverse(),n=x(y);for(var v=n.next();!v.done;v=n.next())v=v.value,u=$C(e,u,f,v.box,g,v.Ci);return je().hh()?(e=new Uint8Array(t.byteLength+u.byteLength),e.set(u),e.set(t,u.byteLength),e):u}function WC(e){e=Le(e);var t=[];new ut().box("mdat",function(o){t.push(o)}).parse(e);for(var n=[],r=0;r<t.length;r++){var i=t[r-1],s=t[r];n.push(KC(e.subarray(i?i.start+i.size:0,s.start+s.size)))}return Lt.apply(un,Y(n))}function KC(e){function t(y){o.push(y),Ue(y)}var n,r,i,s,o=[];if(new ut().box("moof",t).box("traf",t).S("tfhd",function(y){n=y,i=yc(y.reader,y.flags)}).S("trun",function(y){r=y,s=Tc(y.reader,y.version,y.flags)}).parse(e),i&&i.Pi!==2){var u=n.start+ts(n)+4+(i.pj!==null?8:0),l=Ln(e);if(i.Pi!==null)l.setUint32(u,2);else{wc(e,n.start,n.size+4);var f=l.getUint32(n.start+8);l.setUint32(n.start+8,f|2),s&&s.pg!==null&&l.setInt32(r.start+ts(r)+4,s.pg+4),f=e.subarray(0,u),l=e.subarray(u),e=new Uint8Array(e.byteLength+4),e.set(f),f=[];for(var g=3;g>=0;g--)f.push(2>>8*g&255);for(e.set(new Uint8Array(f),u),e.set(l,u+4),u=x(o),l=u.next();!l.done;l=u.next())l=l.value,wc(e,l.start,l.size+4)}}return e}function $C(e,t,n,r,i,s){var o=js(e,r.name),u=t.subarray(r.start,r.start+r.size);for(e=new Uint8Array(r.size+o.byteLength),e.set(u,0),Ln(e).setUint32(4,s),e.set(o,r.size),wc(e,0,e.byteLength),s=new Uint8Array(t.byteLength+e.byteLength),r=je().hf()?r.start:r.start+r.size,o=t.subarray(r),s.set(t.subarray(0,r)),s.set(e,r),s.set(o,r+e.byteLength),t=x(i),i=t.next();!i.done;i=t.next())i=i.value,wc(s,i.start,i.size+e.byteLength);return e=Ln(s,n.start),n=ts(n),t=e.getUint32(n),e.setUint32(n,t+1),s}function wc(e,t,n){e=Ln(e,t),t=e.getUint32(0),t!=0&&(t==1?(e.setUint32(8,n>>32),e.setUint32(12,n&4294967295)):e.setUint32(0,n))}function YC(e){function t(i){r.push({start:i.start,size:i.size}),Ue(i)}var n=Le(e),r=[];return new ut().box("moov",t).box("trak",t).box("mdia",t).box("minf",t).box("stbl",t).box("stsd",function(i){r.push({start:i.start,size:i.size});for(var s=Ln(n,i.start),o=0;o<i.size-3;o++){var u=s.getUint32(o);u==1633889587?s.setUint32(o,1700998451):u==1684103987&&s.setUint32(o,1684366131)}}).parse(n),n}function On(e,t,n,r,i,s,o,u){this.P=e,this.startByte=t,this.endByte=n,this.xd=r===void 0?null:r,this.timescale=i===void 0?null:i,this.h=s===void 0?null:s,this.aesKey=o===void 0?null:o,this.g=this.mimeType=this.codecs=null,this.encrypted=u===void 0?!1:u}On.prototype.Jc=function(){return this.startByte},On.prototype.Hc=function(){return this.endByte},On.prototype.se=function(e){this.h=e},On.prototype.ac=function(){return this.h};function iu(e,t){return e===t?!0:e&&t?e.Jc()==t.Jc()&&e.Hc()==t.Hc()&&Wi(e.P().sort(),t.P().sort())&&hi(e.ac(),t.ac()):e==t}de("shaka.media.InitSegmentReference",On),On.prototype.getEndByte=On.prototype.Hc,On.prototype.getStartByte=On.prototype.Jc;function Ce(e,t,n,r,i,s,o,u,l,f,g,y,v,w,A,I){for(f=f===void 0?[]:f,w=w===void 0?Ci:w,this.startTime=e,this.j=this.endTime=t,this.C=n,this.startByte=r,this.endByte=i,this.ea=s,this.timestampOffset=o,this.appendWindowStart=u,this.appendWindowEnd=l,this.g=f,this.tilesLayout=g===void 0?"":g,this.B=y===void 0?null:y,this.h=v===void 0?null:v,this.status=w,this.preload=!1,this.l=!0,this.o=!1,this.aesKey=A===void 0?null:A,this.thumbnailSprite=null,this.i=-1,this.m=I===void 0?!1:I,this.ie=this.Xc=!1,e=x(this.g),t=e.next();!t.done;t=e.next())t.value.xi();this.m&&this.g.length&&this.g[this.g.length-1].wi(),this.u=this.bandwidth=this.mimeType=this.codecs=null,this.F=!1}p=Ce.prototype,p.P=function(){return this.C()},p.getStartTime=function(){return this.startTime},p.Ij=function(){return this.endTime},p.Jc=function(){return this.startByte},p.Hc=function(){return this.endByte};function ep(e){if(e.endByte)return e.endByte+1-e.startByte;if(e.bandwidth){var t=e.bandwidth*(e.endTime-e.startTime);if(!isNaN(t)&&t>0)return t}if(e.g.length>0&&e.m)for(e=x(e.g),e=e.next();!e.done;e=e.next()){ep(e.value);break}return null}p.ck=function(){return this.tilesLayout},p.bk=function(){return this.B},p.Kc=function(){return this.status},p.yk=function(){this.status=W0},p.Tg=function(){this.preload=!0},p.isPreload=function(){return this.preload},p.wd=function(){this.l=!1},p.nk=function(){return this.l},p.xi=function(){this.Xc=!0},p.qk=function(){return this.Xc},p.wi=function(){this.ie=!0},p.pk=function(){return this.ie},p.ui=function(){this.o=!0},p.ik=function(){return this.o},p.Lf=function(e){this.thumbnailSprite=e},p.Zj=function(){return this.thumbnailSprite},p.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=x(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.startTime+=e,n.endTime+=e,n.j+=e},p.Ch=function(e){this.h==null?yn("Sync attempted without sync time!"):(e=this.h-e-this.startTime,Math.abs(e)>=.001&&this.offset(e))},p.se=function(e,t){this.u=e,this.F=t===void 0?!1:t},p.ac=function(e){var t=this.u;return(e===void 0||e)&&this.F&&(this.u=null),t};function z0(e,t){e.ea=t,e=x(e.g);for(var n=e.next();!n.done;n=e.next())z0(n.value,t)}de("shaka.media.SegmentReference",Ce),Ce.prototype.getSegmentData=Ce.prototype.ac,Ce.prototype.setSegmentData=Ce.prototype.se,Ce.prototype.syncAgainst=Ce.prototype.Ch,Ce.prototype.offset=Ce.prototype.offset,Ce.prototype.getThumbnailSprite=Ce.prototype.Zj,Ce.prototype.setThumbnailSprite=Ce.prototype.Lf,Ce.prototype.hasByterangeOptimization=Ce.prototype.ik,Ce.prototype.markAsByterangeOptimization=Ce.prototype.ui,Ce.prototype.isLastPartial=Ce.prototype.pk,Ce.prototype.markAsLastPartial=Ce.prototype.wi,Ce.prototype.isPartial=Ce.prototype.qk,Ce.prototype.markAsPartial=Ce.prototype.xi,Ce.prototype.isIndependent=Ce.prototype.nk,Ce.prototype.markAsNonIndependent=Ce.prototype.wd,Ce.prototype.isPreload=Ce.prototype.isPreload,Ce.prototype.markAsPreload=Ce.prototype.Tg,Ce.prototype.markAsUnavailable=Ce.prototype.yk,Ce.prototype.getStatus=Ce.prototype.Kc,Ce.prototype.getTileDuration=Ce.prototype.bk,Ce.prototype.getTilesLayout=Ce.prototype.ck,Ce.prototype.getEndByte=Ce.prototype.Hc,Ce.prototype.getStartByte=Ce.prototype.Jc,Ce.prototype.getEndTime=Ce.prototype.Ij,Ce.prototype.getStartTime=Ce.prototype.getStartTime,Ce.prototype.getUris=Ce.prototype.P;var Ci=0,W0=1;Ce.Status={rl:Ci,ym:W0,Ul:2};function su(e){return e.length==1&&e.end(0)-e.start(0)<1e-4}function K0(e){return!e||su(e)?null:e.length==1&&e.start(0)<0?0:e.length?e.start(0):null}function Sc(e){return!e||su(e)?null:e.length?e.end(e.length-1):null}function tp(e,t){return!e||!e.length||su(e)||t>e.end(e.length-1)?!1:t>=e.start(0)}function $0(e,t){if(!e||!e.length||su(e))return 0;var n=0;e=x(Mi(e));for(var r=e.next();!r.done;r=e.next()){var i=r.value;r=i.start,i=i.end,i>t&&(n+=i-Math.max(r,t))}return n}function qC(e,t,n){return!e||!e.length||su(e)?null:(e=Mi(e).findIndex(function(r,i,s){return r.start>t&&(i==0||s[i-1].end-t<=n)}),e>=0?e:null)}function Mi(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function np(){}function Y0(e,t){var n=document.createElement("source");return n.src=e,n.type=t===void 0?"":t,n}function Ac(e){for(var t=!1,n=e.getElementsByTagName("source"),r=n.length-1;r>=0;--r)e.removeChild(n[r]),t=!0;return e.src&&(e.removeAttribute("src"),t=!0),t}function ou(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Bs(){return Io||(rp||(rp=new Ve(function(){Io=null})),(Io=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Io=document.createElement("video")),rp.ka(1),Io)}function QC(e,t){var n,r,i,s,o;return F(function(u){if(u.g==1)return"fonts"in document&&"FontFace"in m?C(u,document.fonts.ready,2):u.return();if(!("entries"in document.fonts))return u.return();for(n=function(l){l=l.entries();for(var f=[],g=l.next();g.done===!1;)f.push(g.value),g=l.next();return f},r=x(n(document.fonts)),i=r.next();!i.done;i=r.next())if(s=i.value,s.family===e&&s.display==="swap")return u.return();o=new FontFace(e,"url("+t+")",{display:"swap"}),document.fonts.add(o),ie(u)})}de("shaka.util.Dom",np),np.removeAllChildren=ou,np.clearSourceFromVideo=Ac;var rp=null,Io=null;/*
 @license
 Shaka Player
 Copyright 2022 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function ip(){}function q0(e,t){return t+10<=e.length&&e[t]===73&&e[t+1]===68&&e[t+2]===51&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Q0(e,t){return t+10<=e.length&&e[t]===51&&e[t+1]===68&&e[t+2]===73&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function sp(e,t){var n=(e[t]&127)<<21;return n|=(e[t+1]&127)<<14,n|=(e[t+2]&127)<<7,n|=e[t+3]&127}function JC(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(e.type==="APIC"){if(e.size<2||e.data[0]!==3)return null;var n=e.data.subarray(1).indexOf(0);if(n===-1)return null;var r=wt(Le(e.data,1,n)),i=e.data[2+n],s=e.data.subarray(3+n).indexOf(0);if(s===-1)return null;var o=wt(Le(e.data,3+n,s)),u;return r==="-->"?u=wt(Le(e.data,4+n+s)):u=vr(e.data.subarray(4+n+s)),t.mimeType=r,t.pictureType=i,t.description=o,t.data=u,t}return e.type==="TXXX"?e.size<2||e.data[0]!==3||(r=e.data.subarray(1).indexOf(0),r===-1)?null:(n=wt(Le(e.data,1,r)),e=wt(Le(e.data,2+r)).replace(/\0*$/,""),t.description=n,t.data=e,t):e.type==="WXXX"?e.size<2||e.data[0]!==3||(r=e.data.subarray(1).indexOf(0),r===-1)?null:(n=wt(Le(e.data,1,r)),e=wt(Le(e.data,2+r)).replace(/\0*$/,""),t.description=n,t.data=e,t):e.type==="PRIV"?e.size<2||(n=e.data.indexOf(0),n===-1)?null:(n=wt(Le(e.data,0,n)),t.description=n,n=="com.apple.streaming.transportStreamTimestamp"?(n=e.data.subarray(n.length+1),e=n[3]&1,n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=4772185884e-2),t.data=n):(e=vr(e.data.subarray(n.length+1)),t.data=e),t):e.type[0]==="T"?e.size<2||e.data[0]!==3?null:(e=wt(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):e.type[0]==="W"?(e=wt(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=vr(e.data),t):null}function Fs(e){for(var t=0,n=[];q0(e,t);){var r=sp(e,t+6);for(e[t+5]>>6&1&&(t+=10),t+=10,r=t+r;t+10<r;){var i=e.subarray(t),s=sp(i,4);i={type:String.fromCharCode(i[0],i[1],i[2],i[3]),size:s,data:i.subarray(10,10+s)},(s=JC(i))&&n.push(s),t+=i.size+10}Q0(e,t)&&(t+=10)}return n}function Co(e,t){for(var n=t=t===void 0?0:t,r=0;q0(e,t);)e[t+5]>>6&1&&(r+=10),r+=10,r+=sp(e,t+6),Q0(e,t+10)&&(r+=10),t+=r;return r>0?e.subarray(n,n+r):new Uint8Array([])}de("shaka.util.Id3Utils",ip),ip.getID3Data=Co,ip.getID3Frames=Fs;function J0(e){return new Date(Date.UTC(1900,0,1,0,0,0,0)+e).getTime()}function Ri(e,t){if(this.j=e,t!==void 0&&t){t=new Uint8Array(e.byteLength);for(var n=0,r=0;r<e.byteLength;r++)r>=2&&e[r]==3&&e[r-1]==0&&e[r-2]==0||(t[n]=e[r],n++);this.j=Le(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function op(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),r=Math.min(4,e.i);r!==0&&(n.set(e.j.subarray(t,t+r)),e.h=new pt(n,0).U(),e.g=r*8,e.i-=r)}function qn(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=n*8,e.g-=n,op(e)}e.h<<=t,e.g-=t}function Xe(e,t){var n=Math.min(e.g,t),r=e.h>>>32-n;return e.g-=n,e.g>0?e.h<<=n:e.i>0&&op(e),n=t-n,n>0?r<<n|Xe(e,n):r}function ap(e){var t;for(t=0;t<e.g;++t)if((e.h&2147483648>>>t)!==0)return e.h<<=t,e.g-=t,t;return op(e),t+ap(e)}function on(e){qn(e,1+ap(e))}function Te(e){var t=ap(e);return Xe(e,t+1)-1}function Mo(e){return e=Te(e),1&e?1+e>>>1:-1*(e>>>1)}function Ee(e){return Xe(e,1)===1}function nt(e){return Xe(e,8)}function Ec(e,t){for(var n=8,r=8,i=0;i<t;i++)r!==0&&(r=Mo(e),r=(n+r+256)%256),n=r===0?n:r}function ZC(e){return nt(e),Te(e),Te(e)}de("shaka.util.ExpGolomb",Ri);function ft(){this.I=null,this.J=!1,this.m=this.K=null,this.j=[],this.g=[],this.C=this.F=null,this.i=[],this.h=[],this.G=null,this.l=[],this.B=this.H=this.o=this.u=null}p=ft.prototype,p.clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},p.Jf=function(e){this.B!=null&&this.B!=e&&(this.o=this.u=null),this.B=e},p.parse=function(e){if(e.length<564)return this;for(var t=Math.max(0,lp(e)),n=e.length-(e.length+t)%188,r=!1,i=t;i<n;i+=188)if(e[i]==71){var s=!!(e[i+1]&64),o=((e[i+1]&31)<<8)+e[i+2];if((e[i+3]&48)>>4>1){var u=i+5+e[i+4];if(u==i+188)continue}else u=i+4;switch(o){case 0:s&&(u+=e[u]+1),this.I=(e[u+10]&31)<<8|e[u+11];break;case 17:case 8191:break;case this.I:s&&(u+=e[u]+1),s=e,o={audio:-1,video:-1,ef:-1,audioCodec:"",videoCodec:""};var l=u+3+((s[u+1]&15)<<8|s[u+2])-4;for(u+=12+((s[u+10]&15)<<8|s[u+11]);u<l;){var f=(s[u+1]&31)<<8|s[u+2],g=(s[u+3]&15)<<8|s[u+4];switch(s[u]){case 6:if(g>0)for(var y=u+5,v=g;v>2;){var w=s[y+1]+2;switch(s[y]){case 5:var A=wh(s.subarray(y+2,y+w));o.audio==-1&&A==="Opus"?(o.audio=f,o.audioCodec="opus"):o.video==-1&&A==="AV01"&&(o.video=f,o.videoCodec="av1");break;case 106:o.audio==-1&&(o.audio=f,o.audioCodec="ac3");break;case 122:o.audio==-1&&(o.audio=f,o.audioCodec="ec3");break;case 124:o.audio==-1&&(o.audio=f,o.audioCodec="aac");break;case 127:o.audioCodec=="opus"&&(A=null,s[y+2]===128&&(A=s[y+3]),A!=null&&(this.H={channelCount:(A&15)===0?2:A&15,sj:A,sampleRate:48e3}))}y+=w,v-=w}break;case 15:o.audio==-1&&(o.audio=f,o.audioCodec="aac");break;case 17:o.audio==-1&&(o.audio=f,o.audioCodec="aac-loas");break;case 21:o.ef==-1&&(o.ef=f);break;case 27:o.video==-1&&(o.video=f,o.videoCodec="avc");break;case 3:case 4:o.audio==-1&&(o.audio=f,o.audioCodec="mp3");break;case 36:o.video==-1&&(o.video=f,o.videoCodec="hvc");break;case 129:o.audio==-1&&(o.audio=f,o.audioCodec="ac3");break;case 132:case 135:o.audio==-1&&(o.audio=f,o.audioCodec="ec3")}u+=g+5}s=o,s.video!=-1&&(this.K=s.video,this.m=s.videoCodec),s.audio!=-1&&(this.F=s.audio,this.C=s.audioCodec),s.ef!=-1&&(this.G=s.ef),r&&!this.J&&(r=!1,i=t-188),this.J=!0;break;case this.K:u=e.subarray(u,i+188),s?this.j.push([u]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(u);break;case this.F:u=e.subarray(u,i+188),s?this.i.push([u]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(u);break;case this.G:u=e.subarray(u,i+188),s?this.l.push([u]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(u);break;default:r=!0}}return this};function up(e,t){if((t[0]<<16|t[1]<<8|t[2])!==1)return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var r=t[7];if(r&192){var i=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2;e.u==null&&(e.u=i),n.pts=ex(i,e.u),e.u=n.pts,n.dts=n.pts,r&64&&(r=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,e.o==null&&(e.o=r),n.dts=n.pts!=i?ex(r,e.o):r),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}p.Fk=function(e){return qe("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Zg(e,{ke:null,state:null})},p.Zg=function(e,t){var n=e.pts?e.pts/9e4:null;e=e.data;var r=e.byteLength,i=1;this.m=="hvc"&&(i=2);var s=t.state||0,o=s,u=0,l=[],f=-1,g=0;for(s==-1&&(f=0,g=this.m=="hvc"?e[0]>>1&63:e[0]&31,s=0,u=1);u<r;){var y=e[u++];s?s===1?s=y?0:2:y?y==1?(y=u-s-1,f>=0?l.push({data:e.subarray(f+i,y),fullData:e.subarray(f,y),type:g,time:n,state:null}):(s=l.length?l[l.length-1]:t.ke)&&(o&&u<=4-o&&s.state&&(s.data=s.data.subarray(0,s.data.byteLength-o),s.fullData=s.fullData.subarray(0,s.fullData.byteLength-o)),y>0&&(y=e.subarray(0,y),s.data=Lt(s.data,y),s.fullData=Lt(s.fullData,y),s.state=0)),u<r?(g=this.m=="hvc"?e[u]>>1&63:e[u]&31,f=u,s=0):s=-1):s=0:s=3:s=y?0:1}return f>=0&&s>=0&&l.push({data:e.subarray(f+i,r),fullData:e.subarray(f,r),type:g,time:n,state:s}),!l.length&&t.ke&&(n=l.length?l[l.length-1]:t.ke)&&(n.data=Lt(n.data,e),n.fullData=Lt(n.fullData,e)),t.state=s,l},p.getMetadata=function(){for(var e=[],t=x(this.l),n=t.next();!n.done;n=t.next())n=Lt.apply(un,Y(n.value)),(n=up(this,n))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:Fs(n.data),dts:n.dts,pts:n.pts});return e},p.ub=function(){if(this.i.length&&!this.h.length)for(var e=x(this.i),t=e.next();!t.done;t=e.next()){var n=Lt.apply(un,Y(t.value)),r=up(this,n);t=this.h.length?this.h[this.h.length-1]:null,r&&r.pts!=null&&r.dts!=null&&(!t||t.pts!=r.pts&&t.dts!=r.dts)?this.h.push(r):this.h.length&&(n=r?r.data:n)&&(t=this.h.pop(),t.data=Lt(t.data,n),this.h.push(t))}return this.h},p.ud=function(e){if(e=e===void 0?!0:e,this.j.length&&!this.g.length){for(var t=x(this.j),n=t.next();!n.done;n=t.next()){var r=Lt.apply(un,Y(n.value)),i=up(this,r);n=this.g.length?this.g[this.g.length-1]:null,i&&i.pts!=null&&i.dts!=null&&(!n||n.pts!=i.pts&&n.dts!=i.dts)?this.g.push(i):this.g.length&&(r=i?i.data:r)&&(n=this.g.pop(),n.data=Lt(n.data,r),this.g.push(n))}if(e){for(t={ke:null,state:null},n=[],r=x(this.g),i=r.next();!i.done;i=r.next())i=i.value,i.nalus=this.Zg(i,t),i.nalus.length&&(n.push(i),t.ke=i.nalus[i.nalus.length-1]);this.g=n}}return e?this.g:(e=this.g,this.g=[],e)},p.getStartTime=function(e){if(e=="audio"){e=null;var t=this.ub();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return e=="video"?(e=null,t=this.ud(!1),t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},p.Xd=function(){return{audio:this.C,video:this.m}},p.df=function(){for(var e=[],t=x(this.ud()),n=t.next();!n.done;n=t.next())e.push.apply(e,Y(n.value.nalus));return e},p.fk=function(){qe("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Mg();return{height:e.height,width:e.width}},p.Mg=function(){return this.m=="hvc"?tM(this):eM(this)};function Z0(e){var t=e.ud();return t.length>1&&(e=t[0].pts,t=t[1].pts,!isNaN(t-e))?String(Math.abs(1/(t-e)*9e4)):null}function eM(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.df();if(!n.length||(n=n.find(function(w){return w.type==7}),!n))return t;n=new Ri(n.data);var r=nt(n),i=nt(n),s=nt(n);if(on(n),nM.includes(r)){var o=Te(n);if(o===3&&qn(n,1),on(n),on(n),qn(n,1),Ee(n)){o=o!==3?8:12;for(var u=0;u<o;u++)Ee(n)&&(u<6?Ec(n,16):Ec(n,64))}}if(on(n),o=Te(n),o===0)Te(n);else if(o===1)for(qn(n,1),on(n),on(n),o=Te(n),u=0;u<o;u++)on(n);on(n),qn(n,1),o=Te(n),u=Te(n);var l=Xe(n,1);l===0&&qn(n,1),qn(n,1);var f=0,g=0,y=0,v=0;return Ee(n)&&(f=Te(n),g=Te(n),y=Te(n),v=Te(n)),t.height=String((2-l)*(u+1)*16-y*2-v*2),t.width=String((o+1)*16-f*2-g*2),t.codec="avc1."+("0"+r.toString(16).toUpperCase()).slice(-2)+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+s.toString(16).toUpperCase()).slice(-2),t.frameRate=Z0(e),t}function tM(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.df();if(!n.length||(n=n.find(function(X){return X.type==33}),!n))return t;var r=new Ri(n.fullData,!0);nt(r),nt(r),Xe(r,4);var i=Xe(r,3);Ee(r);var s=Xe(r,2),o=Xe(r,1),u=Xe(r,5),l=Xe(r,32);n=nt(r);for(var f=nt(r),g=nt(r),y=nt(r),v=nt(r),w=nt(r),A=nt(r),I=[],E=[],R=0;R<i;R++)I.push(Ee(r)),E.push(Ee(r));if(i>0)for(R=i;R<8;R++)Xe(r,2);for(R=0;R<i;R++)I[R]&&Xe(r,88),E[R]&&nt(r);Te(r),i=Te(r),i==3&&Xe(r,1),I=Te(r),E=Te(r);var M=R=0,D=0,O=0;return Ee(r)&&(R+=Te(r),M+=Te(r),D+=Te(r),O+=Te(r)),t.width=String(I-(R+M)*(i===1||i===2?2:1)),t.height=String(E-(D+O)*(i===1?2:1)),r=(function(X){for(var b=0,U=0;U<32;U++)b|=(X>>U&1)<<31-U;return b>>>0})(l),o=o==1?"H":"L",s="hvc1"+("."+["","A","B","C"][s]+u),s+="."+r.toString(16).toUpperCase(),s+="."+o+A,w&&(s+="."+w.toString(16).toUpperCase()),v&&(s+="."+v.toString(16).toUpperCase()),y&&(s+="."+y.toString(16).toUpperCase()),g&&(s+="."+g.toString(16).toUpperCase()),f&&(s+="."+f.toString(16).toUpperCase()),n&&(s+="."+n.toString(16).toUpperCase()),t.codec=s,t.frameRate=Z0(e),t}function ex(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=n*8589934592;return e}function Ro(e){return!(lp(e)<0)}function lp(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(e[n]==71&&e[n+188]==71&&e[n+376]==71)return n;n++}return-1}de("shaka.util.TsParser",ft),ft.syncOffset=lp,ft.probe=Ro,ft.prototype.getVideoInfo=ft.prototype.Mg,ft.prototype.getVideoResolution=ft.prototype.fk,ft.prototype.getVideoNalus=ft.prototype.df,ft.prototype.getCodecs=ft.prototype.Xd,ft.prototype.getStartTime=ft.prototype.getStartTime,ft.prototype.getVideoData=ft.prototype.ud,ft.prototype.getAudioData=ft.prototype.ub,ft.prototype.getMetadata=ft.prototype.getMetadata,ft.prototype.parseNalus=ft.prototype.Zg,ft.prototype.parseAvcNalus=ft.prototype.Fk,ft.prototype.parse=ft.prototype.parse,ft.prototype.setDiscontinuitySequence=ft.prototype.Jf,ft.prototype.clearData=ft.prototype.clearData,ft.Timescale=9e4;var nM=[100,110,122,244,44,83,86,118,128,138,139,134];function tx(e,t,n,r,i){var s=this;this.g=e,this.O=n,this.B=r,this.ba=t,this.l=new Map,this.G=new Map,this.Ta=new Map,this.h=null,this.Fa=!1,this.C=i||null,this.o=new Map,this.u=new et,this.j=new Map,this.K=null,this.M=new at,this.Da="",this.ob=!1,this.za=!0,this.N=!1,this.F=this.R=null,this.i=cp(this,this.M),this.Ua=this.H=!1,this.I=new To(function(){return sM(s)}),this.J=!1,this.X="UNKNOWN",this.eb=this.kb=!1,this.ab=new at,this.m=!1,this.ya=null,this.$=new Map,this.oa=this.T=this.va=this.V=null,this.ma=new at,this.g.remote&&(this.N=this.g.remote.state!="disconnected",this.u.D(this.g.remote,"connect",function(){s.N=s.g.remote.state!="disconnected"}),this.u.D(this.g.remote,"connecting",function(){s.N=s.g.remote.state!="disconnected"}),this.u.D(this.g.remote,"disconnect",function(){s.N=s.g.remote.state!="disconnected"}))}function cp(e,t){if(e.za=!0,m.ManagedMediaSource){e.F||(e.g.disableRemotePlayback=!0);var n=new ManagedMediaSource;e.u.D(n,"startstreaming",function(){e.za=!0}),e.u.D(n,"endstreaming",function(){e.za=!1})}else n=new MediaSource;return e.u.Aa(n,"sourceopen",function(){URL.revokeObjectURL(e.Da),t.resolve()}),e.u.Aa(e.g,"playing",function(){e.ob=!0}),e.Da=pp(n),e.B.useSourceElements?(e.g.removeAttribute("src"),e.R&&e.g.removeChild(e.R),e.F&&e.g.removeChild(e.F),e.R=Y0(e.Da),e.g.appendChild(e.R),e.F&&e.g.appendChild(e.F),e.g.load()):e.g.src=e.Da,n}function rM(e,t,n){e.g&&m.ManagedMediaSource&&e.i&&e.B.useSourceElements&&(e.F&&e.g.removeChild(e.F),e.F=Y0(t,n),e.g.appendChild(e.F),e.g.disableRemotePlayback=!1)}function iM(){var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.20000000.L153.B0",video/mp4; codecs="hvc1.2.4.L120.b0",video/mp4; codecs="hvc1.2.4.L123.b0",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.08.01",video/mp4; codecs="dav1.10.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",audio/mp4; codecs="apac.31.00",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(Y(wi)),t={};je(),e=x(e);for(var n=e.next();!n.done;n=e.next()){if(n=n.value,Wa(n))t[n]=!0;else if(oi()){var r=Kn(n),i=qa(Nn(n),r);r=Ct(r,i),t[n]=vn(r)||!!go(r)}else t[n]=Bs().canPlayType(n)!="";r=n.split(";")[0],t[r]=t[r]||t[n]}return t}p=tx.prototype,p.destroy=function(){return this.I.destroy()};function sM(e){var t,n,r,i,s,o,u,l,f,g,y,v,w,A,I;return F(function(E){if(E.g==1){for(t=[],n=x(e.o),r=n.next();!r.done;r=n.next())for(i=r.value,s=x(i),o=s.next().value,u=s.next().value,l=u[0],f=o,e.o.set(f,u.slice(0,1)),l&&t.push(l.p.catch(z2)),g=x(u.slice(1)),y=g.next();!y.done;y=g.next())v=y.value,v.p.reject(new H(2,7,7003,void 0));return e.h&&t.push(e.h.destroy()),C(E,Promise.all(t),2)}for(w=x(e.j.values()),A=w.next();!A.done;A=w.next())I=A.value,I.destroy();e.u&&(e.u.release(),e.u=null),e.g&&e.F&&e.g.removeChild(e.F),e.g&&e.R&&(e.g.removeChild(e.R),e.g.load(),e.g.disableRemotePlayback=!1),e.g=null,e.R=null,e.F=null,e.B=null,e.i=null,e.h=null,e.ba=null,e.l.clear(),e.Ta.clear(),e.j.clear(),e.K=null,e.o.clear(),e.C=null,e.$.clear(),e.O=null,ie(E)})}p.init=function(e,t,n,r){t=t===void 0?!1:t,n=n===void 0?"UNKNOWN":n,r=r===void 0?!1:r;var i=this,s,o,u,l,f,g;return F(function(y){if(y.g==1)return s=bt,C(y,i.M,2);if(y.g!=3)return!Vs(i)&&!rs(i)?y.A(3):(yn("Expected MediaSource to be open during init(); reopening the media source."),i.M=new at,i.i=cp(i,i.M),C(y,i.M,3));for(i.J=t,i.X=n,i.kb=r,i.eb=!i.J&&i.X=="HLS"&&!i.kb,i.$.clear(),i.V=null,i.va=null,i.T=null,i.oa=null,i.ma=new at,o=x(e.keys()),u=o.next();!u.done;u=o.next())l=u.value,f=e.get(l),Ic(i,l,f,f.codecs),i.m?(i.o.set(s.aa,[]),i.o.set(s.wa,[])):i.o.set(l,[]);(g=e.get(s.aa))&&g.isAudioMuxedInVideo&&(i.m=!0),ie(y)})};function Ic(e,t,n,r){t=="audio"&&r&&(r=qa(r,n.mimeType));var i=Ct(n.mimeType,r);if(t==Fe)Cc(e,i,e.J,n.external);else{var s=e.B.forceTransmux;(!vn(i)||!e.J&&wi.includes(i))&&(s=!0);var o=Zl(n.mimeType,r);if(s){if(s=bn("audio",(r||"").split(",")),r=bn("video",(r||"").split(",")),s&&r){e.m=!0,Ic(e,"audio",n,s),Ic(e,"video",n,r);return}(r=go(o))&&(i=r(),e.j.set(t,i),i=i.convertCodecs(t,o))}o=i+e.B.addExtraFeaturesToSourceBuffer(i),dt(e.I);try{var u=e.i.addSourceBuffer(o)}catch(l){throw new H(2,3,3015,l,"The mediaSource_ status was "+e.i.readyState+" expected 'open'",null)}e.J&&(u.mode=vM),e.u.D(u,"error",function(){var l=e.o.get(t)[0];l.p.reject(new H(2,3,3014,e.g.error?e.g.error.code:0,l.uri))}),e.u.D(u,"updateend",function(){return is(e,t)}),e.l.set(t,u),e.G.set(t,i),e.Ta.set(t,!!n.drmInfos.length)}}p.configure=function(e){this.B=e,this.h&&(this.h.B=e.modifyCueCallback)};function nx(e){return e.za&&!e.N&&!e.H}function Cc(e,t,n,r){e.h||(e.h=new Si(e.ba),e.h&&(e.h.B=e.B.modifyCueCallback));var i=e.h;r=r||e.Fa,e=e.X,t=="application/cea-608"||t=="application/cea-708"?i.i=null:(i.i=Ka.get(t)(),i.i.setSequenceMode?i.i.setSequenceMode(n):qe("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),i.i.setManifestType?i.i.setManifestType(e):qe("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),i.C=r)}function Vs(e){return e.H?!1:e.i?e.i.readyState=="ended":!0}function rs(e){return e.H?!1:e.i?e.i.readyState=="closed":!0}function dp(e,t){return e.l.size?t==Fe?e.h.g:K0(ko(e,t)):null}function Hs(e,t){return e.l.size?t==Fe?e.h.h:Sc(ko(e,t)):null}function oM(e,t,n){return t==Fe?(e=e.h,e.h==null||e.h<n?0:e.h-Math.max(n,e.g)):(e=ko(e,t),$0(e,n))}p.Gc=function(){var e={total:this.H?[]:Mi(this.g.buffered),audio:Mi(ko(this,"audio")),video:Mi(ko(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;t!=null&&n!=null&&e.text.push({start:t,end:n})}return e};function ko(e,t){if(e.H||e.N||rs(e))return null;try{return e.l.get(t).buffered}catch(n){return e.l.has(t),null}}function aM(e,t,n,r,i,s,o){o=o===void 0?!1:o;var u=null,l=[],f=Le(n);if(wi.includes(s))n=Fs(f),n.length&&r&&((o=n.find(function(A){return A.description==="com.apple.streaming.transportStreamTimestamp"}))&&typeof o.data=="number"&&(u=Math.round(o.data)/1e3),e.O.onMetadata([{cueTime:r.startTime,data:f,frames:n,dts:r.startTime,pts:r.startTime}],0,r.endTime));else if(s.includes("/mp4")&&r&&r.ea){f=new ut;var g=i.emsgSchemeIdUris!=null&&i.emsgSchemeIdUris.length>0||e.B.dispatchAllEmsgBoxes;g&&f.S("emsg",function(A){var I=i.emsgSchemeIdUris;if(A.version===0)var E=A.reader.Yc(),R=A.reader.Yc(),M=A.reader.U(),D=A.reader.U(),O=A.reader.U(),X=A.reader.U(),b=r.startTime+D/M;else M=A.reader.U(),b=A.reader.Ed()/M+r.timestampOffset,D=b-r.startTime,O=A.reader.U(),X=A.reader.U(),E=A.reader.Yc(),R=A.reader.Yc();A=A.reader.Ub(A.reader.getLength()-A.reader.Pa(),!0),(I&&I.includes(E)||e.B.dispatchAllEmsgBoxes)&&(E=="urn:mpeg:dash:event:2012"?e.O.Ek():(I=b+O/M,e.O.Ck({startTime:b,endTime:I,schemeIdUri:E,value:R,timescale:M,presentationTimeDelta:D,eventDuration:O,id:X,messageData:A}),(E=="https://aomedia.org/emsg/ID3"||E=="https://developer.apple.com/streaming/emsg-id3")&&(M=Fs(A),M.length&&e.O.onMetadata([{cueTime:b,data:A,frames:M,dts:b,pts:b}],0,I))))});var y=r.ea.timescale;t=y&&!isNaN(y);var v=0,w=!1;t&&f.S("prft",function(A){var I=A.reader,E=A.version;I.U(),A=I.U();var R=I.U();A=A*1e3+R/4294967296*1e3,E===0?I=I.U():(E=I.U(),I=I.U(),I=E*4294967296+I),A=J0(A),I=new Map().set("detail",{wallClockTime:A,programStartDate:new Date(A-I/y*1e3)}),I=new Se("prft",I),e.O.onEvent(I)}).box("moof",Ue).box("traf",Ue).S("tfdt",function(A){w||(v=vc(A.reader,A.version).baseMediaDecodeTime/y,w=!0,g||A.parser.stop())}),(g||t)&&f.parse(n,!1,o),w&&r.timestampOffset==0&&(u=v)}else s.includes("/mp4")||s.includes("/webm")||!Ro(f)||(e.$.has(t)||e.$.set(t,new ft),l=e.$.get(t),l.clearData(),l.Jf(r.i),l.parse(f),f=l.getStartTime(t),f!=null&&(u=f),l=l.getMetadata());return{timestamp:u,metadata:l}}function Mc(e,t,n,r,i,s,o,u,l,f,g){o=o===void 0?!1:o,u=u===void 0?!1:u,l=l===void 0?!1:l,f=f===void 0?!1:f;var y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne;return F(function($){switch($.g){case 1:if(y=bt,t!=y.Na){$.A(2);break}if(e.X!="HLS"){$.A(3);break}return C($,e.ab,4);case 4:v=$.h,e.h.u=v;case 3:return C($,F2(e.h,n,r?r.startTime:null,r?r.endTime:null,r?r.P()[0]:null),5);case 5:return $.return();case 2:if(f||!e.m){$.A(6);break}return C($,Mc(e,y.aa,n,r,i,s,o,u,l,!0),7);case 7:return C($,Mc(e,y.wa,n,r,i,s,o,u,l,!0),8);case 8:return $.return();case 6:if(!e.l.has(t))return $.return();if(w=e.l.get(t).timestampOffset,A=e.G.get(t),e.j.has(t)&&(A=e.j.get(t).getOriginalMimeType()),r&&(I=aM(e,t,n,r,i,A,l),E=I.timestamp,R=I.metadata,E!=null&&(e.V==null&&t==y.wa&&(e.V=E,e.va=r.startTime,e.T!=null&&(M=0,e.va==e.oa&&(M=e.V-e.T),e.ma.resolve(M))),e.T==null&&t==y.aa&&(e.T=E,e.oa=r.startTime,e.V!=null&&(D=0,e.va==e.oa&&(D=e.V-e.T),e.ma.resolve(D))),O=E,X=wi,!e.J&&X.includes(e.G.get(t))&&(O=0),b=r.startTime-O,U=Math.abs(w-b),(U>=.001||o||u)&&(!l||b>0||!w)&&(w=b,e.eb&&(Ht(e,t,function(){return _o(e,t)},null),Ht(e,t,function(){return Po(e,t,w)},null))),(t==y.wa||!e.l.has(y.wa))&&e.ab.resolve(w)),R.length)&&e.O.onMetadata(R,w,r?r.endTime:null),s&&t==y.wa&&(e.h||Cc(e,"application/cea-608",e.J,!1),e.K||(N=A.split(";",1)[0],e.K=new Wr(N)),r?(z=e.K.zf(n),z.length&&H2(e.h,z,w)):e.K.init(n,u,g)),!e.j.has(t)){$.A(9);break}return C($,e.j.get(t).transmux(n,i,r,e.i.duration,t),10);case 10:B=$.h,ArrayBuffer.isView(B)?n=B:(W=B,W.init!=null&&(G=W.init,Ht(e,t,function(){e.C&&Hl(e.C,G,w,i),e.l.get(t).appendBuffer(G)},r?r.P()[0]:null)),n=W.data);case 9:if(n=hM(e,i,n,r,t),!r||!e.J||t==y.Na){$.A(11);break}if(!o&&!u){$.A(11);break}if(re=r.startTime,e.X!="HLS"||e.m||t!=y.aa||!e.l.has(y.wa)){$.A(13);break}return C($,e.ma,14);case 14:ne=$.h,Math.abs(ne)>.15&&(re-=ne);case 13:Ht(e,t,function(){return _o(e,t)},null),Ht(e,t,function(){return Po(e,t,re)},null);case 11:return C($,Ht(e,t,function(){var Q=n;e.C&&Hl(e.C,Q,w,i),e.l.get(t).appendBuffer(Q)},r?r.P()[0]:null),15);case 15:ie($)}})}function uM(e,t){var n=Hs(e,"video")||0;Gv(e.h,t,n)}function lM(e){e.h&&Gv(e.h,"",0)}p.remove=function(e,t,n,r){var i=this,s,o;return F(function(u){return u.g==1?(s=bt,e==s.wa&&i.K&&(i.K.remove(r),o=i.h.g||0,i.h.remove(o,n,!0)),e==s.Na?C(u,i.h.remove(t,n),0):n>t?C(u,Ht(i,e,function(){return Rc(i,e,t,n)},null),5):u.A(0)):i.m?C(u,Ht(i,s.aa,function(){return Rc(i,s.aa,t,n)},null),0):u.A(0)})};function rx(e,t){var n;return F(function(r){return r.g==1?(n=bt,t==n.Na?e.h?C(r,e.h.remove(0,1/0),0):r.return():t===n.wa&&e.K&&e.h?C(r,e.h.remove(0,1/0,!0),4):r.A(4)):r.g!=6?C(r,Ht(e,t,function(){return Rc(e,t,0,e.i.duration)},null),6):e.m?C(r,Ht(e,n.aa,function(){return Rc(e,n.aa,0,e.i.duration)},null),0):r.A(0)})}p.flush=function(e){var t=this,n;return F(function(r){return r.g==1?(n=bt,e==n.Na?r.return():C(r,Ht(t,e,function(){t.g.currentTime-=.001,is(t,e)},null),2)):t.m?C(r,Ht(t,n.aa,function(){var i=n.aa;t.g.currentTime-=.001,is(t,i)},null),0):r.A(0)})};function ix(e,t,n,r,i,s,o,u,l){var f,g,y;return F(function(v){return v.g==1?(f=bt,t==f.Na?(s||(e.h.u=n),V2(e.h,r,i),v.return()):(g=[],C(v,mM(e,t,o,u,l),2))):(y=v.h,y||(g.push(Ht(e,t,function(){return _o(e,t)},null)),e.m&&g.push(Ht(e,f.aa,function(){return _o(e,f.aa)},null))),s||(g.push(Ht(e,t,function(){return Po(e,t,n)},null)),e.m&&g.push(Ht(e,f.aa,function(){return Po(e,f.aa,n)},null))),(r!=0||i!=1/0)&&(g.push(Ht(e,t,function(){return sx(e,t,r,i)},null)),e.m&&g.push(Ht(e,f.aa,function(){return sx(e,f.aa,r,i)},null))),g.length?C(v,Promise.all(g),0):v.A(0))})}function cM(e,t,n){var r,i;return F(function(s){return s.g==1?(r=bt,t==r.Na||(t==r.wa&&(e.ab=new at),!e.J||(i=Hs(e,t))&&Math.abs(i-n)<.15)?s.return():(Ht(e,t,function(){return _o(e,t)},null),e.m&&Ht(e,r.aa,function(){return _o(e,r.aa)},null),C(s,Ht(e,t,function(){return Po(e,t,n)},null),2))):e.m?C(s,Ht(e,r.aa,function(){return Po(e,r.aa,n)},null),0):s.A(0)})}p.endOfStream=function(e){var t=this;return F(function(n){return C(n,au(t,function(){Vs(t)||rs(t)||(e?t.i.endOfStream(e):t.i.endOfStream())}),0)})},p.Ab=function(e){var t=this;return F(function(n){return C(n,au(t,function(){if(t.B.durationReductionEmitsUpdateEnd&&e<t.i.duration)for(var r=x(t.l.keys()),i=r.next();!i.done;i=r.next()){i=i.value;var s={start:function(){},p:new at,uri:null};t.o.get(i).unshift(s)}t.i.duration=e,t.ya=e}),0)})},p.getDuration=function(){return this.i.duration};function dM(e,t,n){F(function(r){return e.I.g||e.g.error||e.N||e.H||Vs(e)||rs(e)?r.return():C(r,au(e,function(){Vs(e)||rs(e)||e.i.setLiveSeekableRange(t,n)}),0)})}function fp(e){F(function(t){return e.I.g||e.g.error||e.N||e.H||Vs(e)||rs(e)?t.return():C(t,au(e,function(){Vs(e)||rs(e)||e.i.clearLiveSeekableRange()}),0)})}function Rc(e,t,n,r){if(r<=n)is(e,t);else{if(e.C){var i=e.C;t==="video"&&i.g&&i.g.flushBuffer(n,r)}e.l.get(t).remove(n,r)}}function _o(e,t){var n=e.l.get(t),r=n.appendWindowStart,i=n.appendWindowEnd;n.abort(),n.appendWindowStart=r,n.appendWindowEnd=i,is(e,t)}function Po(e,t,n){n<0&&(n+=.001),e.l.get(t).timestampOffset=n,is(e,t)}function sx(e,t,n,r){var i=e.l.get(t);(i.appendWindowEnd!==r||i.appendWindowStart!==n)&&(i.appendWindowStart=0,i.appendWindowEnd=r,i.appendWindowStart=n),is(e,t)}function is(e,t){if(e.H||e.I.g){var n=e.o.get(t);n&&n.length&&((n=n[0])&&n.p&&n.p.resolve(),e.o.set(t,[]))}else(n=e.o.get(t)[0])&&(n.p.resolve(),hp(e,t))}function Ht(e,t,n,r){return dt(e.I),n={start:n,p:new at,uri:r},e.o.get(t).push(n),e.o.get(t).length==1&&ox(e,t),n.p}function au(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A;return F(function(I){switch(I.g){case 1:for(dt(e.I),n=[],r=Array.from(e.l.keys()),i=x(r),s=i.next(),o={};!s.done;o={ready:void 0},s=i.next())u=s.value,o.ready=new at,l={start:(function(E){return function(){return E.ready.resolve()}})(o),p:o.ready,uri:null},f=e.o.get(u),f.push(l),n.push(o.ready),f.length==1&&l.start();return Z(I,2),C(I,Promise.all(n),4);case 4:ce(I,3);break;case 2:throw g=se(I),g;case 3:return Z(I,5,6),C(I,t(),6);case 6:for(ye(I),y=x(r),v=y.next();!v.done;v=y.next())w=v.value,hp(e,w);Oe(I,0);break;case 5:throw A=se(I),new H(2,3,3015,A,e.g.error||"No error in the media element",null)}})}function hp(e,t){e.o.get(t).shift(),ox(e,t)}function ox(e,t){var n=e.o.get(t)[0];if(n)try{n.start()}catch(r){r.name=="QuotaExceededError"?n.p.reject(new H(2,3,3017,t)):nx(e)?n.p.reject(new H(2,3,3015,r,e.g.error||"No error in the media element",n.uri)):n.p.reject(new H(2,3,3024,t)),hp(e,t)}}function fM(e,t){e.ba=t,e.h&&(e.h.l=t)}function hM(e,t,n,r,i){if(Xa(e.G.get(i))!="mp4")return n;var s=r===null,o=e.Ta.get(i),u=e.O.Nj(),l=!1;r&&r.ea&&(l=r.ea.encrypted),r=r?r.P()[0]:null;var f=je();return e.B.correctEc3Enca&&s&&i==="audio"&&(n=XC(n)),e.B.insertFakeEncryptionInInit&&o&&f.Fd(u,i)&&(s?n=zC(t,n,r):!l&&f.Li(i)&&(n=WC(n))),s&&f.re()&&(n=YC(n)),n}function pM(e,t,n,r){return Ht(e,t,function(){if(t!==Fe){if(e.G.get(t),je().Bb()){e.j.has(t)&&(e.j.get(t).destroy(),e.j.delete(t)),r&&e.j.set(t,r);var i=n+e.B.addExtraFeaturesToSourceBuffer(n);e.l.get(t).changeType(i),e.G.set(t,n)}is(e,t)}},null)}function gM(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X;return F(function(b){if(b.g==1){if(e.H||e.N)return b.return();for(n=bt,e.H=!0,e.m=!1,r=e.g.currentTime,i=e.g.autoplay,e.g.paused||(e.Ua=!0),e.ob&&(e.g.autoplay=!1),ge(b,2),e.u.Qa(),s=x(e.j.values()),o=s.next();!o.done;o=s.next())u=o.value,u.destroy();for(l=x(e.l.values()),f=l.next();!f.done;f=l.next()){g=f.value;try{e.i.removeSourceBuffer(g)}catch(U){}}return e.j.clear(),e.l.clear(),y=e.i.duration,e.M=new at,e.i=cp(e,e.M),C(b,e.M,4)}if(b.g!=2){for(!isNaN(y)&&y?e.i.duration=y:!isNaN(e.ya)&&e.ya&&(e.i.duration=e.ya),v=new at,w=e.i.sourceBuffers,A=t.size,I=0,E=function(){I++,I===A&&(v.resolve(),e.u.Ma(w,"addsourcebuffer",E))},e.u.D(w,"addsourcebuffer",E),R=x(t.keys()),M=R.next();!M.done;M=R.next())D=M.value,O=t.get(D),Ic(e,D,O,O.codecs);return(X=t.get(n.aa))&&X.isAudioMuxedInVideo&&(e.m=!0),e.m&&!e.o.has(n.aa)&&e.o.set(n.aa,[]),C(b,v,2)}return ye(b),e.H=!1,dt(e.I),e.u.Aa(e.g,"loadedmetadata",function(){e.I.g||(e.g.currentTime=r)}),e.u.Aa(e.g,"canplaythrough",function(){e.I.g||(e.g.autoplay=i,e.Ua&&(e.Ua=!1,e.g.play()))}),Oe(b,0)})}function ax(e,t){return au(e,function(){return gM(e,t)})}function ux(e,t,n,r){var i=!1,s=bn("audio",(r||"").split(",")),o=bn("video",(r||"").split(",")),u=o;t=="audio"&&(u=s),u||(u=r);var l=Ct(n,u),f=Kn(e.G.get(t)),g=e.B.forceTransmux;if(!vn(l)||!e.J&&wi.includes(l)?g=!0:g||n==f||(g=!je().Mf()&&wi.includes(n)),g&&(e=Zl(n,u),u=go(e))){var y=u();s&&o&&(i=!0),l=y.convertCodecs(t,e)}return!y&&t==="video"&&s&&(l=Ct(n,r)),t=Vt(Nn(l)),{jc:y,hl:i,Rh:Kn(l),codec:t,mimeType:l}}function lx(e,t,n,r,i){if(t==Fe)return{type:gp,vf:n,jc:null};var s=Vt(Nn(e.G.get(t))),o=Kn(e.G.get(t)),u=ux(e,t,n,r),l=u.jc,f=u.hl,g=u.Rh,y=u.codec;u=u.mimeType;var v=!0;return f&&e.G.has("audio")&&(n=ux(e,"audio",n,r),r=Vt(Nn(e.G.get("audio"))),v=Kn(e.G.get("audio")),v=r==n.codec&&v==n.Rh,n.jc&&n.jc.destroy()),s===y&&o===g&&v?{type:gp,vf:u,jc:l}:(s=!0,(e.m&&!i.has("audio")||f&&l&&!e.j.has(t))&&(s=!1),t=je(),s&&e.B.codecSwitchingStrategy==="smooth"&&t.Bb()?{type:cx,vf:u,jc:l}:(l&&l.destroy(),{type:mp,vf:u,jc:null}))}function mM(e,t,n,r,i){var s,o,u,l,f,g;return F(function(y){return y.g==1?(s=bt,o=lx(e,t,n,r,i),u=o.type,l=o.jc,f=o.vf,(g=i.get(s.aa))&&(e.m=g.isAudioMuxedInVideo),u==gp?(e.j.has(t)&&!l?(e.j.get(t).destroy(),e.j.delete(t)):!e.j.has(t)&&l?e.j.set(t,l):l&&(e.j.has(t)&&e.j.get(t).transmux!==l.transmux?(e.j.get(t).destroy(),e.j.set(t,l)):l.destroy()),y.return(!1)):u==cx?C(y,pM(e,t,f,l),3):u!=mp?y.A(3):(l&&l.destroy(),C(y,ax(e,i),3))):y.return(!0)})}function yM(e,t,n,r,i){return e=lx(e,t,n,r,i),e.jc&&e.jc.destroy(),e.type==mp}var pp=m.URL.createObjectURL,vM="sequence",gp="none",mp="reset",cx="changeType";function Pe(e,t,n){this.i=e,this.F=t,this.u=this.l=1/0,this.h=1,this.g=this.j=null,this.B=0,this.C=!0,this.J=!1,this.I=0,this.G=n===void 0?!0:n,this.H=0,this.o=!1,this.m=e}p=Pe.prototype,p.getDuration=function(){return this.l},p.Pj=function(){return this.h},p.Ui=function(e){this.i=e},p.Ab=function(e){this.l=e},p.Uj=function(){return this.i},p.Ti=function(e){this.B=e},p.cd=function(e){e&&!this.C&&(this.J=!0),this.C=e},p.Kf=function(e){this.u=e},p.cf=function(){return this.u},p.qh=function(e){this.F=e},p.Hj=function(){return this.F},p.Fi=function(e,t){if(e.length!=0){var n=(Date.now()+this.B)/1e3;if(e=e.filter(function(i){return i.start+t<n}),e.length!=0){var r=e[e.length-1].end+t;this.wf(e[0].start+t),this.h=e.reduce(function(i,s){return Math.max(i,s.end-s.start)},this.h),this.g=Math.max(this.g,r),this.i!=null&&this.G&&!this.o&&(this.i=n-this.g-this.h)}}},p.le=function(e){if(e.length!=0){var t=e[0].startTime,n=e[0].endTime,r=(Date.now()+this.B)/1e3;e=x(e);for(var i=e.next();!i.done;i=e.next())i=i.value,r<i.startTime||(t=Math.min(t,i.startTime),n=Math.max(n,i.endTime),this.h=Math.max(this.h,i.endTime-i.startTime));this.wf(t),this.g=Math.max(this.g,n),this.i!=null&&this.G&&!this.o&&(this.i=r-this.g-this.h)}},p.Ei=function(e,t){this.wf(e),t==1/0||this.W()||(this.g=Math.max(this.g,t))},p.Qj=function(){return this.g},p.pf=function(){this.o=!0},p.rk=function(){return this.o},p.rh=function(e){this.m=e},p.Mj=function(){return this.m},p.wf=function(e){this.j==null?this.j=e:this.J||(this.j=Math.min(this.j,e))},p.Vg=function(e){this.h=Math.max(this.h,e)},p.offset=function(e){this.j!=null&&(this.j+=e),this.g!=null&&(this.g+=e)},p.W=function(){return this.l==1/0&&!this.C},p.Vc=function(){return this.l!=1/0&&!this.C},p.Ib=function(){return Math.max(this.I,this.Ic()-this.u)},p.Wi=function(e){this.I=e},p.Ic=function(){return this.W()||this.Vc()?Math.min(Math.max(0,(Date.now()+this.B)/1e3-this.h-this.i)+this.H,this.l):this.g?Math.min(this.g,this.l):this.l},p.$d=function(e){var t=Math.max(this.j,this.I);return this.u==1/0?Math.ceil(t*1e3)/1e3:Math.max(t,Math.min(this.Ic()-this.u+e,this.Hb()))},p.$b=function(){return this.$d(0)},p.Hb=function(){return Math.max(0,this.Ic()-(this.W()||this.Vc()?this.F:0))},p.ij=function(){return!(this.i==null||this.g!=null&&this.G)},p.Si=function(e){this.H=e},p.Cj=function(){return this.H},de("shaka.media.PresentationTimeline",Pe),Pe.prototype.getAvailabilityTimeOffset=Pe.prototype.Cj,Pe.prototype.setAvailabilityTimeOffset=Pe.prototype.Si,Pe.prototype.usingPresentationStartTime=Pe.prototype.ij,Pe.prototype.getSeekRangeEnd=Pe.prototype.Hb,Pe.prototype.getSeekRangeStart=Pe.prototype.$b,Pe.prototype.getSafeSeekRangeStart=Pe.prototype.$d,Pe.prototype.getSegmentAvailabilityEnd=Pe.prototype.Ic,Pe.prototype.setUserSeekStart=Pe.prototype.Wi,Pe.prototype.getSegmentAvailabilityStart=Pe.prototype.Ib,Pe.prototype.isInProgress=Pe.prototype.Vc,Pe.prototype.isLive=Pe.prototype.W,Pe.prototype.offset=Pe.prototype.offset,Pe.prototype.notifyMaxSegmentDuration=Pe.prototype.Vg,Pe.prototype.notifyMinSegmentStartTime=Pe.prototype.wf,Pe.prototype.getInitialProgramDateTime=Pe.prototype.Mj,Pe.prototype.setInitialProgramDateTime=Pe.prototype.rh,Pe.prototype.isStartTimeLocked=Pe.prototype.rk,Pe.prototype.lockStartTime=Pe.prototype.pf,Pe.prototype.getMaxSegmentEndTime=Pe.prototype.Qj,Pe.prototype.notifyPeriodDuration=Pe.prototype.Ei,Pe.prototype.notifySegments=Pe.prototype.le,Pe.prototype.notifyTimeRange=Pe.prototype.Fi,Pe.prototype.getDelay=Pe.prototype.Hj,Pe.prototype.setDelay=Pe.prototype.qh,Pe.prototype.getSegmentAvailabilityDuration=Pe.prototype.cf,Pe.prototype.setSegmentAvailabilityDuration=Pe.prototype.Kf,Pe.prototype.setStatic=Pe.prototype.cd,Pe.prototype.setClockOffset=Pe.prototype.Ti,Pe.prototype.getPresentationStartTime=Pe.prototype.Uj,Pe.prototype.setDuration=Pe.prototype.Ab,Pe.prototype.setPresentationStartTime=Pe.prototype.Ui,Pe.prototype.getMaxSegmentDuration=Pe.prototype.Pj,Pe.prototype.getDuration=Pe.prototype.getDuration;function yp(e,t,n,r){var i=this;this.u=r,this.g=e,this.F=t,this.h=n,this.j=new et,this.m=!1,this.l=0,this.C=!1,this.H=this.G=0,this.o=TM(this),this.B=!1,this.j.D(e,"waiting",function(){return uu(i)}),this.i=new Ve(function(){uu(i)}).Ea(this.h.gapJumpTimerTime)}yp.prototype.release=function(){this.j&&(this.j.release(),this.j=null),this.i!=null&&(this.i.stop(),this.i=null),this.o&&(this.o.release(),this.o=null),this.g=this.F=this.u=null},yp.prototype.zd=function(){this.B=!0,this.i&&this.i.Ea(this.h.gapJumpTimerTime),uu(this)};function uu(e){if(e.g.readyState!=0){if(e.g.seeking){if(!e.m)return}else e.m=!1;if(!e.g.paused||e.g.currentTime==e.l&&(e.g.autoplay||e.g.currentTime!=e.l)){var t;if(!(t=!e.o)){t=e.o;var n=t.h,r=hx(n),i=n.g.currentTime,s=Date.now()/1e3;(t.g!=i||t.m!=r)&&(t.l=s,t.g=i,t.m=r,t.i=!1),i=s-t.l,(r=i>=t.o&&r&&!t.i)&&(t.j&&t.j(t.g,i),t.i=!0,t.g=n.g.currentTime),t=!r}t&&(t=e.g.currentTime,n=e.g.buffered,r=qC(n,t,e.h.gapDetectionThreshold),r==null||r==0&&!e.B||(i=n.start(r),(s=e.h.gapPadding)&&(i=Math.ceil((i+s)*100)/100),i>=e.F.Hb()||i-t<.001||(r!=0&&n.end(r-1),xM(e,i),t==e.l&&(e.l=i),e.G++,e.u(new Se("gapjumped")))))}}}function xM(e,t){e.C=!0,e.j.Aa(e.g,"seeked",function(){e.C=!1}),e.g.currentTime=t}function TM(e){if(!e.h.stallEnabled)return null;var t=e.h.stallThreshold,n=e.h.stallSkip;return new dx(new fx(e.g),t,function(){var r;return F(function(i){if(i.g==1)return r=Mi(e.g.buffered),r.length?n?(e.g.currentTime+=n,i.A(2)):C(i,e.g.play(),3):i.return();if(i.g!=2){if(!e.g)return i.return();e.g.pause(),e.g.play()}e.H++,e.u(new Se("stalldetected")),ie(i)})})}function dx(e,t,n){this.h=e,this.m=hx(e),this.g=e.g.currentTime,this.l=Date.now()/1e3,this.i=!1,this.o=t,this.j=n}dx.prototype.release=function(){this.h&&this.h.release(),this.j=this.h=null};function fx(e){var t=this;this.g=e,this.h=new et,this.i=!1,this.h.D(this.g,"audiofocuspaused",function(){t.i=!0}),this.h.D(this.g,"audiofocusgranted",function(){t.i=!1}),this.h.D(this.g,"audiofocuslost",function(){t.i=!0})}function hx(e){if(e.g.paused||e.g.playbackRate==0||e.i||e.g.buffered.length==0)var t=!1;else e:{t=e.g.currentTime,e=x(Mi(e.g.buffered));for(var n=e.next();!n.done;n=e.next())if(n=n.value,!(t<n.start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}fx.prototype.release=function(){this.h&&this.h.release(),this.h=null};function Do(e,t,n,r){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?r():(t=wM.value().get(t),n.Aa(e,t,r))}var wM=new vt(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function px(e,t,n,r){var i=this;this.g=e,this.m=t,this.u=n,this.l=null,this.j=function(){return i.l==null&&(i.l=r()),i.l},this.o=!1,this.h=new et,this.i=new vx(e),Do(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){mx(i,i.j())})}px.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i!=null&&(this.i.release(),this.i=null),this.m=function(){},this.g=null};function vp(e){return e.o?e.g.currentTime:e.j()}function gx(e,t){e.g.readyState>0?xx(e.i,t):Do(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){mx(e,e.j())})}function mx(e,t){Math.abs(e.g.currentTime-t)<.001?yx(e):(e.h.Aa(e.g,"seeking",function(){yx(e)}),xx(e.i,e.g.currentTime&&e.g.currentTime!=0?e.g.currentTime:t))}function yx(e){e.o=!0,e.h.D(e.g,"seeking",function(){return e.m()}),e.u(e.g.currentTime)}function vx(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new Ve(function(){t.i<=0||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)})}vx.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null};function xx(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.Ea(.1)}function Tx(e){this.g=e,this.i=!1,this.h=null,this.j=new et}p=Tx.prototype,p.ready=function(){function e(){if(t.h==null||t.h==0&&t.g.duration!=1/0)t.i=!0;else{var n=t.g.currentTime,r=null;if(typeof t.h=="number")r=t.h;else if(t.h instanceof Date){var i=wx(t);i!==null&&(r=t.h.getTime()/1e3-i,r=Sx(t,r))}r==null?t.i=!0:(r<0&&(r=Math.max(0,n+r)),n!=r?(t.j.Aa(t.g,"seeking",function(){t.i=!0}),t.g.currentTime=r):t.i=!0)}}var t=this;Do(this.g,HTMLMediaElement.HAVE_FUTURE_DATA,this.j,function(){e()})},p.release=function(){this.j&&(this.j.release(),this.j=null),this.g=null},p.Zf=function(e){this.h=this.i?this.h:e},p.Pd=function(){var e=this.i?this.g.currentTime:this.h;return e instanceof Date&&(e=e.getTime()/1e3-(wx(this)||0),e=Sx(this,e)),e||0},p.Lh=function(){return 0},p.Jh=function(){return 0},p.Kh=function(){return!1},p.Di=function(){},p.oi=function(){var e=Sc(this.g.buffered);return e!=null&&e>=this.g.duration-1};function wx(e){return e.g.getStartDate&&(e=e.g.getStartDate().getTime(),!isNaN(e))?e/1e3:null}function Sx(e,t){return e=e.g.seekable,e.length>0&&(t=Math.max(e.start(0),t),t=Math.min(e.end(e.length-1),t)),t}function Ax(e,t,n,r,i,s){var o=this;this.h=e,this.g=t.presentationTimeline,this.l=n,this.u=i,this.o=null,this.i=new yp(e,t.presentationTimeline,n,s),this.j=new px(e,function(){e:{var u=o.i;u.m=!0,u.B=!1,u.i&&u.i.Ea(u.h.gapJumpTimerTime),uu(u);var l=vp(o.j);if(u=Cx(o,l),!U0()&&Math.abs(u-l)>.001){l=!1;var f=je().Qi();if(f){var g=Date.now()/1e3;(!o.o||o.o<g-f)&&(o.o=g,l=!0)}else l=!0;if(l){gx(o.j,u),u=void 0;break e}}o.u(),u=void 0}return u},function(u){var l=o.i;l.g.seeking&&!l.m&&(l.m=!0,l.l=u),l.i&&l.i.Ea(l.h.gapJumpTimerTime),uu(l)},function(){return Ex(o,r)}),this.m=new Ve(function(){if(o.h.readyState!=0&&!o.h.paused){var u=vp(o.j),l=o.g.$b(),f=o.g.Hb();f-l<3&&(l=f-3),u<l&&(u=Cx(o,u),o.h.currentTime=u)}})}p=Ax.prototype,p.ready=function(){this.m.Ea(.25)},p.release=function(){this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.m&&(this.m.stop(),this.m=null),this.h=this.j=this.g=this.l=null,this.u=function(){}},p.Zf=function(e){gx(this.j,Ex(this,e))},p.Pd=function(){var e=vp(this.j);return this.h.readyState>0&&!this.h.paused?Mx(this,e):e},p.Lh=function(){return this.i.H},p.Jh=function(){return this.i.G},p.Kh=function(){return this.i.C};function Ex(e,t){return t==null?t=e.g.getDuration()<1/0?e.g.$b():e.g.Hb():t instanceof Date?t=t.getTime()/1e3-(e.g.m||e.g.i):t<0&&(t=e.g.Hb()+t),Ix(e,Mx(e,t))}p.Di=function(){this.i.zd()},p.oi=function(){if(this.g.W()){var e=this.g.Ic(),t=Sc(this.h.buffered);if(t!=null&&t>=e)return!0}return!1};function Ix(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function Cx(e,t){var n=e.l.rebufferingGoal,r=e.l.safeSeekOffset,i=e.g.$b(),s=e.g.Hb(),o=e.g.getDuration();s-i<3&&(i=s-3);var u=e.g.$d(n),l=e.g.$d(r);return n=e.g.$d(n+r),t>=o?Ix(e,t):t>s?s-e.l.safeSeekEndOffset:t<i?e.g.W()&&e.l.returnToEndOfLiveWindowWhenOutside?s-e.l.safeSeekEndOffset:tp(e.h.buffered,l)?l:n:t>=u||tp(e.h.buffered,t)?t:n}function Mx(e,t){var n=e.g.$b();return t<n?n:(e=e.g.Hb(),t>e?e:t)}function Qe(e){this.g=e,this.m=null,this.i=0,this.o=!1}p=Qe.prototype,p.getNumReferences=function(){return this.g.length},p.getNumEvicted=function(){return this.i},p.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},p.zk=function(){this.o=!0},p.Gb=function(e){for(var t=x(this.g),n=t.next();!n.done;n=t.next())e(n.value)};function $r(e){return e.g[0]||null}p.find=function(e){for(var t=this.g.length-1,n=t;n>=0;--n){var r=this.g[n],i=n<t?this.g[n+1].startTime:r.endTime;if(e>=r.startTime&&e<i)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},p.get=function(e){return this.g.length==0?null:(e-=this.i,e<0||e>=this.g.length?null:this.g[e])},p.offset=function(e){if(!this.o)for(var t=x(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},p.rf=function(e){if(!this.o&&e.length){var t=Math.round(e[0].startTime*1e3)/1e3;this.g=this.g.filter(function(n){return Math.round(n.startTime*1e3)/1e3<t}),this.g.push.apply(this.g,Y(e))}},p.je=function(e,t){var n=this;e=e.filter(function(r){return r.endTime>t&&(n.g.length==0||r.endTime>n.g[0].startTime)}),this.rf(e),this.Ya(t)},p.Ya=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter(function(n){return n.endTime>e}),this.i+=t-this.g.length}},p.pd=function(e,t,n){if(n=n===void 0?!1:n,!this.o){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.i++;this.g.length!=0&&(e=this.g[this.g.length-1],t=new Ce(e.startTime,t,e.C,e.startByte,e.endByte,e.ea,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.B,e.h,e.status,e.aesKey),t.mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.g[this.g.length-1]=t)}},p.Qf=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new Ve(function(){var r=t();r?n.g.push.apply(n.g,Y(r)):(n.m.stop(),n.m=null)}),this.m.Ea(e))},Qe.prototype[Symbol.iterator]=function(){return this.Yb(0)},Qe.prototype.Yb=function(e,t,n){t=t===void 0?!1:t,n=n===void 0?!1:n;var r=this.find(e);if(r==null)return null;var i=this.get(r);n?r++:r--;var s=-1;if(i&&i.g.length>0)for(var o=i.g.length-1;o>=0;--o){var u=i.g[o];if(e>=u.startTime&&e<u.endTime){if(!t){for(;o&&!u.l;)o--,u=i.g[o];if(!u.l)return yn("No independent partial segment found!"),null}n?r--:r++,s=o-1;break}}return new Sr(this,r,s,n)},Qe.prototype.Ve=function(){return-1};function kc(e,t,n){return e=new Ce(e,e+t,function(){return n},0,null,null,e,e,e+t),new Qe([e])}de("shaka.media.SegmentIndex",Qe),Qe.forSingleSegment=kc,Qe.prototype.getIteratorForTime=Qe.prototype.Yb,Qe.prototype.updateEvery=Qe.prototype.Qf,Qe.prototype.fit=Qe.prototype.pd,Qe.prototype.evict=Qe.prototype.Ya,Qe.prototype.mergeAndEvict=Qe.prototype.je,Qe.prototype.offset=Qe.prototype.offset,Qe.prototype.get=Qe.prototype.get,Qe.prototype.find=Qe.prototype.find,Qe.prototype.markImmutable=Qe.prototype.zk,Qe.prototype.release=Qe.prototype.release,Qe.prototype.getNumEvicted=Qe.prototype.getNumEvicted,Qe.prototype.getNumReferences=Qe.prototype.getNumReferences;function Sr(e,t,n,r){this.i=e,this.h=t,this.g=n,this.reverse=r}p=Sr.prototype,p.Jd=function(e){this.reverse=e},p.xj=function(){return this.h},p.current=function(){var e=this.i.get(this.h);return e&&e.g.length>0&&e.m&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&e.g.length>0?e.g[this.g]:e},p.next=function(){var e=this.i.get(this.h);return this.reverse?e&&e.g.length>0?(this.g--,this.g<0&&(this.h--,this.g=(e=this.i.get(this.h))&&e.g.length>0?e.g.length-1:0)):(this.h--,this.g=0):e&&e.g.length>0?(this.g++,e.m&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),e=this.current(),{value:e,done:!e}},p.ih=function(){var e=this.current();if(e&&e.Xc&&!e.l&&(e=this.i.get(this.h))&&e.g.length>0)for(var t=e.g[this.g];t.l&&!(this.g<=0);)this.g--,t=e.g[this.g]},de("shaka.media.SegmentIterator",Sr),Sr.prototype.resetToLastIndependent=Sr.prototype.ih,Sr.prototype.next=Sr.prototype.next,Sr.prototype.current=Sr.prototype.current,Sr.prototype.currentPosition=Sr.prototype.xj,Sr.prototype.setReverse=Sr.prototype.Jd;function Et(){Qe.call(this,[]),this.h=[]}J(Et,Qe),p=Et.prototype,p.clone=function(){var e=new Et;return e.h=this.h.slice(),e.i=this.i,e},p.release=function(){this.h=[]},p.Gb=function(e){for(var t=x(this.h),n=t.next();!n.done;n=t.next())n.value.Gb(e)};function SM(e,t){e=x(e.h);for(var n=e.next();!n.done;n=e.next())t(n.value)}p.find=function(e){for(var t=this.i,n=x(this.h),r=n.next();!r.done;r=n.next()){r=r.value;var i=r.find(e);if(i!=null)return i+t;t+=r.getNumEvicted()+r.getNumReferences()}return null};function AM(e,t){e=x(e.h);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.find(t)!=null)return n.Ve();return-1}p.get=function(e){for(var t=this.i,n=x(this.h),r=n.next();!r.done;r=n.next()){r=r.value;var i=r.get(e-t);if(i)return i;i=r.getNumReferences(),t+=r.getNumEvicted()+i}return null},p.offset=function(){},p.rf=function(){},p.Ya=function(e){if(this.h.length){var t=this.h[0];t.Ya(e),t.getNumReferences()==0&&(this.h.shift(),this.i+=t.getNumEvicted(),t.release(),this.Ya(e))}},p.je=function(){},p.pd=function(){},p.Qf=function(){},de("shaka.media.MetaSegmentIndex",Et),Et.prototype.updateEvery=Et.prototype.Qf,Et.prototype.fit=Et.prototype.pd,Et.prototype.mergeAndEvict=Et.prototype.je,Et.prototype.evict=Et.prototype.Ya,Et.prototype.merge=Et.prototype.rf,Et.prototype.offset=Et.prototype.offset,Et.prototype.get=Et.prototype.get,Et.prototype.find=Et.prototype.find,Et.prototype.forEachTopLevelReference=Et.prototype.Gb,Et.prototype.release=Et.prototype.release;function lu(e){var t=this;this.g=e,this.j=!1,this.i=this.g.bf(),this.h=new Ve(function(){t.g.Bi(t.i*.25)})}lu.prototype.release=function(){this.set(this.Tc()),this.h&&(this.h.stop(),this.h=null),this.g=null},lu.prototype.set=function(e){this.i=e,xp(this)},lu.prototype.Tc=function(){return this.g.Tc()};function xp(e){e.h.stop();var t=e.j?0:e.i;if(t>=0)try{e.g.bf()!=t&&e.g.sh(t);return}catch(n){}e.h.Ea(.25),e.g.bf()!=0&&e.g.sh(0)}function Tp(e){var t=this;this.j=e,this.h=new et,this.g=new Set,this.i=new Ve(function(){Rx(t,!1)}).Kb(),e.paused||this.i.Ea(.25),this.h.D(e,"playing",function(){t.i.Kb().Ea(.25)}),this.h.D(e,"pause",function(){t.i.stop()})}Tp.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i.stop();for(var e=x(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()};function Rx(e,t){var n=e.j.currentTime;e=x(e.g);for(var r=e.next();!r.done;r=e.next())r.value.j(n,t)}function _c(e){ot.call(this),this.g=new Map,this.h=e}J(_c,ot),_c.prototype.release=function(){this.g.clear(),ot.prototype.release.call(this)};function EM(e,t){var n=e.g.get(t);return n||(n={qe:[],og:null,contentType:t},e.g.set(t,n)),n}function IM(e,t,n){var r=EM(e,t.contentType);CM(e,r),e={xd:t,position:n},r=r.qe,t=r.findIndex(function(i){return i.position>=n}),t>=0?r.splice(t,r[t].position==n?1:0,e):r.push(e)}_c.prototype.j=function(e){for(var t=x(this.g.values()),n=t.next();!n.done;n=t.next()){n=n.value;var r=n.og;e:{for(var i=n.qe,s=i.length-1;s>=0;s--){var o=i[s];if(o.position<=e){i=o.xd;break e}}i=null}s=i&&!(r===i||r&&i&&r.bandwidth==i.bandwidth&&r.audioSamplingRate==i.audioSamplingRate&&r.codecs==i.codecs&&r.contentType==i.contentType&&r.frameRate==i.frameRate&&r.height==i.height&&r.mimeType==i.mimeType&&r.channelsCount==i.channelsCount&&r.pixelAspectRatio==i.pixelAspectRatio&&r.width==i.width),o=i&&r&&i.label&&r.label&&r.label!==i.label;var u=i&&r&&i.language&&r.language&&r.language!==i.language;r=i&&r&&i.roles&&r.roles&&!Wi(r.roles,i.roles),(o||u||r)&&kx(this,e,i.contentType)&&(n.og=i,r=new Se("audiotrackchange",new Map([["quality",i],["position",e]])),this.dispatchEvent(r)),s&&kx(this,e,i.contentType)&&(n.og=i,JSON.stringify(i),n=new Se("qualitychange",new Map([["quality",i],["position",e]])),this.dispatchEvent(n))}};function kx(e,t,n){return!!((e=e.h()[n])&&e.length>0&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function CM(e,t){if((e=e.h()[t.contentType])&&e.length>0){var n=e[0].start,r=e[e.length-1].end,i=t.qe;t.qe=i.filter(function(s,o){return!(s.position<=n&&o+1<i.length&&i[o+1].position<=n||s.position>=r)})}else t.qe=[]}function Pc(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return e.type=="video"&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),e.type=="audio"&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function cu(e){ot.call(this),this.h=new Map,this.i=e,this.g=null}J(cu,ot),cu.prototype.release=function(){this.h.clear(),this.g&&(this.g.stop(),this.g=null),ot.prototype.release.call(this)};function wp(e,t){var n=t.schemeIdUri+"_"+t.id+"_"+(t.startTime.toFixed(1)+"_"+t.endTime.toFixed(1));e.h.has(n)||(e.h.set(n,t),t=new Se("regionadd",new Map([["region",t]])),e.dispatchEvent(t),MM(e))}function MM(e){e.g||(e.g=new Ve(function(){for(var t=e.i(),n=x(e.h),r=n.next();!r.done;r=n.next()){var i=x(r.value);r=i.next().value,i=i.next().value,i.endTime<t.start&&(e.h.delete(r),r=new Se("regionremove",new Map([["region",i]])),e.dispatchEvent(r))}!e.h.size&&e.g&&(e.g.stop(),e.g=null)}).Ea(2))}function Dc(e,t,n,r,i){function s(o,u){return!(u.fastSwitching&&o.Xc&&o.ie)}this.m=e,this.i=t,this.l=n,this.g=new Map,this.j=new Map,this.h=null,this.o=r,this.u=i||s}function RM(e,t){e.l=t,e=x(e.g.values());for(var n=e.next();!n.done;n=e.next())n.value.g=t}function du(e,t,n){if(n=n===void 0?!1:n,!e.i.segmentIndex||(e.h||(e.h=e.i.segmentIndex.Yb(t,!0,e.o)),!e.h))return Promise.resolve();for(n&&e.h.next(),t=[];e.g.size<e.m&&(n=e.h.next().value,!!n);){var r=!0;if(n.isPreload()&&n.endByte!=null&&(r=!1),n.Kc()==2&&(r=!1),n.ac(!1)&&(r=!1),r&&n.ea&&t.push(_x(e,n.ea)),r&&!e.g.has(n)&&(r=new Ap(e.l),t.push(Lx(r,n,e.i)),e.g.set(n,r)),!e.u(n,e.i))break}return Sp(e),Promise.all(t)}function _x(e,t){if(!e.i.segmentIndex||t.ac()||Array.from(e.j.keys()).some(function(i){return iu(i,t)}))return Promise.resolve();var n=new Ap(e.l),r=Lx(n,t,e.i);return e.j.set(t,n),r}function Px(e,t){t=x(t.keys());for(var n=t.next();!n.done;n=t.next())(n=n.value)&&fu(e,n)}function Yr(e){Px(e,e.g),Px(e,e.j),e.h=null}Dc.prototype.Ya=function(e,t){t=t===void 0?!1:t;for(var n=x(this.g.keys()),r=n.next();!r.done;r=n.next())r=r.value,e>r.endTime&&fu(this,r);t&&Sp(this)},Dc.prototype.Jd=function(e){this.o=e,this.h&&this.h.Jd(e)};function Sp(e){if(e.g.size)for(var t=Array.from(e.g.keys()),n=x(e.j.keys()),r=n.next(),i={};!r.done;i={Pg:void 0},r=n.next())i.Pg=r.value,t.some((function(s){return function(o){return iu(o.ea,s.Pg)}})(i))||fu(e,i.Pg)}function Dx(e,t){e.m=t;for(var n=Array.from(e.g.keys());n.length>t;){var r=n.pop();r&&fu(e,r)}Sp(e)}function kM(e,t){t&&t!==e.i&&(Yr(e),e.i=t)}function fu(e,t){var n=e.g;t instanceof On&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function Ap(e){this.g=e,this.me=this.Ah=null}function Lx(e,t,n){var r=new Uint8Array(0);return e.me=e.g(t,n,function(i){return F(function(s){if(s.g==1)return r.byteLength>0?r=Lt(r,i):r=i,e.Ah?C(s,e.Ah(r),3):s.A(0);r=new Uint8Array(0),ie(s)})}),e.me.promise.catch(function(i){return i instanceof H&&i.code==7001?Promise.resolve():Promise.reject(i)})}Ap.prototype.abort=function(){this.me&&this.me.abort()},de("shaka.config.CrossBoundaryStrategy",{KEEP:"keep",RESET:"reset",RESET_TO_ENCRYPTED:"reset_to_encrypted",RESET_ON_ENCRYPTION_CHANGE:"RESET_ON_ENCRYPTION_CHANGE"});function Ep(e){var t=Kn(e),n=t.split("/")[0];return e=Nn(e),{type:n,mimeType:t,codecs:e,language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,ye:null,colorGamut:null,frameRate:null,timescale:null}}function _M(e,t,n){function r(N){M=N.name;var z=N.reader;z.skip(24);var B=z.Ca(),W=z.Ca();z.skip(50),v=String(B),y=String(W),N.reader.Ia()&&Ue(N)}function i(N){var z=j0(N.reader);w=z.channelCount,A=z.sampleRate,s(N.name)}function s(N){switch(N=N.toLowerCase(),N){case"avc1":case"avc3":u.push(N+".42E01E"),f=!0;break;case"hev1":case"hvc1":u.push(N+".1.6.L93.90"),f=!0;break;case"dvh1":case"dvhe":u.push(N+".05.04"),f=!0;break;case"vp09":u.push(N+".00.10.08"),f=!0;break;case"av01":u.push(N+".0.01M.08"),f=!0;break;case"mp4a":o.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":o.push(N),l=!0;break;case"apac":o.push("apac.31.00"),l=!0}}var o=[],u=[],l=!1,f=!1,g=null,y=null,v=null,w=null,A=null,I=null,E=null,R=null,M;if(new ut().box("moov",Ue).box("trak",Ue).box("mdia",Ue).S("mdhd",function(N){N=xc(N.reader,N.version),g=N.language,R=N.timescale}).box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("mp4a",function(N){var z=j0(N.reader);w=z.channelCount,A=z.sampleRate,N.reader.Ia()?Ue(N):s(N.name)}).box("esds",function(N){N=N.reader;for(var z="mp4a",B,W;N.Ia();){B=N.Y();for(var G=N.Y();G&128;)G=N.Y();if(B==3)N.Ca(),G=N.Y(),G&128&&N.Ca(),G&64&&N.skip(N.Y()),G&32&&N.Ca();else if(B==4)W=N.Y(),N.skip(12);else if(B==5)break}W&&(z+="."+tu(W),B==5&&N.Ia()&&(B=N.Y(),W=(B&248)>>3,W===31&&N.Ia()&&(W=32+((B&7)<<3)+((N.Y()&224)>>5)),z+="."+W)),o.push(z),l=!0}).box("ac-3",i).box("ec-3",i).box("ac-4",i).box("Opus",i).box("fLaC",i).box("apac",i).box("avc1",r).box("avc3",r).box("hev1",r).box("hvc1",r).box("dva1",r).box("dvav",r).box("dvh1",r).box("dvhe",r).box("vp09",r).box("av01",r).box("avcC",function(N){var z=M||"";switch(M){case"dvav":z="avc3";break;case"dva1":z="avc1"}N=N.reader,N.skip(1),N=z+"."+tu(N.Y())+tu(N.Y())+tu(N.Y()),u.push(N),f=!0}).box("hvcC",function(N){var z=M||"";switch(M){case"dvh1":z="hvc1";break;case"dvhe":z="hev1"}var B=N.reader;B.skip(1),N=B.Y();var W=["","A","B","C"][N>>6],G=N&31,re=B.U(),ne=(N&32)>>5?"H":"L";N=[B.Y(),B.Y(),B.Y(),B.Y(),B.Y(),B.Y()],B=B.Y();for(var $=0,Q=0;Q<32&&($|=re&1,Q!=31);Q++)$<<=1,re>>=1;for(z=z+("."+W+G)+("."+tu($,!0)),z+="."+ne+B,W="",G=N.length;G--;)((ne=N[G])||W)&&(W="."+ne.toString(16).toUpperCase()+W);z+=W,u.push(z),f=!0}).box("dvcC",function(N){var z=M||"";switch(M){case"hvc1":z="dvh1";break;case"hev1":z="dvhe";break;case"avc1":z="dva1";break;case"avc3":z="dvav";break;case"av01":z="dav1"}var B=N.reader;B.skip(2),N=B.Y(),B=B.Y(),u.push(z+"."+Yn(N>>1&127)+"."+Yn(N<<5&32|B>>3&31)),f=!0}).box("dvvC",function(N){var z=M||"";switch(M){case"hvc1":z="dvh1";break;case"hev1":z="dvhe";break;case"avc1":z="dva1";break;case"avc3":z="dvav";break;case"av01":z="dav1"}var B=N.reader;B.skip(2),N=B.Y(),B=B.Y(),u.push(z+"."+Yn(N>>1&127)+"."+Yn(N<<5&32|B>>3&31)),f=!0}).S("vpcC",function(N){var z=M||"",B=N.reader;N=B.Y();var W=B.Y();B=B.Y()>>4&15,u.push(z+"."+Yn(N)+"."+Yn(W)+"."+Yn(B)),f=!0}).box("av1C",function(N){var z=M||"";switch(M){case"dav1":z="av01"}var B=N.reader;B.skip(1),N=B.Y(),B=B.Y();var W=N>>>5,G=(B&64)>>6;u.push(z+"."+W+"."+Yn(N&31)+(B>>>7?"H":"M")+"."+Yn(W===2&&G?(B&32)>>5?12:10:G?10:8)+"."+((B&16)>>4)+"."+((B&8)>>3)+((B&4)>>2)+(B&3)+"."+Yn(1)+"."+Yn(1)+"."+Yn(1)+".0"),f=!0}).box("enca",hc).box("encv",$n).box("sinf",Ue).box("frma",function(N){N=Zh(N.reader).codec,s(N)}).box("colr",function(N){u=u.map(function(W){if(W.startsWith("av01.")){var G=N.reader,re=G.Pa(),ne=G.Ub(4,!1),$=String.fromCharCode(ne[0]);if($+=String.fromCharCode(ne[1]),$+=String.fromCharCode(ne[2]),$+=String.fromCharCode(ne[3]),$==="nclx"){ne=G.Ca(),$=G.Ca();var Q=G.Ca(),ae=G.Y()>>7,le=W.split(".");le.length==10&&(le[6]=Yn(ne),le[7]=Yn($),le[8]=Yn(Q),le[9]=String(ae),W=le.join("."))}G.seek(re)}return W});var z=DC(N.reader),B=z.colorGamut;I=z.ye,E=B}).parse(e||t,!0,!0),!o.length&&!u.length)return null;var D=l&&!f,O=new Map;if(f&&!n){n=new Wr("video/mp4"),e&&n.init(e);try{n.zf(t);for(var X=x(n.Yf()),b=X.next();!b.done;b=X.next()){var U=b.value;O.set(U,U)}}catch(N){}n.Od()}return{type:D?"audio":"video",mimeType:D?"audio/mp4":"video/mp4",codecs:Ip(o.concat(u)).join(", "),language:g,height:y,width:v,channelCount:w,sampleRate:A,closedCaptions:O,ye:I,colorGamut:E,frameRate:null,timescale:R}}function Ip(e){var t=new Set,n=[];e=x(e);for(var r=e.next();!r.done;r=e.next()){r=r.value;var i=Ji(r);t.has(i)||(n.push(r),t.add(i))}return t=Sh("audio",n),r=Sh("video",n),e=Sh(Fe,n),r=PM(r),t=t.concat(r).concat(e),n.length&&!t.length?n:t}function PM(e){if(e.length<=1)return e;var t=e.find(function(n){return n.startsWith("dvav.")||n.startsWith("dva1.")||n.startsWith("dvh1.")||n.startsWith("dvhe.")||n.startsWith("dav1.")||n.startsWith("dvc1.")||n.startsWith("dvi1.")});return t?vn('video/mp4; codecs="'+t+'"')?[t]:e.filter(function(n){return n!=t}):e}function DM(e){var t=null;return new ut().box("moov",Ue).box("trak",Ue).box("mdia",Ue).box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("encv",$n).box("enca",hc).box("sinf",Ue).box("schi",Ue).S("tenc",function(n){n=n.reader,n.Y(),n.Y(),n.Y(),n.Y(),n=n.Ub(16,!1),t=gi(n)}).parse(e,!0),t}function Cp(e,t,n){var r,i,s,o,u;return F(function(l){if(l.g==1)return r=t,r.cryptoKey?l.A(2):C(l,r.fetchKey(),3);if(i=r.iv,!i)for(i=Le(new ArrayBuffer(16)),s=r.firstMediaSequenceNumber+n,o=i.byteLength-1;o>=0;o--)i[o]=s&255,s>>=8;return t.blockCipherMode=="CBC"?u={name:"AES-CBC",iv:i}:u={name:"AES-CTR",counter:i,length:64},l.return(m.crypto.subtle.decrypt(u,r.cryptoKey,e))})}function Lo(e,t,n){var r,i,s,o,u,l,f;return F(function(g){switch(g.g){case 1:return r=bo(e),(i=LM.get(r))?g.return(i):(s=0,o=Nt([e],n),Z(g,2),o.method="HEAD",C(g,t.request(s,o).promise,4));case 4:u=g.h,i=u.headers["content-type"],ce(g,3);break;case 2:if(l=se(g),!l||l.code!=1002&&l.code!=1001){g.A(3);break}return o.method="GET",C(g,t.request(s,o).promise,6);case 6:f=g.h,i=f.headers["content-type"];case 3:return g.return(i?i.toLowerCase().split(";").shift():"")}})}function bo(e){return e=new Pt(e).Tb.split("/").pop().split("."),e.length==1?"":e.pop().toLowerCase()}function hu(e,t,n,r,i){return e=Nt(e,r,i),(t!=0||n!=null)&&(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}var LM=new Map().set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html");function bx(e,t){var n=this;this.g=t,this.j=e,this.i=null,this.M=new Map,this.C=1,this.B=this.o=null,this.V=0,this.h=new Map,this.N=!1,this.X=null,this.F=!1,this.l=new To(function(){return bM(n)}),this.R=Date.now()/1e3,this.m=new Map,this.T={projection:null,hfov:null},this.ba=0,this.$=1/0,this.H=null,this.O=[],this.u=new Ve(function(){if(n.j&&n.g)if(n.j.presentationTimeline.W()){var r=n.j.presentationTimeline.$b(),i=n.j.presentationTimeline.Hb();i-r>1?dM(n.g.Z,r,i):fp(n.g.Z)}else fp(n.g.Z),n.u&&n.u.stop();else n.u&&n.u.stop()}),this.I=null,this.J=!1,this.K=new Ve(function(){var r=n.g.video;!r.ended&&n.I&&(n.J=!0,r.currentTime=n.I,n.I=null)}),this.G=new et}p=bx.prototype,p.destroy=function(){return this.l.destroy()};function bM(e){var t,n,r,i,s,o,u;return F(function(l){if(l.g==1){for(e.u&&e.u.stop(),e.u=null,e.K&&e.K.stop(),e.K=null,e.G&&(e.G.release(),e.G=null),t=[],n=x(e.h.values()),r=n.next();!r.done;r=n.next())i=r.value,ki(i),t.push(Uc(i)),i.ia&&(Yr(i.ia),i.ia=null);for(s=x(e.m.values()),o=s.next();!o.done;o=s.next())u=o.value,Yr(u);return C(l,Promise.all(t),2)}e.h.clear(),e.m.clear(),e.g=null,e.j=null,e.i=null,e.I=null,ie(l)})}p.configure=function(e){if(this.i=e,this.X=new o0({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor},!0),e.disableAudioPrefetch){var t=this.h.get("audio");t&&t.ia&&(Yr(t.ia),t.ia=null),t=x(this.m.keys());for(var n=t.next();!n.done;n=t.next())n=n.value,Yr(this.m.get(n)),this.m.delete(n)}for(e.disableTextPrefetch&&(t=this.h.get(Fe))&&t.ia&&(Yr(t.ia),t.ia=null),e.disableVideoPrefetch&&(t=this.h.get("video"))&&t.ia&&(Yr(t.ia),t.ia=null),t=x(this.h.keys()),n=t.next();!n.done;n=t.next())n=this.h.get(n.value),n.ia?(Dx(n.ia,e.segmentPrefetchLimit),e.segmentPrefetchLimit>0||(Yr(n.ia),n.ia=null)):e.segmentPrefetchLimit>0&&(n.ia=Rp(this,n.stream));e.disableAudioPrefetch||VM(this)};function NM(e,t,n){e.j.presentationTimeline.W()||(e.ba=t,e.$=n)}p.start=function(e){var t=this;return F(function(n){if(n.g==1)return C(n,FM(t,e||new Map),2);dt(t.l),t.N=!0,ie(n)})};function OM(e,t){var n,r,i,s,o,u;F(function(l){switch(l.g){case 1:return n=bt,e.V++,r=e.V,Z(l,2),C(l,rx(e.g.Z,n.Na),4);case 4:ce(l,3);break;case 2:i=se(l),e.g&&e.g.onError(i);case 3:s=Ct(t.mimeType,t.codecs),Cc(e.g.Z,s,e.j.sequenceMode,t.external),o=e.g.Z.ba,(o.isTextVisible()||e.i.alwaysStreamText)&&e.V==r&&(u=bc(e,t),e.h.set(n.Na,u),xn(e,u,0)),ie(l)}})}function UM(e){var t=e.h.get(Fe);t&&(ki(t),Uc(t).catch(function(){}),e.H=e.h.get(Fe),e.h.delete(Fe),t.stream&&t.stream.closeSegmentIndex&&t.stream.closeSegmentIndex()),e.B=null}function Nx(e,t){for(var n=e.g.Pb()<0,r=x(e.h.values()),i=r.next();!i.done;i=r.next())i=i.value,i.ua&&i.ua.Jd(n),i.ia&&i.ia.Jd(n);for(r=x(e.m.values()),i=r.next();!i.done;i=r.next())i.value.Jd(n);(n=e.h.get("video"))&&(r=n.stream)&&(t?(t=r.trickModeVideo)&&!n.Nc&&(No(e,t,!1,0,!1),n.Nc=r):(t=n.Nc)&&(n.Nc=null,No(e,t,!0,0,!1)))}function Ox(e,t,n,r,i,s){n=n===void 0?!1:n,r=r===void 0?0:r,i=i===void 0?!1:i,s=s===void 0?!1:s,e.o=t,e.N&&(t.video&&No(e,t.video,n,r,i,s),t.audio&&No(e,t.audio,n,r,i,s))}function Lc(e,t){F(function(n){if(n.g==1)return e.H=null,e.B=t,e.N?t.segmentIndex?n.A(2):C(n,t.createSegmentIndex(),2):n.return();No(e,t,!0,0,!1),ie(n)})}function jM(e){var t=e.h.get(Fe);t&&No(e,t.stream,!0,0,!0)}function BM(e,t){for(var n=x(e.M.entries()),r=n.next();!r.done;r=n.next()){var i=x(r.value);r=i.next().value,i=i.next().value,r.includes(t.type)&&(i(),e.M.delete(r))}}function No(e,t,n,r,i,s){var o=e.h.get(t.type);o||t.type!=Fe?o&&(o.Nc&&(t.trickModeVideo?(o.Nc=t,t=t.trickModeVideo):o.Nc=null),o.stream!=t||i)&&(e.m.has(t)?o.ia=e.m.get(t):o.ia&&kM(o.ia,t),t.type==Fe&&o.stream!=t&&(i=Ct(t.mimeType,t.codecs),Cc(e.g.Z,i,e.j.sequenceMode,t.external)),!e.m.has(o.stream)&&o.stream.closeSegmentIndex&&(o.Ka?(i="("+o.type+":"+o.stream.id+")",e.M.has(i)||e.M.set(i,o.stream.closeSegmentIndex)):o.stream.closeSegmentIndex()),i=o.stream.isAudioMuxedInVideo!=t.isAudioMuxedInVideo,o.stream=t,o.ua=null,o.fg=!!s,t.dependencyStream?o.Fc=bc(e,t.dependencyStream):o.Fc=null,Vx(e),i&&(o.pb=null,o.tc=null,o.sc=null,t.isAudioMuxedInVideo&&(t=null,o.type==="video"?t=e.h.get("audio"):o.type==="audio"&&(t=e.h.get("video")),t&&(Uc(t).catch(function(){}),t.pb=null,t.tc=null,t.sc=null,Mp(e,t),Ux(e,t).catch(function(u){e.g&&e.g.onError(u)})))),n?o.Xb?o.Ld=!0:o.Ka?(o.Vb=!0,o.ld=r,o.Ld=!0):(ki(o),Pp(e,o,!0,r).catch(function(u){e.g&&e.g.onError(u)})):o.Ka||o.qb||xn(e,o,0),Ux(e,o).catch(function(u){e.g&&e.g.onError(u)})):OM(e,t)}function Ux(e,t){var n,r,i;return F(function(s){if(s.g==1)return t.Va?(n=t.stream,r=t.Va,n.segmentIndex?s.A(2):C(s,n.createSegmentIndex(),2)):s.return();if(s.g!=4)return i=n.dependencyStream,!i||i.segmentIndex?s.A(4):C(s,i.createSegmentIndex(),4);if(t.Va!=r||t.stream!=n)return s.return();var o=e.g.nc(),u=Hs(e.g.Z,t.type),l=t.stream.segmentIndex.find(t.Ja?t.Ja.endTime:o),f=l==null?null:t.stream.segmentIndex.get(l);l=f?ep(f):null,f&&!l&&(l=(f.endTime-f.getStartTime())*(t.stream.bandwidth||e.o.bandwidth)/8),l?((f=f.ea)&&(l+=(f.endByte?f.endByte+1-f.startByte:null)||0),f=e.g.getBandwidthEstimate(),o=l*8/f<(u||0)-o-e.i.rebufferingGoal||t.Va.h.g>l):o=!0,o&&t.Va.abort(),ie(s)})}p.bd=function(){if(this.g){for(var e=this.g.nc(),t=x(this.h.keys()),n=t.next();!n.done;n=t.next()){var r=n.value;n=this.h.get(r);var i;if((i=!this.J)&&(i=this.g.Z,r==Fe?(i=i.h,i=i.g==null||i.h==null?!1:e>=i.g&&e<i.h):(i=ko(i,r),i=tp(i,e)),i=!i),i){if(this.R=0,n.ia&&(n.ia.h=null),n.type==="audio"){i=x(this.m.values());for(var s=i.next();!s.done;s=i.next())s.value.h=null}n.ua=null,(Hs(this.g.Z,r)!=null||n.Ka)&&Mp(this,n),n.Va&&(n.Va.abort(),n.Va=null),r===Fe&&(r=this.g.Z,r.K&&r.K.Od()),n.bd=!0}!this.J||n.Xb||n.Ka||n.qb||xn(this,n,0)}gu(this)&&bp(this)}};function Mp(e,t){t.Xb||t.Vb||(t.Ka?(t.Vb=!0,t.ld=0):dp(e.g.Z,t.type)==null?t.qb==null&&xn(e,t,0):(ki(t),Pp(e,t,!1,0).catch(function(n){e.g&&e.g.onError(n)})))}function FM(e,t){var n,r,i,s,o,u,l,f;return F(function(g){if(g.g==1){if(!e.o)throw new H(2,5,5006);return n=Bc(e,!0),r=e.g.Z,C(g,r.init(n,e.j.sequenceMode,e.j.type,e.j.ignoreManifestTimestampsInSegmentsMode),2)}for(dt(e.l),e.updateDuration(),i=x(n.keys()),s=i.next();!s.done;s=i.next())o=s.value,u=n.get(o),e.h.has(o)||(l=bc(e,u),t.has(u.id)&&(f=t.get(u.id),RM(f,function(y,v,w){return Oc(y,v,w||null,e.i.retryParameters,e.g.vc)}),l.ia=f),e.h.set(o,l),xn(e,l,0));Vx(e),ie(g)})}function bc(e,t){var n={stream:t,type:t.type,ua:null,ia:Rp(e,t),Ja:null,pb:null,nf:null,tc:null,sc:null,lf:null,mf:null,Nc:null,endOfStream:!1,Ka:!1,qb:null,Vb:!1,ld:0,Ld:!1,Xb:!1,bd:!0,fg:!1,eh:!1,be:!1,Va:null,Fc:null};return t.dependencyStream&&(n.Fc=bc(e,t.dependencyStream)),n}function Rp(e,t){if(t.type==="video"&&e.i.disableVideoPrefetch||t.type==="audio"&&e.i.disableAudioPrefetch||t.type===Fe&&(t.mimeType=="application/cea-608"||t.mimeType=="application/cea-708")||t.type===Fe&&e.i.disableTextPrefetch)return null;if(e.m.has(t))return e.m.get(t);var n=e.h.get(t.type);return(n=n&&n.ia)&&t===n.i?n:e.i.segmentPrefetchLimit>0?new Dc(e.i.segmentPrefetchLimit,t,function(r,i,s){return Oc(r,i,s||null,e.i.retryParameters,e.g.vc)},e.g.Pb()<0,e.g.cl):null}function VM(e){for(var t=e.i.segmentPrefetchLimit,n=e.i.prefetchAudioLanguages,r=x(e.j.variants),i=r.next(),s={};!i.done;s={Nb:void 0},i=r.next())if(s.Nb=i.value,s.Nb.audio)if(e.m.has(s.Nb.audio)){if(i=e.m.get(s.Nb.audio),Dx(i,t),!(t>0&&n.some((function(u){return function(l){return mo(u.Nb.audio.language,l)}})(s)))){var o=e.h.get(s.Nb.audio.type);i!==(o&&o.ia)&&Yr(i),e.m.delete(s.Nb.audio)}}else t<=0||!n.some((function(u){return function(l){return mo(u.Nb.audio.language,l)}})(s))||!(i=Rp(e,s.Nb.audio))||(s.Nb.audio.segmentIndex||s.Nb.audio.createSegmentIndex(),e.m.set(s.Nb.audio,i))}p.updateDuration=function(){var e=U0(),t=this.j.presentationTimeline.getDuration();t<1/0?(e&&(this.u&&this.u.stop(),fp(this.g.Z)),this.g.Z.Ab(t)):e?(this.u&&this.u.Ea(.5),this.g.Z.Ab(1/0)):this.g.Z.Ab(4294967296)};function HM(e,t){var n,r,i,s,o,u,l,f,g;return F(function(y){switch(y.g){case 1:if(dt(e.l),n=bt,t.Ka||t.qb==null||t.Xb)return y.return();if(t.qb=null,!t.Vb){y.A(2);break}return C(y,Pp(e,t,t.Ld,t.ld),3);case 3:return y.return();case 2:if(BM(e,t),t.stream.segmentIndex){y.A(4);break}return r=t.stream,Z(y,5),C(y,t.stream.createSegmentIndex(),7);case 7:ce(y,6);break;case 5:return i=se(y),C(y,Dp(e,t,i),8);case 8:return y.return();case 6:if(r!=t.stream)return r.closeSegmentIndex&&r.closeSegmentIndex(),t.Ka||t.qb||xn(e,t,0),y.return();case 4:if(!t.Fc){y.A(9);break}if(t.Fc.stream.segmentIndex){y.A(9);break}return Z(y,11),C(y,t.Fc.stream.createSegmentIndex(),13);case 13:ce(y,9);break;case 11:se(y);case 9:Z(y,14),s=GM(e,t),s!=null&&(xn(e,t,s),t.be=!1),ce(y,15);break;case 14:return o=se(y),C(y,Dp(e,t,o),16);case 16:return y.return();case 15:if(t.type===n.Na)return y.return();if(u=[],t.stream&&!t.stream.isAudioMuxedInVideo&&u.push(t),l=t.type===n.aa?n.wa:n.aa,(f=e.h.get(l))&&f.stream&&!f.stream.isAudioMuxedInVideo&&u.push(f),!e.N||!u.every(function(v){return v.endOfStream})){y.A(0);break}return C(y,e.g.Z.endOfStream(),18);case 18:dt(e.l),g=e.g.Z.getDuration(),g!=0&&g<e.j.presentationTimeline.getDuration()&&e.j.presentationTimeline.Ab(g),ie(y)}})}function GM(e,t){if(_p(t))return uM(e.g.Z,t.stream.originalId||""),null;if(t.type==Fe&&lM(e.g.Z),t.stream.isAudioMuxedInVideo&&t.type=="audio")return null;if(t.type!=Fe&&rs(e.g.Z))return jc(e,!0),null;var n=e.i.updateIntervalSeconds/Math.max(1,Math.abs(e.g.Pb()));if(!nx(e.g.Z)&&t.type!=Fe)return n/2;var r=e.g.nc();if(t.type==="audio")for(var i=x(e.m.keys()),s=i.next();!s.done;s=i.next())s=e.m.get(s.value),s.Ya(r,!0),du(s,r);i=t.Ja?t.Ja.endTime:r;var o=oM(e.g.Z,t.type,r);s=Math.max(1,Math.max(e.i.rebufferingGoal,e.i.bufferingGoal)*e.C);var u=e.j.presentationTimeline.getDuration()-i,l=Hs(e.g.Z,t.type);if(u<1e-6&&l)return t.endOfStream=!0,t.type=="video"&&(n=e.h.get(Fe))&&_p(n)&&(n.endOfStream=!0),null;if(t.endOfStream=!1,o>=s)return n/2;if(u=!t.ua,l=jx(e,t,r,l),!l)return e=1/0,(t=t.Ja)&&(e=t.endTime-t.startTime),Math.min(e/2,n);o=t.pb;var f=l.ea;o&&f&&iu(f,o)&&(o.g=f.g),o=!1,u&&t.fg&&(o=!0,t.fg=!1),u=1/0,f=Array.from(e.h.values()),f=x(f);for(var g=f.next();!g.done;g=f.next())g=g.value,_p(g)||g.ua&&!g.ua.current()||(u=Math.min(u,g.Ja?g.Ja.endTime:r));return i>=u+e.j.presentationTimeline.h?n:(t.ia&&t.ua&&!e.m.has(t.stream)&&(t.ia.Ya(l.startTime+.001),du(t.ia,l.startTime).catch(function(){})),gu(e)&&$M(e,t,l)||(XM(e,t,r,l,o).catch(function(){}),t.Fc&&Bx(e,t.Fc,r,s)),null)}function jx(e,t,n,r){if(t.ua)return(n=t.ua.current())&&t.Ja&&Math.abs(t.Ja.startTime-n.startTime)<.001&&(n=t.ua.next().value),n;if(t.Ja||r)return n=t.Ja?t.Ja.endTime:r,e=e.g.Pb()<0,t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Yb(n,!1,e)),t.ua&&t.ua.next().value;r=e.j.sequenceMode||gu(e)?0:e.i.inaccurateManifestTolerance;var i=Math.max(n-r,0);e=e.g.Pb()<0;var s=null;return r&&(t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Yb(i,!1,e)),s=t.ua&&t.ua.next().value),s||(t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Yb(n,!1,e)),s=t.ua&&t.ua.next().value),s}function XM(e,t,n,r,i){var s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X;return F(function(b){switch(b.g){case 1:if(s=bt,o=t.stream,u=t.ua,t.Ka=!0,Z(b,2),r.Kc()==2)throw new H(1,1,1011);return C(b,WM(e,t,r,i),4);case 4:return dt(e.l),e.F?b.return():(l=o.mimeType=="video/mp4"||o.mimeType=="audio/mp4",f=m.ReadableStream,e.i.lowLatencyMode&&e.j.isLowLatency&&f&&l&&(e.j.type!="HLS"||r.o)?(v=new Uint8Array(0),A=w=!1,E=function(U){var N,z,B;return F(function(W){switch(W.g){case 1:if(w||(A=!0,dt(e.l),e.F))return W.return();if(Z(W,2),v=Lt(v,U),N=!1,z=0,new ut().box("mdat",function(G){z=G.size+G.start,N=!0}).parse(v,!1,!0),!N){W.A(4);break}return B=v.subarray(0,z),v=v.subarray(z),C(W,kp(e,t,n,o,r,B,!0,i),5);case 5:t.ia&&t.ua&&du(t.ia,r.startTime,!0);case 4:ce(W,0);break;case 2:I=se(W),ie(W)}})},C(b,pu(e,t,r,E),9)):(g=pu(e,t,r),C(b,g,7)));case 7:return y=b.h,dt(e.l),e.F?b.return():(dt(e.l),t.Vb?(t.Ka=!1,xn(e,t,0),b.return()):C(b,kp(e,t,n,o,r,y,!1,i),6));case 9:if(R=b.h,I)throw I;if(A){b.A(10);break}return w=!0,dt(e.l),e.F?b.return():t.Vb?(t.Ka=!1,xn(e,t,0),b.return()):C(b,kp(e,t,n,o,r,R,!1,i),10);case 10:t.ia&&t.ua&&du(t.ia,r.startTime,!0);case 6:if(dt(e.l),e.F)return b.return();t.Ja=r,u.next(),t.Ka=!1,t.eh=!1,M=e.g.Z.Gc(),D=M[t.type],JSON.stringify(D),t.Vb||(O=null,t.type===s.wa?O=e.h.get(s.aa):t.type===s.aa&&(O=e.h.get(s.wa)),O&&O.type==s.aa?e.g.zd(r,t.stream,O.stream.isAudioMuxedInVideo,!1):e.g.zd(r,t.stream,t.stream.codecs.includes(","),!1)),ki(t),xn(e,t,0),ce(b,0);break;case 2:if(X=se(b),dt(e.l,X),e.F)return b.return();if(t.Ka=!1,X.code==7001)t.Ka=!1,ki(t),xn(e,t,0),b.A(0);else if(t.type==s.Na&&e.i.ignoreTextStreamFailures)e.h.delete(s.Na),b.A(0);else return X.code==3017?C(b,zM(e,t,X),0):(t.be=!0,X.category==1&&t.ia&&fu(t.ia,r),X.severity=2,C(b,Dp(e,t,X),0))}})}function Bx(e,t,n,r){var i,s,o,u,l,f,g,y,v,w,A,I,E;return F(function(R){switch(R.g){case 1:for(i=bt,s=t.stream,l=(u=(o=s.segmentIndex)&&o.Yb(n))&&u.next().value;l&&e.O.includes(l.startTime);)l=u&&u.next().value;if(!l){R.A(0);break}if(f=l.ea,!f||iu(f,t.pb)){R.A(3);break}return t.pb=f,Z(R,4),C(R,pu(e,t,f),6);case 6:g=R.h;var M=e.g.Z;M.C&&Hl(M.C,g,0,s),e.O=[],ce(R,3);break;case 4:throw y=se(R),t.pb=null,y;case 3:if(t.Ja&&t.Ja==l){R.A(0);break}return t.Ja=l,Z(R,8),C(R,pu(e,t,l),10);case 10:v=R.h,M=e.g.Z,M.C&&Hl(M.C,v,0,s),e.O.push(l.startTime),ce(R,9);break;case 8:throw w=se(R),t.Ja=null,w;case 9:if(t.Vb||(A=null,t.type===i.wa?A=e.h.get(i.aa):t.type===i.aa&&(A=e.h.get(i.wa)),A&&A.type==i.aa?e.g.zd(l,t.stream,A.stream.isAudioMuxedInVideo,!0):e.g.zd(l,t.stream,t.stream.codecs.includes(","),!0)),I=Math.max.apply(Math,[0].concat(Y(e.O))),E=e.g.nc(),E+r>I)return C(R,Bx(e,t,l.startTime,r),0);R.A(0)}})}function zM(e,t,n){var r,i,s,o,u,l,f;return F(function(g){switch(g.g){case 1:if(r=Array.from(e.h.values()),r.some(function(y){return y!=t&&y.eh})){g.A(2);break}if(e.i.avoidEvictionOnQuotaExceededError)return i=Lp(e,n),e.g.disableStream(t.stream,i)||xn(e,t,4),g.return();if(s=Math.round(100*e.C),s>20){e.C-=.2,g.A(3);break}if(s>4){e.C-=.04,g.A(3);break}if(o=Lp(e,n),u=e.g.disableStream(t.stream,o),!u){t.be=!0,e.F=!0,e.g.onError(n),g.A(5);break}return e.C=1,l=e.g.nc(),C(g,Nc(e,t,l),5);case 5:return g.return();case 3:return t.eh=!0,f=e.g.nc(),C(g,Nc(e,t,f),2);case 2:xn(e,t,4),ie(g)}})}function WM(e,t,n,r){var i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D;return F(function(O){switch(O.g){case 1:if(i=bt,s=t.Ja==null,o=[],u=Math.max(0,Math.max(n.appendWindowStart,e.ba)-.1),l=Math.min(n.appendWindowEnd,e.$)+.1,f=n.codecs||t.stream.codecs,g=Ji(f),y=Kn(n.mimeType||t.stream.mimeType),v=n.timestampOffset,v==t.nf&&u==t.tc&&l==t.sc&&g==t.lf&&y==t.mf){O.A(2);break}if(w=t.lf&&t.mf&&yM(e.g.Z,t.type,y,f,Bc(e)),!w){O.A(3);break}if(A=null,t.type===i.wa?A=e.h.get(i.aa):t.type===i.aa&&(A=e.h.get(i.wa)),!A){O.A(3);break}return C(O,Uc(A).catch(function(){}),5);case 5:A.pb=null,A.tc=null,A.sc=null,Mp(e,A);case 3:return C(O,Fx(e,t,v,u,l,n,g,y),2);case 2:return iu(n.ea,t.pb)||(t.pb=n.ea,n.l&&n.ea&&(I=pu(e,t,n.ea),E=function(){var X,b,U,N,z,B,W,G,re,ne,$;return F(function(Q){switch(Q.g){case 1:return Z(Q,2),C(Q,I,4);case 4:return X=Q.h,dt(e.l),b=null,U=new Map,N={projection:null,hfov:null},t.stream&&(z=t.stream.videoLayout)&&(B=z.split("/"),B.includes("PROJ-RECT")?N.projection="rect":B.includes("PROJ-EQUI")?N.projection="equi":B.includes("PROJ-HEQU")?N.projection="hequ":B.includes("PROJ-PRIM")?N.projection="prim":B.includes("PROJ-AIV")&&(N.projection="hequ")),W=new ut,W.box("moov",Ue).box("trak",Ue).box("mdia",Ue).S("mdhd",function(ae){b=xc(ae.reader,ae.version).timescale}).box("hdlr",function(ae){switch(ae=ae.reader,ae.skip(8),ae.Yc()){case"soun":U.set(i.aa,b);break;case"vide":U.set(i.wa,b)}b=null}),t.type!==i.wa||N.projection||W.box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("encv",$n).box("avc1",$n).box("avc3",$n).box("hev1",$n).box("hvc1",$n).box("dvav",$n).box("dva1",$n).box("dvh1",$n).box("dvhe",$n).box("dvc1",$n).box("dvi1",$n).box("vexu",Ue).box("proj",Ue).S("prji",function(ae){ae=ae.reader.Yc(),N.projection=ae}).box("hfov",function(ae){ae=ae.reader.U()/1e3,N.hfov=ae}),W.parse(X,!0,!0),t.type===i.wa&&KM(e,N),U.has(t.type)?n.ea.timescale=U.get(t.type):b!=null&&(n.ea.timescale=b),G=t.stream.segmentIndex,G instanceof Et&&(re=AM(G,n.startTime)),ne=t.stream.closedCaptions&&t.stream.closedCaptions.size>0,C(Q,e.g.Sh(t.type,X),5);case 5:return C(Q,Mc(e.g.Z,t.type,X,null,t.stream,ne,t.bd,r,!1,!1,re),6);case 6:ce(Q,0);break;case 2:throw $=se(Q),t.pb=null,$}})},R=n.startTime,s&&(M=Hs(e.g.Z,t.type),M!=null&&(R=M)),e.g.Dk(R,n.ea),o.push(E()))),D=t.Ja?t.Ja.i:-1,n.i!=D&&o.push(cM(e.g.Z,t.type,n.startTime)),C(O,Promise.all(o),0)}})}function Fx(e,t,n,r,i,s,o,u){var l,f,g,y,v;return F(function(w){switch(w.g){case 1:if(l=bt,f=Bc(e),Z(w,2),t.tc=r,t.sc=i,o&&(t.lf=o),u&&(t.mf=u),t.nf=n,g=e.j.sequenceMode||e.j.type=="HLS",y=null,t.type===l.wa?y=e.h.get(l.aa):t.type===l.aa&&(y=e.h.get(l.wa)),!(y&&y.stream&&y.stream.isAudioMuxedInVideo)){w.A(4);break}return C(w,ix(e.g.Z,y.type,n,r,i,g,y.stream.mimeType,y.stream.codecs,f),4);case 4:return C(w,ix(e.g.Z,t.type,n,r,i,g,s.mimeType||t.stream.mimeType,s.codecs||t.stream.codecs,f),6);case 6:ce(w,0);break;case 2:throw v=se(w),t.tc=null,t.sc=null,t.lf=null,t.mf=null,t.nf=null,v}})}function kp(e,t,n,r,i,s,o,u){o=o===void 0?!1:o,u=u===void 0?!1:u;var l,f,g,y;return F(function(v){switch(v.g){case 1:return l=r.closedCaptions&&r.closedCaptions.size>0,e.i.shouldFixTimestampOffset&&(f=r.mimeType=="video/mp4"||r.mimeType=="audio/mp4",g=null,i.ea&&(g=i.ea.timescale),f&&g&&r.type==="video"&&e.j.type=="DASH"&&new ut().box("moof",Ue).box("traf",Ue).S("tfdt",function(w){var A,I,E,R,M,D;return F(function(O){return A=vc(w.reader,w.version),I=A.baseMediaDecodeTime,I?(E=-I/g,R=Number(t.nf)||0,R<E?(M=t.tc,D=t.sc,C(O,Fx(e,t,E,M,D,i),0)):O.A(0)):O.return()})}).parse(s,!1,o)),C(v,Nc(e,t,n),2);case 2:return dt(e.l),y=t.bd,t.bd=!1,C(v,e.g.Sh(t.type,s),3);case 3:return C(v,Mc(e.g.Z,t.type,s,i,r,l,y,u,o),4);case 4:dt(e.l),ie(v)}})}function Nc(e,t,n){var r,i,s,o,u,l,f,g,y;return F(function(v){if(v.g==1)return e.H==t&&(e.H=null),r=t.stream.segmentIndex,r instanceof Et&&(r.Ya(e.j.presentationTimeline.Ib()),i=[],SM(r,function(w){i.push(w.Ve())})),s=Math.max(e.i.bufferBehind*e.C,e.j.presentationTimeline.h),o=dp(e.g.Z,t.type),o==null?v.return():(u=n-o,l=e.i.evictionGoal,f=e.j.presentationTimeline.$b(),g=e.j.presentationTimeline.Hb(),y=u-s,g-f>l&&(y=Math.max(u-s,f-l-o)),y<=l?v.return():C(v,e.g.Z.remove(t.type,o,o+y,i),2));if(v.g!=4)return dt(e.l),e.H?C(v,Nc(e,e.H,n),4):v.A(0);dt(e.l),ie(v)})}function _p(e){return e&&e.type==Fe&&(e.stream.mimeType=="application/cea-608"||e.stream.mimeType=="application/cea-708")}function pu(e,t,n,r){var i,s,o,u,l;return F(function(f){switch(f.g){case 1:if(i=n.ac())return f.return(i);if(s=null,t.ia){var g=t.ia,y=g.g;n instanceof On&&(y=g.j),y.has(n)?(g=y.get(n),r&&(g.Ah=r),s=g.me):s=null}return s||(s=Oc(n,t.stream,r||null,e.i.retryParameters,e.g.vc)),o=0,t.ua&&(o=t.ua.h),t.Va=s,C(f,s.promise,2);case 2:if(u=f.h,t.Va=null,l=u.data,!n.aesKey){f.A(3);break}return C(f,Cp(l,n.aesKey,o),4);case 4:l=f.h;case 3:return f.return(l)}})}function Oc(e,t,n,r,i,s){s=s===void 0?!1:s;var o=e instanceof Ce?e:void 0,u=o?1:0;return e=hu(e.P(),e.startByte,e.endByte,r,n),e.contentType=t.type,i.request(wr,e,{type:u,stream:t,segment:o,isPreload:s})}function Pp(e,t,n,r){var i,s;return F(function(o){if(o.g==1)return t.Vb=!1,t.Ld=!1,t.ld=0,t.Xb=!0,t.Ja=null,t.ua=null,t.ia&&!e.m.has(t.stream)&&Yr(t.ia),r?(i=e.g.nc(),s=e.g.Z.getDuration(),C(o,e.g.Z.remove(t.type,i+r,s),3)):C(o,rx(e.g.Z,t.type),4);if(o.g!=3)return dt(e.l),n?C(o,e.g.Z.flush(t.type),3):o.A(3);dt(e.l),t.Xb=!1,t.endOfStream=!1,t.Ka||t.qb||xn(e,t,0),ie(o)})}function xn(e,t,n){var r=t.type;(r!=Fe||e.h.has(r))&&(t.qb=new $a(function(){var i;return F(function(s){if(s.g==1)return Z(s,2),C(s,HM(e,t),4);if(s.g!=2)return ce(s,0);i=se(s),e.g&&e.g.onError(i),ie(s)})}).ka(n))}function ki(e){e.qb!=null&&(e.qb.stop(),e.qb=null)}function Uc(e){return F(function(t){return e.Va?C(t,e.Va.abort(),0):t.A(0)})}function Dp(e,t,n){var r;return F(function(i){if(i.g==1)return n.code==3024?(t.Ka=!1,ki(t),xn(e,t,0),i.return()):C(i,a0(e.X),2);if(dt(e.l),n.category===1&&n.code!=1003){if(t.Nc)return Nx(e,!1),i.return();r=Lp(e,n),n.handled=e.g.disableStream(t.stream,r),n.handled&&(n.severity=1)}(!n.handled||n.code!=1011)&&e.g.onError(n),n.handled||e.i.failureCallback(n),ie(i)})}function Lp(e,t){return e.i.maxDisabledTime===0&&t.code==1011?1:e.i.maxDisabledTime}function jc(e,t){t=t===void 0?!1:t;var n,r,i,s,o,u;return F(function(l){if(l.g==1){if(n=Date.now()/1e3,r=e.i.minTimeBetweenRecoveries,!t){if(!e.i.allowMediaSourceRecoveries||n-e.R<r)return l.return(!1);e.R=n}return i=bt,(s=e.h.get(i.aa))&&(ki(s),s.Va&&(s.Va.abort(),s.Va=null),s.pb=null,s.tc=null,s.sc=null,s.Ka=!1,s.Vb=!1,s.ld=0,s.Ld=!1,s.Xb=!1,s.ua&&s.ua.ih()),(o=e.h.get(i.wa))&&(ki(o),o.Va&&(o.Va.abort(),o.Va=null),o.pb=null,o.tc=null,o.sc=null,o.Ka=!1,o.Vb=!1,o.ld=0,o.Ld=!1,o.Xb=!1,o.ua&&o.ua.ih()),u=e.g.video.paused,C(l,ax(e.g.Z,Bc(e)),2)}return!o||o.Xb||o.Ka||o.qb||xn(e,o,0),!s||s.Xb||s.Ka||s.qb||xn(e,s,0),u||e.g.video.play(),l.return(!0)})}function KM(e,t){if(e.T.projection!=t.projection||e.T.hfov!=t.hfov){if(t.projection!=null||t.hfov!=null){var n=new Map().set("detail",t);n=new Se("spatialvideoinfo",n)}else n=new Se("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.T=t}}function gu(e){if(e.i.crossBoundaryStrategy!=="keep")return!0;var t=je();if(t.Bb()){if(!t.Mf()){for(t=x(e.h.keys()),n=t.next();!n.done;n=t.next())if(n=e.h.get(n.value),n.type!==bt.Na&&(n=n.stream)&&n.fullMimeTypes&&n.fullMimeTypes.size>1){for(e=new Set,t=x(n.fullMimeTypes),n=t.next();!n.done;n=t.next())e.add(Xa(n.value));return e.size>1}}}else{t=x(e.h.keys());for(var n=t.next();!n.done;n=t.next())if(n=e.h.get(n.value),n.type!==bt.Na&&(n=n.stream)&&n.fullMimeTypes&&n.fullMimeTypes.size>1)return!0}return!1}function Vx(e){e.G.Qa(),gu(e)&&(e.G.D(e.g.video,"waiting",function(){return bp(e)}),e.G.D(e.g.video,"timeupdate",function(){return bp(e)}))}function bp(e){if(gu(e)){e.K.stop();var t=e.g.nc(),n=e.h.get("video")||e.h.get("audio");n&&(n=n.pb)&&n.g!==null&&(t=n.g-t,t<0||t>1||(e.I=n.g+.1,e.K.ka(t)))}}function $M(e,t,n){if(t.type===Fe)return!1;var r=t.pb;if(!r)return!1;var i=n.ea;if(n=r.g!==i.g,e.i.crossBoundaryStrategy==="reset_to_encrypted"&&(r.encrypted||i.encrypted||(n=!1),r.encrypted&&(e.i.crossBoundaryStrategy="keep")),e.i.crossBoundaryStrategy==="RESET_ON_ENCRYPTION_CHANGE"&&r.encrypted==i.encrypted&&(n=!1),e.i.crossBoundaryStrategy==="keep"&&r.mimeType&&i.mimeType){var s=Vt(Nn(r.mimeType)),o=Vt(Nn(r.mimeType));r.mimeType==i.mimeType&&s==o&&(n=!1)}return n&&(e.J||t.bd)&&(e.J=!1,jc(e,!0).then(function(){var u=new Map().set("oldEncrypted",r.encrypted).set("newEncrypted",i.encrypted);e.g.onEvent(new Se("boundarycrossed",u))})),n}function Bc(e,t){function n(s){if(s.fullMimeTypes&&s.fullMimeTypes.size>1&&e.h.has(s.type)){var o=e.h.get(s.type),u=Hs(e.g.Z,o.type),l=e.g.nc();(o=jx(e,o,l,u))&&o.codecs&&o.mimeType&&(s.codecs=o.codecs,s.mimeType=o.mimeType)}}t=t===void 0?!1:t;var r=new Map,i=e.o.audio;return i&&(n(i),r.set("audio",i)),(i=e.o.video)&&(n(i),r.set("video",i)),t&&e.B&&r.set(Fe,e.B),r}function Fc(){}function Np(e,t,n,r,i){var s=i in r,o=s?n.constructor==Object&&Object.keys(r).length==0:n.constructor==Object&&Object.keys(n).length==0,u=s||o,l=!0,f;for(f in t){var g=i+"."+f,y=s?r[i]:n[f];u||f in n?t[f]===void 0?y===void 0||u?delete e[f]:e[f]=br(y):o?e[f]=t[f]:y.constructor==Object&&t[f]&&t[f].constructor==Object?(e[f]||(e[f]=br(y)),g=Np(e[f],t[f],y,r,g),l=l&&g):typeof t[f]!=typeof y||t[f]==null||typeof t[f]!="function"&&t[f].constructor!=y.constructor?(yn("Invalid config, wrong type for "+g),l=!1):typeof n[f]=="function"&&n[f].length!=t[f].length?(Be("Unexpected number of arguments for "+g),e[f]=t[f]):e[f]=Array.isArray(e[f])?t[f].slice():t[f]:(yn("Invalid config, unrecognized key "+g),l=!1)}return l}function Vc(e,t){for(var n={},r=n,i=0,s=0;i=e.indexOf(".",i),!(i<0);)(i==0||e[i-1]!="\\")&&(s=e.substring(s,i).replace(/\\\./g,"."),r[s]={},r=r[s],s=i+1),i+=1;return r[e.substring(s).replace(/\\\./g,".")]=t,n}function Oo(e,t){return e&&t}function Hx(e,t){function n(s){for(var o=x(Object.keys(s)),u=o.next();!u.done;u=o.next())if(u=u.value,!(s[u]instanceof HTMLElement))if(i(s[u])&&Object.keys(s[u]).length===0)delete s[u];else{var l=s[u];Array.isArray(l)&&l.length===0||typeof s[u]=="function"?delete s[u]:i(s[u])&&(n(s[u]),Object.keys(s[u]).length===0&&delete s[u])}}function r(s,o){return Object.keys(s).reduce(function(u,l){var f=s[l];return o.hasOwnProperty(l)?f instanceof HTMLElement&&o[l]instanceof HTMLElement?f.isEqualNode(o[l])||(u[l]=f):i(f)&&i(o[l])?(f=r(f,o[l]),(Object.keys(f).length>0||!i(f))&&(u[l]=f)):Array.isArray(f)&&Array.isArray(o[l])?ws(f,o[l])||(u[l]=f):Number.isNaN(f)&&Number.isNaN(o[l])||f!==o[l]&&(u[l]=f):u[l]=f,u},{})}function i(s){return s&&typeof s=="object"&&!Array.isArray(s)}return e=r(e,t),n(e),e}de("shaka.util.ConfigUtils",Fc),Fc.getDifferenceFromConfigObjects=Hx,Fc.convertToConfigObject=Vc,Fc.mergeConfigObjects=Np,de("shaka.config.RepeatMode",{OFF:0,ALL:1,SINGLE:2});function Un(){}function Gx(e){return e=ei(e),new Pt(e).Eb}function mu(e,t,n){function r(u){Ln(s).setUint32(o,u.byteLength,!0),o+=4,s.set(Le(u),o),o+=u.byteLength}if(!n||!n.byteLength)throw new H(2,6,6015);var i;typeof t=="string"?i=Th(t,!0):i=t,e=ei(e),e=Th(e,!0);var s=new Uint8Array(12+e.byteLength+i.byteLength+n.byteLength),o=0;return r(e),r(i),r(n),s}function Op(e,t,n){return t!=="skd"?e:(t=n.serverCertificate,n=ei(e).split("skd://").pop(),mu(e,n,t))}function Hc(e,t){e===2&&(e=t.drmInfo)&&ba(e.keySystem)&&(t.headers["Content-Type"]="application/octet-stream")}de("shaka.drm.FairPlay",Un),Un.commonFairPlayResponse=function(e,t){if(e===2&&(e=t.originalRequest.drmInfo)&&ba(e.keySystem)){try{var n=wt(t.data)}catch(i){return}if(e=!1,n=n.trim(),n.substr(0,5)==="<ckc>"&&n.substr(-6)==="</ckc>"&&(n=n.slice(5,-6),e=!0),!e)try{var r=JSON.parse(n);r.ckc&&(n=r.ckc,e=!0),r.CkcMessage&&(n=r.CkcMessage,e=!0),r.License&&(n=r.License,e=!0)}catch(i){}e&&(t.data=vr(xr(n)))}},Un.muxFairPlayRequest=function(e,t){Hc(e,t)},Un.expressplayFairPlayRequest=function(e,t){if(e===2){var n=t.drmInfo;n&&ba(n.keySystem)&&Hc(e,t)}},Un.conaxFairPlayRequest=function(e,t){Hc(e,t)},Un.ezdrmFairPlayRequest=function(e,t){Hc(e,t)},Un.verimatrixFairPlayRequest=function(e,t){e===2&&(e=t.drmInfo)&&ba(e.keySystem)&&(e=Le(t.body),e=pi(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=Lr("spc="+e))},Un.muxInitDataTransform=function(e,t,n){return Op(e,t,n)},Un.expressplayInitDataTransform=function(e,t,n){return Op(e,t,n)},Un.conaxInitDataTransform=function(e,t,n){if(t!=="skd")return e;t=n.serverCertificate,n=ei(e).split("skd://").pop().split("?").shift(),n=m.atob(n);var r=new ArrayBuffer(n.length*2);r=pv(r);for(var i=0,s=n.length;i<s;i++)r[i]=n.charCodeAt(i);return mu(e,r,t)},Un.ezdrmInitDataTransform=function(e,t,n){return t!=="skd"?e:(t=n.serverCertificate,n=ei(e).split(";").pop(),mu(e,n,t))},Un.verimatrixInitDataTransform=function(e,t,n){return Op(e,t,n)},Un.initDataTransform=mu,Un.defaultGetContentId=Gx,Un.isFairPlaySupported=function(){var e;return F(function(t){return t.g==1?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},Z(t,2),C(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):t.g!=2?t.return(!0):(se(t),t.return(!1))})};function Gc(e,t,n){for(n=n===void 0?!0:n,this.h=e,this.g=new Set([e]),t=t||[],e=x(t),t=e.next();!t.done;t=e.next())this.add(t.value,n)}Gc.prototype.add=function(e,t){var n=this.h;t=t===void 0?!0:t;var r;if(!(r=!!n.audio!=!!e.audio||!!n.video!=!!e.video||n.language!=e.language)&&(r=n.audio&&e.audio)){r=n.audio;var i=e.audio;r=!(!((!r.channelsCount||!i.channelsCount||r.channelsCount>2||i.channelsCount>2)&&r.channelsCount!=i.channelsCount||r.spatialAudio!==i.spatialAudio||t&&!Xx(r,i))&&ws(r.roles,i.roles)&&r.groupId===i.groupId)}return!r&&(r=n.video&&e.video)&&(n=n.video,r=e.video,r=!((!t||Xx(n,r))&&ws(n.roles,r.roles))),r?!1:(this.g.add(e),!0)},Gc.prototype.values=function(){return this.g.values()};function Xx(e,t){return e.mimeType!=t.mimeType?!1:(e=e.codecs.split(",").map(function(n){return Ji(n)}),t=t.codecs.split(",").map(function(n){return Ji(n)}),ws(e,t))}de("shaka.media.AdaptationSet",Gc);function yu(){this.h=this.g=null}yu.prototype.configure=function(e){this.g=e},yu.prototype.getConfiguration=function(){return this.g},yu.prototype.create=function(e){var t;if(this.g.language){var n=YM(e,this.g.language);n.length&&(t=n)}t||(t=e.filter(function(s){return s.primary}),t=t.length?t:e),e=qM(t,this.g.role),e.length&&(t=e),e=QM(t,this.g.videoRole),e.length&&(t=e),this.g.videoLayout&&(e=nR(t,this.g.videoLayout),e.length&&(t=e)),this.g.hdrLevel&&(e=tR(t,this.g.hdrLevel),e.length&&(t=e));var r=[this.g.channelCount,this.g.preferredAudioChannelCount];if(e=r.filter(function(s,o){return s&&r.indexOf(s)===o}),e.length){for(e=x(e),n=e.next();!n.done;n=e.next())if(n=eR(t,n.value),n.length){t=n;break}}this.g.audioLabel&&(e=JM(t,this.g.audioLabel),e.length&&(t=e)),this.g.videoLabel&&(e=ZM(t,this.g.videoLabel),e.length&&(t=e)),e=rR(t,this.g.spatialAudio),e.length&&(t=e);var i=[this.g.audioCodec,this.g.activeAudioCodec].concat(Y(this.g.preferredAudioCodecs));if(e=i.filter(function(s,o){return s&&i.indexOf(s)===o}),e.length){for(e=x(e),n=e.next();!n.done;n=e.next())if(n=iR(t,n.value),n.length){t=n;break}}return e=je(),e=this.g.codecSwitchingStrategy=="smooth"&&e.Bb(),this.h=new Gc(t[0],t,!e)},yu.prototype.getLastAdaptationSet=function(){return this.h};function YM(e,t){t=tt(t);var n=rc(t,e.map(function(r){return Bh(r)}));return n?e.filter(function(r){return n==Bh(r)}):[]}function qM(e,t){return e.filter(function(n){return n.audio?t?n.audio.roles.includes(t):n.audio.roles.length==0:!1})}function QM(e,t){return e.filter(function(n){return n.video?t?n.video.roles.includes(t):n.video.roles.length==0:!1})}function JM(e,t){return e.filter(function(n){return n.audio&&n.audio.label?n.audio.label.toLowerCase()==t.toLowerCase():!1})}function ZM(e,t){return e.filter(function(n){return n.video&&n.video.label?n.video.label.toLowerCase()==t.toLowerCase():!1})}function eR(e,t){return e.filter(function(n){return!(n.audio&&n.audio.channelsCount&&n.audio.channelsCount>t)}).sort(function(n,r){return n.audio||r.audio?n.audio?r.audio?(r.audio.channelsCount||0)-(n.audio.channelsCount||0):1:-1:0})}function tR(e,t){if(t=="AUTO"){var n=e.some(function(r){return!!(r.video&&r.video.hdr&&r.video.hdr=="HLG")});t=je().sd(n)}return e.filter(function(r){return!(r.video&&r.video.hdr&&r.video.hdr!=t)})}function nR(e,t){return e.filter(function(n){return!(n.video&&n.video.videoLayout&&n.video.videoLayout!=t)})}function rR(e,t){return e.filter(function(n){return!(n.audio&&n.audio.spatialAudio!=t)})}function iR(e,t){return e.filter(function(n){return!(n.audio&&n.audio.codecs!=t)})}function Xc(){}function Uo(){var e=1/0,t=je();navigator.connection&&navigator.connection.saveData&&(e=360);var n={retryParameters:Or(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(u,l,f){return m.shakaMediaKeysPolyfill==="apple"&&l=="skd"&&(l=f.serverCertificate,f=Gx(u),u=mu(u,f,l)),u},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:!1,minHdcpVersion:"",ignoreDuplicateInitData:!0,defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"},r="reload";t.Bb()&&(r="smooth");var i={retryParameters:Or(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,ignoreSupplementalCodecs:!1,updatePeriod:-1,ignoreDrmInfo:!1,enableAudioGroups:!0,dash:{clockSyncUri:"",disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:zc,manifestPreprocessorTXml:Wc,sequenceMode:!1,useStreamOnceInPeriodFlattening:!1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:t.fd(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0,allowRangeRequestsToGuessMimeType:!1},mss:{manifestPreprocessor:zc,manifestPreprocessorTXml:Wc,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}},s={trackSelectionCallback:function(u){return F(function(l){return l.return(u)})},downloadSizeCallback:function(u){var l;return F(function(f){return f.g==1?navigator.storage&&navigator.storage.estimate?C(f,navigator.storage.estimate(),3):f.return(!0):(l=f.h,f.return(l.usage+u<l.quota*.95))})},progressCallback:function(u,l){return Oo([u,l])},usePersistentLicense:!0,numberOfParallelDownloads:5},o={drm:n,manifest:i,streaming:{retryParameters:Or(),failureCallback:function(u){return Oo([u])},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!0,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:1,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:!1,dontChooseCodecs:!1,shouldFixTimestampOffset:!1,avoidEvictionOnQuotaExceededError:!1,crossBoundaryStrategy:"keep",returnToEndOfLiveWindowWhenOutside:!1},networking:{forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3},mediaSource:{codecSwitchingStrategy:r,addExtraFeaturesToSourceBuffer:function(u){return Oo([u],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,correctEc3Enca:!1,modifyCueCallback:function(u,l,f){return Oo([u,l,f])},dispatchAllEmsgBoxes:!1,useSourceElements:!0,durationReductionEmitsUpdateEnd:!0},offline:s,abrFactory:function(){return new At},adaptationSetCriteriaFactory:function(){return new(Function.prototype.bind.apply(yu,[null].concat(Y(Rt.apply(0,arguments)))))},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:5,minTimeToSwitch:0,preferNetworkInformationBandwidth:!1,removeLatencyFromFirstPacketTime:!0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredAudioRole:"",preferredVideoRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25,fontScaleFactor:1},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1,targets:[]},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1,poster:!0},ads:{customPlayheadTracker:!1,skipPlayDetection:!1,supportsMultipleMediaElements:!0,disableHLSInterstitial:!1,disableDASHInterstitial:!1,allowPreloadOnDomElements:!0,allowStartInMiddleOfInterstitial:!0},ignoreHardwareResolution:!1,queue:{preloadNextUrlWindow:1/0,preloadPrevItem:!0,repeatMode:0}};return s.trackSelectionCallback=function(u){return F(function(l){return l.return(sR(u,o.preferredAudioLanguage,o.preferredVideoHdrLevel))})},t.Wa(o)}function zx(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}}function _i(e,t,n){var r={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return Np(e,t,n||Uo(),r,"")}function sR(e,t,n){var r=n;r=="AUTO"&&(n=e.some(function(u){return!!(u.hdr&&u.hdr=="HLG")}),r=je().sd(n));var i=e.filter(function(u){return!(u.type!="variant"||u.hdr&&u.hdr!=r)});n=[];var s=rc(t,i.map(function(u){return u.language}));s&&(n=i.filter(function(u){return tt(u.language)==s})),n.length==0&&(n=i.filter(function(u){return u.primary})),n.length==0&&(i.map(function(u){return u.language}),n=i);var o=n.filter(function(u){return u.height&&u.height<=480});for(o.length&&(o.sort(function(u,l){return l.height-u.height}),n=o.filter(function(u){return u.height==o[0].height})),t=[],n.length&&(i=Math.floor(n.length/2),n.sort(function(u,l){return u.bandwidth-l.bandwidth}),t.push(n[i])),e=x(e),n=e.next();!n.done;n=e.next())n=n.value,n.type!=Fe&&n.type!="image"||t.push(n);return t}function zc(e){return Oo([e],e)}function Wc(e){return Oo([e],e)}de("shaka.util.PlayerConfiguration",Xc),Xc.mergeConfigObjects=_i,Xc.createDefaultForLL=zx,Xc.createDefault=Uo;function oR(){this.g=null,this.h=[]}function Up(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration),e=x(e.h);for(var r=e.next();!r.done;r=e.next())r=r.value,n+=r.state==t?r.duration:0;return n}function aR(e){function t(s){return{timestamp:s.timestamp,state:s.state,duration:s.duration}}for(var n=[],r=x(e.h),i=r.next();!i.done;i=r.next())n.push(t(i.value));return e.g&&n.push(t(e.g)),n}function uR(){this.i=this.h=null,this.g=[]}function jp(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Kc(){this.C=this.X=NaN,this.l="",this.j=this.ti=this.u=this.B=this.K=this.F=this.o=this.m=this.J=this.G=this.i=this.T=this.V=this.N=this.O=this.R=NaN,this.M=0,this.H=this.I=NaN,this.g=new oR,this.h=new uR}function lR(e,t,n){e.R=t,e.O=n}function Wx(e,t,n){e.X=t,e.C=n}function cR(e,t){e.i=isNaN(e.i)?t:Math.max(e.i,t)}function Kx(e,t){e.j=isNaN(e.j)?t:e.j+t}function dR(e){var t=e.X,n=e.C,r=e.l,i=e.B,s=e.O,o=e.R,u=e.N,l=e.V,f=e.T,g=e.u,y=e.i,v=e.G,w=e.J,A=e.m,I=Up(e.g,"playing"),E=Up(e.g,"paused"),R=Up(e.g,"buffering"),M=e.o,D=e.F,O=e.K,X=e.ti,b=e.j,U=e.M,N=e.I,z=e.H,B=aR(e.g),W=[];e=x(e.h.g);for(var G=e.next();!G.done;G=e.next())G=G.value,W.push({timestamp:G.timestamp,id:G.id,type:G.type,fromAdaptation:G.fromAdaptation,bandwidth:G.bandwidth});return{width:t,height:n,currentCodecs:r,streamBandwidth:i,decodedFrames:s,droppedFrames:o,corruptedFrames:u,stallsDetected:l,gapsJumped:f,estimatedBandwidth:g,completionPercent:y,loadLatency:v,manifestTimeSeconds:w,drmTimeSeconds:A,playTime:I,pauseTime:E,bufferingTime:R,licenseTime:M,liveLatency:D,maxSegmentDuration:O,manifestSizeBytes:X,bytesDownloaded:b,nonFatalErrorCount:U,manifestPeriodCount:N,manifestGapCount:z,stateHistory:B,switchHistory:W}}function Ar(e,t,n,r){ot.call(this),this.N=e,this.V=t,this.Da=r.networkingEngine,this.o=n,this.C=null,this.za=0,this.Ta=r.md,this.G=r.wk,this.Ua=r.xk,this.g=r.config,this.m=this.H=this.h=null,this.oa=!1,this.I=r.Ik,this.va=!1,this.j=null,this.ba=!1,this.u=null,this.M=new Map,this.ya=!1,this.Fa=r.Hk,this.X=new Kc,this.ma=new at,this.B=new at,this.O=null,this.l=!1,this.$=r.nj,this.T=this.i=null,this.R=!1,this.K=[],this.J=[],this.F=!0}J(Ar,ot);function vu(e,t,n){(e=t?e.J:e.K)?e.push(n):n()}function fR(e){if(e.J)for(var t=x(e.J),n=t.next();!n.done;n=t.next())n=n.value,n();e.J=null}function $x(e,t){if(e.O=t,e.R=!0,e.K){t=x(e.K);for(var n=t.next();!n.done;n=t.next())n=n.value,n()}e.K=null}p=Ar.prototype,p.getStartTime=function(){return this.o},p.rd=function(){return this.N},p.Kg=function(){return this.h};function hR(e){return e.va=!0,e.I}p.getStats=function(){return this.X};function pR(e){return e.ba=!0,e.j}p.Tj=function(){return this.i?Ls(this.i):null},p.Sj=function(){return this.T?bs(this.T):null};function gR(e){return e.ya=!0,e.M}p.start=function(){var e=this;(function(){var t;return F(function(n){switch(n.g){case 1:return C(n,Promise.resolve(),2);case 2:return Z(n,3),C(n,mR(e),5);case 5:if(ss(e),m.shakaMediaKeysPolyfill==="webkit"){n.A(6);break}return C(n,Yx(e),7);case 7:ss(e);case 6:return C(n,vR(e),8);case 8:if(ss(e),!e.$){n.A(9);break}return C(n,xR(e),10);case 10:ss(e);case 9:if(!e.$||!e.j){n.A(11);break}return C(n,TC(e.j),12);case 12:ss(e);case 11:e.B.resolve(),ce(n,0);break;case 3:t=se(n),t instanceof H&&(t.code==7001||t.code==7003)||e.B.reject(t),ie(n)}})})()},p.dispatchEvent=function(e){return this.O?this.O.dispatchEvent(e):ot.prototype.dispatchEvent.call(this,e)},p.onError=function(e){e.severity===2&&(this.B.reject(e),this.destroy());var t=new Map().set("detail",e);t=new Se("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)};function ss(e){if(e.l)throw new H(2,7,7003)}function Bp(e,t){e.dispatchEvent(new Se("onstatechange",new Map().set("state",t)))}function mR(e){var t,n,r,i,s,o;return F(function(u){switch(u.g){case 1:if(Bp(e,"manifest-parser"),e.m||(e.H=Av(e.N,e.V),e.m=e.H(),e.m.configure(e.g.manifest,function(){return e.F})),t=Date.now()/1e3,Bp(e,"manifest"),e.h){u.A(2);break}return C(u,e.m.start(e.N,e.Ua),3);case 3:return e.h=u.h,Qx(e.h),C(u,yR(e),2);case 2:return e.ma.resolve(),n=new Se("manifestparsed",void 0),C(u,Promise.resolve(),5);case 5:if(e.dispatchEvent(n),e.h.variants.length==0)throw new H(2,4,4036);if(Qx(e.h),r=D0(e.G,e.h),!r){u.A(6);break}return i=new Se("trackschanged",void 0),C(u,Promise.resolve(),7);case 7:ss(e),e.dispatchEvent(i);case 6:s=Date.now()/1e3,o=s-t,e.X.J=o,ie(u)}})}function Yx(e,t){var n,r,i,s;return F(function(o){switch(o.g){case 1:return!e.h||e.j?o.return():(Bp(e,"drm-engine"),e.za=Date.now()/1e3,e.j=e.Ta(),e.G.h=e.j,e.j.configure(e.g.drm,function(){return e.F}),n=ac(e.h.variants),r=!0,e.h&&e.h.presentationTimeline&&(r=e.h.presentationTimeline.W()),C(o,x0(e.j,n,e.h.offlineSessionIds,r),2));case 2:if(ss(e),!t){o.A(3);break}return C(o,e.j.Wb(t),4);case 4:ss(e);case 3:return C(o,P0(e.G,e.h),5);case 5:if(i=o.h,!i){o.A(0);break}return s=new Se("trackschanged",void 0),C(o,Promise.resolve(),7);case 7:e.dispatchEvent(s),ie(o)}})}p.configure=function(e,t){e=Vc(e,t),_i(this.g,e)},p.getConfiguration=function(){return br(this.g)};function yR(e){return F(function(t){return e.C||(e.C=e.g.adaptationSetCriteriaFactory(),e.C.configure({language:e.g.preferredAudioLanguage,role:e.g.preferredAudioRole,videoRole:e.g.preferredVideoRole,channelCount:e.g.preferredAudioChannelCount,hdrLevel:e.g.preferredVideoHdrLevel,spatialAudio:e.g.preferSpatialAudio,videoLayout:e.g.preferredVideoLayout,audioLabel:e.g.preferredAudioLabel,videoLabel:e.g.preferredVideoLabel,codecSwitchingStrategy:e.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:e.g.preferredAudioCodecs,preferredAudioChannelCount:e.g.preferredAudioChannelCount})),e.i||!e.h.variants.length||e.h.variants.length!=1&&e.h.type!="HLS"?t.A(0):(e.i=Fp(e),e.i?C(t,qx(e.i),0):t.A(0))})}function vR(e){return F(function(t){return t.g==1?!e.i||e.h.variants.includes(e.i)?t.A(0):C(t,TR(e.i),3):(e.i=Fp(e),e.i?C(t,qx(e.i),0):t.A(0))})}function xR(e){var t,n,r,i,s;return F(function(o){return!e.i&&(t=Fp(e))&&(e.i=t),e.i?(n=e.h.presentationTimeline.W(),r=[],i=e.i,i.video&&r.push(Vp(e,i.video,n)),i.audio&&r.push(Vp(e,i.audio,n)),(s=yo(e.h.textStreams,e.g.preferredTextLanguage,e.g.preferredTextRole,e.g.preferForcedSubs)[0]||null)&&r0(i.audio,s,e.g)&&(r.push(Vp(e,s,n)),e.T=s),C(o,Promise.all(r),0)):o.A(0)})}function Fp(e){if(!e.u){var t=e.g.abrFactory;e.u=t(),e.u.configure(e.g.abr)}return t=ac(e.h.variants),t=e.C.create(t),e.u.setVariants(Array.from(t.values())),e.u.chooseVariant(!0)}function Vp(e,t,n){var r,i,s,o,u;return F(function(l){return l.g==1?(r=e.g.streaming.segmentPrefetchLimit||2,i=new Dc(r,t,function(f,g,y){return Oc(f,g,y||null,e.g.streaming.retryParameters,e.Da,e.F)},!1),e.M.set(t.id,i),t.segmentIndex?l.A(2):C(l,t.createSegmentIndex(),2)):(s=typeof e.o=="number"?e.o:0,o=t.segmentIndex.Yb(s),u=null,o&&(u=o.current(),u||(u=o.next().value)),u||(u=$r(t.segmentIndex)),u?n?u.ea?C(l,_x(i,u.ea),0):l.A(0):C(l,du(i,u.startTime),0):l.A(0))})}function qx(e){var t,n,r,i;return F(function(s){for(t=[],n=x([e.video,e.audio]),r=n.next();!r.done;r=n.next())(i=r.value)&&!i.segmentIndex&&t.push(i.createSegmentIndex());return t.length>0?C(s,Promise.all(t),0):s.A(0)})}function TR(e){var t,n,r,i;return F(function(s){for(t=[],n=x([e.video,e.audio]),r=n.next();!r.done;r=n.next())(i=r.value)&&i.segmentIndex&&i.closeSegmentIndex&&t.push(i.closeSegmentIndex());return t.length>0?C(s,Promise.all(t),0):s.A(0)})}p.ol=function(){return this.B},p.destroy=function(){var e=this,t,n,r;return F(function(i){if(i.g==1)return e.l=!0,!e.m||e.oa?i.A(2):C(i,e.m.stop(),2);if(i.g!=4)return e.u&&e.u.release(),e.I&&!e.va&&e.I.release(),!e.j||e.ba?i.A(4):C(i,e.j.destroy(),4);if(e.M.size>0&&!e.ya)for(t=x(e.M.values()),n=t.next();!n.done;n=t.next())r=n.value,Yr(r);ie(i)})};function Qx(e){function t(n){return n.video&&n.audio||n.video&&n.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}de("shaka.media.PreloadManager",Ar),Ar.prototype.destroy=Ar.prototype.destroy,Ar.prototype.waitForFinish=Ar.prototype.ol,Ar.prototype.getPrefetchedTextTrack=Ar.prototype.Sj,Ar.prototype.getPrefetchedVariantTrack=Ar.prototype.Tj;function Gs(e,t){ot.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{kd:null,jd:jo,Uc:function(r,i){return Pi(n,"enter",r,i)}},{kd:xu,jd:jo,Uc:function(r,i){return Pi(n,"enter",r,i)}},{kd:Tu,jd:jo,Uc:function(r,i){return Pi(n,"enter",r,i)}},{kd:jo,jd:xu,Uc:function(r,i){return Pi(n,"exit",r,i)}},{kd:jo,jd:Tu,Uc:function(r,i){return Pi(n,"exit",r,i)}},{kd:xu,jd:Tu,Uc:function(r,i){i?Pi(n,"skip",r,i):(Pi(n,"enter",r,i),Pi(n,"exit",r,i))}},{kd:Tu,jd:xu,Uc:function(r,i){return Pi(n,"skip",r,i)}}],this.h=new et,this.h.D(this.i,"regionremove",function(r){n.g.delete(r.region)})}J(Gs,ot),Gs.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,ot.prototype.release.call(this)},Gs.prototype.j=function(e,t){if(!this.l||e!=0){this.l=!1;for(var n=x(this.i.h.values()),r=n.next();!r.done;r=n.next()){r=r.value;var i=this.g.get(r),s=e<r.startTime?xu:e>r.endTime?Tu:jo;this.g.set(r,s);for(var o=x(this.m),u=o.next();!u.done;u=o.next())u=u.value,u.kd==i&&u.jd==s&&u.Uc(r,t)}}};function Pi(e,t,n,r){t=new Se(t,new Map([["region",n],["seeking",r]])),e.dispatchEvent(t)}var xu=1,jo=2,Tu=3;/*
		 @license
		 Copyright 2013 Ali Al Dallal

		 Licensed under the MIT license.

		 Permission is hereby granted, free of charge, to any person obtaining a copy
		 of this software and associated documentation files (the "Software"), to deal
		 in the Software without restriction, including without limitation the rights
		 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
		 copies of the Software, and to permit persons to whom the Software is
		 furnished to do so, subject to the following conditions:

		 The above copyright notice and this permission notice shall be included in
		 all copies or substantial portions of the Software.

		 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
		 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
		 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
		 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
		 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
		 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
		 SOFTWARE.
		*/for(var os={ach:"Lwo",ady:"",af:"Afrikaans","af-NA":"Afrikaans (Namibia)","af-ZA":"Afrikaans (South Africa)",ak:"Ti",ar:"","ar-AR":"","ar-MA":"","ar-SA":" ()","ay-BO":"Aymar aru",az:"Azrbaycan dili","az-AZ":"Azrbaycan dili","be-BY":"",bg:"","bg-BG":"",bn:"","bn-IN":" ()","bn-BD":"()","bs-BA":"Bosanski",ca:"Catal","ca-ES":"Catal",cak:"Maya Kaqchikel","ck-US":" (tsalagi)",cs:"etina","cs-CZ":"etina",cy:"Cymraeg","cy-GB":"Cymraeg",da:"Dansk","da-DK":"Dansk",de:"Deutsch","de-AT":"Deutsch (sterreich)","de-DE":"Deutsch (Deutschland)","de-CH":"Deutsch (Schweiz)",dsb:"Dolnoserbina",el:"","el-GR":"",en:"English","en-GB":"English (UK)","en-AU":"English (Australia)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-IN":"English (India)","en-PI":"English (Pirate)","en-UD":"English (Upside Down)","en-US":"English (US)","en-ZA":"English (South Africa)","en@pirate":"English (Pirate)",eo:"Esperanto","eo-EO":"Esperanto",es:"Espaol","es-AR":"Espaol (Argentine)","es-419":"Espaol (Latinoamrica)","es-CL":"Espaol (Chile)","es-CO":"Espaol (Colombia)","es-EC":"Espaol (Ecuador)","es-ES":"Espaol (Espaa)","es-LA":"Espaol (Latinoamrica)","es-NI":"Espaol (Nicaragua)","es-MX":"Espaol (Mxico)","es-US":"Espaol (Estados Unidos)","es-VE":"Espaol (Venezuela)",et:"eesti keel","et-EE":"Eesti (Estonia)",eu:"Euskara","eu-ES":"Euskara",fa:"","fa-IR":"","fb-LT":"Leet Speak",ff:"Fulah",fi:"Suomi","fi-FI":"Suomi","fo-FO":"Froyskt",fr:"Franais","fr-CA":"Franais (Canada)","fr-FR":"Franais (France)","fr-BE":"Franais (Belgique)","fr-CH":"Franais (Suisse)","fy-NL":"Frysk",ga:"Gaeilge","ga-IE":"Gaeilge (Gaelic)",gl:"Galego","gl-ES":"Galego","gn-PY":"Avae'","gu-IN":"","gx-GR":" ",he:"","he-IL":"",hi:"","hi-IN":"",hr:"Hrvatski","hr-HR":"Hrvatski",hsb:"Hornjoserbina",ht:"Kreyl",hu:"Magyar","hu-HU":"Magyar","hy-AM":"",id:"Bahasa Indonesia","id-ID":"Bahasa Indonesia",is:"slenska","is-IS":"slenska (Iceland)",it:"Italiano","it-IT":"Italiano",ja:"","ja-JP":"","jv-ID":"Basa Jawa","ka-GE":"","kk-KZ":"",km:"","km-KH":"",kab:"Taqbaylit",kn:"","kn-IN":" (India)",ko:"","ko-KR":" ()",ku:"Kurd","ku-TR":"Kurd",la:"Latin","la-VA":"Latin",lb:"Ltzebuergesch","li-NL":"Lmbrgs",lt:"Lietuvi","lt-LT":"Lietuvi",lv:"Latvieu","lv-LV":"Latvieu",mai:", ","mg-MG":"Malagasy",mk:"","mk-MK":" ()",ml:"","ml-IN":"","mn-MN":"",mr:"","mr-IN":"",ms:"Bahasa Melayu","ms-MY":"Bahasa Melayu",mt:"Malti","mt-MT":"Malti",my:"",nb:"Norsk (bokml)","nb-NO":"Norsk (bokml)",ne:"","ne-NP":"",nl:"Nederlands","nl-BE":"Nederlands (Belgi)","nl-NL":"Nederlands (Nederland)","nn-NO":"Norsk (nynorsk)",no:"Norsk",oc:"Occitan","or-IN":"",pa:"","pa-IN":" ( )",pl:"Polski","pl-PL":"Polski","ps-AF":"",pt:"Portugus","pt-BR":"Portugus (Brasil)","pt-PT":"Portugus (Portugal)","qu-PE":"Qhichwa","rm-CH":"Rumantsch",ro:"Romn","ro-RO":"Romn",ru:"","ru-RU":"","sa-IN":"","se-NO":"Davvismegiella","si-LK":"",sk:"Slovenina","sk-SK":"Slovenina (Slovakia)",sl:"Slovenina","sl-SI":"Slovenina","so-SO":"Soomaaliga",sq:"Shqip","sq-AL":"Shqip",sr:"","sr-RS":" (Serbia)",su:"Basa Sunda",sv:"Svenska","sv-SE":"Svenska",sw:"Kiswahili","sw-KE":"Kiswahili",ta:"","ta-IN":"",te:"","te-IN":"",tg:" ","tg-TJ":"",th:"","th-TH":" ()",tl:"Filipino","tl-PH":"Filipino",tlh:"tlhIngan-Hol",tr:"Trke","tr-TR":"Trke","tt-RU":"",uk:"","uk-UA":"",ur:"","ur-PK":"",uz:"O'zbek","uz-UZ":"O'zbek",vi:"Ting Vit","vi-VN":"Ting Vit","xh-ZA":"isiXhosa",yi:"","yi-DE":" (German)",zh:"","zh-HANS":"","zh-HANT":"","zh-CN":"","zh-HK":"","zh-SG":"","zh-TW":"","zu-ZA":"isiZulu"},Jx=x(Object.keys(os)),Hp=Jx.next();!Hp.done;Hp=Jx.next()){var Zx=Hp.value;os[Zx.toLowerCase()]=os[Zx]}function eT(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map(function(o){return eT(o,e)}).join("");if(!e.payload)return e.payload;var n=[],r=e.fontWeight>=ho,i=e.fontStyle==po,s=e.textDecoration.includes(xi);return r&&n.push(["b"]),i&&n.push(["i"]),s&&n.push(["u"]),i=e.color,i==""&&t&&(i=t.color),r="",(i=tT(i))&&(r+="."+i),i=e.backgroundColor,i==""&&t&&(i=t.backgroundColor),(t=tT(i))&&(r+=".bg_"+t),r&&n.push(["c",r]),n.reduceRight(function(o,u){var l=x(u);return u=l.next().value,l=l.next().value,"<"+u+(l===void 0?"":l)+">"+o+"</"+u+">"},e.payload)}function tT(e){e=e.toLowerCase();var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(parseInt(t[1],10)|256).toString(16).slice(1)+(parseInt(t[2],10)|256).toString(16).slice(1)+(parseInt(t[3],10)|256).toString(16).slice(1):e.startsWith("#")&&e.length>7&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Gp(e,t){var n=[];e=x(nT(e));for(var r=e.next();!r.done;r=e.next())if(r=r.value,r.isContainer)n.push.apply(n,Y(Gp(r.nestedCues,r)));else{var i=r.clone();i.nestedCues=[],i.payload=eT(r,t),n.push(i)}return n}function nT(e){var t=[];e=x(e);for(var n=e.next(),r={};!n.done;r={lg:void 0},n=e.next())r.lg=n.value,t.some((function(i){return function(s){return ql(i.lg,s)}})(r))||t.push(r.lg);return t}function wR(e){function t(r){for(var i=5381,s=r.length;s;)i=i*33^r.charCodeAt(--s);return(i>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(r){}return e.textAlign=="center"&&n.align!="center"&&(n.align="middle"),e.writingMode=="vertical-lr"?n.vertical="lr":e.writingMode=="vertical-rl"&&(n.vertical="rl"),e.lineInterpretation==1&&(n.snapToLines=!1),e.line!=null&&(n.line=e.line),e.position!=null&&(n.position=e.position),n}function rT(e,t){var n=Gp(t),r=[];t=e.cues?Array.from(e.cues):[],n=x(n);for(var i=n.next(),s={};!i.done;s={vd:void 0},i=n.next())s.vd=i.value,!t.some((function(o){return function(u){return u.startTime==o.vd.startTime&&u.endTime==o.vd.endTime&&u.text==o.vd.payload}})(s))&&s.vd.payload&&(i=wR(s.vd))&&r.push(i);for(t=r.slice().sort(function(o,u){return o.startTime!=u.startTime?o.startTime-u.startTime:o.endTime!=u.endTime?o.endTime-u.startTime:"line"in VTTCue.prototype?r.indexOf(u)-r.indexOf(o):r.indexOf(o)-r.indexOf(u)}),t=x(t),n=t.next();!n.done;n=t.next())e.addCue(n.value)}function Xp(e,t){var n=!1;e.mode==="disabled"&&(n=!0,e.mode="hidden");for(var r=0;r<e.cues.length;){var i=e.cues[r];t(i)?e.removeCue(i):r++}n&&(e.mode="disabled")}function Gt(e){var t=this;this.i=e,this.l=new et,this.j=null,this.h=new Map,this.g=-1,this.u=!1,this.o=null,this.C=function(){t.l.Ma(t.i,"textchanged",t.m),t.l.Ma(t.j.textTracks,"change",t.B);for(var n=x(t.h.values()),r=n.next();!r.done;r=n.next())r.value.remove();t.h.clear(),t.g=-1,t.j=null},this.m=function(){var n=new Map,r=t.i.Lc();r=x(r);for(var i=r.next();!i.done;i=r.next()){if(i=i.value,t.h.has(i.id)){var s=t.h.get(i.id);i.active||s.track.mode==="disabled"||(s.track.mode="disabled"),t.h.delete(i.id)}else{s=t.j.ownerDocument.createElement("track"),s.kind=SR(i);var o=s,u=void 0;if(i.label)u=i.label;else if(i.language)if(i.language in os)u=os[i.language];else{var l=nc(i.language);l in os&&(u=os[l]+" ("+i.language+")")}u||(u=i.originalTextId,i.language&&i.language!==i.originalTextId&&(u+=" ("+i.language+")")),o.label=u,i.language in os&&(s.srclang=i.language),s.src="data:,WEBVTT",s.track.mode="disabled",t.j.appendChild(s)}n.set(i.id,s),i.active&&(t.g=i.id)}for(r=x(t.h.values()),i=r.next();!i.done;i=r.next())i.value.remove();t.g>-1&&(n.has(t.g)?(r=n.get(t.g).track,r.mode==="disabled"&&(r.mode=t.u?"showing":"hidden")):t.g=-1),t.h=n},this.B=function(){if(!t.o){var n=t.j;t.o=new Ve(function(){if(t.o=null,t.j===n){var r=-1,i=!1;if(t.h.has(t.g)){var s=t.h.get(t.g);s.track.mode==="showing"?(r=t.g,i=!0):s.track.mode==="hidden"&&(r=t.g)}if(!i)for(i=x(t.h),s=i.next();!s.done;s=i.next()){var o=x(s.value);if(s=o.next().value,o=o.next().value,o.track.mode==="showing"){r=s;break}else r<0&&o.track.mode==="hidden"&&(r=s)}for(i=x(t.h),s=i.next();!s.done;s=i.next())o=x(s.value),s=o.next().value,o=o.next().value,s!==r&&o.track.mode!=="disabled"&&(o.track.mode="disabled");t.g!==r&&(t.g=r,r>-1&&t.i.oh({id:r})),t.i.uh(r>-1&&t.h.get(r).track.mode==="showing")}}).ka(0)}},this.l.D(e,"loaded",function(){return t.enableTextDisplayer()}),this.enableTextDisplayer()}p=Gt.prototype,p.configure=function(){},p.remove=function(e,t){if(this.i)this.h.has(this.g)&&Xp(this.h.get(this.g).track,function(n){return n.startTime<t&&n.endTime>e});else return!1;return!0},p.append=function(e){this.h.has(this.g)&&rT(this.h.get(this.g).track,e)},p.destroy=function(){return this.i&&(this.j&&this.C(),this.i=null),this.l&&(this.l.release(),this.l=null),Promise.resolve()},p.isTextVisible=function(){return this.u},p.setTextVisibility=function(e){if(this.u=e,this.h.has(this.g)){var t=this.h.get(this.g).track;t.mode!=="disabled"&&(e=e?"showing":"hidden",t.mode!==e&&(t.mode=e))}else if(this.i&&this.i.Zd()===3)if(t=Array.from(this.i.$e().textTracks).filter(function(r){return["captions","subtitles","forced"].includes(r.kind)}),e){e=null,t=x(t);for(var n=t.next();!n.done;n=t.next())if(n=n.value,n.mode==="showing"){e=null;break}else e||n.mode!=="hidden"||(e=n);e&&(e.mode="showing")}else for(e=x(t),t=e.next();!t.done;t=e.next())t=t.value,t.mode==="showing"&&(t.mode="hidden")},p.setTextLanguage=function(){},p.enableTextDisplayer=function(){!this.j&&this.i&&this.i.Zd()===2&&(this.j=this.i.$e(),this.l.Aa(this.i,"unloading",this.C),this.l.D(this.i,"textchanged",this.m),this.l.D(this.j.textTracks,"change",this.B),this.m())};function SR(e){var t=je();return e.forced&&t.Ha()==="WEBKIT"?"forced":e.kind==="caption"||e.roles&&e.roles.some(function(n){return n.includes("transcribes-spoken-dialog")})&&e.roles.some(function(n){return n.includes("describes-music-and-sound")})?"captions":"subtitles"}de("shaka.text.NativeTextDisplayer",Gt),Gt.prototype.enableTextDisplayer=Gt.prototype.enableTextDisplayer,Gt.prototype.setTextLanguage=Gt.prototype.setTextLanguage,Gt.prototype.setTextVisibility=Gt.prototype.setTextVisibility,Gt.prototype.isTextVisible=Gt.prototype.isTextVisible,Gt.prototype.destroy=Gt.prototype.destroy,Gt.prototype.append=Gt.prototype.append,Gt.prototype.remove=Gt.prototype.remove,Gt.prototype.configure=Gt.prototype.configure;function ln(e,t){for(qe("SimpleTextDisplayer","Please migrate to NativeTextDisplayer"),this.h=e,this.i=t,this.g=null,e=x(Array.from(this.h.textTracks)),t=e.next();!t.done;t=e.next())t=t.value,t.kind!=="metadata"&&t.kind!=="chapters"&&(t.mode="disabled",t.label==this.i&&(this.g=t));this.g&&(this.g.mode="hidden")}p=ln.prototype,p.configure=function(){},p.remove=function(e,t){return this.g?(Xp(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0):!1},p.append=function(e){this.g&&rT(this.g,e)},p.destroy=function(){return this.g&&(Xp(this.g,function(){return!0}),this.g.mode="disabled"),this.g=this.h=null,Promise.resolve()},p.isTextVisible=function(){return this.g?this.g.mode=="showing":!1},p.setTextVisibility=function(e){e&&!this.g&&iT(this),this.g&&(this.g.mode=e?"showing":"hidden")},p.setTextLanguage=function(){},p.enableTextDisplayer=function(){iT(this)};function iT(e){e.h&&!e.g&&(e.g=e.h.addTextTrack("subtitles",e.i),e.g.mode="hidden")}de("shaka.text.SimpleTextDisplayer",ln),ln.prototype.enableTextDisplayer=ln.prototype.enableTextDisplayer,ln.prototype.setTextLanguage=ln.prototype.setTextLanguage,ln.prototype.setTextVisibility=ln.prototype.setTextVisibility,ln.prototype.isTextVisible=ln.prototype.isTextVisible,ln.prototype.destroy=ln.prototype.destroy,ln.prototype.append=ln.prototype.append,ln.prototype.remove=ln.prototype.remove,ln.prototype.configure=ln.prototype.configure;function cn(){}p=cn.prototype,p.configure=function(){},p.remove=function(){},p.append=function(){},p.destroy=function(){},p.isTextVisible=function(){return!1},p.setTextVisibility=function(){},p.setTextLanguage=function(){},p.enableTextDisplayer=function(){},de("shaka.text.StubTextDisplayer",cn),cn.prototype.enableTextDisplayer=cn.prototype.enableTextDisplayer,cn.prototype.setTextLanguage=cn.prototype.setTextLanguage,cn.prototype.setTextVisibility=cn.prototype.setTextVisibility,cn.prototype.isTextVisible=cn.prototype.isTextVisible,cn.prototype.destroy=cn.prototype.destroy,cn.prototype.append=cn.prototype.append,cn.prototype.remove=cn.prototype.remove,cn.prototype.configure=cn.prototype.configure;function dn(e,t){var n=this;this.m=!1,this.h=[],this.j=e,this.o=t,this.C=this.u=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.B=new Ve(function(){n.j.paused||as(n)}),wu(this),this.l=new Map,this.i=new et,this.i.D(document,"fullscreenchange",function(){as(n,!0)}),this.i.D(this.j,"seeking",function(){as(n,!0)}),this.i.D(this.j,"ratechange",function(){wu(n)}),this.i.D(this.j,"resize",function(){var r=n.j,i=r.videoWidth;r=r.videoHeight,i&&r?n.u=i/r:n.u=null}),this.F=null,"ResizeObserver"in m&&(this.F=new ResizeObserver(function(){as(n,!0)}),this.F.observe(this.g)),this.G=new Map}p=dn.prototype,p.configure=function(e){this.C=e,wu(this),as(this,!0)},p.append=function(e){var t=[].concat(Y(this.h));e=x(nT(e));for(var n=e.next(),r={};!n.done;r={mg:void 0},n=e.next())r.mg=n.value,t.some((function(i){return function(s){return ql(s,i.mg)}})(r))||this.h.push(r.mg);this.h.length&&wu(this),as(this)},p.destroy=function(){return this.g&&(this.g.parentElement&&this.o.removeChild(this.g),this.g=null,this.m=!1,this.h=[],this.B&&(this.B.stop(),this.B=null),this.l.clear(),this.i&&(this.i.release(),this.i=null),this.F&&(this.F.disconnect(),this.F=null)),Promise.resolve()},p.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter(function(r){return r.startTime<e||r.endTime>=t}),as(this,n>this.h.length),this.h.length||wu(this),!0},p.isTextVisible=function(){return this.m},p.setTextVisibility=function(e){(this.m=e)?(this.g.parentElement||this.o.appendChild(this.g),as(this,!0)):this.g.parentElement&&this.o.removeChild(this.g)},p.setTextLanguage=function(e){e&&e!="und"?this.g.setAttribute("lang",e):this.g.setAttribute("lang","")},p.enableTextDisplayer=function(){};function wu(e){e.B&&(e.h.length?e.B.Ea((e.C?e.C.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(e.j.playbackRate))):e.B.stop())}function AR(e,t){for(;t!=null;){if(t==e.g)return!0;t=t.parentElement}return!1}function sT(e,t,n,r,i){var s=!1,o=[],u=[];t=x(t);for(var l=t.next();!l.done;l=t.next()){l=l.value,i.push(l);var f=e.l.get(l),g=l.startTime<=r&&l.endTime>r,y=f?f.lj:null;f&&(o.push(f.ng),f.$c&&o.push(f.$c),g||(s=!0,e.l.delete(l),f=null)),g&&(u.push(l),f?AR(e,y)||(s=!0):(ER(e,l,i),f=e.l.get(l),y=f.lj,s=!0)),l.nestedCues.length>0&&y&&sT(e,l.nestedCues,y,r,i),i.pop()}if(s){for(r=x(o),i=r.next();!i.done;i=r.next())i=i.value,i.parentElement&&i.parentElement.removeChild(i);for(u.sort(function(v,w){return v.startTime!=w.startTime?v.startTime-w.startTime:v.endTime-w.endTime}),u=x(u),r=u.next();!r.done;r=u.next())r=e.l.get(r.value),r.$c?(r.$c.contains(n)&&r.$c.removeChild(n),n.appendChild(r.$c),r.$c.appendChild(r.ng)):n.appendChild(r.ng)}}function as(e,t){if(e.g){var n=e.j.currentTime;if(!e.m||t!==void 0&&t){t=x(e.G.values());for(var r=t.next();!r.done;r=t.next())ou(r.value);ou(e.g),e.l.clear(),e.G.clear()}e.m&&sT(e,e.h,e.g,n,[])}}function ER(e,t,n){var r=n.length>1,i=r?"span":"div";t.lineBreak&&(i="br"),t.rubyTag&&(i=t.rubyTag),r=!r&&t.nestedCues.length>0;var s=document.createElement(i);if(i!="br"&&CR(e,s,t,n,r),n=null,t.region&&t.region.id){var o=t.region,u=e.u===4/3?2.5:1.9;if(n=o.id+"_"+o.width+"x"+o.height+(o.heightUnits==Wn?"%":"px")+"-"+o.viewportAnchorX+"x"+o.viewportAnchorY+(o.viewportAnchorUnits==Wn?"%":"px"),e.G.has(n))n=e.G.get(n);else{i=document.createElement("span");var l=o.heightUnits==Wn?"%":"px",f=o.widthUnits==Wn?"%":"px",g=o.viewportAnchorUnits==Wn?"%":"px";i.id="shaka-text-region---"+n,i.classList.add("shaka-text-region"),i.style.position="absolute";var y=o.height,v=o.width;o.heightUnits===2&&(y=o.height*5.33,l="%"),o.widthUnits===2&&(v=o.width*u,f="%"),i.style.height=y+l,i.style.width=v+f,o.viewportAnchorUnits===2?(u=o.viewportAnchorY/75*100,l=o.viewportAnchorX/(e.u===4/3?160:210)*100,u-=o.regionAnchorY*y/100,l-=o.regionAnchorX*v/100,i.style.top=u+"%",i.style.left=l+"%"):(i.style.top=o.viewportAnchorY-o.regionAnchorY*y/100+g,i.style.left=o.viewportAnchorX-o.regionAnchorX*v/100+g),o.heightUnits!==0&&o.widthUnits!==0&&o.viewportAnchorUnits!==0&&(o=Math.max(0,Math.min(100-(parseInt(i.style.width.slice(0,-1),10)||0),parseInt(i.style.left.slice(0,-1),10)||0)),i.style.top=Math.max(0,Math.min(100-(parseInt(i.style.height.slice(0,-1),10)||0),parseInt(i.style.top.slice(0,-1),10)||0))+"%",i.style.left=o+"%"),i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="center",i.style.justifyContent=t.displayAlign=="before"?"flex-start":t.displayAlign=="center"?"center":"flex-end",e.G.set(n,i),n=i}}i=s,r&&(i=document.createElement("span"),i.classList.add("shaka-text-wrapper"),i.style.backgroundColor=t.backgroundColor,i.style.lineHeight="normal",s.appendChild(i)),e.l.set(t,{ng:s,lj:i,$c:n})}function IR(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==Jl?n:e==="left"||e==="start"&&t===Ha||e==="end"&&t==="rtl"?"line-left":e==="right"||e==="start"&&t==="rtl"||e==="end"&&t===Ha?"line-right":"center"}function CR(e,t,n,r,i){var s=t.style,o=n.nestedCues.length==0,u=r.length>1;s.whiteSpace="pre-wrap";var l=n.payload.replace(/\s+$/g,function(g){return"".repeat(g.length)});if(s.webkitTextStrokeColor=n.textStrokeColor,s.webkitTextStrokeWidth=n.textStrokeWidth,s.color=n.color,s.direction=n.direction,s.opacity=n.opacity,s.paddingLeft=zp(n.linePadding,n,e.o),s.paddingRight=zp(n.linePadding,n,e.o),s.textCombineUpright=n.textCombineUpright,s.textShadow=n.textShadow,n.backgroundImage)s.backgroundImage="url('"+n.backgroundImage+"')",s.backgroundRepeat="no-repeat",s.backgroundSize="contain",s.backgroundPosition="center",n.backgroundColor&&(s.backgroundColor=n.backgroundColor),s.width="100%",s.height="100%";else{if(n.nestedCues.length)var f=t;else f=document.createElement("span"),t.appendChild(f);n.border&&(f.style.border=n.border),i||((t=MR(r,function(g){return g.backgroundColor}))?f.style.backgroundColor=t:l&&(f.style.backgroundColor="rgba(0, 0, 0, 0.8)")),l&&(f.setAttribute("translate","no"),f.textContent=l)}u&&!r[r.length-1].isContainer?s.display="inline":(s.display="flex",s.flexDirection="column",s.alignItems="center",n.textAlign=="left"||n.textAlign=="start"?(s.width="100%",s.alignItems="start"):(n.textAlign=="right"||n.textAlign=="end")&&(s.width="100%",s.alignItems="end"),s.justifyContent=n.displayAlign=="before"?"flex-start":n.displayAlign=="center"?"center":"flex-end"),o||(s.margin="0"),s.fontFamily=n.fontFamily,s.fontWeight=n.fontWeight.toString(),s.fontStyle=n.fontStyle,s.letterSpacing=n.letterSpacing,r=e.C?e.C.fontScaleFactor:1,(r!==1||n.fontSize)&&(s.fontSize=zp(n.fontSize||"1em",n,e.o,r)),r=n.line,r!=null&&(o=n.lineInterpretation,o==Ga&&(o=1,u=16,e.u&&e.u<1&&(u=32),r=r<0?100+r/u*100:r/u*100),o==1&&(s.position="absolute",n.writingMode==_s?(s.width="100%",n.lineAlign==Ps?s.top=r+"%":n.lineAlign=="end"&&(s.bottom=100-r+"%")):n.writingMode=="vertical-lr"?(s.height="100%",n.lineAlign==Ps?s.left=r+"%":n.lineAlign=="end"&&(s.right=100-r+"%")):(s.height="100%",n.lineAlign==Ps?s.right=r+"%":n.lineAlign=="end"&&(s.left=100-r+"%")))),s.lineHeight=n.lineHeight,e=IR(n),e=="line-left"?(s.cssFloat="left",n.position!==null&&(s.position="absolute",n.writingMode==_s?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%")):e=="line-right"?(s.cssFloat="right",n.position!==null&&(s.position="absolute",n.writingMode==_s?(s.right=100-n.position+"%",s.width="auto"):s.bottom=n.position+"%")):n.position!==null&&n.position!=50&&(s.position="absolute",n.writingMode==_s?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%",n.size&&(s.transform="translateX(-50%)")),s.textAlign=n.textAlign,s.textDecoration=n.textDecoration.join(" "),s.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&s.writingMode==n.writingMode||(s.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==_s?s.width=n.size+"%":s.height=n.size+"%")}function zp(e,t,n,r){r=r===void 0?1:r;var i=(i=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(i[1]),unit:i[2]}:null;if(!i)return e;switch(e=i.unit,r*=i.value,e){case"%":return r/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*r/t.cellResolution.rows+"px";default:return r+e}}function MR(e,t){for(var n=e.length-1;n>=0;n--){var r=t(e[n]);if(r||r===0)return r}return null}de("shaka.text.UITextDisplayer",dn),dn.prototype.enableTextDisplayer=dn.prototype.enableTextDisplayer,dn.prototype.setTextLanguage=dn.prototype.setTextLanguage,dn.prototype.setTextVisibility=dn.prototype.setTextVisibility,dn.prototype.isTextVisible=dn.prototype.isTextVisible,dn.prototype.remove=dn.prototype.remove,dn.prototype.destroy=dn.prototype.destroy,dn.prototype.append=dn.prototype.append,dn.prototype.configure=dn.prototype.configure;function RR(e,t){function n(s){for(var o=s,u=x(t),l=u.next();!l.done;l=u.next())l=l.value,l.end&&l.start<s&&(o+=l.end-l.start);return s=Math.floor(o/3600),u=Math.floor(o/60%60),l=Math.floor(o%60),o=Math.floor(o*1e3%1e3),(s<10?"0":"")+s+":"+(u<10?"0":"")+u+":"+(l<10?"0":"")+l+"."+(o<100?o<10?"00":"0":"")+o}var r=Gp(e);e="WEBVTT\n\n",r=x(r);for(var i=r.next();!i.done;i=r.next())i=i.value,e+=n(i.startTime)+" --> "+n(i.endTime)+(function(s){var o=[];switch(s.textAlign){case"left":o.push("align:left");break;case"right":o.push("align:right");break;case ii:o.push("align:middle");break;case"start":o.push("align:start");break;case"end":o.push("align:end")}switch(s.writingMode){case"vertical-lr":o.push("vertical:lr");break;case"vertical-rl":o.push("vertical:rl")}return o.length?" "+o.join(" "):""})(i)+"\n",e+=i.payload+"\n\n";return e}de("shaka.text.WebVttGenerator",function(){});function Wp(e,t){this.g=t,this.j=e,this.m=new Map,this.l=void 0,this.F=!1,this.J=!0,this.u=this.I=!1,this.C=this.B=void 0,this.H=0,this.K={request:!1,response:!1,event:!1},this.o={},this.i=new et,this.G=[],this.h=null}Wp.prototype.setMediaElement=function(e){this.h=e,LR(this)},Wp.prototype.configure=function(e){this.g=e,bR(this)};function kR(e){e.m.clear(),e.F=!1,e.J=!0,e.I=!1,e.u=!1,e.B=0,e.C=0,e.H=0,e.K={request:!1,response:!1,event:!1},oT(e),e.o={},e.h=null,e.i.Qa()}function _R(e,t){e.u=t,e.u?e.l==Zc?e.l=ed:e.l==td&&(e.l=nd):e.l==ed?e.l=Zc:e.l==nd&&(e.l=td)}function PR(e,t){if(e.g&&e.g.enabled&&(fn(e,"ps",{dd:"d"}),e.h&&e.h.autoplay)){var n=e.h.play();n&&n.then(function(){e.H=t}).catch(function(){e.H=0})}}function DR(e,t,n){try{if(!e.g.enabled)return t;var r=$p(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var i=Yc;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":i=Qc;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":i=hT;break e}i=void 0}r.ot=i,r.su=!0;var s=Su(r);return $c(t,s)}catch(o){return ir("CMCD_SRC_ERROR","Could not generate src CMCD data.",o),t}}function LR(e){e.i.D(e.h,"playing",function(){e.C||(e.C=Date.now()),fn(e,"ps",{dd:"p"})}),e.i.D(e.h,"volumechange",function(){fn(e,e.h.muted?"m":"um")}),e.i.D(e.h,"play",function(){e.B||(e.B=Date.now(),fn(e,"ps",{dd:"s"}))}),e.i.D(e.h,"pause",function(){fn(e,"ps",{dd:"a"})}),e.i.D(e.j,"buffering",function(){fn(e,"ps",{dd:"w"})}),e.i.D(e.h,"seeking",function(){return fn(e,"ps",{dd:"k"})}),e.i.D(document,"fullscreenchange",function(){fn(e,document.fullscreenElement?"pe":"pc")});var t=e.h;(t.webkitPresentationMode||t.webkitSupportsFullscreen)&&e.i.D(t,"webkitpresentationmodechanged",function(){t.webkitPresentationMode?fn(e,t.webkitPresentationMode!=="inline"?"pe":"pc"):t.webkitSupportsFullscreen&&fn(e,t.webkitDisplayingFullscreen?"pe":"pc")}),e.i.D(e.h,"enterpictureinpicture",function(){fn(e,"pe")}),e.i.D(e.h,"leavepictureinpicture",function(){fn(e,"pc")}),"documentPictureInPicture"in m&&e.i.D(m.documentPictureInPicture,"enter",function(n){fn(e,"pe"),e.i.Aa(n.window,"pagehide",function(){fn(e,"pc")})}),e.i.D(document,"visibilitychange",function(){document.hidden?fn(e,"b",{bg:!0}):fn(e,"b")}),e.i.D(e.j,"complete",function(){fn(e,"ps",{dd:"e"})})}function bR(e){oT(e);var t=aT(e);t=x(t);for(var n=t.next();!n.done;n=t.next())if(n=n.value.timeInterval,n===void 0&&(n=KR),n>=1){var r=new Ve(function(){return fn(e,$R)});r.Ea(n),e.G.push(r)}}function oT(e){if(e.G)for(var t=x(e.G),n=t.next();!n.done;n=t.next())n.value.stop();e.G=[]}function aT(e){return(e=e.g.targets)?e.filter(function(t){return t.mode===vT&&t.enabled}):[]}function Kp(e){return(e=e.g.targets)?e.filter(function(t){return t.mode===yT&&t.enabled===!0}):[]}function $p(e){return e.g.sessionId||(e.g.sessionId=m.crypto.randomUUID()),{v:e.g.version,sf:e.l,sid:e.g.sessionId,cid:e.g.contentId,mtp:e.j.getBandwidthEstimate()/1e3}}function fn(e,t,n){if(n=n===void 0?{}:n,t=Object.assign({e:t,ts:Date.now()},n),t=Qp(e,t,vT),n=e.g.targets,!(e.g.version<Zp)&&n){var r=aT(e);n=Array.from(new Set([].concat(Y(eg),Y(XR)))),r=x(r);for(var i=r.next();!i.done;i=r.next()){i=i.value;var s=Yp(i.includeKeys||[],n);s.includes(gT)||s.push(gT),s=qp(t,s);var o=i.events||[],u=s.e,l=s.sta;u&&(!zR.includes(u)||!(u!=="ps"||l&&WR.includes(l))||o&&o.length>0&&!o.includes(u))||uT(e,s,i)}}}function Bo(e,t,n){if(e.g.enabled){n=Qp(e,n,mT);var r=lT({mode:mT,useHeaders:e.g.useHeaders,includeKeys:e.g.includeKeys||[]});e.o[r]||(e.o[r]={request:1,response:1}),n.sn=e.o[r].request++,r=e.g.includeKeys||[];var i=e.g.version==Zp?Array.from(new Set([].concat(Y(eg),Y(HR)))):pT;r=Yp(r,i),n=qp(n,r),NR(e,n,t,e.g.useHeaders)}}function uT(e,t,n,r){var i=Or(),s=n.url;if(n.useHeaders){if(t=fT(t),!Object.keys(t).length)return;r&&Object.assign(r.headers,t),r=Nt([s],i),Object.assign(r.headers,t)}else{if(t=Su(t),!t)return;s=$c(s,t),r&&(r.uri=s),r=Nt([s],i)}e.j.Zb().request(9,r)}function NR(e,t,n,r){if(r){if(t=fT(t),!Object.keys(t).length)return;Object.assign(n.headers,t)}else{var i=Su(t);if(!i)return;n.uris=n.uris.map(function(s){return $c(s,i)})}Kp(e).length>0||!e.m.has(n)||e.m.delete(n)}function Yp(e,t){if(!e||e.length===0)return t;for(var n=x(e),r=n.next();!r.done;r=n.next())t.includes(r.value);return e=e.filter(function(i){return t.includes(i)})}function qp(e,t){return Object.keys(e).reduce(function(n,r){return t.includes(r)&&(n[r]=e[r]),n},{})}function OR(e){if(e.type===0)return BR;if(e=e.stream){var t=e.type;if(t=="video")return e.codecs&&e.codecs.includes(",")?Qc:qc;if(t=="audio")return Yc;if(t=="text")return e.mimeType==="application/mp4"?Jc:Jp}}function lT(e){var t=Object.keys(e).sort().reduce(function(n,r){return r!=="enabled"&&(n[r]=e[r]),n},{});return JSON.stringify(t)}function UR(e,t){if(t=e.j.Gc()[t],!t.length)return NaN;var n=e.h?e.h.currentTime:0;return(e=t.find(function(r){return r.start<=n&&r.end>=n}))?(e.end-n)*1e3:NaN}function cT(e,t){if(t=e.j.Gc()[t],!t.length)return 0;var n=e.h?e.h.currentTime:0;return(e=t.find(function(r){return r.start<=n&&r.end>=n}))?(e.end-n)*1e3:0}function jR(e,t){var n=e.j.qc();if(!n.length)return NaN;e=n[0],n=x(n);for(var r=n.next();!r.done;r=n.next())r=r.value,r.type==="variant"&&r.bandwidth>e.bandwidth&&(e=r);switch(t){case qc:return e.videoBandwidth||NaN;case Yc:return e.audioBandwidth||NaN;default:return e.bandwidth}}function dT(e,t,n){var r=t.segment,i=0;r&&(i=r.endTime-r.startTime),i={d:i*1e3,st:e.j.W()?VR:FR},i.ot=OR(t);var s=i.ot===qc||i.ot===Yc||i.ot===Qc||i.ot===Jc;if(t=t.stream){var o=e.j.Pb();if(s&&(i.bl=UR(e,t.type),i.ot!==Jc)){var u=cT(e,t.type);i.dl=o?u/Math.abs(o):u}if(t.bandwidth&&(i.br=t.bandwidth/1e3),t.segmentIndex&&r){if((o=t.segmentIndex.Yb(r.endTime,!0,o<0))&&(o=o.next().value)&&o!=r){if(n&&!Wi(r.P(),o.P())){var l=o.P()[0];u=new URL(l);var f=new URL(n);if(u.origin!==f.origin)n=l;else{n=u.pathname.split("/").slice(1),l=f.pathname.split("/").slice(1,-1),f=Math.min(n.length,l.length);for(var g=0;g<f&&n[g]===l[g];g++)n.shift(),l.shift();for(;l.length;)l.shift(),n.unshift("..");n=n.join("/")+u.search+u.hash}i.nor=n}!o.startByte&&!o.endByte||r.startByte==o.startByte&&r.endByte==o.endByte||(n=o.startByte+"-",o.endByte&&(n+=o.endByte),i.nrr=n)}o=e.j.Pb()||1,n=cT(e,t.type)||500,r=(t=t.bandwidth)?t*(r.endTime-r.startTime)/1e3/(n/o/1e3)*e.g.rtpSafetyFactor:NaN,isNaN(r)||(i.rtp=r)}}return s&&i.ot!==Jc&&(i.tb=jR(e,i.ot)/1e3),i}function Qp(e,t,n){Object.assign(t,$p(e)),t.pr=e.j.Pb();var r=t.ot===qc||t.ot===Qc;return e.I&&r&&(t.bs=!0,t.su=!0,e.I=!1),t.su==null&&(t.su=e.J),e.j.W()&&(r=FT(e.j),t.ltc=r||void 0),document.hidden&&(t.bg=!0),r=e.C&&e.B?e.C-(e.H||e.B):void 0,r==null||e.K[n]||(t.msd=r,e.K[n]=!0),t}function Su(e){function t(y){return n(y/100)*100}function n(y){return Math.round(y)}function r(y){return!Number.isNaN(y)&&y!=null&&y!==""&&y!==!1}var i=[],s={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(y){return encodeURIComponent(y)},rtp:t,tb:n,ttfb:n,ttlb:n},o=Object.keys(e||{}).sort();o=x(o);for(var u=o.next();!u.done;u=o.next()){u=u.value;var l=e[u];if(r(l)&&(u!=="v"||l!==1)&&(u!="pr"||l!==1)){var f=s[u];f&&(l=f(l)),f=typeof l;var g=void 0;g=f==="string"&&u!=="ot"&&u!=="sf"&&u!=="st"?u+"="+JSON.stringify(l):f==="boolean"?u:f==="symbol"?u+"="+l.description:u+"="+l,i.push(g)}}return i.join(",")}function fT(e){var t=Object.keys(e),n={},r=["Object","Request","Session","Status"],i=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,url:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,ttfb:1,ttlb:1,ts:1,rc:1,cmsdd:1,cmsds:1,sn:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3,bg:3};t=x(t);for(var o=t.next();!o.done;o=t.next())o=o.value,i[s[o]!=null?s[o]:1][o]=e[o];for(e=0;e<i.length;e++)(s=Su(i[e]))&&(n["CMCD-"+r[e]]=s);return n}function $c(e,t){return!t||e.includes("offline:")?e:(e=new Pt(e),e.g.set("CMCD",t),e.toString())}var hT="m",Yc="a",qc="v",Qc="av",BR="i",Jp="c",Jc="tt",Zp=2,FR="v",VR="l",Zc="d",ed="ld",td="h",nd="lh";de("shaka.util.CmcdManager.StreamingFormat",{DASH:Zc,Ql:ed,HLS:td,Rl:nd,gm:"s",OTHER:"o"});var pT="br bl bs cid d dl mtp nor nrr ot pr rtp sf sid st su tb v".split(" "),eg="br ab bl tbl bs cdn cid ltc mtp pr sf sid bg sta st ts tpb tb lb tab lab pt ec msd v sn".split(" "),HR="ab bl tbl bs cdn cid d dl ltc mtp nor ot pr rtp sf sid bg sta st su ts tpb tb lb tab lab pt ec msd v".split(" "),GR="d dl nor ot rtp rc su ttfb ttfbb ttlb url cmsdd cmsds".split(" "),XR=["e","sta"],zR="ps e t c b m um pe pc".split(" "),WR="spawkrfeqd".split(""),KR=10,gT="ts",$R="t",mT="request",yT="response",vT="event";function Er(e){this.h=e,this.g=null}p=Er.prototype,p.configure=function(e){this.h=e},p.gi=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(wT)?this.g.get(wT)*1e3:null},p.di=function(){return this.h.enabled&&this.g&&this.g.has(TT)?this.g.get(TT)*1e3:null},p.Vj=function(){return this.h.enabled&&this.g&&this.g.has(ST)?this.g.get(ST):null},p.Wj=function(){return this.h.enabled&&this.g&&this.g.has(AT)?this.g.get(AT):null},p.getBandwidthEstimate=function(e){var t=this.di();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return n>0&&n<=1?e*(1-n)+t*n:e};function xT(e){return e?e.toLowerCase()==="false"?!1:/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""):!0}de("shaka.util.CmsdManager",Er),Er.prototype.getBandwidthEstimate=Er.prototype.getBandwidthEstimate,Er.prototype.getRoundTripTime=Er.prototype.Wj,Er.prototype.getResponseDelay=Er.prototype.Vj,Er.prototype.getEstimatedThroughput=Er.prototype.di,Er.prototype.getMaxBitrate=Er.prototype.gi;var TT="etp",wT="mb",ST="rd",AT="rtt";function ET(){this.g=null,this.h=[]}function tg(e,t){return F(function(n){if(n.g==1)return e.g?C(n,new Promise(function(r){return e.h.push(r)}),2):n.A(2);e.g=t,ie(n)})}ET.prototype.release=function(){this.h.length>0?this.h.shift()():this.g=null};function IT(e,t,n){return n=n===void 0?Number.EPSILON:n,e===t?!0:(e=Math.abs(e-t),e<=n?!0:n!==Number.EPSILON?Math.abs(e-n)<=Number.EPSILON:!1)}function te(e,t,n){t=t===void 0?null:t,ot.call(this);var r=this;this.m=ld,this.h=null,this.Ae=t,this.$=!1,this.Ke=new et,this.Be=new et,this.j=new et,this.ec=new et,this.Gd=new et,this.G=this.H=this.F=this.N=null,this.Le=0,this.ba=new ET,this.O=this.Fa=this.X=this.i=this.zc=this.I=this.l=this.xe=this.T=this.Nh=this.va=this.K=this.kb=this.za=this.ze=this.R=this.Ta=this.M=this.bc=null,this.Ua=!1,this.Fe=this.o=null,this.Ee=1e9,this.Je=[],this.yc=new Map,this.ob=[],this.$f=-1,this.g=qr(this),this.cg=zx(),this.V=null,this.Me=-1,this.dc=null,this.ya={width:1/0,height:1/0},this.De=new Qh(this.g,this.ya,null),this.He=[],this.B=null,this.J=this.g.adaptationSetCriteriaFactory(),this.J.configure({language:this.g.preferredAudioLanguage,role:this.g.preferredAudioRole,videoRole:this.g.preferredVideoRole,channelCount:0,hdrLevel:this.g.preferredVideoHdrLevel,spatialAudio:this.g.preferSpatialAudio,videoLayout:this.g.preferredVideoLayout,audioLabel:this.g.preferredAudioLabel,videoLabel:this.g.preferredVideoLabel,codecSwitchingStrategy:this.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:this.g.preferredAudioCodecs,preferredAudioChannelCount:this.g.preferredAudioChannelCount}),this.Kd=this.g.preferredTextLanguage,this.Nd=this.g.preferredTextRole,this.Md=this.g.preferForcedSubs,this.Ce=[],n&&n(this),this.K=new Wp(this,this.g.cmcd),this.va=new Er(this.g.cmsd),this.N=DT(this),this.ma=this.oa=this.Da=this.C=null,this.eg=!1,this.ag=[],this.dg=new Ve(function(){return F(function(i){if(i.g==1)return r.oa?C(i,r.Wb(r.ma,!0),3):i.A(0);if(i.g!=4)return C(i,r.load(r.oa),4);r.eg?r.ma.pause():r.ma.play(),r.oa=null,r.eg=!1,ie(i)})}),cd&&(this.C=cd(),this.C.configure(this.g.ads),this.Gd.D(this.C,"ad-content-pause-requested",function(i){var s,o;return F(function(u){if(u.g==1)return r.dg.stop(),r.oa?u.A(0):(r.ma=r.h,r.eg=r.fe(),s=i.saveLivePosition||!1,o=!0,r.W()&&(o=s),C(u,r.Yh(!0,o),3));r.oa=u.h,ie(u)})}),this.Gd.D(this.C,"ad-content-resume-requested",function(i){if(i=i.offset||0,r.oa){var s=r.oa;s.o&&i&&(typeof s.o=="number"?s.o+=i:s.o.setTime(s.o.getTime()+i*1e3))}r.dg.ka(.1)}),this.Gd.D(this.C,"ad-content-attach-requested",function(){return F(function(i){if(i.g==1)return r.h||!r.ma?i.A(0):C(i,r.Wb(r.ma,!0),3);r.ma=null,ie(i)})})),dd&&(this.Da=dd(this),this.Da.configure(this.g.queue)),this.Ke.D(m,"online",function(){ug(r),r.jh()}),this.Ge=new Ve(function(){for(var i=Date.now()/1e3,s=!1,o=!0,u=x(r.i.variants),l=u.next();!l.done;l=u.next())l=l.value,l.disabledUntilTime>0&&l.disabledUntilTime<=i&&(l.disabledUntilTime=0,s=!0),l.disabledUntilTime>0&&(o=!1);o&&r.Ge.stop(),s&&ls(r,!1,void 0,!1,!1)}),this.eb=null,e&&(qe("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Wb(e,!0)),this.u=null}J(te,ot);function rd(e){e.T!=null&&(wv(e.T),e.T.release(),e.T=null)}function YR(e,t,n){n||t.lcevc.enabled?(rd(e),e.T==null&&(e.T=new Na(e.h,e.Nh,t.lcevc,n),e.H&&(e.H.C=e.T))):rd(e)}function ct(e,t){return new Se(e,t)}p=te.prototype,p.destroy=function(){var e=this,t;return F(function(n){switch(n.g){case 1:return e.m==Ur?n.return():(rd(e),t=e.detach(),e.m=Ur,C(n,t,2));case 2:return C(n,e.qg(),3);case 3:if(e.Ke&&(e.Ke.release(),e.Ke=null),e.Be&&(e.Be.release(),e.Be=null),e.j&&(e.j.release(),e.j=null),e.ec&&(e.ec.release(),e.ec=null),e.Gd&&(e.Gd.release(),e.Gd=null),e.Fe=null,e.g=null,e.B=null,e.Ae=null,e.K=null,e.va=null,!e.N){n.A(4);break}return C(n,e.N.destroy(),5);case 5:e.N=null;case 4:e.o&&(e.o.release(),e.o=null),e.Da&&(e.Da.destroy(),e.Da=null),ot.prototype.release.call(e),ie(n)}})};function CT(e,t){t1.set(e,t)}function Fo(e,t){e.dispatchEvent(ct("onstatechange",new Map().set("state",t)))}p.Wb=function(e,t){t=t===void 0?!0:t;var n=this,r,i,s;return F(function(o){switch(o.g){case 1:if(n.m==Ur)throw new H(2,7,7e3);if(r=n.h&&n.h==e,!n.h||n.h==e){o.A(2);break}return C(o,n.detach(),2);case 2:return C(o,ng(n,"attach"),4);case 4:if(o.h)return o.return();if(Z(o,5,6),r||(Fo(n,"attach"),i=function(){var u=lg(n,!1);u&&Vo(n,u)},n.Be.D(e,"error",i),n.h=e,n.K&&n.K.setMediaElement(e)),je(),!t||!oi()||n.H){o.A(6);break}return C(o,rg(n),6);case 6:ye(o),n.ba.release(),Oe(o,0);break;case 5:return s=se(o),C(o,n.detach(),10);case 10:throw s}})},p.oj=function(e){this.Nh=e},p.detach=function(e){e=e===void 0?!1:e;var t=this;return F(function(n){if(n.g==1){if(t.m==Ur)throw new H(2,7,7e3);return C(n,t.Cc(!1,e),2)}if(n.g!=3)return C(n,ng(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.Be.Qa(),t.h=null),Fo(t,"detach"),t.C&&!e&&t.C.release()}finally{t.ba.release()}ie(n)})};function ng(e,t){var n;return F(function(r){return r.g==1?(n=++e.Le,C(r,tg(e.ba,t),2)):n!=e.Le?(e.ba.release(),r.return(!0)):r.return(!1)})}p.Cc=function(e,t){e=e===void 0?!0:e,t=t===void 0?!1:t;var n=this,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M;return F(function(D){switch(D.g){case 1:return n.m!=Ur&&(n.m=ld),C(D,ng(n,"unload"),2);case 2:return D.h?D.return():(ge(D,3),n.Ua=!1,Fo(n,"unload"),rd(n),r=n.Ce.map(function(O){return O()}),n.Ce=[],C(D,Promise.all(r),5));case 5:if(n.dispatchEvent(ct("unloading")),n.ze&&(n.ze.release(),n.ze=null),n.za&&(n.za.release(),n.za=null),n.kb&&(n.kb.release(),n.kb=null),n.h&&(n.j.Qa(),n.ec.Qa()),n.Ge.stop(),n.bc&&(n.bc.release(),n.bc=null),n.Ta&&(n.Ta.stop(),n.Ta=null),!n.I){D.A(6);break}return C(D,n.I.stop(),7);case 7:n.I=null,n.zc=null;case 6:if(n.o&&n.o.stop(),!n.l){D.A(8);break}return C(D,n.l.destroy(),9);case 9:n.l=null;case 8:if(n.M&&(n.M.release(),n.M=null),n.G&&(n.G.release(),n.G=null),m.shakaMediaKeysPolyfill!=="webkit"||!n.F){D.A(10);break}return C(D,n.F.destroy(),11);case 11:n.F=null;case 10:if(!n.H){D.A(12);break}return C(D,n.H.destroy(),13);case 13:n.H=null;case 12:if(n.C&&!t&&n.C.onAssetUnload(),n.oa&&!t&&(n.oa.destroy(),n.oa=null),t||n.dg.stop(),n.K&&kR(n.K),n.va&&(n.va.g=null),!n.u){D.A(14);break}return C(D,n.u.destroy(),15);case 15:n.u=null;case 14:if(n.$=!1,n.h){for(i=x(n.ag),s=i.next();!s.done;s=i.next())o=s.value,o.src.startsWith("blob:")&&URL.revokeObjectURL(o.src),o.remove();n.ag=[],Ac(n.h)&&n.h.load()}if(!n.F){D.A(16);break}return C(D,n.F.destroy(),17);case 17:n.F=null;case 16:if(n.eb&&n.X!=n.eb.rd()&&(n.eb.l||n.eb.destroy(),n.eb=null),n.X=null,n.Fa=null,n.R=null,n.i){for(u=x(n.i.variants),l=u.next();!l.done;l=u.next())for(f=l.value,g=x([f.audio,f.video]),y=g.next();!y.done;y=g.next())(v=y.value)&&v.segmentIndex&&v.segmentIndex.release();for(w=x(n.i.textStreams),A=w.next();!A.done;A=w.next())I=A.value,I.segmentIndex&&I.segmentIndex.release()}for(n.g&&n.g.streaming.clearDecodingCache&&(uc.clear(),oo.clear()),n.i=null,n.B=new Kc,n.Mh=null,n.dc=null,n.V=null,n.Me=-1,n.Je=[],E=x(n.yc.values()),R=E.next();!R.done;R=E.next())M=R.value,M.stop();n.yc.clear(),n.ob=[],n.$f=-1,n.N&&n.N.Uh(),Au(n);case 3:ye(D),n.ba.release(),Oe(D,4);break;case 4:if(je(),e&&oi()&&!n.H&&n.h)return C(D,rg(n),0);D.A(0)}})},p.ll=function(e){this.O=e},p.load=function(e,t,n){t=t===void 0?null:t;var r=this,i,s,o,u,l,f,g,y,v,w,A,I,E,R;return F(function(M){switch(M.g){case 1:if(r.m==Ur)throw new H(2,7,7e3);if(r.h||!r.ma){M.A(2);break}return C(M,r.Wb(r.ma,!0),3);case 3:r.ma=null;case 2:if(i=null,s="",e instanceof Ar){if(e.l)throw new H(2,7,7006);i=e,s=i.rd()||""}else s=e||"";return C(M,tg(r.ba,"load"),4);case 4:if(r.ba.release(),!r.h)throw new H(2,7,7002);if(!r.X){M.A(5);break}return r.X=s,C(M,r.Cc(!1),5);case 5:if(o=++r.Le,u=function(){return F(function(D){if(D.g==1)return r.Le==o?D.A(0):i?C(D,i.destroy(),3):D.A(3);throw new H(2,7,7e3)})},l=function(D,O){return F(function(X){switch(X.g){case 1:return ge(X,2),C(X,tg(r.ba,O),4);case 4:return C(X,u(),5);case 5:return C(X,D(),6);case 6:return C(X,u(),7);case 7:i&&r.g&&(i.g=r.g);case 2:ye(X),r.ba.release(),Oe(X,0)}})},Z(M,7,8),t==null&&i&&(t=i.getStartTime()),r.O=t,r.Ua=!1,r.dispatchEvent(ct("loading")),i){n=i.V,M.A(10);break}if(n){M.A(10);break}return C(M,l(function(){return F(function(D){if(D.g==1)return C(D,_T(r,s),2);n=D.h,ie(D)})},"guessMimeType_"),10);case 10:if(f=!!i,i){$x(i,r),r.B=i.getStats(),M.A(13);break}return C(M,RT(r,s,t,n,!0,r.g),14);case 14:(i=M.h)?(i.F=!1,$x(i,r),r.B=i.getStats(),i.start(),i.B.catch(function(){})):r.B=new Kc;case 13:return g=!i,y=Date.now()/1e3,r.B=i?i.getStats():new Kc,r.X=s,r.Fa=n||null,Au(r),v=function(){var D=r.h?r.h.buffered:null;return{start:K0(D)||0,end:Sc(D)||0}},r.za=new cu(v),r.za.addEventListener("regionadd",function(D){ig(r,D.region,"metadataadded")}),g?C(M,l(function(){return F(function(D){return C(D,ZR(r,n),0)})},"initializeSrcEqualsDrmInner_"),25):(r.kb=new cu(v),C(M,l(function(){return F(function(D){if(D.g==1)return C(D,Promise.race([i.ma,i.B]),2);r.zc=i.H;var O=i;O.oa=!0,r.I=O.m,r.i=i.Kg(),ie(D)})},"waitForFinish"),17));case 17:if(r.H){M.A(18);break}return C(M,l(function(){return F(function(D){return C(D,rg(r),0)})},"initializeMediaSourceEngineInner_"),18);case 18:return r.i&&r.i.textStreams.length&&(r.u.enableTextDisplayer?r.u.enableTextDisplayer():qe("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),C(M,l(function(){return F(function(D){return C(D,i.B,0)})},"waitForFinish"),20);case 20:if(r.g=i.getConfiguration(),r.De=i.G,r.I&&r.I.setMediaElement&&r.h&&r.I.setMediaElement(r.h),r.ze=hR(i),r.xe=i.Fa,(w=i.C)&&(r.J=w),f&&r.h&&r.h.nodeName==="AUDIO"&&(qR(r),r.configure("manifest.disableVideo",!0)),i.j){M.A(21);break}return C(M,l(function(){return F(function(D){return C(D,Yx(i,r.h),0)})},"drmEngine_.init"),21);case 21:return r.F=pR(i),C(M,l(function(){return F(function(D){return C(D,r.F.Wb(r.h),0)})},"drmEngine_.attach"),23);case 23:return A=r.g.abrFactory,r.o&&r.Fe==A||(r.Fe=A,r.o&&r.o.release(),r.o=A(),typeof r.o.setMediaElement!="function"&&(qe("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),r.o.setMediaElement=function(){}),typeof r.o.setCmsdManager!="function"&&(qe("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),r.o.setCmsdManager=function(){}),typeof r.o.trySuggestStreams!="function"&&(qe("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),r.o.trySuggestStreams=function(){}),r.o.configure(r.g.abr)),I=gR(i),E=i.i,C(M,l(function(){return F(function(D){return C(D,JR(r,y,E,I),0)})},"loadInner_"),24);case 24:fR(i),r.Fa&&je().ej()&&ec(r.Fa)&&rM(r.H,r.X,r.Fa),M.A(16);break;case 25:return C(M,l(function(){return F(function(D){return C(D,ek(r,y,n),0)})},"srcEqualsInner_"),16);case 16:r.dispatchEvent(ct("loaded"));case 8:if(ye(M),!i){M.A(27);break}return C(M,i.destroy(),27);case 27:r.eb=null,Oe(M,0);break;case 7:if(R=se(M),!R||R.code==7e3){M.A(29);break}return C(M,r.Cc(!1),29);case 29:throw R}})};function qR(e){for(var t=x(e.i.variants),n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter(function(r){return r.audio})}p.hj=function(e,t,n){e=e===void 0?!0:e,t=t===void 0?!1:t,n=n===void 0?!1:n;var r=this,i;return F(function(s){return s.g==1?C(s,MT(r,n),2):s.g!=3?(i=s.h,C(s,r.Cc(e,t),3)):s.return(i)})},p.Yh=function(e,t){e=e===void 0?!1:e,t=t===void 0?!1:t;var n=this,r;return F(function(i){return i.g==1?C(i,MT(n,t),2):i.g!=3?(r=i.h,C(i,n.detach(e),3)):i.return(r)})};function MT(e,t){t=t===void 0?!1:t;var n,r,i;return F(function(s){if(s.g==1)return n=null,e.i&&e.I&&e.zc&&e.X&&e.g?(r=e.h.currentTime,t||(r=null),C(s,kT(e,e.X,r,e.Fa,e.g,!0,!1),3)):s.A(2);if(s.g!=2){n=s.h,e.He.push(n),e.I&&e.I.setMediaElement&&e.I.setMediaElement(null),(i=e.l?e.l.o:null)&&(n.i=i);var o=n,u=e.I,l=e.zc;o.h=e.i,o.m=u,o.H=l,n.C=e.J,n.start(),e.i=null,e.I=null,e.zc=null,e.o=null,e.Fe=null}return s.return(n)})}p.preload=function(e,t,n,r){t=t===void 0?null:t;var i=this,s,o;return F(function(u){return u.g==1?(s=qr(i),_i(s,r||i.g,qr(i)),C(u,RT(i,e,t,n,!1,s),2)):((o=u.h)?o.start():Vo(i,new H(2,7,7005)),u.return(o))})},p.qg=function(){var e=this,t,n,r,i;return F(function(s){for(t=[],n=x(e.He),r=n.next();!r.done;r=n.next())i=r.value,i.l||t.push(i.destroy());return e.He=[],C(s,Promise.all(t),0)})};function RT(e,t,n,r,i,s){i=i===void 0?!1:i;var o,u,l;return F(function(f){return f.g==1?r?f.A(2):C(f,_T(e,t),3):(f.g!=2&&(r=f.h),QR(e,r)?f.return(null):(o=s||e.g,u=!1,i&&e.h&&e.h.nodeName==="AUDIO"&&(u=!0),l=kT(e,t,n,r||null,o,!i,u),l=i?l.then(function(g){return g.F=!1,g}):l.then(function(g){return e.He.push(g),g}),f.return(l)))})}function kT(e,t,n,r,i,s,o){s=s===void 0?!0:s,o=o===void 0?!1:o;var u,l,f,g,y,v,w,A,I,E,R,M,D,O,X;return F(function(b){return b.g==1?(u=null,l=br(i),o&&(l.manifest.disableVideo=!0),f=function(){return u.R&&u.l?null:u},g=function(){return f()?f().getConfiguration():e.g},e.ya.width!=1/0||e.ya.height!=1/0||e.g.ignoreHardwareResolution?b.A(2):(y=je(),C(b,y.lc(),3))):(b.g!=2&&(v=b.h,e.ya.width=v.width,e.ya.height=v.height),w=new Qh(l,e.ya,null),A={networkingEngine:e.N,filter:function(U){var N,z;return F(function(B){if(B.g==1)return C(B,P0(w,U),2);if(B.g!=4)return N=B.h,N?(z=ct("trackschanged"),C(B,Promise.resolve(),4)):B.A(0);u.dispatchEvent(z),ie(B)})},makeTextStreamsForClosedCaptions:function(U){return hk(e,U)},onTimelineRegionAdded:function(U){wp(u.I,U)},onEvent:function(U){return u.dispatchEvent(U)},onError:function(U){return u.onError(U)},isLowLatencyMode:function(){return g().streaming.lowLatencyMode},updateDuration:function(){e.l&&u.R&&e.l.updateDuration()},newDrmInfo:function(U){var N=u.j,z=N?N.g:null;z&&N.B&&b0(w,z.keySystem,U)},onManifestUpdated:function(){var U=new Map().set("isLive",e.W());u.dispatchEvent(ct("manifestupdated",U)),vu(u,!1,function(){e.C&&e.C.onManifestUpdated(e.W())})},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(U,N,z,B){var W=U;(U=="com.apple.hls.interstitial"||U=="com.apple.hls.overlay")&&(W="com.apple.quicktime.HLS",U={startTime:N,endTime:z,values:B},e.C&&e.C.onHLSInterstitialMetadata(e,e.h,U)),B=x(B),U=B.next();for(var G={};!U.done;G={ah:void 0},U=B.next())G.ah=U.value,G.ah.name!="ID"&&vu(u,!1,(function(re){return function(){sg(e,N,z,W,re.ah)}})(G))},disableStream:function(U){return e.disableStream(U,e.g.streaming.maxDisabledTime)},addFont:function(U,N){return e.addFont(U,N)}},I=new cu(function(){return e.Ra()}),I.addEventListener("regionadd",function(U){var N=U.region;Cu(e,"timelineregionadded",N,u),vu(u,!1,function(){e.C&&(e.C.onDashTimedMetadata(N),e.C.onDASHInterstitialMetadata(e,e.h,N))})}),E=null,l.streaming.observeQualityChanges&&(E=new _c(function(){return e.Gc()}),E.addEventListener("qualitychange",function(U){QT(e,U.quality,U.position)}),E.addEventListener("audiotrackchange",function(U){QT(e,U.quality,U.position,!0)})),R=!0,M={vc:e.N,onError:function(U){return u.onError(U)},yf:function(U){vu(u,!0,function(){e.F&&gk(e,U)})},onExpirationUpdated:function(U,N){var z=ct("expirationupdated");u.dispatchEvent(z),(z=u.m)&&z.onExpirationUpdated&&z.onExpirationUpdated(U,N)},onEvent:function(U){u.dispatchEvent(U),U.type=="drmsessionupdate"&&R&&(R=!1,U=Date.now()/1e3-u.za,(e.B||u.getStats()).m=U,e.T&&wv(e.T))}},D=DT(e,f),d0(e.N,D),O=function(){return e.md(M)},X={config:l,xk:A,Ik:I,Hk:E,md:O,wk:w,networkingEngine:D,nj:s},u=new Ar(t,r,n,X),b.return(u))})}function _T(e,t){var n,r,i,s;return F(function(o){return o.g==1?(n=e.g.manifest.retryParameters,C(o,Lo(t,e.N,n),2)):(r=o.h,r=="application/x-mpegurl"&&(i=je(),i.Ha()==="WEBKIT"&&(r="application/vnd.apple.mpegurl")),r=="video/quicktime"&&(s=je(),s.Ha()==="CHROMIUM"&&(r="video/mp4")),o.return(r))})}function QR(e,t){if(!oi(je()))return!0;if(t){if((e.h||Bs()).canPlayType(t)=="")return!1;if(!oi(je())||!uo.has(t.toLowerCase()))return!0;if(ec(t))return je().Ha()==="WEBKIT"&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls;if(t==="application/dash+xml"||t==="video/vnd.mpeg.dash.mpd")return e.g.streaming.preferNativeDash}return!1}function id(e,t){var n=e.g.textDisplayFactory;e.Mh!==n||t!==void 0&&t?(t=e.u,e.u=n(),e.u.configure?e.u.configure(e.g.textDisplayer):qe("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.u.setTextLanguage||qe("Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),t?(e.u.setTextVisibility(t.isTextVisible()),t.destroy().catch(function(){})):e.u.setTextVisibility(e.$),e.H&&fM(e.H,e.u),e.Mh=n,e.l&&jM(e.l)):e.u&&e.u.configure&&e.u.configure(e.g.textDisplayer)}function rg(e){var t,n,r;return F(function(i){if(i.g==1)return je(),Fo(e,"media-source"),e.g.mediaSource.useSourceElements&&Ac(e.h),id(e),t=uk(e.h,e.u,{Nj:function(){return e.keySystem()},onMetadata:function(s,o,u){s=x(s);for(var l=s.next();!l.done;l=s.next())if(l=l.value,l.data&&typeof l.cueTime=="number"&&l.frames){var f=l.cueTime+o,g=u;g&&f>g&&(g=f);for(var y=x(l.frames),v=y.next();!v.done;v=y.next())sg(e,f,g,"org.id3",v.value);e.C&&e.C.onHlsTimedMetadata(l,f)}},Ck:function(s){e.kb&&wp(e.kb,{schemeIdUri:s.schemeIdUri,startTime:s.startTime,endTime:s.endTime,id:String(s.id),emsg:s})},onEvent:function(s){return e.dispatchEvent(s)},Ek:function(){e.I&&e.I.update&&e.I.update()}},e.T,e.g.mediaSource),n=e.g.manifest,r=n.segmentRelativeVttTiming,t.Fa=r,C(i,t.M,2);e.H=t,ie(i)})}function PT(e,t,n){function r(){return og(e)}if(e.j.D(t,"playing",r),e.j.D(t,"pause",r),e.j.D(t,"ended",r),e.j.D(t,"ratechange",function(){var s=e.h.playbackRate;s!=0&&(e.M&&(e.M.set(s),e.m==an&&e.o.playbackRateChanged(s),HT(e,s)),s=ct("ratechange"),e.dispatchEvent(s))}),t.remote&&(e.j.D(t.remote,"connect",function(){e.l&&t.remote.state=="connected"&&Di(e),Cn(e)}),e.j.D(t.remote,"connecting",function(){return Cn(e)}),e.j.D(t.remote,"disconnect",function(){return F(function(s){if(s.g==1)return e.l&&t.remote.state=="disconnected"?C(s,jc(e.l),3):s.A(2);s.g!=2&&Di(e),Cn(e),ie(s)})})),t.audioTracks&&(e.j.D(t.audioTracks,"addtrack",function(){return Cn(e)}),e.j.D(t.audioTracks,"removetrack",function(){return Cn(e)}),e.j.D(t.audioTracks,"change",function(){return Cn(e)})),t.videoTracks&&(e.j.D(t.videoTracks,"addtrack",function(){return Cn(e)}),e.j.D(t.videoTracks,"removetrack",function(){return Cn(e)}),e.j.D(t.videoTracks,"change",function(){return Cn(e)})),(t.webkitPresentationMode||t.webkitSupportsFullscreen)&&e.j.D(t,"webkitpresentationmodechanged",function(){e.Ae&&id(e,!0)}),t.textTracks){var i=function(){e.m===Qn&&e.u instanceof Gt&&Di(e),Cn(e)};e.j.D(t.textTracks,"addtrack",function(s){if(s.track)switch(s=s.track,s.kind){case"metadata":rk(e,s);break;case"chapters":ik(e,s);break;default:i()}}),e.j.D(t.textTracks,"removetrack",i),e.j.D(t.textTracks,"change",i)}t.preload!="none"&&e.j.Aa(t,"loadedmetadata",function(){e.B.G=Date.now()/1e3-n})}function JR(e,t,n,r){var i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$;return F(function(Q){switch(Q.g){case 1:for(Fo(e,"load"),i=e.h,e.M=new lu({bf:function(){return i.playbackRate},Tc:function(){return i.defaultPlaybackRate},sh:function(ae){i.playbackRate=ae},Bi:function(ae){i.currentTime+=ae}}),PT(e,i,t),("onchange"in m.screen)&&e.j.D(m.screen,"change",function(){if(e.J.getConfiguration){var ae=e.J.getConfiguration();ae.hdrLevel=="AUTO"?us(e):e.g.preferredVideoHdrLevel=="AUTO"&&e.g.abr.enabled&&(ae.hdrLevel="AUTO",e.J.configure(ae),us(e))}}),s=!1,o=x(e.i.variants),u=o.next();!u.done;u=o.next())l=u.value,(f=l.video&&l.video.dependencyStream)&&(s=Sv(f));YR(e,e.g,s),e.Kd=e.g.preferredTextLanguage,e.Nd=e.g.preferredTextRole,e.Md=e.g.preferForcedSubs,cg(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.o.init(function(ae,le,be){e.i&&e.l&&ae!=e.l.o&&Eu(e,ae,!0,le===void 0?!1:le,be===void 0?0:be)}),e.o.setMediaElement(i),e.o.setCmsdManager(e.va),e.l=lk(e),e.l.configure(e.g.streaming),e.m=an,e.dispatchEvent(ct("streaming")),g=n;case 2:for((v=e.l.o)||g||(g=XT(e,!0)),w=[],y=v||g,A=x([y.video,y.audio]),I=A.next();!I.done;I=A.next())(E=I.value)&&!E.segmentIndex&&(w.push(E.createSegmentIndex()),E.dependencyStream&&w.push(E.dependencyStream.createSegmentIndex()));if(!(w.length>0)){Q.A(4);break}return C(Q,Promise.all(w),4);case 4:if(!y||y.disabledUntilTime!=0){Q.A(2);break}if(us(e),e.I&&e.I.onInitialVariantChosen&&e.I.onInitialVariantChosen(y),e.i.isLowLatency&&(e.g.streaming.lowLatencyMode?e.configure(e.cg):Be("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),e.K&&(_R(e.K,e.i.isLowLatency&&e.g.streaming.lowLatencyMode),PR(e.K,t*1e3)),cg(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),NM(e.l,e.g.playRangeStart,e.g.playRangeEnd),e.Ua=!0,e.dispatchEvent(ct("canupdatestarttime")),R=function(ae){e.G=sk(e,ae),e.bc=ok(e,ae),LT(e,i,!1)},e.g.streaming.startAtSegmentBoundary||(M=e.O,M==null&&e.i.startTime&&(M=e.i.startTime),R(M)),v){Q.A(7);break}if(!e.g.streaming.startAtSegmentBoundary){Q.A(8);break}return D=e.i.presentationTimeline,e.O instanceof Date&&(X=D.m||D.i,b=e.O.getTime()/1e3-X,b!=null&&(O=b)),O==null&&(O=typeof e.O=="number"?e.O:e.h.currentTime),e.O==null&&e.i.startTime&&(O=e.i.startTime),U=D.$b(),N=D.Hb(),O<U?O=U:O>N&&(O=N),C(Q,pk(g,O),9);case 9:z=Q.h,R(z);case 8:Eu(e,g,!0,!1,0);case 7:return e.G.ready(),B=e.Lc().find(function(ae){return ae.active}),B||((W=yo(e.i.textStreams,e.Kd,e.Nd,e.Md)[0]||null)&&jp(e.B.h,W,!0),g&&(W?(r0(g.audio,W,e.g)&&(e.$=!0),e.$&&e.u.setTextVisibility(!0)):(e.$=!1,e.u.setTextVisibility(!1)),YT(e)),W&&(e.g.streaming.alwaysStreamText||e.Rg())&&(Lc(e.l,W),Iu(e))),C(Q,e.l.start(r),10);case 10:e.g.abr.enabled&&(e.o.enable(),qT(e)),Cn(e),e.i.variants.some(function(ae){return ae.primary}),((G=e.W())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.i.serviceDescription||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(re=function(){return GT(e)},e.j.D(i,"timeupdate",re)),G||(ne=function(){return ud(e)},e.j.D(i,"timeupdate",ne),ud(e),e.i.nextUrl&&(e.g.streaming.preloadNextUrlWindow>0&&($=function(){var ae;return F(function(le){if(le.g==1)return ae=e.Ra().end-e.h.currentTime,isNaN(ae)||!(ae<=e.g.streaming.preloadNextUrlWindow)?le.A(0):(e.j.Ma(i,"timeupdate",$),C(le,e.preload(e.i.nextUrl),4));e.eb=le.h,ie(le)})},e.j.D(i,"timeupdate",$)),e.j.D(i,"ended",function(){e.load(e.eb||e.i.nextUrl)}))),e.C&&e.C.onManifestUpdated(G),ie(Q)}})}function ZR(e,t){var n,r,i;return F(function(s){return s.g==1?(n=Date.now()/1e3,r=!0,e.F=e.md({vc:e.N,onError:function(o){Vo(e,o)},yf:function(){},onExpirationUpdated:function(){var o=ct("expirationupdated");e.dispatchEvent(o)},onEvent:function(o){e.dispatchEvent(o),o.type=="drmsessionupdate"&&r&&(r=!1,e.B.m=Date.now()/1e3-n)}}),e.F.configure(e.g.drm),i=i0([t]),e.F.O=!0,C(s,x0(e.F,[i],[]),2)):C(s,e.F.Wb(e.h),0)})}function ek(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A;return F(function(I){switch(I.g){case 1:if(Fo(e,"src-equals"),r=e.h,e.G=new Tx(r),i=!1,e.Ce.push(function(){i=!0}),e.dispatchEvent(ct("canupdatestarttime")),e.O!=null&&e.G.Zf(e.O),e.bc=ak(e,e.O||0),e.M=new lu({bf:function(){return r.playbackRate},Tc:function(){return r.defaultPlaybackRate},sh:function(E){r.playbackRate=E},Bi:function(E){r.currentTime+=E}}),LT(e,r,!0),r.textTracks&&(id(e),s=function(E){if(!(e.u instanceof Gt)){var R=sd(e).find(function(M){return M.mode!=="disabled"});R&&(R.mode=E?"showing":"hidden"),e.u instanceof ln&&(R=ck(e))&&(R.mode=!E&&e.u.isTextVisible()?"showing":"hidden")}},e.j.D(r,"enterpictureinpicture",function(){return s(!0)}),e.j.D(r,"leavepictureinpicture",function(){return s(!1)}),r.remote?(e.j.D(r.remote,"connect",function(){return s(!1)}),e.j.D(r.remote,"connecting",function(){return s(!1)}),e.j.D(r.remote,"disconnect",function(){return s(!1)})):"webkitCurrentPlaybackTargetIsWireless"in r&&e.j.D(r,"webkitcurrentplaybacktargetiswirelesschanged",function(){return s(!1)}),o=r,(o.webkitPresentationMode||o.webkitSupportsFullscreen)&&e.j.D(o,"webkitpresentationmodechanged",function(){o.webkitPresentationMode?s(o.webkitPresentationMode!=="inline"):o.webkitSupportsFullscreen&&s(o.webkitDisplayingFullscreen)})),PT(e,r,t),u=DR(e.K,e.X,n),!u.includes("#t=")&&(e.g.playRangeStart>0||isFinite(e.g.playRangeEnd))&&(u+="#t=",e.g.playRangeStart>0&&(u+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(u+=","+e.g.playRangeEnd)),!e.H){I.A(2);break}return C(I,e.H.destroy(),3);case 3:e.H=null;case 2:return Ac(r),r.src=u,l=je(),l.Oa()=="TV"&&r.load(),r.preload!="none"&&!r.autoplay&&ec(n)&&l.Ha()==="WEBKIT"&&r.load(),e.m=Qn,e.dispatchEvent(ct("streaming")),f=function(){return new Promise(function(E){var R=new Ve(E);e.j.D(r.textTracks,"change",function(){return R.ka(.5)}),R.ka(.5)})},g=new at,Do(r,HTMLMediaElement.HAVE_METADATA,e.j,function(){return F(function(E){if(E.g==1)return e.G.ready(),e.Fa&&ec(e.Fa)?C(E,f(),3):(g.resolve(),E.A(0));g.resolve(),ie(E)})}),Do(r,HTMLMediaElement.HAVE_CURRENT_DATA,e.j,function(){var E,R,M,D,O;return F(function(X){if(X.g==1)return C(X,f(),2);if(i)return X.return();if(tk(e),E=sd(e),E.some(function(b){return b.mode==="showing"})&&(e.$=!0,e.u.setTextVisibility(!0)),!(e.u instanceof Gt))for(E.length&&(e.u.enableTextDisplayer?e.u.enableTextDisplayer():qe("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method')),R=!1,M=x(E),D=M.next();!D.done;D=M.next())O=D.value,O.mode!=="disabled"&&(R?(O.mode="disabled",Be("Found more than one enabled text track, disabling it",O)):(BT(e,O),R=!0));nk(e),ie(X)})}),r.error?g.reject(lg(e)):r.preload=="none"&&(Be('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),g.resolve()),e.j.Aa(r,"error",function(){g.reject(lg(e))}),C(I,tc(e.g.streaming.loadTimeout,g),4);case 4:((y=e.W())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(v=function(){return GT(e)},e.j.D(r,"timeupdate",v)),y||(w=function(){return ud(e)},e.j.D(r,"timeupdate",w),ud(e)),e.C&&(e.C.onManifestUpdated(y),y&&(A=e.Ra().end,e.j.D(r,"progress",function(){var E=e.Ra().end;A!=E&&(e.C.onManifestUpdated(e.W()),A=E)}))),e.Ua=!0,ie(I)}})}function tk(e){var t=e.g.preferredAudioLanguage;t!=""&&e.Ri(t,e.g.preferredAudioRole)}function nk(e){var t=e.g.preferredTextLanguage;t!=""&&e.nh(t,e.g.preferredTextRole,e.g.preferForcedSubs)}function rk(e,t){if(t.kind=="metadata"){t.mode="hidden",e.j.D(t,"cuechange",function(){if(t.activeCues)for(var r=x(t.activeCues),i=r.next();!i.done;i=r.next())i=i.value,sg(e,i.startTime,i.endTime,i.type,i.value),e.C&&e.C.onCueMetadataChange(i.value);if(t.cues){r=[],i=x(t.cues);for(var s=i.next(),o={};!s.done;o={Ec:void 0},s=i.next())o.Ec=s.value,o.Ec.type=="com.apple.quicktime.HLS"&&o.Ec.startTime!=null&&(s=r.find((function(u){return function(l){return l.startTime==u.Ec.startTime&&l.endTime==u.Ec.endTime}})(o)),s||(s={startTime:o.Ec.startTime,endTime:o.Ec.endTime,values:[]},r.push(s)),s.values.push(o.Ec.value));for(r=x(r),i=r.next();!i.done;i=r.next())i=i.value,i.values.some(function(u){return u.key=="X-ASSET-URI"||u.key=="X-ASSET-LIST"})&&e.C&&(i.values.push({key:"CUE",description:"",data:i.startTime!=0||e.W()?"ONCE":"ONCE,PRE",mimeType:null,pictureType:null}),e.C.onHLSInterstitialMetadata(e,e.h,i))}});var n=new Ve(function(){var r=dk(e);r=x(r);for(var i=r.next();!i.done;i=r.next())i.value.mode="hidden"}).Kb().ka(.5);e.Ce.push(function(){n.stop()})}}function ig(e,t,n){t=new Map().set("startTime",t.startTime).set("endTime",t.endTime).set("metadataType",t.schemeIdUri).set("payload",t.payload),e.dispatchEvent(ct(n,t))}function sg(e,t,n,r,i){e.za&&(t={schemeIdUri:r,startTime:t,endTime:n||1/0,id:"",payload:i},t.id=JSON.stringify(t),wp(e.za,t))}function ik(e,t){if(t&&t.kind=="chapters"){t.mode="hidden";var n=new Ve(function(){t.mode="hidden"}).Kb().ka(.5);e.Ce.push(function(){n.stop()})}}p.Mk=function(){for(var e=this.ba;e.g;)e.release()},p.md=function(e){return new mc(e)};function DT(e,t){function n(s){t()?t().dispatchEvent(s):e.dispatchEvent(s)}function r(s){t()?vu(t(),!0,s):s()}t||(t=function(){return null});var i=new mt(function(s,o,u,l,f){r(function(){e.o&&e.o.segmentDownloaded(s,o,u,l,f)})},function(s,o,u){o=new Map().set("headers",s).set("request",o).set("requestType",u),n(ct("downloadheadersreceived",o)),r(function(){if(e.va){var l=e.va;if(l.h.enabled){var f=s["cmsd-static"];if(f)try{var g=new Map,y=f.split(",");for(f=0;f<y.length;f++){var v=y[f].split("=");g.set(v[0],xT(v[1]))}}catch(R){}if(g=s["cmsd-dynamic"]){e:{try{var w=new Map,A=g.split(";");for(g=1;g<A.length;g++){var I=A[g].split("=");w.set(I[0],xT(I[1]))}var E=w;break e}catch(R){E=null;break e}E=void 0}E&&(l.g=E)}}}})},function(s,o){s=new Map().set("request",s).set("response",o),n(ct("downloadcompleted",s))},function(s,o,u,l){s=new Map().set("request",s).set("error",o).set("httpResponseCode",u).set("aborted",l),n(ct("downloadfailed",s))},function(s,o,u){r(function(){if(e.K){var l=e.K,f=u;if(f=f===void 0?{}:f,l.g.enabled)if(o.method==="HEAD")Bo(l,o,{});else switch(s){case 0:try{if(l.g.enabled){if(f.type){e:{switch(f.type){case 4:var g=l.u?ed:Zc;break e;case 3:case 2:g=l.u?nd:td;break e;case 5:g="s";break e}g=void 0}l.l=g}Bo(l,o,{ot:hT,su:!l.F})}}catch(v){ir("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",v)}break;case wr:try{if(l.g.enabled){var y=dT(l,f,o.uris[0]);y.ts=Date.now(),l.m.has(o)&&l.m.delete(o),l.m.set(o,y.ts),Bo(l,o,y)}}catch(v){ir("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",v)}break;case 2:case 5:case 6:Bo(l,o,{ot:"k"});break;case 4:Bo(l,o,{ot:"o"})}}})},function(s,o,u,l){(s=t()?t().m:e.I)&&s.banLocation&&s.banLocation(l)},function(s,o,u){if(o.data){var l=o.data.byteLength,f=t()?t().getStats():e.B;if(f&&(Kx(f,l),s===0&&(f.ti=l)),l=e.K,u=u===void 0?{}:u,Kp(l).length!==0)switch(s){case wr:try{var g=dT(l,u,o.uri);o.originalRequest&&o.originalRequest.timeToFirstByte!=null&&(g.ttfb=o.originalRequest.timeToFirstByte),o.timeMs!=null&&(g.ttlb=o.timeMs);var y=o.originalUri||o.uri;if(y.includes("CMCD="))try{var v=new URL(y);v.searchParams.delete("CMCD");var w=v.toString()}catch(U){w=y}else w=y;g.url=w,l.m.has(o.originalRequest)?(g.ts=l.m.get(o.originalRequest),l.m.delete(o.originalRequest)):g.ts||(g.ts=Date.now());var A=Kp(l);if(A.length!==0){var I=l.g.version==Zp?Array.from(new Set([].concat(Y(eg),Y(GR)))):pT;g.rc=o.status||0;var E=Qp(l,g,yT);o.headers&&o.headers["CMSD-Static"]&&(E.cmsds=btoa(o.headers["CMSD-Static"])),o.headers&&o.headers["CMSD-Dynamic"]&&(E.cmsdd=btoa(o.headers["CMSD-Dynamic"]));for(var R=x(A),M=R.next();!M.done;M=R.next()){var D=M.value,O=Yp(D.includeKeys||[],I),X=lT(D);l.o[X]||(l.o[X]={request:1,response:1}),E.sn=l.o[X].response++;var b=qp(E,O);uT(l,b,D,o)}}}catch(U){ir("CMCD_SEGMENT_ERROR","Could not generate response segment CMCD data.",U)}}}});return i.configure(e.g.networking),i}function sk(e,t){return new Ax(e.h,e.i,e.g.streaming,t,function(){e.bc&&Rx(e.bc,!e.G.Kh()),e.l&&e.l.bd(),e.R&&si(e,"seeking")},function(n){return e.dispatchEvent(n)})}function ok(e,t){var n=e.W()||typeof t=="number"&&t>0;t=new Gs(e.ze,n),t.addEventListener("enter",function(s){Cu(e,"timelineregionenter",s.region)}),t.addEventListener("exit",function(s){Cu(e,"timelineregionexit",s.region)}),t.addEventListener("skip",function(s){var o=s.region;s.seeking||(Cu(e,"timelineregionenter",o),Cu(e,"timelineregionexit",o))});var r=new Gs(e.za,n);r.addEventListener("enter",function(s){ig(e,s.region,"metadata")}),n=new Gs(e.kb,n),n.addEventListener("enter",function(s){s=new Map().set("detail",s.region.emsg),e.dispatchEvent(ct("emsg",s))});var i=new Tp(e.h);return i.g.add(t),i.g.add(r),i.g.add(n),e.xe&&i.g.add(e.xe),i}function ak(e,t){t=new Gs(e.za,t instanceof Date||t>0),t.addEventListener("enter",function(r){ig(e,r.region,"metadata")});var n=new Tp(e.h);return n.g.add(t),n}function LT(e,t,n){e.R=new PC,qh(e.R,Os),bT(e),Au(e),e.Ta=new Ve(function(){si(e)}),e.g.streaming.rebufferingGoal&&e.Ta.Ea(.25),e.j.D(t,"waiting",function(){return si(e,"waiting")}),e.j.D(t,"canplaythrough",function(){return si(e,"canplaythrough")}),e.j.D(t,"playing",function(){return si(e,"playing")}),e.j.D(t,"seeked",function(){return si(e,"seeked")}),e.j.D(t,"timeupdate",function(){return si(e,"timeupdate")}),n&&(e.j.D(t,"progress",function(){return si(e,"progress")}),e.j.D(t,"stalled",function(){return si(e,"stalled")}))}function bT(e){var t=e.g.streaming.rebufferingGoal;e.R.j.set(Us,Math.min(.5,t/2)).set(Os,t)}function si(e,t){if(e.g.streaming.rebufferingGoal){t=e.H?Vs(e.H):!1,t=e.fe()||t||e.G.oi();var n=$0(e.h.buffered,e.h.currentTime),r=e.R,i=r.j.get(r.g);qh(r,t||n>=i&&n>0?Us:Os)&&Au(e)}else if(t){n=e.R,r=e.h.currentTime,i=n.h,n.h=r;var s=void 0;switch(t){case"seeking":case"waiting":n.h=-1,s=Os;break;case"canplaythrough":case"playing":case"seeked":s=Us;break;case"timeupdate":i>=0&&r-i>.01&&(s=Us)}s!==void 0&&qh(n,s)&&Au(e)}}function uk(e,t,n,r,i){return new tx(e,t,n,i,r)}function lk(e){return new bx(e.i,{nc:function(){return e.G?e.G.Pd():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},Pb:function(){return e.Pb()},video:e.h,Z:e.H,vc:e.N,onError:function(t){return Vo(e,t)},onEvent:function(t){return e.dispatchEvent(t)},zd:function(t,n,r,i){var s=t.startTime,o=t.endTime,u=n.type;if(u!=Fe){if(e.G){e.G.Di();var l=dp(e.H,u);!e.W()&&e.h.paused&&!e.h.seeking&&l!=null&&l>0&&e.G.Pd()<l&&!IT(e.G.Pd(),l,.001)&&e.G.Zf(l)}si(e)}r=new Map().set("start",s).set("end",o).set("contentType",u).set("isMuxed",r).set("isDependency",i),e.dispatchEvent(ct("segmentappended",r)),e.o&&n.fastSwitching&&t.Xc&&t.ie&&e.o.trySuggestStreams()},Dk:function(t,n){(n=n.xd)&&e.xe&&IM(e.xe,n,t)},Sh:function(t,n){var r=e.F;if(r.h.parseInbandPsshEnabled&&!r.H&&["audio","video"].includes(t)){t=new Wh(Le(n)),n=0;for(var i=x(t.data),s=i.next();!s.done;s=i.next())n+=s.value.length;if(n==0)r=Promise.resolve();else{for(n=new Uint8Array(n),i=0,t=x(t.data),s=t.next();!s.done;s=t.next())s=s.value,n.set(s,i),i+=s.length;Ja(r,"cenc",n),r=r.m}}else r=Promise.resolve();return r},disableStream:function(t,n){return e.disableStream(t,n)},cl:function(t,n){return!(e.g.abr.enabled&&n.fastSwitching&&t.Xc&&t.ie)}})}p.configure=function(e,t){var n=this.getConfiguration();if(arguments.length==2&&typeof e=="string"&&(e=Vc(e,t)),"preferredVariantRole"in e&&(qe("preferredVariantRole configuration","Please Use preferredAudioRole instead."),e.preferredAudioRole=e.preferredVariantRole,delete e.preferredVariantRole),e.streaming&&"forceTransmuxTS"in e.streaming&&(qe("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(qe("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming){qe("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead.");var r=je();e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&r.Ha()==="WEBKIT",delete e.streaming.useNativeHlsOnSafari}if(e.streaming&&typeof e.streaming.liveSync=="boolean"&&(qe("streaming.liveSync","Please Use streaming.liveSync.enabled instead."),r=e.streaming.liveSync,e.streaming.liveSync={},e.streaming.liveSync.enabled=r),e.streaming&&!(e.streaming.liveSync&&"targetLatency"in e.streaming.liveSync)&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){r=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-r)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=r+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(qe("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(qe("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(qe("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(qe("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(qe("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(qe("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(qe("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(qe("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){qe("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var s=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return s},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(qe("manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(qe("streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(qe("manifest.dash.enableAudioGroups configuration","Please Use manifest.enableAudioGroups instead."),e.manifest.enableAudioGroups=e.manifest.dash.enableAudioGroups,delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(qe("streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(qe("streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.manifest&&e.manifest.dash&&"ignoreSupplementalCodecs"in e.manifest.dash&&(qe("manifest.dash.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.dash.ignoreSupplementalCodecs,delete e.manifest.dash.ignoreSupplementalCodecs),e.manifest&&e.manifest.hls&&"ignoreSupplementalCodecs"in e.manifest.hls&&(qe("manifest.hls.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.hls.ignoreSupplementalCodecs,delete e.manifest.hls.ignoreSupplementalCodecs),e.manifest&&e.manifest.dash&&"updatePeriod"in e.manifest.dash&&(qe("manifest.dash.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.dash.updatePeriod,delete e.manifest.dash.updatePeriod),e.manifest&&e.manifest.hls&&"updatePeriod"in e.manifest.hls&&(qe("manifest.hls.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.hls.updatePeriod,delete e.manifest.hls.updatePeriod),e.manifest&&e.manifest.dash&&"ignoreDrmInfo"in e.manifest.dash&&(qe("manifest.dash.ignoreDrmInfo configuration","Please Use manifest.ignoreDrmInfo instead."),e.manifest.ignoreDrmInfo=e.manifest.dash.ignoreDrmInfo,delete e.manifest.dash.ignoreDrmInfo),e.drm&&e.drm.advanced){r=!1;for(var o in e.drm.advanced){var u=e.drm.advanced[o];i=u.videoRobustness,u=u.audioRobustness,"videoRobustness"in e.drm.advanced[o]&&!Array.isArray(e.drm.advanced[o].videoRobustness)&&(e.drm.advanced[o].videoRobustness=[i],r=!0),"audioRobustness"in e.drm.advanced[o]&&!Array.isArray(e.drm.advanced[o].audioRobustness)&&(e.drm.advanced[o].audioRobustness=[u],r=!0)}r&&qe("AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return e.streaming&&"forceHTTP"in e.streaming&&(qe("streaming.forceHTTP configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTP=e.streaming.forceHTTP,delete e.streaming.forceHTTP),e.streaming&&"forceHTTPS"in e.streaming&&(qe("streaming.forceHTTPS configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTPS=e.streaming.forceHTTPS,delete e.streaming.forceHTTPS),e.streaming&&"minBytesForProgressEvents"in e.streaming&&(qe("streaming.minBytesForProgressEvents configuration","Please Use networking.minBytesForProgressEvents instead."),e.networking=e.networking||{},e.networking.minBytesForProgressEvents=e.streaming.minBytesForProgressEvents,delete e.streaming.minBytesForProgressEvents),o=_i(this.g,e,qr(this)),NT(this,n),o},p.wj=function(e){this.cg=e};function NT(e,t){if(e.De=new Qh(e.g,e.ya,e.F),e.I){var n=br(e.g.manifest);e.h&&e.h.nodeName==="AUDIO"&&(n.disableVideo=!0),e.I.configure(n)}if(e.F&&e.F.configure(e.g.drm),e.l){e.l.configure(e.g.streaming);try{e.m!=Ur&&L0(e.De,e.i)&&Cn(e)}catch(i){Vo(e,i)}e.o&&us(e),n=e.l.o,!n||n.allowedByApplication&&n.allowedByKeySystem||ls(e)}if(e.N&&e.N.configure(e.g.networking),e.H&&(e.H.configure(e.g.mediaSource),e.H.Fa=e.g.manifest.segmentRelativeVttTiming),e.u&&id(e),e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),qT(e)),e.R&&bT(e),e.Ta&&(e.g.streaming.rebufferingGoal?e.Ta.Ea(.25):e.Ta.stop()),e.i&&cg(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.C&&e.C.configure(e.g.ads),e.K&&e.K.configure(e.g.cmcd),e.va&&e.va.configure(e.g.cmsd),e.Da&&e.Da.configure(e.g.queue),e.m==an&&e.J.getConfiguration){n=e.J.getConfiguration();var r=!1;t.preferredVideoHdrLevel!=e.g.preferredVideoHdrLevel&&n.hdrLevel!=e.g.preferredVideoHdrLevel&&(n.hdrLevel=e.g.preferredVideoHdrLevel,r=!0),t.preferredVideoLayout!=e.g.preferredVideoLayout&&n.videoLayout!=e.g.preferredVideoLayout&&(n.videoLayout=e.g.preferredVideoLayout,r=!0),t.preferSpatialAudio!=e.g.preferSpatialAudio&&n.spatialAudio!=e.g.preferSpatialAudio&&(n.spatialAudio=e.g.preferSpatialAudio,r=!0),t.preferredVideoRole!=e.g.preferredVideoRole&&n.videoRole!=e.g.preferredVideoRole&&(n.videoRole=e.g.preferredVideoRole,r=!0),r&&(e.J.configure(n),ls(e))}}p.getConfiguration=function(){var e=qr(this);return _i(e,this.g,qr(this)),e},p.Gj=function(){return this.cg},p.ii=function(){var e=qr(this);return _i(e,this.g,qr(this)),Hx(this.g,qr(this))},p.ci=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(t=Math.min(this.h.currentTime+t,this.Ra().end),e>=t)return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},p.Mi=function(){var e=this.getConfiguration(),t;for(t in this.g)delete this.g[t];_i(this.g,qr(this),qr(this)),NT(this,e)},p.Zd=function(){return this.m},p.ei=function(){return this.i?this.i.type:null},p.$e=function(){return this.h},p.Zb=function(){return this.N},p.rd=function(){return this.X},p.bi=function(){return this.C?this.C:null},p.ki=function(){return this.Da?this.Da:null},p.W=function(){return this.i&&!this.xa()?this.i.presentationTimeline.W():this.h&&(this.h.src||this.xa())?this.h.duration==1/0:!1},p.Vc=function(){return this.i?this.i.presentationTimeline.Vc():!1},p.jk=function(){if(this.i&&!this.xa()){var e=this.i.variants;return e.length?!e[0].video:!1}return this.h&&(this.h.src||this.xa())?this.h.videoTracks?this.h.videoTracks.length==0:this.h.videoHeight==0:!1},p.ri=function(){if(this.i&&!this.xa()){var e=this.i.variants;return e.length?(e=e[0],e.audio||!e.video?!1:!e.video.codecs.includes(",")):!1}return this.h&&(this.h.src||this.xa())&&this.h.audioTracks?this.h.audioTracks.length==0:!1},p.Ra=function(){if(this.i&&!this.xa()){if(!this.Ua&&this.i.type=="HLS")return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.$b(),end:e.Hb()}}if(this.h&&(this.h.src||this.xa())&&(e=this.h.seekable)&&e.length){var t=this.g?this.g.playRangeStart:0;t=Math.max(e.start(0),t);var n=this.g?this.g.playRangeEnd:1/0;return e=Math.min(e.end(e.length-1),n),{start:t,end:e}}return{start:0,end:0}},p.gk=function(){this.W()&&(this.h.currentTime=this.Ra().end)},p.kk=function(){return this.Ua},p.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},p.drmInfo=function(){return this.F?this.F.g:null},p.Yd=function(){return this.F?this.F.Yd():1/0},p.Jg=function(){return this.F?this.F.Jg():[]},p.Ze=function(){return this.F?this.F.Ze():{}},p.Qg=function(){return this.R?this.R.g==Os:!!this.X},p.Pb=function(){return this.h?this.M?this.M.i:1:0},p.Ih=function(e){this.m==an&&this.l&&Nx(this.l,e)},p.we=function(e,t){t=t===void 0?!0:t,e==0?Be("A trick play rate of 0 is unsupported!"):(this.M.set(e),this.m==an&&(this.o.playbackRateChanged(e),this.Ih(t&&e!=1)),HT(this,e))},p.Rd=function(){var e=this.M.Tc();this.m==Qn&&this.M.set(e),this.m==an&&(this.M.set(e),this.o.playbackRateChanged(e),this.Ih(!1)),this.ec.Qa()},p.qc=function(){if(this.i&&!this.xa()){for(var e=this.l?this.l.o:null,t=[],n=0,r=x(this.i.variants),i=r.next();!i.done;i=r.next())if(i=i.value,Qa(i)){var s=Ls(i);s.active=i==e,s.active||n==1||e==null||i.video!=e.video||i.audio!=e.audio||(s.active=!0),s.active&&n++,t.push(s)}return t}if(this.h&&this.h.audioTracks){var o=zT(this);return e=Array.from(this.h.audioTracks),e.length?e.map(function(u){return oc(u,o)}):o?[oc(null,o)]:[]}return[]},p.Lc=function(){if(this.i){if(this.xa())return[];for(var e=this.l?this.l.B:null,t=[],n=x(this.i.textStreams),r=n.next();!r.done;r=n.next()){r=r.value;var i=bs(r);i.active=r==e,t.push(i)}return t}return this.h&&this.h.src&&this.h.textTracks?sd(this).map(function(s){return Zv(s)}):[]},p.Lj=function(){var e=this.Je;return this.i&&(e=this.i.imageStreams),e.map(function(t){return Vh(t)})},p.zj=function(e){var t=this,n,r;return F(function(i){return i.g==1?C(i,UT(t,e),2):(n=i.h,n?(r=[],n.segmentIndex.Gb(function(s){var o=OT(s.tilesLayout||n.tilesLayout);if(o)for(var u=o.rows*o.columns,l=s.j-s.startTime,f=0;f<u;f++){var g=jT(s,n,s.startTime+l*f/u,o);r.push(g)}}),n.closeSegmentIndex&&n.closeSegmentIndex(),i.return(r)):i.return(null))})};function OT(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{columns:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}p.$j=function(e,t){var n=this,r,i,s,o,u,l;return F(function(f){return f.g==1?C(f,UT(n,e),2):(r=f.h,!r||(r.closeSegmentIndex&&(n.yc.has(r)||(i=new Ve(function(){r.closeSegmentIndex(),n.yc.delete(r)}),n.yc.set(r,i)),s=n.yc.get(r),s.ka(5)),o=r.segmentIndex.find(t),o==null)?f.return(null):(u=r.segmentIndex.get(o),(l=OT(u.tilesLayout||r.tilesLayout))?f.return(jT(u,r,t,l)):f.return(null)))})};function UT(e,t){var n,r;return F(function(i){return i.g==1?e.m!=an&&e.m!=Qn||(n=e.Je,e.i&&(n=e.i.imageStreams),r=n[0],!r)?i.return(null):(t!=null&&(r=n.find(function(s){return s.id==t})),r?r.segmentIndex?i.A(2):C(i,r.createSegmentIndex(),2):i.return(null)):i.return(r)})}function jT(e,t,n,r){var i=t.width||0,s=t.height||0,o=i/r.columns,u=s/r.rows,l=r.columns*r.rows,f=e.j-e.startTime;f=e.B||f/l;var g=e.startTime,y=0,v=0;return l>1&&(v=Math.floor((n-e.startTime)/f),g=e.startTime+v*f,y=v%r.columns*o,v=Math.floor(v/r.columns)*u),r=!1,(n=e.thumbnailSprite)&&(r=!0,u=n.height,y=n.positionX,v=n.positionY,o=n.width),{segment:e,imageHeight:s,imageWidth:i,height:u,positionX:y,positionY:v,startTime:g,duration:f,uris:e.P(),startByte:e.Jc(),endByte:e.Hc(),width:o,sprite:r,mimeType:e.mimeType||t.mimeType,codecs:e.codecs||t.codecs}}p.oh=function(e){function t(){var r=n.i.textStreams.find(function(i){return i.id==e.id});r&&r!=n.l.B&&(jp(n.B.h,r,!1),Lc(n.l,r),Di(n),Iu(n),n.Kd=r.language)}var n=this;this.i&&this.G&&(t(),!this.xa())||(function(){if(n.h&&n.h.textTracks){var r=sd(n),i=r.find(function(u){return sc(u)===e.id});if(i){if(n.u instanceof Gt){r=x(r);for(var s=r.next();!s.done;s=r.next()){s=s.value;var o=s===i?n.$?"showing":"hidden":"disabled";s.mode!==o&&(s.mode=o)}}else r=r.find(function(u){return u.mode!=="disabled"}),r!==i&&(r&&(r.mode="disabled",n.j.Ma(r,"cuechange"),n.u.remove(0,1/0)),i&&BT(n,i));Di(n),Iu(n)}}})()};function BT(e,t){e.j.D(t,"cuechange",function(){e.u.remove(0,Math.max(0,e.h.currentTime-e.g.streaming.bufferBehind));var n={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},r=[],i=Array.from(t.activeCues||[]);i=x(i);for(var s=i.next();!s.done;s=i.next()){if(s=s.value,s.endTime===1/0||s.endTime<s.startTime)s=null;else{var o=new ht(s.startTime,s.endTime,s.text);o.line=typeof s.line=="number"?s.line:null,s.lineAlign&&(o.lineAlign=s.lineAlign),o.lineInterpretation=s.snapToLines?Ga:1,o.position=typeof s.position=="number"?s.position:null,s.positionAlign&&(o.positionAlign=s.positionAlign),o.size=s.size,o.textAlign=s.align,s.vertical==="lr"?o.writingMode="vertical-lr":s.vertical==="rl"&&(o.writingMode="vertical-rl"),s.region&&(o.region.id=s.region.id,o.region.height=s.region.lines,o.region.heightUnits=2,o.region.regionAnchorX=s.region.regionAnchorX,o.region.regionAnchorY=s.region.regionAnchorY,o.region.scroll=s.region.scroll,o.region.viewportAnchorX=s.region.viewportAnchorX,o.region.viewportAnchorY=s.region.viewportAnchorY,o.region.viewportAnchorUnits=Wn,o.region.width=s.region.width,o.region.widthUnits=Wn),Ql(o),s=o}s&&((o=e.g.mediaSource.modifyCueCallback)&&o(s,null,n),r.push(s))}e.u.append(r)}),t.mode=document.pictureInPictureElement?"showing":"hidden"}p.If=function(e,t,n){function r(){var s=i.i.variants.find(function(u){return u.id==e.id});if(s&&Qa(s)){var o=i.l.o;i.g.abr.enabled&&(o.video!=s.video||o.audio&&s.audio&&o.audio.language==s.audio.language&&o.audio.channelsCount==s.audio.channelsCount&&o.audio.label==s.audio.label)&&Be("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),i.xa()?Eu(i,s,!1,!1,0):Eu(i,s,!1,t||!1,n||0),i.J.configure({language:s.language,role:s.audio&&s.audio.roles&&s.audio.roles[0]||"",videoRole:s.video&&s.video.roles&&s.video.roles[0]||"",channelCount:s.audio&&s.audio.channelsCount?s.audio.channelsCount:0,hdrLevel:s.video&&s.video.hdr?s.video.hdr:"",spatialAudio:s.audio&&s.audio.spatialAudio?s.audio.spatialAudio:!1,videoLayout:s.video&&s.video.videoLayout?s.video.videoLayout:"",audioLabel:s.audio&&s.audio.label?s.audio.label:"",videoLabel:s.video&&s.video.label?s.video.label:"",codecSwitchingStrategy:i.g.mediaSource.codecSwitchingStrategy,audioCodec:s.audio&&s.audio.codecs?s.audio.codecs:"",activeAudioCodec:o.audio&&o.audio.codecs?o.audio.codecs:"",activeAudioChannelCount:o.audio&&o.audio.channelsCount?o.audio.channelsCount:0,preferredAudioCodecs:i.g.preferredAudioCodecs,preferredAudioChannelCount:i.g.preferredAudioChannelCount}),us(i)}}var i=this;t=t===void 0?!1:t,n=n===void 0?0:n,!(this.i&&this.G&&(r(),!this.xa()))&&(function(){if(e.originalAudioId&&i.h&&i.h.audioTracks){var s=Array.from(i.h.audioTracks);s=x(s);for(var o=s.next();!o.done;o=s.next())if(o=o.value,sc(o)==e.id){ag(i,o);break}}})()},p.Uk=function(e,t){function n(){var i=r.J.getConfiguration();i.audioCodec=e.codecs||"",i.audioLabel=e.label||"",i.channelCount=e.channelsCount||0,i.language=e.language,i.role=e.roles[0]||"",i.spatialAudio=e.spatialAudio,r.J.configure(i),ls(r,!0,t,!1,!1)}var r=this;t=t===void 0?0:t,!(this.i&&this.G&&(n(),!this.xa()))&&(function(){if(r.h&&r.h.audioTracks){var i=tt(e.language),s=Array.from(r.h.audioTracks),o=null;s=x(s);for(var u=s.next();!u.done;u=s.next()){u=u.value;var l=u.language||"und";if(u.label==e.label&&tt(l)==i&&u.kind==e.roles[0]){o=u;break}}o&&ag(r,o)}})()},p.getAudioTracks=function(){if(this.i&&!this.xa()){var e=this.qc();if(!e.length)return[];var t=e.find(function(s){return s.active});if(!t)return[];var n=e;if(this.m!=an||this.xa()||(n=e.filter(function(s){return s.originalVideoId===t.originalVideoId&&(s.audioCodec||wi.includes(s.audioMimeType||""))})),!n.length)return[];e=new Map,n=x(n);for(var r=n.next();!r.done;r=n.next()){r=r.value;var i=r.originalAudioId;i||r.audioId==null||(i=String(r.audioId)),!i&&r.codecs.includes(",")&&r.audioCodec&&(i="muxed-in-video"),i&&(i+=[r.language,r.label,r.channelsCount,r.spatialAudio,r.audioCodec||""].join("_"),e.set(i,{active:r.active,language:r.language,label:r.label,mimeType:r.audioMimeType,codecs:r.audioCodec,primary:r.primary,roles:r.audioRoles||[],accessibilityPurpose:r.accessibilityPurpose,channelsCount:r.channelsCount,audioSamplingRate:r.audioSamplingRate,spatialAudio:r.spatialAudio,originalLanguage:r.originalLanguage}))}return Array.from(e.values())}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map(function(s){var o=s.language;return o={active:s.enabled,language:tt(o||"und"),label:s.label,mimeType:null,codecs:null,primary:s.kind=="main",roles:[],accessibilityPurpose:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,originalLanguage:o},s.kind&&(s.kind=="description"&&(o.accessibilityPurpose="visually impaired"),o.roles.push(s.kind)),s.configuration&&(s.configuration.codec&&(o.codecs=s.configuration.codec),s.configuration.sampleRate&&(o.audioSamplingRate=s.configuration.sampleRate),s.configuration.numberOfChannels&&(o.channelsCount=s.configuration.numberOfChannels)),o}):[]},p.Wk=function(e,t,n){t=t===void 0?!1:t,n=n===void 0?0:n;var r=this.qc();if(r.length){var i=r.find(function(o){return o.active});if(i){r=r.filter(function(o){return(o.videoBandwidth||o.bandwidth)==e.bandwidth&&o.width==e.width&&o.height==e.height&&o.frameRate==e.frameRate&&o.pixelAspectRatio==e.pixelAspectRatio&&o.hdr==e.hdr&&o.colorGamut==e.colorGamut&&o.videoLayout==e.videoLayout&&o.videoMimeType==e.mimeType&&o.videoCodec==e.codecs&&Wi(o.videoRoles,e.roles)&&o.videoLabel==e.label});var s;r.length==1?s=r[0]:s=r.find(function(o){return o.audioId===i.audioId}),s||(s=r.find(function(o){return o.language==i.language&&o.label===i.label&&o.channelsCount===i.channelsCount&&o.spatialAudio===i.spatialAudio&&o.audioMimeType===i.audioMimeType&&Vt(o.audioCodec||"")===Vt(i.audioCodec||"")&&Wi(o.audioRoles,i.audioRoles)})),s&&!s.active&&this.If(s,t,n)}}},p.getVideoTracks=function(){if(this.m==Qn||this.xa())return[];var e=this.qc();if(!e.length)return[];var t=e.find(function(s){return s.active});if(!t)return[];var n=e;if(this.ri()||(n=e.filter(function(s){return s.videoCodec&&s.audioGroupId===t.audioGroupId&&s.originalAudioId===t.originalAudioId?s.audioId===t.audioId?!0:s.language===t.language&&s.label===t.label&&s.channelsCount===t.channelsCount&&s.spatialAudio===t.spatialAudio&&s.audioMimeType===t.audioMimeType&&Vt(s.audioCodec||"")===Vt(t.audioCodec||"")&&Wi(s.audioRoles,t.audioRoles):!1})),!n.length)return[];e=new Map,n=x(n);for(var r=n.next();!r.done;r=n.next()){r=r.value;var i=r.originalVideoId;i||r.videoId==null||(i=String(r.videoId)),i&&e.set(i,{active:r.active,bandwidth:r.videoBandwidth||r.bandwidth,width:r.width,height:r.height,frameRate:r.frameRate,pixelAspectRatio:r.pixelAspectRatio,hdr:r.hdr,colorGamut:r.colorGamut,videoLayout:r.videoLayout,mimeType:r.videoMimeType,codecs:r.videoCodec,roles:r.videoRoles||[],label:r.videoLabel})}return Array.from(e.values())},p.Bj=function(){return ZT(this.qc())},p.Yj=function(){return ZT(this.Lc())},p.Aj=function(){return Array.from(JT(this.qc()))},p.Xj=function(){return Array.from(JT(this.Lc()))},p.Ri=function(e,t,n,r,i,s,o){function u(){function f(A,I){return A.video||I.video?A.video&&I.video?Math.abs((A.video.height||0)-(I.video.height||0))+Math.abs((A.video.width||0)-(I.video.width||0)):1/0:0}var g=l.l.o;l.J=l.g.adaptationSetCriteriaFactory(),l.J.configure({language:e,role:t||"",videoRole:g.video&&g.video.roles&&g.video.roles[0]||"",channelCount:n||0,hdrLevel:"",spatialAudio:s||!1,videoLayout:"",audioLabel:o||"",videoLabel:"",codecSwitchingStrategy:l.g.mediaSource.codecSwitchingStrategy,audioCodec:i||"",activeAudioCodec:g.audio&&g.audio.codecs?g.audio.codecs:"",activeAudioChannelCount:g.audio&&g.audio.channelsCount?g.audio.channelsCount:0,preferredAudioCodecs:l.g.preferredAudioCodecs,preferredAudioChannelCount:l.g.preferredAudioChannelCount});var y=l.J.create(l.i.variants),v=null;y=x(y.values());for(var w=y.next();!w.done;w=y.next())w=w.value,Qa(w)&&(!v||f(v,g)>f(w,g))&&(v=w);v!=g&&(v?(g=Ls(v),l.If(g,!0,r||0)):ls(l))}var l=this;n=n===void 0?0:n,r=r===void 0?0:r,i=i===void 0?"":i,s=s===void 0?!1:s,o=o===void 0?"":o,!(this.i&&this.G&&(u(),!this.xa()))&&(function(){if(l.h&&l.h.audioTracks){var f=yo(l.qc(),e,t||"",!1)[0];f&&l.If(f)}})()},p.nh=function(e,t,n){function r(){i.Kd=e,i.Nd=t||"",i.Md=n||!1;var s=yo(i.i.textStreams,i.Kd,i.Nd,i.Md)[0]||null;s&&s!=i.l.B&&(jp(i.B.h,s,!1),i.g.streaming.alwaysStreamText||i.Rg())&&(Lc(i.l,s),Di(i),Iu(i))}var i=this;n=n===void 0?!1:n,!(this.i&&this.G&&(r(),!this.xa()))&&(function(){var s=yo(i.Lc(),e,t||"",n||!1)[0];s&&i.oh(s)})()},p.Vk=function(e,t,n){function r(){for(var s=null,o=x(i.i.variants),u=o.next();!u.done;u=o.next())if(u=u.value,u.audio.label==e){s=u;break}s!=null&&(i.J=i.g.adaptationSetCriteriaFactory(),i.J.configure({language:s.language,role:"",videoRole:"",channelCount:0,hdrLevel:"",spatialAudio:!1,videoLayout:"",videoLabel:"",audioLabel:e,codecSwitchingStrategy:i.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:i.g.preferredAudioCodecs,preferredAudioChannelCount:i.g.preferredAudioChannelCount}),ls(i,t,n))}var i=this;t=t===void 0?!0:t,n=n===void 0?0:n,!(this.i&&this.G&&(r(),!this.xa()))&&(function(){if(i.h&&i.h.audioTracks){var s=Array.from(i.h.audioTracks),o=null;s=x(s);for(var u=s.next();!u.done;u=s.next())u=u.value,u.label==e&&(o=u);o&&ag(i,o)}})()},p.Rg=function(){var e=this.$;return this.u?this.u.isTextVisible():e},p.Fj=function(){return this.ob.map(function(e){return bs(e)})},p.Dj=function(e){if(qe("getChapters","Please use an getChaptersAsync."),!this.ob.length)return[];var t=tt(e);if(e=this.ob.filter(function(s){return tt(s.language)==t}),!e.length)return[];var n=[],r=new Set;e=x(e);for(var i=e.next();!i.done;i=e.next())i=i.value,i.segmentIndex&&i.segmentIndex.Gb(function(s){var o=s.P()[0],u=s.startTime+"-"+s.endTime+"-"+o;s={id:u,title:o,startTime:s.startTime,endTime:s.endTime},r.has(u)||(n.push(s),r.add(u))});return n},p.Ej=function(e){var t=this,n,r,i,s,o,u,l;return F(function(f){switch(f.g){case 1:if(!t.ob.length)return f.return([]);if(n=tt(e),r=t.ob.filter(function(g){return tt(g.language)==n}),!r.length)return f.return([]);i=[],s=new Set,o=x(r),u=o.next();case 2:if(u.done){f.A(4);break}if(l=u.value,l.segmentIndex){f.A(5);break}return C(f,l.createSegmentIndex(),5);case 5:l.segmentIndex.Gb(function(g){var y=g.P()[0],v=g.startTime+"-"+g.endTime+"-"+y;g={id:v,title:y,startTime:g.startTime,endTime:g.endTime},s.has(v)||(i.push(g),s.add(v))}),u=o.next(),f.A(2);break;case 4:return f.return(i)}})};function sd(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind!="metadata"&&t.kind!="chapters"&&t.label!="Shaka Player TextTrack"})}function ck(e){return Array.from(e.h.textTracks).find(function(t){return t.label=="Shaka Player TextTrack"})}function dk(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind=="metadata"})}p.uh=function(e){e=!!e,this.$!=e&&(this.$=e,this.m==an?(this.u.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.l.B||(e=yo(this.i.textStreams,this.Kd,this.Nd,this.Md),e.length>0&&(Lc(this.l,e[0]),Di(this),Iu(this))):UM(this.l))):this.h&&this.h.src&&this.h.textTracks&&this.u.setTextVisibility(e),YT(this))},p.Rj=function(){if(this.G)var e=this.G.Pd();else{if(this.O==null)return new Date;if(this.O instanceof Date)return this.O;e=this.O}if(this.i&&!this.xa()){var t=this.i.presentationTimeline;return new Date(((t.m||t.i)+e)*1e3)}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+e*1e3)):null},p.ji=function(){if(this.i&&!this.xa()){var e=this.i.presentationTimeline;return e=e.m||e.i,e===null?null:new Date(e*1e3)}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},p.cf=function(){return this.W()&&this.i?this.i.presentationTimeline.cf():null},p.Gc=function(){if(this.m==an)return this.H.Gc();var e={total:[],audio:[],video:[],text:[]};return this.m==Qn&&(e.total=Mi(this.h.buffered)),e};function FT(e){if(!e.h||!e.h.currentTime)return null;var t=e.ji();return t?Math.floor(Date.now()-(t.getTime()+e.h.currentTime*1e3)):null}p.getBandwidthEstimate=function(){return this.o?this.o.getBandwidthEstimate():NaN},p.getStats=function(){if(this.m!=an&&this.m!=Qn)return{width:NaN,height:NaN,currentCodecs:"",streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};og(this);var e=this.h,t=e.currentTime/e.duration;if(isNaN(t)||this.W()||cR(this.B,Math.round(100*t)),this.G&&(this.B.T=this.G.Jh(),this.B.V=this.G.Lh()),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),lR(this.B,Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.B.N=Number(t.corruptedVideoFrames)),this.B.o=this.F?yC(this.F):NaN,Wx(this.B,e.videoWidth||NaN,e.videoHeight||NaN),this.B.l="",this.W()&&(e=FT(this),e!=null&&(this.B.F=e/1e3)),t=this.qc().find(function(i){return i.active}),e=this.Lc().find(function(i){return i.active}),t){if(t.bandwidth){var n=this.M?this.M.i:1,r=n*t.bandwidth;e&&e.bandwidth&&(r+=n*e.bandwidth),this.B.B=r}t.width&&t.height&&Wx(this.B,t.width||NaN,t.height||NaN),t=t.codecs,e&&(t+=","+(e.codecs||e.mimeType)),t&&(this.B.l=t)}return this.m!=an||this.xa()||(this.i&&(this.B.I=this.i.periodCount,this.B.H=this.i.gapCount,this.i.presentationTimeline&&(this.B.K=this.i.presentationTimeline.h)),e=this.o.getBandwidthEstimate(),this.B.u=e),this.m==Qn&&Kx(this.B,NaN),dR(this.B)},p.Qd=function(e,t,n,r,i,s,o){o=o===void 0?!1:o;var u=this,l,f,g,y,v,w,A,I,E,R,M,D;return F(function(O){switch(O.g){case 1:if(u.m!=an&&u.m!=Qn)throw new H(1,7,7004);if(n!="subtitles"&&n!="captions"&&Be("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),r){O.A(2);break}return C(O,od(u,e),3);case 3:r=O.h;case 2:if(l=[],u.C&&(l=u.C.getCuePoints()),u.m!=Qn){O.A(4);break}return f=je(),o&&f.Ha()==="WEBKIT"&&(n="forced"),C(O,fk(u,e,t,n,r,s||"",l),5);case 5:if(g=O.h,g.track)return Cn(u),Di(u),O.return(Zv(g.track));throw new H(1,2,2012);case 4:if(y=bt,v=u.Ra(),w=v.end-v.start,u.i&&(w=u.i.presentationTimeline.getDuration()),w==1/0)throw new H(1,4,4033);if(!l.length){O.A(6);break}return C(O,ad(u,e),7);case 7:A=O.h,I=VT(u,A,r,l),E=new Blob([I],{type:"text/vtt"}),e=pp(E),r="text/vtt";case 6:if(R={id:u.Ee++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:kc(0,w,[e]),mimeType:r||"",codecs:i||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:s||null,type:y.Na,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Ct(r||"",i||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},M=Ct(R.mimeType,R.codecs),D=Wa(M),!D)throw new H(2,2,2014,r);return u.i.textStreams.push(R),Cn(u),Di(u),O.return(bs(R))}})},p.Oe=function(e,t){var n=this,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O;return F(function(X){switch(X.g){case 1:if(n.m!=an&&n.m!=Qn)throw new H(1,7,7004);if(t){X.A(2);break}return C(X,od(n,e),3);case 3:t=X.h;case 2:if(t!="text/vtt")throw new H(1,2,2017,e);if(r=bt,i=n.Ra(),s=i.end-i.start,n.i&&(s=n.i.presentationTimeline.getDuration()),s==1/0)throw new H(1,4,4045);return C(X,ad(n,e),4);case 4:if(o=X.h,u=za(t),!u)throw new H(2,2,2014,t);for(l=u(),f={periodStart:0,segmentStart:0,segmentEnd:s,vttOffset:0},g=Le(o),y=l.parseMedia(g,f,e,[]),v=[],w=x(y),A=w.next(),I={};!A.done;I={Vf:void 0,nd:void 0},A=w.next())I.nd=A.value,I.Vf=null,E=(function(b){return function(){return b.Vf==null&&(b.Vf=$t([e],[b.nd.payload])),b.Vf||[]}})(I),R=new Ce(I.nd.startTime,I.nd.endTime,E,0,null,null,0,0,1/0),I.nd.payload.includes("#xywh")&&(M=I.nd.payload.split("#xywh=")[1].split(","),M.length===4&&R.Lf({height:parseInt(M[3],10),positionX:parseInt(M[0],10),positionY:parseInt(M[1],10),width:parseInt(M[2],10)})),v.push(R);if(D=t,!v.length){X.A(5);break}return C(X,od(n,v[0].P()[0]),6);case 6:D=X.h;case 5:return O={id:n.Ee++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Qe(v),mimeType:D||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:r.Xf,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Ct(D||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},n.m==Qn?n.Je.push(O):n.i.imageStreams.push(O),Cn(n),X.return(Vh(O))}})},p.Ne=function(e,t,n){var r=this,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M;return F(function(D){switch(D.g){case 1:if(r.m!=an&&r.m!=Qn)throw new H(1,7,7004);if(n){D.A(2);break}return C(D,od(r,e),3);case 3:n=D.h;case 2:if(i=bt,s=r.Ra(),o=s.end-s.start,r.i&&(o=r.i.presentationTimeline.getDuration()),o==1/0)throw new H(1,4,4055);if(u=za(n),!u)throw new H(2,2,2014,n);return C(D,ad(r,e),4);case 4:for(l=D.h,f=u(),g={periodStart:0,segmentStart:0,segmentEnd:o,vttOffset:0},y=Le(l),v=f.parseMedia(y,g,e,[]),w=[],A=x(v),I=A.next(),E={};!I.done;E={We:void 0},I=A.next())E.We=I.value,R=new Ce(E.We.startTime,E.We.endTime,(function(O){return function(){return[O.We.payload]}})(E),0,null,null,0,0,1/0),w.push(R);return M={id:r.Ee++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Qe(w),mimeType:"text/plain",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:null,type:i.Na,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Ct("text/plain","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},r.ob.push(M),Cn(r),D.return(bs(M))}})};function od(e,t){var n;return F(function(r){switch(r.g){case 1:return Z(r,2),C(r,Lo(t,e.N,e.g.streaming.retryParameters),4);case 4:n=r.h,ce(r,3);break;case 2:se(r);case 3:if(n)return r.return(n);throw new H(1,2,2011,t)}})}function fk(e,t,n,r,i,s,o){var u,l,f,g;return F(function(y){if(y.g==1)return i!="text/vtt"||o.length?C(y,ad(e,t),3):y.A(2);y.g!=2&&(u=y.h,l=VT(e,u,i,o),f=new Blob([l],{type:"text/vtt"}),t=pp(f),i="text/vtt"),g=document.createElement("track");e:{var v=e.K,w=t;try{if(!v.g.enabled){var A=w;break e}var I=$p(v);I.ot=Jp,I.su=!0;var E=Su(I);A=$c(w,E);break e}catch(R){ir("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",R),A=w;break e}A=void 0}return g.src=A,g.label=s,g.kind=r,g.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(g),e.ag.push(g),y.return(g)})}function ad(e,t){var n,r,i,s;return F(function(o){if(o.g==1){n=wr,r=e.g.streaming.retryParameters,i=Nt([t],r),i.method="GET";var u=e.K;try{u.g.enabled&&Bo(u,i,{ot:Jp,su:!0})}catch(l){ir("CMCD_TEXT_ERROR","Could not generate text CMCD data.",l)}return C(o,e.N.request(n,i).promise,2)}return s=o.h,o.return(s.data)})}function VT(e,t,n,r){var i=za(n);if(i)return n=i(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Le(t),t=n.parseMedia(t,e,null,[]),RR(t,r);throw new H(2,2,2014,n)}p.al=function(e,t){this.ya.width=e,this.ya.height=t},p.jh=function(e){if(this.m==an){var t=this.l;if(e=e===void 0?.1:e,t.l.g)t=!1;else if(t.F)t=!1;else{for(var n=x(t.h.values()),r=n.next();!r.done;r=n.next())r=r.value,!r.be||r.Ka||r.qb||(r.be=!1,xn(t,r,e));t=!0}}else t=!1;return t},p.Kg=function(){return Be("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},p.Oj=function(){return this.zc},p.Jj=function(){var e={video:null,audio:null,text:null};if(this.m!=an)return e;var t=this.l.o,n=this.h.currentTime;t=x([t.video,t.audio,this.l.B]);for(var r=t.next();!r.done;r=t.next())if((r=r.value)&&r.segmentIndex){var i=r.segmentIndex.find(n);i=r.segmentIndex.get(i),i={codecs:i.codecs||r.codecs,mimeType:i.mimeType||r.mimeType,bandwidth:i.bandwidth||r.bandwidth},r.type=="video"?(i.width=r.width,i.height=r.height,e.video=i):r.type=="audio"?e.audio=i:r.type==Fe&&(e.text=i)}return e};function qr(e){var t=Uo();return t.streaming.failureCallback=function(n){if(e.W()){var r=null;n.code==1001||n.code==1002?(r=1,e.g.streaming.lowLatencyMode&&(r=.1)):n.code==1003&&(r=.1),r!=null&&(n.severity=1,e.jh(r))}},t.textDisplayFactory=function(){if(e.Ae){var n=e.h;n=!(n.webkitDisplayingFullscreen||n.webkitPresentationMode&&n.webkitPresentationMode!="inline")}else n=!1;return n?new dn(e.h,e.Ae):"track"in document.createElement("track")?new Gt(e):new cn},t}p.Xi=function(e){this.Ae=e};function hk(e,t){for(var n=new Set,r=x(t.textStreams),i=r.next();!i.done;i=r.next())i=i.value,i.mimeType!="application/cea-608"&&i.mimeType!="application/cea-708"||n.add(i.originalId);for(r=x(t.variants),i=r.next();!i.done;i=r.next())if((i=i.value.video)&&i.closedCaptions){for(var s=x(i.closedCaptions.keys()),o=s.next();!o.done;o=s.next())if(o=o.value,!n.has(o)){var u=o.startsWith("CC")?"application/cea-608":"application/cea-708",l=new Et,f=i.closedCaptions.get(o);u={id:e.Ee++,originalId:o,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:l,mimeType:u,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:f,originalLanguage:f,label:null,type:Fe,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:i.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([Ct(u,"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},t.textStreams.push(u),n.add(o)}}}function pk(e,t){var n,r,i,s,o;return F(function(u){return u.g==1?(n=e.audio,r=e.video,i=function(l,f){var g,y,v;return F(function(w){return w.g==1?l?l.segmentIndex?w.A(2):C(w,l.createSegmentIndex(),2):w.return(null):(y=(g=l.segmentIndex.Yb(f))?g.next().value:null,y?(v=y.startTime,w.return(v)):w.return(null))})},C(u,i(n,t),2)):u.g!=3?(s=u.h,C(u,i(r,t),3)):(o=u.h,o!=null&&s!=null?u.return(Math.max(o,s)):o!=null?u.return(o):s!=null?u.return(s):u.return(t))})}function Au(e){var t=e.Qg();if(e.B&&e.R&&e.G){if(e.g.streaming.rebufferingGoal==0){var n=e.M;n.j=!1,xp(n)}else n=e.M,n.j=t,xp(n);if(e.K&&(n=e.K,t||n.F||(n.F=!0),n.F&&t&&(n.I=!0,fn(n,"ps",{dd:"r"})),n.J=t),og(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Me<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var r=e.g.streaming.liveSync.targetLatencyTolerance,i=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.V&&(e.V=Math.min(e.V+ ++e.Me*i,n-r))}}t=new Map().set("buffering",t),e.dispatchEvent(ct("buffering",t))}function HT(e,t){e.ec.Qa(),e.ec.D(e.h,"timeupdate",function(){var n=e.h.currentTime,r=e.Ra(),i=e.W(),s=i?e.g.streaming.safeSeekOffset:0;t>0?i&&t>1&&Math.floor(n)>=Math.floor(r.end)&&e.Rd():Math.floor(n)<=Math.floor(r.start+s)&&e.Rd()})}function og(e){if(e.B&&e.R){var t=e.B.g,n="playing";e.R.g==Os?n="buffering":e.fe()?n="ended":e.h.paused&&(n="paused");var r=n;if(t.g==null)t.g={timestamp:Date.now()/1e3,state:r,duration:0},t=!0;else{var i=Date.now()/1e3;t.g.duration=i-t.g.timestamp,t.g.state==r?t=!1:(t.h.push(t.g),t.g={timestamp:i,state:r,duration:0},t=!0)}t&&(n=new Map().set("newstate",n),e.dispatchEvent(ct("statechanged",n)))}}function GT(e){var t=e.h.playbackRate,n=e.W();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var r=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,i=e.ci();i<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=r&&e.we(r,!1):i==1&&t!==e.M.Tc()&&e.Rd()}if(n&&(n=e.Ra(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start||e.h.paused))){r=e.g.streaming.liveSync.targetLatencyTolerance,i=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var s=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var o=e.g.streaming.liveSync.targetLatency,u=o+r,l=Math.max(0,o-r),f=e.g.streaming.liveSync.maxPlaybackRate,g=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(o=e.i.serviceDescription.targetLatency,e.i.serviceDescription.targetLatency!=null?u=e.i.serviceDescription.targetLatency+r:e.i.serviceDescription.maxLatency!=null&&(u=e.i.serviceDescription.maxLatency),e.i.serviceDescription.targetLatency!=null?l=Math.max(0,e.i.serviceDescription.targetLatency-r):e.i.serviceDescription.minLatency!=null&&(l=e.i.serviceDescription.minLatency),f=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,g=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.V||typeof o!="number"||(e.V=o);var y=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;i&&e.dc&&e.V!==null&&typeof o=="number"&&e.Me<y&&Date.now()-e.dc>s*1e3&&(s=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.V=Math.max(e.V-(o-s)/2,s+r),e.dc=Date.now()),i&&e.V!==null&&(u=e.V+r,l=e.V-r),o=n.end-e.h.currentTime,r=0,e.m==Qn&&(i=e.h.buffered,i.length>0&&(r=i.end(i.length-1),r=Math.max(f,r-n.end))),n=e.g.streaming.liveSync.panicMode,i=e.g.streaming.liveSync.panicThreshold*1e3,s=Date.now()-e.R.i,n&&!g&&(g=e.g.streaming.liveSync.minPlaybackRate),n&&g&&s<=i?t!=g&&e.we(g,!1):u!=null&&f&&o-r>u?(t!=f&&e.we(f,!1),e.dc=null):l!=null&&g&&o-r<l?(t!=g&&e.we(g,!1),e.dc=null):t!==e.M.Tc()&&(e.Rd(),e.dc=Date.now())}}function ud(e){if(e.h){var t=function(i,s){return(IT(i,s,.01)||s>i)&&e.$f<i?(e.$f=i,!0):!1},n=e.Ra();if(n=n.end-n.start,n=n>0?e.h.currentTime/n:0,!isNaN(n)){if(n*=100,t(0,n))var r=ct("started");else t(25,n)?r=ct("firstquartile"):t(50,n)?r=ct("midpoint"):t(75,n)?r=ct("thirdquartile"):((t(100,n)||n>100)&&(r=ct("complete")),e.g&&e.g.playRangeEnd!=1/0&&e.fe()&&e.h.pause());r&&e.dispatchEvent(r)}}}function us(e){try{N0(e.De,e.i)}catch(n){return Vo(e,n),!1}var t=ac(e.i.variants);return t=e.J.create(t),e=e.o.setVariants(Array.from(t.values())),typeof e=="boolean"?e:!0}function XT(e,t){if(t=t===void 0?!1:t,us(e)){if(!e.g.abr.enabled){var n=e.J;if(typeof n.getLastAdaptationSet!="function"&&(qe("AdaptationSetCriteria w/o getLastAdaptationSet","Please use an AdaptationSetCriteria with getLastAdaptationSet."),n.getLastAdaptationSet=function(){return null}),(n=n.getLastAdaptationSet())&&(n=Array.from(n.values()),n.length)){var r=e.l.o;if(r&&r.video&&(n=n.find(function(i){return i.video==r.video})))return n}}return e.o.chooseVariant(t)}return null}function ls(e,t,n,r,i){t=t===void 0?!0:t,n=n===void 0?0:n,r=r===void 0?!1:r,i=i===void 0?!0:i;var s=XT(e);s&&Eu(e,s,i,t,n,r)}function Eu(e,t,n,r,i,s){s=s===void 0?!1:s;var o=e.l.o;if(t==o)r&&Ox(e.l,t,r,i,!0);else{var u=e.B.h;if(u.h!=t&&(u.h=t,u.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),Ox(e.l,t,r,i,s,n),r=null,o&&(r=Ls(o)),o=Ls(t),o.active=!0,e.T&&(i=e.T,t=t.video)){switch(t.dependencyStream&&(t=t.dependencyStream),s=0,u=-1,t.mimeType){case"video/webm":s=1;break;case"video/mp4":s=2}switch(e.ei()){case"DASH":u=1;break;case"HLS":u=0}i.g&&(i.g.setLevelSwitching(t.id,!0),i.g.setContainerFormat(s),i.j||i.g.setStreamingFormat(u))}n?(n=new Map().set("oldTrack",r).set("newTrack",o),n=ct("adaptation",n),Xs(e,n)):WT(e,r,o),KT(e,r,o)}}function ag(e,t){var n=Array.from(e.h.audioTracks).find(function(i){return i.enabled});if(t.enabled=!0,n){t.id!==n.id&&(n.enabled=!1);var r=zT(e);n=oc(n,r),t=oc(t,r),WT(e,n,t),KT(e,n,t)}}function zT(e){return e.h&&e.h.videoTracks?Array.from(e.h.videoTracks).find(function(t){return t.selected}):null}function Cn(e){var t=ct("trackschanged");Xs(e,t),$T(e)}function WT(e,t,n){t=new Map().set("oldTrack",t).set("newTrack",n),t=ct("variantchanged",t),Xs(e,t)}function KT(e,t,n){var r=!1;t&&t.audioId==n.audioId&&t.audioGroupId==n.audioGroupId||(r=!0),r&&$T(e)}function $T(e){var t=ct("audiotrackschanged");Xs(e,t)}function Di(e){var t=ct("textchanged");Xs(e,t)}function YT(e){var t=ct("texttrackvisibility");Xs(e,t)}function qT(e){e.g.abr.enabled||ug(e);var t=new Map().set("newStatus",e.g.abr.enabled);Xs(e,ct("abrstatuschanged",t))}function Iu(e){var t=e.Lc().find(function(n){return n.active});t&&e.u&&e.u.setTextLanguage&&e.u.setTextLanguage(t.language)}function ug(e,t){if(t=t===void 0?!0:t,e.m==an){e.Ge.stop();for(var n=x(e.i.variants),r=n.next();!r.done;r=n.next())r.value.disabledUntilTime=0;t&&us(e)}}p.disableStream=function(e,t){if(!this.g.abr.enabled||this.m===Ur||!navigator.onLine||t==0||!this.i)return!1;if(this.i.variants.some(function(u){var l=u[e.type];return l&&l.id!==e.id&&!u.disabledUntilTime?e.type=="audio"?e.language===l.language:!0:!1})){for(var n=!1,r=!1,i=x(this.i.variants),s=i.next();!s.done;s=i.next()){s=s.value;var o=s[e.type];o&&(o.id===e.id?(s.disabledUntilTime=Date.now()/1e3+t,n=!0):o.trickModeVideo&&o.trickModeVideo.id==e.id&&(r=!0))}return!n&&r?!1:(this.Ge.Ea(1),t=this.Gc().video.reduce(function(u,l){return u+l.end-l.start},0),ls(this,!1,t,!0,!1),!0)}return!1};function Vo(e,t){var n,r,i,s,o;return F(function(u){switch(u.g){case 1:if(e.m==Ur)return u.return();if(t.severity===1&&e.B.M++,n=!0,!(e.Ua&&e.i&&e.l)||t.code!=3016&&t.code!=3014&&t.code!=3015&&t.code!=3024&&t.code!=3018){u.A(2);break}return r=je(),r.Ha()==="WEBKIT"&&t.code==3016?u.return():(Z(u,3),C(u,jc(e.l),5));case 5:i=u.h,n=!i,i&&(s=ct("mediasourcerecovered"),e.dispatchEvent(s)),ce(u,2);break;case 3:se(u),n=!0;case 2:if(!n)return u.return();t.severity===2&&ug(e,!1),o=ct("error",new Map().set("detail",t)),e.dispatchEvent(o),o.defaultPrevented&&(t.handled=!0),ie(u)}})}p.addFont=function(e,t){return QC(e,t)};function Cu(e,t,n,r){r=r===void 0?e:r,e=new Map().set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,timescale:n.timescale,eventElement:n.eventElement,eventNode:n.eventNode}),r.dispatchEvent(ct(t,e))}function QT(e,t,n,r){r=r===void 0?!1:r,t=new Map().set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(ct(r?"audiotrackchanged":"mediaqualitychanged",t))}function lg(e,t){if(t=t===void 0?!0:t,!e.h.error)return t?new H(2,3,3016):null;var n=e.h.error.code;return!t&&n==1?null:((t=e.h.error.msExtendedCode)&&(t<0&&(t+=4294967296),t=t.toString(16)),new H(2,3,3016,n,t,e.h.error.message))}function gk(e,t){var n=ct("keystatuschanged");e.dispatchEvent(n);var r=Object.keys(t);r.length==1&&r[0]==""&&(r=["00"],t={"00":t[""]});var i=r.length==1&&r[0]=="00";if(n=!1,r.length){r=e.keySystem();for(var s=wo(e.g.drm.clearKeys),o=function(A,I){A.allowedByKeySystem=!0,I=x(I);for(var E=I.next();!E.done;E=I.next())E=E.value,((E=t[i?"00":E])||e.F.H)&&(A.allowedByKeySystem=A.allowedByKeySystem&&!!E&&!O0.includes(E))},u=x(e.i.variants),l=u.next();!l.done;l=u.next()){l=l.value;var f=tC(l);f=x(f);for(var g=f.next();!g.done;g=f.next()){g=g.value;var y=l.allowedByKeySystem;if(g.keyIds.size)if(g.drmInfos.length&&!s.size&&e.i.type=="HLS")for(var v=x(g.drmInfos),w=v.next();!w.done;w=v.next())w=w.value,w.keySystem==r&&(w.keyIds.size?o(l,w.keyIds):o(l,g.keyIds));else o(l,g.keyIds);y!=l.allowedByKeySystem&&(n=!0)}}}n&&(Cn(e),(n=e.l.o)&&!n.allowedByKeySystem?ls(e):us(e))}function cg(e,t,n){t>0&&(e.W()||e.Wi(t)),t=e.getDuration(),n<t&&(e.W()||e.Ab(n))}function Xs(e,t){F(function(n){if(n.g==1)return C(n,Promise.resolve(),2);e.m!=Ur&&e.dispatchEvent(t),ie(n)})}function JT(e){var t=new Set;e=x(e);for(var n=e.next();!n.done;n=e.next())n=n.value,n.language?t.add(tt(n.language)):t.add("und");return t}function ZT(e){for(var t=new Map,n=new Map,r=0;r<e.length;r++){var i=e[r],s="und",o=[];i.language&&(s=tt(i.language)),i.type=="variant"?o=i.audioRoles:o=i.roles,o&&o.length||(o=[""]),t.has(s)||t.set(s,new Set),o=x(o);for(var u=o.next();!u.done;u=o.next())u=u.value,t.get(s).add(u),i.label&&(n.has(s)||n.set(s,new Map),n.get(s).set(u,i.label))}var l=[];return t.forEach(function(f,g){f=x(f);for(var y=f.next();!y.done;y=f.next()){y=y.value;var v=null;n.has(g)&&n.get(g).has(y)&&(v=n.get(g).get(y)),l.push({language:g,role:y,label:v})}}),l}p.xa=function(){return this.h&&this.h.remote?this.h.remote.state!="disconnected":!1},p.fe=function(){return!this.h||this.h.ended?!0:this.Ua&&!this.W()&&this.h.currentTime>=this.Ra().end},de("shaka.Player",te),te.prototype.isEnded=te.prototype.fe,te.prototype.isRemotePlayback=te.prototype.xa,te.prototype.addFont=te.prototype.addFont,te.prototype.setVideoContainer=te.prototype.Xi,te.prototype.getFetchedPlaybackInfo=te.prototype.Jj,te.prototype.getManifestParserFactory=te.prototype.Oj,te.prototype.getManifest=te.prototype.Kg,te.prototype.retryStreaming=te.prototype.jh,te.prototype.setMaxHardwareResolution=te.prototype.al,te.prototype.addChaptersTrack=te.prototype.Ne,te.prototype.addThumbnailsTrack=te.prototype.Oe,te.prototype.addTextTrackAsync=te.prototype.Qd,te.prototype.getStats=te.prototype.getStats,te.prototype.getBufferedInfo=te.prototype.Gc,te.prototype.getSegmentAvailabilityDuration=te.prototype.cf,te.prototype.getPresentationStartTimeAsDate=te.prototype.ji,te.prototype.getPlayheadTimeAsDate=te.prototype.Rj,te.prototype.setTextTrackVisibility=te.prototype.uh,te.prototype.getChaptersAsync=te.prototype.Ej,te.prototype.getChapters=te.prototype.Dj,te.prototype.getChaptersTracks=te.prototype.Fj,te.prototype.isTextTrackVisible=te.prototype.Rg,te.prototype.selectVariantsByLabel=te.prototype.Vk,te.prototype.selectTextLanguage=te.prototype.nh,te.prototype.selectAudioLanguage=te.prototype.Ri,te.prototype.getTextLanguages=te.prototype.Xj,te.prototype.getAudioLanguages=te.prototype.Aj,te.prototype.getTextLanguagesAndRoles=te.prototype.Yj,te.prototype.getAudioLanguagesAndRoles=te.prototype.Bj,te.prototype.getVideoTracks=te.prototype.getVideoTracks,te.prototype.selectVideoTrack=te.prototype.Wk,te.prototype.getAudioTracks=te.prototype.getAudioTracks,te.prototype.selectAudioTrack=te.prototype.Uk,te.prototype.selectVariantTrack=te.prototype.If,te.prototype.selectTextTrack=te.prototype.oh,te.prototype.getThumbnails=te.prototype.$j,te.prototype.getAllThumbnails=te.prototype.zj,te.prototype.getImageTracks=te.prototype.Lj,te.prototype.getTextTracks=te.prototype.Lc,te.prototype.getVariantTracks=te.prototype.qc,te.prototype.cancelTrickPlay=te.prototype.Rd,te.prototype.trickPlay=te.prototype.we,te.prototype.useTrickPlayTrackIfAvailable=te.prototype.Ih,te.prototype.getPlaybackRate=te.prototype.Pb,te.prototype.isBuffering=te.prototype.Qg,te.prototype.getKeyStatuses=te.prototype.Ze,te.prototype.getActiveSessionsMetadata=te.prototype.Jg,te.prototype.getExpiration=te.prototype.Yd,te.prototype.drmInfo=te.prototype.drmInfo,te.prototype.keySystem=te.prototype.keySystem,te.prototype.isFullyLoaded=te.prototype.kk,te.prototype.goToLive=te.prototype.gk,te.prototype.seekRange=te.prototype.Ra,te.prototype.isVideoOnly=te.prototype.ri,te.prototype.isAudioOnly=te.prototype.jk,te.prototype.isInProgress=te.prototype.Vc,te.prototype.isLive=te.prototype.W,te.prototype.getQueueManager=te.prototype.ki,te.prototype.getAdManager=te.prototype.bi,te.prototype.getAssetUri=te.prototype.rd,te.prototype.getNetworkingEngine=te.prototype.Zb,te.prototype.getMediaElement=te.prototype.$e,te.prototype.getManifestType=te.prototype.ei,te.prototype.getLoadMode=te.prototype.Zd,te.prototype.resetConfiguration=te.prototype.Mi,te.prototype.getBufferFullness=te.prototype.ci,te.prototype.getNonDefaultConfiguration=te.prototype.ii,te.prototype.getConfigurationForLowLatency=te.prototype.Gj,te.prototype.getConfiguration=te.prototype.getConfiguration,te.prototype.configurationForLowLatency=te.prototype.wj,te.prototype.configure=te.prototype.configure,te.prototype.releaseAllMutexes=te.prototype.Mk,te.prototype.destroyAllPreloads=te.prototype.qg,te.prototype.preload=te.prototype.preload,te.prototype.detachAndSavePreload=te.prototype.Yh,te.prototype.unloadAndSavePreload=te.prototype.hj,te.prototype.load=te.prototype.load,te.prototype.updateStartTime=te.prototype.ll,te.prototype.unload=te.prototype.Cc,te.prototype.detach=te.prototype.detach,te.prototype.attachCanvas=te.prototype.oj,te.prototype.attach=te.prototype.Wb,te.probeSupport=function(e){e=e===void 0?!0:e;var t,n,r,i,s,o,u;return F(function(l){switch(l.g){case 1:if(t={},!e){l.A(2);break}return C(l,SC(),3);case 3:t=l.h;case 2:return n=b2(),r=iM(),i=je(),C(l,i.lc(),4);case 4:return s=l.h,o={manifest:n,media:r,drm:t,hardwareResolution:s},u=t1,u.forEach(function(f,g){o[g]=f()}),l.return(o)}})},te.isBrowserSupported=function(){return m.Promise||Be("A Promise implementation or polyfill is required"),!(m.Promise&&m.Uint8Array&&Array.prototype.forEach)||(navigator.userAgent||"").includes("Trident/")?!1:(je(),oi()?!0:Bs().canPlayType("application/x-mpegurl")!="")},te.setQueueManagerFactory=function(e){dd=e},te.setAdManagerFactory=function(e){cd=e},te.registerSupportPlugin=CT,te.prototype.destroy=te.prototype.destroy;var Ur=0,ld=1,an=2,Qn=3;te.LoadMode={DESTROYED:Ur,NOT_LOADED:ld,MEDIA_SOURCE:an,SRC_EQUALS:Qn},te.version="v4.16.11";var e1=["4","16"];dv=new function(e){this.g=e,this.i=C2,this.h=M2}(new gh(Number(e1[0]),Number(e1[1])));var t1=new Map,cd=null,dd=null;function n1(){this.g=[],this.i=this.m=this.l=this.j=this.h=0}function mk(e){return e.g.length?e.g.reduce(function(t,n){return t+n},0)/e.g.length:0}function Me(e,t,n){var r=this;this.g=e,this.h=t,this.m=n,this.i=!1,this.j=this.h.getVolume(),this.l=new et,this.l.D(this.h,google.ima.AdEvent.Type.PAUSED,function(){r.i=!0}),this.l.D(this.h,google.ima.AdEvent.Type.RESUMED,function(){r.i=!1})}p=Me.prototype,p.needsSkipUI=function(){return!1},p.isClientRendering=function(){return!0},p.hasCustomClick=function(){return!0},p.isUsingAnotherMediaElement=function(){return!0},p.getDuration=function(){return this.g.getDuration()},p.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},p.getRemainingTime=function(){return this.h.getRemainingTime()},p.isPaused=function(){return this.i},p.isSkippable=function(){return this.g.getSkipTimeOffset()>=0},p.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},p.canSkipNow=function(){return this.h.getAdSkippableState()},p.skip=function(){return this.h.skip()},p.pause=function(){return this.h.pause()},p.play=function(){return this.h.resume()},p.getVolume=function(){return this.h.getVolume()},p.setVolume=function(e){return this.m.volume=e,this.h.setVolume(e)},p.isMuted=function(){return this.h.getVolume()==0},p.isLinear=function(){return this.g.isLinear()},p.resize=function(e,t){this.h.resize(e,t)},p.setMuted=function(e){(this.m.muted=e)?(this.j=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.j)},p.getSequenceLength=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getTotalAds()},p.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getAdPosition()},p.getTitle=function(){return this.g.getTitle()},p.getDescription=function(){return this.g.getDescription()},p.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},p.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},p.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},p.getVastAdId=function(){return""},p.getAdId=function(){return this.g.getAdId()},p.getCreativeAdId=function(){return this.g.getCreativeAdId()},p.getAdvertiserName=function(){return this.g.getAdvertiserName()},p.getMediaUrl=function(){return this.g.getMediaUrl()},p.getTimeOffset=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getTimeOffset()},p.getPodIndex=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getPodIndex()},p.release=function(){this.h=this.g=null},de("shaka.ads.ClientSideAd",Me),Me.prototype.release=Me.prototype.release,Me.prototype.getPodIndex=Me.prototype.getPodIndex,Me.prototype.getTimeOffset=Me.prototype.getTimeOffset,Me.prototype.getMediaUrl=Me.prototype.getMediaUrl,Me.prototype.getAdvertiserName=Me.prototype.getAdvertiserName,Me.prototype.getCreativeAdId=Me.prototype.getCreativeAdId,Me.prototype.getAdId=Me.prototype.getAdId,Me.prototype.getVastAdId=Me.prototype.getVastAdId,Me.prototype.getVastMediaWidth=Me.prototype.getVastMediaWidth,Me.prototype.getVastMediaHeight=Me.prototype.getVastMediaHeight,Me.prototype.getVastMediaBitrate=Me.prototype.getVastMediaBitrate,Me.prototype.getDescription=Me.prototype.getDescription,Me.prototype.getTitle=Me.prototype.getTitle,Me.prototype.getPositionInSequence=Me.prototype.getPositionInSequence,Me.prototype.getSequenceLength=Me.prototype.getSequenceLength,Me.prototype.setMuted=Me.prototype.setMuted,Me.prototype.resize=Me.prototype.resize,Me.prototype.isLinear=Me.prototype.isLinear,Me.prototype.isMuted=Me.prototype.isMuted,Me.prototype.setVolume=Me.prototype.setVolume,Me.prototype.getVolume=Me.prototype.getVolume,Me.prototype.play=Me.prototype.play,Me.prototype.pause=Me.prototype.pause,Me.prototype.skip=Me.prototype.skip,Me.prototype.canSkipNow=Me.prototype.canSkipNow,Me.prototype.getTimeUntilSkippable=Me.prototype.getTimeUntilSkippable,Me.prototype.isSkippable=Me.prototype.isSkippable,Me.prototype.isPaused=Me.prototype.isPaused,Me.prototype.getRemainingTime=Me.prototype.getRemainingTime,Me.prototype.getMinSuggestedDuration=Me.prototype.getMinSuggestedDuration,Me.prototype.getDuration=Me.prototype.getDuration,Me.prototype.isUsingAnotherMediaElement=Me.prototype.isUsingAnotherMediaElement,Me.prototype.hasCustomClick=Me.prototype.hasCustomClick,Me.prototype.isClientRendering=Me.prototype.isClientRendering,Me.prototype.needsSkipUI=Me.prototype.needsSkipUI;function yt(){}function r1(e,t){var n=[];e=x(it(e,"Ad"));for(var r=e.next();!r.done;r=e.next())if((r=gt(r.value,"InLine"))&&(r=gt(r,"Creatives"))){r=x(it(r,"Creative"));for(var i=r.next();!i.done;i=r.next()){i=i.value;var s=gt(i,"Linear");if(s&&yk(n,t,s),i=gt(i,"NonLinearAds")){i=it(i,"NonLinear"),i=x(i);for(var o=i.next();!o.done;o=i.next())e:{s=n;var u=t,l=o.value,f=gt(l,"StaticResource");if(f)o=f.attributes.creativeType;else{if(f=gt(l,"HTMLResource"),!f)break e;o="text/html"}if(f=In(f)){o==="text/html"&&(f="data:text/html;charset=UTF-8,"+encodeURIComponent(f));var g=De(l,"width",nn)||De(l,"expandedWidth",nn),y=De(l,"height",nn)||De(l,"expandedHeight",nn);if(g||y){var v=null,w=gt(l,"NonLinearClickThrough");w&&(w=In(w))&&(v=w),w=null,(l=l.attributes.minSuggestedDuration)&&(w=fo(l)),l=0,u!=null&&(l=u),s.push({id:null,groupId:null,startTime:l,endTime:null,uri:f,mimeType:o,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:w,once:!0,pre:u==null,post:u==1/0,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:g||0,y:y||0}},displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:v})}}}}}}return n}function yk(e,t,n){var r=0;t!=null&&(r=t);var i=null;n.attributes.skipoffset&&(i=fo(n.attributes.skipoffset),isNaN(i)&&(i=null));var s=gt(n,"MediaFiles");if(s){var o=null;for((n=gt(n,"VideoClicks"))&&(n=gt(n,"ClickThrough"))&&(n=In(n))&&(o=n),s=n=it(s,"MediaFile"),n=n.filter(function(l){return l.attributes.delivery=="streaming"}),n.length&&(s=n),s=s.sort(function(l,f){return(parseInt(f.attributes.height,10)||0)-(parseInt(l.attributes.height,10)||0)}),s=x(s),n=s.next();!n.done;n=s.next())if(n=n.value,!n.attributes.apiFramework){var u=In(n);if(u){e.push({id:null,groupId:null,startTime:r,endTime:null,uri:u,mimeType:n.attributes.type||null,isSkippable:i!=null,skipOffset:i,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:t==null,post:t==1/0,timelineRange:!1,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:o});break}}}}function vk(e){var t=[];e=x(it(e,"vmap:AdBreak"));for(var n=e.next();!n.done;n=e.next()){var r=n.value,i=r.attributes.timeOffset;i&&(n=null,i=="start"?n=null:i=="end"?n=1/0:n=fo(i),(r=gt(r,"vmap:AdSource"))&&(r=gt(r,"vmap:AdTagURI"))&&(r=Dt(r))&&t.push({time:n,uri:r}))}return t}de("shaka.ads.Utils",yt),yt.ADS_LOADED="ads-loaded",yt.AD_STARTED="ad-started",yt.AD_FIRST_QUARTILE="ad-first-quartile",yt.AD_MIDPOINT="ad-midpoint",yt.AD_THIRD_QUARTILE="ad-third-quartile",yt.AD_COMPLETE="ad-complete",yt.AD_STOPPED="ad-stopped",yt.AD_SKIPPED="ad-skipped",yt.AD_VOLUME_CHANGED="ad-volume-changed",yt.AD_MUTED="ad-muted",yt.AD_PAUSED="ad-paused",yt.AD_RESUMED="ad-resumed",yt.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",yt.CUEPOINTS_CHANGED="ad-cue-points-changed",yt.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",yt.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",yt.AD_CLICKED="ad-clicked",yt.AD_PROGRESS="ad-progress",yt.AD_BUFFERING="ad-buffering",yt.AD_IMPRESSION="ad-impression",yt.AD_DURATION_CHANGED="ad-duration-changed",yt.AD_CLOSED="ad-closed",yt.AD_LOADED="ad-loaded",yt.ALL_ADS_COMPLETED="all-ads-completed",yt.AD_LINEAR_CHANGED="ad-linear-changed",yt.AD_METADATA="ad-metadata",yt.AD_RECOVERABLE_ERROR="ad-recoverable-error",yt.AD_ERROR="ad-error",yt.AD_BREAK_READY="ad-break-ready",yt.AD_INTERACTION="ad-interaction",yt.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",yt.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",yt.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested";function fd(e,t,n,r,i){var s=this;this.u=e,this.i=t,this.G=!1,this.B=this.o=null,this.H=NaN,this.l=i,this.j=null,this.h=new et,google.ima.settings.setLocale(n),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.F=new google.ima.AdDisplayContainer(this.u,this.i),this.F.initialize(),this.m=new google.ima.AdsLoader(this.F),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.16.11"),this.g=null,this.C=r||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(o){xk(s,o)}),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(o){i1(s,o)}),this.h.D(this.i,"ended",function(){s.m.contentComplete()}),this.h.Aa(this.i,"play",function(){s.G=!0})}fd.prototype.configure=function(e){this.o=e},fd.prototype.stop=function(){this.g&&this.g.stop(),this.u&&ou(this.u)},fd.prototype.release=function(){this.stop(),this.B&&this.B.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.F.destroy()};function i1(e,t){t.getError(),t=new Map().set("originalEvent",t),e.l(new Se("ad-error",t)),hd(e,null),e.l(new Se("ad-cue-points-changed",new Map().set("cuepoints",[])))}function xk(e,t){if(e.l(new Se("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.H))),e.o.customPlayheadTracker){var n={currentTime:e.i.currentTime};e.g=t.getAdsManager(n,e.C),e.i.muted?e.g.setVolume(0):e.g.setVolume(e.i.volume),e.h.D(e.i,"timeupdate",function(){e.i.duration&&(n.currentTime=e.i.currentTime)}),e.h.D(e.i,"volumechange",function(){e.j&&(e.j.setVolume(e.i.volume),e.i.muted&&e.j.setMuted(!0))})}else e.g=t.getAdsManager(e.i,e.C);e.l(new Se("ima-ad-manager-loaded",new Map().set("imaAdManager",e.g)));var r=e.g.getCuePoints();if(r.length){t=[],r=x(r);for(var i=r.next();!i.done;i=r.next())t.push({start:i.value,end:null});e.l(new Se("ad-cue-points-changed",new Map().set("cuepoints",t)))}Tk(e);try{e.g.init(e.i.offsetWidth,e.i.offsetHeight),e.h.D(e.i,"loadeddata",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight)}),"ResizeObserver"in m?(e.B=new ResizeObserver(function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight)}),e.B.observe(e.i)):e.h.D(document,"fullscreenchange",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight)}),e.G||e.o.skipPlayDetection?e.g.start():e.h.Aa(e.i,"play",function(){e.G=!0,e.g.start()})}catch(s){hd(e,null)}}function Tk(e){function t(n,r){n=new Map().set("originalEvent",n),e.l(new Se(r,n))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(n){i1(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(n){s1(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,function(n){s1(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(n){t(n,"ad-first-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,function(n){t(n,"ad-midpoint")}),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(n){t(n,"ad-third-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,function(n){t(n,"ad-complete")}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(n){hd(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(n){t(n,"all-ads-completed"),hd(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,function(n){t(n,"ad-skipped")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(n){t(n,"ad-volume-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(n){t(n,"ad-muted")}),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,function(n){t(n,"ad-clicked")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(n){t(n,"ad-progress")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(n){t(n,"ad-buffering")}),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,function(n){t(n,"ad-impression")}),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(n){t(n,"ad-duration-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(n){t(n,"ad-closed")}),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,function(n){t(n,"ad-loaded")}),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(n){t(n,"ad-linear-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,function(n){t(n,"ad-metadata")}),e.h.D(e.g,google.ima.AdEvent.Type.LOG,function(n){t(n,"ad-recoverable-error")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(n){t(n,"ad-break-ready")}),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,function(n){t(n,"ad-interaction")})}function s1(e,t){var n=t.getAd();n?(e.j=new Me(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Se("ad-content-pause-requested")),t=new Map().set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Se("ad-started",t)),e.j.isLinear()&&(e.u.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?(t=e.j,t.j=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):Be("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function hd(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Se("ad-content-resume-requested")),e.l(new Se("ad-stopped",new Map().set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.u.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function Re(e,t,n,r,i,s){this.g=e,this.h=t,this.j=(this.i=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.l=t.skipFor,this.B=n,this.o=r,this.m=i,this.u=s,this.C=t.overlay}p=Re.prototype,p.needsSkipUI=function(){return!0},p.isClientRendering=function(){return!0},p.hasCustomClick=function(){return this.h.clickThroughUrl!=null},p.isUsingAnotherMediaElement=function(){return this.u},p.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},p.getMinSuggestedDuration=function(){return this.getDuration()},p.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},p.isPaused=function(){return this.g.paused},p.isSkippable=function(){return this.i&&this.l!=null?this.getDuration()-this.getRemainingTime()<this.j+this.l:this.i},p.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},p.canSkipNow=function(){return this.i&&this.getTimeUntilSkippable()==0},p.skip=function(){this.canSkipNow()&&this.B()},p.pause=function(){return this.g.pause()},p.play=function(){return this.g.play()},p.getVolume=function(){return this.g.volume},p.setVolume=function(e){this.g.volume=e},p.isMuted=function(){return this.g.muted},p.isLinear=function(){return this.C==null},p.resize=function(){},p.setMuted=function(e){this.g.muted=e},p.getSequenceLength=function(){return this.o},p.getPositionInSequence=function(){return this.m},p.getTitle=function(){return""},p.getDescription=function(){return""},p.getVastMediaBitrate=function(){return 0},p.getVastMediaHeight=function(){return 0},p.getVastMediaWidth=function(){return 0},p.getVastAdId=function(){return""},p.getAdId=function(){return this.h.id||""},p.getCreativeAdId=function(){return""},p.getAdvertiserName=function(){return""},p.getMediaUrl=function(){return this.h.uri},p.getTimeOffset=function(){return this.h.pre?0:this.h.post?-1:this.h.startTime},p.getPodIndex=function(){return 0},p.release=function(){this.g=null},de("shaka.ads.InterstitialAd",Re),Re.prototype.release=Re.prototype.release,Re.prototype.getPodIndex=Re.prototype.getPodIndex,Re.prototype.getTimeOffset=Re.prototype.getTimeOffset,Re.prototype.getMediaUrl=Re.prototype.getMediaUrl,Re.prototype.getAdvertiserName=Re.prototype.getAdvertiserName,Re.prototype.getCreativeAdId=Re.prototype.getCreativeAdId,Re.prototype.getAdId=Re.prototype.getAdId,Re.prototype.getVastAdId=Re.prototype.getVastAdId,Re.prototype.getVastMediaWidth=Re.prototype.getVastMediaWidth,Re.prototype.getVastMediaHeight=Re.prototype.getVastMediaHeight,Re.prototype.getVastMediaBitrate=Re.prototype.getVastMediaBitrate,Re.prototype.getDescription=Re.prototype.getDescription,Re.prototype.getTitle=Re.prototype.getTitle,Re.prototype.getPositionInSequence=Re.prototype.getPositionInSequence,Re.prototype.getSequenceLength=Re.prototype.getSequenceLength,Re.prototype.setMuted=Re.prototype.setMuted,Re.prototype.resize=Re.prototype.resize,Re.prototype.isLinear=Re.prototype.isLinear,Re.prototype.isMuted=Re.prototype.isMuted,Re.prototype.setVolume=Re.prototype.setVolume,Re.prototype.getVolume=Re.prototype.getVolume,Re.prototype.play=Re.prototype.play,Re.prototype.pause=Re.prototype.pause,Re.prototype.skip=Re.prototype.skip,Re.prototype.canSkipNow=Re.prototype.canSkipNow,Re.prototype.getTimeUntilSkippable=Re.prototype.getTimeUntilSkippable,Re.prototype.isSkippable=Re.prototype.isSkippable,Re.prototype.isPaused=Re.prototype.isPaused,Re.prototype.getRemainingTime=Re.prototype.getRemainingTime,Re.prototype.getMinSuggestedDuration=Re.prototype.getMinSuggestedDuration,Re.prototype.getDuration=Re.prototype.getDuration,Re.prototype.isUsingAnotherMediaElement=Re.prototype.isUsingAnotherMediaElement,Re.prototype.hasCustomClick=Re.prototype.hasCustomClick,Re.prototype.isClientRendering=Re.prototype.isClientRendering,Re.prototype.needsSkipUI=Re.prototype.needsSkipUI;function ke(e,t,n){this.g=e,this.j=t,this.h=n,this.i=e.overlay==null}p=ke.prototype,p.needsSkipUI=function(){return!0},p.isClientRendering=function(){return!0},p.hasCustomClick=function(){return this.g.clickThroughUrl!=null},p.isUsingAnotherMediaElement=function(){return!1},p.getDuration=function(){return-1},p.getMinSuggestedDuration=function(){return this.getDuration()},p.getRemainingTime=function(){return-1},p.isPaused=function(){return!1},p.isSkippable=function(){return!1},p.getTimeUntilSkippable=function(){return 0},p.canSkipNow=function(){return!1},p.skip=function(){},p.pause=function(){},p.play=function(){},p.getVolume=function(){return 1},p.setVolume=function(){},p.isMuted=function(){return!1},p.isLinear=function(){return this.i},p.resize=function(){},p.setMuted=function(){},p.getSequenceLength=function(){return this.j},p.getPositionInSequence=function(){return this.h},p.getTitle=function(){return""},p.getDescription=function(){return""},p.getVastMediaBitrate=function(){return 0},p.getVastMediaHeight=function(){return 0},p.getVastMediaWidth=function(){return 0},p.getVastAdId=function(){return""},p.getAdId=function(){return this.g.id||""},p.getCreativeAdId=function(){return""},p.getAdvertiserName=function(){return""},p.getMediaUrl=function(){return this.g.uri},p.getTimeOffset=function(){return this.g.pre?0:this.g.post?-1:this.g.startTime},p.getPodIndex=function(){return 0},p.release=function(){},de("shaka.ads.InterstitialStaticAd",ke),ke.prototype.release=ke.prototype.release,ke.prototype.getPodIndex=ke.prototype.getPodIndex,ke.prototype.getTimeOffset=ke.prototype.getTimeOffset,ke.prototype.getMediaUrl=ke.prototype.getMediaUrl,ke.prototype.getAdvertiserName=ke.prototype.getAdvertiserName,ke.prototype.getCreativeAdId=ke.prototype.getCreativeAdId,ke.prototype.getAdId=ke.prototype.getAdId,ke.prototype.getVastAdId=ke.prototype.getVastAdId,ke.prototype.getVastMediaWidth=ke.prototype.getVastMediaWidth,ke.prototype.getVastMediaHeight=ke.prototype.getVastMediaHeight,ke.prototype.getVastMediaBitrate=ke.prototype.getVastMediaBitrate,ke.prototype.getDescription=ke.prototype.getDescription,ke.prototype.getTitle=ke.prototype.getTitle,ke.prototype.getPositionInSequence=ke.prototype.getPositionInSequence,ke.prototype.getSequenceLength=ke.prototype.getSequenceLength,ke.prototype.setMuted=ke.prototype.setMuted,ke.prototype.resize=ke.prototype.resize,ke.prototype.isLinear=ke.prototype.isLinear,ke.prototype.isMuted=ke.prototype.isMuted,ke.prototype.setVolume=ke.prototype.setVolume,ke.prototype.getVolume=ke.prototype.getVolume,ke.prototype.play=ke.prototype.play,ke.prototype.pause=ke.prototype.pause,ke.prototype.skip=ke.prototype.skip,ke.prototype.canSkipNow=ke.prototype.canSkipNow,ke.prototype.getTimeUntilSkippable=ke.prototype.getTimeUntilSkippable,ke.prototype.isSkippable=ke.prototype.isSkippable,ke.prototype.isPaused=ke.prototype.isPaused,ke.prototype.getRemainingTime=ke.prototype.getRemainingTime,ke.prototype.getMinSuggestedDuration=ke.prototype.getMinSuggestedDuration,ke.prototype.getDuration=ke.prototype.getDuration,ke.prototype.isUsingAnotherMediaElement=ke.prototype.isUsingAnotherMediaElement,ke.prototype.hasCustomClick=ke.prototype.hasCustomClick,ke.prototype.isClientRendering=ke.prototype.isClientRendering,ke.prototype.needsSkipUI=ke.prototype.needsSkipUI;function o1(e,t,n,r){function i(o){return o?o.overlay?!0:s.g.ended?o.post:!s.g.paused:!1}var s=this;this.M=null,this.m=e,this.C=t,this.g=n,this.G=null,this.u=!0,this.h=this.g,this.va=r,this.ma=new Set,this.T=new Set,this.H=new Set,this.F=new Map,this.K=new Map,this.i=new te,pg(this),this.I=new et,this.j=new et,this.J=!1,this.$=this.o=this.B=this.l=null,this.ba=!1,this.O=-1,this.X=function(){if(!s.J&&s.l&&!s.C.xa()){s.l=s.g.currentTime;var o=Ho(s);o&&i(o)&&pd(s,o,1,1,Date.now())}},this.V=function(){if(!(s.J||s.l||s.C.xa())){s.g.paused||(s.l=s.g.currentTime);var o=Ho(s,!0);o||(o=Ho(s)),o&&i(o)&&pd(s,o,1,1,Date.now())}},this.oa=function(){if(!s.J&&s.l&&!s.C.xa()){var o=s.g.currentTime;s.B&&!s.B.pre&&!s.B.post&&o<(s.B.endTime||s.B.startTime)&&(s.B=null)}},this.R=new Ve(this.X),this.N=new Ve(function(){var o,u,l,f,g,y,v,w,A,I,E;return F(function(R){switch(R.g){case 1:if(!s.H.size||s.l==null){R.A(0);break}if(o=s.C.Zd(),o==Ur||o==ld)return R.return();u=!1,l=Array.from(s.H),f=s.C.Ra(),g=x(l),y=g.next();case 3:if(y.done){R.A(5);break}if(v=y.value,v==s.B){R.A(4);break}if(w=v.endTime||v.startTime,!(f.start-w>=1)){A=v.startTime-s.l,A>0&&A<=10&&(!s.F.has(v)&&u1(v)&&s.F.set(v,s.i.preload(v.uri,null,v.mimeType||void 0)),c1(s,v)),R.A(4);break}if(!s.F.has(v)){R.A(7);break}return C(R,s.F.get(v),8);case 8:(I=R.h)&&I.destroy(),s.F.delete(v);case 7:d1(s,v),E=v.id||JSON.stringify(v),s.T.has(E)&&s.T.delete(E),s.H.delete(v),dg(s),v.overlay||(u=!0);case 4:y=g.next(),R.A(3);break;case 5:u&&gd(s),ie(R)}})}),this.configure(this.C.getConfiguration().ads)}p=o1.prototype,p.configure=function(e){this.M=e,fg(this)};function wk(e){if(!e.ba&&e.H.size){if(e.I.D(e.g,"playing",e.V),e.I.D(e.g,"timeupdate",e.V),e.I.D(e.g,"seeked",e.oa),e.I.D(e.g,"ended",e.X),"requestVideoFrameCallback"in e.g&&!l1()){var t=e.g,n=function(){e.O!=-1&&(e.X(),e.O!=-1&&(e.O=t.requestVideoFrameCallback(n)))};e.O=t.requestVideoFrameCallback(n)}else e.R.Ea(.025);e.N&&e.N.Ea(1),e.ba=!0}}function dg(e){e.ba&&!e.H.size&&(e.I.Ma(e.g,"playing",e.V),e.I.Ma(e.g,"timeupdate",e.V),e.I.Ma(e.g,"seeked",e.oa),e.I.Ma(e.g,"ended",e.X),e.O!=-1&&(e.g.cancelVideoFrameCallback(e.O),e.O=-1),e.R&&e.R.stop(),e.N&&e.N.stop(),e.ba=!1)}function fg(e){if(e.m&&e.M){var t=e.M.supportsMultipleMediaElements,n=e.g;(n.controls||n.webkitPresentationMode&&n.webkitPresentationMode!=="inline"||n.webkitDisplayingFullscreen)&&(t=!1),e.u==t&&(e.u=!t,e.u?(e.h=e.g,e.G&&(e.G.parentElement&&e.m.removeChild(e.G),e.G=null)):(e.G||(t=document.createElement(e.g.tagName),t.autoplay=!0,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="none",t.setAttribute("playsinline",""),e.G=t),e.h=e.G))}else e.u=!0}p.stop=function(){if(this.j&&this.j.Qa(),this.ma.clear(),this.T.clear(),this.H.clear(),this.i.qg(),this.F.size){var e=Array.from(this.F.values());e=x(e);for(var t=e.next();!t.done;t=e.next())(t=t.value)&&t.then(function(n){n&&n.destroy()})}if(this.F.clear(),this.K.size)for(e=Array.from(this.K.keys()),e=x(e),t=e.next();!t.done;t=e.next())d1(this,t.value);this.K.clear(),this.i.detach(),this.J=!1,this.B=this.l=null,this.u=!0,this.h=this.g,this.G=null,hg(this),dg(this),this.m&&ou(this.m),this.o&&(this.o.stop(),this.o=null)},p.release=function(){this.stop(),this.I&&this.I.release(),this.j&&this.j.release(),this.R&&(this.R.stop(),this.R=null),this.N&&(this.N.stop(),this.N=null),this.i.destroy()},p.td=function(){return this.i};function Sk(e,t){var n,r,i;F(function(s){if(s.g==1){if(n=null,(r=t.values.find(function(o){return o.key=="ID"}))&&(n=r.data),n){if(e.ma.has(n))return s.return();e.ma.add(n)}return pg(e),i=[],t&&t.values.find(function(o){return o.key=="X-OVERLAY-ID"})?(i=Mk(t),s.A(2)):C(s,Ck(e,t),3)}s.g!=2&&(i=s.h),i.length?Mu(e,i):Be("Unsupported HLS interstitial",t),ie(s)})}function Ak(e,t){var n=gt(t.eventNode,"OverlayEvent"),r=n.attributes.uri,i=n.attributes.mimeType,s=n.attributes.loop=="true",o=De(n,"z",nn);if(r&&o!=0){var u=null,l=gt(n,"Background");if(l){var f=l.attributes.uri;f?u="center / contain no-repeat url('"+f+"')":u=In(l)}l=1920,f=1080;var g=gt(n,"Viewport");if(g&&(l=De(g,"x",nn),l==null||(f=De(g,"y",nn),f==null)))return;var y={viewport:{x:l,y:f},topLeft:{x:0,y:0},size:{x:l,y:f}},v=gt(n,"Overlay");if(g&&v){var w=gt(v,"TopLeft"),A=gt(v,"Size");if(w&&A){if(v=De(w,"x",nn),v==null||(w=De(w,"y",nn),w==null))return;var I=De(A,"x",nn);if(I==null||(A=De(A,"y",nn),A==null))return;y.topLeft.x=v,y.topLeft.y=w,y.size.x=I,y.size.y=A}}if(v=null,n=gt(n,"Squeeze"),g&&n&&(A=gt(n,"TopLeft"),n=gt(n,"Size"),A&&n)){if(g=De(A,"x",nn),g==null||(v=De(A,"y",nn),v==null)||(A=De(n,"x",nn),A==null)||(n=De(n,"y",nn),n==null))return;v={viewport:{x:l,y:f},topLeft:{x:g,y:v},size:{x:A,y:n}}}Mu(e,[{id:t.id,groupId:null,startTime:t.startTime,endTime:t.endTime,uri:r,mimeType:i,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:s,overlay:y,displayOnBackground:o==-1,currentVideo:v,background:u,clickThroughUrl:null}])}}p.addAdUrlInterstitial=function(e){var t=this,n,r,i,s,o,u,l,f,g;return F(function(y){if(y.g==1)return n={type:12},C(y,gg(t,e,n),2);if(y.g!=3){if(r=y.h,i=Ba(r,"VAST,vmap:VMAP"),!i)throw new H(2,10,10007);if(s=[],i.tagName=="VAST")return s=r1(i,t.l),y.A(3);if(i.tagName!="vmap:VMAP")return y.A(3);for(o=function(v){var w,A;return F(function(I){if(I.g==1)return C(I,gg(t,v.uri,n),2);if(w=I.h,A=Ba(w,"VAST"),!A)throw new H(2,10,10007);s.push.apply(s,Y(r1(A,v.time))),ie(I)})},u=[],l=x(vk(i)),f=l.next();!f.done;f=l.next())g=f.value,u.push(o(g));return u.length?C(y,Promise.all(u),3):y.A(3)}Mu(t,s),ie(y)})};function Mu(e,t){var n,r,i,s,o,u,l,f;F(function(g){switch(g.g){case 1:n=!1,r=x(t),i=r.next();case 2:if(i.done){g.A(4);break}if(s=i.value,!s.uri){Be("Missing URL in interstitial",s),g.A(3);break}if(s.mimeType){g.A(5);break}return Z(g,6),o=e.i.Zb(),C(g,Lo(s.uri,o,e.C.getConfiguration().streaming.retryParameters),8);case 8:s.mimeType=g.h,ce(g,5);break;case 6:se(g);case 5:if(u=s.id||JSON.stringify(s),e.T.has(u)){g.A(3);break}s.loop&&!s.overlay&&Be("Loop is only supported in overlay interstitials",s),s.overlay||(n=!0),e.T.add(u),e.H.add(s),l=!1,s.pre&&e.l==null?l=!0:s.startTime!=0||s.canJump?e.l!=null&&(f=s.startTime-e.l,f>0&&f<=10&&(l=!0)):l=!0,l&&(!e.F.has(s)&&u1(s)&&e.F.set(s,e.i.preload(s.uri,null,s.mimeType||void 0)),c1(e,s));case 3:i=r.next(),g.A(2);break;case 4:n&&gd(e),wk(e),ie(g)}})}function Ho(e,t,n){t=t===void 0?!1:t,n=n===void 0?null:n;var r=0,i=null;if(e.H.size&&e.l!=null){var s=e.g.ended,o=Array.from(e.H).sort(function(y,v){return v.startTime-y.startTime}),u=o;for(u=t?o.filter(function(y){return y.pre}):s?o.filter(function(y){return y.post}):o.filter(function(y){return!y.pre&&!y.post}),o=x(u),u=o.next();!u.done;u=o.next()){u=u.value;var l=!1;if(t)l=u.pre;else if(s)l=u.post;else if(!u.pre&&!u.post){var f=e.l-Math.round(u.startTime*1e3)/1e3,g=1;e.M.allowStartInMiddleOfInterstitial&&u.endTime&&u.endTime!=1/0&&(g=u.endTime-u.startTime),(f>0||f==0&&e.l==0)&&(f<=g||!u.canJump)&&(l=!(n==null&&e.B&&!e.B.pre&&!e.B.post&&e.B.startTime>=u.startTime))}l&&(!e.B||u.startTime>=e.B.startTime)&&(r==(n||0)?i=u:i&&!u.canJump&&Math.round(u.startTime*1e3)/1e3-Math.round(i.startTime*1e3)/1e3>.001&&(i=u,r=0),r++)}}return i}function pd(e,t,n,r,i,s){s=s===void 0?0:s,e.B=t,fg(e),e.u||!e.m||e.h.parentElement||e.m.appendChild(e.h),r==1&&n==1&&(n=Array.from(e.H).filter(function(o){return t.pre?o.pre==t.pre:t.post?o.post==t.post:Math.abs(o.startTime-t.startTime)<.001}).length),t.once&&(s++,e.H.delete(t),dg(e),t.overlay||gd(e)),t.mimeType&&(t.mimeType.startsWith("image/")||t.mimeType==="text/html")?t.overlay?Ek(e,t,n,r,s):Be("Unsupported interstitial",t):e.u&&t.overlay?Be("Unsupported interstitial",t):Ik(e,t,n,r,i,s)}function Ek(e,t,n,r,i){function s(){e.o&&(e.o.stop(),e.o=null),e.m.removeChild(l),hg(e,t),_t(e,"ad-stopped"),e.j.Qa();var v=Ho(e,t.pre,r-i);v?pd(e,v,n,++r,Date.now(),i):e.J=!1}e.J=!0;var o=t.overlay,u=t.mimeType=="text/html"?"iframe":"img",l=document.createElement(u);l.style.objectFit="contain",l.style.position="absolute",l.style.border="none",a1(e,t);var f=new ke(t,n,r);_t(e,"ad-impression"),_t(e,"ad-started",new Map().set("ad",f)),u=="iframe"?l.src=t.uri:(l.src=t.uri,l.onerror=function(v){_t(e,"ad-error",new Map().set("originalEvent",v)),s()}),f=o.viewport;var g=o.topLeft;o=o.size,f.x==0&&f.y==0?(l.width=t.overlay.size.x,l.height=t.overlay.size.y,l.style.bottom="10%",l.style.left="0",l.style.right="0",l.style.width="100%",t.overlay.size.y||u!="iframe"||(l.style.height="auto")):(l.style.height=o.y/f.y*100+"%",l.style.left=g.x/f.x*100+"%",l.style.top=g.y/f.y*100+"%",l.style.width=o.x/f.x*100+"%"),e.m.appendChild(l);var y=Date.now();e.o&&e.o.stop(),e.o=new Ve(function(){t.playoutLimit&&(Date.now()-y)/1e3>t.playoutLimit||t.endTime&&e.g.currentTime>t.endTime?(_t(e,"ad-complete"),s()):e.g.currentTime<t.startTime&&(_t(e,"ad-skipped"),s())}),t.playoutLimit&&!t.endTime?e.o.ka(t.playoutLimit):t.endTime&&e.o.Ea(.025),e.j.D(e.g,"seeked",function(){var v=e.g.currentTime;(v<t.startTime||t.endTime&&v>t.endTime)&&(e.o&&e.o.stop(),_t(e,"ad-skipped"),s())}),t.clickThroughUrl&&e.j.D(l,"click",function(){t.clickThroughUrl&&m.open(t.clickThroughUrl,"_blank")})}function Ik(e,t,n,r,i,s){var o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B;F(function(W){switch(W.g){case 1:if(o=Date.now(),e.J=!0,u=!1,l=function(){if(!e.u&&!t.overlay&&t.resumeOffset==null)if(t.timelineRange&&t.endTime&&t.endTime!=1/0)e.g.currentTime!=t.endTime&&(e.g.currentTime=t.endTime);else{var G=Date.now();e.g.currentTime+=(G-i)/1e3,i=G}},f=function(G){var re,ne;return F(function($){if($.g==1){if(l(),re=Ho(e,t.pre,r-s),G&&t.groupId)for(;re&&re.groupId==t.groupId;)r++,re=Ho(e,t.pre,r-s);return e.o&&(!t.groupId||re&&re.groupId!=t.groupId)&&(e.o.stop(),e.o=null),hg(e,t),re&&!re.overlay?$.A(2):(t.post&&(e.l=null,e.B=null),e.u?C($,e.i.detach(),4):C($,e.i.Cc(),4))}$.g!=2&&(e.u&&(ne=t.resumeOffset,ne==null&&(ne=t.timelineRange&&t.endTime&&t.endTime!=1/0?t.endTime-(e.l||0):(Date.now()-i)/1e3),_t(e,"ad-content-resume-requested",new Map().set("offset",ne))),_t(e,"ad-stopped"),e.j.Qa(),e.J=!1,e.u?gd(e):(e.h.style.display="none",l(),e.g.ended||e.g.play())),fg(e),re&&(_t(e,"ad-stopped"),e.j.Qa(),pd(e,re,n,++r,i,s)),ie($)})},g=function(G){return F(function(re){return u?re.return():(u=!0,_t(e,"ad-error",new Map().set("originalEvent",G)),C(re,f(!1),0))})},y=function(){return F(function(G){if(G.g==1)return u?G.return():(u=!0,C(G,f(!1),2));_t(e,"ad-complete"),ie(G)})},e.$=function(){return F(function(G){return u?G.return():(u=!0,_t(e,"ad-skipped"),C(G,f(!0),0))})},v=new Re(e.h,t,e.$,n,r,!e.u),e.u||(v.setMuted(e.g.muted),v.setVolume(e.g.volume)),_t(e,"ad-started",new Map().set("ad",v)),(w=v.canSkipNow())&&_t(e,"ad-skip-state-changed"),e.j.Aa(e.i,"error",g),e.j.D(e.h,"timeupdate",function(){if(e.h.duration){var G=v.canSkipNow();w!=G&&v.getRemainingTime()>0&&v.getDuration()>0&&_t(e,"ad-skip-state-changed"),w=G,!e.u&&!t.overlay&&t.resumeOffset==null&&t.timelineRange&&t.endTime&&t.endTime!=1/0&&e.g.currentTime!=t.endTime&&e.C.Ra().end>=t.endTime&&(e.g.currentTime=t.endTime)}}),e.j.Aa(e.i,"firstquartile",function(){l(),_t(e,"ad-first-quartile")}),e.j.Aa(e.i,"midpoint",function(){l(),_t(e,"ad-midpoint")}),e.j.Aa(e.i,"thirdquartile",function(){l(),_t(e,"ad-third-quartile")}),e.j.Aa(e.i,"complete",y),e.j.D(e.h,"play",function(){_t(e,"ad-resumed")}),e.j.D(e.h,"pause",function(){var G=e.i.getConfiguration();e.h.currentTime>=G.playRangeEnd?y():_t(e,"ad-paused")}),e.j.D(e.h,"volumechange",function(){e.h.muted?_t(e,"ad-muted"):_t(e,"ad-volume-changed")}),t.clickThroughUrl&&(A=e.m||e.h,e.j.D(A,"click",function(){t.clickThroughUrl&&(v.isPaused()||v.pause(),m.open(t.clickThroughUrl,"_blank"))})),!e.u||r!=1){W.A(2);break}return _t(e,"ad-content-pause-requested",new Map().set("saveLivePosition",!0)),I=new at,E=function(G){return F(function(re){if(re.g==1)return G.state!="detach"?re.A(0):l1()?C(re,new Promise(function(ne){return new Ve(ne).ka(.1)}),3):re.A(3);I.resolve(),e.j.Ma(e.C,"onstatechange",E),ie(re)})},e.j.D(e.C,"onstatechange",E),C(W,I,2);case 2:return a1(e,t),e.u||(e.h.style.display="",t.overlay?(e.h.loop=t.loop,R=t.overlay.viewport,M=t.overlay.topLeft,D=t.overlay.size,e.h.style.height=D.y/R.y*100+"%",e.h.style.left=M.x/R.x*100+"%",e.h.style.top=M.y/R.y*100+"%",e.h.style.width=D.x/R.x*100+"%"):(e.g.pause(),t.resumeOffset!=null&&t.resumeOffset!=0&&(e.g.currentTime+=t.resumeOffset),e.h.loop=!1,e.h.style.height="100%",e.h.style.left="0",e.h.style.top="0",e.h.style.width="100%")),Z(W,4),pg(e),t.startTime&&t.endTime&&t.endTime!=1/0&&t.startTime!=t.endTime&&(O=t.endTime-t.startTime,O>0&&e.i.configure("playRangeEnd",O)),t.playoutLimit&&!e.o&&(e.o=new Ve(function(){e.$()}).ka(t.playoutLimit),e.i.configure("playRangeEnd",t.playoutLimit)),C(W,e.i.Wb(e.h),6);case 6:return X=null,e.M.allowStartInMiddleOfInterstitial&&e.l!=null&&(b=e.l-t.startTime,Math.abs(b)>.25&&(X=b)),e.F.has(t)?C(W,e.F.get(t),10):C(W,e.i.load(t.uri,X,t.mimeType||void 0),8);case 10:return U=W.h,e.F.delete(t),U?C(W,e.i.load(U),8):C(W,e.i.load(t.uri,X,t.mimeType||void 0),8);case 8:t.overlay&&e.g.paused?e.h.pause():e.h.play(),N=(Date.now()-o)/1e3,_t(e,"ads-loaded",new Map().set("loadTime",N)),e.u&&e.g.play(),t.overlay&&(t.pre||t.post||e.C.W()&&!(t.startTime>0)||(z=function(){var G=e.g.currentTime-t.startTime;Math.abs(G-e.h.currentTime)>.1&&(e.h.currentTime=G)},e.j.Aa(e.h,"playing",z),e.j.D(e.g,"seeking",z)),e.j.D(e.g,"seeked",function(){var G=e.g.currentTime;(G<t.startTime||t.endTime&&G>t.endTime)&&e.$()})),ce(W,0);break;case 4:if(B=se(W),!e.J)return W.return();g(B),ie(W)}})}function a1(e,t){if(t.displayOnBackground&&(e.g.style.zIndex="1"),t.currentVideo!=null){var n=t.currentVideo;e.g.style.transformOrigin="top left";var r=!0,i=[],s=n.topLeft.x/n.viewport.x*100;s>0&&s<=100&&(i.push("translateX("+s+"%)"),r=!1),s=n.topLeft.y/n.viewport.y*100,s>0&&s<=100&&(i.push("translateY("+s+"%)"),r=!1),s=n.size.x/n.viewport.x,s<1&&i.push("scaleX("+s+")"),n=n.size.y/n.viewport.y,s<1&&i.push("scaleY("+n+")"),i.length&&(e.g.style.transform=i.join(" ")),r&&(e.g.style.transition="transform 250ms")}e.m&&(t.clickThroughUrl?(e.m.setAttribute("ad-active","true"),e.m.style.pointerEvents=""):e.m.style.pointerEvents="none",t.background&&(e.m.style.background=t.background)),e.G&&(e.G.style.background=t.overlay?"":"rgb(0, 0, 0)")}function hg(e,t){(!t||t.displayOnBackground)&&(e.g.style.zIndex=""),t&&t.currentVideo==null||(e.g.style.transformOrigin="",e.g.style.transition="",e.g.style.transform=""),e.m&&(e.m.removeAttribute("ad-active"),e.m.style.pointerEvents="",!t||t.background)&&(e.m.style.background=""),e.G&&(e.G.style.background="")}function Ck(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze,Ne,st,ze,He,$e,Je;return F(function(Ye){switch(Ye.g){case 1:if(n=[],!t||(r=t.values.find(function(Ge){return Ge.key=="X-ASSET-URI"}),i=t.values.find(function(Ge){return Ge.key=="X-ASSET-LIST"}),!r&&!i))return Ye.return(n);if(s=null,(o=t.values.find(function(Ge){return Ge.key=="ID"}))&&(s=o.data),u=s==null?Math.floor(t.startTime*10)/10:t.startTime,(l=t.endTime)&&t.endTime!=1/0&&typeof t.endTime=="number"&&(l=s==null?Math.floor(t.endTime*10)/10:t.endTime),f=t.values.find(function(Ge){return Ge.key=="X-RESTRICT"}),y=g=!0,f&&f.data&&(v=f.data,g=!v.includes("SKIP"),y=!v.includes("JUMP")),w=g?0:null,(A=t.values.find(function(Ge){return Ge.key=="X-ENABLE-SKIP-AFTER"}))&&(I=A.data,w=parseFloat(I),isNaN(w)&&(w=g?0:null)),E=null,(R=t.values.find(function(Ge){return Ge.key=="X-ENABLE-SKIP-FOR"}))&&(M=R.data,E=parseFloat(M),isNaN(w)&&(E=null)),D=null,(O=t.values.find(function(Ge){return Ge.key=="X-RESUME-OFFSET"}))&&(X=O.data,D=parseFloat(X),isNaN(D)&&(D=null)),b=null,(U=t.values.find(function(Ge){return Ge.key=="X-PLAYOUT-LIMIT"}))&&(N=U.data,b=parseFloat(N),isNaN(b)&&(b=null)),W=B=z=!1,(G=t.values.find(function(Ge){return Ge.key=="CUE"}))&&(re=G.data,z=re.includes("ONCE"),B=re.includes("PRE"),W=re.includes("POST")),ne=!1,($=t.values.find(function(Ge){return Ge.key=="X-TIMELINE-OCCUPIES"}))?(Q=$.data,ne=Q.includes("RANGE")):!O&&e.C.W()&&(ne=!B&&!W),r){if(ae=r.data,!ae)return Ye.return(n);n.push({id:s,groupId:null,startTime:u,endTime:l,uri:ae,mimeType:null,isSkippable:g,skipOffset:w,skipFor:E,canJump:y,resumeOffset:D,playoutLimit:b,once:z,pre:B,post:W,timelineRange:ne,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null}),Ye.A(2);break}if(!i){Ye.A(2);break}return le=i.data,le?(Z(Ye,4),be={type:11},C(Ye,gg(e,le,be),6)):Ye.return(n);case 6:for(xe=Ye.h,Ze=wt(xe),Ne=JSON.parse(Ze),(st=Ne["SKIP-CONTROL"])&&(ze=st["ENABLE-SKIP-AFTER"],typeof ze=="number"&&(w=parseFloat(ze),isNaN(ze)&&(w=g?0:null)),He=st["ENABLE-SKIP-FOR"],typeof He=="number"&&(E=parseFloat(He),isNaN(He)&&(E=null))),$e=0;$e<Ne.ASSETS.length;$e++)Je=Ne.ASSETS[$e],Je.URI&&n.push({id:s+"_shaka_asset_"+$e,groupId:s,startTime:u,endTime:l,uri:Je.URI,mimeType:null,isSkippable:g,skipOffset:w,skipFor:E,canJump:y,resumeOffset:D,playoutLimit:b,once:z,pre:B,post:W,timelineRange:ne,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null});ce(Ye,2);break;case 4:se(Ye);case 2:return Ye.return(n)}})}function Mk(e){var t=[];if(!e)return t;var n=e.values.find(function(E){return E.key=="X-ASSET-URI"});if(!n||(n=n.data,!n))return t;var r=null,i=e.values.find(function(E){return E.key=="X-OVERLAY-ID"});i&&(r=i.data),i=r==null?Math.floor(e.startTime*10)/10:e.startTime;var s=e.endTime;e.endTime&&e.endTime!=1/0&&typeof e.endTime=="number"&&(s=r==null?Math.floor(e.endTime*10)/10:e.endTime);var o=!1,u=!1,l=!1,f=e.values.find(function(E){return E.key=="CUE"});f&&(l=f.data,o=l.includes("ONCE"),u=l.includes("PRE"),l=l.includes("POST")),f=null;var g=e.values.find(function(E){return E.key=="X-ASSET-MIMETYPE"});g&&(f=g.data),g=!1;var y=e.values.find(function(E){return E.key=="X-LOOP"});y&&(g=y.data=="YES"),y=1;var v=e.values.find(function(E){return E.key=="X-DEPTH"});v&&(y=parseFloat(v.data),isNaN(y)&&(y=1)),v=null;var w=e.values.find(function(E){return E.key=="X-BACKGROUND"});w&&(v=w.data),w=1920;var A=1080,I=e.values.find(function(E){return E.key=="X-VIEWPORT"});if(I){if(A=I.data.split("x"),A.length!=2)return t;w=parseFloat(A[0]),A=parseFloat(A[1])}if(w={viewport:{x:w,y:A},topLeft:{x:0,y:0},size:{x:w,y:A}},A=e.values.find(function(E){return E.key=="X-OVERLAY-POSITION"})){if(A=A.data.split("x"),A.length!=2)return t;w.topLeft.x=parseFloat(A[0]),w.topLeft.y=parseFloat(A[1])}if(A=e.values.find(function(E){return E.key=="X-OVERLAY-SIZE"})){if(A=A.data.split("x"),A.length!=2)return t;w.size.x=parseFloat(A[0]),w.size.y=parseFloat(A[1])}if(A=null,(I=e.values.find(function(E){return E.key=="X-SQUEEZECURRENT"}))&&(A=parseFloat(I.data),isNaN(A)&&(A=1),A={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920*A,y:1080*A}},e=e.values.find(function(E){return E.key=="X-SQUEEZECURRENT-POSITION"}))){if(e=e.data.split("x"),e.length!=2)return t;A.topLeft.x=parseFloat(e[0]),A.topLeft.y=parseFloat(e[1])}return t.push({id:r,groupId:null,startTime:i,endTime:s,uri:n,mimeType:f,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:o,pre:u,post:l,timelineRange:!0,loop:g,overlay:w,displayOnBackground:y==-1,currentVideo:A,background:v,clickThroughUrl:null}),t}function gd(e){for(var t=[],n=x(e.H),r=n.next(),i={};!r.done;i={Bc:void 0},r=n.next())r=r.value,r.overlay||(i.Bc={start:r.startTime,end:null},r.pre?(i.Bc.start=0,i.Bc.end=null):r.post?(i.Bc.start=-1,i.Bc.end=null):r.timelineRange&&(i.Bc.end=r.endTime),t.find((function(s){return function(o){return s.Bc.start==o.start&&s.Bc.end==o.end}})(i))||t.push(i.Bc));_t(e,"ad-cue-points-changed",new Map().set("cuepoints",t))}function pg(e){e.i.configure(e.C.ii()),e.i.configure("ads.disableHLSInterstitial",!0),e.i.configure("ads.disableDASHInterstitial",!0),e.i.configure("playRangeEnd",1/0),d0(e.C.Zb(),e.i.Zb())}function gg(e,t,n){var r,i,s;return F(function(o){return o.g==1?(r=Nt([t],Or()),i=e.C.Zb().request(7,r,n),C(o,i.promise,2)):(s=o.h,o.return(s.data))})}function u1(e){return(e=e.mimeType)?!e.startsWith("image/")&&e!=="text/html":!0}function l1(){var e=je().Oa();return e=="TV"||e=="CONSOLE"||e=="CAST"}function c1(e,t){if(!(e.K.has(t)||e.M&&!e.M.allowPreloadOnDomElements)){var n=function(s){var o=document.createElement("link");return o.rel="preload",o.href=s,o.as="image",document.head.appendChild(o),o},r=[];if(t.background){var i=t.background.match(/url\(('|")?([^'"()]+)('|")\)?/);i&&r.push(n(i[2]))}t.mimeType&&t.mimeType.startsWith("image/")&&r.push(n(t.uri)),e.K.set(t,r)}}function d1(e,t){if(e.K.has(t)){var n=e.K.get(t);n=x(n);for(var r=n.next();!r.done;r=n.next())r=r.value,r.parentNode.removeChild(r);e.K.delete(t)}}function _t(e,t,n){e.va(new Se(t,n))}function Ie(e,t,n,r,i){this.h=e,this.j=fo(this.h.skipOffset),this.g=i,this.i=t,this.l=n,this.o=r,this.m=!1}p=Ie.prototype,p.needsSkipUI=function(){return!0},p.isClientRendering=function(){return!1},p.hasCustomClick=function(){return!1},p.isUsingAnotherMediaElement=function(){return!1},p.getDuration=function(){return this.h.durationInSeconds},p.getMinSuggestedDuration=function(){return this.getDuration()},p.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},p.isPaused=function(){return this.g.paused},p.isSkippable=function(){return typeof this.j=="number"},p.getTimeUntilSkippable=function(){if(typeof this.j!="number")return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},p.canSkipNow=function(){return this.getTimeUntilSkippable()==0},p.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},p.pause=function(){return this.g.pause()},p.play=function(){return this.g.play()},p.getVolume=function(){return this.g.volume},p.setVolume=function(e){this.g.volume=e},p.isMuted=function(){return this.g.muted},p.isLinear=function(){return this.o},p.resize=function(){},p.setMuted=function(e){this.g.muted=e},p.getSequenceLength=function(){return this.l?this.l:1},p.getPositionInSequence=function(){return this.i?this.i:1},p.getTitle=function(){return this.h.adTitle},p.getDescription=function(){return""},p.getVastMediaBitrate=function(){return 0},p.getVastMediaHeight=function(){return 0},p.getVastMediaWidth=function(){return 0},p.getVastAdId=function(){return this.h.vastAdId||""},p.getAdId=function(){return this.h.adId},p.getCreativeAdId=function(){return this.h.creativeId},p.getAdvertiserName=function(){return""},p.getMediaUrl=function(){return null},p.getTimeOffset=function(){return 0},p.getPodIndex=function(){return 0},p.release=function(){this.l=this.i=this.g=this.h=null},de("shaka.ads.MediaTailorAd",Ie),Ie.prototype.release=Ie.prototype.release,Ie.prototype.getPodIndex=Ie.prototype.getPodIndex,Ie.prototype.getTimeOffset=Ie.prototype.getTimeOffset,Ie.prototype.getMediaUrl=Ie.prototype.getMediaUrl,Ie.prototype.getAdvertiserName=Ie.prototype.getAdvertiserName,Ie.prototype.getCreativeAdId=Ie.prototype.getCreativeAdId,Ie.prototype.getAdId=Ie.prototype.getAdId,Ie.prototype.getVastAdId=Ie.prototype.getVastAdId,Ie.prototype.getVastMediaWidth=Ie.prototype.getVastMediaWidth,Ie.prototype.getVastMediaHeight=Ie.prototype.getVastMediaHeight,Ie.prototype.getVastMediaBitrate=Ie.prototype.getVastMediaBitrate,Ie.prototype.getDescription=Ie.prototype.getDescription,Ie.prototype.getTitle=Ie.prototype.getTitle,Ie.prototype.getPositionInSequence=Ie.prototype.getPositionInSequence,Ie.prototype.getSequenceLength=Ie.prototype.getSequenceLength,Ie.prototype.setMuted=Ie.prototype.setMuted,Ie.prototype.resize=Ie.prototype.resize,Ie.prototype.isLinear=Ie.prototype.isLinear,Ie.prototype.isMuted=Ie.prototype.isMuted,Ie.prototype.setVolume=Ie.prototype.setVolume,Ie.prototype.getVolume=Ie.prototype.getVolume,Ie.prototype.play=Ie.prototype.play,Ie.prototype.pause=Ie.prototype.pause,Ie.prototype.skip=Ie.prototype.skip,Ie.prototype.canSkipNow=Ie.prototype.canSkipNow,Ie.prototype.getTimeUntilSkippable=Ie.prototype.getTimeUntilSkippable,Ie.prototype.isSkippable=Ie.prototype.isSkippable,Ie.prototype.isPaused=Ie.prototype.isPaused,Ie.prototype.getRemainingTime=Ie.prototype.getRemainingTime,Ie.prototype.getMinSuggestedDuration=Ie.prototype.getMinSuggestedDuration,Ie.prototype.getDuration=Ie.prototype.getDuration,Ie.prototype.isUsingAnotherMediaElement=Ie.prototype.isUsingAnotherMediaElement,Ie.prototype.hasCustomClick=Ie.prototype.hasCustomClick,Ie.prototype.isClientRendering=Ie.prototype.isClientRendering,Ie.prototype.needsSkipUI=Ie.prototype.needsSkipUI;function Ru(e,t,n,r){this.C=e,this.K=t,this.h=n,this.l=null,this.R=NaN,this.i=r,this.J=!1,this.B=null,this.j=[],this.N=[],this.M=this.F=this.g=null,this.G=new Map,this.m=[],this.u=[],this.H="",this.O=!0,this.I="",this.o=new et}Ru.prototype.stop=function(){for(var e=x(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.Ma(t.target,t.type,t.listener);Go(this),this.m=[],this.u=[],this.H="",this.O=!0,this.I="",this.B=null,this.j=[],this.N=[],this.G.clear()},Ru.prototype.release=function(){this.stop(),this.o&&this.o.release()},Ru.prototype.onManifestUpdated=function(e){this.J=e,this.H!=""&&(kk(this,this.H,this.O),this.O=!1)},Ru.prototype.getCuePoints=function(){for(var e=[],t=x(this.j),n=t.next();!n.done;n=t.next()){n=x(n.value.ads);for(var r=n.next();!r.done;r=n.next())r=r.value,e.push({start:r.startTimeInSeconds,end:r.startTimeInSeconds+r.durationInSeconds})}return e};function Rk(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A;F(function(I){if(I.g==1)return r={type:7},i=Nt([t],Or()),i.method="POST",n&&(s=JSON.stringify(n),i.body=Lr(s)),o=e.K.request(7,i,r),Z(I,2),C(I,o.promise,4);if(I.g!=2){if(u=I.h,l=wt(u.data),f=JSON.parse(l),f.manifestUrl&&f.trackingUrl)g=new Pt(t),y=new Pt(f.trackingUrl),e.H=g.resolve(y).toString(),v=Date.now()/1e3,w=v-e.R,e.i(new Se("ads-loaded",new Map().set("loadTime",w))),A=new Pt(f.manifestUrl),e.l.resolve(g.resolve(A).toString()),e.l=null;else throw Error("Insufficient data from MediaTailor.");return ce(I,0)}if(se(I),!e.I.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,I.return();e.l.resolve(e.I),e.l=null,ie(I)})}function kk(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M;F(function(D){if(D.g==1)return r={type:8},i=Nt([t],Or()),s=e.K.request(7,i,r),Z(D,2),C(D,s.promise,4);if(D.g!=2){if(o=D.h,u=[],l=wt(o.data),f=JSON.parse(l),f.avails.length>0){if(JSON.stringify(e.j)!=JSON.stringify(f.avails)){for(e.j=f.avails,g=x(e.j),y=g.next();!y.done;y=g.next())for(v=y.value,w=x(v.nonLinearAdsList),A=w.next();!A.done;A=w.next())for(I=A.value,E=x(I.nonLinearAdList),R=E.next();!R.done;R=E.next())M=R.value,_k(e,M);u=e.getCuePoints(),e.i(new Se("ad-cue-points-changed",new Map().set("cuepoints",u)))}}else e.j.length&&e.i(new Se("ad-cue-points-changed",new Map().set("cuepoints",u))),Go(e),e.j=[];return n&&(e.J||u.length>0)&&Pk(e),ce(D,0)}se(D),ie(D)})}function _k(e,t){var n,r,i,s,o,u,l,f;F(function(g){if(g.g==1)return!t.staticResource||(n=f1(t),e.G.get(n))?g.return():(r={type:9},i=Nt([t.staticResource],Or()),s=e.K.request(7,i,r),Z(g,2),e.G.set(n,[]),C(g,s.promise,4));if(g.g!=2)return o=g.h,u=wt(o.data),l=JSON.parse(u),f=l.apps,e.G.set(n,f),ce(g,0);se(g),e.G.delete(n),ie(g)})}function f1(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function Pk(e){p1(e),e.J||(h1(e),e.o.D(e.h,"seeked",function(){h1(e)}),e.o.D(e.h,"ended",function(){Go(e)})),e.o.D(e.h,"timeupdate",function(){p1(e)})}function h1(e){var t=e.h.currentTime;if(t!=0&&e.B==null){for(var n,r,i=x(e.j),s=i.next();!s.done;s=i.next()){s=s.value;for(var o=x(s.ads),u=o.next();!u.done;u=o.next())if(u=u.value,!r)u.startTimeInSeconds<t&&(r=u,n=s);else if(u.startTimeInSeconds<t&&u.startTimeInSeconds>r.startTimeInSeconds+r.durationInSeconds){r=u,n=s;break}}n&&r&&!e.N.includes(r.adId)&&(e.B=t,e.h.currentTime=n.startTimeInSeconds)}}function p1(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var r=e.F,i=r.startTimeInSeconds+.5*r.durationInSeconds,s=r.startTimeInSeconds+.75*r.durationInSeconds;t>=r.startTimeInSeconds+.25*r.durationInSeconds&&!e.u.includes("firstQuartile")?(e.u.push("firstQuartile"),Mn(e,"firstQuartile")):t>=i&&!e.u.includes("midpoint")?(e.u.push("midpoint"),Mn(e,"midpoint")):t>=s&&!e.u.includes("thirdQuartile")&&(e.u.push("thirdQuartile"),Mn(e,"thirdQuartile")),r=e.g.getRemainingTime(),i=e.g.getDuration(),e.g.canSkipNow()&&r>0&&i>0&&Mn(e,"skipStateChanged"),i>0&&(r<=0||r>i)&&Go(e)}if(!e.g||!e.g.isLinear()){e:for(r=x(e.j),i=r.next();!i.done&&(i=i.value,!(e.g&&e.g.isLinear()));i=r.next())for(s=0;s<i.ads.length;s++){var o=i.ads[s],u=o.startTimeInSeconds+o.durationInSeconds;if(o.startTimeInSeconds<=t&&u>t){if(e.N.includes(o.adId)){if(e.h.ended)continue;e.h.currentTime=u;break e}Go(e),e.M=i,e.g=new Ie(o,s+1,i.ads.length,!0,e.h),e.F=o,s===0&&Mn(e,"breakStart"),g1(e);break}}if(!e.g){for(r=x(e.j),i=r.next();!i.done&&(i=i.value,!e.g);i=r.next())for(s=0;s<i.nonLinearAdsList.length;s++)if(o=i.nonLinearAdsList[s],o.nonLinearAdList.length){u=i.startTimeInSeconds;var l=e.G.get(f1(o.nonLinearAdList[0]));if(u<=t&&l&&l.length){Go(e),u=e,l=x(l);for(var f=l.next();!f.done;f=l.next())if(f=f.value,f.data.source.length){var g=document.createElement("img");g.src=f.data.source[0].url,g.style.top=(f.placeholder.top||0)+"%",g.style.height=100-(f.placeholder.top||0)+"%",g.style.left=(f.placeholder.left||0)+"%",g.style.maxWidth=100-(f.placeholder.left||0)+"%",g.style.objectFit="contain",g.style.position="absolute",u.C.appendChild(g)}e.M=i,e.g=new Ie(o,s+1,i.ads.length,!1,e.h),e.F=o,s===0&&Mn(e,"breakStart"),g1(e);break}}}n&&!e.g&&(t=e.h.currentTime,e.B&&e.B>t&&(e.h.currentTime=e.B),e.B=null)}}}function Go(e){if(e.g){for(;e.C.lastChild;)e.C.removeChild(e.C.firstChild);e.J||e.N.push(e.F.adId);var t=e.g.m;t!==void 0&&t?Mn(e,"skip"):Mn(e,"complete"),t=x(e.m);for(var n=t.next();!n.done;n=t.next())n=n.value,e.o.Ma(n.target,n.type,n.listener);e.m=[],e.u=[],t=e.g.getPositionInSequence(),n=e.g.getSequenceLength(),t===n&&Mn(e,"breakEnd"),e.g=null,e.F=null,e.M=null}}function g1(e){var t=!1;e.h.paused?t=!0:(Mn(e,"impression"),Mn(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&Mn(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||Mn(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(Mn(e,"impression"),Mn(e,"start"),t=!1):Mn(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){Mn(e,"pause")}});for(var n=x(e.m),r=n.next();!r.done;r=n.next())r=r.value,e.o.D(r.target,r.type,r.listener)}function Mn(e,t){var n=e.F.trackingEvents.find(function(s){return s.eventType==t});if(n||(n=e.M.adBreakTrackingEvents.find(function(s){return s.eventType==t})),n){var r={type:10};n=x(n.beaconUrls);for(var i=n.next();!i.done;i=n.next())(i=i.value)&&i!=""&&(i=Nt([i],Or()),i.method="POST",e.K.request(7,i,r))}switch(t){case"impression":e.i(new Se("ad-impression"));break;case"start":e.i(new Se("ad-started",new Map().set("ad",e.g)));break;case"mute":e.i(new Se("ad-muted"));break;case"unmute":e.i(new Se("ad-volume-changed"));break;case"resume":e.i(new Se("ad-resumed"));break;case"pause":e.i(new Se("ad-paused"));break;case"firstQuartile":e.i(new Se("ad-first-quartile"));break;case"midpoint":e.i(new Se("ad-midpoint"));break;case"thirdQuartile":e.i(new Se("ad-third-quartile"));break;case"complete":e.i(new Se("ad-complete")),e.i(new Se("ad-stopped"));break;case"skip":e.i(new Se("ad-skipped")),e.i(new Se("ad-stopped"));break;case"breakStart":e.C.setAttribute("ad-active","true");break;case"breakEnd":e.C.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Se("ad-skip-state-changed"))}}function _e(e,t){this.g=e,this.i=null,this.h=t}p=_e.prototype,p.needsSkipUI=function(){return!0},p.isClientRendering=function(){return!1},p.hasCustomClick=function(){return!0},p.isUsingAnotherMediaElement=function(){return!1},p.getDuration=function(){return this.i?this.i.duration:-1},p.getMinSuggestedDuration=function(){return this.getDuration()},p.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},p.isPaused=function(){return this.h.paused},p.isSkippable=function(){return this.g.isSkippable()},p.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},p.canSkipNow=function(){return this.getTimeUntilSkippable()==0},p.skip=function(){this.h.currentTime+=this.getRemainingTime()},p.pause=function(){return this.h.pause()},p.play=function(){return this.h.play()},p.getVolume=function(){return this.h.volume},p.setVolume=function(e){this.h.volume=e},p.isMuted=function(){return this.h.muted},p.isLinear=function(){return!0},p.resize=function(){},p.setMuted=function(e){this.h.muted=e},p.getSequenceLength=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getTotalAds()},p.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getAdPosition()},p.getTitle=function(){return this.g.getTitle()},p.getDescription=function(){return this.g.getDescription()},p.getVastMediaBitrate=function(){return 0},p.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},p.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},p.getVastAdId=function(){return""},p.getAdId=function(){return this.g.getAdId()},p.getCreativeAdId=function(){return this.g.getCreativeAdId()},p.getAdvertiserName=function(){return this.g.getAdvertiserName()},p.getMediaUrl=function(){return null},p.getTimeOffset=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getTimeOffset()},p.getPodIndex=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getPodIndex()},p.release=function(){this.h=this.i=this.g=null},de("shaka.ads.ServerSideAd",_e),_e.prototype.release=_e.prototype.release,_e.prototype.getPodIndex=_e.prototype.getPodIndex,_e.prototype.getTimeOffset=_e.prototype.getTimeOffset,_e.prototype.getMediaUrl=_e.prototype.getMediaUrl,_e.prototype.getAdvertiserName=_e.prototype.getAdvertiserName,_e.prototype.getCreativeAdId=_e.prototype.getCreativeAdId,_e.prototype.getAdId=_e.prototype.getAdId,_e.prototype.getVastAdId=_e.prototype.getVastAdId,_e.prototype.getVastMediaWidth=_e.prototype.getVastMediaWidth,_e.prototype.getVastMediaHeight=_e.prototype.getVastMediaHeight,_e.prototype.getVastMediaBitrate=_e.prototype.getVastMediaBitrate,_e.prototype.getDescription=_e.prototype.getDescription,_e.prototype.getTitle=_e.prototype.getTitle,_e.prototype.getPositionInSequence=_e.prototype.getPositionInSequence,_e.prototype.getSequenceLength=_e.prototype.getSequenceLength,_e.prototype.setMuted=_e.prototype.setMuted,_e.prototype.resize=_e.prototype.resize,_e.prototype.isLinear=_e.prototype.isLinear,_e.prototype.isMuted=_e.prototype.isMuted,_e.prototype.setVolume=_e.prototype.setVolume,_e.prototype.getVolume=_e.prototype.getVolume,_e.prototype.play=_e.prototype.play,_e.prototype.pause=_e.prototype.pause,_e.prototype.skip=_e.prototype.skip,_e.prototype.canSkipNow=_e.prototype.canSkipNow,_e.prototype.getTimeUntilSkippable=_e.prototype.getTimeUntilSkippable,_e.prototype.isSkippable=_e.prototype.isSkippable,_e.prototype.isPaused=_e.prototype.isPaused,_e.prototype.getRemainingTime=_e.prototype.getRemainingTime,_e.prototype.getMinSuggestedDuration=_e.prototype.getMinSuggestedDuration,_e.prototype.getDuration=_e.prototype.getDuration,_e.prototype.isUsingAnotherMediaElement=_e.prototype.isUsingAnotherMediaElement,_e.prototype.hasCustomClick=_e.prototype.hasCustomClick,_e.prototype.isClientRendering=_e.prototype.isClientRendering,_e.prototype.needsSkipUI=_e.prototype.needsSkipUI;function m1(e,t,n,r){var i=this;this.u=e,this.l=t,this.j=null,this.G=NaN,this.i=r,this.H=!1,this.B=this.m=this.o=null,this.C="",this.F=[],this.h=new et,e=new google.ima.dai.api.UiSettings,e.setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.u,e),this.i(new Se("ima-stream-manager-loaded",new Map().set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(s){Dk(i,s)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){i.C.length?i.j.resolve(i.C):i.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),i.j=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(s){s=s.getAd(),i.m=new _e(s,i.l),i.B&&(i.m.i=i.B),i.i(new Se("ad-started",new Map().set("ad",i.m))),i.u.setAttribute("ad-active","true")}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){i.u.removeAttribute("ad-active");var s=i.l.currentTime;i.o&&i.o>s&&(i.l.currentTime=i.o,i.o=null)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(s){i.B=s.getStreamData().adProgressData,i.m&&(i.m.i=i.B)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){i.i(new Se("ad-first-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){i.i(new Se("ad-midpoint"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){i.i(new Se("ad-third-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){i.i(new Se("ad-complete")),i.i(new Se("ad-stopped")),i.u.removeAttribute("ad-active"),i.m=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){i.i(new Se("ad-skipped")),i.i(new Se("ad-stopped"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(s){var o=s.getStreamData();s=[],o=x(o.cuepoints);for(var u=o.next();!u.done;u=o.next())u=u.value,s.push({start:u.start,end:u.end});i.F=s,i.i(new Se("ad-cue-points-changed",new Map().set("cuepoints",s)))})}p=m1.prototype,p.configure=function(){},p.stop=function(){this.C="",this.o=null,this.F=[]},p.release=function(){this.stop(),this.h&&this.h.release()},p.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},p.getCuePoints=function(){return this.F};function Dk(e,t){e.i(new Se("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.G))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.H||e.h.D(e.l,"seeked",function(){var n=e.l.currentTime;if(n!=0){e.g.streamTimeForContentTime(n);var r=e.g.previousCuePointForStreamTime(n);r&&!r.played&&(e.o=n,e.l.currentTime=r.start)}})}function ve(){ot.call(this),this.h=this.i=this.j=this.g=null,this.m=new n1,this.o=navigator.language,this.l=null}J(ve,ot),p=ve.prototype,p.setLocale=function(e){this.o=e},p.configure=function(e){this.l=e,this.g&&this.g.configure(this.l),this.j&&this.j.configure(this.l),this.h&&this.h.configure(this.l)},p.initInterstitial=function(e,t,n){var r=this;this.g&&this.g.release(),this.g=new o1(e,t,n,function(i){return md(r,i)}),this.g.configure(this.l)},p.initClientSide=function(e,t,n){var r=this;if(!m.google||!google.ima||!google.ima.AdsLoader)throw new H(2,10,1e4);this.j&&this.j.release(),this.j=new fd(e,t,this.o,n,function(i){return md(r,i)}),this.j.configure(this.l)},p.release=function(){this.g&&(this.g.release(),this.g=null),this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),ot.prototype.release.call(this)},p.onAssetUnload=function(){this.g&&this.g.stop(),this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.dispatchEvent(new Se("ad-stopped")),this.dispatchEvent(new Se("ad-content-attach-requested")),this.m=new n1},p.requestClientSideAds=function(e){if(!this.j)throw new H(1,10,10001);var t=this.j;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.H=Date.now()/1e3,t.m.requestAds(e)},p.updateClientSideAdsRenderingSettings=function(e){if(!this.j)throw new H(1,10,10001);var t=this.j;t.C=e,t.g&&t.g.updateAdsRenderingSettings(t.C)},p.initMediaTailor=function(e,t,n){var r=this;this.i&&this.i.release(),this.i=new Ru(e,t,n,function(i){return md(r,i)})},p.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new H(1,10,10005);var r=this.i;return n=n===void 0?"":n,r.l?e=Promise.reject(new H(1,10,10004)):(r.l=new at,Rk(r,e,t),r.I=n||"",r.R=Date.now()/1e3,e=r.l),e},p.addMediaTailorTrackingUrl=function(e){if(!this.i)throw new H(1,10,10005);var t=this.i;t.H=e,t.i(new Se("ads-loaded",new Map().set("loadTime",0)))},p.initServerSide=function(e,t){var n=this;if(!m.google||!google.ima||!google.ima.dai)throw new H(2,10,10002);this.h&&this.h.release(),this.h=new m1(e,t,this.o,function(r){return md(n,r)}),this.h.configure(this.l)},p.requestServerSideStream=function(e,t){if(t=t===void 0?"":t,!this.h)throw new H(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&Be('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.16.11",n=this.h,n.j?e=Promise.reject(new H(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.H=!0),n.j=new at,n.g.requestStream(e),n.C=t||"",n.G=Date.now()/1e3,e=n.j),e},p.replaceServerSideAdTagParameters=function(e){if(!this.h)throw new H(1,10,10003);(e.mpt||e.mpv)&&Be('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv="v4.16.11",this.h.g.replaceAdTagParameters(e)},p.getServerSideCuePoints=function(){return qe("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},p.getCuePoints=function(){var e=[];return this.h&&(e=e.concat(this.h.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},p.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:mk(e),started:e.h,overlayAds:e.j,playedCompletely:e.l,skipped:e.m,errors:e.i}},p.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},p.onDashTimedMetadata=function(e){this.h&&e.schemeIdUri=="urn:google:dai:2018"&&this.h.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},p.onHlsTimedMetadata=function(e,t){this.h&&this.h.g.processMetadata("ID3",e.data,t)},p.onCueMetadataChange=function(e){this.h&&this.h.onCueMetadataChange(e)},p.onHLSInterstitialMetadata=function(e,t,n){this.l&&this.l.disableHLSInterstitial||(this.g||this.initInterstitial(null,e,t),this.g&&Sk(this.g,n))},p.onDASHInterstitialMetadata=function(e,t,n){if(!this.l||!this.l.disableDASHInterstitial){var r=n.schemeIdUri;if(r=="urn:mpeg:dash:event:alternativeMPD:insert:2025"||r=="urn:mpeg:dash:event:alternativeMPD:replace:2025"){if(this.g||this.initInterstitial(null,e,t),this.g&&(e=this.g,t=n.schemeIdUri=="urn:mpeg:dash:event:alternativeMPD:replace:2025",r=n.schemeIdUri=="urn:mpeg:dash:event:alternativeMPD:insert:2025",t||r)){for(var i=n.startTime,s=n.endTime,o=null,u=0,l,f=x(n.eventNode.children),g=f.next();!g.done;g=f.next())if(g=g.value,g.tagName=="AlternativeMPD"){if(g=g.attributes.uri){l=g;break}}else if(g.tagName=="InsertPresentation"||g.tagName=="ReplacePresentation"){var y=g.attributes.url;if(y){l=En(y),(f=De(g,"maxDuration",nn))&&(o=f/n.timescale),(f=De(g,"returnOffset",nn))&&(u=f/n.timescale),t&&u&&(s=i+u);break}}l&&Mu(e,[{id:n.id,groupId:null,startTime:i,endTime:s,uri:l,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:r?u:null,playoutLimit:o,once:!1,pre:!1,post:!1,timelineRange:t&&!r,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null}])}}else(r=="urn:mpeg:dash:event:2012"||r=="urn:scte:dash:scte214-events")&&n.eventNode&&gt(n.eventNode,"OverlayEvent")&&(this.g||this.initInterstitial(null,e,t),this.g&&Ak(this.g,n))}},p.addCustomInterstitial=function(e){if(!this.g)throw new H(1,10,10006);Mu(this.g,[e])},p.addAdUrlInterstitial=function(e){if(!this.g)throw new H(1,10,10006);return this.g.addAdUrlInterstitial(e)},p.getInterstitialPlayer=function(){if(!this.g)throw new H(1,10,10006);return this.g.td()};function md(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;var n=t.ad;n&&!n.isLinear()&&e.m.j++;break;case"ad-complete":e.m.l++;break;case"ad-skipped":e.m.m++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}de("shaka.ads.AdManager",ve),ve.prototype.getInterstitialPlayer=ve.prototype.getInterstitialPlayer,ve.prototype.addAdUrlInterstitial=ve.prototype.addAdUrlInterstitial,ve.prototype.addCustomInterstitial=ve.prototype.addCustomInterstitial,ve.prototype.onDASHInterstitialMetadata=ve.prototype.onDASHInterstitialMetadata,ve.prototype.onHLSInterstitialMetadata=ve.prototype.onHLSInterstitialMetadata,ve.prototype.onCueMetadataChange=ve.prototype.onCueMetadataChange,ve.prototype.onHlsTimedMetadata=ve.prototype.onHlsTimedMetadata,ve.prototype.onDashTimedMetadata=ve.prototype.onDashTimedMetadata,ve.prototype.onManifestUpdated=ve.prototype.onManifestUpdated,ve.prototype.getStats=ve.prototype.getStats,ve.prototype.getCuePoints=ve.prototype.getCuePoints,ve.prototype.getServerSideCuePoints=ve.prototype.getServerSideCuePoints,ve.prototype.replaceServerSideAdTagParameters=ve.prototype.replaceServerSideAdTagParameters,ve.prototype.requestServerSideStream=ve.prototype.requestServerSideStream,ve.prototype.initServerSide=ve.prototype.initServerSide,ve.prototype.addMediaTailorTrackingUrl=ve.prototype.addMediaTailorTrackingUrl,ve.prototype.requestMediaTailorStream=ve.prototype.requestMediaTailorStream,ve.prototype.initMediaTailor=ve.prototype.initMediaTailor,ve.prototype.updateClientSideAdsRenderingSettings=ve.prototype.updateClientSideAdsRenderingSettings,ve.prototype.requestClientSideAds=ve.prototype.requestClientSideAds,ve.prototype.onAssetUnload=ve.prototype.onAssetUnload,ve.prototype.release=ve.prototype.release,ve.prototype.initClientSide=ve.prototype.initClientSide,ve.prototype.initInterstitial=ve.prototype.initInterstitial,ve.prototype.configure=ve.prototype.configure,ve.prototype.setLocale=ve.prototype.setLocale,ve.ADS_LOADED="ads-loaded",ve.AD_STARTED="ad-started",ve.AD_FIRST_QUARTILE="ad-first-quartile",ve.AD_MIDPOINT="ad-midpoint",ve.AD_THIRD_QUARTILE="ad-third-quartile",ve.AD_COMPLETE="ad-complete",ve.AD_STOPPED="ad-stopped",ve.AD_SKIPPED="ad-skipped",ve.AD_VOLUME_CHANGED="ad-volume-changed",ve.AD_MUTED="ad-muted",ve.AD_PAUSED="ad-paused",ve.AD_RESUMED="ad-resumed",ve.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",ve.CUEPOINTS_CHANGED="ad-cue-points-changed",ve.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",ve.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",ve.AD_CLICKED="ad-clicked",ve.AD_PROGRESS="ad-progress",ve.AD_BUFFERING="ad-buffering",ve.AD_IMPRESSION="ad-impression",ve.AD_DURATION_CHANGED="ad-duration-changed",ve.AD_CLOSED="ad-closed",ve.AD_LOADED="ad-loaded",ve.ALL_ADS_COMPLETED="all-ads-completed",ve.AD_LINEAR_CHANGED="ad-linear-changed",ve.AD_METADATA="ad-metadata",ve.AD_RECOVERABLE_ERROR="ad-recoverable-error",ve.AD_ERROR="ad-error",ve.AD_BREAK_READY="ad-break-ready",ve.AD_INTERACTION="ad-interaction",ve.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",ve.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",ve.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",cd=function(){return new ve};function mg(e){return JSON.stringify(e,function(t,n){if(typeof n!="function"){if(t=n instanceof Se,n instanceof Event||t){var r={};for(s in n){var i=n[s];i&&typeof i=="object"?s=="detail"?r[s]=i:i instanceof Event||i instanceof Se?r[s]={__type__:"Event",event:mg(i)}:t&&Array.isArray(i)&&(r[s]=i):s in Event||(r[s]=i)}return r}if(n instanceof Error){var s=new Set(["name","message","stack"]);for(r in n)s.add(r);for(t=x(Object.getOwnPropertyNames(n)),r=t.next();!r.done;r=t.next())s.add(r.value);for(t={},s=x(s),r=s.next();!r.done;r=s.next())r=r.value,t[r]=n[r];n={__type__:"Error",contents:t}}else if(n instanceof TimeRanges){for(s={__type__:"TimeRanges",length:n.length,start:[],end:[]},n=x(Mi(n)),t=n.next();!t.done;t=n.next())t=t.value,r=t.end,s.start.push(t.start),s.end.push(r);n=s}else n=ArrayBuffer.isView(n)&&n.BYTES_PER_ELEMENT===1?{__type__:"Uint8Array",entries:Array.from(n)}:typeof n=="number"?isNaN(n)?"NaN":isFinite(n)?n:n<0?"-Infinity":"Infinity":n;return n}})}function yd(e){return JSON.parse(e,function(t,n){if(n=="NaN")var r=NaN;else if(n=="-Infinity")r=-1/0;else if(n=="Infinity")r=1/0;else if(n&&typeof n=="object"&&n.__type__=="TimeRanges")r=Lk(n);else if(n&&typeof n=="object"&&n.__type__=="Uint8Array")r=new Uint8Array(n.entries);else if(n&&typeof n=="object"&&n.__type__=="Error"){t=n.contents,n=Error(t.message);for(r in t)n[r]=t[r];r=n}else r=n&&typeof n=="object"&&n.__type__=="Event"?yd(n.event):n;return r})}function Lk(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}var y1="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),bk="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),yg=["loop","playbackRate"],Nk=["pause","play"],vg=new Map().set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("isVideoOnly",10).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1).set("getBandwidthEstimate",1).set("isRemotePlayback",1),xg=new Map().set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getAudioTracks",2).set("getChaptersTracks",2).set("getImageTracks",2).set("getVideoTracks",2).set("getTextTracks",2).set("getVariantTracks",2),v1=new Map().set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),x1=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],T1=[["isTextTrackVisible","setTextTrackVisibility"]],Ok="cancelTrickPlay configure configurationForLowLatency getChapters resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel selectVideoTrack setTextTrackVisibility trickPlay updateStartTime goToLive useTrickPlayTrackIfAvailable".split(" "),Uk="addChaptersTrack addTextTrackAsync addThumbnailsTrack getAllThumbnails getChaptersAsync getThumbnails attach attachCanvas detach load unload".split(" ");function Tg(e,t,n,r,i,s,o){var u=this;this.H=e,this.K=o,this.l=new Ve(t),this.M=n,this.u=!1,this.B=r,this.G=i,this.N=s,this.i=this.m=!1,this.J="",this.o=null,this.C=function(){return wg(u)},this.F=function(l,f){switch(l=yd(f),l.type){case"event":var g=l.targetName,y=c0(l.event);u.B(g,y);break;case"update":g=l.update;for(y in g){l=u.g[y]||{};for(var v in g[y])l[v]=g[y][v]}u.u&&(u.M(),u.u=!1);break;case"asyncComplete":if(v=l.id,y=l.error,f=l.res,l=u.h.get(v),u.h.delete(v),l)if(y){v=new H(y.severity,y.category,y.code);for(g in y)v[g]=y[g];l.reject(v)}else l.resolve(f)}},this.g={video:{},player:{}},this.I=0,this.h=new Map,this.j=null,_u.add(this)}p=Tg.prototype,p.destroy=function(){return _u.delete(this),Sg(this),jr&&S1(this),this.l&&(this.l.stop(),this.l=null),this.G=this.B=null,this.i=this.m=!1,this.F=this.C=this.j=this.h=this.g=this.o=null,Promise.resolve()},p.wb=function(){return this.i},p.dh=function(){return this.J},p.init=function(){if(this.H.length)if(m.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.Kb();var e=new chrome.cast.SessionRequest(this.H,[],null,this.K,null);e=new chrome.cast.ApiConfig(e,function(t){for(var n=x(_u),r=n.next();!r.done;r=n.next()){r=r.value;var i=t;r.j=new at,r.u=!0,vd(r,i)}},function(t){for(var n=x(_u),r=n.next();!r.done;r=n.next())r=r.value,xd=t=="available",r.l.Kb()},"origin_scoped"),chrome.cast.initialize(e,function(){},function(){}),xd&&this.l.ka(Bk),(e=jr)&&e.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new at,this.u=!0,vd(this,e)):jr=null}else m.__onGCastApiAvailable!==A1&&(Td=m.__onGCastApiAvailable||null,m.__onGCastApiAvailable=A1)},p.ph=function(e){this.o=e,this.i&&ku(this,{type:"appData",appData:this.o})},p.cast=function(){var e=this;return F(function(t){if(!e.m)throw new H(1,8,8e3);if(!xd)throw new H(1,8,8001);if(e.i)throw new H(1,8,8002);return e.j=new at,chrome.cast.requestSession(function(n){return vd(e,n)},function(n){return w1(e,n)}),C(t,e.j,0)})};function jk(e){e.i&&chrome.cast.requestSession(function(t){return vd(e,t)},function(t){return w1(e,t)})}p.qd=function(){if(this.i){if(Sg(this),jr){S1(this);try{jr.stop(function(){},function(){})}catch(e){}jr=null}wg(this)}},p.get=function(e,t){var n=this;if(e=="video"){if(Nk.includes(t))return function(){return n.Ki.apply(n,[e,t].concat(Y(Rt.apply(0,arguments))))}}else if(e=="player"){if(v1.has(t)&&!this.get("player","isLive")())return function(){};if(Ok.includes(t))return function(){return n.Ki.apply(n,[e,t].concat(Y(Rt.apply(0,arguments))))};if(Uk.includes(t))return function(){return n.Nk.apply(n,[e,t].concat(Y(Rt.apply(0,arguments))))};if(vg.has(t)||xg.has(t))return function(){return n.g[e][t]}}return this.g[e][t]},p.set=function(e,t,n){this.g[e][t]=n,ku(this,{type:"set",targetName:e,property:t,value:n})};function vd(e,t){var n=e.N();jr=t,t.addUpdateListener(e.C),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.F),wg(e),ku(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function w1(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new H(2,8,n,t))}p.Ki=function(e,t){ku(this,{type:"call",targetName:e,methodName:t,args:Rt.apply(2,arguments)})},p.Nk=function(e,t){var n=Rt.apply(2,arguments),r=new at,i=this.I.toString();this.I++,this.h.set(i,r);try{ku(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:i})}catch(s){r.reject(s)}return r};function S1(e){var t=jr;t.removeUpdateListener(e.C),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.F)}function wg(e){var t=jr?jr.status=="connected":!1;if(e.i&&!t){e.G();for(var n in e.g)e.g[n]={};Sg(e)}e.i=t,e.J=t?jr.receiver.friendlyName:"",e.l.Kb()}function Sg(e){if(e.h)for(var t=x(e.h.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var r=e.h.get(n);e.h.delete(n),r.reject(new H(1,7,7e3))}}function ku(e,t){t=mg(t);var n=jr;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},Ts)}catch(r){throw t=new H(2,8,8005,r),n=new Se("error",new Map().set("detail",t)),e.B("player",n),e.qd(),t}}var Bk=.02,xd=!1,jr=null,Td=null,_u=new Set;function A1(e){if(Td?m.__onGCastApiAvailable=Td:delete m.__onGCastApiAvailable,Td=null,e)for(var t=x(_u),n=t.next();!n.done;n=t.next())n.value.init();typeof m.__onGCastApiAvailable=="function"&&m.__onGCastApiAvailable(e)}function Ot(e,t,n,r){r=r===void 0?!1:r,ot.call(this);var i=this;this.i=e,this.h=t,this.l=this.o=this.m=this.u=this.j=null,this.I=n,this.H=r,this.F=[],this.C=[],this.B=[],this.G=new Map,this.g=null,m.chrome&&je().Oa()!="CAST"?(this.g=new Tg(n,function(){return C1(i)},function(){return M1(i)},function(s,o){return k1(i,s,o)},function(){return R1(i)},function(){return I1(i)},r),Fk(this)):(this.j=this.i,this.u=this.h)}J(Ot,ot),p=Ot.prototype,p.destroy=function(e){return this.g&&(e!==void 0&&e)&&this.g.qd(),this.l&&(this.l.release(),this.l=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.j=this.i=null,ot.prototype.release.call(this),Promise.all(e)},p.ek=function(){return this.j},p.td=function(){return this.u},p.qj=function(){return this.g?this.g.m&&xd:!1},p.wb=function(){return this.g?this.g.wb():!1},p.dh=function(){return this.g?this.g.dh():""},p.cast=function(){var e=this;return F(function(t){return t.g==1?e.g?C(t,e.g.cast(),2):t.return():e.h?C(t,e.h.Cc(),0):t.return()})},p.ph=function(e){this.g&&this.g.ph(e)},p.fl=function(){this.g&&jk(this.g)},p.qd=function(){this.g&&this.g.qd()},p.rj=function(e,t){t=t===void 0?!1:t;var n=this;return F(function(r){if(r.g==1)return e==n.I&&t==n.H||(n.I=e,n.H=t,!n.g)?r.return():(n.g.qd(),C(r,n.g.destroy(),2));n.g=null,n.g=new Tg(e,function(){return C1(n)},function(){return M1(n)},function(i,s){return k1(n,i,s)},function(){return R1(n)},function(){return I1(n)},t),n.g.init(),ie(r)})};function Fk(e){e.g.init(),e.l=new et;for(var t=x(y1),n=t.next();!n.done;n=t.next())e.l.D(e.i,n.value,function(s){e.g.wb()||(s=c0(s),e.m.dispatchEvent(s))});for(var r in cc)e.l.D(e.h,cc[r],function(s){e.g.wb()||e.o.dispatchEvent(s)});e.j={},t={};for(var i in e.i)t={ge:t.ge},t.ge=i,Object.defineProperty(e.j,t.ge,{configurable:!1,enumerable:!0,get:(function(s){return function(){return Hk(e,s.ge)}})(t),set:(function(s){return function(o){var u=s.ge;e.g.wb()?e.g.set("video",u,o):e.i[u]=o}})(t)});e.u={},E1(e,function(s){Object.defineProperty(e.u,s,{configurable:!1,enumerable:!0,get:function(){return wd(e,s)}})}),Vk(e),e.m=new ot,e.m.Ie=e.j,e.o=new ot,e.o.Ie=e.u,e.l.D(e.h,"unloading",function(){e.g&&e.g.wb()||Ag(e)})}function Vk(e){var t=new Map;E1(e,function(n,r){t.has(r)?(r=t.get(r),n.length<r.length?e.G.set(n,r):e.G.set(r,n)):t.set(r,n)})}function E1(e,t){function n(l){return l=="constructor"||typeof r[l]!="function"?!1:!i.has(l)}var r=e.h,i=new Set,s;for(s in r)n(s)&&(i.add(s),t(s,r[s]));for(e=Object.getPrototypeOf(r),s=Object.getPrototypeOf({});e&&e!=s;){for(var o=x(Object.getOwnPropertyNames(e)),u=o.next();!u.done;u=o.next())u=u.value,n(u)&&(i.add(u),t(u,r[u]));e=Object.getPrototypeOf(e)}}function I1(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.rd(),startTime:null,addThumbnailsTrackCalls:e.F,addTextTrackAsyncCalls:e.C,addChaptersTrackCalls:e.B};e.i.pause();for(var n=x(yg),r=n.next();!r.done;r=n.next())r=r.value,t.video[r]=e.i[r];for(e.i.ended||(t.startTime=e.i.currentTime),n=x(x1),r=n.next();!r.done;r=n.next()){var i=r.value;r=i[1],i=e.h[i[0]](),t.player[r]=i}for(n=x(T1),r=n.next();!r.done;r=n.next())i=r.value,r=i[1],i=e.h[i[0]](),t.playerAfterLoad[r]=i;return t}function C1(e){var t=new Se("caststatuschanged");e.dispatchEvent(t)}function M1(e){var t=new Se(e.j.paused?"pause":"play");e.m.dispatchEvent(t)}function R1(e){for(var t=x(x1),n=t.next();!n.done;n=t.next()){var r=n.value;n=r[1],r=e.g.get("player",r[0])(),e.h[n](r)}var i=e.F,s=e.C,o=e.B;Ag(e);var u=e.g.get("player","getAssetUri")();r=e.g.get("video","ended"),t=Promise.resolve();var l=e.i.autoplay;n=null,r||(n=e.g.get("video","currentTime"));var f;(r=e.g.get("player","getTextTracks")())&&r.length&&(f=r.find(function(v){return v.active}));var g=e.g.get("player","isTextTrackVisible")();u&&(e.i.autoplay=!1,t=e.h.load(u,n));var y={};for(n=x(yg),r=n.next();!r.done;r=n.next())r=r.value,y[r]=e.g.get("video",r);t.then(function(){if(e.i){for(var v=x(i),w=v.next();!w.done;w=v.next()){w=w.value;var A;(A=e.td()).Oe.apply(A,Y(w))}for(v=x(s),A=v.next();!A.done;A=v.next()){A=A.value;var I;(I=e.td()).Qd.apply(I,Y(A))}for(I=x(o),v=I.next();!v.done;v=I.next()){v=v.value;var E;(E=e.td()).Ne.apply(E,Y(v))}for(E=x(yg),I=E.next();!I.done;I=E.next())I=I.value,e.i[I]=y[I];for(E=x(T1),I=E.next();!I.done;I=E.next())v=I.value,I=v[1],v=e.g.get("player",v[0])(),e.h[I](v);e.h.uh(g),f&&e.h.nh(f.language,f.roles,f.forced),e.i.autoplay=l,u&&e.i.play()}},function(v){v=new Map().set("detail",v),v=new Se("error",v),e.h.dispatchEvent(v)})}function Hk(e,t){if(t=="addEventListener")return function(r,i,s){return e.m.addEventListener(r,i,s)};if(t=="removeEventListener")return function(r,i,s){return e.m.removeEventListener(r,i,s)};if(e.g.wb()&&Object.keys(e.g.g.video).length==0){var n=e.i[t];if(typeof n!="function")return n}return e.g.wb()?e.g.get("video",t):(t=e.i[t],typeof t=="function"&&(t=t.bind(e.i)),t)}function wd(e,t,n){if(n=n===void 0?!1:n,e.G.has(t)&&(t=e.G.get(t)),t=="addEventListener")return function(r,i,s){return e.o.addEventListener(r,i,s)};if(t=="removeEventListener")return function(r,i,s){return e.o.removeEventListener(r,i,s)};if(t=="getMediaElement")return function(){return e.j};if(t=="getSharedConfiguration")return e.g.get("player","getConfiguration");if(t=="getNetworkingEngine")return function(){return e.h.Zb()};if(t=="getDrmEngine")return function(){return e.h.F};if(t=="getAdManager")return function(){return e.h.bi()};if(t=="getQueueManager")return function(){return e.h.ki()};if(t=="setVideoContainer")return function(r){return e.h.Xi(r)};if(!n){if(t=="addThumbnailsTrack")return function(){var r=Rt.apply(0,arguments);return e.F.push(r),wd(e,t,!0).apply(null,Y(r))};if(t=="addTextTrackAsync")return function(){var r=Rt.apply(0,arguments);return e.C.push(r),wd(e,t,!0).apply(null,Y(r))};if(t=="addChaptersTrack")return function(){var r=Rt.apply(0,arguments);return e.B.push(r),wd(e,t,!0).apply(null,Y(r))}}if(e.g.wb()){if(t=="getManifest"||t=="drmInfo")return function(){return Be(t+"() does not work while casting!"),null};if(t=="attach"||t=="detach")return function(){return Be(t+"() does not work while casting!"),Promise.resolve()};if(t=="getChapters")return function(){return Be(t+"() does not work while casting!"),[]}}return e.g.wb()&&Object.keys(e.g.g.video).length==0&&(vg.has(t)||xg.has(t))||!e.g.wb()?e.h[t].bind(e.h):e.g.get("player",t)}function k1(e,t,n){e.g.wb()&&(t=="video"?e.m.dispatchEvent(n):t=="player"&&(n.type=="unloading"&&Ag(e),e.o.dispatchEvent(n)))}function Ag(e){e.F=[],e.C=[],e.B=[]}de("shaka.cast.CastProxy",Ot),Ot.prototype.changeReceiverId=Ot.prototype.rj,Ot.prototype.forceDisconnect=Ot.prototype.qd,Ot.prototype.suggestDisconnect=Ot.prototype.fl,Ot.prototype.setAppData=Ot.prototype.ph,Ot.prototype.cast=Ot.prototype.cast,Ot.prototype.receiverName=Ot.prototype.dh,Ot.prototype.isCasting=Ot.prototype.wb,Ot.prototype.canCast=Ot.prototype.qj,Ot.prototype.getPlayer=Ot.prototype.td,Ot.prototype.getVideo=Ot.prototype.ek,Ot.prototype.destroy=Ot.prototype.destroy;function hn(e,t,n,r){ot.call(this);var i=this;this.h=e,this.g=t,this.j=new et,this.I={video:e,player:t},this.G=n||function(){},this.J=r||function(s){return s},this.i=null,this.H=!1,this.o=!0,this.m=0,this.C=!1,this.B=!0,this.u=this.l=null,this.F=new Ve(function(){Eg(i)}),Gk(this)}J(hn,ot),p=hn.prototype,p.isConnected=function(){return this.H},p.lk=function(){return this.o},p.Zk=function(e){this.i=e},p.vj=function(){this.i=null},p.$k=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},p.Yk=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},p.Xk=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},p.destroy=function(){var e=this,t,n;return F(function(r){if(r.g==1)return e.j&&(e.j.release(),e.j=null),t=[],e.g&&(t.push(e.g.destroy()),e.g=null),e.F&&(e.F.stop(),e.F=null),e.h=null,e.I=null,e.G=null,e.H=!1,e.o=!0,e.l=null,e.u=null,ot.prototype.release.call(e),C(r,Promise.all(t),2);n=cast.receiver.CastReceiverManager.getInstance(),n.stop(),ie(r)})};function Gk(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return _1(e)},t.onSenderDisconnected=function(){return _1(e)},t.onSystemVolumeChanged=function(){var i=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();i&&Li(e,{type:"update",update:{video:{volume:i.level,muted:i.muted}}},e.l),Li(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.u=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.u.onMessage=function(i){return Wk(e,i)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(i){return zk(e,i)},t.start(),t=x(y1);for(var n=t.next();!n.done;n=t.next())e.j.D(e.h,n.value,function(i){return P1(e,"video",i)});for(var r in cc)e.j.D(e.g,cc[r],function(i){return P1(e,"player",i)});e.j.D(e.h,"loadeddata",function(){e.C=!0}),e.j.D(e.g,"loading",function(){e.o=!1,Xo(e)}),e.j.D(e.h,"playing",function(){e.o=!1,Xo(e)}),e.j.D(e.h,"pause",function(){Xo(e)}),e.j.D(e.g,"unloading",function(){e.o=!0,Xo(e)}),e.j.D(e.h,"ended",function(){new Ve(function(){e.h&&e.h.ended&&(e.o=!0,Xo(e))}).ka($k)})}function _1(e){e.m=0,e.B=!0,e.H=cast.receiver.CastReceiverManager.getInstance().getSenders().length!=0,Xo(e)}function Xo(e){var t;F(function(n){if(n.g==1)return C(n,Promise.resolve(),2);if(!e.g)return n.return();t=new Se("caststatuschanged"),e.dispatchEvent(t),D1(e)||bi(e),ie(n)})}function Xk(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X;F(function(b){switch(b.g){case 1:for(r in t.player)i=t.player[r],e.g[r](i);return e.G(n),s=e.h.autoplay,t.manifest?(e.h.autoplay=!1,Z(b,5),C(b,e.g.load(t.manifest,t.startTime),7)):C(b,Promise.resolve(),3);case 7:if(t.addThumbnailsTrackCalls)for(o=x(t.addThumbnailsTrackCalls),u=o.next();!u.done;u=o.next())l=u.value,e.g.Oe.apply(e.g,Y(l));if(t.addTextTrackAsyncCalls)for(f=x(t.addTextTrackAsyncCalls),g=f.next();!g.done;g=f.next())y=g.value,e.g.Qd.apply(e.g,Y(y));if(t.addChaptersTrackCalls)for(v=x(t.addChaptersTrackCalls),w=v.next();!w.done;w=v.next())A=w.value,e.g.Ne.apply(e.g,Y(A));ce(b,3);break;case 5:return I=se(b),E=new Map().set("detail",I),R=new Se("error",E),e.g&&e.g.dispatchEvent(R),b.return();case 3:if(!e.g)return b.return();for(M in t.video)D=t.video[M],e.h[M]=D;for(O in t.playerAfterLoad)X=t.playerAfterLoad[O],e.g[O](X);e.h.autoplay=s,t.manifest&&(e.h.play(),bi(e)),ie(b)}})}function P1(e,t,n){e.g&&(Eg(e),Li(e,{type:"event",targetName:t,event:n},e.l))}function Eg(e){e.F.ka(Kk);for(var t={video:{},player:{}},n=x(bk),r=n.next();!r.done;r=n.next())r=r.value,t.video[r]=e.h[r];e.g.W()&&v1.forEach(function(i,s){e.m%i==0&&(t.player[s]=e.g[s]())}),vg.forEach(function(i,s){e.m%i==0&&(t.player[s]=e.g[s]())}),(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Li(e,{type:"update",update:t},e.l),xg.forEach(function(i,s){e.m%i==0&&(i={player:{}},i.player[s]=e.g[s](),Li(e,{type:"update",update:i},e.l))}),e.C&&(e.m+=1),D1(e)}function D1(e){return e.B&&(e.h.duration||e.g.W())?(Ig(e),e.B=!1,!0):!1}function Ig(e,t){var n={contentId:e.g.rd(),streamType:e.g.W()?"LIVE":"BUFFERED",contentType:""};e.g.W()||(n.duration=e.h.duration),e.i&&(n.metadata=e.i),bi(e,t===void 0?0:t,n)}function zk(e,t){var n=yd(t.data);switch(n.type){case"init":e.m=0,e.C=!1,e.B=!0,Xk(e,n.initState,n.appData),Eg(e);break;case"appData":e.G(n.appData);break;case"set":var r=n.targetName,i=n.property;if(n=n.value,r=="video"){if(t=cast.receiver.CastReceiverManager.getInstance(),i=="volume"){t.setSystemVolumeLevel(n);break}else if(i=="muted"){t.setSystemVolumeMuted(n);break}}e.I[r][i]=n;break;case"call":r=e.I[n.targetName],r[n.methodName].apply(r,n.args);break;case"asyncCall":r=n.targetName,i=n.methodName,r=="player"&&i=="load"&&(e.m=0,e.C=!1);var s=n.id,o=t.senderId;t=e.I[r],n=t[i].apply(t,n.args),r=="player"&&i=="load"&&(n=n.then(function(){e.B=!0})),n.then(function(u){return L1(e,o,s,null,u)},function(u){return L1(e,o,s,u,null)})}}function Wk(e,t){var n=yd(t.data);switch(n.type){case"PLAY":e.h.play(),bi(e);break;case"PAUSE":e.h.pause(),bi(e);break;case"SEEK":t=n.currentTime;var r=n.resumeState;t!=null&&(e.h.currentTime=Number(t)),r&&r=="PLAYBACK_START"?(e.h.play(),bi(e)):r&&r=="PLAYBACK_PAUSE"&&(e.h.pause(),bi(e));break;case"STOP":e.g.Cc().then(function(){e.g&&bi(e)});break;case"GET_STATUS":Ig(e,Number(n.requestId));break;case"VOLUME":r=n.volume,t=r.level,r=r.muted;var i=e.h.volume,s=e.h.muted;t!=null&&(e.h.volume=Number(t)),r!=null&&(e.h.muted=r),i==e.h.volume&&s==e.h.muted||bi(e);break;case"LOAD":e.m=0,e.C=!1,e.B=!1,t=n.media,r=n.currentTime,i=e.J(t.contentId),s=n.autoplay||!0,e.G(t.customData),s&&(e.h.autoplay=!0),e.g.load(i,r).then(function(){e.g&&Ig(e)}).catch(function(o){var u="LOAD_FAILED";o.category==7&&o.code==7e3&&(u="LOAD_CANCELLED"),Li(e,{requestId:Number(n.requestId),type:u},e.u)});break;default:Li(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.u)}}function L1(e,t,n,r,i){e.g&&Li(e,{type:"asyncComplete",id:n,error:r,res:i},e.l,t)}function Li(e,t,n,r){e.H&&(e=mg(t),r?n.getCastChannel(r).send(e):n.broadcast(e))}function bi(e,t,n){n=n===void 0?null:n;var r={mediaSessionId:0,playbackRate:e.h.playbackRate,playerState:e.o?Yk:e.g.Qg()?Qk:e.h.paused?Jk:qk,currentTime:e.h.currentTime,supportedMediaCommands:63,volume:{level:e.h.volume,muted:e.h.muted}};n&&(r.media=n),Li(e,{requestId:t===void 0?0:t,type:"MEDIA_STATUS",status:[r]},e.u)}de("shaka.cast.CastReceiver",hn),hn.prototype.destroy=hn.prototype.destroy,hn.prototype.setContentArtist=hn.prototype.Xk,hn.prototype.setContentImage=hn.prototype.Yk,hn.prototype.setContentTitle=hn.prototype.$k,hn.prototype.clearContentMetadata=hn.prototype.vj,hn.prototype.setContentMetadata=hn.prototype.Zk,hn.prototype.isIdle=hn.prototype.lk,hn.prototype.isConnected=hn.prototype.isConnected;var Kk=.5,$k=5,Yk="IDLE",qk="PLAYING",Qk="BUFFERING",Jk="PAUSED";function b1(e,t,n,r,i){if(r>=i)return null;for(var s=-1,o=-1,u=0;u<n.length;u++)if(n[u].some(function(O){return O!=null&&O.g.trim()!=""})){s=u;break}for(u=n.length-1;u>=0;u--)if(n[u].some(function(O){return O!=null&&O.g.trim()!=""})){o=u;break}if(s===-1||o===-1)return null;for(var l=u=!1,f="white",g="black",y=Cg(r,i,u,l,f,g);s<=o;s++){for(var v=n[s],w=-1,A=-1,I=0;I<v.length;I++)if(v[I]!=null&&v[I].g.trim()!==""){w=I;break}for(I=v.length-1;I>=0;I--)if(v[I]!=null&&v[I].g.trim()!==""){A=I;break}if(w===-1||A===-1)v=N1(r,i),e.nestedCues.push(v);else{for(;w<=A;w++)if(I=v[w]){var E=I.l,R=I.i,M=I.j,D=I.h;(E!=u||R!=l||M!=f||D!=g)&&(y.payload&&e.nestedCues.push(y),y=Cg(r,i,E,R,M,D),u=E,l=R,f=M,g=D),y.payload+=I.g}else y.payload+=" ";y.payload&&e.nestedCues.push(y),s!==o&&(y=N1(r,i),e.nestedCues.push(y)),y=Cg(r,i,u,l,f,g)}}return e.nestedCues.length?{cue:e,stream:t}:null}function Cg(e,t,n,r,i,s){return e=new ht(e,t,""),n&&e.textDecoration.push(xi),r&&(e.fontStyle=po),e.color=i,e.backgroundColor=s,e}function N1(e,t){return e=new ht(e,t,""),e.lineBreak=!0,e}function O1(e,t,n,r,i){this.g=e,this.l=t,this.i=n,this.h=r,this.j=i}function Mg(e,t){this.i=[],this.g=1,this.h=0,this.F=e,this.C=t,this.j=this.m=!1,this.l="white",this.o="black",this.u=this.B=null,Pu(this)}function Sd(e,t,n){var r="CC"+((e.F<<1|e.C)+1),i=new ht(t,n,"");i.lineInterpretation=1;var s=B1.get(e.g);return s&&(i.line=s),e.u!=null&&e.B!=null&&(i.position=10+Math.min(70,e.u*10)+e.B*2.5),(t=b1(i,r,e.i,t,n))&&e.g+t.cue.nestedCues.length-3>15&&(s=B1.get(e.g+3-t.cue.nestedCues.length))&&(i.line=s),t}function Pu(e){Ni(e,0,15),e.g=1}function zo(e,t,n){if(!(n<32||n>127)){var r="";switch(t){case 0:r=j1.has(n)?j1.get(n):String.fromCharCode(n);break;case 1:r=Zk.get(n);break;case 2:e.i[e.g].pop(),r=e_.get(n);break;case 3:e.i[e.g].pop(),r=t_.get(n)}r&&e.i[e.g].push(new O1(r,e.m,e.j,e.o,e.l))}}function U1(e,t,n,r){if(!(n<0||t<0))if(t>=n)for(--r;r>=0;r--)e.i[t+r]=e.i[n+r].map(function(s){return s});else for(var i=0;i<r;i++)e.i[t+i]=e.i[n+i].map(function(s){return s})}function Ni(e,t,n){for(var r=0;r<=n;r++)e.i[t+r]=[]}var j1=new Map([[39,""],[42,""],[92,""],[92,""],[94,""],[95,""],[96,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),Zk=new Map([[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57," "],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),e_=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,"*"],[41,"'"],[42,""],[43,""],[44,""],[45,""],[46,""],[47,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),t_=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,""],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),B1=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Ad(e,t){this.h=0,this.o=new Mg(e,t),this.i=new Mg(e,t),this.g=this.j=new Mg(e,t),this.l=0,this.m=null}function Rg(e,t,n){e.g=e.i;var r=e.g,i=null;return e.h!==3&&e.h!==4&&(i=Sd(r,e.l,n),n=e.i,n.g=n.h>0?n.h:0,Ni(n,0,15),n=e.j,n.g=n.h>0?n.h:0,Ni(n,0,15),r.g=15),e.h=3,r.h=t,i}function F1(e){e.h=1,e.g=e.j,e.g.h=0}function V1(e){ir("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var n_="black green blue cyan red yellow magenta black".split(" "),H1="white green blue cyan red yellow magenta white_italics".split(" ");function kg(e,t){this.J=t,this.N=e,this.K=this.l=!1,this.m=this.o=this.H=this.M=this.I=0,this.G=2,this.i=[],this.g=this.h=this.j=0,this.F=this.B=!1,this.C="white",this.u="black",_g(this)}function _g(e){e.i=[];for(var t=0;t<16;t++)e.i.push(Pg())}function Pg(){for(var e=[],t=0;t<42;t++)e.push(null);return e}function cs(e,t){G1(e)&&(e.i[e.h][e.g]=new O1(t,e.F,e.B,e.u,e.C),e.g++)}function G1(e){var t=e.g<e.m&&e.g>=0;return e.h<e.o&&e.h>=0&&t}kg.prototype.isVisible=function(){return this.l};function r_(e){for(var t=0,n=1;n<16;n++,t++)e.i[t]=e.i[n];for(n=0;n<1;n++,t++)e.i[t]=Pg()}function zs(e,t,n){var r=new ht(e.j,t,"");r.textAlign=e.G===0?"left":e.G===1?"right":ii;var i=r.region;switch(e.J&&(i.id+="svc"+e.J),i.id+="win"+e.N,i.height=e.o,i.width=e.m,i.heightUnits=2,i.widthUnits=2,i.viewportAnchorX=e.I,i.viewportAnchorY=e.M,i.viewportAnchorUnits=e.K?Wn:2,e.H){case 0:i.regionAnchorX=0,i.regionAnchorY=0;break;case 1:i.regionAnchorX=50,i.regionAnchorY=0;break;case 2:i.regionAnchorX=100,i.regionAnchorY=0;break;case 3:i.regionAnchorX=0,i.regionAnchorY=50;break;case 4:i.regionAnchorX=50,i.regionAnchorY=50;break;case 5:i.regionAnchorX=100,i.regionAnchorY=50;break;case 6:i.regionAnchorX=0,i.regionAnchorY=100;break;case 7:i.regionAnchorX=50,i.regionAnchorY=100;break;case 8:i.regionAnchorX=100,i.regionAnchorY=100}return(n=b1(r,"svc"+n,e.i,e.j,t))&&(e.j=t),n}kg.prototype.display=function(){this.l=!0};function i_(){this.i=[],this.h=null,this.g=0}function s_(e,t){t.type===3?(e.g=(t.value&63)*2-1,e.h=[]):e.h&&(e.g>0&&(e.h.push(t),e.g--),e.g===0&&(e.i.push(new Du(e.h)),e.h=null,e.g=0))}function Du(e){this.g=0,this.h=e}Du.prototype.Ia=function(){return this.g<this.h.length},Du.prototype.Pa=function(){return this.g};function Xt(e){if(!e.Ia())throw new H(2,2,3e3);return e.h[e.g++]}Du.prototype.skip=function(e){if(this.g+e>this.h.length)throw new H(2,2,3e3);this.g+=e},Du.prototype.Oi=function(e){if(this.g-e<0)throw new H(2,2,3e3);this.g-=e};function o_(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function a_(e,t,n,r){if(!e.g)return[];if(n==24)return n=Xt(t).value,r=Xt(t).value,n=(function(s){return s.map(function(o){return("0"+(o&255).toString(16)).slice(-2)}).join("")})([n,r]),cs(e.g,String.fromCharCode(parseInt(n,16))),[];t=e.g;var i=null;switch(n){case 8:!G1(t)||t.g<=0&&t.h<=0||(t.g<=0?(t.g=t.m-1,t.h--):t.g--,t.i[t.h][t.g]=null);break;case 13:t.isVisible()&&(i=zs(t,r,e.i)),t.h+1>=t.o?r_(t):t.h++,t.g=0;break;case 14:t.isVisible()&&(i=zs(t,r,e.i)),t.i[t.h]=Pg(),t.g=0;break;case 12:t.isVisible()&&(i=zs(t,r,e.i)),_g(t),t.h=0,t.g=0}return i?[i]:[]}function u_(e,t,n,r){if(n>=128&&n<=135)r=n&7,e.h[r]&&(e.g=e.h[r]);else{if(n===136){n=Xt(t).value,t=[],n=x(Lu(e,n));for(var i=n.next();!i.done;i=n.next()){if(i=e.h[i.value],i.isVisible()){var s=zs(i,r,e.i);s&&t.push(s)}_g(i)}return t}if(n===137)for(t=Xt(t).value,t=x(Lu(e,t)),n=t.next();!n.done;n=t.next())n=e.h[n.value],n.isVisible()||(n.j=r),n.display();else{if(n===138){for(n=Xt(t).value,t=null,n=x(Lu(e,n)),i=n.next();!i.done;i=n.next())i=e.h[i.value],i.isVisible()&&(t=zs(i,r,e.i)),i.l=!1;return t?[t]:[]}if(n===139){for(n=Xt(t).value,t=null,n=x(Lu(e,n)),i=n.next();!i.done;i=n.next())i=e.h[i.value],i.isVisible()?t=zs(i,r,e.i):i.j=r,i.l=!i.l;return t?[t]:[]}if(n===140)return t=Xt(t).value,X1(e,t,r);if(n===143)return r=X1(e,255,r),z1(e),r;if(n===144)t.skip(1),r=Xt(t).value,e.g&&(e.g.B=(r&128)>0,e.g.F=(r&64)>0);else if(n===145)r=Xt(t).value,n=Xt(t).value,t.skip(1),e.g&&(t=W1((n&48)>>4,(n&12)>>2,n&3),e.g.C=W1((r&48)>>4,(r&12)>>2,r&3),e.g.u=t);else if(n===146)r=Xt(t).value,t=Xt(t).value,e.g&&(e=e.g,e.h=r&15,e.g=t&63);else if(n===151)t.skip(1),t.skip(1),r=Xt(t).value,t.skip(1),e.g&&(e.g.G=r&3);else if(n>=152&&n<=159){n=(n&15)-8,i=e.h[n]!==null,i||(s=new kg(n,e.i),s.j=r,e.h[n]=s),r=Xt(t).value,s=Xt(t).value;var o=Xt(t).value,u=Xt(t).value,l=Xt(t).value;t=Xt(t).value,i&&(t&7)===0||(t=e.h[n],t.h=0,t.g=0,t.F=!1,t.B=!1,t.C="white",t.u="black"),t=e.h[n],t.l=(r&32)>0,t.M=s&127,t.I=o,t.H=(u&240)>>4,t.K=(s&128)>0,t.o=(u&15)+1,t.m=(l&63)+1,e.g=e.h[n]}}}return[]}function Lu(e,t){for(var n=[],r=0;r<8;r++)(t&1)===1&&e.h[r]&&n.push(r),t>>=1;return n}function X1(e,t,n){var r=[];t=x(Lu(e,t));for(var i=t.next();!i.done;i=t.next()){i=i.value;var s=e.h[i];s.isVisible()&&(s=zs(s,n,e.i))&&r.push(s),e.h[i]=null}return r}function z1(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function W1(e,t,n){var r={0:0,1:0,2:1,3:1};return e=r[e],t=r[t],n=r[n],l_[e<<2|t<<1|n]}var K1=new Map([[32," "],[33,""],[37,""],[42,""],[44,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[57,""],[58,""],[60,""],[61,""],[63,""],[118,""],[119,""],[120,""],[121,""],[122,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),l_="black blue green cyan red magenta yellow white".split(" ");function Wo(){this.h=[],this.g=[],this.i=new i_,this.l=0,this.m=new Map([["CC1",new Ad(0,0)],["CC2",new Ad(0,1)],["CC3",new Ad(1,0)],["CC4",new Ad(1,1)]]),this.u=this.o=0,this.j=new Map,this.C=!0,this.B=new Set,Dg(this)}Wo.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,Dg(this),e=x(this.j.values());for(var t=e.next();!t.done;t=e.next())z1(t.value)};function Dg(e){e.o=0,e.u=0;for(var t=x(e.m.values()),n=t.next();!n.done;n=t.next())n=n.value,n.h=0,n.g=n.j,n.m=null,Pu(n.i),Pu(n.j),Pu(n.o);e.C=!0}Wo.prototype.extract=function(e,t){if(this.C){for(var n=x(this.m.values()),r=n.next();!r.done;r=n.next())r.value.l=t;this.C=!1}if(e=new pt(e,0),!(e.getLength()<8)&&e.Y()===181&&e.Ca()===49&&e.U()===1195456820&&e.Y()===3&&(n=e.Y(),(n&64)!==0))for(n&=31,e.skip(1),r=0;r<n;r++){var i=e.Y(),s=(i&4)>>2,o=e.Y(),u=e.Y();s&&(i&=3,i===0||i===1?this.h.push({pts:t,type:i,Db:o,kc:u,order:this.h.length}):(this.g.push({pts:t,type:i,value:o,order:this.g.length}),this.g.push({pts:t,type:2,value:u,order:this.g.length})))}},Wo.prototype.decode=function(){function e(i,s){return i.pts-s.pts||i.order-s.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=x(this.h),r=n.next();!r.done;r=n.next())(r=c_(this,r.value))&&t.push(r);for(n=x(this.g),r=n.next();!r.done;r=n.next())s_(this.i,r.value);for(n=x(this.i.i),r=n.next();!r.done;r=n.next())r=d_(this,r.value),t.push.apply(t,Y(r));return this.i.i=[],this.h=[],this.g=[],t};function c_(e,t){var n=t.type;if((t.Db&112)===16){var r=t.Db>>3&1;n===0?e.o=r:e.u=r}if(r="CC"+((n<<1|(n?e.u:e.o))+1),n=e.m.get(r),t.Db===255&&t.kc===255||!t.Db&&!t.kc||!$1(t.Db)||!$1(t.kc))return++e.l>=45&&Dg(e),null;e.l=0,t.Db&=127,t.kc&=127;var i=t.Db;if(i>=1&&i<=15||!t.Db&&!t.kc)return null;if(i=null,(t.Db&112)===16)e:{if(e.B.add(r),r=t.Db,e=t.kc,n.m===(r<<8|e))n.m=null;else if(n.m=r<<8|e,(r&240)===16&&(e&192)===64){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(r&7)<<1|e>>5&1],r="white",i=!1;var s=null,o=e>95?e-96:e-64;o<=13?r=H1[Math.floor(o/2)]:o<=15?i=!0:s=Math.floor((o-16)/2),e=(e&1)===1,n.h!==4&&(o=n.g,n.h===3&&t!==o.g&&(n=1+t-o.h,U1(o,n,1+o.g-o.h,o.h),Ni(o,0,n-1),Ni(o,t+1,15-t)),o.g=t,o.m=e,o.j=i,o.l=r,o.u=s,o.o="black")}else if((r&247)===17&&(e&240)===32)n.g.m=!1,n.g.j=!1,n.g.l="white",zo(n.g,0,32),r=!1,t=H1[(e&14)>>1],t==="white_italics"&&(t="white",r=!0),n.g.m=(e&1)===1,n.g.j=r,n.g.l=t;else if((r&247)===16&&(e&240)===32||(r&247)===23&&(e&255)===45)t="black",(r&7)===0&&(t=n_[(e&14)>>1]),n.g.o=t;else if((r&247)===17&&(e&240)===48)zo(n.g,1,e);else if((r&246)===18&&(e&224)===32)zo(n.g,r&1?3:2,e);else{if((r&246)===20&&(e&240)===32){switch(e=t.pts,r=null,t.kc){case 32:F1(n);break;case 33:n=n.g,n.i[n.g].pop();break;case 37:r=Rg(n,2,e);break;case 38:r=Rg(n,3,e);break;case 39:r=Rg(n,4,e);break;case 40:zo(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:Pu(n.o),V1(n);break;case 43:V1(n);break;case 44:t=n.i,r=null,n.h!==4&&(r=Sd(t,n.l,e)),Ni(t,0,15);break;case 45:t=n.g,n.h!==3?r=null:(r=Sd(t,n.l,e),i=t.g-t.h+1,U1(t,i-1,i,t.h),Ni(t,0,i-1),Ni(t,t.g,15-t.g),n.l=e);break;case 46:Ni(n.j,0,15);break;case 47:t=null,n.h!==4&&(t=Sd(n.i,n.l,e)),r=n.j,n.j=n.i,n.i=r,F1(n),n.l=e,r=t}i=r;break e}(r==23||r==31)&&e>=33&&e<=35&&(n.g.B=e-32)}i=null}else e=t.kc,zo(n.g,0,t.Db),zo(n.g,0,e);return i}function d_(e,t){var n=[];try{for(;t.Ia();){var r=Xt(t).value,i=(r&224)>>5,s=r&31;if(i===7&&s!=0&&(i=Xt(t).value&63),i!=0){e.B.add("svc"+i),e.j.has(i)||e.j.set(i,new o_(i));for(var o=e.j.get(i),u=t.Pa();t.Pa()-u<s;){i=o;var l=t,f=Xt(l),g=f.value,y=f.pts;if(g===16){var v=Xt(l);g=g<<16|v.value}if(g>=0&&g<=31)var w=a_(i,l,g,y);else if(g>=128&&g<=159)w=u_(i,l,g,y);else{if(g>=4096&&g<=4127)i=l,l=g&255,l>=8&&l<=15?i.skip(1):l>=16&&l<=23?i.skip(2):l>=24&&l<=31&&i.skip(3);else if(g>=4224&&g<=4255)i=l,l=g&255,l>=128&&l<=135?i.skip(4):l>=136&&l<=143&&i.skip(5);else if(g>=32&&g<=127)l=g,i.g&&(l===127?cs(i.g,""):cs(i.g,String.fromCharCode(l)));else if(g>=160&&g<=255)i.g&&cs(i.g,String.fromCharCode(g));else if(g>=4128&&g<=4223){if(l=g&255,i.g)if(K1.has(l)){var A=K1.get(l);cs(i.g,A)}else cs(i.g,"_")}else g>=4256&&g<=4351&&i.g&&((g&255)!=160?cs(i.g,"_"):cs(i.g,"[CC]"));w=[]}n.push.apply(n,Y(w))}}}}catch(I){if(I instanceof H&&I.code===3e3)ir("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.");else throw I}return n}function $1(e){for(var t=0;e;)t^=e&1,e>>=1;return t===1}Wo.prototype.getStreams=function(){return Array.from(this.B)},de("shaka.cea.CeaDecoder",Wo),Cs=function(){return new Wo};function Y1(e){for(var t=[],n=e,r=e=0;r<n.length;)e==2&&n[r]==3?(e=0,n=[].concat(Y(n)),n.splice(r,1),n=new Uint8Array(n)):n[r]==0?e++:e=0,r++;for(e=n,r=0;r<e.length;){for(n=0;e[r]==255;)n+=255,r++;n+=e[r++];for(var i=0;e[r]==255;)i+=255,r++;i+=e[r++],n==4&&t.push(e.subarray(r,r+i)),r+=i}return t}function Ed(){this.j=new Map,this.i=this.h=0,this.g=Lg}Ed.prototype.init=function(e){function t(s){s=s.name,Id.has(s)&&(n.g=Id.get(s))}var n=this,r=[],i=[];if(new ut().box("moov",Ue).box("mvex",Ue).S("trex",function(s){var o=s.reader;o.skip(4),o.skip(4),s=o.U(),o=o.U(),n.h=s,n.i=o}).box("trak",Ue).S("tkhd",function(s){var o=s.reader;s=s.version,s==1?(o.skip(8),o.skip(8)):(o.skip(4),o.skip(4));var u=o.U();s==1?o.skip(8):o.skip(4),o.skip(4),o.skip(8),o.skip(2),o.skip(2),o.skip(2),o.skip(2),o.skip(36),o.Ca(),o.Ca(),o.Ca(),o.Ca(),r.push(u)}).box("mdia",Ue).S("mdhd",function(s){s=xc(s.reader,s.version),i.push(s.timescale)}).box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",$n).box("sinf",Ue).box("frma",function(s){s=Zh(s.reader).codec,Id.has(s)&&(n.g=Id.get(s))}).parse(e,!0,!0),!r.length||!i.length||r.length!=i.length)throw new H(2,2,2010);this.g==Lg&&Be("Unable to determine bitstream format for CEA parsing!"),r.forEach(function(s,o){n.j.set(s,i[o])})},Ed.prototype.parse=function(e){var t=this;if(this.g==Lg)return[];var n=[],r=0,i=[];return new ut().box("moof",function(s){r=s.start,i=[],Ue(s)}).box("traf",function(s){i.push({baseMediaDecodeTime:null,Vd:t.h,Wd:t.i,Gi:[],timescale:9e4}),Ue(s)}).S("trun",function(s){var o=i[i.length-1];s=Tc(s.reader,s.version,s.flags),o.Gi.push(s)}).S("tfhd",function(s){var o=i[i.length-1];s=yc(s.reader,s.flags),o.Vd=s.Vd||t.h,o.Wd=s.Wd||t.i,s=s.trackId,t.j.has(s)&&(o.timescale=t.j.get(s))}).S("tfdt",function(s){var o=i[i.length-1];s=vc(s.reader,s.version),o.baseMediaDecodeTime=s.baseMediaDecodeTime}).box("mdat",function(s){for(var o=r-s.start-8,u=s.reader.Pa(),l=x(i),f=l.next();!f.done;f=l.next())f=f.value,f.baseMediaDecodeTime===null?Be("Unable to find base media decode time for CEA captions!"):(s.reader.seek(u),f_(t,s.reader,f.baseMediaDecodeTime,f.timescale,f.Vd,f.Wd,o,f.Gi,n))}).parse(e,!1,!0),n};function f_(e,t,n,r,i,s,o,u,l){var f=0,g=s,y=u.map(function(A){return A.kh});for(y=[].concat.apply([],Y(y)),y.length&&(g=y[0].sampleSize||s),t.skip(o+u[0].pg);t.Ia();){o=t.U();var v=t.Y(),w=null;switch(w=!1,u=1,e.g){case bu:w=v&31,w=w==6;break;case Nu:u=2,t.skip(1),w=v>>1&63,w=w==39||w==40;break;case Ou:u=2,t.skip(1),w=v>>1&63,w=w==23||w==24;break;default:return}if(w)for(v=0,f<y.length&&(v=y[f].Ff||0),v=(n+v)/r,u=t.Ub(o-u,!1),u=x(Y1(u)),w=u.next();!w.done;w=u.next())l.push({packet:w.value,pts:v});else try{t.skip(o-u)}catch(A){break}g-=o+4,g==0&&(n=f<y.length?n+(y[f].mh||i):n+i,f++,f<y.length?g=y[f].sampleSize||s:g=s)}}de("shaka.cea.Mp4CeaParser",Ed);var Lg=0,bu=1,Nu=2,Ou=3,Id=new Map().set("avc1",bu).set("avc3",bu).set("dvav",bu).set("dva1",bu).set("hev1",Nu).set("hvc1",Nu).set("dvh1",Nu).set("dvhe",Nu).set("vvc1",Ou).set("vvi1",Ou).set("dvc1",Ou).set("dvi1",Ou);Eh("video/mp4",function(){return new Ed});function Cd(){this.g=null}Cd.prototype.init=function(){},Cd.prototype.parse=function(e){this.g?this.g.clearData():this.g=new ft;var t=[];if(e=Le(e),!Ro(e))return t;e=this.g.parse(e);var n=e.Xd(),r=e.df();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(n=x(r),r=n.next();!r.done;r=n.next())if(r=r.value,e.includes(r.type)&&r.time!=null)for(var i=x(Y1(r.data)),s=i.next();!s.done;s=i.next())t.push({packet:s.value,pts:r.time});return t},de("shaka.cea.TsCeaParser",Cd),Eh("video/mp2t",function(){return new Cd});function h_(e){var t=0,n=Ln(e),r=n.getUint32(t,!0);if(r!=e.byteLength)return[];e:{for(e=t+4+2,t=[];e<n.byteLength-1;){r=n.getUint16(e,!0),e+=2;var i=n.getUint16(e,!0);if(e+=2,(i&1)!=0||i+e>n.byteLength){n=[];break e}var s=Le(n,e,i);t.push({type:r,value:s}),e+=i}n=t}return n}function q1(e){return e=xr(Dt(e)),e=h_(e).filter(function(t){return t.type===p_})[0],e?(e=Ki(e.value,!0),(e=ks(e,"WRMHEADER"))?e:null):null}function Md(e){try{var t=q1(e);if(t)e:{for(var n=x(Kr(t,"DATA")),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.children)for(var s=x(i.children),o=s.next();!o.done;o=s.next()){var u=o.value;if(u.tagName=="LA_URL"){var l=Dt(u);break e}}}l=""}else l="";return l}catch(f){return""}}var p_=1;function Q1(){this.g=new Map}Q1.prototype.release=function(){this.g.clear()};function J1(e,t,n,r){var i=y_(e,t),s=null;e=[];var o=[];t=null;var u=new Set(i.map(function(f){return f.keyId}));u.delete(null);var l="cenc";if(u.size>1)throw new H(2,4,4010);if(!n){if(o=i.filter(function(f){return f.Hd=="urn:mpeg:dash:sea:2012"}),o.length>1)throw new H(2,4,4050);o.length&&(t=x_(o[0])),(o=i.find(function(f){return f.Hd=="urn:mpeg:dash:mp4protection:2011"}))&&o.encryptionScheme&&(l=o.encryptionScheme),o=i.filter(function(f){return f.Hd=="urn:mpeg:dash:mp4protection:2011"?(s=f.init||s,!1):f.Hd!="urn:mpeg:dash:sea:2012"}),o.length&&(e=m_(s,l,o,r,u),e.length==0&&(e=[mi("",l,s)]))}if(i.length&&!t&&(n||!o.length))for(e=[],n=x(Object.values(r)),r=n.next();!r.done;r=n.next())r=r.value,r!="org.w3.clearkey"&&(r=mi(r,l,s),e.push(r));if(u=Array.from(u)[0]||null)for(l=x(e),n=l.next();!n.done;n=l.next())for(n=x(n.value.initData),r=n.next();!r.done;r=n.next())r.value.keyId=u;return{Wh:u,Cm:s,drmInfos:e,gg:t,ai:!0}}function g_(e,t,n,r,i){var s=J1(e,t,r,i);if(n.ai)e=n.drmInfos.length==1&&!n.drmInfos[0].keySystem,t=s.drmInfos.length==0,(n.drmInfos.length==0||e&&!t)&&(n.drmInfos=s.drmInfos),n.ai=!1;else if(s.drmInfos.length>0&&(n.drmInfos=n.drmInfos.filter(function(o){return s.drmInfos.some(function(u){return u.keySystem==o.keySystem})}),n.drmInfos.length==0))throw new H(2,4,4008);return s.Wh||n.Wh}function Rd(e){var t=Tr(e.node,"https://dashif.org/CPS","Laurl");if(t&&(t=Dt(t)))return t;if((t=Tr(e.node,"urn:microsoft:playready","pro"))&&Dt(t))return Md(t);if((e=Tr(e.node,"urn:mpeg:cenc:2013","pssh"))&&(e=Dt(e))){t=xr(e),e=8,t=Ln(t);var n=t.getUint8(e);return e+=20,n>0&&(e+=4+16*t.getUint32(e)),e=Le(t,e+4),e=Vl(e),e=ks("<pro>"+e+"</pro>"),Md(e)}return""}function m_(e,t,n,r,i){var s=[];n=x(n);for(var o=n.next();!o.done;o=n.next()){o=o.value;var u=r[o.Hd];if(u){var l;if((l=Tr(o.node,"urn:microsoft:playready","pro"))&&Dt(l)){l=Dt(l),l=xr(l);var f=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);l=[{initData:gc(l,f,new Set,0),initDataType:"cenc",keyId:o.keyId}]}else l=null;if(f=null,o.Hd==="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"){f=o;var g=i;if(g.size==0)f=null;else{var y=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),v=new Uint8Array([]);f=[{initData:gc(v,y,g,1),initDataType:"cenc",keyId:f.keyId}]}}l=mi(u,t,o.init||e||l||f),(u=T_.get(u))&&(l.licenseServerUri=u(o));e:{if((o=Tr(o.node,"https://dashif.org/CPS","Certurl"))&&(o=Dt(o)))break e;o=""}l.serverCertificateUri=o,s.push(l)}}return s}function y_(e,t){var n=[];t=x(t);for(var r=t.next();!r.done;r=t.next())(r=v_(e,r.value))&&n.push(r);return n}function v_(e,t){var n=t.attributes.schemeIdUri,r=yi(t,"urn:mpeg:cenc:2013","default_KID"),i=Rv(t,"urn:mpeg:cenc:2013","pssh").map(In),s=t.attributes.value;if(!n)return null;if(n=n.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase(),r.includes(" ")))throw new H(2,4,4009);var o=[];try{o=i.map(function(u){if(!e.g.has(u)){var l=xr(u);e.g.set(u,l)}return{initDataType:"cenc",initData:e.g.get(u),keyId:null}})}catch(u){throw new H(2,4,4007)}return{node:t,Hd:n,keyId:r,init:o.length>0?o:null,encryptionScheme:s}}function x_(e){if(!m.crypto||!m.crypto.subtle)throw Be("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new H(2,4,4042);var t=Tr(e.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!t)throw new H(2,4,4051);if(t.attributes.schemeIdUri!="urn:mpeg:dash:sea:aes128-cbc:2013")throw new H(2,4,4051);if(t=Tr(e.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!t)throw new H(2,4,4051);if(e=t.attributes.IV,t=En(t.attributes.keyUriTemplate),!e||!t)throw new H(2,4,4051);if(e=Es(e.substr(2)),e.byteLength!=16)throw new H(2,4,4048);return{tk:t,iv:e}}var T_=new Map().set("com.apple.fps",function(e){if(m.shakaMediaKeysPolyfill==="apple")throw new H(2,4,4054);return(e=Tr(e.node,"https://dashif.org/CPS","Laurl"))&&(e=Dt(e))?e:""}).set("com.widevine.alpha",function(e){var t=Tr(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Dt(t))?t:(e=Tr(e.node,"urn:microsoft","laurl"))&&En(e.attributes.licenseUrl)||""}).set("com.microsoft.playready",Rd).set("com.microsoft.playready.recommendation",Rd).set("com.microsoft.playready.software",Rd).set("com.microsoft.playready.hardware",Rd).set("org.w3.clearkey",function(e){var t=Tr(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Dt(t))?t:(e=Tr(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&e.attributes.Lic_type==="EME-1.0"&&e&&(e=Dt(e))?e:""});function Uu(e,t,n,r,i,s){var o=new Map().set("RepresentationID",t).set("Number",n).set("SubNumber",r).set("Bandwidth",i).set("Time",s);return e.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(u,l,f,g){if(u=="$$")return"$";var y=o.get(l);if(y==null)return u;switch(l=="RepresentationID"&&f&&(f=void 0),l=="Time"&&typeof y!="bigint"&&(Math.abs(y-Math.round(y))>=.2&&Be("Calculated $Time$ values must be close to integers"),y=Math.round(y)),g){case void 0:case"d":case"i":case"u":u=y.toString();break;case"o":u=y.toString(8);break;case"x":u=y.toString(16);break;case"X":u=y.toString(16).toUpperCase();break;default:u=y.toString()}return f=m.parseInt(f,10)||1,Array(Math.max(0,f-u.length)+1).join("0")+u})}function Z1(e,t){var n=Br(e,t,"timescale"),r=1;n&&(r=ri(n)||1),n=Br(e,t,"duration");var i=(n=ri(n||""))?n/r:null,s=Br(e,t,"startNumber"),o=Number(Br(e,t,"presentationTimeOffset"))||0,u=rn(s||"");if((s==null||u==null)&&(u=1),s=null,t=Ko(e,t,"SegmentTimeline")){t=it(t,"S"),s=r,e=e.na.duration||1/0;for(var l=u,f=[],g=-o,y=0;y<t.length;++y){var v=t[y],w=t[y+1],A=De(v,"t",rn),I=De(v,"d",rn),E=De(v,"r",nn);if(v=De(v,"k",nn)||0,A!=null&&(A-=o),I){if(A=A!=null?A:g,E=E||0,E<0)if(w){if(w=De(w,"t",rn),w==null)break;if(A>=w)break;E=Math.ceil((w-A)/I)-1}else{if(e==1/0)break;if(A/s>=e)break;E=Math.ceil((e*s-A)/I)-1}for(f.length>0&&A!=g&&(f[f.length-1].end=A/s),w=0;w<=E;++w)g=A+I,f.push({start:A/s,end:g/s,Hh:A,wc:v,Tk:f.length+l}),A=g}}s=f}return{timescale:r,Pf:n,gb:i,ue:u,Jb:o/r||0,gd:o,timeline:s}}function ew(e,t){return[t(e.L),t(e.qa),t(e.sa)].filter(Zi)}function Br(e,t,n){t=ew(e,t),e=null,t=x(t);for(var r=t.next();!r.done&&!(e=r.value.attributes[n]);r=t.next());return e}function Ko(e,t,n){t=ew(e,t),e=null,t=x(t);for(var r=t.next();!r.done&&!(e=gt(r.value,n));r=t.next());return e}function w_(e,t,n,r,i,s){for(var o=yi(e,"http://www.w3.org/1999/xlink","href"),u=yi(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=x(Object.keys(e.attributes)),f=l.next();!f.done;f=l.next()){f=f.value;var g=f.split(":"),y=Ch("http://www.w3.org/1999/xlink");g[0]==y&&delete e.attributes[f]}if(s>=5)return es(new H(2,4,4028));if(u!="onLoad")return es(new H(2,4,4027));var v=$t([r],[o]);return i.request(0,Nt(v,t)).Xa(function(w){if(w=Ba(w.data,e.tagName),!w)return es(new H(2,4,4001,o));for(e.children=[];w.children.length;){var A=w.children.shift();e.children.push(A)}A=x(Object.keys(w.attributes));for(var I=A.next();!I.done;I=A.next())I=I.value,e.attributes[I]=w.attributes[I];return kd(e,t,n,v[0],i,s+1)})}function kd(e,t,n,r,i,s){if(s=s===void 0?0:s,yi(e,"http://www.w3.org/1999/xlink","href")){var o=w_(e,t,n,r,i,s);return n&&(o=o.Xa(void 0,function(){return kd(e,t,n,r,i,s)})),o}o=[];for(var u=x(Mv(e)),l=u.next(),f={};!l.done;f={Sd:void 0},l=u.next())f.Sd=l.value,yi(f.Sd,"http://www.w3.org/1999/xlink","href")=="urn:mpeg:dash:resolve-to-zero:2013"?e.children=e.children.filter((function(g){return function(y){return y!==g.Sd}})(f)):f.Sd.tagName!="SegmentTimeline"&&o.push(kd(f.Sd,t,n,r,i,s));return l0(o).Xa(function(){return e})}function S_(e,t,n,r,i,s,o){var u,l=new ut().S("sidx",function(f){u=A_(t,r,i,s,o,n,f)});if(e&&l.parse(e),u)return u;throw new H(2,3,3004)}function A_(e,t,n,r,i,s,o){var u=[];o.reader.skip(4);var l=o.reader.U();if(l==0)throw new H(2,3,3005);if(o.version==0)var f=o.reader.U(),g=o.reader.U();else f=o.reader.Ed(),g=o.reader.Ed();o.reader.skip(2);var y=o.reader.Ca();for(e=e+o.size+g,g=0;g<y;g++){var v=o.reader.U(),w=(v&2147483648)>>>31;v&=2147483647;var A=o.reader.U();if(o.reader.skip(4),w==1)throw new H(2,3,3006);u.push(new Ce(f/l+n,(f+A)/l+n,function(){return s},e,e+v-1,t,n,r,i)),f+=A,e+=v}return o.parser.stop(),u}function ds(e){this.h=Ln(e),this.g=new pt(this.h,0)}ds.prototype.Ia=function(){return this.g.Ia()};function Oi(e){var t=tw(e);if(t.length>7)throw new H(2,3,3002);var n=0;t=x(t);for(var r=t.next();!r.done;r=t.next())n=256*n+r.value;t=tw(e);e:{r=x(E_);for(var i=r.next();!i.done;i=r.next())if(hi(t,new Uint8Array(i.value))){r=!0;break e}r=!1}if(r)t=e.h.byteLength-e.g.Pa();else{if(t.length==8&&t[1]&224)throw new H(2,3,3001);for(i=r=0;i<t.length;i++){var s=t[i];r=i==0?s&(1<<8-t.length)-1:256*r+s}t=r}return t=e.g.Pa()+t<=e.h.byteLength?t:e.h.byteLength-e.g.Pa(),r=Ln(e.h,e.g.Pa(),t),e.g.skip(t),new I_(n,r)}function tw(e){var t=e.g.Pa(),n=e.g.Y();if(n==0)throw new H(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Le(e.h,t,n)}var E_=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function I_(e,t){this.id=e,this.g=t}function bg(e){if(e.g.byteLength>8)throw new H(2,3,3002);if(e.g.byteLength==8&&e.g.getUint8(0)&224)throw new H(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){var r=e.g.getUint8(n);t=256*t+r}return t}function C_(e,t,n,r,i,s,o,u,l){function f(){return i}var g=[];e=new ds(e.g);for(var y=null,v=null;e.Ia();){var w=Oi(e);if(w.id==187){var A=M_(w);A&&(w=n*A.kl,A=t+A.Lk,y!=null&&g.push(new Ce(y+o,w+o,f,v,A-1,s,o,u,l)),y=w,v=A)}}return y!=null&&g.push(new Ce(y+o,r+o,f,v,null,s,o,u,l)),g}function M_(e){var t=new ds(e.g);if(e=Oi(t),e.id!=179)throw new H(2,3,3013);if(e=bg(e),t=Oi(t),t.id!=183)throw new H(2,3,3012);t=new ds(t.g);for(var n=0;t.Ia();){var r=Oi(t);if(r.id==241){n=bg(r);break}}return{kl:e,Lk:n}}function nw(e,t,n){if(t=Ko(e,t,"Initialization"),!t)return null;var r=e.L.cb(),i=t.attributes.sourceURL;i&&(r=$t(r,[En(i)],e.Mb())),i=0;var s=null;return(t=De(t,"range",Wl))&&(i=t.start,s=t.end),n=new On(function(){return r},i,s,ow(e),null,null,n,e.qa.encrypted),n.codecs=e.L.codecs,n.mimeType=e.L.mimeType,e.na&&!e.na.jf&&(n.g=e.na.start+e.na.duration),n}function R_(e,t,n){var r=Number(Br(e,$o,"presentationTimeOffset"))||0,i=Br(e,$o,"timescale"),s=1;i&&(s=ri(i)||1);var o=r/s||0,u=nw(e,$o,n);k_(e,u);var l=Yi(e);return{endTime:-1,timeline:-1,Sc:function(){var f=Ko(l,$o,"RepresentationIndex"),g=l.L.cb();return f&&(f=En(f.attributes.sourceURL))&&(g=$t(g,[f],l.Mb())),f=iw(l),rw(l,t,u,g,f.start,f.end,o)},timescale:s}}function rw(e,t,n,r,i,s,o){var u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N;return F(function(z){if(z.g==1)return u=e.presentationTimeline,l=!e.Fb||!e.na.jf,f=e.na.start,g=e.na.duration,y=e.L.mimeType.split("/")[1],v=t,w=null,A=[v(r,i,s,!1),y=="webm"?v(n.P(),n.startByte,n.endByte,!0):null],v=null,C(z,Promise.all(A),2);if(I=z.h,E=I[0],R=I[1]||null,M=null,D=f-o,O=f,X=g?f+g:1/0,y=="mp4")var B=S_(E,i,r,n,D,O,X);else{B=E;var W=new ds(R);if(Oi(W).id!=440786851)throw new H(2,3,3008);var G=Oi(W);if(G.id!=408125543)throw new H(2,3,3009);W=G.g.byteOffset,G=new ds(G.g);for(var re=null;G.Ia();){var ne=Oi(G);if(ne.id==357149030){re=ne;break}}if(!re)throw new H(2,3,3010);for(re=new ds(re.g),ne=1e6,G=null;re.Ia();){var $=Oi(re);if($.id==2807729)ne=bg($);else if($.id==17545)if($.g.byteLength==4)G=$.g.getFloat32(0);else if($.g.byteLength==8)G=$.g.getFloat64(0);else throw new H(2,3,3003)}if(G==null)throw new H(2,3,3011);if(re=ne/1e9,G*=re,B=Oi(new ds(B)),B.id!=475249515)throw new H(2,3,3007);B=C_(B,W,re,G,r,n,D,O,X)}for(M=B,b=x(M),U=b.next();!U.done;U=b.next())N=U.value,N.codecs=e.L.codecs,N.mimeType=e.L.mimeType,N.bandwidth=e.bandwidth;return u.le(M),w=new Qe(M),l&&w.pd(O,X,!0),z.return(w)})}function $o(e){return e.Id}function iw(e){var t=Ko(e,$o,"RepresentationIndex");return e=Br(e,$o,"indexRange"),e=Wl(e||""),t&&(e=De(t,"range",Wl,e)),e}function k_(e,t){if(sw(e,t),!iw(e))throw new H(2,4,4002)}function sw(e,t){var n=e.L.mimeType.split("/")[1];if(e.L.contentType!=Fe&&n!="mp4"&&n!="webm")throw new H(2,4,4006);if(n=="webm"&&!t)throw new H(2,4,4005)}function ow(e){var t=e.L;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.xf,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.qa.label||null,roles:e.roles||null,language:e.qa.language||null}}function __(e,t,n){var r=nw(e,aw,n),i=P_(e);if(!i.gb&&!i.timeline&&i.yd.length>1)throw new H(2,4,4002);if(!i.gb&&!e.na.duration&&!i.timeline&&i.yd.length==1)throw new H(2,4,4002);if(i.timeline&&i.timeline.length==0)throw new H(2,4,4002);var s=null,o=null;e.sa.id&&e.L.id&&(o=t.get(e.sa.id+","+e.L.id))&&(s=o.segmentIndex);var u=D_(e.na.start,e.na.duration,e.L.cb,i,r,n,e.L.mimeType,e.L.codecs,e.bandwidth,e.Mb);return t=!s,s?s.je(u,e.presentationTimeline.Ib()):s=new Qe(u),e.presentationTimeline.le(u),e.Fb&&e.na.jf||s.pd(e.na.start,e.na.duration?e.na.start+e.na.duration:1/0,t),o&&(o.segmentIndex=s),{endTime:-1,timeline:-1,Sc:function(){return s&&s.getNumReferences()!=0||s.rf(u),Promise.resolve(s)},timescale:i.timescale}}function aw(e){return e.Ac}function P_(e){var t=L_(e);e=Z1(e,aw);var n=e.ue;n==0&&(n=1);var r=0;return e.gb?r=e.gb*(n-1):e.timeline&&e.timeline.length>0&&(r=e.timeline[0].start),{gb:e.gb,startTime:r,ue:n,Jb:e.Jb,timescale:e.timescale,timeline:e.timeline,yd:t}}function D_(e,t,n,r,i,s,o,u,l,f){var g=r.yd.length;r.timeline&&r.timeline.length!=r.yd.length&&(g=Math.min(r.timeline.length,r.yd.length));for(var y=e-r.Jb,v=t?e+t:1/0,w=[],A=r.startTime,I={},E=0;E<g;I={Rf:void 0,Gf:void 0},E++){I.Gf=r.yd[E];var R=A;A=void 0,A=r.gb!=null?R+r.gb:r.timeline?r.timeline[E].end:R+t,I.Rf=null,I=new Ce(e+R,e+A,(function(M){return function(){return M.Rf==null&&(M.Rf=$t(n(),[M.Gf.Ak],f())),M.Rf}})(I),I.Gf.start,I.Gf.end,i,y,e,v,[],"",null,null,Ci,s),I.codecs=u,I.mimeType=o,I.bandwidth=l,w.push(I)}return w}function L_(e){return[e.L.Ac,e.qa.Ac,e.sa.Ac].filter(Zi).map(function(t){return it(t,"SegmentURL")}).reduce(function(t,n){return t.length>0?t:n}).map(function(t){t.attributes.indexRange&&!e.Ng&&(e.Ng=!0);var n=En(t.attributes.media);return t=De(t,"mediaRange",Wl,{start:0,end:null}),{Ak:n,start:t.start,end:t.end}})}function uw(e,t,n,r,i,s,o,u,l,f){l||e.L.gf||(e.L.gf=Br(e,fs,"initialization"));var g=e.L.gf?U_(e,o):null,y=b_(e);N_(y);var v=Yi(e);if(y.ee)return sw(e,g),{endTime:-1,timeline:-1,Sc:function(){var R=Uu(y.ee,v.L.originalId,null,null,v.bandwidth||null,null);return R=$t(v.L.cb(),[R]),rw(v,t,g,R,0,null,y.Jb)},timescale:y.timescale};if(y.gb)return r||e.qa.contentType==="image"||e.qa.contentType==="text"||(r=e.na.start,f=e.sa.id,n=e.na.duration,f=(f=f!=null&&s.get(f)||n)?r+f:1/0,e.presentationTimeline.Vg(y.gb),e.presentationTimeline.Ei(r,f)),{endTime:-1,timeline:-1,Sc:function(){return O_(v,y,i,g,s,o,u,e.L.Hf)},timescale:y.timescale};var w=null;r=r=null,e.sa.id&&e.L.id&&(r=e.sa.id+","+e.L.id,r=n.get(r))&&(w=r.segmentIndex);var A=e.na.start,I=e.na.duration?A+e.na.duration:1/0;if(w)f=w,lw(f,y,A,I,g,e.Fb),f.Ya(e.presentationTimeline.Ib());else{if(n=0,l=-1,e.sa.id!=null&&e.L.id!=null){var E=f.get(e.sa.id);if(E)l=E.timeline;else for(f=x(f.values()),E=f.next();!E.done;E=f.next())if(E=E.value,Math.abs(y.Jb-E.endTime)<=xv&&E.fh.includes(e.L.id)){l=E.timeline;break}else E.timeline>=n&&(n=E.timeline+1)}l==-1&&(l=n),w=new ju(e.Fb,y,e.L.originalId,e.bandwidth,e.L.cb,e.Mb,A,I,g,o,e.L.Hf,l)}return y.timeline&&e.qa.contentType!=="image"&&e.qa.contentType!=="text"&&e.presentationTimeline.Fi(w.h?w.h.timeline:[],A),r&&e.Fb&&(r.segmentIndex=w),r=(r=(r=y.timeline)&&r[r.length-1])?r.end+y.Jb:-1,f=-1,w instanceof ju&&(f=w.Ve()),{endTime:r,timeline:f,Sc:function(){return w instanceof ju&&w.getNumReferences()==0&&lw(w,y,A,I,g,e.Fb),Promise.resolve(w)},timescale:y.timescale}}function fs(e){return e.Oc}function b_(e){var t=Z1(e,fs),n=Br(e,fs,"media"),r=Br(e,fs,"index"),i=Br(e,fs,"k"),s=0;return i&&(s=parseInt(i,10)),{Pf:t.Pf,gb:t.gb,timescale:t.timescale,ue:t.ue,Jb:t.Jb,gd:t.gd,timeline:t.timeline,cc:n&&En(n),ee:r,mimeType:e.L.mimeType,codecs:e.L.codecs,bandwidth:e.bandwidth,Bk:s}}function N_(e){var t=e.ee?1:0;if(t+=e.timeline?1:0,t+=e.gb?1:0,t==0)throw new H(2,4,4002);if(t!=1&&(e.ee&&(e.timeline=null),e.Pf=null,e.gb=null),!e.ee&&!e.cc)throw new H(2,4,4002)}function O_(e,t,n,r,i,s,o,u){function l(G){var re=G-E,ne=re*I,$=t.Pf,Q=re*$;"BigInt"in m&&Q>Number.MAX_SAFE_INTEGER&&(Q=BigInt(re)*BigInt($)),ne+=v,re=ne+I,$=Math.min(re,g());var ae=[],le=t.Bk;if(le)for(var be=($-ne)/le,xe={},Ze=0;Ze<le;xe={$i:void 0},Ze++){var Ne=ne+be*Ze,st=Ne+be;xe.$i=Ze,xe=new Ce(Ne,st,(function(ze){return function(){var He=Uu(R,D,G,ze.$i,M,Q);return $t(O(),[He],X())}})(xe),0,null,r,b,v,g(),[],"",null,null,Ci,s),xe.codecs=e.L.codecs,xe.mimeType=e.L.mimeType,u==0?Ze>0&&xe.wd():Ze%u!=0&&xe.wd(),ae.push(xe)}return ne=new Ce(ne,$,function(){if(le)return[];var ze=Uu(R,D,G,null,M,Q);return $t(O(),[ze],X())},0,null,r,b,v,g(),ae,"",null,null,Ci,s,ae.length>0),ne.codecs=e.L.codecs,ne.mimeType=e.L.mimeType,ne.bandwidth=e.bandwidth,ne.j=re,ne}function f(){var G=[Math.max(y.Ib(),v),Math.min(y.Ic(),g())].map(function(re){return re-v});return G=[Math.ceil(G[0]/I),Math.ceil(G[1]/I)-1],e.L.rb&&G[1]++,G.map(function(re){return re+E})}function g(){var G=w!=null&&i.get(w)||A;return G?v+G:1/0}var y=e.presentationTimeline,v=e.na.start,w=e.sa.id,A=e.na.duration,I=t.gb,E=t.ue,R=t.cc,M=e.bandwidth||null,D=e.L.originalId,O=e.L.cb,X=e.Mb,b=v-t.Jb,U=f();n=e.Fb?Math.max(U[0],U[1]-n+1):U[0],o=o||U[1],U=[];for(var N=n;N<=o;++N){var z=l(N);U.push(z)}var B=new Qe(U);if(U=y.Ic()<g(),N=y.W(),U||N){var W=Math.max(n,o+1);n=I,e.L.rb&&(n=.1),B.Qf(n,function(){var G=y.Ib();B.Ya(G);var re=x(f());re.next(),re=re.next().value;for(var ne=[];W<=re;){var $=l(W);ne.push($),W++}return G>g()&&!ne.length?null:ne})}return Promise.resolve(B)}function U_(e,t){var n=e.L.gf;if(n||(n=Br(e,fs,"initialization")),!n)return null;n=En(n);var r=e.L.originalId,i=e.bandwidth||null,s=e.L.cb,o=e.Mb;return t=new On(function(){var u=Uu(n,r,null,null,i,null);return $t(s(),[u],o())},0,null,ow(e),null,null,t,e.qa.encrypted),t.codecs=e.L.codecs,t.mimeType=e.L.mimeType,e.na&&!e.na.jf&&(t.g=e.na.start+e.na.duration),t}function ju(e,t,n,r,i,s,o,u,l,f,g,y){Qe.call(this,[]),this.F=e,this.h=t,this.H=n,this.C=r,this.G=i,this.J=s,this.j=o,this.l=u,this.u=l,this.B=f,this.I=g,this.K=y,Ng(this)}J(ju,Qe),p=ju.prototype,p.getNumReferences=function(){return this.h?this.h.timeline.length:0},p.release=function(){Qe.prototype.release.call(this),this.h=null},p.Ya=function(e){if(this.h){for(var t=0,n=this.h.timeline,r=0;r<n.length&&n[r].end+this.j<=e;r+=1)t+=1;t>0&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.i+=t,this.getNumReferences()===0&&this.release())}};function lw(e,t,n,r,i,s){if(j_(e,i),e.F=s,e.h){if(e.h.gd!==t.gd&&(e.h.timeline=t.timeline,e.h.gd=t.gd,e.h.Jb=t.Jb),e.h.cc!==t.cc&&(e.h.cc=t.cc),n=e.h.timeline,n.length){var o=n[n.length-1];t=t.timeline.filter(function(u){return u.end>o.end})}else t=t.timeline.slice();t.length>0&&e.h.timeline.push.apply(e.h.timeline,Y(t)),e.l!==r&&(e.l=r)}else e.h=t,e.j=n,e.l=r;Ng(e)}function j_(e,t){if(e.u!==t){e.u=t,e=x(e.g);for(var n=e.next();!n.done;n=e.next())(n=n.value)&&z0(n,t)}}function Ng(e){if(e.h&&!e.o){for(var t=[],n=x(e.h.timeline),r=n.next();!r.done;r=n.next())r=r.value,r.start>=e.l||r.end<=0||t.push(r);e.h.timeline=t,e.Ya(e.j)}}p.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var t=this.h.timeline;if(e<this.j||e>=this.l)return null;for(var n=t.length-1,r=0;r<t.length;r++){var i=t[r],s=i.start+this.j;if(i=r<n?t[r+1].start+this.j:this.l===1/0?i.end+this.j:this.l,e>=s&&e<i)return r+this.i}return null},p.get=function(e){var t=this;if(e-=this.i,e<0||e>=this.getNumReferences()||!this.h)return null;var n=this.g[e];if(!n){n=this.h.timeline[e];var r=n.Tk,i=n.Hh+this.h.gd,s=this.j-this.h.Jb,o=this.j+n.end,u=o;e===this.getNumReferences()-1&&this.l!==1/0&&(u=this.F&&Math.abs(u-this.l)>.1?Math.min(u,this.l):this.l);var l=this.h.codecs,f=this.h.mimeType,g=this.h.bandwidth,y=[],v=!1;if(n.wc&&this.h&&this.h.cc&&(v=this.h.cc.includes("$SubNumber$")),v){v=(n.end-n.start)/n.wc;for(var w={},A=0;A<n.wc;w={Sf:void 0,aj:void 0},A++){var I=n.start+v*A,E=I+v;w.aj=A,w.Sf=null,w=new Ce(this.j+I,this.j+E,(function(R){return function(){return t.h?(R.Sf==null&&(R.Sf=cw(t.h.cc,t.H,r,t.C,i,R.aj,t.G,t.J)),R.Sf):[]}})(w),0,null,this.u,s,this.j,this.l,[],"",null,null,Ci,this.B),w.codecs=l,w.mimeType=f,w.bandwidth=g,this.I==0?A>0&&w.wd():A%this.I!=0&&w.wd(),y.push(w)}}n=new Ce(this.j+n.start,u,function(){return y.length>0||!t.h?[]:cw(t.h.cc,t.H,r,t.C,i,null,t.G,t.J)},0,null,this.u,s,this.j,this.l,y,"",null,null,Ci,this.B,y.length>0),n.codecs=l,n.mimeType=f,n.j=o,n.bandwidth=g,this.g[e]=n}return n},p.Gb=function(e){Ng(this);for(var t=0;t<this.getNumReferences();t++){var n=this.get(t+this.i);n&&e(n)}};function cw(e,t,n,r,i,s,o,u){return e=Uu(e,t,n,s,r||null,i),$t(o(),[e],u()).map(function(l){return l.toString()})}p.Ve=function(){return this.K};function Yo(e){this.o=null,this.B=e,this.H=new xo,this.i=[],this.h=null,this.m=[],this.C=null,this.G=[],this.F=300,this.l=new Map,this.j=new Map,this.g=null,this.u="UNKNOWN"}Yo.prototype.configure=function(e){this.o=e},Yo.prototype.destroy=function(){return this.B=this.o=null,this.i=[],this.h=null,this.m=[],this.G=[],this.l.clear(),this.g!=null&&(this.g.stop(),this.g=null),this.H.destroy()},Yo.prototype.setManifestType=function(e){this.u=e};function Bu(e,t){var n,r,i,s,o,u,l;return F(function(f){if(f.g==1)return n=$t(e.i,[B_(e,t)]),r=Nt(n,e.o.retryParameters),i=e.B.networkingEngine.request(8,r),Ns(e.H,i),Z(f,2),C(f,i.promise,4);if(f.g!=2)return s=f.h,o=wt(s.data),u=JSON.parse(o),u.VERSION==1&&F_(e,u,s.uri),ce(f,0);if((l=se(f))&&l.code==7001)return f.return();e.g!=null&&(e.g.stop(),e.g=null),e.g=new Ve(function(){Bu(e,t)}),e.g.ka(e.F),ie(f)})}function B_(e,t){if(!e.m.length)return t;t=new Pt(t);var n=e.C||e.m[0],r=Math.round(e.B.getBandwidthEstimate()),i=t.g;return e.u=="DASH"?(i.add("_DASH_pathway",n),i.add("_DASH_throughput",String(r))):e.u=="HLS"&&(i.add("_HLS_pathway",n),i.add("_HLS_throughput",String(r))),hv(i)&&Ss(t,i),t.toString()}function F_(e,t,n){e.g!=null&&(e.g.stop(),e.g=null);var r=t["RELOAD-URI"]||n;e.g=new Ve(function(){Bu(e,r)}),(n=t.TTL)&&(e.F=n),e.g.ka(e.F),e.m=t["PATHWAY-PRIORITY"]||[],e.G=t["PATHWAY-CLONES"]||[]}function qo(e,t,n,r){var i=e.l.get(t);i||(i=new Map),i.set(n,r),e.l.set(t,i)}Yo.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)};function Fu(e,t,n){n=n===void 0?!1:n,t=e.l.get(t)||new Map;for(var r=[],i=x(e.m),s=i.next(),o={};!s.done;o={Cd:void 0},s=i.next())if(o.Cd=s.value,s=t.get(o.Cd))r.push({$g:o.Cd,location:s});else if(s=e.G.find((function(l){return function(f){return f.Ml==l.Cd}})(o))){var u=t.get(s["BASE-ID"]);u&&(s["URI-REPLACEMENT"].mj?(u=new Pt(u),Ul(u,s["URI-REPLACEMENT"].mj),r.push({$g:o.Cd,location:u.toString()})):r.push({$g:o.Cd,location:u}))}for(i=Date.now(),o=x(e.j.keys()),s=o.next();!s.done;s=o.next())s=s.value,u=e.j.get(s),i>u&&e.j.delete(s);if(r=r.filter(function(l){for(var f=x(e.j.keys()),g=f.next();!g.done;g=f.next())if(g.value.includes(new Pt(l.location).Eb))return!1;return!0}),r.length&&(e.C=r[0].$g),r=r.map(function(l){return l.location}),!r.length&&e.h)for(i=x(e.h.split(",")),o=i.next();!o.done;o=i.next())(o=t.get(o.value))&&(e.C=e.h,r.push(o));if(!r.length)for(t=x(t.values()),i=t.next();!i.done;i=t.next())r.push(i.value);return n?r:$t(e.i,r)}function jn(){this.l=[],this.h=[],this.g=[],this.j=[],this.i=[],this.o=!1,this.m=new Set}p=jn.prototype,p.release=function(){for(var e=x(this.h.concat(this.g,this.j,this.i)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.j=[],this.i=[],this.l=[],this.o=!1,this.m.clear()},p.dk=function(){return this.l},p.Lg=function(){return this.j.slice()},p.Kj=function(){return this.i},p.Xh=function(e,t){if(e){if(e.type=="audio")for(var n=x(this.h),r=n.next();!r.done;r=n.next())r=r.value,r.matchedStreams=r.matchedStreams.filter(function(i){return i!==e});else if(e.type=="video")for(n=x(this.g),r=n.next();!r.done;r=n.next())r=r.value,r.matchedStreams=r.matchedStreams.filter(function(i){return i!==e}),r.trickModeVideo&&(r.trickModeVideo.matchedStreams=r.trickModeVideo.matchedStreams.filter(function(i){return i!==e})),r.dependencyStream&&(r.dependencyStream.matchedStreams=r.dependencyStream.matchedStreams.filter(function(i){return i!==e}));else if(e.type==Fe)for(n=x(this.j),r=n.next();!r.done;r=n.next())r=r.value,r.matchedStreams=r.matchedStreams.filter(function(i){return i!==e});else if(e.type=="image")for(n=x(this.i),r=n.next();!r.done;r=n.next())r=r.value,r.matchedStreams=r.matchedStreams.filter(function(i){return i!==e});e.segmentIndex&&e.closeSegmentIndex(),this.m.delete(t)}};function dw(e,t){var n=[],r=[],i=[],s=[];e=x(e);for(var o=e.next();!o.done;o=e.next()){var u=o.value;o=new Map(u.audioStreams.map(function(y){return[Bg(y),y]}));var l=new Map(u.videoStreams.map(function(y){return[jg(y),y]})),f=new Map(u.textStreams.map(function(y){return[Hu(y),y]}));if(u=new Map(u.imageStreams.map(function(y){return[Gu(y),y]})),t){var g=vw(Fe);f.set(Hu(g),g),g=vw("image"),u.set(Gu(g),g)}n.push(o),r.push(l),i.push(f),s.push(u)}return{Qh:n,kj:r,fj:i,ni:s}}p.kg=function(e,t,n){n=n===void 0?!1:n;var r=this,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be;return F(function(xe){if(xe.g==1){if(i=bt,!t&&e.length==1)return s=dw(e,!1),o=s.Qh,u=s.kj,l=s.fj,f=s.ni,r.h=Array.from(o[0].values()),r.g=Array.from(u[0].values()),r.j=Array.from(l[0].values()),r.i=Array.from(f[0].values()),xe.A(2);for(g=n?r.m.size:0,y=-1,v=0;v<e.length;v++)w=e[v],r.m.has(w.id)||(r.m.add(w.id),y==-1&&(y=v));return y==-1?xe.return():(A=dw(e,!0),I=A.Qh,E=A.kj,R=A.fj,M=A.ni,C(xe,Promise.all([hs(r,r.h,I,y,Qo,ps,g),hs(r,r.g,E,y,Qo,ps,g),hs(r,r.j,R,y,Qo,ps,g),hs(r,r.i,M,y,Qo,ps,g)]),2))}if(D=0,O=[],r.g.length&&r.h.length)for(W=x(r.h),G=W.next();!G.done;G=W.next())for(re=G.value,ne=x(r.g),$=ne.next();!$.done;$=ne.next())Q=$.value,ae=mv(re.drmInfos,Q.drmInfos),re.drmInfos.length&&Q.drmInfos.length&&!ae.length||(le=(re.bandwidth||0)+(Q.bandwidth||0),re.dependencyStream&&(le+=re.dependencyStream.bandwidth||0),Q.dependencyStream&&(le+=Q.dependencyStream.bandwidth||0),be=D++,O.push({id:be,language:re.language,disabledUntilTime:0,primary:re.primary,audio:re,video:Q,bandwidth:le,drmInfos:ae,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(X=r.g.length?r.g:r.h,b=x(X),U=b.next();!U.done;U=b.next())N=U.value,z=D++,B=N.bandwidth||0,N.dependencyStream&&(B+=N.dependencyStream.bandwidth||0),O.push({id:z,language:N.language,disabledUntilTime:0,primary:N.primary,audio:N.type==i.aa?N:null,video:N.type==i.wa?N:null,bandwidth:B,drmInfos:N.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});r.l=O,ie(xe)})};function fw(e){var t,n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne;return F(function($){switch($.g){case 1:if(t=bt,e.length==1)return $.return(e[0]);for(n=e.map(function(Q){return new Map(Q.filter(function(ae){return ae.type===t.aa}).map(function(ae){return[Bg(ae),ae]}))}),r=e.map(function(Q){return new Map(Q.filter(function(ae){return ae.type===t.wa}).map(function(ae){return[jg(ae),ae]}))}),i=e.map(function(Q){return new Map(Q.filter(function(ae){return ae.type===t.Na}).map(function(ae){return[Hu(ae),ae]}))}),s=e.map(function(Q){return new Map(Q.filter(function(ae){return ae.type===t.Xf}).map(function(ae){return[Gu(ae),ae]}))}),o=x(i),u=o.next();!u.done;u=o.next())l=u.value,f=yw(t.Na),l.set(Hu(f),f);for(g=x(s),y=g.next();!y.done;y=g.next())v=y.value,w=yw(t.Xf),v.set(Gu(w),w);return A=new jn,C($,hs(A,[],n,0,_d,Pd,0),2);case 2:return I=$.h,C($,hs(A,[],r,0,_d,Pd,0),3);case 3:return E=$.h,C($,hs(A,[],i,0,_d,Pd,0),4);case 4:return R=$.h,C($,hs(A,[],s,0,_d,Pd,0),5);case 5:if(M=$.h,D=0,E.length&&I.length)for(N=x(I),z=N.next();!z.done;z=N.next())for(B=z.value,W=x(E),G=W.next();!G.done;G=W.next())re=G.value,ne=D++,re.variantIds.push(ne),B.variantIds.push(ne);else for(O=E.concat(I),X=x(O),b=X.next();!b.done;b=X.next())U=b.value,U.variantIds=[D++];return $.return(E.concat(I).concat(R).concat(M))}})}function hs(e,t,n,r,i,s,o){var u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z;return F(function(B){switch(B.g){case 1:for(u=[],l=0;l<n.length;l++)l>=r?u.push(new Set(n[l].values())):u.push(new Set);f=x(t),g=f.next();case 2:if(g.done){B.A(4);break}return y=g.value,C(B,V_(e,y,n,r,s,u,o),5);case 5:if(v=B.h,!v)throw new H(2,4,4037);g=f.next(),B.A(2);break;case 4:for(w=x(u),A=w.next();!A.done;A=w.next())for(I=A.value,E=x(I),R=E.next();!R.done;R=E.next())M=R.value,(D=H_(e,t,M,n,i,s,u))&&t.push(D);for(O=x(u),X=O.next();!X.done;X=O.next())for(b=X.value,U=x(b),N=U.next(),z={};!N.done;z={xh:void 0},N=U.next())if(z.xh=N.value,!Ug(z.xh)&&t.some((function(W){return function(G){return Og(W.xh,G)}})(z)))throw new H(2,4,4037);return B.return(t)}})}function V_(e,t,n,r,i,s,o){return F(function(u){return u.g==1?(gw(e,n,t,o>0),t.matchedStreams?t.segmentIndex?C(u,hw(t,r+o),2):u.A(2):u.return(!1)):(pw(t,r,i,s,o),u.return(!0))})}function hw(e,t){var n,r,i,s,o,u;return F(function(l){if(l.g==1){for(n=[],r=e.matchedStreams,i=t;i<r.length;i++)s=r[i],n.push(s.createSegmentIndex()),s.trickModeVideo&&!s.trickModeVideo.segmentIndex&&n.push(s.trickModeVideo.createSegmentIndex()),s.dependencyStream&&!s.dependencyStream.segmentIndex&&n.push(s.dependencyStream.createSegmentIndex());return C(l,Promise.all(n),2)}if(e.segmentIndex instanceof Et)for(o=t;o<r.length;o++)u=r[o],u.segmentIndex&&e.segmentIndex.h.push(u.segmentIndex);ie(l)})}function H_(e,t,n,r,i,s,o){if(Ug(n))return null;var u=i(n);return gw(e,r,u),u.createSegmentIndex&&(u.createSegmentIndex=function(){return F(function(l){return u.segmentIndex?l.A(0):(u.segmentIndex=new Et,C(l,hw(u,0),0))})},u.closeSegmentIndex=function(){if(u.segmentIndex&&(u.segmentIndex.release(),u.segmentIndex=null),u.matchedStreams)for(var l=x(u.matchedStreams),f=l.next();!f.done;f=l.next()){f=f.value;var g;if(g=f.segmentIndex){e:{g=x(t);for(var y=g.next();!y.done;y=g.next())if(y=y.value,y!==u&&y.segmentIndex&&y.matchedStreams&&y.matchedStreams.includes(f)){g=!0;break e}g=!1}g=!g}g&&(f.segmentIndex.release(),f.segmentIndex=null)}}),!u.matchedStreams||!u.matchedStreams.length?null:(pw(u,0,s,o,0),u)}function pw(e,t,n,r,i){var s=e.matchedStreams;for(t+=i;t<s.length;t++){var o=s[t];n(e,o);var u=!0;if(e.type=="audio"&&Ds(e.language,o.language)==0&&(u=!1),u&&((u=r[t-i])&&u.delete(o),o.fullMimeTypes))for(o=x(o.fullMimeTypes.values()),u=o.next();!u.done;u=o.next())e.fullMimeTypes.add(u.value)}}function Qo(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t.dependencyStream=null,t}function _d(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t}function ps(e,t){function n(o,u){o||(o=[]),u=x(u);for(var l=u.next();!l.done;l=u.next())l=l.value,o.includes(l)||o.push(l);return o}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var r=x(t.keyIds),i=r.next();!i.done;i=r.next())e.keyIds.add(i.value);if(e.originalId==null?e.originalId=t.originalId:(r=t.originalId||"")&&!e.originalId.endsWith(r)&&(e.originalId+=","+r),r=mv(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!r.length)throw new H(2,4,4038);if(e.drmInfos=r,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=x(t.closedCaptions),i=r.next();!i.done;i=r.next()){var s=x(i.value);i=s.next().value,s=s.next().value,e.closedCaptions.set(i,s)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=Qo(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();for(var o=new Et,u=x(e.trickModeVideo.matchedStreams),l=u.next();!l.done;l=u.next())o.h.push(l.value.segmentIndex);return e.trickModeVideo.segmentIndex=o,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),ps(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),ps(e.trickModeVideo,t)),t.dependencyStream?(e.dependencyStream||(e.dependencyStream=Qo(t.dependencyStream),e.dependencyStream.matchedStreams=[],e.dependencyStream.createSegmentIndex=function(){if(e.dependencyStream.segmentIndex)return Promise.resolve();for(var o=new Et,u=x(e.dependencyStream.matchedStreams),l=u.next();!l.done;l=u.next())o.h.push(l.value.segmentIndex);return e.dependencyStream.segmentIndex=o,Promise.resolve()}),e.dependencyStream.matchedStreams.push(t.dependencyStream),ps(e.dependencyStream,t.dependencyStream)):e.dependencyStream&&(e.dependencyStream.matchedStreams.push(t),ps(e.dependencyStream,t))}function Pd(e,t){var n=e.roles;n||(n=[]);for(var r=x(t.roles),i=r.next();!i.done;i=r.next())i=i.value,n.includes(i)||n.push(i);for(e.roles=n,n=x(t.keyIds),r=n.next();!r.done;r=n.next())e.keyIds.add(r.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,Y(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),t=x(t.closedCaptions),n=t.next();!n.done;n=t.next())r=x(n.value),n=r.next().value,r=r.next().value,e.closedCaptions.set(n,r)}function gw(e,t,n,r){r=r!==void 0&&r?n.matchedStreams:[],t=x(t);for(var i=t.next();!i.done;i=t.next()){if(i=G_(e,i.value,n),!i)return;r.push(i)}n.matchedStreams=r}function G_(e,t,n){var r={audio:Bg,video:jg,text:Hu,image:Gu}[n.type],i=null,s=r(n);if(t.has(s))i=t.get(s);else{s={audio:function(f,g){return Og(f,g)},video:function(f,g){return Og(f,g)},text:X_,image:z_}[n.type];for(var o={audio:W_,video:K_,text:$_,image:Y_}[n.type],u=x(t.values()),l=u.next();!l.done;l=u.next())l=l.value,!s(n,l)||n.fastSwitching!=l.fastSwitching||i&&!o(n,i,l)||(i=l)}return e.o&&!Ug(i)&&t.delete(r(i)),i}function mw(e,t){return e.mimeType!=t.mimeType?!1:ww(e.codecs)===ww(t.codecs)}p.Vi=function(e){this.o=e};function Og(e,t){return!(e.drmInfos&&!gv(e.drmInfos,t.drmInfos))}function X_(e,t){return t.language?!(e.forced!==t.forced||Ds(e.language,t.language)==0||t.kind!=e.kind):!0}function z_(){return!0}function W_(e,t,n){var r=xw(e,t,n);if(r===Jn)return!0;if(r===Ir)return!1;r=Ds(e.language,t.language);var i=Ds(e.language,n.language);if(i>r)return!0;if(i<r)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(r=t.roles.filter(function(s){return e.roles.includes(s)}),i=n.roles.filter(function(s){return e.roles.includes(s)}),i.length>r.length)return!0;if(i.length<r.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!t.primary&&n.primary?!0:t.primary&&!n.primary?!1:(r=Vu(e.channelsCount,t.channelsCount,n.channelsCount),r==Jn?!0:r==Ir?!1:(r=Vu(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate),r==Jn?!0:r==Ir?!1:!!(e.bandwidth&&Tw(e.bandwidth,t.bandwidth,n.bandwidth)==Jn)))}function K_(e,t,n){var r=xw(e,t,n);if(r===Jn)return!0;if(r===Ir)return!1;if(r=Vu(e.width*e.height,t.width*t.height,n.width*n.height),r==Jn)return!0;if(r==Ir)return!1;if(e.frameRate){if(r=Vu(e.frameRate,t.frameRate,n.frameRate),r==Jn)return!0;if(r==Ir)return!1}return!!(e.bandwidth&&Tw(e.bandwidth,t.bandwidth,n.bandwidth)==Jn)}function $_(e,t,n){var r=Ds(e.language,t.language),i=Ds(e.language,n.language);if(i>r)return!0;if(i<r)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(r=t.roles.filter(function(s){return e.roles.includes(s)}),i=n.roles.filter(function(s){return e.roles.includes(s)}),i.length>r.length)return!0;if(i.length<r.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(n.mimeType!=e.mimeType||n.codecs!=e.codecs||t.mimeType==e.mimeType&&t.codecs==e.codecs)}function Y_(e,t,n){return Vu(e.width*e.height,t.width*t.height,n.width*n.height)==Jn}function yw(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1,baseOriginalId:null}}function vw(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Qe([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}}function Vu(e,t,n){if(t==e&&e!=n)return Ir;if(n==e&&e!=t)return Jn;if(t>e){if(n<=e||n-e<t-e)return Jn;if(n-e>t-e)return Ir}else{if(n>e)return Ir;if(e-n<e-t)return Jn;if(e-n>e-t)return Ir}return Fg}function xw(e,t,n){var r=e.mimeType===t.mimeType&&e.codecs===t.codecs,i=e.mimeType===n.mimeType&&e.codecs===n.codecs;return r&&!i?Ir:!r&&i?Jn:(t=mw(e,t),e=mw(e,n),t&&!e?Ir:!t&&e?Jn:Fg)}function Tw(e,t,n){return t=Math.abs(e-t),e=Math.abs(e-n),e<t?Jn:t<e?Ir:Fg}function Ug(e){switch(e.type){case Fe:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function jg(e){return Dd([e.fastSwitching,e.width,e.frameRate,e.codecs,e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function Bg(e){return Dd([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,e.codecs,e.mimeType,e.roles,e.audioSamplingRate,e.primary,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function Hu(e){return Dd([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function Gu(e){return Dd([e.width,e.codecs,e.mimeType])}function Dd(e){return JSON.stringify(e)}function ww(e){if(!Vg.has(e)){var t=Vt(e);Vg.set(e,t)}return Vg.get(e)}de("shaka.util.PeriodCombiner",jn),jn.prototype.setUseStreamOnce=jn.prototype.Vi,jn.prototype.combinePeriods=jn.prototype.kg,jn.prototype.deleteStream=jn.prototype.Xh,jn.prototype.getImageStreams=jn.prototype.Kj,jn.prototype.getTextStreams=jn.prototype.Lg,jn.prototype.getVariants=jn.prototype.dk;var Jn=1,Fg=0,Ir=-1,Vg=new Map;function q_(e,t){var n=new DOMParser,r=Q_.value()(e);e=null;try{e=n.parseFromString(r,"text/xml")}catch(i){return null}if(n=e.documentElement,!n||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function Sw(e,t){try{var n=ei(e);return q_(n,t)}catch(r){return null}}var Q_=new vt(function(){if(typeof trustedTypes<"u"){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(t){return t}});return function(t){return e.createHTML(t)}}return function(t){return t}});function Xu(){var e=this;this.j=this.g=null,this.B=[],this.h=null,this.Fa=1,this.H=[],this.l={uf:"",type:"",profiles:[],uc:null,rb:0,cb:null,pe:0},this.u=new Map,this.C=new Map,this.o=new Map,this.F=new Map,this.za=new Map,this.m=new jn,this.K=0,this.Da=new Xr(5),this.M=new Ve(function(){if(e.J&&!e.g.continueLoadingWhenPaused&&(e.I.Ma(e.J,"timeupdate"),e.J.paused)){e.I.Aa(e.J,"timeupdate",function(){return kw(e)});return}kw(e)}),this.R=new xo,this.O=null,this.G=[],this.ba=1/0,this.va=!1,this.i=null,this.N=0,this.T=!1,this.I=new et,this.J=null,this.V=!1,this.$="",this.oa=function(){return!1},this.X=[],this.ma=new Set,this.ya=new Q1}p=Xu.prototype,p.configure=function(e,t){var n=this.j&&e.updatePeriod!=this.g.updatePeriod&&e.updatePeriod>=0;this.g=e,t&&(this.oa=t),n&&this.h&&this.h.presentationTimeline.W()&&this.M.Kb(),this.i&&this.i.configure(this.g),this.m&&this.m.Vi(this.g.dash.useStreamOnceInPeriodFlattening)},p.start=function(e,t){var n=this,r;return F(function(i){if(i.g==1)return n.va=t.isLowLatencyMode(),n.B=[e],n.j=t,C(i,Hg(n),2);if(r=i.h,n.j&&Gg(n,r),!n.j)throw new H(2,7,7001);return i.return(n.h)})},p.stop=function(){for(var e=x(this.o.values()),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.B=[],this.h=null,this.o.clear(),this.F.clear(),this.u.clear(),this.C.clear(),this.l={uf:"",type:"",profiles:[],uc:null,rb:0,cb:null,pe:0},this.m=null,this.M!=null&&(this.M.stop(),this.M=null),this.i&&this.i.destroy(),this.I&&(this.I.release(),this.I=null),this.ma.clear(),this.ya.release(),this.R.destroy()},p.update=function(){var e=this,t;return F(function(n){if(n.g==1)return Z(n,2),C(n,Hg(e),4);if(n.g!=2)return ce(n,0);if(t=se(n),!e.j||!t)return n.return();e.j.onError(t),ie(n)})},p.onExpirationUpdated=function(){},p.onInitialVariantChosen=function(e){if(this.h&&this.h.presentationTimeline.W()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.h.presentationTimeline.Ic();var n=t.segmentIndex.find(e);n!=null&&(t=t.segmentIndex.get(n))&&(this.K=t.endTime-e,Gg(this,0))}}},p.banLocation=function(e){this.i&&this.i.banLocation(e)},p.setMediaElement=function(e){this.J=e};function Hg(e){var t,n,r,i,s,o,u,l,f,g,y;return F(function(v){return v.g==1?(t=4,n="MPD",r=fP(e),i=e.B,r.length?(i=r,n="Patch",t=6):e.B.length>1&&e.i&&(s=Fu(e.i,"Location",!0),s.length&&(i=s)),o=Nt(i,e.g.retryParameters),u=Date.now(),C(v,zg(e,o,0,{type:t}),2)):v.g!=3?(l=v.h,e.j?(l.uri&&l.uri!=l.originalUri&&!e.B.includes(l.uri)&&e.B.unshift(l.uri),f=new Pt(l.uri),e.$=f.g.toString(),C(v,J_(e,l.data,l.uri,n),3)):v.return(0)):(g=Date.now(),y=(g-u)/1e3,e.Da.sample(1,y),e.ma.clear(),v.return(y))})}function J_(e,t,n,r){var i,s,o,u,l,f,g,y,v,w;return F(function(A){if(A.g==1){if(i=t,s=e.g.dash.manifestPreprocessor,o=zc,s!=o){if(qe("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),u=Sw(i,r),!u)throw new H(2,4,4001,n);s(u),i=Lr(u.outerHTML)}if(l=Ba(i,r),!l)throw new H(2,4,4001,n);return f=e.g.dash.manifestPreprocessorTXml,g=Wc,f!=g&&f(l),r==="Patch"?A.return(Z_(e,l)):e.g.dash.disableXlinkProcessing?A.return(Aw(e,l,n)):(y=e.g.dash.xlinkFailGracefully,v=kd(l,e.g.retryParameters,y,n,e.j.networkingEngine),Ns(e.R,v),C(A,v.promise,2))}return w=A.h,A.return(Aw(e,w,n))})}function Aw(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze,Ne,st,ze,He,$e,Je,Ye,Ge,We,Wt,jt,pr,Vn,kn,$s,ji,Fr,ra,ia,pf;return F(function(Vr){switch(Vr.g){case 1:for(e.i&&e.i.l.clear(),r=[n],i=[],s=new Map,o=it(t,"Location"),u=x(o),l=u.next();!l.done;l=u.next())f=l.value,g=f.attributes.serviceLocation,(y=In(f))&&(v=$t(r,[y])[0],g&&(e.i?qo(e.i,"Location",g,v):s.set(g,v)),i.push(v));if(e.i?(w=Fu(e.i,"Location",!0),w.length>0&&(r=e.B=w)):i.length&&(r=e.B=i),e.l.uf=t.attributes.id||"",e.l.pe=De(t,"publishTime",vi)||0,e.H=it(t,"PatchLocation"),A=Promise.resolve(),(I=gt(t,"ContentSteering"))&&e.j)for(E=I.attributes.defaultServiceLocation,e.i?(e.i.i=r,e.i.h=E):(e.i=new Yo(e.j),e.i.configure(e.g),e.i.setManifestType("DASH"),e.i.i=r,e.i.h=E,(R=In(I))&&(De(I,"queryBeforeStart",$l,!1)?A=Bu(e.i,R):Bu(e.i,R))),M=x(s.keys()),D=M.next();!D.done;D=M.next())O=D.value,X=s.get(O),qo(e.i,"Location",O,X);if(b=it(t,"BaseURL"),U=!1,e.i)for(N=x(b),z=N.next();!z.done;z=N.next())B=z.value,W=B.attributes.serviceLocation,G=In(B),W&&G&&(qo(e.i,"BaseURL",W,G),U=!0);if(e.X.splice(0),U&&e.i||(re=b.map(In),e.X.push.apply(e.X,Y($t(r,re)))),ne=e.i,$=e.X,Q=hP,ae=Q.call(Xu,ne,U,$),e.l.cb=ae,le=0,b&&b.length&&(le=De(b[0],"availabilityTimeOffset",Kl)||0),e.l.rb=le,e.K=De(t,"minimumUpdatePeriod",ni,-1),be=De(t,"availabilityStartTime",vi),xe=De(t,"timeShiftBufferDepth",ni),Ze=e.g.dash.ignoreSuggestedPresentationDelay,Ne=null,Ze||(Ne=De(t,"suggestedPresentationDelay",ni)),st=e.g.dash.ignoreMaxSegmentDuration,ze=null,st||(ze=De(t,"maxSegmentDuration",ni)),He=t.attributes.type||"static",e.h&&e.h.presentationTimeline&&(e.V=e.h.presentationTimeline.W()&&He=="static"),e.l.type=He,e.h)for($e=e.h.presentationTimeline,Je=$e.Ib(),Ye=x(e.o.values()),Ge=Ye.next();!Ge.done;Ge=Ye.next())We=Ge.value,We.segmentIndex&&We.segmentIndex.Ya(Je);else Wt=e.g.dash.ignoreMinBufferTime,jt=0,Wt||(jt=De(t,"minBufferTime",ni)||0),pr=0,pr=Ne!=null?Math.min(Ne,xe||1/0):e.g.defaultPresentationDelay>0?e.g.defaultPresentationDelay:Math.min(jt*1.5,xe||1/0),$e=new Pe(be,pr,e.g.dash.autoCorrectDrift);return $e.cd(He=="static"),$e.W()&&!isNaN(e.g.availabilityWindowOverride)&&(xe=e.g.availabilityWindowOverride),xe==null&&(xe=1/0),$e.Kf(xe),Vn=t.attributes.profiles||"",e.l.profiles=Vn.split(","),kn={Fb:He!="static",presentationTimeline:$e,sa:null,na:null,qa:null,L:null,bandwidth:0,Ng:!1,rb:le,uc:null,profiles:Vn.split(","),roles:null,Mb:Lw},C(Vr,A,2);case 2:return e.N=0,$s=Mw(e,kn,ae,t,!1),ji=$s.duration,Fr=$s.periods,(He!="static"||e.V)&&$s.Zh||$e.Ab(ji||1/0),e.T&&e.va&&$e.Si(e.ba),$e.Vg(ze||1),e.T&&e.va&&(ra=Ne!=null?Ne:e.g.defaultPresentationDelay,$e.qh(ra)),e.h?(e.h.periodCount=Fr.length,e.h.gapCount=e.N,C(Vr,Ew(e,Fr,!1),4)):C(Vr,e.m.kg(Fr,kn.Fb),6);case 6:var gf=$e,Qm=e.m.l,mf=e.m.Lg(),sa=e.m.i,nl=e.g.dash.sequenceMode,Bt=gt(t,"ServiceDescription");if(Bt){var er=gt(Bt,"Latency");if(Bt=gt(Bt,"PlaybackRate"),er||Bt){var _n={};er&&("target"in er.attributes&&(_n.targetLatency=parseInt(er.attributes.target,10)/1e3),"max"in er.attributes&&(_n.maxLatency=parseInt(er.attributes.max,10)/1e3),"min"in er.attributes&&(_n.minLatency=parseInt(er.attributes.min,10)/1e3)),Bt&&("max"in Bt.attributes&&(_n.maxPlaybackRate=parseFloat(Bt.attributes.max)),"min"in Bt.attributes&&(_n.minPlaybackRate=parseFloat(Bt.attributes.min))),er=_n}else er=null}else er=null;e:{if(Bt=it(t,"SupplementalProperty"),Bt.length){for(Bt=x(Bt),_n=Bt.next();!_n.done;_n=Bt.next())if(_n=_n.value,_n.attributes.schemeIdUri=="urn:mpeg:dash:chaining:2016"){Bt=_n.attributes.value;break e}}Bt=null}if(e.h={presentationTimeline:gf,variants:Qm,textStreams:mf,imageStreams:sa,offlineSessionIds:[],sequenceMode:nl,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:er,nextUrl:Bt,periodCount:Fr.length,gapCount:e.N,isLowLatency:e.T,startTime:null},!$e.ij()){Vr.A(7);break}return ia=it(t,"UTCTiming"),C(Vr,cP(e,ae,ia),8);case 8:if(pf=Vr.h,!e.j)return Vr.return();$e.Ti(pf);case 7:$e.pf(),e.m&&!e.h.presentationTimeline.W()&&e.m.release();case 4:e.j.makeTextStreamsForClosedCaptions(e.h),tP(e),nP(e,Fr),ie(Vr)}})}function Ew(e,t,n){var r;return F(function(i){if(i.g==1)return C(i,e.m.kg(t,!0,n),2);e.h.variants=e.m.l,r=e.m.Lg(),r.length>0&&(e.h.textStreams=r),e.h.imageStreams=e.m.i,e.j.filter(e.h),ie(i)})}function Z_(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G;return F(function(re){if(re.g==1){if(n=t.attributes.mpdId,r=De(t,"originalPublishTime",vi),!n||n!==e.l.uf||r!==e.l.pe)throw e.H=[],new H(1,4,4052);for(i=[],s=[],o=new Set,u=x(Mv(t)),l=u.next();!l.done;l=u.next())if(f=l.value,g=Yl(f.attributes.sel||""),y=g[g.length-1],v=In(f)||"",y.name==="MPD")if(y.Dc==="mediaPresentationDuration"){w=In(f)||"";var ne=ni(w);if(ne!=null){e.l.uc=ne;for(var $=x(e.u.values()),Q=$.next();!Q.done;Q=$.next())Q.value.uc=ne}}else if(y.Dc==="type"){for(e.h.presentationTimeline.cd(v=="static"),e.l.type=v,ne=x(e.u.values()),$=ne.next();!$.done;$=ne.next())$.value.Fb=v=="dynamic";v=="static"&&(e.K=-1)}else y.Dc==="publishTime"?e.l.pe=vi(v)||0:y.Dc===null&&f.tagName==="add"&&s.push(f);else if(y.name==="PatchLocation")kv(e.H,f);else if(y.name==="Period")f.tagName==="add"?s.push(f):f.tagName==="remove"&&y.id&&eP(e,y.id);else if(y.name==="SegmentTemplate"){if($=Yl(f.attributes.sel||""),ne=$[$.length-1],ne.Dc){$=Iw(e,$),Q=In(f)||"";for(var ae=x($),le=ae.next();!le.done;le=ae.next())le=e.u.get(le.value),Pv(le.L.Oc,f.tagName,ne.Dc,Q);ne=$}else ne=[];for(A=ne,I=x(A),E=I.next();!E.done;E=I.next())R=E.value,o.add(R)}else if(y.name==="SegmentTimeline"||y.name==="S"){for(ne=Yl(f.attributes.sel||""),ne=Iw(e,ne),$=x(ne),Q=$.next();!Q.done;Q=$.next())Q=e.u.get(Q.value),Q=Ko(Q,fs,"SegmentTimeline"),ae=it(Q,"S"),kv(ae,f),Q.children=ae;for(M=ne,D=x(M),O=D.next();!O.done;O=D.next())X=O.value,o.add(X)}for(b=x(o),U=b.next();!U.done;U=b.next())N=U.value,Cw(e,N);for(z=x(s),B=z.next();!B.done;B=z.next())W=B.value,i.push.apply(i,Y(Mw(e,{Fb:e.l.type=="dynamic",presentationTimeline:e.h.presentationTimeline,sa:null,na:null,qa:null,L:null,bandwidth:0,Ng:!1,rb:e.l.rb,profiles:e.l.profiles,uc:e.l.uc,roles:null,Mb:Lw},e.l.cb,W,!0).periods));return i.length?(e.h.periodCount+=i.length,e.h.gapCount=e.N,C(re,Ew(e,i,!0),2)):re.A(2)}e.l.type=="static"&&(G=e.l.uc,e.h.presentationTimeline.Ab(G||1/0)),ie(re)})}function eP(e,t){e.h.periodCount--;for(var n=x(e.u.keys()),r=n.next();!r.done;r=n.next())if(r=r.value,r.startsWith(t)){var i=e.u.get(r);Ko(i,fs,"SegmentTimeline").children=[],Cw(e,r),e.u.delete(r)}e.G=e.G.filter(function(s){return s!==t})}function Iw(e,t){var n="",r="",i=-1,s="";t=x(t);for(var o=t.next();!o.done;o=t.next())o=o.value,o.name==="Period"?n=o.id:o.name==="AdaptationSet"?(r=o.id,o.position!==null&&(i=o.position)):o.name==="Representation"&&(s=o.id);if(t=[],s)t.push(n+","+s);else if(r)for(i=x(e.u.values()),e=i.next();!e.done;e=i.next())e=e.value,e.sa.id===n&&e.qa.id===r&&e.L.id&&t.push(n+","+e.L.id);else if(i>-1)for(r=x(e.u.values()),e=r.next();!e.done;e=r.next())e=e.value,e.sa.id===n&&e.qa.position===i&&e.L.id&&t.push(n+","+e.L.id);return t}function Cw(e,t){var n=e.u.get(t),r=e.o.get(t);r.segmentIndex&&r.segmentIndex.Ya(e.h.presentationTimeline.Ib());try{var i=uw(n,function(s,o,u,l){return Pw(e,s,o,u,l)},e.o,!0,e.g.dash.initialSegmentLimit,e.za,n.L.aesKey,null,!0,e.C);r.createSegmentIndex=function(){return F(function(s){if(s.g==1)return r.segmentIndex?s.A(0):C(s,i.Sc(),3);r.segmentIndex=s.h,ie(s)})}}catch(s){if(t=n.L.contentType,t!=Fe&&t!="application"&&t!="image"||s.code!=4002)throw s}}function Mw(e,t,n,r,i){var s=t.uc;s||(s=De(r,"mediaPresentationDuration",ni),e.l.uc=s);var o=0;e.h&&e.h.presentationTimeline&&e.V&&(o=e.h.presentationTimeline.$b());var u=[],l=o;r=it(r,"Period");for(var f=0;f<r.length;f++){var g=r[f],y=r[f+1],v=De(g,"start",ni,l),w=g.attributes.id,A=De(g,"duration",ni);v=f==0&&v==0&&e.V?o:v;var I=null;if(y){var E=De(y,"start",ni);E!=null&&(I=E-v+o)}else s!=null&&(I=s-v+o);if(E=xv,I&&A&&Math.abs(I-A)>E&&I>A&&e.N++,I==null&&(I=A),!(e.O!==null&&w!==null&&v!==null&&v<e.O)||e.G.includes(w)||f+1==r.length){if(v!==null&&(e.O===null||v>e.O)&&(e.O=v),l=rP(e,t,n,{start:v,duration:I,node:g,jf:I==null||!y}),u.push(l),t.sa.id&&I&&e.za.set(t.sa.id,I),I==null){l=null;break}l=v+I}}if(i)for(t=x(u),n=t.next();!n.done;n=t.next())n=n.value.id,e.G.includes(n)||e.G.push(n);else e.G=u.map(function(R){return R.id});return s!=null?{periods:u,duration:s+o,Zh:!1}:{periods:u,duration:l,Zh:!0}}function tP(e){var t=Array.from(e.F.keys()).filter(function(u){return!e.G.includes(u)});t=x(t);for(var n=t.next();!n.done;n=t.next()){n=n.value;for(var r=!0,i=x(e.F.get(n)),s=i.next();!s.done;s=i.next()){s=s.value;var o=e.o.get(s);o&&(o.segmentIndex&&o.segmentIndex.getNumReferences()!=0?r=!1:(e.m&&e.m.Xh(o,n),e.o.delete(s)))}r&&e.F.delete(n)}}function nP(e,t){t=new Set(t.map(function(i){return i.id}));for(var n=x(e.C.keys()),r=n.next();!r.done;r=n.next())r=r.value,t.has(r)||e.C.delete(r)}function rP(e,t,n,r){t.sa=Xg(e,r.node,null,n),t.na=r,t.sa.rb=t.rb,t.sa.id||(t.sa.id="__shaka_period_"+r.start);var i=it(r.node,"EventStream");n=t.presentationTimeline.Ib(),i=x(i);for(var s=i.next();!s.done;s=i.next())dP(e,r.start,r.duration,s.value,n);for(n=it(r.node,"SupplementalProperty"),n=x(n),i=n.next();!i.done;i=n.next())i=i.value,i.attributes.schemeIdUri=="urn:mpeg:dash:urlparam:2014"&&(i=zu(e,i))&&(t.Mb=i);if(n=it(r.node,"AdaptationSet").map(function(w,A){return Rw(e,t,A,w)}).filter(Zi),t.Fb){i=[],s=x(n);for(var o=s.next();!o.done;o=s.next()){o=x(o.value.Pk);for(var u=o.next();!u.done;u=o.next())i.push(u.value)}if(i.length!=new Set(i).size)throw new H(2,4,4018)}for(i=new Map,s=x(n),o=s.next();!o.done;o=s.next())for(o=x(o.value.yj),u=o.next();!u.done;u=o.next()){var l=x(u.value);u=l.next().value,l=l.next().value,i.set(u,l)}if(i.size)for(s=null,o=x(n),u=o.next();!u.done;u=o.next()){u=u.value,l=[];for(var f=x(u.streams),g=f.next(),y={};!g.done;y={yh:void 0},g=f.next())if(y.yh=g.value,i.has(y.yh.originalId)){s||(s=it(r.node,"AdaptationSet").map(function(w,A){return Rw(e,t,A,w)}).filter(Zi)),g=x(s);for(var v=g.next();!v.done;v=g.next())(v=v.value.streams.find((function(w){return function(A){return A.originalId==w.yh.originalId}})(y)))&&(v.dependencyStream=i.get(v.originalId),v.originalId+=v.dependencyStream.originalId,l.push(v))}l.length&&u.streams.push.apply(u.streams,Y(l))}if(r=n.filter(function(w){return!w.Gh}),n=n.filter(function(w){return w.Gh}),!e.g.disableIFrames){for(n=x(n),i=n.next();!i.done;i=n.next())for(i=i.value,s=i.Gh.split(" "),o=x(r),u=o.next();!u.done;u=o.next())if(u=u.value,s.includes(u.id))for(u=x(u.streams),l=u.next();!l.done;l=u.next())t0(l.value,i.streams)}if(n=Ld(e.g.disableAudio,r,"audio"),i=Ld(e.g.disableVideo,r,"video"),s=Ld(e.g.disableText,r,Fe),r=Ld(e.g.disableThumbnails,r,"image"),i.length===0&&n.length===0)throw new H(2,4,4004);return{id:t.sa.id,audioStreams:n,videoStreams:i,textStreams:s,imageStreams:r}}function Ld(e,t,n){return e||!t.length?[]:t.reduce(function(r,i){return i.contentType!=n||r.push.apply(r,Y(i.streams)),r},[])}function Rw(e,t,n,r){function i(G){var re=G.attributes["dvb:fontFamily"];G=G.attributes["dvb:url"],re&&G&&(G=$t(t.qa.cb(),[G],t.Mb()),e.j.addFont(re,G[0]))}function s(G){switch(G){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function o(G){switch(G){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.qa=Xg(e,r,t.sa,null),t.qa.position=n;var u=!1;n=it(r,"Role");var l=n.map(function(G){return G.attributes.value}).filter(Zi),f=void 0,g=t.qa.contentType==Fe;g&&(f="subtitle"),n=x(n);for(var y=n.next();!y.done;y=n.next()){y=y.value;var v=y.attributes.schemeIdUri;if(v==null||v=="urn:mpeg:dash:role:2011")switch(y=y.attributes.value,y){case"main":u=!0;break;case"caption":case"subtitle":f=y}}var w=it(r,"EssentialProperty");n=null;var A=!1;y=null,v=!1,w=x(w);for(var I=w.next();!I.done;I=w.next()){I=I.value;var E=I.attributes.schemeIdUri;if(E=="http://dashif.org/guidelines/trickmode")n=I.attributes.value;else if(E=="urn:mpeg:mpegB:cicp:TransferCharacteristics")var R=o(parseInt(I.attributes.value,10));else if(E=="urn:mpeg:mpegB:cicp:ColourPrimaries")var M=s(parseInt(I.attributes.value,10));else E!="urn:mpeg:mpegB:cicp:MatrixCoefficients"&&(E=="urn:mpeg:dash:ssr:2023"&&e.g.dash.enableFastSwitching?A=!0:E=="urn:dvb:dash:fontdownload:2014"?i(I):E=="urn:mpeg:dash:urlparam:2014"&&(y=zu(e,I))||(v=!0))}if(v)return null;var D=null;for(v=it(r,"SupplementalProperty"),v=x(v),w=v.next();!w.done;w=v.next())w=w.value,I=w.attributes.schemeIdUri,I=="http://dashif.org/guidelines/last-segment-number"?D=parseInt(w.attributes.value,10)-1:I=="urn:mpeg:mpegB:cicp:TransferCharacteristics"?R=o(parseInt(w.attributes.value,10)):I=="urn:mpeg:mpegB:cicp:ColourPrimaries"?M=s(parseInt(w.attributes.value,10)):I=="urn:dvb:dash:fontdownload:2014"?i(w):I=="urn:mpeg:dash:urlparam:2014"&&(y=zu(e,w));y&&(t.Mb=y),y=it(r,"Accessibility");var O=new Map,X;for(y=x(y),v=y.next();!v.done;v=y.next())if(w=v.value,v=w.attributes.schemeIdUri,w=w.attributes.value,v!="urn:scte:dash:cc:cea-608:2015"||e.g.disableText)if(v!="urn:scte:dash:cc:cea-708:2015"||e.g.disableText)v=="urn:mpeg:dash:role:2011"?w!=null&&(l.push(w),w=="captions"&&(f="caption")):v=="urn:tva:metadata:cs:AudioPurposeCS:2007"&&(w=="1"?X="visually impaired":w=="2"?X="hard of hearing":w=="9"&&(X="spoken subtitles"));else if(v=1,w!=null)for(w=x(w.split(";")),I=w.next();!I.done;I=w.next()){E=I.value;var b=I=void 0;E.includes("=")?(E=E.split("="),I="svc"+E[0],b=E[1].split(",")[0].split(":").pop()):(I="svc"+v,v++,b=E),O.set(I,tt(b))}else O.set("svc1","und");else if(v=1,w!=null)for(w=w.split(";"),I=x(w),E=I.next();!E.done;E=I.next()){b=E.value;var U=E=void 0;b.includes("=")?(b=b.split("="),E=b[0].startsWith("CC")?b[0]:"CC"+b[0],U=b[1]||"und"):(E="CC"+v,w.length==2?v+=2:v++,U=b),O.set(E,tt(U))}else O.set("CC1","und");y=it(r,"ContentProtection");var N=J1(e.ya,y,e.g.ignoreDrmInfo,e.g.dash.keySystemsByURI);t.qa.encrypted=y.length>0;var z=tt(t.qa.language||"und"),B=t.qa.label,W=new Map;if(r=it(r,"Representation"),!e.g.ignoreSupplementalCodecs){for(y=[],v=x(r),w=v.next();!w.done;w=v.next())I=w.value,(w=yi(I,"urn:scte:dash:scte214-extensions","supplementalCodecs"))&&(I=br(I),I.attributes.codecs=w.split(" ").join(","),I.attributes.id&&(I.attributes.supplementalId=I.attributes.id+"_supplementalCodecs"),y.push(I));r.push.apply(r,Y(y))}if(y=r.map(function(G){var re=iP(e,t,N,f,z,B,u,l,O,G,X,D);return re&&(re.hdr=re.hdr||R,re.colorGamut=re.colorGamut||M,re.fastSwitching=A,G=G.attributes.dependencyId)?(re.baseOriginalId=G,W.set(G,re),null):re}).filter(function(G){return!!G}),y.length==0&&W.size==0){if(n=t.qa.contentType=="image",e.g.dash.ignoreEmptyAdaptationSet||g||n)return null;throw new H(2,4,4003)}if(!t.qa.contentType||t.qa.contentType=="application")for(t.qa.contentType=Dw(y[0].mimeType,y[0].codecs),g=x(y),v=g.next();!v.done;v=g.next())v.value.type=t.qa.contentType;for(g=t.qa.id||"__fake__"+e.Fa++,v=x(y),w=v.next();!w.done;w=v.next()){for(w=w.value,I=x(N.drmInfos),E=I.next();!E.done;E=I.next())E=E.value,E.keyIds=E.keyIds&&w.keyIds?new Set([].concat(Y(E.keyIds),Y(w.keyIds))):E.keyIds||w.keyIds;e.g.enableAudioGroups&&(w.groupId=g)}return r=r.map(function(G){return G.attributes.supplementalId||G.attributes.id}).filter(Zi),{id:g,contentType:t.qa.contentType,language:z,Dm:u,streams:y,drmInfos:N.drmInfos,Gh:n,Pk:r,yj:W}}function zu(e,t){if((t=Tr(t,"urn:mpeg:dash:schema:urlparam:2014","UrlQueryInfo"))&&De(t,"useMPDUrlQuery",$l,!1)){var n=t.attributes.queryTemplate;if(n)return function(){return n=="$querypart$"?e.$:n.split("&").map(function(r){if(r=="$querypart$")return e.$;var i=/\$query:(.*?)\$/g.exec(r);if(i&&i.length==2){i=i[1];var s=new io(e.$).get(i);if(s.length)return i+"="+s[0]}return r}).join("&")}}return null}function iP(e,t,n,r,i,s,o,u,l,f,g,y){t.L=Xg(e,f,t.qa,null);var v=t.L.id;if(e.ba=Math.min(e.ba,t.L.rb),e.T=e.ba>0,!lP(t.L))return null;var w=t.na.start;t.bandwidth=De(f,"bandwidth",ri)||0,t.roles=u;var A=it(f,"SupplementalProperty"),I=it(f,"EssentialProperty"),E=it(f,"ContentProtection");f=null;var R=I.find(function($){return $.attributes.schemeIdUri=="urn:mpeg:dash:urlparam:2014"});(R||(R=A.find(function($){return $.attributes.schemeIdUri=="urn:mpeg:dash:urlparam:2014"})))&&(f=zu(e,R)),f&&(t.Mb=f),R=t.L.contentType,f=R==Fe||R=="application",R=R=="image",E.length&&(t.qa.encrypted=!0);try{var M=void 0;if(n.gg){var D=t.L.cb,O=t.Mb,X=$t(D(),[n.gg.tk],O()),b=Nt(X,e.g.retryParameters);M={bitsKey:128,blockCipherMode:"CBC",iv:n.gg.iv,firstMediaSequenceNumber:0,fetchKey:function(){var $,Q,ae;return F(function(le){if(le.g==1)return C(le,zg(e,b,6),2);if(le.g!=3){if($=le.h,!$.data||$.data.byteLength!=16)throw new H(2,4,4049);return Q={name:"AES-CBC"},ae=M,C(le,m.crypto.subtle.importKey("raw",$.data,Q,!0,["decrypt"]),3)}ae.cryptoKey=le.h,M.fetchKey=void 0,ie(le)})}}}if(t.L.aesKey=M,D=function($,Q,ae,le){return Pw(e,$,Q,ae,le)},t.L.Id)var U=R_(t,D,M);else if(t.L.Ac)U=__(t,e.o,M);else if(t.L.Oc)U=uw(t,D,e.o,!!e.h,e.g.dash.initialSegmentLimit,e.za,M,y,!1,e.C);else{var N=t.na.duration||0,z=t.L.cb,B=t.L.mimeType,W=t.L.codecs;U={endTime:-1,timeline:-1,Sc:function(){var $=kc(w,N,z());return $.Gb(function(Q){Q.mimeType=B,Q.codecs=W}),Promise.resolve($)},timescale:1}}}catch($){if((f||R)&&$.code==4002)return null;throw $}y=g_(e.ya,E,n,e.g.ignoreDrmInfo,e.g.dash.keySystemsByURI),y=new Set(y?[y]:[]),E=!1,A.some(function($){return $.attributes.schemeIdUri=="tag:dolby.com,2018:dash:EC3_ExtensionType:2018"&&$.attributes.value=="JOC"})&&(E=!0),A=!1,f&&(A=u.includes("forced_subtitle")||u.includes("forced-subtitle"));var G;if(R&&((I=I.find(function($){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes($.attributes.schemeIdUri)}))&&(G=I.attributes.value),!G))return null;var re;f=t.L.codecs,t.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(f.includes("hvc1.2.4.L153.B0")||f.includes("hev1.2.4.L153.B0"))&&(re="PQ"),I=t.L.id?t.sa.id+","+t.L.id:"",e.H.length&&v&&e.u.set(t.sa.id+","+v,oP(t)),t.L.Bf&&sP(e,t.L.Bf,U,t.presentationTimeline),U.endTime!=-1&&t.sa.id!=null&&t.L.id!=null&&((v=e.C.get(t.sa.id))?(v.endTime=U.endTime,v.fh.includes(t.L.id)||v.fh.push(t.L.id),e.C.set(t.sa.id,v)):e.C.set(t.sa.id,{endTime:U.endTime,timeline:U.timeline,fh:[t.L.id]}));var ne=I&&e.o.has(I)?e.o.get(I):{id:e.Fa++,originalId:t.L.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){ne.segmentIndex&&(ne.segmentIndex.release(),ne.segmentIndex=null)},segmentIndex:null,mimeType:t.L.mimeType,codecs:f,frameRate:t.L.frameRate,pixelAspectRatio:t.L.pixelAspectRatio,bandwidth:t.bandwidth,width:t.L.width,height:t.L.height,kind:r,encrypted:n.drmInfos.length>0,drmInfos:n.drmInfos,keyIds:y,language:i,originalLanguage:t.qa.language,label:s,type:t.qa.contentType,primary:o,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:t.L.emsgSchemeIdUris,roles:u,forced:A,channelsCount:t.L.xf,audioSamplingRate:t.L.audioSamplingRate,spatialAudio:E,closedCaptions:l,hdr:re,colorGamut:void 0,videoLayout:void 0,tilesLayout:G,accessibilityPurpose:g,external:!1,fastSwitching:!1,fullMimeTypes:new Set([Ct(t.L.mimeType,t.L.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null};return ne.createSegmentIndex=function(){var $;return F(function(Q){if(Q.g==1)return ne.segmentIndex?Q.A(0):($=ne,C(Q,U.Sc(),3));$.segmentIndex=Q.h,ie(Q)})},I&&t.Fb&&!e.o.has(I)&&(t=t.sa.id||"",e.F.has(t)||e.F.set(t,[]),e.o.set(I,ne),e.F.get(t).push(I)),ne}function sP(e,t,n,r){if(!e.ma.has(t)){e.ma.add(t);var i=De(t,"presentationTime",rn)||0,s=gt(t,"UTCTiming"),o;(o=s&&s.attributes.schemeIdUri)&&(s=s.attributes.schemeIdUri,o=!(s==="urn:mpeg:dash:utc:http-ntp:2014"||s==="urn:mpeg:dash:utc:ntp:2014"||s==="urn:mpeg:dash:utc:sntp:2014")),o?t=(De(t,"wallClockTime",vi)||0)*1e3:(t=De(t,"wallClockTime",rn)||0,t=J0(t)),n=new Date(t-i/n.timescale*1e3),i=n.getTime()/1e3,isNaN(i)||(r.o||r.rh(i),r=new Map().set("detail",{wallClockTime:t,programStartDate:n}),r=new Se("prft",r),e.j.onEvent(r))}}function oP(e){function t(n){return n?(n=Yi(n),n.Id=null,n.Ac=null,n.Oc=Mh(n.Oc),n.Bf=null,n):null}return e=Yi(e),e.sa=t(e.sa),e.qa=t(e.qa),e.L=t(e.L),e.na&&(e.na=Yi(e.na),e.na.node=null),e}function kw(e){var t,n;return F(function(r){switch(r.g){case 1:return t=0,Z(r,2),C(r,Hg(e),4);case 4:t=r.h,ce(r,3);break;case 2:if(n=se(r),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),r.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return r.return();e.j.onManifestUpdated(),Gg(e,t),ie(r)}})}function Gg(e,t){if(!(e.K<0)){var n=e.K;e.g.updatePeriod>=0&&(n=e.g.updatePeriod),e.M.ka(Math.max(n-t,yr(e.Da)))}}function Xg(e,t,n,r){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,xf:null,audioSamplingRate:null,rb:0,Hf:1,encrypted:!1},r=r||n.cb;var i=t.attributes.id,s=t.attributes.supplementalId,o=it(t,"BaseURL"),u,l=!1;if(e.i)for(var f=x(o),g=f.next();!g.done;g=f.next()){var y=g.value;g=y.attributes.serviceLocation,y=In(y),g&&y&&(qo(e.i,i,g,y),l=!0)}l&&e.i||(u=o.map(In));var v=e.i;e=t.attributes.contentType||n.contentType,f=t.attributes.mimeType||n.mimeType,g=Ip([t.attributes.codecs||n.codecs]).join(","),y=De(t,"frameRate",U2)||n.frameRate;var w=t.attributes.sar||n.pixelAspectRatio,A=aP(it(t,"InbandEventStream"),n.emsgSchemeIdUris),I=it(t,"AudioChannelConfiguration");I=uP(I)||n.xf;var E=De(t,"audioSamplingRate",rn)||n.audioSamplingRate;e||(e=Dw(f,g));var R=gt(t,"SegmentBase"),M=gt(t,"SegmentTemplate"),D=R&&De(R,"availabilityTimeOffset",Kl)||0,O=M&&De(M,"availabilityTimeOffset",Kl)||0,X=o&&o.length&&De(o[0],"availabilityTimeOffset",Kl)||0;D=n.rb+X+D+O,O=null,(X=gt(t,"SegmentSequenceProperties"))&&(X=De(X,"cadence",ri))&&(O=X),X=t.attributes.label;var b=it(t,"Label");return b&&b.length&&(b=b[0],Dt(b)&&(X=Dt(b))),{cb:function(){return $t(r(),o.length?v&&l?Fu(v,i):u||[]:[])},Id:R||n.Id,Ac:gt(t,"SegmentList")||n.Ac,Oc:M||n.Oc,Bf:gt(t,"ProducerReferenceTime")||n.Bf,width:De(t,"width",rn)||n.width,height:De(t,"height",rn)||n.height,contentType:e,mimeType:f,codecs:g,frameRate:y,pixelAspectRatio:w,emsgSchemeIdUris:A,id:s||i,originalId:i,language:t.attributes.lang,xf:I,audioSamplingRate:E,rb:D,gf:null,Hf:O||n.Hf,label:X||null,encrypted:!1}}function aP(e,t){t=t.slice(),e=x(e);for(var n=e.next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}function uP(e){e=x(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=t.attributes.schemeIdUri;if(n&&(t=t.attributes.value))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(t=parseInt(t,10),!t)continue;return t;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":if(n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2],t=parseInt(t,16),!t)continue;for(var r=0,i=0;i<n.length;i++)t&1<<i&&(r+=n[i]);if(r)return r;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),t=parseInt(t,16),!t)continue;for(i=r=0;i<n.length;i++)t&1<<i&&(r+=n[i]);if(r)return r;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(t=parseInt(t,10))&&t>0&&t<n.length)return n[t]}}return null}function lP(e){var t=e.Id?1:0;return t+=e.Ac?1:0,t+=e.Oc?1:0,t==0?e.contentType==Fe||e.contentType=="application":(t!=1&&(e.Id&&(e.Ac=null),e.Oc=null),!0)}function _w(e,t,n,r){var i,s,o,u,l,f,g;return F(function(y){if(y.g==1)return i=[En(n)],s=$t(t(),i),o=Nt(s,e.g.retryParameters),o.method=r,u=e.j.networkingEngine.request(4,o,{isPreload:e.oa()}),Ns(e.R,u),C(y,u.promise,2);if(l=y.h,r=="HEAD"){if(!l.headers||!l.headers.date)return y.return(0);f=l.headers.date}else f=wt(l.data);return g=Date.parse(f),isNaN(g)?y.return(0):y.return(g-Date.now())})}function cP(e,t,n){var r,i,s,o,u,l,f,g;return F(function(y){switch(y.g){case 1:r=n.map(function(v){return{scheme:v.attributes.schemeIdUri,value:v.attributes.value}}),i=e.g.dash.clockSyncUri,!r.length&&i&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),s=x(r),o=s.next();case 2:if(o.done){y.A(4);break}switch(u=o.value,Z(y,5),l=u.scheme,f=u.value,l){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return y.A(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return y.A(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return g=Date.parse(f),y.return(isNaN(g)?0:g-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Be("NTP UTCTiming scheme is not supported");break;default:Be("Unrecognized scheme in UTCTiming element",l)}y.A(9);break;case 7:return C(y,_w(e,t,f,"HEAD"),10);case 10:return y.return(y.h);case 8:return C(y,_w(e,t,f,"GET"),11);case 11:return y.return(y.h);case 9:ce(y,3);break;case 5:se(y);case 3:o=s.next(),y.A(2);break;case 4:return Be("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),y.return(0)}})}function dP(e,t,n,r,i){var s=r.attributes.schemeIdUri||"",o=r.attributes.value||"",u=De(r,"timescale",rn)||1,l=De(r,"presentationTimeOffset",rn)||0;r=x(it(r,"Event"));for(var f=r.next();!f.done;f=r.next()){f=f.value;var g=De(f,"presentationTime",rn)||0,y=De(f,"duration",rn)||0;g=Math.max((g-l)/u+t,t),y=g+y/u,n!=null&&(g=Math.min(g,t+n),y=Math.min(y,t+n)),y<i||(f={schemeIdUri:s,value:o,startTime:g,endTime:y,id:f.attributes.id||"",timescale:u,eventElement:Dv(f),eventNode:Mh(f)},e.j.onTimelineRegionAdded(f))}}function Pw(e,t,n,r,i){var s,o,u,l;return F(function(f){return f.g==1?(s=wr,o=i?0:1,u=hu(t,n,r,e.g.retryParameters),C(f,zg(e,u,s,{type:o}),2)):(l=f.h,f.return(l.data))})}function Dw(e,t){return t=Ct(e,t),Wa(t)?Fe:e.split("/")[0]}function zg(e,t,n,r){return r||(r={}),r.isPreload=e.oa(),t=e.j.networkingEngine.request(n,t,r),Ns(e.R,t),t.promise}function fP(e){var t=e.l.pe;if(!e.l.uf||!t||!e.H.length)return[];var n=Date.now()/1e3,r=e.H.filter(function(i){return i=rn(i.attributes.ttl),!i||t+i>n}).map(In).filter(Zi);return r.length?$t(e.B,r):[]}function Lw(){return""}function hP(e,t,n){return function(){return e&&t?Fu(e,"BaseURL"):n.slice()}}de("shaka.dash.DashParser",Xu),Is("application/dash+xml",function(){return new Xu}),Is("video/vnd.mpeg.dash.mpd",function(){return new Xu});function bd(){}de("shaka.dependencies",bd),bd.has=function(e){return Wg.has(e)},bd.add=function(e,t){if(!Nw[e])throw Error(e+" is not supported");e==bw?qe("mux.js","mux.js is no longer used in Shaka Player."):Wg.set(e,function(){return t})};var bw="muxjs",Nw={Em:bw,ISOBoxer:"ISOBoxer"};bd.Allowed=Nw;var Wg=new Map([["ISOBoxer",function(){return m.ISOBoxer}]]);function rt(){this.j=new vt(function(){return["Oculus","Quest"].some(function(e){return navigator.userAgent.includes(e.toLowerCase())})?"VR":navigator.userAgent.match(/Smart( ?|_)TV/i)||navigator.userAgent.match(/Android ?TV/i)?"TV":navigator.userAgentData?navigator.userAgentData.mobile?"MOBILE":"DESKTOP":/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)?"MOBILE":navigator.userAgentData&&navigator.userAgentData.platform?navigator.userAgentData.platform.toLowerCase()=="android"?"MOBILE":"DESKTOP":navigator.userAgent.includes("Android")?"MOBILE":"DESKTOP"}),this.l=new vt(function(){return navigator.vendor.includes("Apple")&&(navigator.userAgent.includes("Version/")||navigator.userAgent.includes("OS/"))?"WEBKIT":navigator.userAgent.includes("Edge/")?"EDGE":navigator.userAgent.includes("Chrome/")?"CHROMIUM":navigator.userAgent.includes("Firefox/")?"GECKO":"UNKNOWN"})}function oi(){var e=m.ManagedMediaSource||m.MediaSource;return!!(e&&e.isTypeSupported)}p=rt.prototype,p.hc=function(){return!!navigator.mediaCapabilities},p.Oa=function(){return this.j.value()},p.Ha=function(){return this.l.value()},p.Fd=function(){return!1},p.hh=function(){return!1},p.hf=function(){return!1},p.Li=function(){return!1},p.re=function(){return!1},p.fd=function(){return!0},p.Bb=function(){var e=m.ManagedSourceBuffer||m.SourceBuffer;return!!e&&!!e.prototype&&!!e.prototype.changeType},p.ve=function(){return!0},p.Qi=function(){return 0},p.lc=function(){return Promise.resolve({width:1/0,height:1/0})},p.Yi=function(){return!1},p.wh=function(){return!1},p.Wa=function(e){var t=this.Oa();return(t==="TV"||t==="CONSOLE"||t==="CAST")&&(e.ads.customPlayheadTracker=!0,e.ads.skipPlayDetection=!0,e.ads.supportsMultipleMediaElements=!1),e},p.Bh=function(){return!!m.indexedDB},p.Ji=function(){return[]},p.sd=function(e){return m.matchMedia!==void 0&&m.matchMedia("(color-gamut: p3)").matches?e?"HLG":"PQ":"SDR"},p.ej=function(){return!1},p.zi=function(){return!1},p.Ef=function(){return!1},p.Nf=function(){return!0},p.Ai=function(){return!1},p.dj=function(){return!0},p.ed=function(){return!1},p.Ug=function(e){return e==="com.apple.fps"},p.Mf=function(){return!0},p.toString=function(){return"Device: "+this.Ob()+" v"+this.Ba()+"; Type: "+this.Oa()};function Kg(){rt.call(this),this.g=new vt(function(){var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}),this.h=new vt(function(){return/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1?"xr"in navigator?"APPLE_VR":"MOBILE":"xr"in navigator?"APPLE_VR":"DESKTOP"})}J(Kg,rt),p=Kg.prototype,p.Ba=function(){return this.g.value()},p.Ob=function(){return"Apple Browser"},p.Oa=function(){return this.h.value()},p.Ha=function(){return"WEBKIT"},p.hc=function(){return!1},p.Fd=function(e,t){return t==="audio"},p.hf=function(){return!0},p.Li=function(e){return e==="audio"},p.Wa=function(e){return rt.prototype.Wa.call(this,e),e.abr.minTimeToSwitch=.5,e},p.ej=function(){return!0},p.Mf=function(){return!1},(navigator.vendor||"").includes("Apple")&&(/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1||navigator.userAgentData&&navigator.userAgentData.platform&&navigator.userAgentData.platform.toLowerCase()=="macos"||navigator.platform&&navigator.platform.toLowerCase().includes("mac"))&&(zr=function(){return new Kg});function $g(){if(!Ow())throw Error("Not a Chromecast device!");rt.call(this),this.h=new vt(function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}),this.g=new vt(function(){var e=navigator.userAgentData&&navigator.userAgentData.platform||navigator.userAgent;return e=e.toLowerCase(),e.includes("android")?Uw:e.includes("fuchsia")?jw:Yg})}J($g,rt),p=$g.prototype,p.Ba=function(){return this.h.value()},p.Ob=function(){return"Chromecast with "+this.g.value()},p.Oa=function(){return"CAST"},p.Ha=function(){return"CHROMIUM"},p.hc=function(){return rt.prototype.hc.call(this)&&this.g.value()!==Yg},p.Bb=function(){return rt.prototype.Bb.call(this)&&this.g.value()!==Yg},p.Qi=function(){switch(this.g.value()){case Uw:return 0;case jw:return 3;default:return 1}},p.lc=function(){var e,t,n,r,i;return F(function(s){switch(s.g){case 1:if(e=m.cast&&cast.__platform__&&cast.__platform__.canDisplayType,t={width:1280,height:720},Z(s,2),!(n=e)){s.A(4);break}return C(s,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),5);case 5:n=s.h;case 4:if(n){t.width=3840,t.height=2160,s.A(6);break}if(!(r=e)){s.A(7);break}return C(s,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),8);case 8:r=s.h;case 7:r&&(t.width=1920,t.height=1080);case 6:ce(s,3);break;case 2:i=se(s),yn("Failed to check canDisplayType:",i);case 3:return s.return(t)}})},p.Wa=function(e){return rt.prototype.Wa.call(this,e),e.streaming.stallSkip=0,e},p.Bh=function(){return!1},p.ed=function(){return!0};function Ow(){return navigator.userAgent.includes("CrKey")&&!navigator.userAgent.includes("VIZIO SmartCast")}var Uw="Android",jw="Fuchsia",Yg="Linux";Ow()&&(zr=function(){return new $g});function qg(){rt.call(this);var e=this;this.i=new vt(function(){var t=navigator.userAgent.match(/(Chrome|Firefox)\/(\d+)/);return t?parseInt(t[2],10):null}),this.g=new vt(function(){return navigator.userAgent.match(/Edge?\//)?"Edge":navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Firefox")?"Firefox":"Unknown"}),this.h=new vt(function(){return navigator.userAgentData&&navigator.userAgentData.platform?navigator.userAgentData.platform.toLowerCase()=="windows":navigator.platform?navigator.platform.toLowerCase().includes("win32"):!1}),this.u=new vt(function(){return rt.prototype.Bb.call(e)?navigator.userAgent.match(/Edge?\//)?!e.h.value():!0:!1}),this.o=new vt(function(){return navigator.userAgent.includes("sony.hbbtv.tv")}),this.m=new vt(function(){return navigator.userAgentData&&navigator.userAgentData.platform?navigator.userAgentData.platform.toLowerCase()=="android":!!navigator.userAgent.includes("Android")})}J(qg,rt),p=qg.prototype,p.Ba=function(){return this.i.value()},p.Ob=function(){return this.g.value()},p.Fd=function(e){return vh(e)?this.g.value()==="Edge"&&this.h.value():!1},p.hh=function(){return this.g.value()==="Edge"&&this.h.value()},p.hf=function(){return this.g.value()==="Edge"&&this.h.value()},p.Bb=function(){return this.u.value()},p.Wa=function(e){if(rt.prototype.Wa.call(this,e),this.h.value())switch(this.g.value()){case"Firefox":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation"};break;case"Chrome":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation.3000","com.microsoft.playready.recommendation":"com.microsoft.playready.recommendation.3000"}}return this.m.value()&&(e.drm.defaultAudioRobustnessForWidevine="",e.drm.defaultVideoRobustnessForWidevine=""),e},p.Ef=function(){return this.g.value()==="Edge"||this.o.value()},p.ed=function(){if(this.Ha()==="GECKO"){var e=this.Ba();return e!==null?e>=100:rt.prototype.ed.call(this)}return rt.prototype.ed.call(this)},p.Ug=function(e){return this.Ha()==="GECKO"?e.startsWith("com.microsoft.playready.recommendation"):rt.prototype.Ug.call(this,e)},ph=function(){return new qg};function Qg(){rt.apply(this,arguments)}J(Qg,rt),p=Qg.prototype,p.Ba=function(){return null},p.Ob=function(){return"Hisense"},p.Oa=function(){return"TV"},p.hc=function(){return!1},p.lc=function(){var e={width:1920,height:1080},t=null;if(m.Hisense_Get4KSupportState)try{t=m.Hisense_Get4KSupportState()}catch(n){}return t==null&&(t=navigator.userAgent.includes("UHD")),t&&(e.width=3840,e.height=2160),Promise.resolve(e)},p.Wa=function(e){return rt.prototype.Wa.call(this,e),e.streaming.stallSkip=0,e},(navigator.userAgent.includes("Hisense")||navigator.userAgent.includes("VIDAA"))&&(zr=function(){return new Qg});function Jg(){rt.call(this),this.g=new vt(function(){var e=navigator.userAgent.match(/PlayStation (\d+)/);return e?parseInt(e[1],10):null})}J(Jg,rt),p=Jg.prototype,p.Ob=function(){return"PlayStation"},p.Oa=function(){return"CONSOLE"},p.Ha=function(){return"WEBKIT"},p.Ba=function(){return this.g.value()},p.hc=function(){return!1},p.fd=function(){return!1},p.Bb=function(){return!1},p.wh=function(){return this.Ba()===4},p.lc=function(){var e,t,n,r,i;return F(function(s){switch(s.g){case 1:return e={width:1920,height:1080},t=!1,Z(s,2),C(s,m.msdk.device.getDisplayInfo(),4);case 4:n=s.h,t=n.resolution==="4K",ce(s,3);break;case 2:return se(s),Z(s,5),C(s,m.msdk.device.getDisplayInfoImmediate(),7);case 7:r=s.h,t=r.resolution==="4K",ce(s,3);break;case 5:i=se(s),Be("PlayStation: Failed to get the display info:",i);case 3:return t&&(e.width=3840,e.height=2160),s.return(e)}})},p.Wa=function(e){return rt.prototype.Wa.call(this,e),this.Ba()===4&&e.drm.preferredKeySystems.push("com.microsoft.playready"),e.streaming.clearDecodingCache=!0,e},p.Ef=function(){return this.Ba()===4},p.Nf=function(){return this.Ba()!==4},navigator.userAgent.includes("PlayStation")&&(zr=function(){return new Jg});function Zg(){rt.call(this);var e=navigator.userAgent.match(/Tizen (\d+).(\d+)/);this.g=e?parseInt(e[1],10):null,this.h=e?parseInt(e[2],10):null}J(Zg,rt),p=Zg.prototype,p.Ba=function(){return this.g},p.Ob=function(){return"Tizen"},p.Ha=function(){return"CHROMIUM"},p.Oa=function(){return"TV"},p.Fd=function(){return!0},p.re=function(){return this.Ba()===3},p.hc=function(){return!1},p.fd=function(){var e=this.Ba();return e!==null?e>=4:rt.prototype.fd.call(this)},p.Bb=function(){return!1},p.ve=function(){return this.g&&this.h?this.g===5?this.h>=5:this.g>5:rt.prototype.ve.call(this)},p.lc=function(){var e=m.devicePixelRatio;e={width:m.screen.width*e>1920?3840:1920,height:m.screen.height*e>1080?2160:1080};try{if(webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution){var t=webapis.systeminfo.getMaxVideoResolution();e.width=t.width,e.height=t.height}else webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(e.width=7680,e.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(e.width=3840,e.height=2160)}catch(n){Be("Tizen: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},p.Wa=function(e){return rt.prototype.Wa.call(this,e),e.drm.ignoreDuplicateInitData=this.Ba()!==2,this.Ba()===3&&(e.streaming.crossBoundaryStrategy="reset_to_encrypted"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e.streaming.gapPadding=2,e},p.Ji=function(){var e=[];return this.g!==null&&this.g<5&&e.push("opus"),e},p.sd=function(e){try{if(webapis.avinfo.isHdrTvSupport())return e?"HLG":"PQ"}catch(t){return rt.prototype.sd.call(this,e)}return"SDR"},p.zi=function(){return!0},p.Ai=function(){return this.Ba()===3},navigator.userAgent.includes("Tizen")&&(zr=function(){return new Zg});function Jo(){rt.apply(this,arguments)}J(Jo,rt),Jo.prototype.Ba=function(){return null},Jo.prototype.Ob=function(){return"Vizio"},Jo.prototype.Oa=function(){return"TV"},Jo.prototype.hc=function(){return!1},navigator.userAgent.includes("VIZIO SmartCast")&&(zr=function(){return new Jo});function em(){rt.call(this),this.i=new vt(function(){return navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("Sky_STB")}),this.h=new vt(function(){return navigator.userAgent.includes("SOPOpenBrowser")}),this.g=new vt(function(){if(navigator.userAgent.includes("DT_STB_BCM"))return 11;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null})}J(em,rt),p=em.prototype,p.Ba=function(){return this.g.value()},p.Ob=function(){return"WebKit STB"},p.Oa=function(){return"TV"},p.Ha=function(){return"WEBKIT"},p.hc=function(){return!1},p.fd=function(){var e=this.g.value();return e!==null?e>=15:!0},p.Fd=function(){return this.h.value()},p.lc=function(){return Promise.resolve({width:m.screen.width*m.devicePixelRatio,height:m.screen.height*m.devicePixelRatio})},p.Nf=function(){return!this.i.value()},p.Mf=function(){return!1},(navigator.userAgent.includes("SOPOpenBrowser")||navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("Sky_STB")||!(!(navigator.vendor||"").includes("Apple")||/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1||navigator.userAgentData&&navigator.userAgentData.platform&&navigator.userAgentData.platform.toLowerCase()=="macos"||navigator.platform&&navigator.platform.toLowerCase().includes("mac")))&&(zr=function(){return new em});function tm(){rt.call(this);var e=this;this.h=pP(),this.g=null;try{var t=new PalmServiceBridge;t.onservicecallback=function(n){n=JSON.parse(n),e.g=n.configs["tv.model.supportHDR"]||n.configs["tv.config.supportDolbyHDRContents"]||!1},t.call("luna://com.webos.service.config/getConfigs",JSON.stringify({configNames:["tv.model.supportHDR","tv.config.supportDolbyHDRContents"]}))}catch(n){Be("WebOS: getConfigs call failed",n)}}J(tm,rt),p=tm.prototype,p.Ba=function(){return this.h},p.Ob=function(){return"WebOS"},p.Oa=function(){return"TV"},p.Ha=function(){return"CHROMIUM"},p.hc=function(){return!1},p.fd=function(){var e=this.Ba();return e!==null?e>3:rt.prototype.fd.call(this)},p.Bb=function(){return!1},p.ve=function(){var e=this.Ba();return e!==null?e>3:rt.prototype.ve.call(this)},p.lc=function(){var e={width:1920,height:1080};try{var t=JSON.parse(m.PalmSystem.deviceInfo);e.width=Math.max(1920,t.screenWidth),e.height=Math.max(1080,t.screenHeight)}catch(n){Be("WebOS: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},p.Wa=function(e){return rt.prototype.Wa.call(this,e),this.Ba()===3&&(e.streaming.crossBoundaryStrategy="reset"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e},p.sd=function(e){return this.g==null?(Be("WebOS: getConfigs call haven't finished"),rt.prototype.sd.call(this,e)):this.g?e?"HLG":"PQ":"SDR"};function pP(){var e=null,t=navigator.userAgent.match(/Chrome\/(\d+)/);switch(t&&(e=parseInt(t[1],10)),e){case 38:return 3;case 53:return 4;case 68:return 5;case 79:return 6;case 87:return 22;case 94:return 23;case 108:return 24;case 120:return 25;default:return null}}if(p.dj=function(){return!1},p.ed=function(){var e=this.Ba();return e!==null?e>=6:rt.prototype.ed.call(this)},navigator.userAgent.includes("Web0S")){var gP=new tm;zr=function(){return gP}}function nm(){rt.call(this),this.g=navigator.userAgent.includes("Edge/");var e=navigator.userAgent.match(/Edge?\/(\d+)/);this.h=e?parseInt(e[1],10):null}J(nm,rt),p=nm.prototype,p.Ba=function(){return this.h},p.Ob=function(){return"Xbox"},p.Oa=function(){return"CONSOLE"},p.Ha=function(){return this.g?"EDGE":"CHROMIUM"},p.Fd=function(){return!0},p.hh=function(){return!0},p.hf=function(){return!0},p.Yi=function(){return this.g},p.lc=function(){var e={width:1920,height:1080},t=Bw();if(t)try{var n=new t.Media.Protection.ProtectionCapabilities,r=t.Media.Protection.ProtectionCapabilityResult;t=null;do t=n.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation");while(t===r.maybe);t===r.probably&&(e.width=3840,e.height=2160)}catch(i){Be("Xbox: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},p.Wa=function(e){return rt.prototype.Wa.call(this,e),e.drm.parseInbandPsshEnabled=this.g,e.drm.preferredKeySystems.push("com.microsoft.playready"),this.g&&(e.streaming.gapPadding=.01),e},p.Ef=function(){return!0},p.Bh=function(){return!1};function Bw(){var e=null;try{e=typeof Windows<"u"?Windows:chrome.webview.hostObjects.sync.Windows}catch(t){}return e}(navigator.userAgent.includes("Xbox One")||Bw()!==null)&&(zr=function(){return new nm});function Fw(e,t,n){this.type=e,this.ha=t,this.segments=n||null}function Nd(e,t,n,r){this.id=e,this.name=t,this.attributes=n,this.value=r===void 0?null:r}Nd.prototype.toString=function(e){function t(i){return i.name+"="+(isNaN(Number(i.value))?'"'+i.value+'"':i.value)}var n="#"+this.name,r=this.attributes?this.attributes.filter(function(i){return e?!e.has(i.name):!0}).map(t):[];return this.value&&r.unshift(this.value),r.length>0&&(n+=":"+r.join(",")),n};function rm(e,t){return t?e.toString():(t=new Set().add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function Zo(e,t){return e.attributes.find(function(n){return n.name===t})||null}function Ae(e,t,n){return(e=Zo(e,t))?e.value:n||null}function lt(e,t){if(e=Zo(e,t),!e)throw new H(2,4,4023,t);return e.value}function Vw(e,t,n){n=n===void 0?[]:n,this.ha=t,this.g=e,this.wc=n}function Od(e,t){this.name=e,this.value=t}function Cr(e,t){return e.filter(function(n){return n.name==t})}function Hw(e,t){return e.filter(function(n){return lt(n,"TYPE")==t})}function Yt(e,t){e=x(e);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.name===t)return n;return null}function ea(e,t,n){return n=n===void 0?0:n,(e=Yt(e,t))?Number(e.value):n}function gs(e,t,n){return t?Gw(e,[t],n):[]}function Gw(e,t,n){if(!t.length)return[];var r=t;return n&&n.size&&(r=t.map(function(i){return Xw(i,n)})),$t(e,r)}function Xw(e,t){if(!t||!t.size)return e;e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}");var n=e.match(/{\$\w*}/g);if(n){n=x(n);for(var r=n.next();!r.done;r=n.next()){r=r.value;var i=r.slice(2,r.length-1),s=t.get(i);if(s)e=e.replace(r,s);else throw new H(2,4,4039,i)}}return e}function mP(){this.g=0}function im(e,t){t=wt(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var n=t.split(/\n+/m);if(!vP.test(n[0]))throw new H(2,4,4015);t=0;for(var r=!1,i=[],s=!0,o=0;o<n.length;o++){var u=n[o],l=n[o+1];if(u.startsWith("#")&&!u.startsWith("#EXT")||s)s=!1;else{if(u=zw(e,u),r||(Kw.has(u.name)?(t=1,r=!0):u.name=="EXT-X-STREAM-INF"||u.name=="EXT-X-MEDIA"?r=!0:$w.has(u.name)&&(t=1,r=!0)),$w.has(u.name)){if(t!=1)throw new H(2,4,4017);s=e,e=Array(Math.max(100,Math.floor((n.length-o)/2))),r=0,u=[];var f=[];for(l=null;o<n.length;o++){var g=n[o];g.startsWith("#EXT")?(g=zw(s,g),Kw.has(g.name)?i.push(g):g.name=="EXT-X-MAP"?l=g:g.name=="EXT-X-PART"?f.push(g):g.name=="EXT-X-PRELOAD-HINT"?Ae(g,"TYPE")=="PART"?f.push(g):Ae(g,"TYPE")=="MAP"&&(g.name="EXT-X-MAP",l=g):u.push(g)):(!g.startsWith("#")||g.startsWith("#EXT"))&&(g=g.trim(),l&&u.push(l),u=new Vw(g,u,f),r<e.length?e[r++]=u:(e.push(u),r++),u=[],f=[])}return f.length&&(l&&u.push(l),n=new Vw("",u,f),r<e.length?e[r++]=n:(e.push(n),r++)),new Fw(t,i,r<e.length?e.slice(0,r):e)}i.push(u),u.name=="EXT-X-STREAM-INF"&&(u.attributes.push(new Od("URI",l)),s=!0)}}return new Fw(t,i)}function zw(e,t){e=e.g++;var n=t.match(yP);if(!n)throw new H(2,4,4016,t);t=n[1];var r=n[2];n=[];var i;if(r){r=new lo(r);var s;for(Ww.lastIndex=0,(s=$i(r,Ww))&&(i=s[1]),sm.lastIndex=0,s=$i(r,sm);s;)n.push(new Od(s[1],s[2]||s[3])),co(r),s=$i(r,sm)}return new Nd(e,t,n,i)}var yP=/^#(EXT[^:]*)(?::(.*))?$/,vP=/^#EXTM3U($|[ \t\n])/m,Ww=/^([^,=]+)(?:,|$)/g,sm=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,Kw=new Set("EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" ")),$w=new Set("EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" "));function Yw(){}function qw(e,t){try{var n=Ud(e);return vo({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType},originalRequest:t})}catch(r){return es(r)}}function Ud(e){var t=e.split(":");if(t.length<2||t[0]!="data")throw new H(2,1,1004,e);if(t=t.slice(1).join(":").split(","),t.length<2)throw new H(2,1,1004,e);var n=t[0];e=m.decodeURIComponent(t.slice(1).join(",")),t=n.split(";"),n=t[0];var r=!1;t.length>1&&t[t.length-1]=="base64"&&(r=!0,t.pop());var i;return r?i=xr(e):i=Lr(e),{data:i,contentType:n}}de("shaka.net.DataUriPlugin",Yw),Yw.parse=qw,Ai("data",qw);function jd(){var e=this;this.g=this.h=null,this.G=1,this.B=new Map,this.M=new Map,this.C=new Map,this.C.set("video",new Map),this.C.set("audio",new Map),this.C.set(Fe,new Map),this.C.set("image",new Map),this.ec=new Map().set("com.apple.streamingkeydelivery",function(t,n,r){return WP(e,t,n,r)}).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",function(t){var n=lt(t,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var r="cenc";n=="SAMPLE-AES"&&(r="cbcs");var i=lt(t,"URI");n=Ud(i.split("?")[0]),i=i.split("?")[0],e.I.has(i)||(n=Le(n.data),e.I.set(i,n)),r=mi("com.widevine.alpha",r,[{initDataType:"cenc",initData:e.I.get(i)}]),(t=Ae(t,"KEYID"))&&r.keyIds.add(t.toLowerCase().substr(2)),t=Promise.resolve(r)}else t=Promise.resolve(null);return t}).set("com.microsoft.playready",function(t){var n=lt(t,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var r="cenc";n=="SAMPLE-AES"&&(r="cbcs"),t=lt(t,"URI"),t=Ud(t.split("?")[0]),t=Le(t.data),n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),n=gc(t,n,new Set,0),r=mi("com.microsoft.playready",r,[{initDataType:"cenc",initData:n}]),(t=ks(["<PLAYREADY>",pi(t),"</PLAYREADY>"].join("\n")))&&(r.licenseServerUri=Md(t)),r=Promise.resolve(r)}else r=Promise.resolve(null);return r}).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",function(t){var n=lt(t,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var r="cenc";n=="SAMPLE-AES"&&(r="cbcs");var i=lt(t,"URI");n=Ud(i.split("?")[0]),i=i.split("?")[0],e.I.has(i)||(n=Le(n.data),e.I.set(i,n)),r=mi("com.huawei.wiseplay",r,[{initDataType:"cenc",initData:e.I.get(i)}]),(t=Ae(t,"KEYID"))&&r.keyIds.add(t.toLowerCase().substr(2)),t=Promise.resolve(r)}else t=Promise.resolve(null);return t}),this.ob=new Set,this.i=new Map,this.l=null,this.H="",this.ab=new mP,this.N=-1,this.ma=1/0,this.ba=this.zc=this.kb=!1,this.F=new Ve(function(){if(e.X&&!e.g.continueLoadingWhenPaused&&(e.V.Ma(e.X,"timeupdate"),e.X.paused)){e.V.Aa(e.X,"timeupdate",function(){return yS(e)});return}yS(e)}),this.Fa=zd,this.m=null,this.eb=0,this.o=1/0,this.Ua=this.Ta=this.T=0,this.$=new xo,this.J=new Map,this.K=new Map,this.Da=new Map,this.va=new Map,this.O=new Map,this.ya=new Map,this.za=new Map,this.yc=this.oa=!1,this.bc=new Xr(5),this.j=null,this.R=!0,this.V=new et,this.u=this.X=null,this.dc=function(){return!1},this.I=new Map}p=jd.prototype,p.configure=function(e,t){var n=this.h&&e.updatePeriod!=this.g.updatePeriod&&e.updatePeriod>=0;this.g=e,t&&(this.dc=t),this.j&&this.j.configure(this.g),n&&this.m&&this.m.presentationTimeline.W()&&this.F.Kb()},p.start=function(e,t){var n=this,r;return F(function(i){return i.g==1?(n.h=t,n.oa=t.isLowLatencyMode(),C(i,fm(n,[e]).promise,2)):i.g!=3?(r=i.h,n.H=r.uri,C(i,wP(n,r.data),3)):i.return(n.m)})},p.stop=function(){this.F&&(this.F.stop(),this.F=null);var e=[];return this.$&&(e.push(this.$.destroy()),this.$=null),this.g=this.h=null,this.ob.clear(),this.m=null,this.i.clear(),this.M.clear(),this.K.clear(),this.B.clear(),this.Da.clear(),this.va.clear(),this.O.clear(),this.ya.clear(),this.za.clear(),this.I.clear(),this.j&&this.j.destroy(),this.V&&(this.V.release(),this.V=null),Promise.all(e)},p.update=function(){var e=this,t,n,r,i,s,o,u,l,f,g;return F(function(y){if(y.g==1){if(!Tn(e))return y.return();for(t=[],n=Array.from(e.i.values()),e.o=1/0,e.m.gapCount=0,r=n.filter(function(v){return!v.stream.isAudioMuxedInVideo&&v.stream.segmentIndex}),i=x(r),s=i.next();!s.done;s=i.next())o=s.value,t.push(xP(e,o));return C(y,Promise.all(t),2)}for(iS(e,r.map(function(v){return v.stream})),u=r.some(function(v){return v.ae==0}),r.length&&!u&&(Hd(e,zd),Bd(e)),u&&Bd(e),l=x(r),f=l.next();!f.done;f=l.next())g=f.value,g.stream.isAudioMuxedInVideo||!g.stream.segmentIndex||$r(g.stream.segmentIndex)||e.h.disableStream(g.stream);ie(y)})};function om(e,t){return Tn(e)?e.C.get(t.type):t.qf}function xP(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze;return F(function(Ne){switch(Ne.g){case 1:if(t.stream.isAudioMuxedInVideo)return Ne.return();for(n=[],r=x(t.P()),i=r.next();!i.done;i=r.next())s=i.value,o=new Pt(s),u=o.g,t.Te&&(t.Rb>=0&&u.add("_HLS_msn",String(t.Rb)),t.Sb>=0&&u.add("_HLS_part",String(t.Sb))),t.Ue&&u.add("_HLS_skip","YES"),hv(u)&&Ss(o,ro(u.toString())),n.push(o.toString());return Z(Ne,2),C(Ne,fm(e,n,!0).promise,4);case 4:l=Ne.h,ce(Ne,3);break;case 2:throw f=se(Ne),e.h&&e.h.disableStream(t.stream),f;case 3:if(!t.stream.segmentIndex)return Ne.return();if(g=im(e.ab,l.data),g.type!=1)throw new H(2,4,4017);return y=l.uri,y==l.originalUri||t.P().includes(y)||t.Cf.push(y),v=Cr(g.ha,"EXT-X-DEFINE"),w=am(e,v,y),A=t.stream,I=om(e,t),C(Ne,uS(e,g,A.mimeType,t.P,w),5);case 5:for(E=Ne.h,R=E.keyIds,M=E.drmInfos,D=E.encrypted,O=E.Oh,A.encrypted||!D||O||(A.encrypted=!0),X=function(st,ze){return st.size===ze.size&&[].concat(Y(st)).every(function(He){return ze.has(He)})},X(A.keyIds,R)||(A.keyIds=R,A.drmInfos=M,e.h.newDrmInfo(A)),b=pS(e,g,I,w,t.P,t.type),U=b.segments,(N=b.bandwidth)&&(A.bandwidth=N),z=Pc(A),B=x(U),W=B.next();!W.done;W=B.next())G=W.value,G.ea&&(G.ea.xd=z);A.segmentIndex.je(U,e.l.Ib()),U.length&&(re=ea(g.ha,"EXT-X-MEDIA-SEQUENCE",0),$=(ne=Yt(g.ha,"EXT-X-SKIP"))?Number(Ae(ne,"SKIPPED-SEGMENTS")):0,Q=oS(re,U),ae=Q.Rb,le=Q.Sb,t.Rb=ae+$,t.Sb=le,be=I.get(re),A.segmentIndex.Ya(be)),(xe=$r(A.segmentIndex))&&(t.Wc=xe.startTime,Ze=U[U.length-1],t.Mc=Ze.endTime),Yt(g.ha,"EXT-X-ENDLIST")&&(t.ae=!0),lm(e,g),cm(e,g.ha,A.type,w,t.P),ie(Ne)}})}p.onExpirationUpdated=function(){},p.onInitialVariantChosen=function(){},p.banLocation=function(e){this.j&&this.j.banLocation(e)},p.setMediaElement=function(e){this.X=e};function Qw(e,t,n){n=n===void 0?!1:n;for(var r=e.N==-1,i=x(t),s=i.next();!s.done;s=i.next()){s=s.value;var o=s.stream.segmentIndex,u=om(e,s);if(o=$r(o)){u=x(u);for(var l=u.next();!l.done;l=u.next()){l=x(l.value);var f=l.next().value;if(l.next().value==o.startTime){r&&(e.N=Math.max(e.N,f)),s.rg=f;break}}}}if(!(e.N<0))for(t=x(t),r=t.next();!r.done;r=t.next())r=r.value,(Wu(e,r.type)||n)&&(i=r.stream.segmentIndex)&&(s=e.N-r.rg,s>0&&(i.g.splice(0,s),i=$r(i))&&(i=-i.startTime,r.stream.segmentIndex.offset(i),Jw(e,r,i)))}function TP(e,t){if(e.ma==1/0){t=x(t);for(var n=t.next();!n.done;n=t.next())n=$r(n.value.stream.segmentIndex),n!=null&&n.h!=null&&(e.ma=Math.min(e.ma,n.h))}if(t=e.ma,t!=1/0){n=x(e.i.values());for(var r=n.next();!r.done;r=n.next())if(r=r.value,!Wu(e,r.type)){var i=r.stream.segmentIndex;if(i!=null){var s=$r(i);if(s)if(s.h==null)yn("Missing EXT-X-PROGRAM-DATE-TIME for stream",r.P(),"Expect AV sync issues!");else for(Jw(e,r,s.h-t-s.startTime),r=x(i),i=r.next();!i.done;i=r.next())i.value.Ch(t)}}}}function Jw(e,t,n){if(!(Math.abs(n)<.001)){t.Wc+=n,t.Mc+=n,e=om(e,t);for(var r=x(e),i=r.next();!i.done;i=r.next()){var s=x(i.value);i=s.next().value,s=s.next().value,e.set(i,s+n)}t.P()}}function wP(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze,Ne,st,ze,He,$e,Je,Ye;return F(function(Ge){switch(Ge.g){case 1:return n=bt,r=im(e.ab,t),i=Cr(r.ha,"EXT-X-DEFINE"),s=[],o=[],u=[],e.l=new Pe(null,0),e.l.cd(!0),l=function(){return[e.H]},f=null,g=new Map,r.type==1?(e.R=!1,ae=Cr(r.ha,"EXT-X-DEFINE"),g=am(e,ae,e.H),f=n.wa,le="",be=new Map,C(Ge,sS(e,e.G++,g,r,l,"",f,le,!0,"Media Playlist",null,be,null,!1,null,!1),7)):(AP(e,i),y=Cr(r.ha,"EXT-X-MEDIA"),v=Cr(r.ha,"EXT-X-STREAM-INF"),w=Cr(r.ha,"EXT-X-IMAGE-STREAM-INF"),A=Cr(r.ha,"EXT-X-I-FRAME-STREAM-INF"),I=Cr(r.ha,"EXT-X-SESSION-KEY"),E=Cr(r.ha,"EXT-X-SESSION-DATA"),R=Cr(r.ha,"EXT-X-CONTENT-STEERING"),IP(e,E),C(Ge,CP(e,R),4));case 4:if(!e.g.ignoreSupplementalCodecs){for(M=[],D=x(v),O=D.next(),X={};!O.done;X={bj:void 0},O=D.next())b=O.value,(U=Ae(b,"SUPPLEMENTAL-CODECS"))&&(X.bj=U.split(/\s*,\s*/).map(function(We){return We.split("/")[0]}),N=b.attributes.map((function(We){return function(Wt){var jt=Wt.name,pr=Wt.value;return jt=="CODECS"&&(pr=We.bj.join(","),Wt=Wt.value.split(","),Wt.length>1&&(Wt=bn("audio",Wt))&&(pr+=","+Wt)),new Od(jt,pr)}})(X)),M.push(new Nd(b.id,b.name,N,null)));for(v.push.apply(v,Y(M)),z=[],B=x(A),W=B.next(),G={};!W.done;G={cj:void 0},W=B.next())re=W.value,(ne=Ae(re,"SUPPLEMENTAL-CODECS"))&&(G.cj=ne.split(/\s*,\s*/).map(function(We){return We.split("/")[0]}),$=re.attributes.map((function(We){return function(Wt){var jt=Wt.name;return Wt=Wt.value,jt=="CODECS"&&(Wt=We.cj.join(",")),new Od(jt,Wt)}})(G)),z.push(new Nd(re.id,re.name,$,null)));A.push.apply(A,Y(z))}return EP(e,v),jP(e,y),Q=_P(e,A),C(Ge,PP(e,v,I,y,l,e.B,Q),5);case 5:return s=Ge.h,o=MP(e,y),C(Ge,RP(e,w,A),6);case 6:u=Ge.h,Ge.A(3);break;case 7:xe=Ge.h,e.i.set(e.H,xe),xe.stream&&(Ze=Pc(xe.stream),xe.stream.segmentIndex.Gb(function(We){We.ea&&(We.ea.xd=Ze)})),f=xe.stream.type,Ne=!0,(e.g.disableAudio&&xe.type=="audio"||e.g.disableVideo&&xe.type=="video"&&!xe.stream.codecs.includes(","))&&(Ne=!1),Ne&&s.push({id:0,language:tt(le||"und"),disabledUntilTime:0,primary:!0,audio:xe.type=="audio"?xe.stream:null,video:xe.type=="video"?xe.stream:null,bandwidth:xe.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new H(2,7,7001);if(cS(e,r),r.type==1&&(Tn(e)&&(dS(e,r),st=e.o,e.F.ka(st)),ze=Array.from(e.i.values()),um(e,ze),Bd(e),cm(e,r.ha,f,g,l)),e.m={presentationTimeline:e.l,variants:s,textStreams:o,imageStreams:u,offlineSessionIds:[],sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:e.u},e.ba||!e.g.hls.disableCodecGuessing){Ge.A(8);break}for(He=[],$e=x(e.m.variants),Je=$e.next();!Je.done;Je=$e.next())Ye=Je.value,Ye.audio&&Ye.audio.codecs===""&&He.push(Ye.audio.createSegmentIndex()),Ye.video&&Ye.video.codecs===""&&He.push(Ye.video.createSegmentIndex());return C(Ge,Promise.all(He),8);case 8:e.h.makeTextStreamsForClosedCaptions(e.m),ie(Ge)}})}function SP(e,t){var n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R;return F(function(M){if(M.g==1)return n=Ep(e.g.hls.mediaPlaylistFullMimeType),t.length?(r=gS(e,t),i=r.segment,s=r.segmentIndex,o=i.P(),(u=bo(o[0]))&&(l=hm.get(u))?M.return(Ep(l)):C(M,Promise.all([Zw(e,i.ea,0),Zw(e,i,s)]),2)):M.return(n);if(f=M.h,g=f[1].mimeType,y=f[0].data,v=f[1].data,w="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),A=["audio/mp4","video/mp4","video/iso.segment"],I=i.ea||A.includes(g),!I&&Ro(Le(v))){var D=v,O=e.g.disableAudio,X=e.g.disableVideo,b=e.g.disableText,U=Le(D),N=new ft().parse(U),z=N.Xd();U=N.Mg();var B=[],W=!1,G=!1;if(!O)switch(z.audio){case"aac":case"aac-loas":N.ub().length&&(B.push("mp4a.40.2"),W=!0);break;case"mp3":N.ub().length&&(B.push("mp4a.40.34"),W=!0);break;case"ac3":N.ub().length&&(B.push("ac-3"),W=!0);break;case"ec3":N.ub().length&&(B.push("ec-3"),W=!0);break;case"opus":N.ub().length&&(B.push("opus"),W=!0)}if(!X)switch(z.video){case"avc":U.codec?B.push(U.codec):B.push("avc1.42E01E"),G=!0;break;case"hvc":U.codec?B.push(U.codec):B.push("hvc1.1.6.L93.90"),G=!0;break;case"av1":B.push("av01.0.01M.08"),G=!0}if(B.length){if(O=W&&!G,X=new Map,G&&!b){for(b=new Wr("video/mp2t"),b.zf(D),D=x(b.Yf()),G=D.next();!G.done;G=D.next())G=G.value,X.set(G,G);b.Od()}U={type:O?"audio":"video",mimeType:"video/mp2t",codecs:B.join(", "),language:null,height:U.height,width:U.width,channelCount:null,sampleRate:null,closedCaptions:X,ye:null,colorGamut:null,frameRate:U.frameRate,timescale:null}}else U=null;if(E=U)return M.return(E)}else if((I||w.includes(u))&&(R=_M(y,v,e.g.disableText)))return M.return(R);return g?M.return(Ep(g)):M.return(n)})}function Zw(e,t,n){var r,i,s,o,u,l;return F(function(f){switch(f.g){case 1:return t?(r=wr,i=hu(t.P(),t.Jc(),t.Hc(),e.g.retryParameters),s=t instanceof Ce?1:0,C(f,Ui(e,i,r,{type:s}).promise,2)):f.return({mimeType:null,data:null});case 2:if(o=f.h,u=o.data,!t.aesKey){f.A(3);break}return C(f,Cp(u,t.aesKey,n),4);case 4:u=f.h;case 3:return t instanceof Ce?t.se(u,!0):t.se(u),(l=o.headers["content-type"])&&(l=l.split(";")[0].toLowerCase()),f.return({mimeType:l,data:u})}})}function Bd(e){if(Tn(e)){if(e.Fa==pm){for(var t=1/0,n=1/0,r=x(e.i.values()),i=r.next();!i.done;i=r.next())i=i.value,i.stream.segmentIndex&&i.stream.type!="text"&&!i.stream.isAudioMuxedInVideo&&(t=Math.min(t,i.Mc),n=Math.min(n,i.Wc));t=t-n||0,isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.Kf(t)}}else e.l.Ab(rS(e));if(!e.l.o)for(t=x(e.i.values()),n=t.next();!n.done;n=t.next())n=n.value,!n.stream.segmentIndex||n.type!="audio"&&n.type!="video"||(n=$r(n.stream.segmentIndex))&&n.h&&e.l.rh(n.h);e.l.pf()}function AP(e,t){var n=new Pt(e.H).g;t=x(t);for(var r=t.next();!r.done;r=t.next()){var i=r.value;r=Ae(i,"NAME");var s=Ae(i,"VALUE");i=Ae(i,"QUERYPARAM"),r&&s&&(e.B.has(r)||e.B.set(r,s)),i&&(r=n.get(i)[0])&&!e.B.has(r)&&e.B.set(i,r)}}function am(e,t,n){n=new Pt(n).g;var r=new Map;t=x(t);for(var i=t.next();!i.done;i=t.next()){var s=i.value,o=Ae(s,"NAME"),u=Ae(s,"VALUE");i=Ae(s,"QUERYPARAM"),s=Ae(s,"IMPORT"),o&&u&&(r.has(o)||r.set(o,u)),i&&(o=n.get(i)[0])&&!r.has(o)&&r.set(i,o),s&&(i=e.B.get(s))&&r.set(s,i)}return r}function EP(e,t){t=x(t);for(var n=t.next();!n.done;n=t.next()){var r=n.value,i=Ae(r,"AUDIO");n=Ae(r,"VIDEO");var s=Ae(r,"SUBTITLES");if(r=eS(e,r),s){var o=bn(Fe,r);e.K.set(s,o),Dr(r,o)}i&&(s=bn("audio",r),s||(s=e.g.hls.defaultAudioCodec),e.K.set(i,s)),n&&(i=bn("video",r),i||(i=e.g.hls.defaultVideoCodec),e.K.set(n,i))}}function IP(e,t){t=x(t);for(var n=t.next();!n.done;n=t.next()){var r=n.value,i=Ae(r,"DATA-ID");n=Ae(r,"URI");var s=Ae(r,"LANGUAGE");r=Ae(r,"VALUE"),i=new Map().set("id",i),n&&i.set("uri",gs([e.H],n,e.B)[0]),s&&i.set("language",s),r&&i.set("value",r),n=new Se("sessiondata",i),e.h&&e.h.onEvent(n)}}function CP(e,t){var n,r,i,s,o,u;return F(function(l){if(!e.h||!e.g)return l.return();for(r=x(t),i=r.next();!i.done;i=r.next())if(s=i.value,o=Ae(s,"PATHWAY-ID"),u=Ae(s,"SERVER-URI"),o&&u){e.j=new Yo(e.h),e.j.configure(e.g),e.j.i=[e.H],e.j.setManifestType("HLS"),e.j.h=o,n=Bu(e.j,u);break}return C(l,n,0)})}function MP(e,t){var n=Hw(t,"SUBTITLES"),r={};t=x(n);for(var i=t.next();!i.done;i=t.next()){i=i.value;var s=rm(i,!e.j);r[s]?r[s].push(i):r[s]=[i]}if(t=[],!e.g.disableText)for(var o in r)try{t.push(tS(e,r[o],new Map).stream)}catch(u){if(!e.g.hls.ignoreTextStreamFailures)throw u}for(o=x(n),n=o.next();!n.done;n=o.next())if(r=lt(n.value,"GROUP-ID"),(n=e.K.get(r))&&(r=e.M.get(r)))for(r=x(r),i=r.next();!i.done;i=r.next())i=i.value,i.stream.codecs=n,i.stream.mimeType=dm(Fe,n)||Vd(Fe),ta(i.stream);return t.filter(function(u){return u})}function ta(e){var t=new Set([Ct(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Gb(function(n){n.mimeType&&t.add(Ct(n.mimeType,e.codecs))}),e.fullMimeTypes=t}function RP(e,t,n){var r,i;return F(function(s){return s.g==1?(r=t.map(function(o){var u,l;return F(function(f){if(f.g==1)return e.g.disableThumbnails?f.return(null):(Z(f,2),C(f,BP(e,o),4));if(f.g!=2)return u=f.h,f.return(u.stream);if(l=se(f),e.g.hls.ignoreImageStreamFailures)return f.return(null);throw l})}).concat(n.map(function(o){if(e.g.disableThumbnails)return null;try{var u=nS(e,o);return u.stream.type!=="image"?null:u.stream}catch(l){if(e.g.hls.ignoreImageStreamFailures)return null;throw l}})),C(s,Promise.all(r),2)):(i=s.h,s.return(i.filter(function(o){return o})))})}function kP(e,t,n){t=t.filter(function(u){var l=Ae(u,"URI")||"";return u=Ae(u,"TYPE"),u!="SUBTITLES"&&(l!=""||u=="AUDIO")});var r={};t=x(t);for(var i=t.next();!i.done;i=t.next()){i=i.value;var s=rm(i,!e.j);r[s]?r[s].push(i):r[s]=[i]}for(var o in r)tS(e,r[o],n,!1)}function _P(e,t){return t.map(function(n){return n=nS(e,n),n.stream.type!=="video"?null:n.stream}).filter(function(n){return n})}function PP(e,t,n,r,i,s,o){var u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze,Ne,st,ze,He,$e;return F(function(Je){switch(Je.g){case 1:if(u=[],l=new Set,e.g.ignoreDrmInfo||!(n.length>0)){Je.A(2);break}f=x(n),g=f.next();case 3:if(g.done){Je.A(2);break}if(y=g.value,v=lt(y,"METHOD"),w=Ae(y,"KEYFORMAT")||"identity",A=null,v=="NONE"){Je.A(4);break}if(Gd(v)){I=gs(i(),lt(y,"URI"),s),E=I.sort().join(""),e.O.has(E)||(R=Nt(I,e.g.retryParameters),M=Ui(e,R,6).promise,e.O.set(E,M)),Je.A(4);break}if(w=="identity")return C(Je,vS(e,y,"",i,null,s),12);if(D=e.ec.get(w),!D){O=null,Je.A(10);break}return C(Je,D(y,"",null),11);case 11:O=Je.h;case 10:A=O,Je.A(6);break;case 12:A=Je.h;case 6:if(A){if(A.keyIds)for(X=x(A.keyIds),b=X.next();!b.done;b=X.next())U=b.value,l.add(U);u.push(A)}case 4:g=f.next(),Je.A(3);break;case 2:for(N={},z=x(t),B=z.next();!B.done;B=z.next())W=B.value,G=rm(W,!e.j),N[G]?N[G].push(W):N[G]=[W];re=[];for(ne in N)$=N[ne],Q=$[0],ae=Ae(Q,"FRAME-RATE"),le=Number(lt(Q,"BANDWIDTH"))||Number(Ae(Q,"AVERAGE-BANDWIDTH")),be=Ae(Q,"RESOLUTION"),xe=x(be?be.split("x"):[null,null]),Ze=xe.next().value,Ne=xe.next().value,st=Ae(Q,"VIDEO-RANGE"),(ze=Ae(Q,"REQ-VIDEO-LAYOUT"))&&ze.includes(",")&&(He=ze.split(",").filter(function(Ye){return Ye=="CH-STEREO"||Ye=="CH-MONO"}),ze=He[0]),ze=ze||"CH-MONO",$e=DP(e,$,r),re.push.apply(re,Y(UP(e,$e.audio,$e.video,le,Ze,Ne,ae,st,ze,u,l,o)));return Je.return(re.filter(function(Ye){return Ye!=null}))}})}function DP(e,t,n){for(var r={audio:[],video:[]},i=new Map,s=[],o=!1,u=!1,l=x(t),f=l.next();!f.done;f=l.next()){var g=f.value;f=Ae(g,"AUDIO");var y=Ae(g,"VIDEO"),v=f||y;v&&(s.includes(v)||s.push(v),(g=Ae(g,"PATHWAY-ID"))&&i.set(v,g),f?o=!0:y&&(u=!0))}s.length&&n.length&&(n=n.filter(function(A){return s.includes(lt(A,"GROUP-ID"))}),kP(e,n,i)),n=(i=s.sort().join(","))&&e.M.has(i)?e.M.get(i):[],o?r.audio.push.apply(r.audio,Y(n)):u&&r.video.push.apply(r.video,Y(n)),u=!1;var w=t.map(function(A){return lt(A,"URI")});return o=r.audio.find(function(A){return A&&A.P().find(function(I){return w.includes(I)})}),n=eS(e,t[0]),l=bn("video",n),(f=bn("audio",n))&&!l?(o="audio",u=r.audio.length>0&&!r.audio.some(function(A){return A.stream.isAudioMuxedInVideo})):!r.audio.length&&!r.video.length&&f&&l?(o="video",n=[[l,f].join()]):r.audio.length&&o?(o="audio",u=!0):o=r.video.length&&!r.audio.length?"audio":"video",u||(t=FP(e,t,n,o),i&&e.g.enableAudioGroups&&(t.stream.groupId=i),t.stream.type=="audio"&&o==="audio"&&r.audio.some(function(A){return A.stream.isAudioMuxedInVideo})&&(e=r.audio[0].stream,t.stream.language=e.language,t.stream.channelsCount=e.channelsCount,t.stream.label=e.label,t.stream.audioSamplingRate=e.audioSamplingRate,t.stream.originalId=e.originalId,t.stream.originalLanguage=e.originalLanguage),r[t.stream.type]=[t]),r}function eS(e,t){return t=Ae(t,"CODECS")||"",e.ba=t.length>0,e.ba||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),t=t.join(",")),Ip(t.split(/\s*,\s*/))}function LP(e){return(e=Ae(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}function bP(e){return(e=Ae(e,"SAMPLE-RATE"))?parseInt(e,10):null}function NP(e){return e=Ae(e,"CHANNELS"),e?(e=e.split("/"),e.length!=2?!1:e[1]==="JOC"||e[1].includes("ATMOS")):!1}function OP(e){return e=lt(e,"TYPE").toLowerCase(),e=="subtitles"&&(e=Fe),e}function UP(e,t,n,r,i,s,o,u,l,f,g,y){for(var v=x(n),w=v.next();!w.done;w=v.next())mS(w.value.stream,i,s,o,u,l,null);for(i=e.g.disableVideo,(!n.length||i)&&(n=[null]),i&&(t=t.filter(function(R){return!R.stream.isAudioMuxedInVideo})),i=e.g.disableAudio,(!t.length||i)&&(t=[null]),i=[],t=x(t),s=t.next();!s.done;s=t.next())for(s=s.value,o=x(n),u=o.next();!u.done;u=o.next()){var A=u.value;(u=s?s.stream:null)&&(u.drmInfos=f,u.keyIds=g),(l=A?A.stream:null)&&(l.drmInfos=f,l.keyIds=g,e.g.disableIFrames||t0(l,y)),l&&!u&&(l.bandwidth=r),!l&&u&&(u.bandwidth=r),v=s?s.stream.drmInfos:null,w=A?A.stream.drmInfos:null,A=A?A.P().sort().join(","):"";var I=s?s.P().sort().join(","):"",E=[];u&&u.codecs&&E.push(u.codecs),l&&l.codecs&&E.push(l.codecs),A=[A,I,E.sort()].join("-"),u&&l&&!gv(v,w)||e.ob.has(A)||(u={id:e.G++,language:u?u.language:"und",disabledUntilTime:0,primary:!!u&&u.primary||!!l&&l.primary,audio:u,video:l,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},i.push(u),e.ob.add(A))}return i}function jP(e,t){t=Hw(t,"CLOSED-CAPTIONS"),e.R=t.length==0,t=x(t);for(var n=t.next();!n.done;n=t.next()){var r=n.value,i=Ae(r,"LANGUAGE");n=tt(i||"und"),i||(i=Ae(r,"NAME"))&&(n=i),i=lt(r,"GROUP-ID"),r=lt(r,"INSTREAM-ID").replace("SERVICE","svc"),e.J.get(i)||e.J.set(i,new Map),e.J.get(i).set(r,n)}}function tS(e,t,n,r){r=r===void 0?!0:r;for(var i=[],s=[],o=new Map,u=x(t),l=u.next(),f={};!l.done;f={mi:void 0},l=u.next()){l=l.value,f.mi=++e.G,f=(function(I){return function(){return"shaka://hls-muxed"+I.mi}})(f);var g=r?lt(l,"URI"):Ae(l,"URI")||f();f=lt(l,"GROUP-ID"),i.push(g),s.push(f),o.set(f,g),(l=Ae(l,"PATHWAY-ID"))&&n.set(f,l)}if(r=s.sort().join(","),l=t[0],t="",u=OP(l),u==Fe)t=Ae(l,"CODECS")||"";else for(s=x(s),f=s.next();!f.done;f=s.next())if(f=f.value,e.K.has(f)){t=e.K.get(f);break}if(s=i.sort().join(","),u=="audio"&&r&&(s+=r),e.i.has(s))return e.i.get(s);if(f=e.G++,e.j)for(o=x(o),g=o.next();!g.done;g=o.next()){var y=x(g.value);g=y.next().value,y=y.next().value,(g=n.get(g))&&qo(e.j,f,g,y)}n=Ae(l,"LANGUAGE"),o=Ae(l,"NAME"),g=Ae(l,"DEFAULT")=="YES",y=u=="audio"?LP(l):null;var v=u=="audio"?NP(l):!1,w=Ae(l,"CHARACTERISTICS"),A=Ae(l,"FORCED")=="YES";return l=u=="audio"?bP(l):null,i=Fd(e,f,i,t,u,n,g,o,y,null,w,A,l,v),i.stream&&e.g.enableAudioGroups&&(i.stream.groupId=r),e.M.has(r)?e.M.get(r).push(i):e.M.set(r,[i]),e.i.set(s,i),i}function BP(e,t){var n,r,i,s,o,u,l,f,g,y;return F(function(v){return v.g==1?(n=lt(t,"URI"),r=Ae(t,"CODECS","jpeg")||"",e.i.has(n)?v.return(e.i.get(n)):(i=Ae(t,"LANGUAGE"),s=Ae(t,"NAME"),o=Ae(t,"CHARACTERISTICS"),u=Fd(e,e.G++,[n],r,"image",i,!1,s,null,null,o,!1,null,!1),(l=Ae(t,"RESOLUTION"))?C(v,u.stream.createSegmentIndex(),3):v.A(2))):(v.g!=2&&(f=$r(u.stream.segmentIndex),(g=f.tilesLayout)&&(u.stream.width=Number(l.split("x")[0])*Number(g.split("x")[0]),u.stream.height=Number(l.split("x")[1])*Number(g.split("x")[1])),u.stream.closeSegmentIndex()),(y=Ae(t,"BANDWIDTH"))&&(u.stream.bandwidth=Number(y)),e.i.set(n,u),v.return(u))})}function nS(e,t){var n="video",r=lt(t,"URI"),i=Ae(t,"CODECS")||"";if(i=="mjpg"&&(n="image"),e.i.has(r))return e.i.get(r);var s=Ae(t,"LANGUAGE"),o=Ae(t,"NAME"),u=Ae(t,"CHARACTERISTICS");return n=Fd(e,e.G++,[r],i,n,s,!1,o,null,null,u,!1,null,!1),i=Ae(t,"RESOLUTION"),s=x(i?i.split("x"):[null,null]),i=s.next().value,s=s.next().value,n.stream.width=Number(i)||void 0,n.stream.height=Number(s)||void 0,(t=Ae(t,"BANDWIDTH"))&&(n.stream.bandwidth=Number(t)),e.i.set(r,n),n}function FP(e,t,n,r){for(var i=e.G++,s=[],o=x(t),u=o.next();!u.done;u=o.next()){var l=u.value;u=lt(l,"URI"),l=Ae(l,"PATHWAY-ID"),e.j&&l&&qo(e.j,i,l,u),s.push(u)}if(o=s.sort().join(",")+n.sort().join(","),e.i.has(o))return e.i.get(o);u=s.join(",");e:{if(t=Ae(t[0],"CLOSED-CAPTIONS"),r=="video"){if(e.g.disableText){e.R=!1,t=null;break e}if(t){if(t!="NONE"){t=e.J.get(t);break e}e.R=!1}else if(!t&&e.J.size)for(t=x(e.J.keys()),t=t.next();!t.done;t=t.next()){t=e.J.get(t.value);break e}}t=null}return n=ao(r,n),r=Fd(e,i,s,n,r,null,!1,u,null,t,null,!1,null,!1),e.i.set(o,r),r}function Fd(e,t,n,r,i,s,o,u,l,f,g,y,v,w){function A(O){var X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze,Ne,st,ze;return F(function(He){switch(He.g){case 1:return X=bt,Z(He,2),C(He,O.promise,4);case 4:if(b=He.h,O.aborted)return He.return();if(U=b.uri,U!=b.originalUri&&(N=R.P(),N.includes(U)||R.Cf.push(U)),z=im(e.ab,b.data),z.type!=1)throw new H(2,4,4017);return B=Cr(z.ha,"EXT-X-DEFINE"),W=am(e,B,U),G=!1,(!e.ba&&e.g.hls.disableCodecGuessing||e.R&&i==X.wa&&!e.g.hls.disableClosedCaptionsDetection)&&z.segments.length>0&&(e.R=!1,G=!0),re=!e.ba&&e.g.hls.disableCodecGuessing,ne=Tn(e),C(He,sS(e,0,W,z,I,r,i,s,o,u,l,f,g,y,v,w,void 0,G,re),5);case 5:if($=He.h,O.aborted)return He.return();Q=$.stream,cS(e,z),Tn(e)&&!ne&&dS(e,z),R.Wc=$.Wc,R.Mc=$.Mc,R.Ue=$.Ue,R.Te=$.Te,R.ae=$.ae,R.qf=$.qf,R.Rb=$.Rb,R.Sb=$.Sb,E.segmentIndex=Q.segmentIndex,E.encrypted=Q.encrypted,E.drmInfos=Q.drmInfos,E.keyIds=Q.keyIds,E.mimeType=Q.mimeType,E.bandwidth=E.bandwidth||Q.bandwidth,E.codecs=E.codecs||Q.codecs,E.closedCaptions=E.closedCaptions||Q.closedCaptions,E.width=E.width||Q.width,E.height=E.height||Q.height,E.hdr=E.hdr||Q.hdr,E.colorGamut=E.colorGamut||Q.colorGamut,E.frameRate=E.frameRate||Q.frameRate,E.language=="und"&&Q.language!="und"&&(E.language=Q.language),E.language=E.language||Q.language,E.channelsCount=E.channelsCount||Q.channelsCount,E.audioSamplingRate=E.audioSamplingRate||Q.audioSamplingRate,ta(E),E.drmInfos.length&&e.h.newDrmInfo(E),ae=!1,(!f&&E.closedCaptions||f&&E.closedCaptions&&f.size!=E.closedCaptions.size)&&(ae=!0),e.m&&ae&&e.h.makeTextStreamsForClosedCaptions(e.m),i==X.Na&&(le=$r(Q.segmentIndex))&&le.ea&&(E.mimeType="application/mp4",ta(E)),be=Pc(E),E.segmentIndex.Gb(function($e){$e.ea&&($e.ea.xd=be)}),VP(e)&&(e.zc?um(e,[R]):(e.zc=!0,xe=Array.from(e.i.values()),Ze=xe.filter(function($e){return $e.stream.segmentIndex}),um(e,Ze),Bd(e),Ne=e.o,Ne>0&&e.F.ka(Ne))),cm(e,z.ha,E.type,W,I),e.m&&(e.m.startTime=e.u),ce(He,0);break;case 2:if(st=se(He),E.closeSegmentIndex(),st.code===7001)return He.return();if(ze=e.h.disableStream(E),!ze)throw st;ie(He)}})}function I(){return e.j&&n.length>1?Fu(e.j,t):R.Cf.concat(Gw([e.H],n,e.B))}var E=aS(e,r,i,s,o,u,l,f,g,y,v,w);n.some(function(O){return O.startsWith("shaka://hls-muxed")})&&(E.isAudioMuxedInVideo=!0,E.mimeType="video/mp2t",ta(E));var R={stream:E,type:i,Cf:[],Wc:0,Mc:0,qf:new Map,Ue:!1,Te:!1,ae:!1,rg:-1,Rb:-1,Sb:-1,P:I},M=null,D;return E.createSegmentIndex=function(){return M||(E.isAudioMuxedInVideo?(E.segmentIndex=new Qe([]),Promise.resolve()):(D=fm(e,R.P(),!0),M=new Promise(function(O){O(A(D))})))},E.closeSegmentIndex=function(){M&&!E.segmentIndex&&D.abort(),E.segmentIndex&&(E.segmentIndex.release(),E.segmentIndex=null),M=null},R}function rS(e){var t=1/0;e=x(e.i.values());for(var n=e.next();!n.done;n=e.next())n=n.value,n.stream.segmentIndex&&n.stream.type!="text"&&!n.stream.isAudioMuxedInVideo&&(t=Math.min(t,n.Mc));return t}function iS(e,t){var n=[];t=x(t);for(var r=t.next();!r.done;r=t.next())r=r.value,r.segmentIndex&&r.segmentIndex.Gb(function(i){n.push(i)});e.l.le(n)}function um(e,t){if(!Tn(e))for(var n=rS(e),r=x(t),i=r.next();!i.done;i=r.next())i.value.stream.segmentIndex.pd(0,n);iS(e,t.map(function(s){return s.stream})),r=Array.from(e.i.values()).filter(function(s){return s.stream.segmentIndex}),n=r.some(function(s){return s.stream.type=="audio"}),i=r.some(function(s){return s.stream.type=="video"}),r=Tn(e)&&!e.kb,n=!Tn(e)&&e.kb&&!(n&&i),e.g.hls.ignoreManifestProgramDateTime||r||n?Qw(e,t,r):(TP(e,t),e.g.hls.ignoreManifestProgramDateTimeForTypes.length>0&&Qw(e,t))}function Wu(e,t){return e.g.hls.ignoreManifestProgramDateTime?!0:e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function VP(e){if(!e.m)return!1;var t=[],n=[];e=x(e.m.variants);for(var r=e.next();!r.done;r=e.next())r=r.value,r.video&&t.push(r.video),r.audio&&n.push(r.audio);return!(t.length>0&&!t.some(function(i){return i.segmentIndex})||n.length>0&&!n.some(function(i){return i.segmentIndex}))}function sS(e,t,n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M){R=R===void 0?!0:R,M=M===void 0?!0:M;var D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae,le,be,xe,Ze,Ne,st,ze,He,$e,Je,Ye,Ge,We,Wt;return F(function(jt){switch(jt.g){case 1:if(D=r.segments||[],O=D.every(function(pr){return!!Yt(pr.ha,"EXT-X-GAP")}),!D.length||O)throw new H(2,4,4053);if(HP(e,r),Tn(e)&&lm(e,r),X=Tn(e)?e.C.get(o):new Map,b=pS(e,r,X,n,i,o),U=b.segments,N=b.bandwidth,re=G=W=B=z=null,!(U.length>0&&R)){jt.A(2);break}return C(jt,SP(e,U),3);case 3:ne=jt.h,o!=ne.type&&Tn(e)&&(e.C.set(ne.type,e.C.get(o)),e.C.set(o,new Map)),o=ne.type,u=ne.language,g=ne.channelCount,A=ne.sampleRate,e.g.disableText||(y=ne.closedCaptions),B=ne.height,z=ne.width,W=ne.ye,G=ne.colorGamut,re=ne.frameRate,M&&(E=ne.mimeType,s=ne.codecs);case 2:if(E){jt.A(4);break}return C(jt,zP(e,o,s,U),5);case 5:E=jt.h,o!=Fe||s||E!="application/mp4"||!U[0]||U[0].ea||(E="text/vtt");case 4:return C(jt,uS(e,r,E,i,n),6);case 6:if($=jt.h,Q=$.drmInfos,ae=$.keyIds,le=$.encrypted,be=$.Oh,le&&!Q.length&&!be)throw new H(2,4,4026);return xe=aS(e,s,o,u,l,f,g,y,v,w,A,I),xe.encrypted=le&&!be,xe.drmInfos=Q,xe.keyIds=ae,xe.mimeType=E,N&&(xe.bandwidth=N),ta(xe),o=="video"&&(z||B||W||G)&&mS(xe,z,B,re,W,null,G),Tn(e)&&lm(e,r),Ze=U[0].startTime,Ne=U[U.length-1],st=Ne.endTime,ze=new Qe(U),xe.segmentIndex=ze,$e=(He=Yt(r.ha,"EXT-X-SERVER-CONTROL"))?Zo(He,"CAN-SKIP-UNTIL")!=null:!1,Je=He?Zo(He,"CAN-BLOCK-RELOAD")!=null:!1,Ye=ea(r.ha,"EXT-X-MEDIA-SEQUENCE",0),Ge=oS(Ye,U),We=Ge.Rb,Wt=Ge.Sb,jt.return({stream:xe,type:o,Cf:[],P:i,Wc:Ze,Mc:st,Ue:$e,Te:Je,ae:!1,rg:-1,Rb:We,Sb:Wt,qf:X})}})}function oS(e,t){e=e+t.length-1;var n=-1;if(!t.length)return e++,{Rb:e,Sb:n};t=t[t.length-1];var r=t.g;return t.g.length?(n=r.length-1,r[r.length-1].isPreload()||(e++,n=0),{Rb:e,Sb:n}):(e++,t.o&&(n=0),{Rb:e,Sb:n})}function aS(e,t,n,r,i,s,o,u,l,f,g,y){var v=dm(n,t)||Vd(n),w=[];if(l){l=x(l.split(","));for(var A=l.next();!A.done;A=l.next())w.push(A.value)}return A=void 0,l=null,n==Fe?A=w.includes("public.accessibility.transcribes-spoken-dialog")&&w.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":w.includes("public.accessibility.describes-video")&&(l="visually impaired"),w.length||A!=="subtitle"||w.push("subtitle"),A=null,n!="video"&&(A=s),e={id:e.G++,originalId:s,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:v,codecs:t,kind:n==Fe?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:tt(r||"und"),originalLanguage:r,label:A,type:n,primary:i,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:w,forced:f,channelsCount:o,audioSamplingRate:g,spatialAudio:y,closedCaptions:u,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:l,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null},ta(e),e}function uS(e,t,n,r,i){var s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae;return F(function(le){switch(le.g){case 1:if(s=new Map,!e.g.ignoreDrmInfo&&t.segments){for(o=x(t.segments),u=o.next();!u.done;u=o.next())if(l=u.value,f=Cr(l.ha,"EXT-X-KEY"),g=null,f.length)for(g=fS(e,t,l.ha,r,i),y=x(f),v=y.next();!v.done;v=y.next())w=v.value,s.set(w,g)}I=A=!1,E=[],R=new Set,M=x(s),D=M.next();case 2:if(D.done){le.A(4);break}if(O=D.value,X=x(O),b=X.next().value,U=X.next().value,N=b,z=U,B=lt(N,"METHOD"),B=="NONE"){le.A(3);break}if(A=!0,W=Ae(N,"KEYFORMAT")||"identity",G=null,Gd(B)){I=!0,le.A(3);break}if(W=="identity")return C(le,vS(e,N,n,r,z,i),11);if(re=e.ec.get(W),!re){ne=null,le.A(9);break}return C(le,re(N,n,z),10);case 10:ne=le.h;case 9:G=ne,le.A(6);break;case 11:G=le.h;case 6:if(G){if(G.keyIds)for($=x(G.keyIds),Q=$.next();!Q.done;Q=$.next())ae=Q.value,R.add(ae);E.push(G)}case 3:D=M.next(),le.A(2);break;case 4:return le.return({drmInfos:E,keyIds:R,encrypted:A,Oh:I})}})}function lS(e,t,n,r,i){if(!m.crypto||!m.crypto.subtle)throw Be("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new H(2,4,4042);var s=0,o=Ae(t,"IV","");if(o){var u=Es(o.substr(2));if(u.byteLength!=16)throw new H(2,4,4048)}else s=ea(n.ha,"EXT-X-MEDIA-SEQUENCE",0);var l=gs(r(),lt(t,"URI"),i),f=l.sort().join("");if(n=t.toString()+"-"+s+"-"+f,!e.va.has(n)){var g={bitsKey:128,blockCipherMode:"CBC",iv:u,firstMediaSequenceNumber:s};switch(lt(t,"METHOD")){case"AES-256":g.bitsKey=256;break;case"AES-256-CTR":g.bitsKey=256,g.blockCipherMode="CTR"}g.fetchKey=function(){var y,v,w,A;return F(function(I){if(I.g==1)return e.O.has(f)||(y=Nt(l,e.g.retryParameters),v=Ui(e,y,6).promise,e.O.set(f,v)),C(I,e.O.get(f),2);if(I.g!=3){if(w=I.h,!w.data||w.data.byteLength!=g.bitsKey/8)throw new H(2,4,4049);return A={name:g.blockCipherMode=="CTR"?"AES-CTR":"AES-CBC",length:g.bitsKey},C(I,m.crypto.subtle.importKey("raw",w.data,A,!0,["decrypt"]),3)}g.cryptoKey=I.h,g.fetchKey=void 0,ie(I)})},e.va.set(n,g)}return e.va.get(n)}function cS(e,t){e.u==null&&(t=Yt(t.ha,"EXT-X-START"))&&(e.u=Number(lt(t,"TIME-OFFSET")))}function HP(e,t){var n=Yt(t.ha,"EXT-X-PLAYLIST-TYPE");t=Yt(t.ha,"EXT-X-ENDLIST"),t=n&&n.value=="VOD"||t,n=n&&n.value=="EVENT"&&!t,n=!t&&!n,t?Hd(e,zd):n?Hd(e,pm):Hd(e,QP)}function lm(e,t){var n=1/0,r=t.segments;if(r.length)for(var i=r.length-1;i>=0;){var s=Yt(r[i].ha,"EXTINF");if(s){n=Number(s.value.split(",")[0]);break}i--}if(r=Yt(t.ha,"EXT-X-TARGETDURATION"),!r)throw new H(2,4,4024,"EXT-X-TARGETDURATION");r=Number(r.value),(i=Yt(t.ha,"EXT-X-PART-INF"))&&(e.T=Number(lt(i,"PART-TARGET"))),t=Yt(t.ha,"EXT-X-SERVER-CONTROL"),e.oa&&e.T?(e.o=e.yc?e.T*5<=n?Math.min(e.T,e.o):Math.min(n,e.o):Math.min(e.T,e.o),e.Ua=t?Number(lt(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?Zo(t,"HOLD-BACK"):null,e.Ta=n?Number(n.value):0),e.eb=Math.max(r,e.eb)}function dS(e,t){var n=0;if(e.g.defaultPresentationDelay)n=e.g.defaultPresentationDelay;else if(e.Ua)n=e.Ua;else if(e.Ta)n=e.Ta;else for(var r=t.segments.length,i=r-Math.min(r,e.g.hls.liveSegmentsDelay);i<r;i++){var s=Yt(t.segments[i].ha,"EXTINF");n=s?n+Number(s.value.split(",")[0]):n+e.eb}e.u&&e.u<0&&(n=Math.min(-e.u,n),e.u+=n),e.l.Ui(0),e.l.qh(n),e.l.cd(!1)}function fS(e,t,n,r,i){var s=Yt(n,"EXT-X-MAP");if(!s)return null;var o=lt(s,"URI"),u=gs(r(),o,i);if(o=[u.toString(),Ae(s,"BYTERANGE","")].join("-"),!e.Da.has(o)){var l=void 0,f=null,g=!1;n=x(n);for(var y=n.next();!y.done;y=n.next())y=y.value,y.name=="EXT-X-KEY"?(g=lt(y,"METHOD"),Gd(g)&&y.id<s.id?(g=!1,l=lS(e,y,t,r,i)):g=g!="NONE"):y.name=="EXT-X-BYTERANGE"&&y.id<s.id&&(f=y);t=GP(u,s,f,l,g),e.Da.set(o,t)}return e.Da.get(o)}function GP(e,t,n,r,i){var s=0,o=null;return t=Ae(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(s=t.split("@"),o=Number(s[0]),s=Number(s[1]),o=s+o-1,r&&(n=o+1-s,n%16&&(o+=16-n%16))),new On(function(){return e},s,o,null,null,null,r,i)}function XP(e,t,n,r,i,s,o,u,l,f){var g=r.ha,y=Yt(g,"EXTINF"),v=0,w=0,A=null;r.wc.length&&(e.m.isLowLatency=!0);var I=null;if(!e.g.hls.ignoreManifestProgramDateTime){var E=Yt(g,"EXT-X-PROGRAM-DATE-TIME");E&&E.value&&(I=vi(E.value),e.kb=!0)}var R=Ci;if(Yt(g,"EXT-X-GAP")&&(e.m.gapCount++,R=2),!y){if(r.wc.length==0)throw new H(2,4,4024,"EXTINF");if(!e.oa)return null}var M=[];E=!1;var D=null,O=!1,X=!1;if(e.oa&&r.wc.length){v=t&&m.ReadableStream&&e.g.hls.allowLowLatencyByteRangeOptimization;for(var b=I,U={},N=0;N<r.wc.length;U={Tf:void 0,oe:void 0},N++){var z=r.wc[N],B=N==0?n:M[M.length-1],W=N==0?i:B.endTime,G=Number(Ae(z,"DURATION"))||e.T;if(G){var re=W+G,ne=0,$=null;if(z.name=="EXT-X-PRELOAD-HINT"?(ne=(ne=Ae(z,"BYTERANGE-START"))?Number(ne):0,(B=Ae(z,"BYTERANGE-LENGTH"))?$=ne+Number(B)-1:ne&&($=Number.MAX_SAFE_INTEGER)):(ne=Ae(z,"BYTERANGE"),$=x(hS(B,ne)),ne=$.next().value,$=$.next().value),U.oe=Ae(z,"URI"),U.oe){B=Ci,Ae(z,"GAP")=="YES"&&(e.m.gapCount++,B=2,O=!0),U.Tf=null;var Q=(function(le){return function(){return le.Tf==null&&(le.Tf=gs(u(),le.oe,s)),le.Tf}})(U);v&&ne>=0&&$!=null&&(D=Q,E=!0),W=new Ce(W,re,Q,ne,$,t,0,0,1/0,[],"",null,b,B,f),z.name=="EXT-X-PRELOAD-HINT"&&(W.Tg(),X=!0),Ae(z,"INDEPENDENT")!="YES"&&N>0&&W.wd(),z=l,z||(M.length&&M[0].mimeType?z=M[0].mimeType:U.oe&&(U=bo(U.oe),z=Xd.get(o).get(U)||null)),z&&(W.mimeType=z,TS.has(z)&&(W.ea=null)),M.push(W),b&&(b+=G)}}}}if(y){if(y=Number(y.value.split(",")[0]),y==0)return null;v=i+y}else if(M.length)v=M[M.length-1].endTime;else return null;E&&(O||M[0].startByte!=0?(E=!1,D=null):M=[]),(y=Yt(g,"EXT-X-BYTERANGE"))?(A=x(hS(n,y.value)),w=A.next().value,A=A.next().value):M.length&&(w=M[0].startByte,A=M[M.length-1].endByte),n="",y=null,o=="image"&&(n="1x1",o=Yt(g,"EXT-X-TILES"))&&(n=lt(o,"LAYOUT"),(o=Ae(o,"DURATION"))&&(y=Number(o)));var ae=null;return t=new Ce(i,v,function(){return D?D():(ae==null&&(ae=gs(u(),r.g,s)),ae||[])},w,A,t,0,0,1/0,M,n,y,I,R,f,M.length>0&&!!r.g),l&&(t.mimeType=l,TS.has(l)&&(t.ea=null)),E&&(e.yc=!0,t.ui(),X&&t.Tg()),t}function hS(e,t){var n=0,r=null;return t&&(n=t.split("@"),t=Number(n[0]),n=n[1]?Number(n[1]):e.endByte+1,r=n+t-1),[n,r]}function cm(e,t,n,r,i){if(n=="video"||n=="audio"){var s=e.l.m;if(s&&!Wu(e,n))for(t=Cr(t,"EXT-X-DATERANGE"),t=t.filter(function(B){return Zo(B,"START-DATE")!=null}).sort(function(B,W){return B=lt(B,"START-DATE"),W=lt(W,"START-DATE"),B<W?-1:B>W?1:0}),n=0;n<t.length;n++){var o=t[n];try{var u=lt(o,"START-DATE"),l=vi(u);if(!isNaN(l)){var f=Math.max(0,l-s),g=null,y=Ae(o,"END-DATE");if(y){var v=vi(y);if(!isNaN(v)&&(g=v-s,g<0))continue}if(g==null){var w=Ae(o,"DURATION")||Ae(o,"PLANNED-DURATION");if(w){var A=parseFloat(w);if(isNaN(A)||(g=f+A),l-s+A<0)continue}}var I=Ae(o,"CLASS")||"com.apple.quicktime.HLS",E=Ae(o,"END-ON-NEXT")=="YES";if(g==null&&E){for(var R=n+1;R<t.length;R++){var M=Ae(t[R],"CLASS")||"com.apple.quicktime.HLS";if(I==M){var D=lt(t[R],"START-DATE"),O=vi(D);if(!isNaN(O)&&O&&O>l){g=Math.max(0,O-s);break}}}if(g==null)continue}R=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var X=[],b=x(o.attributes),U=b.next();!U.done;U=b.next()){var N=U.value;if(!R.includes(N.name)){var z=Xw(N.value,r);(N.name=="X-ASSET-URI"||N.name=="X-ASSET-LIST")&&(z=gs(i(),N.value,r)[0]),X.push({key:N.name,description:"",data:z,mimeType:null,pictureType:null})}}X.length>1&&e.h.onMetadata(I,f,g,X)}}catch(B){}}}}function pS(e,t,n,r,i,s){function o(B){if(B=bo(B),!B)return null;var W=Xd.get(s).get(B);return W||(W=hm.get(B)),W}var u=t.segments,l=null,f=null,g=null,y=null,v=void 0,w=ea(t.ha,"EXT-X-DISCONTINUITY-SEQUENCE",-1),A=ea(t.ha,"EXT-X-MEDIA-SEQUENCE",0),I=Yt(t.ha,"EXT-X-SKIP"),E=I?Number(Ae(I,"SKIPPED-SEGMENTS")):0,R=A+E,M=0;Tn(e)&&n.has(R)&&(M=n.get(R)),M===0&&e.Fa==pm&&n.size>0&&!n.has(R)&&e.l.i!=null&&(M=e.l.Ib());var D=[],O=null;I=[];for(var X=0;X<u.length;X++){var b=u[X];(R=Yt(b.ha,"EXT-X-MAP"))&&R.id!==f&&(l=fS(e,t,b.ha,i,r),f=R.id),R=b.g;var U="";R&&(U=bo(R)),U!==y&&(g=o(R),y=U),U=X==0?M:O.endTime,R=A+E+X,Yt(b.ha,"EXT-X-DISCONTINUITY")&&(w++,O&&O.ea&&(O.ea.g=U));for(var N=x(b.ha),z=N.next();!z.done;z=N.next())z=z.value,z.name=="EXT-X-KEY"&&(Gd(lt(z,"METHOD"))?v=lS(e,z,t,i,r):v=void 0);if(n.set(R,U),U=XP(e,l,O,b,U,r,s,i,g,v)){if((O=ea(b.ha,"EXT-X-BITRATE"))?(I.push({bitrate:O,duration:U.endTime-U.startTime}),U.bandwidth=O):U.endByte?(b=ep(U))&&(O=U.endTime-U.startTime,b=b*8/O/1e3,I.push({bitrate:b,duration:O}),U.bandwidth=b):I.length&&(O=I.pop(),O.duration+=U.endTime-U.startTime,I.push(O),U.bandwidth=O.bitrate),U.bandwidth)for(O=x(U.g),b=O.next();!b.done;b=O.next())b.value.bandwidth=U.bandwidth;O=U,U.i=w,Wu(e,s)&&e.N!=null&&R<e.N||D.push(U)}}if(t=void 0,I.length&&(t=I.reduce(function(B,W){return B+W.duration},0),t=Math.round(I.reduce(function(B,W){return B+W.bitrate*W.duration},0)/t*1e3)),I=D.some(function(B){return B.h!=null})){for(n={},r=0;r<D.length;n={Ye:void 0,Xe:void 0,Qe:void 0,Zc:void 0,Pe:void 0},r++)if(n.Zc=D[r],n.Zc.h==null)for(n.Xe=0,n.Ye=r,i=(function(B){return function(){var W=D[B.Ye];if(W){if(W.h!=null)return W.h+B.Xe;B.Xe-=W.endTime-W.startTime,B.Ye+=1}return null}})(n),n.Pe=0,n.Qe=r,u=(function(B){return function(){var W=D[B.Qe];if(W){if(W!=B.Zc&&(B.Pe+=W.endTime-W.startTime),W.h!=null)return W.h+B.Pe;--B.Qe}return null}})(n);n.Zc.h==null;)n.Zc.h=u(),n.Zc.h==null&&(n.Zc.h=i())}if(I)for(n=x(D),r=n.next();!r.done;r=n.next())for(i=r.value,r=i.h,i=x(i.g),u=i.next();!u.done;u=i.next())u=u.value,u.h=r,r+=u.endTime-u.startTime;if(n=e.ma,I&&n!=1/0&&!Wu(e,s))for(e=x(D),I=e.next();!I.done;I=e.next())I.value.Ch(n);return{segments:D,bandwidth:t}}function dm(e,t){if(e==Fe){if(t=="vtt"||t=="wvtt")return"text/vtt";if(t&&t!=="")return"application/mp4"}return e!="image"||t&&t!="jpeg"?e=="audio"&&t=="mp4a.40.34"?"audio/mpeg":t=="mjpg"?"application/mp4":null:"image/jpeg"}function Vd(e){return e==Fe?"text/vtt":Xd.get(e).get("mp4")}function gS(e,t){e=Tn(e)?Math.trunc((t.length-1)/2):0;for(var n=t[e];n.Kc()==2&&e+1<t.length;)e++,n=t[e];return{segment:n,segmentIndex:e}}function zP(e,t,n,r){var i,s,o,u,l,f,g,y,v,w,A,I,E;return F(function(R){switch(R.g){case 1:return i=wr,s=gS(e,r),o=s.segment,o.status==2?R.return(Vd(t)):(l=o.P(),(f=bo(l[0]))&&(g=Xd.get(t),(y=g.get(f))||(y=hm.get(f)))?R.return(y):(u=dm(t,n))?R.return(u):(w=1,A=Nt(l,e.g.retryParameters),Z(R,2),A.method="HEAD",C(R,Ui(e,A,i,{type:w}).promise,4)));case 4:I=R.h,v=I.headers["content-type"],ce(R,3);break;case 2:if(E=se(R),!E||E.code!=1002&&E.code!=1001){R.A(3);break}return A.method="GET",e.g.hls.allowRangeRequestsToGuessMimeType&&(A.headers.Range="bytes=0-0"),C(R,Ui(e,A,i,{type:w}).promise,6);case 6:I=R.h,v=I.headers["content-type"];case 3:if(!v){R.A(7);break}if(u=v.toLowerCase().split(";")[0],u!="application/octet-stream"){R.A(8);break}if(I.data.byteLength){R.A(9);break}return A.method="GET",C(R,Ui(e,A,i,{type:w}).promise,10);case 10:I=R.h;case 9:Ro(Le(I.data))&&(u="video/mp2t");case 8:if(u!="application/octet-stream")return R.return(u);case 7:return R.return(Vd(t))}})}function mS(e,t,n,r,i,s,o){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(r)||void 0,e.hdr=i||void 0,e.videoLayout=s||void 0,e.colorGamut=o||void 0)}function fm(e,t,n){return Ui(e,Nt(t,e.g.retryParameters),0,{type:n?2:3})}function yS(e){var t,n,r,i,s,o;return F(function(u){switch(u.g){case 1:return e.h?(Z(u,2),t=Date.now(),C(u,e.update(),4)):u.return();case 4:n=Date.now(),Tn(e)&&(r=(n-t)/1e3,e.bc.sample(1,r),i=e.g.updatePeriod>0?e.g.updatePeriod:e.o,s=Math.max(0,i-yr(e.bc)),e.F.ka(s)),ce(u,3);break;case 2:if(o=se(u),!e.h)return u.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(o),u.return();o.severity=1,e.h.onError(o),e.F.ka(.1);case 3:if(!e.h)return u.return();e.h.onManifestUpdated(),ie(u)}})}function Tn(e){return e.Fa!=zd}function Hd(e,t){e.Fa=t,e.l&&e.l.cd(!Tn(e)),Tn(e)||e.F.stop()}function Ui(e,t,n,r){if(!e.$)throw new H(2,7,7001);return r||(r={}),r.isPreload=e.dc(),t=e.h.networkingEngine.request(n,t,r),Ns(e.$,t),t}function Gd(e){return e=="AES-128"||e=="AES-256"||e=="AES-256-CTR"}function WP(e,t,n,r){var i,s,o,u,l,f;return F(function(g){if(g.g==1){if(n=="video/mp2t")throw new H(2,4,4040);if(m.shakaMediaKeysPolyfill==="apple")throw new H(2,4,4041);if(i=lt(t,"METHOD"),s=["SAMPLE-AES","SAMPLE-AES-CTR"],!s.includes(i))return g.return(null);o="cenc",i=="SAMPLE-AES"&&(o="cbcs"),u=lt(t,"URI"),l=mi("com.apple.fps",o,null,u);var y=new Pt(u).Eb.replace(/-/g,"").toLowerCase();return(f=y.length===32&&/^[0-9a-f]+$/.test(y)?y:null)||!r?g.A(2):C(g,xS(e,r),3)}return g.g!=2&&(f=g.h),f&&l.keyIds.add(f),g.return(l)})}function vS(e,t,n,r,i,s){var o,u,l,f,g,y,v,w,A,I,E,R;return F(function(M){switch(M.g){case 1:if(n=="video/mp2t")throw new H(2,4,4040);if(m.shakaMediaKeysPolyfill==="apple")throw new H(2,4,4041);if(o=lt(t,"METHOD"),u=["SAMPLE-AES","SAMPLE-AES-CTR"],!u.includes(o))return M.return(null);if(l=gs(r(),lt(t,"URI"),s),l[0].startsWith("data:text/plain;base64,")){f=gi(xr(l[0].split("data:text/plain;base64,").pop())),M.A(2);break}return g=l.sort().join(""),e.ya.has(g)||(y=Nt(l,e.g.retryParameters),v=Ui(e,y,6).promise,e.ya.set(g,v)),C(M,e.ya.get(g),3);case 3:w=M.h,f=gi(w.data);case 2:if(A="00000000000000000000000000000000",!i){M.A(4);break}return C(M,xS(e,i),5);case 5:(I=M.h)&&(A=I);case 4:return E=new Map,E.set(A,f),R="cenc",o=="SAMPLE-AES"&&(R="cbcs"),M.return(vv(E,R))}})}function xS(e,t){var n,r,i,s;return F(function(o){return o.g==1?(n=null,e.za.has(t)?(n=e.za.get(t),o.A(2)):(r=hu(t.P(),t.Jc(),t.Hc(),e.g.retryParameters),i=wr,C(o,Ui(e,r,i,{type:0}).promise,3))):(o.g!=2&&(s=o.h,t.se(s.data),n=DM(s.data),e.za.set(t,n)),o.return(n))})}de("shaka.hls.HlsParser",jd);var hm=new Map().set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),KP=new Map().set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),$P=new Map().set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),YP=new Map().set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),qP=new Map().set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),Xd=new Map().set("audio",KP).set("video",$P).set("text",YP).set("image",qP),TS=new Set(["video/mp2t"].concat(Y(wi))),zd="VOD",QP="EVENT",pm="LIVE";Is("application/x-mpegurl",function(){return new jd}),Is("application/vnd.apple.mpegurl",function(){return new jd});function Wd(e){return Md(e)}var JP=new Map().set("com.microsoft.playready",Wd).set("com.microsoft.playready.recommendation",Wd).set("com.microsoft.playready.software",Wd).set("com.microsoft.playready.hardware",Wd);function gm(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.u=1,this.i=null,this.F=new Xr(5),this.o=new Ve(function(){ZP(e)}),this.C=new xo,this.m=new Map,this.B=function(){return!1}}p=gm.prototype,p.configure=function(e,t){this.g=e,t&&(this.B=t)},p.start=function(e,t){var n=this;return F(function(r){if(r.g==1)return n.l=[e],n.h=t,C(r,mm(n),2);if(!n.h)throw new H(2,7,7001);return r.return(n.j)})};function ZP(e){var t;F(function(n){switch(n.g){case 1:return Z(n,2),C(n,mm(e),4);case 4:ce(n,3);break;case 2:t=se(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();ie(n)}})}p.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,this.o!=null&&(this.o.stop(),this.o=null),this.m.clear(),this.C.destroy()},p.update=function(){var e=this,t;return F(function(n){if(n.g==1)return Z(n,2),C(n,mm(e),4);if(n.g!=2)return ce(n,0);if(t=se(n),!e.h||!t)return n.return();e.h.onError(t),ie(n)})},p.onExpirationUpdated=function(){},p.onInitialVariantChosen=function(){},p.banLocation=function(){},p.setMediaElement=function(){};function mm(e){var t,n,r,i,s,o,u;return F(function(l){if(l.g==1)return t=Nt(e.l,e.g.retryParameters),n=e.h.networkingEngine,r=Date.now(),i=n.request(0,t,{type:5,isPreload:e.B()}),Ns(e.C,i),C(l,i.promise,2);if(s=l.h,!e.h)return l.return();s.uri&&!e.l.includes(s.uri)&&e.l.unshift(s.uri);var f=s.uri,g=s.data,y=e.g.mss.manifestPreprocessor;if(y!=zc){if(qe("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),g=Sw(g,"SmoothStreamingMedia"),!g)throw new H(2,4,4046,f);y(g),g=Lr(g.outerHTML)}var v=Ba(g,"SmoothStreamingMedia");if(!v)throw new H(2,4,4046,f);if(f=e.g.mss.manifestPreprocessorTXml,f!=Wc&&f(v),e.i||(e.i=new Pe(null,0)),f=De(v,"IsLive",$l,!1))throw new H(2,4,4047);e.i.cd(!f),y=De(v,"TimeScale",rn,1e7),g=De(v,"DVRWindowLength",rn),f&&(g===0||isNaN(g))&&(g=1/0);var w=De(v,"CanSeek",$l,!1);g===0&&w&&(g=1/0),w=null,g&&g>0&&(w=g/y),f&&!isNaN(e.g.availabilityWindowOverride)&&(w=e.g.availabilityWindowOverride),w==null&&(w=1/0),e.i.Kf(w),g=De(v,"Duration",rn,1/0),f||e.i.Ab(g/y),f={variants:[],textStreams:[],timescale:y,duration:g/y};var A;for(w=it(v,"Protection"),y=e.g.mss.keySystemsBySystemId,g=[],w=x(w),A=w.next();!A.done;A=w.next())g=g.concat(it(A.value,"ProtectionHeader"));if(g.length){for(w=[],A=0;A<g.length;A++){var I=g[A],E=I.attributes.SystemID.toLowerCase(),R=y[E];if(R){var M;e:{if(M=q1(I)){M=x(Kr(M,"DATA"));for(var D=M.next();!D.done;D=M.next())if(D=gt(D.value,"KID")){M=xr(Dt(D)),M=new Uint8Array([M[3],M[2],M[1],M[0],M[5],M[4],M[7],M[6]].concat(Y(M.slice(8)))),M=gi(M);break e}}M=null}D=xr(Dt(I)),E=Es(E.replace(/-/g,"")),E=[{initData:gc(D,E,new Set,0),initDataType:"cenc",keyId:M}],E=mi(R,"cenc",E),M&&E.keyIds.add(M),(R=JP.get(R))&&(E.licenseServerUri=R(I)),w.push(E)}}y=w}else y=[];for(A=y,w=[],y=[],g=[],v=it(v,"StreamIndex"),v=x(v),I=v.next();!I.done;I=v.next()){I=I.value,R=it(I,"QualityLevel"),E=f.timescale,M=f.duration,D=it(I,"c");for(var O=[],X=0,b=0;b<D.length;++b){var U=D[b],N=D[b+1],z=De(U,"t",rn),B=De(U,"d",rn);if(U=De(U,"r",nn),!B)break;if(z=z!=null?z:X,(U=U||0)&&U--,U<0)if(N){if(N=De(N,"t",rn),N==null)break;if(z>=N)break;U=Math.ceil((N-z)/B)-1}else{if(M==1/0)break;if(z/E>=M)break;U=Math.ceil((M*E-z)/B)-1}for(N=0;N<=U;++N)X=z+B,O.push({start:z/E,end:X/E,Hh:z}),z=X}for(E=O,R=x(R),M=R.next();!M.done;M=R.next())(M=eD(e,I,M.value,E,A,f))&&(M.type!="audio"||e.g.disableAudio?M.type!="video"||e.g.disableVideo?M.type!=Fe||e.g.disableText||g.push(M):y.push(M):w.push(M))}for(v=[],w=x(w.length>0?w:[null]),A=w.next();!A.done;A=w.next())for(A=A.value,I=x(y.length>0?y:[null]),O=I.next();!O.done;O=I.next())R=v,E=R.push,M=e,D=A,O=O.value,b=0,D&&D.bandwidth&&D.bandwidth>0&&(b+=D.bandwidth),O&&O.bandwidth&&O.bandwidth>0&&(b+=O.bandwidth),M={id:M.u++,language:D?D.language:"und",disabledUntilTime:0,primary:!!D&&D.primary||!!O&&O.primary,audio:D,video:O,bandwidth:b,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},E.call(R,M);f.variants=v,f.textStreams=g,e.j?(e.j.variants=f.variants,e.j.textStreams=f.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:f.variants,textStreams:f.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},e.i.pf()),Promise.resolve(),o=Date.now(),u=(o-r)/1e3,e.F.sample(1,u),ie(l)})}function eD(e,t,n,r,i,s){var o=t.attributes.Type;if(o!=="audio"&&o!=="video"&&o!=="text")return Be("Ignoring unrecognized type:",o),null;var u=t.attributes.Language,l=e.u++,f=De(n,"Bitrate",ri),g=De(n,"MaxWidth",ri),y=De(n,"MaxHeight",ri),v=De(n,"Channels",ri),w=De(n,"SamplingRate",ri),A=s.duration;r.length&&(A=r[r.length-1].end-r[0].start);var I=e.i.getDuration();e.i.Ab(Math.min(A,I)),(I=t.attributes.Name)&&(I+=n.attributes.Index),I||(I=String(l));var E={id:l,originalId:I,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:f||0,width:g||void 0,height:y||void 0,kind:"",encrypted:i.length>0,drmInfos:i,keyIds:new Set,language:tt(u||"und"),originalLanguage:u,label:"",type:"",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:v,audioSamplingRate:w,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:A,timescale:s.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};if((i=t.attributes.Subtype)&&((i=oD.get(i))&&E.roles.push(i),i==="main"&&(E.primary=!0)),i=n.attributes.FourCC,(i===null||i==="")&&(i=t.attributes.FourCC),!i){if(o==="audio")i="AAC";else if(o==="video")return Be('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null}if(!sD.includes(i.toUpperCase()))return Be("Codec not supported:",i),null;switch(n=tD(n,o,i,E),E.mssPrivateData.codecPrivateData=n,o){case"audio":if(!n)return Be("Quality unsupported without CodecPrivateData",o),null;E.type="audio",E.mimeType="mss/audio/mp4",E.codecs=nD(i,n);break;case"video":if(!n)return Be("Quality unsupported without CodecPrivateData",o),null;E.type="video",E.mimeType="mss/video/mp4",E.codecs=rD(n);break;case"text":E.type=Fe,E.mimeType="application/mp4",(i==="TTML"||i==="DFXP")&&(E.codecs="stpp")}return E.fullMimeTypes.add(Ct(E.mimeType,E.codecs)),E.createSegmentIndex=function(){if(E.segmentIndex)return Promise.resolve();if(e.m.has(E.id))var R=e.m.get(E.id);else R=[],E.type=="video"&&(R=E.mssPrivateData.codecPrivateData.split("00000001").slice(1)),R={id:E.id,type:E.type,codecs:E.codecs,encrypted:E.encrypted,timescale:E.mssPrivateData.timescale,duration:E.mssPrivateData.duration,Cb:R,Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:null,stream:E},R=Eo(new Ao([R])),e.m.set(E.id,R);return R=iD(e,new On(function(){return[]},0,null,Pc(E),E.mssPrivateData.timescale,R,null,E.encrypted),E,t,r),E.segmentIndex=new Qe(R),Promise.resolve()},E.closeSegmentIndex=function(){E.segmentIndex&&(E.segmentIndex.release(),E.segmentIndex=null)},E}function tD(e,t,n,r){if(e=e.attributes.CodecPrivateData)return e;if(t!=="audio")return null;t=r.channelsCount||2,e=r.audioSamplingRate||44100;var i={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return r=i[e],n==="AACH"?(n=new Uint8Array(4),e=i[e*2],n[0]=40|r>>1,n[1]=r<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|r>>1,n[1]=r<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}function nD(e,t){var n=0;return e==="AACH"&&(n=5),t?n===0&&(n=(parseInt(t.substr(0,2),16)&248)>>3):(n=2,e==="AACH"&&(n=5)),"mp4a.40."+n}function rD(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}function iD(e,t,n,r,i){var s=r.attributes.Url.replace("{bitrate}",String(n.bandwidth));r=[],i=x(i);for(var o=i.next(),u={};!o.done;u={Of:void 0},o=i.next())u.Of=o.value,r.push(new Ce(u.Of.start,u.Of.end,(function(l){return function(){return $t(e.l,[s.replace("{start time}",String(l.Of.Hh))])}})(u),0,null,t,0,0,n.mssPrivateData.duration));return r}de("shaka.mss.MssParser",gm);var sD="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),oD=new Map().set("CAPT","main").set("SUBT","alternate").set("DESC","main");Is("application/vnd.ms-sstr+xml",function(){return new gm});function wS(e,t,n,r,i,s,o){if(n>=200&&n<=299&&n!=202||n==304)return{uri:i||r,originalUri:r,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:s};s=null;try{s=ei(t)}catch(u){}throw new H(n==401||n==403?2:1,1,1001,r,n,s,e,o,i||r)}function ym(){}function Kd(e,t,n,r,i,s){var o=new fD;try{wo(t.headers).forEach(function(g,y){o.append(y,g)})}catch(g){return es(new H(1,1,1002,e,g,n))}var u=new cD,l={Th:!1,gj:!1};if(e=aD(e,t,n,{body:t.body||void 0,headers:o,method:t.method,signal:u.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},l,r,i,t.streamDataCallback,s.minBytesForProgressEvents||0),e=new kt(e,function(){return l.Th=!0,u.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var f=new Ve(function(){l.gj=!0,u.abort()});f.ka(t/1e3),e.finally(function(){f.stop()})}return e}function aD(e,t,n,r,i,s,o,u,l){var f,g,y,v,w,A,I,E,R,M,D,O,X,b,U;return F(function(N){switch(N.g){case 1:return f=lD,g=dD,v=new ArrayBuffer(0),A=w=0,I={},E=Date.now(),Z(N,2),C(N,f(e,r),4);case 4:if(y=N.h,I=uD(y.headers),o(I),r.method=="HEAD"){N.A(5);break}return M=(R=y.headers.get("Content-Length"))?parseInt(R,10):0,y.body?(D=y.clone().body.getReader(),O=function(z){function B(){var W,G,re,ne;return F(function($){switch($.g){case 1:return Z($,2),C($,D.read(),4);case 4:W=$.h,ce($,3);break;case 2:return se($),$.return();case 3:if(W.done){$.A(5);break}if(w+=W.value.byteLength,!u){$.A(5);break}return C($,u(W.value),5);case 5:G=Date.now(),re=w-A,(G-E>100&&re>=l||W.done)&&(ne=W.done?0:M-w,s(G-E,re,ne),A=w,E=G),W.done?z.close():(z.enqueue(W.value),B()),ie($)}})}B()},new g({start:O}),C(N,y.arrayBuffer(),8)):C(N,y.arrayBuffer(),9);case 8:v=N.h,N.A(5);break;case 9:v=N.h,X=Date.now(),s(X-E,v.byteLength,0);case 5:t.headers.Range&&(b=t.headers.Range.replace("bytes=","").split("-").filter(function(z){return z}).map(function(z){return parseInt(z,10)}),b.length==2&&v.byteLength!=b[1]-b[0]+1&&Be("Payload length does not match range requested bytes",t,y)),ce(N,3);break;case 2:throw U=se(N),i.Th?new H(1,1,7001,e,n):i.gj?new H(1,1,1003,e,n):new H(1,1,1002,e,U,n);case 3:return N.return(wS(I,v,y.status,e,y.url,t,n))}})}function uD(e){var t={};return e.forEach(function(n,r){t[r.trim()]=n}),t}function SS(){if(m.ReadableStream)try{new ReadableStream({})}catch(e){return!1}else return!1;if(m.Response){if(!new Response("").body)return!1}else return!1;return!(!m.fetch||"polyfill"in m.fetch||!m.AbortController)}de("shaka.net.HttpFetchPlugin",ym),ym.isSupported=SS,ym.parse=Kd;var lD=m.fetch,cD=m.AbortController,dD=m.ReadableStream,fD=m.Headers;SS()&&(Ai("http",Kd,2,!0),Ai("https",Kd,2,!0),Ai("blob",Kd,2,!0));function AS(){}function $d(e,t,n,r,i,s){var o=new hD,u=Date.now(),l=0,f=new Promise(function(g,y){o.open(t.method,e,!0),o.responseType="arraybuffer",o.timeout=t.retryParameters.timeout,o.withCredentials=t.allowCrossSiteCredentials;var v={};o.onabort=function(){y(new H(1,1,7001,e,n))},o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.HEADERS_RECEIVED){var A=o.getAllResponseHeaders().trim().split("\r\n"),I={};A=x(A);for(var E=A.next();!E.done;E=A.next())E=E.value.split(": "),I[E[0].toLowerCase()]=E.slice(1).join(": ");v=I,i(v)}},o.onload=function(A){var I=o.response;try{r(Date.now()-u,A.loaded-l,0);var E=wS(v,I,o.status,e,o.responseURL,t,n);g(E)}catch(R){y(R)}},o.onerror=function(A){y(new H(1,1,1002,e,A,n))},o.ontimeout=function(){y(new H(1,1,1003,e,n))},o.onprogress=function(A){var I=Date.now(),E=s.minBytesForProgressEvents||0,R=A.loaded-l;(I-u>100&&R>=E||A.lengthComputable&&A.loaded==A.total)&&(r(I-u,R,o.readyState==4?0:A.total-A.loaded),l=A.loaded,u=I)};for(var w in t.headers)try{o.setRequestHeader(w.toLowerCase(),t.headers[w])}catch(A){throw new H(1,1,1002,e,A,n)}o.send(t.body)});return new kt(f,function(){return o.abort(),Promise.resolve()})}de("shaka.net.HttpXHRPlugin",AS),AS.parse=$d;var hD=m.XMLHttpRequest;Ai("http",$d,1,!0),Ai("https",$d,1,!0),Ai("blob",$d,1,!0);function ES(e,t,n,r,i){this.g=e,this.i=t,this.groupId=n,this.h=r,this.j=i}function vm(e){var t=e.ac(!1);return t?pi(t):e.P().map(function(n){return"{"+encodeURI(n.split("#xywh=")[0])+"}"}).join("")+":"+e.startByte+":"+e.endByte}function pD(e,t){return hu(e.g.P(),e.g.startByte,e.g.endByte,t.streaming.retryParameters)}function IS(){this.g=this.j=this.i=0,this.h=new Map,this.l=0}function CS(e,t){e.i+=t;var n=e.l;return e.l++,e.h.set(n,t),n}IS.prototype.close=function(e,t){if(this.h.has(e)){var n=this.h.get(e);this.h.delete(e),this.j+=n,this.g+=t}};function MS(e){return e.i==0?0:e.j/e.i}function xm(e){var t=this;this.u=e,this.i=new Map,this.h=new To(function(){return Tm(t).catch(function(){})}),this.j=[],this.o=function(){},this.m=function(){},this.g=new IS,this.l=!1}xm.prototype.destroy=function(){return this.h.destroy()};function gD(e,t,n){e.o=t,e.m=n}function Tm(e){e.l=!0;var t=e.j.map(function(n){return n()});return e.j=[],Promise.all(t)}xm.prototype.queue=function(e,t,n,r,i){var s=this;dt(this.h);var o=(this.i.get(e)||Promise.resolve()).then(function(){var u,l,f,g,y,v,w;return F(function(A){if(A.g==1)return C(A,vD(s,t),2);if(u=A.h,s.h.g)throw new H(2,9,7001);if(r)for(g in l=Le(u),f=new Wh(l),f.data)y=Number(g),v=f.data[y],w=f.g[y],s.m(v,w);return s.g.close(n,u.byteLength),s.o(MS(s.g),s.g.g),A.return(i(u))})});return this.i.set(e,o),o};function mD(e,t,n,r,i,s){dt(e.h);var o=(e.i.get(t)||Promise.resolve()).then(function(){if(e.h.g)throw new H(2,9,7001);if(i){var u=Le(n);u=new Wh(u);for(var l in u.data){var f=Number(l);e.m(u.data[f],u.g[f])}}return e.g.close(r,n.byteLength),e.o(MS(e.g),e.g.g),s(n)});e.i.set(t,o)}function yD(e){return F(function(t){return t.g==1?C(t,Promise.all(e.i.values()),2):t.return(e.g.g)})}function vD(e,t){var n,r,i,s;return F(function(o){return o.g==1?(n=wr,r=e.u.request(n,t),i=function(){return r.abort()},e.j.push(i),C(o,r.promise,2)):(s=o.h,Dr(e.j,i),o.return(s.data))})}function Yd(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new at,e.onabort=function(r){r.preventDefault(),n.g.reject()},e.onerror=function(r){r.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}Yd.prototype.abort=function(){var e=this;return F(function(t){if(t.g==1){try{e.i.abort()}catch(n){}return Z(t,2),C(t,e.g,4)}if(t.g!=2)return ce(t,0);se(t),ie(t)})};function wm(e,t){return new Promise(function(n,r){var i=e.h.openCursor();i.onerror=r,i.onsuccess=function(){var s;return F(function(o){if(o.g==1)return i.result==null?(n(),o.return()):(s=i.result,C(o,t(s.key,s.value,s),2));s.continue(),ie(o)})}})}Yd.prototype.store=function(){return this.h},Yd.prototype.promise=function(){return this.g};function Sm(e){this.h=e,this.g=[]}Sm.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))};function Ws(e,t){return qd(e,t,"readwrite")}function qd(e,t,n){n=e.h.transaction([t],n);var r=new Yd(n,t);return e.g.push(r),r.promise().then(function(){Dr(e.g,r)},function(){Dr(e.g,r)}),r}function Ks(e,t,n){this.h=new Sm(e),this.i=t,this.g=n}p=Ks.prototype,p.destroy=function(){return this.h.destroy()},p.hasFixedKeySpace=function(){return!0},p.addSegments=function(){return RS(this.i)},p.removeSegments=function(e,t){return kS(this,this.i,e,t)},p.getSegments=function(e){var t=this,n;return F(function(r){return r.g==1?C(r,_S(t,t.i,e),2):(n=r.h,r.return(n.map(function(i){return t.Vh(i)})))})},p.addManifests=function(){return RS(this.g)},p.updateManifest=function(){return Promise.reject(new H(2,9,9016,"Cannot modify values in "+this.g))};function xD(e,t,n){e=Ws(e.h,e.g);var r=e.store();return r.get(t).onsuccess=function(){r.put(n,t)},e.promise()}p.updateManifestExpiration=function(e,t){var n=Ws(this.h,this.g),r=n.store();return r.get(e).onsuccess=function(i){(i=i.target.result)&&(i.expiration=t,r.put(i,e))},n.promise()},p.removeManifests=function(e,t){return kS(this,this.g,e,t)},p.getManifests=function(e){var t=this,n;return F(function(r){return r.g==1?C(r,_S(t,t.g,e),2):(n=r.h,r.return(Promise.all(n.map(function(i){return t.Td(i)}))))})},p.getAllManifests=function(){var e=this,t,n;return F(function(r){return r.g==1?(t=qd(e.h,e.g,"readonly"),n=new Map,C(r,wm(t,function(i,s){var o;return F(function(u){if(u.g==1)return C(u,e.Td(s),2);o=u.h,n.set(i,o),ie(u)})}),2)):r.g!=3?C(r,t.promise(),3):r.return(n)})},p.Vh=function(e){return e},p.Td=function(e){return Promise.resolve(e)};function RS(e){return Promise.reject(new H(2,9,9011,"Cannot add new value to "+e))}p.add=function(e,t){var n=this,r,i,s,o,u,l,f;return F(function(g){if(g.g==1){for(r=Ws(n.h,e),i=r.store(),s=[],o=x(t),u=o.next(),l={};!u.done;l={gh:void 0},u=o.next())f=u.value,l.gh=i.add(f),l.gh.onsuccess=(function(y){return function(){s.push(y.gh.result)}})(l);return C(g,r.promise(),2)}return g.return(s)})};function kS(e,t,n,r){e=Ws(e.h,t),t=e.store(),n=x(n);for(var i=n.next(),s={};!i.done;s={Sg:void 0},i=n.next())s.Sg=i.value,t.delete(s.Sg).onsuccess=(function(o){return function(){return r(o.Sg)}})(s);return e.promise()}function _S(e,t,n){var r,i,s,o,u,l,f;return F(function(g){if(g.g==1){for(r=qd(e.h,t,"readonly"),i=r.store(),s={},o=[],u=x(n),l=u.next(),f={};!l.done;f={Df:void 0,kf:void 0},l=u.next())f.kf=l.value,f.Df=i.get(f.kf),f.Df.onsuccess=(function(y){return function(){y.Df.result==null&&o.push(y.kf),s[y.kf]=y.Df.result}})(f);return C(g,r.promise(),2)}if(o.length)throw new H(2,9,9012,"Could not find values for "+o);return g.return(n.map(function(y){return s[y]}))})}function Ku(e){this.g=new Sm(e)}Ku.prototype.destroy=function(){return this.g.destroy()},Ku.prototype.getAll=function(){var e=this,t,n;return F(function(r){return r.g==1?(t=qd(e.g,"session-ids","readonly"),n=[],C(r,wm(t,function(i,s){n.push(s)}),2)):r.g!=3?C(r,t.promise(),3):r.return(n)})},Ku.prototype.add=function(e){var t=Ws(this.g,"session-ids"),n=t.store();e=x(e);for(var r=e.next();!r.done;r=e.next())n.add(r.value);return t.promise()},Ku.prototype.remove=function(e){var t=this,n;return F(function(r){return r.g==1?(n=Ws(t.g,"session-ids"),C(r,wm(n,function(i,s,o){e.includes(s.sessionId)&&o.delete()}),2)):C(r,n.promise(),0)})};function Bn(){this.g=new Map}Bn.prototype.destroy=function(){for(var e=[],t=x(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Bn.prototype.init=function(){var e=this;$u.forEach(function(i,s){(i=i())&&e.g.set(s,i)});for(var t=[],n=x(this.g.values()),r=n.next();!r.done;r=n.next())t.push(r.value.init());return Promise.all(t)};function PS(e){var t=null;if(e.g.forEach(function(n,r){n.getCells().forEach(function(i,s){i.hasFixedKeySpace()||t||(t={path:{Qb:r,bb:s},bb:i})})}),t)return t;throw new H(2,9,9013,"Could not find a cell that supports add-operations")}function TD(e,t){e.g.forEach(function(n,r){n.getCells().forEach(function(i,s){t({Qb:r,bb:s},i)})})}function Qd(e,t,n){if(e=e.g.get(t),!e)throw new H(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells().get(n),!t)throw new H(2,9,9013,"Could not find cell with name "+n);return t}function wD(e,t){e.g.forEach(function(n){t(n.getEmeSessionCell())})}function SD(e){var t=Array.from(e.g.keys());if(!t.length)throw new H(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}function AD(e){var t,n,r;return F(function(i){return i.g==1?(t=Array.from(e.g.values()),n=t.length>0,n||(r=$u,r.forEach(function(s){(s=s())&&t.push(s)})),C(i,Promise.all(t.map(function(s){return s.erase()})),2)):n?i.A(0):C(i,Promise.all(t.map(function(s){return s.destroy()})),0)})}function DS(e,t){$u.set(e,t)}de("shaka.offline.StorageMuxer",Bn),Bn.unregister=function(e){$u.delete(e)},Bn.register=DS,Bn.prototype.destroy=Bn.prototype.destroy;var $u=new Map;function Yu(){Ks.apply(this,arguments)}J(Yu,Ks),Yu.prototype.updateManifestExpiration=function(e,t){var n=this,r,i,s;return F(function(o){return r=Ws(n.h,n.g),i=r.store(),s=new at,i.get(e).onsuccess=function(u){(u=u.target.result)?(u.expiration=t,i.put(u),s.resolve()):s.reject(new H(2,9,9012,"Could not find values for "+e))},C(o,Promise.all([r.promise(),s]),0)})},Yu.prototype.Td=function(e){var t,n,r,i,s,o;return F(function(u){if(u.g==1){for(t=[],n=0;n<e.periods.length;++n)r=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=r-e.periods[n].startTime,s=ED(e.periods[n],i),t.push(s);return C(u,fw(t),2)}return o=u.h,u.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:e.expiration==null?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})};function ED(e,t){CD(e);for(var n=x(e.streams),r=n.next();!r.done;r=n.next());return e.streams.map(function(i){return ID(i,e.startTime,t)})}function ID(e,t,n){var r=e.initSegmentUri?LS(e.initSegmentUri):null,i=t+e.presentationTimeOffset,s=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:r,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(o){var u=LS(o.uri);return{startTime:t+o.startTime,endTime:t+o.endTime,dataKey:u,initSegmentKey:r,appendWindowStart:t,appendWindowEnd:s,timestampOffset:i,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}Yu.prototype.Vh=function(e){return{data:e.data}};function LS(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new H(2,9,9004,"Could not parse uri "+e)}function CD(e){var t=e.streams.filter(function(u){return u.contentType=="audio"});if(e=e.streams.filter(function(u){return u.contentType=="video"}),!t.every(function(u){return u.variantIds})||!e.every(function(u){return u.variantIds})){for(var n=x(t),r=n.next();!r.done;r=n.next())r.value.variantIds=[];for(n=x(e),r=n.next();!r.done;r=n.next())r.value.variantIds=[];if(n=0,e.length&&!t.length){r=n++;for(var i=x(e),s=i.next();!s.done;s=i.next())s.value.variantIds.push(r)}if(!e.length&&t.length)for(r=n++,i=x(t),s=i.next();!s.done;s=i.next())s.value.variantIds.push(r);if(e.length&&t.length)for(t=x(t),r=t.next();!r.done;r=t.next())for(r=r.value,i=x(e),s=i.next();!s.done;s=i.next()){s=s.value;var o=n++;r.variantIds.push(o),s.variantIds.push(o)}}}function Jd(){Ks.apply(this,arguments)}J(Jd,Ks),Jd.prototype.Td=function(e){var t,n,r,i,s,o;return F(function(u){if(u.g==1){for(t=[],n=0;n<e.periods.length;++n){r=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=r-e.periods[n].startTime;for(var l=e.periods[n],f=[],g=x(l.streams),y=g.next();!y.done;y=g.next())y=y.value,y.variantIds.length!=0&&f.push(MD(y,l.startTime,l.startTime+i));s=f,t.push(s)}return C(u,fw(t),2)}return o=u.h,u.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:e.expiration==null?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})})};function MD(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(r){return{startTime:t+r.startTime,endTime:t+r.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:r.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function Am(){Ks.apply(this,arguments)}J(Am,Ks),p=Am.prototype,p.hasFixedKeySpace=function(){return!1},p.addSegments=function(e){return this.add(this.i,e)},p.addManifests=function(e){return this.add(this.g,e)},p.updateManifest=function(e,t){return xD(this,e,t)},p.Td=function(e){return e.expiration==null&&(e.expiration=1/0),Promise.resolve(e)};function bS(){this.m=this.j=this.i=this.h=this.g=this.l=null}p=bS.prototype,p.init=function(){var e=this,t=new at,n=!1,r=new Ve(function(){n=!0,t.reject(new H(2,9,9017))});typeof Zd=="number"&&Zd>0&&r.ka(Zd);var i=m.indexedDB.open("shaka_offline_db",5);return i.onsuccess=function(){if(!n){r.stop();var s=i.result;e.l=s;var o=s.objectStoreNames;o=o.contains("manifest")&&o.contains("segment")?new Yu(s,"segment","manifest"):null,e.g=o,o=s.objectStoreNames,o=o.contains("manifest-v2")&&o.contains("segment-v2")?new Jd(s,"segment-v2","manifest-v2"):null,e.h=o,o=s.objectStoreNames,o=o.contains("manifest-v3")&&o.contains("segment-v3")?new Jd(s,"segment-v3","manifest-v3"):null,e.i=o,o=s.objectStoreNames,o=o.contains("manifest-v5")&&o.contains("segment-v5")?new Am(s,"segment-v5","manifest-v5"):null,e.j=o,s=s.objectStoreNames.contains("session-ids")?new Ku(s):null,e.m=s,t.resolve()}},i.onupgradeneeded=function(){for(var s=i.result,o=x(["segment-v5","manifest-v5","session-ids"]),u=o.next();!u.done;u=o.next())u=u.value,s.objectStoreNames.contains(u)||s.createObjectStore(u,{autoIncrement:!0})},i.onerror=function(s){n||(r.stop(),t.reject(new H(2,9,9001,i.error)),s.preventDefault())},t},p.destroy=function(){var e=this;return F(function(t){switch(t.g){case 1:if(!e.g){t.A(2);break}return C(t,e.g.destroy(),2);case 2:if(!e.h){t.A(4);break}return C(t,e.h.destroy(),4);case 4:if(!e.i){t.A(6);break}return C(t,e.i.destroy(),6);case 6:if(!e.j){t.A(8);break}return C(t,e.j.destroy(),8);case 8:if(!e.m){t.A(10);break}return C(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),ie(t)}})},p.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},p.getEmeSessionCell=function(){return this.m},p.erase=function(){var e=this;return F(function(t){switch(t.g){case 1:if(!e.g){t.A(2);break}return C(t,e.g.destroy(),2);case 2:if(!e.h){t.A(4);break}return C(t,e.h.destroy(),4);case 4:if(!e.i){t.A(6);break}return C(t,e.i.destroy(),6);case 6:if(!e.j){t.A(8);break}return C(t,e.j.destroy(),8);case 8:return e.l&&e.l.close(),C(t,RD(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,C(t,e.init(),0)}})};function RD(){var e=new at,t=m.indexedDB.deleteDatabase("shaka_offline_db");return t.onblocked=function(){},t.onsuccess=function(){e.resolve()},t.onerror=function(n){e.reject(new H(2,9,9001,t.error)),n.preventDefault()},e}var Zd=5;de("shaka.offline.indexeddb.StorageMechanismOpenTimeout",Zd),DS("idb",function(){return je().Bh()?new bS:null});function ai(e,t,n,r){this.g=e,this.i=t,this.h=n,this.l=r,this.j=["offline:",e,"/",t,"/",n,"/",r].join("")}ai.prototype.Qb=function(){return this.i},ai.prototype.bb=function(){return this.h},ai.prototype.key=function(){return this.l},ai.prototype.toString=function(){return this.j};function Em(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),e==null)return null;var t=e[1];if(t!="manifest"&&t!="segment")return null;var n=e[2];if(!n)return null;var r=e[3];return r&&t!=null?new ai(t,n,r,Number(e[4])):null}function NS(e,t){this.h=e,this.g=t}function OS(e,t){var n=new Pe(null,0);n.Ab(t.duration);var r=t.streams.filter(function(f){return f.type=="audio"}),i=t.streams.filter(function(f){return f.type=="video"});r=kD(e,r,i,n),i=t.streams.filter(function(f){return f.type==Fe}).map(function(f){return ef(e,f,n)});var s=t.streams.filter(function(f){return f.type=="image"}).map(function(f){return ef(e,f,n)}),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var u=x(r.values()),l=u.next();!l.done;l=u.next())l=l.value,l.audio&&l.audio.encrypted&&(l.audio.drmInfos=o),l.video&&l.video.encrypted&&(l.video.drmInfos=o);return{presentationTimeline:n,offlineSessionIds:t.sessionIds,variants:Array.from(r.values()),textStreams:i,imageStreams:s,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}}function kD(e,t,n,r){for(var i=new Set,s=x(t),o=s.next();!o.done;o=s.next()){o=x(o.value.variantIds);for(var u=o.next();!u.done;u=o.next())i.add(u.value)}for(s=x(n),o=s.next();!o.done;o=s.next())for(o=x(o.value.variantIds),u=o.next();!u.done;u=o.next())i.add(u.value);for(s=new Map,i=x(i),o=i.next();!o.done;o=i.next())o=o.value,s.set(o,{id:o,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=x(t),i=t.next();!i.done;i=t.next())for(o=i.value,i=ef(e,o,r),o=x(o.variantIds),u=o.next();!u.done;u=o.next())u=s.get(u.value),u.language=i.language,u.primary=u.primary||i.primary,u.audio=i;for(n=x(n),t=n.next();!t.done;t=n.next())for(i=t.value,t=ef(e,i,r),i=x(i.variantIds),o=i.next();!o.done;o=i.next())o=s.get(o.value),o.primary=o.primary||t.primary,o.video=t;return s}function ef(e,t,n){var r=t.segments.map(function(i){return _D(e,i,t)});return n.le(r),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Qe(r),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,mssPrivateData:t.mssPrivateData,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([Ct(t.mimeType,t.codecs)]),isAudioMuxedInVideo:t.isAudioMuxedInVideo||!1,baseOriginalId:null}}function _D(e,t,n){var r=new ai("segment",e.h,e.g,t.dataKey);return e=new Ce(t.startTime,t.endTime,function(){return[r.toString()]},0,null,t.initSegmentKey!=null?PD(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",t.thumbnailSprite&&e.Lf(t.thumbnailSprite),e}function PD(e,t){var n=new ai("segment",e.h,e.g,t);return new On(function(){return[n.toString()]},0,null)}function US(){this.g=null}p=US.prototype,p.configure=function(){},p.start=function(e,t){var n=this,r,i,s,o,u,l,f;return F(function(g){switch(g.g){case 1:if(r=Em(e),n.g=r,r==null||r.g!="manifest")throw new H(2,1,9004,e);return i=new Bn,ge(g,2),C(g,i.init(),4);case 4:return C(g,Qd(i,r.Qb(),r.bb()),5);case 5:return s=g.h,C(g,s.getManifests([r.key()]),6);case 6:return o=g.h,u=o[0],l=new NS(r.Qb(),r.bb()),f=OS(l,u),t.makeTextStreamsForClosedCaptions(f),g.return(f);case 2:return ye(g),C(g,i.destroy(),7);case 7:Oe(g,0)}})},p.stop=function(){return Promise.resolve()},p.update=function(){},p.onExpirationUpdated=function(e,t){var n=this,r,i,s,o,u,l,f;return F(function(g){switch(g.g){case 1:return r=n.g,i=new Bn,Z(g,2,3),C(g,i.init(),5);case 5:return C(g,Qd(i,r.Qb(),r.bb()),6);case 6:return s=g.h,C(g,s.getManifests([r.key()]),7);case 7:if(o=g.h,u=o[0],l=u.sessionIds.includes(e),f=u.expiration==null||u.expiration>t,!l||!f){g.A(3);break}return C(g,s.updateManifestExpiration(r.key(),t),3);case 3:return ye(g),C(g,i.destroy(),10);case 10:Oe(g,0);break;case 2:se(g),g.A(3)}})},p.onInitialVariantChosen=function(){},p.banLocation=function(){},p.setMediaElement=function(){},Is("application/x-offline-manifest",function(){return new US});function jS(){}function BS(e,t){var n=Em(e);return n&&n.g=="manifest"?(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t},e=vo(e)):e=n&&n.g=="segment"?DD(n.key(),n,t):es(new H(2,1,9004,e)),e}function DD(e,t,n){var r=new Bn;return vo(void 0).Xa(function(){return r.init()}).Xa(function(){return Qd(r,t.Qb(),t.bb())}).Xa(function(i){return i.getSegments([t.key()])}).Xa(function(i){return{uri:t,data:i[0].data,headers:{},originalRequest:n}}).finally(function(){return r.destroy()})}de("shaka.offline.OfflineScheme",jS),jS.plugin=BS,Ai("offline",BS);function FS(e,t,n){var r,i,s,o,u,l;return F(function(f){switch(f.g){case 1:r=[];for(var g=[],y=x(n),v=y.next();!v.done;v=y.next()){v=v.value;for(var w=!1,A=x(g),I=A.next();!I.done;I=A.next())if(I=I.value,bD(I.info,v)){I.sessionIds.push(v.sessionId),w=!0;break}w||g.push({info:v,sessionIds:[v.sessionId]})}i=x(g),s=i.next();case 2:if(s.done){f.A(4);break}return o=s.value,u=LD(e,t,o),C(f,u,5);case 5:l=f.h,r=r.concat(l),s=i.next(),f.A(2);break;case 4:return f.return(r)}})}function LD(e,t,n){var r,i;return F(function(s){switch(s.g){case 1:return r=new mc({vc:t,onError:function(){},yf:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Z(s,2),r.configure(e),C(s,hC(r,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:ce(s,3);break;case 2:return se(s),C(s,r.destroy(),5);case 5:return s.return([]);case 3:return i=[],C(s,Promise.all(n.sessionIds.map(function(o){return F(function(u){if(u.g==1)return Z(u,2),C(u,mC(r,o),4);if(u.g!=2)return i.push(o),ce(u,0);se(u),ie(u)})})),6);case 6:return C(s,r.destroy(),7);case 7:return s.return(i)}})}function bD(e,t){function n(r,i){return r.robustness==i.robustness&&r.contentType==i.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&ws(e.audioCapabilities,t.audioCapabilities,n)&&ws(e.videoCapabilities,t.videoCapabilities,n)}function ND(e,t,n){var r=t.presentationTimeline.getDuration();return t=VS(t),{offlineUri:null,originalManifestUri:e,duration:r,size:0,expiration:1/0,tracks:t,appMetadata:n,isIncomplete:!1}}function Im(e,t){var n=OS(new NS(e.Qb(),e.bb()),t),r=t.appMetadata||{};return n=VS(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:r,isIncomplete:t.isIncomplete||!1}}function VS(e){var t=[],n=ac(e.variants);n=x(n);for(var r=n.next();!r.done;r=n.next())t.push(Ls(r.value));for(e=x(e.textStreams),n=e.next();!n.done;n=e.next())t.push(bs(n.value));return t}function OD(){this.g=new Map}function UD(e,t){var n=t.audio,r=t.video;if(n&&!r&&e.g.set(n.id,n.bandwidth||t.bandwidth),!n&&r&&e.g.set(r.id,r.bandwidth||t.bandwidth),n&&r){var i=n.bandwidth||393216,s=r.bandwidth||t.bandwidth-i;s<=0&&(s=t.bandwidth),e.g.set(n.id,i),e.g.set(r.id,s)}}function jD(e,t){e.g.set(t.id,t.bandwidth||2048)}function HS(e,t){return e=e.g.get(t),e==null&&(e=0),e}function Jt(e){var t=this;if(e&&e.constructor!=te)throw new H(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.Zb()):(this.h=Uo(),this.g=new mt,this.g.configure(this.h.networking)),this.i=[],this.l=[];var n=!e;this.j=new To(function(){var r,i,s,o,u;return F(function(l){switch(l.g){case 1:return C(l,Promise.all(t.l.map(function(f){return Tm(f)})),2);case 2:for(r=function(){},i=[],s=x(t.i),o=s.next();!o.done;o=s.next())u=o.value,i.push(u.then(r,r));return C(l,Promise.all(i),3);case 3:if(!n){l.A(4);break}return C(l,t.g.destroy(),4);case 4:t.h=null,t.g=null,ie(l)}})}),this.m=1e9}function Cm(){if(oi(je()))e:{for(var e=x($u.values()),t=e.next();!t.done;t=e.next())if(t=t.value,t=t()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}p=Jt.prototype,p.destroy=function(){return this.j.destroy()},p.configure=function(e,t){return arguments.length==2&&typeof e=="string"&&(e=Vc(e,t)),_i(this.h,e)},p.getConfiguration=function(){var e=Uo();return _i(e,this.h,Uo()),e},p.Zb=function(){return this.g},p.store=function(e,t,n,r,i){var s=this,o=this.getConfiguration(),u=new xm(this.g);return this.l.push(u),t=BD(this,e,t||{},r||[],i||[],function(){var l;return F(function(f){return f.g==1?n?f.A(2):C(f,Lo(e,s.g,o.manifest.retryParameters),3):(f.g!=2&&(n=f.h),l=Av(e,n||null),f.return(l()))})},o,u),t=new kt(t,function(){return Tm(u)}),t.finally(function(){Dr(s.l,u)}),t4(this,t)};function BD(e,t,n,r,i,s,o,u){var l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$;return F(function(Q){switch(Q.g){case 1:return tf(),f=l=null,g=new Bn,w=v=y=null,Z(Q,2,3),C(Q,s(),5);case 5:return l=Q.h,C(Q,$D(e,t,l,o),6);case 6:if(A=Q.h,sr(e),I=!A.presentationTimeline.W()&&!A.presentationTimeline.Vc(),!I)throw new H(2,9,9005,t);E=x(r),R=E.next();case 7:if(R.done){Q.A(9);break}return M=R.value,C(Q,YD(e,M,A),10);case 10:D=Q.h,A.imageStreams.push(D),sr(e),R=E.next(),Q.A(7);break;case 9:O=x(i),X=O.next();case 11:return X.done?(_0(o.drm.clearKeys,A.variants),N=A.variants.some(function(ae){if(ae.audio){for(var le=x(ae.audio.drmInfos),be=le.next();!be.done;be=le.next())if(be.value.licenseServerUri.startsWith("data:"))return!0}if(ae.video){for(ae=x(ae.video.drmInfos),le=ae.next();!le.done;le=ae.next())if(le.value.licenseServerUri.startsWith("data:"))return!0}return!1}),z=o.offline.usePersistentLicense,N&&(z=!1),C(Q,e.md(A,function(ae){w=w||ae},o,z),15)):(b=X.value,C(Q,qD(e,A,b.uri,b.language,b.kind,b.mime,b.codecs),14));case 14:U=Q.h,A.textStreams.push(U),sr(e),X=O.next(),Q.A(11);break;case 15:if(f=Q.h,sr(e),w)throw w;return C(Q,VD(A,f,o,z),16);case 16:return C(Q,g.init(),17);case 17:return sr(e),C(Q,PS(g),18);case 18:return y=Q.h,sr(e),B=HD(f,A,t,n,o,u,z),W=B.vk,G=B.Fh,C(Q,y.bb.addManifests([W]),19);case 19:if(re=Q.h,sr(e),v=re[0],sr(e),w)throw w;return C(Q,FD(e,G,v,W,u,o,y.bb,A,f,z),20);case 20:return sr(e),WS(A,W,f,z),C(Q,y.bb.updateManifest(v,W),21);case 21:return sr(e),ne=new ai("manifest",y.path.Qb,y.path.bb,v),Q.return(Im(ne,W));case 3:return ye(Q),C(Q,g.destroy(),22);case 22:if(!l){Q.A(23);break}return C(Q,l.stop(),23);case 23:if(!f){Q.A(25);break}return C(Q,f.destroy(),25);case 25:Oe(Q,0);break;case 2:if($=se(Q),v==null){Q.A(27);break}return C(Q,GS(v),27);case 27:throw w||$}})}function FD(e,t,n,r,i,s,o,u,l,f){var g,y,v,w,A,I,E,R,M,D,O;return F(function(X){switch(X.g){case 1:if(g={},y=0,v=function(){if(e.j.g||i.l)throw new H(2,9,7001)},w=function(b,U){var N,z,B,W,G,re,ne,$,Q;return F(function(ae){if(ae.g==1){for(N=x(b),z=N.next(),B={};!z.done;B={mc:void 0},z=N.next())B.mc=z.value,v(),W=pD(B.mc,s),G=B.mc.i,re=B.mc.h,ne=(function(le){return function(be){var xe,Ze,Ne,st;return F(function(ze){switch(ze.g){case 1:if(xe=le.mc.g,Ze=xe.ac(!1),!xe.aesKey||Ze){ze.A(2);break}return C(ze,Cp(be,xe.aesKey,le.mc.j),3);case 3:be=ze.h;case 2:return Ne=vm(xe),C(ze,o.addSegments([{data:be}]),4);case 4:st=ze.h,v(),g[Ne]=st[0],y+=be.byteLength,ie(ze)}})}})(B),$=B.mc.g,(Q=$.ac(!1))?mD(i,B.mc.groupId,Q,G,re,ne):i.queue(B.mc.groupId,W,G,re,ne);return C(ae,yD(i),2)}return v(),!U||i.l?ae.A(0):(WS(u,r,l,f),C(ae,o.updateManifest(n,r),0))})},A=!1,Z(X,2),!Mm(u)||!A||zS(u)){X.A(4);break}return C(X,w(t.filter(function(b){return b.h}),!0),5);case 5:return v(),t=t.filter(function(b){return!b.h}),I=g,E=y,g={},y=0,C(X,XS(o,n,r,I,E,function(){return sr(e)}),6);case 6:v();case 4:if(A){X.A(7);break}return C(X,w(t,!1),8);case 8:return v(),R=g,M=y,g={},y=0,C(X,XS(o,n,r,R,M,function(){return v()}),9);case 9:v();case 7:ce(X,0);break;case 2:return D=se(X),O=Object.values(g),C(X,o.removeSegments(O,function(){}),10);case 10:throw D}})}function GS(e){var t,n,r,i;return F(function(s){switch(s.g){case 1:return t=new Bn,C(s,t.init(),2);case 2:return C(s,PS(t),3);case 3:return n=s.h,r=new ai("manifest",n.path.Qb,n.path.bb,e),C(s,t.destroy(),4);case 4:return i=new Jt,C(s,i.remove(r.toString()),0)}})}function XS(e,t,n,r,i,s){var o,u,l,f,g,y,v,w,A,I,E;return F(function(R){switch(R.g){case 1:for(o=!1,Z(R,2),u=!0,l=x(n.streams),f=l.next();!f.done;f=l.next())for(g=f.value,y=x(g.segments),v=y.next();!v.done;v=y.next())w=v.value,A=w.pendingSegmentRefId?r[w.pendingSegmentRefId]:null,A!=null&&(w.dataKey=A,w.pendingSegmentRefId=void 0),A=w.pendingInitSegmentRefId?r[w.pendingInitSegmentRefId]:null,A!=null&&(w.initSegmentKey=A,w.pendingInitSegmentRefId=void 0),w.pendingSegmentRefId&&(u=!1),w.pendingInitSegmentRefId&&(u=!1);return n.size+=i,u&&(n.isIncomplete=!1),C(R,e.updateManifest(t,n),4);case 4:o=!0,s(),ce(R,0);break;case 2:return I=se(R),C(R,GS(t),5);case 5:if(o){R.A(6);break}return E=Object.values(r),C(R,e.removeSegments(E,function(){}),6);case 6:throw I}})}function VD(e,t,n,r){var i,s,o,u,l,f,g,y,v,w,A,I,E,R,M,D,O,X,b,U,N,z,B,W,G,re,ne,$,Q,ae;return F(function(le){switch(le.g){case 1:return i={width:1/0,height:1/0},K2(e,n.restrictions,i),C(le,Yv(t,e,r,n.drm.preferredKeySystems,n.drm.keySystemsMapping),2);case 2:for(s=[],o=n.preferredDecodingAttributes,u=n.preferredVideoCodecs,l=n.preferredAudioCodecs,f=n.preferredTextFormats,$v(e,u,l,o,f),g=x(e.variants),y=g.next();!y.done;y=g.next())v=y.value,s.push(Ls(v));for(w=x(e.textStreams),A=w.next();!A.done;A=w.next())I=A.value,s.push(bs(I));for(E=x(e.imageStreams),R=E.next();!R.done;R=E.next())M=R.value,s.push(Vh(M));return C(le,n.offline.trackSelectionCallback(s),3);case 3:for(D=le.h,O=e.presentationTimeline.getDuration(),X=0,b=x(D),U=b.next();!U.done;U=b.next())N=U.value,z=N.bandwidth*O/8,X+=z;return Z(le,4),C(le,n.offline.downloadSizeCallback(X),6);case 6:if(B=le.h,!B)throw new H(2,9,9014);ce(le,5);break;case 4:throw W=se(le),W instanceof H?W:new H(2,9,9015);case 5:for(G=new Set,re=new Set,ne=new Set,$=x(D),Q=$.next();!Q.done;Q=$.next())ae=Q.value,ae.type=="variant"&&G.add(ae.id),ae.type=="text"&&re.add(ae.id),ae.type=="image"&&ne.add(ae.id);e.variants=e.variants.filter(function(be){return G.has(be.id)}),e.textStreams=e.textStreams.filter(function(be){return re.has(be.id)}),e.imageStreams=e.imageStreams.filter(function(be){return ne.has(be.id)}),i4(e),ie(le)}})}function HD(e,t,n,r,i,s,o){var u=ND(n,t,r),l=i.offline.progressCallback;gD(s,function(A,I){u.size=I,l(u,A)},function(A,I){f&&o&&g==I&&Ja(e,"cenc",A)});var f=Mm(t)&&!zS(t),g=null;f&&(g=s4.get(e.g.keySystem));for(var y=new OD,v=x(t.textStreams),w=v.next();!w.done;w=v.next())y.g.set(w.value.id,52);for(v=x(t.imageStreams),w=v.next();!w.done;w=v.next())jD(y,w.value);for(v=x(t.variants),w=v.next();!w.done;w=v.next())UD(y,w.value);return s=JD(s,y,t,i),i=s.streams,s=s.Fh,(y=e.g)&&o&&(y.initData=[]),{vk:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.Yd(),streams:i,sessionIds:o?A0(e):[],drmInfo:y,appMetadata:r,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},Fh:s}}function Mm(e){return e.variants.some(function(t){var n=t.audio&&t.audio.encrypted;return t.video&&t.video.encrypted||n})}function zS(e){return e.variants.some(function(t){return(t.video?t.video.drmInfos:[]).concat(t.audio?t.audio.drmInfos:[]).some(function(n){return n.initData&&n.initData.length})})}function WS(e,t,n,r){if(t.expiration=n.Yd(),n=A0(n),t.sessionIds=r?n:[],Mm(e)&&r&&!n.length)throw new H(2,9,9007)}p.remove=function(e){return Rm(this,GD(this,e))};function GD(e,t){var n,r,i,s,o,u;return F(function(l){switch(l.g){case 1:if(tf(),n=Em(t),n==null||n.g!="manifest")throw new H(2,9,9004,t);return r=n,i=new Bn,ge(l,2),C(l,i.init(),4);case 4:return C(l,Qd(i,r.Qb(),r.bb()),5);case 5:return s=l.h,C(l,s.getManifests([r.key()]),6);case 6:return o=l.h,u=o[0],C(l,Promise.all([XD(e,u,i),zD(s,r,u)]),2);case 2:return ye(l),C(l,i.destroy(),8);case 8:Oe(l,0)}})}function KS(e,t){for(var n=[],r=x(e.streams),i=r.next();!i.done;i=r.next())i=i.value,t&&i.type=="video"?n.push({contentType:Ct(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||i.type!="audio"||n.push({contentType:Ct(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return n}function XD(e,t,n){return F(function(r){return C(r,r4(e.g,e.h.drm,n,t),0)})}function zD(e,t,n){function r(){}var i=n4(n);return Im(t,n),Promise.all([e.removeSegments(i,r),e.removeManifests([t.key()],r)])}p.Ok=function(){return Rm(this,WD(this))};function WD(e){var t,n,r,i,s,o,u,l,f,g;return F(function(y){switch(y.g){case 1:return tf(),t=e.g,n=e.h.drm,r=new Bn,i=!1,ge(y,2),C(y,r.init(),4);case 4:s=[],wD(r,function(v){return s.push(v)}),o=x(s),u=o.next();case 5:if(u.done){y.A(2);break}return l=u.value,C(y,l.getAll(),8);case 8:return f=y.h,C(y,FS(n,t,f),9);case 9:return g=y.h,C(y,l.remove(g),10);case 10:g.length!=f.length&&(i=!0),u=o.next(),y.A(5);break;case 2:return ye(y),C(y,r.destroy(),11);case 11:Oe(y,3);break;case 3:return y.return(!i)}})}p.list=function(){return Rm(this,KD())};function KD(){var e,t,n;return F(function(r){switch(r.g){case 1:return tf(),e=[],t=new Bn,ge(r,2),C(r,t.init(),4);case 4:return n=Promise.resolve(),TD(t,function(i,s){n=n.then(function(){var o;return F(function(u){if(u.g==1)return C(u,s.getAllManifests(),2);o=u.h,o.forEach(function(l,f){l=Im(new ai("manifest",i.Qb,i.bb,f),l),e.push(l)}),ie(u)})})}),C(r,n,2);case 2:return ye(r),C(r,t.destroy(),6);case 6:Oe(r,3);break;case 3:return r.return(e)}})}function $D(e,t,n,r){var i,s,o,u,l;return F(function(f){if(f.g==1)return i=null,s=e.g,o={networkingEngine:s,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(g){i=g},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return r.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){},addFont:function(){}},n.configure(r.manifest),sr(e),C(f,n.start(t,o),2);if(f.g!=3)return u=f.h,sr(e),l=YS(u),C(f,Promise.all(Xh(l,function(g){return g.createSegmentIndex()})),3);if(sr(e),i)throw i;return f.return(u)})}function YD(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A,I,E,R;return F(function(M){switch(M.g){case 1:return C(M,$S(e,t),2);case 2:if(r=M.h,r!="text/vtt")throw new H(1,2,2017,t);return C(M,QD(t,e.g,e.h.streaming.retryParameters),3);case 3:if(i=M.h,s=za(r),!s)throw new H(2,2,2014,r);for(o=s(),u={periodStart:0,segmentStart:0,segmentEnd:n.presentationTimeline.getDuration(),vttOffset:0},l=Le(i),f=o.parseMedia(l,u,t,[]),g=[],y=x(f),v=y.next(),w={};!v.done;w={Uf:void 0,od:void 0},v=y.next())w.od=v.value,w.Uf=null,A=(function(D){return function(){return D.Uf==null&&(D.Uf=$t([t],[D.od.payload])),D.Uf||[]}})(w),I=new Ce(w.od.startTime,w.od.endTime,A,0,null,null,0,0,1/0),w.od.payload.includes("#xywh")&&(E=w.od.payload.split("#xywh=")[1].split(","),E.length===4&&I.Lf({height:parseInt(E[3],10),positionX:parseInt(E[0],10),positionY:parseInt(E[1],10),width:parseInt(E[2],10)})),g.push(I);if(R=r,!g.length){M.A(4);break}return C(M,Lo(g[0].P()[0],e.g,e.h.manifest.retryParameters),5);case 5:R=M.h;case 4:return M.return({id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Qe(g),mimeType:R||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"image",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Ct(R||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null})}})}function qD(e,t,n,r,i,s,o){var u,l,f;return F(function(g){if(g.g==1)return s?g.A(2):C(g,$S(e,n),3);if(g.g!=2&&(s=g.h),u={id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:kc(0,t.presentationTimeline.getDuration(),[n]),mimeType:s||"",codecs:o||"",kind:i,encrypted:!1,drmInfos:[],keyIds:new Set,language:r,originalLanguage:r,label:null,type:Fe,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Ct(s||"",o||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},l=Ct(u.mimeType,u.codecs),f=Wa(l),!f)throw new H(2,2,2014,s);return g.return(u)})}function $S(e,t){var n;return F(function(r){switch(r.g){case 1:return Z(r,2),C(r,Lo(t,e.g,e.h.streaming.retryParameters),4);case 4:n=r.h,ce(r,3);break;case 2:se(r);case 3:if(n)return r.return(n);throw new H(1,2,2011,t)}})}function QD(e,t,n){var r,i,s;return F(function(o){return o.g==1?(r=wr,i=Nt([e],n),i.method="GET",C(o,t.request(r,i).promise,2)):(s=o.h,o.return(s.data))})}p.md=function(e,t,n,r){var i=this,s;return F(function(o){return o.g==1?(s=new mc({vc:i.g,onError:t,yf:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),s.configure(n.drm),C(o,fC(s,e.variants,r),2)):o.g!=3?C(o,S0(s),3):o.return(s)})};function JD(e,t,n,r){var i=new Map,s=YS(n),o=new Map;s=x(s);for(var u=s.next();!u.done;u=s.next()){u=u.value;var l=ZD(e,t,n,u,r,i);o.set(u.id,l)}for(e=x(n.variants),t=e.next();!t.done;t=e.next())t=t.value,t.audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),Fh:Array.from(i.values())}}function ZD(e,t,n,r,i,s){var o={id:r.id,originalId:r.originalId,groupId:r.groupId,primary:r.primary,type:r.type,mimeType:r.mimeType,codecs:r.codecs,frameRate:r.frameRate,pixelAspectRatio:r.pixelAspectRatio,hdr:r.hdr,colorGamut:r.colorGamut,videoLayout:r.videoLayout,kind:r.kind,language:r.language,originalLanguage:r.originalLanguage,label:r.label,width:r.width||null,height:r.height||null,encrypted:r.encrypted,keyIds:r.keyIds,segments:[],variantIds:[],roles:r.roles,forced:r.forced,channelsCount:r.channelsCount,audioSamplingRate:r.audioSamplingRate,spatialAudio:r.spatialAudio,closedCaptions:r.closedCaptions,tilesLayout:r.tilesLayout,mssPrivateData:r.mssPrivateData,external:r.external,fastSwitching:r.fastSwitching,isAudioMuxedInVideo:r.isAudioMuxedInVideo},u=i.offline.numberOfParallelDownloads,l=u===0?r.id:0;return e4(r,n.presentationTimeline.Ib(),function(f,g){var y=vm(f),v=void 0;if(!s.has(y)){var w=f.endTime-f.startTime;w=HS(t,r.id)*w,w=CS(e.g,w),s.set(y,new ES(f,w,l,!1,g))}f.ea&&(v=vm(f.ea),s.has(v)||(w=HS(t,r.id)*.5,w=CS(e.g,w),s.set(v,new ES(f.ea,w,l,!0,g)))),o.segments.push({pendingInitSegmentRefId:v,initSegmentKey:v?0:null,startTime:f.startTime,endTime:f.endTime,appendWindowStart:f.appendWindowStart,appendWindowEnd:f.appendWindowEnd,timestampOffset:f.timestampOffset,tilesLayout:f.tilesLayout,pendingSegmentRefId:y,dataKey:0,mimeType:f.mimeType,codecs:f.codecs,thumbnailSprite:f.thumbnailSprite}),u!==0&&(l=(l+1)%u)}),o}function e4(e,t,n){if(t=e.segmentIndex.find(t),t!=null)for(var r=e.segmentIndex.get(t);r;)n(r,t),r=e.segmentIndex.get(++t)}function sr(e){if(e.j.g)throw new H(2,9,7001)}function tf(){if(!Cm())throw new H(2,9,9e3)}function Rm(e,t){return F(function(n){return n.g==1?(e.i.push(t),ge(n,2),C(n,t,4)):n.g!=2?n.return(n.h):(ye(n),Dr(e.i,t),Oe(n,0))})}function t4(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){Dr(e.i,n)})}function n4(e){var t=new Set;e=x(e.streams);for(var n=e.next();!n.done;n=e.next()){n=x(n.value.segments);for(var r=n.next();!r.done;r=n.next())r=r.value,r.initSegmentKey!=null&&t.add(r.initSegmentKey),t.add(r.dataKey)}return Array.from(t)}function r4(e,t,n,r){var i,s,o;return F(function(u){return u.g==1?r.drmInfo?(i=SD(n),s=r.sessionIds.map(function(l){return{sessionId:l,keySystem:r.drmInfo.keySystem,licenseUri:r.drmInfo.licenseServerUri,serverCertificate:r.drmInfo.serverCertificate,audioCapabilities:KS(r,!1),videoCapabilities:KS(r,!0)}}),C(u,FS(t,e,s),2)):u.return():u.g!=3?(o=u.h,C(u,i.remove(o),3)):C(u,i.add(s.filter(function(l){return!o.includes(l.sessionId)})),0)})}function YS(e){for(var t=new Set,n=x(e.variants),r=n.next();!r.done;r=n.next())r=r.value,r.audio&&t.add(r.audio),r.video&&t.add(r.video);for(n=x(e.textStreams),r=n.next();!r.done;r=n.next())t.add(r.value);for(e=x(e.imageStreams),n=e.next();!n.done;n=e.next())t.add(n.value);return t}function i4(e){e.variants.map(function(s){return s.video});var t=new Set(e.variants.map(function(s){return s.audio}));e=e.textStreams;for(var n=x(t),r=n.next();!r.done;r=n.next()){r=x(t);for(var i=r.next();!i.done;i=r.next());}for(t=x(e),n=t.next();!n.done;n=t.next())for(n=x(e),r=n.next();!r.done;r=n.next());}de("shaka.offline.Storage",Jt),Jt.deleteAll=function(){var e;return F(function(t){return t.g==1?(e=new Bn,ge(t,2),C(t,AD(e),2)):t.g!=5?(ye(t),C(t,e.destroy(),5)):Oe(t,0)})},Jt.prototype.list=Jt.prototype.list,Jt.prototype.removeEmeSessions=Jt.prototype.Ok,Jt.prototype.remove=Jt.prototype.remove,Jt.prototype.store=Jt.prototype.store,Jt.prototype.getNetworkingEngine=Jt.prototype.Zb,Jt.prototype.getConfiguration=Jt.prototype.getConfiguration,Jt.prototype.configure=Jt.prototype.configure,Jt.prototype.destroy=Jt.prototype.destroy,Jt.support=Cm;var s4=new Map().set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c");CT("offline",Cm);function Fn(){}function or(e,t){for(e={priority:t||0,callback:e},t=0;t<qu.length;t++)if(qu[t].priority<e.priority){qu.splice(t,0,e);return}qu.push(e)}de("shaka.polyfill",Fn),Fn.register=or,Fn.installAll=function(){for(var e=x(qu),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){Be("Error installing polyfill!",n)}}};var qu=[];function nf(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}nf.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=x(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(t=x(e.audioCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},nf.prototype.createMediaKeys=function(){return this.g.createMediaKeys()};function qS(e){return e.startsWith("com.apple")?"cbcs":e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("org.w3")||e.startsWith("com.huawei")?"cenc":(Be("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function QS(e){if(!e)return!1;e=e.getConfiguration();var t=e.audioCapabilities&&e.audioCapabilities[0];return!!((e=e.videoCapabilities&&e.videoCapabilities[0]||t)&&e.encryptionScheme!==void 0)}function km(e,t){return!!(!e||e==t||(e=="cbcs"||e=="cbcs-1-9")&&je().ed())}function JS(){}var Qu;function ZS(){je().Nf()&&!Qu&&!navigator.emeEncryptionSchemePolyfilled&&navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration&&(Qu=navigator.requestMediaKeySystemAccess,navigator.requestMediaKeySystemAccess=o4,navigator.emeEncryptionSchemePolyfilled=!0)}function o4(e,t){var n=this,r;return F(function(i){return i.g==1?C(i,Qu.call(n,e,t),2):(r=i.h,QS(r)?(navigator.requestMediaKeySystemAccess=Qu,i.return(r)):(navigator.requestMediaKeySystemAccess=eA,i.return(eA.call(n,e,t))))})}function eA(e,t){var n=this,r,i,s,o,u,l,f,g,y,v,w,A;return F(function(I){if(I.g==1){for(r=qS(e),i=[],s=x(t),o=s.next();!o.done;o=s.next())u=o.value,l=tA(u.videoCapabilities,r),f=tA(u.audioCapabilities,r),u.videoCapabilities&&u.videoCapabilities.length&&!l.length||u.audioCapabilities&&u.audioCapabilities.length&&!f.length||(g=Object.assign({},u),g.videoCapabilities=l,g.audioCapabilities=f,i.push(g));if(!i.length)throw y=Error("Unsupported keySystem or supportedConfigurations."),y.name="NotSupportedError",y.code=DOMException.NOT_SUPPORTED_ERR,y;return C(I,Qu.call(n,e,i),2)}return v=I.h,A=w=null,i[0]&&(i[0].videoCapabilities&&(w=i[0].videoCapabilities[0].encryptionScheme),i[0].audioCapabilities&&(A=i[0].audioCapabilities[0].encryptionScheme)),I.return(new nf(v,w,A))})}function tA(e,t){return e&&e.filter(function(n){return km(n.encryptionScheme,t)})}Fn.EmeEncryptionScheme=JS,JS.install=ZS,or(ZS);function nA(){}var Ju;function rA(){je().Nf()&&!Ju&&!navigator.mediaCapabilitiesEncryptionSchemePolyfilled&&navigator.mediaCapabilities&&(Ju=navigator.mediaCapabilities.decodingInfo,navigator.mediaCapabilities.decodingInfo=a4,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0)}function a4(e){var t=this,n,r;return F(function(i){switch(i.g){case 1:return C(i,Ju.call(t,e),2);case 2:if(n=i.h,!n.supported||!e.keySystemConfiguration)return i.return(n);if(r=n.keySystemAccess,QS(r))return navigator.mediaCapabilities.decodingInfo=Ju,i.return(n);if(navigator.mediaCapabilities.decodingInfo=iA,r){i.A(3);break}return C(i,sA(e),4);case 4:return n.keySystemAccess=i.h,i.return(n);case 3:return i.return(iA.call(t,e))}})}function iA(e){var t=this,n,r,i,s,o,u,l;return F(function(f){switch(f.g){case 1:return r=n=null,!e.keySystemConfiguration||(i=e.keySystemConfiguration,s=i.keySystem,r=i.audio&&i.audio.encryptionScheme,n=i.video&&i.video.encryptionScheme,o=qS(s),u={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},km(r,o)&&km(n,o))?C(f,Ju.call(t,e),2):f.return(u);case 2:if(l=f.h,l.keySystemAccess){l.keySystemAccess=new nf(l.keySystemAccess,n,r),f.A(3);break}if(!e.keySystemConfiguration){f.A(3);break}return C(f,sA(e),5);case 5:l.keySystemAccess=f.h;case 3:return f.return(l)}})}function sA(e){var t,n;return F(function(r){if(r.g==1){var i=e.keySystemConfiguration,s=[],o=[];return i.audio&&s.push({robustness:i.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:i.audio.encryptionScheme}),i.video&&o.push({robustness:i.video.robustness||"",contentType:e.video.contentType,encryptionScheme:i.video.encryptionScheme}),i={initDataTypes:i.initDataType?[i.initDataType]:[],distinctiveIdentifier:i.distinctiveIdentifier,persistentState:i.persistentState,sessionTypes:i.sessionTypes},s.length&&(i.audioCapabilities=s),o.length&&(i.videoCapabilities=o),t=i,C(r,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=r.h,r.return(n)})}Fn.MCapEncryptionScheme=nA,nA.install=rA,or(rA,-2);function rf(){}function oA(){je().hc()||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),rf.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=u4)}function u4(e){var t,n,r,i,s,o,u,l,f,g,y;return F(function(v){switch(v.g){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},je(),n=e.video,r=e.audio,e.type!="media-source"){if(e.type=="file"){if(n&&(i=n.contentType,s=Bs().canPlayType(i)!="",!s)||r&&(o=r.contentType,u=Bs().canPlayType(o)!="",!u))return v.return(t)}else return v.return(t);v.A(2);break}if(!oi())return v.return(t);if(!n){v.A(3);break}return C(v,l4(n),4);case 4:if(l=v.h,!l)return v.return(t);case 3:if(r){var w=je().Oa(),A=r.contentType;if(w==="CAST"&&r.spatialRendering&&(A+="; spatialRendering=true"),f=vn(A),!f)return v.return(t)}case 2:return e.keySystemConfiguration?(g=e.keySystemConfiguration,C(v,c4(n,r,g),6)):(t.supported=!0,v.return(t));case 6:(y=v.h)&&(t.supported=!0,t.keySystemAccess=y);case 5:return v.return(t)}})}function l4(e){var t,n,r;return F(function(i){return i.g==1?(t=je(),n=t.Oa(),n!=="CAST"?i.A(2):C(i,d4(e),3)):i.g!=2?(r=i.h,i.return(r)):i.return(vn(e.contentType))})}function c4(e,t,n){var r,i,s,o,u,l,f,g,y,v,w,A;return F(function(I){switch(I.g){case 1:r=[],i=[],s=[],n.audio&&(o={robustness:n.audio.robustness||"",contentType:t.contentType},je().zi()&&t.contentType.includes('codecs="ac-3"')&&(o.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(o.encryptionScheme=n.audio.encryptionScheme,s.push(n.audio.encryptionScheme)),r.push(o)),n.video&&(u={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(u.encryptionScheme=n.video.encryptionScheme,s.push(n.video.encryptionScheme)),i.push(u)),l={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},r.length&&(l.audioCapabilities=r),i.length&&(l.videoCapabilities=i),f=e?e.contentType:"",g=t?t.contentType:"",y=Kn(f)+";"+Ji(f),v=Kn(g)+";"+Ji(g),w=n.keySystem,A=null,Z(I,2);var E=xh(y,v,w,s);if(oo.has(E)){E=xh(y,v,w,s),A=oo.get(E)||null,I.A(4);break}return C(I,navigator.requestMediaKeySystemAccess(n.keySystem,[l]),5);case 5:E=A=I.h;var R=xh(y,v,w,s);oo.set(R,E);case 4:ce(I,3);break;case 2:se(I);case 3:return I.return(A)}})}function d4(e){var t,n,r,i,s;return F(function(o){if(o.g==1){if(!(m.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return o.return(vn(e.contentType));switch(t=e.contentType,e.width&&e.height&&e.width>1280&&e.height>720&&(t+="; width="+e.width+"; height="+e.height),e.framerate&&(n=Math.round(e.framerate),n<24||n>30)&&(t+="; framerate="+e.framerate),r=e.transferFunction||"",r){case"":case"srgb":break;case"pq":t+="; eotf=smpte2084";break;case"hlg":t+="; eotf=arib-std-b67";break;default:return o.return(!1)}return i=!1,s=f4,s.has(t)?(i=s.get(t),o.A(2)):C(o,cast.__platform__.canDisplayType(t),3)}return o.g!=2&&(i=o.h,s.set(t,i)),o.return(i)})}Fn.MediaCapabilities=rf,rf.install=oA,rf.originalMcap=null;var f4=new Map;or(oA,-1);function aA(){}function uA(){var e=je(),t=e.Ha()==="WEBKIT"?e.Ba():null;for((m.MediaSource||m.ManagedMediaSource)&&t&&m.MediaSource&&(t<=12?(lA(),h4()):t<=15&&lA()),e=x(e.Ji()),t=e.next();!t.done;t=e.next())g4(t.value);(m.MediaSource||m.ManagedMediaSource)&&p4(),m.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&m4()}function lA(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,Rt.apply(0,arguments));return t.abort=function(){},t}}function h4(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function p4(){if(m.MediaSource){var e=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(n){return Xa(n)!="mp2t"&&e(n)}}if(m.ManagedMediaSource){var t=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);m.ManagedMediaSource.isTypeSupported=function(n){return Xa(n)!="mp2t"&&t(n)}}}function g4(e){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(r){return Ji(r)!=e&&t(r)},m.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);m.ManagedMediaSource.isTypeSupported=function(r){return Ji(r)!=e&&n(r)}}}function m4(){var e=MediaSource.isTypeSupported;je().dj()&&(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),r=n.findIndex(function(o){return o.startsWith("codecs=")});if(r<0)return e(t);var i=n[r].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),s=i.findIndex(function(o){return o.startsWith("vp09")});return s>=0&&(i[s]="vp9",n[r]='codecs="'+i.join(",")+'"',t=n.join("; ")),e(t)})}Fn.MediaSource=aA,aA.install=uA,or(uA);function _m(){}var Pm,Dm,Lm,bm,Nm,Om;function cA(e){m.HTMLVideoElement&&m.WebKitMediaKeys&&m.shakaMediaKeysPolyfill!=jm&&(e!==void 0&&e&&(Pm=!0,Dm=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),Lm=HTMLMediaElement.prototype.setMediaKeys,bm=m.MediaKeys,Nm=m.MediaKeySystemAccess,Om=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=v4,m.MediaKeys=Zu,m.MediaKeySystemAccess=sf,navigator.requestMediaKeySystemAccess=y4,m.shakaMediaKeysPolyfill=jm,uc.clear(),oo.clear())}function y4(e,t){try{var n=new sf(e,t);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function v4(e){var t=this.mediaKeys;return t&&t!=e&&dA(t,null),delete this.mediaKeys,(this.mediaKeys=e)?dA(e,this):Promise.resolve()}function x4(e){if(e=Le(e.initData),Ln(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Ki(e.subarray(4),!0),e=Lr(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=vr(e),this.dispatchEvent(t)}Fn.PatchedMediaKeysApple=_m,_m.uninstall=function(){m.shakaMediaKeysPolyfill==jm&&Pm&&(Pm=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",Dm),HTMLMediaElement.prototype.setMediaKeys=Lm,m.MediaKeys=bm,m.MediaKeySystemAccess=Nm,navigator.requestMediaKeySystemAccess=Om,Dm=Om=Lm=Nm=bm=null,m.shakaMediaKeysPolyfill="",uc.clear(),oo.clear())},_m.install=cA;function sf(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=x(t),t=e.next();!t.done;t=e.next()){var n=t.value;if(n.persistentState=="required")t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var r=!1,i=!1;if(n.audioCapabilities)for(var s=x(n.audioCapabilities),o=s.next();!o.done;o=s.next())o=o.value,o.contentType&&(r=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,o.contentType.split(";")[0])&&(t.audioCapabilities.push(o),i=!0));if(n.videoCapabilities)for(n=x(n.videoCapabilities),s=n.next();!s.done;s=n.next())s=s.value,s.contentType&&(r=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,s.contentType.split(";")[0])&&(t.videoCapabilities.push(s),i=!0));r||(i=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=i?t:null}if(t){this.g=t;return}}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}sf.prototype.createMediaKeys=function(){var e=new Zu(this.keySystem);return Promise.resolve(e)},sf.prototype.getConfiguration=function(){return this.g};function Zu(e){this.h=new WebKitMediaKeys(e),this.g=new et}Zu.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary")throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Um(this.h)},Zu.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function dA(e,t){if(e.g.Qa(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",x4);try{return Do(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(n){return Promise.reject(n)}}Zu.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function Um(e){ot.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new et,this.sessionId="",this.expiration=NaN,this.closed=new at,this.keyStatuses=new fA,this.onkeystatuseschange=null}J(Um,ot),p=Um.prototype,p.generateRequest=function(e,t){var n=this;this.h=new at;try{var r=this.l.createSession("video/mp4",Le(t));this.i=r,this.sessionId=r.sessionId||"",this.j.D(this.i,"webkitkeymessage",function(i){n.h&&(n.h.resolve(),n.h=null),i=new Map().set("messageType",n.keyStatuses.Kc()==null?"license-request":"license-renewal").set("message",vr(i.message)),i=new Se("message",i),n.dispatchEvent(i)}),this.j.D(r,"webkitkeyadded",function(){n.g&&(of(n,"usable"),n.g.resolve(),n.g=null)}),this.j.D(r,"webkitkeyerror",function(){var i=Error("EME PatchedMediaKeysApple key error");if(i.errorCode=n.i.error,n.h!=null)n.h.reject(i),n.h=null;else if(n.g!=null)n.g.reject(i),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:of(n,"output-not-allowed");break;default:of(n,"internal-error")}}),of(this,"status-pending")}catch(i){this.h.reject(i)}return this.h},p.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},p.update=function(e){this.g=new at;try{this.i.update(Le(e))}catch(t){this.g.reject(t)}return this.g},p.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Qa()}catch(e){this.closed.reject(e)}return this.closed},p.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};function of(e,t){var n=e.keyStatuses;n.size=t==null?0:1,n.g=t,t=new Se("keystatuseschange"),e.dispatchEvent(t),e.onkeystatuseschange&&e.onkeystatuseschange(t)}function fA(){this.size=0,this.g=void 0}p=fA.prototype,p.Kc=function(){return this.g},p.forEach=function(e){this.g&&e(this.g,Fl.value())},p.get=function(e){if(this.has(e))return this.g},p.has=function(e){var t=Fl.value();return!!(this.g&&hi(e,t))},p.entries=function(){},p.keys=function(){},p.values=function(){};var jm="apple";or(function(){m.HTMLVideoElement&&m.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||cA())});function hA(){}function pA(){if(m.MediaKeys){var e=je();MediaKeys.prototype.setServerCertificate&&e.ve()||(MediaKeys.prototype.setServerCertificate=T4)}}function T4(){return Promise.resolve(!1)}Fn.PatchedMediaKeysCert=hA,hA.install=pA,or(pA);function gA(){}function mA(){if(!(!m.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Gm="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=w4,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=S4,m.MediaKeys=el,m.MediaKeySystemAccess=af,m.shakaMediaKeysPolyfill=A4}}function Bm(e){var t=Gm;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function w4(e,t){try{var n=new af(e,t);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function S4(e){var t=this.mediaKeys;return t&&t!=e&&yA(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&yA(e,this),Promise.resolve()}Fn.PatchedMediaKeysWebkit=gA,gA.install=mA;function af(e,t){this.g=this.keySystem=e;var n=!1;e=="org.w3.clearkey"&&(this.g="webkit-org.w3.clearkey",n=!1);var r=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video"),t=x(t);for(var s=t.next();!s.done;s=t.next()){s=s.value;var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},u=!1;if(s.audioCapabilities)for(var l=x(s.audioCapabilities),f=l.next();!f.done;f=l.next())f=f.value,f.contentType&&(u=!0,i.canPlayType(f.contentType.split(";")[0],this.g)&&(o.audioCapabilities.push(f),r=!0));if(s.videoCapabilities)for(l=x(s.videoCapabilities),f=l.next();!f.done;f=l.next())f=f.value,f.contentType&&(u=!0,i.canPlayType(f.contentType,this.g)&&(o.videoCapabilities.push(f),r=!0));if(u||(r=i.canPlayType("video/mp4",this.g)||i.canPlayType("video/webm",this.g)),s.persistentState=="required"&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):r=!1),r){this.h=o;return}}throw n="Unsupported keySystem",(e=="org.w3.clearkey"||e=="com.widevine.alpha")&&(n="None of the requested configurations were supported."),e=Error(n),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}af.prototype.createMediaKeys=function(){var e=new el(this.g);return Promise.resolve(e)},af.prototype.getConfiguration=function(){return this.h};function el(e){this.l=e,this.h=null,this.g=new et,this.i=[],this.j=new Map}function yA(e,t){e.h=t,e.g.Qa();var n=Gm;t&&(e.g.D(t,n+"needkey",function(r){var i=new CustomEvent("encrypted");i.initDataType="cenc",i.initData=vr(r.initData),e.h.dispatchEvent(i)}),e.g.D(t,n+"keymessage",function(r){var i=Fm(e,r.sessionId);i&&(r=new Map().set("messageType",i.keyStatuses.Kc()==null?"licenserequest":"licenserenewal").set("message",r.message),r=new Se("message",r),i.h&&(i.h.resolve(),i.h=null),i.dispatchEvent(r))}),e.g.D(t,n+"keyadded",function(r){(r=Fm(e,r.sessionId))&&r.ready()}),e.g.D(t,n+"keyerror",function(r){var i=Fm(e,r.sessionId);if(i){var s=Error("EME v0.1b key error"),o=r.errorCode;o.systemCode=r.systemCode,s.errorCode=o,!r.sessionId&&i.h?(r.systemCode==45&&(s.message="Unsupported session type."),i.h.reject(s),i.h=null):r.sessionId&&i.g?(i.g.reject(s),i.g=null):(s=r.systemCode,r.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?uf(i,"output-restricted"):s==1?uf(i,"expired"):uf(i,"internal-error"))}}))}el.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary"&&e!="persistent-license")throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new Vm(t,this.l,e),this.i.push(e),e},el.prototype.setServerCertificate=function(){return Promise.resolve(!1)},el.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function Fm(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function Vm(e,t,n){ot.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new at,this.keyStatuses=new xA,this.onkeystatuseschange=null}J(Vm,ot),p=Vm.prototype,p.ready=function(){uf(this,"usable"),this.g&&this.g.resolve(),this.g=null};function vA(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if(e.l=="persistent-license")if(n)var r=Le(Lr("LOAD_SESSION|"+n));else{var i=Lr("PERSISTENT|");r=Lt(i,t)}else r=Le(t)}catch(o){return Promise.reject(o)}e.h=new at;var s=Bm("generateKeyRequest");try{e.j[s](e.i,r)}catch(o){if(o.name!="InvalidStateError")return e.h=null,Promise.reject(o);new Ve(function(){try{e.j[s](e.i,r)}catch(u){e.h.reject(u),e.h=null}}).ka(.01)}return e.h}function Hm(e,t,n){if(e.g)e.g.then(function(){return Hm(e,t,n)}).catch(function(){return Hm(e,t,n)});else{if(e.g=t,e.i=="webkit-org.w3.clearkey"){var r=wt(n),i=JSON.parse(r);i.keys[0].kty!="oct"&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),r=xr(i.keys[0].k),i=xr(i.keys[0].kid)}else r=Le(n),i=null;var s=Bm("addKey");try{e.j[s](e.i,r,i,e.sessionId)}catch(o){e.g.reject(o),e.g=null}}}function uf(e,t){var n=e.keyStatuses;n.size=t==null?0:1,n.g=t,t=new Se("keystatuseschange"),e.dispatchEvent(t),e.onkeystatuseschange&&e.onkeystatuseschange(t)}p.generateRequest=function(e,t){return vA(this,t,null)},p.load=function(e){return this.l=="persistent-license"?vA(this,null,e):Promise.reject(Error("Not a persistent session."))},p.update=function(e){var t=new at;return Hm(this,t,e),t},p.close=function(){if(this.l!="persistent-license"){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Bm("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},p.remove=function(){return this.l!="persistent-license"?Promise.reject(Error("Not a persistent session.")):this.close()};function xA(){this.size=0,this.g=void 0}p=xA.prototype,p.Kc=function(){return this.g},p.forEach=function(e){this.g&&e(this.g,Fl.value())},p.get=function(e){if(this.has(e))return this.g},p.has=function(e){var t=Fl.value();return!!(this.g&&hi(e,t))},p.entries=function(){},p.keys=function(){},p.values=function(){};var Gm="",A4="webkit";or(mA);function TA(){}function wA(){m.crypto&&("randomUUID"in m.crypto||(m.crypto.randomUUID=E4))}function E4(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}Fn.RandomUUID=TA,TA.install=wA,or(wA);function SA(){}function AA(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:I4})}function I4(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}Fn.Symbol=SA,SA.install=AA,or(AA);function EA(){}function IA(){for(var e=x([Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array]),t=e.next();!t.done;t=e.next())t=t.value,t.prototype.indexOf||(t.prototype.indexOf=C4),t.prototype.lastIndexOf||(t.prototype.lastIndexOf=M4),t.prototype.includes||(t.prototype.includes=R4)}function C4(e,t){return Array.prototype.indexOf.call(this,e,t)}function M4(e,t){return Array.prototype.lastIndexOf.call(this,e,t)}function R4(e,t){return this.indexOf(e,t)!==-1}Fn.TypedArray=EA,EA.install=IA,or(IA);function CA(){}function MA(){if(m.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch(function(){}),t}}}Fn.VideoPlayPromise=CA,CA.install=MA,or(MA);function RA(){}function kA(){if(m.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||typeof Bs().webkitDroppedFrameCount=="number")&&(e.getVideoPlaybackQuality=k4)}}function k4(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}Fn.VideoPlaybackQuality=RA,RA.install=kA,or(kA);function _A(){}function PA(){if(!m.VTTCue&&m.TextTrackCue){var e=null,t=TextTrackCue.length;if(t==3)e=Xm;else if(t==6)e=_4;else{try{var n=!!Xm(1,2,"")}catch(r){n=!1}n&&(e=Xm)}e&&(m.VTTCue=function(r,i,s){return e(r,i,s)})}}function Xm(e,t,n){return new m.TextTrackCue(e,t,n)}function _4(e,t,n){return new m.TextTrackCue(e+"-"+t+"-"+n,e,t,n)}Fn.VTTCue=_A,_A.install=PA,or(PA);function qt(e){ot.call(this),this.g=e,this.m=null,this.h=[],this.j=-1,this.i=this.l=null,this.o=new et}J(qt,ot),p=qt.prototype,p.destroy=function(){var e=this;return F(function(t){if(t.g==1)return C(t,e.removeAllItems(),2);e.g=null,e.o&&(e.o.release(),e.o=null),ot.prototype.release.call(e),ie(t)})},p.configure=function(e){this.m=e},p.getConfiguration=function(){return this.m},p.getCurrentItem=function(){return this.h.length&&this.j>=0&&this.j<this.h.length?this.h[this.j]:null},p.getCurrentItemIndex=function(){return this.j},p.getItems=function(){return this.h.slice()},p.insertItems=function(e){this.h.push.apply(this.h,Y(e)),this.dispatchEvent(new Se("itemsinserted"))},p.removeAllItems=function(){var e=this,t,n,r,i;return F(function(s){if(s.g==1)return e.o.Qa(),e.h.length&&e.j>=0?C(s,e.g.Cc(),2):s.A(2);if(s.g!=4){for(t=[],e.i&&(e.i.preloadManager.l||t.push(e.i.preloadManager.destroy()),e.i=null),e.l&&(e.l.preloadManager.l||t.push(e.l.preloadManager.destroy()),e.l=null),n=x(e.h),r=n.next();!r.done;r=n.next())i=r.value,i.preloadManager&&!i.preloadManager.l&&t.push(i.preloadManager.destroy());return t.length?C(s,Promise.all(t),4):s.A(4)}e.h=[],e.j=-1,e.dispatchEvent(new Se("itemsremoved")),ie(s)})},p.playItem=function(e){var t=this,n,r,i,s,o,u,l,f,g,y,v,w,A,I,E,R,M;return F(function(D){switch(D.g){case 1:if(t.o.Qa(),!t.h.length||e>=t.h.length)throw new H(2,7,7007);if(n=t.getCurrentItem(),r=t.h[e],t.j!=e&&(t.j=e,t.dispatchEvent(new Se("currentitemchanged"))),i=t.g.$e(),s=t.m?t.m.preloadNextUrlWindow:0,s>0&&(o=!1,t.o.D(i,"timeupdate",function(){var O,X,b,U;return F(function(N){switch(N.g){case 1:if(t.l||t.h.length<=1||o||t.g.W()||!i.duration)return N.return();if(O=t.g.Ra().end-i.currentTime,isNaN(O)){N.A(0);break}if(!(O<=s)){N.A(0);break}if(X=t.m&&t.m.repeatMode,b=null,t.j+1<t.h.length?b=t.h[t.j+1]:X==1&&(b=t.h[0]),!b||b.preloadManager&&!b.preloadManager.l){N.A(0);break}return o=!0,U=null,Z(N,5),C(N,t.g.preload(b.manifestUri,b.startTime,b.mimeType,b.config),7);case 7:U=N.h,ce(N,6);break;case 5:se(N),U=null;case 6:t.l={item:b,preloadManager:U},o=!1,ie(N)}})})),t.o.D(t.g,"complete",function(){var O=t.m&&t.m.repeatMode,X=!1;if(O==2)X=!0;else{var b=t.j+1;b<t.h.length?t.playItem(b):O==1&&(t.h.length==1?X=!0:t.playItem(0))}X&&(i.paused?(i.currentTime=t.g.Ra().start,i.play()):t.o.D(i,"paused",function(){i.currentTime=t.g.Ra().start,i.play()}))}),u=r.manifestUri,r.preloadManager&&!r.preloadManager.l&&(u=r.preloadManager),l=!1,t.l&&t.l.item==r&&t.l.preloadManager?u=t.l.preloadManager:t.i&&t.i.item==r&&t.i.preloadManager&&(u=t.i.preloadManager,l=!0),!t.i){D.A(2);break}if(l||t.i.preloadManager.l){D.A(3);break}return C(D,t.i.preloadManager.destroy(),3);case 3:t.i=null;case 2:if(!(t.m&&t.m.preloadPrevItem&&n&&t.g.Zd()===an)){D.A(5);break}return f=null,Z(D,6),C(D,t.g.hj(),8);case 8:f=D.h,ce(D,7);break;case 6:se(D),f=null;case 7:t.i={item:n,preloadManager:f};case 5:return r.config&&(t.g.Mi(),t.g.configure(r.config)),C(D,t.g.load(u,r.startTime,r.mimeType),9);case 9:if(t.l=null,r.extraText)for(g=x(r.extraText),y=g.next();!y.done;y=g.next())v=y.value,v.mime?t.g.Qd(v.uri,v.language,v.kind,v.mime,v.codecs):t.g.Qd(v.uri,v.language,v.kind);if(r.extraThumbnail)for(w=x(r.extraThumbnail),A=w.next();!A.done;A=w.next())I=A.value,t.g.Oe(I);if(r.extraChapter)for(E=x(r.extraChapter),R=E.next();!R.done;R=E.next())M=R.value,t.g.Ne(M.uri,M.language,M.mime);ie(D)}})},de("shaka.queue.QueueManager",qt),qt.prototype.playItem=qt.prototype.playItem,qt.prototype.removeAllItems=qt.prototype.removeAllItems,qt.prototype.insertItems=qt.prototype.insertItems,qt.prototype.getItems=qt.prototype.getItems,qt.prototype.getCurrentItemIndex=qt.prototype.getCurrentItemIndex,qt.prototype.getCurrentItem=qt.prototype.getCurrentItem,qt.prototype.getConfiguration=qt.prototype.getConfiguration,qt.prototype.configure=qt.prototype.configure,qt.prototype.destroy=qt.prototype.destroy,dd=function(e){return new qt(e)};function ar(){}ar.prototype.parseInit=function(){},ar.prototype.setSequenceMode=function(){},ar.prototype.setManifestType=function(){},ar.prototype.parseMedia=function(e,t){var n=null,r=[];e=wt(e).split(/\r?\n/),e=x(e);for(var i=e.next();!i.done;i=e.next())if((i=i.value)&&!/^\s+$/.test(i)&&(i=P4.exec(i))){var s=D4.exec(i[1]);s=parseInt(s[1],10)*60+parseFloat(s[2].replace(",",".")),i=new ht(s,t.segmentEnd?t.segmentEnd:s+2,i[2]),n&&(n.endTime=s,r.push(n)),n=i}return n&&r.push(n),r},de("shaka.text.LrcTextParser",ar),ar.prototype.parseMedia=ar.prototype.parseMedia,ar.prototype.setManifestType=ar.prototype.setManifestType,ar.prototype.setSequenceMode=ar.prototype.setSequenceMode,ar.prototype.parseInit=ar.prototype.parseInit;var P4=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,D4=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;sn("application/x-subtitle-lrc",function(){return new ar});function Zn(){this.g="UNKNOWN"}Zn.prototype.parseInit=function(){},Zn.prototype.setSequenceMode=function(){},Zn.prototype.setManifestType=function(e){this.g=e},Zn.prototype.parseMedia=function(e,t,n,r){var i=wt(e);if(e=[],i=="")return e;var s=ks(i,"tt",!0);if(!s)throw new H(2,2,2005,"Failed to parse TTML.");if(i=Kr(s,"body")[0],!i)return[];var o=ti(s,tl,"frameRate"),u=ti(s,tl,"subFrameRate"),l=ti(s,tl,"frameRateMultiplier"),f=ti(s,tl,"tickRate"),g=ti(s,tl,"cellResolution"),y=s.attributes["xml:space"]||"default",v=ti(s,df,"extent");if(y!="default"&&y!="preserve")throw new H(2,2,2005,"Invalid xml:space value: "+y);y=y=="default",o=new U4(o,u,l,f),g=O4(g),u=Kr(s,"metadata")[0],u=(u?u.children:[]).filter(function(I){return I!="\n"}),l=Kr(s,"style"),s=Kr(s,"region"),f=[];for(var w=x(s),A=w.next();!A.done;A=w.next())(A=L4(this,A.value,l,v))&&f.push(A);if(it(i,"p").length)throw new H(2,2,2001,"<p> can only be inside <div> in TTML");for(v=x(it(i,"div")),w=v.next();!w.done;w=v.next())if(it(w.value,"span").length)throw new H(2,2,2001,"<span> can only be inside <p> in TTML");return(t=DA(this,i,t,o,u,l,s,f,y,g,null,!1,n,r))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e};function DA(e,t,n,r,i,s,o,u,l,f,g,y,v,w){var A=g;if(zl(t)){if(!y)return null;var I={tagName:"span",children:[Dt(t)],attributes:{},parent:null}}else I=t;for(var E=null,R=x(HA),M=R.next();!M.done&&!(E=cf(I,"backgroundImage",i,"#",M.value)[0]);M=R.next());R=null,M=ti(I,HA,"backgroundImage");var D=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if(M&&D.test(M)){if(R=parseInt(M.split(":").pop(),10)-1,R>=w.length)return null;R=w[R]}else v&&M&&!M.startsWith("#")&&(D=new Pt(v),M=new Pt(M),(M=D.resolve(M).toString())&&(R=M));if((t.tagName=="p"||E||R)&&(y=!0),t=y,M=(I.attributes["xml:space"]||(l?"default":"preserve"))=="default",D=I.children.every(zl),l=[],!D)for(var O=x(I.children),X=O.next();!X.done;X=O.next())(X=DA(e,X.value,n,r,i,s,o,u,M,f,I,y,v,w))&&l.push(X);if(i=g!=null,v=Dt(I),v=I.children.length&&v&&/\S/.test(v),O=I.attributes.begin||I.attributes.end||I.attributes.dur,!(O||v||I.tagName=="br"||l.length!=0||i&&!M))return null;for(w=NA(I,r),v=w.start,w=w.end;A&&A.tagName&&A.tagName!="tt";)w=N4(A,r,v,w),v=w.start,w=w.end,A=A.parent;if(v==null&&(v=0),v+=n.periodStart,w=w==null?1/0:w+n.periodStart,e.g!=="HLS"&&(v=Math.max(v,n.segmentStart),w=Math.min(w,n.segmentEnd)),!O&&l.length>0)for(v=1/0,w=0,n=x(l),r=n.next();!r.done;r=n.next())r=r.value,v=Math.min(v,r.startTime),w=Math.max(w,r.endTime);if(I.tagName=="br")return e=new ht(v,w,""),e.lineBreak=!0,e;if(n="",D&&(n=En(Dt(I)||""),M&&(n=n.replace(/\s+/g," "))),n=new ht(v,w,n),n.nestedCues=l,y||(n.isContainer=!0),f&&(n.cellResolution=f),f=cf(I,"region",o,"")[0],I.attributes.region&&f&&f.attributes["xml:id"]){var b=f.attributes["xml:id"];n.region=u.filter(function(U){return U.id==b})[0]}return u=f,g&&i&&!I.attributes.region&&!I.attributes.style&&(u=cf(g,"region",o,"")[0]),b4(e,n,I,u,E,R,s,t,l.length==0),n}function L4(e,t,n,r){var i=new Ms,s=t.attributes["xml:id"];if(!s)return null;i.id=s,s=null,r&&(s=Ym.exec(r)||qm.exec(r)),r=s?Number(s[1]):null,s=s?Number(s[2]):null;var o,u=lf(e,t,n,"extent");if(u){var l=(o=Ym.exec(u))||qm.exec(u);l!=null&&(i.width=Number(l[1]),i.height=Number(l[2]),o||(r!=null&&(i.width=i.width*100/r),s!=null&&(i.height=i.height*100/s)),i.widthUnits=o||r!=null?Wn:0,i.heightUnits=o||s!=null?Wn:0)}return(e=lf(e,t,n,"origin"))&&(l=(o=Ym.exec(e))||qm.exec(e),l!=null&&(i.viewportAnchorX=Number(l[1]),i.viewportAnchorY=Number(l[2]),o?u||(i.width=100-i.viewportAnchorX,i.widthUnits=Wn,i.height=100-i.viewportAnchorY,i.heightUnits=Wn):(s!=null&&(i.viewportAnchorY=i.viewportAnchorY*100/s),r!=null&&(i.viewportAnchorX=i.viewportAnchorX*100/r)),i.viewportAnchorUnits=o||r!=null?Wn:0)),i}function zm(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&(t=t[1].split(","),t.length==4)?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e}function b4(e,t,n,r,i,s,o,u,l){if(u=u||l,pn(e,n,r,o,"direction",u)=="rtl"&&(t.direction="rtl"),l=pn(e,n,r,o,"writingMode",u),l=="tb"||l=="tblr"?t.writingMode="vertical-lr":l=="tbrl"?t.writingMode="vertical-rl":l=="rltb"||l=="rl"?t.direction="rtl":l&&(t.direction=Ha),(l=pn(e,n,r,o,"textAlign",!0))?(t.positionAlign=F4.get(l),t.lineAlign=B4.get(l),t.textAlign=_h[l.toUpperCase()]):t.textAlign=ii,(l=pn(e,n,r,o,"displayAlign",!0))&&(t.displayAlign=Ov[l.toUpperCase()]),(l=pn(e,n,r,o,"color",u))&&(t.color=zm(l)),(l=pn(e,n,r,o,"backgroundColor",u))&&(t.backgroundColor=zm(l)),(l=pn(e,n,r,o,"border",u))&&(t.border=l),l=pn(e,n,r,o,"fontFamily",u))switch(l){case"monospaceSerif":t.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":t.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":t.fontFamily="sans-serif";break;case"monospaceSansSerif":t.fontFamily="Consolas,monospace";break;case"proportionalSerif":t.fontFamily="serif";break;default:t.fontFamily=l.split(",").filter(function(f){return f!="default"}).join(",")}switch((l=pn(e,n,r,o,"fontWeight",u))&&l=="bold"&&(t.fontWeight=ho),l=pn(e,n,r,o,"wrapOption",u),t.wrapLine=!(l&&l=="noWrap"),(l=pn(e,n,r,o,"lineHeight",u))&&l.match(na)&&(t.lineHeight=l),(l=pn(e,n,r,o,"fontSize",u))&&(l.match(na)||l.match(j4))&&(t.fontSize=l),(l=pn(e,n,r,o,"fontStyle",u))&&(t.fontStyle=Fv[l.toUpperCase()]),i?(s=i.attributes.imageType||i.attributes.imagetype,l=i.attributes.encoding,i=Dt(i).trim(),s=="PNG"&&l=="Base64"&&i&&(t.backgroundImage="data:image/png;base64,"+i)):s&&(t.backgroundImage=s),(i=pn(e,n,r,o,"textOutline",u))&&(i=i.split(" "),i[0].match(na)?t.textStrokeColor=t.color:(t.textStrokeColor=zm(i[0]),i.shift()),i[0]&&i[0].match(na)?t.textStrokeWidth=i[0]:t.textStrokeColor=""),(i=pn(e,n,r,o,"letterSpacing",u))&&i.match(na)&&(t.letterSpacing=i),(i=pn(e,n,r,o,"linePadding",u))&&i.match(na)&&(t.linePadding=i),(i=pn(e,n,r,o,"opacity",u))&&(t.opacity=parseFloat(i)),(i=lf(e,r,o,"textDecoration"))&&LA(t,i),(i=Wm(e,n,o,"textDecoration"))&&LA(t,i),(i=pn(e,n,r,o,"textCombine",u))&&(t.textCombineUpright=i),pn(e,n,r,o,"ruby",u)){case"container":t.rubyTag="ruby";break;case"text":t.rubyTag="rt"}}function LA(e,t){t=x(t.split(" "));for(var n=t.next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(xi)||e.textDecoration.push(xi);break;case"noUnderline":e.textDecoration.includes(xi)&&Dr(e.textDecoration,xi);break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Dr(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Dr(e.textDecoration,"overline")}}function pn(e,t,n,r,i,s){return s=s===void 0?!0:s,(t=Wm(e,t,r,i))?t:s?lf(e,n,r,i):null}function lf(e,t,n,r){if(!t)return null;var i=ti(t,df,r);return i||bA(e,t,n,r)}function Wm(e,t,n,r){var i=ti(t,df,r);return i||bA(e,t,n,r)}function bA(e,t,n,r){t=cf(t,"style",n,"");for(var i=null,s=0;s<t.length;s++){var o=yi(t[s],"urn:ebu:tt:style",r);o||(o=ti(t[s],df,r)),o||(o=Wm(e,t[s],n,r)),o&&(i=o)}return i}function cf(e,t,n,r,i){var s=[];if(!e||n.length<1)return s;var o=e;for(e=null;!e&&!(e=i?yi(o,i,t):o.attributes[t])&&(o=o.parent,o););if(t=e){for(t=x(t.split(" ")),i=t.next();!i.done;i=t.next())for(i=i.value,e=x(n),o=e.next();!o.done;o=e.next())if(o=o.value,r+o.attributes["xml:id"]==i){s.push(o);break}}return s}function N4(e,t,n,r){return e=NA(e,t),n==null?n=e.start:e.start!=null&&(n+=e.start),r==null?r=e.end:e.start!=null&&(r+=e.start),{start:n,end:r}}function NA(e,t){var n=Km(e.attributes.begin,t),r=Km(e.attributes.end,t);return e=Km(e.attributes.dur,t),r==null&&e!=null&&(r=n+e),{start:n,end:r}}function Km(e,t){var n=null;if(OA.test(e)){e=OA.exec(e),n=Number(e[1]);var r=Number(e[2]),i=Number(e[3]),s=Number(e[4]);s+=(Number(e[5])||0)/t.h,i+=s/t.frameRate,n=i+r*60+n*3600}else if(UA.test(e))n=$m(UA,e);else if(jA.test(e))n=$m(jA,e);else if(BA.test(e))e=BA.exec(e),n=Number(e[1])/t.frameRate;else if(FA.test(e))e=FA.exec(e),n=Number(e[1])/t.g;else if(VA.test(e))n=$m(VA,e);else if(e)throw new H(2,2,2001,"Could not parse cue time range in TTML");return n}function $m(e,t){return e=e.exec(t),e==null||e[0]==""?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+(Number(e[2])||0)*60+(Number(e[1])||0)*3600}function O4(e){return e&&(e=/^(\d+) (\d+)$/.exec(e))?{columns:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}de("shaka.text.TtmlTextParser",Zn),Zn.prototype.parseMedia=Zn.prototype.parseMedia,Zn.prototype.setManifestType=Zn.prototype.setManifestType,Zn.prototype.setSequenceMode=Zn.prototype.setSequenceMode,Zn.prototype.parseInit=Zn.prototype.parseInit;function U4(e,t,n,r){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(r),this.g==0&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}var Ym=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,j4=/^(\d{1,4}(?:\.\d+)?|100)%$/,na=/^(\d+px|\d+em|\d*\.?\d+c)$/,qm=/^(\d+)px (\d+)px$/,OA=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,UA=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,jA=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,BA=/^(\d*(?:\.\d*)?)f$/,FA=/^(\d*(?:\.\d*)?)t$/,VA=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),B4=new Map().set("left",Ps).set("center","center").set("right","end").set("start",Ps).set("end","end"),F4=new Map().set("left","line-left").set("center","center").set("right","line-right"),tl=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],df=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],HA=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];sn("application/ttml+xml",function(){return new Zn});function zt(){this.g=new Zn}zt.prototype.parseInit=function(e){var t=!1;if(new ut().box("moov",Ue).box("trak",Ue).box("mdia",Ue).box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("stpp",function(n){t=!0,n.parser.stop()}).parse(e),!t)throw new H(2,2,2007)},zt.prototype.setSequenceMode=function(e){this.g.setSequenceMode(e)},zt.prototype.setManifestType=function(e){this.g.setManifestType(e)},zt.prototype.parseMedia=function(e,t,n){var r=[],i=null,s=[],o=new Map,u=[];if(new ut().box("moof",Ue).box("traf",Ue).S("tfhd",function(R){i=yc(R.reader,R.flags).Wd}).S("trun",function(R){R=Tc(R.reader,R.version,R.flags),R=x(R.kh);for(var M=R.next();!M.done;M=R.next())u.push(M.value.sampleSize||i||0)}).S("subs",function(R){for(var M=R.reader,D=M.U(),O=-1,X=0;X<D;X++){var b=M.U();O+=b,b=M.Ca();for(var U=[],N=0;N<b;N++)R.version==1?U.push(M.U()):U.push(M.Ca()),M.Y(),M.Y(),M.U();o.set(O,U)}}).box("mdat",So(function(R){s.push(R)},!1)).parse(e,!1),s.length==0)throw new H(2,2,2007);for(var l=Lt.apply(un,Y(s)),f=0,g=0;g<u.length;g++){var y=Le(l,f,u[g]);f+=u[g];var v=o.get(g);if(v&&v.length){y=Le(y,0,v[0]);for(var w=[],A=v[0],I=1;I<v.length;I++){var E=Le(e,A,v[I]);E=Vl(E),w.push("data:image/png;base64,"+E),A+=v[I]}r=r.concat(this.g.parseMedia(y,t,n,w))}else r=r.concat(this.g.parseMedia(y,t,n,[]))}return r},de("shaka.text.Mp4TtmlParser",zt),zt.prototype.parseMedia=zt.prototype.parseMedia,zt.prototype.setManifestType=zt.prototype.setManifestType,zt.prototype.setSequenceMode=zt.prototype.setSequenceMode,zt.prototype.parseInit=zt.prototype.parseInit,sn('application/mp4; codecs="stpp"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.im1i"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.im1t"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.im2i"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.im2t"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.etd1"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.etd1|im1t"',function(){return new zt}),sn('application/mp4; codecs="stpp.ttml.im1t|etd1"',function(){return new zt}),sn('application/mp4; codecs="stpp.TTML.im1t"',function(){return new zt});function Rn(){this.g="UNKNOWN"}Rn.prototype.parseInit=function(){},Rn.prototype.setSequenceMode=function(){},Rn.prototype.setManifestType=function(e){this.g=e},Rn.prototype.parseMedia=function(e,t){e=wt(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");var n=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new H(2,2,2e3);if(e=t.vttOffset,this.g=="HLS"&&n[0].includes("X-TIMESTAMP-MAP")){var r=n[0];if(e=r.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),r=r.match(/MPEGTS:(\d+)/m),!e||!r)throw new H(2,2,2e3);if(e=fo(e[1]),e==null)throw new H(2,2,2e3);r=Number(r[1]);for(var i=t.segmentStart-t.periodStart;i>=95443.7176888889;)i-=95443.7176888889,r+=8589934592;e=t.periodStart+r/9e4-e}for(t=[],r=x(n[0].split("\n")),i=r.next();!i.done;i=r.next())if(i=i.value,/^Region:/.test(i)){i=new lo(i);var s=new Ms;Rs(i),co(i);for(var o=Rs(i);o;){var u=s,l=o;(o=/^id=(.*)$/.exec(l))?u.id=o[1]:(o=/^width=(\d{1,2}|100)%$/.exec(l))?u.width=Number(o[1]):(o=/^lines=(\d+)$/.exec(l))?(u.height=Number(o[1]),u.heightUnits=2):(o=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))?(u.regionAnchorX=Number(o[1]),u.regionAnchorY=Number(o[2])):(o=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))?(u.viewportAnchorX=Number(o[1]),u.viewportAnchorY=Number(o[2])):/^scroll=up$/.exec(l)&&(u.scroll="up"),co(i),o=Rs(i)}t.push(s)}for(r=new Map,bv(r),i=[],n=x(n.slice(1)),s=n.next();!s.done;s=n.next()){if(s=s.value.split("\n"),(s.length!=1||s[0])&&!/^NOTE($|[ \t])/.test(s[0])&&s[0]=="STYLE"){for(u=[],o=-1,l=1;l<s.length;l++)s[l].includes("::cue")&&(u.push([]),o=u.length-1),o!=-1&&(u[o].push(s[l]),s[l].includes("}")&&(o=-1));for(u=x(u),o=u.next();!o.done;o=u.next()){var f=o.value;o="global",(l=f[0].match(/\((.*)\)/))&&(o=l.pop()),l=f.slice(1,-1),f[0].includes("}")&&(f=/\{(.*?)\}/.exec(f[0]))&&(l=f[1].split(";")),(f=r.get(o))||(f=new ht(0,0,""));for(var g=!1,y=0;y<l.length;y++){var v=/^\s*([^:]+):\s*(.*)/.exec(l[y]);if(v){var w=v[2].trim().replace(";","");switch(v[1].trim()){case"background-color":case"background":g=!0,f.backgroundColor=w;break;case"color":g=!0,f.color=w;break;case"font-family":g=!0,f.fontFamily=w;break;case"font-size":g=!0,f.fontSize=w;break;case"font-weight":(parseInt(w,10)>=700||w=="bold")&&(g=!0,f.fontWeight=ho);break;case"font-style":switch(w){case"normal":g=!0,f.fontStyle=Dh;break;case"italic":g=!0,f.fontStyle=po;break;case"oblique":g=!0,f.fontStyle="oblique"}break;case"opacity":g=!0,f.opacity=parseFloat(w);break;case"text-combine-upright":g=!0,f.textCombineUpright=w;break;case"text-shadow":g=!0,f.textShadow=w;break;case"white-space":g=!0,f.wrapLine=w!="noWrap"}}}g&&r.set(o,f)}}if(f=s,g=e,f.length==1&&!f[0]||/^NOTE($|[ \t])/.test(f[0])||f[0]=="STYLE"||f[0]=="REGION")s=null;else if(s=null,f[0].includes("-->")||(s=f[0],f.splice(0,1)),u=new lo(f[0]),o=ja(u),y=$i(u,/[ \t]+--\x3e[ \t]+/g),l=ja(u),o==null||y==null||l==null)Be("Failed to parse VTT time code. Cue skipped:",s,f),s=null;else{for(o+=g,l+=g,o<0&&(o=0),g=f.slice(1).join("\n").trim(),r.has("global")?(f=r.get("global").clone(),f.startTime=o,f.endTime=l,f.payload=g):f=new ht(o,l,g),co(u),o=Rs(u);o;)GA(f,o,t),co(u),o=Rs(u);Ql(f,r),s!=null&&(f.id=s),s=f}s&&i.push(s)}return i};function GA(e,t,n){var r;(r=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=r[1],t=="middle"?e.textAlign=ii:e.textAlign=_h[t.toUpperCase()]):(r=/^vertical:(lr|rl)$/.exec(t))?e.writingMode=r[1]=="lr"?"vertical-lr":"vertical-rl":(r=/^size:([\d.]+)%$/.exec(t))?e.size=Number(r[1]):(r=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(r[1]),r[2]&&(t=r[2],e.positionAlign=t=="line-left"||t=="start"?"line-left":t=="line-right"||t=="end"?"line-right":t=="center"||t=="middle"?"center":Jl)):(r=/^region:(.*)$/.exec(t))?(t=V4(n,r[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=Ph[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Ga,e.line=Number(n[1]),n[2]&&(e.lineAlign=Ph[n[2].toUpperCase()]))}function V4(e,t){return e=e.filter(function(n){return n.id==t}),e.length?e[0]:null}de("shaka.text.VttTextParser",Rn),Rn.prototype.parseMedia=Rn.prototype.parseMedia,Rn.prototype.setManifestType=Rn.prototype.setManifestType,Rn.prototype.setSequenceMode=Rn.prototype.setSequenceMode,Rn.prototype.parseInit=Rn.prototype.parseInit,sn("text/vtt",function(){return new Rn}),sn('text/vtt; codecs="vtt"',function(){return new Rn}),sn('text/vtt; codecs="wvtt"',function(){return new Rn});function ur(){this.g=null}ur.prototype.parseInit=function(e){var t=this,n=!1;if(new ut().box("moov",Ue).box("trak",Ue).box("mdia",Ue).S("mdhd",function(r){r=xc(r.reader,r.version),t.g=r.timescale}).box("minf",Ue).box("stbl",Ue).S("stsd",Ii).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new H(2,2,2008);if(!n)throw new H(2,2,2008)},ur.prototype.setSequenceMode=function(){},ur.prototype.setManifestType=function(){},ur.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new H(2,2,2008);var n=0,r=[],i,s=[],o=!1,u=!1,l=!1,f=null;if(new ut().box("moof",Ue).box("traf",Ue).S("tfdt",function(D){o=!0,n=vc(D.reader,D.version).baseMediaDecodeTime}).S("tfhd",function(D){f=yc(D.reader,D.flags).Vd}).S("trun",function(D){u=!0,r=Tc(D.reader,D.version,D.flags).kh}).box("mdat",So(function(D){l=!0,i=D},!1)).parse(e,!1),!l&&!o&&!u)throw new H(2,2,2008);e=n;for(var g=new pt(i,0),y=x(r),v=y.next();!v.done;v=y.next()){v=v.value;var w=v.mh||f,A=v.Ff?n+v.Ff:e;e=A+(w||0);var I=0;do{var E=g.U();I+=E;var R=g.U(),M=null;pc(R)=="vttc"?E>8&&(M=g.Ub(E-8,!1)):g.skip(E-8),w&&M&&(E=H4(M,t.periodStart+A/this.g,t.periodStart+e/this.g),s.push(E))}while(v.sampleSize&&I<v.sampleSize)}return s.filter(Zi)};function H4(e,t,n){var r,i,s;return new ut().box("payl",So(function(o){r=wt(o)},!1)).box("iden",So(function(o){i=wt(o)},!1)).box("sttg",So(function(o){s=wt(o)},!1)).parse(e),r?G4(r,i,s,t,n):null}function G4(e,t,n,r,i){if(e=new ht(r,i,e),Ql(e),t&&(e.id=t),n)for(t=new lo(n),n=Rs(t);n;)GA(e,n,[]),co(t),n=Rs(t);return e}de("shaka.text.Mp4VttParser",ur),ur.prototype.parseMedia=ur.prototype.parseMedia,ur.prototype.setManifestType=ur.prototype.setManifestType,ur.prototype.setSequenceMode=ur.prototype.setSequenceMode,ur.prototype.parseInit=ur.prototype.parseInit,sn('application/mp4; codecs="wvtt"',function(){return new ur});function lr(){}lr.prototype.parseInit=function(){},lr.prototype.setSequenceMode=function(){},lr.prototype.setManifestType=function(){},lr.prototype.parseMedia=function(e){var t=wt(e).replace(/\r+/g,"");if(t=t.trim(),e=[],t=="")return e;t=x(t.split("\n\n"));for(var n=t.next();!n.done;n=t.next()){n=n.value.split("\n");var r=new lo(n[0]),i=ja(r),s=$i(r,/,/g);if(r=ja(r),i==null||s==null||r==null)throw new H(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new ht(i,r,n.slice(1).join("\n").trim()))}return e},de("shaka.text.SbvTextParser",lr),lr.prototype.parseMedia=lr.prototype.parseMedia,lr.prototype.setManifestType=lr.prototype.setManifestType,lr.prototype.setSequenceMode=lr.prototype.setSequenceMode,lr.prototype.parseInit=lr.prototype.parseInit,sn("text/x-subviewer",function(){return new lr});function cr(){this.g=new Rn}cr.prototype.parseInit=function(){},cr.prototype.setSequenceMode=function(){},cr.prototype.setManifestType=function(){},cr.prototype.parseMedia=function(e,t,n){var r=wt(e);if(e="WEBVTT\n\n",r!=""){r=r.replace(/\r+/g,""),r=r.trim(),r=x(r.split("\n\n"));for(var i=r.next();!i.done;i=r.next())i=i.value.split(/\n/),i[0].match(/\d+/)&&i.shift(),i[0]=i[0].replace(/,/g,"."),e+=i.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n"}return e=Le(Lr(e)),this.g.parseMedia(e,t,n,[])},de("shaka.text.SrtTextParser",cr),cr.prototype.parseMedia=cr.prototype.parseMedia,cr.prototype.setManifestType=cr.prototype.setManifestType,cr.prototype.setSequenceMode=cr.prototype.setSequenceMode,cr.prototype.parseInit=cr.prototype.parseInit,sn("text/srt",function(){return new cr});function dr(){}dr.prototype.parseInit=function(){},dr.prototype.setSequenceMode=function(){},dr.prototype.setManifestType=function(){},dr.prototype.parseMedia=function(e){var t="",n="",r=null,i=null;for(i=wt(e).split(/\r?\n\s*\r?\n/),e=x(i),i=e.next();!i.done;i=e.next()){var s=i.value;i=s,(s=z4.exec(s))&&(r=s[1],i=s[2]),r=="V4 Styles"||r=="V4+ Styles"?(t=i,t=n?t+("\n"+i):i):r=="Events"&&(n=n?n+("\n"+i):i)}for(r=[],i=null,t=x(t.split(/\r?\n/)),e=t.next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(s=WA.exec(e))){if(e=s[1].trim(),s=s[2].trim(),e=="Format")i=s.split(ff);else if(e=="Style"){e=s.split(ff),s={};for(var o=0;o<i.length&&o<e.length;o++)s[i[o]]=e[o];r.push(s)}}for(i=[],t=null,n=x(n.split(/\r?\n/)),s=n.next(),e={};!s.done;e={Zi:void 0},s=n.next())if(s=s.value,!/^\s*;/.test(s)&&(o=WA.exec(s))){if(s=o[1].trim(),o=o[2].trim(),s=="Format")t=o.split(ff);else if(s=="Dialogue"){o=o.split(ff),s={};for(var u=0;u<t.length&&u<o.length;u++)s[t[u]]=o[u];u=zA(s.Start);var l=zA(s.End);o=new ht(u,l,o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.Zi=s.Style,(e=r.find((function(f){return function(g){return g.Name==f.Zi}})(e)))&&X4(o,e),i.push(o)}}return i};function X4(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=XA(n))&&(e.color=n),(n=t.BackColour)&&(n=XA(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=ho),t.Italic&&(e.fontStyle=po),t.Underline&&e.textDecoration.push(xi),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=Va,e.textAlign="start";break;case 2:e.displayAlign=Va,e.textAlign=ii;break;case 3:e.displayAlign=Va,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=ii;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=ii;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function XA(e){return e=parseInt(e.replace("&H",""),16),e>=0?"rgba("+(e&255)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function zA(e){return e=W4.exec(e),(e[1]?parseInt(e[1].replace(":",""),10):0)*3600+parseInt(e[2],10)*60+parseFloat(e[3])}de("shaka.text.SsaTextParser",dr),dr.prototype.parseMedia=dr.prototype.parseMedia,dr.prototype.setManifestType=dr.prototype.setManifestType,dr.prototype.setSequenceMode=dr.prototype.setSequenceMode,dr.prototype.parseInit=dr.prototype.parseInit;var z4=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,WA=/^\s*([^:]+):\s*(.*)/,ff=/\s*,\s*/,W4=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;sn("text/x-ssa",function(){return new dr});function KA(e,t){var n=e[t+1]&1?7:9;return t+n<=e.length&&(e=((e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5)-n,e>0)?{ce:n,ra:e}:null}function $A(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=(e[t+2]&60)>>>2;if(r>n.length-1)return null;var i=((e[t+2]&192)>>>6)+1,s=(e[t+2]&1)<<2;return s|=(e[t+3]&192)>>>6,{sampleRate:n[r],channelCount:s,codec:"mp4a.40."+i}}function YA(e,t){if(t+1<e.length&&e[t]===255&&(e[t+1]&246)===240){var n=e[t+1]&1?7:9;if(t+n>=e.length)return!1;var r=(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5;return r<=n?!1:(t+=r,t===e.length||t+1<e.length&&e[t]===255&&(e[t+1]&246)===240)}return!1}function K4(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2||t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}function fr(e){this.j=e,this.h=0,this.g=new Map,this.i=null}p=fr.prototype,p.destroy=function(){this.g.clear()},p.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/aac"?vn(this.convertCodecs("audio",e)):!1},p.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/aac"?'audio/mp4; codecs="'+(Nn(t)||"mp4a.40.2")+'"':t},p.getOriginalMimeType=function(){return this.j},p.transmux=function(e,t,n,r){for(var i=Le(e),s=Co(i),o=s.length;o<i.length&&!YA(i,o);o++);if(e=n.endTime*1e3,s=Fs(s),s.length&&n&&(s=s.find(function(g){return g.description==="com.apple.streaming.transportStreamTimestamp"}))&&(e=s.data),s=$A(i,o),!s)return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=s.sampleRate,t.channelsCount=s.channelCount;for(var u=[];o<i.length;){var l=KA(i,o);if(!l)return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));var f=l.ce+l.ra;o+f<=i.length&&u.push({data:i.subarray(o+l.ce,o+f),size:l.ra,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),o+=f}return i=s.sampleRate,e=Math.floor(e*i/1e3),r={id:t.id,type:"audio",codecs:s.codec,encrypted:t.encrypted&&t.drmInfos.length>0,timescale:i,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:u},stream:t},r=new Ao([r]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Eo(r),this.g.set(n,t)),n=this.i!==t,r=ru(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})},de("shaka.transmuxer.AacTransmuxer",fr),fr.prototype.transmux=fr.prototype.transmux,fr.prototype.getOriginalMimeType=fr.prototype.getOriginalMimeType,fr.prototype.convertCodecs=fr.prototype.convertCodecs,fr.prototype.isSupported=fr.prototype.isSupported,fr.prototype.destroy=fr.prototype.destroy,Ti("audio/aac",function(){return new fr("audio/aac")},Qi);function qA(e,t){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return null;var n=e[t+4]>>6;if(n>=3)return null;var r=e[t+4]&63,i=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][r*3+n]*2;if(t+i>e.length)return null;var s=e[t+6]>>5,o=0;s===2?o+=2:(s&1&&s!==1&&(o+=2),s&4&&(o+=2)),o=(e[t+6]<<8|e[t+7])>>12-o&1;var u=e[t+5]&7;return e=new Uint8Array([n<<6|e[t+5]>>3<<1|u>>2,(u&3)<<6|s<<3|o<<2|r>>4,r<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][s]+o,Ga:e,ra:i}}function $4(e,t){if(e[t]===11&&e[t+1]===119){var n=0,r=5;t+=r;for(var i,s;r>0;){s=e[t];var o=Math.min(r,8),u=8-o;i=4278190080>>>24+u<<u,i=(s&i)>>u,n=n?n<<o|i:i,t+=1,r-=o}if(n<16)return!0}return!1}function Mr(e){this.j=e,this.h=0,this.g=new Map,this.i=null}p=Mr.prototype,p.destroy=function(){this.g.clear()},p.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/ac3"?vn(this.convertCodecs("audio",e)):!1},p.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/ac3"?je().re()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},p.getOriginalMimeType=function(){return this.j},p.transmux=function(e,t,n,r){e=Le(e);for(var i=Co(e),s=i.length;s<e.length&&!$4(e,s);s++);var o=n.endTime*1e3;i=Fs(i),i.length&&n&&(i=i.find(function(g){return g.description==="com.apple.streaming.transportStreamTimestamp"}))&&(o=i.data),i=0;for(var u=new Uint8Array([]),l=[];s<e.length;){var f=qA(e,s);if(!f)return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=f.sampleRate,t.channelsCount=f.channelCount,i=f.sampleRate,u=f.Ga,l.push({data:e.subarray(s,s+f.ra),size:f.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),s+=f.ra}return e=Math.floor(o*i/1e3),r={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:i,duration:r,Cb:[],Ga:u,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:l},stream:t},r=new Ao([r]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Eo(r),this.g.set(n,t)),n=this.i!==t,r=ru(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})},de("shaka.transmuxer.Ac3Transmuxer",Mr),Mr.prototype.transmux=Mr.prototype.transmux,Mr.prototype.getOriginalMimeType=Mr.prototype.getOriginalMimeType,Mr.prototype.convertCodecs=Mr.prototype.convertCodecs,Mr.prototype.isSupported=Mr.prototype.isSupported,Mr.prototype.destroy=Mr.prototype.destroy,Ti("audio/ac3",function(){return new Mr("audio/ac3")},Qi);function QA(e,t){if(t+8>e.length||(e[t]<<8|e[t+1]<<0)!==2935)return null;var n=new Ri(e.subarray(t+2));qn(n,2),qn(n,3);var r=Xe(n,11)+1<<1,i=Xe(n,2);if(i==3){i=Xe(n,2),i=[24e3,22060,16e3][i];var s=3}else i=[48e3,44100,32e3][i],s=Xe(n,2);var o=Xe(n,3),u=Xe(n,1);return n=Xe(n,5),t+r>e.byteLength?null:(e=Math.floor(r*i/([1,2,3,6][s]*16)),e=new Uint8Array([(e&8160)>>5,(e&31)<<3,i<<6|n<<1|0,0|o<<1|u<<0,0]),{sampleRate:i,channelCount:[2,1,2,3,3,4,4,5][o]+u,Ga:e,ra:r})}function Rr(e){this.j=e,this.h=0,this.g=new Map,this.i=null}p=Rr.prototype,p.destroy=function(){this.g.clear()},p.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/ec3"?vn(this.convertCodecs("audio",e)):!1},p.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/ec3"?'audio/mp4; codecs="ec-3"':t},p.getOriginalMimeType=function(){return this.j},p.transmux=function(e,t,n,r){e=Le(e);for(var i=Co(e),s=i.length;s<e.length&&(e[s]<<8|e[s+1]<<0)!==2935;s++);var o=n.endTime*1e3;i=Fs(i),i.length&&n&&(i=i.find(function(g){return g.description==="com.apple.streaming.transportStreamTimestamp"}))&&(o=i.data),i=0;for(var u=new Uint8Array([]),l=[];s<e.length;){var f=QA(e,s);if(!f)return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=f.sampleRate,t.channelsCount=f.channelCount,i=f.sampleRate,u=f.Ga,l.push({data:e.subarray(s,s+f.ra),size:f.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),s+=f.ra}return e=Math.floor(o*i/1e3),r={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:i,duration:r,Cb:[],Ga:u,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:l},stream:t},r=new Ao([r]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Eo(r),this.g.set(n,t)),n=this.i!==t,r=ru(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})},de("shaka.transmuxer.Ec3Transmuxer",Rr),Rr.prototype.transmux=Rr.prototype.transmux,Rr.prototype.getOriginalMimeType=Rr.prototype.getOriginalMimeType,Rr.prototype.convertCodecs=Rr.prototype.convertCodecs,Rr.prototype.isSupported=Rr.prototype.isSupported,Rr.prototype.destroy=Rr.prototype.destroy,Ti("audio/ec3",function(){return new Rr("audio/ec3")},Qi);function Y4(e){if(!e.length)return null;var t=e.find(function(I){return I.type==7});if(e=e.find(function(I){return I.type==8}),!t||!e)return null;var n=new Ri(t.data),r=nt(n);if(nt(n),nt(n),on(n),Q4.includes(r)&&(r=Te(n),r===3&&qn(n,1),on(n),on(n),qn(n,1),Ee(n))){r=r!==3?8:12;for(var i=0;i<r;i++)Ee(n)&&(i<6?Ec(n,16):Ec(n,64))}if(on(n),r=Te(n),r===0)Te(n);else if(r===1)for(qn(n,1),on(n),on(n),r=Te(n),i=0;i<r;i++)on(n);on(n),qn(n,1);var s=Te(n),o=Te(n),u=Xe(n,1);u===0&&qn(n,1),qn(n,1);var l=0,f=0,g=0,y=0;if(Ee(n)&&(l=Te(n),f=Te(n),g=Te(n),y=Te(n)),i=r=1,Ee(n)&&Ee(n)){var v=nt(n),w=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],A=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];v>0&&v<=16?(r=w[v-1],i=A[v-1]):v===255&&(r=Xe(n,16),i=Xe(n,16))}return n=(2-u)*(o+1)*16-g*2-y*2,s=(s+1)*16-l*2-f*2,l=[],t=t.fullData,l.push(t.byteLength>>>8&255),l.push(t.byteLength&255),l=l.concat.apply(l,Y(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(e.byteLength&255),t=t.concat.apply(t,Y(e)),e=new Uint8Array([1,l[3],l[4],l[5],255,225].concat(l,[1],t)),{height:n,width:s,Sa:e,Za:r,$a:i}}function q4(e){function t(A){i={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:A.pts,dts:A.dts,nalus:[]}}function n(){if(i&&i.nalus.length&&i.frame){for(var A=[],I=x(i.nalus),E=I.next();!E.done;E=I.next()){E=E.value;var R=E.fullData.byteLength,M=new Uint8Array(4);M[0]=R>>24&255,M[1]=R>>16&255,M[2]=R>>8&255,M[3]=R&255,A.push(M),A.push(E.fullData)}i.data=Lt.apply(un,Y(A)),r.push(i)}}for(var r=[],i=null,s=!1,o=0;o<e.length;o++){var u=e[o],l=u.nalus,f=!1;i&&l.length&&!s&&(n(),t(u)),l=x(u.nalus);for(var g=l.next();!g.done;g=l.next()){g=g.value;var y=!1;switch(g.type){case 1:var v=!1;y=!0;var w=g.data;f&&w.length>4&&(w=ZC(new Ri(w)),w===2||w===4||w===7||w===9)&&(v=!0),v&&i&&i.frame&&!i.isKeyframe&&(n(),i=null),i||t(u),i.frame=!0,i.isKeyframe=v;break;case 5:y=!0,i&&i.frame&&!i.isKeyframe&&(n(),i=null),i||t(u),i.frame=!0,i.isKeyframe=!0;break;case 6:y=!0;break;case 7:f=y=!0;break;case 8:y=!0;break;case 9:s=y=!0,i&&i.frame&&(n(),i=null),i||t(u);break;case 12:y=!0;break;default:y=!1}i&&y&&i.nalus.push(g)}}return n(),r}var Q4=[100,110,122,244,44,83,86,118,128,138,139,134];function J4(e){if(!e.length)return null;var t=e.find(function(o){return o.type==32}),n=e.find(function(o){return o.type==33}),r=e.find(function(o){return o.type==34});if(!t||!n||!r)return null;var i=Z4(t.fullData);e=eL(n.fullData);var s=tL(r.fullData);return t=nL(t.fullData,n.fullData,r.fullData,{Wg:i.Wg,Dh:i.Dh,Hg:e.Hg,Ig:e.Ig,Bg:e.Bg,Gg:e.Gg,Cg:e.Cg,Dg:e.Dg,Eg:e.Eg,Fg:e.Fg,vg:e.vg,wg:e.wg,xg:e.xg,yg:e.yg,zg:e.zg,Ag:e.Ag,tf:e.tf,jg:e.jg,ig:e.ig,hg:e.hg,Yg:s.Yg,ug:e.ug,sg:e.sg}),{height:e.height,width:e.width,Sa:t,Za:e.Sk,$a:e.Rk}}function Z4(e){var t=new Ri(e,!0);return nt(t),nt(t),Xe(t,4),Xe(t,2),Xe(t,6),e=Xe(t,3),t=Ee(t),{Wg:e+1,Dh:t}}function eL(e){e=new Ri(e,!0),nt(e),nt(e);var t=0,n=0,r=0,i=0;Xe(e,4);var s=Xe(e,3);Ee(e);for(var o=Xe(e,2),u=Xe(e,1),l=Xe(e,5),f=nt(e),g=nt(e),y=nt(e),v=nt(e),w=nt(e),A=nt(e),I=nt(e),E=nt(e),R=nt(e),M=nt(e),D=nt(e),O=[],X=[],b=0;b<s;b++)O.push(Ee(e)),X.push(Ee(e));if(s>0)for(b=s;b<8;b++)Xe(e,2);for(b=0;b<s;b++)O[b]&&Xe(e,88),X[b]&&nt(e);Te(e),O=Te(e),O==3&&Xe(e,1),X=Te(e),b=Te(e),Ee(e)&&(t+=Te(e),n+=Te(e),r+=Te(e),i+=Te(e));var U=Te(e),N=Te(e),z=Te(e);if(Ee(e))for(var B=0;B<=s;B++)Te(e),Te(e),Te(e);else Te(e),Te(e),Te(e);if(Te(e),Te(e),Te(e),Te(e),Te(e),Te(e),Ee(e)&&Ee(e))for(B=0;B<4;B++)for(var W=0;W<(B===3?2:6);W++)if(Ee(e)){var G=Math.min(64,1<<4+(B<<1));B>1&&Mo(e);for(var re=0;re<G;re++)Mo(e)}else Te(e);for(Ee(e),Ee(e),Ee(e)&&(nt(e),Te(e),Te(e),Ee(e)),B=Te(e),G=W=0;G<B;G++)if(re=!1,G!==0&&(re=Ee(e)),re){G===B&&Te(e),Ee(e),Te(e);for(var ne=re=0;ne<=W;ne++){var $=Ee(e),Q=!1;$||(Q=Ee(e)),($||Q)&&re++}W=re}else{for(ne=Te(e),re=Te(e),W=ne+re,$=0;$<ne;$++)Te(e),Ee(e);for(ne=0;ne<re;ne++)Te(e),Ee(e)}if(Ee(e))for(B=Te(e),W=0;W<B;W++){for(G=0;G<z+4;G++)Xe(e,1);Xe(e,1)}if(B=z=1,W=!0,G=1,ne=re=0,Ee(e),Ee(e),Ee(e)){if(Ee(e)){$=nt(e),Q=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2];var ae=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];$>0&&$<=16?(z=Q[$-1],B=ae[$-1]):$===255&&(z=Xe(e,16),B=Xe(e,16))}if(Ee(e)&&Ee(e),Ee(e)&&(Xe(e,3),Ee(e),Ee(e)&&(nt(e),nt(e),nt(e))),Ee(e)&&(Te(e),Te(e)),Ee(e),Ee(e),Ee(e),($=Ee(e))&&(on(e),on(e),on(e),on(e)),Ee(e)&&(G=Xe(e,32),re=Xe(e,32),Ee(e)&&Te(e),Ee(e))){ae=!1,$=Ee(e),Q=Ee(e),($||Q)&&((ae=Ee(e))&&(nt(e),Xe(e,5),Ee(e),Xe(e,5)),Xe(e,4),Xe(e,4),ae&&Xe(e,4),Xe(e,5),Xe(e,5),Xe(e,5));for(var le=0;le<=s;le++){W=Ee(e);var be=!0,xe=1;W||(be=Ee(e));var Ze=!1;if(be?Te(e):Ze=Ee(e),Ze||(xe=Te(e)+1),$){for(be=0;be<xe;be++)Te(e),Te(e),ae&&(Te(e),Te(e));Ee(e)}if(Q){for(be=0;be<xe;be++)Te(e),Te(e),ae&&(Te(e),Te(e));Ee(e)}}}Ee(e)&&(Ee(e),Ee(e),Ee(e),ne=Te(e),Te(e),Te(e),Te(e),Te(e))}return{Bg:D,Hg:o,Ig:u,Gg:l,Cg:f,Dg:g,Eg:y,Fg:v,vg:w,wg:A,xg:I,yg:E,zg:R,Ag:M,tf:ne,jg:O,ig:U,hg:N,width:X-(t+n)*(O===1||O===2?2:1),height:b-(r+i)*(O===1?2:1),Sk:z,Rk:B,ug:re/G,sg:W}}function tL(e){var t=new Ri(e,!0);nt(t),nt(t),Te(t),Te(t),Ee(t),Ee(t),Xe(t,3),Ee(t),Ee(t),Te(t),Te(t),Mo(t),Ee(t),Ee(t),Ee(t)&&Te(t),Mo(t),Mo(t),Ee(t),Ee(t),Ee(t),Ee(t),e=Ee(t),t=Ee(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Yg:n}}function nL(e,t,n,r){var i=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));for(i[0]=1,i[1]=(r.Hg&3)<<6|(r.Ig?1:0)<<5|r.Gg&31,i[2]=r.Cg,i[3]=r.Dg,i[4]=r.Eg,i[5]=r.Fg,i[6]=r.vg,i[7]=r.wg,i[8]=r.xg,i[9]=r.yg,i[10]=r.zg,i[11]=r.Ag,i[12]=r.Bg,i[13]=240|(r.tf&3840)>>8,i[14]=r.tf&255,i[15]=252|r.Yg&3,i[16]=252|r.jg&3,i[17]=248|r.ig&7,i[18]=248|r.hg&7,i[19]=0,i[20]=parseInt(r.ug,10),i[21]=((r.sg?1:0)&3)<<6|(r.Wg&7)<<3|(r.Dh?1:0)<<2|3,i[22]=3,e=[e,t,n],t=23,n=e.length-1,r=0;r<e.length;r+=1)i.set(new Uint8Array([32+r|(r===n?128:0),0,1]),t),t+=3,i.set(new Uint8Array([e[r].byteLength>>8,e[r].byteLength&255]),t),t+=2,i.set(e[r],t),t+=e[r].byteLength;return i}function hf(e,t){var n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,s=e[t+2]>>2&3;if(n!==1&&i!==0&&i!==15&&s!==3){var o=e[t+3]>>6;i=rL[(n===3?3-r:r===3?3:4)*14+i-1]*1e3,s=iL[(n===3?0:n===2?1:2)*3+s],n=sL[n][r];var u=oL[r],l=Math.floor(n*i/s+(e[t+2]>>1&1))*u,f=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(f=f?parseInt(f[1],10):0)&&f<=87&&r===2&&i>=224e3&&o===0&&(e[t+3]|=128),{sampleRate:s,channelCount:o===3?1:2,ra:l,Qk:n*8*u}}return null}function JA(e,t){return e[t]===255&&(e[t+1]&224)===224&&(e[t+1]&6)!==0}function ZA(e,t){if(t+1<e.length&&JA(e,t)){var n=hf(e,t),r=4;return n&&n.ra&&(r=n.ra),t+=r,t===e.length||t+1<e.length&&JA(e,t)}return!1}var rL=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],iL=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],sL=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],oL=[0,1,1,4];function kr(e){this.j=e,this.h=0,this.g=new Map,this.i=null}p=kr.prototype,p.destroy=function(){this.g.clear()},p.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/mpeg"?vn(this.convertCodecs("audio",e)):!1},p.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/mpeg"?'audio/mp4; codecs="mp3"':t},p.getOriginalMimeType=function(){return this.j},p.transmux=function(e,t,n,r){for(var i=Le(e),s=Co(i).length;s<i.length&&!ZA(i,s);s++);var o;for(e=[];s<i.length;){var u=hf(i,s);if(!u)return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));o||(o=u),s+u.ra<=i.length&&e.push({data:i.subarray(s,s+u.ra),size:u.ra,duration:1152,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),s+=u.ra}return o?(i=o.Qk*9e4/o.sampleRate*this.h,r={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:o.sampleRate,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:i,zb:e},stream:t},r=new Ao([r]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Eo(r),this.g.set(n,t)),n=this.i!==t,r=ru(r),this.i=t,this.h++,Promise.resolve({data:r,init:n?t:null})):Promise.reject(new H(2,3,3018,n?n.P()[0]:null))},de("shaka.transmuxer.Mp3Transmuxer",kr),kr.prototype.transmux=kr.prototype.transmux,kr.prototype.getOriginalMimeType=kr.prototype.getOriginalMimeType,kr.prototype.convertCodecs=kr.prototype.convertCodecs,kr.prototype.isSupported=kr.prototype.isSupported,kr.prototype.destroy=kr.prototype.destroy,Ti("audio/mpeg",function(){return new kr("audio/mpeg")},Qi);function _r(e){this.h=e,this.g=null}p=_r.prototype,p.destroy=function(){},p.isSupported=function(e){if(e.toLowerCase().split(";")[0]!="video/mp2t")return!1;var t=Nn(e).split(","),n=bn("audio",t);return t=bn("video",t),!n||t||Vt(n)!="mp3"?!1:vn(this.convertCodecs("audio",e))},p.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="video/mp2t"?"audio/mpeg":t},p.getOriginalMimeType=function(){return this.h},p.transmux=function(e,t,n,r,i){if(this.g?this.g.clearData():this.g=new ft,this.g.Jf(n.i),e=Le(e),e=this.g.parse(e),e.Xd().audio!="mp3"||i!="audio")return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));for(n=new Uint8Array([]),i=x(e.ub()),e=i.next();!e.done;e=i.next())if(e=e.value.data)for(t=0;t<e.length;)(r=hf(e,t))?(t+r.ra<=e.length&&(n=Lt(n,e.subarray(t,t+r.ra))),t+=r.ra):t++;return Promise.resolve(n)},de("shaka.transmuxer.MpegTsTransmuxer",_r),_r.prototype.transmux=_r.prototype.transmux,_r.prototype.getOriginalMimeType=_r.prototype.getOriginalMimeType,_r.prototype.convertCodecs=_r.prototype.convertCodecs,_r.prototype.isSupported=_r.prototype.isSupported,_r.prototype.destroy=_r.prototype.destroy,Ti("video/mp2t",function(){return new _r("video/mp2t")},bh);/*
 @license
 MSS Transmuxer
 Copyright 2015 Dash Industry Forum
 SPDX-License-Identifier: BSD-3-Clause
*/function hr(e){this.h=e,(this.g=Wg.get("ISOBoxer")())&&aL(this)}function aL(e){function t(){this._procFullBox(),this.flags&1&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,function(n){this._procEntryField(n,"InitializationVector","data",8),this.flags&2&&(this._procEntryField(n,"NumberOfEntries","uint",16),this._procSubEntries(n,"clearAndCryptedData",n.NumberOfEntries,function(r){this._procEntryField(r,"BytesOfClearData","uint",16),this._procEntryField(r,"BytesOfEncryptedData","uint",32)}))})}e.g.addBoxProcessor("saio",function(){this._procFullBox(),this.flags&1&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",this.version===1?64:32)}),e.g.addBoxProcessor("saiz",function(){this._procFullBox(),this.flags&1&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),this.default_sample_info_size===0&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",function(){for(var n=!0,r=0;r<16;r++)this.usertype[r]!==uL[r]&&(n=!1);n&&(this._parsing&&(this.type="sepiff"),t.call(this))})}p=hr.prototype,p.destroy=function(){},p.isSupported=function(e,t){var n=e.startsWith("mss/");return!this.g||!n?!1:t?vn(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),vn(t)||vn(e))},p.convertCodecs=function(e,t){return t.replace("mss/","")},p.getOriginalMimeType=function(){return this.h},p.transmux=function(e,t,n){if(!n)return Promise.resolve(Le(e));if(!t.mssPrivateData)return Promise.reject(new H(2,3,3020,n?n.P()[0]:null));try{var r,i=this.g.parseBuffer(e),s=i.fetch("tfhd");s.track_ID=t.id+1;var o=i.fetch("tfdt"),u=i.fetch("traf");o===null&&(o=this.g.createFullBox("tfdt",u,s),o.version=1,o.flags=0,o.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var l=i.fetch("trun"),f=i.fetch("tfxd");f&&f._parent.boxes.splice(f._parent.boxes.indexOf(f),1);var g=i.fetch("tfrf");g&&g._parent.boxes.splice(g._parent.boxes.indexOf(g),1);var y=i.fetch("sepiff");if(y!==null){y.type="senc",y.usertype=void 0;var v=i.fetch("saio");if(v===null){v=this.g.createFullBox("saio",u),v.version=0,v.flags=0,v.entry_count=1,v.offset=[0];var w=this.g.createFullBox("saiz",u);if(w.version=0,w.flags=0,w.sample_count=y.sample_count,w.default_sample_info_size=0,w.sample_info_size=[],y.flags&2)for(r=0;r<y.sample_count;r+=1)w.sample_info_size[r]=10+6*y.entry[r].NumberOfEntries;else w.default_sample_info_size=8}}s.flags&=16777214,s.flags|=131072,l.flags|=1;var A=i.fetch("moof");l.data_offset=A.getLength()+8;var I=i.fetch("saio");I!==null&&(I.offset[0]=eE(A,"traf")+eE(u,"senc")+16);var E=Le(i.write());return Promise.resolve(E)}catch(R){return R instanceof H?Promise.reject(R):Promise.reject(new H(2,3,3022,n?n.P()[0]:null))}};function eE(e,t){for(var n=8,r=0;r<e.boxes.length&&e.boxes[r].type!==t;r++)n+=e.boxes[r].size;return n}de("shaka.transmuxer.MssTransmuxer",hr),hr.prototype.transmux=hr.prototype.transmux,hr.prototype.getOriginalMimeType=hr.prototype.getOriginalMimeType,hr.prototype.convertCodecs=hr.prototype.convertCodecs,hr.prototype.isSupported=hr.prototype.isSupported,hr.prototype.destroy=hr.prototype.destroy;var uL=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);Ti("mss/audio/mp4",function(){return new hr("mss/audio/mp4")},Qi),Ti("mss/video/mp4",function(){return new hr("mss/video/mp4")},Qi);function Pr(e){this.m=e,this.g=0,this.j=new Map,this.l=this.i=this.h=null}p=Pr.prototype,p.destroy=function(){this.j.clear(),this.i&&this.i.destroy()},p.isSupported=function(e,t){if(e.toLowerCase().split(";")[0]!="video/mp2t")return!1;var n=e;t&&(n=this.convertCodecs(t,e));var r=Nn(n).split(",");return n=bn("audio",r),r=bn("video",r),n&&(n=Vt(n),!lL.includes(n))||r&&(n=Vt(r),!cL.includes(n))?!1:t?vn(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),vn(t)||vn(e))},p.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="video/mp2t"?(t=Nn(t).replace("mp4a.40.34","mp3").split(",").map(function(n){return qa(n,"audio/mp4")}).map(Jv).join(","),e=="audio"?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},p.getOriginalMimeType=function(){return this.m},p.transmux=function(e,t,n,r,i){var s=Le(e);if(i=="audio"&&!Ro(s)){for(var o=Co(s),u=o.length;u<s.length;u++)if(ZA(s,u))return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));for(u=o.length;u<s.length;u++)if(YA(s,u))return this.i||(this.i=new fr("audio/aac")),this.i.transmux(e,t,n,r,i);return Promise.reject(new H(2,3,3018,n?n.P()[0]:null))}this.h?this.h.clearData():this.h=new ft,this.h.Jf(n.i);var l=this.h.parse(s),f=[],g=l.Xd();try{var y=null;if(i=="video"){switch(g.video){case"avc":var v=[],w=null,A=l.ud(),I=q4(A);if(!I.length)throw new H(2,3,3023,n?n.P()[0]:null);for(var E=0;E<I.length;E++){var R=I[E];w==null&&(w=R.dts);var M=void 0;M=E+1<I.length?(I[E+1].dts||0)-(R.dts||0):I.length>1?(R.dts||0)-(I[E-1].dts||0):(n.endTime-n.startTime)*9e4,v.push({data:R.data,size:R.data.byteLength,duration:M,sb:Math.round((R.pts||0)-(R.dts||0)),flags:{xb:0,mb:0,jb:0,hb:0,ib:R.isKeyframe?2:1,yb:R.isKeyframe?0:1}})}for(var D=[],O=x(A),X=O.next();!X.done;X=O.next())D.push.apply(D,Y(X.value.nalus));var b=Y4(D);if(!b||w==null)throw new H(2,3,3018,n?n.P()[0]:null);t.height=b.height,t.width=b.width,y={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:9e4,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:b.Sa,Za:b.Za,$a:b.$a,data:{sequenceNumber:this.g,baseMediaDecodeTime:w,zb:v},stream:t};break;case"hvc":var U=[],N=null,z=[],B=l.ud();if(!B.length)throw new H(2,3,3023,n?n.P()[0]:null);for(var W=0;W<B.length;W++){var G=B[W],re=G.nalus;z.push.apply(z,Y(re));for(var ne=!1,$=[],Q=!1,ae=x(re),le=ae.next();!le.done;le=ae.next()){var be=le.value;switch(be.type){case 1:case 0:var xe=Q=!0;break;case 19:case 20:case 21:ne=xe=Q=!0;break;case 32:xe=!0;break;case 33:xe=!0;break;case 34:xe=!0;break;case 35:Q=xe=!0;break;case 39:case 40:xe=!0;break;default:xe=!1}if(Q&&xe){var Ze=be.fullData.byteLength,Ne=new Uint8Array(4);Ne[0]=Ze>>24&255,Ne[1]=Ze>>16&255,Ne[2]=Ze>>8&255,Ne[3]=Ze&255,$.push(Ne),$.push(be.fullData)}}var st=$.length?{data:Lt.apply(un,Y($)),isKeyframe:ne}:null;if(st){N==null&&G.dts!=null&&(N=G.dts);var ze=void 0;ze=W+1<B.length?(B[W+1].dts||0)-(G.dts||0):B.length>1?(G.dts||0)-(B[W-1].dts||0):(n.endTime-n.startTime)*9e4,U.push({data:st.data,size:st.data.byteLength,duration:ze,sb:Math.round((G.pts||0)-(G.dts||0)),flags:{xb:0,mb:0,jb:0,hb:0,ib:st.isKeyframe?2:1,yb:st.isKeyframe?0:1}})}}var He=J4(z);if(!He||N==null)throw new H(2,3,3018,n?n.P()[0]:null);t.height=He.height,t.width=He.width,y={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:9e4,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:He.Sa,Za:He.Za,$a:He.$a,data:{sequenceNumber:this.g,baseMediaDecodeTime:N,zb:U},stream:t}}y&&(f.push(y),y=null)}if(i=="audio"){switch(g.audio){case"aac":for(var $e=[],Je,Ye=null,Ge=null,We=null,Wt=x(l.ub()),jt=Wt.next();!jt.done;jt=Wt.next()){var pr=jt.value,Vn=pr.data;if(Vn){var kn=0;if(Ge==-1&&We)Vn=Lt(We,pr.data),Ge=null;else if(Ge!=null&&We){kn=Math.max(0,Ge);var $s=Lt(We,Vn.subarray(0,kn));$e.push({data:$s,size:$s.byteLength,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),Ge=We=null}if(Je=$A(Vn,kn),!Je)throw new H(2,3,3018,n?n.P()[0]:null);for(t.audioSamplingRate=Je.sampleRate,t.channelsCount=Je.channelCount,Ye==null&&pr.pts!==null&&(Ye=pr.pts);kn<Vn.length;){var ji=KA(Vn,kn);if(!ji){We=Vn.subarray(kn,Vn.length),Ge=-1;break}var Fr=ji.ce+ji.ra;Ge=Math.max(0,kn+Fr-Vn.length),Ge!=0?We=Vn.subarray(kn+ji.ce,kn+Fr):kn+Fr<=Vn.length&&$e.push({data:Vn.subarray(kn+ji.ce,kn+Fr),size:ji.ra,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),kn+=Fr}}}if(!Je||Ye==null){Ye=n.startTime*9e4;var ra=bn("audio",t.codecs.split(","));if(!ra||!t.channelsCount||!t.audioSamplingRate)throw new H(2,3,3018,n?n.P()[0]:null);Je={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:ra};var ia=K4(ra,t.channelsCount);if(!ia)throw new H(2,3,3018,n?n.P()[0]:null);for(var pf=Ye+(n.endTime-n.startTime)*9e4,Vr=Ye;Vr<pf;)$e.push({data:ia,size:ia.byteLength,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),Vr+=1024/Je.sampleRate*9e4}var gf=Je.sampleRate,Qm=Ye/9e4*gf;y={id:t.id,type:"audio",codecs:Je.codec,encrypted:t.encrypted&&t.drmInfos.length>0,timescale:gf,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:Qm,zb:$e},stream:t};break;case"ac3":for(var mf=[],sa=0,nl=new Uint8Array([]),Bt=null,er=x(l.ub()),_n=er.next();!_n.done;_n=er.next()){var Jm=_n.value,Zm=Jm.data;Bt==null&&Jm.pts!==null&&(Bt=Jm.pts);for(var oa=0;oa<Zm.length;){var ms=qA(Zm,oa);ms?(t.audioSamplingRate=ms.sampleRate,t.channelsCount=ms.channelCount,sa=ms.sampleRate,nl=ms.Ga,mf.push({data:Zm.subarray(oa,oa+ms.ra),size:ms.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),oa+=ms.ra):oa++}}if(sa==0||nl.byteLength==0||Bt==null)throw new H(2,3,3018,n?n.P()[0]:null);var dL=Bt/9e4*sa;y={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:sa,duration:r,Cb:[],Ga:nl,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:dL,zb:mf},stream:t};break;case"ec3":for(var nE=[],yf=0,ey=new Uint8Array([]),vf=null,rE=x(l.ub()),ty=rE.next();!ty.done;ty=rE.next()){var ny=ty.value,ry=ny.data;vf==null&&ny.pts!==null&&(vf=ny.pts);for(var aa=0;aa<ry.length;){var ys=QA(ry,aa);ys?(t.audioSamplingRate=ys.sampleRate,t.channelsCount=ys.channelCount,yf=ys.sampleRate,ey=ys.Ga,nE.push({data:ry.subarray(aa,aa+ys.ra),size:ys.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),aa+=ys.ra):aa++}}if(yf==0||ey.byteLength==0||vf==null)throw new H(2,3,3018,n?n.P()[0]:null);var fL=vf/9e4*yf;y={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:yf,duration:r,Cb:[],Ga:ey,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:fL,zb:nE},stream:t};break;case"mp3":for(var iE=[],xf,Tf=null,sE=x(l.ub()),iy=sE.next();!iy.done;iy=sE.next()){var sy=iy.value,rl=sy.data;if(rl){Tf==null&&sy.pts!==null&&(Tf=sy.pts);for(var Ys=0;Ys<rl.length;){var ua=hf(rl,Ys);ua?(xf||(xf=ua),Ys+ua.ra<=rl.length&&iE.push({data:rl.subarray(Ys,Ys+ua.ra),size:ua.ra,duration:1152,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),Ys+=ua.ra):Ys++}}}if(!xf||Tf==null)throw new H(2,3,3018,n?n.P()[0]:null);var oE=xf.sampleRate,hL=Tf/9e4*oE;y={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:oE,duration:r,Cb:[],Ga:new Uint8Array([]),Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:hL,zb:iE},stream:t};break;case"opus":var aE=[],wf=null,ui=l.H;if(!ui)throw new H(2,3,3018,n?n.P()[0]:null);var Pn=[];switch(ui.sj){case 1:case 2:Pn=[0];break;case 0:Pn=[255,1,1,0,1];break;case 128:Pn=[255,2,0,0,1];break;case 3:Pn=[1,2,1,0,2,1];break;case 4:Pn=[1,2,2,0,1,2,3];break;case 5:Pn=[1,3,2,0,4,1,2,3];break;case 6:Pn=[1,4,2,0,4,1,2,3,5];break;case 7:Pn=[1,4,2,0,4,1,2,3,5,6];break;case 8:Pn=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:Pn=[1,1,2,0,1];break;case 131:Pn=[1,1,3,0,1,2];break;case 132:Pn=[1,1,4,0,1,2,3];break;case 133:Pn=[1,1,5,0,1,2,3,4];break;case 134:Pn=[1,1,6,0,1,2,3,4,5];break;case 135:Pn=[1,1,7,0,1,2,3,4,5,6];break;case 136:Pn=[1,1,8,0,1,2,3,4,5,6,7]}for(var uE=new Uint8Array([0,ui.channelCount,0,0,ui.sampleRate>>>24&255,ui.sampleRate>>>17&255,ui.sampleRate>>>8&255,ui.sampleRate>>>0&255,0,0].concat(Y(Pn))),lE=ui.sampleRate,cE=x(l.ub()),oy=cE.next();!oy.done;oy=cE.next()){var ay=oy.value,la=ay.data;wf==null&&ay.pts!==null&&(wf=ay.pts);for(var il=0;il<la.length;){for(var pL=(la[il+1]&16)!==0,gL=(la[il+1]&8)!==0,Bi=il+2,Sf=0;la[Bi]===255;)Sf+=255,Bi+=1;Sf+=la[Bi],Bi+=1,Bi+=pL?2:0,Bi+=gL?2:0;var dE=la.slice(Bi,Bi+Sf);aE.push({data:dE,size:dE.byteLength,duration:960,sb:0,flags:{xb:0,mb:0,jb:0,hb:0,ib:2,yb:0}}),il=Bi+Sf}}if(uE.byteLength==0||wf==null)throw new H(2,3,3018,n?n.P()[0]:null);t.audioSamplingRate=ui.sampleRate,t.channelsCount=ui.channelCount;var mL=wf/9e4*lE;y={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:lE,duration:r,Cb:[],Ga:uE,Sa:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:mL,zb:aE},stream:t}}y&&(f.push(y),y=null)}}catch(ly){return ly&&ly.code==3023?Promise.resolve(new Uint8Array([])):Promise.reject(ly)}if(!f.length)return Promise.reject(new H(2,3,3018,n?n.P()[0]:null));var fE=new Ao(f),uy=t.id+"_"+n.i;if(this.j.has(uy))var sl=this.j.get(uy);else sl=Eo(fE),this.j.set(uy,sl);var yL=this.l!==sl,vL=ru(fE);return this.l=sl,this.g++,Promise.resolve({data:vL,init:yL?sl:null})},de("shaka.transmuxer.TsTransmuxer",Pr),Pr.prototype.transmux=Pr.prototype.transmux,Pr.prototype.getOriginalMimeType=Pr.prototype.getOriginalMimeType,Pr.prototype.convertCodecs=Pr.prototype.convertCodecs,Pr.prototype.isSupported=Pr.prototype.isSupported,Pr.prototype.destroy=Pr.prototype.destroy;var lL=["aac","ac-3","ec-3","mp3","opus"],cL=["avc","hevc"];Ti("video/mp2t",function(){return new Pr("video/mp2t")},Nh);function tE(){}J(tE,Un),de("shaka.util.FairPlayUtils",tE)}).call(a,c,c,void 0);for(var d in a.shaka)h[d]=a.shaka[d]})()})(Ry)),Ry}aj();const qy={lightning:{debug:!1,focusDebug:!1,fontSettings:{fontFamily:"Roboto",color:4294967295,fontSize:40},animationSettings:{easing:"ease-in-out",duration:250},rendererOptions:{appHeight:1080,appWidth:1920,numImageWorkers:2,fontEngines:[sj],renderEngine:Xb,inspector:void 0,deviceLogicalPixelRatio:1,devicePhysicalPixelRatio:1,boundsMargin:20,createImageBitmapSupport:"auto"}},keys:{Back:["b",66],Left:["ArrowLeft",37],Right:["ArrowRight",39],Up:["ArrowUp",38],Down:["ArrowDown",40],Enter:["Enter",13],Play:["p",80],Pause:["a",65],Menu:["m"],PlayPause:["t",84],FastForward:["f",70],FastForward10:["d",68],Rewind:["r",82],Rewind10:["e",69],Stop:["s",83],Key0:["0",96,48],Key1:["1",97,49],Key2:["2",98,50],Key3:["3",99,51],Key4:["4",100,52],Key5:["5",101,53],Key6:["6",102,54],Key7:["7",103,55],Key8:["8",104,56],Key9:["9",105,57]},keyHoldOptions:{userKeyHoldMap:{EnterHold:["Enter",13],BackHold:["b",66]},holdThreshold:1e3}},uj="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxODU4MjY0ZTM2ZWQ1NzZkYzM3ZDU5MjJmNzM3MWRmNiIsIm5iZiI6MTY2NzIzOTgzMS45MDIwMDAyLCJzdWIiOiI2MzYwMGY5NzFkYmM4ODAwOTBmNTIxMDAiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.LXx9-LdX9JsiY0DhpmjYcYitlqPJqntNHVv-HGZXpww",lj="https://api.themoviedb.org/3";let x2,T2;const cj=new URLSearchParams(window.location.search),dj=cj.get("posterSize")||"w185",fj={headers:{"Content-Type":"application/json",Authorization:"Bearer "+uj}};function Cj(h,c=dj){return T2+c+h}function hj(h,c={}){return x2?Qy(h,c):w2().then(()=>Qy(h,c))}function Qy(h,c={}){return fetch(lj+h,{...fj,...c}).then(a=>a.json())}function w2(){return Qy("/configuration").then(h=>{var c;return x2=h,T2=(c=h.images)==null?void 0:c.secure_base_url,h})}const S2={get:hj,loadConfig:w2};async function pj(h){try{const c=await S2.get("/discover/movie");return(h?c.results.slice(0,5):c.results).map(d=>({title:d.title,poster_path:d.poster_path,overview:d.overview,backdrop_path:d.backdrop_path,id:d.id}))}catch(c){throw console.error(c),c}}async function gj(h){try{const c=await S2.get("/discover/tv");return(h?c.results.slice(0,5):c.results).map(d=>({title:d.name,poster_path:d.poster_path,overview:d.overview,backdrop_path:d.backdrop_path,id:d.id}))}catch(c){throw console.error(c),c}}function mj(){const h=[];return h.push({title:"MOVIES",items:By(()=>pj(!0))[0]}),h.push({title:"SERIES",items:By(()=>gj(!0))[0]}),{rows:h}}YU(en,qy.lightning);const{render:yj}=L3();qb(SN);yj(()=>(uN(qy.keys,qy.keyHoldOptions),ci(xN,{root:wN,get children(){return ci(iN,{path:"/",get component(){return C3(()=>AL(()=>import("./index-CksZPw6c.js"),[],import.meta.url))},preload:mj})}})));export{Aj as F,Ij as T,N3 as V,xj as __vite_legacy_guard,ci as a,gr as b,VI as c,Cj as g,Tj as i,Ej as m,HI as s};
